{"version":2,"kind":"Notebook","sha256":"acdbf678c9b93155b7b37c4838ab8abd60362943e19def8b06c47f1813ffad57","slug":"chapter13","location":"/julia/chapter13.md","dependencies":[],"frontmatter":{"title":"Chapter 13","numbering":{"heading_1":{"enabled":false},"heading_2":{"enabled":false},"heading_3":{"enabled":false},"heading_4":{"enabled":false},"heading_5":{"enabled":false},"heading_6":{"enabled":false},"title":{"offset":2}},"kernelspec":{"name":"julia-1.11","display_name":"Julia 1","language":"julia"},"content_includes_title":false,"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","TPBVP":"two-point boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"edit_url":"https://github.com/fncbook/fnc/blob/master/julia/chapter13.md","exports":[{"format":"md","filename":"chapter13.md","url":"/build/chapter13-19e5facadad4962e6741dea04d6b396c.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Functions","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"Pg1QuzPBQe"}],"identifier":"functions","label":"Functions","html_id":"functions","implicit":true,"key":"KVl8cTdyVB"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Create a tensor-product grid","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"VZIYcoJmtb"}],"key":"u1sIwR6Ot4"},{"type":"include","file":"FNCFunctions/src/chapter13.jl","literal":true,"filter":{"startAfter":"# begin tensorgrid","endBefore":"# end tensorgrid"},"children":[{"type":"code","value":"\"\"\"\n    tensorgrid(x, y)\n\nCreate a tensor grid for a rectangle from its 1d projections `x` and `y`.\nReturns `unvec` to reshape a vector into a 2d array, `mtx` to evaluate a\nfunction on the grid, `X`, `Y` to give the grid coordinates, and boolean array\n`is_boundary` to identify the boundary points.\n\"\"\"\nfunction tensorgrid(x, y)\n    m, n = length(x) - 1, length(y) - 1\n    unvec(u) = reshape(u, m+1, n+1)\n    mtx(h) = [h(x, y) for x in x, y in y]\n    X = mtx((x, y) -> x)\n    Y = mtx((x, y) -> y)\n    is_boundary = trues(m+1, n+1)\n    is_boundary[2:m, 2:n] .= false\n    return mtx, X, Y, unvec, is_boundary\nend","lang":"julia","showLineNumbers":true,"filename":"tensorgrid.jl","key":"CaAWwYkY99"}],"key":"ojYwn7VAUS"}],"label":"function-tensorgrid-julia","identifier":"function-tensorgrid-julia","html_id":"function-tensorgrid-julia","key":"sf4RPRPSPF"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Solution of Poisson’s equation by finite differences","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"a0fqwfiM4E"}],"key":"Y59usCn306"},{"type":"include","file":"FNCFunctions/src/chapter13.jl","literal":true,"filter":{"startAfter":"# begin poissonfd","endBefore":"# end poissonfd"},"children":[{"type":"code","value":"\"\"\"\n    poissonfd(f, g, m, xspan, n, yspan)\n\nSolve Poisson's equation on a rectangle by finite differences.\nFunction `f` is the forcing function and function `g` gives the\nDirichlet boundary condition. The rectangle is the tensor product of\nintervals `xspan` and `yspan`,  and the discretization uses `m`+1\nand `n`+1 points in the two coordinates.\n\nReturns vectors defining the grid and a matrix of grid solution values.\n\"\"\"\nfunction poissonfd(f, g, m, xspan, n, yspan)\n    # Discretize the domain.\n    x, Dx, Dxx = FNC.diffmat2(m, xspan)\n    y, Dy, Dyy = FNC.diffmat2(n, yspan)\n    mtx, X, Y, unvec, is_boundary = tensorgrid(x, y)\n    N = (m+1) * (n+1)   # total number of unknowns\n\n    # Form the collocated PDE as a linear system.\n    A = kron(I(n+1), sparse(Dxx)) + kron(sparse(Dyy), I(m+1))\n    b = vec(mtx(f))\n\n    # Apply Dirichlet condition.\n    scale = maximum(abs, A[n+2, :])\n    idx = vec(is_boundary)\n    A[idx, :] = scale * I(N)[idx, :]        # Dirichet assignment\n    b[idx] = scale * g.(X[idx], Y[idx])    # assigned values\n\n    # Solve the linear system and reshape the output.\n    u = A \\ b\n    return x, y, unvec(u)\nend","lang":"julia","showLineNumbers":true,"filename":"poissonfd.jl","key":"Ner4ukfom9"}],"key":"KuXPxIJP5E"}],"label":"function-poissonfd-julia","identifier":"function-poissonfd-julia","html_id":"function-poissonfd-julia","key":"iDvTdm3OkL"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Solution of elliptic ","key":"b34CyXYGDh"},{"type":"abbreviation","title":"partial differential equation","children":[{"type":"text","value":"PDE","key":"h56SjBFcZ3"}],"key":"eQb5T6hVbs"},{"type":"text","value":" by Chebyshev collocation","key":"fjcY2Va5jU"}],"key":"i7S4WyyncK"},{"type":"include","file":"FNCFunctions/src/chapter13.jl","literal":true,"filter":{"startAfter":"# begin elliptic","endBefore":"# end elliptic"},"children":[{"type":"code","value":"\"\"\"\n    elliptic(ϕ, g, m, xspan, n, yspan)\n\nSolve the elliptic PDE\n    `ϕ`(x, y, u, u_x, u_xx, u_y, u_yy) = 0\non the rectangle `xspan`x`yspan`, subject to `g`(x,y)=0 on the boundary. Uses\n`m`+1 points in x by `n`+1 points in y in a Chebyshev discretization. Returns\nvectors defining the grid and a matrix of grid solution values.\n\"\"\"\nfunction elliptic(ϕ, g, m, xspan, n, yspan)\n    # Discretize the domain.\n    x, Dx, Dxx = diffcheb(m, xspan)\n    y, Dy, Dyy = diffcheb(n, yspan)\n    mtx, X, Y, unvec, is_boundary = tensorgrid(x, y)\n    N = (m+1) * (n+1)   # total number of unknowns\n\n    # Identify boundary locations and evaluate the boundary condition.\n    idx = vec(is_boundary)\n    gb = g.(X[idx], Y[idx])\n\n    # Evaluate the PDE+BC residual.\n    function residual(u)\n        U = unvec(u)\n        R = ϕ(X, Y, U, Dx * U, Dxx * U, U * Dy', U * Dyy')    # PDE\n        @. R[idx] = u[idx] - gb                               # boundary residual\n        return vec(R)\n    end\n\n    # Solve the equation.\n    u = levenberg(residual, vec(zeros(size(X))))[end]\n    U = unvec(u)\n\n    return function (ξ, η)\n        v = [chebinterp(x, u, ξ) for u in eachcol(U)]\n        return chebinterp(y, v, η)\n    end\nend","lang":"julia","showLineNumbers":true,"filename":"elliptic.jl","key":"r0So15HeZp"}],"key":"XXLy1RHnn4"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"About the code","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"key":"T61eDMjE1q"}],"key":"teO2aFvGi9"},{"type":"paragraph","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"children":[{"type":"text","value":"The boundary values are accessed using Boolean indexing. One advantage of this style, though it is not exploited here, is that the complementary points can also be accessed via the Boolean NOT operator ","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"key":"QZEVSYQLNh"},{"type":"inlineCode","value":"!","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"key":"XL5iFzSQOx"},{"type":"text","value":". Note that any indexing array either has to be the same size as the object of the indexing, or a vector with the same number of elements. In this function, for example, ","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"key":"SfZHUxzSS2"},{"type":"inlineCode","value":"X[idx]","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"key":"XHCYxTWEgd"},{"type":"text","value":", ","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"key":"XLU1jwID2t"},{"type":"inlineCode","value":"X[isboundary]","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"key":"H7rnqxRuzK"},{"type":"text","value":", and ","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"key":"ohuabKX6is"},{"type":"inlineCode","value":"u[idx]","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"key":"Bx0F2d4Idh"},{"type":"text","value":" would all be valid, but ","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"key":"qhjyRg5azf"},{"type":"inlineCode","value":"u[isboundary]","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"key":"KWnb2HWodA"},{"type":"text","value":" would not be.","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"key":"SABxbIt8HI"}],"key":"Ru1jKlDtoB"}],"class":"dropdown","key":"E5LdGs9YWW"}],"label":"function-elliptic-julia","identifier":"function-elliptic-julia","html_id":"function-elliptic-julia","key":"XVKUyyELSc"},{"type":"heading","depth":2,"position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"children":[{"type":"text","value":"Examples","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"RsJEELGoOY"}],"identifier":"examples","label":"Examples","html_id":"examples","implicit":true,"key":"g2Ccfcmj3N"}],"key":"GkUwymKhWn"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"include(\"FNC_init.jl\")","visibility":"show","key":"D2gQdxYwbr"},{"type":"output","id":"yeh1P5NfGulxz8NOlZG_r","data":[{"output_type":"stream","name":"stderr","text":"\u001b[32m\u001b[1m  Activating\u001b[22m\u001b[39m "},{"output_type":"stream","name":"stderr","text":"project at `~/Documents/GitHub/fnc`\n"}],"visibility":"show","key":"Nc8cw74I62"}],"data":{"tags":[]},"visibility":"remove","key":"NCtzlLGNIn"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"children":[{"type":"text","value":"13.1 ","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"key":"HZOKjDXJtl"},{"type":"link","identifier":"section-twodim-tensorprod","label":"section-twodim-tensorprod","kind":"narrative","position":{"start":{"line":60,"column":6},"end":{"line":60,"column":32}},"url":"/tensorprod","internal":true,"dataUrl":"/tensorprod.json","children":[{"type":"text","value":"Tensor-product discretizations","key":"UB5fAjhXcR"}],"key":"ibgSfQITwx"}],"identifier":"id-13-1","label":"13.1 ","html_id":"id-13-1","implicit":true,"key":"tgGLDqIoLM"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-tensorprod-gridfun","label":"demo-tensorprod-gridfun","kind":"proof:example","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":25}},"children":[{"type":"text","value":"Example ","key":"y81yuOGkn4"},{"type":"text","value":"13.1.2","key":"aqFxSDMiun"}],"template":"Example %s","enumerator":"13.1.2","resolved":true,"html_id":"demo-tensorprod-gridfun","remote":true,"url":"/tensorprod","dataUrl":"/tensorprod.json","key":"m6KZDhWFad"}],"key":"SfZlMUYLBB"},{"type":"paragraph","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"children":[{"type":"text","value":"Here is the grid from ","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"EyLIbmF3a2"},{"type":"crossReference","kind":"proof:example","identifier":"example-tensorprod-smallgrid","label":"example-tensorprod-smallgrid","children":[{"type":"text","value":"Example ","key":"C4FxSoI4Yt"},{"type":"text","value":"13.1.1","key":"LG4DL6JPg4"}],"template":"Example %s","enumerator":"13.1.1","resolved":true,"html_id":"example-tensorprod-smallgrid","remote":true,"url":"/tensorprod","dataUrl":"/tensorprod.json","key":"faJMPfmOm6"},{"type":"text","value":".","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"HyxIMUggDF"}],"key":"fx9E7eMMAm"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"m = 4\nx = range(0, 2, m+1)\nn = 2\ny = range(1, 3, n+1);","key":"dWk8ShRTso"},{"type":"output","id":"ZRMStuS46wvGPrzo0Eh8c","data":[],"key":"fh56Rtvfmh"}],"key":"jToGBPZefw"},{"type":"paragraph","position":{"start":{"line":74,"column":1},"end":{"line":74,"column":1}},"children":[{"type":"text","value":"For a given ","position":{"start":{"line":74,"column":1},"end":{"line":74,"column":1}},"key":"JwteNAhZ3P"},{"type":"inlineMath","value":"f(x,y)","position":{"start":{"line":74,"column":1},"end":{"line":74,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo separator=\"true\">,</mo><mi>y</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">f(x,y)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span></span></span></span>","key":"T4Kf6dKtxk"},{"type":"text","value":" we can find ","position":{"start":{"line":74,"column":1},"end":{"line":74,"column":1}},"key":"HLHmXknUXP"},{"type":"inlineMath","value":"\\operatorname{mtx}(f)","position":{"start":{"line":74,"column":1},"end":{"line":74,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">mtx</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mi>f</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\operatorname{mtx}(f)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop\"><span class=\"mord mathrm\">mtx</span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mclose\">)</span></span></span></span>","key":"qzY7M4Niih"},{"type":"text","value":" by using a comprehension syntax.","position":{"start":{"line":74,"column":1},"end":{"line":74,"column":1}},"key":"q04bzshpvt"}],"key":"YSukpDl4gD"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"f = (x, y) -> cos(π * x * y - y)\nF = [f(x, y) for x in x, y in y]","key":"NqhwzfGz3Z"},{"type":"output","id":"iLoL60XVuM7I6Mp9VoGA1","data":[{"output_type":"execute_result","execution_count":3,"metadata":{},"data":{"text/plain":{"content":"5×3 Matrix{Float64}:\n  0.540302  -0.416147  -0.989992\n  0.841471   0.416147  -0.14112\n -0.540302  -0.416147   0.989992\n -0.841471   0.416147   0.14112\n  0.540302  -0.416147  -0.989992","content_type":"text/plain"}}}],"key":"GLzfoC9IEi"}],"key":"uOYzSUQUY1"},{"type":"paragraph","position":{"start":{"line":81,"column":1},"end":{"line":81,"column":1}},"children":[{"type":"text","value":"We can make a nice plot of the function by first choosing a much finer grid.","position":{"start":{"line":81,"column":1},"end":{"line":81,"column":1}},"key":"Ger5Rpa3Tv"}],"key":"ZddZTAcK34"},{"type":"admonition","kind":"warning","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Warning","key":"t7Nb9eHNNo"}],"key":"OlX6rQwXUD"},{"type":"paragraph","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"children":[{"type":"text","value":"The contour and surface plotting functions of the Julia ","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"key":"g94n5kh2GK"},{"type":"inlineCode","value":"Plots","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"key":"Bxow0E2Y4W"},{"type":"text","value":" package expect the ","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"key":"zZPEB2mI68"},{"type":"emphasis","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"children":[{"type":"text","value":"transpose","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"key":"InBf39WvWm"}],"key":"oT8JmzpMFg"},{"type":"text","value":" of our convention for mtx(","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"key":"Gtljo6ZYnL"},{"type":"inlineMath","value":"f","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>","key":"XzZKKpUYGN"},{"type":"text","value":"). If you forget to do this, you will either get an error or a plot with the axes swapped.","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"key":"cFcUxyzbBl"}],"key":"cL99A9YOEP"}],"key":"AbZm68eGHt"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"R2R22hfUBA"}],"key":"SMucVChLyL"},{"type":"paragraph","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"children":[{"type":"text","value":"To emphasize departures from a zero level, use a colormap such as ","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"key":"jYhzYPy6oi"},{"type":"inlineCode","value":"redsblues","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"key":"o2USdHKpol"},{"type":"text","value":", and use ","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"key":"lYa8Sbi9Mo"},{"type":"inlineCode","value":"clims","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"key":"V6H0lAGoIm"},{"type":"text","value":" to set balanced color differences.","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"key":"ppiBGrNtp2"}],"key":"GDt3lJfrOk"}],"class":"dropdown","key":"S1u5eHEtve"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"using Plots\nm, n = 80, 60\nx = range(0, 2, m+1);\ny = range(1, 3, n+1);\nF = [f(x, y) for x in x, y in y]\ncontour(x, y, F';\n    levels=21,  aspect_ratio=1,\n    color=:redsblues,  clims=(-1, 1),\n    xlabel=\"x\",  ylabel=\"y\" )","key":"biSlB6Olwd"},{"type":"output","id":"OSdCnsjJFafkKROopRNDY","data":[{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"30682d518367736334acda11ac71659f","path":"/build/30682d518367736334acda11ac71659f.png"},"text/html":{"content_type":"text/html","hash":"6bdf85d39c9c68eb01b0910dbbf7c766","path":"/build/6bdf85d39c9c68eb01b0910dbbf7c766.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"0d3aae71438098f656528c726729d361","path":"/build/0d3aae71438098f656528c726729d361.svg"}}}],"key":"quNcbfvcqk"}],"key":"gWVKUBf1iB"}],"label":"demo-tensorprod-gridfun-julia","identifier":"demo-tensorprod-gridfun-julia","html_id":"demo-tensorprod-gridfun-julia","key":"XMdl4jgmDA"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-tensorprod-disksphere","label":"demo-tensorprod-disksphere","kind":"proof:example","position":{"start":{"line":107,"column":1},"end":{"line":107,"column":28}},"children":[{"type":"text","value":"Example ","key":"iTA6XZ9Qb2"},{"type":"text","value":"13.1.3","key":"AlHL8okdDA"}],"template":"Example %s","enumerator":"13.1.3","resolved":true,"html_id":"demo-tensorprod-disksphere","remote":true,"url":"/tensorprod","dataUrl":"/tensorprod.json","key":"QYXwccL7g5"}],"key":"sdx8ClMfWa"},{"type":"paragraph","position":{"start":{"line":109,"column":1},"end":{"line":109,"column":1}},"children":[{"type":"text","value":"For a function given in polar form, such as ","position":{"start":{"line":109,"column":1},"end":{"line":109,"column":1}},"key":"W41W2nqAwe"},{"type":"inlineMath","value":"f(r,\\theta)=1-r^4","position":{"start":{"line":109,"column":1},"end":{"line":109,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><mi>r</mi><mo separator=\"true\">,</mo><mi>θ</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mn>1</mn><mo>−</mo><msup><mi>r</mi><mn>4</mn></msup></mrow><annotation encoding=\"application/x-tex\">f(r,\\theta)=1-r^4</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">4</span></span></span></span></span></span></span></span></span></span></span>","key":"eczRP20CN6"},{"type":"text","value":", construction of a function over the unit disk is straightforward using a grid in ","position":{"start":{"line":109,"column":1},"end":{"line":109,"column":1}},"key":"crvdERkgLd"},{"type":"inlineMath","value":"(r,\\theta)","position":{"start":{"line":109,"column":1},"end":{"line":109,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>r</mi><mo separator=\"true\">,</mo><mi>θ</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(r,\\theta)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"mclose\">)</span></span></span></span>","key":"NETX4vWnke"},{"type":"text","value":" space.","position":{"start":{"line":109,"column":1},"end":{"line":109,"column":1}},"key":"aU1NoWAmRb"}],"key":"jTdJ14pDW0"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"r = range(0, 1, 41)\nθ = range(0, 2π, 81)\nF = [1 - r^4 for r in r, θ in θ]\nplot(r, θ, F';\n    legend=:none, \n    color=:viridis,  fill=true,\n    xlabel=\"r\",  ylabel=\"θ\", \n    title=\"A polar function\")","key":"EXRT4pLxmw"},{"type":"output","id":"CsrKFt96p54vef15rLsaq","data":[{"output_type":"execute_result","execution_count":5,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"6787e9518ac3070bd0ce76b4f81c122e","path":"/build/6787e9518ac3070bd0ce76b4f81c122e.png"},"text/html":{"content_type":"text/html","hash":"61746eb15329d6e742e42148f5f7a9b2","path":"/build/61746eb15329d6e742e42148f5f7a9b2.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"dc3250df03adfab7584bd837a48747ee","path":"/build/dc3250df03adfab7584bd837a48747ee.svg"}}}],"key":"EmoFQRhtMv"}],"key":"qGSvVm2Jru"},{"type":"paragraph","position":{"start":{"line":122,"column":1},"end":{"line":122,"column":1}},"children":[{"type":"text","value":"Of course, we are used to seeing such plots over the ","position":{"start":{"line":122,"column":1},"end":{"line":122,"column":1}},"key":"wpgrCSmtQ4"},{"type":"inlineMath","value":"(x,y)","position":{"start":{"line":122,"column":1},"end":{"line":122,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo separator=\"true\">,</mo><mi>y</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(x,y)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span></span></span></span>","key":"w3s7oHFfdV"},{"type":"text","value":" plane, not the ","position":{"start":{"line":122,"column":1},"end":{"line":122,"column":1}},"key":"K5W3LVWB8t"},{"type":"inlineMath","value":"(r,\\theta)","position":{"start":{"line":122,"column":1},"end":{"line":122,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>r</mi><mo separator=\"true\">,</mo><mi>θ</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(r,\\theta)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"mclose\">)</span></span></span></span>","key":"SFwuWmU7Xh"},{"type":"text","value":" plane.","position":{"start":{"line":122,"column":1},"end":{"line":122,"column":1}},"key":"tHFrPgce83"}],"key":"k346s7Kilf"},{"type":"paragraph","position":{"start":{"line":124,"column":1},"end":{"line":124,"column":1}},"children":[{"type":"text","value":"In such functions the values along the line ","position":{"start":{"line":124,"column":1},"end":{"line":124,"column":1}},"key":"BeL8gVYWdo"},{"type":"inlineMath","value":"r=0","position":{"start":{"line":124,"column":1},"end":{"line":124,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>r</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">r=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"crkIYgDe7x"},{"type":"text","value":" must be identical, and the values on the line ","position":{"start":{"line":124,"column":1},"end":{"line":124,"column":1}},"key":"aEzrNclf6p"},{"type":"inlineMath","value":"\\theta=0","position":{"start":{"line":124,"column":1},"end":{"line":124,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>θ</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">\\theta=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"k1DzwvpAay"},{"type":"text","value":" should be identical to those on ","position":{"start":{"line":124,"column":1},"end":{"line":124,"column":1}},"key":"F3I54mOLcL"},{"type":"inlineMath","value":"\\theta=2\\pi","position":{"start":{"line":124,"column":1},"end":{"line":124,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>θ</mi><mo>=</mo><mn>2</mn><mi>π</mi></mrow><annotation encoding=\"application/x-tex\">\\theta=2\\pi</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span></span></span></span>","key":"XC4k9tp6tY"},{"type":"text","value":". Otherwise the interpretation of the domain as the unit disk is nonsensical. If the function is defined in terms of ","position":{"start":{"line":124,"column":1},"end":{"line":124,"column":1}},"key":"ikBo2l8bOr"},{"type":"inlineMath","value":"x","position":{"start":{"line":124,"column":1},"end":{"line":124,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"dJ3Ld5Oal8"},{"type":"text","value":" and ","position":{"start":{"line":124,"column":1},"end":{"line":124,"column":1}},"key":"CPWzuhBttv"},{"type":"inlineMath","value":"y","position":{"start":{"line":124,"column":1},"end":{"line":124,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>","key":"jxzeC2TBk0"},{"type":"text","value":", then those can be defined in terms of ","position":{"start":{"line":124,"column":1},"end":{"line":124,"column":1}},"key":"CmplohD8yF"},{"type":"inlineMath","value":"r","position":{"start":{"line":124,"column":1},"end":{"line":124,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>r</mi></mrow><annotation encoding=\"application/x-tex\">r</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span></span></span></span>","key":"CCZGAh6Ogp"},{"type":"text","value":" and ","position":{"start":{"line":124,"column":1},"end":{"line":124,"column":1}},"key":"gNCRZmm1cz"},{"type":"text","value":"θ","position":{"start":{"line":124,"column":1},"end":{"line":124,"column":1}},"key":"SrsiPwqUkR"},{"type":"text","value":" using ","position":{"start":{"line":124,"column":1},"end":{"line":124,"column":1}},"key":"wlcJ9KWgYc"},{"type":"crossReference","kind":"equation","identifier":"unitdiskparam","label":"unitdiskparam","children":[{"type":"text","value":"(","key":"gWgimBSAcC"},{"type":"text","value":"13.1.5","key":"w0Vt93iQKW"},{"type":"text","value":")","key":"o0PT2NVKbH"}],"template":"(%s)","enumerator":"13.1.5","resolved":true,"html_id":"unitdiskparam","remote":true,"url":"/tensorprod","dataUrl":"/tensorprod.json","key":"x375qPCsPj"},{"type":"text","value":".","position":{"start":{"line":124,"column":1},"end":{"line":124,"column":1}},"key":"hXHbuJWCWq"}],"key":"StZKwQC4XQ"}],"label":"demo-tensorprod-disksphere-julia","identifier":"demo-tensorprod-disksphere-julia","html_id":"demo-tensorprod-disksphere-julia","key":"s4Xhg4s2WB"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-tensorprod-diff","label":"demo-tensorprod-diff","kind":"proof:example","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":22}},"children":[{"type":"text","value":"Example ","key":"XoSUSmLCg2"},{"type":"text","value":"13.1.4","key":"xC1SQ2GE4B"}],"template":"Example %s","enumerator":"13.1.4","resolved":true,"html_id":"demo-tensorprod-diff","remote":true,"url":"/tensorprod","dataUrl":"/tensorprod.json","key":"aU525l6Rfe"}],"key":"OU8upJUn5p"},{"type":"paragraph","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"children":[{"type":"text","value":"We define a function and, for reference, its two exact partial derivatives.","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"key":"NQpYR4bYZi"}],"key":"SzftrttCvq"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"u = (x, y) -> sin(π * x * y - y);\n∂u_∂x = (x, y) -> π * y * cos(π * x * y - y);\n∂u_∂y = (x, y) -> (π * x - 1) * cos(π * x * y - y);","key":"jJuibFSrHl"},{"type":"output","id":"o_H-bvvyqw6_7awWxvoqb","data":[],"key":"mMjFMayNO9"}],"key":"FA5tmEMPxn"},{"type":"paragraph","position":{"start":{"line":139,"column":1},"end":{"line":139,"column":1}},"children":[{"type":"text","value":"We use an equispaced grid and second-order finite differences as implemented by ","position":{"start":{"line":139,"column":1},"end":{"line":139,"column":1}},"key":"gS0YuNQmGW"},{"type":"inlineCode","value":"diffmat2","position":{"start":{"line":139,"column":1},"end":{"line":139,"column":1}},"key":"BxXBWzBvpp"},{"type":"text","value":".","position":{"start":{"line":139,"column":1},"end":{"line":139,"column":1}},"key":"IsprTigqwA"}],"key":"Ng4Nzm610j"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"m, n = 80, 70;\nx, Dx, _ = FNC.diffmat2(m, [0, 2]);\ny, Dy, _ = FNC.diffmat2(n, [1, 3]);\nmtx = (f, x, y) -> [f(x, y) for x in x, y in y];","key":"cjKZ7D8Tz7"},{"type":"output","id":"kI5AlpO7GYGy3iOkXETqj","data":[],"key":"kTd8Qa22Hu"}],"key":"OSyvfKJYkx"},{"type":"paragraph","position":{"start":{"line":148,"column":1},"end":{"line":148,"column":1}},"children":[{"type":"text","value":"Here is how the exact first partial derivatives look on the grid.","position":{"start":{"line":148,"column":1},"end":{"line":148,"column":1}},"key":"bDag8ZYbgo"}],"key":"fy9nSlmxDt"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"plot(layout=(1, 2), aspect_ratio=1, xlabel=\"x\", ylabel=\"y\")\ncontour!(x, y, mtx(∂u_∂x, x, y)';\n    levels=12, colormap=:viridis, subplot=1, title=\"∂u/∂x\")\ncontour!(x, y, mtx(∂u_∂y, x, y)';\n    levels=12, colormap=:viridis, subplot=2, title=\"∂u/∂y\")","key":"TzNJH4HiAH"},{"type":"output","id":"zt58VIl7oQ-VLrKe80-fh","data":[{"output_type":"execute_result","execution_count":8,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"59b694dcb3d0683df75912cd8368b42f","path":"/build/59b694dcb3d0683df75912cd8368b42f.png"},"text/html":{"content_type":"text/html","hash":"99c78c484301a84a77cbd7f1270c218f","path":"/build/99c78c484301a84a77cbd7f1270c218f.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"651b3405f8dc639cb6e40f1de98c14e8","path":"/build/651b3405f8dc639cb6e40f1de98c14e8.svg"}}}],"key":"P4mLKS1lce"}],"key":"FqTWDHzBVV"},{"type":"paragraph","position":{"start":{"line":158,"column":1},"end":{"line":158,"column":1}},"children":[{"type":"text","value":"Next, we compute the finite-difference approximations of these derivatives on the grid.","position":{"start":{"line":158,"column":1},"end":{"line":158,"column":1}},"key":"WGbJv8EScC"}],"key":"NPJyyIhGiN"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"U = mtx(u, x, y)\n∂xU = Dx * U\n∂yU = U * Dy';","key":"ms1TAA8mKh"},{"type":"output","id":"6uBByZRJsozjWXJseXnDX","data":[],"key":"EPRQIkNngw"}],"key":"jNUK3MHRGd"},{"type":"paragraph","position":{"start":{"line":166,"column":1},"end":{"line":166,"column":1}},"children":[{"type":"text","value":"Finally, we compare the finite-difference approximations to the exact values, using a colormap that is symmetric about zero.","position":{"start":{"line":166,"column":1},"end":{"line":166,"column":1}},"key":"imbmZPfKAR"}],"key":"aaIKK3ORnI"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"err_x = mtx(∂u_∂x, x, y) - ∂xU\nerr_y = mtx(∂u_∂y, x, y) - ∂yU\n\nplot(layout=(1, 2), aspect_ratio=1, \n    xlabel=\"x\", ylabel=\"y\")\nM = maximum(abs, err_x)\ncontour!(x, y, err_x';\n    levels=15, clims=(-M, M), colormap=:redsblues, fill=true,\n    l=false, subplot=1, title=\"∂u/∂x error\")\nM = maximum(abs, err_y)\ncontour!(x, y, err_y';\n    levels=15, clims=(-M, M), colormap=:redsblues, fill=true,\n    l=false, subplot=2, title=\"∂u/∂y error\")","key":"sMURa7TdXO"},{"type":"output","id":"kKIZJOItULvg9mgyVAOaF","data":[{"output_type":"execute_result","execution_count":10,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"d93cf1c66bff531f549121653711e0f4","path":"/build/d93cf1c66bff531f549121653711e0f4.png"},"text/html":{"content_type":"text/html","hash":"c219bc608da129709524e4aeb4469678","path":"/build/c219bc608da129709524e4aeb4469678.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"46e99fa17ab4a0cee89ddd4e811154bd","path":"/build/46e99fa17ab4a0cee89ddd4e811154bd.svg"}}}],"key":"r8IujNL9HE"}],"key":"ZkBKuEEc7U"},{"type":"paragraph","position":{"start":{"line":185,"column":1},"end":{"line":185,"column":1}},"children":[{"type":"text","value":"Not surprisingly, the errors are largest where the derivatives themselves are largest.","position":{"start":{"line":185,"column":1},"end":{"line":185,"column":1}},"key":"ifSsH8u1As"}],"key":"Y7rUM05J98"}],"label":"demo-tensorprod-diff-julia","identifier":"demo-tensorprod-diff-julia","html_id":"demo-tensorprod-diff-julia","key":"NKePLz3yXx"},{"type":"heading","depth":3,"position":{"start":{"line":189,"column":1},"end":{"line":189,"column":1}},"children":[{"type":"text","value":"13.2 ","position":{"start":{"line":189,"column":1},"end":{"line":189,"column":1}},"key":"knEqJP0Xu6"},{"type":"link","identifier":"section-twodim-diffadv","label":"section-twodim-diffadv","kind":"narrative","position":{"start":{"line":189,"column":6},"end":{"line":189,"column":29}},"url":"/diffadv","internal":true,"dataUrl":"/diffadv.json","children":[{"type":"text","value":"Two-dimensional diffusion and advection","key":"wz6gcdYoqo"}],"key":"Xoo5rigjfM"}],"identifier":"id-13-2","label":"13.2 ","html_id":"id-13-2","implicit":true,"key":"BE8cpYh7SC"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-diffadv-vec","label":"demo-diffadv-vec","kind":"proof:example","position":{"start":{"line":192,"column":1},"end":{"line":192,"column":18}},"children":[{"type":"text","value":"Example ","key":"CXhF41sK66"},{"type":"text","value":"13.2.1","key":"uhuXJNdRHu"}],"template":"Example %s","enumerator":"13.2.1","resolved":true,"html_id":"demo-diffadv-vec","remote":true,"url":"/diffadv","dataUrl":"/diffadv.json","key":"huI97bVP4y"}],"key":"FYnPmKpgb2"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"m = 2;\nn = 3;\nV = rand(1:9, m, n);\nv = vec(V)","key":"cRib4HKwht"},{"type":"output","id":"NOLJO1UwmlIIs32537GEJ","data":[{"output_type":"execute_result","execution_count":11,"metadata":{},"data":{"text/plain":{"content":"6-element Vector{Int64}:\n 5\n 8\n 2\n 2\n 5\n 5","content_type":"text/plain"}}}],"key":"PuaTkjR6QG"}],"key":"ILAWgY2oTq"},{"type":"paragraph","position":{"start":{"line":202,"column":1},"end":{"line":202,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":202,"column":1},"end":{"line":202,"column":1}},"key":"Aed4RnFRaz"},{"type":"inlineCode","value":"unvec","position":{"start":{"line":202,"column":1},"end":{"line":202,"column":1}},"key":"bdRACOVnF1"},{"type":"text","value":" operation is the inverse of vec.","position":{"start":{"line":202,"column":1},"end":{"line":202,"column":1}},"key":"MLcz53SGY2"}],"key":"jeKv4QOkBp"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"unvec = z -> reshape(z, m, n)\nunvec(v)","key":"NbqX4W8NYP"},{"type":"output","id":"thjOyiCILVZvl8VkJmgaM","data":[{"output_type":"execute_result","execution_count":12,"metadata":{},"data":{"text/plain":{"content":"2×3 Matrix{Int64}:\n 5  2  5\n 8  2  5","content_type":"text/plain"}}}],"key":"wFZraHICNi"}],"key":"m37MQuk8Od"}],"label":"demo-diffadv-vec-julia","identifier":"demo-diffadv-vec-julia","html_id":"demo-diffadv-vec-julia","key":"OUJ8q7SENq"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-diffadv-heat","label":"demo-diffadv-heat","kind":"proof:example","position":{"start":{"line":211,"column":1},"end":{"line":211,"column":19}},"children":[{"type":"text","value":"Example ","key":"Xdr80IFtZ3"},{"type":"text","value":"13.2.2","key":"sxdPrphhty"}],"template":"Example %s","enumerator":"13.2.2","resolved":true,"html_id":"demo-diffadv-heat","remote":true,"url":"/diffadv","dataUrl":"/diffadv.json","key":"LlOAxVehVb"}],"key":"DtANlz0tyA"},{"type":"paragraph","position":{"start":{"line":214,"column":1},"end":{"line":214,"column":1}},"children":[{"type":"text","value":"We start by defining the discretization of the rectangle.","position":{"start":{"line":214,"column":1},"end":{"line":214,"column":1}},"key":"nsoeBwIIuF"}],"key":"E6RcgYOxiB"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"m, n = (60, 25)\nx, Dx, Dxx = FNC.diffper(m, [-1, 1])\ny, Dy, Dyy = FNC.diffper(n, [-1, 1])\nmtx, X, Y, unvec, _ = FNC.tensorgrid(x, y);","key":"zstY9gF5EA"},{"type":"output","id":"fBJY2w2WeCpz09x6IIfxD","data":[],"key":"mJJCoABHPS"}],"key":"Tubc7e45Eu"},{"type":"paragraph","position":{"start":{"line":223,"column":1},"end":{"line":223,"column":1}},"children":[{"type":"text","value":"Here is the initial condition, evaluated on the grid.","position":{"start":{"line":223,"column":1},"end":{"line":223,"column":1}},"key":"vKhbCkfd1j"}],"key":"HaW51XVci7"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"u_init = (x, y) -> sin(4 * π * x) * exp(cos(π * y))\nU₀ = mtx(u_init)\nM = maximum(abs, U₀)\ncontour(x, y, U₀';\n    color=:redsblues,  clims=(-M, M), \n    aspect_ratio=1,\n    xaxis=(\"x\", (-1, 1)),  yaxis=(\"y\", (-1, 1)), \n    title=\"Initial condition\" )","key":"jjpvfHpByr"},{"type":"output","id":"8IE54s_D8zfUVgIRd2Emi","data":[{"output_type":"execute_result","execution_count":14,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"525c3bd608d1d46d7e0be4eb3861bbc6","path":"/build/525c3bd608d1d46d7e0be4eb3861bbc6.png"},"text/html":{"content_type":"text/html","hash":"41ea2bc85a443952fcb872e91042c79b","path":"/build/41ea2bc85a443952fcb872e91042c79b.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"e2a6d8267d063a18882c4fb814050c5c","path":"/build/e2a6d8267d063a18882c4fb814050c5c.svg"}}}],"key":"QcC5DGGTEb"}],"key":"mvyuZCBFmQ"},{"type":"paragraph","position":{"start":{"line":236,"column":1},"end":{"line":236,"column":1}},"children":[{"type":"text","value":"The following function computes the time derivative for the unknowns, which have a vector shape. The actual calculations, however, take place using the matrix shape.","position":{"start":{"line":236,"column":1},"end":{"line":236,"column":1}},"key":"QQlATvcyQD"}],"key":"ba3otQ4tTE"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"function du_dt(u, α, t)\n    U = unvec(u)\n    Uxx = Dxx * U\n    Uyy = U * Dyy'            # 2nd partials\n    du_dt = α * (Uxx + Uyy)    # PDE\n    return vec(du_dt)\nend;","key":"Faflj13B0V"},{"type":"output","id":"FsTqKy210m58vRA0_rxrX","data":[],"key":"RUx6dGT8oZ"}],"key":"pVPdJUgsgh"},{"type":"paragraph","position":{"start":{"line":248,"column":1},"end":{"line":248,"column":1}},"children":[{"type":"text","value":"Since this problem is parabolic, a stiff time integrator is appropriate.","position":{"start":{"line":248,"column":1},"end":{"line":248,"column":1}},"key":"yr4ugewi8G"}],"key":"u7JiJ9y94Y"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"using OrdinaryDiffEq\nIVP = ODEProblem(du_dt, vec(U₀), (0, 0.2), 0.1)\nsol = solve(IVP, Rodas4P());","key":"kOFOo05WLL"},{"type":"output","id":"3CPjxkEmxmGN9t1mhj_Tz","data":[],"key":"WFcNYPAgVs"}],"key":"pzg1DFHQJW"},{"type":"paragraph","position":{"start":{"line":256,"column":1},"end":{"line":256,"column":1}},"children":[{"type":"text","value":"We can use the function ","position":{"start":{"line":256,"column":1},"end":{"line":256,"column":1}},"key":"Dlu1yVcvaZ"},{"type":"inlineCode","value":"sol","position":{"start":{"line":256,"column":1},"end":{"line":256,"column":1}},"key":"CCi9If4plw"},{"type":"text","value":" defined above to get the solution at any time. Its output is the matrix ","position":{"start":{"line":256,"column":1},"end":{"line":256,"column":1}},"key":"GnVm4nYi5W"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":256,"column":1},"end":{"line":256,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"F3o8XmTmcA"},{"type":"text","value":" of values on the grid. An animation shows convergence of the solution toward a uniform value.","position":{"start":{"line":256,"column":1},"end":{"line":256,"column":1}},"key":"yPatUZyM8T"}],"key":"GqgoQonJHk"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"rqTcqvVtPE"}],"key":"OS9rSHYPc7"},{"type":"paragraph","position":{"start":{"line":260,"column":1},"end":{"line":260,"column":1}},"children":[{"type":"text","value":"To plot the solution at any time, we use the same color scale as with the initial condition, so that the pictures are more easily compared.","position":{"start":{"line":260,"column":1},"end":{"line":260,"column":1}},"key":"MxEzy9kW7m"}],"key":"Ec5ccO4mWW"}],"class":"dropdown","key":"tdIwLDtOf3"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"anim = @animate for t in range(0, 0.2, 81)\n    surface(x, y, unvec(sol(t))';\n        color=:redsblues,  clims=(-M, M),\n        xaxis=(L\"x\", (-1, 1)), \n        yaxis=(L\"y\", (-1, 1)), \n        zlims=(-M, M),\n        title=@sprintf(\"Heat equation, t=%.3f\", t),\n        dpi=150, colorbar=:none)\nend\nmp4(anim, \"figures/2d-heat.mp4\");","visibility":"hide","key":"UukPlrjrhX"},{"type":"output","id":"CQNhKuSZL5f9aS2-RTXJk","data":[{"output_type":"stream","name":"stderr","text":"\u001b[36m\u001b[1m[ \u001b[22m\u001b[39m\u001b[36m\u001b[1mInfo: \u001b[22m\u001b[39mSaved animation to /Users/driscoll/Documents/GitHub/fnc/julia/figures/2d-heat.mp4\n"}],"visibility":"remove","key":"UTnDR9XxkO"}],"data":{"tags":[]},"visibility":"show","key":"DMbbdGEYuA"},{"type":"image","url":"/build/2d-heat-9babec0e2a08c02f533e5f54c9895903.mp4","alt":"Heat equation in 2d","position":{"start":{"line":277,"column":1},"end":{"line":277,"column":1}},"key":"IUM9cDNpIy","urlSource":"figures/2d-heat.mp4"}],"label":"demo-diffadv-heat-julia","identifier":"demo-diffadv-heat-julia","html_id":"demo-diffadv-heat-julia","key":"PgoP5xIIDv"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-diffadv-advdiff","label":"demo-diffadv-advdiff","kind":"proof:example","position":{"start":{"line":282,"column":1},"end":{"line":282,"column":22}},"children":[{"type":"text","value":"Example ","key":"S2UJqbHQxw"},{"type":"text","value":"13.2.3","key":"yIx2sd45eB"}],"template":"Example %s","enumerator":"13.2.3","resolved":true,"html_id":"demo-diffadv-advdiff","remote":true,"url":"/diffadv","dataUrl":"/diffadv.json","key":"NFFZqAO47V"}],"key":"PcB9XzeL88"},{"type":"paragraph","position":{"start":{"line":285,"column":1},"end":{"line":285,"column":1}},"children":[{"type":"text","value":"The first step is to define a discretization of the domain.","position":{"start":{"line":285,"column":1},"end":{"line":285,"column":1}},"key":"xPABaKWbJu"}],"key":"aCmLJvSBzB"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"m, n = 50, 36\nx, Dx, Dxx = FNC.diffcheb(m, [-1, 1])\ny, Dy, Dyy = FNC.diffcheb(n, [-1, 1])\nmtx, X, Y, _ = FNC.tensorgrid(x, y)\nU₀ = mtx( (x, y) -> (1 + y) * (1 - x)^4 * (1 + x)^2 * (1 - y^4) );","key":"oQm2js1Txf"},{"type":"output","id":"NQc0Lj7Tt0gr4eY2NChAe","data":[],"key":"Ae7COhOflb"}],"key":"LoOpxdpERp"},{"type":"paragraph","position":{"start":{"line":295,"column":1},"end":{"line":295,"column":1}},"children":[{"type":"text","value":"We define functions ","position":{"start":{"line":295,"column":1},"end":{"line":295,"column":1}},"key":"n4HNfqk5bN"},{"type":"inlineCode","value":"extend","position":{"start":{"line":295,"column":1},"end":{"line":295,"column":1}},"key":"BIWHzx92ID"},{"type":"text","value":" and ","position":{"start":{"line":295,"column":1},"end":{"line":295,"column":1}},"key":"Xs1tbheawK"},{"type":"inlineCode","value":"chop","position":{"start":{"line":295,"column":1},"end":{"line":295,"column":1}},"key":"fuTcRFWY7G"},{"type":"text","value":" to deal with the Dirichlet boundary conditions.","position":{"start":{"line":295,"column":1},"end":{"line":295,"column":1}},"key":"NaDaRyUaWX"}],"key":"yIFCRZO2Ps"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"chop = U -> U[2:m, 2:n]\nz = zeros(1, n-1)\nextend = W -> [zeros(m+1) [z; W; z] zeros(m+1)]","key":"Z1GQKal5P0"},{"type":"output","id":"_TEMdi-L2WayROLEinQ_G","data":[{"output_type":"execute_result","execution_count":19,"metadata":{},"data":{"text/plain":{"content":"#27 (generic function with 1 method)","content_type":"text/plain"}}}],"key":"Ord4qZyuPV"}],"key":"YkPg4B6O0C"},{"type":"paragraph","position":{"start":{"line":303,"column":1},"end":{"line":303,"column":1}},"children":[{"type":"text","value":"Next, we define the ","position":{"start":{"line":303,"column":1},"end":{"line":303,"column":1}},"key":"KJXZVurRuu"},{"type":"inlineCode","value":"pack","position":{"start":{"line":303,"column":1},"end":{"line":303,"column":1}},"key":"e7nbAc2aMN"},{"type":"text","value":" and ","position":{"start":{"line":303,"column":1},"end":{"line":303,"column":1}},"key":"XiWRw3ZKjZ"},{"type":"inlineCode","value":"unpack","position":{"start":{"line":303,"column":1},"end":{"line":303,"column":1}},"key":"jjw9Agybo6"},{"type":"text","value":" functions, using another call to ","position":{"start":{"line":303,"column":1},"end":{"line":303,"column":1}},"key":"g9Qz9hckvn"},{"type":"crossReference","identifier":"function-tensorgrid","label":"function-tensorgrid","kind":"proof:algorithm","position":{"start":{"line":303,"column":74},"end":{"line":303,"column":94}},"children":[{"type":"text","value":"Algorithm ","key":"l1f0nO4fQY"},{"type":"text","value":"13.2.1","key":"o4X8i8I5lv"}],"template":"Algorithm %s","enumerator":"13.2.1","resolved":true,"html_id":"function-tensorgrid","remote":true,"url":"/diffadv","dataUrl":"/diffadv.json","key":"xJh3ukmvuj"},{"type":"text","value":" to get reshaping functions for the interior points.","position":{"start":{"line":303,"column":1},"end":{"line":303,"column":1}},"key":"K3mlK42lxe"}],"key":"C4wlehwJYR"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"_, _, _, unvec, _ = FNC.tensorgrid(x[2:m], y[2:n])\npack = U -> vec(chop(U))\nunpack = w -> extend(unvec(w))","key":"EgmwmyBQTD"},{"type":"output","id":"fzAmWOxStIwLt3j7HCvmd","data":[{"output_type":"execute_result","execution_count":20,"metadata":{},"data":{"text/plain":{"content":"#31 (generic function with 1 method)","content_type":"text/plain"}}}],"key":"dhRD6gEBaJ"}],"key":"N7CGF4LsgF"},{"type":"paragraph","position":{"start":{"line":311,"column":1},"end":{"line":311,"column":1}},"children":[{"type":"text","value":"Now we can define and solve the ","key":"EyeMLthL0h"},{"type":"abbreviation","title":"initial-value problem","children":[{"type":"text","value":"IVP","key":"qzU5BFfWIa"}],"key":"gAnOfCWf8p"},{"type":"text","value":" using a stiff solver.","key":"DuGClJ3Ywq"}],"key":"TK6juaJZ4w"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"function dw_dt(w, ϵ, t)\n    U = unpack(w)\n    Ux, Uxx = Dx * U, Dxx * U\n    Uyy = U * Dyy'\n    du_dt = @. 1 - Ux + ϵ * (Uxx + Uyy)\n    return pack(du_dt)\nend\n\nIVP = ODEProblem(dw_dt, pack(U₀), (0.0, 2), 0.05)\nw = solve(IVP, Rodas4P());","key":"ox9lQMg20f"},{"type":"output","id":"NoU_TmRx02khJha9MxVAh","data":[],"key":"lgCS1SflMt"}],"key":"SQUxMwr5li"},{"type":"paragraph","position":{"start":{"line":326,"column":1},"end":{"line":326,"column":1}},"children":[{"type":"text","value":"When we evaluate the solution at a particular value of ","position":{"start":{"line":326,"column":1},"end":{"line":326,"column":1}},"key":"zMfCPjxEN1"},{"type":"inlineMath","value":"t","position":{"start":{"line":326,"column":1},"end":{"line":326,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span></span></span></span>","key":"cLDvYY57CX"},{"type":"text","value":", we get a vector of the interior grid values. The same ","position":{"start":{"line":326,"column":1},"end":{"line":326,"column":1}},"key":"JdmA4IbodQ"},{"type":"inlineCode","value":"unpack","position":{"start":{"line":326,"column":1},"end":{"line":326,"column":1}},"key":"jwiQ9pF0sV"},{"type":"text","value":" function above converts this to a complete matrix of grid values.","position":{"start":{"line":326,"column":1},"end":{"line":326,"column":1}},"key":"eJA2uW4KZg"}],"key":"K3qcZL4moo"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"U = t -> unpack(w(t))\ncontour(x, y, U(0.5)';\n    fill=true,  color=:blues,  levels=20, l=0,\n    aspect_ratio=1,  xlabel=L\"x\",  ylabel=L\"y\",\n    title=\"Solution at t = 0.5\")","key":"N1owYprT0Z"},{"type":"output","id":"IpMLiaUNQ08c4Cnd7BtUX","data":[{"output_type":"execute_result","execution_count":22,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"1cf90e735b5cf2f25932fac53af432b4","path":"/build/1cf90e735b5cf2f25932fac53af432b4.png"},"text/html":{"content_type":"text/html","hash":"97bc361ad3f95a7c558cb3d8690d4708","path":"/build/97bc361ad3f95a7c558cb3d8690d4708.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"219526d2e8d52a593a8fa98cfef0247e","path":"/build/219526d2e8d52a593a8fa98cfef0247e.svg"}}}],"key":"glFOlM2GW6"}],"key":"RL4TjqnDXR"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"anim = @animate for t in 0:0.02:2\n    U = unpack(w(t))\n    surface(x, y, U';\n        layout=(1, 2),  size=(640, 320),\n        xlabel=L\"x\",  ylabel=L\"y\",  zaxis=((0, 2.3), L\"u(x,y)\"),\n        color=:blues,  alpha=0.66,  clims=(0, 2.3), colorbar=:none,\n        title=\"Advection-diffusion\",  dpi=150)\n    contour!(x, y, U'; \n        levels=24, \n        aspect_ratio=1,  subplot=2, \n        xlabel=L\"x\",  ylabel=L\"y\",\n        color=:blues,  clims=(0, 2.3),  colorbar=:none,\n        title=@sprintf(\"t = %.2f\", t))\nend\nmp4(anim, \"figures/2d-advdiff.mp4\");","visibility":"hide","key":"BXVHgKeqQR"},{"type":"output","id":"CO1zZ_5nDga8tn21iqrs8","data":[{"output_type":"stream","name":"stderr","text":"\u001b[36m\u001b[1m[ \u001b[22m\u001b[39m\u001b[36m\u001b[1mInfo: \u001b[22m\u001b[39mSaved animation to /Users/driscoll/Documents/GitHub/fnc/julia/figures/2d-advdiff.mp4\n"}],"visibility":"remove","key":"ruR1LohWvO"}],"data":{"tags":[]},"visibility":"show","key":"MhyqU2arZG"},{"type":"image","url":"/build/2d-advdiff-02cf34a66eabef04f4b65cae50d131b1.mp4","alt":"Advection-diffusion in 2d","position":{"start":{"line":355,"column":1},"end":{"line":355,"column":1}},"key":"sWIIFj7qob","urlSource":"figures/2d-advdiff.mp4"}],"label":"demo-diffadv-advdiff-julia","identifier":"demo-diffadv-advdiff-julia","html_id":"demo-diffadv-advdiff-julia","key":"xT8wku5orS"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-diffadv-wave","label":"demo-diffadv-wave","kind":"proof:example","position":{"start":{"line":359,"column":1},"end":{"line":359,"column":19}},"children":[{"type":"text","value":"Example ","key":"y927LMpD0q"},{"type":"text","value":"13.2.4","key":"QTHwCtvesc"}],"template":"Example %s","enumerator":"13.2.4","resolved":true,"html_id":"demo-diffadv-wave","remote":true,"url":"/diffadv","dataUrl":"/diffadv.json","key":"uU4yvAWrzh"}],"key":"tQdl5oPkzP"},{"type":"paragraph","position":{"start":{"line":361,"column":1},"end":{"line":361,"column":1}},"children":[{"type":"text","value":"We start with the discretization and initial condition.","position":{"start":{"line":361,"column":1},"end":{"line":361,"column":1}},"key":"J7LSYy2M5O"}],"key":"Sd3LwvNxDg"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"m, n = 40, 40\nx, Dx, Dxx = FNC.diffcheb(m, [-2, 2])\ny, Dy, Dyy = FNC.diffcheb(n, [-2, 2])\nmtx, X, Y, _ = FNC.tensorgrid(x, y)\nU₀ = mtx( (x, y) -> (x + 0.2) * exp(-12 * (x^2 + y^2)) )\nV₀ = zeros(size(U₀));","key":"MKbAksoT1k"},{"type":"output","id":"XenF3cILXsCcYAt3OnKk0","data":[],"key":"f49d0hGOjF"}],"key":"U2velRcMkG"},{"type":"paragraph","position":{"start":{"line":372,"column":1},"end":{"line":372,"column":1}},"children":[{"type":"text","value":"We need to define chopping and extension for the ","position":{"start":{"line":372,"column":1},"end":{"line":372,"column":1}},"key":"iid0xruTYJ"},{"type":"inlineMath","value":"u","position":{"start":{"line":372,"column":1},"end":{"line":372,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span>","key":"Bvf68IFdDO"},{"type":"text","value":" component. This looks the same as in ","position":{"start":{"line":372,"column":1},"end":{"line":372,"column":1}},"key":"dlA7onqzCg"},{"type":"crossReference","identifier":"demo-diffadv-advdiff","label":"demo-diffadv-advdiff","kind":"proof:example","position":{"start":{"line":372,"column":91},"end":{"line":372,"column":112}},"children":[{"type":"text","value":"Example ","key":"AjhPYd2cZx"},{"type":"text","value":"13.2.3","key":"Kxls4QvSMD"}],"template":"Example %s","enumerator":"13.2.3","resolved":true,"html_id":"demo-diffadv-advdiff","remote":true,"url":"/diffadv","dataUrl":"/diffadv.json","key":"XBNRK6JKUj"},{"type":"text","value":".","position":{"start":{"line":372,"column":1},"end":{"line":372,"column":1}},"key":"Ru7RqliXJs"}],"key":"Lp4P5NMkBf"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"chop = U -> U[2:m, 2:n]\nextend = U -> [zeros(m+1) [zeros(1, n-1); U; zeros(1, n-1)] zeros(m+1)]","key":"SqaT5cPhx1"},{"type":"output","id":"ikPCOXL731PHTzy0JC283","data":[{"output_type":"execute_result","execution_count":25,"metadata":{},"data":{"text/plain":{"content":"#39 (generic function with 1 method)","content_type":"text/plain"}}}],"key":"u44nFjd7se"}],"key":"L7AR16iURq"},{"type":"paragraph","position":{"start":{"line":379,"column":1},"end":{"line":379,"column":1}},"children":[{"type":"text","value":"While ","position":{"start":{"line":379,"column":1},"end":{"line":379,"column":1}},"key":"EuYDuxOGYV"},{"type":"inlineCode","value":"vec","position":{"start":{"line":379,"column":1},"end":{"line":379,"column":1}},"key":"JjdYn9eeEy"},{"type":"text","value":" is the same for both the interior and full grids, the ","position":{"start":{"line":379,"column":1},"end":{"line":379,"column":1}},"key":"ByewR8gDz3"},{"type":"inlineCode","value":"unvec","position":{"start":{"line":379,"column":1},"end":{"line":379,"column":1}},"key":"LzrBDlr8Gv"},{"type":"text","value":" operation is defined differently for them.","position":{"start":{"line":379,"column":1},"end":{"line":379,"column":1}},"key":"HSluDT9eeS"}],"key":"HkE9tWxQ6V"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"_, _, _, unvec_v, _ = FNC.tensorgrid(x, y)\n_, _, _, unvec_u, _ = FNC.tensorgrid(x[2:m], y[2:n])\nN = (m-1) * (n-1)    # number of interior unknowns\n\npack = (U, V) -> [vec(chop(U)); vec(V)]\nunpack = w -> (extend(unvec_u(w[1:N])), unvec_v(w[N+1:end]));","key":"MwNlnh4Gj5"},{"type":"output","id":"kLNVmA-Ij9O2fLNEPUUKO","data":[],"key":"Tt9oYWU1ki"}],"key":"v1gjRgW2bZ"},{"type":"paragraph","position":{"start":{"line":390,"column":1},"end":{"line":390,"column":1}},"children":[{"type":"text","value":"We can now define and solve the ","key":"TIqkZRwECn"},{"type":"abbreviation","title":"initial-value problem","children":[{"type":"text","value":"IVP","key":"ZJX26fUJgI"}],"key":"tNBHrKsSO6"},{"type":"text","value":". Since this problem is hyperbolic, a nonstiff integrator is faster than a stiff one.","key":"mtvYKqbesg"}],"key":"k6gxC7Q8oj"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"function dw_dt(w, c, t)\n    U, V = unpack(w)\n    du_dt = V\n    dv_dt = c^2 * (Dxx * U + U * Dyy')\n    return pack(du_dt, dv_dt)\nend\n\nIVP = ODEProblem(dw_dt, pack(U₀, V₀), (0, 4.0), 1)\nsol = solve(IVP, Tsit5())\nU = t -> unpack(sol(t))[1];","key":"EepS8I0vFx"},{"type":"output","id":"lRjdA3lNQSxOyp4Foaf37","data":[],"key":"L6IdNqTnQZ"}],"key":"S6CwWjI69S"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"anim = @animate for t in 0:4/100:4\n    Ut = U(t)\n    surface(x, y, Ut';\n        layout=(1, 2), size=(640, 320),\n        xlabel=L\"x\",  ylabel=L\"y\",  zaxis=((-0.1, 0.1), L\"u(x,y)\"),\n        color=:redsblues,  alpha=0.66,  clims=(-0.1, 0.1), colorbar=:none,\n        title=\"Wave equation\",  dpi=150)\n    contour!(x, y, Ut'; \n        levels=24,  subplot=2, \n        aspect_ratio=1,\n        xlabel=L\"x\",  ylabel=L\"y\",\n        color=:redsblues,  clims=(-0.1, 0.1), \n        colorbar=:none,  title=@sprintf(\"t = %.2f\", t))\nend\nmp4(anim, \"figures/2d-wave.mp4\");","visibility":"hide","key":"u0XjE1jyKa"},{"type":"output","id":"1Afo3otc9YskWrrcbbfAy","data":[{"output_type":"stream","name":"stderr","text":"\u001b[36m\u001b[1m[ \u001b[22m\u001b[39m\u001b[36m\u001b[1mInfo: \u001b[22m\u001b[39mSaved animation to /Users/driscoll/Documents/GitHub/fnc/julia/figures/2d-wave.mp4\n"}],"visibility":"remove","key":"F3LCUytGhr"}],"data":{"tags":[]},"visibility":"show","key":"KEGy5lzFnp"},{"type":"image","url":"/build/2d-wave-8c7dad225e8106515a28e762c2b15b76.mp4","alt":"Wave equation in 2d","position":{"start":{"line":424,"column":1},"end":{"line":424,"column":1}},"key":"YeW1qxE0BI","urlSource":"figures/2d-wave.mp4"}],"label":"demo-diffadv-wave-julia","identifier":"demo-diffadv-wave-julia","html_id":"demo-diffadv-wave-julia","key":"vk7ggKBK3e"},{"type":"heading","depth":3,"position":{"start":{"line":427,"column":1},"end":{"line":427,"column":1}},"children":[{"type":"text","value":"13.3 ","position":{"start":{"line":427,"column":1},"end":{"line":427,"column":1}},"key":"Gv7U0IzWmG"},{"type":"link","identifier":"section-twodim-laplace","label":"section-twodim-laplace","kind":"narrative","position":{"start":{"line":427,"column":6},"end":{"line":427,"column":29}},"url":"/laplace","internal":true,"dataUrl":"/laplace.json","children":[{"type":"text","value":"Laplace and Poisson equations","key":"T4uMzodB01"}],"key":"g6QGr1H28f"}],"identifier":"id-13-3","label":"13.3 ","html_id":"id-13-3","implicit":true,"key":"b0Cd30opdO"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-laplace-kron","label":"demo-laplace-kron","kind":"proof:example","position":{"start":{"line":430,"column":1},"end":{"line":430,"column":19}},"children":[{"type":"text","value":"Example ","key":"zk8quubHrn"},{"type":"text","value":"13.3.1","key":"csPnFVv0hO"}],"template":"Example %s","enumerator":"13.3.1","resolved":true,"html_id":"demo-laplace-kron","remote":true,"url":"/laplace","dataUrl":"/laplace.json","key":"WaSN8K0Vyq"}],"key":"R9iJVoyObe"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"A = [1 2; -2 0]","key":"MZUdUqTzFE"},{"type":"output","id":"mel56TWHyPvAcWggqOnZK","data":[{"output_type":"execute_result","execution_count":29,"metadata":{},"data":{"text/plain":{"content":"2×2 Matrix{Int64}:\n  1  2\n -2  0","content_type":"text/plain"}}}],"key":"X1jQr4KYhJ"}],"key":"Vvm6n4HVEQ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"B = [1 10 100; -5 5 3]","key":"k61lc381o7"},{"type":"output","id":"iJDxeW2561NtbFInsb4vF","data":[{"output_type":"execute_result","execution_count":30,"metadata":{},"data":{"text/plain":{"content":"2×3 Matrix{Int64}:\n  1  10  100\n -5   5    3","content_type":"text/plain"}}}],"key":"dL2xwLVgoY"}],"key":"SmYakI0cwN"},{"type":"paragraph","position":{"start":{"line":441,"column":1},"end":{"line":441,"column":1}},"children":[{"type":"text","value":"Applying the definition manually, we get","position":{"start":{"line":441,"column":1},"end":{"line":441,"column":1}},"key":"NSpEs162jv"}],"key":"dPKPM8UDtG"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"A_kron_B = [\n    A[1, 1]*B A[1, 2]*B;\n    A[2, 1]*B A[2, 2]*B\n    ]","key":"uJoQZJaHc9"},{"type":"output","id":"vEr4Hr6DHQvjQM-4LQ4DG","data":[{"output_type":"execute_result","execution_count":31,"metadata":{},"data":{"text/plain":{"content":"4×6 Matrix{Int64}:\n  1   10   100    2  20  200\n -5    5     3  -10  10    6\n -2  -20  -200    0   0    0\n 10  -10    -6    0   0    0","content_type":"text/plain"}}}],"key":"kHatrdJHrR"}],"key":"cayNKSwDji"},{"type":"paragraph","position":{"start":{"line":453,"column":1},"end":{"line":453,"column":1}},"children":[{"type":"text","value":"That result should be the same as the following.","position":{"start":{"line":453,"column":1},"end":{"line":453,"column":1}},"key":"WR90ZazVTf"}],"indexEntries":[{"entry":"Julia","subEntry":{"value":"kron","kind":"entry"},"emphasis":true}],"label":"index-NhxmROWuYU","identifier":"index-nhxmrowuyu","html_id":"index-nhxmrowuyu","key":"ax6OkMtTup"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"kron(A, B)","key":"VxsfuONONt"},{"type":"output","id":"A23gbnUTmn5YiJTenCHJm","data":[{"output_type":"execute_result","execution_count":32,"metadata":{},"data":{"text/plain":{"content":"4×6 Matrix{Int64}:\n  1   10   100    2  20  200\n -5    5     3  -10  10    6\n -2  -20  -200    0   0    0\n 10  -10    -6    0   0    0","content_type":"text/plain"}}}],"key":"ghL1pk43x8"}],"key":"tCiKVkUxY5"}],"label":"demo-laplace-kron-julia","identifier":"demo-laplace-kron-julia","html_id":"demo-laplace-kron-julia","key":"xWcLBsmwdz"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-laplace-fd","label":"demo-laplace-fd","kind":"proof:example","position":{"start":{"line":461,"column":1},"end":{"line":461,"column":17}},"children":[{"type":"text","value":"Example ","key":"ZPRVNm9yh9"},{"type":"text","value":"13.3.2","key":"VeUNFf1v0f"}],"template":"Example %s","enumerator":"13.3.2","resolved":true,"html_id":"demo-laplace-fd","remote":true,"url":"/laplace","dataUrl":"/laplace.json","key":"Jgwq82WOQB"}],"key":"mlcd1IwABu"},{"type":"paragraph","position":{"start":{"line":463,"column":1},"end":{"line":463,"column":1}},"children":[{"type":"text","value":"We make a crude discretization for illustrative purposes.","position":{"start":{"line":463,"column":1},"end":{"line":463,"column":1}},"key":"db3PdtdOR9"}],"key":"Qmmqu3C4Dp"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"m, n = 6, 5\nx, Dx, Dxx = FNC.diffmat2(m, [0, 3])\ny, Dy, Dyy = FNC.diffmat2(n, [-1, 1])\nmtx, X, Y, unvec, is_boundary = FNC.tensorgrid(x, y);","key":"x1F9Cddwsw"},{"type":"output","id":"dYGehdJrqYxq8eSHHwjIX","data":[],"key":"AtW0JCLh6n"}],"key":"YC7aLBVvjJ"},{"type":"paragraph","position":{"start":{"line":472,"column":1},"end":{"line":472,"column":1}},"children":[{"type":"text","value":"Here is a look at the matrix we called ","position":{"start":{"line":472,"column":1},"end":{"line":472,"column":1}},"key":"jM3aKW7Lkk"},{"type":"inlineMath","value":"\\mathbf{L}","position":{"start":{"line":472,"column":1},"end":{"line":472,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">L</span></span></span></span>","key":"On9bdiclWj"},{"type":"text","value":" (the discrete Laplacian), before any modifications are made for the boundary conditions. The combination of Kronecker products and finite differences produces a characteristic sparsity pattern.","position":{"start":{"line":472,"column":1},"end":{"line":472,"column":1}},"key":"dplAdVct02"}],"key":"FJPnIZeb7t"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"using SparseArrays, Plots\nA = kron(I(n+1), sparse(Dxx)) + kron(sparse(Dyy), I(m+1))\nspy(A;\n    color=:blues,  m=3,\n    title=\"System matrix before boundary conditions\")","key":"wvlL746TPQ"},{"type":"output","id":"fpFm3T1ncbTTKaLCru6NF","data":[{"output_type":"execute_result","execution_count":34,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"9dd525c8c93538fd6969c621ced64247","path":"/build/9dd525c8c93538fd6969c621ced64247.png"},"text/html":{"content_type":"text/html","hash":"fb13c84a8caf1d593a83eda2f4f52aa7","path":"/build/fb13c84a8caf1d593a83eda2f4f52aa7.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"2988456f84d479f144d6ef0b40e3e1b5","path":"/build/2988456f84d479f144d6ef0b40e3e1b5.svg"}}}],"key":"Q6w8RpGQXG"}],"key":"TmUGTck7yB"},{"type":"paragraph","position":{"start":{"line":482,"column":1},"end":{"line":482,"column":1}},"children":[{"type":"text","value":"The number of equations is equal to ","position":{"start":{"line":482,"column":1},"end":{"line":482,"column":1}},"key":"zqRPBPJY7K"},{"type":"inlineMath","value":"(m+1)(n+1)","position":{"start":{"line":482,"column":1},"end":{"line":482,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>m</mi><mo>+</mo><mn>1</mn><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">(</mo><mi>n</mi><mo>+</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(m+1)(n+1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">m</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span></span></span>","key":"vP9h9hwACT"},{"type":"text","value":", which is the total number of points on the grid.","position":{"start":{"line":482,"column":1},"end":{"line":482,"column":1}},"key":"sZY5H6m9UW"}],"key":"l4ajIwABew"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"N = (m+1) * (n+1)","key":"nrrFAr9JpX"},{"type":"output","id":"lTR1PcdhaRO7roWzlfNt0","data":[{"output_type":"execute_result","execution_count":35,"metadata":{},"data":{"text/plain":{"content":"42","content_type":"text/plain"}}}],"key":"J4p0eCX9El"}],"key":"mukrzmBocI"},{"type":"paragraph","position":{"start":{"line":488,"column":1},"end":{"line":488,"column":1}},"children":[{"type":"text","value":"We now use the final output from ","position":{"start":{"line":488,"column":1},"end":{"line":488,"column":1}},"key":"xMWPXcJ7oV"},{"type":"crossReference","identifier":"function-tensorgrid","label":"function-tensorgrid","kind":"proof:algorithm","position":{"start":{"line":488,"column":34},"end":{"line":488,"column":54}},"children":[{"type":"text","value":"Algorithm ","key":"IkzavJLBei"},{"type":"text","value":"13.2.1","key":"ZFCPm0Zx5k"}],"template":"Algorithm %s","enumerator":"13.2.1","resolved":true,"html_id":"function-tensorgrid","remote":true,"url":"/diffadv","dataUrl":"/diffadv.json","key":"ZgIc0qGURX"},{"type":"text","value":", which is a Boolean array indicating where the boundary points lie in the grid.","position":{"start":{"line":488,"column":1},"end":{"line":488,"column":1}},"key":"cNqzDuWyJy"}],"key":"TRL3Omv544"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"spy(sparse(is_boundary);\n    m=3,  color=:darkblue, \n    legend=:none,  title=\"Boundary points\",\n    xaxis=(\"column index\", [0, n+2]), \n    yaxis=(\"row index\", [0, m+2]))","key":"Z9GINL0MaG"},{"type":"output","id":"13Bnm3S9WbOu_UTD3nhSC","data":[{"output_type":"execute_result","execution_count":36,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"5a2fd256e675e8604702d1d0e0044736","path":"/build/5a2fd256e675e8604702d1d0e0044736.png"},"text/html":{"content":"<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" width=\"500\" height=\"320\" viewBox=\"0 0 2000 1280\">\n<defs>\n  <clipPath id=\"clip100\">\n    <rect x=\"0\" y=\"0\" width=\"2000\" height=\"1280\"/>\n  </clipPath>\n</defs>\n<path clip-path=\"url(#clip100)\" d=\"M0 1280 L2000 1280 L2000 0 L0 0  Z\" fill=\"#ffffff\" fill-rule=\"evenodd\" fill-opacity=\"1\"/>\n<defs>\n  <clipPath id=\"clip101\">\n    <rect x=\"400\" y=\"0\" width=\"1401\" height=\"1280\"/>\n  </clipPath>\n</defs>\n<path clip-path=\"url(#clip100)\" d=\"M642.238 1111.02 L1478.71 1111.02 L1478.71 107.256 L642.238 107.256  Z\" fill=\"#ffffff\" fill-rule=\"evenodd\" fill-opacity=\"1\"/>\n<defs>\n  <clipPath id=\"clip102\">\n    <rect x=\"642\" y=\"107\" width=\"837\" height=\"1005\"/>\n  </clipPath>\n</defs>\n<polyline clip-path=\"url(#clip100)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"642.238,1111.02 1478.71,1111.02 \"/>\n<polyline clip-path=\"url(#clip100)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"665.912,1111.02 665.912,1092.12 \"/>\n<polyline clip-path=\"url(#clip100)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"823.736,1111.02 823.736,1092.12 \"/>\n<polyline clip-path=\"url(#clip100)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"981.56,1111.02 981.56,1092.12 \"/>\n<polyline clip-path=\"url(#clip100)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"1139.38,1111.02 1139.38,1092.12 \"/>\n<polyline clip-path=\"url(#clip100)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"1297.21,1111.02 1297.21,1092.12 \"/>\n<polyline clip-path=\"url(#clip100)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"1455.03,1111.02 1455.03,1092.12 \"/>\n<path clip-path=\"url(#clip100)\" d=\"M656.294 1166.28 L663.933 1166.28 L663.933 1139.92 L655.622 1141.58 L655.622 1137.33 L663.886 1135.66 L668.562 1135.66 L668.562 1166.28 L676.201 1166.28 L676.201 1170.22 L656.294 1170.22 L656.294 1166.28 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip100)\" d=\"M818.389 1166.28 L834.708 1166.28 L834.708 1170.22 L812.764 1170.22 L812.764 1166.28 Q815.426 1163.53 820.009 1158.9 Q824.616 1154.25 825.796 1152.9 Q828.042 1150.38 828.921 1148.64 Q829.824 1146.89 829.824 1145.2 Q829.824 1142.44 827.879 1140.7 Q825.958 1138.97 822.856 1138.97 Q820.657 1138.97 818.204 1139.73 Q815.773 1140.5 812.995 1142.05 L812.995 1137.33 Q815.819 1136.19 818.273 1135.61 Q820.727 1135.03 822.764 1135.03 Q828.134 1135.03 831.329 1137.72 Q834.523 1140.4 834.523 1144.89 Q834.523 1147.02 833.713 1148.95 Q832.926 1150.84 830.819 1153.44 Q830.241 1154.11 827.139 1157.33 Q824.037 1160.52 818.389 1166.28 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip100)\" d=\"M985.808 1151.58 Q989.164 1152.3 991.039 1154.57 Q992.938 1156.84 992.938 1160.17 Q992.938 1165.29 989.419 1168.09 Q985.901 1170.89 979.419 1170.89 Q977.243 1170.89 974.928 1170.45 Q972.637 1170.03 970.183 1169.18 L970.183 1164.66 Q972.127 1165.8 974.442 1166.38 Q976.757 1166.95 979.28 1166.95 Q983.678 1166.95 985.97 1165.22 Q988.285 1163.48 988.285 1160.17 Q988.285 1157.12 986.132 1155.4 Q984.002 1153.67 980.183 1153.67 L976.155 1153.67 L976.155 1149.83 L980.368 1149.83 Q983.817 1149.83 985.646 1148.46 Q987.475 1147.07 987.475 1144.48 Q987.475 1141.82 985.576 1140.4 Q983.701 1138.97 980.183 1138.97 Q978.262 1138.97 976.063 1139.39 Q973.864 1139.8 971.225 1140.68 L971.225 1136.51 Q973.887 1135.77 976.202 1135.4 Q978.539 1135.03 980.6 1135.03 Q985.924 1135.03 989.026 1137.46 Q992.127 1139.87 992.127 1143.99 Q992.127 1146.86 990.484 1148.85 Q988.84 1150.82 985.808 1151.58 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip100)\" d=\"M1142.39 1139.73 L1130.59 1158.18 L1142.39 1158.18 L1142.39 1139.73 M1141.17 1135.66 L1147.05 1135.66 L1147.05 1158.18 L1151.98 1158.18 L1151.98 1162.07 L1147.05 1162.07 L1147.05 1170.22 L1142.39 1170.22 L1142.39 1162.07 L1126.79 1162.07 L1126.79 1157.56 L1141.17 1135.66 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip100)\" d=\"M1287.49 1135.66 L1305.84 1135.66 L1305.84 1139.59 L1291.77 1139.59 L1291.77 1148.07 Q1292.79 1147.72 1293.81 1147.56 Q1294.82 1147.37 1295.84 1147.37 Q1301.63 1147.37 1305.01 1150.54 Q1308.39 1153.71 1308.39 1159.13 Q1308.39 1164.71 1304.92 1167.81 Q1301.44 1170.89 1295.13 1170.89 Q1292.95 1170.89 1290.68 1170.52 Q1288.44 1170.15 1286.03 1169.41 L1286.03 1164.71 Q1288.11 1165.84 1290.33 1166.4 Q1292.56 1166.95 1295.03 1166.95 Q1299.04 1166.95 1301.38 1164.85 Q1303.71 1162.74 1303.71 1159.13 Q1303.71 1155.52 1301.38 1153.41 Q1299.04 1151.31 1295.03 1151.31 Q1293.16 1151.31 1291.28 1151.72 Q1289.43 1152.14 1287.49 1153.02 L1287.49 1135.66 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip100)\" d=\"M1455.44 1151.08 Q1452.29 1151.08 1450.44 1153.23 Q1448.61 1155.38 1448.61 1159.13 Q1448.61 1162.86 1450.44 1165.03 Q1452.29 1167.19 1455.44 1167.19 Q1458.59 1167.19 1460.42 1165.03 Q1462.27 1162.86 1462.27 1159.13 Q1462.27 1155.38 1460.42 1153.23 Q1458.59 1151.08 1455.44 1151.08 M1464.72 1136.42 L1464.72 1140.68 Q1462.96 1139.85 1461.16 1139.41 Q1459.37 1138.97 1457.61 1138.97 Q1452.98 1138.97 1450.53 1142.09 Q1448.1 1145.22 1447.75 1151.54 Q1449.12 1149.52 1451.18 1148.46 Q1453.24 1147.37 1455.72 1147.37 Q1460.92 1147.37 1463.93 1150.54 Q1466.97 1153.69 1466.97 1159.13 Q1466.97 1164.45 1463.82 1167.67 Q1460.67 1170.89 1455.44 1170.89 Q1449.44 1170.89 1446.27 1166.31 Q1443.1 1161.7 1443.1 1152.97 Q1443.1 1144.78 1446.99 1139.92 Q1450.88 1135.03 1457.43 1135.03 Q1459.19 1135.03 1460.97 1135.38 Q1462.78 1135.73 1464.72 1136.42 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><g clip-path=\"url(#clip100)\">\n<text style=\"fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:66px; text-anchor:middle;\" transform=\"rotate(0, 1060.47, 1252.42)\" x=\"1060.47\" y=\"1252.42\">column index</text>\n</g>\n<polyline clip-path=\"url(#clip100)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"642.238,107.256 642.238,1111.02 \"/>\n<polyline clip-path=\"url(#clip100)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"642.238,135.664 651.096,135.664 \"/>\n<polyline clip-path=\"url(#clip100)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"642.238,293.489 651.096,293.489 \"/>\n<polyline clip-path=\"url(#clip100)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"642.238,451.313 651.096,451.313 \"/>\n<polyline clip-path=\"url(#clip100)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"642.238,609.137 651.096,609.137 \"/>\n<polyline clip-path=\"url(#clip100)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"642.238,766.961 651.096,766.961 \"/>\n<polyline clip-path=\"url(#clip100)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"642.238,924.786 651.096,924.786 \"/>\n<polyline clip-path=\"url(#clip100)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"642.238,1082.61 651.096,1082.61 \"/>\n<path clip-path=\"url(#clip100)\" d=\"M592.331 149.009 L599.97 149.009 L599.97 122.643 L591.659 124.31 L591.659 120.051 L599.923 118.384 L604.599 118.384 L604.599 149.009 L612.238 149.009 L612.238 152.944 L592.331 152.944 L592.331 149.009 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip100)\" d=\"M595.919 306.833 L612.238 306.833 L612.238 310.769 L590.294 310.769 L590.294 306.833 Q592.956 304.079 597.539 299.449 Q602.145 294.796 603.326 293.454 Q605.571 290.931 606.451 289.195 Q607.354 287.435 607.354 285.746 Q607.354 282.991 605.409 281.255 Q603.488 279.519 600.386 279.519 Q598.187 279.519 595.733 280.283 Q593.303 281.047 590.525 282.597 L590.525 277.875 Q593.349 276.741 595.803 276.162 Q598.257 275.584 600.294 275.584 Q605.664 275.584 608.858 278.269 Q612.053 280.954 612.053 285.445 Q612.053 287.574 611.243 289.496 Q610.456 291.394 608.349 293.986 Q607.77 294.658 604.669 297.875 Q601.567 301.07 595.919 306.833 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip100)\" d=\"M605.108 449.959 Q608.465 450.676 610.34 452.945 Q612.238 455.213 612.238 458.547 Q612.238 463.662 608.72 466.463 Q605.201 469.264 598.72 469.264 Q596.544 469.264 594.229 468.824 Q591.937 468.408 589.484 467.551 L589.484 463.037 Q591.428 464.172 593.743 464.75 Q596.058 465.329 598.581 465.329 Q602.979 465.329 605.27 463.593 Q607.585 461.857 607.585 458.547 Q607.585 455.491 605.432 453.778 Q603.303 452.042 599.483 452.042 L595.456 452.042 L595.456 448.199 L599.669 448.199 Q603.118 448.199 604.946 446.834 Q606.775 445.445 606.775 442.852 Q606.775 440.19 604.877 438.778 Q603.002 437.343 599.483 437.343 Q597.562 437.343 595.363 437.76 Q593.164 438.176 590.525 439.056 L590.525 434.889 Q593.187 434.149 595.502 433.778 Q597.84 433.408 599.9 433.408 Q605.224 433.408 608.326 435.838 Q611.428 438.246 611.428 442.366 Q611.428 445.237 609.784 447.227 Q608.141 449.195 605.108 449.959 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip100)\" d=\"M602.655 595.931 L590.849 614.38 L602.655 614.38 L602.655 595.931 M601.428 591.857 L607.307 591.857 L607.307 614.38 L612.238 614.38 L612.238 618.269 L607.307 618.269 L607.307 626.417 L602.655 626.417 L602.655 618.269 L587.053 618.269 L587.053 613.755 L601.428 591.857 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip100)\" d=\"M591.335 749.681 L609.692 749.681 L609.692 753.617 L595.618 753.617 L595.618 762.089 Q596.636 761.742 597.655 761.58 Q598.673 761.394 599.692 761.394 Q605.479 761.394 608.858 764.566 Q612.238 767.737 612.238 773.154 Q612.238 778.732 608.766 781.834 Q605.294 784.913 598.974 784.913 Q596.798 784.913 594.53 784.542 Q592.284 784.172 589.877 783.431 L589.877 778.732 Q591.96 779.867 594.183 780.422 Q596.405 780.978 598.882 780.978 Q602.886 780.978 605.224 778.871 Q607.562 776.765 607.562 773.154 Q607.562 769.542 605.224 767.436 Q602.886 765.33 598.882 765.33 Q597.007 765.33 595.132 765.746 Q593.28 766.163 591.335 767.043 L591.335 749.681 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip100)\" d=\"M600.71 922.922 Q597.562 922.922 595.71 925.075 Q593.882 927.228 593.882 930.978 Q593.882 934.705 595.71 936.881 Q597.562 939.033 600.71 939.033 Q603.858 939.033 605.687 936.881 Q607.539 934.705 607.539 930.978 Q607.539 927.228 605.687 925.075 Q603.858 922.922 600.71 922.922 M609.993 908.27 L609.993 912.529 Q608.233 911.696 606.428 911.256 Q604.645 910.816 602.886 910.816 Q598.257 910.816 595.803 913.941 Q593.372 917.066 593.025 923.385 Q594.391 921.371 596.451 920.307 Q598.511 919.219 600.988 919.219 Q606.196 919.219 609.206 922.39 Q612.238 925.538 612.238 930.978 Q612.238 936.302 609.09 939.52 Q605.942 942.737 600.71 942.737 Q594.715 942.737 591.544 938.154 Q588.372 933.547 588.372 924.821 Q588.372 916.626 592.261 911.765 Q596.15 906.881 602.701 906.881 Q604.46 906.881 606.243 907.228 Q608.048 907.575 609.993 908.27 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip100)\" d=\"M590.016 1065.33 L612.238 1065.33 L612.238 1067.32 L599.692 1099.89 L594.808 1099.89 L606.613 1069.27 L590.016 1069.27 L590.016 1065.33 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><g clip-path=\"url(#clip100)\">\n<text style=\"fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:66px; text-anchor:middle;\" transform=\"rotate(-90, 545.491, 609.137)\" x=\"545.491\" y=\"609.137\">row index</text>\n</g>\n<g clip-path=\"url(#clip100)\">\n<text style=\"fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:66px; text-anchor:middle;\" transform=\"rotate(0, 1060.47, 57.6)\" x=\"1060.47\" y=\"57.6\">Boundary points</text>\n</g>\n<circle clip-path=\"url(#clip102)\" cx=\"665.912\" cy=\"135.664\" r=\"10.8\" fill=\"#00008b\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"none\"/>\n<circle clip-path=\"url(#clip102)\" cx=\"665.912\" cy=\"293.489\" r=\"10.8\" fill=\"#00008b\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"none\"/>\n<circle clip-path=\"url(#clip102)\" cx=\"665.912\" cy=\"451.313\" r=\"10.8\" fill=\"#00008b\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"none\"/>\n<circle clip-path=\"url(#clip102)\" cx=\"665.912\" cy=\"609.137\" r=\"10.8\" fill=\"#00008b\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"none\"/>\n<circle clip-path=\"url(#clip102)\" cx=\"665.912\" cy=\"766.961\" r=\"10.8\" fill=\"#00008b\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"none\"/>\n<circle clip-path=\"url(#clip102)\" cx=\"665.912\" cy=\"924.786\" r=\"10.8\" fill=\"#00008b\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"none\"/>\n<circle clip-path=\"url(#clip102)\" cx=\"665.912\" cy=\"1082.61\" r=\"10.8\" fill=\"#00008b\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"none\"/>\n<circle clip-path=\"url(#clip102)\" cx=\"823.736\" cy=\"135.664\" r=\"10.8\" fill=\"#00008b\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"none\"/>\n<circle clip-path=\"url(#clip102)\" cx=\"823.736\" cy=\"1082.61\" r=\"10.8\" fill=\"#00008b\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"none\"/>\n<circle clip-path=\"url(#clip102)\" cx=\"981.56\" cy=\"135.664\" r=\"10.8\" fill=\"#00008b\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"none\"/>\n<circle clip-path=\"url(#clip102)\" cx=\"981.56\" cy=\"1082.61\" r=\"10.8\" fill=\"#00008b\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"none\"/>\n<circle clip-path=\"url(#clip102)\" cx=\"1139.38\" cy=\"135.664\" r=\"10.8\" fill=\"#00008b\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"none\"/>\n<circle clip-path=\"url(#clip102)\" cx=\"1139.38\" cy=\"1082.61\" r=\"10.8\" fill=\"#00008b\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"none\"/>\n<circle clip-path=\"url(#clip102)\" cx=\"1297.21\" cy=\"135.664\" r=\"10.8\" fill=\"#00008b\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"none\"/>\n<circle clip-path=\"url(#clip102)\" cx=\"1297.21\" cy=\"1082.61\" r=\"10.8\" fill=\"#00008b\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"none\"/>\n<circle clip-path=\"url(#clip102)\" cx=\"1455.03\" cy=\"135.664\" r=\"10.8\" fill=\"#00008b\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"none\"/>\n<circle clip-path=\"url(#clip102)\" cx=\"1455.03\" cy=\"293.489\" r=\"10.8\" fill=\"#00008b\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"none\"/>\n<circle clip-path=\"url(#clip102)\" cx=\"1455.03\" cy=\"451.313\" r=\"10.8\" fill=\"#00008b\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"none\"/>\n<circle clip-path=\"url(#clip102)\" cx=\"1455.03\" cy=\"609.137\" r=\"10.8\" fill=\"#00008b\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"none\"/>\n<circle clip-path=\"url(#clip102)\" cx=\"1455.03\" cy=\"766.961\" r=\"10.8\" fill=\"#00008b\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"none\"/>\n<circle clip-path=\"url(#clip102)\" cx=\"1455.03\" cy=\"924.786\" r=\"10.8\" fill=\"#00008b\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"none\"/>\n<circle clip-path=\"url(#clip102)\" cx=\"1455.03\" cy=\"1082.61\" r=\"10.8\" fill=\"#00008b\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"none\"/>\n</svg>\n","content_type":"text/html"},"image/svg+xml":{"content":"<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" width=\"500\" height=\"320\" viewBox=\"0 0 2000 1280\">\n<defs>\n  <clipPath id=\"clip050\">\n    <rect x=\"0\" y=\"0\" width=\"2000\" height=\"1280\"/>\n  </clipPath>\n</defs>\n<path clip-path=\"url(#clip050)\" d=\"M0 1280 L2000 1280 L2000 0 L0 0  Z\" fill=\"#ffffff\" fill-rule=\"evenodd\" fill-opacity=\"1\"/>\n<defs>\n  <clipPath id=\"clip051\">\n    <rect x=\"400\" y=\"0\" width=\"1401\" height=\"1280\"/>\n  </clipPath>\n</defs>\n<path clip-path=\"url(#clip050)\" d=\"M642.238 1111.02 L1478.71 1111.02 L1478.71 107.256 L642.238 107.256  Z\" fill=\"#ffffff\" fill-rule=\"evenodd\" fill-opacity=\"1\"/>\n<defs>\n  <clipPath id=\"clip052\">\n    <rect x=\"642\" y=\"107\" width=\"837\" height=\"1005\"/>\n  </clipPath>\n</defs>\n<polyline clip-path=\"url(#clip050)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"642.238,1111.02 1478.71,1111.02 \"/>\n<polyline clip-path=\"url(#clip050)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"665.912,1111.02 665.912,1092.12 \"/>\n<polyline clip-path=\"url(#clip050)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"823.736,1111.02 823.736,1092.12 \"/>\n<polyline clip-path=\"url(#clip050)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"981.56,1111.02 981.56,1092.12 \"/>\n<polyline clip-path=\"url(#clip050)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"1139.38,1111.02 1139.38,1092.12 \"/>\n<polyline clip-path=\"url(#clip050)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"1297.21,1111.02 1297.21,1092.12 \"/>\n<polyline clip-path=\"url(#clip050)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"1455.03,1111.02 1455.03,1092.12 \"/>\n<path clip-path=\"url(#clip050)\" d=\"M656.294 1166.28 L663.933 1166.28 L663.933 1139.92 L655.622 1141.58 L655.622 1137.33 L663.886 1135.66 L668.562 1135.66 L668.562 1166.28 L676.201 1166.28 L676.201 1170.22 L656.294 1170.22 L656.294 1166.28 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip050)\" d=\"M818.389 1166.28 L834.708 1166.28 L834.708 1170.22 L812.764 1170.22 L812.764 1166.28 Q815.426 1163.53 820.009 1158.9 Q824.616 1154.25 825.796 1152.9 Q828.042 1150.38 828.921 1148.64 Q829.824 1146.89 829.824 1145.2 Q829.824 1142.44 827.879 1140.7 Q825.958 1138.97 822.856 1138.97 Q820.657 1138.97 818.204 1139.73 Q815.773 1140.5 812.995 1142.05 L812.995 1137.33 Q815.819 1136.19 818.273 1135.61 Q820.727 1135.03 822.764 1135.03 Q828.134 1135.03 831.329 1137.72 Q834.523 1140.4 834.523 1144.89 Q834.523 1147.02 833.713 1148.95 Q832.926 1150.84 830.819 1153.44 Q830.241 1154.11 827.139 1157.33 Q824.037 1160.52 818.389 1166.28 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip050)\" d=\"M985.808 1151.58 Q989.164 1152.3 991.039 1154.57 Q992.938 1156.84 992.938 1160.17 Q992.938 1165.29 989.419 1168.09 Q985.901 1170.89 979.419 1170.89 Q977.243 1170.89 974.928 1170.45 Q972.637 1170.03 970.183 1169.18 L970.183 1164.66 Q972.127 1165.8 974.442 1166.38 Q976.757 1166.95 979.28 1166.95 Q983.678 1166.95 985.97 1165.22 Q988.285 1163.48 988.285 1160.17 Q988.285 1157.12 986.132 1155.4 Q984.002 1153.67 980.183 1153.67 L976.155 1153.67 L976.155 1149.83 L980.368 1149.83 Q983.817 1149.83 985.646 1148.46 Q987.475 1147.07 987.475 1144.48 Q987.475 1141.82 985.576 1140.4 Q983.701 1138.97 980.183 1138.97 Q978.262 1138.97 976.063 1139.39 Q973.864 1139.8 971.225 1140.68 L971.225 1136.51 Q973.887 1135.77 976.202 1135.4 Q978.539 1135.03 980.6 1135.03 Q985.924 1135.03 989.026 1137.46 Q992.127 1139.87 992.127 1143.99 Q992.127 1146.86 990.484 1148.85 Q988.84 1150.82 985.808 1151.58 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip050)\" d=\"M1142.39 1139.73 L1130.59 1158.18 L1142.39 1158.18 L1142.39 1139.73 M1141.17 1135.66 L1147.05 1135.66 L1147.05 1158.18 L1151.98 1158.18 L1151.98 1162.07 L1147.05 1162.07 L1147.05 1170.22 L1142.39 1170.22 L1142.39 1162.07 L1126.79 1162.07 L1126.79 1157.56 L1141.17 1135.66 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip050)\" d=\"M1287.49 1135.66 L1305.84 1135.66 L1305.84 1139.59 L1291.77 1139.59 L1291.77 1148.07 Q1292.79 1147.72 1293.81 1147.56 Q1294.82 1147.37 1295.84 1147.37 Q1301.63 1147.37 1305.01 1150.54 Q1308.39 1153.71 1308.39 1159.13 Q1308.39 1164.71 1304.92 1167.81 Q1301.44 1170.89 1295.13 1170.89 Q1292.95 1170.89 1290.68 1170.52 Q1288.44 1170.15 1286.03 1169.41 L1286.03 1164.71 Q1288.11 1165.84 1290.33 1166.4 Q1292.56 1166.95 1295.03 1166.95 Q1299.04 1166.95 1301.38 1164.85 Q1303.71 1162.74 1303.71 1159.13 Q1303.71 1155.52 1301.38 1153.41 Q1299.04 1151.31 1295.03 1151.31 Q1293.16 1151.31 1291.28 1151.72 Q1289.43 1152.14 1287.49 1153.02 L1287.49 1135.66 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip050)\" d=\"M1455.44 1151.08 Q1452.29 1151.08 1450.44 1153.23 Q1448.61 1155.38 1448.61 1159.13 Q1448.61 1162.86 1450.44 1165.03 Q1452.29 1167.19 1455.44 1167.19 Q1458.59 1167.19 1460.42 1165.03 Q1462.27 1162.86 1462.27 1159.13 Q1462.27 1155.38 1460.42 1153.23 Q1458.59 1151.08 1455.44 1151.08 M1464.72 1136.42 L1464.72 1140.68 Q1462.96 1139.85 1461.16 1139.41 Q1459.37 1138.97 1457.61 1138.97 Q1452.98 1138.97 1450.53 1142.09 Q1448.1 1145.22 1447.75 1151.54 Q1449.12 1149.52 1451.18 1148.46 Q1453.24 1147.37 1455.72 1147.37 Q1460.92 1147.37 1463.93 1150.54 Q1466.97 1153.69 1466.97 1159.13 Q1466.97 1164.45 1463.82 1167.67 Q1460.67 1170.89 1455.44 1170.89 Q1449.44 1170.89 1446.27 1166.31 Q1443.1 1161.7 1443.1 1152.97 Q1443.1 1144.78 1446.99 1139.92 Q1450.88 1135.03 1457.43 1135.03 Q1459.19 1135.03 1460.97 1135.38 Q1462.78 1135.73 1464.72 1136.42 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><g clip-path=\"url(#clip050)\">\n<text style=\"fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:66px; text-anchor:middle;\" transform=\"rotate(0, 1060.47, 1252.42)\" x=\"1060.47\" y=\"1252.42\">column index</text>\n</g>\n<polyline clip-path=\"url(#clip050)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"642.238,107.256 642.238,1111.02 \"/>\n<polyline clip-path=\"url(#clip050)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"642.238,135.664 651.096,135.664 \"/>\n<polyline clip-path=\"url(#clip050)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"642.238,293.489 651.096,293.489 \"/>\n<polyline clip-path=\"url(#clip050)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"642.238,451.313 651.096,451.313 \"/>\n<polyline clip-path=\"url(#clip050)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"642.238,609.137 651.096,609.137 \"/>\n<polyline clip-path=\"url(#clip050)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"642.238,766.961 651.096,766.961 \"/>\n<polyline clip-path=\"url(#clip050)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"642.238,924.786 651.096,924.786 \"/>\n<polyline clip-path=\"url(#clip050)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"642.238,1082.61 651.096,1082.61 \"/>\n<path clip-path=\"url(#clip050)\" d=\"M592.331 149.009 L599.97 149.009 L599.97 122.643 L591.659 124.31 L591.659 120.051 L599.923 118.384 L604.599 118.384 L604.599 149.009 L612.238 149.009 L612.238 152.944 L592.331 152.944 L592.331 149.009 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip050)\" d=\"M595.919 306.833 L612.238 306.833 L612.238 310.769 L590.294 310.769 L590.294 306.833 Q592.956 304.079 597.539 299.449 Q602.145 294.796 603.326 293.454 Q605.571 290.931 606.451 289.195 Q607.354 287.435 607.354 285.746 Q607.354 282.991 605.409 281.255 Q603.488 279.519 600.386 279.519 Q598.187 279.519 595.733 280.283 Q593.303 281.047 590.525 282.597 L590.525 277.875 Q593.349 276.741 595.803 276.162 Q598.257 275.584 600.294 275.584 Q605.664 275.584 608.858 278.269 Q612.053 280.954 612.053 285.445 Q612.053 287.574 611.243 289.496 Q610.456 291.394 608.349 293.986 Q607.77 294.658 604.669 297.875 Q601.567 301.07 595.919 306.833 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip050)\" d=\"M605.108 449.959 Q608.465 450.676 610.34 452.945 Q612.238 455.213 612.238 458.547 Q612.238 463.662 608.72 466.463 Q605.201 469.264 598.72 469.264 Q596.544 469.264 594.229 468.824 Q591.937 468.408 589.484 467.551 L589.484 463.037 Q591.428 464.172 593.743 464.75 Q596.058 465.329 598.581 465.329 Q602.979 465.329 605.27 463.593 Q607.585 461.857 607.585 458.547 Q607.585 455.491 605.432 453.778 Q603.303 452.042 599.483 452.042 L595.456 452.042 L595.456 448.199 L599.669 448.199 Q603.118 448.199 604.946 446.834 Q606.775 445.445 606.775 442.852 Q606.775 440.19 604.877 438.778 Q603.002 437.343 599.483 437.343 Q597.562 437.343 595.363 437.76 Q593.164 438.176 590.525 439.056 L590.525 434.889 Q593.187 434.149 595.502 433.778 Q597.84 433.408 599.9 433.408 Q605.224 433.408 608.326 435.838 Q611.428 438.246 611.428 442.366 Q611.428 445.237 609.784 447.227 Q608.141 449.195 605.108 449.959 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip050)\" d=\"M602.655 595.931 L590.849 614.38 L602.655 614.38 L602.655 595.931 M601.428 591.857 L607.307 591.857 L607.307 614.38 L612.238 614.38 L612.238 618.269 L607.307 618.269 L607.307 626.417 L602.655 626.417 L602.655 618.269 L587.053 618.269 L587.053 613.755 L601.428 591.857 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip050)\" d=\"M591.335 749.681 L609.692 749.681 L609.692 753.617 L595.618 753.617 L595.618 762.089 Q596.636 761.742 597.655 761.58 Q598.673 761.394 599.692 761.394 Q605.479 761.394 608.858 764.566 Q612.238 767.737 612.238 773.154 Q612.238 778.732 608.766 781.834 Q605.294 784.913 598.974 784.913 Q596.798 784.913 594.53 784.542 Q592.284 784.172 589.877 783.431 L589.877 778.732 Q591.96 779.867 594.183 780.422 Q596.405 780.978 598.882 780.978 Q602.886 780.978 605.224 778.871 Q607.562 776.765 607.562 773.154 Q607.562 769.542 605.224 767.436 Q602.886 765.33 598.882 765.33 Q597.007 765.33 595.132 765.746 Q593.28 766.163 591.335 767.043 L591.335 749.681 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip050)\" d=\"M600.71 922.922 Q597.562 922.922 595.71 925.075 Q593.882 927.228 593.882 930.978 Q593.882 934.705 595.71 936.881 Q597.562 939.033 600.71 939.033 Q603.858 939.033 605.687 936.881 Q607.539 934.705 607.539 930.978 Q607.539 927.228 605.687 925.075 Q603.858 922.922 600.71 922.922 M609.993 908.27 L609.993 912.529 Q608.233 911.696 606.428 911.256 Q604.645 910.816 602.886 910.816 Q598.257 910.816 595.803 913.941 Q593.372 917.066 593.025 923.385 Q594.391 921.371 596.451 920.307 Q598.511 919.219 600.988 919.219 Q606.196 919.219 609.206 922.39 Q612.238 925.538 612.238 930.978 Q612.238 936.302 609.09 939.52 Q605.942 942.737 600.71 942.737 Q594.715 942.737 591.544 938.154 Q588.372 933.547 588.372 924.821 Q588.372 916.626 592.261 911.765 Q596.15 906.881 602.701 906.881 Q604.46 906.881 606.243 907.228 Q608.048 907.575 609.993 908.27 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip050)\" d=\"M590.016 1065.33 L612.238 1065.33 L612.238 1067.32 L599.692 1099.89 L594.808 1099.89 L606.613 1069.27 L590.016 1069.27 L590.016 1065.33 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><g clip-path=\"url(#clip050)\">\n<text style=\"fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:66px; text-anchor:middle;\" transform=\"rotate(-90, 545.491, 609.137)\" x=\"545.491\" y=\"609.137\">row index</text>\n</g>\n<g clip-path=\"url(#clip050)\">\n<text style=\"fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:66px; text-anchor:middle;\" transform=\"rotate(0, 1060.47, 57.6)\" x=\"1060.47\" y=\"57.6\">Boundary points</text>\n</g>\n<circle clip-path=\"url(#clip052)\" cx=\"665.912\" cy=\"135.664\" r=\"10.8\" fill=\"#00008b\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"none\"/>\n<circle clip-path=\"url(#clip052)\" cx=\"665.912\" cy=\"293.489\" r=\"10.8\" fill=\"#00008b\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"none\"/>\n<circle clip-path=\"url(#clip052)\" cx=\"665.912\" cy=\"451.313\" r=\"10.8\" fill=\"#00008b\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"none\"/>\n<circle clip-path=\"url(#clip052)\" cx=\"665.912\" cy=\"609.137\" r=\"10.8\" fill=\"#00008b\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"none\"/>\n<circle clip-path=\"url(#clip052)\" cx=\"665.912\" cy=\"766.961\" r=\"10.8\" fill=\"#00008b\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"none\"/>\n<circle clip-path=\"url(#clip052)\" cx=\"665.912\" cy=\"924.786\" r=\"10.8\" fill=\"#00008b\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"none\"/>\n<circle clip-path=\"url(#clip052)\" cx=\"665.912\" cy=\"1082.61\" r=\"10.8\" fill=\"#00008b\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"none\"/>\n<circle clip-path=\"url(#clip052)\" cx=\"823.736\" cy=\"135.664\" r=\"10.8\" fill=\"#00008b\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"none\"/>\n<circle clip-path=\"url(#clip052)\" cx=\"823.736\" cy=\"1082.61\" r=\"10.8\" fill=\"#00008b\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"none\"/>\n<circle clip-path=\"url(#clip052)\" cx=\"981.56\" cy=\"135.664\" r=\"10.8\" fill=\"#00008b\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"none\"/>\n<circle clip-path=\"url(#clip052)\" cx=\"981.56\" cy=\"1082.61\" r=\"10.8\" fill=\"#00008b\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"none\"/>\n<circle clip-path=\"url(#clip052)\" cx=\"1139.38\" cy=\"135.664\" r=\"10.8\" fill=\"#00008b\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"none\"/>\n<circle clip-path=\"url(#clip052)\" cx=\"1139.38\" cy=\"1082.61\" r=\"10.8\" fill=\"#00008b\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"none\"/>\n<circle clip-path=\"url(#clip052)\" cx=\"1297.21\" cy=\"135.664\" r=\"10.8\" fill=\"#00008b\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"none\"/>\n<circle clip-path=\"url(#clip052)\" cx=\"1297.21\" cy=\"1082.61\" r=\"10.8\" fill=\"#00008b\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"none\"/>\n<circle clip-path=\"url(#clip052)\" cx=\"1455.03\" cy=\"135.664\" r=\"10.8\" fill=\"#00008b\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"none\"/>\n<circle clip-path=\"url(#clip052)\" cx=\"1455.03\" cy=\"293.489\" r=\"10.8\" fill=\"#00008b\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"none\"/>\n<circle clip-path=\"url(#clip052)\" cx=\"1455.03\" cy=\"451.313\" r=\"10.8\" fill=\"#00008b\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"none\"/>\n<circle clip-path=\"url(#clip052)\" cx=\"1455.03\" cy=\"609.137\" r=\"10.8\" fill=\"#00008b\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"none\"/>\n<circle clip-path=\"url(#clip052)\" cx=\"1455.03\" cy=\"766.961\" r=\"10.8\" fill=\"#00008b\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"none\"/>\n<circle clip-path=\"url(#clip052)\" cx=\"1455.03\" cy=\"924.786\" r=\"10.8\" fill=\"#00008b\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"none\"/>\n<circle clip-path=\"url(#clip052)\" cx=\"1455.03\" cy=\"1082.61\" r=\"10.8\" fill=\"#00008b\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"none\"/>\n</svg>\n","content_type":"image/svg+xml"}}}],"key":"v1n1TMIm3y"}],"key":"dv0oaiRKX6"},{"type":"paragraph","position":{"start":{"line":498,"column":1},"end":{"line":498,"column":1}},"children":[{"type":"text","value":"In order to impose Dirichlet boundary conditions, we use the boundary indicator to index into the rows of the system.","position":{"start":{"line":498,"column":1},"end":{"line":498,"column":1}},"key":"VzJ39pF19L"}],"key":"RHLsSudFdW"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"I_N = I(N)\nidx = vec(is_boundary)\nA[idx, :] .= I_N[idx, :];     # Dirichlet conditions\n\nspy(A;\n    color=:blues,  m=3, title=\"System matrix with boundary modifications\")","key":"kpXGa5go2Y"},{"type":"output","id":"wCxDztu2OE0cUDyoAh03d","data":[{"output_type":"execute_result","execution_count":37,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"7f90d92c09dad69424c452054ae776dd","path":"/build/7f90d92c09dad69424c452054ae776dd.png"},"text/html":{"content_type":"text/html","hash":"ee07e4c353977b74a41610bd4b8ebf37","path":"/build/ee07e4c353977b74a41610bd4b8ebf37.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"af850da1c3ea463648c2444ba5c21800","path":"/build/af850da1c3ea463648c2444ba5c21800.svg"}}}],"key":"cXCjSeyp8m"}],"key":"PS91xtUXAz"},{"type":"paragraph","position":{"start":{"line":509,"column":1},"end":{"line":509,"column":1}},"children":[{"type":"text","value":"Next, we evaluate ","position":{"start":{"line":509,"column":1},"end":{"line":509,"column":1}},"key":"EuP4V9mCAP"},{"type":"text","value":"ϕ","position":{"start":{"line":509,"column":1},"end":{"line":509,"column":1}},"key":"BG1YPk3f9Q"},{"type":"text","value":" on the grid to get the forcing vector of the linear system, and then modify the boundary rows to hold the boundary values—in this case, zero.","position":{"start":{"line":509,"column":1},"end":{"line":509,"column":1}},"key":"jnZtFKCHAb"}],"key":"yFqFq9XGzG"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"ϕ = (x, y) -> x^2 - y + 2\nb = vec(mtx(ϕ));\nb[idx] .= 0;    # Dirichlet values","key":"VjZ2TcLn4t"},{"type":"output","id":"guUEwrpBX8jCpsCBtF-dV","data":[],"key":"BBJFcOD0xR"}],"key":"cFDdeTDfHx"},{"type":"paragraph","position":{"start":{"line":517,"column":1},"end":{"line":517,"column":1}},"children":[{"type":"text","value":"Now we can solve the linear system ","position":{"start":{"line":517,"column":1},"end":{"line":517,"column":1}},"key":"lWH4gocMvV"},{"type":"inlineMath","value":"\\mathbf{A}\\mathbf{u}=\\mathbf{b}","position":{"start":{"line":517,"column":1},"end":{"line":517,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi><mi mathvariant=\"bold\">u</mi><mo>=</mo><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}\\mathbf{u}=\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">Au</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"FReQAxZLd2"},{"type":"text","value":" for ","position":{"start":{"line":517,"column":1},"end":{"line":517,"column":1}},"key":"jIUNqo6S8i"},{"type":"inlineMath","value":"\\mathbf{u}","position":{"start":{"line":517,"column":1},"end":{"line":517,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">u</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{u}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4444em;\"></span><span class=\"mord mathbf\">u</span></span></span></span>","key":"RFmkHxjiYn"},{"type":"text","value":" and reinterpret it as the matrix-shaped ","position":{"start":{"line":517,"column":1},"end":{"line":517,"column":1}},"key":"l2uwzUBxgl"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":517,"column":1},"end":{"line":517,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"fPrO3w2499"},{"type":"text","value":", the solution on our grid.","position":{"start":{"line":517,"column":1},"end":{"line":517,"column":1}},"key":"cY6QfwltzB"}],"key":"ysvOFqMoeV"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"u = A \\ b\nU = unvec(u)","key":"diPERPPbPk"},{"type":"output","id":"NflsA63wU_PlNwN-Jd7dG","data":[{"output_type":"execute_result","execution_count":39,"metadata":{},"data":{"text/plain":{"content":"7×6 Matrix{Float64}:\n 0.0   0.0        0.0        0.0        0.0       0.0\n 0.0  -0.549304  -0.758277  -0.712098  -0.453391  0.0\n 0.0  -0.917873  -1.30273   -1.24377   -0.798473  0.0\n 0.0  -1.21928   -1.74064   -1.67911   -1.09539   0.0\n 0.0  -1.39869   -1.97682   -1.91786   -1.27929   0.0\n 0.0  -1.21024   -1.65843   -1.61225   -1.11433   0.0\n 0.0   0.0        0.0        0.0        0.0       0.0","content_type":"text/plain"}}}],"key":"GvA8qihND4"}],"key":"Xc6FLCspjf"}],"label":"demo-laplace-fd-julia","identifier":"demo-laplace-fd-julia","html_id":"demo-laplace-fd-julia","key":"zf92YOghEv"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-laplace-poisson","label":"demo-laplace-poisson","kind":"proof:example","position":{"start":{"line":526,"column":1},"end":{"line":526,"column":22}},"children":[{"type":"text","value":"Example ","key":"qSzFVNlqv3"},{"type":"text","value":"13.3.3","key":"PM8O5IyFtk"}],"template":"Example %s","enumerator":"13.3.3","resolved":true,"html_id":"demo-laplace-poisson","remote":true,"url":"/laplace","dataUrl":"/laplace.json","key":"bBDH3r5Y9l"}],"key":"et61yKFT7b"},{"type":"paragraph","position":{"start":{"line":529,"column":1},"end":{"line":529,"column":1}},"children":[{"type":"text","value":"First we define the problem on ","position":{"start":{"line":529,"column":1},"end":{"line":529,"column":1}},"key":"q9pFDtgimH"},{"type":"inlineMath","value":"[0,1]\\times[0,2]","position":{"start":{"line":529,"column":1},"end":{"line":529,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mn>0</mn><mo separator=\"true\">,</mo><mn>1</mn><mo stretchy=\"false\">]</mo><mo>×</mo><mo stretchy=\"false\">[</mo><mn>0</mn><mo separator=\"true\">,</mo><mn>2</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[0,1]\\times[0,2]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">2</span><span class=\"mclose\">]</span></span></span></span>","key":"EY41NlF0pX"},{"type":"text","value":".","position":{"start":{"line":529,"column":1},"end":{"line":529,"column":1}},"key":"XHTfNdCQhS"}],"key":"Km2WtGLTZG"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"f = (x, y) -> -sin(3x * y - 4y) * (9y^2 + (3x - 4)^2);\ng = (x, y) -> sin(3x * y - 4y);\nxspan = [0, 1];\nyspan = [0, 2];","key":"IBAlfju6LX"},{"type":"output","id":"jDMuhj9D_xFaCDU3TPg3r","data":[],"key":"z5tXQV8smM"}],"key":"oeGYfmrmuO"},{"type":"paragraph","position":{"start":{"line":538,"column":1},"end":{"line":538,"column":1}},"children":[{"type":"text","value":"Here is the finite-difference solution.","position":{"start":{"line":538,"column":1},"end":{"line":538,"column":1}},"key":"yyDg1D64hp"}],"key":"ueoWY7zDsf"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"x, y, U = FNC.poissonfd(f, g, 40, xspan, 60, yspan);","key":"JD3KEFK7Km"},{"type":"output","id":"uuCSZk_jdqniwlt1DlUA0","data":[],"key":"sXdw5Hd0iN"}],"key":"X6yHplVNrW"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"surface(x, y, U';\n    color=:viridis,\n    title=\"Solution of Poisson's equation\",\n    xaxis=(L\"x\"),  yaxis=(L\"y\"),  zaxis=(L\"u(x,y)\"),\n    right_margin=3Plots.mm,  camera=(70, 50))","key":"I51Qlu7Rnb"},{"type":"output","id":"RQY_mW7gHvImFZuLx7ZDQ","data":[{"output_type":"execute_result","execution_count":42,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"41939ba4e04d67101adc635a81c73f1e","path":"/build/41939ba4e04d67101adc635a81c73f1e.png"},"text/html":{"content_type":"text/html","hash":"d7726d40c5c3b2dd5b0ad287408e3b9c","path":"/build/d7726d40c5c3b2dd5b0ad287408e3b9c.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"23e96d7df1052311697ac76c944fb131","path":"/build/23e96d7df1052311697ac76c944fb131.svg"}}}],"key":"DLKIOA4jU1"}],"key":"ucsHGAN6Ch"},{"type":"paragraph","position":{"start":{"line":552,"column":1},"end":{"line":552,"column":1}},"children":[{"type":"text","value":"The error is a smooth function of ","position":{"start":{"line":552,"column":1},"end":{"line":552,"column":1}},"key":"eACPyFhPXS"},{"type":"inlineMath","value":"x","position":{"start":{"line":552,"column":1},"end":{"line":552,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"QB7xnzw38v"},{"type":"text","value":" and ","position":{"start":{"line":552,"column":1},"end":{"line":552,"column":1}},"key":"mG4176VgLg"},{"type":"inlineMath","value":"y","position":{"start":{"line":552,"column":1},"end":{"line":552,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>","key":"ghBpXVvNVs"},{"type":"text","value":". It must be zero on the boundary; otherwise, we have implemented boundary conditions incorrectly.","position":{"start":{"line":552,"column":1},"end":{"line":552,"column":1}},"key":"X6D6ugG5GJ"}],"key":"ZcpBWQbXhV"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"error = [g(x, y) for x in x, y in y] - U;\nM = maximum(abs, error)\ncontour(x, y, error';\n    levels=17, \n    clims=(-M, M), color=:redsblues, \n    colorbar=:bottom,  aspect_ratio=1,\n    title=\"Error\", \n    xaxis=(L\"x\"),  yaxis=(L\"y\"),\n    right_margin=7Plots.mm)\nplot!([0, 1, 1, 0, 0], [0, 0, 2, 2, 0], l=(2, :black))","key":"bQcJzJmDDn"},{"type":"output","id":"E1NSzymDsus9I0W8jIy1j","data":[{"output_type":"execute_result","execution_count":43,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"50f276e1002ebad1c386d0f0d29923a8","path":"/build/50f276e1002ebad1c386d0f0d29923a8.png"},"text/html":{"content_type":"text/html","hash":"8232c29ca0b15d6d56973e2428620d64","path":"/build/8232c29ca0b15d6d56973e2428620d64.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"08171e47c03f319e481c86d261428e90","path":"/build/08171e47c03f319e481c86d261428e90.svg"}}}],"key":"vqBVQaIyK9"}],"key":"JgJqQAAlLX"}],"label":"demo-laplace-poisson-julia","identifier":"demo-laplace-poisson-julia","html_id":"demo-laplace-poisson-julia","key":"WkhedGTolG"},{"type":"heading","depth":3,"position":{"start":{"line":568,"column":1},"end":{"line":568,"column":1}},"children":[{"type":"text","value":"13.4 ","position":{"start":{"line":568,"column":1},"end":{"line":568,"column":1}},"key":"TShzYjdjYP"},{"type":"link","identifier":"section-twodim-nonlinear","label":"section-twodim-nonlinear","kind":"narrative","position":{"start":{"line":568,"column":6},"end":{"line":568,"column":31}},"url":"/nonlinear-1","internal":true,"dataUrl":"/nonlinear-1.json","children":[{"type":"text","value":"Nonlinear elliptic PDEs","key":"uLKNp27ilx"}],"key":"bdH4TOrXB0"}],"identifier":"id-13-4","label":"13.4 ","html_id":"id-13-4","implicit":true,"key":"fSuVrDdcNA"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-nonlinear2d-mems","label":"demo-nonlinear2d-mems","kind":"proof:example","position":{"start":{"line":571,"column":1},"end":{"line":571,"column":23}},"children":[{"type":"text","value":"Example ","key":"bsqwQ9sSfy"},{"type":"text","value":"13.4.2","key":"E0eqpFfs8h"}],"template":"Example %s","enumerator":"13.4.2","resolved":true,"html_id":"demo-nonlinear2d-mems","remote":true,"url":"/nonlinear-1","dataUrl":"/nonlinear-1.json","key":"INl7uiisGg"}],"key":"J4iCrAGgXv"},{"type":"paragraph","position":{"start":{"line":573,"column":1},"end":{"line":573,"column":1}},"children":[{"type":"text","value":"All we need to define are ","position":{"start":{"line":573,"column":1},"end":{"line":573,"column":1}},"key":"wl3ppY1LkL"},{"type":"text","value":"ϕ","position":{"start":{"line":573,"column":1},"end":{"line":573,"column":1}},"key":"yWhGkrvR0A"},{"type":"text","value":" from ","position":{"start":{"line":573,"column":1},"end":{"line":573,"column":1}},"key":"heW2oTWD6p"},{"type":"crossReference","kind":"equation","identifier":"nonlinpdepde","label":"nonlinpdepde","children":[{"type":"text","value":"(","key":"mKDWoTAI5r"},{"type":"text","value":"13.4.2","key":"O6tgdqZsk4"},{"type":"text","value":")","key":"m4tTpmGwGT"}],"template":"(%s)","enumerator":"13.4.2","resolved":true,"html_id":"nonlinpdepde","remote":true,"url":"/nonlinear-1","dataUrl":"/nonlinear-1.json","key":"u3wAUAgs3K"},{"type":"text","value":" for the ","key":"CFCDTkT45m"},{"type":"abbreviation","title":"partial differential equation","children":[{"type":"text","value":"PDE","key":"QtofPolBaV"}],"key":"NZyhSDuBPv"},{"type":"text","value":", and a trivial zero function for the boundary condition.","key":"sXWu7K6fjr"}],"key":"Nph8Jp9aIO"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"λ = 1.5\nϕ = (X, Y, U, Ux, Uxx, Uy, Uyy) -> @. Uxx + Uyy - λ / (U + 1)^2;\ng = (x, y) -> 0;","key":"Ie1I32mC09"},{"type":"output","id":"TQKVnwaQIuK7QGK5_vwWV","data":[],"key":"IPUU9pmGLu"}],"key":"IUdmP6nYmp"},{"type":"paragraph","position":{"start":{"line":581,"column":1},"end":{"line":581,"column":1}},"children":[{"type":"text","value":"Here is the solution for ","position":{"start":{"line":581,"column":1},"end":{"line":581,"column":1}},"key":"shI4B6eKSS"},{"type":"inlineMath","value":"m=15","position":{"start":{"line":581,"column":1},"end":{"line":581,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi><mo>=</mo><mn>15</mn></mrow><annotation encoding=\"application/x-tex\">m=15</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">15</span></span></span></span>","key":"hlR0wX4a0w"},{"type":"text","value":", ","position":{"start":{"line":581,"column":1},"end":{"line":581,"column":1}},"key":"HYMGmUgQ4y"},{"type":"inlineMath","value":"n=8","position":{"start":{"line":581,"column":1},"end":{"line":581,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>=</mo><mn>8</mn></mrow><annotation encoding=\"application/x-tex\">n=8</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">8</span></span></span></span>","key":"mLGpjWlEVR"},{"type":"text","value":".","position":{"start":{"line":581,"column":1},"end":{"line":581,"column":1}},"key":"CZdLYggZZJ"}],"key":"mAZ1GOVluV"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"u = FNC.elliptic(ϕ, g, 15, [0, 2.5], 8, [0, 1]);","key":"eba7jFMn6t"},{"type":"output","id":"serTDHjcNOraDhYJ2ATEu","data":[],"key":"Cb3suXIu2o"}],"key":"qdrLUIAVhj"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"using Plots\nx = range(0, 2.5, 100)\ny = range(0, 1, 50)\nU = [u(x, y) for x in x, y in y]\ncontourf(x, y, U';\n    color=:blues,  l=0,\n    aspect_ratio=1,\n    xlabel=L\"x\",  ylabel=L\"y\",  zlabel=L\"u(x,y)\",\n    title=\"Deflection of a MEMS membrane\",\n    right_margin=3Plots.mm)","key":"bsmy7vL0CH"},{"type":"output","id":"DbY-JYh7M9lBjglmJz_z0","data":[{"output_type":"execute_result","execution_count":46,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"ce25a32d63cc0178cc918cb8fc066a30","path":"/build/ce25a32d63cc0178cc918cb8fc066a30.png"},"text/html":{"content_type":"text/html","hash":"8bf4c4cc9e9491b4e09721fdc377b2f0","path":"/build/8bf4c4cc9e9491b4e09721fdc377b2f0.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"9782fe50fd3c82716bd55e5fe7f0b0a2","path":"/build/9782fe50fd3c82716bd55e5fe7f0b0a2.svg"}}}],"key":"apvWKzlCaD"}],"key":"iRlTVHwD2L"},{"type":"paragraph","position":{"start":{"line":600,"column":1},"end":{"line":600,"column":1}},"children":[{"type":"text","value":"In the absence of an exact solution, how can we be confident that the solution is accurate? First, the Levenberg iteration converged without issuing a warning, so we should feel confident that the discrete equations were solved. We can check the boundary values easily. For example,","position":{"start":{"line":600,"column":1},"end":{"line":600,"column":1}},"key":"TcKYQxpttL"}],"key":"sukmkCwXyA"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"x_test = range(0, 2.5, 100)\nnorm([u(x, 0) - g(x, 0) for x in x_test], Inf)","key":"swqvnBjQob"},{"type":"output","id":"Ew8JuWEVfbR1SA8NIUsX1","data":[{"output_type":"execute_result","execution_count":47,"metadata":{},"data":{"text/plain":{"content":"2.4918568873705487e-23","content_type":"text/plain"}}}],"key":"eQLOGdFaNn"}],"key":"QO1Q4LSRTe"},{"type":"paragraph","position":{"start":{"line":607,"column":1},"end":{"line":607,"column":1}},"children":[{"type":"text","value":"Assuming that we encoded the ","key":"PeFw49m1ow"},{"type":"abbreviation","title":"partial differential equation","children":[{"type":"text","value":"PDE","key":"aflfxLGi6u"}],"key":"OB1qEPxK5j"},{"type":"text","value":" correctly, the remaining source error is truncation from the discretization. We can estimate that by refining the grid a bit and seeing how much the numerical solution changes.","key":"fszErmWkYQ"}],"key":"PK8WPu6sip"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"x_test = range(0, 2.5, 6)\ny_test = range(0, 1, 6)\nmtx_test, _ = FNC.tensorgrid(x_test, y_test)\nmtx_test(u)","key":"Sh89xrzu6i"},{"type":"output","id":"P62ONHUAt6C_QLH9lvAD3","data":[{"output_type":"execute_result","execution_count":48,"metadata":{},"data":{"text/plain":{"content":"6×6 Matrix{Float64}:\n  0.0           2.38731e-25  -4.92724e-24  …   7.74378e-25   0.0\n  2.91976e-24  -0.147964     -0.226459        -0.147964     -4.94098e-25\n -9.59403e-24  -0.195861     -0.305949        -0.195861      1.55867e-24\n -1.77355e-23  -0.195861     -0.305949        -0.195861      1.30691e-23\n -8.41765e-25  -0.147964     -0.226459        -0.147964     -4.47272e-24\n  0.0           2.5961e-24   -1.38235e-24  …   4.40206e-24   0.0","content_type":"text/plain"}}}],"key":"lklWcedA1I"}],"key":"GC3t8fiE9H"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"u = FNC.elliptic(ϕ, g, 25, [0, 2.5], 14, [0, 1]);\nmtx_test(u)","key":"W8hSotBwfZ"},{"type":"output","id":"B7REuFjkF2Ejtk80UMNjz","data":[{"output_type":"execute_result","execution_count":49,"metadata":{},"data":{"text/plain":{"content":"6×6 Matrix{Float64}:\n  0.0           1.88629e-22  -1.23684e-23  …  -1.24193e-22   0.0\n -1.32086e-25  -0.147958     -0.226453        -0.147958     -5.68645e-23\n -3.55135e-22  -0.195861     -0.305929        -0.195861      8.60294e-23\n -1.22576e-21  -0.195861     -0.305929        -0.195861     -2.26458e-22\n -2.49121e-22  -0.147958     -0.226453        -0.147958     -2.62429e-23\n  0.0           1.52693e-22   2.54043e-22  …  -4.0251e-23    0.0","content_type":"text/plain"}}}],"key":"HPA1efg0wx"}],"key":"NZgfHRI4He"},{"type":"paragraph","position":{"start":{"line":621,"column":1},"end":{"line":621,"column":1}},"children":[{"type":"text","value":"The original solution seems to be accurate to about four digits.","position":{"start":{"line":621,"column":1},"end":{"line":621,"column":1}},"key":"bh9s9QRBgJ"}],"key":"TxJKTDowpy"}],"label":"demo-nonlinear2d-mems-julia","identifier":"demo-nonlinear2d-mems-julia","html_id":"demo-nonlinear2d-mems-julia","key":"d1hy6y3YWM"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-nonlinear-advdiff","label":"demo-nonlinear-advdiff","kind":"proof:example","position":{"start":{"line":626,"column":1},"end":{"line":626,"column":24}},"children":[{"type":"text","value":"Example ","key":"W11hqwIPCF"},{"type":"text","value":"13.4.3","key":"OgC2JRCoWc"}],"template":"Example %s","enumerator":"13.4.3","resolved":true,"html_id":"demo-nonlinear-advdiff","remote":true,"url":"/nonlinear-1","dataUrl":"/nonlinear-1.json","key":"qRWrmhNVQD"}],"key":"Q3IOmN7ruF"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"ϕ = (X, Y, U, Ux, Uxx, Uy, Uyy) -> @. 1 - Ux - 2Uy + 0.05 * (Uxx + Uyy)\ng = (x, y) -> 0\nu = FNC.elliptic(ϕ, g, 32, [-1, 1], 32, [-1, 1]);","key":"ziySu9ZJ4t"},{"type":"output","id":"oGXSH9641QzIJPh4Xo2K-","data":[],"key":"J6dJIYY7wt"}],"key":"IX5yQP5LoB"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"x = y = range(-1, 1, 80)\nU = [u(x, y) for x in x, y in y]\ncontourf(x, y, U';\n    color=:viridis, \n    aspect_ratio=1,\n    xlabel=L\"x\",  ylabel=L\"y\",  zlabel=L\"u(x,y)\",\n    title=\"Steady advection–diffusion\")","key":"W1E3mjdEiJ"},{"type":"output","id":"jeC2xE3qDHzVjDxRGda9x","data":[{"output_type":"execute_result","execution_count":51,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"5f71a2c8fb796adc8d6b9e22bf10fe9b","path":"/build/5f71a2c8fb796adc8d6b9e22bf10fe9b.png"},"text/html":{"content_type":"text/html","hash":"030168bc26696e3010ffb776a8cf1916","path":"/build/030168bc26696e3010ffb776a8cf1916.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"44a8a5bdd0c24438fcac7e8621e23e22","path":"/build/44a8a5bdd0c24438fcac7e8621e23e22.svg"}}}],"key":"aOWOSBYKid"}],"key":"Hs4LgN0dLl"}],"label":"demo-nonlinear-advdiff-julia","identifier":"demo-nonlinear-advdiff-julia","html_id":"demo-nonlinear-advdiff-julia","key":"I53d1HbP8L"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-nonlinear2d-allencahn","label":"demo-nonlinear2d-allencahn","kind":"proof:example","position":{"start":{"line":648,"column":1},"end":{"line":648,"column":28}},"children":[{"type":"text","value":"Example ","key":"f4MIl0jkV0"},{"type":"text","value":"13.4.4","key":"tvKx9wX0N9"}],"template":"Example %s","enumerator":"13.4.4","resolved":true,"html_id":"demo-nonlinear2d-allencahn","remote":true,"url":"/nonlinear-1","dataUrl":"/nonlinear-1.json","key":"WIH8cxNDP0"}],"key":"bqt4D5TcBm"},{"type":"paragraph","position":{"start":{"line":651,"column":1},"end":{"line":651,"column":1}},"children":[{"type":"text","value":"The following defines the ","key":"jT3oZW389E"},{"type":"abbreviation","title":"partial differential equation","children":[{"type":"text","value":"PDE","key":"sVs4CstSoz"}],"key":"oqaYF0IPLi"},{"type":"text","value":" and a nontrivial Dirichlet boundary condition for the square ","key":"BepCVTWu3Q"},{"type":"inlineMath","value":"[0,1]^2","position":{"start":{"line":651,"column":1},"end":{"line":651,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mn>0</mn><mo separator=\"true\">,</mo><mn>1</mn><msup><mo stretchy=\"false\">]</mo><mn>2</mn></msup></mrow><annotation encoding=\"application/x-tex\">[0,1]^2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\"><span class=\"mclose\">]</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span>","key":"v4HAJQYkdB"},{"type":"text","value":".","position":{"start":{"line":651,"column":1},"end":{"line":651,"column":1}},"key":"RRA9msmZ63"}],"key":"wqawkW3fnM"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"ϕ = (X, Y, U, Ux, Uxx, Uy, Uyy) -> @. U * (1 - U^2) + 0.05 * (Uxx + Uyy)\ng = (x, y) -> tanh(5 * (x + 2y - 1));","key":"pWjcCJUfXp"},{"type":"output","id":"JBOdqaK_QSxWHw2IrBo4l","data":[],"key":"A05QnLGhMN"}],"key":"QDZ95hS5Hv"},{"type":"paragraph","position":{"start":{"line":658,"column":1},"end":{"line":658,"column":1}},"children":[{"type":"text","value":"We solve the ","key":"Tb4G0CzAAM"},{"type":"abbreviation","title":"partial differential equation","children":[{"type":"text","value":"PDE","key":"FVnrRHYNMj"}],"key":"b4jYtXSDoE"},{"type":"text","value":" and then plot the result.","key":"nPBvqC6h2y"}],"key":"qbGAaHN31s"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"u = FNC.elliptic(ϕ, g, 36, [0, 1], 36, [0, 1]);","key":"qa6TwqTLJU"},{"type":"output","id":"xEqW2XUtzYdG8Wjgrg6RV","data":[],"key":"VKsUjTHGps"}],"key":"JFI4cWNw0d"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"x = y = range(0, 1, 80)\nU = [u(x, y) for x in x, y in y]\ncontourf(x, y, U';\n    color=:viridis, \n    aspect_ratio=1,\n    xlabel=L\"x\",  ylabel=L\"y\",  zlabel=L\"u(x,y)\", \n    title=\"Steady Allen-Cahn\",\n    right_margin=3Plots.mm)","key":"BXDWOJnb72"},{"type":"output","id":"zGP3yLcBqiH-uUCNoDhAh","data":[{"output_type":"execute_result","execution_count":54,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"547b7c3e65de22f1b225f8f72e819447","path":"/build/547b7c3e65de22f1b225f8f72e819447.png"},"text/html":{"content_type":"text/html","hash":"5acdd33dd4e86602798bdc0b9994aa0f","path":"/build/5acdd33dd4e86602798bdc0b9994aa0f.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"bcc4197b402ed50b73e0ef2e90f15299","path":"/build/bcc4197b402ed50b73e0ef2e90f15299.svg"}}}],"key":"AOXCYsMmOX"}],"key":"pUkmIltSPa"}],"label":"demo-nonlinear2d-allencahn-julia","identifier":"demo-nonlinear2d-allencahn-julia","html_id":"demo-nonlinear2d-allencahn-julia","key":"gKVVc2VqCU"}],"key":"OIy1G0grQ8"}],"key":"adHwbBetwX"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Chapter 12","url":"/chapter12","group":"Julia codes"},"next":{"title":"MATLAB setup","url":"/setup-1","group":"MATLAB codes"}}},"domain":"http://localhost:3000"}