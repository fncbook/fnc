{"kind":"Notebook","sha256":"ccee49e8a0be9a99532afdc7b647975de0c22b83416d884e56038623ce7bfb52","slug":"conv-1","location":"/chapter8/section3/matlab/conv.ipynb","dependencies":[],"frontmatter":{"numbering":{"heading_1":{"enabled":false},"heading_2":{"enabled":false},"heading_3":{"enabled":false},"heading_4":{"enabled":false},"heading_5":{"enabled":false},"heading_6":{"enabled":false}},"kernelspec":{"name":"jupyter_matlab_kernel","display_name":"MATLAB Kernel","language":"matlab"},"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"exports":[{"format":"ipynb","filename":"conv.ipynb","url":"/build/conv-62c0a41d3febb5c681464eae1e2fcd4a.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"GAzawxAPUi"},{"type":"text","value":"8.3.1","key":"bMXS6CsGfn"}],"key":"TSoigvImCo"}],"identifier":"demo-inviter-conv","label":"demo-inviter-conv","kind":"proof:example","template":"Example %s","enumerator":"8.3.1","resolved":true,"html_id":"demo-inviter-conv","remote":true,"url":"/inviter","dataUrl":"/inviter.json","key":"y67dGwRZYJ"}],"key":"gbWNZOtg1F"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We set up a ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"waQlVhOfBY"},{"type":"inlineMath","value":"5\\times 5","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>5</mn><mo>×</mo><mn>5</mn></mrow><annotation encoding=\"application/x-tex\">5\\times 5</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">5</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">5</span></span></span></span>","key":"ijCoGdPhXP"},{"type":"text","value":" triangular matrix with prescribed eigenvalues on its diagonal.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ZGucWhErv7"}],"key":"LhWVgN4joO"}],"key":"b19XE2mRF9"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"ev = [1, -0.75, 0.6, -0.4, 0];\nA = triu(ones(5, 5), 1) + diag(ev);","key":"tbkvjZxPrD"},{"type":"output","id":"7-djrJmHvDO8ORXa7bp5F","data":[],"key":"APAJ6LUh1j"}],"key":"tg67D1yQLa"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We run inverse iteration with the shift ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"C65XNTRM9D"},{"type":"inlineMath","value":"s=0.7","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>s</mi><mo>=</mo><mn>0.7</mn></mrow><annotation encoding=\"application/x-tex\">s=0.7</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0.7</span></span></span></span>","key":"cbBt3WNRBl"},{"type":"text","value":". The result should converge to the eigenvalue closest to 0.7, which we know to be 0.6 here.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rGKMlzAEee"}],"key":"QMyW8R8XJ2"}],"key":"EeV9XiJ25Z"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"s = 0.7;\n[beta, x] = inviter(A, s, 30);\nformat short\nbeta(1:10)","key":"NKR4USAMOc"},{"type":"output","id":"5NUqSzlLXTwAcNg05snD-","data":[{"output_type":"execute_result","execution_count":3,"metadata":{},"data":{"text/plain":{"content":"ans = 1×10 double\n    0.7009    0.5726    0.6109    0.5967    0.6012    0.5996    0.6001    0.6000    0.6000    0.6000\n","content_type":"text/plain"},"text/html":{"content":"<html><body><pre>ans = 1×10 double\n    0.7009    0.5726    0.6109    0.5967    0.6012    0.5996    0.6001    0.6000    0.6000    0.6000\n</pre></body></html>","content_type":"text/html"}}}],"key":"EqfBlcW29P"}],"key":"ukbVZBiSMs"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The convergence is again linear.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"W2yZIe1nhj"}],"key":"GCbVfuDaVk"}],"key":"gbQsmu0nm0"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"err = abs(0.6 - beta);\nsemilogy(abs(err),'.-')\ntitle('Convergence of inverse iteration')\nxlabel('k'), ylabel(('|\\lambda_j - \\beta_k|'));","key":"h7L3gEcJRM"},{"type":"output","id":"1bCdv0r1APRNHSgDLzQU_","data":[{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"7e0cae7dcf7af4d9081774e8ba625da5","path":"/build/7e0cae7dcf7af4d9081774e8ba625da5.png"}}}],"key":"d3kvnJRcbi"}],"key":"qkeyzhB08M"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Let’s reorder the eigenvalues to enforce ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"USE2gO4Tle"},{"type":"crossReference","kind":"equation","identifier":"shiftorder","label":"shiftorder","children":[{"type":"text","value":"(","key":"QM1dPo3uwP"},{"type":"text","value":"8.3.3","key":"D9b0wDXcma"},{"type":"text","value":")","key":"GcwjILSTR7"}],"template":"(%s)","enumerator":"8.3.3","resolved":true,"html_id":"shiftorder","remote":true,"url":"/inviter","dataUrl":"/inviter.json","key":"Md5qom42PO"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"F3eDr8wPtQ"}],"key":"hHFxixQmms"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"aP2rGkuW8h"}],"key":"qWm3zUR7YF"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"The second output of ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"rHYL69klP8"},{"type":"inlineCode","value":"sort","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"AAoD1nzVXf"},{"type":"text","value":" returns the index permutation needed to sort the given vector.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"wpmk3Fw0bE"}],"key":"NH1sWrQenp"}],"class":"dropdown","key":"Pm5uA0sKx9"}],"key":"NpEYgI80ep"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"[~, idx] = sort(abs(ev - s));\nev = ev(idx)","key":"sxKTFTgvES"},{"type":"output","id":"zBqIOJ8ctTO7322qvADBc","data":[{"output_type":"execute_result","execution_count":5,"metadata":{},"data":{"text/plain":{"content":"ev = 1×5 double\n    0.6000    1.0000         0   -0.4000   -0.7500\n","content_type":"text/plain"},"text/html":{"content":"<html><body><pre>ev = 1×5 double\n    0.6000    1.0000         0   -0.4000   -0.7500\n</pre></body></html>","content_type":"text/html"}}}],"key":"wxYENbNrqp"}],"key":"KitNEseAnk"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now it is easy to compare the theoretical and observed linear convergence rates.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ipUszCL0N2"}],"key":"RnJz4xFtFZ"}],"key":"bV91elUWgb"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"theoretical_rate = (ev(1) - s) / (ev(2) - s)\nobserved_rate = err(26) / err(25)","key":"zZaWlR4sW5"},{"type":"output","id":"kZcjVx18R_Fdcjze9R5cK","data":[{"output_type":"execute_result","execution_count":6,"metadata":{},"data":{"text/plain":{"content":"theoretical_rate = -0.3333","content_type":"text/plain"},"text/html":{"content":"<html><body><pre>theoretical_rate = -0.3333</pre></body></html>","content_type":"text/html"}}},{"output_type":"execute_result","execution_count":6,"metadata":{},"data":{"text/plain":{"content":"observed_rate = 0.3332","content_type":"text/plain"},"text/html":{"content":"<html><body><pre>observed_rate = 0.3332</pre></body></html>","content_type":"text/html"}}}],"key":"VEiotLlrgr"}],"key":"F05zOgxcdM"}],"key":"u1NzAdTimS"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Iter","url":"/iter-1","group":"Chapter 8"},"next":{"title":"Accel","url":"/accel-1","group":"Chapter 8"}}},"domain":"http://localhost:3000"}