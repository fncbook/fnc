{"kind":"Notebook","sha256":"3cd0fc40801d21ea0787898705f684574a3055f9f1194d2deeb8eea9c0e0ff51","slug":"mems-3","location":"/chapter13/section4/julia/mems.ipynb","dependencies":[],"frontmatter":{"numbering":{"heading_1":{"enabled":false},"heading_2":{"enabled":false},"heading_3":{"enabled":false},"heading_4":{"enabled":false},"heading_5":{"enabled":false},"heading_6":{"enabled":false}},"kernelspec":{"name":"julia-1.11","display_name":"Julia 1","language":"julia"},"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"exports":[{"format":"ipynb","filename":"mems.ipynb","url":"/fnc/build/mems-bd6cc18d25db8d7cd417d4d787cf1c65.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"GhpWg9pykX"},{"type":"text","value":"13.4.2","key":"rwo4MthMVG"}],"key":"MMvVUvjc7c"}],"identifier":"demo-nonlinear2d-mems","label":"demo-nonlinear2d-mems","kind":"proof:example","template":"Example %s","enumerator":"13.4.2","resolved":true,"html_id":"demo-nonlinear2d-mems","remote":true,"url":"/nonlinear-1","dataUrl":"/nonlinear-1.json","key":"idwZPSQRro"}],"key":"vSQ4Xv7i31"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"All we need to define are ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"blgUSlHAez"},{"type":"text","value":"ϕ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"CERLiCiHNR"},{"type":"text","value":" from ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"TCBG2CSd5l"},{"type":"crossReference","kind":"equation","identifier":"nonlinpdepde","label":"nonlinpdepde","children":[{"type":"text","value":"(","key":"i8N6cy0UUn"},{"type":"text","value":"13.4.2","key":"cubp2u1ocx"},{"type":"text","value":")","key":"J8UszvUYzr"}],"template":"(%s)","enumerator":"13.4.2","resolved":true,"html_id":"nonlinpdepde","remote":true,"url":"/nonlinear-1","dataUrl":"/nonlinear-1.json","key":"y52uiEOPAy"},{"type":"text","value":" for the ","key":"ewaY3CtjZJ"},{"type":"abbreviation","title":"partial differential equation","children":[{"type":"text","value":"PDE","key":"vbgvNJeXi4"}],"key":"RHo6SCBX1S"},{"type":"text","value":", and a trivial zero function for the boundary condition.","key":"zvaumUj2KA"}],"key":"SebtmOBIi4"}],"key":"jleMmFIQj5"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:46:16.255000Z","iopub.status.busy":"2025-01-14T15:46:13.746000Z","iopub.execute_input":"2025-01-14T15:46:15.844000Z","shell.execute_reply":"2025-01-14T15:46:16.251000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"λ = 1.5\nϕ = (X, Y, U, Ux, Uxx, Uy, Uyy) -> @. Uxx + Uyy - λ / (U + 1)^2;\ng = (x, y) -> 0;","key":"M6JsPSkGvo"},{"type":"output","id":"Bd3wbVtlvb-jTbKba6YcA","data":[],"key":"lqFRbBx7Nc"}],"key":"Neh57XBMvo"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Here is the solution for ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"t0MGdRJ5VR"},{"type":"inlineMath","value":"m=15","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi><mo>=</mo><mn>15</mn></mrow><annotation encoding=\"application/x-tex\">m=15</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">15</span></span></span></span>","key":"Ed5S203NHc"},{"type":"text","value":", ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ldFDWT5xsw"},{"type":"inlineMath","value":"n=8","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>=</mo><mn>8</mn></mrow><annotation encoding=\"application/x-tex\">n=8</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">8</span></span></span></span>","key":"PHXWZdzJFu"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"C7k8EyLnN6"}],"key":"v1Zku9LbZp"}],"key":"aYoHakNKvp"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:46:41.390000Z","iopub.status.busy":"2025-01-14T15:46:16.259000Z","iopub.execute_input":"2025-01-14T15:46:16.260000Z","shell.execute_reply":"2025-01-14T15:46:41.389000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"u = FNC.elliptic(ϕ, g, 15, [0, 2.5], 8, [0, 1]);","key":"BKiEfNfF8s"},{"type":"output","id":"u1GvNSwpBV8v9Xe2ZySGD","data":[],"key":"WTbFg5xSB9"}],"key":"hSqEqX8v80"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:47:30.415000Z","iopub.status.busy":"2025-01-14T15:46:41.399000Z","iopub.execute_input":"2025-01-14T15:46:41.400000Z","shell.execute_reply":"2025-01-14T15:47:30.412000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"x = range(0, 2.5, 100)\ny = range(0, 1, 50)\nU = [u(x, y) for x in x, y in y]\ncontourf(x, y, U';\n    color=:blues,  l=0,\n    aspect_ratio=1,\n    xlabel=L\"x\",  ylabel=L\"y\",  zlabel=L\"u(x,y)\",\n    title=\"Deflection of a MEMS membrane\",\n    right_margin=3Plots.mm)","key":"ToaE2jxcrW"},{"type":"output","id":"mk5nCQIdq9d4AjZvMNktc","data":[{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"ce25a32d63cc0178cc918cb8fc066a30","path":"/fnc/build/ce25a32d63cc0178cc918cb8fc066a30.png"},"text/html":{"content_type":"text/html","hash":"2a68ce0886e09d767ff02a94753b5658","path":"/fnc/build/2a68ce0886e09d767ff02a94753b5658.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"9ca46ee42e1464ae5188496e46b1eae1","path":"/fnc/build/9ca46ee42e1464ae5188496e46b1eae1.svg"}}}],"key":"ntty9Uw6lf"}],"key":"muZ9CRd1x8"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"In the absence of an exact solution, how can we be confident that the solution is accurate? First, the Levenberg iteration converged without issuing a warning, so we should feel confident that the discrete equations were solved. We can check the boundary values easily. For example,","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"fUFuq2shLA"}],"key":"vUiJMQNImT"}],"key":"mTjpbLyQ7e"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:47:33.771000Z","iopub.status.busy":"2025-01-14T15:47:30.450000Z","iopub.execute_input":"2025-01-14T15:47:30.451000Z","shell.execute_reply":"2025-01-14T15:47:33.758000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"x_test = range(0, 2.5, 100)\nnorm([u(x, 0) - g(x, 0) for x in x_test], Inf)","key":"b4YnKGoyEF"},{"type":"output","id":"DCRHTgp7EuycqStJSgrgv","data":[{"output_type":"execute_result","execution_count":5,"metadata":{},"data":{"text/plain":{"content":"2.4918568873705487e-23","content_type":"text/plain"}}}],"key":"x2XRQxSlRW"}],"key":"Z7EhNteEV1"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Assuming that we encoded the ","key":"DLKPFlNlAX"},{"type":"abbreviation","title":"partial differential equation","children":[{"type":"text","value":"PDE","key":"rbQ9jevlR8"}],"key":"jVrbnGHD0h"},{"type":"text","value":" correctly, the remaining source error is truncation from the discretization. We can estimate that by refining the grid a bit and seeing how much the numerical solution changes.","key":"PyB6iZlieK"}],"key":"b5komm95vZ"}],"key":"qTvtw1uISr"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:47:50.252000Z","iopub.status.busy":"2025-01-14T15:47:33.803000Z","iopub.execute_input":"2025-01-14T15:47:33.804000Z","shell.execute_reply":"2025-01-14T15:47:50.245000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"x_test = range(0, 2.5, 6)\ny_test = range(0, 1, 6)\nmtx_test, _ = FNC.tensorgrid(x_test, y_test)\nmtx_test(u)","key":"yehX5Fyz7q"},{"type":"output","id":"GI4bOyW9eo6VkGJjIY30q","data":[{"output_type":"execute_result","execution_count":6,"metadata":{},"data":{"text/plain":{"content":"6×6 Matrix{Float64}:\n  0.0           2.38731e-25  -4.92724e-24  …   7.74378e-25   0.0\n  2.91976e-24  -0.147964     -0.226459        -0.147964     -4.94098e-25\n -9.59403e-24  -0.195861     -0.305949        -0.195861      1.55867e-24\n -1.77355e-23  -0.195861     -0.305949        -0.195861      1.30691e-23\n -8.41765e-25  -0.147964     -0.226459        -0.147964     -4.47272e-24\n  0.0           2.5961e-24   -1.38235e-24  …   4.40206e-24   0.0","content_type":"text/plain"}}}],"key":"VkQR1XsNy1"}],"key":"dI6cfB6LlT"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:47:55.432000Z","iopub.status.busy":"2025-01-14T15:47:50.303000Z","iopub.execute_input":"2025-01-14T15:47:50.303000Z","shell.execute_reply":"2025-01-14T15:47:55.431000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"u = FNC.elliptic(ϕ, g, 25, [0, 2.5], 14, [0, 1]);\nmtx_test(u)","key":"tTbp64snaJ"},{"type":"output","id":"6W6TFoRsan1_-Hj2lDiiZ","data":[{"output_type":"execute_result","execution_count":7,"metadata":{},"data":{"text/plain":{"content":"6×6 Matrix{Float64}:\n  0.0          -2.32202e-22   3.64848e-23  …  -7.02464e-24   0.0\n -9.25622e-23  -0.147958     -0.226453        -0.147958     -1.59215e-22\n -1.02101e-22  -0.195861     -0.305929        -0.195861     -1.96135e-22\n -1.47369e-21  -0.195861     -0.305929        -0.195861     -4.03143e-22\n -1.46345e-22  -0.147958     -0.226453        -0.147958      1.00683e-22\n  0.0          -4.08671e-23   3.06048e-22  …  -4.38852e-23   0.0","content_type":"text/plain"}}}],"key":"CmVIHojpwa"}],"key":"jGcLA7JXhR"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The original solution seems to be accurate to about four digits.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WKWkCscWUC"}],"key":"R0gKQahEhk"}],"key":"JIRpEL1dcK"}],"key":"pw0rdYjBeK"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Poisson","url":"/poisson","group":"Chapter 13"},"next":{"title":"Advdiff","url":"/advdiff-2","group":"Chapter 13"}}},"domain":"http://localhost:3000"}