{"kind":"Notebook","sha256":"fd63a8d596b2921e2f93e3e2875925680d6ff1461f2a136e118fd8a90b8a28f4","slug":"bound-2","location":"/chapter2/section8/python/bound.ipynb","dependencies":[],"frontmatter":{"numbering":{"heading_1":{"enabled":false},"heading_2":{"enabled":false},"heading_3":{"enabled":false},"heading_4":{"enabled":false},"heading_5":{"enabled":false},"heading_6":{"enabled":false}},"kernelspec":{"name":"python3","display_name":"Python 3","language":"python"},"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"exports":[{"format":"ipynb","filename":"bound.ipynb","url":"/fnc/build/bound-5fa651348de0882e56c0489664b4246e.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:43:50.198710Z","iopub.status.busy":"2025-01-11T17:43:50.198573Z","iopub.status.idle":"2025-01-11T17:43:50.533403Z","shell.execute_reply":"2025-01-11T17:43:50.532842Z"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"exec(open(\"../../../python/FNC_init.py\").read())","visibility":"show","key":"dRcCuKanra"},{"type":"output","id":"fNzMOXN1Cg3VNQFL1IQKy","data":[],"visibility":"show","key":"U7BRbi0Afa"}],"visibility":"remove","key":"J7wTeV57tA"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"HZo8UeCgG4"},{"type":"text","value":"2.8.1","key":"YQmqMCQ1dd"}],"key":"i9jRysN5g3"}],"identifier":"demo-condition-bound","label":"demo-condition-bound","kind":"proof:example","template":"Example %s","enumerator":"2.8.1","resolved":true,"html_id":"demo-condition-bound","remote":true,"url":"/condition-number","dataUrl":"/condition-number.json","key":"D89c8e3o0G"}],"key":"GGJuxlR89K"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"The function ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"wvTseblwlq"},{"type":"inlineCode","value":"cond","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"pNPWYlaqaV"},{"type":"text","value":" from ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"lDlAwszdnu"},{"type":"inlineCode","value":"numpy.linalg","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"BxMFaOIpbZ"},{"type":"text","value":" is used to computes matrix condition numbers. By default, the 2-norm is used. As an example, the family of ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"YPQ0fUN2sZ"},{"type":"emphasis","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Hilbert matrices","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"M0BPM6rKED"}],"key":"p51T6gfk7j"},{"type":"text","value":" is famously badly conditioned. Here is the ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"amVUX4VAth"},{"type":"inlineMath","value":"6\\times 6","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>6</mn><mo>×</mo><mn>6</mn></mrow><annotation encoding=\"application/x-tex\">6\\times 6</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">6</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">6</span></span></span></span>","key":"okmspKpTMA"},{"type":"text","value":"  case.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"f3lKrJzysj"}],"indexEntries":[{"entry":"Python","subEntry":{"value":"cond","kind":"entry"},"emphasis":true}],"label":"index-P0EQTkdnHE","identifier":"index-p0eqtkdnhe","html_id":"index-p0eqtkdnhe","key":"QofQdpFW2C"}],"key":"XZ5CEfPwSe"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:43:50.536085Z","iopub.status.busy":"2025-01-11T17:43:50.535921Z","iopub.status.idle":"2025-01-11T17:43:50.538237Z","shell.execute_reply":"2025-01-11T17:43:50.537964Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"A = array([ \n    [1/(i + j + 2) for j in range(6)] \n    for i in range(6) \n    ])\nprint(A)","key":"sCli52e0kk"},{"type":"output","id":"l_rVsCxXtMDfnwl0_8LFb","data":[{"name":"stdout","output_type":"stream","text":"[[0.5        0.33333333 0.25       0.2        0.16666667 0.14285714]\n [0.33333333 0.25       0.2        0.16666667 0.14285714 0.125     ]\n [0.25       0.2        0.16666667 0.14285714 0.125      0.11111111]\n [0.2        0.16666667 0.14285714 0.125      0.11111111 0.1       ]\n [0.16666667 0.14285714 0.125      0.11111111 0.1        0.09090909]\n [0.14285714 0.125      0.11111111 0.1        0.09090909 0.08333333]]\n"}],"key":"omsM4xQfJl"}],"key":"MVTAcnRQgf"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:43:50.539384Z","iopub.status.busy":"2025-01-11T17:43:50.539295Z","iopub.status.idle":"2025-01-11T17:43:50.541178Z","shell.execute_reply":"2025-01-11T17:43:50.540931Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"from numpy.linalg import cond\nkappa = cond(A)\nprint(f\"kappa is {kappa:.3e}\")","key":"O4YsMCTRgh"},{"type":"output","id":"QGQXyQqf_CIw4cnj1TvLh","data":[{"name":"stdout","output_type":"stream","text":"kappa is 5.110e+07\n"}],"key":"J8TZWnqL3B"}],"key":"N7IthvRJiv"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Next we engineer a linear system problem to which we know the exact answer.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LUTgszw0FL"}],"key":"Mu29g8SLMp"}],"key":"vQEuGUCMUt"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:43:50.542280Z","iopub.status.busy":"2025-01-11T17:43:50.542200Z","iopub.status.idle":"2025-01-11T17:43:50.544016Z","shell.execute_reply":"2025-01-11T17:43:50.543730Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"x_exact = 1.0 + arange(6)\nb = A @ x_exact","key":"jWTEOuchJ2"},{"type":"output","id":"frUimuGRYilVlvLm9kQMl","data":[],"key":"o3CWFjT5TV"}],"key":"nWsfhfBe2S"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now we perturb the data randomly with a vector of norm ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Z7rOAVsW9X"},{"type":"span","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"10","key":"Qtyfvl5x1J"},{"type":"superscript","children":[{"type":"text","value":"-12","key":"dRcG0ga1FZ"}],"key":"LbTUszZu5a"}],"key":"RQv2lsdg75"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DSPMTyLJFk"}],"key":"mO2yaQvbWr"}],"key":"HQDCuYpoXJ"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:43:50.545181Z","iopub.status.busy":"2025-01-11T17:43:50.545104Z","iopub.status.idle":"2025-01-11T17:43:50.546901Z","shell.execute_reply":"2025-01-11T17:43:50.546683Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"dA = random.randn(6, 6)\ndA = 1e-12 * (dA / norm(dA, 2))\ndb = random.randn(6)\ndb = 1e-12 * (db / norm(db, 2))","key":"HtgTdk7s9d"},{"type":"output","id":"7k7T1QFn3mFdwr7KDDD1j","data":[],"key":"fHCHeXbfms"}],"key":"BYQW6dsybb"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We solve the perturbed problem using built-in pivoted LU and see how the solution was changed.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"IaXzkfprqq"}],"key":"e6YR8Y3HcN"}],"key":"cfhi2Kcwrx"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:43:50.548040Z","iopub.status.busy":"2025-01-11T17:43:50.547957Z","iopub.status.idle":"2025-01-11T17:43:50.549611Z","shell.execute_reply":"2025-01-11T17:43:50.549368Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"x = linalg.solve(A + dA, b + db) \ndx = x - x_exact","key":"SO1MiioPZf"},{"type":"output","id":"B5Qj1ZN6B7uUZ9U4_QyAx","data":[],"key":"OeciyjWKtb"}],"key":"KTLTaePvOV"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Here is the relative error in the solution.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PzRmcuV1ba"}],"key":"csWAmouFwx"}],"key":"IY1i5ZXvJF"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:43:50.550779Z","iopub.status.busy":"2025-01-11T17:43:50.550703Z","iopub.status.idle":"2025-01-11T17:43:50.552425Z","shell.execute_reply":"2025-01-11T17:43:50.552169Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"print(f\"relative error is {norm(dx) / norm(x_exact):.2e}\")","key":"SLyNK5L68G"},{"type":"output","id":"KD0ovK9y9imB2dgH9hAi4","data":[{"name":"stdout","output_type":"stream","text":"relative error is 5.01e-06\n"}],"key":"dq44SnulBW"}],"key":"rSZnjwb7US"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"And here are upper bounds predicted using the condition number of the original matrix.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"peI0S5vxLC"}],"key":"yqty1M4vVj"}],"key":"WKn4EtO7oD"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:43:50.553510Z","iopub.status.busy":"2025-01-11T17:43:50.553437Z","iopub.status.idle":"2025-01-11T17:43:50.555198Z","shell.execute_reply":"2025-01-11T17:43:50.554997Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"print(f\"b_bound: {kappa * 1e-12 / norm(b):.2e}\")\nprint(f\"A_bound: {kappa * 1e-12 / norm(A, 2):.2e}\")","key":"JuqqGjXvTP"},{"type":"output","id":"Jbmcww9mBVtIwY2_7KjUu","data":[{"name":"stdout","output_type":"stream","text":"b_bound: 6.72e-06\nA_bound: 4.57e-05\n"}],"key":"bgz5coq07b"}],"key":"k4KOR4ozS3"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Even if we don’t make any manual perturbations to the data, machine epsilon does when we solve the linear system numerically.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"eL3hrC16PC"}],"key":"FWymFbBK8J"}],"key":"adIFGop1XM"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:43:50.556220Z","iopub.status.busy":"2025-01-11T17:43:50.556132Z","iopub.status.idle":"2025-01-11T17:43:50.557968Z","shell.execute_reply":"2025-01-11T17:43:50.557752Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"x = linalg.solve(A, b)\nprint(f\"relative error: {norm(x - x_exact) / norm(x_exact):.2e}\")\nprint(f\"rounding bound: {kappa / 2**52:.2e}\")\n","key":"raeg9sqwsf"},{"type":"output","id":"HPzHQaSxtjbxHMc-n5pXm","data":[{"name":"stdout","output_type":"stream","text":"relative error: 6.85e-10\nrounding bound: 1.13e-08\n"}],"key":"kigYQxtfrd"}],"key":"t0rPmrbRyJ"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Because ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"P3mX7LnWNL"},{"type":"inlineMath","value":"\\kappa\\approx 10^8","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>κ</mi><mo>≈</mo><mn>1</mn><msup><mn>0</mn><mn>8</mn></msup></mrow><annotation encoding=\"application/x-tex\">\\kappa\\approx 10^8</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4831em;\"></span><span class=\"mord mathnormal\">κ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">8</span></span></span></span></span></span></span></span></span></span></span>","key":"uXTrSQdc5l"},{"type":"text","value":", it’s possible to lose 8 digits of accuracy in the process of passing from ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"quCzcarxX6"},{"type":"inlineMath","value":"A","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi></mrow><annotation encoding=\"application/x-tex\">A</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">A</span></span></span></span>","key":"mvyvD9aCFv"},{"type":"text","value":" and ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"SC65hRNmCJ"},{"type":"inlineMath","value":"b","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>b</mi></mrow><annotation encoding=\"application/x-tex\">b</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">b</span></span></span></span>","key":"cQlbogR1wR"},{"type":"text","value":" to ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MFB8mYK7ak"},{"type":"inlineMath","value":"x","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"NYKnG30tLu"},{"type":"text","value":". That’s independent of the algorithm; it’s inevitable once the data are expressed in double precision.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"v6l1K9QjQH"}],"key":"JUi1hUzP5Z"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Larger Hilbert matrices are even more poorly conditioned.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"fp8k8wt0oh"}],"key":"k1SbOcOPN9"}],"key":"VpsTkOsJGv"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:43:50.559039Z","iopub.status.busy":"2025-01-11T17:43:50.558965Z","iopub.status.idle":"2025-01-11T17:43:50.561015Z","shell.execute_reply":"2025-01-11T17:43:50.560801Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"A = array([ [1/(i+j+2) for j in range(14)] for i in range(14) ])\nkappa = cond(A)\nprint(f\"kappa is {kappa:.3e}\")","key":"mpisID57uc"},{"type":"output","id":"W464zy0tRpYAAIxZRwv9u","data":[{"name":"stdout","output_type":"stream","text":"kappa is 1.436e+19\n"}],"key":"BigCW8DbIM"}],"key":"zr47nHKKHX"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Before we compute the solution, note that ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"r7WUbvxKQy"},{"type":"text","value":"κ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PSeQQI6CSO"},{"type":"text","value":" exceeds ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"uIxVMYW9bh"},{"type":"inlineCode","value":"1/eps","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"aGJiRlJqwp"},{"type":"text","value":". In principle we therefore might end up with an answer that is completely wrong (i.e., a relative error greater than 100%).","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UQQ8MJzRs7"}],"key":"YerT4Ddwy1"}],"key":"WRpNip0rhF"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:43:50.562076Z","iopub.status.busy":"2025-01-11T17:43:50.561999Z","iopub.status.idle":"2025-01-11T17:43:50.563714Z","shell.execute_reply":"2025-01-11T17:43:50.563481Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"print(f\"rounding bound: {kappa / 2**52:.2e}\")","key":"bSQFnvFWh3"},{"type":"output","id":"JWY6OgnGqA4HXb47JWJDr","data":[{"name":"stdout","output_type":"stream","text":"rounding bound: 3.19e+03\n"}],"key":"JA1qsyGpX9"}],"key":"VvSI0KfR3c"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:43:50.564845Z","iopub.status.busy":"2025-01-11T17:43:50.564760Z","iopub.status.idle":"2025-01-11T17:43:50.566409Z","shell.execute_reply":"2025-01-11T17:43:50.566141Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"x_exact = 1.0 + arange(14)\nb = A @ x_exact  \nx = linalg.solve(A, b)","key":"C43kfQWVfu"},{"type":"output","id":"1cSTZwhljAgUujpkp8k8R","data":[],"key":"Giukp5MAMH"}],"key":"ffEksyjjji"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We got an answer. But in fact, the error does exceed 100%:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jLdL9UYYTl"}],"key":"AaP5pWd80T"}],"key":"YQ6XW0SIFT"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:43:50.567501Z","iopub.status.busy":"2025-01-11T17:43:50.567429Z","iopub.status.idle":"2025-01-11T17:43:50.569064Z","shell.execute_reply":"2025-01-11T17:43:50.568852Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"print(f\"relative error: {norm(x - x_exact) / norm(x_exact):.2e}\")","key":"BG6uO3CmEg"},{"type":"output","id":"L8rjt91T9EbH06Mn1BcSA","data":[{"name":"stdout","output_type":"stream","text":"relative error: 1.42e+01\n"}],"key":"TLN19yFCDN"}],"key":"aQ54DaNMFz"}],"key":"kY5YTXBFVS"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Matrix","url":"/matrix-2","group":"Chapter 2"},"next":{"title":"Banded","url":"/banded-2","group":"Chapter 2"}}},"domain":"http://localhost:3000"}