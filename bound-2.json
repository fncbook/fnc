{"kind":"Notebook","sha256":"fd63a8d596b2921e2f93e3e2875925680d6ff1461f2a136e118fd8a90b8a28f4","slug":"bound-2","location":"/chapter2/section8/python/bound.ipynb","dependencies":[],"frontmatter":{"numbering":{"heading_1":{"enabled":false},"heading_2":{"enabled":false},"heading_3":{"enabled":false},"heading_4":{"enabled":false},"heading_5":{"enabled":false},"heading_6":{"enabled":false}},"kernelspec":{"name":"python3","display_name":"Python 3","language":"python"},"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"exports":[{"format":"ipynb","filename":"bound.ipynb","url":"/build/bound-5fa651348de0882e56c0489664b4246e.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:43:50.198710Z","iopub.status.busy":"2025-01-11T17:43:50.198573Z","iopub.status.idle":"2025-01-11T17:43:50.533403Z","shell.execute_reply":"2025-01-11T17:43:50.532842Z"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"exec(open(\"../../../python/FNC_init.py\").read())","visibility":"show","key":"hNvInmhKgi"},{"type":"output","id":"e_Z86FaeX7gD17EWsTE79","data":[],"visibility":"show","key":"Jmr6qonzhy"}],"visibility":"remove","key":"jh9dtSxPQP"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"JRLAuqSWQ0"},{"type":"text","value":"2.8.1","key":"BHG8Hz8XC7"}],"key":"QVkbXRzdXf"}],"identifier":"demo-condition-bound","label":"demo-condition-bound","kind":"proof:example","template":"Example %s","enumerator":"2.8.1","resolved":true,"html_id":"demo-condition-bound","remote":true,"url":"/condition-number","dataUrl":"/condition-number.json","key":"QemU6xmOtU"}],"key":"QHuoEQnjBD"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"The function ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"borWoB6l2y"},{"type":"inlineCode","value":"cond","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"gK8QkjG9kg"},{"type":"text","value":" from ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"IBooSMRnC3"},{"type":"inlineCode","value":"numpy.linalg","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"AvGgKsijeH"},{"type":"text","value":" is used to computes matrix condition numbers. By default, the 2-norm is used. As an example, the family of ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"RHN4Ka6sYP"},{"type":"emphasis","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Hilbert matrices","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"Y0CTLqHpAS"}],"key":"ns1pI4xz8C"},{"type":"text","value":" is famously badly conditioned. Here is the ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"guBxZdda4b"},{"type":"inlineMath","value":"6\\times 6","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>6</mn><mo>×</mo><mn>6</mn></mrow><annotation encoding=\"application/x-tex\">6\\times 6</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">6</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">6</span></span></span></span>","key":"lrOBnRgP3Z"},{"type":"text","value":"  case.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"caLCVWq1Ks"}],"indexEntries":[{"entry":"Python","subEntry":{"value":"cond","kind":"entry"},"emphasis":true}],"label":"index-z1mJ7sR5Ck","identifier":"index-z1mj7sr5ck","html_id":"index-z1mj7sr5ck","key":"pCPvT0Ic8g"}],"key":"WwVAlHrQsK"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:43:50.536085Z","iopub.status.busy":"2025-01-11T17:43:50.535921Z","iopub.status.idle":"2025-01-11T17:43:50.538237Z","shell.execute_reply":"2025-01-11T17:43:50.537964Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"A = array([ \n    [1/(i + j + 2) for j in range(6)] \n    for i in range(6) \n    ])\nprint(A)","key":"swMjgvhXgH"},{"type":"output","id":"yN-Ipcyz4AD_vk1j_2OMx","data":[{"name":"stdout","output_type":"stream","text":"[[0.5        0.33333333 0.25       0.2        0.16666667 0.14285714]\n [0.33333333 0.25       0.2        0.16666667 0.14285714 0.125     ]\n [0.25       0.2        0.16666667 0.14285714 0.125      0.11111111]\n [0.2        0.16666667 0.14285714 0.125      0.11111111 0.1       ]\n [0.16666667 0.14285714 0.125      0.11111111 0.1        0.09090909]\n [0.14285714 0.125      0.11111111 0.1        0.09090909 0.08333333]]\n"}],"key":"gBqFQoFAU8"}],"key":"rx3n6zETf1"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:43:50.539384Z","iopub.status.busy":"2025-01-11T17:43:50.539295Z","iopub.status.idle":"2025-01-11T17:43:50.541178Z","shell.execute_reply":"2025-01-11T17:43:50.540931Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"from numpy.linalg import cond\nkappa = cond(A)\nprint(f\"kappa is {kappa:.3e}\")","key":"C9Llvn4TEu"},{"type":"output","id":"ahkR0YbomS6tdqDnlPFUs","data":[{"name":"stdout","output_type":"stream","text":"kappa is 5.110e+07\n"}],"key":"Npjqx833hH"}],"key":"Yz654BSVtT"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Next we engineer a linear system problem to which we know the exact answer.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WBOI3T9TrZ"}],"key":"TQybFp8tbk"}],"key":"IMBEtDetii"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:43:50.542280Z","iopub.status.busy":"2025-01-11T17:43:50.542200Z","iopub.status.idle":"2025-01-11T17:43:50.544016Z","shell.execute_reply":"2025-01-11T17:43:50.543730Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"x_exact = 1.0 + arange(6)\nb = A @ x_exact","key":"l32POMPLIq"},{"type":"output","id":"RsEJHlIA295ePNIbeCr6S","data":[],"key":"plunoSyenY"}],"key":"e62VjM4nDg"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now we perturb the data randomly with a vector of norm ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"SL9c1kQoNI"},{"type":"span","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"10","key":"P8lAvadPqa"},{"type":"superscript","children":[{"type":"text","value":"-12","key":"rZluAEJ3NY"}],"key":"hjUqDFY32X"}],"key":"yA0VPBBbpj"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"iLPBPfJqEm"}],"key":"qVLrnmp178"}],"key":"lYAER2ifbC"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:43:50.545181Z","iopub.status.busy":"2025-01-11T17:43:50.545104Z","iopub.status.idle":"2025-01-11T17:43:50.546901Z","shell.execute_reply":"2025-01-11T17:43:50.546683Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"dA = random.randn(6, 6)\ndA = 1e-12 * (dA / norm(dA, 2))\ndb = random.randn(6)\ndb = 1e-12 * (db / norm(db, 2))","key":"Yp1QkgYFFj"},{"type":"output","id":"PCCARWpj1F2hUoN21fKrf","data":[],"key":"cBUO7qaMRo"}],"key":"lBZ72aiCLt"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We solve the perturbed problem using built-in pivoted LU and see how the solution was changed.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Jwp3LpR4dX"}],"key":"UeQ4UoswBQ"}],"key":"qKkghblxD2"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:43:50.548040Z","iopub.status.busy":"2025-01-11T17:43:50.547957Z","iopub.status.idle":"2025-01-11T17:43:50.549611Z","shell.execute_reply":"2025-01-11T17:43:50.549368Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"x = linalg.solve(A + dA, b + db) \ndx = x - x_exact","key":"GyEjgQiEju"},{"type":"output","id":"1NUB5xG51WQKUBPn3HHN4","data":[],"key":"VOfpG8O29u"}],"key":"vhtKZUudJS"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Here is the relative error in the solution.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"SKrfoSF3mt"}],"key":"Iu872jRqU9"}],"key":"UImILkjyLN"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:43:50.550779Z","iopub.status.busy":"2025-01-11T17:43:50.550703Z","iopub.status.idle":"2025-01-11T17:43:50.552425Z","shell.execute_reply":"2025-01-11T17:43:50.552169Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"print(f\"relative error is {norm(dx) / norm(x_exact):.2e}\")","key":"IdE31tfJoD"},{"type":"output","id":"j0U3PVpb8FCqpzP1qUwDH","data":[{"name":"stdout","output_type":"stream","text":"relative error is 5.01e-06\n"}],"key":"cTmSt8pRcF"}],"key":"nuvqg0OKSx"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"And here are upper bounds predicted using the condition number of the original matrix.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"D0ZUBStIqj"}],"key":"Tk0FyRTUrz"}],"key":"YoIOPbX4IX"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:43:50.553510Z","iopub.status.busy":"2025-01-11T17:43:50.553437Z","iopub.status.idle":"2025-01-11T17:43:50.555198Z","shell.execute_reply":"2025-01-11T17:43:50.554997Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"print(f\"b_bound: {kappa * 1e-12 / norm(b):.2e}\")\nprint(f\"A_bound: {kappa * 1e-12 / norm(A, 2):.2e}\")","key":"bks3RT06yC"},{"type":"output","id":"X1tnbd92MvjD0U-emUky6","data":[{"name":"stdout","output_type":"stream","text":"b_bound: 6.72e-06\nA_bound: 4.57e-05\n"}],"key":"pVg5fDxdqx"}],"key":"p0AOXnMSDJ"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Even if we don’t make any manual perturbations to the data, machine epsilon does when we solve the linear system numerically.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"yeLgFAsx8i"}],"key":"JDYb2lWN74"}],"key":"EcKCeo0Iyv"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:43:50.556220Z","iopub.status.busy":"2025-01-11T17:43:50.556132Z","iopub.status.idle":"2025-01-11T17:43:50.557968Z","shell.execute_reply":"2025-01-11T17:43:50.557752Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"x = linalg.solve(A, b)\nprint(f\"relative error: {norm(x - x_exact) / norm(x_exact):.2e}\")\nprint(f\"rounding bound: {kappa / 2**52:.2e}\")\n","key":"TNlNdFbCep"},{"type":"output","id":"r420xHtp9kyH9yvz7nGtp","data":[{"name":"stdout","output_type":"stream","text":"relative error: 6.85e-10\nrounding bound: 1.13e-08\n"}],"key":"oT0oLlgzRN"}],"key":"PYVmBPbWMN"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Because ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dhTNhuyybN"},{"type":"inlineMath","value":"\\kappa\\approx 10^8","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>κ</mi><mo>≈</mo><mn>1</mn><msup><mn>0</mn><mn>8</mn></msup></mrow><annotation encoding=\"application/x-tex\">\\kappa\\approx 10^8</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4831em;\"></span><span class=\"mord mathnormal\">κ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">8</span></span></span></span></span></span></span></span></span></span></span>","key":"QqWK53Uic0"},{"type":"text","value":", it’s possible to lose 8 digits of accuracy in the process of passing from ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"QyLzfqhY79"},{"type":"inlineMath","value":"A","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi></mrow><annotation encoding=\"application/x-tex\">A</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">A</span></span></span></span>","key":"pJa3cJxAXX"},{"type":"text","value":" and ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Ngc3EloCzY"},{"type":"inlineMath","value":"b","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>b</mi></mrow><annotation encoding=\"application/x-tex\">b</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">b</span></span></span></span>","key":"PZkhu2txjd"},{"type":"text","value":" to ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YsrwLhDswd"},{"type":"inlineMath","value":"x","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"Y1S4WaR5ox"},{"type":"text","value":". That’s independent of the algorithm; it’s inevitable once the data are expressed in double precision.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"oHyuKuarHw"}],"key":"DxaPes5YeP"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Larger Hilbert matrices are even more poorly conditioned.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"lm5cQGUs1s"}],"key":"XdGRJcQrzf"}],"key":"mEuMcBGaJG"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:43:50.559039Z","iopub.status.busy":"2025-01-11T17:43:50.558965Z","iopub.status.idle":"2025-01-11T17:43:50.561015Z","shell.execute_reply":"2025-01-11T17:43:50.560801Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"A = array([ [1/(i+j+2) for j in range(14)] for i in range(14) ])\nkappa = cond(A)\nprint(f\"kappa is {kappa:.3e}\")","key":"znkdlMlZpr"},{"type":"output","id":"9-L7jjI2svDDWypOEbYLS","data":[{"name":"stdout","output_type":"stream","text":"kappa is 1.436e+19\n"}],"key":"S5mZnvLThC"}],"key":"srvFbpUGBk"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Before we compute the solution, note that ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OqSFpJWfF1"},{"type":"text","value":"κ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"yOL4jUoDLs"},{"type":"text","value":" exceeds ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GdvjzUnvYC"},{"type":"inlineCode","value":"1/eps","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"HkIW0CTrLi"},{"type":"text","value":". In principle we therefore might end up with an answer that is completely wrong (i.e., a relative error greater than 100%).","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"yukZVC5Owu"}],"key":"gImnKlzBzJ"}],"key":"H1Xu95g5xM"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:43:50.562076Z","iopub.status.busy":"2025-01-11T17:43:50.561999Z","iopub.status.idle":"2025-01-11T17:43:50.563714Z","shell.execute_reply":"2025-01-11T17:43:50.563481Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"print(f\"rounding bound: {kappa / 2**52:.2e}\")","key":"nfYreBdFA5"},{"type":"output","id":"8Q4vrh4FvtDkkCAgq62rO","data":[{"name":"stdout","output_type":"stream","text":"rounding bound: 3.19e+03\n"}],"key":"zt1QxmjvEE"}],"key":"k0W4INl9lu"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:43:50.564845Z","iopub.status.busy":"2025-01-11T17:43:50.564760Z","iopub.status.idle":"2025-01-11T17:43:50.566409Z","shell.execute_reply":"2025-01-11T17:43:50.566141Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"x_exact = 1.0 + arange(14)\nb = A @ x_exact  \nx = linalg.solve(A, b)","key":"pd7T2KK3zE"},{"type":"output","id":"7YTGC2wbLrbmUkCzJMyzL","data":[],"key":"K9cxZsMS7F"}],"key":"PkRBVp0FB2"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We got an answer. But in fact, the error does exceed 100%:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"owmBquzU7A"}],"key":"pLbGvY5ZMr"}],"key":"V9usnA1RHB"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:43:50.567501Z","iopub.status.busy":"2025-01-11T17:43:50.567429Z","iopub.status.idle":"2025-01-11T17:43:50.569064Z","shell.execute_reply":"2025-01-11T17:43:50.568852Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"print(f\"relative error: {norm(x - x_exact) / norm(x_exact):.2e}\")","key":"pWNbzSDe46"},{"type":"output","id":"c2D5IUN4AaGLnodIcuyer","data":[{"name":"stdout","output_type":"stream","text":"relative error: 1.42e+01\n"}],"key":"mDjl932RcD"}],"key":"HWYUacXqGF"}],"key":"id8yHOiXg1"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Matrix","url":"/matrix-2","group":"Chapter 2"},"next":{"title":"Banded","url":"/banded-2","group":"Chapter 2"}}},"domain":"http://localhost:3000"}