{"kind":"Notebook","sha256":"5abacf85a12787077a9d8f1890ec96a2b8edfd1afda731f026afc2f78932ad3c","slug":"stiff-1","location":"/chapter6/section7/matlab/stiff.ipynb","dependencies":[],"frontmatter":{"numbering":{"heading_1":{"enabled":false},"heading_2":{"enabled":false},"heading_3":{"enabled":false},"heading_4":{"enabled":false},"heading_5":{"enabled":false},"heading_6":{"enabled":false}},"kernelspec":{"name":"jupyter_matlab_kernel","display_name":"MATLAB Kernel","language":"matlab"},"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"exports":[{"format":"ipynb","filename":"stiff.ipynb","url":"/build/stiff-9c6a462fa3e59f1431ab66e9febe0492.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"e1M5yWafZi"},{"type":"text","value":"6.7.2","key":"OT8EEn9BQ2"}],"key":"WhHwZS8e3d"}],"identifier":"demo-implicit-stiff","label":"demo-implicit-stiff","kind":"proof:example","template":"Example %s","enumerator":"6.7.2","resolved":true,"html_id":"demo-implicit-stiff","remote":true,"url":"/implicit","dataUrl":"/implicit.json","key":"khLAQjjiXW"}],"key":"tDrwhAMIOt"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The following simple ","key":"HE5PyLNcd6"},{"type":"abbreviation","title":"ordinary differential equation","children":[{"type":"text","value":"ODE","key":"FjIsC3NIju"}],"key":"siZoeLRezD"},{"type":"text","value":" uncovers a surprise.","key":"OwPuBxFDsh"}],"key":"S076eLJeWZ"}],"key":"co6mKJaGg2"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"ivp = ode;\nivp.ODEFcn = @(t, u, p) u^2 - u^3;\nivp.InitialValue = 0.005;","key":"Qrr6WpePHI"},{"type":"output","id":"ThQED_DJqegF20BIe1GpZ","data":[],"key":"GdnjVKph5u"}],"key":"isudaUZXg3"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We will solve the problem first with the implicit AM2 method using ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mcMTmhgQSl"},{"type":"inlineMath","value":"n=200","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>=</mo><mn>200</mn></mrow><annotation encoding=\"application/x-tex\">n=200</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">200</span></span></span></span>","key":"TyZ6nXFTyV"},{"type":"text","value":" steps.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rFddM9zZsd"}],"key":"swltRNPfTN"}],"key":"YPJx1tJzFK"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"[tI, uI] = am2(ivp, 0, 400, 200);\nclf\nplot(tI, uI)\nxlabel(\"t\");  ylabel((\"u(t)\"));","key":"QCmCxOk99t"},{"type":"output","id":"3wEkf6SSO_twPwHRe0Nq1","data":[{"output_type":"execute_result","execution_count":3,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"a5b868bb1759313f50bfde45ab7d2103","path":"/build/a5b868bb1759313f50bfde45ab7d2103.png"}}}],"key":"l8S5xCrOcR"}],"key":"wtZ8FkuKFb"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now we repeat the process using the explicit AB4 method.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"NcwuxGXMfS"}],"key":"UYyhILA7AX"}],"key":"yQhiKiHwfF"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"[tE, uE] = ab4(ivp, 0, 400, 200);\nhold on\nplot(tE, uE, '.', 'markersize', 8)\nylim([-5, 3])\nlegend(\"AM2\", \"AB4\");","key":"Yvt3en5LnK"},{"type":"output","id":"SEc3OGD7ODUlaSW5tqcyT","data":[{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"321d54a84271b638c7e259c76b289158","path":"/build/321d54a84271b638c7e259c76b289158.png"}}}],"key":"hFf5uq95R4"}],"key":"YiwwHQlnHA"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Once the solution starts to take off, the AB4 result goes catastrophically wrong.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ATP4CmixcK"}],"key":"pI9lSekeKa"}],"key":"HqFhvV7Clo"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"format short e\nuE(105:111)","key":"nNv9yUbr6u"},{"type":"output","id":"DDZQ2AWrwP8fwFZEduU9E","data":[{"output_type":"execute_result","execution_count":5,"metadata":{},"data":{"text/plain":{"content":"ans = 1×7 double\n1.0e+00 *\n\n   7.5539e-01   1.4373e+00  -3.2890e+00   2.1418e+02  -4.4821e+07   4.1269e+23  -3.2214e+71\n","content_type":"text/plain"},"text/html":{"content":"<html><body><pre>ans = 1×7 double\n1.0e+00 *\n\n   7.5539e-01   1.4373e+00  -3.2890e+00   2.1418e+02  -4.4821e+07   4.1269e+23  -3.2214e+71\n</pre></body></html>","content_type":"text/html"}}}],"key":"B1bEXOyQpq"}],"key":"uauMTEgubM"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We hope that AB4 will converge in the limit ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"eezDMPrKRC"},{"type":"inlineMath","value":"h\\to 0","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>h</mi><mo>→</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">h\\to 0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">h</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"xSa5mx8lz7"},{"type":"text","value":", so let’s try using more steps.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"NO21A3BfLP"}],"key":"qJcA1LYp6H"}],"key":"AJS6UpvhlN"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"clf,  plot(tI, uI, '.', 'markersize', 10)\nhold on\n[tE, uE] = ab4(ivp, 0, 400, 1000);\nplot(tE, uE)\n[tE, uE] = ab4(ivp, 0, 400, 1600);\nplot(tE, uE)\nlegend(\"AM2, n=200\", \"AB4, n=1000\", \"AB4, n=1600\", location=\"northwest\");","key":"qpnQDH26Dm"},{"type":"output","id":"RKLAJ9pkw4-_0f8DxQT1l","data":[{"output_type":"execute_result","execution_count":6,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"81dec41f06acae3c595773a9312ed44a","path":"/build/81dec41f06acae3c595773a9312ed44a.png"}}}],"key":"M7VVIVCvRr"}],"key":"b0qwTZHsa2"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"So AB4, which is supposed to be ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"avaat5qOsZ"},{"type":"emphasis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"more","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hBA3rLdCGG"}],"key":"lz9z5aVcE8"},{"type":"text","value":" accurate than AM2, actually needs something like 8 times as many steps to get a reasonable-looking answer!","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jPbvsAizWs"}],"key":"E0GcIe7OLO"}],"key":"X9OaC2pX77"}],"key":"cpEWV9Ndmk"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Ab4","url":"/ab4-1","group":"Chapter 6"},"next":{"title":"LIAF","url":"/liaf-1","group":"Chapter 6"}}},"domain":"http://localhost:3000"}