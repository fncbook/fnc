{"version":1,"kind":"Notebook","sha256":"c2e83ae254cee704c1a9c6ac1a5cf8c0d3450fe9c7bb1b63210e568dea18df24","slug":"chapter10-2","location":"/python/chapter10.md","dependencies":[],"frontmatter":{"title":"Chapter 10","numbering":{"heading_1":{"enabled":false},"heading_2":{"enabled":false},"heading_3":{"enabled":false},"heading_4":{"enabled":false},"heading_5":{"enabled":false},"heading_6":{"enabled":false},"title":{"offset":2}},"kernelspec":{"name":"python3","display_name":"Python 3","language":"python"},"content_includes_title":false,"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","TPBVP":"two-point boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"edit_url":"https://github.com/fncbook/fnc/blob/master/python/chapter10.md","exports":[{"format":"md","filename":"chapter10.md","url":"/build/chapter10-974d0fc30828e31d9231784927831380.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Functions","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"zH1VkHYXDo"}],"identifier":"functions","label":"Functions","html_id":"functions","implicit":true,"key":"rkm6mS2Y2U"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Shooting method for a two-point boundary-value problem","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"k5yey5lAcK"}],"key":"cNVNZqCZEc"},{"type":"include","file":"fncbook/fncbook/chapter10.py","literal":true,"filter":{"startAt":"def shoot","endAt":"return x, u, du_dx"},"children":[{"type":"code","value":"def shoot(phi, a, b, ga, gb, init):\n    \"\"\"\n    shoot(phi, a, b, ga, gb, init)\n\n    Use the shooting method to solve a two-point boundary value problem. \n    The ODE is u'' = phi(x, u, u') for x in (a,b). The functions \n    ga(u(a), u'(a)) and gb(u(b), u'(b)) specify the boundary conditions. \n    The value init is an initial guess for [u(a), u'(a)].\n\n    Return vectors for the nodes, the values of u, and the values of u'.\n    \"\"\"\n\n    # Tolerances for IVP solver and rootfinder.\n    tol = 1e-5\n    # To be solved by the IVP solver\n    def shootivp(x, y):\n        return np.array([y[1], phi(x, y[0], y[1])])\n\n    # Evaluate the difference between computed and target values at x=b.\n    def objective(s):\n        nonlocal x, y  # change these values in outer scope\n\n        x = np.linspace(a, b, 400)  # make decent plots on return\n        sol = solve_ivp(shootivp, [a, b], s, atol=tol/10, rtol=tol/10, t_eval=x)\n        x = sol.t\n        y = sol.y\n        residual = np.array([ga(y[0, 0], y[1, 0]), gb(y[0, -1], y[0, -1])])\n        return residual\n\n    # Find the unknown quantity at x=a by rootfinding.\n    x, y = [], []    # the values will be overwritten\n    s = levenberg(objective, init, tol)\n\n    # Don't need to solve the IVP again. It was done within the\n    # objective function already.\n    u = y[0]        # solution\n    du_dx = y[1]    # derivative\n\n    return x, u, du_dx","lang":"python","showLineNumbers":true,"filename":"shoot.py","key":"W1DnY5mQDC"}],"key":"kdclKFloug"}],"label":"function-shoot-python","identifier":"function-shoot-python","html_id":"function-shoot-python","key":"UVloTFUu5F"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Second-order differentiation matrices","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"juyc3AuRQ5"}],"key":"Sypjylzcmm"},{"type":"include","file":"fncbook/fncbook/chapter10.py","literal":true,"filter":{"startAt":"def diffmat2","endAt":"return x, Dx, Dxx"},"children":[{"type":"code","value":"def diffmat2(n, xspan):\n    \"\"\"\n    diffmat2(n, xspan)\n\n    Compute 2nd-order-accurate differentiation matrices on n+1 points in the\n    interval xspan. Return a vector of nodes, and the matrices for the first\n    and second derivatives.\n    \"\"\"\n    a, b = xspan\n    h = (b - a) / n\n    x = np.linspace(a, b, n + 1)  # nodes\n\n    # Define most of Dx by its diagonals.\n    dp = 0.5 / h * np.ones(n)  # superdiagonal\n    dm = -0.5 / h * np.ones(n)  # subdiagonal\n    Dx = np.diag(dm, -1) + np.diag(dp, 1)\n\n    # Fix first and last rows.\n    Dx[0, :3] = np.array([-1.5, 2, -0.5]) / h\n    Dx[-1, -3:] = np.array([0.5, -2, 1.5]) / h\n\n    # Define most of Dxx by its diagonals.\n    d0 = -2 / h**2 * np.ones(n + 1)  # main diagonal\n    dp = np.ones(n) / h**2  # superdiagonal and subdiagonal\n    Dxx = np.diag(d0, 0) + np.diag(dp, -1) + np.diag(dp, 1)\n\n    # Fix first and last rows.\n    Dxx[0, :4] = np.array([2, -5, 4, -1]) / h**2\n    Dxx[-1, -4:] = np.array([-1, 4, -5, 2]) / h**2\n\n    return x, Dx, Dxx","lang":"python","showLineNumbers":true,"filename":"diffmat2.py","key":"jMv7vev4xe"}],"key":"MGKrLQmTdS"}],"label":"function-diffmat2-python","identifier":"function-diffmat2-python","html_id":"function-diffmat2-python","key":"mnyJV3FY1o"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Chebyshev differentiation matrices","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"key":"lOV9ANIAah"}],"key":"WLImt9EboD"},{"type":"include","file":"fncbook/fncbook/chapter10.py","literal":true,"filter":{"startAt":"def diffcheb","endAt":"return x, Dx, Dxx"},"children":[{"type":"code","value":"def diffcheb(n, xspan):\n    \"\"\"\n    diffcheb(n, xspan)\n\n    Compute Chebyshev differentiation matrices on n+1 points in the\n    interval xspan. Return a vector of nodes, and the matrices for the first\n    and second derivatives.\n    \"\"\"\n    x = -np.cos(np.arange(n + 1) * np.pi / n)  # nodes in [-1,1]\n    Dx = np.zeros([n + 1, n + 1])\n    c = np.hstack([2.0, np.ones(n - 1), 2.0])  # endpoint factors\n\n    # Off-diagonal entries\n    Dx = np.zeros([n + 1, n + 1])\n    for i in range(n + 1):\n        for j in range(n + 1):\n            if i != j:\n                Dx[i, j] = (-1) ** (i + j) * c[i] / (c[j] * (x[i] - x[j]))\n\n    # Diagonal entries by the \"negative sum trick\"\n    for i in range(n + 1):\n        Dx[i, i] = -np.sum([Dx[i, j] for j in range(n + 1) if j != i])\n\n    # Transplant to [a,b]\n    a, b = xspan\n    x = a + (b - a) * (x + 1) / 2\n    Dx = 2 * Dx / (b - a)\n\n    # Second derivative\n    Dxx = Dx @ Dx\n\n    return x, Dx, Dxx","lang":"python","showLineNumbers":true,"filename":"diffcheb.py","key":"q5gkbpElDF"}],"key":"wm6uyNH8Sh"}],"label":"function-diffcheb-python","identifier":"function-diffcheb-python","html_id":"function-diffcheb-python","key":"NugPtEV251"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Solution of a linear boundary-value problem","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"key":"OmdSxTkk9a"}],"key":"AzgxidvSDB"},{"type":"include","file":"fncbook/fncbook/chapter10.py","literal":true,"filter":{"startAt":"def bvplin(","endAt":"return x, u"},"children":[{"type":"code","value":"def bvplin(p, q, r, xspan, lval, rval, n):\n    \"\"\"\n        bvplin(p, q, r, xspan, lval, rval, n)\n\n    Use finite differences to solve a linear bopundary value problem. The ODE is\n    u''+p(x)u'+q(x)u = r(x) on the interval xspan, with endpoint function\n    values given as lval and rval. There will be n+1 equally spaced nodes,\n    including the endpoints.\n\n    Return vectors of the nodes and the solution values.\n    \"\"\"\n    x, Dx, Dxx = diffmat2(n, xspan)\n\n    P = np.diag(p(x))\n    Q = np.diag(q(x))\n    L = Dxx + P @ Dx + Q  # ODE expressed at the nodes\n\n    # Replace first and last rows using boundary conditions.\n    I = np.eye(n + 1)\n    A = np.vstack([I[0], L[1:-1], I[-1]])\n    b = np.hstack([lval, r(x[1:-1]), rval])\n\n    # Solve the system.\n    u = np.linalg.solve(A, b)\n\n    return x, u","lang":"python","showLineNumbers":true,"filename":"bvplin.py","key":"PYq8qKpMjK"}],"key":"ngBO4GUgJz"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"About the code","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"key":"X8ATSfP9YU"}],"key":"KDv5ITEiTv"},{"type":"paragraph","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"children":[{"type":"text","value":"Note that there is no need to explicitly form the row-deletion matrix ","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"key":"AL1VPgbW4J"},{"type":"inlineMath","value":"\\mathbf{E}","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">E</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{E}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">E</span></span></span></span>","key":"wGP2sed4Rh"},{"type":"text","value":" from ","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"key":"pdvOaOVVyk"},{"type":"crossReference","kind":"equation","identifier":"rowdeletion","label":"rowdeletion","children":[{"type":"text","value":"(","key":"Nt0JdrGkKG"},{"type":"text","value":"10.4.8","key":"JE5WlbOc4M"},{"type":"text","value":")","key":"D5tGUUIP0W"}],"template":"(%s)","enumerator":"10.4.8","resolved":true,"html_id":"rowdeletion","remote":true,"url":"/linear","dataUrl":"/linear.json","key":"PJc05EZORk"},{"type":"text","value":". Since it only appears as left-multiplying ","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"key":"sFHrCfSjOJ"},{"type":"inlineMath","value":"\\mathbf{L}","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">L</span></span></span></span>","key":"usKVqySuJ8"},{"type":"text","value":" or ","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"key":"L9JGUgAYY4"},{"type":"inlineMath","value":"\\mathbf{r}","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">r</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{r}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4444em;\"></span><span class=\"mord mathbf\">r</span></span></span></span>","key":"AbFF6MqjH4"},{"type":"text","value":", we simply perform the row deletions as needed using indexing.","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"key":"tg41WKo0Ex"}],"key":"zCo1As2j7E"}],"class":"dropdown","key":"AKLTDGA0pH"}],"label":"function-bvplin-python","identifier":"function-bvplin-python","html_id":"function-bvplin-python","key":"oLEgxkM4es"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Solution of a nonlinear boundary-value problem","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"key":"Hu0Mxo7akE"}],"key":"oRF7qJBvfJ"},{"type":"include","file":"fncbook/fncbook/chapter10.py","literal":true,"filter":{"startAt":"def bvp(","endAt":"return x"},"children":[{"type":"code","value":"def bvp(phi, xspan, ga, gb, init):\n    \"\"\"\n    bvp(phi, xspan, ga, gb, init)\n\n    Use finite differences to solve a two-point boundary value problem. \n    The ODE is u'' = phi(x, u, u') for x in (a,b). The functions \n    ga(u(a), u'(a)) and gb(u(b), u'(b)) specify the boundary conditions. \n    The value init is an initial guess for [u(a), u'(a)].\n\n    Return vectors for the nodes and the values of u.\n    \"\"\"\n    n = len(init) - 1\n    x, Dx, Dxx = diffmat2(n, xspan)\n    h = x[1] - x[0]\n    def residual(u):\n        # Compute the difference between u'' and phi(x,u,u') at the\n        # interior nodes and appends the error at the boundaries.\n        du_dx = Dx @ u  # discrete u'\n        d2u_dx2 = Dxx @ u  # discrete u''\n        f = d2u_dx2 - phi(x, u, du_dx)\n\n        # Replace first and last values by boundary conditions.\n        f[0] = ga(u[0], du_dx[0]) / h\n        f[n] = gb(u[n], du_dx[n]) / h\n        return f\n\n    u = levenberg(residual, init.copy())\n    return x, u[-1]","lang":"python","showLineNumbers":true,"filename":"bvp.py","key":"PbSyaHRakN"}],"key":"Ehp9d6BhOX"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"About the code","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"key":"TqPs2j3c02"}],"key":"f6vdtfEgSD"},{"type":"paragraph","position":{"start":{"line":78,"column":1},"end":{"line":78,"column":1}},"children":[{"type":"text","value":"The nested function ","position":{"start":{"line":78,"column":1},"end":{"line":78,"column":1}},"key":"dDi3JduQb2"},{"type":"inlineCode","value":"residual","position":{"start":{"line":78,"column":1},"end":{"line":78,"column":1}},"key":"QFnUNKD6L2"},{"type":"text","value":" uses differentiation matrices computed externally to it, rather than computing them anew on each invocation. As in ","position":{"start":{"line":78,"column":1},"end":{"line":78,"column":1}},"key":"l47ux07O4y"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-bvplin","label":"function-bvplin","children":[{"type":"text","value":"Function ","key":"Tvw5SDcV6m"},{"type":"text","value":"10.4.1","key":"F17Jpaxl7k"}],"template":"Algorithm %s","enumerator":"10.4.1","resolved":true,"html_id":"function-bvplin","remote":true,"url":"/linear","dataUrl":"/linear.json","key":"PWNYIXr2xa"},{"type":"text","value":", there is no need to form the row-deletion matrix ","position":{"start":{"line":78,"column":1},"end":{"line":78,"column":1}},"key":"ECLuVH3M2Y"},{"type":"inlineMath","value":"\\mathbf{E}","position":{"start":{"line":78,"column":1},"end":{"line":78,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">E</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{E}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">E</span></span></span></span>","key":"XsPdLBC4TI"},{"type":"text","value":" explicitly. In lines 23--24, we divide the values of ","position":{"start":{"line":78,"column":1},"end":{"line":78,"column":1}},"key":"izxrMUNOQC"},{"type":"inlineMath","value":"g_1","position":{"start":{"line":78,"column":1},"end":{"line":78,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>g</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">g_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"Agz8xuez5H"},{"type":"text","value":" and ","position":{"start":{"line":78,"column":1},"end":{"line":78,"column":1}},"key":"ZAkirAQ5JW"},{"type":"inlineMath","value":"g_2","position":{"start":{"line":78,"column":1},"end":{"line":78,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>g</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">g_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"XYQR9NFMbA"},{"type":"text","value":" by a factor of ","position":{"start":{"line":78,"column":1},"end":{"line":78,"column":1}},"key":"m1rvCccyAs"},{"type":"inlineMath","value":"h","position":{"start":{"line":78,"column":1},"end":{"line":78,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>h</mi></mrow><annotation encoding=\"application/x-tex\">h</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">h</span></span></span></span>","key":"VdfHZGcZ0Z"},{"type":"text","value":". This helps scale the residual components more uniformly and improves the robustness of convergence a bit.","position":{"start":{"line":78,"column":1},"end":{"line":78,"column":1}},"key":"kYQhFfAcl4"}],"key":"zMCUUAG1Po"}],"class":"dropdown","key":"UUUtGKcUT9"}],"label":"function-bvp-python","identifier":"function-bvp-python","html_id":"function-bvp-python","key":"uC0SLENJfD"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Piecewise linear finite elements for a linear ","key":"BS9JjoZxvq"},{"type":"abbreviation","title":"boundary-value problem","children":[{"type":"text","value":"BVP","key":"qTvHNKtnRY"}],"key":"nEjUVsEyzk"}],"key":"b0ULX1xpyF"},{"type":"include","file":"fncbook/fncbook/chapter10.py","literal":true,"filter":{"startAt":"def fem","endAt":"return x, u"},"children":[{"type":"code","value":"def fem(c, s, f, a, b, n):\n    \"\"\"\n    fem(c, s, f, a, b, n)\n\n    Use a piecewise linear finite element method to solve a two-point boundary\n    value problem. The ODE is (c(x)u')' + s(x)u = f(x) on the interval\n    [a,b], and the boundary values are zero. The discretization uses n equal\n    subintervals.\n\n    Return vectors for the nodes and the values of u.\n    \"\"\"\n    # Define the grid.\n    h = (b - a) / n\n    x = np.linspace(a, b, n + 1)\n\n    # Templates for the subinterval matrix and vector contributions.\n    Ke = np.array([[1, -1], [-1, 1]])\n    Me = (1 / 6) * np.array([[2, 1], [1, 2]])\n    fe = (1 / 2) * np.array([1, 1])\n\n    # Evaluate coefficent functions and find average values.\n    cval = c(x)\n    cbar = (cval[:-1] + cval[1:]) / 2\n    sval = s(x)\n    sbar = (sval[:-1] + sval[1:]) / 2\n    fval = f(x)\n    fbar = (fval[:-1] + fval[1:]) / 2\n\n    # Assemble global system, one interval at a time.\n    K = np.zeros([n - 1, n - 1])\n    M = np.zeros([n - 1, n - 1])\n    f = np.zeros(n - 1)\n    K[0, 0] = cbar[0] / h\n    M[0, 0] = sbar[0] * h / 3\n    f[0] = fbar[0] * h / 2\n    K[-1, -1] = cbar[-1] / h\n    M[-1, -1] = sbar[-1] * h / 3\n    f[-1] = fbar[-1] * h / 2\n    for k in range(1, n - 1):\n        K[k - 1 : k + 1, k - 1 : k + 1] += (cbar[k] / h) * Ke\n        M[k - 1 : k + 1, k - 1 : k + 1] += (sbar[k] * h) * Me\n        f[k - 1 : k + 1] += (fbar[k] * h) * fe\n\n    # Solve system for the interior values.\n    u = np.linalg.solve(K + M, f)\n    u = np.hstack([0, u, 0])  # put the boundary values into the result\n\n    return x, u","lang":"python","showLineNumbers":true,"filename":"fem.py","key":"MnhgJcKSBb"}],"key":"M0sdBKjFAr"}],"label":"function-fem-python","identifier":"function-fem-python","html_id":"function-fem-python","key":"auW5sa5OCw"},{"type":"heading","depth":2,"position":{"start":{"line":94,"column":1},"end":{"line":94,"column":1}},"children":[{"type":"text","value":"Examples","position":{"start":{"line":94,"column":1},"end":{"line":94,"column":1}},"key":"r9CazlMHyp"}],"identifier":"examples","label":"Examples","html_id":"examples","implicit":true,"key":"i8DFBNGObF"}],"key":"tPLFXl1YWK"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"exec(open(\"FNC_init.py\").read())","visibility":"show","key":"vIqdgMysV8"},{"type":"output","id":"MbG2_CPSW_nt8efU1b9mu","data":[],"visibility":"show","key":"Lz1FnW6EKY"}],"data":{"tags":[]},"visibility":"remove","key":"phfE3hyQqG"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"children":[{"type":"text","value":"10.1 ","position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"key":"ZSPJcYWGPw"},{"type":"link","identifier":"section-bvp-tpbvp","label":"section-bvp-tpbvp","kind":"narrative","position":{"start":{"line":101,"column":6},"end":{"line":101,"column":24}},"url":"/tpbvp","internal":true,"dataUrl":"/tpbvp.json","children":[{"type":"text","value":"Two-point BVP","key":"ShTS9r4HHw"}],"key":"g8Vat81hTM"}],"identifier":"id-10-1","label":"10.1 ","html_id":"id-10-1","implicit":true,"key":"USaM8cugNp"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-tpbvp-mems","label":"demo-tpbvp-mems","kind":"proof:example","position":{"start":{"line":104,"column":1},"end":{"line":104,"column":17}},"children":[{"type":"text","value":"Example ","key":"RcV86gk32K"},{"type":"text","value":"10.1.3","key":"lNegPyMY9r"}],"template":"Example %s","enumerator":"10.1.3","resolved":true,"html_id":"demo-tpbvp-mems","remote":true,"url":"/tpbvp","dataUrl":"/tpbvp.json","key":"KxmmtYPa9j"}],"key":"HV0iSR5qnR"},{"type":"paragraph","position":{"start":{"line":106,"column":1},"end":{"line":106,"column":1}},"children":[{"type":"text","value":"To solve this problem, we have to define functions for the ","key":"xRQ9SklIHd"},{"type":"abbreviation","title":"ordinary differential equation","children":[{"type":"text","value":"ODE","key":"fngJcDJTbE"}],"key":"ZR8Ys7NOzk"},{"type":"text","value":" and boundary conditions. The first, which is similar to what we do for solving ","key":"RZeuU2Nsa6"},{"type":"abbreviation","title":"initial-value problem","children":[{"type":"text","value":"IVP","key":"PuY1N00VAQ"}],"key":"TnoS6Uqlm7"},{"type":"text","value":"s, returns the computed values of ","key":"slIV54qX4Q"},{"type":"inlineMath","value":"y_1'","position":{"start":{"line":106,"column":1},"end":{"line":106,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msubsup><mi>y</mi><mn>1</mn><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msubsup></mrow><annotation encoding=\"application/x-tex\">y_1&#x27;</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.2481em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-2.4519em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2481em;\"><span></span></span></span></span></span></span></span></span></span>","key":"y9CpPcd3XV"},{"type":"text","value":" and ","position":{"start":{"line":106,"column":1},"end":{"line":106,"column":1}},"key":"LAi7jSWIz0"},{"type":"inlineMath","value":"y_2'","position":{"start":{"line":106,"column":1},"end":{"line":106,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msubsup><mi>y</mi><mn>2</mn><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msubsup></mrow><annotation encoding=\"application/x-tex\">y_2&#x27;</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.2481em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-2.4519em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2481em;\"><span></span></span></span></span></span></span></span></span></span>","key":"vADI1TsonA"},{"type":"text","value":" given values of the dependent and independent variable.","position":{"start":{"line":106,"column":1},"end":{"line":106,"column":1}},"key":"PG56o5jvLF"}],"key":"XXKRUKUdeJ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"lamb = 0.6\ndef ode(r, y):\n    return array([\n        y[1],\n        lamb / y[0]**2 - y[1] / r\n    ])","key":"sdl6igUL8A"},{"type":"output","id":"gOoZl6W8LS_nwMIECvOiP","data":[],"key":"K70FNd3Oos"}],"data":{},"key":"jWYRKsODCn"},{"type":"paragraph","position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"children":[{"type":"text","value":"To encode the boundary conditions ","position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"key":"VbrigYjEGI"},{"type":"inlineMath","value":"y_2(0)=0","position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>y</mi><mn>2</mn></msub><mo stretchy=\"false\">(</mo><mn>0</mn><mo stretchy=\"false\">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">y_2(0)=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"RJtIchm5lq"},{"type":"text","value":", ","position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"key":"aSQuCLWPj6"},{"type":"inlineMath","value":"y_1(2)-1=0","position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>y</mi><mn>1</mn></msub><mo stretchy=\"false\">(</mo><mn>2</mn><mo stretchy=\"false\">)</mo><mo>−</mo><mn>1</mn><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">y_1(2)-1=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\">2</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"jpGEayEspK"},{"type":"text","value":", we define a function for their residual values. In other words, these are quantities that the solver has to make zero in order to satisfy the boundary conditions.","position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"key":"mRScZ3PS7s"}],"key":"XZqBCFEx4G"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def bc(ya, yb):    # given vectors y(a), y(b)\n    return array([\n        ya[1],\n        yb[0] - 1\n    ])","key":"PEdJr1Ridg"},{"type":"output","id":"q89i9I8RAYtPRarq6qwlM","data":[],"key":"Pz0SwnNEey"}],"data":{},"key":"sdE2d33X61"},{"type":"paragraph","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"children":[{"type":"text","value":"The domain of the mathematical problem is ","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"key":"FE10JiDJJj"},{"type":"inlineMath","value":"r\\in [0,1]","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>r</mi><mo>∈</mo><mo stretchy=\"false\">[</mo><mn>0</mn><mo separator=\"true\">,</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">r\\in [0,1]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]</span></span></span></span>","key":"G5Bk3IqVMz"},{"type":"text","value":". However, there is a division by ","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"key":"w5bfRdXsmm"},{"type":"inlineMath","value":"r","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>r</mi></mrow><annotation encoding=\"application/x-tex\">r</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span></span></span></span>","key":"JTLjNaGHaL"},{"type":"text","value":" in this ","key":"AMQM7xqWfI"},{"type":"abbreviation","title":"ordinary differential equation","children":[{"type":"text","value":"ODE","key":"OVoP3NKtXc"}],"key":"ihoYQPSkrB"},{"type":"text","value":", so we want to avoid ","key":"UtepC7ukjQ"},{"type":"inlineMath","value":"r=0","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>r</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">r=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"pxE7lvUBWk"},{"type":"text","value":" by truncating the domain a bit.","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"key":"qTYj75sO0O"}],"key":"H1CceUYYHe"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"a, b = finfo(float).eps, 1","key":"mAkeDFP8Jw"},{"type":"output","id":"x3pDvYhucA24IA_B1V7Vp","data":[],"key":"a2TDYzWtOW"}],"data":{},"key":"ECAGoH24Gr"},{"type":"paragraph","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"children":[{"type":"text","value":"We need one last ingredient that is not part of the mathematical specification: an initial guess for the solution ","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"key":"yfxCsPfAAr"},{"type":"inlineMath","value":"\\mathbf{y}(r)","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">y</mi><mo stretchy=\"false\">(</mo><mi>r</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\mathbf{y}(r)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">y</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mclose\">)</span></span></span></span>","key":"rkCoM2dm9Q"},{"type":"text","value":". As we will see, this plays the same role as initialization in Newton’s method for rootfinding. Here, we try a constant value for each component.","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"key":"lWnXNy5xon"}],"key":"zHhWbj1lhs"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"r = linspace(a, b, 50)\nw = ones(r.size)         # w(r) = 1 everywhere\ndw_dr = zeros(r.size)    # w'(r) = 0 everywhere\ny_init = vstack([w, dw_dr])","key":"O09GceoaDz"},{"type":"output","id":"rNCWOCLU5SFHMK2GsrbgR","data":[],"key":"nKxTU4nqu3"}],"data":{},"key":"Y4zu6ZOU5Y"},{"type":"paragraph","position":{"start":{"line":142,"column":1},"end":{"line":142,"column":1}},"children":[{"type":"text","value":"Now we can solve the problem using ","position":{"start":{"line":142,"column":1},"end":{"line":142,"column":1}},"key":"RjERQcAOeX"},{"type":"inlineCode","value":"solve_bvp","position":{"start":{"line":142,"column":1},"end":{"line":142,"column":1}},"key":"KlQ9mEtnPD"},{"type":"text","value":" from ","position":{"start":{"line":142,"column":1},"end":{"line":142,"column":1}},"key":"u1P1SixW5s"},{"type":"inlineCode","value":"scipy.integrate","position":{"start":{"line":142,"column":1},"end":{"line":142,"column":1}},"key":"Z9aSXyX0sa"},{"type":"text","value":".","position":{"start":{"line":142,"column":1},"end":{"line":142,"column":1}},"key":"YgL7jY6w65"}],"key":"GbcqUGd2zk"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from scipy.integrate import solve_bvp\nsol = solve_bvp(ode, bc, r, y_init)\nprint(f\"Solved at {sol.x.size} nodes.\")\nplot(sol.x, sol.y[0])\nxlabel(\"$r$\"),  ylabel(\"$w(r)$\")\ntitle(\"Solution of MEMS problem for $\\\\lambda=0.6$\");","key":"ZxGT8gPOEN"},{"type":"output","id":"BDHFTo1fLz7ae7UWC51Zk","data":[{"output_type":"stream","name":"stdout","text":"Solved at 998 nodes.\n"},{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"2cfea2baa81ef9ec1f3e473e9e6c062f","path":"/build/2cfea2baa81ef9ec1f3e473e9e6c062f.png"}}}],"key":"GsM13YyOlA"}],"data":{},"key":"HXyrrEYuXP"},{"type":"paragraph","position":{"start":{"line":153,"column":1},"end":{"line":153,"column":1}},"children":[{"type":"text","value":"It’s important to visually check the boundary conditions. The left BC implies a horizontal tangent at ","position":{"start":{"line":153,"column":1},"end":{"line":153,"column":1}},"key":"xzLMdXtFCZ"},{"type":"inlineMath","value":"r=0","position":{"start":{"line":153,"column":1},"end":{"line":153,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>r</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">r=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"rfZWqkvlW2"},{"type":"text","value":", and the right BC implies that ","position":{"start":{"line":153,"column":1},"end":{"line":153,"column":1}},"key":"hWafwZ0wwh"},{"type":"inlineMath","value":"w(1)=1","position":{"start":{"line":153,"column":1},"end":{"line":153,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>w</mi><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">w(1)=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"cDhM7P4xug"},{"type":"text","value":". If the solver failed to satisfy these conditions, we would have to try a different initial guess.","position":{"start":{"line":153,"column":1},"end":{"line":153,"column":1}},"key":"iSNTQhUDPI"}],"key":"y0Jxs4WgUM"}],"label":"demo-tpbvp-mems-python","identifier":"demo-tpbvp-mems-python","html_id":"demo-tpbvp-mems-python","key":"zB2Wgs1kyr"},{"type":"heading","depth":3,"position":{"start":{"line":157,"column":1},"end":{"line":157,"column":1}},"children":[{"type":"text","value":"10.2 ","position":{"start":{"line":157,"column":1},"end":{"line":157,"column":1}},"key":"ID65PWTnoy"},{"type":"link","identifier":"section-bvp-shooting","label":"section-bvp-shooting","kind":"narrative","position":{"start":{"line":157,"column":6},"end":{"line":157,"column":27}},"url":"/shooting","internal":true,"dataUrl":"/shooting.json","children":[{"type":"text","value":"Shooting","key":"B6EfAFyZOt"}],"key":"HGZz1kwiki"}],"identifier":"id-10-2","label":"10.2 ","html_id":"id-10-2","implicit":true,"key":"zclyBX0uIC"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-shooting-naive","label":"demo-shooting-naive","kind":"proof:example","position":{"start":{"line":159,"column":1},"end":{"line":159,"column":21}},"children":[{"type":"text","value":"Example ","key":"cQpfwZudfc"},{"type":"text","value":"10.2.1","key":"xWdSzkGmT6"}],"template":"Example %s","enumerator":"10.2.1","resolved":true,"html_id":"demo-shooting-naive","remote":true,"url":"/shooting","dataUrl":"/shooting.json","key":"fzfrEqUKOx"}],"key":"t5BqsRFFyN"},{"type":"paragraph","position":{"start":{"line":162,"column":1},"end":{"line":162,"column":1}},"children":[{"type":"text","value":"Let’s first examine the shooting approach for the ","key":"Ikp5IfXHl1"},{"type":"abbreviation","title":"two-point boundary-value problem","children":[{"type":"text","value":"TPBVP","key":"bWbGZiX4X4"}],"key":"n6ZCFrXOoh"},{"type":"text","value":" from ","key":"GdEV47CZbv"},{"type":"crossReference","kind":"proof:example","identifier":"example-tpbvp-mems","label":"example-tpbvp-mems","children":[{"type":"text","value":"Example ","key":"EPSAuj1i2Z"},{"type":"text","value":"10.1.2","key":"KnDSBq7cpk"}],"template":"Example %s","enumerator":"10.1.2","resolved":true,"html_id":"example-tpbvp-mems","remote":true,"url":"/tpbvp","dataUrl":"/tpbvp.json","key":"kQr1bbiJBg"},{"type":"text","value":" with ","position":{"start":{"line":162,"column":1},"end":{"line":162,"column":1}},"key":"eFhPh4kEv7"},{"type":"inlineMath","value":"\\lambda=0.6","position":{"start":{"line":162,"column":1},"end":{"line":162,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>λ</mi><mo>=</mo><mn>0.6</mn></mrow><annotation encoding=\"application/x-tex\">\\lambda=0.6</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">λ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0.6</span></span></span></span>","key":"xYHUaSXXkQ"},{"type":"text","value":".","position":{"start":{"line":162,"column":1},"end":{"line":162,"column":1}},"key":"Y9vg9MZQTI"}],"key":"mrPl9Ooimf"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"lamb = 0.6\nphi = lambda r, w, dw_dr: lamb / w**2 - dw_dr / r","key":"Q8CkGICtFq"},{"type":"output","id":"kQIJx9wP9fUuljt87IV2b","data":[],"key":"VMs5c1veXf"}],"data":{},"key":"bsTURg55MN"},{"type":"paragraph","position":{"start":{"line":169,"column":1},"end":{"line":169,"column":1}},"children":[{"type":"text","value":"We convert the ","key":"LaHw1p29N0"},{"type":"abbreviation","title":"ordinary differential equation","children":[{"type":"text","value":"ODE","key":"f7TlvLIamu"}],"key":"yYd5K7p2G7"},{"type":"text","value":" to a first-order system in order to apply a numerical method. We also have to truncate the domain to avoid division by zero.","key":"wUrYRFt04O"}],"key":"NnNsXfKsPF"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"f = lambda r, y: hstack([y[1], phi(r, y[0], y[1])])\na, b = finfo(float).eps, 1","key":"TnidcxRpxB"},{"type":"output","id":"DeFS_ADYMiWB9gCNVyunL","data":[],"key":"r65oXktyBI"}],"data":{},"key":"Co1z6JGrWB"},{"type":"paragraph","position":{"start":{"line":176,"column":1},"end":{"line":176,"column":1}},"children":[{"type":"text","value":"The ","key":"CdqTyyWv2j"},{"type":"abbreviation","title":"boundary-value problem","children":[{"type":"text","value":"BVP","key":"PdMeHtA5IS"}],"key":"stUlhwV9qc"},{"type":"text","value":" specifies ","key":"JA25yQ6TT8"},{"type":"inlineMath","value":"w'(0)=y_2(0)=0","position":{"start":{"line":176,"column":1},"end":{"line":176,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>w</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo stretchy=\"false\">(</mo><mn>0</mn><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mi>y</mi><mn>2</mn></msub><mo stretchy=\"false\">(</mo><mn>0</mn><mo stretchy=\"false\">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">w&#x27;(0)=y_2(0)=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0019em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"JSPV3ZBMiG"},{"type":"text","value":". We can try multiple values for the unknown ","position":{"start":{"line":176,"column":1},"end":{"line":176,"column":1}},"key":"bgpErLzSWm"},{"type":"inlineMath","value":"w(0)=y_1(0)","position":{"start":{"line":176,"column":1},"end":{"line":176,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>w</mi><mo stretchy=\"false\">(</mo><mn>0</mn><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mi>y</mi><mn>1</mn></msub><mo stretchy=\"false\">(</mo><mn>0</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">w(0)=y_1(0)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mclose\">)</span></span></span></span>","key":"I4GK5h8MVl"},{"type":"text","value":" and plot the solutions.","position":{"start":{"line":176,"column":1},"end":{"line":176,"column":1}},"key":"NuRKMawh2Y"}],"key":"VU8KnbDpgS"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from scipy.integrate import solve_ivp\nt = linspace(a, b, 400)\nfor w0 in arange(0.4, 1.0, 0.1):\n    sol = solve_ivp(f, [a, b], [w0, 0], t_eval=t)\n    plot(t, sol.y[0], label=f\"$w_0$ = {w0:.1f}\")\n\nxlabel(\"$r$\"),  ylabel(\"$w(r)$\")\nlegend(),  grid(True)\ntitle(\"Solutions for choices of w(0)\");","key":"n9LkmlhyTw"},{"type":"output","id":"uc1PZ5ajjNhJJRPD_PcPH","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"f337c1ec6b34c3056a26e7d945056b8e","path":"/build/f337c1ec6b34c3056a26e7d945056b8e.png"}}}],"key":"rul3dt4hRO"}],"data":{},"key":"veisJ1fKZJ"},{"type":"paragraph","position":{"start":{"line":190,"column":1},"end":{"line":190,"column":1}},"children":[{"type":"text","value":"On the graph, it’s the curve starting at ","position":{"start":{"line":190,"column":1},"end":{"line":190,"column":1}},"key":"D9kysf6Kze"},{"type":"inlineMath","value":"w(0)=0.8","position":{"start":{"line":190,"column":1},"end":{"line":190,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>w</mi><mo stretchy=\"false\">(</mo><mn>0</mn><mo stretchy=\"false\">)</mo><mo>=</mo><mn>0.8</mn></mrow><annotation encoding=\"application/x-tex\">w(0)=0.8</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0.8</span></span></span></span>","key":"aosoVNmbok"},{"type":"text","value":" that comes closest to the required condition ","position":{"start":{"line":190,"column":1},"end":{"line":190,"column":1}},"key":"i0GLoh6kei"},{"type":"inlineMath","value":"w(1)=1","position":{"start":{"line":190,"column":1},"end":{"line":190,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>w</mi><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">w(1)=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"xcmzbU5QJJ"},{"type":"text","value":", but it’s a bit too large.","position":{"start":{"line":190,"column":1},"end":{"line":190,"column":1}},"key":"OFx0ct2Owv"}],"key":"uQtFdxofEV"}],"label":"demo-shooting-naive-python","identifier":"demo-shooting-naive-python","html_id":"demo-shooting-naive-python","key":"kFDOBOnc78"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-shooting-mems","label":"demo-shooting-mems","kind":"proof:example","position":{"start":{"line":194,"column":1},"end":{"line":194,"column":20}},"children":[{"type":"text","value":"Example ","key":"LSwWxwuLoK"},{"type":"text","value":"10.2.2","key":"sbpswXfvN0"}],"template":"Example %s","enumerator":"10.2.2","resolved":true,"html_id":"demo-shooting-mems","remote":true,"url":"/shooting","dataUrl":"/shooting.json","key":"TBrfdDHXSa"}],"key":"vd62CtK6oc"},{"type":"paragraph","position":{"start":{"line":196,"column":1},"end":{"line":196,"column":1}},"children":[{"type":"text","value":"We revisit ","position":{"start":{"line":196,"column":1},"end":{"line":196,"column":1}},"key":"zyoptYj4hM"},{"type":"crossReference","kind":"proof:example","identifier":"demo-shooting-naive","label":"demo-shooting-naive","children":[{"type":"text","value":"Demo ","key":"F79POIc0RZ"},{"type":"text","value":"10.2.1","key":"CYC7NlyLMj"}],"template":"Example %s","enumerator":"10.2.1","resolved":true,"html_id":"demo-shooting-naive","remote":true,"url":"/shooting","dataUrl":"/shooting.json","key":"lVdMUYza4z"},{"type":"text","value":" but let ","position":{"start":{"line":196,"column":1},"end":{"line":196,"column":1}},"key":"ROLipkJFpA"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-shoot","label":"function-shoot","children":[{"type":"text","value":"Function ","key":"PxK1KCRdn6"},{"type":"text","value":"10.2.1","key":"N9XXJrWMlt"}],"template":"Algorithm %s","enumerator":"10.2.1","resolved":true,"html_id":"function-shoot","remote":true,"url":"/shooting","dataUrl":"/shooting.json","key":"uKF0W0LPsA"},{"type":"text","value":" do the heavy lifting.","position":{"start":{"line":196,"column":1},"end":{"line":196,"column":1}},"key":"z1Boqay2L6"}],"key":"I1KU9cRnj6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"lamb = 0.6\nphi = lambda r, w, dwdr: lamb / w**2 - dwdr / r\na, b = finfo(float).eps, 1","key":"eaNlMORXBH"},{"type":"output","id":"18twmoCAF1p5B0jFjzghl","data":[],"key":"kBhq4vLjTD"}],"data":{},"key":"Ns5Bn86xUH"},{"type":"paragraph","position":{"start":{"line":204,"column":1},"end":{"line":204,"column":1}},"children":[{"type":"text","value":"We specify the given and unknown endpoint values.","position":{"start":{"line":204,"column":1},"end":{"line":204,"column":1}},"key":"g9fClNKo3s"}],"key":"h3hyZOVCgy"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ga = lambda w, dw : dw       # w'=0 at left\ngb = lambda w, dw : w - 1    # w=1 at right","key":"Xx3ALroVLu"},{"type":"output","id":"nRZSQM6EqeXnBtTdUmqpl","data":[],"key":"e7NwHYQ3Or"}],"data":{},"key":"fYXQDZZwFG"},{"type":"paragraph","position":{"start":{"line":211,"column":1},"end":{"line":211,"column":1}},"children":[{"type":"text","value":"In this setting, we need to provide initial guesses for ","position":{"start":{"line":211,"column":1},"end":{"line":211,"column":1}},"key":"SeMfIU2uq6"},{"type":"inlineMath","value":"w(a)","position":{"start":{"line":211,"column":1},"end":{"line":211,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>w</mi><mo stretchy=\"false\">(</mo><mi>a</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">w(a)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">a</span><span class=\"mclose\">)</span></span></span></span>","key":"S2EIbZ6gfF"},{"type":"text","value":" and ","position":{"start":{"line":211,"column":1},"end":{"line":211,"column":1}},"key":"di6cLq2Fym"},{"type":"inlineMath","value":"w'(a)","position":{"start":{"line":211,"column":1},"end":{"line":211,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>w</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo stretchy=\"false\">(</mo><mi>a</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">w&#x27;(a)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0019em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">a</span><span class=\"mclose\">)</span></span></span></span>","key":"cR6qIu8tKD"},{"type":"text","value":".","position":{"start":{"line":211,"column":1},"end":{"line":211,"column":1}},"key":"CEjtfiAPLN"}],"key":"yIKtart0hl"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"init = array([0.8, 0])\nr, w, dw_dx = FNC.shoot(phi, a, b, ga, gb, init)\nplot(r, w)\ntitle(\"Shooting solution\")\nxlabel(\"$r$\"),  ylabel(\"$w(r)$\");","key":"Y2DufirSGq"},{"type":"output","id":"ARyAVQ0eQM5L6X7Rza14n","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"54763b31afad2315d5f48edf000e1fd2","path":"/build/54763b31afad2315d5f48edf000e1fd2.png"}}}],"key":"iWfUhwCTp6"}],"data":{},"key":"gx6ZOiTbgx"},{"type":"paragraph","position":{"start":{"line":221,"column":1},"end":{"line":221,"column":1}},"children":[{"type":"text","value":"The value of ","position":{"start":{"line":221,"column":1},"end":{"line":221,"column":1}},"key":"Uo6435ApwE"},{"type":"inlineMath","value":"w","position":{"start":{"line":221,"column":1},"end":{"line":221,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>w</mi></mrow><annotation encoding=\"application/x-tex\">w</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span></span></span></span>","key":"AwsPn1cSpe"},{"type":"text","value":" at ","position":{"start":{"line":221,"column":1},"end":{"line":221,"column":1}},"key":"WRNzv4id1j"},{"type":"inlineMath","value":"r=1","position":{"start":{"line":221,"column":1},"end":{"line":221,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>r</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">r=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"L3746DE9p9"},{"type":"text","value":", meant to be exactly one, was computed to be","position":{"start":{"line":221,"column":1},"end":{"line":221,"column":1}},"key":"ybqnRbUHUy"}],"key":"gjuegVrNEr"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(f\"w at right end is {w[-1]}\")","key":"i9LzZENbZD"},{"type":"output","id":"q9YCUveg-Rf8RMWmwrxXW","data":[{"output_type":"stream","name":"stdout","text":"w at right end is 1.0000010017900354\n"}],"key":"Scxxn6PAGR"}],"data":{},"key":"nb3gGNcIFn"},{"type":"paragraph","position":{"start":{"line":227,"column":1},"end":{"line":227,"column":1}},"children":[{"type":"text","value":"The accuracy is consistent with the error tolerance used for the ","key":"im0TaZ493q"},{"type":"abbreviation","title":"initial-value problem","children":[{"type":"text","value":"IVP","key":"mN8UkCNOvt"}],"key":"JN8rqy3SvP"},{"type":"text","value":" solution by ","key":"pFaidhSwio"},{"type":"inlineCode","value":"shoot","position":{"start":{"line":227,"column":1},"end":{"line":227,"column":1}},"key":"u79TcRbeQ5"},{"type":"text","value":". The initial value ","position":{"start":{"line":227,"column":1},"end":{"line":227,"column":1}},"key":"g8cSG9QkFO"},{"type":"inlineMath","value":"w(0)","position":{"start":{"line":227,"column":1},"end":{"line":227,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>w</mi><mo stretchy=\"false\">(</mo><mn>0</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">w(0)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mclose\">)</span></span></span></span>","key":"e20gjWEvo2"},{"type":"text","value":" that gave this solution is","position":{"start":{"line":227,"column":1},"end":{"line":227,"column":1}},"key":"JUqasB41JY"}],"key":"QvZDw8SAxJ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(f\"w at left end is {w[0]}\")","key":"VYoXuprz0P"},{"type":"output","id":"IaQOyC_hpCti1hFpTHXXt","data":[{"output_type":"stream","name":"stdout","text":"w at left end is 0.7877599056161069\n"}],"key":"MA4cYZO9gJ"}],"data":{},"key":"QG4ruNp8TZ"}],"label":"demo-shooting-mems-python","identifier":"demo-shooting-mems-python","html_id":"demo-shooting-mems-python","key":"TLjMD3fHZS"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-shooting-unstable","label":"demo-shooting-unstable","kind":"proof:example","position":{"start":{"line":235,"column":1},"end":{"line":235,"column":24}},"children":[{"type":"text","value":"Example ","key":"NXYcjxMWEm"},{"type":"text","value":"10.2.3","key":"p1CNwSrSfj"}],"template":"Example %s","enumerator":"10.2.3","resolved":true,"html_id":"demo-shooting-unstable","remote":true,"url":"/shooting","dataUrl":"/shooting.json","key":"Z6x1UF9KDy"}],"key":"nmv9daytVt"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ga = lambda u, du : u + 1    # u=-1 at left\ngb = lambda u, du : u        # u= 0 at right\ninit = array([-1, 0])\nfor lamb in range(6, 22, 4):\n    phi = lambda x, u, du_dx: lamb**2 * u + lamb**2\n    x, u, du_dx = FNC.shoot(phi, 0.0, 1.0, ga, gb, init)\n    plot(x, u, label=f\"$\\\\lambda$ = {lamb:.1f}\")\n\nxlabel(\"$x$\"),  ylabel(\"$u(x)$\"),  ylim(-1.0, 0.25)\ngrid(True),  legend(loc=\"upper left\")\ntitle(\"Shooting instability\");","key":"KNoADVh8ms"},{"type":"output","id":"ja85RfPJvgbBIZTQIElqt","data":[{"output_type":"stream","name":"stderr","text":"/Users/driscoll/Dropbox/Mac/Documents/GitHub/fnc/python/fncbook/fncbook/chapter04.py:167: UserWarning: Iteration did not find a root.\n  warnings.warn(\"Iteration did not find a root.\")\n"},{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"db7a32375999e1d5be10b06f99704448","path":"/build/db7a32375999e1d5be10b06f99704448.png"}}}],"key":"aT8wOBF9LT"}],"data":{},"key":"UfscmMjs64"},{"type":"paragraph","position":{"start":{"line":252,"column":1},"end":{"line":252,"column":1}},"children":[{"type":"text","value":"The numerical solutions evidently don’t satisfy the right boundary condition as ","position":{"start":{"line":252,"column":1},"end":{"line":252,"column":1}},"key":"Wi8CC7Edd5"},{"type":"text","value":"λ","position":{"start":{"line":252,"column":1},"end":{"line":252,"column":1}},"key":"y5Zkb9kYe1"},{"type":"text","value":" increases, which makes them invalid.","position":{"start":{"line":252,"column":1},"end":{"line":252,"column":1}},"key":"PqNSjQXoLe"}],"key":"oiqQg3iVSR"}],"label":"demo-shooting-unstable-python","identifier":"demo-shooting-unstable-python","html_id":"demo-shooting-unstable-python","key":"w2q4J2dno0"},{"type":"heading","depth":3,"position":{"start":{"line":256,"column":1},"end":{"line":256,"column":1}},"children":[{"type":"text","value":"10.3 ","position":{"start":{"line":256,"column":1},"end":{"line":256,"column":1}},"key":"Ruta2EpElH"},{"type":"link","identifier":"section-bvp-diffmats","label":"section-bvp-diffmats","kind":"narrative","position":{"start":{"line":256,"column":6},"end":{"line":256,"column":27}},"url":"/diffmats","internal":true,"dataUrl":"/diffmats.json","children":[{"type":"text","value":"Differentiation matrices","key":"SOqYivv2xq"}],"key":"BppIROE9gL"}],"identifier":"id-10-3","label":"10.3 ","html_id":"id-10-3","implicit":true,"key":"EyrcpJLng9"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-diffmats-2nd","label":"demo-diffmats-2nd","kind":"proof:example","position":{"start":{"line":258,"column":1},"end":{"line":258,"column":19}},"children":[{"type":"text","value":"Example ","key":"j7pPHfy3sT"},{"type":"text","value":"10.3.1","key":"J7Bn1ddMjX"}],"template":"Example %s","enumerator":"10.3.1","resolved":true,"html_id":"demo-diffmats-2nd","remote":true,"url":"/diffmats","dataUrl":"/diffmats.json","key":"ZLJoTGxy5v"}],"key":"gFpSpSdQMn"},{"type":"paragraph","position":{"start":{"line":260,"column":1},"end":{"line":260,"column":1}},"children":[{"type":"text","value":"We test first-order and second-order differentiation matrices for the function ","position":{"start":{"line":260,"column":1},"end":{"line":260,"column":1}},"key":"QwDilPoq3a"},{"type":"inlineMath","value":"x + \\exp(\\sin 4x)","position":{"start":{"line":260,"column":1},"end":{"line":260,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mo>+</mo><mi>exp</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mi>sin</mi><mo>⁡</mo><mn>4</mn><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">x + \\exp(\\sin 4x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop\">exp</span><span class=\"mopen\">(</span><span class=\"mop\">sin</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">4</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span>","key":"rgIRX7jwva"},{"type":"text","value":" over ","position":{"start":{"line":260,"column":1},"end":{"line":260,"column":1}},"key":"YbEqPwGggT"},{"type":"inlineMath","value":"[-1,1]","position":{"start":{"line":260,"column":1},"end":{"line":260,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mo>−</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[-1,1]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">−</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]</span></span></span></span>","key":"PdiOeKtlJj"},{"type":"text","value":".","position":{"start":{"line":260,"column":1},"end":{"line":260,"column":1}},"key":"g8opRWbTK3"}],"key":"yYb2M4hrt4"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"f = lambda x: x + exp( sin(4 * x) )","key":"VPpNqsDfLH"},{"type":"output","id":"kcZ4uCtXGSfdRCOShWLM7","data":[],"key":"svGCQr9eg7"}],"data":{},"key":"IoMCLtvz4M"},{"type":"paragraph","position":{"start":{"line":266,"column":1},"end":{"line":266,"column":1}},"children":[{"type":"text","value":"For reference, here are the exact first and second derivatives.","position":{"start":{"line":266,"column":1},"end":{"line":266,"column":1}},"key":"kLta8eeASA"}],"key":"qwlH8TacLU"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"df_dx = lambda x: 1 + 4 * exp(sin(4 * x)) * cos(4 * x)\nd2f_dx2 = lambda x: 4 * exp(sin(4 * x)) * (4 * cos(4 * x)**2 - 4 * sin(4 * x))","key":"BFWWSP67Y3"},{"type":"output","id":"6FvIklhP14Y6aS6rwfmEa","data":[],"key":"G1IuXnJpm1"}],"data":{},"key":"zGbRIFbZxJ"},{"type":"paragraph","position":{"start":{"line":273,"column":1},"end":{"line":273,"column":1}},"children":[{"type":"text","value":"We discretize on equally spaced nodes and evaluate ","position":{"start":{"line":273,"column":1},"end":{"line":273,"column":1}},"key":"bRNeNytqgv"},{"type":"inlineMath","value":"f","position":{"start":{"line":273,"column":1},"end":{"line":273,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>","key":"togSWsEkfj"},{"type":"text","value":" at the nodes.","position":{"start":{"line":273,"column":1},"end":{"line":273,"column":1}},"key":"jqXiArQvxW"}],"key":"vNGsojdWvz"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"t, Dx, Dxx = FNC.diffmat2(12, [-1, 1])\ny = f(t)","key":"undBEqjWtQ"},{"type":"output","id":"sF3HSRg1HuzVnXno2MiRT","data":[],"key":"IoSmLBpjxJ"}],"data":{},"key":"zTDp39VFyS"},{"type":"paragraph","position":{"start":{"line":280,"column":1},"end":{"line":280,"column":1}},"children":[{"type":"text","value":"Then the first two derivatives of ","position":{"start":{"line":280,"column":1},"end":{"line":280,"column":1}},"key":"MA1ahLVVCR"},{"type":"inlineMath","value":"f","position":{"start":{"line":280,"column":1},"end":{"line":280,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>","key":"LjKW9iFLYx"},{"type":"text","value":" each require one matrix-vector multiplication.","position":{"start":{"line":280,"column":1},"end":{"line":280,"column":1}},"key":"keYzE1GCWD"}],"key":"zWtfRFeks6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"yx = Dx @ y\nyxx = Dxx @ y","key":"V3b0zvIChn"},{"type":"output","id":"Y7BrQNG6EAlOAcs6z468x","data":[],"key":"XEwDvV12YW"}],"data":{},"key":"FoOfNwhncX"},{"type":"paragraph","position":{"start":{"line":287,"column":1},"end":{"line":287,"column":1}},"children":[{"type":"text","value":"The results show poor accuracy for this small value of ","position":{"start":{"line":287,"column":1},"end":{"line":287,"column":1}},"key":"Db92INUhrG"},{"type":"inlineMath","value":"n","position":{"start":{"line":287,"column":1},"end":{"line":287,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"Nsz3hyf7BW"},{"type":"text","value":".","position":{"start":{"line":287,"column":1},"end":{"line":287,"column":1}},"key":"C47zCPnaJs"}],"key":"yp5fjiXHDY"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"x = linspace(-1, 1, 500)\nsubplot(2, 1, 1)\nplot(x, df_dx(x))\nplot(t, yx, \"ko\")\nxlabel(\"$x$\"),  ylabel(\"$f'(x)$\")\n\nsubplot(2, 1, 2)\nplot(x, d2f_dx2(x))\nplot(t, yxx, \"ko\")\nxlabel(\"$x$\"),  ylabel(\"$f''(x)$\");","key":"wM4na2Daqr"},{"type":"output","id":"a6LZLarDm6QvywFiULiwY","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 2 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"1b70df6b8023b535ffa7ea2bb6f30cc3","path":"/build/1b70df6b8023b535ffa7ea2bb6f30cc3.png"}}}],"key":"XFmzvN5SJm"}],"data":{},"key":"W0eWwB2DCE"},{"type":"paragraph","position":{"start":{"line":302,"column":1},"end":{"line":302,"column":1}},"children":[{"type":"text","value":"A convergence experiment confirms the order of accuracy. Because we expect an algebraic convergence rate, we use a log-log plot of the errors.","position":{"start":{"line":302,"column":1},"end":{"line":302,"column":1}},"key":"TaQ9kE75se"}],"key":"XhetRGovTN"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"N = array([int(2**k) for k in arange(4, 11.5, 0.5)])\nerr1 = zeros(len(N))\nerr2 = zeros(len(N))\nfor k, n in enumerate(N):\n    t, Dx, Dxx = FNC.diffmat2(n, [-1, 1])\n    y = f(t)\n    err1[k] = norm(df_dx(t) - Dx @ y, inf)\n    err2[k] = norm(d2f_dx2(t) - Dxx @ y, inf)\n\nloglog(N, err1, \"-o\", label=\"$f'$\")\nloglog(N, err2, \"-o\", label=\"$f''$\")\nplot(N, 10 * 10 / N**2, \"k--\", label=\"2nd order\")\nxlabel(\"$n$\"),  ylabel(\"max error\")\nlegend(loc=\"lower left\")\ntitle(\"Convergence of finite differences\");","key":"QMdUMyNGl7"},{"type":"output","id":"mfVkPiZ5mpOwm1sn49NUr","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"010d09be50d41c34e41f4eeee0aca78d","path":"/build/010d09be50d41c34e41f4eeee0aca78d.png"}}}],"key":"aAtPh8FZFt"}],"data":{},"key":"JSJbd6X47o"}],"label":"demo-diffmats-2nd-python","identifier":"demo-diffmats-2nd-python","html_id":"demo-diffmats-2nd-python","key":"vgvXM0SsYK"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-diffmats-cheb","label":"demo-diffmats-cheb","kind":"proof:example","position":{"start":{"line":324,"column":1},"end":{"line":324,"column":20}},"children":[{"type":"text","value":"Example ","key":"Nj2UPIpfHA"},{"type":"text","value":"10.3.2","key":"OfGh6Cwjvm"}],"template":"Example %s","enumerator":"10.3.2","resolved":true,"html_id":"demo-diffmats-cheb","remote":true,"url":"/diffmats","dataUrl":"/diffmats.json","key":"BUPbMRnMTC"}],"key":"scW98d45Pk"},{"type":"paragraph","position":{"start":{"line":326,"column":1},"end":{"line":326,"column":1}},"children":[{"type":"text","value":"Here is a ","position":{"start":{"line":326,"column":1},"end":{"line":326,"column":1}},"key":"evtKci1Wkk"},{"type":"inlineMath","value":"4\\times 4","position":{"start":{"line":326,"column":1},"end":{"line":326,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>4</mn><mo>×</mo><mn>4</mn></mrow><annotation encoding=\"application/x-tex\">4\\times 4</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">4</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">4</span></span></span></span>","key":"siaPfUICaD"},{"type":"text","value":" Chebyshev differentiation matrix.","position":{"start":{"line":326,"column":1},"end":{"line":326,"column":1}},"key":"DSB0Qhhixz"}],"key":"tBqMzSKGSP"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"t, Dx, Dxx = FNC.diffcheb(3, [-1, 1])\nprint(Dx)","key":"qgGCvaOOcH"},{"type":"output","id":"xkD-JXdgxam5_Cl1Vn1Hf","data":[{"output_type":"stream","name":"stdout","text":"[[-3.16666667  4.         -1.33333333  0.5       ]\n [-1.          0.33333333  1.         -0.33333333]\n [ 0.33333333 -1.         -0.33333333  1.        ]\n [-0.5         1.33333333 -4.          3.16666667]]\n"}],"key":"mB6XvjretM"}],"data":{},"key":"wBcWCqjPbJ"},{"type":"paragraph","position":{"start":{"line":333,"column":1},"end":{"line":333,"column":1}},"children":[{"type":"text","value":"We again test the convergence rate.","position":{"start":{"line":333,"column":1},"end":{"line":333,"column":1}},"key":"H90FJZl5P9"}],"key":"c50iP5OpFL"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"f = lambda x: x + exp(sin(4 * x))\ndf_dx = lambda x: 1 + 4 * exp(sin(4 * x)) * cos(4 * x)\nd2f_dx2 = lambda x: 4 * exp(sin(4 * x)) * (4 * cos(4 * x) ** 2 - 4 * sin(4 * x))\n\nN = range(5, 75, 5)\nerr1 = zeros(len(N))\nerr2 = zeros(len(N))\nerr = zeros((len(N), 2))\nfor k, n in enumerate(N):\n    t, Dx, Dxx = FNC.diffcheb(n, [-1, 1])\n    y = f(t)\n    err[k, 0] = norm(df_dx(t) - Dx @ y, inf)\n    err[k, 1] = norm(d2f_dx2(t) - Dxx @ y, inf)","key":"FpKFqqbRqS"},{"type":"output","id":"SD9KyaMqyUJ94gZwojuOe","data":[],"key":"qrMpeiPSVA"}],"data":{},"key":"jL1NRC3qlU"},{"type":"paragraph","position":{"start":{"line":351,"column":1},"end":{"line":351,"column":1}},"children":[{"type":"text","value":"Since we expect a spectral convergence rate, we use a semi-log plot for the error.","position":{"start":{"line":351,"column":1},"end":{"line":351,"column":1}},"key":"liZc73ydrF"}],"key":"QQ89Qf7rf9"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"semilogy(N, err, \"-o\")\nxlabel(\"$n$\"), ylabel(\"max error\")\nlegend([\"$f'$\", \"$f''$\"], loc=\"lower left\")\ntitle(\"Convergence of Chebyshev derivatives\");","key":"EJq8hdQJGP"},{"type":"output","id":"kMyuZau59nMO0Gvo711FT","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"02214a610319e078419fcf62e18f043d","path":"/build/02214a610319e078419fcf62e18f043d.png"}}}],"key":"vDCO6SP08q"}],"data":{},"key":"wlokq5ssk9"}],"label":"demo-diffmats-cheb-python","identifier":"demo-diffmats-cheb-python","html_id":"demo-diffmats-cheb-python","key":"pNBzzq9voS"},{"type":"heading","depth":3,"position":{"start":{"line":361,"column":1},"end":{"line":361,"column":1}},"children":[{"type":"text","value":"10.4 ","position":{"start":{"line":361,"column":1},"end":{"line":361,"column":1}},"key":"kEzfvex3WW"},{"type":"link","identifier":"section-bvp-linear","label":"section-bvp-linear","kind":"narrative","position":{"start":{"line":361,"column":6},"end":{"line":361,"column":25}},"url":"/linear","internal":true,"dataUrl":"/linear.json","children":[{"type":"text","value":"Collocation for linear problems","key":"uksPUogVwc"}],"key":"V5Cki7bNtG"}],"identifier":"id-10-4","label":"10.4 ","html_id":"id-10-4","implicit":true,"key":"UZw3Lx9xdu"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-linear-solve","label":"demo-linear-solve","kind":"proof:example","position":{"start":{"line":363,"column":1},"end":{"line":363,"column":19}},"children":[{"type":"text","value":"Example ","key":"XKEhcP1SL0"},{"type":"text","value":"10.4.1","key":"jJ7IMqqsEh"}],"template":"Example %s","enumerator":"10.4.1","resolved":true,"html_id":"demo-linear-solve","remote":true,"url":"/linear","dataUrl":"/linear.json","key":"o8pNadI16B"}],"key":"mVCt8nybqA"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"exact = lambda x: exp( sin(x) )","key":"G2rHL7bFo2"},{"type":"output","id":"V0wedo-zRA08w90j3zmXW","data":[],"key":"En2mxf5dTg"}],"data":{},"key":"HxsmUnNxhL"},{"type":"paragraph","position":{"start":{"line":370,"column":1},"end":{"line":370,"column":1}},"children":[{"type":"text","value":"The problem is presented above in our standard form, so we can identify the coefficient functions in the ","key":"lWgHJrfnzC"},{"type":"abbreviation","title":"ordinary differential equation","children":[{"type":"text","value":"ODE","key":"GmOQSSr2DO"}],"key":"iEs5eYC8Cr"},{"type":"text","value":". Each should be coded as a function.","key":"RvxrmlOinK"}],"key":"aMWUx4w0LU"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"p = lambda x: -cos(x)\nq = sin\nr = lambda x: 0 * x    # must be a function","key":"s8I4102jfp"},{"type":"output","id":"eEEFfonrrjyUHl8L7OKmg","data":[],"key":"xGhwXIX1Z9"}],"data":{},"key":"gTJ8tmBcrh"},{"type":"paragraph","position":{"start":{"line":378,"column":1},"end":{"line":378,"column":1}},"children":[{"type":"text","value":"We solve the ","key":"pTIeH1hpcW"},{"type":"abbreviation","title":"boundary-value problem","children":[{"type":"text","value":"BVP","key":"jYzL7bXUyE"}],"key":"caHC36ryOE"},{"type":"text","value":" and compare the result to the exact solution.","key":"DP1sjHiNxQ"}],"key":"fYNDJx7Vv2"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"x, u = FNC.bvplin(p, q, r, [0, pi/2], 1, exp(1), 25)","key":"KFyTzO7fOz"},{"type":"output","id":"qwO3JSkgPvi0DOuhGPK1Z","data":[],"key":"yWw8bNZuqM"}],"data":{},"key":"WnZ5rS659o"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"subplot(2, 1, 1)\nplot(x, u)\nylabel(\"solution\"),  title(\"Solution of the BVP\")\n\nsubplot(2, 1, 2)\nplot(x, exact(x) - u, \"-o\")\nylabel(\"error\");","key":"bNaTLOjTMH"},{"type":"output","id":"CTwFMvzkuczlbfXtPS7Ln","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 2 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"a5b42bc179fbabcd26eeb84e85d8c3a1","path":"/build/a5b42bc179fbabcd26eeb84e85d8c3a1.png"}}}],"key":"MXR3xx9uYY"}],"data":{},"key":"tvy66snH90"}],"label":"demo-linear-solve-python","identifier":"demo-linear-solve-python","html_id":"demo-linear-solve-python","key":"aIo2ZNAkY4"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-linear-converge","label":"demo-linear-converge","kind":"proof:example","position":{"start":{"line":396,"column":1},"end":{"line":396,"column":22}},"children":[{"type":"text","value":"Example ","key":"pAUw4QvAj7"},{"type":"text","value":"10.4.2","key":"FTeGhVR0jy"}],"template":"Example %s","enumerator":"10.4.2","resolved":true,"html_id":"demo-linear-converge","remote":true,"url":"/linear","dataUrl":"/linear.json","key":"deiKISxjtF"}],"key":"Hqb2AnR1hm"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"lamb = 10\nexact = lambda x: sinh(lamb * x) / sinh(lamb) - 1","key":"lSTwd6BNBd"},{"type":"output","id":"OLyWCi5G8LMJU9TFAgBPG","data":[],"key":"Q8D6v06sSS"}],"data":{},"key":"peTKXI07DF"},{"type":"paragraph","position":{"start":{"line":403,"column":1},"end":{"line":403,"column":1}},"children":[{"type":"text","value":"The following functions define the ","key":"aH9aURoteK"},{"type":"abbreviation","title":"ordinary differential equation","children":[{"type":"text","value":"ODE","key":"TLyscJeFNf"}],"key":"dyW07SmLDL"},{"type":"text","value":".","key":"FoGAqcxijy"}],"key":"gUOaLEddMC"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"p = lambda x: zeros(size(x))\nq = lambda x: -(lamb**2) * ones(len(x))\nr = lambda x: lamb**2 * ones(len(x))","key":"ODSKGU72dD"},{"type":"output","id":"sQtJE7eAt7JcSY4k-fosE","data":[],"key":"Dq60WhFOvI"}],"data":{},"key":"y9zi8g1KoU"},{"type":"paragraph","position":{"start":{"line":411,"column":1},"end":{"line":411,"column":1}},"children":[{"type":"text","value":"We compare the computed solution to the exact one for increasing ","position":{"start":{"line":411,"column":1},"end":{"line":411,"column":1}},"key":"Yi2uCq9QJ2"},{"type":"inlineMath","value":"n","position":{"start":{"line":411,"column":1},"end":{"line":411,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"X0SsymxprB"},{"type":"text","value":".","position":{"start":{"line":411,"column":1},"end":{"line":411,"column":1}},"key":"vUo0JSDO8J"}],"key":"LpULASLFWu"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"N = array([int(2 * 10**d) for d in arange(1, 3.1, 0.25)])\nerr = zeros(len(N))\nresults = PrettyTable([\"n\", \"error\"])\nfor k, n in enumerate(N):\n    x, u = FNC.bvplin(p, q, r, [0, 1], -1, 0, n)\n    err[k] = norm(exact(x) - u, inf)\n    results.add_row([n, err[k]])\nprint(results)","key":"aUXwUYKEfp"},{"type":"output","id":"UthClF9IyCewLLR7OMHol","data":[{"output_type":"stream","name":"stdout","text":"+------+-----------------------+\n|  n   |         error         |\n+------+-----------------------+\n|  20  | 0.0037471006137431706 |\n|  35  | 0.0012307958808570607 |\n|  63  | 0.0003848512001198845 |\n| 112  |  0.000122087055467901 |\n| 200  | 3.831198680559478e-05 |\n| 355  | 1.216083231792009e-05 |\n| 632  | 3.837495240799349e-06 |\n| 1124 | 1.213264558486138e-06 |\n| 2000 | 3.832060194719489e-07 |\n+------+-----------------------+\n"}],"key":"h37WEOZSAT"}],"data":{},"key":"Cck7UfpCdx"},{"type":"paragraph","position":{"start":{"line":424,"column":1},"end":{"line":424,"column":1}},"children":[{"type":"text","value":"Each factor of 10 in ","position":{"start":{"line":424,"column":1},"end":{"line":424,"column":1}},"key":"bGjptU2iGy"},{"type":"inlineMath","value":"n","position":{"start":{"line":424,"column":1},"end":{"line":424,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"pPTixmmArs"},{"type":"text","value":" reduces error by a factor of 100, which is indicative of second-order convergence.","position":{"start":{"line":424,"column":1},"end":{"line":424,"column":1}},"key":"mIX9x21UEu"}],"key":"Uau700iCoI"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"loglog(N, err, \"-o\", label=\"observed\")\nloglog(N, 1 / N**2, \"--\", label=\"2nd order\")\nxlabel(\"$n$\"),  ylabel(\"max error\")\nlegend(),  title(\"Convergence of finite differences\");","key":"asEH4FyJrl"},{"type":"output","id":"gavniPal-yANJEdw6I6Lm","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"36982da10315357bd6591ae92cd9649b","path":"/build/36982da10315357bd6591ae92cd9649b.png"}}}],"key":"zbZFEcHX8Q"}],"data":{},"key":"Pi2BSJ7cTV"}],"label":"demo-linear-converge-python","identifier":"demo-linear-converge-python","html_id":"demo-linear-converge-python","key":"E3bpcoWAWx"},{"type":"heading","depth":3,"position":{"start":{"line":434,"column":1},"end":{"line":434,"column":1}},"children":[{"type":"text","value":"10.5 ","position":{"start":{"line":434,"column":1},"end":{"line":434,"column":1}},"key":"MxdUl9A5qZ"},{"type":"link","identifier":"section-bvp-nonlinear","label":"section-bvp-nonlinear","kind":"narrative","position":{"start":{"line":434,"column":6},"end":{"line":434,"column":28}},"url":"/nonlinear","internal":true,"dataUrl":"/nonlinear.json","children":[{"type":"text","value":"Nonlinearity and boundary conditions","key":"tMuoQk3UwY"}],"key":"XZ3Vm2IC5W"}],"identifier":"id-10-5","label":"10.5 ","html_id":"id-10-5","implicit":true,"key":"zCW7Wlh1vg"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-nonlinear-pendulum","label":"demo-nonlinear-pendulum","kind":"proof:example","position":{"start":{"line":436,"column":1},"end":{"line":436,"column":25}},"children":[{"type":"text","value":"Example ","key":"bzZQ0FwPMf"},{"type":"text","value":"10.5.2","key":"Jz9giXLB0C"}],"template":"Example %s","enumerator":"10.5.2","resolved":true,"html_id":"demo-nonlinear-pendulum","remote":true,"url":"/nonlinear","dataUrl":"/nonlinear.json","key":"tG5VS8cC8O"}],"key":"IdrWXyNVVl"},{"type":"paragraph","position":{"start":{"line":438,"column":1},"end":{"line":438,"column":1}},"children":[{"type":"text","value":"The first step is to define the function ","position":{"start":{"line":438,"column":1},"end":{"line":438,"column":1}},"key":"tvuPXJZFpl"},{"type":"text","value":"ϕ","position":{"start":{"line":438,"column":1},"end":{"line":438,"column":1}},"key":"j5hzZkLsK5"},{"type":"text","value":" that equals ","position":{"start":{"line":438,"column":1},"end":{"line":438,"column":1}},"key":"vwvd7Bd3eL"},{"type":"inlineMath","value":"\\theta''","position":{"start":{"line":438,"column":1},"end":{"line":438,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>θ</mi><mrow><mo mathvariant=\"normal\">′</mo><mo mathvariant=\"normal\">′</mo></mrow></msup></mrow><annotation encoding=\"application/x-tex\">\\theta&#x27;&#x27;</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′′</span></span></span></span></span></span></span></span></span></span></span></span>","key":"BIKUKhubuW"},{"type":"text","value":".","position":{"start":{"line":438,"column":1},"end":{"line":438,"column":1}},"key":"Rx9GmxGdaZ"}],"key":"av2yDFgVcm"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"phi = lambda t, theta, omega: -0.05 * omega - sin(theta)","key":"CmcvLbetnk"},{"type":"output","id":"z8Bcx1fwbo2RzCTuVl4vQ","data":[],"key":"NC6YQWzqmW"}],"data":{},"key":"KakmuK7aSf"},{"type":"paragraph","position":{"start":{"line":444,"column":1},"end":{"line":444,"column":1}},"children":[{"type":"text","value":"Next, we define the boundary conditions.","position":{"start":{"line":444,"column":1},"end":{"line":444,"column":1}},"key":"jTpJAChrvo"}],"key":"NxJ4ozF1bP"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ga = lambda u, du: u - 2.5\ngb = lambda u, du: u + 2","key":"KVuYIeASOI"},{"type":"output","id":"eUZk2m3OrD3X5bhlh0aLn","data":[],"key":"ULb77A9WXY"}],"data":{},"key":"wdl7mmCvia"},{"type":"paragraph","position":{"start":{"line":451,"column":1},"end":{"line":451,"column":1}},"children":[{"type":"text","value":"The last ingredient is an initial estimate of the solution. Here we choose ","position":{"start":{"line":451,"column":1},"end":{"line":451,"column":1}},"key":"zgtcrumAkO"},{"type":"inlineMath","value":"n=100","position":{"start":{"line":451,"column":1},"end":{"line":451,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>=</mo><mn>100</mn></mrow><annotation encoding=\"application/x-tex\">n=100</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">100</span></span></span></span>","key":"mCAeKlVU9Q"},{"type":"text","value":" and a linear function between the endpoint values.","position":{"start":{"line":451,"column":1},"end":{"line":451,"column":1}},"key":"lWbewrDA3z"}],"key":"v4SjhgcIkY"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"init = linspace(2.5, -2, 101)","key":"wgnwVJwoqj"},{"type":"output","id":"0o_QkTxOAGIKHyr6dQbtq","data":[],"key":"BZHdIgODOj"}],"data":{},"key":"HHadcurnjZ"},{"type":"paragraph","position":{"start":{"line":457,"column":1},"end":{"line":457,"column":1}},"children":[{"type":"text","value":"We find a solution with negative initial slope, i.e., the pendulum is initially pushed back toward equilibrium.","position":{"start":{"line":457,"column":1},"end":{"line":457,"column":1}},"key":"qLT4zDB6O0"}],"key":"Q8PCeMSxwP"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"t, theta = FNC.bvp(phi, [0, 5], ga, gb, init)\nplot(t, theta)\nxlabel(\"$t$\")\nylabel(\"$\\theta(t)$\")\ntitle(\"Pendulum over [0,5]\");","key":"DQOJjDtr4U"},{"type":"output","id":"c_gKslgG64eI8dCrWKnKE","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"5996eaf1156457ebdc85dd62e207728a","path":"/build/5996eaf1156457ebdc85dd62e207728a.png"}}}],"key":"YfYxo4jyVg"}],"data":{},"key":"zJwySKiDQF"},{"type":"paragraph","position":{"start":{"line":467,"column":1},"end":{"line":467,"column":1}},"children":[{"type":"text","value":"If we extend the time interval longer for the same boundary values, then the initial slope must adjust.","position":{"start":{"line":467,"column":1},"end":{"line":467,"column":1}},"key":"BrZ15GyDVF"}],"key":"ESuEBbVi8j"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"t, theta = FNC.bvp(phi, [0, 8], ga, gb, init)\nplot(t, theta)\nxlabel(\"$t$\")\nylabel(\"$\\theta(t)$\")\ntitle(\"Pendulum over [0,8]\");","key":"LOLKpbHif8"},{"type":"output","id":"ZVT4ZUsLzqznBYYOVn-tJ","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"6033774d3d7b872aa48a16c51367ae5b","path":"/build/6033774d3d7b872aa48a16c51367ae5b.png"}}}],"key":"UBtVPX3YsG"}],"data":{},"key":"heUulfuux4"},{"type":"paragraph","position":{"start":{"line":478,"column":1},"end":{"line":478,"column":1}},"children":[{"type":"text","value":"This time, the pendulum is initially pushed toward the unstable equilibrium in the upright vertical position before gravity pulls it back down.","position":{"start":{"line":478,"column":1},"end":{"line":478,"column":1}},"key":"aQ3MwbCdnu"}],"key":"nTDVQFSebS"}],"label":"demo-nonlinear-pendulum-python","identifier":"demo-nonlinear-pendulum-python","html_id":"demo-nonlinear-pendulum-python","key":"EXmmBMbwZm"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-nonlinear-mems","label":"demo-nonlinear-mems","kind":"proof:example","position":{"start":{"line":482,"column":1},"end":{"line":482,"column":21}},"children":[{"type":"text","value":"Example ","key":"y0OejReCT3"},{"type":"text","value":"10.5.3","key":"DiX8uGIgHM"}],"template":"Example %s","enumerator":"10.5.3","resolved":true,"html_id":"demo-nonlinear-mems","remote":true,"url":"/nonlinear","dataUrl":"/nonlinear.json","key":"ecDhTWKizs"}],"key":"LpCLER8GKX"},{"type":"paragraph","position":{"start":{"line":484,"column":1},"end":{"line":484,"column":1}},"children":[{"type":"text","value":"Here is the problem definition. We use a truncated domain to avoid division by zero at ","position":{"start":{"line":484,"column":1},"end":{"line":484,"column":1}},"key":"OsOd7a9IdH"},{"type":"inlineMath","value":"r=0","position":{"start":{"line":484,"column":1},"end":{"line":484,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>r</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">r=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"qztAX26DqR"},{"type":"text","value":".","position":{"start":{"line":484,"column":1},"end":{"line":484,"column":1}},"key":"z9QFPOWdkR"}],"key":"qIJTDq2RoF"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"lamb = 0.5\nphi = lambda r, w, dwdr: lamb / w**2 - dwdr / r\na, b = finfo(float).eps, 1\nga = lambda w, dw: dw\ngb = lambda w, dw: w - 1","key":"MsVca2T9y8"},{"type":"output","id":"GcVce7sqp8W-EbhKdzRBJ","data":[],"key":"DDjqvpks5n"}],"data":{},"key":"NJFiwKzS8l"},{"type":"paragraph","position":{"start":{"line":494,"column":1},"end":{"line":494,"column":1}},"children":[{"type":"text","value":"First we try a constant function as the initialization.","position":{"start":{"line":494,"column":1},"end":{"line":494,"column":1}},"key":"rghasnxF35"}],"key":"QojJtWbpmt"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"init = ones(201)\nr, w1 = FNC.bvp(phi, [a, b], ga, gb, init)\nplot(r, w1)\nfig, ax = gcf(), gca()\nxlabel(\"$r$\"),  ylabel(\"$w(r)$\")\ntitle(\"Solution of the MEMS problem\");","key":"xbmZ2lKOPI"},{"type":"output","id":"Ed5K70iEXbTfD42ZzRDFS","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"a0b3f0abd76e886c466bc32d3a540591","path":"/build/a0b3f0abd76e886c466bc32d3a540591.png"}}}],"key":"IFNuKC5Fu6"}],"data":{},"key":"J2048Zh13f"},{"type":"paragraph","position":{"start":{"line":505,"column":1},"end":{"line":505,"column":1}},"children":[{"type":"text","value":"It’s not necessary that the initialization satisfy the boundary conditions. In fact, by choosing a different constant function as the initial guess, we arrive at another valid solution.","position":{"start":{"line":505,"column":1},"end":{"line":505,"column":1}},"key":"t153N8Pxpz"}],"key":"So6o6OcuWR"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"r, w2 = FNC.bvp(phi, [a, b], ga, gb, 0.5 * init)\nax.plot(r, w2)\nax.set_title(\"Multiple solutions of the MEMS problem\");\nfig","key":"Gmo5WFHeWO"},{"type":"output","id":"55lrwuWLqkbTmBNmO7f5r","data":[{"output_type":"execute_result","execution_count":40,"metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"ac106652d2b8287bced99d83f789b9f0","path":"/build/ac106652d2b8287bced99d83f789b9f0.png"}}}],"key":"YIaTdNvyCw"}],"data":{},"key":"XESluhMVgZ"}],"label":"demo-nonlinear-mems-python","identifier":"demo-nonlinear-mems-python","html_id":"demo-nonlinear-mems-python","key":"bgRLHyeegj"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-nonlinear-allencahn","label":"demo-nonlinear-allencahn","kind":"proof:example","position":{"start":{"line":516,"column":1},"end":{"line":516,"column":26}},"children":[{"type":"text","value":"Example ","key":"dMTHbVfEgR"},{"type":"text","value":"10.5.4","key":"AJ2NgYJtVg"}],"template":"Example %s","enumerator":"10.5.4","resolved":true,"html_id":"demo-nonlinear-allencahn","remote":true,"url":"/nonlinear","dataUrl":"/nonlinear.json","key":"a4IvolRKKs"}],"key":"SHvWz8e44w"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"phi = lambda x, u, dudx: (u**3 - u) / epsilon\nga = lambda u, du: du\ngb = lambda u, du: u - 1","key":"OBMxzoAzRr"},{"type":"output","id":"CnYkwNG2dUC5GHG8qQm1j","data":[],"key":"C79Yo1N7kr"}],"data":{},"key":"i4oBFnEacm"},{"type":"paragraph","position":{"start":{"line":525,"column":1},"end":{"line":525,"column":1}},"children":[{"type":"text","value":"Finding a solution is easy at larger values of ","position":{"start":{"line":525,"column":1},"end":{"line":525,"column":1}},"key":"grLJRrvjb8"},{"type":"text","value":"ε","position":{"start":{"line":525,"column":1},"end":{"line":525,"column":1}},"key":"m6GrXIjhKf"},{"type":"text","value":".","position":{"start":{"line":525,"column":1},"end":{"line":525,"column":1}},"key":"MzdZlTE06D"}],"key":"YzNKu4xAnp"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"epsilon = 0.05\ninit = linspace(-1, 1, 141)\nx, u1 = FNC.bvp(phi, [0, 1], ga, gb, init)\n\nplot(x, u1, label=\"$\\\\epsilon = 0.05$\")\nfig, ax = gcf(), gca()\nxlabel(\"$x$\"),  ylabel(\"$u(x)$\")\nlegend(),  title(\"Allen-Cahn solution\");","key":"LV17UIeXXg"},{"type":"output","id":"hWtvURn-BVANdul8tkbwN","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"3470642e16f1b58a867ef718841ef959","path":"/build/3470642e16f1b58a867ef718841ef959.png"}}}],"key":"WpEOSNt3rW"}],"data":{},"key":"BT2MDHPymy"},{"type":"paragraph","position":{"start":{"line":538,"column":1},"end":{"line":538,"column":1}},"children":[{"type":"text","value":"Finding a good initialization is not trivial for smaller values of ","position":{"start":{"line":538,"column":1},"end":{"line":538,"column":1}},"key":"lnymNlHEgF"},{"type":"text","value":"ε","position":{"start":{"line":538,"column":1},"end":{"line":538,"column":1}},"key":"YEFJyGETWa"},{"type":"text","value":". But the iteration succeeds if we use the first solution as the initialization at the smaller ","position":{"start":{"line":538,"column":1},"end":{"line":538,"column":1}},"key":"cfMWEYaAJ7"},{"type":"text","value":"ε","position":{"start":{"line":538,"column":1},"end":{"line":538,"column":1}},"key":"qP5sKjCC0A"},{"type":"text","value":".","position":{"start":{"line":538,"column":1},"end":{"line":538,"column":1}},"key":"jYF1RTLKTW"}],"key":"SdVEEuxI85"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"epsilon = 0.002\nx, u2 = FNC.bvp(phi, [0, 1], ga, gb, u1)\nax.plot(x, u2, label=\"$\\\\epsilon = 0.002$\")\nax.legend()\nfig","key":"d5fIWZ291d"},{"type":"output","id":"cIYgl1opXCj9AtifMga7o","data":[{"output_type":"execute_result","execution_count":43,"metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"a1518de5712dd4c8dce006c3d5f68461","path":"/build/a1518de5712dd4c8dce006c3d5f68461.png"}}}],"key":"cXCCfhMvUt"}],"data":{},"key":"eCMrh6g81V"},{"type":"paragraph","position":{"start":{"line":549,"column":1},"end":{"line":549,"column":1}},"children":[{"type":"text","value":"In this case we can continue further.","position":{"start":{"line":549,"column":1},"end":{"line":549,"column":1}},"key":"bGY0ypQRrg"}],"key":"VTUXoK1sEv"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ϵ = 0.0005\nx, u3 = FNC.bvp(phi, [0, 1], ga, gb, u2)\nax.plot(x, u3, label=\"$\\\\epsilon = 0.005$\")\nax.legend()\nfig","key":"iL4xo8yFlL"},{"type":"output","id":"RHdSSmLyD-nUMQO7xJgI6","data":[{"output_type":"execute_result","execution_count":44,"metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"5b1c6ef08d3e669c779bc01a4da55869","path":"/build/5b1c6ef08d3e669c779bc01a4da55869.png"}}}],"key":"ajKo2z7o6c"}],"data":{},"key":"PvrnYksW8w"}],"label":"demo-nonlinear-allencahn-python","identifier":"demo-nonlinear-allencahn-python","html_id":"demo-nonlinear-allencahn-python","key":"GZH4LyYmkW"},{"type":"heading","depth":3,"position":{"start":{"line":560,"column":1},"end":{"line":560,"column":1}},"children":[{"type":"text","value":"10.6 ","position":{"start":{"line":560,"column":1},"end":{"line":560,"column":1}},"key":"KVvOklUVpR"},{"type":"link","identifier":"section-bvp-galerkin","label":"section-bvp-galerkin","kind":"narrative","position":{"start":{"line":560,"column":6},"end":{"line":560,"column":27}},"url":"/galerkin","internal":true,"dataUrl":"/galerkin.json","children":[{"type":"text","value":"The Galerkin method","key":"Wtgm4xcZal"}],"key":"MiB8YH4XPl"}],"identifier":"id-10-6","label":"10.6 ","html_id":"id-10-6","implicit":true,"key":"mIXUz4apOI"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-galerkin-fem","label":"demo-galerkin-fem","kind":"proof:example","position":{"start":{"line":562,"column":1},"end":{"line":562,"column":19}},"children":[{"type":"text","value":"Example ","key":"NFK5Z3fAHl"},{"type":"text","value":"10.6.2","key":"VDT59PX4nV"}],"template":"Example %s","enumerator":"10.6.2","resolved":true,"html_id":"demo-galerkin-fem","remote":true,"url":"/galerkin","dataUrl":"/galerkin.json","key":"s6sBxcUPH1"}],"key":"VZFaa1DE69"},{"type":"paragraph","position":{"start":{"line":564,"column":1},"end":{"line":564,"column":1}},"children":[{"type":"text","value":"Here are the coefficient function definitions. Even though ","position":{"start":{"line":564,"column":1},"end":{"line":564,"column":1}},"key":"BEBHBvMeRz"},{"type":"inlineMath","value":"s","position":{"start":{"line":564,"column":1},"end":{"line":564,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>s</mi></mrow><annotation encoding=\"application/x-tex\">s</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">s</span></span></span></span>","key":"rkpbAyj2zp"},{"type":"text","value":" is a constant, it has to be defined as a function for ","position":{"start":{"line":564,"column":1},"end":{"line":564,"column":1}},"key":"UdgaudV6RE"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-fem","label":"function-fem","children":[{"type":"text","value":"Function ","key":"n1sAcAMi0N"},{"type":"text","value":"10.6.1","key":"RGVrgrVxFs"}],"template":"Algorithm %s","enumerator":"10.6.1","resolved":true,"html_id":"function-fem","remote":true,"url":"/galerkin","dataUrl":"/galerkin.json","key":"HCzrzhhKWB"},{"type":"text","value":" to use it.","position":{"start":{"line":564,"column":1},"end":{"line":564,"column":1}},"key":"eLhGDvoNth"}],"key":"UyqtbRlV18"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"c = lambda x: x**2\nq = lambda x: 4 * ones(len(x))\nf = lambda x: sin(pi * x)","key":"xkg7aWU4qE"},{"type":"output","id":"YMnP58-k7-wbJ4U8vtTOi","data":[],"key":"T0YKhvLAHp"}],"data":{},"key":"RpyOnNsXO5"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"x, u = FNC.fem(c, q, f, 0, 1, 50)\nplot(x, u)\nxlabel(\"$x$\"),  ylabel(\"$u$\")\ntitle(\"Solution by finite elements\");","key":"oLy5L7dbQX"},{"type":"output","id":"TujGNnD6RtBMcVO9Ty-Nu","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"0d693ecff541d6f07fbef867f78f8ce8","path":"/build/0d693ecff541d6f07fbef867f78f8ce8.png"}}}],"key":"lmc0EhIIMW"}],"data":{},"key":"FtIisxVL46"}],"label":"demo-galerkin-fem-python","identifier":"demo-galerkin-fem-python","html_id":"demo-galerkin-fem-python","key":"P0w52oyYnL"}],"key":"HfGp1Bn2U5"}],"key":"yrUtzk32uX"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Chapter 9","url":"/chapter9-2","group":"Python codes"},"next":{"title":"Chapter 11","url":"/chapter11-2","group":"Python codes"}}},"domain":"http://localhost:3000"}