{"version":2,"kind":"Notebook","sha256":"dbcab13fa7f4a937bcf396c06733231b1e6495a333a36cfa39e7bfbf14937fd0","slug":"chapter2-1","location":"/matlab/chapter2.md","dependencies":[],"frontmatter":{"title":"Chapter 2","numbering":{"heading_1":{"enabled":false},"heading_2":{"enabled":false},"heading_3":{"enabled":false},"heading_4":{"enabled":false},"heading_5":{"enabled":false},"heading_6":{"enabled":false},"title":{"offset":2}},"kernelspec":{"name":"jupyter_matlab_kernel","display_name":"MATLAB","language":"matlab"},"content_includes_title":false,"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","TPBVP":"two-point boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"edit_url":"https://github.com/fncbook/fnc/blob/master/matlab/chapter2.md","exports":[{"format":"md","filename":"chapter2.md","url":"/build/chapter2-2c02c35fe90603d5f8b300d8be839248.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"Functions","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"l2IGb3nk2X"}],"identifier":"functions","label":"Functions","html_id":"functions","implicit":true,"key":"arsL2rtEqZ"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Forward substitution","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"ZyTMzS9oHE"}],"key":"VI7BG7GLGJ"},{"type":"include","file":"FNC-matlab/forwardsub.m","literal":true,"children":[{"type":"code","value":"function x = forwardsub(L,b)\r\n% FORWARDSUB   Solve a lower triangular linear system.\r\n% Input:\r\n%   L    lower triangular square matrix (n by n)\r\n%   b    right-hand side vector (n by 1)   \r\n% Output:\r\n%   x    solution of Lx=b (n by 1 vector)\r\n\r\nn = length(L);\r\nx = zeros(n,1);\r\nfor i = 1:n\r\n  x(i) = ( b(i) - L(i,1:i-1) * x(1:i-1) ) / L(i,i);\r\nend","lang":"matlab","showLineNumbers":true,"filename":"forwardsub.m","key":"a9XUTiSsVl"}],"key":"XNHAHeNYvh"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"About the code","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"skGItFZdAE"}],"key":"VGJmmyEQAu"},{"type":"paragraph","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"Line 12 implements ","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"QvLbogmdgY"},{"type":"crossReference","identifier":"forwardsub","label":"forwardsub","kind":"equation","position":{"start":{"line":24,"column":20},"end":{"line":24,"column":31}},"children":[{"type":"text","value":"(","key":"aBNpaMp6RT"},{"type":"text","value":"2.3.7","key":"txHXl6fAAI"},{"type":"text","value":")","key":"O1EoMA9SOd"}],"template":"(%s)","enumerator":"2.3.7","resolved":true,"html_id":"forwardsub","remote":true,"url":"/linear-systems","dataUrl":"/linear-systems.json","key":"nsyrWhgBf3"},{"type":"text","value":". It contains an inner product between row ","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"Vo0aW7ZqvO"},{"type":"inlineMath","value":"i","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span>","key":"S1uc77HdE5"},{"type":"text","value":" of ","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"IwYqHKrcNz"},{"type":"inlineMath","value":"\\mathbf{L}","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">L</span></span></span></span>","key":"U1EKBc3p81"},{"type":"text","value":" and the solution vector ","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"OhJoK11FhK"},{"type":"inlineMath","value":"\\mathbf{x}","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">x</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{x}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4444em;\"></span><span class=\"mord mathbf\">x</span></span></span></span>","key":"z10wfezZxs"},{"type":"text","value":", using only the entries of ","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"X3VUHSg5Lf"},{"type":"inlineMath","value":"\\mathbf{x}","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">x</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{x}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4444em;\"></span><span class=\"mord mathbf\">x</span></span></span></span>","key":"ITAkJ6wo57"},{"type":"text","value":" that have already been computed.","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"H5tul2t2Jn"}],"key":"QlAJrehWC2"}],"class":"dropdown","key":"BAmV8RGSSt"}],"label":"function-forwardsub-matlab","identifier":"function-forwardsub-matlab","html_id":"function-forwardsub-matlab","key":"IMmqVy8xy6"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Backward substitution","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"pYLj3pMbKA"}],"key":"Fy9548f3Nb"},{"type":"include","file":"FNC-matlab/backsub.m","literal":true,"children":[{"type":"code","value":"function x = backsub(U,b)\r\n% BACKSUB   Solve an upper triangular linear system.\r\n% Input:\r\n%   U    upper triangular square matrix (n by n)\r\n%   b    right-hand side vector (n by 1)   \r\n% Output:\r\n%   x    solution of Ux=b (n by 1 vector)\r\n\r\nn = length(U);\r\nx = zeros(n,1);\r\nfor i = n:-1:1\r\n  x(i) = ( b(i) - U(i,i+1:n)*x(i+1:n) ) / U(i,i);\r\nend","lang":"matlab","showLineNumbers":true,"filename":"backsub.m","key":"lvT0e8yo3l"}],"key":"JNW6buFSbL"}],"label":"function-backsub-matlab","identifier":"function-backsub-matlab","html_id":"function-backsub-matlab","key":"Iy2AfIzOBZ"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"LU factorization (not stable)","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"key":"ktN2VJnPP4"}],"key":"ozOcThSfSV"},{"type":"include","file":"FNC-matlab/lufact.m","literal":true,"children":[{"type":"code","value":"function [L, U] = lufact(A)\r\n% LUFACT   LU factorization (demo only--not stable!).\r\n% Input:\r\n%   A    square matrix\r\n% Output:\r\n%   L,U  unit lower triangular and upper triangular such that LU=A\r\n\r\nn = size(A, 1);     % detect the dimensions from the input\r\nL = eye(n);         % ones on main diagonal, zeros elsewhere\r\nU = zeros(n, n);\r\nA_k = A;            % make a working copy \r\n\r\n% Reduction by outer products\r\nfor k = 1:n-1\r\n    U(k, :) = A_k(k, :);\r\n    L(:, k) = A_k(:,k) / U(k, k);\r\n    A_k = A_k -  L(:, k) * U(k, :);\r\nend\r\nU(n, n) = A_k(n, n);\r\nL = tril(L); U = triu(U);    % force exact triangularity","lang":"matlab","showLineNumbers":true,"filename":"lufact.m","key":"X2KJsRH69I"}],"key":"twaYRiNxV2"}],"label":"function-lufact-matlab","identifier":"function-lufact-matlab","html_id":"function-lufact-matlab","key":"C7vGamXwr7"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"LU factorization with partial pivoting","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"key":"NL019PE3bI"}],"key":"o58kwF44Cw"},{"type":"include","file":"FNC-matlab/plufact.m","literal":true,"children":[{"type":"code","value":"function [L, U, p] = plufact(A)\n% PLUFACT   Pivoted LU factorization \n% Input:\n%   A    square matrix\n% Output:\n%   L    unit lower triangular \n%   U    upper triangular\n%   p    row permutation vector such that A(p,:) = L*U\nn = size(A, 1);\nL = zeros(n, n);\nU = zeros(n, n);\np = zeros(1, n);\nA_k = A;\n\n% Reduction by outer products\nfor k = 1:n\n    [~, p(k)] = max(abs(A_k(:, k)));\n    U(k, :) = A_k(p(k), :);\n    L(:, k) = A_k(:, k) / U(k, k);\n    if k < n\n        A_k = A_k - L(:, k) * U(k, :);\n    end\nend\nL = tril(L(p, :));\nU = triu(U);","lang":"matlab","showLineNumbers":true,"filename":"plufact.m","key":"PohXhQ8leS"}],"key":"ZvRHIEoct3"},{"type":"code","lang":"","value":"","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"MV6Kq9JH6N"}],"label":"function-plufact-matlab","identifier":"function-plufact-matlab","html_id":"function-plufact-matlab","key":"upcupNIQzc"},{"type":"heading","depth":2,"position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"children":[{"type":"text","value":"Examples","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"W2ZawdDDSI"}],"identifier":"examples","label":"Examples","html_id":"examples","implicit":true,"key":"TlQMTGK5iu"}],"key":"BwRiEDcVpc"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"cd  /Users/driscoll/Documents/GitHub/fnc/matlab\nFNC_init;\npwd","visibility":"show","key":"C53vPq6HLB"},{"type":"output","id":"ot2H_orJPNFYjYjA7K1FU","data":[{"output_type":"stream","name":"stdout","text":"Starting MATLAB ...\n"},{"output_type":"stream","name":"stdout","text":"Executing ..."},{"output_type":"execute_result","execution_count":1,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = '/Users/driscoll/Documents/GitHub/fnc/matlab'</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = '/Users/driscoll/Documents/GitHub/fnc/matlab'","content_type":"text/plain"}}}],"visibility":"show","key":"ShMKqFUTUG"}],"data":{"tags":[]},"visibility":"remove","key":"e1XqrPDGBf"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":66,"column":1},"end":{"line":66,"column":1}},"children":[{"type":"text","value":"2.1 ","position":{"start":{"line":66,"column":1},"end":{"line":66,"column":1}},"key":"OmkQxFqLx0"},{"type":"link","identifier":"section-linsys-polyinterp","label":"section-linsys-polyinterp","kind":"narrative","position":{"start":{"line":66,"column":5},"end":{"line":66,"column":31}},"url":"/polyinterp","internal":true,"dataUrl":"/polyinterp.json","children":[{"type":"text","value":"Polynomial interpolation","key":"KNjUs1YNyK"}],"key":"Mj4i1zOL4u"}],"identifier":"id-2-1","label":"2.1 ","html_id":"id-2-1","implicit":true,"key":"EAfncmNofE"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-interp-vander","label":"demo-interp-vander","kind":"proof:example","position":{"start":{"line":68,"column":1},"end":{"line":68,"column":20}},"children":[{"type":"text","value":"Example ","key":"hFOZ1Z0ICJ"},{"type":"text","value":"2.1.1","key":"NAJg86EcAF"}],"template":"Example %s","enumerator":"2.1.1","resolved":true,"html_id":"demo-interp-vander","remote":true,"url":"/polyinterp","dataUrl":"/polyinterp.json","key":"E5cjqGKatT"}],"key":"QiCc7NW7Gh"},{"type":"paragraph","position":{"start":{"line":70,"column":1},"end":{"line":70,"column":1}},"children":[{"type":"text","value":"We create two column vectors for data about the population of China. The first has the years of census data and the other has the population, in millions of people.","position":{"start":{"line":70,"column":1},"end":{"line":70,"column":1}},"key":"FK2NzrXS2N"}],"key":"QUgh0AQu3i"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"year = [1982; 2000; 2010; 2015]; \npop = [1008.18; 1262.64; 1337.82; 1374.62];","key":"pFgB9v9lu1"},{"type":"output","id":"em9Y9HMwrrFRGhYKmPoUm","data":[],"key":"kCoxwpel4K"}],"key":"xHl6SX6pQW"},{"type":"paragraph","position":{"start":{"line":77,"column":1},"end":{"line":77,"column":1}},"children":[{"type":"text","value":"It’s convenient to measure time in years since 1980.","position":{"start":{"line":77,"column":1},"end":{"line":77,"column":1}},"key":"vua3x4JswS"}],"key":"pLe6WdY03t"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"t = year - 1980;\ny = pop;","key":"RfEG41BRQe"},{"type":"output","id":"NzqyEz72d6q-HmPQG1Swn","data":[],"key":"oTAwEOEJzS"}],"key":"nLQOO7L5Xu"},{"type":"paragraph","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"children":[{"type":"text","value":"Now we have four data points ","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"NtfAEoz4RN"},{"type":"inlineMath","value":"(t_1,y_1),\\dots,(t_4,y_4)","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><msub><mi>t</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><msub><mi>y</mi><mn>1</mn></msub><mo stretchy=\"false\">)</mo><mo separator=\"true\">,</mo><mo>…</mo><mo separator=\"true\">,</mo><mo stretchy=\"false\">(</mo><msub><mi>t</mi><mn>4</mn></msub><mo separator=\"true\">,</mo><msub><mi>y</mi><mn>4</mn></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(t_1,y_1),\\dots,(t_4,y_4)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">4</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">4</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"jBVeSwm2q9"},{"type":"text","value":", so ","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"TsTUVLHC9J"},{"type":"inlineMath","value":"n=4","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>=</mo><mn>4</mn></mrow><annotation encoding=\"application/x-tex\">n=4</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">4</span></span></span></span>","key":"vXkR27M1nd"},{"type":"text","value":" and we seek an interpolating cubic polynomial. We construct the associated Vandermonde matrix:","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"VuN7tvskNt"}],"indexEntries":[{"entry":"MATLAB","subEntry":{"value":"vander","kind":"entry"},"emphasis":true}],"label":"index-yI3KGx1w9a","identifier":"index-yi3kgx1w9a","html_id":"index-yi3kgx1w9a","key":"a5ZvmsgWcj"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"V = vander(t)","key":"AtE3FGlyLT"},{"type":"output","id":"UfLSKvRxq9fUdX6cYAVO4","data":[{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>V = 4×4 double\n           8           4           2           1\n        8000         400          20           1\n       27000         900          30           1\n       42875        1225          35           1\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"V = 4×4 double\n           8           4           2           1\n        8000         400          20           1\n       27000         900          30           1\n       42875        1225          35           1\n","content_type":"text/plain"}}}],"key":"EfDHzwERZ5"}],"key":"LkRNNTvNnH"},{"type":"paragraph","position":{"start":{"line":96,"column":1},"end":{"line":96,"column":1}},"children":[{"type":"text","value":"To solve for the vector of polynomial coefficients, we use a backslash to solve the linear system:","position":{"start":{"line":96,"column":1},"end":{"line":96,"column":1}},"key":"ZjKbQjvk3a"}],"indexEntries":[{"entry":"MATLAB","subEntry":{"value":"\\\\","kind":"entry"},"emphasis":true}],"label":"index-AquUWv5j7I","identifier":"index-aquuwv5j7i","html_id":"index-aquuwv5j7i","key":"pOoDcCa7mf"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"HBav2PbRvk"}],"key":"EQGWu1tLiP"},{"type":"paragraph","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"children":[{"type":"text","value":"A ","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"key":"WmHZRHVrqW"},{"type":"strong","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"children":[{"type":"text","value":"backslash","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"key":"GZ4Wt3mTtb"}],"key":"jGANy05i3b"},{"type":"text","value":" ","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"key":"VABI9CsN6l"},{"type":"inlineCode","value":"\\","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"key":"CvdzOVEYHx"},{"type":"text","value":" is used to solve a linear system of equations.","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"key":"BUUR9AC6vL"}],"key":"KEIGUip3wV"}],"class":"dropdown","key":"fNw7Gr8bkB"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"c = V \\ y","key":"QOIeoHbC4d"},{"type":"output","id":"jhS8xtNAJyEwtZe9PrOry","data":[{"output_type":"stream","name":"stderr","text":"Error using \\\nMatrix dimensions must agree."}],"key":"SqrMqU98AG"}],"key":"jHh708Q9mn"},{"type":"paragraph","position":{"start":{"line":106,"column":1},"end":{"line":106,"column":1}},"children":[{"type":"text","value":"The algorithms used by the backslash operator are the main topic of this chapter. As a check on the solution, we can compute the ","position":{"start":{"line":106,"column":1},"end":{"line":106,"column":1}},"key":"OY0fSDyV6N"},{"type":"emphasis","position":{"start":{"line":106,"column":1},"end":{"line":106,"column":1}},"children":[{"type":"text","value":"residual","position":{"start":{"line":106,"column":1},"end":{"line":106,"column":1}},"key":"Gmnq3yezwO"}],"key":"vY3LEAWuV8"},{"type":"text","value":".","position":{"start":{"line":106,"column":1},"end":{"line":106,"column":1}},"key":"OX5FYcL5qx"}],"key":"AXN03MTgP1"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"y - V * c","key":"VyyNxDiF57"},{"type":"output","id":"zC91QqyCnmaYH6O9UVeC-","data":[{"output_type":"stream","name":"stderr","text":"Error using *\nIncorrect dimensions for matrix multiplication. Check that the number of columns in the first matrix matches the number of rows in the second matrix. To operate on each element of the matrix individually, use TIMES (.*) for elementwise multiplication."}],"key":"jZk8okEUuQ"}],"key":"CoeDadCrz8"},{"type":"paragraph","position":{"start":{"line":112,"column":1},"end":{"line":112,"column":1}},"children":[{"type":"text","value":"Using floating-point arithmetic, it is not realistic to expect exact equality of quantities; a relative difference comparable to ","position":{"start":{"line":112,"column":1},"end":{"line":112,"column":1}},"key":"qTiiJsEatS"},{"type":"inlineMath","value":"\\macheps","position":{"start":{"line":112,"column":1},"end":{"line":112,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>ϵ</mi><mtext>mach</mtext></msub></mrow><annotation encoding=\"application/x-tex\">\\macheps</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">ϵ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">mach</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"nrAIKOr4VK"},{"type":"text","value":" is all we can look for.","position":{"start":{"line":112,"column":1},"end":{"line":112,"column":1}},"key":"xNOe4Wfi8u"}],"key":"CPPpwIVlbw"},{"type":"paragraph","position":{"start":{"line":114,"column":1},"end":{"line":114,"column":1}},"children":[{"type":"text","value":"By our definitions, the elements of ","position":{"start":{"line":114,"column":1},"end":{"line":114,"column":1}},"key":"vf59PBwnMN"},{"type":"inlineCode","value":"c","position":{"start":{"line":114,"column":1},"end":{"line":114,"column":1}},"key":"AvGgiC8ffF"},{"type":"text","value":" are coefficients in descending-degree order for the interpolating polynomial. We can use the polynomial to estimate the population of China in 2005:","position":{"start":{"line":114,"column":1},"end":{"line":114,"column":1}},"key":"h2GHHRBIKv"}],"key":"fGeD1EaXXV"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"p = @(t) polyval(c, t - 1980);  % include the 1980 time shift\np(2005)","key":"aFD6qQPWBQ"},{"type":"output","id":"dtjwahm8qke5SL5ZWPv3Q","data":[{"output_type":"execute_result","execution_count":7,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = 1.1705e+03</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = 1.1705e+03","content_type":"text/plain"}}}],"key":"txBf0hF6dl"}],"key":"QJoGPnk7oe"},{"type":"paragraph","position":{"start":{"line":121,"column":1},"end":{"line":121,"column":1}},"children":[{"type":"text","value":"The official population value for 2005 was 1303.72, so our result is rather good.","position":{"start":{"line":121,"column":1},"end":{"line":121,"column":1}},"key":"ye2bZK9lXo"}],"key":"JVy7EdTx3d"},{"type":"paragraph","position":{"start":{"line":126,"column":1},"end":{"line":126,"column":1}},"children":[{"type":"text","value":"We can visualize the interpolation process. First, we plot the data as points.","position":{"start":{"line":126,"column":1},"end":{"line":126,"column":1}},"key":"KeGcDMREnP"}],"indexEntries":[{"entry":"MATLAB","subEntry":{"value":"scatter","kind":"entry"},"emphasis":true}],"label":"index-mJZXb528hC","identifier":"index-mjzxb528hc","html_id":"index-mjzxb528hc","key":"dmla4fN6ME"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"t94Zbjh80r"}],"key":"ejcD6Nrm5G"},{"type":"paragraph","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"key":"ucdk45Smac"},{"type":"inlineCode","value":"scatter","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"key":"nITD9o2Gdu"},{"type":"text","value":" function creates a scatter plot of points; you can specify a line connecting the points as well.","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"key":"IT9TwMA0Zm"}],"key":"hzJLH3CJDa"}],"class":"dropdown","key":"RqcthGO6LF"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"scatter(year, y)\nxlabel(\"years since 1980\")\nylabel(\"population (millions)\")\ntitle(\"Population of China\")","key":"Be1H90mEMO"},{"type":"output","id":"KupIfZd1xBJsOat_ZA0mr","data":[{"output_type":"stream","name":"stderr","text":"Error using scatter (line 68)\nX and Y must be vectors of the same length, matrices of the same size, or a combination of a vector and a matrix where the length of the vector matches either the number of rows or columns of the matrix."}],"key":"LZwD2BxKgt"}],"key":"rJup62ywEx"},{"type":"paragraph","position":{"start":{"line":142,"column":1},"end":{"line":142,"column":1}},"children":[{"type":"text","value":"We want to superimpose a plot of the polynomial. We do that by evaluating it at a vector of points in the interval.","position":{"start":{"line":142,"column":1},"end":{"line":142,"column":1}},"key":"dI5sUPGAJ5"}],"indexEntries":[{"entry":"MATLAB","subEntry":{"value":"linspace","kind":"entry"},"emphasis":true}],"label":"index-qiXgn9gNqX","identifier":"index-qixgn9gnqx","html_id":"index-qixgn9gnqx","key":"yffp3G9Zkg"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"gyI08iU5gx"}],"key":"yeMbCTc0uP"},{"type":"paragraph","position":{"start":{"line":145,"column":1},"end":{"line":145,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":145,"column":1},"end":{"line":145,"column":1}},"key":"H5eb2QugOL"},{"type":"inlineCode","value":"linspace","position":{"start":{"line":145,"column":1},"end":{"line":145,"column":1}},"key":"A42pCdFjK8"},{"type":"text","value":" function constructs evenly spaced values given the endpoints and the number of values.","position":{"start":{"line":145,"column":1},"end":{"line":145,"column":1}},"key":"aRWzHvhK32"}],"key":"vWNxSh079u"}],"class":"dropdown","key":"Pd5BoeLP4Q"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"tt = linspace(1980, 2015, 500);    % 500 times in the interval [1980, 2015]\nyy = p(tt);                        % evaluate p at all the vector elements\nyy(1:4)","key":"xw5lxDdsg6"},{"type":"output","id":"sy7Bw8FxOPdmh8yxZtpBA","data":[{"output_type":"stream","name":"stderr","text":"Unable to perform assignment because the left and right sides have a different number of elements.\n\nError in polyinterp/evaluate (line 29)\n            f(j) = sum(y.*terms) / sum(terms);"}],"key":"JLSJn9i2J2"}],"key":"p0NF4A7xPb"},{"type":"paragraph","position":{"start":{"line":157,"column":1},"end":{"line":157,"column":1}},"children":[{"type":"text","value":"Now we use ","position":{"start":{"line":157,"column":1},"end":{"line":157,"column":1}},"key":"sRRkKyaDj1"},{"type":"inlineCode","value":"plot!","position":{"start":{"line":157,"column":1},"end":{"line":157,"column":1}},"key":"tuLUcp4dn1"},{"type":"text","value":" to add to the current plot, rather than replacing it.","position":{"start":{"line":157,"column":1},"end":{"line":157,"column":1}},"key":"Ng5EBOJDtB"}],"indexEntries":[{"entry":"MATLAB","subEntry":{"value":"hold on","kind":"entry"},"emphasis":true},{"entry":"MATLAB","subEntry":{"value":"plot","kind":"entry"},"emphasis":true}],"label":"index-N8l4oXvcID","identifier":"index-n8l4oxvcid","html_id":"index-n8l4oxvcid","key":"Rcf4HDnXVr"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"Piff70HcTp"}],"key":"CUJxcEdcYD"},{"type":"paragraph","position":{"start":{"line":160,"column":1},"end":{"line":161,"column":1}},"children":[{"type":"text","value":"Use ","position":{"start":{"line":160,"column":1},"end":{"line":160,"column":1}},"key":"NH0hYNnP8w"},{"type":"inlineCode","value":"hold on","position":{"start":{"line":160,"column":1},"end":{"line":160,"column":1}},"key":"jkF7jaCAR1"},{"type":"text","value":" to add to an existing plot rather than replacing it.\nThe ","position":{"start":{"line":160,"column":1},"end":{"line":160,"column":1}},"key":"wtoVLgHlka"},{"type":"inlineCode","value":"plot","position":{"start":{"line":160,"column":1},"end":{"line":160,"column":1}},"key":"h7xhwm4100"},{"type":"text","value":" function plots lines connecting the given ","position":{"start":{"line":160,"column":1},"end":{"line":160,"column":1}},"key":"qGch6Ikimc"},{"type":"inlineMath","value":"x","position":{"start":{"line":160,"column":1},"end":{"line":160,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"nZwuNCwb23"},{"type":"text","value":" and ","position":{"start":{"line":160,"column":1},"end":{"line":160,"column":1}},"key":"pC4kJzyhuB"},{"type":"inlineMath","value":"y","position":{"start":{"line":160,"column":1},"end":{"line":160,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>","key":"agVCk8qCE2"},{"type":"text","value":" values; you can also specify markers at the points.","position":{"start":{"line":160,"column":1},"end":{"line":160,"column":1}},"key":"JSVPMG2pKJ"}],"key":"zfrbuJqMyH"}],"class":"dropdown","key":"T3IAPESAQ9"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"hold on \nplot(tt, yy)\nlegend(\"data\", \"interpolant\", \"location\", \"northwest\");","key":"WaNm1PhI1F"},{"type":"output","id":"Autobrg1qomPKi6jZ33JG","data":[{"output_type":"execute_result","execution_count":10,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"23e517282d0152e58e17507257077ea7","path":"/build/23e517282d0152e58e17507257077ea7.png"}}},{"output_type":"stream","name":"stderr","text":"Unrecognized function or variable 'yy'."}],"key":"S4hcMPd9j6"}],"key":"IeEBPkWK7M"}],"label":"demo-interp-vander-matlab","identifier":"demo-interp-vander-matlab","html_id":"demo-interp-vander-matlab","key":"wGyDMLsmjw"},{"type":"heading","depth":3,"position":{"start":{"line":171,"column":1},"end":{"line":171,"column":1}},"children":[{"type":"text","value":"2.2 ","position":{"start":{"line":171,"column":1},"end":{"line":171,"column":1}},"key":"CjXgU6uVm4"},{"type":"link","identifier":"section-linsys-matrices","label":"section-linsys-matrices","kind":"narrative","position":{"start":{"line":171,"column":5},"end":{"line":171,"column":29}},"url":"/matrices","internal":true,"dataUrl":"/matrices.json","children":[{"type":"text","value":"Computing with matrices","key":"kWGfqbpg6m"}],"key":"FXtlpvHasr"}],"identifier":"id-2-2","label":"2.2 ","html_id":"id-2-2","implicit":true,"key":"o9mPVH1zC4"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-matrices","label":"demo-matrices","kind":"proof:example","position":{"start":{"line":173,"column":1},"end":{"line":173,"column":15}},"children":[{"type":"text","value":"Example ","key":"HMkKacbfy9"},{"type":"text","value":"2.2.1","key":"ZwIZPpltXM"}],"template":"Example %s","enumerator":"2.2.1","resolved":true,"html_id":"demo-matrices","remote":true,"url":"/matrices","dataUrl":"/matrices.json","key":"uvBpgOncG1"}],"key":"yHVzOcFA4B"},{"type":"paragraph","position":{"start":{"line":178,"column":1},"end":{"line":178,"column":1}},"children":[{"type":"text","value":"In MATLAB, every numerical value is treated like a matrix. A matrix with one row or one column is interpreted as a vector, and a ","position":{"start":{"line":178,"column":1},"end":{"line":178,"column":1}},"key":"xLmSeGqutj"},{"type":"inlineMath","value":"1\\times 1","position":{"start":{"line":178,"column":1},"end":{"line":178,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mo>×</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">1\\times 1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"jrdyFLPM52"},{"type":"text","value":" matrix is interpreted as a scalar.","position":{"start":{"line":178,"column":1},"end":{"line":178,"column":1}},"key":"AZaAkshtmP"}],"indexEntries":[{"entry":"MATLAB","subEntry":{"value":"size","kind":"entry"},"emphasis":true},{"entry":"MATLAB","subEntry":{"value":"length","kind":"entry"},"emphasis":true}],"label":"index-Xwvr0o3iYe","identifier":"index-xwvr0o3iye","html_id":"index-xwvr0o3iye","key":"AdtfuhJdzQ"},{"type":"paragraph","position":{"start":{"line":180,"column":1},"end":{"line":180,"column":1}},"children":[{"type":"text","value":"Square brackets are used to enclose elements of a matrix or vector. Use spaces for horizontal concatenation, and semicolons or new lines to indicate vertical concatenation.","position":{"start":{"line":180,"column":1},"end":{"line":180,"column":1}},"key":"sfEVLiwjJS"}],"key":"FQqkCOQKmK"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"xBv9scDxZx"}],"key":"mJSo2aPiGi"},{"type":"paragraph","position":{"start":{"line":183,"column":1},"end":{"line":183,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":183,"column":1},"end":{"line":183,"column":1}},"key":"EFFblGug2w"},{"type":"inlineCode","value":"size","position":{"start":{"line":183,"column":1},"end":{"line":183,"column":1}},"key":"AYQCKneCZm"},{"type":"text","value":" function returns the number of rows and columns in a matrix. Use ","position":{"start":{"line":183,"column":1},"end":{"line":183,"column":1}},"key":"GnLqsEMKlY"},{"type":"inlineCode","value":"length","position":{"start":{"line":183,"column":1},"end":{"line":183,"column":1}},"key":"zZtzCdNtMt"},{"type":"text","value":" to get the number of elements in a vector or matrix.","position":{"start":{"line":183,"column":1},"end":{"line":183,"column":1}},"key":"u391VCXuec"}],"key":"fYOVCyO6QK"}],"class":"dropdown","key":"wNgyVMelaa"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A = [ \n    1       2      3             4      5; \n    50     40     30            20     10\n    pi sqrt(2) exp(1) (1+sqrt(5))/2 log(3) \n    ]","key":"gBWq4vFfyX"},{"type":"output","id":"KP91vaOilkhK0sOYJjcty","data":[{"output_type":"execute_result","execution_count":11,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>A = 3×5 double\n   1.0000e+00   2.0000e+00   3.0000e+00   4.0000e+00   5.0000e+00\n   5.0000e+01   4.0000e+01   3.0000e+01   2.0000e+01   1.0000e+01\n   3.1416e+00   1.4142e+00   2.7183e+00   1.6180e+00   1.0986e+00\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"A = 3×5 double\n   1.0000e+00   2.0000e+00   3.0000e+00   4.0000e+00   5.0000e+00\n   5.0000e+01   4.0000e+01   3.0000e+01   2.0000e+01   1.0000e+01\n   3.1416e+00   1.4142e+00   2.7183e+00   1.6180e+00   1.0986e+00\n","content_type":"text/plain"}}}],"key":"RH4vJNeu1z"}],"key":"VBQ3HGLkZr"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"m, n = size(A)","key":"bSfyn0TbgQ"},{"type":"output","id":"GqYIhcZ6F30peliZ2jtvl","data":[{"output_type":"execute_result","execution_count":12,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>m = \n     4\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"m = \n     4\n","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":12,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>n = 1×2 double\n     3     5\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"n = 1×2 double\n     3     5\n","content_type":"text/plain"}}}],"key":"t0MJ2abbWH"}],"key":"rULgqV5rMo"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"x = [ 3, 3, 0, 1, 0 ];   % row vector\nsize(x)","key":"vACbVnYmJz"},{"type":"output","id":"CMb55K00zgmN1EhI5bMf5","data":[{"output_type":"execute_result","execution_count":13,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = 1×2 double\n     1     5\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = 1×2 double\n     1     5\n","content_type":"text/plain"}}}],"key":"UTUZdITxTV"}],"key":"tvfsGdiEpR"},{"type":"paragraph","position":{"start":{"line":204,"column":1},"end":{"line":204,"column":1}},"children":[{"type":"text","value":"Concatenated elements within brackets may be matrices or vectors for a block representation, as long as all the block sizes are compatible.","position":{"start":{"line":204,"column":1},"end":{"line":204,"column":1}},"key":"xO50iQ3l0g"}],"key":"w6muNfu21C"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[ x  x ]","key":"yBsk3May7D"},{"type":"output","id":"-VF2VphgAit-3NkCDFm1B","data":[{"output_type":"execute_result","execution_count":14,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = 1×10 double\n     3     3     0     1     0     3     3     0     1     0\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = 1×10 double\n     3     3     0     1     0     3     3     0     1     0\n","content_type":"text/plain"}}}],"key":"fAlXP0Mu9m"}],"key":"wkIDUL2F6F"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[ x; x ]","key":"fOais73aCA"},{"type":"output","id":"u4ZaUKcc_WSYfLZBSMWnX","data":[{"output_type":"execute_result","execution_count":15,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = 800×1 double\n                   0\n   0.002500000000000\n   0.005000000000000\n   0.007500000000000\n   0.010000000000000\n   0.012500000000000\n   0.015000000000000\n   0.017500000000000\n   0.020000000000000\n   0.022500000000000\n...</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = 800×1 double\n                   0\n   0.002500000000000\n   0.005000000000000\n   0.007500000000000\n   0.010000000000000\n   0.012500000000000\n   0.015000000000000\n   0.017500000000000\n   0.020000000000000\n   0.022500000000000\n...","content_type":"text/plain"}}}],"key":"FBuKy8xvLe"}],"key":"wH2ozHFWB0"},{"type":"paragraph","position":{"start":{"line":217,"column":1},"end":{"line":217,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":217,"column":1},"end":{"line":217,"column":1}},"key":"plexkbkbAT"},{"type":"inlineCode","value":"zeros","position":{"start":{"line":217,"column":1},"end":{"line":217,"column":1}},"key":"PGhTSYJPoL"},{"type":"text","value":" and ","position":{"start":{"line":217,"column":1},"end":{"line":217,"column":1}},"key":"GbWBcaZziP"},{"type":"inlineCode","value":"ones","position":{"start":{"line":217,"column":1},"end":{"line":217,"column":1}},"key":"ashL7QoRrt"},{"type":"text","value":" functions construct matrices with entries all zero or one, respectively.","position":{"start":{"line":217,"column":1},"end":{"line":217,"column":1}},"key":"wzjW8KVRPH"}],"indexEntries":[{"entry":"MATLAB","subEntry":{"value":"zeros","kind":"entry"},"emphasis":true},{"entry":"MATLAB","subEntry":{"value":"ones","kind":"entry"},"emphasis":true}],"label":"index-K9bi2SGTD0","identifier":"index-k9bi2sgtd0","html_id":"index-k9bi2sgtd0","key":"mzlfPXy9Oj"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"B = [ zeros(3, 2) ones(3, 1) ]","key":"jHFiY8OZRo"},{"type":"output","id":"KsMnIWzRbHFBn2ON-YAz4","data":[{"output_type":"execute_result","execution_count":16,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>B = 3×3 double\n     0     0     1\n     0     0     1\n     0     0     1\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"B = 3×3 double\n     0     0     1\n     0     0     1\n     0     0     1\n","content_type":"text/plain"}}}],"key":"Pc0hHExhvN"}],"key":"Zx7KHupoab"},{"type":"paragraph","position":{"start":{"line":226,"column":1},"end":{"line":226,"column":1}},"children":[{"type":"text","value":"A single quote ","position":{"start":{"line":226,"column":1},"end":{"line":226,"column":1}},"key":"e02TOBwvSZ"},{"type":"inlineCode","value":"'","position":{"start":{"line":226,"column":1},"end":{"line":226,"column":1}},"key":"VOE5SnhYx1"},{"type":"text","value":" after a matrix returns its adjoint. For real matrices, this is the transpose; for complex-valued matrices, the elements are also conjugated.","position":{"start":{"line":226,"column":1},"end":{"line":226,"column":1}},"key":"HeWFL9BXaK"}],"indexEntries":[{"entry":"MATLAB","subEntry":{"value":"transpose","kind":"entry"},"emphasis":true},{"entry":"MATLAB","subEntry":{"value":"adjoint","kind":"entry"},"emphasis":true},{"entry":"MATLAB","subEntry":{"value":"\\'","kind":"entry"},"emphasis":true}],"label":"index-vzLSdyQ8Bz","identifier":"index-vzlsdyq8bz","html_id":"index-vzlsdyq8bz","key":"kWrqgbs16K"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A'","key":"y0mFf0hCmH"},{"type":"output","id":"rP1YI3rUN4TERsuYT1pV-","data":[{"output_type":"execute_result","execution_count":17,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = \n  Columns 1 through 2\n\n  -1.4568e+00 + 0.0000e+00i   2.4354e-01 + 6.8497e-01i\n   2.4354e-01 - 6.8497e-01i   1.7283e+00 + 0.0000e+00i\n  -3.2242e-02 - 1.1942e+00i   1.3377e+00 - 3.7267e-02i\n  -8.0037e-01 - 1.6783e+00i   3.6769e-01 + 4.3942e-02i\n   1.0315e+00 + 3.1215e-01i  -8.5540e-02 + 7.1419e-01i\n   2.8617e-01 + 7.0846e-01i  -9.7051e-01 + 1.0873e+00i\n  -1.0113e-01 - 1.2976e+00i   7.0498e-01 - 1.7575e-01i\n\n  Columns 3 through 4\n\n  -3.2242e-02 + 1.1942e+00i  -8.0037e-01 + 1.6783e+00i\n   1.3377e+00 + 3.7267e-02i   3.6769e-01 - 4.3942e-02i\n   4.5764e-01 + 0.0000e+00i   4.4211e-01 - 1.7664e-01i\n   4.4211e-01 + 1.7664e-01i   7.7511e-01 + 0.0000e+00i\n  -5.6162e-01 + 3.4719e-01i   8.3951e-01 - 9.8058e-01i\n  -9.0968e-01 - 5.4220e-01i  -5.8835e-01 + 1.4548e-01i\n  -8.0992e-01 - 4.5419e-01i  -9.7813e-01 + 1.7613e+00i\n\n  Columns 5 through 6\n\n   1.0315e+00 - 3.1215e-01i   2.8617e-01 - 7.0846e-01i\n  -8.5540e-02 - 7.1419e-01i  -9.7051e-01 - 1.0873e+00i\n  -5.6162e-01 - 3.4719e-01i  -9.0968e-01 + 5.4220e-01i\n   8.3951e-01 + 9.8058e-01i  -5.8835e-01 - 1.4548e-01i\n   6.5444e-01 + 0.0000e+00i   3.8851e-01 + 1.3576e-02i\n   3.8851e-01 - 1.3576e-02i   4.5075e-01 + 0.0000e+00i\n  -1.0296e+00 - 4.8757e-01i   3.9233e-01 - 2.7791e-01i\n\n  Column 7\n\n  -1.0113e-01 + 1.2976e+00i\n   7.0498e-01 + 1.7575e-01i\n  -8.0992e-01 + 4.5419e-01i\n  -9.7813e-01 - 1.7613e+00i\n  -1.0296e+00 + 4.8757e-01i\n   3.9233e-01 + 2.7791e-01i\n  -7.7652e-01 + 0.0000e+00i\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = \n  Columns 1 through 2\n\n  -1.4568e+00 + 0.0000e+00i   2.4354e-01 + 6.8497e-01i\n   2.4354e-01 - 6.8497e-01i   1.7283e+00 + 0.0000e+00i\n  -3.2242e-02 - 1.1942e+00i   1.3377e+00 - 3.7267e-02i\n  -8.0037e-01 - 1.6783e+00i   3.6769e-01 + 4.3942e-02i\n   1.0315e+00 + 3.1215e-01i  -8.5540e-02 + 7.1419e-01i\n   2.8617e-01 + 7.0846e-01i  -9.7051e-01 + 1.0873e+00i\n  -1.0113e-01 - 1.2976e+00i   7.0498e-01 - 1.7575e-01i\n\n  Columns 3 through 4\n\n  -3.2242e-02 + 1.1942e+00i  -8.0037e-01 + 1.6783e+00i\n   1.3377e+00 + 3.7267e-02i   3.6769e-01 - 4.3942e-02i\n   4.5764e-01 + 0.0000e+00i   4.4211e-01 - 1.7664e-01i\n   4.4211e-01 + 1.7664e-01i   7.7511e-01 + 0.0000e+00i\n  -5.6162e-01 + 3.4719e-01i   8.3951e-01 - 9.8058e-01i\n  -9.0968e-01 - 5.4220e-01i  -5.8835e-01 + 1.4548e-01i\n  -8.0992e-01 - 4.5419e-01i  -9.7813e-01 + 1.7613e+00i\n\n  Columns 5 through 6\n\n   1.0315e+00 - 3.1215e-01i   2.8617e-01 - 7.0846e-01i\n  -8.5540e-02 - 7.1419e-01i  -9.7051e-01 - 1.0873e+00i\n  -5.6162e-01 - 3.4719e-01i  -9.0968e-01 + 5.4220e-01i\n   8.3951e-01 + 9.8058e-01i  -5.8835e-01 - 1.4548e-01i\n   6.5444e-01 + 0.0000e+00i   3.8851e-01 + 1.3576e-02i\n   3.8851e-01 - 1.3576e-02i   4.5075e-01 + 0.0000e+00i\n  -1.0296e+00 - 4.8757e-01i   3.9233e-01 - 2.7791e-01i\n\n  Column 7\n\n  -1.0113e-01 + 1.2976e+00i\n   7.0498e-01 + 1.7575e-01i\n  -8.0992e-01 + 4.5419e-01i\n  -9.7813e-01 - 1.7613e+00i\n  -1.0296e+00 + 4.8757e-01i\n   3.9233e-01 + 2.7791e-01i\n  -7.7652e-01 + 0.0000e+00i\n","content_type":"text/plain"}}}],"key":"t4rjdKqsGZ"}],"key":"wqiortHVA7"},{"type":"paragraph","position":{"start":{"line":235,"column":1},"end":{"line":235,"column":1}},"children":[{"type":"text","value":"There are many convenient shorthand ways of building vectors and matrices other than entering all of their entries directly or in a loop. To get a range with evenly spaced entries between two endpoints, you have two options. One is to use a colon ","position":{"start":{"line":235,"column":1},"end":{"line":235,"column":1}},"key":"NLnQq6efnb"},{"type":"inlineCode","value":":","position":{"start":{"line":235,"column":1},"end":{"line":235,"column":1}},"key":"FlmwXQWmQk"},{"type":"text","value":".","position":{"start":{"line":235,"column":1},"end":{"line":235,"column":1}},"key":"SEUM2tossD"}],"indexEntries":[{"entry":"MATLAB","subEntry":{"value":"linspace","kind":"entry"},"emphasis":true},{"entry":"MATLAB","subEntry":{"value":":","kind":"entry"},"emphasis":true}],"label":"index-GeRHdIi4qd","identifier":"index-gerhdii4qd","html_id":"index-gerhdii4qd","key":"hzMbyE0zTf"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"y = 1:4              % start:stop","key":"TVcW2AtcgC"},{"type":"output","id":"tXyJibvhEhvQm47y_5zW9","data":[{"output_type":"execute_result","execution_count":18,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>y = 1×4 double\n     1     2     3     4\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"y = 1×4 double\n     1     2     3     4\n","content_type":"text/plain"}}}],"key":"cvn0IizinD"}],"key":"s9o0xYP3oP"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"z = 0:3:12           % start:step:stop","key":"yW5whfLkAK"},{"type":"output","id":"MMq3YP-aQl8YOo51nzvpH","data":[{"output_type":"execute_result","execution_count":19,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>z = 1×5 double\n     0     3     6     9    12\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"z = 1×5 double\n     0     3     6     9    12\n","content_type":"text/plain"}}}],"key":"Y3MP9Qn87U"}],"key":"rJvqFT499F"},{"type":"paragraph","position":{"start":{"line":245,"column":1},"end":{"line":245,"column":1}},"children":[{"type":"text","value":"Instead of specifying the step size, you can give the number of points in the range if you use ","position":{"start":{"line":245,"column":1},"end":{"line":245,"column":1}},"key":"DVMkqCQ1Y7"},{"type":"inlineCode","value":"linspace","position":{"start":{"line":245,"column":1},"end":{"line":245,"column":1}},"key":"NnjYvZBAVO"},{"type":"text","value":".","position":{"start":{"line":245,"column":1},"end":{"line":245,"column":1}},"key":"mrYPQbHu1X"}],"key":"A7gsOT0q79"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"s = linspace(-1, 1, 5)    % row result","key":"PCh9vWgnBm"},{"type":"output","id":"1mkoKp-m3xKFIvg5yavFX","data":[{"output_type":"execute_result","execution_count":20,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>s = 1×5 double\n  -1.0000e+00  -5.0000e-01            0   5.0000e-01   1.0000e+00\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"s = 1×5 double\n  -1.0000e+00  -5.0000e-01            0   5.0000e-01   1.0000e+00\n","content_type":"text/plain"}}}],"key":"GCTK6KNPaq"}],"key":"Tj1YBEyXuH"},{"type":"paragraph","position":{"start":{"line":254,"column":1},"end":{"line":254,"column":1}},"children":[{"type":"text","value":"Accessing an element is done by giving one (for a vector) or two (for a matrix) index values within parentheses.","position":{"start":{"line":254,"column":1},"end":{"line":254,"column":1}},"key":"RfrYo3XCmy"}],"indexEntries":[{"entry":"MATLAB","subEntry":{"value":"end","kind":"entry"},"emphasis":true},{"entry":"MATLAB","subEntry":{"value":"indexing arrays","kind":"entry"},"emphasis":true}],"label":"index-oLZfWAQX8W","identifier":"index-olzfwaqx8w","html_id":"index-olzfwaqx8w","key":"ksAMptFwEu"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"hsBURwjmh9"}],"key":"CHH1BGSXni"},{"type":"paragraph","position":{"start":{"line":257,"column":1},"end":{"line":257,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":257,"column":1},"end":{"line":257,"column":1}},"key":"j6PyLPYwkC"},{"type":"inlineCode","value":"end","position":{"start":{"line":257,"column":1},"end":{"line":257,"column":1}},"key":"poJ4P6qady"},{"type":"text","value":" keyword refers to the last element in a dimension. It saves you from having to compute and store the size of the matrix first.","position":{"start":{"line":257,"column":1},"end":{"line":257,"column":1}},"key":"D3wuSS4DO9"}],"key":"eVqmlfIJUp"}],"class":"dropdown","key":"r5q8dQ9EBf"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"a = A(2, end-1)","key":"aGF78ocVOy"},{"type":"output","id":"gMh2bodyowerAvaAEGuxI","data":[{"output_type":"execute_result","execution_count":21,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>a = \n     7\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"a = \n     7\n","content_type":"text/plain"}}}],"key":"ppPoYaKExk"}],"key":"UQRYZNer3a"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"x(2)","key":"WdMrIKDOJV"},{"type":"output","id":"8vAtIcDbxc1QyEGSZ_1Pt","data":[{"output_type":"execute_result","execution_count":22,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = \n    -962/3553  \n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = \n    -962/3553  \n","content_type":"text/plain"}}}],"key":"XjYQZjYKHH"}],"key":"XyzBDWfOtc"},{"type":"paragraph","position":{"start":{"line":268,"column":1},"end":{"line":268,"column":1}},"children":[{"type":"text","value":"The indices can be vectors or ranges, in which case a block of the matrix is accessed.","position":{"start":{"line":268,"column":1},"end":{"line":268,"column":1}},"key":"T8p4nhI4Na"}],"key":"rcntTZEeLB"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A(1:2, end-2:end)    % first two rows, last three columns","key":"oQQmfb6Yth"},{"type":"output","id":"7nXMNE6Qd3HmDJYiPuuhw","data":[{"output_type":"execute_result","execution_count":23,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = 2×3 double\n    24     1     8\n     5     7    14\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = 2×3 double\n    24     1     8\n     5     7    14\n","content_type":"text/plain"}}}],"key":"gKsufVnzga"}],"key":"lDJBaAbjtK"},{"type":"paragraph","position":{"start":{"line":277,"column":1},"end":{"line":277,"column":1}},"children":[{"type":"text","value":"If a dimension has only the index ","position":{"start":{"line":277,"column":1},"end":{"line":277,"column":1}},"key":"aN7Uhm92cW"},{"type":"inlineCode","value":":","position":{"start":{"line":277,"column":1},"end":{"line":277,"column":1}},"key":"rJVVU6HyF3"},{"type":"text","value":" (a colon), then it refers to all the entries in that dimension of the matrix.","position":{"start":{"line":277,"column":1},"end":{"line":277,"column":1}},"key":"lEmJcXAHLt"}],"indexEntries":[{"entry":"MATLAB","subEntry":{"value":":","kind":"entry"},"emphasis":false}],"label":"index-YdV7lKbSz7","identifier":"index-ydv7lkbsz7","html_id":"index-ydv7lkbsz7","key":"AEcCZRPKxR"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A(:, 1:2:end)        % all of the odd columns","key":"AgeiE54KrU"},{"type":"output","id":"K3qrWv3ry0muSwjbXjWGi","data":[{"output_type":"execute_result","execution_count":24,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = 5×3 double\n   1.391432836534640  -0.600295765014863  -0.761917467242313\n  -3.228541752471429  -1.901343919927020   2.199431185574128\n  -0.600295765014863   3.140819009887375  -1.501359407651272\n  -0.483099602705164   0.784116216898455   0.921230383787219\n  -0.761917467242313  -1.501359407651272   0.257904315544598\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = 5×3 double\n   1.391432836534640  -0.600295765014863  -0.761917467242313\n  -3.228541752471429  -1.901343919927020   2.199431185574128\n  -0.600295765014863   3.140819009887375  -1.501359407651272\n  -0.483099602705164   0.784116216898455   0.921230383787219\n  -0.761917467242313  -1.501359407651272   0.257904315544598\n","content_type":"text/plain"}}}],"key":"wr6zLTUihH"}],"key":"Ph2YlPTfaP"},{"type":"paragraph","position":{"start":{"line":286,"column":1},"end":{"line":286,"column":1}},"children":[{"type":"text","value":"The matrix and vector senses of addition, subtraction, scalar multiplication, multiplication, and power are all handled by the usual symbols.","position":{"start":{"line":286,"column":1},"end":{"line":286,"column":1}},"key":"Ks1QqPxQym"}],"indexEntries":[{"entry":"MATLAB","subEntry":{"value":"diag","kind":"entry"},"emphasis":true}],"label":"index-BPbVcN40RE","identifier":"index-bpbvcn40re","html_id":"index-bpbvcn40re","key":"PVsrwYmI37"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"BfwcIGJUrk"}],"key":"d9NYHMHPb4"},{"type":"paragraph","position":{"start":{"line":289,"column":1},"end":{"line":289,"column":1}},"children":[{"type":"text","value":"Use ","position":{"start":{"line":289,"column":1},"end":{"line":289,"column":1}},"key":"IXCMOxAVpL"},{"type":"inlineCode","value":"diag","position":{"start":{"line":289,"column":1},"end":{"line":289,"column":1}},"key":"P38rOVRNWN"},{"type":"text","value":" to construct a matrix by its diagonals. A more general syntax puts elements on super- or subdiagonals.","position":{"start":{"line":289,"column":1},"end":{"line":289,"column":1}},"key":"RUv42TjQ2d"}],"key":"ZitxfbtI3G"}],"class":"dropdown","key":"NFwXqNV8pZ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"B = diag([-1, 0, -5])   % create a diagonal matrix","key":"zT5baIXdkL"},{"type":"output","id":"_jT-PDo7BO9NDkqGpKq20","data":[{"output_type":"execute_result","execution_count":25,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>B = 3×3 double\n    -1     0     0\n     0     0     0\n     0     0    -5\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"B = 3×3 double\n    -1     0     0\n     0     0     0\n     0     0    -5\n","content_type":"text/plain"}}}],"key":"MdeiEdZpYU"}],"key":"j3gE2ZXukq"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"size(A)\nsize(B)","key":"kSuI73ilr9"},{"type":"output","id":"6lN5768Y6T3V86cHrv_p2","data":[{"output_type":"execute_result","execution_count":26,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = 1×2 double\n   400     3\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = 1×2 double\n   400     3\n","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":26,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = 1×2 double\n     3     3\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = 1×2 double\n     3     3\n","content_type":"text/plain"}}}],"key":"AQnzXy2CbT"}],"key":"DmHcKmbVAD"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"BA = B * A     % matrix product","key":"wxLYt0gpw9"},{"type":"output","id":"hfzUMXk--2EEyy6mJ5L-O","data":[{"output_type":"stream","name":"stderr","text":"Error using *\nIncorrect dimensions for matrix multiplication. Check that the number of columns in the first matrix matches the number of rows in the second matrix. To operate on each element of the matrix individually, use TIMES (.*) for elementwise multiplication."}],"key":"GCBT2SoGTF"}],"key":"BLM3pejsC0"},{"type":"paragraph","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":1}},"children":[{"type":"inlineCode","value":"A * B","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":1}},"key":"kFqcnodzK2"},{"type":"text","value":" causes an error here, because the dimensions aren’t compatible.","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":1}},"key":"hPaAzEVVSX"}],"key":"CcWl0nQZth"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"BsJkWFryB9"}],"key":"vtn7jN3YL6"},{"type":"paragraph","position":{"start":{"line":308,"column":1},"end":{"line":308,"column":1}},"children":[{"type":"text","value":"Errors are formally called ","position":{"start":{"line":308,"column":1},"end":{"line":308,"column":1}},"key":"IaaS8l5igu"},{"type":"emphasis","position":{"start":{"line":308,"column":1},"end":{"line":308,"column":1}},"children":[{"type":"text","value":"exceptions","position":{"start":{"line":308,"column":1},"end":{"line":308,"column":1}},"key":"hPXcUPFj6P"}],"key":"EjKu9tQPoy"},{"type":"text","value":" in Julia.","position":{"start":{"line":308,"column":1},"end":{"line":308,"column":1}},"key":"fqNpdbyj0G"}],"key":"IYfH0aqy6x"}],"class":"dropdown","key":"lS9ZYPWbwT"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"A * B    % throws an error","visibility":"show","key":"YwrsCdZfoH"},{"type":"output","id":"CEBWq50skLY5J6nJ-tQBh","data":[{"output_type":"stream","name":"stderr","text":"Error using *\nIncorrect dimensions for matrix multiplication. Check that the number of columns in the first matrix matches the number of rows in the second matrix. To operate on each element of the matrix individually, use TIMES (.*) for elementwise multiplication."}],"visibility":"show","key":"g4chejFpG9"}],"data":{"tags":["raises-exception"]},"visibility":"show","key":"uGmgcXjsUl"},{"type":"paragraph","position":{"start":{"line":316,"column":1},"end":{"line":316,"column":1}},"children":[{"type":"text","value":"A square matrix raised to an integer power is the same as repeated matrix multiplication.","position":{"start":{"line":316,"column":1},"end":{"line":316,"column":1}},"key":"G5T24RZipy"}],"key":"nq8HN7Z3o4"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"B^3    % same as B*B*B","key":"h0tDufYEx8"},{"type":"output","id":"dHrTe2LH0DSOPt-t1QnKG","data":[{"output_type":"execute_result","execution_count":29,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = 3×3 double\n    -1     0     0\n     0     0     0\n     0     0  -125\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = 3×3 double\n    -1     0     0\n     0     0     0\n     0     0  -125\n","content_type":"text/plain"}}}],"key":"RStXI8QhTA"}],"key":"DRFbbWLnsc"},{"type":"paragraph","position":{"start":{"line":322,"column":1},"end":{"line":322,"column":1}},"children":[{"type":"text","value":"Sometimes one instead wants to treat a matrix or vector as a mere array and simply apply a single operation to each element of it. For multiplication, division, and power, the corresponding operators start with a dot.","position":{"start":{"line":322,"column":1},"end":{"line":322,"column":1}},"key":"PwaZv3T4vi"}],"key":"TosJscBbZm"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"C = -A;","key":"ngEdp8NL1F"},{"type":"output","id":"7AS4471SHEoznVGv1RKs1","data":[],"key":"ylI6pJg3ho"}],"key":"MjOusGBKhe"},{"type":"paragraph","position":{"start":{"line":328,"column":1},"end":{"line":328,"column":1}},"children":[{"type":"text","value":"Because both matrices are ","position":{"start":{"line":328,"column":1},"end":{"line":328,"column":1}},"key":"CnRE8XO2B3"},{"type":"inlineMath","value":"3\\times 5","position":{"start":{"line":328,"column":1},"end":{"line":328,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>3</mn><mo>×</mo><mn>5</mn></mrow><annotation encoding=\"application/x-tex\">3\\times 5</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">3</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">5</span></span></span></span>","key":"bXHcmhr3FD"},{"type":"text","value":", ","position":{"start":{"line":328,"column":1},"end":{"line":328,"column":1}},"key":"QOApVAMWBL"},{"type":"inlineCode","value":"A * C","position":{"start":{"line":328,"column":1},"end":{"line":328,"column":1}},"key":"I5fA1iHYP3"},{"type":"text","value":" would be an error here, but elementwise operations are fine.","position":{"start":{"line":328,"column":1},"end":{"line":328,"column":1}},"key":"gJDyIQG6kR"}],"key":"o5DjQjLcrO"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"elementwise = A .* C","key":"xjncOKctSj"},{"type":"output","id":"Ppebz2P6dO3BQmPSoKPob","data":[{"output_type":"execute_result","execution_count":31,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>elementwise = 5×5 double\n   -1.0000   -1.0000   -1.0000   -1.0000   -1.0000\n         0   -0.5625   -1.0000   -1.0000   -1.0000\n         0         0   -0.3600   -1.0000   -1.0000\n         0         0         0   -0.1600   -1.0000\n         0         0         0         0         0\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"elementwise = 5×5 double\n   -1.0000   -1.0000   -1.0000   -1.0000   -1.0000\n         0   -0.5625   -1.0000   -1.0000   -1.0000\n         0         0   -0.3600   -1.0000   -1.0000\n         0         0         0   -0.1600   -1.0000\n         0         0         0         0         0\n","content_type":"text/plain"}}}],"key":"cUmT2Mg6vC"}],"key":"pivbtXuSKU"},{"type":"paragraph","position":{"start":{"line":337,"column":1},"end":{"line":337,"column":1}},"children":[{"type":"text","value":"The two operands of a dot operator have to have the same size—unless one is a scalar, in which case it is expanded or ","position":{"start":{"line":337,"column":1},"end":{"line":337,"column":1}},"key":"tIcS5TpW2i"},{"type":"emphasis","position":{"start":{"line":337,"column":1},"end":{"line":337,"column":1}},"children":[{"type":"text","value":"broadcast","position":{"start":{"line":337,"column":1},"end":{"line":337,"column":1}},"key":"A0GAtVOPl9"}],"key":"AoZ7BEnNDx"},{"type":"text","value":" to be the same size as the other operand.","position":{"start":{"line":337,"column":1},"end":{"line":337,"column":1}},"key":"yyiGXAAFjq"}],"indexEntries":[{"entry":"MATLAB","subEntry":{"value":"broadcasting","kind":"entry"},"emphasis":false}],"label":"index-JM2340JNAb","identifier":"index-jm2340jnab","html_id":"index-jm2340jnab","key":"YYFpoEwph4"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"x_to_two = x .^ 2","key":"fCUHQSj6TS"},{"type":"output","id":"BHz4P9HA2l7phXF3Bisq6","data":[{"output_type":"execute_result","execution_count":32,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>x_to_two = 201×1 double\n    1.0000\n    0.9998\n    0.9990\n    0.9978\n    0.9961\n    0.9938\n    0.9911\n    0.9880\n    0.9843\n    0.9801\n...</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"x_to_two = 201×1 double\n    1.0000\n    0.9998\n    0.9990\n    0.9978\n    0.9961\n    0.9938\n    0.9911\n    0.9880\n    0.9843\n    0.9801\n...","content_type":"text/plain"}}}],"key":"lOFilkM3Wj"}],"key":"AvCxQkQcDy"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"two_to_x = 2 .^ x","key":"Yofc6T6RJi"},{"type":"output","id":"_Fcml2JqH-WL_BgRJmTc8","data":[{"output_type":"execute_result","execution_count":33,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>two_to_x = 61×1 double\n    0.5000\n    0.5005\n    0.5019\n    0.5043\n    0.5076\n    0.5119\n    0.5173\n    0.5236\n    0.5309\n    0.5392\n...</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"two_to_x = 61×1 double\n    0.5000\n    0.5005\n    0.5019\n    0.5043\n    0.5076\n    0.5119\n    0.5173\n    0.5236\n    0.5309\n    0.5392\n...","content_type":"text/plain"}}}],"key":"imP5HyCxDd"}],"key":"UcecYU8gL3"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"rwYjZnaakF"}],"key":"FIbqpCIfN3"},{"type":"paragraph","position":{"start":{"line":349,"column":1},"end":{"line":349,"column":1}},"children":[{"type":"text","value":"Most of the mathematical functions, such as cos, sin, log, exp, and sqrt, can operate elementwise on vectors and matrices.","position":{"start":{"line":349,"column":1},"end":{"line":349,"column":1}},"key":"rBGGnQ0vL1"}],"key":"bGmJNP43Pm"}],"class":"dropdown","key":"FgeEz1XQY4"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"cos(pi * x)","key":"U7HpS1FzAg"},{"type":"output","id":"skeokdan5Vd0WEJ4ynf5C","data":[{"output_type":"stream","name":"stderr","text":"Failed to execute. Operation may have interrupted by user."}],"key":"SagWQGAMj2"}],"key":"fORIhcfDic"}],"label":"demo-matrices-matlab","identifier":"demo-matrices-matlab","html_id":"demo-matrices-matlab","key":"YlVkZy4cqG"},{"type":"heading","depth":3,"position":{"start":{"line":357,"column":1},"end":{"line":357,"column":1}},"children":[{"type":"text","value":"2.3 ","position":{"start":{"line":357,"column":1},"end":{"line":357,"column":1}},"key":"pKvpslhVMh"},{"type":"link","identifier":"section-linsys-linear-systems","label":"section-linsys-linear-systems","kind":"narrative","position":{"start":{"line":357,"column":5},"end":{"line":357,"column":35}},"url":"/linear-systems","internal":true,"dataUrl":"/linear-systems.json","children":[{"type":"text","value":"Linear systems","key":"HBqBN7IWvl"}],"key":"FejvV6KqSJ"}],"identifier":"id-2-3","label":"2.3 ","html_id":"id-2-3","implicit":true,"key":"YEHP0LRQDF"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-systems-backslash","label":"demo-systems-backslash","kind":"proof:example","position":{"start":{"line":359,"column":1},"end":{"line":359,"column":24}},"children":[{"type":"text","value":"Example ","key":"UIKJVr3uJd"},{"type":"text","value":"2.3.2","key":"jCSfIpClwo"}],"template":"Example %s","enumerator":"2.3.2","resolved":true,"html_id":"demo-systems-backslash","remote":true,"url":"/linear-systems","dataUrl":"/linear-systems.json","key":"UUU0IEGmYq"}],"key":"Dxbn93HcLJ"},{"type":"paragraph","position":{"start":{"line":361,"column":1},"end":{"line":361,"column":1}},"children":[{"type":"text","value":"For a square matrix ","position":{"start":{"line":361,"column":1},"end":{"line":361,"column":1}},"key":"cqfpp4Pcs0"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":361,"column":1},"end":{"line":361,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"abbIvFMZnw"},{"type":"text","value":", the syntax ","position":{"start":{"line":361,"column":1},"end":{"line":361,"column":1}},"key":"OPweSVrvMh"},{"type":"inlineCode","value":"A \\ b","position":{"start":{"line":361,"column":1},"end":{"line":361,"column":1}},"key":"btb3a34Zqf"},{"type":"text","value":" is mathematically equivalent to ","position":{"start":{"line":361,"column":1},"end":{"line":361,"column":1}},"key":"vqrCwsv4x1"},{"type":"inlineMath","value":"\\mathbf{A}^{-1} \\mathbf{b}","position":{"start":{"line":361,"column":1},"end":{"line":361,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi mathvariant=\"bold\">A</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}^{-1} \\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">A</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"sN0uIQstS6"},{"type":"text","value":".","position":{"start":{"line":361,"column":1},"end":{"line":361,"column":1}},"key":"LlrPPUQRX4"}],"key":"M6fdEO4I1t"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A = [1 0 -1; 2 2 1; -1 -3 0]","key":"TWHOXgUdUT"},{"type":"output","id":"ARVA9W4mJdGmDYzEByFjs","data":[{"output_type":"execute_result","execution_count":35,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>A = 3×3 double\n     1     0    -1\n     2     2     1\n    -1    -3     0\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"A = 3×3 double\n     1     0    -1\n     2     2     1\n    -1    -3     0\n","content_type":"text/plain"}}}],"key":"LI6yxo3TQi"}],"key":"A9449UrGOY"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"b = [1; 2; 3]","key":"Er63SBZJFh"},{"type":"output","id":"01b2A_awaRHt3w0bprVI-","data":[{"output_type":"execute_result","execution_count":36,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>b = 3×1 double\n     1\n     2\n     3\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"b = 3×1 double\n     1\n     2\n     3\n","content_type":"text/plain"}}}],"key":"tfSB9A22nL"}],"key":"P6HL23dZxg"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"x = A \\ b","key":"RCZuekWqfD"},{"type":"output","id":"elG1nsrTfhfXyDRUYZhx4","data":[{"output_type":"execute_result","execution_count":37,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>x = 3×1 double\n   2.1429e+00\n  -1.7143e+00\n   1.1429e+00\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"x = 3×1 double\n   2.1429e+00\n  -1.7143e+00\n   1.1429e+00\n","content_type":"text/plain"}}}],"key":"Ud3Af6xhX2"}],"key":"kt6MOxsiUQ"},{"type":"paragraph","position":{"start":{"line":378,"column":1},"end":{"line":378,"column":1}},"children":[{"type":"text","value":"One way to check the answer is to compute a quantity known as the ","position":{"start":{"line":378,"column":1},"end":{"line":378,"column":1}},"key":"Px3ATApwTD"},{"type":"strong","position":{"start":{"line":378,"column":1},"end":{"line":378,"column":1}},"children":[{"type":"text","value":"residual","position":{"start":{"line":378,"column":1},"end":{"line":378,"column":1}},"key":"iQHeWPoCsH"}],"key":"nhoXzW2dmn"},{"type":"text","value":". It is (ideally) close to machine precision (relative to the elements in the data).","position":{"start":{"line":378,"column":1},"end":{"line":378,"column":1}},"key":"Y2ORYuLNfp"}],"indexEntries":[{"entry":"residual","emphasis":false}],"label":"index-WDqXVdLN4A","identifier":"index-wdqxvdln4a","html_id":"index-wdqxvdln4a","key":"R5zwIGbOQg"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"residual = b - A*x","key":"tZpcxYMJCW"},{"type":"output","id":"w72ASdSEThDgb3L6rcs2Y","data":[{"output_type":"stream","name":"stderr","text":"Error using *\nIncorrect dimensions for matrix multiplication. Check that the number of columns in the first matrix matches the number of rows in the second matrix. To operate on each element of the matrix individually, use TIMES (.*) for elementwise multiplication."}],"key":"EoiPGrexiY"}],"key":"j0ruEZLeeq"},{"type":"paragraph","position":{"start":{"line":384,"column":1},"end":{"line":384,"column":1}},"children":[{"type":"text","value":"If the matrix ","position":{"start":{"line":384,"column":1},"end":{"line":384,"column":1}},"key":"HlrniJVBYA"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":384,"column":1},"end":{"line":384,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"bnAcJi2pR0"},{"type":"text","value":" is singular, you may get a warning and nonsense result.","position":{"start":{"line":384,"column":1},"end":{"line":384,"column":1}},"key":"STh9FEwtQT"}],"key":"BL0zO9H9Z1"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"A = [0 1; 0 0]\nb = [1; -1]\nx = A \\ b","visibility":"show","key":"VVxkyeT20e"},{"type":"output","id":"UqSngvjD6UYv1BfYvp5Mh","data":[{"output_type":"execute_result","execution_count":39,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>A = 2×2 double\n     0     1\n     0     0\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"A = 2×2 double\n     0     1\n     0     0\n","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":39,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>b = 2×1 double\n     1\n    -1\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"b = 2×1 double\n     1\n    -1\n","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":39,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>x = 2×1 double\n   Inf\n  -Inf\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"x = 2×1 double\n   Inf\n  -Inf\n","content_type":"text/plain"}}}],"visibility":"show","key":"iveIZFsbqz"}],"data":{"tags":["raises-exception"]},"visibility":"show","key":"qAxqvUjtih"},{"type":"paragraph","position":{"start":{"line":393,"column":1},"end":{"line":393,"column":1}},"children":[{"type":"text","value":"In this case, we can check that the rank of ","position":{"start":{"line":393,"column":1},"end":{"line":393,"column":1}},"key":"HhQdcHcKTv"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":393,"column":1},"end":{"line":393,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"bCLEykDv8k"},{"type":"text","value":" is less than its number of columns, indicating singularity.","position":{"start":{"line":393,"column":1},"end":{"line":393,"column":1}},"key":"vnuk0FDHlA"}],"key":"mrH05QRwBH"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"GiZSSTZ1mD"}],"key":"MaamCIrpXK"},{"type":"paragraph","position":{"start":{"line":396,"column":1},"end":{"line":396,"column":1}},"children":[{"type":"text","value":"The function ","position":{"start":{"line":396,"column":1},"end":{"line":396,"column":1}},"key":"RTGlDdunjD"},{"type":"inlineCode","value":"rank","position":{"start":{"line":396,"column":1},"end":{"line":396,"column":1}},"key":"FLnjlFeTKS"},{"type":"text","value":" computes the rank of a matrix. However, it is numerically unstable for matrices that are nearly singular, in a sense to be defined in a later section.","position":{"start":{"line":396,"column":1},"end":{"line":396,"column":1}},"key":"p5RK2FB9DX"}],"key":"AarJJGEEwN"}],"class":"dropdown","key":"hLZtfQhjTM"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"rank(A)","key":"GUW77mZz7P"},{"type":"output","id":"6E5apsMJ_jj7c1t9B6nIs","data":[{"output_type":"execute_result","execution_count":40,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = \n     1\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = \n     1\n","content_type":"text/plain"}}}],"key":"yELbIJNLr5"}],"key":"f1G0CzcpwW"},{"type":"paragraph","position":{"start":{"line":403,"column":1},"end":{"line":403,"column":1}},"children":[{"type":"text","value":"A linear system with a singular matrix might have no solution or infinitely many solutions, but in either case, backslash will fail. Moreover, detecting singularity is a lot like checking whether two floating-point numbers are ","position":{"start":{"line":403,"column":1},"end":{"line":403,"column":1}},"key":"Ctzm7aukI4"},{"type":"emphasis","position":{"start":{"line":403,"column":1},"end":{"line":403,"column":1}},"children":[{"type":"text","value":"exactly","position":{"start":{"line":403,"column":1},"end":{"line":403,"column":1}},"key":"K45FN7UL1S"}],"key":"ui9RK93lOZ"},{"type":"text","value":" equal: because of roundoff, it could be missed. In ","position":{"start":{"line":403,"column":1},"end":{"line":403,"column":1}},"key":"cTfs0RVfOn"},{"type":"link","kind":"numref","identifier":"section-linsys-condition-number","label":"section-linsys-condition-number","url":"/condition-number","internal":true,"dataUrl":"/condition-number.json","children":[{"type":"text","value":"Conditioning of linear systems","key":"qOZ6jbHoW8"}],"key":"Ikl86Pw9g6"},{"type":"text","value":" we’ll find a robust way to fully describe this situation.","position":{"start":{"line":403,"column":1},"end":{"line":403,"column":1}},"key":"pEvf0prxOC"}],"key":"CYE9Guv9EA"}],"label":"demo-systems-backslash-matlab","identifier":"demo-systems-backslash-matlab","html_id":"demo-systems-backslash-matlab","key":"AN6VLFpK1Q"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-systems-triangular","label":"demo-systems-triangular","kind":"proof:example","position":{"start":{"line":407,"column":1},"end":{"line":407,"column":25}},"children":[{"type":"text","value":"Example ","key":"UG2tPb5Xcq"},{"type":"text","value":"2.3.3","key":"DBkaa2Jdjv"}],"template":"Example %s","enumerator":"2.3.3","resolved":true,"html_id":"demo-systems-triangular","remote":true,"url":"/linear-systems","dataUrl":"/linear-systems.json","key":"rfPOj6lQBm"}],"key":"CsNryFZckG"},{"type":"paragraph","position":{"start":{"line":412,"column":1},"end":{"line":412,"column":1}},"children":[{"type":"text","value":"It’s easy to get just the lower triangular part of any matrix using the ","position":{"start":{"line":412,"column":1},"end":{"line":412,"column":1}},"key":"JiXBGui0xI"},{"type":"inlineCode","value":"tril","position":{"start":{"line":412,"column":1},"end":{"line":412,"column":1}},"key":"OMnTbZ9Mne"},{"type":"text","value":" function.","position":{"start":{"line":412,"column":1},"end":{"line":412,"column":1}},"key":"WJaoRo3wLI"}],"indexEntries":[{"entry":"MATLAB","subEntry":{"value":"tril","kind":"entry"},"emphasis":true},{"entry":"MATLAB","subEntry":{"value":"triu","kind":"entry"},"emphasis":true}],"label":"index-MbwBluE3kM","identifier":"index-mbwblue3km","html_id":"index-mbwblue3km","key":"oI3gkugSfs"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"pMxIqkMng7"}],"key":"nivRgONBsg"},{"type":"paragraph","position":{"start":{"line":415,"column":1},"end":{"line":415,"column":1}},"children":[{"type":"text","value":"Use ","position":{"start":{"line":415,"column":1},"end":{"line":415,"column":1}},"key":"BMxuf503e8"},{"type":"inlineCode","value":"tril","position":{"start":{"line":415,"column":1},"end":{"line":415,"column":1}},"key":"FtNMen8ihY"},{"type":"text","value":" to return a matrix that zeros out everything above the main diagonal. The ","position":{"start":{"line":415,"column":1},"end":{"line":415,"column":1}},"key":"cZZrlPV3k0"},{"type":"inlineCode","value":"triu","position":{"start":{"line":415,"column":1},"end":{"line":415,"column":1}},"key":"HBqG4LioQQ"},{"type":"text","value":" function zeros out below the diagonal.","position":{"start":{"line":415,"column":1},"end":{"line":415,"column":1}},"key":"exdpWlRsV5"}],"key":"uZ9bgbF3Yl"}],"class":"dropdown","key":"IPaj84Kvsn"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A = randi(9, 5, 5);\nL = tril(A)","key":"vdYXqlUm4U"},{"type":"output","id":"BEp03mjjQIsoAyaDH5WG0","data":[{"output_type":"execute_result","execution_count":41,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>L = 5×5 double\n     7     0     0     0     0\n     8     8     0     0     0\n     9     5     6     0     0\n     6     7     2     1     0\n     5     2     6     6     7\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"L = 5×5 double\n     7     0     0     0     0\n     8     8     0     0     0\n     9     5     6     0     0\n     6     7     2     1     0\n     5     2     6     6     7\n","content_type":"text/plain"}}}],"key":"MynxY7Rs1O"}],"key":"oKsDTZdF7j"},{"type":"paragraph","position":{"start":{"line":423,"column":1},"end":{"line":423,"column":1}},"children":[{"type":"text","value":"We’ll set up and solve a linear system with this matrix.","position":{"start":{"line":423,"column":1},"end":{"line":423,"column":1}},"key":"il6IgqVvYt"}],"key":"HvS9hIImq1"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"b = ones(5);\nx = forwardsub(L, b)","key":"Z4527ISTZ8"},{"type":"output","id":"ymlEzHpytIPCG-vVT0jFo","data":[{"output_type":"execute_result","execution_count":42,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>x = 5×1 double\n   1.4286e-01\n  -1.7857e-02\n  -3.2738e-02\n   3.3333e-01\n  -2.1173e-01\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"x = 5×1 double\n   1.4286e-01\n  -1.7857e-02\n  -3.2738e-02\n   3.3333e-01\n  -2.1173e-01\n","content_type":"text/plain"}}}],"key":"fnh6OEI2dR"}],"key":"UGhdIjmrde"},{"type":"paragraph","position":{"start":{"line":433,"column":1},"end":{"line":433,"column":1}},"children":[{"type":"text","value":"It’s not clear how accurate this answer is. However, the residual should be zero or comparable to ","position":{"start":{"line":433,"column":1},"end":{"line":433,"column":1}},"key":"oUPjhzHnjx"},{"type":"inlineMath","value":"\\macheps","position":{"start":{"line":433,"column":1},"end":{"line":433,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>ϵ</mi><mtext>mach</mtext></msub></mrow><annotation encoding=\"application/x-tex\">\\macheps</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">ϵ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">mach</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"HU6vRXp5QH"},{"type":"text","value":".","position":{"start":{"line":433,"column":1},"end":{"line":433,"column":1}},"key":"nmKHf8GRIg"}],"indexEntries":[{"entry":"residual","emphasis":false}],"label":"index-gLNalCEWGZ","identifier":"index-glnalcewgz","html_id":"index-glnalcewgz","key":"CscXS5OhRG"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"b - L * x","key":"S1dpCORSBE"},{"type":"output","id":"4sbww6UMHDv9BUurLV_pM","data":[{"output_type":"stream","name":"stderr","text":"Error using *\nIncorrect dimensions for matrix multiplication. Check that the number of columns in the first matrix matches the number of rows in the second matrix. To operate on each element of the matrix individually, use TIMES (.*) for elementwise multiplication."}],"key":"kHES3exSqF"}],"key":"WO96TIRXx8"},{"type":"paragraph","position":{"start":{"line":442,"column":1},"end":{"line":442,"column":1}},"children":[{"type":"text","value":"Next, we’ll engineer a problem to which we know the exact answer.","position":{"start":{"line":442,"column":1},"end":{"line":442,"column":1}},"key":"Lx95448eDh"}],"indexEntries":[{"entry":"MATLAB","subEntry":{"value":"diag","kind":"entry"},"emphasis":true},{"entry":"MATLAB","subEntry":{"value":"eye","kind":"entry"},"emphasis":true}],"label":"index-WJ7tLUKpbz","identifier":"index-wj7tlukpbz","html_id":"index-wj7tlukpbz","key":"a9Wn6rwpEv"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"omBm7sy0PW"}],"key":"wNBhQEHvd2"},{"type":"paragraph","position":{"start":{"line":445,"column":1},"end":{"line":445,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":445,"column":1},"end":{"line":445,"column":1}},"key":"tVwARxXnVI"},{"type":"inlineCode","value":"eye","position":{"start":{"line":445,"column":1},"end":{"line":445,"column":1}},"key":"VOi0fxFhYK"},{"type":"text","value":" function creates an identity matrix. The ","position":{"start":{"line":445,"column":1},"end":{"line":445,"column":1}},"key":"PtZSvzPJjN"},{"type":"inlineCode","value":"diag","position":{"start":{"line":445,"column":1},"end":{"line":445,"column":1}},"key":"mHm1eMNq8e"},{"type":"text","value":" function uses 0 as the main diagonal, positive integers as superdiagonals, and negative integers as subdiagonals.","position":{"start":{"line":445,"column":1},"end":{"line":445,"column":1}},"key":"PNduaNl1e2"}],"key":"k5YtW9QvHG"}],"class":"dropdown","key":"jhgQBCEpKQ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"alpha = 0.3;\nbeta = 2.2;\nU = eye(5) + diag([-1 -1 -1 -1], 1);\nU(1, [4, 5]) = [alpha - beta, beta]","key":"yxzsNVXzYD"},{"type":"output","id":"lztjFFmzY__78cTOVnLeo","data":[{"output_type":"execute_result","execution_count":44,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>U = 5×5 double\n   1.0000e+00  -1.0000e+00            0  -1.9000e+00   2.2000e+00\n            0   1.0000e+00  -1.0000e+00            0            0\n            0            0   1.0000e+00  -1.0000e+00            0\n            0            0            0   1.0000e+00  -1.0000e+00\n            0            0            0            0   1.0000e+00\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"U = 5×5 double\n   1.0000e+00  -1.0000e+00            0  -1.9000e+00   2.2000e+00\n            0   1.0000e+00  -1.0000e+00            0            0\n            0            0   1.0000e+00  -1.0000e+00            0\n            0            0            0   1.0000e+00  -1.0000e+00\n            0            0            0            0   1.0000e+00\n","content_type":"text/plain"}}}],"key":"Z5DLMQsHrF"}],"key":"AuzVQvnV07"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"x_exact = ones(5);\nb = [alpha; 0; 0; 0; 1];","key":"p2iIG8DyMc"},{"type":"output","id":"Rh53v__G1FVYJb5w3XkGM","data":[],"key":"AAN5HPtn7X"}],"key":"vQ2DXykope"},{"type":"paragraph","position":{"start":{"line":460,"column":1},"end":{"line":460,"column":1}},"children":[{"type":"text","value":"Now we use backward substitution to solve for ","position":{"start":{"line":460,"column":1},"end":{"line":460,"column":1}},"key":"W4xVuGfJ0l"},{"type":"inlineMath","value":"\\mathbf{x}","position":{"start":{"line":460,"column":1},"end":{"line":460,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">x</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{x}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4444em;\"></span><span class=\"mord mathbf\">x</span></span></span></span>","key":"Bylno6Bb20"},{"type":"text","value":", and compare to the exact solution we know already.","position":{"start":{"line":460,"column":1},"end":{"line":460,"column":1}},"key":"BplPujDzLW"}],"key":"m3JU5uXysA"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"x = backsub(U, b);\nerr = x - x_exact","key":"iqE7K8KU4K"},{"type":"output","id":"iyed3wzpc6jiGvKuqkkdc","data":[{"output_type":"execute_result","execution_count":46,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>err = 5×5 double\n     0     0     0     0     0\n     0     0     0     0     0\n     0     0     0     0     0\n     0     0     0     0     0\n     0     0     0     0     0\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"err = 5×5 double\n     0     0     0     0     0\n     0     0     0     0     0\n     0     0     0     0     0\n     0     0     0     0     0\n     0     0     0     0     0\n","content_type":"text/plain"}}}],"key":"THM49qSMO9"}],"key":"QosUwp3Kho"},{"type":"paragraph","position":{"start":{"line":467,"column":1},"end":{"line":467,"column":1}},"children":[{"type":"text","value":"Everything seems OK here. But another example, with a different value for ","position":{"start":{"line":467,"column":1},"end":{"line":467,"column":1}},"key":"mNmna5M0ha"},{"type":"text","value":"β","position":{"start":{"line":467,"column":1},"end":{"line":467,"column":1}},"key":"f6rRKRDzVf"},{"type":"text","value":", is more troubling.","position":{"start":{"line":467,"column":1},"end":{"line":467,"column":1}},"key":"dJB1lIky5v"}],"key":"uWmAzDF07J"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"alpha = 0.3;\nbeta = 1e12;\nU = eye(5) + diag([-1 -1 -1 -1], 1);\nU(1, [4, 5]) = [alpha - beta, beta];\nb = [alpha; 0; 0; 0; 1];\n\nx = backsub(U, b);\nerr = x - x_exact","key":"Vkr7133eVO"},{"type":"output","id":"c3rN0SjgBR3spvOSYfHDV","data":[{"output_type":"execute_result","execution_count":47,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>err = 5×5 double\n1.0e-04 *\n\n  -0.488281249999556  -0.488281249999556  -0.488281249999556  -0.488281249999556  -0.488281249999556\n                   0                   0                   0                   0                   0\n                   0                   0                   0                   0                   0\n                   0                   0                   0                   0                   0\n                   0                   0                   0                   0                   0\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"err = 5×5 double\n1.0e-04 *\n\n  -0.488281249999556  -0.488281249999556  -0.488281249999556  -0.488281249999556  -0.488281249999556\n                   0                   0                   0                   0                   0\n                   0                   0                   0                   0                   0\n                   0                   0                   0                   0                   0\n                   0                   0                   0                   0                   0\n","content_type":"text/plain"}}}],"key":"d33agWecUd"}],"key":"cIbIhkN7zm"},{"type":"paragraph","position":{"start":{"line":480,"column":1},"end":{"line":480,"column":1}},"children":[{"type":"text","value":"It’s not so good to get 4 digits of accuracy after starting with sixteen! The source of the error is not hard to track down. Solving for ","position":{"start":{"line":480,"column":1},"end":{"line":480,"column":1}},"key":"oJdAvf3ipO"},{"type":"inlineMath","value":"x_1","position":{"start":{"line":480,"column":1},"end":{"line":480,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">x_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"ujg8w9R7wh"},{"type":"text","value":" performs ","position":{"start":{"line":480,"column":1},"end":{"line":480,"column":1}},"key":"DAI019jDly"},{"type":"inlineMath","value":"(\\alpha-\\beta)+\\beta","position":{"start":{"line":480,"column":1},"end":{"line":480,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>α</mi><mo>−</mo><mi>β</mi><mo stretchy=\"false\">)</mo><mo>+</mo><mi>β</mi></mrow><annotation encoding=\"application/x-tex\">(\\alpha-\\beta)+\\beta</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05278em;\">β</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05278em;\">β</span></span></span></span>","key":"CA3VMJR90F"},{"type":"text","value":" in the first row. Since ","position":{"start":{"line":480,"column":1},"end":{"line":480,"column":1}},"key":"KWm2rhDHle"},{"type":"inlineMath","value":"|\\alpha|","position":{"start":{"line":480,"column":1},"end":{"line":480,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">∣</mi><mi>α</mi><mi mathvariant=\"normal\">∣</mi></mrow><annotation encoding=\"application/x-tex\">|\\alpha|</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">∣</span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span><span class=\"mord\">∣</span></span></span></span>","key":"dM4mm5Rwmd"},{"type":"text","value":" is so much smaller than ","position":{"start":{"line":480,"column":1},"end":{"line":480,"column":1}},"key":"MDTR0jroR8"},{"type":"inlineMath","value":"|\\beta|","position":{"start":{"line":480,"column":1},"end":{"line":480,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">∣</mi><mi>β</mi><mi mathvariant=\"normal\">∣</mi></mrow><annotation encoding=\"application/x-tex\">|\\beta|</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">∣</span><span class=\"mord mathnormal\" style=\"margin-right:0.05278em;\">β</span><span class=\"mord\">∣</span></span></span></span>","key":"X2WvqeLzm2"},{"type":"text","value":", this a recipe for losing digits to subtractive cancellation.","position":{"start":{"line":480,"column":1},"end":{"line":480,"column":1}},"key":"B8WZ3sdhJO"}],"key":"pV3PSDjeWI"}],"label":"demo-systems-triangular-matlab","identifier":"demo-systems-triangular-matlab","html_id":"demo-systems-triangular-matlab","key":"byXnDuoWia"},{"type":"heading","depth":3,"position":{"start":{"line":482,"column":1},"end":{"line":482,"column":1}},"children":[{"type":"text","value":"2.4 ","position":{"start":{"line":482,"column":1},"end":{"line":482,"column":1}},"key":"C1njkqmXQd"},{"type":"link","identifier":"section-linsys-lu","label":"section-linsys-lu","kind":"narrative","position":{"start":{"line":482,"column":5},"end":{"line":482,"column":23}},"url":"/lu","internal":true,"dataUrl":"/lu.json","children":[{"type":"text","value":"LU factorization","key":"spSWvRdSYJ"}],"key":"ptlUOBNp1h"}],"identifier":"id-2-4","label":"2.4 ","html_id":"id-2-4","implicit":true,"key":"g7uTq8RfP3"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-lu-outertri","label":"demo-lu-outertri","kind":"proof:example","position":{"start":{"line":484,"column":1},"end":{"line":484,"column":18}},"children":[{"type":"text","value":"Example ","key":"bBXusOmia7"},{"type":"text","value":"2.4.2","key":"wdqRun55Z1"}],"template":"Example %s","enumerator":"2.4.2","resolved":true,"html_id":"demo-lu-outertri","remote":true,"url":"/lu","dataUrl":"/lu.json","key":"vMK7Gs2b62"}],"key":"eAXFnSIE9S"},{"type":"paragraph","position":{"start":{"line":489,"column":1},"end":{"line":489,"column":1}},"children":[{"type":"text","value":"We explore the outer product formula for two random triangular matrices.","position":{"start":{"line":489,"column":1},"end":{"line":489,"column":1}},"key":"naOgtmum9Z"}],"indexEntries":[{"entry":"MATLAB","subEntry":{"value":"tril","kind":"entry"},"emphasis":false},{"entry":"MATLAB","subEntry":{"value":"triu","kind":"entry"},"emphasis":false}],"label":"index-fQOKEZtbAC","identifier":"index-fqokeztbac","html_id":"index-fqokeztbac","key":"d9QVM62RVa"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"L = tril( randi(9, 3, 3) )","key":"Rqra4wfs67"},{"type":"output","id":"LpBuatUMzrJaY_s8rPkMb","data":[{"output_type":"execute_result","execution_count":48,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>L = 3×3 double\n     5     0     0\n     4     8     0\n     5     6     5\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"L = 3×3 double\n     5     0     0\n     4     8     0\n     5     6     5\n","content_type":"text/plain"}}}],"key":"RMiNFrrCxx"}],"key":"f2RzSq43fX"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"U = triu( randi(9, 3, 3) )","key":"dXwBYWGskR"},{"type":"output","id":"kJ_7TsNQBNUF-eNNKmBC8","data":[{"output_type":"execute_result","execution_count":49,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>U = 3×3 double\n     6     2     2\n     0     9     7\n     0     0     3\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"U = 3×3 double\n     6     2     2\n     0     9     7\n     0     0     3\n","content_type":"text/plain"}}}],"key":"J5jdYMfE4h"}],"key":"P3hb9vjPks"},{"type":"paragraph","position":{"start":{"line":499,"column":1},"end":{"line":499,"column":1}},"children":[{"type":"text","value":"Here are the three outer products in the sum in ","position":{"start":{"line":499,"column":1},"end":{"line":499,"column":1}},"key":"rlxkSay2sv"},{"type":"crossReference","kind":"equation","identifier":"matrixouter","label":"matrixouter","children":[{"type":"text","value":"(","key":"QfeBsT0S2r"},{"type":"text","value":"2.4.4","key":"U7ZyRxxdvl"},{"type":"text","value":")","key":"Tncb46nHA3"}],"template":"(%s)","enumerator":"2.4.4","resolved":true,"html_id":"matrixouter","remote":true,"url":"/lu","dataUrl":"/lu.json","key":"HqWf1fs0gH"},{"type":"text","value":":","position":{"start":{"line":499,"column":1},"end":{"line":499,"column":1}},"key":"XetNUXI6hb"}],"key":"By58rktSKq"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"L(:, 1) * U(1, :)","key":"HAYKmLrNQ0"},{"type":"output","id":"ZYMd-orTVQtwnB58Eq6Gr","data":[{"output_type":"execute_result","execution_count":50,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = 3×3 double\n    30    10    10\n    24     8     8\n    30    10    10\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = 3×3 double\n    30    10    10\n    24     8     8\n    30    10    10\n","content_type":"text/plain"}}}],"key":"aHH7if0hnV"}],"key":"GK9e5xcGTb"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"L(:, 2) * U(2, :)","key":"SjAqMacHJL"},{"type":"output","id":"N3D99etV4Eszsvhw7b0ti","data":[{"output_type":"execute_result","execution_count":51,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = 3×3 double\n     0     0     0\n     0    72    56\n     0    54    42\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = 3×3 double\n     0     0     0\n     0    72    56\n     0    54    42\n","content_type":"text/plain"}}}],"key":"IYldYJf4qJ"}],"key":"VkGGUULSDx"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"L(:, 3) * U(3, :)","key":"kfJ2eQW3NV"},{"type":"output","id":"bpXqvbAeKxrnnpda_m6me","data":[{"output_type":"execute_result","execution_count":52,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = 3×3 double\n     0     0     0\n     0     0     0\n     0     0    15\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = 3×3 double\n     0     0     0\n     0     0     0\n     0     0    15\n","content_type":"text/plain"}}}],"key":"xinUg6zGT7"}],"key":"sBGczSwpEr"},{"type":"paragraph","position":{"start":{"line":513,"column":1},"end":{"line":513,"column":1}},"children":[{"type":"text","value":"Simply because of the triangular zero structures, only the first outer product contributes to the first row and first column of the entire product.","position":{"start":{"line":513,"column":1},"end":{"line":513,"column":1}},"key":"Nk5pu6nYE1"}],"key":"DrSNWEKWnv"}],"label":"demo-lu-outertri-matlab","identifier":"demo-lu-outertri-matlab","html_id":"demo-lu-outertri-matlab","key":"uuU9U6Urc5"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-lu-derive","label":"demo-lu-derive","kind":"proof:example","position":{"start":{"line":517,"column":1},"end":{"line":517,"column":16}},"children":[{"type":"text","value":"Example ","key":"wr5VlXkL76"},{"type":"text","value":"2.4.3","key":"RRsBnq7H0e"}],"template":"Example %s","enumerator":"2.4.3","resolved":true,"html_id":"demo-lu-derive","remote":true,"url":"/lu","dataUrl":"/lu.json","key":"nWsmUXbYfz"}],"key":"sl6LQ2UZiB"},{"type":"paragraph","position":{"start":{"line":519,"column":1},"end":{"line":519,"column":1}},"children":[{"type":"text","value":"For illustration, we work on a ","position":{"start":{"line":519,"column":1},"end":{"line":519,"column":1}},"key":"MlwMJlKNQl"},{"type":"inlineMath","value":"4 \\times 4","position":{"start":{"line":519,"column":1},"end":{"line":519,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>4</mn><mo>×</mo><mn>4</mn></mrow><annotation encoding=\"application/x-tex\">4 \\times 4</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">4</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">4</span></span></span></span>","key":"cRNISpb9pS"},{"type":"text","value":" matrix. We name it with a subscript in preparation for what comes.","position":{"start":{"line":519,"column":1},"end":{"line":519,"column":1}},"key":"Cc5Mi2CJH3"}],"key":"bjhNS0Y67n"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A_1 = [\n     2    0    4     3 \n    -4    5   -7   -10 \n     1   15    2   -4.5\n    -2    0    2   -13\n    ];\nL = eye(4);\nU = zeros(4, 4);","key":"BwkJ5XxIaw"},{"type":"output","id":"-gaJkOJhwF3mARTOR0X2S","data":[],"key":"idq9yux7dq"}],"key":"YYxuDqFePA"},{"type":"paragraph","position":{"start":{"line":532,"column":1},"end":{"line":532,"column":1}},"children":[{"type":"text","value":"Now we appeal to ","position":{"start":{"line":532,"column":1},"end":{"line":532,"column":1}},"key":"cBjEP980pI"},{"type":"crossReference","kind":"equation","identifier":"outer-row1","label":"outer-row1","children":[{"type":"text","value":"(","key":"fOCXlrjoti"},{"type":"text","value":"2.4.5","key":"vIHNH3qzee"},{"type":"text","value":")","key":"QFcCcqQ1NU"}],"template":"(%s)","enumerator":"2.4.5","resolved":true,"html_id":"outer-row1","remote":true,"url":"/lu","dataUrl":"/lu.json","key":"mUNBPoWWbA"},{"type":"text","value":". Since ","position":{"start":{"line":532,"column":1},"end":{"line":532,"column":1}},"key":"b13oS4e48S"},{"type":"inlineMath","value":"L_{11}=1","position":{"start":{"line":532,"column":1},"end":{"line":532,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>L</mi><mn>11</mn></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">L_{11}=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">L</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">11</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"AutCcCONhD"},{"type":"text","value":", we see that the first row of ","position":{"start":{"line":532,"column":1},"end":{"line":532,"column":1}},"key":"HOkfkhk6R9"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":532,"column":1},"end":{"line":532,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"CDGetSYJ8K"},{"type":"text","value":" is just the first row of ","position":{"start":{"line":532,"column":1},"end":{"line":532,"column":1}},"key":"MaPnbhshZC"},{"type":"inlineMath","value":"\\mathbf{A}_1","position":{"start":{"line":532,"column":1},"end":{"line":532,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">A</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8361em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"VTVuFVMxu5"},{"type":"text","value":".","position":{"start":{"line":532,"column":1},"end":{"line":532,"column":1}},"key":"MDryfdNQUn"}],"key":"B8d8iszBLZ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"U(1, :) = A_1(1, :)","key":"RxtyLo7NZo"},{"type":"output","id":"LAfU1_2evjh31ZASUDLb5","data":[{"output_type":"execute_result","execution_count":54,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>U = 4×4 double\n     2     0     4     3\n     0     0     0     0\n     0     0     0     0\n     0     0     0     0\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"U = 4×4 double\n     2     0     4     3\n     0     0     0     0\n     0     0     0     0\n     0     0     0     0\n","content_type":"text/plain"}}}],"key":"G4A9z0gUQy"}],"key":"DEmY0WBDnj"},{"type":"paragraph","position":{"start":{"line":538,"column":1},"end":{"line":538,"column":1}},"children":[{"type":"text","value":"From ","position":{"start":{"line":538,"column":1},"end":{"line":538,"column":1}},"key":"i6RghviJip"},{"type":"crossReference","kind":"equation","identifier":"outer-col1","label":"outer-col1","children":[{"type":"text","value":"(","key":"tqk0TBG8w7"},{"type":"text","value":"2.4.6","key":"aZXMqe2kKD"},{"type":"text","value":")","key":"cgGVf7AGjd"}],"template":"(%s)","enumerator":"2.4.6","resolved":true,"html_id":"outer-col1","remote":true,"url":"/lu","dataUrl":"/lu.json","key":"SBBZhsZcxy"},{"type":"text","value":", we see that we can find the first column of ","position":{"start":{"line":538,"column":1},"end":{"line":538,"column":1}},"key":"HYFn4agym0"},{"type":"inlineMath","value":"\\mathbf{L}","position":{"start":{"line":538,"column":1},"end":{"line":538,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">L</span></span></span></span>","key":"slEU6ukPlW"},{"type":"text","value":" from the first column of ","position":{"start":{"line":538,"column":1},"end":{"line":538,"column":1}},"key":"pCTZMmI5SI"},{"type":"inlineMath","value":"\\mathbf{A}_1","position":{"start":{"line":538,"column":1},"end":{"line":538,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">A</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8361em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"cqRv2351eR"},{"type":"text","value":".","position":{"start":{"line":538,"column":1},"end":{"line":538,"column":1}},"key":"GnErCAZ4za"}],"key":"j3yiZPP9aO"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"L(:, 1) = A_1(:, 1) / U(1, 1)","key":"DHD6VoQgbZ"},{"type":"output","id":"y0mE17EMOVroG32E4eiDM","data":[{"output_type":"execute_result","execution_count":55,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>L = 4×4 double\n   1.000000000000000                   0                   0                   0\n  -2.000000000000000   1.000000000000000                   0                   0\n   0.500000000000000                   0   1.000000000000000                   0\n  -1.000000000000000                   0                   0   1.000000000000000\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"L = 4×4 double\n   1.000000000000000                   0                   0                   0\n  -2.000000000000000   1.000000000000000                   0                   0\n   0.500000000000000                   0   1.000000000000000                   0\n  -1.000000000000000                   0                   0   1.000000000000000\n","content_type":"text/plain"}}}],"key":"UQTjfT9qIL"}],"key":"EzxZsGHdZY"},{"type":"paragraph","position":{"start":{"line":544,"column":1},"end":{"line":544,"column":1}},"children":[{"type":"text","value":"We have obtained the first term in the sum ","position":{"start":{"line":544,"column":1},"end":{"line":544,"column":1}},"key":"ZaN7ZRJ1iO"},{"type":"crossReference","kind":"equation","identifier":"matrixouter","label":"matrixouter","children":[{"type":"text","value":"(","key":"qfO7sMRHYm"},{"type":"text","value":"2.4.4","key":"fp6UN1L9qC"},{"type":"text","value":")","key":"lyssNctFA1"}],"template":"(%s)","enumerator":"2.4.4","resolved":true,"html_id":"matrixouter","remote":true,"url":"/lu","dataUrl":"/lu.json","key":"IcAX6n20WN"},{"type":"text","value":" for ","position":{"start":{"line":544,"column":1},"end":{"line":544,"column":1}},"key":"PXzHQoguIi"},{"type":"inlineMath","value":"\\mathbf{L}\\mathbf{U}","position":{"start":{"line":544,"column":1},"end":{"line":544,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">LU</span></span></span></span>","key":"sgYKeacHrY"},{"type":"text","value":", and we subtract it away from ","position":{"start":{"line":544,"column":1},"end":{"line":544,"column":1}},"key":"u1HSGpFytA"},{"type":"inlineMath","value":"\\mathbf{A}_1","position":{"start":{"line":544,"column":1},"end":{"line":544,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">A</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8361em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"s04Ek8tUoM"},{"type":"text","value":".","position":{"start":{"line":544,"column":1},"end":{"line":544,"column":1}},"key":"sSBAfzoH3a"}],"key":"KXNp7h6QZz"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A_2 = A_1 - L(:, 1) * U(1, :)","key":"C63LrXkwIG"},{"type":"output","id":"IWKMe5OkyXZubn7-V7obg","data":[{"output_type":"execute_result","execution_count":56,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>A_2 = 4×4 double\n     0     0     0     0\n     0     5     1    -4\n     0    15     0    -6\n     0     0     6   -10\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"A_2 = 4×4 double\n     0     0     0     0\n     0     5     1    -4\n     0    15     0    -6\n     0     0     6   -10\n","content_type":"text/plain"}}}],"key":"FqvU5JJDho"}],"key":"FfdHJKMMrU"},{"type":"paragraph","position":{"start":{"line":550,"column":1},"end":{"line":550,"column":1}},"children":[{"type":"text","value":"Now ","position":{"start":{"line":550,"column":1},"end":{"line":550,"column":1}},"key":"Yocy6vhOoS"},{"type":"inlineMath","value":"\\mathbf{A}_2 = \\boldsymbol{\\ell}_2\\mathbf{u}_2^T + \\boldsymbol{\\ell}_3\\mathbf{u}_3^T + \\boldsymbol{\\ell}_4\\mathbf{u}_4^T.","position":{"start":{"line":550,"column":1},"end":{"line":550,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">A</mi><mn>2</mn></msub><mo>=</mo><msub><mi mathvariant=\"bold\">ℓ</mi><mn>2</mn></msub><msubsup><mi mathvariant=\"bold\">u</mi><mn>2</mn><mi>T</mi></msubsup><mo>+</mo><msub><mi mathvariant=\"bold\">ℓ</mi><mn>3</mn></msub><msubsup><mi mathvariant=\"bold\">u</mi><mn>3</mn><mi>T</mi></msubsup><mo>+</mo><msub><mi mathvariant=\"bold\">ℓ</mi><mn>4</mn></msub><msubsup><mi mathvariant=\"bold\">u</mi><mn>4</mn><mi>T</mi></msubsup><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}_2 = \\boldsymbol{\\ell}_2\\mathbf{u}_2^T + \\boldsymbol{\\ell}_3\\mathbf{u}_3^T + \\boldsymbol{\\ell}_4\\mathbf{u}_4^T.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8361em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0894em;vertical-align:-0.2481em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">ℓ</span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathbf\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-2.4519em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2481em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0894em;vertical-align:-0.2481em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">ℓ</span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathbf\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-2.4519em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2481em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0894em;vertical-align:-0.2481em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">ℓ</span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">4</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathbf\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-2.4519em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">4</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2481em;\"><span></span></span></span></span></span></span><span class=\"mord\">.</span></span></span></span>","key":"vOXChPdI3k"},{"type":"text","value":" If we ignore the first row and first column of the matrices in this equation, then in what remains we are in the same situation as at the start. Specifically, only ","position":{"start":{"line":550,"column":1},"end":{"line":550,"column":1}},"key":"xmgqLjj9lt"},{"type":"inlineMath","value":"\\boldsymbol{\\ell}_2\\mathbf{u}_2^T","position":{"start":{"line":550,"column":1},"end":{"line":550,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">ℓ</mi><mn>2</mn></msub><msubsup><mi mathvariant=\"bold\">u</mi><mn>2</mn><mi>T</mi></msubsup></mrow><annotation encoding=\"application/x-tex\">\\boldsymbol{\\ell}_2\\mathbf{u}_2^T</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0894em;vertical-align:-0.2481em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">ℓ</span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathbf\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-2.4519em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2481em;\"><span></span></span></span></span></span></span></span></span></span>","key":"GjGivkwL6z"},{"type":"text","value":" has any effect on the second row and column, so we can deduce them now.","position":{"start":{"line":550,"column":1},"end":{"line":550,"column":1}},"key":"CNZXlJ37dP"}],"key":"yPtgnwKlgN"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"U(2, :) = A_2(2, :)\nL(:, 2) = A_2(:, 2) / U(2, 2)","key":"QzFJN4rh2t"},{"type":"output","id":"7h-Uw5l0v4L4X5UlFWfSV","data":[{"output_type":"execute_result","execution_count":57,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>U = 4×4 double\n     2     0     4     3\n     0     5     1    -4\n     0     0     0     0\n     0     0     0     0\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"U = 4×4 double\n     2     0     4     3\n     0     5     1    -4\n     0     0     0     0\n     0     0     0     0\n","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":57,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>L = 4×4 double\n   1.0000e+00            0            0            0\n  -2.0000e+00   1.0000e+00            0            0\n   5.0000e-01   3.0000e+00   1.0000e+00            0\n  -1.0000e+00            0            0   1.0000e+00\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"L = 4×4 double\n   1.0000e+00            0            0            0\n  -2.0000e+00   1.0000e+00            0            0\n   5.0000e-01   3.0000e+00   1.0000e+00            0\n  -1.0000e+00            0            0   1.0000e+00\n","content_type":"text/plain"}}}],"key":"E2Rm53Xv1j"}],"key":"j6P2NqLMTQ"},{"type":"paragraph","position":{"start":{"line":557,"column":1},"end":{"line":557,"column":1}},"children":[{"type":"text","value":"If we subtract off the latest outer product, we have a matrix that is zero in the first ","position":{"start":{"line":557,"column":1},"end":{"line":557,"column":1}},"key":"S9ILZbjabx"},{"type":"emphasis","position":{"start":{"line":557,"column":1},"end":{"line":557,"column":1}},"children":[{"type":"text","value":"two","position":{"start":{"line":557,"column":1},"end":{"line":557,"column":1}},"key":"WysWTZK44n"}],"key":"irj2kBQuzJ"},{"type":"text","value":" rows and columns.","position":{"start":{"line":557,"column":1},"end":{"line":557,"column":1}},"key":"lecD4nPn9K"}],"key":"Zm1eXtNyHQ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A_3 = A_2 - L(:, 2) * U(2, :)","key":"AhCX3AAcQp"},{"type":"output","id":"WBeU3pw6QHHHICni5q0IC","data":[{"output_type":"execute_result","execution_count":58,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>A_3 = 4×4 double\n     0     0     0     0\n     0     0     0     0\n     0     0    -3     6\n     0     0     6   -10\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"A_3 = 4×4 double\n     0     0     0     0\n     0     0     0     0\n     0     0    -3     6\n     0     0     6   -10\n","content_type":"text/plain"}}}],"key":"PXZ7IblOzy"}],"key":"yArXpMHDpa"},{"type":"paragraph","position":{"start":{"line":563,"column":1},"end":{"line":563,"column":1}},"children":[{"type":"text","value":"Now we can deal with the lower right ","position":{"start":{"line":563,"column":1},"end":{"line":563,"column":1}},"key":"UdmpjrXvHz"},{"type":"inlineMath","value":"2\\times 2","position":{"start":{"line":563,"column":1},"end":{"line":563,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>2</mn><mo>×</mo><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">2\\times 2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">2</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span></span></span></span>","key":"chpTVM0881"},{"type":"text","value":" submatrix of the remainder in a similar fashion.","position":{"start":{"line":563,"column":1},"end":{"line":563,"column":1}},"key":"kdzTNdb7hh"}],"key":"svIK8AwJD2"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"U(3, :) = A_3(3, :);\nL(:, 3) = A_3(:, 3) / U(3, 3);\nA_4 = A_3 - L(:, 3) * U(3, :)","key":"bSZaJwIUPS"},{"type":"output","id":"f4W9ZP9GxwxvpaFeyIu-e","data":[{"output_type":"execute_result","execution_count":59,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>A_4 = 4×4 double\n     0     0     0     0\n     0     0     0     0\n     0     0     0     0\n     0     0     0     2\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"A_4 = 4×4 double\n     0     0     0     0\n     0     0     0     0\n     0     0     0     0\n     0     0     0     2\n","content_type":"text/plain"}}}],"key":"ByreOrveEJ"}],"key":"CXIgyTMZfy"},{"type":"paragraph","position":{"start":{"line":571,"column":1},"end":{"line":571,"column":1}},"children":[{"type":"text","value":"Finally, we pick up the last unknown in the factors.","position":{"start":{"line":571,"column":1},"end":{"line":571,"column":1}},"key":"ruL20vjxJ7"}],"key":"kJX8vpcBkr"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"U(4, 4) = A_4(4, 4);","key":"FVmkwpiGdR"},{"type":"output","id":"Sczhq35W8fuP4G_Do_uHt","data":[],"key":"vRvrsvOzwm"}],"key":"Ro7BM9qTRd"},{"type":"paragraph","position":{"start":{"line":577,"column":1},"end":{"line":577,"column":1}},"children":[{"type":"text","value":"We now have all of ","position":{"start":{"line":577,"column":1},"end":{"line":577,"column":1}},"key":"rUBlVtz7JP"},{"type":"inlineMath","value":"\\mathbf{L}","position":{"start":{"line":577,"column":1},"end":{"line":577,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">L</span></span></span></span>","key":"n9BII0lewj"},{"type":"text","value":",","position":{"start":{"line":577,"column":1},"end":{"line":577,"column":1}},"key":"K4lABJ98Xr"}],"key":"mJ0pDlzHuw"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"L","key":"EvbPGZRXdF"},{"type":"output","id":"Y4ZvcsMd_PMebt0f38Imi","data":[{"output_type":"execute_result","execution_count":61,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>L = 4×4 double\n   1.0000e+00            0            0            0\n  -2.0000e+00   1.0000e+00            0            0\n   5.0000e-01   3.0000e+00   1.0000e+00            0\n  -1.0000e+00            0  -2.0000e+00   1.0000e+00\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"L = 4×4 double\n   1.0000e+00            0            0            0\n  -2.0000e+00   1.0000e+00            0            0\n   5.0000e-01   3.0000e+00   1.0000e+00            0\n  -1.0000e+00            0  -2.0000e+00   1.0000e+00\n","content_type":"text/plain"}}}],"key":"QTQ4kmVF9r"}],"key":"IzKbZU8FNM"},{"type":"paragraph","position":{"start":{"line":583,"column":1},"end":{"line":583,"column":1}},"children":[{"type":"text","value":"and all of ","position":{"start":{"line":583,"column":1},"end":{"line":583,"column":1}},"key":"JHBrTPG3PL"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":583,"column":1},"end":{"line":583,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"JNqNviocb1"},{"type":"text","value":",","position":{"start":{"line":583,"column":1},"end":{"line":583,"column":1}},"key":"zFZnQmZGNG"}],"key":"CcsUm88kop"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"U","key":"CwdEWImtAs"},{"type":"output","id":"HVzw2790S3mgezw7ExK-P","data":[{"output_type":"execute_result","execution_count":62,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>U = 4×4 double\n     2     0     4     3\n     0     5     1    -4\n     0     0    -3     6\n     0     0     0     2\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"U = 4×4 double\n     2     0     4     3\n     0     5     1    -4\n     0     0    -3     6\n     0     0     0     2\n","content_type":"text/plain"}}}],"key":"FvcPXPCjPD"}],"key":"PfBVHg4RAK"},{"type":"paragraph","position":{"start":{"line":589,"column":1},"end":{"line":589,"column":1}},"children":[{"type":"text","value":"We can verify that we have a correct factorization of the original matrix by computing the backward error:","position":{"start":{"line":589,"column":1},"end":{"line":589,"column":1}},"key":"R92qeQdJyX"}],"key":"pzaNFzaDnu"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A_1 - L * U","key":"ixQa9txBln"},{"type":"output","id":"dz4bot-HlGWR8p2nROzwo","data":[{"output_type":"execute_result","execution_count":63,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = 4×4 double\n     0     0     0     0\n     0     0     0     0\n     0     0     0     0\n     0     0     0     0\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = 4×4 double\n     0     0     0     0\n     0     0     0     0\n     0     0     0     0\n     0     0     0     0\n","content_type":"text/plain"}}}],"key":"TltdAde61q"}],"key":"vPlywQtsdw"},{"type":"paragraph","position":{"start":{"line":595,"column":1},"end":{"line":595,"column":1}},"children":[{"type":"text","value":"In floating point, we cannot expect the difference to be exactly zero as we found in this toy example. Instead, we would be satisfied to see that each element of the difference above is comparable in size to machine precision.","position":{"start":{"line":595,"column":1},"end":{"line":595,"column":1}},"key":"WQSbNWKrTz"}],"key":"hFNbN4vYhY"}],"label":"demo-lu-derive-matlab","identifier":"demo-lu-derive-matlab","html_id":"demo-lu-derive-matlab","key":"vKlRK5OdnW"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-lu-solve","label":"demo-lu-solve","kind":"proof:example","position":{"start":{"line":600,"column":1},"end":{"line":600,"column":15}},"children":[{"type":"text","value":"Example ","key":"Xz8R60VxLz"},{"type":"text","value":"2.4.4","key":"MVgZWAMRjz"}],"template":"Example %s","enumerator":"2.4.4","resolved":true,"html_id":"demo-lu-solve","remote":true,"url":"/lu","dataUrl":"/lu.json","key":"YAM49iciu5"}],"key":"PTt0duVmQT"},{"type":"paragraph","position":{"start":{"line":602,"column":1},"end":{"line":602,"column":1}},"children":[{"type":"text","value":"Here are the data for a linear system ","position":{"start":{"line":602,"column":1},"end":{"line":602,"column":1}},"key":"CcK7ubriF4"},{"type":"inlineMath","value":"\\mathbf{A}\\mathbf{x}=\\mathbf{b}","position":{"start":{"line":602,"column":1},"end":{"line":602,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi><mi mathvariant=\"bold\">x</mi><mo>=</mo><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}\\mathbf{x}=\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">Ax</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"H4ASfDXzpa"},{"type":"text","value":".","position":{"start":{"line":602,"column":1},"end":{"line":602,"column":1}},"key":"lTflPDVltS"}],"key":"ZAHbDg9IPq"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A = [2 0 4 3; -4 5 -7 -10; 1 15 2 -4.5; -2 0 2 -13];\nb = [4; 9; 9; 4];","key":"i8YA5SOORP"},{"type":"output","id":"gsMkgbKKZ4Y6xWQUgXcC5","data":[],"key":"pAAHxWMVHI"}],"key":"VFwlECUDDe"},{"type":"paragraph","position":{"start":{"line":609,"column":1},"end":{"line":609,"column":1}},"children":[{"type":"text","value":"We apply ","position":{"start":{"line":609,"column":1},"end":{"line":609,"column":1}},"key":"yt0Zvp5Hrp"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-lufact","label":"function-lufact","children":[{"type":"text","value":"Function ","key":"PFYCCcO8Am"},{"type":"text","value":"2.4.1","key":"MlyPROzQuU"}],"template":"Algorithm %s","enumerator":"2.4.1","resolved":true,"html_id":"function-lufact","remote":true,"url":"/lu","dataUrl":"/lu.json","key":"iXvfpZjkeK"},{"type":"text","value":" and then do two triangular solves.","position":{"start":{"line":609,"column":1},"end":{"line":609,"column":1}},"key":"FPLCVW2hBX"}],"key":"UspDkSBORf"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[L, U] = lufact(A)\nz = forwardsub(L, b);\nx = backsub(U, z);","key":"XkUWvFp8t0"},{"type":"output","id":"P8oc7Hv6cnV4b5vyBiQi6","data":[{"output_type":"execute_result","execution_count":65,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>L = 4×4 double\n   1.0000e+00            0            0            0\n  -2.0000e+00   1.0000e+00            0            0\n   5.0000e-01   3.0000e+00   1.0000e+00            0\n  -1.0000e+00            0  -2.0000e+00   1.0000e+00\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"L = 4×4 double\n   1.0000e+00            0            0            0\n  -2.0000e+00   1.0000e+00            0            0\n   5.0000e-01   3.0000e+00   1.0000e+00            0\n  -1.0000e+00            0  -2.0000e+00   1.0000e+00\n","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":65,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>U = 4×4 double\n     2     0     4     3\n     0     5     1    -4\n     0     0    -3     6\n     0     0     0     2\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"U = 4×4 double\n     2     0     4     3\n     0     5     1    -4\n     0     0    -3     6\n     0     0     0     2\n","content_type":"text/plain"}}}],"key":"znyE2Ap2UZ"}],"key":"Isd7lU8A9A"},{"type":"paragraph","position":{"start":{"line":617,"column":1},"end":{"line":617,"column":1}},"children":[{"type":"text","value":"A check on the residual assures us that we found the solution.","position":{"start":{"line":617,"column":1},"end":{"line":617,"column":1}},"key":"qDe4ABdbPY"}],"key":"emNQPcA9qx"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"b - A * x","key":"VaxabQqjTT"},{"type":"output","id":"-1ceV8HRW7RwiiBbjLXGx","data":[{"output_type":"execute_result","execution_count":66,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = 4×1 double\n1.0e+00 *\n\n            0\n  -5.6843e-14\n   2.8422e-14\n            0\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = 4×1 double\n1.0e+00 *\n\n            0\n  -5.6843e-14\n   2.8422e-14\n            0\n","content_type":"text/plain"}}}],"key":"N6FW2SZw17"}],"key":"y2OA7XJ5gk"}],"label":"demo-lu-solve-matlab","identifier":"demo-lu-solve-matlab","html_id":"demo-lu-solve-matlab","key":"vbKaCLcPAG"},{"type":"heading","depth":3,"position":{"start":{"line":624,"column":1},"end":{"line":624,"column":1}},"children":[{"type":"text","value":"2.5 ","position":{"start":{"line":624,"column":1},"end":{"line":624,"column":1}},"key":"IThl1D3rMu"},{"type":"link","identifier":"section-linsys-efficiency","label":"section-linsys-efficiency","kind":"narrative","position":{"start":{"line":624,"column":5},"end":{"line":624,"column":31}},"url":"/efficiency","internal":true,"dataUrl":"/efficiency.json","children":[{"type":"text","value":"Efficiency of matrix computations","key":"IeIrz9ZaTa"}],"key":"bmUfXk2B0B"}],"identifier":"id-2-5","label":"2.5 ","html_id":"id-2-5","implicit":true,"key":"RBE0ERVUiz"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-flops-mvmult","label":"demo-flops-mvmult","kind":"proof:example","position":{"start":{"line":626,"column":1},"end":{"line":626,"column":19}},"children":[{"type":"text","value":"Example ","key":"mTbAlNkQq1"},{"type":"text","value":"2.5.4","key":"b6LSAF7Gxn"}],"template":"Example %s","enumerator":"2.5.4","resolved":true,"html_id":"demo-flops-mvmult","remote":true,"url":"/efficiency","dataUrl":"/efficiency.json","key":"wd1pakfxS6"}],"key":"mLDBbcmC0J"},{"type":"paragraph","position":{"start":{"line":628,"column":1},"end":{"line":628,"column":1}},"children":[{"type":"text","value":"Here is a straightforward implementation of matrix-vector multiplication.","position":{"start":{"line":628,"column":1},"end":{"line":628,"column":1}},"key":"aO0cQ23Zrt"}],"key":"Oqd4eng1ww"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"n = 6;\nA = magic(n);\nx = ones(n,1);\ny = zeros(n,1);\nfor i = 1:n\n    for j = 1:n\n        y(i) = y(i) + A(i,j)*x(j);   % 2 flops\n    end\nend","key":"GZn4PeAanO"},{"type":"output","id":"YGx-F3_5KDFL2Nwcgsuvw","data":[],"key":"lqv8rDqWUF"}],"key":"Ib2J7uXRw4"},{"type":"paragraph","position":{"start":{"line":642,"column":1},"end":{"line":642,"column":1}},"children":[{"type":"text","value":"Each of the loops implies a summation of flops. The total flop count for this algorithm is","position":{"start":{"line":642,"column":1},"end":{"line":642,"column":1}},"key":"Fu0isnS1vv"}],"key":"SzOL7gR7U3"},{"type":"math","value":"\\sum_{i=1}^n \\sum_{j=1}^n 2 = \\sum_{i=1}^n 2n = 2n^2.","position":{"start":{"line":644,"column":1},"end":{"line":644,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mn>2</mn><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mn>2</mn><mi>n</mi><mo>=</mo><mn>2</mn><msup><mi>n</mi><mn>2</mn></msup><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">\\sum_{i=1}^n \\sum_{j=1}^n 2 = \\sum_{i=1}^n 2n = 2n^2.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:3.0652em;vertical-align:-1.4138em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.6514em;\"><span style=\"top:-1.8723em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span><span style=\"top:-4.3em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.2777em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.6514em;\"><span style=\"top:-1.8723em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span><span style=\"top:-4.3em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.4138em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">2</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.9291em;vertical-align:-1.2777em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.6514em;\"><span style=\"top:-1.8723em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span><span style=\"top:-4.3em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.2777em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">2</span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8641em;\"></span><span class=\"mord\">2</span><span class=\"mord\"><span class=\"mord mathnormal\">n</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mord\">.</span></span></span></span></span>","enumerator":"1","key":"umg9IrvnmT"},{"type":"paragraph","position":{"start":{"line":646,"column":1},"end":{"line":646,"column":1}},"children":[{"type":"text","value":"Since the matrix ","position":{"start":{"line":646,"column":1},"end":{"line":646,"column":1}},"key":"RVYLg2S0N8"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":646,"column":1},"end":{"line":646,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"RNXiOBGIUm"},{"type":"text","value":" has ","position":{"start":{"line":646,"column":1},"end":{"line":646,"column":1}},"key":"hdXppNiE9t"},{"type":"inlineMath","value":"n^2","position":{"start":{"line":646,"column":1},"end":{"line":646,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>n</mi><mn>2</mn></msup></mrow><annotation encoding=\"application/x-tex\">n^2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">n</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span>","key":"EVb65KUaEF"},{"type":"text","value":" elements, all of which have to be involved in the product, it seems unlikely that we could get a flop count that is smaller than ","position":{"start":{"line":646,"column":1},"end":{"line":646,"column":1}},"key":"Y05NyMPbr4"},{"type":"inlineMath","value":"O(n^2)","position":{"start":{"line":646,"column":1},"end":{"line":646,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(n^2)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">n</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"Ei1eMVX7jt"},{"type":"text","value":" in general.","position":{"start":{"line":646,"column":1},"end":{"line":646,"column":1}},"key":"kgPA6EswzK"}],"key":"ZbiBeT6KL3"},{"type":"paragraph","position":{"start":{"line":651,"column":1},"end":{"line":651,"column":1}},"children":[{"type":"text","value":"Let’s run an experiment with the built-in matrix-vector multiplication, using ","position":{"start":{"line":651,"column":1},"end":{"line":651,"column":1}},"key":"jUHiZcTDwK"},{"type":"inlineCode","value":"tic","position":{"start":{"line":651,"column":1},"end":{"line":651,"column":1}},"key":"Y38CEHnHQF"},{"type":"text","value":" and ","position":{"start":{"line":651,"column":1},"end":{"line":651,"column":1}},"key":"C8WXnzFkE9"},{"type":"inlineCode","value":"toc","position":{"start":{"line":651,"column":1},"end":{"line":651,"column":1}},"key":"oYtntrCdOt"},{"type":"text","value":" to time the operation.","position":{"start":{"line":651,"column":1},"end":{"line":651,"column":1}},"key":"yO5L1wwZNu"}],"indexEntries":[{"entry":"MATLAB","subEntry":{"value":"tic and toc","kind":"entry"},"emphasis":true}],"label":"index-YmyRwxBomf","identifier":"index-ymyrwxbomf","html_id":"index-ymyrwxbomf","key":"C9s9fZ5ue6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"n = (500:500:5000)';\nt = zeros(size(n));\nfor k = 1:length(n)\n    A = randn(n(k), n(k));  x = randn(n(k), 1);\n    tic    % start a timer\n    for j = 1:200      % repeat 100 times\n        A*x;\n    end\n    time = toc;           % read the timer\n    t(k) = time / 200;   % seconds per instance\nend","key":"yAJ65sDUNb"},{"type":"output","id":"wlsnVA7iWhor-J-FEDU-7","data":[],"key":"tBsD5kl4Vn"}],"key":"Xy3PzlEjQb"},{"type":"paragraph","position":{"start":{"line":667,"column":1},"end":{"line":667,"column":1}},"children":[{"type":"text","value":"The reason for doing multiple repetitions at each value of ","position":{"start":{"line":667,"column":1},"end":{"line":667,"column":1}},"key":"Un8SnKItqD"},{"type":"inlineMath","value":"n","position":{"start":{"line":667,"column":1},"end":{"line":667,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"Ei6HEVgSBe"},{"type":"text","value":" in the loop above is to avoid having times so short that the resolution of the timer is significant.","position":{"start":{"line":667,"column":1},"end":{"line":667,"column":1}},"key":"l0M42YaKdh"}],"key":"cLLHlW0uCX"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"table(n, t, 'variablenames', [\"size\", \"time\"])","key":"FnMUPYFMTf"},{"type":"output","id":"2QFFPP8T0bmMh1U7MAi0m","data":[{"output_type":"execute_result","execution_count":69,"metadata":{},"data":{"text/html":{"content":"<html><head><style>.mwBasicVariableOutputWrapper .mwBasicVariableOutputHeader {font-style: italic;}</style></head><body><div class='mwBasicVariableOutputWrapper'><div>ans = <span class='mwBasicVariableOutputHeader'>10x2 table</span></div><table><thead><tr><th>size</th><th>time</th></tr></thead><tbody><tr><td>500</td><td>5.8707e-03</td></tr><tr><td>1000</td><td>6.7576e-03</td></tr><tr><td>1500</td><td>7.1093e-03</td></tr><tr><td>2000</td><td>8.4666e-03</td></tr><tr><td>2500</td><td>9.3188e-03</td></tr><tr><td>3000</td><td>1.3534e-02</td></tr><tr><td>3500</td><td>1.5050e-02</td></tr><tr><td>4000</td><td>1.3002e-02</td></tr><tr><td>4500</td><td>1.4546e-02</td></tr><tr><td>5000</td><td>2.4072e-02</td></tr></tbody></table></div></body></html>","content_type":"text/html"},"text/plain":{"content":"<html><head><style>.mwBasicVariableOutputWrapper .mwBasicVariableOutputHeader {font-style: italic;}</style></head><body><div class='mwBasicVariableOutputWrapper'><div>ans = <span class='mwBasicVariableOutputHeader'>10x2 table</span></div><table><thead><tr><th>size</th><th>time</th></tr></thead><tbody><tr><td>500</td><td>5.8707e-03</td></tr><tr><td>1000</td><td>6.7576e-03</td></tr><tr><td>1500</td><td>7.1093e-03</td></tr><tr><td>2000</td><td>8.4666e-03</td></tr><tr><td>2500</td><td>9.3188e-03</td></tr><tr><td>3000</td><td>1.3534e-02</td></tr><tr><td>3500</td><td>1.5050e-02</td></tr><tr><td>4000</td><td>1.3002e-02</td></tr><tr><td>4500</td><td>1.4546e-02</td></tr><tr><td>5000</td><td>2.4072e-02</td></tr></tbody></table></div></body></html>","content_type":"text/plain"}}}],"key":"SKL2jgbUVy"}],"key":"nnCCyrEtqc"},{"type":"paragraph","position":{"start":{"line":676,"column":1},"end":{"line":676,"column":1}},"children":[{"type":"text","value":"Looking at the timings just for ","position":{"start":{"line":676,"column":1},"end":{"line":676,"column":1}},"key":"JdAzN5fiMa"},{"type":"inlineMath","value":"n=2500","position":{"start":{"line":676,"column":1},"end":{"line":676,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>=</mo><mn>2500</mn></mrow><annotation encoding=\"application/x-tex\">n=2500</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2500</span></span></span></span>","key":"PTrcrXqhUj"},{"type":"text","value":" and ","position":{"start":{"line":676,"column":1},"end":{"line":676,"column":1}},"key":"j6nM8O7F8n"},{"type":"inlineMath","value":"n=5000","position":{"start":{"line":676,"column":1},"end":{"line":676,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>=</mo><mn>5000</mn></mrow><annotation encoding=\"application/x-tex\">n=5000</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">5000</span></span></span></span>","key":"h2VmnesMmJ"},{"type":"text","value":", they have ratio","position":{"start":{"line":676,"column":1},"end":{"line":676,"column":1}},"key":"lksHOkVFAT"}],"indexEntries":[{"entry":"MATLAB","subEntry":{"value":"Boolean indexing","kind":"entry"},"emphasis":false}],"label":"index-KYity15VYC","identifier":"index-kyity15vyc","html_id":"index-kyity15vyc","key":"rUcTjP7akm"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"zOvn2HswqB"}],"key":"TS3kSt4Okl"},{"type":"paragraph","position":{"start":{"line":679,"column":1},"end":{"line":679,"column":1}},"children":[{"type":"text","value":"The expression ","position":{"start":{"line":679,"column":1},"end":{"line":679,"column":1}},"key":"cyUUf8EHvC"},{"type":"inlineCode","value":"n==5000","position":{"start":{"line":679,"column":1},"end":{"line":679,"column":1}},"key":"R4mUZcn1sx"},{"type":"text","value":" here produces a vector of Boolean (true/false) values the same size as ","position":{"start":{"line":679,"column":1},"end":{"line":679,"column":1}},"key":"MoQPrckXeM"},{"type":"inlineCode","value":"n","position":{"start":{"line":679,"column":1},"end":{"line":679,"column":1}},"key":"rljFvzuJ70"},{"type":"text","value":". This result is used to index within ","position":{"start":{"line":679,"column":1},"end":{"line":679,"column":1}},"key":"Ji0JLnu33r"},{"type":"inlineCode","value":"t","position":{"start":{"line":679,"column":1},"end":{"line":679,"column":1}},"key":"IKpAY8s0Zn"},{"type":"text","value":", accessing only the value for which the comparison is true.","position":{"start":{"line":679,"column":1},"end":{"line":679,"column":1}},"key":"Awjtf0Ob5p"}],"key":"vi9LuQb6KR"}],"class":"dropdown","key":"hbu7VQ1Ozl"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"t(n==5000) / t(n==2500)","key":"FXr1R4zBx4"},{"type":"output","id":"lsO5hJiHG5pD802vdgJVx","data":[{"output_type":"execute_result","execution_count":70,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = \n   2.5832e+00\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = \n   2.5832e+00\n","content_type":"text/plain"}}}],"key":"uOxn9YVgz6"}],"key":"dDUKUWOe9a"},{"type":"paragraph","position":{"start":{"line":686,"column":1},"end":{"line":686,"column":1}},"children":[{"type":"text","value":"If the run time is dominated by flops, then we expect this ratio to be","position":{"start":{"line":686,"column":1},"end":{"line":686,"column":1}},"key":"d9vNptHDBr"}],"key":"NMA6p3Cg78"},{"type":"math","value":"\\frac{2(5000)^2}{2(2500)^2}=4.","position":{"start":{"line":688,"column":1},"end":{"line":690,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mfrac><mrow><mn>2</mn><mo stretchy=\"false\">(</mo><mn>5000</mn><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup></mrow><mrow><mn>2</mn><mo stretchy=\"false\">(</mo><mn>2500</mn><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup></mrow></mfrac><mo>=</mo><mn>4.</mn></mrow><annotation encoding=\"application/x-tex\">\\frac{2(5000)^2}{2(2500)^2}=4.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.4271em;vertical-align:-0.936em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.4911em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"mopen\">(</span><span class=\"mord\">2500</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7401em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"mopen\">(</span><span class=\"mord\">5000</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.936em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">4.</span></span></span></span></span>","enumerator":"2","key":"QXIyGMKVoj"}],"label":"demo-flops-mvmult-matlab","identifier":"demo-flops-mvmult-matlab","html_id":"demo-flops-mvmult-matlab","key":"ylP23uPzLd"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-flops-loglog","label":"demo-flops-loglog","kind":"proof:example","position":{"start":{"line":694,"column":1},"end":{"line":694,"column":19}},"children":[{"type":"text","value":"Example ","key":"PQoazinwcN"},{"type":"text","value":"2.5.5","key":"I8J8bCkWd5"}],"template":"Example %s","enumerator":"2.5.5","resolved":true,"html_id":"demo-flops-loglog","remote":true,"url":"/efficiency","dataUrl":"/efficiency.json","key":"KU6SL3AXVA"}],"key":"QcBXe9OC05"},{"type":"paragraph","position":{"start":{"line":697,"column":1},"end":{"line":697,"column":1}},"children":[{"type":"text","value":"Let’s repeat the previous experiment for more, and larger, values of ","position":{"start":{"line":697,"column":1},"end":{"line":697,"column":1}},"key":"YjGxMbStb5"},{"type":"inlineMath","value":"n","position":{"start":{"line":697,"column":1},"end":{"line":697,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"i6gNu1ebmZ"},{"type":"text","value":".","position":{"start":{"line":697,"column":1},"end":{"line":697,"column":1}},"key":"GfYrQYtTj2"}],"key":"sr82uJdBsv"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"n = (400:400:6000)';\nt = zeros(size(n));\nfor k = 1:length(n)\n    A = randn(n(k), n(k));  x = randn(n(k), 1);\n    tic    % start a timer\n    for j = 1:100      % repeat ten times\n        A*x;\n    end\n    time = toc;          % read the timer\n    t(k) = time / 100;   % seconds per instance\nend","key":"PP0dPVrFcn"},{"type":"output","id":"VD81FyFHBvvvQmutpNMNF","data":[],"key":"bYQyNjEiMB"}],"key":"Gk79GThMDt"},{"type":"paragraph","position":{"start":{"line":713,"column":1},"end":{"line":713,"column":1}},"children":[{"type":"text","value":"Plotting the time as a function of ","position":{"start":{"line":713,"column":1},"end":{"line":713,"column":1}},"key":"KDP3q3LnYp"},{"type":"inlineMath","value":"n","position":{"start":{"line":713,"column":1},"end":{"line":713,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"ac1fOUZ22J"},{"type":"text","value":" on log-log scales is equivalent to plotting the logs of the variables.","position":{"start":{"line":713,"column":1},"end":{"line":713,"column":1}},"key":"SNB0aRZQT9"}],"key":"vSiJfi04Ga"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf    % clear any existing figure\nloglog(n, t, 'o-')\nxlabel('size of matrix')\nylabel('time (sec)')\ntitle('Timing of matrix-vector multiplications')","key":"RmojNbUUwM"},{"type":"output","id":"6zzZnMDG41BkC7XPt1snp","data":[{"output_type":"execute_result","execution_count":72,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"d6e9100869b609752268eac6e3bbde9a","path":"/build/d6e9100869b609752268eac6e3bbde9a.png"}}}],"key":"BpkZVIMAgz"}],"key":"e522XOhnqP"},{"type":"paragraph","position":{"start":{"line":723,"column":1},"end":{"line":723,"column":1}},"children":[{"type":"text","value":"You can see that while the full story is complicated, the graph is trending to a straight line of positive slope. For comparison, we can plot a line that represents ","position":{"start":{"line":723,"column":1},"end":{"line":723,"column":1}},"key":"Qfa1QMa5ZT"},{"type":"inlineMath","value":"O(n^2)","position":{"start":{"line":723,"column":1},"end":{"line":723,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(n^2)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">n</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"OqAQ7ASvZw"},{"type":"text","value":" growth exactly. (All such lines have slope equal to 2.)","position":{"start":{"line":723,"column":1},"end":{"line":723,"column":1}},"key":"Ve0b9MFARC"}],"key":"dskfHC8y9D"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"hold on\nloglog(n, 0.5 * t(end) * (n / n(end)).^2, 'k--')\naxis tight\nlegend('data', 'O(n^2)', 'location', 'southeast')","key":"Oqu5mW0epZ"},{"type":"output","id":"sO_I6sIJDdF6vu98h965l","data":[{"output_type":"execute_result","execution_count":73,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"0e2b3dafe3b1dcafd6b87071f416f25c","path":"/build/0e2b3dafe3b1dcafd6b87071f416f25c.png"}}}],"key":"W28FwAhs9f"}],"key":"DlPE01ip6S"}],"label":"demo-flops-loglog-matlab","identifier":"demo-flops-loglog-matlab","html_id":"demo-flops-loglog-matlab","key":"yivrHMecJK"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-flops-lufact","label":"demo-flops-lufact","kind":"proof:example","position":{"start":{"line":734,"column":1},"end":{"line":734,"column":19}},"children":[{"type":"text","value":"Example ","key":"Spf6smuYfd"},{"type":"text","value":"2.5.6","key":"Iqk75zgP5d"}],"template":"Example %s","enumerator":"2.5.6","resolved":true,"html_id":"demo-flops-lufact","remote":true,"url":"/efficiency","dataUrl":"/efficiency.json","key":"pOJxoNs2ID"}],"key":"nfOwlSr001"},{"type":"paragraph","position":{"start":{"line":736,"column":1},"end":{"line":736,"column":1}},"children":[{"type":"text","value":"We’ll test the conclusion of ","position":{"start":{"line":736,"column":1},"end":{"line":736,"column":1}},"key":"Q3sRi6GbC1"},{"type":"inlineMath","value":"O(n^3)","position":{"start":{"line":736,"column":1},"end":{"line":736,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><msup><mi>n</mi><mn>3</mn></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(n^3)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">n</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"nXzrYsnzBD"},{"type":"text","value":" flops experimentally, using the built-in ","position":{"start":{"line":736,"column":1},"end":{"line":736,"column":1}},"key":"LcUKK3nR53"},{"type":"inlineCode","value":"lu","position":{"start":{"line":736,"column":1},"end":{"line":736,"column":1}},"key":"FRj46N2JcU"},{"type":"text","value":" function instead of the purely instructive ","position":{"start":{"line":736,"column":1},"end":{"line":736,"column":1}},"key":"SjENcmBzWW"},{"type":"inlineCode","value":"lufact","position":{"start":{"line":736,"column":1},"end":{"line":736,"column":1}},"key":"mZ7KEXveil"},{"type":"text","value":".","position":{"start":{"line":736,"column":1},"end":{"line":736,"column":1}},"key":"pe3os9gb0M"}],"key":"ZqbhTyZr0w"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"yEVRnWiLkx"}],"key":"TDHXIrgUEc"},{"type":"paragraph","position":{"start":{"line":739,"column":1},"end":{"line":739,"column":1}},"children":[{"type":"text","value":"The first time a function is invoked, there may be significant time needed to compile it in memory. Thus, when timing a function, run it at least once before beginning the timing.","position":{"start":{"line":739,"column":1},"end":{"line":739,"column":1}},"key":"dTtx2QtE3J"}],"key":"EvR2zRk3Lx"}],"class":"dropdown","key":"OsYO7JWcGt"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"n = (200:100:2400)';\nt = zeros(size(n));\nfor k = 1:length(n)\n    A = randn(n(k), n(k));  \n    tic    % start a timer\n    for j = 1:6,  [L, U] = lu(A);  end\n    time = toc;\n    t(k) = time / 6;  \nend","key":"dlXkgZb7nW"},{"type":"output","id":"Kpaxs7tWsdrnSUuVH0p9-","data":[],"key":"ZDaWzDcwOc"}],"key":"fUx6bmGa7T"},{"type":"paragraph","position":{"start":{"line":754,"column":1},"end":{"line":754,"column":1}},"children":[{"type":"text","value":"We plot the timings on a log-log graph and compare it to ","position":{"start":{"line":754,"column":1},"end":{"line":754,"column":1}},"key":"xfz2i58I00"},{"type":"inlineMath","value":"O(n^3)","position":{"start":{"line":754,"column":1},"end":{"line":754,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><msup><mi>n</mi><mn>3</mn></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(n^3)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">n</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"HWuxNJIQ7y"},{"type":"text","value":". The result could vary significantly from machine to machine, but in theory the data should start to parallel the line as ","position":{"start":{"line":754,"column":1},"end":{"line":754,"column":1}},"key":"Co8C1Z1Z8i"},{"type":"inlineMath","value":"n\\to\\infty","position":{"start":{"line":754,"column":1},"end":{"line":754,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>→</mo><mi mathvariant=\"normal\">∞</mi></mrow><annotation encoding=\"application/x-tex\">n\\to\\infty</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord\">∞</span></span></span></span>","key":"F81A6R0cMw"},{"type":"text","value":".","position":{"start":{"line":754,"column":1},"end":{"line":754,"column":1}},"key":"wwDsin5HZq"}],"key":"biDGO9Tulf"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf\nloglog(n, t, 'o-')\nhold on\nloglog(n, 0.5 * t(end) * (n/n(end)).^3, 'k--')\naxis tight\nxlabel('size of matrix'), ylabel('time (sec)')\ntitle('Timing of LU factorization')\nlegend('lu','O(n^3)','location','southeast');","key":"KL2ybTtNWN"},{"type":"output","id":"zTrmc9--coUP8wC1pVwuM","data":[{"output_type":"execute_result","execution_count":75,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"4e36554d2c417c92d216837cfdc4c42b","path":"/build/4e36554d2c417c92d216837cfdc4c42b.png"}}}],"key":"zDpq5MXAaG"}],"key":"f7AWtBW04H"}],"label":"demo-flops-lufact-matlab","identifier":"demo-flops-lufact-matlab","html_id":"demo-flops-lufact-matlab","key":"ltEQ0X2YRU"},{"type":"heading","depth":3,"position":{"start":{"line":768,"column":1},"end":{"line":768,"column":1}},"children":[{"type":"text","value":"2.6 ","position":{"start":{"line":768,"column":1},"end":{"line":768,"column":1}},"key":"nHmoYMep7W"},{"type":"link","identifier":"section-linsys-pivoting","label":"section-linsys-pivoting","kind":"narrative","position":{"start":{"line":768,"column":5},"end":{"line":768,"column":29}},"url":"/pivoting","internal":true,"dataUrl":"/pivoting.json","children":[{"type":"text","value":"Row pivoting","key":"wqIWe0u00t"}],"key":"hWwcv321cV"}],"identifier":"id-2-6","label":"2.6 ","html_id":"id-2-6","implicit":true,"key":"zUBLb8XUwE"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-pivoting-fail","label":"demo-pivoting-fail","kind":"proof:example","position":{"start":{"line":770,"column":1},"end":{"line":770,"column":20}},"children":[{"type":"text","value":"Example ","key":"lprI05rOSY"},{"type":"text","value":"2.6.1","key":"gDCzQg0e9L"}],"template":"Example %s","enumerator":"2.6.1","resolved":true,"html_id":"demo-pivoting-fail","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"Us9BBVQp94"}],"key":"Yd4zmMD619"},{"type":"paragraph","position":{"start":{"line":772,"column":1},"end":{"line":772,"column":1}},"children":[{"type":"text","value":"Here is a previously encountered matrix that factors well.","position":{"start":{"line":772,"column":1},"end":{"line":772,"column":1}},"key":"rmv4jiLzuF"}],"key":"aTDZGCARh1"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A = [\n    2 0 4 3\n    -4 5 -7 -10\n    1 15 2 -4.5\n    -2 0 2 -13\n    ];\n[L, U] = lufact(A);\nL","key":"wuNMXHWuMe"},{"type":"output","id":"Cc1Rza1obZHW70Nyu4BHU","data":[{"output_type":"stream","name":"stderr","text":"Failed to execute. Operation may have interrupted by user."}],"key":"VKZmd0hCLo"}],"key":"SAnjjXFKul"},{"type":"paragraph","position":{"start":{"line":785,"column":1},"end":{"line":785,"column":1}},"children":[{"type":"text","value":"If we swap the second and fourth rows of ","position":{"start":{"line":785,"column":1},"end":{"line":785,"column":1}},"key":"T9Dt10CrTO"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":785,"column":1},"end":{"line":785,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"AXL6qezXYB"},{"type":"text","value":", the result is still nonsingular. However, the factorization now fails.","position":{"start":{"line":785,"column":1},"end":{"line":785,"column":1}},"key":"bZeI2gcMVz"}],"key":"HFTZDzUEvv"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A([2, 4], :) = A([4, 2], :);    % swap rows 2 and 4\n[L, U] = lufact(A);\nL","key":"b2aglIASNT"},{"type":"output","id":"-xLcVQ2WvipJUo5xWg-rM","data":[{"output_type":"execute_result","execution_count":77,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>L = 4×4 double\n   1.0000e+00            0            0            0\n  -1.0000e+00          NaN            0            0\n   5.0000e-01          Inf          NaN            0\n  -2.0000e+00          Inf          NaN   1.0000e+00\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"L = 4×4 double\n   1.0000e+00            0            0            0\n  -1.0000e+00          NaN            0            0\n   5.0000e-01          Inf          NaN            0\n  -2.0000e+00          Inf          NaN   1.0000e+00\n","content_type":"text/plain"}}}],"key":"aNUzxTXrRW"}],"key":"BvudkExOS1"},{"type":"paragraph","position":{"start":{"line":796,"column":1},"end":{"line":796,"column":1}},"children":[{"type":"text","value":"The presence of ","position":{"start":{"line":796,"column":1},"end":{"line":796,"column":1}},"key":"p0VjmGXGKO"},{"type":"inlineCode","value":"NaN","position":{"start":{"line":796,"column":1},"end":{"line":796,"column":1}},"key":"HUixTCiLQD"},{"type":"text","value":" in the result indicates that some impossible operation was required. The source of the problem is easy to locate. We can find the first outer product in the factorization just fine:","position":{"start":{"line":796,"column":1},"end":{"line":796,"column":1}},"key":"p8A4peEQci"}],"indexEntries":[{"entry":"MATLAB","subEntry":{"value":"NaN","kind":"entry"},"emphasis":false}],"label":"index-BqgNWy9tiW","identifier":"index-bqgnwy9tiw","html_id":"index-bqgnwy9tiw","key":"HKHY5afFlz"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"U(1, :) = A(1, :);\nL(:, 1) = A(:, 1) / U(1, 1)\nA = A - L(:, 1) * U(1, :)","key":"PPzwJKAmIp"},{"type":"output","id":"Z3fRFUzAuzWulPyAQR5aB","data":[{"output_type":"execute_result","execution_count":78,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>L = 4×4 double\n   1.0000e+00            0            0            0\n  -1.0000e+00          NaN            0            0\n   5.0000e-01          Inf          NaN            0\n  -2.0000e+00          Inf          NaN   1.0000e+00\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"L = 4×4 double\n   1.0000e+00            0            0            0\n  -1.0000e+00          NaN            0            0\n   5.0000e-01          Inf          NaN            0\n  -2.0000e+00          Inf          NaN   1.0000e+00\n","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":78,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>A = 4×4 double\n     0     0     0     0\n     0     0     6   -10\n     0    15     0    -6\n     0     5     1    -4\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"A = 4×4 double\n     0     0     0     0\n     0     0     6   -10\n     0    15     0    -6\n     0     5     1    -4\n","content_type":"text/plain"}}}],"key":"Um46DxDkHw"}],"key":"Lhx3SsUxlW"},{"type":"paragraph","position":{"start":{"line":804,"column":1},"end":{"line":804,"column":1}},"children":[{"type":"text","value":"The next step is ","position":{"start":{"line":804,"column":1},"end":{"line":804,"column":1}},"key":"MQSh9dcflm"},{"type":"inlineCode","value":"U(2, :) = A(2, :)","position":{"start":{"line":804,"column":1},"end":{"line":804,"column":1}},"key":"Oe3ffyDpSA"},{"type":"text","value":", which is also OK. But then we are supposed to divide by ","position":{"start":{"line":804,"column":1},"end":{"line":804,"column":1}},"key":"dvm8kEux7g"},{"type":"inlineCode","value":"U(2, 2)","position":{"start":{"line":804,"column":1},"end":{"line":804,"column":1}},"key":"TPJ6VVjr6S"},{"type":"text","value":", which is zero. The algorithm cannot continue.","position":{"start":{"line":804,"column":1},"end":{"line":804,"column":1}},"key":"hGO37xDOF1"}],"key":"P0B8jELN7F"}],"label":"demo-pivoting-fail-matlab","identifier":"demo-pivoting-fail-matlab","html_id":"demo-pivoting-fail-matlab","key":"naNetsz4t5"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-pivoting-fix","label":"demo-pivoting-fix","kind":"proof:example","position":{"start":{"line":808,"column":1},"end":{"line":808,"column":19}},"children":[{"type":"text","value":"Example ","key":"eaAnjAmKMc"},{"type":"text","value":"2.6.2","key":"Bn4QDJiFlQ"}],"template":"Example %s","enumerator":"2.6.2","resolved":true,"html_id":"demo-pivoting-fix","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"Pb5gWIvRFk"}],"key":"Wbvt6jxkyj"},{"type":"paragraph","position":{"start":{"line":810,"column":1},"end":{"line":810,"column":1}},"children":[{"type":"text","value":"Here is the trouble-making matrix from ","position":{"start":{"line":810,"column":1},"end":{"line":810,"column":1}},"key":"wO3FjReqBx"},{"type":"crossReference","kind":"proof:example","identifier":"demo-pivoting-fail","label":"demo-pivoting-fail","children":[{"type":"text","value":"Demo ","key":"MsYpqtkGFC"},{"type":"text","value":"2.6.1","key":"PktHtRHgEx"}],"template":"Example %s","enumerator":"2.6.1","resolved":true,"html_id":"demo-pivoting-fail","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"sDElb5lZgI"},{"type":"text","value":".","position":{"start":{"line":810,"column":1},"end":{"line":810,"column":1}},"key":"CmN2RiPqrG"}],"key":"uqjiElSxJs"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A_1 = [2 0 4 3; -2 0 2 -13; 1 15 2 -4.5; -4 5 -7 -10]","key":"A9f31d4Hyj"},{"type":"output","id":"vr8VaCGgKKn6hEVlPjDUv","data":[{"output_type":"execute_result","execution_count":79,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>A_1 = 4×4 double\n   2.0000e+00            0   4.0000e+00   3.0000e+00\n  -2.0000e+00            0   2.0000e+00  -1.3000e+01\n   1.0000e+00   1.5000e+01   2.0000e+00  -4.5000e+00\n  -4.0000e+00   5.0000e+00  -7.0000e+00  -1.0000e+01\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"A_1 = 4×4 double\n   2.0000e+00            0   4.0000e+00   3.0000e+00\n  -2.0000e+00            0   2.0000e+00  -1.3000e+01\n   1.0000e+00   1.5000e+01   2.0000e+00  -4.5000e+00\n  -4.0000e+00   5.0000e+00  -7.0000e+00  -1.0000e+01\n","content_type":"text/plain"}}}],"key":"qTQqVLOQKa"}],"key":"A2B3uoquIA"},{"type":"paragraph","position":{"start":{"line":819,"column":1},"end":{"line":819,"column":1}},"children":[{"type":"text","value":"We now find the largest candidate pivot in the first column. We don’t care about sign, so we take absolute values before finding the max.","position":{"start":{"line":819,"column":1},"end":{"line":819,"column":1}},"key":"WkS7kVI5Ho"}],"indexEntries":[{"entry":"MATLAB","subEntry":{"value":"max","kind":"entry"},"emphasis":true},{"entry":"MATLAB","subEntry":{"value":"\\~","kind":"entry"},"emphasis":true}],"label":"index-JMi96Hd9TE","identifier":"index-jmi96hd9te","html_id":"index-jmi96hd9te","key":"WlchyQxe4D"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"ISxCnfoWDH"}],"key":"DDg3TGYgUO"},{"type":"paragraph","position":{"start":{"line":822,"column":1},"end":{"line":822,"column":1}},"children":[{"type":"text","value":"The second output of ","position":{"start":{"line":822,"column":1},"end":{"line":822,"column":1}},"key":"zHvq6ZMAVN"},{"type":"inlineCode","value":"max","position":{"start":{"line":822,"column":1},"end":{"line":822,"column":1}},"key":"lPpfAduIa2"},{"type":"text","value":" returns the location of the largest element of a vector. The ","position":{"start":{"line":822,"column":1},"end":{"line":822,"column":1}},"key":"QNZQEzsSaD"},{"type":"inlineCode","value":"~","position":{"start":{"line":822,"column":1},"end":{"line":822,"column":1}},"key":"jxnrV3bJhx"},{"type":"text","value":" symbol is used to ignore the value of the first output.","position":{"start":{"line":822,"column":1},"end":{"line":822,"column":1}},"key":"xVAkTmhHcf"}],"key":"fBAVcnEnkB"}],"class":"dropdown","key":"ZcUXO7su7u"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[~, i] = max( abs(A_1(:, 1)) )","key":"KgvSUJmkck"},{"type":"output","id":"1HdVbdX_bcMdMDkkLHE42","data":[{"output_type":"execute_result","execution_count":80,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>i = \n     4\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"i = \n     4\n","content_type":"text/plain"}}}],"key":"ks8H3BQhYi"}],"key":"K2L8Ecb5SP"},{"type":"paragraph","position":{"start":{"line":830,"column":1},"end":{"line":830,"column":1}},"children":[{"type":"text","value":"This is the row of the matrix that we extract to put into ","position":{"start":{"line":830,"column":1},"end":{"line":830,"column":1}},"key":"bjP3wpHe07"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":830,"column":1},"end":{"line":830,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"zYFsaNQXNG"},{"type":"text","value":". That guarantees that the division used to find ","position":{"start":{"line":830,"column":1},"end":{"line":830,"column":1}},"key":"VT3M2O7eq7"},{"type":"inlineMath","value":"\\boldsymbol{\\ell}_1","position":{"start":{"line":830,"column":1},"end":{"line":830,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">ℓ</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\boldsymbol{\\ell}_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">ℓ</span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"virkOPbqQD"},{"type":"text","value":" will be valid.","position":{"start":{"line":830,"column":1},"end":{"line":830,"column":1}},"key":"rraXk7jmRM"}],"key":"tHiBrrFdQn"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"L = zeros(4, 4);\nU = zeros(4, 4);\nU(1, :) = A_1(i, :);\nL(:, 1) = A_1(:, 1) / U(1, 1);\nA_2 = A_1 - L(:, 1) * U(1, :)","key":"KFciOpBACk"},{"type":"output","id":"_VKWx-Wr7UPnc5OAPFUoj","data":[{"output_type":"execute_result","execution_count":81,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>A_2 = 4×4 double\n            0   2.5000e+00   5.0000e-01  -2.0000e+00\n            0  -2.5000e+00   5.5000e+00  -8.0000e+00\n            0   1.6250e+01   2.5000e-01  -7.0000e+00\n            0            0            0            0\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"A_2 = 4×4 double\n            0   2.5000e+00   5.0000e-01  -2.0000e+00\n            0  -2.5000e+00   5.5000e+00  -8.0000e+00\n            0   1.6250e+01   2.5000e-01  -7.0000e+00\n            0            0            0            0\n","content_type":"text/plain"}}}],"key":"iMa0buq499"}],"key":"wpmeFt1ILj"},{"type":"paragraph","position":{"start":{"line":840,"column":1},"end":{"line":840,"column":1}},"children":[{"type":"text","value":"Observe that ","position":{"start":{"line":840,"column":1},"end":{"line":840,"column":1}},"key":"vwig0dV0MV"},{"type":"inlineMath","value":"\\mathbf{A}_2","position":{"start":{"line":840,"column":1},"end":{"line":840,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">A</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8361em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"cCTVEVoRul"},{"type":"text","value":" has a new zero row and zero column, but the zero row is the fourth rather than the first. However, we forge on by using the largest possible pivot in column 2 for the next outer product.","position":{"start":{"line":840,"column":1},"end":{"line":840,"column":1}},"key":"PjBtvhuiMO"}],"key":"tkfdNjz7ZF"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[~, i] = max( abs(A_2(:, 2)) )\nU(2, :) = A_2(i, :);\nL(:, 2) = A_2(:, 2) / U(2, 2);\nA_3 = A_2 - L(:, 2) * U(2, :)","key":"XWH4QbSMv6"},{"type":"output","id":"savvxO_CAvN1wqx3VBagG","data":[{"output_type":"execute_result","execution_count":82,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>i = \n     3\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"i = \n     3\n","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":82,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>A_3 = 4×4 double\n            0            0   4.6154e-01  -9.2308e-01\n            0            0   5.5385e+00  -9.0769e+00\n            0            0            0            0\n            0            0            0            0\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"A_3 = 4×4 double\n            0            0   4.6154e-01  -9.2308e-01\n            0            0   5.5385e+00  -9.0769e+00\n            0            0            0            0\n            0            0            0            0\n","content_type":"text/plain"}}}],"key":"bR2LSJlqwA"}],"key":"RVetqJ5Nti"},{"type":"paragraph","position":{"start":{"line":849,"column":1},"end":{"line":849,"column":1}},"children":[{"type":"text","value":"Now we have zeroed out the third row as well as the second column. We can finish out the procedure.","position":{"start":{"line":849,"column":1},"end":{"line":849,"column":1}},"key":"El3yv3KEW0"}],"key":"fhHBMIBlHO"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[~, i] = max( abs(A_3(:, 3)) ) \nU(3, :) = A_3(i, :);\nL(:, 3) = A_3(:, 3) / U(3, 3);\nA_4 = A_3 - L(:, 3) * U(3, :)","key":"DnlCwVVoFy"},{"type":"output","id":"Kob6j4t6m0pIFc_8QcI_U","data":[{"output_type":"execute_result","execution_count":83,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>i = \n     2\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"i = \n     2\n","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":83,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>A_4 = 4×4 double\n            0            0            0  -1.6667e-01\n            0            0            0            0\n            0            0            0            0\n            0            0            0            0\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"A_4 = 4×4 double\n            0            0            0  -1.6667e-01\n            0            0            0            0\n            0            0            0            0\n            0            0            0            0\n","content_type":"text/plain"}}}],"key":"KZvY31Pt5U"}],"key":"Gmz5HK9M4e"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[~, i] = max( abs(A_4(:, 4)) ) \nU(4, :) = A_4(i, :);\nL(:, 4) = A_4(:, 4) / U(4, 4);","key":"AjxbXXwQgC"},{"type":"output","id":"3y6TRtnLJZCxEMHrcmUZ0","data":[{"output_type":"execute_result","execution_count":84,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>i = \n     1\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"i = \n     1\n","content_type":"text/plain"}}}],"key":"Vt26Nxmf3b"}],"key":"YPphrACoBj"},{"type":"paragraph","position":{"start":{"line":864,"column":1},"end":{"line":864,"column":1}},"children":[{"type":"text","value":"We do have a factorization of the original matrix:","position":{"start":{"line":864,"column":1},"end":{"line":864,"column":1}},"key":"S4UB21NxW9"}],"key":"XybDz0QC8w"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A_1 - L * U","key":"dMILmhpDSF"},{"type":"output","id":"3loP6hb5LiWMy4ip6yHGA","data":[{"output_type":"execute_result","execution_count":85,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = 4×4 double\n     0     0     0     0\n     0     0     0     0\n     0     0     0     0\n     0     0     0     0\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = 4×4 double\n     0     0     0     0\n     0     0     0     0\n     0     0     0     0\n     0     0     0     0\n","content_type":"text/plain"}}}],"key":"tqxhH9G0Vr"}],"key":"LQmrmFiBhU"},{"type":"paragraph","position":{"start":{"line":870,"column":1},"end":{"line":870,"column":1}},"children":[{"type":"text","value":"And ","position":{"start":{"line":870,"column":1},"end":{"line":870,"column":1}},"key":"YgzFrElrGg"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":870,"column":1},"end":{"line":870,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"EqxZdHO3d8"},{"type":"text","value":" has the required structure:","position":{"start":{"line":870,"column":1},"end":{"line":870,"column":1}},"key":"MBI65BQc34"}],"key":"qxBVveuasp"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"U","key":"C75XgUxiTO"},{"type":"output","id":"J4sMXAXXBMjvbsrZgnEgA","data":[{"output_type":"execute_result","execution_count":86,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>U = 4×4 double\n  -4.0000e+00   5.0000e+00  -7.0000e+00  -1.0000e+01\n            0   1.6250e+01   2.5000e-01  -7.0000e+00\n            0            0   5.5385e+00  -9.0769e+00\n            0            0            0  -1.6667e-01\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"U = 4×4 double\n  -4.0000e+00   5.0000e+00  -7.0000e+00  -1.0000e+01\n            0   1.6250e+01   2.5000e-01  -7.0000e+00\n            0            0   5.5385e+00  -9.0769e+00\n            0            0            0  -1.6667e-01\n","content_type":"text/plain"}}}],"key":"ehEO0Sj28Y"}],"key":"apJjsI4KZp"},{"type":"paragraph","position":{"start":{"line":876,"column":1},"end":{"line":876,"column":1}},"children":[{"type":"text","value":"However, the triangularity of ","position":{"start":{"line":876,"column":1},"end":{"line":876,"column":1}},"key":"pAl8SsDPzi"},{"type":"inlineMath","value":"\\mathbf{L}","position":{"start":{"line":876,"column":1},"end":{"line":876,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">L</span></span></span></span>","key":"EO9vV6gCmo"},{"type":"text","value":" has been broken.","position":{"start":{"line":876,"column":1},"end":{"line":876,"column":1}},"key":"TcNBuVjRYG"}],"key":"C8CmOW8FCm"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"L","key":"oCbxPE7gdn"},{"type":"output","id":"h9-fmwH3Bx6U5Vd_H2j50","data":[{"output_type":"execute_result","execution_count":87,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>L = 4×4 double\n  -5.0000e-01   1.5385e-01   8.3333e-02   1.0000e+00\n   5.0000e-01  -1.5385e-01   1.0000e+00            0\n  -2.5000e-01   1.0000e+00            0            0\n   1.0000e+00            0            0            0\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"L = 4×4 double\n  -5.0000e-01   1.5385e-01   8.3333e-02   1.0000e+00\n   5.0000e-01  -1.5385e-01   1.0000e+00            0\n  -2.5000e-01   1.0000e+00            0            0\n   1.0000e+00            0            0            0\n","content_type":"text/plain"}}}],"key":"OOMsRMPAMv"}],"key":"FBBxREslTd"}],"label":"demo-pivoting-fix-matlab","identifier":"demo-pivoting-fix-matlab","html_id":"demo-pivoting-fix-matlab","key":"tu5NECtDbQ"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-pivoting-permute","label":"demo-pivoting-permute","kind":"proof:example","position":{"start":{"line":884,"column":1},"end":{"line":884,"column":23}},"children":[{"type":"text","value":"Example ","key":"jrn3vmAx9Q"},{"type":"text","value":"2.6.3","key":"oxTkQXcoJE"}],"template":"Example %s","enumerator":"2.6.3","resolved":true,"html_id":"demo-pivoting-permute","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"s6pA2JGMBU"}],"key":"KBoPE3OItT"},{"type":"paragraph","position":{"start":{"line":886,"column":1},"end":{"line":886,"column":1}},"children":[{"type":"text","value":"Here again is the matrix from ","position":{"start":{"line":886,"column":1},"end":{"line":886,"column":1}},"key":"JaajDgvzCu"},{"type":"crossReference","kind":"proof:example","identifier":"demo-pivoting-fix","label":"demo-pivoting-fix","children":[{"type":"text","value":"Demo ","key":"fEFt4KISnZ"},{"type":"text","value":"2.6.2","key":"fKTDjRMrIO"}],"template":"Example %s","enumerator":"2.6.2","resolved":true,"html_id":"demo-pivoting-fix","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"usFVg6Le53"},{"type":"text","value":".","position":{"start":{"line":886,"column":1},"end":{"line":886,"column":1}},"key":"Q6R7jTuHo0"}],"key":"GR06jcm1jT"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A = [2 0 4 3; -2 0 2 -13; 1 15 2 -4.5; -4 5 -7 -10]","key":"inwpZVjpJh"},{"type":"output","id":"Z2cXii5SbZVSumXoGhCPO","data":[{"output_type":"execute_result","execution_count":88,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>A = 4×4 double\n   2.0000e+00            0   4.0000e+00   3.0000e+00\n  -2.0000e+00            0   2.0000e+00  -1.3000e+01\n   1.0000e+00   1.5000e+01   2.0000e+00  -4.5000e+00\n  -4.0000e+00   5.0000e+00  -7.0000e+00  -1.0000e+01\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"A = 4×4 double\n   2.0000e+00            0   4.0000e+00   3.0000e+00\n  -2.0000e+00            0   2.0000e+00  -1.3000e+01\n   1.0000e+00   1.5000e+01   2.0000e+00  -4.5000e+00\n  -4.0000e+00   5.0000e+00  -7.0000e+00  -1.0000e+01\n","content_type":"text/plain"}}}],"key":"EaLDAyPaC9"}],"key":"mPKrKMnUWS"},{"type":"paragraph","position":{"start":{"line":892,"column":1},"end":{"line":892,"column":1}},"children":[{"type":"text","value":"As the factorization proceeded, the pivots were selected from rows 4, 3, 2, and finally 1. If we were to put the rows of ","position":{"start":{"line":892,"column":1},"end":{"line":892,"column":1}},"key":"HxRyPuLNee"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":892,"column":1},"end":{"line":892,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"JYSi22laLv"},{"type":"text","value":" into that order, then the algorithm would run exactly like the plain LU factorization from ","position":{"start":{"line":892,"column":1},"end":{"line":892,"column":1}},"key":"HVGTYzDqQm"},{"type":"link","kind":"numref","identifier":"section-linsys-lu","label":"section-linsys-lu","url":"/lu","internal":true,"dataUrl":"/lu.json","children":[{"type":"text","value":"LU factorization","key":"B4Cwq8TRCN"}],"key":"onoC7GWgpA"},{"type":"text","value":".","position":{"start":{"line":892,"column":1},"end":{"line":892,"column":1}},"key":"gSniDW0bVq"}],"key":"KYKuvWo43d"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"B = A([4, 3, 2, 1], :);\n[L, U] = lufact(B);","key":"DsMlDMqU7K"},{"type":"output","id":"isBIxTPBzL0-S-KXKS9im","data":[],"key":"izwo69lX7z"}],"key":"gz89AzofQ6"},{"type":"paragraph","position":{"start":{"line":899,"column":1},"end":{"line":899,"column":1}},"children":[{"type":"text","value":"We obtain the same ","position":{"start":{"line":899,"column":1},"end":{"line":899,"column":1}},"key":"kLeVuac6UP"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":899,"column":1},"end":{"line":899,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"xxYzYsLTL6"},{"type":"text","value":" as before:","position":{"start":{"line":899,"column":1},"end":{"line":899,"column":1}},"key":"XkZEVjnWFX"}],"key":"RiNittAwTW"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"U","key":"YdgKNpAHhV"},{"type":"output","id":"E8lylLOT5-4PB8ctjRXGK","data":[{"output_type":"execute_result","execution_count":90,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>U = 4×4 double\n  -4.0000e+00   5.0000e+00  -7.0000e+00  -1.0000e+01\n            0   1.6250e+01   2.5000e-01  -7.0000e+00\n            0            0   5.5385e+00  -9.0769e+00\n            0            0            0  -1.6667e-01\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"U = 4×4 double\n  -4.0000e+00   5.0000e+00  -7.0000e+00  -1.0000e+01\n            0   1.6250e+01   2.5000e-01  -7.0000e+00\n            0            0   5.5385e+00  -9.0769e+00\n            0            0            0  -1.6667e-01\n","content_type":"text/plain"}}}],"key":"YLU7NLxDWp"}],"key":"VpSzNDQHlE"},{"type":"paragraph","position":{"start":{"line":905,"column":1},"end":{"line":905,"column":1}},"children":[{"type":"text","value":"And ","position":{"start":{"line":905,"column":1},"end":{"line":905,"column":1}},"key":"x8F1pZYcNp"},{"type":"inlineMath","value":"\\mathbf{L}","position":{"start":{"line":905,"column":1},"end":{"line":905,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">L</span></span></span></span>","key":"LW9dr8z0q9"},{"type":"text","value":" has the same rows as before, but arranged into triangular order:","position":{"start":{"line":905,"column":1},"end":{"line":905,"column":1}},"key":"pjx1RlRWff"}],"key":"fSc3XAVSO1"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"L","key":"WBsesuhePn"},{"type":"output","id":"MYzaPsrRecrzrr5N97mLC","data":[{"output_type":"execute_result","execution_count":91,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>L = 4×4 double\n   1.0000e+00            0            0            0\n  -2.5000e-01   1.0000e+00            0            0\n   5.0000e-01  -1.5385e-01   1.0000e+00            0\n  -5.0000e-01   1.5385e-01   8.3333e-02   1.0000e+00\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"L = 4×4 double\n   1.0000e+00            0            0            0\n  -2.5000e-01   1.0000e+00            0            0\n   5.0000e-01  -1.5385e-01   1.0000e+00            0\n  -5.0000e-01   1.5385e-01   8.3333e-02   1.0000e+00\n","content_type":"text/plain"}}}],"key":"baWVV2vOo2"}],"key":"SFNkNn0nIh"}],"label":"demo-pivoting-permute-matlab","identifier":"demo-pivoting-permute-matlab","html_id":"demo-pivoting-permute-matlab","key":"IabdAnK84Z"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-pivoting-usage","label":"demo-pivoting-usage","kind":"proof:example","position":{"start":{"line":913,"column":1},"end":{"line":913,"column":21}},"children":[{"type":"text","value":"Example ","key":"dgrl8U0o15"},{"type":"text","value":"2.6.4","key":"lr7vtfmWCg"}],"template":"Example %s","enumerator":"2.6.4","resolved":true,"html_id":"demo-pivoting-usage","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"JQrIPDgXdO"}],"key":"kdEoFQklii"},{"type":"paragraph","position":{"start":{"line":915,"column":1},"end":{"line":915,"column":1}},"children":[{"type":"text","value":"The third output of ","position":{"start":{"line":915,"column":1},"end":{"line":915,"column":1}},"key":"P782Otrek5"},{"type":"inlineCode","value":"plufact","position":{"start":{"line":915,"column":1},"end":{"line":915,"column":1}},"key":"dnwZDUc8kY"},{"type":"text","value":" is the permutation vector we need to apply to ","position":{"start":{"line":915,"column":1},"end":{"line":915,"column":1}},"key":"A7AbguCkuB"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":915,"column":1},"end":{"line":915,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"rkwGYFyBAT"},{"type":"text","value":".","position":{"start":{"line":915,"column":1},"end":{"line":915,"column":1}},"key":"Vif88NgHj0"}],"key":"cRjCVgYrUl"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A = randi(20, 4, 4);\n[L, U, p] = plufact(A);\nA(p, :) - L * U    % should be ≈ 0","key":"bPMQdrqrRG"},{"type":"output","id":"UbZmfbyH7IYqw2dRKaBUz","data":[{"output_type":"execute_result","execution_count":92,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = 4×4 double\n     0     0     0     0\n     0     0     0     0\n     0     0     0     0\n     0     0     0     0\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = 4×4 double\n     0     0     0     0\n     0     0     0     0\n     0     0     0     0\n     0     0     0     0\n","content_type":"text/plain"}}}],"key":"qe9zaNAmfP"}],"key":"q4pI9j7cjq"},{"type":"paragraph","position":{"start":{"line":923,"column":1},"end":{"line":923,"column":1}},"children":[{"type":"text","value":"Given a vector ","position":{"start":{"line":923,"column":1},"end":{"line":923,"column":1}},"key":"J2Z2ABUCRf"},{"type":"inlineMath","value":"\\mathbf{b}","position":{"start":{"line":923,"column":1},"end":{"line":923,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"Br1SjG8Nqd"},{"type":"text","value":", we solve ","position":{"start":{"line":923,"column":1},"end":{"line":923,"column":1}},"key":"t6q9O0NPmU"},{"type":"inlineMath","value":"\\mathbf{A}\\mathbf{x}=\\mathbf{b}","position":{"start":{"line":923,"column":1},"end":{"line":923,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi><mi mathvariant=\"bold\">x</mi><mo>=</mo><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}\\mathbf{x}=\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">Ax</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"y39C7stq0K"},{"type":"text","value":" by first permuting the entries of ","position":{"start":{"line":923,"column":1},"end":{"line":923,"column":1}},"key":"P8AXL2frKH"},{"type":"inlineMath","value":"\\mathbf{b}","position":{"start":{"line":923,"column":1},"end":{"line":923,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"uxBZJPyVNs"},{"type":"text","value":" and then proceeding as before.","position":{"start":{"line":923,"column":1},"end":{"line":923,"column":1}},"key":"FUTQjYhHVf"}],"key":"go1Ky36jOu"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"b = rand(4, 1);\nz = forwardsub(L, b(p));\nx = backsub(U, z)","key":"bmkDj68565"},{"type":"output","id":"JVbjO_lIiOvKB7M9CKTeH","data":[{"output_type":"execute_result","execution_count":93,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>x = 4×1 double\n   4.1449e-03\n   2.9307e-02\n  -1.4960e-02\n   9.8275e-02\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"x = 4×1 double\n   4.1449e-03\n   2.9307e-02\n  -1.4960e-02\n   9.8275e-02\n","content_type":"text/plain"}}}],"key":"EReKVGq5cg"}],"key":"UYCu8VyfNu"},{"type":"paragraph","position":{"start":{"line":931,"column":1},"end":{"line":931,"column":1}},"children":[{"type":"text","value":"A residual check is successful:","position":{"start":{"line":931,"column":1},"end":{"line":931,"column":1}},"key":"rGp3ICN9Dh"}],"key":"BuWWgod2W3"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"b - A*x","key":"zKHyBZtX5V"},{"type":"output","id":"380sYTTzuffPIYKAUYs9s","data":[{"output_type":"execute_result","execution_count":94,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = 4×1 double\n     0\n     0\n     0\n     0\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = 4×1 double\n     0\n     0\n     0\n     0\n","content_type":"text/plain"}}}],"key":"T5snZ2QVgs"}],"key":"q8luwR5jZN"}],"label":"demo-pivoting-usage-matlab","identifier":"demo-pivoting-usage-matlab","html_id":"demo-pivoting-usage-matlab","key":"ETthGjUtut"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-pivoting-builtin","label":"demo-pivoting-builtin","kind":"proof:example","position":{"start":{"line":939,"column":1},"end":{"line":939,"column":23}},"children":[{"type":"text","value":"Example ","key":"GoTmmmYSr0"},{"type":"text","value":"2.6.5","key":"vBcG5TMZkr"}],"template":"Example %s","enumerator":"2.6.5","resolved":true,"html_id":"demo-pivoting-builtin","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"MRiyc8ONdu"}],"key":"vAD8TV6s4O"},{"type":"paragraph","position":{"start":{"line":941,"column":1},"end":{"line":941,"column":1}},"children":[{"type":"text","value":"With the syntax ","position":{"start":{"line":941,"column":1},"end":{"line":941,"column":1}},"key":"uzCTB9uqYD"},{"type":"inlineCode","value":"A \\ b","position":{"start":{"line":941,"column":1},"end":{"line":941,"column":1}},"key":"gSJSYa5Pec"},{"type":"text","value":", the matrix ","position":{"start":{"line":941,"column":1},"end":{"line":941,"column":1}},"key":"pcZu47baUZ"},{"type":"inlineCode","value":"A","position":{"start":{"line":941,"column":1},"end":{"line":941,"column":1}},"key":"lngy3YDOmj"},{"type":"text","value":" is PLU-factored, followed by two triangular solves.","position":{"start":{"line":941,"column":1},"end":{"line":941,"column":1}},"key":"jk4xRd5eom"}],"key":"AhlDI9Emo4"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A = randn(500, 500);    % 500x500 with normal random entries\ntic; for k=1:50; A \\ rand(500, 1); end; toc","key":"B3y87vXqHi"},{"type":"output","id":"VOWcuzIs4nZ27OH4OwcgW","data":[{"output_type":"stream","name":"stdout","text":"Elapsed time is 1.071237 seconds.\n"}],"key":"HHG0MdF5Pu"}],"key":"LQUS2R5PCj"},{"type":"paragraph","position":{"start":{"line":948,"column":1},"end":{"line":948,"column":1}},"children":[{"type":"text","value":"In ","position":{"start":{"line":948,"column":1},"end":{"line":948,"column":1}},"key":"xamMrxrUPK"},{"type":"link","kind":"numref","identifier":"section-linsys-efficiency","label":"section-linsys-efficiency","url":"/efficiency","internal":true,"dataUrl":"/efficiency.json","children":[{"type":"text","value":"Efficiency of matrix computations","key":"cCcomIKXnA"}],"key":"cLGD0ycEeP"},{"type":"text","value":" we showed that the factorization is by far the most costly part of the solution process. A factorization object allows us to do that costly step only once per unique matrix.","position":{"start":{"line":948,"column":1},"end":{"line":948,"column":1}},"key":"SQQoUreRk8"}],"key":"SlxKejjkS3"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[L, U, p] = lu(A, 'vector');    % keep factorization result\ntic\nfor k=1:50\n    b = rand(500, 1);\n    U \\ (L \\ b(p));\nend\ntoc","key":"WLSacfESKy"},{"type":"output","id":"QMLgHYiy8zcHMQgeaBD30","data":[{"output_type":"stream","name":"stdout","text":"Elapsed time is 0.010074 seconds.\n"}],"key":"wgFJzYgjxP"}],"key":"myVODS4uJ5"}],"label":"demo-pivoting-builtin-matlab","identifier":"demo-pivoting-builtin-matlab","html_id":"demo-pivoting-builtin-matlab","key":"jM6wr6yNUK"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-pivoting-stable","label":"demo-pivoting-stable","kind":"proof:example","position":{"start":{"line":962,"column":1},"end":{"line":962,"column":22}},"children":[{"type":"text","value":"Example ","key":"UA46pnPgm7"},{"type":"text","value":"2.6.6","key":"JP8XPgY6VF"}],"template":"Example %s","enumerator":"2.6.6","resolved":true,"html_id":"demo-pivoting-stable","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"anGG7xz8xy"}],"key":"TYrkqXv5jl"},{"type":"paragraph","position":{"start":{"line":964,"column":1},"end":{"line":964,"column":1}},"children":[{"type":"text","value":"We construct a linear system for this matrix with ","position":{"start":{"line":964,"column":1},"end":{"line":964,"column":1}},"key":"htc7hv5Juh"},{"type":"inlineMath","value":"\\epsilon=10^{-12}","position":{"start":{"line":964,"column":1},"end":{"line":964,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ϵ</mi><mo>=</mo><mn>1</mn><msup><mn>0</mn><mrow><mo>−</mo><mn>12</mn></mrow></msup></mrow><annotation encoding=\"application/x-tex\">\\epsilon=10^{-12}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">ϵ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">12</span></span></span></span></span></span></span></span></span></span></span></span>","key":"mwWc97KGHN"},{"type":"text","value":" and exact solution ","position":{"start":{"line":964,"column":1},"end":{"line":964,"column":1}},"key":"d2BmMEVKp6"},{"type":"inlineMath","value":"[1, 1]","position":{"start":{"line":964,"column":1},"end":{"line":964,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[1, 1]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]</span></span></span></span>","key":"g9YQHBH5bk"},{"type":"text","value":":","position":{"start":{"line":964,"column":1},"end":{"line":964,"column":1}},"key":"jTu6eBwGeB"}],"key":"PQUHiInJt4"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"ep = 1e-12\nA = [-ep 1; 1 -1];\nb = A * [1; 1];","key":"smQGnlO3DR"},{"type":"output","id":"PY1Gl6R1tpG6lq6eCv7d_","data":[{"output_type":"execute_result","execution_count":97,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ep = \n   1.0000e-12\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ep = \n   1.0000e-12\n","content_type":"text/plain"}}}],"key":"Wao4y2ujdP"}],"key":"vzXtFtxu3T"},{"type":"paragraph","position":{"start":{"line":972,"column":1},"end":{"line":972,"column":1}},"children":[{"type":"text","value":"We can factor the matrix without pivoting and solve for ","position":{"start":{"line":972,"column":1},"end":{"line":972,"column":1}},"key":"rrAO2ThiLx"},{"type":"inlineMath","value":"\\mathbf{x}","position":{"start":{"line":972,"column":1},"end":{"line":972,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">x</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{x}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4444em;\"></span><span class=\"mord mathbf\">x</span></span></span></span>","key":"aWCGKNmKU4"},{"type":"text","value":".","position":{"start":{"line":972,"column":1},"end":{"line":972,"column":1}},"key":"YqPSyjBmoM"}],"key":"Shk8nnxUeR"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[L, U] = lufact(A);\nx = backsub( U, forwardsub(L, b) )","key":"kOBIPHvRku"},{"type":"output","id":"4jK6NPeToqNYlbFjhTjjm","data":[{"output_type":"execute_result","execution_count":98,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>x = 2×1 double\n   9.9998e-01\n   1.0000e+00\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"x = 2×1 double\n   9.9998e-01\n   1.0000e+00\n","content_type":"text/plain"}}}],"key":"jVfo04Oalo"}],"key":"HyVwR95u1f"},{"type":"paragraph","position":{"start":{"line":979,"column":1},"end":{"line":979,"column":1}},"children":[{"type":"text","value":"Note that we have obtained only about 5 accurate digits for ","position":{"start":{"line":979,"column":1},"end":{"line":979,"column":1}},"key":"VsHNsNef74"},{"type":"inlineMath","value":"x_1","position":{"start":{"line":979,"column":1},"end":{"line":979,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">x_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"VbKI8fceZ1"},{"type":"text","value":". We could make the result even more inaccurate by making ","position":{"start":{"line":979,"column":1},"end":{"line":979,"column":1}},"key":"S3NtfYMMNM"},{"type":"text","value":"ε","position":{"start":{"line":979,"column":1},"end":{"line":979,"column":1}},"key":"tt4ggFz8Kc"},{"type":"text","value":" even smaller:","position":{"start":{"line":979,"column":1},"end":{"line":979,"column":1}},"key":"qcmfZFj7PN"}],"key":"YwnVgv5qTr"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"ep = 1e-20; A = [-ep 1; 1 -1];\nb = A * [1; 1];\n[L, U] = lufact(A);\nx = backsub( U, forwardsub(L, b) )","key":"VU9e64sjEL"},{"type":"output","id":"JDolJ8oApKNa62N06LRhn","data":[{"output_type":"execute_result","execution_count":99,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>x = 2×1 double\n     0\n     1\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"x = 2×1 double\n     0\n     1\n","content_type":"text/plain"}}}],"key":"CmRkVB136e"}],"key":"enyvXNeeey"},{"type":"paragraph","position":{"start":{"line":988,"column":1},"end":{"line":988,"column":1}},"children":[{"type":"text","value":"This effect is not due to ill conditioning of the problem—a solution with PLU factorization works perfectly:","position":{"start":{"line":988,"column":1},"end":{"line":988,"column":1}},"key":"UZ94zp2IYa"}],"key":"LStXDA7pPu"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A \\ b","key":"INGcHlqBuD"},{"type":"output","id":"ykHiTFf7d7_7SjOq7QV_u","data":[{"output_type":"execute_result","execution_count":100,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = 2×1 double\n     1\n     1\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = 2×1 double\n     1\n     1\n","content_type":"text/plain"}}}],"key":"jNfRZsfbwD"}],"key":"yYqvJdJHyf"}],"label":"demo-pivoting-stable-matlab","identifier":"demo-pivoting-stable-matlab","html_id":"demo-pivoting-stable-matlab","key":"IcbtIHZ2uc"},{"type":"heading","depth":3,"position":{"start":{"line":995,"column":1},"end":{"line":995,"column":1}},"children":[{"type":"text","value":"2.7 ","position":{"start":{"line":995,"column":1},"end":{"line":995,"column":1}},"key":"cFa0I5SYL8"},{"type":"link","identifier":"section-linsys-norms","label":"section-linsys-norms","kind":"narrative","position":{"start":{"line":995,"column":5},"end":{"line":995,"column":26}},"url":"/norms","internal":true,"dataUrl":"/norms.json","children":[{"type":"text","value":"Vector and matrix norms","key":"iWTYm1tJge"}],"key":"b3YdhR5sCk"}],"identifier":"id-2-7","label":"2.7 ","html_id":"id-2-7","implicit":true,"key":"L6OSGXbjRQ"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-norms-vector","label":"demo-norms-vector","kind":"proof:example","position":{"start":{"line":997,"column":1},"end":{"line":997,"column":19}},"children":[{"type":"text","value":"Example ","key":"TILR11XSN5"},{"type":"text","value":"2.7.1","key":"opLpk1iJT4"}],"template":"Example %s","enumerator":"2.7.1","resolved":true,"html_id":"demo-norms-vector","remote":true,"url":"/norms","dataUrl":"/norms.json","key":"sbS5SWWYbi"}],"key":"woZwMlAVpo"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"x = [2; -3; 1; -1];\ntwonorm = norm(x)    % or norm(x, 2)","key":"VJG23yCdQc"},{"type":"output","id":"B-yFhN-sbDhxwUwJp0Wr3","data":[{"output_type":"execute_result","execution_count":101,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>twonorm = \n   3.8730e+00\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"twonorm = \n   3.8730e+00\n","content_type":"text/plain"}}}],"key":"RbjOdflSCs"}],"indexEntries":[{"entry":"MATLAB","subEntry":{"value":"norm","kind":"entry"},"emphasis":true}],"label":"index-BP40g5ymDN","identifier":"index-bp40g5ymdn","html_id":"index-bp40g5ymdn","key":"ejvcHQTXKJ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"infnorm = norm(x, Inf)","key":"rMlfqpPo6a"},{"type":"output","id":"NFhNXqO4ICKacklqzhT10","data":[{"output_type":"execute_result","execution_count":102,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>infnorm = \n     3\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"infnorm = \n     3\n","content_type":"text/plain"}}}],"key":"VndxaxEofo"}],"key":"D5vtm1Pe2e"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"onenorm = norm(x, 1)","key":"raJjQZaktD"},{"type":"output","id":"0ostFZQF_pnGirQtEJ9uA","data":[{"output_type":"execute_result","execution_count":103,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>onenorm = \n     7\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"onenorm = \n     7\n","content_type":"text/plain"}}}],"key":"QjUW0HohIL"}],"key":"DOjv9ED2Kf"}],"label":"demo-norms-vector-matlab","identifier":"demo-norms-vector-matlab","html_id":"demo-norms-vector-matlab","key":"QJf6JO5AX6"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-norms-matrix","label":"demo-norms-matrix","kind":"proof:example","position":{"start":{"line":1017,"column":1},"end":{"line":1017,"column":19}},"children":[{"type":"text","value":"Example ","key":"vuLfdqsi9Z"},{"type":"text","value":"2.7.2","key":"uBzjknxGwv"}],"template":"Example %s","enumerator":"2.7.2","resolved":true,"html_id":"demo-norms-matrix","remote":true,"url":"/norms","dataUrl":"/norms.json","key":"cBRMcc2jKF"}],"key":"Ea5ll0pkCJ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A = [ 2 0; 1 -1 ]","key":"L0nr7K9hy4"},{"type":"output","id":"MhBRC8y4q9KL9K-j_AmhZ","data":[{"output_type":"execute_result","execution_count":104,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>A = 2×2 double\n     2     0\n     1    -1\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"A = 2×2 double\n     2     0\n     1    -1\n","content_type":"text/plain"}}}],"key":"agnKxxaWqE"}],"key":"givooJMnv5"},{"type":"paragraph","position":{"start":{"line":1027,"column":1},"end":{"line":1027,"column":1}},"children":[{"type":"text","value":"The default matrix norm is the 2-norm.","position":{"start":{"line":1027,"column":1},"end":{"line":1027,"column":1}},"key":"UkZMh0hD35"}],"indexEntries":[{"entry":"MATLAB","subEntry":{"value":"norm","kind":"entry"},"emphasis":true}],"label":"index-PMcdgp0qLj","identifier":"index-pmcdgp0qlj","html_id":"index-pmcdgp0qlj","key":"cTmvjw46kc"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"twonorm = norm(A)","key":"P7uS3wzWRT"},{"type":"output","id":"GXZwn6Tjlo_fiLsNdONqI","data":[{"output_type":"execute_result","execution_count":105,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>twonorm = \n   2.2882e+00\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"twonorm = \n   2.2882e+00\n","content_type":"text/plain"}}}],"key":"SiYzNISUiN"}],"key":"ZjjT3Q55qN"},{"type":"paragraph","position":{"start":{"line":1033,"column":1},"end":{"line":1033,"column":1}},"children":[{"type":"text","value":"You can get the 1-norm as well.","position":{"start":{"line":1033,"column":1},"end":{"line":1033,"column":1}},"key":"BNslSs7C1B"}],"key":"pnDxmHPToZ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"onenorm = norm(A, 1)","key":"mMk3HxH0WW"},{"type":"output","id":"VbzBvuSJ4D-gJwvMhQl0v","data":[{"output_type":"execute_result","execution_count":106,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>onenorm = \n     3\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"onenorm = \n     3\n","content_type":"text/plain"}}}],"key":"vhJF42N587"}],"key":"uMMnDGUxPY"},{"type":"paragraph","position":{"start":{"line":1042,"column":1},"end":{"line":1042,"column":1}},"children":[{"type":"text","value":"According to ","position":{"start":{"line":1042,"column":1},"end":{"line":1042,"column":1}},"key":"NKexmGVYdM"},{"type":"crossReference","kind":"equation","identifier":"mxonenorm","label":"mxonenorm","children":[{"type":"text","value":"(","key":"o4qSePi6ET"},{"type":"text","value":"2.7.15","key":"Y9Q5s0VZzH"},{"type":"text","value":")","key":"z2IMANZbs0"}],"template":"(%s)","enumerator":"2.7.15","resolved":true,"html_id":"mxonenorm","remote":true,"url":"/norms","dataUrl":"/norms.json","key":"fA8DCfuiSw"},{"type":"text","value":", the matrix 1-norm is equivalent to the maximum of the sums down the columns (in absolute value).","position":{"start":{"line":1042,"column":1},"end":{"line":1042,"column":1}},"key":"x6ykLBGJ1j"}],"indexEntries":[{"entry":"MATLAB","subEntry":{"value":"max","kind":"entry"},"emphasis":true},{"entry":"MATLAB","subEntry":{"value":"sum","kind":"entry"},"emphasis":true}],"label":"index-hFN2WjWg26","identifier":"index-hfn2wjwg26","html_id":"index-hfn2wjwg26","key":"ku4C7YeGv9"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"WWcE8P02WG"}],"key":"O85UgbpYdd"},{"type":"paragraph","position":{"start":{"line":1045,"column":1},"end":{"line":1045,"column":1}},"children":[{"type":"text","value":"Use ","position":{"start":{"line":1045,"column":1},"end":{"line":1045,"column":1}},"key":"e1e89LZK1a"},{"type":"inlineCode","value":"sum","position":{"start":{"line":1045,"column":1},"end":{"line":1045,"column":1}},"key":"f2xKCph67F"},{"type":"text","value":" to sum along a dimension of a matrix. The ","position":{"start":{"line":1045,"column":1},"end":{"line":1045,"column":1}},"key":"CuP0w2PuMB"},{"type":"inlineCode","value":"max","position":{"start":{"line":1045,"column":1},"end":{"line":1045,"column":1}},"key":"xKj8pWuDz1"},{"type":"text","value":" and ","position":{"start":{"line":1045,"column":1},"end":{"line":1045,"column":1}},"key":"fz2WxOaLKh"},{"type":"inlineCode","value":"min","position":{"start":{"line":1045,"column":1},"end":{"line":1045,"column":1}},"key":"RVP3a9AOsw"},{"type":"text","value":" functions also work along one dimension.","position":{"start":{"line":1045,"column":1},"end":{"line":1045,"column":1}},"key":"WV2NmqXnhK"}],"key":"eoQOCE0EQ8"}],"class":"dropdown","key":"rHyMCYBAVe"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"% Sum down the rows (1st matrix dimension):\nmax( sum(abs(A), 1) )","key":"r8TplHaoyq"},{"type":"output","id":"FvFlGUWnYLRhD9uU2bAq3","data":[{"output_type":"execute_result","execution_count":107,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = \n     3\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = \n     3\n","content_type":"text/plain"}}}],"key":"oWjozqFygh"}],"key":"PKKQicULPA"},{"type":"paragraph","position":{"start":{"line":1053,"column":1},"end":{"line":1053,"column":1}},"children":[{"type":"text","value":"Similarly, we can get the ","position":{"start":{"line":1053,"column":1},"end":{"line":1053,"column":1}},"key":"UrT5hhgOgF"},{"type":"text","value":"∞","position":{"start":{"line":1053,"column":1},"end":{"line":1053,"column":1}},"key":"Qilpjdov9g"},{"type":"text","value":"-norm and check our formula for it.","position":{"start":{"line":1053,"column":1},"end":{"line":1053,"column":1}},"key":"kj0j7VRVeh"}],"key":"gj5DoOBEyG"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"infnorm = norm(A, Inf)","key":"oBxseNn5am"},{"type":"output","id":"w7VuUj3LMfU8oWOrys7EI","data":[{"output_type":"execute_result","execution_count":108,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>infnorm = \n     2\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"infnorm = \n     2\n","content_type":"text/plain"}}}],"key":"QkWr7mdnx1"}],"key":"T0wbI8h1rF"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"% Sum across columns (2nd matrix dimension):\nmax( sum(abs(A), 2) )","key":"sPzyA8V4IW"},{"type":"output","id":"3VXmc9aS6BW7kJHC-pBgw","data":[{"output_type":"execute_result","execution_count":109,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = \n     2\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = \n     2\n","content_type":"text/plain"}}}],"key":"G4zXv2rCa8"}],"key":"T4VFi1CVNR"},{"type":"paragraph","position":{"start":{"line":1063,"column":1},"end":{"line":1063,"column":1}},"children":[{"type":"text","value":"Next we illustrate a geometric interpretation of the 2-norm. First, we will sample a lot of vectors on the unit circle in ","position":{"start":{"line":1063,"column":1},"end":{"line":1063,"column":1}},"key":"RLjUCt0G9Y"},{"type":"inlineMath","value":"\\mathbb{R}^2","position":{"start":{"line":1063,"column":1},"end":{"line":1063,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi mathvariant=\"double-struck\">R</mi><mn>2</mn></msup></mrow><annotation encoding=\"application/x-tex\">\\mathbb{R}^2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathbb\">R</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span>","key":"sI9HSvbMSy"},{"type":"text","value":".","position":{"start":{"line":1063,"column":1},"end":{"line":1063,"column":1}},"key":"G0l9JNdO81"}],"key":"RBH1ITcJrw"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"LVMwSIXcIU"}],"key":"R2mUTggCjH"},{"type":"paragraph","position":{"start":{"line":1066,"column":1},"end":{"line":1066,"column":1}},"children":[{"type":"text","value":"You can use functions as values, e.g., as elements of a vector.","position":{"start":{"line":1066,"column":1},"end":{"line":1066,"column":1}},"key":"ZPL6XaXHtO"}],"key":"tEB6phzotn"}],"class":"dropdown","key":"wwFe9D5mn2"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"theta = linspace(0, 2*pi, 601);\nx = [ cos(theta); sin(theta) ];    % 601 unit column vectors\nclf\nsubplot(1, 2, 1)\nplot(x(1, :), x(2, :)), axis equal\ntitle('Unit circle in 2-norm')\nxlabel('x_1')\nylabel(('x_2'));","key":"ValLsDdsBf"},{"type":"output","id":"j2euiqolXgY7dYiadpwPI","data":[{"output_type":"execute_result","execution_count":110,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"0e92adc3da14a806186ee451025e3b86","path":"/build/0e92adc3da14a806186ee451025e3b86.png"}}}],"key":"mNQ5xDlFfy"}],"indexEntries":[{"entry":"MATLAB","subEntry":{"value":"subplot","kind":"entry"},"emphasis":true}],"label":"index-GChYZVoVt3","identifier":"index-gchyzvovt3","html_id":"index-gchyzvovt3","key":"gtrpcitK2H"},{"type":"paragraph","position":{"start":{"line":1083,"column":1},"end":{"line":1083,"column":1}},"children":[{"type":"text","value":"The linear function ","position":{"start":{"line":1083,"column":1},"end":{"line":1083,"column":1}},"key":"jDFiIu0ZVl"},{"type":"inlineMath","value":"\\mathbf{f}(\\mathbf{x}) = \\mathbf{A}\\mathbf{x}","position":{"start":{"line":1083,"column":1},"end":{"line":1083,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">f</mi><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi mathvariant=\"bold\">A</mi><mi mathvariant=\"bold\">x</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{f}(\\mathbf{x}) = \\mathbf{A}\\mathbf{x}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.10903em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathbf\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">Ax</span></span></span></span>","key":"TLzlN2VziN"},{"type":"text","value":" defines a mapping from ","position":{"start":{"line":1083,"column":1},"end":{"line":1083,"column":1}},"key":"y5XWRY7tWK"},{"type":"inlineMath","value":"\\mathbb{R}^2","position":{"start":{"line":1083,"column":1},"end":{"line":1083,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi mathvariant=\"double-struck\">R</mi><mn>2</mn></msup></mrow><annotation encoding=\"application/x-tex\">\\mathbb{R}^2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathbb\">R</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span>","key":"HCdrmmU46b"},{"type":"text","value":" to ","position":{"start":{"line":1083,"column":1},"end":{"line":1083,"column":1}},"key":"yRiywLFqGF"},{"type":"inlineMath","value":"\\mathbb{R}^2","position":{"start":{"line":1083,"column":1},"end":{"line":1083,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi mathvariant=\"double-struck\">R</mi><mn>2</mn></msup></mrow><annotation encoding=\"application/x-tex\">\\mathbb{R}^2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathbb\">R</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span>","key":"fMEcmVIKLu"},{"type":"text","value":". We can apply ","position":{"start":{"line":1083,"column":1},"end":{"line":1083,"column":1}},"key":"DjpvfVnAcQ"},{"type":"inlineCode","value":"A","position":{"start":{"line":1083,"column":1},"end":{"line":1083,"column":1}},"key":"utYa4jKwC8"},{"type":"text","value":" to every column of ","position":{"start":{"line":1083,"column":1},"end":{"line":1083,"column":1}},"key":"BhgCVFnbpm"},{"type":"inlineCode","value":"x","position":{"start":{"line":1083,"column":1},"end":{"line":1083,"column":1}},"key":"FoSPtec2qX"},{"type":"text","value":" by using a single matrix multiplication.","position":{"start":{"line":1083,"column":1},"end":{"line":1083,"column":1}},"key":"ZyY3n2pUJI"}],"key":"ugyABjRihE"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"Ax = A * x;","key":"QMaEDrwMT3"},{"type":"output","id":"u1rsqb12TEcVdv4fmrjLN","data":[],"key":"qiNNEse77A"}],"key":"W0u1RqX33H"},{"type":"paragraph","position":{"start":{"line":1089,"column":1},"end":{"line":1089,"column":1}},"children":[{"type":"text","value":"The image of the transformed vectors is an ellipse that just touches the circle of radius ","position":{"start":{"line":1089,"column":1},"end":{"line":1089,"column":1}},"key":"AYouLHbied"},{"type":"inlineMath","value":"\\|\\mathbf{A}\\|_2","position":{"start":{"line":1089,"column":1},"end":{"line":1089,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">∥</mi><mi mathvariant=\"bold\">A</mi><msub><mi mathvariant=\"normal\">∥</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\|\\mathbf{A}\\|_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">∥</span><span class=\"mord mathbf\">A</span><span class=\"mord\"><span class=\"mord\">∥</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"KJcCdLxSvF"},{"type":"text","value":":","position":{"start":{"line":1089,"column":1},"end":{"line":1089,"column":1}},"key":"WOJuyXxea2"}],"key":"IMzG88naVp"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"subplot(1,2,2), plot(Ax(1,:), Ax(2,:)), axis equal\nhold on, plot(twonorm * x(1,:), twonorm * x(2,:), '--')\ntitle('Image of Ax, with ||A||')\nxlabel('x_1')\nylabel(('x_2'));","key":"yayHytZSS6"},{"type":"output","id":"RulJjeInjhUe1hg5NkMMn","data":[{"output_type":"execute_result","execution_count":112,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"774e79654b2faf08eec5cd2c2f1e3a95","path":"/build/774e79654b2faf08eec5cd2c2f1e3a95.png"}}}],"key":"ZLfcnalCbp"}],"key":"Fm2U8PR6sg"}],"label":"demo-norms-matrix-matlab","identifier":"demo-norms-matrix-matlab","html_id":"demo-norms-matrix-matlab","key":"UXqUnINrax"},{"type":"heading","depth":3,"position":{"start":{"line":1101,"column":1},"end":{"line":1101,"column":1}},"children":[{"type":"text","value":"2.8 ","position":{"start":{"line":1101,"column":1},"end":{"line":1101,"column":1}},"key":"zqt4L9ronO"},{"type":"link","identifier":"section-linsys-condition-number","label":"section-linsys-condition-number","kind":"narrative","position":{"start":{"line":1101,"column":5},"end":{"line":1101,"column":37}},"url":"/condition-number","internal":true,"dataUrl":"/condition-number.json","children":[{"type":"text","value":"Conditioning of linear systems","key":"Rc7tKvmqjC"}],"key":"wZJOqy5O3g"}],"identifier":"id-2-8","label":"2.8 ","html_id":"id-2-8","implicit":true,"key":"DVUkUpFEP8"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-condition-bound","label":"demo-condition-bound","kind":"proof:example","position":{"start":{"line":1103,"column":1},"end":{"line":1103,"column":22}},"children":[{"type":"text","value":"Example ","key":"TxCQ2eykhA"},{"type":"text","value":"2.8.1","key":"TZ5t57UD0K"}],"template":"Example %s","enumerator":"2.8.1","resolved":true,"html_id":"demo-condition-bound","remote":true,"url":"/condition-number","dataUrl":"/condition-number.json","key":"jBrw66gLZD"}],"key":"uJqyvRECmd"},{"type":"paragraph","position":{"start":{"line":1108,"column":1},"end":{"line":1108,"column":1}},"children":[{"type":"text","value":"MATLAB has a function ","position":{"start":{"line":1108,"column":1},"end":{"line":1108,"column":1}},"key":"AIpPMNKUz0"},{"type":"inlineCode","value":"cond","position":{"start":{"line":1108,"column":1},"end":{"line":1108,"column":1}},"key":"vb50Lt9LHH"},{"type":"text","value":" to compute matrix condition numbers. By default, the 2-norm is used. As an example, the family of ","position":{"start":{"line":1108,"column":1},"end":{"line":1108,"column":1}},"key":"wxNtazEVdv"},{"type":"emphasis","position":{"start":{"line":1108,"column":1},"end":{"line":1108,"column":1}},"children":[{"type":"text","value":"Hilbert matrices","position":{"start":{"line":1108,"column":1},"end":{"line":1108,"column":1}},"key":"ElTcNDgrT1"}],"key":"U1HyDQ7zip"},{"type":"text","value":" is famously badly conditioned. Here is the ","position":{"start":{"line":1108,"column":1},"end":{"line":1108,"column":1}},"key":"MfHDMUYe5w"},{"type":"inlineMath","value":"6\\times 6","position":{"start":{"line":1108,"column":1},"end":{"line":1108,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>6</mn><mo>×</mo><mn>6</mn></mrow><annotation encoding=\"application/x-tex\">6\\times 6</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">6</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">6</span></span></span></span>","key":"pUN55M2r67"},{"type":"text","value":" case.","position":{"start":{"line":1108,"column":1},"end":{"line":1108,"column":1}},"key":"y40UXinLH3"}],"indexEntries":[{"entry":"MATLAB","subEntry":{"value":"cond","kind":"entry"},"emphasis":true}],"label":"index-j4wBkiqIeI","identifier":"index-j4wbkiqiei","html_id":"index-j4wbkiqiei","key":"s4AjSEZv6Y"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A = hilb(6)\nkappa = cond(A)","key":"KVB6zxdRnS"},{"type":"output","id":"5WgPpV9NfV_xOf_-vMwMF","data":[{"output_type":"execute_result","execution_count":113,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>A = 6×6 double\n   1.0000e+00   5.0000e-01   3.3333e-01   2.5000e-01   2.0000e-01   1.6667e-01\n   5.0000e-01   3.3333e-01   2.5000e-01   2.0000e-01   1.6667e-01   1.4286e-01\n   3.3333e-01   2.5000e-01   2.0000e-01   1.6667e-01   1.4286e-01   1.2500e-01\n   2.5000e-01   2.0000e-01   1.6667e-01   1.4286e-01   1.2500e-01   1.1111e-01\n   2.0000e-01   1.6667e-01   1.4286e-01   1.2500e-01   1.1111e-01   1.0000e-01\n   1.6667e-01   1.4286e-01   1.2500e-01   1.1111e-01   1.0000e-01   9.0909e-02\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"A = 6×6 double\n   1.0000e+00   5.0000e-01   3.3333e-01   2.5000e-01   2.0000e-01   1.6667e-01\n   5.0000e-01   3.3333e-01   2.5000e-01   2.0000e-01   1.6667e-01   1.4286e-01\n   3.3333e-01   2.5000e-01   2.0000e-01   1.6667e-01   1.4286e-01   1.2500e-01\n   2.5000e-01   2.0000e-01   1.6667e-01   1.4286e-01   1.2500e-01   1.1111e-01\n   2.0000e-01   1.6667e-01   1.4286e-01   1.2500e-01   1.1111e-01   1.0000e-01\n   1.6667e-01   1.4286e-01   1.2500e-01   1.1111e-01   1.0000e-01   9.0909e-02\n","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":113,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>kappa = \n   1.4951e+07\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"kappa = \n   1.4951e+07\n","content_type":"text/plain"}}}],"key":"VI0s7WaEi8"}],"key":"KSh89wzWh4"},{"type":"paragraph","position":{"start":{"line":1115,"column":1},"end":{"line":1115,"column":1}},"children":[{"type":"text","value":"Because ","position":{"start":{"line":1115,"column":1},"end":{"line":1115,"column":1}},"key":"bJVViZpHjX"},{"type":"inlineMath","value":"\\kappa\\approx 10^8","position":{"start":{"line":1115,"column":1},"end":{"line":1115,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>κ</mi><mo>≈</mo><mn>1</mn><msup><mn>0</mn><mn>8</mn></msup></mrow><annotation encoding=\"application/x-tex\">\\kappa\\approx 10^8</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4831em;\"></span><span class=\"mord mathnormal\">κ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">8</span></span></span></span></span></span></span></span></span></span></span>","key":"HgrL10wgcU"},{"type":"text","value":", it’s possible to lose nearly 8 digits of accuracy in the process of passing from ","position":{"start":{"line":1115,"column":1},"end":{"line":1115,"column":1}},"key":"jBLAi4SlSL"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":1115,"column":1},"end":{"line":1115,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"pAKHtfw7yO"},{"type":"text","value":" and ","position":{"start":{"line":1115,"column":1},"end":{"line":1115,"column":1}},"key":"WktC2smH2V"},{"type":"inlineMath","value":"\\mathbf{b}","position":{"start":{"line":1115,"column":1},"end":{"line":1115,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"g7uh20dfUn"},{"type":"text","value":" to ","position":{"start":{"line":1115,"column":1},"end":{"line":1115,"column":1}},"key":"A001yIsCNQ"},{"type":"inlineMath","value":"\\mathbf{x}","position":{"start":{"line":1115,"column":1},"end":{"line":1115,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">x</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{x}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4444em;\"></span><span class=\"mord mathbf\">x</span></span></span></span>","key":"skvVaXz3xk"},{"type":"text","value":". That fact is independent of the algorithm; it’s inevitable once the data are expressed in finite precision.","position":{"start":{"line":1115,"column":1},"end":{"line":1115,"column":1}},"key":"Y0wEnGHMmz"}],"key":"t9ogiYmyQs"},{"type":"paragraph","position":{"start":{"line":1117,"column":1},"end":{"line":1117,"column":1}},"children":[{"type":"text","value":"Let’s engineer a linear system problem to observe the effect of a perturbation. We will make sure we know the exact answer.","position":{"start":{"line":1117,"column":1},"end":{"line":1117,"column":1}},"key":"GLRzKiV0DE"}],"key":"E2pNlI22dk"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"x = (1:6)';\nb = A * x;","key":"N6aNzzatpV"},{"type":"output","id":"diK9SOTftY9kY-tPLWr7Z","data":[],"key":"dGJysAmpOU"}],"key":"OvX0VFfUJt"},{"type":"paragraph","position":{"start":{"line":1124,"column":1},"end":{"line":1124,"column":1}},"children":[{"type":"text","value":"Now we perturb the system matrix and vector randomly by ","position":{"start":{"line":1124,"column":1},"end":{"line":1124,"column":1}},"key":"z29D0Yn9NZ"},{"type":"span","position":{"start":{"line":1124,"column":1},"end":{"line":1124,"column":1}},"children":[{"type":"text","value":"10","key":"jdNEaRFuEm"},{"type":"superscript","children":[{"type":"text","value":"-10","key":"qN76kwEcWT"}],"key":"Jfw7XX0ibb"}],"key":"VqEunLCEqr"},{"type":"text","value":" in norm.","position":{"start":{"line":1124,"column":1},"end":{"line":1124,"column":1}},"key":"tzfbnLFddb"}],"key":"s7dRruSPVv"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"dA = randn(size(A));  dA = 1e-10 * (dA / norm(dA));\ndb = randn(size(b));  db = 1e-10 * (db / norm(db));","key":"jpefXRULNo"},{"type":"output","id":"gB8b77__fTdvR6LA15QAb","data":[],"key":"xaePOHk5wD"}],"key":"BmXttGBKRE"},{"type":"paragraph","position":{"start":{"line":1131,"column":1},"end":{"line":1131,"column":1}},"children":[{"type":"text","value":"We solve the perturbed problem using pivoted LU and see how the solution was changed.","position":{"start":{"line":1131,"column":1},"end":{"line":1131,"column":1}},"key":"SREeCfSPgG"}],"key":"iv12ZroH7U"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"new_x = ((A + dA) \\ (b + db));\ndx = new_x - x;","key":"n4D0KJb0SD"},{"type":"output","id":"oqlhi4riUKpeQfg0N8AhB","data":[],"key":"lxXhKtGAG3"}],"key":"UWWTogbHW9"},{"type":"paragraph","position":{"start":{"line":1138,"column":1},"end":{"line":1138,"column":1}},"children":[{"type":"text","value":"Here is the relative error in the solution.","position":{"start":{"line":1138,"column":1},"end":{"line":1138,"column":1}},"key":"Wp1NIyOtil"}],"key":"wuvwXfnxpL"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"relative_error = norm(dx) / norm(x)","key":"VRe7fvI6Qr"},{"type":"output","id":"noUQhlAXNAtSacN-T2wqv","data":[{"output_type":"execute_result","execution_count":117,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>relative_error = \n   5.8831e-05\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"relative_error = \n   5.8831e-05\n","content_type":"text/plain"}}}],"key":"ZvCvgF3rEx"}],"key":"OqnG2rCeyD"},{"type":"paragraph","position":{"start":{"line":1144,"column":1},"end":{"line":1144,"column":1}},"children":[{"type":"text","value":"And here are upper bounds predicted using the condition number of the original matrix.","position":{"start":{"line":1144,"column":1},"end":{"line":1144,"column":1}},"key":"vqJN6I5PFv"}],"key":"X9WCCIEGRJ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"upper_bound_b = (kappa * norm(db) / norm(b))\nupper_bound_A = (kappa * norm(dA) / norm(A))","key":"WqZuCQIU05"},{"type":"output","id":"Kxmq--bOeNKXtQAcfwmQ-","data":[{"output_type":"execute_result","execution_count":118,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>upper_bound_b = \n   1.5810e-04\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"upper_bound_b = \n   1.5810e-04\n","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":118,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>upper_bound_A = \n   9.2353e-04\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"upper_bound_A = \n   9.2353e-04\n","content_type":"text/plain"}}}],"key":"krTa3bjwIQ"}],"key":"VPzrO9vF3e"},{"type":"paragraph","position":{"start":{"line":1151,"column":1},"end":{"line":1151,"column":1}},"children":[{"type":"text","value":"Even if we didn’t make any manual perturbations to the data, machine roundoff does so at the relative level of ","position":{"start":{"line":1151,"column":1},"end":{"line":1151,"column":1}},"key":"xeDa7bD4GV"},{"type":"inlineMath","value":"\\macheps","position":{"start":{"line":1151,"column":1},"end":{"line":1151,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>ϵ</mi><mtext>mach</mtext></msub></mrow><annotation encoding=\"application/x-tex\">\\macheps</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">ϵ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">mach</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"hmBOxTOzjb"},{"type":"text","value":".","position":{"start":{"line":1151,"column":1},"end":{"line":1151,"column":1}},"key":"VuqzIaTwhO"}],"key":"vPWqKawTbq"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"dx = A\\b - x;\nrelative_error = norm(dx) / norm(x)\nrounding_bound = kappa * eps","key":"MAgUMqxxYL"},{"type":"output","id":"YyXHm_2QcLvvIlSp-ukGV","data":[{"output_type":"execute_result","execution_count":119,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>relative_error = \n   4.5027e-11\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"relative_error = \n   4.5027e-11\n","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":119,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>rounding_bound = \n   3.3198e-09\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"rounding_bound = \n   3.3198e-09\n","content_type":"text/plain"}}}],"key":"YIuGvoSL5I"}],"key":"EtnvFVpEIh"},{"type":"paragraph","position":{"start":{"line":1159,"column":1},"end":{"line":1159,"column":1}},"children":[{"type":"text","value":"Larger Hilbert matrices are even more poorly conditioned:","position":{"start":{"line":1159,"column":1},"end":{"line":1159,"column":1}},"key":"qSzWSJ4RhM"}],"key":"AlopSC4HWg"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A = hilb(14);\nkappa = cond(A)","key":"o8l93vFrHB"},{"type":"output","id":"8wYk9YSHvPpLWgfk0ZwgH","data":[{"output_type":"execute_result","execution_count":120,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>kappa = \n   2.4325e+17\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"kappa = \n   2.4325e+17\n","content_type":"text/plain"}}}],"key":"NcZa1qCGg3"}],"key":"euWGweZqy1"},{"type":"paragraph","position":{"start":{"line":1166,"column":1},"end":{"line":1166,"column":1}},"children":[{"type":"text","value":"Note that ","position":{"start":{"line":1166,"column":1},"end":{"line":1166,"column":1}},"key":"n23YxC3cIt"},{"type":"text","value":"κ","position":{"start":{"line":1166,"column":1},"end":{"line":1166,"column":1}},"key":"CNebR7j5aa"},{"type":"text","value":" exceeds ","position":{"start":{"line":1166,"column":1},"end":{"line":1166,"column":1}},"key":"crCY7AIawc"},{"type":"inlineMath","value":"1/\\macheps","position":{"start":{"line":1166,"column":1},"end":{"line":1166,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mi mathvariant=\"normal\">/</mi><msub><mi>ϵ</mi><mtext>mach</mtext></msub></mrow><annotation encoding=\"application/x-tex\">1/\\macheps</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1/</span><span class=\"mord\"><span class=\"mord mathnormal\">ϵ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">mach</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"I6ECmHDnRz"},{"type":"text","value":". In principle we therefore may end up with an answer that has relative error greater than 100%.","position":{"start":{"line":1166,"column":1},"end":{"line":1166,"column":1}},"key":"TFymDlBpoQ"}],"key":"hVLMAyeNlS"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"rounding_bound = kappa * eps","key":"GgGO7lASVa"},{"type":"output","id":"qVVz_6mMGWTvbuEkaK9ZO","data":[{"output_type":"execute_result","execution_count":121,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>rounding_bound = \n   5.4013e+01\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"rounding_bound = \n   5.4013e+01\n","content_type":"text/plain"}}}],"key":"ucQkehoJi8"}],"key":"zI6GWwnLuz"},{"type":"paragraph","position":{"start":{"line":1172,"column":1},"end":{"line":1172,"column":1}},"children":[{"type":"text","value":"Let’s put that prediction to the test.","position":{"start":{"line":1172,"column":1},"end":{"line":1172,"column":1}},"key":"UYGG2R6ZDu"}],"key":"cLxfqvE4Kh"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"x = (1:14)';  b = A * x;\ndx = A\\b - x;\nrelative_error = norm(dx) / norm(x)","key":"RbSV9cDR7U"},{"type":"output","id":"tsFJMp2aeP7NDBplJj93H","data":[{"output_type":"execute_result","execution_count":122,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>relative_error = \n   6.1012e+01\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"relative_error = \n   6.1012e+01\n","content_type":"text/plain"}}}],"key":"AGA5sJChV6"}],"key":"fH3IbI1HNf"},{"type":"paragraph","position":{"start":{"line":1180,"column":1},"end":{"line":1180,"column":1}},"children":[{"type":"text","value":"As anticipated, the solution has zero accurate digits in the 2-norm.","position":{"start":{"line":1180,"column":1},"end":{"line":1180,"column":1}},"key":"t8CgozePy9"}],"key":"wIx8hviJIK"}],"label":"demo-condition-bound-matlab","identifier":"demo-condition-bound-matlab","html_id":"demo-condition-bound-matlab","key":"NFHac1UMkD"},{"type":"heading","depth":3,"position":{"start":{"line":1183,"column":1},"end":{"line":1183,"column":1}},"children":[{"type":"text","value":"2.9 ","position":{"start":{"line":1183,"column":1},"end":{"line":1183,"column":1}},"key":"CJWO4gGBUL"},{"type":"link","identifier":"section-linsys-structure","label":"section-linsys-structure","kind":"narrative","position":{"start":{"line":1183,"column":5},"end":{"line":1183,"column":30}},"url":"/structure","internal":true,"dataUrl":"/structure.json","children":[{"type":"text","value":"Exploiting matrix structure","key":"dFBJTpwwrz"}],"key":"skIvoXbUdC"}],"identifier":"id-2-9","label":"2.9 ","html_id":"id-2-9","implicit":true,"key":"CBM4vUhfsF"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-structure-banded","label":"demo-structure-banded","kind":"proof:example","position":{"start":{"line":1185,"column":1},"end":{"line":1185,"column":23}},"children":[{"type":"text","value":"Example ","key":"fkHlBO7qXL"},{"type":"text","value":"2.9.1","key":"s4K3K2LmeB"}],"template":"Example %s","enumerator":"2.9.1","resolved":true,"html_id":"demo-structure-banded","remote":true,"url":"/structure","dataUrl":"/structure.json","key":"lDS5yQzks0"}],"key":"AO2aTqLx1I"},{"type":"paragraph","position":{"start":{"line":1190,"column":1},"end":{"line":1190,"column":1}},"children":[{"type":"text","value":"Here is a small tridiagonal matrix. Note that there is one fewer element on the super- and subdiagonals than on the main diagonal.","position":{"start":{"line":1190,"column":1},"end":{"line":1190,"column":1}},"key":"M6FomWlvvg"}],"indexEntries":[{"entry":"MATLAB","subEntry":{"value":"fill","kind":"entry"},"emphasis":true},{"entry":"MATLAB","subEntry":{"value":"diagm","kind":"entry"},"emphasis":false},{"entry":"MATLAB","subEntry":{"value":"diag","kind":"entry"},"emphasis":true}],"label":"index-jVVTgneOGO","identifier":"index-jvvtgneogo","html_id":"index-jvvtgneogo","key":"bQVYdGThY4"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A = [ 2 -1  0  0  0  0\n      4  2 -1  0  0  0\n      0  3  0 -1  0  0\n      0  0  2  2 -1  0\n      0  0  0  1  1 -1\n      0  0  0  0  0  2 ];","key":"utYV6wRMLe"},{"type":"output","id":"M_vnwWyw_ZSbbhOQs0X5x","data":[],"key":"UeHNmposDK"}],"key":"sB4B2fbC2J"},{"type":"paragraph","position":{"start":{"line":1204,"column":1},"end":{"line":1204,"column":1}},"children":[{"type":"text","value":"We can extract the elements on any diagonal using the ","position":{"start":{"line":1204,"column":1},"end":{"line":1204,"column":1}},"key":"dPIxvB6Vis"},{"type":"inlineCode","value":"diag","position":{"start":{"line":1204,"column":1},"end":{"line":1204,"column":1}},"key":"SKWX6KqFrJ"},{"type":"text","value":" function. The main or central diagonal is numbered zero, above and to the right of that is positive, and below and to the left is negative.","position":{"start":{"line":1204,"column":1},"end":{"line":1204,"column":1}},"key":"fPNqHMytM6"}],"indexEntries":[{"entry":"MATLAB","subEntry":{"value":"diag","kind":"entry"},"emphasis":true}],"label":"index-yNtZyWAy8F","identifier":"index-yntzyway8f","html_id":"index-yntzyway8f","key":"VvytwSy2rv"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"lABYZLk1IY"}],"key":"KtXvIJXv3N"},{"type":"paragraph","position":{"start":{"line":1207,"column":1},"end":{"line":1207,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":1207,"column":1},"end":{"line":1207,"column":1}},"key":"kMM63wgFBi"},{"type":"inlineCode","value":"diag","position":{"start":{"line":1207,"column":1},"end":{"line":1207,"column":1}},"key":"IoA8TdWfEr"},{"type":"text","value":" function extracts the elements from a specified diagonal of a matrix.","position":{"start":{"line":1207,"column":1},"end":{"line":1207,"column":1}},"key":"QroXeYcXGJ"}],"key":"ne9139013A"}],"class":"dropdown","key":"PXJRTG4MYT"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"diag_main = diag(A, 0)'\ndiag_plusone = diag(A, 1)'\ndiag_minusone = diag(A,-1)'","key":"ANQb9RYcmw"},{"type":"output","id":"qc9yqlTGq9cxDBlVHTwGR","data":[{"output_type":"execute_result","execution_count":124,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>diag_main = 1×6 double\n     2     2     0     2     1     2\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"diag_main = 1×6 double\n     2     2     0     2     1     2\n","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":124,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>diag_plusone = 1×5 double\n    -1    -1    -1    -1    -1\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"diag_plusone = 1×5 double\n    -1    -1    -1    -1    -1\n","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":124,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>diag_minusone = 1×5 double\n     4     3     2     1     0\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"diag_minusone = 1×5 double\n     4     3     2     1     0\n","content_type":"text/plain"}}}],"key":"WAfpGoynWD"}],"key":"a3osC0aTPG"},{"type":"comment","value":"We can also put whatever numbers we like onto any diagonal with `diag`.","position":{"start":{"line":1216,"column":1},"end":{"line":1216,"column":1}},"key":"J9DgTHSXJQ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A = A + diag([5 8 6 7], 2)","key":"RAtY54NwnA"},{"type":"output","id":"AyhVGt-0fMb8yCeg2BC0K","data":[{"output_type":"execute_result","execution_count":125,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>A = 6×6 double\n     2    -1     5     0     0     0\n     4     2    -1     8     0     0\n     0     3     0    -1     6     0\n     0     0     2     2    -1     7\n     0     0     0     1     1    -1\n     0     0     0     0     0     2\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"A = 6×6 double\n     2    -1     5     0     0     0\n     4     2    -1     8     0     0\n     0     3     0    -1     6     0\n     0     0     2     2    -1     7\n     0     0     0     1     1    -1\n     0     0     0     0     0     2\n","content_type":"text/plain"}}}],"key":"WUibZw41Yj"}],"key":"mDmSBxmHzG"},{"type":"paragraph","position":{"start":{"line":1222,"column":1},"end":{"line":1222,"column":1}},"children":[{"type":"text","value":"The lower and upper bandwidths of ","position":{"start":{"line":1222,"column":1},"end":{"line":1222,"column":1}},"key":"SkK2fBARdx"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":1222,"column":1},"end":{"line":1222,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"dv7h5EhJ6R"},{"type":"text","value":" are repeated in the factors from the unpivoted LU factorization.","position":{"start":{"line":1222,"column":1},"end":{"line":1222,"column":1}},"key":"uDf5sk7tko"}],"key":"DGJFqJgLp8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[L, U] = lufact(A)","key":"aLynkubq3J"},{"type":"output","id":"OC74IAVe_Lfi49IAKiutB","data":[{"output_type":"execute_result","execution_count":126,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>L = 6×6 double\n   1.0000e+00            0            0            0            0            0\n   2.0000e+00   1.0000e+00            0            0            0            0\n            0   7.5000e-01   1.0000e+00            0            0            0\n            0            0   2.4242e-01   1.0000e+00            0            0\n            0            0            0   2.7049e-01   1.0000e+00            0\n            0            0            0            0            0   1.0000e+00\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"L = 6×6 double\n   1.0000e+00            0            0            0            0            0\n   2.0000e+00   1.0000e+00            0            0            0            0\n            0   7.5000e-01   1.0000e+00            0            0            0\n            0            0   2.4242e-01   1.0000e+00            0            0\n            0            0            0   2.7049e-01   1.0000e+00            0\n            0            0            0            0            0   1.0000e+00\n","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":126,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>U = 6×6 double\n   2.0000e+00  -1.0000e+00   5.0000e+00            0            0            0\n            0   4.0000e+00  -1.1000e+01   8.0000e+00            0            0\n            0            0   8.2500e+00  -7.0000e+00   6.0000e+00            0\n            0            0            0   3.6970e+00  -2.4545e+00   7.0000e+00\n            0            0            0            0   1.6639e+00  -2.8934e+00\n            0            0            0            0            0   2.0000e+00\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"U = 6×6 double\n   2.0000e+00  -1.0000e+00   5.0000e+00            0            0            0\n            0   4.0000e+00  -1.1000e+01   8.0000e+00            0            0\n            0            0   8.2500e+00  -7.0000e+00   6.0000e+00            0\n            0            0            0   3.6970e+00  -2.4545e+00   7.0000e+00\n            0            0            0            0   1.6639e+00  -2.8934e+00\n            0            0            0            0            0   2.0000e+00\n","content_type":"text/plain"}}}],"key":"Acea0FBp4M"}],"key":"vTbvjIHonc"}],"label":"demo-structure-banded-matlab","identifier":"demo-structure-banded-matlab","html_id":"demo-structure-banded-matlab","key":"GoYiO9AB34"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-structure-symm","label":"demo-structure-symm","kind":"proof:example","position":{"start":{"line":1230,"column":1},"end":{"line":1230,"column":21}},"children":[{"type":"text","value":"Example ","key":"wG2chXAEgY"},{"type":"text","value":"2.9.2","key":"Ygg4v2AaI1"}],"template":"Example %s","enumerator":"2.9.2","resolved":true,"html_id":"demo-structure-symm","remote":true,"url":"/structure","dataUrl":"/structure.json","key":"jLHWWlXdL2"}],"key":"Xem5t6Rtli"},{"type":"paragraph","position":{"start":{"line":1233,"column":1},"end":{"line":1233,"column":1}},"children":[{"type":"text","value":"We begin with a symmetric ","position":{"start":{"line":1233,"column":1},"end":{"line":1233,"column":1}},"key":"Sct2MnqjAU"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":1233,"column":1},"end":{"line":1233,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"cPxAyXD2sd"},{"type":"text","value":".","position":{"start":{"line":1233,"column":1},"end":{"line":1233,"column":1}},"key":"RF8W0K3jd7"}],"key":"GhKbJksRaN"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A_1 = [ 2     4     4     2\n        4     5     8    -5\n        4     8     6     2\n        2    -5     2   -26 ];","key":"Rwiq73piYr"},{"type":"output","id":"7Pl2bsthgIiSb3mkc4o41","data":[],"key":"VylB8WztUX"}],"key":"bqZErfAvFT"},{"type":"paragraph","position":{"start":{"line":1242,"column":1},"end":{"line":1242,"column":1}},"children":[{"type":"text","value":"We won’t use pivoting, so the pivot element is at position (1,1). This will become the first element on the diagonal of ","position":{"start":{"line":1242,"column":1},"end":{"line":1242,"column":1}},"key":"vZzgk9rfaZ"},{"type":"inlineMath","value":"\\mathbf{D}","position":{"start":{"line":1242,"column":1},"end":{"line":1242,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">D</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{D}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">D</span></span></span></span>","key":"Pu0WzPj1FE"},{"type":"text","value":". Then we divide by that pivot to get the first column of ","position":{"start":{"line":1242,"column":1},"end":{"line":1242,"column":1}},"key":"FgmoXsV3ko"},{"type":"inlineMath","value":"\\mathbf{L}","position":{"start":{"line":1242,"column":1},"end":{"line":1242,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">L</span></span></span></span>","key":"i5mbUOG1nb"},{"type":"text","value":".","position":{"start":{"line":1242,"column":1},"end":{"line":1242,"column":1}},"key":"TLAJnDrqZ0"}],"key":"hPIsqn3JuF"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"L = eye(4);\nd = zeros(4, 1);\nd(1) = A_1(1, 1);\nL(:, 1) = A_1(:, 1) / d(1);\nA_2 = A_1 - d(1) * L(:, 1) * L(:, 1)'","key":"FxC4FnNAnj"},{"type":"output","id":"hEr8p9Li3ozyjMDbdRbav","data":[{"output_type":"execute_result","execution_count":128,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>A_2 = 4×4 double\n     0     0     0     0\n     0    -3     0    -9\n     0     0    -2    -2\n     0    -9    -2   -28\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"A_2 = 4×4 double\n     0     0     0     0\n     0    -3     0    -9\n     0     0    -2    -2\n     0    -9    -2   -28\n","content_type":"text/plain"}}}],"key":"cFfxmPLQ6F"}],"key":"JGZFAQ0Nsy"},{"type":"paragraph","position":{"start":{"line":1252,"column":1},"end":{"line":1252,"column":1}},"children":[{"type":"text","value":"We are now set up the same way for the submatrix in rows and columns 2–4.","position":{"start":{"line":1252,"column":1},"end":{"line":1252,"column":1}},"key":"fiW5QijS8j"}],"key":"H2Pj9zpOMf"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"d(2) = A_2(2, 2);\nL(:, 2) = A_2(:, 2) / d(2);\nA_3 = A_2 - d(2) * L(:, 2) * L(:, 2)'","key":"FIIkN4pvoO"},{"type":"output","id":"tEEnN1ZneZiQrDJUh4Q78","data":[{"output_type":"execute_result","execution_count":129,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>A_3 = 4×4 double\n     0     0     0     0\n     0     0     0     0\n     0     0    -2    -2\n     0     0    -2    -1\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"A_3 = 4×4 double\n     0     0     0     0\n     0     0     0     0\n     0     0    -2    -2\n     0     0    -2    -1\n","content_type":"text/plain"}}}],"key":"bb1oF2PZso"}],"key":"e3JWKj9x2f"},{"type":"paragraph","position":{"start":{"line":1260,"column":1},"end":{"line":1260,"column":1}},"children":[{"type":"text","value":"We continue working our way down the diagonal.","position":{"start":{"line":1260,"column":1},"end":{"line":1260,"column":1}},"key":"k1juMQgu1K"}],"key":"GpRuyO2R39"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"d(3) = A_3(3, 3);\nL(:, 3) = A_3(:, 3) / d(3);\nA_4 = A_3 - d(3) * L(:, 3) * L(:, 3)'\nd(4) = A_4(4, 4);\nd\nL","key":"aqB7WUvQVE"},{"type":"output","id":"TVuSpWOjXr2miXZ8D2qbl","data":[{"output_type":"execute_result","execution_count":130,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>A_4 = 4×4 double\n     0     0     0     0\n     0     0     0     0\n     0     0     0     0\n     0     0     0     1\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"A_4 = 4×4 double\n     0     0     0     0\n     0     0     0     0\n     0     0     0     0\n     0     0     0     1\n","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":130,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>d = 4×1 double\n     2\n    -3\n    -2\n     1\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"d = 4×1 double\n     2\n    -3\n    -2\n     1\n","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":130,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>L = 4×4 double\n     1     0     0     0\n     2     1     0     0\n     2     0     1     0\n     1     3     1     1\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"L = 4×4 double\n     1     0     0     0\n     2     1     0     0\n     2     0     1     0\n     1     3     1     1\n","content_type":"text/plain"}}}],"key":"RRGM5Rx2hd"}],"key":"OpJQ7H37lr"},{"type":"paragraph","position":{"start":{"line":1271,"column":1},"end":{"line":1271,"column":1}},"children":[{"type":"text","value":"We have arrived at the desired factorization, which we can validate:","position":{"start":{"line":1271,"column":1},"end":{"line":1271,"column":1}},"key":"mgAIhGB84a"}],"key":"WIK0KiyVFo"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"norm(A_1 - (L * diag(d) * L'))","key":"k5fNueMj2I"},{"type":"output","id":"y00YqzAPzLYcb6j-l4wt4","data":[{"output_type":"execute_result","execution_count":131,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = \n     0\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = \n     0\n","content_type":"text/plain"}}}],"key":"T5NbsR1wtn"}],"key":"PcV8Emm5iD"}],"label":"demo-structure-symm-matlab","identifier":"demo-structure-symm-matlab","html_id":"demo-structure-symm-matlab","key":"i0QPXcqGlX"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-structure-cholesky","label":"demo-structure-cholesky","kind":"proof:example","position":{"start":{"line":1279,"column":1},"end":{"line":1279,"column":25}},"children":[{"type":"text","value":"Example ","key":"gewMZr1V7Y"},{"type":"text","value":"2.9.3","key":"NaSTPQzAcf"}],"template":"Example %s","enumerator":"2.9.3","resolved":true,"html_id":"demo-structure-cholesky","remote":true,"url":"/structure","dataUrl":"/structure.json","key":"HWXQZcu74B"}],"key":"qMRMNew9mM"},{"type":"paragraph","position":{"start":{"line":1281,"column":1},"end":{"line":1281,"column":1}},"children":[{"type":"text","value":"A randomly chosen matrix is extremely unlikely to be symmetric. However, there is a simple way to symmetrize one.","position":{"start":{"line":1281,"column":1},"end":{"line":1281,"column":1}},"key":"a1HGdXvkU8"}],"key":"PdKeNGJOJl"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A = magic(4) + eye(4);\nB = A + A'","key":"REdkFC8DQ6"},{"type":"output","id":"DRjz4cXa4R7d1MEfkc5lT","data":[{"output_type":"execute_result","execution_count":132,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>B = 4×4 double\n    34     7    12    17\n     7    24    17    22\n    12    17    14    27\n    17    22    27     4\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"B = 4×4 double\n    34     7    12    17\n     7    24    17    22\n    12    17    14    27\n    17    22    27     4\n","content_type":"text/plain"}}}],"key":"wbmftfxYoe"}],"key":"NWfjbrMfGC"},{"type":"paragraph","position":{"start":{"line":1291,"column":1},"end":{"line":1291,"column":1}},"children":[{"type":"text","value":"Similarly, a random symmetric matrix is unlikely to be positive definite. The Cholesky algorithm always detects a non-PD matrix by quitting with an error.","position":{"start":{"line":1291,"column":1},"end":{"line":1291,"column":1}},"key":"FDLPhsPEsO"}],"indexEntries":[{"entry":"MATLAB","subEntry":{"value":"chol","kind":"entry"},"emphasis":true}],"label":"index-KHYbxj7lDu","identifier":"index-khybxj7ldu","html_id":"index-khybxj7ldu","key":"sfejUoy4j5"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"Kea6FkAnfL"}],"key":"sJL7rzui9E"},{"type":"paragraph","position":{"start":{"line":1294,"column":1},"end":{"line":1294,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":1294,"column":1},"end":{"line":1294,"column":1}},"key":"qVM6cOeRjq"},{"type":"inlineCode","value":"chol","position":{"start":{"line":1294,"column":1},"end":{"line":1294,"column":1}},"key":"IL7GFauHJP"},{"type":"text","value":" function computes a Cholesky factorization if possible, or throws an error for a non-positive-definite matrix.","position":{"start":{"line":1294,"column":1},"end":{"line":1294,"column":1}},"key":"hdNfTKTCSY"}],"key":"YfjSl1NaO3"}],"class":"dropdown","key":"VJB4g2YEXI"},{"type":"admonition","kind":"warning","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Warning","key":"A7IscPSsF1"}],"key":"hU4Za4t3lI"},{"type":"paragraph","position":{"start":{"line":1298,"column":1},"end":{"line":1298,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":1298,"column":1},"end":{"line":1298,"column":1}},"key":"oWOCpqeLnc"},{"type":"inlineCode","value":"chol","position":{"start":{"line":1298,"column":1},"end":{"line":1298,"column":1}},"key":"ZwZ5rySZ6c"},{"type":"text","value":" function does ","position":{"start":{"line":1298,"column":1},"end":{"line":1298,"column":1}},"key":"aRIpMTx8Eb"},{"type":"emphasis","position":{"start":{"line":1298,"column":1},"end":{"line":1298,"column":1}},"children":[{"type":"text","value":"not","position":{"start":{"line":1298,"column":1},"end":{"line":1298,"column":1}},"key":"mkOWBSABMF"}],"key":"TqHcdwhqZk"},{"type":"text","value":" check for symmetry. It may give a nonsensical result if the input is not symmetric.","position":{"start":{"line":1298,"column":1},"end":{"line":1298,"column":1}},"key":"EH7q8aO2Ms"}],"key":"Og1KPqiKzG"}],"key":"KCB1Ur3Dr3"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"chol(B)    % throws an error","visibility":"show","key":"VGFW9mIo29"},{"type":"output","id":"3ACPTQyPa-ZsRC3PI3jtj","data":[{"output_type":"stream","name":"stderr","text":"Error using chol\nMatrix must be positive definite."}],"visibility":"show","key":"GaNDrTbHb8"}],"data":{"tags":["raises-exception"]},"visibility":"show","key":"kJWOFRcjrO"},{"type":"paragraph","position":{"start":{"line":1306,"column":1},"end":{"line":1306,"column":1}},"children":[{"type":"text","value":"It’s not hard to manufacture an ","key":"ClURRTTQkQ"},{"type":"abbreviation","title":"symmetric positive definite","children":[{"type":"text","value":"SPD","key":"JmXOfwMwHk"}],"key":"qCDt8IqyIQ"},{"type":"text","value":" matrix to try out the Cholesky factorization.","key":"tiYZ5a6o8J"}],"key":"TXrMQoM1Uj"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"B = A' * A;\nR = chol(B)","key":"e0i0JIDniN"},{"type":"output","id":"vdHj6xmCTmFHDPfJO2rUv","data":[{"output_type":"execute_result","execution_count":134,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>R = 4×4 double\n   2.0273e+01   1.0507e+01   1.1049e+01   1.8596e+01\n            0   1.6811e+01   1.5996e+01   2.2973e+00\n            0            0   2.2453e+00  -4.1053e+00\n            0            0            0   3.6133e+00\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"R = 4×4 double\n   2.0273e+01   1.0507e+01   1.1049e+01   1.8596e+01\n            0   1.6811e+01   1.5996e+01   2.2973e+00\n            0            0   2.2453e+00  -4.1053e+00\n            0            0            0   3.6133e+00\n","content_type":"text/plain"}}}],"key":"iotvhCb7XZ"}],"key":"zaosfpeDmt"},{"type":"paragraph","position":{"start":{"line":1313,"column":1},"end":{"line":1313,"column":1}},"children":[{"type":"text","value":"Here we validate the factorization:","position":{"start":{"line":1313,"column":1},"end":{"line":1313,"column":1}},"key":"YR3r2Ae7nQ"}],"key":"YytTXVgyIJ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"norm(R' * R - B) / norm(B)","key":"tEtEpV6tmb"},{"type":"output","id":"SA46WM1j6vQ8BC_nXJqC5","data":[{"output_type":"execute_result","execution_count":135,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = \n   5.6013e-17\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = \n   5.6013e-17\n","content_type":"text/plain"}}}],"key":"TINN5E73PF"}],"key":"HKv1QEhkOS"}],"label":"demo-structure-cholesky-matlab","identifier":"demo-structure-cholesky-matlab","html_id":"demo-structure-cholesky-matlab","key":"QKrLfQAhqW"}],"key":"UxWNr8cB7V"}],"key":"FOjKth7fMi"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Chapter 1","url":"/chapter1-1","group":"MATLAB codes"},"next":{"title":"Chapter 3","url":"/chapter3-1","group":"MATLAB codes"}}},"domain":"http://localhost:3000"}