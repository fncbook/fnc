{"kind":"Notebook","sha256":"cc32e75dce3b12b904234d5e74cbae45060b1d46574145f8b8144e94a5c4cab8","slug":"oregon","location":"/chapter11/section4/julia/oregon.ipynb","dependencies":[],"frontmatter":{"kernelspec":{"name":"julia-1.11","display_name":"Julia 1.11.2","language":"julia"},"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","numbering":{"heading_1":{"enabled":true},"heading_2":{"enabled":true},"heading_3":{"enabled":false}},"math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"exports":[{"format":"ipynb","filename":"oregon.ipynb","url":"/fnc/build/oregon-dc185331534505bc44b0ec6db40a0e8e.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"LW12XmG7Nd"},{"type":"text","value":"11.4.2","key":"AgLE8F7WMa"}],"key":"QX0xIWF2bu"}],"identifier":"demo-stiffness-oregon","label":"demo-stiffness-oregon","kind":"proof:example","template":"Example %s","enumerator":"11.4.2","resolved":true,"html_id":"demo-stiffness-oregon","remote":true,"url":"/stiffness","dataUrl":"/stiffness.json","key":"U0f6rsRUJo"}],"key":"zH1nwzKw7A"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"In ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ST9iQzICYi"},{"type":"crossReference","kind":"proof:example","identifier":"example-stiffness-oregon","label":"example-stiffness-oregon","children":[{"type":"text","value":"Example ","key":"p0UVDHmQZt"},{"type":"text","value":"11.4.1","key":"ODGmrAVidX"}],"template":"Example %s","enumerator":"11.4.1","resolved":true,"html_id":"example-stiffness-oregon","remote":true,"url":"/stiffness","dataUrl":"/stiffness.json","key":"yG5DL2H46b"},{"type":"text","value":" we derived a Jacobian matrix for the Oregonator model. Here is a numerical solution of the ","key":"Ce7f66EEwT"},{"type":"abbreviation","title":"ordinary differential equation","children":[{"type":"text","value":"ODE","key":"mhZbhrORrd"}],"key":"S3atbR8qK7"},{"type":"text","value":".","key":"c8zBryYcyn"}],"key":"qOxQR9vIGr"}],"key":"JU6VKiYP04"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:26:16.131000Z","iopub.status.busy":"2025-01-14T15:24:47.726000Z","iopub.execute_input":"2025-01-14T15:24:49.238000Z","shell.execute_reply":"2025-01-14T15:26:16.116000Z"},"tags":[]},"children":[{"type":"code","lang":"julia","executable":true,"value":"using OrdinaryDiffEq\nfunction ode(u,p,t)\n    s,w,q = p\n    f = [ \n        s * ( u[2]*(1 - u[1]) + u[1]*(1 - q*u[1]) ),\n        (u[3] - u[2] - u[1] * u[2]) / s,   \n        w * (u[1] - u[3])\n        ]\n    return f\nend\ns, w, q = (77.27, .161, 8.375e-6)\noregon = ODEProblem(ode, [1., 2, 3], (0., 500.), [s, w, q])\nsol = solve(oregon)\nplot(sol, yscale=:log10, legend=:none, title=\"Solution of the Oregonator\")","visibility":"hide","key":"dXC3ZgRoKo"},{"type":"output","id":"o1qa5ESYOvh0QQ5gS0rPb","data":[{"output_type":"execute_result","execution_count":2,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"7a2c719d8c3d5d1eb90ed414cf45e906","path":"/fnc/build/7a2c719d8c3d5d1eb90ed414cf45e906.png"},"text/html":{"content_type":"text/html","hash":"051d6e7d0bd2bf06340f00284580e5b8","path":"/fnc/build/051d6e7d0bd2bf06340f00284580e5b8.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"e24fdc8bedbffcf929ce77f82ef36b3c","path":"/fnc/build/e24fdc8bedbffcf929ce77f82ef36b3c.svg"}}}],"visibility":"show","key":"VASWcoAwEc"}],"visibility":"show","key":"yaNpiH0DQE"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"At each value of the numerical solution, we can compute the eigenvalues of the Jacobian. Here we plot all of those eigenvalues in the complex plane.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zgLIMXjTvo"}],"key":"PyU7BT2FjF"}],"key":"rHsullrA9S"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:26:31.544000Z","iopub.status.busy":"2025-01-14T15:26:16.428000Z","iopub.execute_input":"2025-01-14T15:26:16.431000Z","shell.execute_reply":"2025-01-14T15:26:31.539000Z"},"tags":[]},"children":[{"type":"code","lang":"julia","executable":true,"value":"t,u = sol.t[1:2:end], sol.u[1:2:end]\nλ = fill(0.0im, length(t), 3)\nfor (k, u) in enumerate(u)\n    J = [\n    s*(1-u[2]-2q*u[1]) s*(1-u[1])        0 \n         -u[2]/s       -(1+u[1])/s     1/s \n            w               0           -w\n        ]\n    λ[k, :] .= eigvals(J)\nend\n\nscatter(real(λ), imag(λ), t;\n    xaxis=(\"Re(λ)\", 25000*(-5:2:-1)),  ylabel=\"Im(λ)\",  zlabel=\"t\",\n    title=\"Oregonator eigenvalues\")","visibility":"hide","key":"FoFrRKSuDJ"},{"type":"output","id":"vM3oy2acMs8w6xa2X1Y32","data":[{"output_type":"execute_result","execution_count":3,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"4745dc62b5fc61c980f1906cb0eff230","path":"/fnc/build/4745dc62b5fc61c980f1906cb0eff230.png"},"text/html":{"content_type":"text/html","hash":"3e1c8910cbf620299deba22915423470","path":"/fnc/build/3e1c8910cbf620299deba22915423470.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"ab7794f1502241366228e759dc587d46","path":"/fnc/build/ab7794f1502241366228e759dc587d46.svg"}}}],"visibility":"show","key":"j1xIbpLzBP"}],"visibility":"show","key":"FPcrIQlxF7"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"You can see that there is one eigenvalue that ranges over a wide portion of the negative real axis and dominates stability considerations.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bikwYyGjqq"}],"key":"eLUDnkffIs"}],"key":"oScBCCAnsN"}],"key":"GEaJdgvIBS"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Regions","url":"/regions","group":"Chapter 11"},"next":{"title":"Explicit","url":"/explicit","group":"Chapter 11"}}},"domain":"http://localhost:3000"}