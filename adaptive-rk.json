{"version":1,"kind":"Article","sha256":"723120ed016d5d12045b6c2bfcc40ecb5ffd61a444c03331a61b285c40dcce78","slug":"adaptive-rk","location":"/chapter6/adaptive-rk.md","dependencies":[{"url":"/chapter6","label":"function-rk23-julia","kind":"Notebook","slug":"chapter6","location":"/julia/chapter6.md","title":"Chapter 6"},{"url":"/chapter6-1","label":"function-rk23-matlab","kind":"Notebook","slug":"chapter6-1","location":"/matlab/chapter6.md","title":"Chapter 6"},{"url":"/chapter6-2","label":"function-rk23-python","kind":"Notebook","slug":"chapter6-2","location":"/python/chapter6.md","title":"Chapter 6"}],"frontmatter":{"title":"Adaptive Runge–Kutta","numbering":{"heading_1":{"enabled":true},"heading_2":{"enabled":true},"heading_3":{"enabled":false},"enumerator":{"enumerator":"6.5.%s"},"title":{"offset":1}},"content_includes_title":false,"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","TPBVP":"two-point boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"edit_url":"https://github.com/fncbook/fnc/blob/master/chapter6/adaptive-rk.md","exports":[{"format":"md","filename":"adaptive-rk.md","url":"/build/adaptive-rk-20739ae3fff414a6d93f75b7da599ea2.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"The derivation and analysis of methods for initial-value problems usually assumes a fixed step size ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"yJlWj69Xc7"},{"type":"inlineMath","value":"h","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>h</mi></mrow><annotation encoding=\"application/x-tex\">h</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">h</span></span></span></span>","key":"M2qrtClc6C"},{"type":"text","value":". While the error behavior ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"iVwvuKURxG"},{"type":"inlineMath","value":"O(h^p)","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><msup><mi>h</mi><mi>p</mi></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(h^p)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">h</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">p</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"T7PkTLJqln"},{"type":"text","value":" is guaranteed by ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"cRcsZDwK2p"},{"type":"crossReference","kind":"proof:theorem","identifier":"theorem-euler-onestepgte","label":"theorem-euler-onestepGTE","children":[{"type":"text","value":"Theorem ","key":"Hr4DwcVUrZ"},{"type":"text","value":"6.2.1","key":"nTy7xjjKXE"}],"template":"Theorem %s","enumerator":"6.2.1","resolved":true,"html_id":"theorem-euler-onestepgte","remote":true,"url":"/euler","dataUrl":"/euler.json","key":"pWUa1YghiL"},{"type":"text","value":" as ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"hgrKu78WfF"},{"type":"inlineMath","value":"h\\rightarrow 0","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>h</mi><mo>→</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">h\\rightarrow 0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">h</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"RmGiClyWIT"},{"type":"text","value":", this bound comes with an unknowable constant, and it is not very useful as a guide to the numerical value of the error at any particular value of ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"Zj4uenbzEY"},{"type":"inlineMath","value":"h","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>h</mi></mrow><annotation encoding=\"application/x-tex\">h</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">h</span></span></span></span>","key":"TxFqjlqvvv"},{"type":"text","value":". Furthermore, as we saw in ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"Ztra4Nhm9H"},{"type":"link","kind":"numref","identifier":"section-localapprox-adaptive","label":"section-localapprox-adaptive","url":"/adaptive","internal":true,"dataUrl":"/adaptive.json","children":[{"type":"text","value":"Adaptive integration","key":"Gm4Eifv4dC"}],"key":"vUXfwL3fSX"},{"type":"text","value":" for numerical integration, in many problems a fixed step size is far from the most efficient strategy.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"GakukhLoTq"}],"indexEntries":[{"entry":"Runge–Kutta method","emphasis":false}],"label":"index-gdy2I6kXtk","identifier":"index-gdy2i6kxtk","html_id":"index-gdy2i6kxtk","key":"auqYnt4IsI"},{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"In response we will employ the basic strategy of ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"iqBSO9dzhH"},{"type":"link","kind":"numref","identifier":"section-localapprox-adaptive","label":"section-localapprox-adaptive","url":"/adaptive","internal":true,"dataUrl":"/adaptive.json","children":[{"type":"text","value":"Adaptive integration","key":"Lwe1AqvR5w"}],"key":"CRqRnlkUJJ"},{"type":"text","value":": estimate the error and adapt the step size in order to reach an accuracy goal. Unlike the integration problem, though, the “integrand” of an ","key":"Hr6iohoppr"},{"type":"abbreviation","title":"initial-value problem","children":[{"type":"text","value":"IVP","key":"bV2duqyf3E"}],"key":"o9yj2Methe"},{"type":"text","value":" is dependent on the solution itself, so the details differ greatly.","key":"Rwz7HUlfnC"}],"key":"lXg9G5G0PO"},{"type":"heading","depth":2,"position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"Step size prediction","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"Vilf72TuGc"}],"identifier":"step-size-prediction","label":"Step size prediction","html_id":"step-size-prediction","implicit":true,"enumerator":"6.5.1","key":"LFA2ch39tZ"},{"type":"paragraph","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"Suppose that, starting from a given value ","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"es8EhdfZ1k"},{"type":"inlineMath","value":"u_i","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>u</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">u_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"BcqM8CuhCq"},{"type":"text","value":" and using a step size ","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"z4MZ4vvcyJ"},{"type":"inlineMath","value":"h","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>h</mi></mrow><annotation encoding=\"application/x-tex\">h</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">h</span></span></span></span>","key":"Oo2BHOK1t1"},{"type":"text","value":", we run one step of two different RK methods simultaneously: one method with order ","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"uTnj3myPMy"},{"type":"inlineMath","value":"p","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>p</mi></mrow><annotation encoding=\"application/x-tex\">p</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">p</span></span></span></span>","key":"Dp32qy9nlW"},{"type":"text","value":", producing ","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"gjObsafWaH"},{"type":"inlineMath","value":"u_{i+1}","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>u</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding=\"application/x-tex\">u_{i+1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6389em;vertical-align:-0.2083em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span></span></span></span>","key":"ayEUb6q68f"},{"type":"text","value":", and the other method with order ","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"l6LV47znhj"},{"type":"inlineMath","value":"p+1","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>p</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">p+1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"IhCsd4x5pT"},{"type":"text","value":", producing ","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"O2j3CMlWH9"},{"type":"inlineMath","value":"\\tilde{u}_{i+1}","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mover accent=\"true\"><mi>u</mi><mo>~</mo></mover><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding=\"application/x-tex\">\\tilde{u}_{i+1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8762em;vertical-align:-0.2083em;\"></span><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6679em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\">u</span></span><span style=\"top:-3.35em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.2222em;\"><span class=\"mord\">~</span></span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span></span></span></span>","key":"qfMvi2MSNF"},{"type":"text","value":". In most circumstances, we can expect that ","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"kagTiYMPPI"},{"type":"inlineMath","value":"\\tilde{\\mathbf{u}}_{i+1}","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mover accent=\"true\"><mi mathvariant=\"bold\">u</mi><mo>~</mo></mover><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding=\"application/x-tex\">\\tilde{\\mathbf{u}}_{i+1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8896em;vertical-align:-0.2083em;\"></span><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6813em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathbf\">u</span></span><span style=\"top:-3.3634em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.2222em;\"><span class=\"mord\">~</span></span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span></span></span></span>","key":"O8Pkg9H1Rd"},{"type":"text","value":" is a much better approximation to the solution than ","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"iZ3VaziG9q"},{"type":"inlineMath","value":"\\mathbf{u}_{i+1}","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">u</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbf{u}_{i+1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6528em;vertical-align:-0.2083em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span></span></span></span>","key":"nETISXaKsW"},{"type":"text","value":" is. So it seems reasonable to use","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"pDAP7RRjmb"}],"key":"EZc476BcYz"},{"type":"math","value":"E_i(h)=|\\tilde{\\mathbf{u}}_{i+1} - \\mathbf{u}_{i+1}|","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>E</mi><mi>i</mi></msub><mo stretchy=\"false\">(</mo><mi>h</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi mathvariant=\"normal\">∣</mi><msub><mover accent=\"true\"><mi mathvariant=\"bold\">u</mi><mo>~</mo></mover><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>−</mo><msub><mi mathvariant=\"bold\">u</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mi mathvariant=\"normal\">∣</mi></mrow><annotation encoding=\"application/x-tex\">E_i(h)=|\\tilde{\\mathbf{u}}_{i+1} - \\mathbf{u}_{i+1}|</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">h</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">∣</span><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6813em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathbf\">u</span></span><span style=\"top:-3.3634em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.2222em;\"><span class=\"mord\">~</span></span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span><span class=\"mord\">∣</span></span></span></span></span>","enumerator":"6.5.1","key":"t0sRKcuKRW"},{"type":"paragraph","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"as an estimate of the actual local error made by the ","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"iCfQe0xVsb"},{"type":"inlineMath","value":"p","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>p</mi></mrow><annotation encoding=\"application/x-tex\">p</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">p</span></span></span></span>","key":"DDkcXAQNNE"},{"type":"text","value":"th-order method. For a vector ","key":"sSu3HQgbUL"},{"type":"abbreviation","title":"initial-value problem","children":[{"type":"text","value":"IVP","key":"gUGvRinGwV"}],"key":"ssRBy8GGyD"},{"type":"text","value":", we would use a norm rather than an absolute value.","key":"amz0zKwMtV"}],"key":"Xc1cKtuZ4O"},{"type":"comment","value":" If the goal is to keep global error less than some predetermined value, we could decide to accept the new solution value if $E_i$ small enough, and otherwise reject it.[^extrap]\n\n[^extrap]: Even though the estimate $E_i$ is meant to go with the *less* accurate proposed value $\\mathbf{u}_{i+1}$, it's hard to resist the temptation to keep the more accurate value instead, and this is common in practice. ","key":"LVRIRIG5n5"},{"type":"paragraph","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"text","value":"Now we ask: looking back, what step size ","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"FYJ0Mo7jCM"},{"type":"emphasis","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"text","value":"should","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"LlMKnOAxq8"}],"key":"Ujj77XARQB"},{"type":"text","value":" we have taken to meet an error target of size ","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"rRtWJUGbTk"},{"type":"text","value":"ε","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"JX6H7yTO4S"},{"type":"text","value":"? Let’s speculate, given the behavior of local truncation error as ","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"V6OjiOjPNm"},{"type":"inlineMath","value":"h\\rightarrow 0","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>h</mi><mo>→</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">h\\rightarrow 0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">h</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"vIiln6IJcG"},{"type":"text","value":", that ","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"vz5UKayrkJ"},{"type":"inlineMath","value":"E_i(h)\\approx C h^{p+1}","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>E</mi><mi>i</mi></msub><mo stretchy=\"false\">(</mo><mi>h</mi><mo stretchy=\"false\">)</mo><mo>≈</mo><mi>C</mi><msup><mi>h</mi><mrow><mi>p</mi><mo>+</mo><mn>1</mn></mrow></msup></mrow><annotation encoding=\"application/x-tex\">E_i(h)\\approx C h^{p+1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">h</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"mord\"><span class=\"mord mathnormal\">h</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">p</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span></span></span></span>","key":"D0FVPBPyle"},{"type":"text","value":" for an unknown constant ","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"hiTkhZj8kW"},{"type":"inlineMath","value":"C","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>C</mi></mrow><annotation encoding=\"application/x-tex\">C</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span></span></span></span>","key":"yB2pDIlZML"},{"type":"text","value":". If we had used a step size ","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"lJAToikjRL"},{"type":"inlineMath","value":"q h","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>q</mi><mi>h</mi></mrow><annotation encoding=\"application/x-tex\">q h</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"mord mathnormal\">h</span></span></span></span>","key":"DltFwUVUjb"},{"type":"text","value":" for some ","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"z4R6yEnerK"},{"type":"inlineMath","value":"q>0","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>q</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">q&gt;0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7335em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&gt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"T7zVPBIWKN"},{"type":"text","value":", then trivially, we would expect","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"FC6vx6mMg0"}],"key":"S9Lmiv0MKO"},{"type":"math","value":"E_i(qh)\\approx C q^{p+1}h^{p+1}.","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>E</mi><mi>i</mi></msub><mo stretchy=\"false\">(</mo><mi>q</mi><mi>h</mi><mo stretchy=\"false\">)</mo><mo>≈</mo><mi>C</mi><msup><mi>q</mi><mrow><mi>p</mi><mo>+</mo><mn>1</mn></mrow></msup><msup><mi>h</mi><mrow><mi>p</mi><mo>+</mo><mn>1</mn></mrow></msup><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">E_i(qh)\\approx C q^{p+1}h^{p+1}.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"mord mathnormal\">h</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0585em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">p</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\">h</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">p</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mord\">.</span></span></span></span></span>","enumerator":"6.5.2","key":"F5ZcAWW3Ie"},{"type":"paragraph","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"children":[{"type":"text","value":"Our best guess for ","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"Wy1hstu0io"},{"type":"inlineMath","value":"q","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>q</mi></mrow><annotation encoding=\"application/x-tex\">q</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span></span></span></span>","key":"l0jmf8TjK5"},{"type":"text","value":" would therefore be to set ","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"BLjWQ4Z3dS"},{"type":"inlineMath","value":"E_i(qh)\\approx \\epsilon","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>E</mi><mi>i</mi></msub><mo stretchy=\"false\">(</mo><mi>q</mi><mi>h</mi><mo stretchy=\"false\">)</mo><mo>≈</mo><mi>ϵ</mi></mrow><annotation encoding=\"application/x-tex\">E_i(qh)\\approx \\epsilon</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"mord mathnormal\">h</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">ϵ</span></span></span></span>","key":"zyL28zRZw1"},{"type":"text","value":", or","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"uCg1e28X7p"}],"key":"GsCTxM2R7J"},{"type":"math","value":"  q \\approx \\left(\\frac{\\epsilon}{E_i}\\right)^{1/(p+1)}.","label":"adaptRKlocal","identifier":"adaptrklocal","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>q</mi><mo>≈</mo><msup><mrow><mo fence=\"true\">(</mo><mfrac><mi>ϵ</mi><msub><mi>E</mi><mi>i</mi></msub></mfrac><mo fence=\"true\">)</mo></mrow><mrow><mn>1</mn><mi mathvariant=\"normal\">/</mi><mo stretchy=\"false\">(</mo><mi>p</mi><mo>+</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow></msup><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">  q \\approx \\left(\\frac{\\epsilon}{E_i}\\right)^{1/(p+1)}.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6776em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.6779em;vertical-align:-0.95em;\"></span><span class=\"minner\"><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">(</span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.1076em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">ϵ</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">)</span></span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.7279em;\"><span style=\"top:-3.9029em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1/</span><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\">p</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span><span class=\"mclose mtight\">)</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">.</span></span></span></span></span>","enumerator":"6.5.3","html_id":"adaptrklocal","key":"pq4CQJaJUx"},{"type":"paragraph","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"children":[{"type":"text","value":"Perhaps, though, we should aim to control the contribution to ","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"key":"Xm3Uhi3CyQ"},{"type":"emphasis","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"children":[{"type":"text","value":"global","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"key":"di0lr5B1fi"}],"key":"wkOrYoLpWC"},{"type":"text","value":" error, which is closer to ","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"key":"Y9DWwnCcPx"},{"type":"inlineMath","value":"E_i(qh)/(q h)","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>E</mi><mi>i</mi></msub><mo stretchy=\"false\">(</mo><mi>q</mi><mi>h</mi><mo stretchy=\"false\">)</mo><mi mathvariant=\"normal\">/</mi><mo stretchy=\"false\">(</mo><mi>q</mi><mi>h</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">E_i(qh)/(q h)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"mord mathnormal\">h</span><span class=\"mclose\">)</span><span class=\"mord\">/</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"mord mathnormal\">h</span><span class=\"mclose\">)</span></span></span></span>","key":"IFuyLTl5S8"},{"type":"text","value":". Then we end up with","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"key":"pemsfbtBHW"}],"key":"UKCQfodL3a"},{"type":"math","value":"  q \\le \\left(\\frac{\\epsilon}{E_i}\\right)^{1/p}.","label":"adaptRKglobal","identifier":"adaptrkglobal","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>q</mi><mo>≤</mo><msup><mrow><mo fence=\"true\">(</mo><mfrac><mi>ϵ</mi><msub><mi>E</mi><mi>i</mi></msub></mfrac><mo fence=\"true\">)</mo></mrow><mrow><mn>1</mn><mi mathvariant=\"normal\">/</mi><mi>p</mi></mrow></msup><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">  q \\le \\left(\\frac{\\epsilon}{E_i}\\right)^{1/p}.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8304em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.6779em;vertical-align:-0.95em;\"></span><span class=\"minner\"><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">(</span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.1076em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">ϵ</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">)</span></span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.7279em;\"><span style=\"top:-3.9029em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1/</span><span class=\"mord mathnormal mtight\">p</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">.</span></span></span></span></span>","enumerator":"6.5.4","html_id":"adaptrkglobal","key":"foETr7jwBZ"},{"type":"paragraph","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"children":[{"type":"text","value":"Experts have different recommendations about whether to use ","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"key":"i3NHCys5sl"},{"type":"crossReference","kind":"equation","identifier":"adaptrklocal","label":"adaptRKlocal","children":[{"type":"text","value":"(","key":"rBv8NB434W"},{"type":"text","value":"6.5.3","key":"O88RtJnKXJ"},{"type":"text","value":")","key":"UDD7uqYvQs"}],"template":"(%s)","enumerator":"6.5.3","resolved":true,"html_id":"adaptrklocal","key":"UWCAY60qov"},{"type":"text","value":" or ","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"key":"hCJmVexh4I"},{"type":"crossReference","kind":"equation","identifier":"adaptrkglobal","label":"adaptRKglobal","children":[{"type":"text","value":"(","key":"lYi8cIkwNN"},{"type":"text","value":"6.5.4","key":"AaS08Ehf13"},{"type":"text","value":")","key":"WnSYMaCZCv"}],"template":"(%s)","enumerator":"6.5.4","resolved":true,"html_id":"adaptrkglobal","key":"JyDMTiV7lO"},{"type":"text","value":". Even though ","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"key":"N2aiKrY2e9"},{"type":"crossReference","kind":"equation","identifier":"adaptrkglobal","label":"adaptRKglobal","children":[{"type":"text","value":"(","key":"rhTn1MpCAO"},{"type":"text","value":"6.5.4","key":"SxgfrweOZI"},{"type":"text","value":")","key":"eWLUNAytXV"}],"template":"(%s)","enumerator":"6.5.4","resolved":true,"html_id":"adaptrkglobal","key":"CXCT3pP0Xf"},{"type":"text","value":" appears to be more in keeping with our assumptions about global errors, modern practice seems to favor ","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"key":"Bah4zKGY0E"},{"type":"crossReference","kind":"equation","identifier":"adaptrklocal","label":"adaptRKlocal","children":[{"type":"text","value":"(","key":"B2Zl4Kt8rw"},{"type":"text","value":"6.5.3","key":"tfghokirxO"},{"type":"text","value":")","key":"KKF6L5D4ck"}],"template":"(%s)","enumerator":"6.5.3","resolved":true,"html_id":"adaptrklocal","key":"Svz7YAb9gf"},{"type":"text","value":".","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"key":"WI6HZrLJeH"}],"key":"QljYMeYFrT"},{"type":"paragraph","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"children":[{"type":"text","value":"We now have an outline of an algorithm.","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"key":"A1ZMmJZzmk"}],"indexEntries":[{"entry":"adaptivity","subEntry":{"value":"in IVP solver","kind":"entry"},"emphasis":false}],"label":"index-UErOfE8cfx","identifier":"index-uerofe8cfx","html_id":"index-uerofe8cfx","key":"WeEQef0oV5"},{"type":"proof","kind":"algorithm","enumerated":true,"children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Adaptive step size for an ","key":"aBaZYszWYv"},{"type":"abbreviation","title":"initial-value problem","children":[{"type":"text","value":"IVP","key":"XQEfoUDMbT"}],"key":"sGjKQJ5Bsx"}],"key":"QvpfIg2aN0"},{"type":"paragraph","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"children":[{"type":"text","value":"Given a solution estimate ","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"YAxbsLXoUd"},{"type":"inlineMath","value":"u_i","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>u</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">u_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"YSO46DwVXH"},{"type":"text","value":" at ","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"wVEJbiDuOn"},{"type":"inlineMath","value":"t=t_i","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi><mo>=</mo><msub><mi>t</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">t=t_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7651em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"t3EucDyQ6v"},{"type":"text","value":", and a step size ","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"fDM6dVvOZb"},{"type":"inlineMath","value":"h","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>h</mi></mrow><annotation encoding=\"application/x-tex\">h</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">h</span></span></span></span>","key":"XupU2Z1MRS"},{"type":"text","value":", do the following:","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"exIdhR75Oa"}],"key":"EMoL9OYkcW"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":54,"column":1},"end":{"line":57,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"children":[{"type":"text","value":"Produce estimates ","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"key":"SqZgsVHtAi"},{"type":"inlineMath","value":"{u}_{i+1}","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>u</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding=\"application/x-tex\">{u}_{i+1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6389em;vertical-align:-0.2083em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">u</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span></span></span></span>","key":"waFVpBDEqL"},{"type":"text","value":" and ","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"key":"TYwIXSEcF4"},{"type":"inlineMath","value":"\\tilde{u}_{i+1}","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mover accent=\"true\"><mi>u</mi><mo>~</mo></mover><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding=\"application/x-tex\">\\tilde{u}_{i+1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8762em;vertical-align:-0.2083em;\"></span><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6679em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\">u</span></span><span style=\"top:-3.35em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.2222em;\"><span class=\"mord\">~</span></span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span></span></span></span>","key":"EVg96TbneA"},{"type":"text","value":", and estimate the error.","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"key":"CyaapdAnFl"}],"key":"mBeDM0ExQh"},{"type":"listItem","spread":true,"position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"children":[{"type":"text","value":"If the error is small enough, adopt ","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"key":"wTQCTj9jH6"},{"type":"inlineMath","value":"\\tilde{u}_{i+1}","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mover accent=\"true\"><mi>u</mi><mo>~</mo></mover><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding=\"application/x-tex\">\\tilde{u}_{i+1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8762em;vertical-align:-0.2083em;\"></span><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6679em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\">u</span></span><span style=\"top:-3.35em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.2222em;\"><span class=\"mord\">~</span></span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span></span></span></span>","key":"W8dq1tFtle"},{"type":"text","value":" as the solution value at ","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"key":"iE0JuAYoBj"},{"type":"inlineMath","value":"t=t_i+h","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi><mo>=</mo><msub><mi>t</mi><mi>i</mi></msub><mo>+</mo><mi>h</mi></mrow><annotation encoding=\"application/x-tex\">t=t_i+h</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7651em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">h</span></span></span></span>","key":"hVC1jVCEBr"},{"type":"text","value":", then increment ","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"key":"ChdvrJAUpn"},{"type":"inlineMath","value":"i","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span>","key":"Dp1hFpdUWL"},{"type":"text","value":".","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"key":"dlH4tV8pyu"}],"key":"zCjL85r1Lx"},{"type":"listItem","spread":true,"position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"children":[{"type":"text","value":"Replace ","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"key":"AGrQWXSXdT"},{"type":"inlineMath","value":"h","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>h</mi></mrow><annotation encoding=\"application/x-tex\">h</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">h</span></span></span></span>","key":"C8XOtKOsrG"},{"type":"text","value":" by ","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"key":"zpq5p0tKgO"},{"type":"inlineMath","value":"q h","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>q</mi><mi>h</mi></mrow><annotation encoding=\"application/x-tex\">q h</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"mord mathnormal\">h</span></span></span></span>","key":"kM9H91E9gg"},{"type":"text","value":", with ","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"key":"eox8UGjhTn"},{"type":"inlineMath","value":"q","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>q</mi></mrow><annotation encoding=\"application/x-tex\">q</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span></span></span></span>","key":"rUuXwdhxag"},{"type":"text","value":" given by ","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"key":"sa2QyAKVPd"},{"type":"crossReference","kind":"equation","identifier":"adaptrklocal","label":"adaptRKlocal","children":[{"type":"text","value":"(","key":"f4xPscaCd2"},{"type":"text","value":"6.5.3","key":"iM91kx4QWZ"},{"type":"text","value":")","key":"HrBLqOZi4E"}],"template":"(%s)","enumerator":"6.5.3","resolved":true,"html_id":"adaptrklocal","key":"WW8HTPwKMW"},{"type":"text","value":" or ","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"key":"UzFe1GXkRv"},{"type":"crossReference","kind":"equation","identifier":"adaptrkglobal","label":"adaptRKglobal","children":[{"type":"text","value":"(","key":"cnYq9v14k6"},{"type":"text","value":"6.5.4","key":"HmlzqfSVIf"},{"type":"text","value":")","key":"qz79fi4al6"}],"template":"(%s)","enumerator":"6.5.4","resolved":true,"html_id":"adaptrkglobal","key":"JPFx3g66GS"},{"type":"text","value":".","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"key":"rXaj7jBbiX"}],"key":"il5l3PUzj7"},{"type":"listItem","spread":true,"position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"children":[{"type":"text","value":"Repeat until ","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"EHlKUOotvw"},{"type":"inlineMath","value":"t=b","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi><mo>=</mo><mi>b</mi></mrow><annotation encoding=\"application/x-tex\">t=b</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">b</span></span></span></span>","key":"dpwN09gPpW"},{"type":"text","value":".","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"Yb1YptJ5k9"}],"key":"aFFTWL3GP7"}],"key":"KCuKSTymIS"}],"label":"algorithm-adaptive-adapt","identifier":"algorithm-adaptive-adapt","html_id":"algorithm-adaptive-adapt","enumerator":"6.5.1","key":"gPnJ2nagbo"},{"type":"paragraph","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"children":[{"type":"text","value":"Many details remain unspecified at this point, but we first address step 1.","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"key":"SGyTvZ1Cwh"}],"key":"aW6Gm5Zs7U"},{"type":"heading","depth":2,"position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"children":[{"type":"text","value":"Embedded formulas","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"VtkGANd67E"}],"identifier":"embedded-formulas","label":"Embedded formulas","html_id":"embedded-formulas","implicit":true,"enumerator":"6.5.2","key":"ht5KcdapUt"},{"type":"paragraph","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"children":[{"type":"text","value":"Suppose, for example, we choose to use a  pair of second- and third-order RK methods to get the ","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"key":"s3kDCF19L5"},{"type":"inlineMath","value":"\\mathbf{u}_{i+1}","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">u</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbf{u}_{i+1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6528em;vertical-align:-0.2083em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span></span></span></span>","key":"JElx6nxNdO"},{"type":"text","value":" and ","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"key":"FdTFAyuGyj"},{"type":"inlineMath","value":"\\tilde{\\mathbf{u}}_{i+1}","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mover accent=\"true\"><mi mathvariant=\"bold\">u</mi><mo>~</mo></mover><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding=\"application/x-tex\">\\tilde{\\mathbf{u}}_{i+1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8896em;vertical-align:-0.2083em;\"></span><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6813em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathbf\">u</span></span><span style=\"top:-3.3634em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.2222em;\"><span class=\"mord\">~</span></span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span></span></span></span>","key":"WBKbTh7kGO"},{"type":"text","value":" needed in ","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"key":"A4XAIdOs00"},{"type":"crossReference","kind":"proof:algorithm","identifier":"algorithm-adaptive-adapt","label":"algorithm-adaptive-adapt","children":[{"type":"text","value":"Algorithm ","key":"ii7JjnOHoM"},{"type":"text","value":"6.5.1","key":"JdGJjWKdXM"}],"template":"Algorithm %s","enumerator":"6.5.1","resolved":true,"html_id":"algorithm-adaptive-adapt","key":"dqalRo7ZPi"},{"type":"text","value":". Then we seem to need at least ","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"key":"bZNc1bzs6B"},{"type":"inlineMath","value":"2+3=5","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>2</mn><mo>+</mo><mn>3</mn><mo>=</mo><mn>5</mn></mrow><annotation encoding=\"application/x-tex\">2+3=5</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">2</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">3</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">5</span></span></span></span>","key":"QXJ4skjpir"},{"type":"text","value":" evaluations of ","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"key":"nRle4reIea"},{"type":"inlineMath","value":"f(t,y)","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><mi>t</mi><mo separator=\"true\">,</mo><mi>y</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">f(t,y)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span></span></span></span>","key":"FKWfNN9Mgb"},{"type":"text","value":" for each attempted time step. This is more than double the computational work needed by the second-order method without adaptivity.","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"key":"ERaQSHXMJk"}],"key":"Owf10LkAI8"},{"type":"paragraph","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"children":[{"type":"text","value":"Fortunately, the marginal cost of adaptivity can be substantially reduced by using ","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"hQg5gSNhDF"},{"type":"strong","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"children":[{"type":"text","value":"embedded Runge–Kutta","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"iAaJn9A5xy"}],"key":"qXLDT6Ku7Z"},{"type":"text","value":" formulas. Embedded RK formulas are a pair of RK methods whose stages share the same internal ","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"RrkwprGWuS"},{"type":"inlineMath","value":"f","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>","key":"cyIac8lpsV"},{"type":"text","value":" evaluations, combining them differently in order to get estimates of two different orders of accuracy.","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"nAKri7rAlZ"}],"key":"pr9kKeaT3q"},{"type":"paragraph","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"children":[{"type":"text","value":"A good example of an embedded method is the ","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"key":"u75a1W8Ndd"},{"type":"strong","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"children":[{"type":"text","value":"Bogacki–Shampine","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"key":"GNDOSuczmN"}],"key":"Pstsi13Caz"},{"type":"text","value":" (BS23) formula, given by the table","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"key":"cPX9PLh1Ip"}],"key":"zev2Vifwou"},{"type":"math","value":"\\begin{array}{r|cccc}\n0                  & \\rule{0pt}{2.75ex} &                    &                    &                    \\\\\n\\frac{1}{2}        & \\frac{1}{2}        & \\rule{0pt}{2.75ex} &                    &                    \\\\\n\\frac{3}{4}        & 0                  & \\frac{3}{4}        & \\rule{0pt}{2.75ex} &                    \\\\\n1                 & \\frac{2}{9}        & \\frac{1}{3}        & \\frac{4}{9}        & \\rule{0pt}{2.75ex} \\\\[2pt] \\hline\n\\rule{0pt}{2.75ex} & \\frac{2}{9}        & \\frac{1}{3}        & \\frac{4}{9}        & 0                  \\\\[2pt] \\hline\n\\rule{0pt}{2.75ex} & \\frac{7}{24}       & \\frac{1}{4}        & \\frac{1}{3}        & \\frac{1}{8}\n\\end{array}","label":"bs23","identifier":"bs23","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mtable rowspacing=\"0.16em\" columnalign=\"right center center center center\" columnlines=\"solid none none none\" columnspacing=\"1em\" rowlines=\"none none none solid solid\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mpadded height=\"0em\" voffset=\"0em\"><mspace mathbackground=\"black\" width=\"0em\" height=\"1.1852em\"></mspace></mpadded></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mfrac><mn>1</mn><mn>2</mn></mfrac></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mfrac><mn>1</mn><mn>2</mn></mfrac></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mpadded height=\"0em\" voffset=\"0em\"><mspace mathbackground=\"black\" width=\"0em\" height=\"1.1852em\"></mspace></mpadded></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mfrac><mn>3</mn><mn>4</mn></mfrac></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mfrac><mn>3</mn><mn>4</mn></mfrac></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mpadded height=\"0em\" voffset=\"0em\"><mspace mathbackground=\"black\" width=\"0em\" height=\"1.1852em\"></mspace></mpadded></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mfrac><mn>2</mn><mn>9</mn></mfrac></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mfrac><mn>1</mn><mn>3</mn></mfrac></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mfrac><mn>4</mn><mn>9</mn></mfrac></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mpadded height=\"0em\" voffset=\"0em\"><mspace mathbackground=\"black\" width=\"0em\" height=\"1.1852em\"></mspace></mpadded></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mpadded height=\"0em\" voffset=\"0em\"><mspace mathbackground=\"black\" width=\"0em\" height=\"1.1852em\"></mspace></mpadded></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mfrac><mn>2</mn><mn>9</mn></mfrac></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mfrac><mn>1</mn><mn>3</mn></mfrac></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mfrac><mn>4</mn><mn>9</mn></mfrac></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>0</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mpadded height=\"0em\" voffset=\"0em\"><mspace mathbackground=\"black\" width=\"0em\" height=\"1.1852em\"></mspace></mpadded></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mfrac><mn>7</mn><mn>24</mn></mfrac></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mfrac><mn>1</mn><mn>4</mn></mfrac></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mfrac><mn>1</mn><mn>3</mn></mfrac></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mfrac><mn>1</mn><mn>8</mn></mfrac></mstyle></mtd></mtr></mtable><annotation encoding=\"application/x-tex\">\\begin{array}{r|cccc}\n0                  &amp; \\rule{0pt}{2.75ex} &amp;                    &amp;                    &amp;                    \\\\\n\\frac{1}{2}        &amp; \\frac{1}{2}        &amp; \\rule{0pt}{2.75ex} &amp;                    &amp;                    \\\\\n\\frac{3}{4}        &amp; 0                  &amp; \\frac{3}{4}        &amp; \\rule{0pt}{2.75ex} &amp;                    \\\\\n1                 &amp; \\frac{2}{9}        &amp; \\frac{1}{3}        &amp; \\frac{4}{9}        &amp; \\rule{0pt}{2.75ex} \\\\[2pt] \\hline\n\\rule{0pt}{2.75ex} &amp; \\frac{2}{9}        &amp; \\frac{1}{3}        &amp; \\frac{4}{9}        &amp; 0                  \\\\[2pt] \\hline\n\\rule{0pt}{2.75ex} &amp; \\frac{7}{24}       &amp; \\frac{1}{4}        &amp; \\frac{1}{3}        &amp; \\frac{1}{8}\n\\end{array}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:9.6715em;vertical-align:-4.5858em;\"></span><span class=\"mord\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:5.0858em;\"><span style=\"top:-7.0857em;\"><span class=\"pstrut\" style=\"height:7.0857em;\"></span><span class=\"mtable\"><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-r\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:5.0857em;\"><span style=\"top:-7.2339em;\"><span class=\"pstrut\" style=\"height:3.3334em;\"></span><span class=\"mord\"><span class=\"mord\">0</span></span></span><span style=\"top:-5.6887em;\"><span class=\"pstrut\" style=\"height:3.3334em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8451em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span><span style=\"top:-4.1434em;\"><span class=\"pstrut\" style=\"height:3.3334em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8451em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">4</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">3</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span><span style=\"top:-2.5982em;\"><span class=\"pstrut\" style=\"height:3.3334em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span><span style=\"top:-0.8529em;\"><span class=\"pstrut\" style=\"height:3.3334em;\"></span><span class=\"mord\"><span class=\"mord rule\" style=\"border-right-width:0em;border-top-width:1.1852em;bottom:0em;\"></span></span></span><span style=\"top:0.8923em;\"><span class=\"pstrut\" style=\"height:3.3334em;\"></span><span class=\"mord\"><span class=\"mord rule\" style=\"border-right-width:0em;border-top-width:1.1852em;bottom:0em;\"></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:4.5858em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"vertical-separator\" style=\"height:9.6715em;border-right-width:0.04em;border-right-style:solid;margin:0 -0.02em;vertical-align:-4.5857em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:5.0857em;\"><span style=\"top:-7.2339em;\"><span class=\"pstrut\" style=\"height:3.3334em;\"></span><span class=\"mord\"><span class=\"mord rule\" style=\"border-right-width:0em;border-top-width:1.1852em;bottom:0em;\"></span></span></span><span style=\"top:-5.6887em;\"><span class=\"pstrut\" style=\"height:3.3334em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8451em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span><span style=\"top:-4.1434em;\"><span class=\"pstrut\" style=\"height:3.3334em;\"></span><span class=\"mord\"><span class=\"mord\">0</span></span></span><span style=\"top:-2.5982em;\"><span class=\"pstrut\" style=\"height:3.3334em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8451em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">9</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span><span style=\"top:-0.8529em;\"><span class=\"pstrut\" style=\"height:3.3334em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8451em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">9</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span><span style=\"top:0.8923em;\"><span class=\"pstrut\" style=\"height:3.3334em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8451em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">24</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">7</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:4.5858em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:5.0857em;\"><span style=\"top:-7.2339em;\"><span class=\"pstrut\" style=\"height:3.3334em;\"></span><span class=\"mord\"></span></span><span style=\"top:-5.6887em;\"><span class=\"pstrut\" style=\"height:3.3334em;\"></span><span class=\"mord\"><span class=\"mord rule\" style=\"border-right-width:0em;border-top-width:1.1852em;bottom:0em;\"></span></span></span><span style=\"top:-4.1434em;\"><span class=\"pstrut\" style=\"height:3.3334em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8451em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">4</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">3</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span><span style=\"top:-2.5982em;\"><span class=\"pstrut\" style=\"height:3.3334em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8451em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">3</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span><span style=\"top:-0.8529em;\"><span class=\"pstrut\" style=\"height:3.3334em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8451em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">3</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span><span style=\"top:0.8923em;\"><span class=\"pstrut\" style=\"height:3.3334em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8451em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">4</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:4.5858em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:5.0857em;\"><span style=\"top:-7.2339em;\"><span class=\"pstrut\" style=\"height:3.3334em;\"></span><span class=\"mord\"></span></span><span style=\"top:-5.6887em;\"><span class=\"pstrut\" style=\"height:3.3334em;\"></span><span class=\"mord\"></span></span><span style=\"top:-4.1434em;\"><span class=\"pstrut\" style=\"height:3.3334em;\"></span><span class=\"mord\"><span class=\"mord rule\" style=\"border-right-width:0em;border-top-width:1.1852em;bottom:0em;\"></span></span></span><span style=\"top:-2.5982em;\"><span class=\"pstrut\" style=\"height:3.3334em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8451em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">9</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">4</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span><span style=\"top:-0.8529em;\"><span class=\"pstrut\" style=\"height:3.3334em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8451em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">9</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">4</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span><span style=\"top:0.8923em;\"><span class=\"pstrut\" style=\"height:3.3334em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8451em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">3</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:4.5858em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:5.0857em;\"><span style=\"top:-7.2339em;\"><span class=\"pstrut\" style=\"height:3.3334em;\"></span><span class=\"mord\"></span></span><span style=\"top:-5.6887em;\"><span class=\"pstrut\" style=\"height:3.3334em;\"></span><span class=\"mord\"></span></span><span style=\"top:-4.1434em;\"><span class=\"pstrut\" style=\"height:3.3334em;\"></span><span class=\"mord\"></span></span><span style=\"top:-2.5982em;\"><span class=\"pstrut\" style=\"height:3.3334em;\"></span><span class=\"mord\"><span class=\"mord rule\" style=\"border-right-width:0em;border-top-width:1.1852em;bottom:0em;\"></span></span></span><span style=\"top:-0.8529em;\"><span class=\"pstrut\" style=\"height:3.3334em;\"></span><span class=\"mord\"><span class=\"mord\">0</span></span></span><span style=\"top:0.8923em;\"><span class=\"pstrut\" style=\"height:3.3334em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8451em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">8</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:4.5858em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span></span></span><span style=\"top:-4.0452em;\"><span class=\"pstrut\" style=\"height:7.0857em;\"></span><span class=\"hline\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-5.7905em;\"><span class=\"pstrut\" style=\"height:7.0857em;\"></span><span class=\"hline\" style=\"border-bottom-width:0.04em;\"></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:4.5858em;\"><span></span></span></span></span></span></span></span></span></span>","enumerator":"6.5.5","html_id":"bs23","key":"h871uxUiUW"},{"type":"paragraph","position":{"start":{"line":81,"column":1},"end":{"line":81,"column":1}},"children":[{"type":"text","value":"The top part of the table describes four stages in the usual RK fashion. The last two rows describe how to construct a third-order estimate ","position":{"start":{"line":81,"column":1},"end":{"line":81,"column":1}},"key":"rELSLUgfCk"},{"type":"inlineMath","value":"\\tilde{\\mathbf{u}}_{i+1}","position":{"start":{"line":81,"column":1},"end":{"line":81,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mover accent=\"true\"><mi mathvariant=\"bold\">u</mi><mo>~</mo></mover><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding=\"application/x-tex\">\\tilde{\\mathbf{u}}_{i+1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8896em;vertical-align:-0.2083em;\"></span><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6813em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathbf\">u</span></span><span style=\"top:-3.3634em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.2222em;\"><span class=\"mord\">~</span></span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span></span></span></span>","key":"xkjs209mt0"},{"type":"text","value":" and a second-order estimate ","position":{"start":{"line":81,"column":1},"end":{"line":81,"column":1}},"key":"cx6nEik5mq"},{"type":"inlineMath","value":"\\mathbf{u}_{i+1}","position":{"start":{"line":81,"column":1},"end":{"line":81,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">u</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbf{u}_{i+1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6528em;vertical-align:-0.2083em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span></span></span></span>","key":"k4V6yTbxrn"},{"type":"text","value":" by taking different combinations of those stages.","position":{"start":{"line":81,"column":1},"end":{"line":81,"column":1}},"key":"uw7f7a8I92"}],"key":"oX9qh6oKmQ"},{"type":"heading","depth":2,"position":{"start":{"line":83,"column":1},"end":{"line":83,"column":1}},"children":[{"type":"text","value":"Implementation","position":{"start":{"line":83,"column":1},"end":{"line":83,"column":1}},"key":"x1DOzwFfH3"}],"identifier":"implementation","label":"Implementation","html_id":"implementation","implicit":true,"enumerator":"6.5.3","key":"FZym0pTwGc"},{"type":"paragraph","position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"children":[{"type":"text","value":"Our implementation of an embedded second/third-order (RK23) code is given in ","position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"key":"o2eNlvDw3s"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-rk23","label":"function-rk23","children":[{"type":"text","value":"Function ","key":"LkcTfHUWJO"},{"type":"text","value":"6.5.2","key":"ScDaaYM9iL"}],"template":"Algorithm %s","enumerator":"6.5.2","resolved":true,"html_id":"function-rk23","key":"lxxujakdmH"},{"type":"text","value":".","position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"key":"iPIeD5GCtP"}],"key":"MzaH8cEu4Y"},{"type":"proof","kind":"algorithm","enumerated":true,"children":[{"type":"admonitionTitle","children":[{"type":"text","value":"rk23","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"key":"DYfHw4HQc2"}],"key":"ogzgtmpmkb"},{"type":"tabSet","children":[{"type":"tabItem","title":"Julia","sync":"julia","children":[{"type":"embed","source":{"url":"/chapter6","label":"function-rk23-julia","kind":"Notebook","slug":"chapter6","location":"/julia/chapter6.md","title":"Chapter 6"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Adaptive ","key":"dJqt6Viem0"},{"type":"abbreviation","title":"initial-value problem","children":[{"type":"text","value":"IVP","key":"JcUZyJCP4W"}],"key":"F0pVIKr3Fv"},{"type":"text","value":" solver based on embedded RK formulas","key":"xsAELYG60B"}],"key":"EUZCtJWSEn"},{"type":"include","file":"FNCFunctions/src/chapter06.jl","literal":true,"filter":{"startAfter":"# begin rk23","endBefore":"# end rk23"},"children":[{"type":"code","value":"\"\"\"\n    rk23(ivp, tol)\n\nApply an adaptive embedded RK formula pair to solve given IVP with\nestimated error `tol`. Returns a vector of times and a vector of\nsolution values.\n\"\"\"\nfunction rk23(ivp, tol)\n    # Initialize for the first time step.\n    a, b = ivp.tspan\n    t = [a]\n    u = [float(ivp.u0)]\n    i = 1\n    h = 0.5 * tol^(1 / 3)\n    s₁ = ivp.f(ivp.u0, ivp.p, a)\n\n    # Time stepping.\n    while t[i] < b\n        # Detect underflow of the step size.\n        if t[i] + h == t[i]\n            @warn \"Stepsize too small near t=$(t[i])\"\n            break  # quit time stepping loop\n        end\n\n        # New RK stages.\n        s₂ = ivp.f(u[i] + (h / 2) * s₁, ivp.p, t[i] + h / 2)\n        s₃ = ivp.f(u[i] + (3h / 4) * s₂, ivp.p, t[i] + 3h / 4)\n        u_new3 = u[i] + h * (2s₁ + 3s₂ + 4s₃) / 9   # 3rd order solution\n        s₄ = ivp.f(u_new3, ivp.p, t[i] + h)\n        err = h * (-5s₁ / 72 + s₂ / 12 + s₃ / 9 - s₄ / 8)  # 2nd/3rd difference\n        E = norm(err, Inf)                         # error estimate\n        maxerr = tol * (1 + norm(u[i], Inf))     # relative/absolute blend\n\n        # Accept the proposed step?\n        if E < maxerr     # yes\n            push!(t, t[i] + h)\n            push!(u, u_new3)\n            i += 1\n            s₁ = s₄       # use FSAL property\n        end\n\n        # Adjust step size.\n        q = 0.8 * (maxerr / E)^(1 / 3)   # conservative optimal step factor\n        q = min(q, 4)               # limit stepsize growth\n        h = min(q * h, b - t[i])        # don't step past the end\n    end\n    return t, u\nend","lang":"julia","showLineNumbers":true,"filename":"rk23.jl","key":"w7kKM6eprV"}],"key":"y4rrdYezUv"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"About the code","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"key":"yfnQjqs1Yn"}],"key":"Pw1ym9Q1jF"},{"type":"paragraph","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"children":[{"type":"text","value":"The check ","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"o16Ivmbe9U"},{"type":"inlineCode","value":"t[i]+h == t[i]","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"QAbPoPHDTw"},{"type":"text","value":"on line 19 is to detect when ","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"zE3Rqufdta"},{"type":"inlineMath","value":"h","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>h</mi></mrow><annotation encoding=\"application/x-tex\">h</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">h</span></span></span></span>","key":"WoA0P7WaR5"},{"type":"text","value":" has become so small that it no longer changes the floating-point value of ","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"EV2Se90cnx"},{"type":"inlineMath","value":"t_i","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>t</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">t_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7651em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"oCQE6fL6sh"},{"type":"text","value":". This may be a sign that the underlying exact solution has a singularity near ","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"u9zEbKx77Y"},{"type":"inlineMath","value":"t=t_i","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi><mo>=</mo><msub><mi>t</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">t=t_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7651em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"BAC09TNM64"},{"type":"text","value":", but in any case, the solver must halt by using a ","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"vWHy5Yvgwn"},{"type":"inlineCode","value":"break","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"wNTCRRWDz9"},{"type":"text","value":" statement to exit the loop.","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"K3JvDWXICS"}],"key":"t1y3YXbOD3"},{"type":"paragraph","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"children":[{"type":"text","value":"On line 30, we use a combination of absolute and relative tolerances to judge the acceptability of a solution value, as in ","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"key":"wbbt8SNaIv"},{"type":"crossReference","kind":"equation","identifier":"absreltolerance","label":"absreltolerance","children":[{"type":"text","value":"(","key":"qhFfEV1aXn"},{"type":"text","value":"5.7.6","key":"w1oxDX9xst"},{"type":"text","value":")","key":"GW08mA6DA3"}],"template":"(%s)","enumerator":"5.7.6","resolved":true,"html_id":"absreltolerance","remote":true,"url":"/adaptive","dataUrl":"/adaptive.json","key":"pJ4jFpiCyr"},{"type":"text","value":". In lines 41--43 we underestimate the step factor ","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"key":"Udt65e3wFy"},{"type":"inlineMath","value":"q","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>q</mi></mrow><annotation encoding=\"application/x-tex\">q</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span></span></span></span>","key":"rFW6Dgl63v"},{"type":"text","value":" a bit and prevent a huge increase in the step size, since a rejected step is expensive, and then we make sure that our final step doesn’t take us past the end of the domain.","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"key":"uEQxSyqvNj"}],"key":"kSI89ZNMnh"},{"type":"paragraph","position":{"start":{"line":69,"column":1},"end":{"line":70,"column":1}},"children":[{"type":"text","value":"Finally, line 37 exploits a subtle property of the BS23 formula called ","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"key":"SsRGHVf8zX"},{"type":"emphasis","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"children":[{"type":"text","value":"first same as last","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"key":"hcqnjMJPzO"}],"key":"GMDXv1w24q"},{"type":"text","value":" (FSAL).\nWhile ","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"key":"cplDlLF8NV"},{"type":"crossReference","kind":"equation","identifier":"bs23","label":"bs23","children":[{"type":"text","value":"(","key":"vkHmeFJJpl"},{"type":"text","value":"6.5.5","key":"MY544uoDqD"},{"type":"text","value":")","key":"VYY3GoyxUk"}],"template":"(%s)","enumerator":"6.5.5","resolved":true,"html_id":"bs23","remote":true,"url":"/adaptive-rk","dataUrl":"/adaptive-rk.json","key":"OFdP1QxC2Y"},{"type":"text","value":" calls for four stages to find the paired second- and third-order estimates, the final stage computed in stepping from ","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"key":"h7va04kXQN"},{"type":"inlineMath","value":"t_i","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>t</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">t_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7651em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"VM1u9avzPX"},{"type":"text","value":" to ","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"key":"UzX8S0K8mj"},{"type":"inlineMath","value":"t_{i+1}","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>t</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding=\"application/x-tex\">t_{i+1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8234em;vertical-align:-0.2083em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span></span></span></span>","key":"CcwdtfZABt"},{"type":"text","value":" is identical to the first stage needed to step from ","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"key":"TsTzy4bI1s"},{"type":"inlineMath","value":"t_{i+1}","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>t</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding=\"application/x-tex\">t_{i+1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8234em;vertical-align:-0.2083em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span></span></span></span>","key":"hiVBAINqRc"},{"type":"text","value":" to ","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"key":"PuIIEViZQf"},{"type":"inlineMath","value":"t_{i+2}","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>t</mi><mrow><mi>i</mi><mo>+</mo><mn>2</mn></mrow></msub></mrow><annotation encoding=\"application/x-tex\">t_{i+2}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8234em;vertical-align:-0.2083em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">2</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span></span></span></span>","key":"ryApKSg6fW"},{"type":"text","value":". By repurposing ","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"key":"YxhWHzGxNs"},{"type":"inlineCode","value":"s₄","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"key":"zBUgdjpjcI"},{"type":"text","value":" as ","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"key":"A14i2ovreV"},{"type":"inlineCode","value":"s₁","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"key":"oo6g5mHpCR"},{"type":"text","value":" for the next pass, one of the stage evaluations comes for free, and only three evaluations of ","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"key":"Gph76cXHxd"},{"type":"inlineMath","value":"f","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>","key":"rgVLRTwV1Q"},{"type":"text","value":" are needed per successful step.","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"key":"pKMGSmFbxN"}],"key":"OhF2ACeMYf"}],"class":"dropdown","key":"CJ139P9wTg"}],"key":"OqLHsq4B6b"}],"key":"Cgi2kjnz0c"}],"key":"yvgANycAGP"},{"type":"tabItem","title":"MATLAB","sync":"matlab","children":[{"type":"embed","source":{"url":"/chapter6-1","label":"function-rk23-matlab","kind":"Notebook","slug":"chapter6-1","location":"/matlab/chapter6.md","title":"Chapter 6"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Adaptive ","key":"ByWqE6EmAG"},{"type":"abbreviation","title":"initial-value problem","children":[{"type":"text","value":"IVP","key":"DvYwjy3gpo"}],"key":"CmBMW4jihr"},{"type":"text","value":" solver based on embedded RK formulas","key":"ft0U8tUOHF"}],"key":"Fy7yQzR05H"},{"type":"include","file":"FNC-matlab/rk23.m","literal":true,"children":[{"type":"code","value":"function [t, u] = rk23(ivp, a, b, tol)\r\n% RK23   Adaptive IVP solver based on embedded RK formulas.\r\n% Input:\r\n%   ivp     structure defining the IVP\r\n%   a, b    endpoints of time interval (scalars)\r\n%   tol     global error target (positive scalar)\r\n% Output:\r\n%   t       selected nodes (vector, length n+1)\r\n%   u       solution values (array, m by (n+1))\r\n\r\ndu_dt = ivp.ODEFcn;\r\nu0 = ivp.InitialValue;\r\np = ivp.Parameters;\r\n\r\n% Initialize for the first time step.\r\nt = a;\r\nu(:, 1) = u0(:);  i = 1;\r\nh = 0.5 * tol^(1/3);\r\ns1 = du_dt(t(1), u(:, 1) ,p);\r\n\r\n% Time stepping.\r\nwhile t(i) < b\r\n    % Detect underflow of the step size.\r\n    if t(i) + h == t(i)\r\n        warning('Stepsize too small near t=%.6g.',t(i))\r\n        break  % quit time stepping loop\r\n    end\r\n    \r\n    % New RK stages.\r\n    s2 = du_dt(t(i) + h/2,   u(:, i) + (h/2)   * s1, p);\r\n    s3 = du_dt(t(i) + 3*h/4, u(:, i) + (3*h/4) * s2, p);\r\n    unew2 = u(:, i) + h * (2*s1 + 3*s2 + 4*s3) / 9;    % 2rd order solution\r\n    s4 = du_dt(t(i) + h, unew2, p );\r\n    err = h * (-5*s1/72 + s2/12 + s3/9 - s4/8);        % 2nd/3rd order difference\r\n    E = norm(err, Inf);                                % error estimate\r\n    maxerr = tol * (1 + norm(u(:, i), Inf));           % relative/absolute blend\r\n    \r\n    % Accept the proposed step? \r\n    if E < maxerr     % yes \r\n        t(i+1) = t(i) + h;\r\n        u(:, i+1) = unew2;\r\n        i = i+1;\r\n        s1 = s4;      % use FSAL property\r\n    end\r\n    \r\n    % Adjust step size. \r\n    q = 0.8 * (maxerr/E)^(1/3);       % conservative optimal step factor\r\n    q = min(q, 4);                    % limit stepsize growth\r\n    h = min(q*h, b - t(i));           % don't step past the end\r\nend","lang":"matlab","showLineNumbers":true,"filename":"rk23.m","key":"HHarn7VRds"}],"key":"Ubt4ErZNL9"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"About the code","position":{"start":{"line":51,"column":1},"end":{"line":51,"column":1}},"key":"wDt2kEbOzL"}],"key":"Ox0i4UgdDU"},{"type":"paragraph","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"children":[{"type":"text","value":"The check ","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"Gv5muzHY4s"},{"type":"inlineCode","value":"t(i) + h == t(i)","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"GDKj603rXo"},{"type":"text","value":"on line 24 is to detect when ","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"h7QUPRp2xD"},{"type":"inlineMath","value":"h","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>h</mi></mrow><annotation encoding=\"application/x-tex\">h</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">h</span></span></span></span>","key":"xY3U308qsb"},{"type":"text","value":" has become so small that it no longer changes the floating-point value of ","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"pp22mEZ9y3"},{"type":"inlineMath","value":"t_i","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>t</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">t_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7651em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"HsBOXZ8I7i"},{"type":"text","value":". This may be a sign that the underlying exact solution has a singularity near ","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"BpamX1U6Xe"},{"type":"inlineMath","value":"t=t_i","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi><mo>=</mo><msub><mi>t</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">t=t_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7651em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"PkP3h1GzO5"},{"type":"text","value":", but in any case, the solver must halt by using a ","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"HvMsKGzesl"},{"type":"inlineCode","value":"break","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"AGViHzhT2a"},{"type":"text","value":" statement to exit the loop.","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"ZjcsCoCkkH"}],"key":"yv8njChjuZ"},{"type":"paragraph","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"children":[{"type":"text","value":"On line 36, we use a combination of absolute and relative tolerances to judge the acceptability of a solution value, as in ","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"key":"f5eagN0Pte"},{"type":"crossReference","kind":"equation","identifier":"absreltolerance","label":"absreltolerance","children":[{"type":"text","value":"(","key":"h7YDNHvyrH"},{"type":"text","value":"5.7.6","key":"gtI3KJMCMj"},{"type":"text","value":")","key":"OqUnceDoyg"}],"template":"(%s)","enumerator":"5.7.6","resolved":true,"html_id":"absreltolerance","remote":true,"url":"/adaptive","dataUrl":"/adaptive.json","key":"w4R2Tcjcsm"},{"type":"text","value":". In lines 47--49 we underestimate the step factor ","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"key":"YKtPUa2QRI"},{"type":"inlineMath","value":"q","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>q</mi></mrow><annotation encoding=\"application/x-tex\">q</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span></span></span></span>","key":"jKOhCqxaxl"},{"type":"text","value":" a bit and prevent a huge increase in the step size, since a rejected step is expensive, and then we make sure that our final step doesn’t take us past the end of the domain.","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"key":"YgRE9zxTq5"}],"key":"jsRW9fjbS5"},{"type":"paragraph","position":{"start":{"line":57,"column":1},"end":{"line":58,"column":1}},"children":[{"type":"text","value":"Finally, line 43 exploits a subtle property of the BS23 formula called ","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"b2DOdvtEJo"},{"type":"emphasis","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"children":[{"type":"text","value":"first same as last","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"LqEcwl9sPk"}],"key":"DX4bMieRCo"},{"type":"text","value":" (FSAL).\nWhile ","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"kvV82lOELn"},{"type":"crossReference","kind":"equation","identifier":"bs23","label":"bs23","children":[{"type":"text","value":"(","key":"PI9nhayXjc"},{"type":"text","value":"6.5.5","key":"IvhQaOYgmA"},{"type":"text","value":")","key":"z1AqF5EfH2"}],"template":"(%s)","enumerator":"6.5.5","resolved":true,"html_id":"bs23","remote":true,"url":"/adaptive-rk","dataUrl":"/adaptive-rk.json","key":"sRMCLyVpGI"},{"type":"text","value":" calls for four stages to find the paired second- and third-order estimates, the final stage computed in stepping from ","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"KDsYW35H93"},{"type":"inlineMath","value":"t_i","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>t</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">t_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7651em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"v3OmSL2Csh"},{"type":"text","value":" to ","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"CHAAwEE9nr"},{"type":"inlineMath","value":"t_{i+1}","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>t</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding=\"application/x-tex\">t_{i+1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8234em;vertical-align:-0.2083em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span></span></span></span>","key":"jC942CdZ05"},{"type":"text","value":" is identical to the first stage needed to step from ","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"rZXJPkKcMe"},{"type":"inlineMath","value":"t_{i+1}","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>t</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding=\"application/x-tex\">t_{i+1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8234em;vertical-align:-0.2083em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span></span></span></span>","key":"C7eQECPV0b"},{"type":"text","value":" to ","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"nyFUWehlJR"},{"type":"inlineMath","value":"t_{i+2}","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>t</mi><mrow><mi>i</mi><mo>+</mo><mn>2</mn></mrow></msub></mrow><annotation encoding=\"application/x-tex\">t_{i+2}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8234em;vertical-align:-0.2083em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">2</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span></span></span></span>","key":"QUrZ6IDy1o"},{"type":"text","value":". By repurposing ","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"dSfedZlNOx"},{"type":"inlineCode","value":"s4","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"adUjbGSnry"},{"type":"text","value":" as ","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"kZIYCXLRLz"},{"type":"inlineCode","value":"s1","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"ZC4ux4TiT1"},{"type":"text","value":" for the next pass, one of the stage evaluations comes for free, and only three evaluations of ","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"WpVOQjHs1C"},{"type":"inlineMath","value":"f","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>","key":"Foico3SSO3"},{"type":"text","value":" are needed per successful step.","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"CGFGiEkr5Z"}],"key":"a8PkabaaT0"}],"class":"dropdown","key":"PdrtwaIaKo"}],"key":"bLL3auKnjw"}],"key":"KU2UJjVt7F"}],"key":"O8u2M6za2R"},{"type":"tabItem","title":"Python","sync":"python","children":[{"type":"embed","source":{"url":"/chapter6-2","label":"function-rk23-python","kind":"Notebook","slug":"chapter6-2","location":"/python/chapter6.md","title":"Chapter 6"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Adaptive ","key":"I8ypbFk562"},{"type":"abbreviation","title":"initial-value problem","children":[{"type":"text","value":"IVP","key":"tfvdA0vibF"}],"key":"TKirAiUSMu"},{"type":"text","value":" solver based on embedded RK formulas","key":"uj2kYefk2r"}],"key":"Qz6bVEy0ko"},{"type":"include","file":"fncbook/fncbook/chapter06.py","literal":true,"filter":{"startAt":"def euler","endAt":"return"},"children":[{"type":"code","value":"def euler(du_dt, tspan, u0, n):\n    \"\"\"\n    euler(du_dt, tspan, u0, n)\n\n    Apply Euler's method to solve the IVP u'=du_dt(u,t) over the interval tspan with\n    u(tspan[1])=u0, using n subintervals/steps. Return vectors of times and solution\n    values.\n    \"\"\"\n    a, b = tspan\n    h = (b - a) / n\n    t = np.linspace(a, b, n+1)\n    u = np.tile(np.array(u0), (n+1, 1))\n    for i in range(n):\n        u[i+1] = u[i] + h * du_dt(t[i], u[i])\n\n    return t, u.T","lang":"python","showLineNumbers":true,"filename":"rk23.py","key":"yrZ8ODlfa5"}],"key":"JmHk1Gnmtu"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"About the code","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"OjMRQ8bUWV"}],"key":"qwkQNCFcPC"},{"type":"paragraph","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"children":[{"type":"text","value":"The check ","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"ereel1Lskc"},{"type":"inlineCode","value":"t[i]+h==t[i]","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"ukxKDtjSVC"},{"type":"text","value":"on line 19 is to detect when ","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"t3GJtyEQSE"},{"type":"inlineMath","value":"h","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>h</mi></mrow><annotation encoding=\"application/x-tex\">h</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">h</span></span></span></span>","key":"SRDNtFo6JW"},{"type":"text","value":" has become so small that it no longer changes the floating-point value of ","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"GLvyejB33b"},{"type":"inlineMath","value":"t_i","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>t</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">t_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7651em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"VyuO9Dl0He"},{"type":"text","value":". This may be a sign that the underlying exact solution has a singularity near ","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"hQo8wieLIz"},{"type":"inlineMath","value":"t=t_i","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi><mo>=</mo><msub><mi>t</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">t=t_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7651em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"Wt9NjVkrIm"},{"type":"text","value":", but in any case, the solver must halt by using a ","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"ZLLvN4gFjd"},{"type":"inlineCode","value":"break","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"jnyMi4E2f7"},{"type":"text","value":" statement to exit the loop.","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"lMPb5VLc2m"}],"key":"JCKyBJusKp"},{"type":"paragraph","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"children":[{"type":"text","value":"On line 30, we use a combination of absolute and relative tolerances to judge the acceptability of a solution value, as in ","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"key":"uZV8dshtmJ"},{"type":"crossReference","kind":"equation","identifier":"absreltolerance","label":"absreltolerance","children":[{"type":"text","value":"(","key":"IkE0n0FuUp"},{"type":"text","value":"5.7.6","key":"tOEmADVtAl"},{"type":"text","value":")","key":"S57OIWniyJ"}],"template":"(%s)","enumerator":"5.7.6","resolved":true,"html_id":"absreltolerance","remote":true,"url":"/adaptive","dataUrl":"/adaptive.json","key":"quebLZPliP"},{"type":"text","value":". In lines 41--43 we underestimate the step factor ","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"key":"QIIKHNnoLF"},{"type":"inlineMath","value":"q","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>q</mi></mrow><annotation encoding=\"application/x-tex\">q</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span></span></span></span>","key":"mWHE3aQikC"},{"type":"text","value":" a bit and prevent a huge increase in the step size, since a rejected step is expensive, and then we make sure that our final step doesn’t take us past the end of the domain.","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"key":"zEhxJmF4r6"}],"key":"YAAOZpztQQ"},{"type":"paragraph","position":{"start":{"line":65,"column":1},"end":{"line":66,"column":1}},"children":[{"type":"text","value":"Finally, line 37 exploits a subtle property of the BS23 formula called ","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"Xu0CYT75kz"},{"type":"emphasis","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"children":[{"type":"text","value":"first same as last","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"mVlKpDPbL4"}],"key":"AFrSCCE1uf"},{"type":"text","value":" (FSAL).\nWhile ","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"h23w0efM2p"},{"type":"crossReference","kind":"equation","identifier":"bs23","label":"bs23","children":[{"type":"text","value":"(","key":"STRipjOzGk"},{"type":"text","value":"6.5.5","key":"AONdKKDkp3"},{"type":"text","value":")","key":"uNZ7RmvK69"}],"template":"(%s)","enumerator":"6.5.5","resolved":true,"html_id":"bs23","remote":true,"url":"/adaptive-rk","dataUrl":"/adaptive-rk.json","key":"nlM57Fyd9L"},{"type":"text","value":" calls for four stages to find the paired second- and third-order estimates, the final stage computed in stepping from ","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"FP161ppJcc"},{"type":"inlineMath","value":"t_i","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>t</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">t_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7651em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"JzFmPzZ81T"},{"type":"text","value":" to ","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"wUSY6VPh70"},{"type":"inlineMath","value":"t_{i+1}","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>t</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding=\"application/x-tex\">t_{i+1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8234em;vertical-align:-0.2083em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span></span></span></span>","key":"KwVBlZlkxt"},{"type":"text","value":" is identical to the first stage needed to step from ","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"TpyNFkRpP8"},{"type":"inlineMath","value":"t_{i+1}","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>t</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding=\"application/x-tex\">t_{i+1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8234em;vertical-align:-0.2083em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span></span></span></span>","key":"l9VgT7DLd6"},{"type":"text","value":" to ","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"qKXwUDsdTM"},{"type":"inlineMath","value":"t_{i+2}","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>t</mi><mrow><mi>i</mi><mo>+</mo><mn>2</mn></mrow></msub></mrow><annotation encoding=\"application/x-tex\">t_{i+2}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8234em;vertical-align:-0.2083em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">2</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span></span></span></span>","key":"agGP4TPc65"},{"type":"text","value":". By repurposing ","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"rmPQhDRGBD"},{"type":"inlineCode","value":"s₄","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"p9SnCPRS9v"},{"type":"text","value":" as ","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"ec0eZFqkdZ"},{"type":"inlineCode","value":"s₁","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"HWeIkAmokY"},{"type":"text","value":" for the next pass, one of the stage evaluations comes for free, and only three evaluations of ","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"SC202ln5AB"},{"type":"inlineMath","value":"f","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>","key":"sKvCueq8WR"},{"type":"text","value":" are needed per successful step.","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"QM4MSPtNls"}],"key":"fZP3pE6XcV"}],"class":"dropdown","key":"R90og7ZZoU"}],"key":"bHiNgcFy3L"}],"key":"AGlytyNyWq"}],"key":"vt09PJliqF"}],"key":"ld1fVIu8TA"}],"label":"function-rk23","identifier":"function-rk23","html_id":"function-rk23","enumerator":"6.5.2","key":"kiITQOAkBr"},{"type":"proof","kind":"example","enumerated":true,"children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Adaptive step size","position":{"start":{"line":111,"column":1},"end":{"line":111,"column":1}},"key":"DlUbyi7LQS"}],"key":"ZhlYQVAOSn"},{"type":"tabSet","children":[{"type":"tabItem","title":"Julia","sync":"julia","children":[{"type":"embed","source":{"url":"/chapter6","label":"demo-adapt-basic-julia","kind":"Notebook","slug":"chapter6","location":"/julia/chapter6.md","title":"Chapter 6"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-adapt-basic","label":"demo-adapt-basic","kind":"proof:example","position":{"start":{"line":480,"column":1},"end":{"line":480,"column":18}},"children":[{"type":"text","value":"Example ","key":"KjOV4AMjPe"},{"type":"text","value":"6.5.1","key":"R0ZYsBeV4O"}],"template":"Example %s","enumerator":"6.5.1","resolved":true,"html_id":"demo-adapt-basic","remote":true,"url":"/adaptive-rk","dataUrl":"/adaptive-rk.json","key":"PkRI1m69mq"}],"key":"isGUKAlRWS"},{"type":"paragraph","position":{"start":{"line":482,"column":1},"end":{"line":482,"column":1}},"children":[{"type":"text","value":"Let’s run adaptive RK on  ","position":{"start":{"line":482,"column":1},"end":{"line":482,"column":1}},"key":"SHa3bO5v0g"},{"type":"inlineMath","value":"u'=e^{t-u\\sin u}","position":{"start":{"line":482,"column":1},"end":{"line":482,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>u</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo>=</mo><msup><mi>e</mi><mrow><mi>t</mi><mo>−</mo><mi>u</mi><mi>sin</mi><mo>⁡</mo><mi>u</mi></mrow></msup></mrow><annotation encoding=\"application/x-tex\">u&#x27;=e^{t-u\\sin u}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8305em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8305em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mbin mtight\">−</span><span class=\"mord mathnormal mtight\">u</span><span class=\"mspace mtight\" style=\"margin-right:0.1952em;\"></span><span class=\"mop mtight\"><span class=\"mtight\">s</span><span class=\"mtight\">i</span><span class=\"mtight\">n</span></span><span class=\"mspace mtight\" style=\"margin-right:0.1952em;\"></span><span class=\"mord mathnormal mtight\">u</span></span></span></span></span></span></span></span></span></span></span></span>","key":"pRgQWb01eK"},{"type":"text","value":".","position":{"start":{"line":482,"column":1},"end":{"line":482,"column":1}},"key":"OUovEojnbL"}],"key":"ohBIop7tzJ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"using OrdinaryDiffEq, Plots\nf(u, p, t) = exp(t - u * sin(u))\nivp = ODEProblem(f, 0, (0.0, 5.0))\nt, u = FNC.rk23(ivp, 1e-5)\nplot(t, u, m=2,\n    xlabel=L\"t\",  ylabel=L\"u(t)\", \n    title=\"Adaptive IVP solution\")","key":"sGl61yLsUK"},{"type":"output","id":"pjfH5uupxppsqzFpfcoY_","data":[{"output_type":"execute_result","execution_count":32,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"13c76cef9dc6e9251aa46e34e2c48c95","path":"/build/13c76cef9dc6e9251aa46e34e2c48c95.png"},"text/html":{"content_type":"text/html","hash":"eac66844fd5e7b5f80a30a5ecdcce5c2","path":"/build/eac66844fd5e7b5f80a30a5ecdcce5c2.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"8f3fa63c5cdf70a49fc815ca3eecd657","path":"/build/8f3fa63c5cdf70a49fc815ca3eecd657.svg"}}}],"key":"SrdwNVnmAm"}],"data":{},"key":"Fuwlt7d0J8"},{"type":"paragraph","position":{"start":{"line":494,"column":1},"end":{"line":494,"column":1}},"children":[{"type":"text","value":"The solution makes a very abrupt change near ","position":{"start":{"line":494,"column":1},"end":{"line":494,"column":1}},"key":"upVSVJ5rjA"},{"type":"inlineMath","value":"t=2.4","position":{"start":{"line":494,"column":1},"end":{"line":494,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi><mo>=</mo><mn>2.4</mn></mrow><annotation encoding=\"application/x-tex\">t=2.4</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2.4</span></span></span></span>","key":"j2Qk3ilUgY"},{"type":"text","value":". The resulting time steps vary over three orders of magnitude.","position":{"start":{"line":494,"column":1},"end":{"line":494,"column":1}},"key":"o8O8F2LnsR"}],"key":"OpmJzNS2of"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"Δt = diff(t)\nplot(t[1:end-1], Δt;\n    xaxis=(L\"t\", (0, 5)), yaxis=(:log10, \"step size\"),\n    title=\"Adaptive step sizes\")","key":"bibSzUsi6x"},{"type":"output","id":"PbNV__8cxk8azF5AhNX_4","data":[{"output_type":"execute_result","execution_count":33,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"a0fb87535fa921065e3241b4f03a05c7","path":"/build/a0fb87535fa921065e3241b4f03a05c7.png"},"text/html":{"content":"<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" width=\"500\" height=\"320\" viewBox=\"0 0 2000 1280\">\n<defs>\n  <clipPath id=\"clip930\">\n    <rect x=\"0\" y=\"0\" width=\"2000\" height=\"1280\"/>\n  </clipPath>\n</defs>\n<path clip-path=\"url(#clip930)\" d=\"M0 1280 L2000 1280 L2000 -2.66454e-14 L0 -2.66454e-14  Z\" fill=\"#ffffff\" fill-rule=\"evenodd\" fill-opacity=\"1\"/>\n<defs>\n  <clipPath id=\"clip931\">\n    <rect x=\"400\" y=\"0\" width=\"1401\" height=\"1280\"/>\n  </clipPath>\n</defs>\n<path clip-path=\"url(#clip930)\" d=\"M245.508 1111.02 L1952.76 1111.02 L1952.76 107.256 L245.508 107.256  Z\" fill=\"#ffffff\" fill-rule=\"evenodd\" fill-opacity=\"1\"/>\n<defs>\n  <clipPath id=\"clip932\">\n    <rect x=\"245\" y=\"107\" width=\"1708\" height=\"1005\"/>\n  </clipPath>\n</defs>\n<polyline clip-path=\"url(#clip932)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"245.508,1111.02 245.508,107.256 \"/>\n<polyline clip-path=\"url(#clip932)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"586.957,1111.02 586.957,107.256 \"/>\n<polyline clip-path=\"url(#clip932)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"928.407,1111.02 928.407,107.256 \"/>\n<polyline clip-path=\"url(#clip932)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"1269.86,1111.02 1269.86,107.256 \"/>\n<polyline clip-path=\"url(#clip932)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"1611.31,1111.02 1611.31,107.256 \"/>\n<polyline clip-path=\"url(#clip932)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"1952.76,1111.02 1952.76,107.256 \"/>\n<polyline clip-path=\"url(#clip932)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"245.508,1000.16 1952.76,1000.16 \"/>\n<polyline clip-path=\"url(#clip932)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"245.508,509.899 1952.76,509.899 \"/>\n<polyline clip-path=\"url(#clip930)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"245.508,1111.02 1952.76,1111.02 \"/>\n<polyline clip-path=\"url(#clip930)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"245.508,1111.02 245.508,1092.12 \"/>\n<polyline clip-path=\"url(#clip930)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"586.957,1111.02 586.957,1092.12 \"/>\n<polyline clip-path=\"url(#clip930)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"928.407,1111.02 928.407,1092.12 \"/>\n<polyline clip-path=\"url(#clip930)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"1269.86,1111.02 1269.86,1092.12 \"/>\n<polyline clip-path=\"url(#clip930)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"1611.31,1111.02 1611.31,1092.12 \"/>\n<polyline clip-path=\"url(#clip930)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"1952.76,1111.02 1952.76,1092.12 \"/>\n<path clip-path=\"url(#clip930)\" d=\"M245.508 1138.74 Q241.897 1138.74 240.068 1142.3 Q238.262 1145.84 238.262 1152.97 Q238.262 1160.08 240.068 1163.64 Q241.897 1167.19 245.508 1167.19 Q249.142 1167.19 250.947 1163.64 Q252.776 1160.08 252.776 1152.97 Q252.776 1145.84 250.947 1142.3 Q249.142 1138.74 245.508 1138.74 M245.508 1135.03 Q251.318 1135.03 254.373 1139.64 Q257.452 1144.22 257.452 1152.97 Q257.452 1161.7 254.373 1166.31 Q251.318 1170.89 245.508 1170.89 Q239.698 1170.89 236.619 1166.31 Q233.563 1161.7 233.563 1152.97 Q233.563 1144.22 236.619 1139.64 Q239.698 1135.03 245.508 1135.03 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip930)\" d=\"M577.339 1166.28 L584.978 1166.28 L584.978 1139.92 L576.668 1141.58 L576.668 1137.33 L584.932 1135.66 L589.608 1135.66 L589.608 1166.28 L597.247 1166.28 L597.247 1170.22 L577.339 1170.22 L577.339 1166.28 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip930)\" d=\"M923.06 1166.28 L939.379 1166.28 L939.379 1170.22 L917.435 1170.22 L917.435 1166.28 Q920.097 1163.53 924.68 1158.9 Q929.287 1154.25 930.467 1152.9 Q932.713 1150.38 933.592 1148.64 Q934.495 1146.89 934.495 1145.2 Q934.495 1142.44 932.55 1140.7 Q930.629 1138.97 927.527 1138.97 Q925.328 1138.97 922.875 1139.73 Q920.444 1140.5 917.666 1142.05 L917.666 1137.33 Q920.49 1136.19 922.944 1135.61 Q925.398 1135.03 927.435 1135.03 Q932.805 1135.03 936 1137.72 Q939.194 1140.4 939.194 1144.89 Q939.194 1147.02 938.384 1148.95 Q937.597 1150.84 935.49 1153.44 Q934.912 1154.11 931.81 1157.33 Q928.708 1160.52 923.06 1166.28 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip930)\" d=\"M1274.1 1151.58 Q1277.46 1152.3 1279.34 1154.57 Q1281.23 1156.84 1281.23 1160.17 Q1281.23 1165.29 1277.72 1168.09 Q1274.2 1170.89 1267.72 1170.89 Q1265.54 1170.89 1263.22 1170.45 Q1260.93 1170.03 1258.48 1169.18 L1258.48 1164.66 Q1260.42 1165.8 1262.74 1166.38 Q1265.05 1166.95 1267.58 1166.95 Q1271.97 1166.95 1274.27 1165.22 Q1276.58 1163.48 1276.58 1160.17 Q1276.58 1157.12 1274.43 1155.4 Q1272.3 1153.67 1268.48 1153.67 L1264.45 1153.67 L1264.45 1149.83 L1268.66 1149.83 Q1272.11 1149.83 1273.94 1148.46 Q1275.77 1147.07 1275.77 1144.48 Q1275.77 1141.82 1273.87 1140.4 Q1272 1138.97 1268.48 1138.97 Q1266.56 1138.97 1264.36 1139.39 Q1262.16 1139.8 1259.52 1140.68 L1259.52 1136.51 Q1262.18 1135.77 1264.5 1135.4 Q1266.84 1135.03 1268.9 1135.03 Q1274.22 1135.03 1277.32 1137.46 Q1280.42 1139.87 1280.42 1143.99 Q1280.42 1146.86 1278.78 1148.85 Q1277.14 1150.82 1274.1 1151.58 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip930)\" d=\"M1614.32 1139.73 L1602.51 1158.18 L1614.32 1158.18 L1614.32 1139.73 M1613.09 1135.66 L1618.97 1135.66 L1618.97 1158.18 L1623.9 1158.18 L1623.9 1162.07 L1618.97 1162.07 L1618.97 1170.22 L1614.32 1170.22 L1614.32 1162.07 L1598.71 1162.07 L1598.71 1157.56 L1613.09 1135.66 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip930)\" d=\"M1943.03 1135.66 L1961.39 1135.66 L1961.39 1139.59 L1947.32 1139.59 L1947.32 1148.07 Q1948.33 1147.72 1949.35 1147.56 Q1950.37 1147.37 1951.39 1147.37 Q1957.18 1147.37 1960.56 1150.54 Q1963.94 1153.71 1963.94 1159.13 Q1963.94 1164.71 1960.46 1167.81 Q1956.99 1170.89 1950.67 1170.89 Q1948.5 1170.89 1946.23 1170.52 Q1943.98 1170.15 1941.58 1169.41 L1941.58 1164.71 Q1943.66 1165.84 1945.88 1166.4 Q1948.1 1166.95 1950.58 1166.95 Q1954.58 1166.95 1956.92 1164.85 Q1959.26 1162.74 1959.26 1159.13 Q1959.26 1155.52 1956.92 1153.41 Q1954.58 1151.31 1950.58 1151.31 Q1948.71 1151.31 1946.83 1151.72 Q1944.98 1152.14 1943.03 1153.02 L1943.03 1135.66 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><g clip-path=\"url(#clip930)\">\n<image width=\"20\" height=\"42\" xlink:href=\"data:image/png;base64,\niVBORw0KGgoAAAANSUhEUgAAABQAAAAqCAYAAACz+XvQAAABb0lEQVRIia2WXbGEMAyFT6+CggQk\noAUN4AANSAAL4KAaKgENAQfZhws70B8mLduZPADpafr1TAqYGSlBRNy2LVtrOfQ9SWyeZwbwjXVd\nPdEkwasYAB7H0RNUR6JoKKVuycys3Jw/qdg0TbKVpdvVWt+2+z/VzxNXuO/77bnv+2CemKGEHyBk\nuCyL/OQk/KqqEvET+9AVG4YhKihiKOUHCBgm8QMAa63HJze01mHDvokvw23bglsry/L2TETR3RZF\noZLaFR7sIrKN6z+t9TtBt7pQ/0vyYYr/zhH1obj/uUPa/yT8Hhkig98jwxx+QIRhNr9j5Z/xizJE\nJr8ow1x+QIDhK37H6j/jF2SIF/xEglKh8+K6vRzHMbn/XecR0fv+d92VV2EOP2MMA2BjDHs+zPHf\nOefMFf99hUbXdQw4F1fuCa/rygC4aZpb3qOpY2JEFD20Rx8SkTfhPISYA6KeckWvd3Rd19HqH/mE\nIlT1NT62/UqELBm6rwAAAABJRU5ErkJggg==\n\" transform=\"translate(1089, 1200)\"/>\n</g>\n<polyline clip-path=\"url(#clip930)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"245.508,1111.02 245.508,107.256 \"/>\n<polyline clip-path=\"url(#clip930)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"245.508,1000.16 264.405,1000.16 \"/>\n<polyline clip-path=\"url(#clip930)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"245.508,509.899 264.405,509.899 \"/>\n<path clip-path=\"url(#clip930)\" d=\"M113.675 1019.96 L121.314 1019.96 L121.314 993.592 L113.004 995.258 L113.004 990.999 L121.268 989.332 L125.944 989.332 L125.944 1019.96 L133.583 1019.96 L133.583 1023.89 L113.675 1023.89 L113.675 1019.96 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip930)\" d=\"M153.027 992.411 Q149.416 992.411 147.587 995.976 Q145.782 999.518 145.782 1006.65 Q145.782 1013.75 147.587 1017.32 Q149.416 1020.86 153.027 1020.86 Q156.661 1020.86 158.467 1017.32 Q160.295 1013.75 160.295 1006.65 Q160.295 999.518 158.467 995.976 Q156.661 992.411 153.027 992.411 M153.027 988.707 Q158.837 988.707 161.893 993.314 Q164.971 997.897 164.971 1006.65 Q164.971 1015.37 161.893 1019.98 Q158.837 1024.56 153.027 1024.56 Q147.217 1024.56 144.138 1019.98 Q141.082 1015.37 141.082 1006.65 Q141.082 997.897 144.138 993.314 Q147.217 988.707 153.027 988.707 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip930)\" d=\"M164.971 982.809 L189.083 982.809 L189.083 986.006 L164.971 986.006 L164.971 982.809 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip930)\" d=\"M207.721 971.712 L198.129 986.702 L207.721 986.702 L207.721 971.712 M206.724 968.402 L211.502 968.402 L211.502 986.702 L215.508 986.702 L215.508 989.862 L211.502 989.862 L211.502 996.482 L207.721 996.482 L207.721 989.862 L195.045 989.862 L195.045 986.194 L206.724 968.402 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip930)\" d=\"M115.368 529.691 L123.007 529.691 L123.007 503.326 L114.697 504.992 L114.697 500.733 L122.96 499.066 L127.636 499.066 L127.636 529.691 L135.275 529.691 L135.275 533.626 L115.368 533.626 L115.368 529.691 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip930)\" d=\"M154.72 502.145 Q151.108 502.145 149.28 505.71 Q147.474 509.252 147.474 516.381 Q147.474 523.488 149.28 527.052 Q151.108 530.594 154.72 530.594 Q158.354 530.594 160.159 527.052 Q161.988 523.488 161.988 516.381 Q161.988 509.252 160.159 505.71 Q158.354 502.145 154.72 502.145 M154.72 498.441 Q160.53 498.441 163.585 503.048 Q166.664 507.631 166.664 516.381 Q166.664 525.108 163.585 529.714 Q160.53 534.298 154.72 534.298 Q148.909 534.298 145.831 529.714 Q142.775 525.108 142.775 516.381 Q142.775 507.631 145.831 503.048 Q148.909 498.441 154.72 498.441 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip930)\" d=\"M166.664 492.543 L190.775 492.543 L190.775 495.74 L166.664 495.74 L166.664 492.543 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip930)\" d=\"M202.248 503.019 L215.508 503.019 L215.508 506.216 L197.678 506.216 L197.678 503.019 Q199.841 500.781 203.565 497.019 Q207.308 493.239 208.267 492.148 Q210.091 490.098 210.806 488.687 Q211.539 487.258 211.539 485.885 Q211.539 483.647 209.959 482.236 Q208.398 480.826 205.878 480.826 Q204.091 480.826 202.098 481.446 Q200.123 482.067 197.866 483.327 L197.866 479.49 Q200.161 478.569 202.154 478.098 Q204.148 477.628 205.803 477.628 Q210.166 477.628 212.762 479.81 Q215.357 481.992 215.357 485.64 Q215.357 487.371 214.699 488.932 Q214.06 490.474 212.348 492.58 Q211.878 493.126 209.358 495.74 Q206.837 498.336 202.248 503.019 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><g clip-path=\"url(#clip930)\">\n<text style=\"fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:66px; text-anchor:middle;\" transform=\"rotate(-90, 71.4418, 609.137)\" x=\"71.4418\" y=\"609.137\">step size</text>\n</g>\n<g clip-path=\"url(#clip930)\">\n<text style=\"fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:66px; text-anchor:middle;\" transform=\"rotate(0, 1099.13, 57.6)\" x=\"1099.13\" y=\"57.6\">Adaptive step sizes</text>\n</g>\n<polyline clip-path=\"url(#clip932)\" style=\"stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none\" points=\"245.508,501.98 249.186,354.395 263.898,325.393 283.218,336.127 300.685,343.179 317.033,346.864 332.824,348.257 348.409,347.805 364.062,345.672 380.031,341.853 396.583,336.198 414.038,328.349 432.829,317.582 453.619,302.269 477.626,277.557 507.905,262.52 542.778,255.132 580.158,273.539 611.602,278.885 641.505,280.343 671.003,280.884 700.35,281.538 729.518,282.904 758.314,285.377 786.449,289.188 813.595,294.41 839.441,300.988 863.739,308.773 886.323,317.581 907.113,327.224 926.104,337.54 943.34,348.396 958.906,359.692 972.904,371.354 985.45,383.325 996.662,395.566 1006.66,408.048 1015.54,420.747 1023.43,433.647 1030.42,446.734 1036.6,459.997 1042.06,473.426 1046.87,487.013 1051.1,500.75 1054.82,514.63 1058.09,528.646 1060.95,542.791 1063.46,557.057 1065.65,571.439 1067.57,585.929 1069.24,600.519 1070.7,615.203 1071.97,629.972 1073.07,644.819 1074.03,659.736 1074.87,674.713 1075.59,689.741 1076.22,704.811 1076.77,719.914 1077.25,735.037 1077.66,750.17 1078.02,765.302 1078.33,780.418 1078.6,795.504 1078.83,810.547 1079.03,825.529 1079.21,840.433 1079.36,855.239 1079.49,869.923 1079.61,884.463 1079.71,898.829 1079.8,912.99 1079.88,926.907 1079.95,940.535 1080,953.823 1080.06,966.702 1080.1,979.091 1080.15,990.88 1080.18,1001.92 1080.22,1012.01 1080.25,1020.82 1080.28,1027.84 1080.3,1032.06 1080.33,1031.14 1080.35,1016.34 1080.38,1063.72 1080.4,1053.13 1080.42,1073.01 1080.44,1081.82 1080.45,1082.61 1080.47,1077.39 1080.49,1065.47 1080.51,1042.48 1080.53,1017.51 1080.56,1014.28 1080.59,1027.3 1080.61,1025.75 1080.64,1019.66 1080.67,1011.54 1080.7,1002.14 1080.73,991.809 1080.77,980.762 1080.81,969.133 1080.86,957.018 1080.91,944.485 1080.97,931.587 1081.03,918.366 1081.1,904.855 1081.19,891.081 1081.28,877.068 1081.39,862.834 1081.52,848.398 1081.66,833.772 1081.82,818.972 1082.01,804.007 1082.22,788.888 1082.47,773.626 1082.76,758.227 1083.09,742.701 1083.47,727.053 1083.92,711.291 1084.43,695.421 1085.03,679.449 1085.72,663.379 1086.53,647.217 1087.47,630.967 1088.57,614.635 1089.84,598.223 1091.33,581.736 1093.07,565.178 1095.1,548.551 1097.48,531.86 1100.26,515.106 1103.51,498.294 1107.32,481.425 1111.78,464.501 1117.01,447.525 1123.14,430.499 1130.34,413.423 1138.79,396.298 1148.72,379.126 1160.38,361.905 1174.09,344.636 1190.22,327.317 1209.19,309.948 1231.53,292.526 1257.83,275.052 1288.83,257.529 1325.38,239.964 1368.48,222.384 1419.32,204.846 1479.27,187.479 1549.84,170.558 1632.56,154.658 1728.62,140.874 1837.94,135.664 \"/>\n</svg>\n","content_type":"text/html"},"image/svg+xml":{"content":"<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" width=\"500\" height=\"320\" viewBox=\"0 0 2000 1280\">\n<defs>\n  <clipPath id=\"clip880\">\n    <rect x=\"0\" y=\"0\" width=\"2000\" height=\"1280\"/>\n  </clipPath>\n</defs>\n<path clip-path=\"url(#clip880)\" d=\"M0 1280 L2000 1280 L2000 -2.66454e-14 L0 -2.66454e-14  Z\" fill=\"#ffffff\" fill-rule=\"evenodd\" fill-opacity=\"1\"/>\n<defs>\n  <clipPath id=\"clip881\">\n    <rect x=\"400\" y=\"0\" width=\"1401\" height=\"1280\"/>\n  </clipPath>\n</defs>\n<path clip-path=\"url(#clip880)\" d=\"M245.508 1111.02 L1952.76 1111.02 L1952.76 107.256 L245.508 107.256  Z\" fill=\"#ffffff\" fill-rule=\"evenodd\" fill-opacity=\"1\"/>\n<defs>\n  <clipPath id=\"clip882\">\n    <rect x=\"245\" y=\"107\" width=\"1708\" height=\"1005\"/>\n  </clipPath>\n</defs>\n<polyline clip-path=\"url(#clip882)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"245.508,1111.02 245.508,107.256 \"/>\n<polyline clip-path=\"url(#clip882)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"586.957,1111.02 586.957,107.256 \"/>\n<polyline clip-path=\"url(#clip882)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"928.407,1111.02 928.407,107.256 \"/>\n<polyline clip-path=\"url(#clip882)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"1269.86,1111.02 1269.86,107.256 \"/>\n<polyline clip-path=\"url(#clip882)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"1611.31,1111.02 1611.31,107.256 \"/>\n<polyline clip-path=\"url(#clip882)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"1952.76,1111.02 1952.76,107.256 \"/>\n<polyline clip-path=\"url(#clip882)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"245.508,1000.16 1952.76,1000.16 \"/>\n<polyline clip-path=\"url(#clip882)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"245.508,509.899 1952.76,509.899 \"/>\n<polyline clip-path=\"url(#clip880)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"245.508,1111.02 1952.76,1111.02 \"/>\n<polyline clip-path=\"url(#clip880)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"245.508,1111.02 245.508,1092.12 \"/>\n<polyline clip-path=\"url(#clip880)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"586.957,1111.02 586.957,1092.12 \"/>\n<polyline clip-path=\"url(#clip880)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"928.407,1111.02 928.407,1092.12 \"/>\n<polyline clip-path=\"url(#clip880)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"1269.86,1111.02 1269.86,1092.12 \"/>\n<polyline clip-path=\"url(#clip880)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"1611.31,1111.02 1611.31,1092.12 \"/>\n<polyline clip-path=\"url(#clip880)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"1952.76,1111.02 1952.76,1092.12 \"/>\n<path clip-path=\"url(#clip880)\" d=\"M245.508 1138.74 Q241.897 1138.74 240.068 1142.3 Q238.262 1145.84 238.262 1152.97 Q238.262 1160.08 240.068 1163.64 Q241.897 1167.19 245.508 1167.19 Q249.142 1167.19 250.947 1163.64 Q252.776 1160.08 252.776 1152.97 Q252.776 1145.84 250.947 1142.3 Q249.142 1138.74 245.508 1138.74 M245.508 1135.03 Q251.318 1135.03 254.373 1139.64 Q257.452 1144.22 257.452 1152.97 Q257.452 1161.7 254.373 1166.31 Q251.318 1170.89 245.508 1170.89 Q239.698 1170.89 236.619 1166.31 Q233.563 1161.7 233.563 1152.97 Q233.563 1144.22 236.619 1139.64 Q239.698 1135.03 245.508 1135.03 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip880)\" d=\"M577.339 1166.28 L584.978 1166.28 L584.978 1139.92 L576.668 1141.58 L576.668 1137.33 L584.932 1135.66 L589.608 1135.66 L589.608 1166.28 L597.247 1166.28 L597.247 1170.22 L577.339 1170.22 L577.339 1166.28 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip880)\" d=\"M923.06 1166.28 L939.379 1166.28 L939.379 1170.22 L917.435 1170.22 L917.435 1166.28 Q920.097 1163.53 924.68 1158.9 Q929.287 1154.25 930.467 1152.9 Q932.713 1150.38 933.592 1148.64 Q934.495 1146.89 934.495 1145.2 Q934.495 1142.44 932.55 1140.7 Q930.629 1138.97 927.527 1138.97 Q925.328 1138.97 922.875 1139.73 Q920.444 1140.5 917.666 1142.05 L917.666 1137.33 Q920.49 1136.19 922.944 1135.61 Q925.398 1135.03 927.435 1135.03 Q932.805 1135.03 936 1137.72 Q939.194 1140.4 939.194 1144.89 Q939.194 1147.02 938.384 1148.95 Q937.597 1150.84 935.49 1153.44 Q934.912 1154.11 931.81 1157.33 Q928.708 1160.52 923.06 1166.28 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip880)\" d=\"M1274.1 1151.58 Q1277.46 1152.3 1279.34 1154.57 Q1281.23 1156.84 1281.23 1160.17 Q1281.23 1165.29 1277.72 1168.09 Q1274.2 1170.89 1267.72 1170.89 Q1265.54 1170.89 1263.22 1170.45 Q1260.93 1170.03 1258.48 1169.18 L1258.48 1164.66 Q1260.42 1165.8 1262.74 1166.38 Q1265.05 1166.95 1267.58 1166.95 Q1271.97 1166.95 1274.27 1165.22 Q1276.58 1163.48 1276.58 1160.17 Q1276.58 1157.12 1274.43 1155.4 Q1272.3 1153.67 1268.48 1153.67 L1264.45 1153.67 L1264.45 1149.83 L1268.66 1149.83 Q1272.11 1149.83 1273.94 1148.46 Q1275.77 1147.07 1275.77 1144.48 Q1275.77 1141.82 1273.87 1140.4 Q1272 1138.97 1268.48 1138.97 Q1266.56 1138.97 1264.36 1139.39 Q1262.16 1139.8 1259.52 1140.68 L1259.52 1136.51 Q1262.18 1135.77 1264.5 1135.4 Q1266.84 1135.03 1268.9 1135.03 Q1274.22 1135.03 1277.32 1137.46 Q1280.42 1139.87 1280.42 1143.99 Q1280.42 1146.86 1278.78 1148.85 Q1277.14 1150.82 1274.1 1151.58 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip880)\" d=\"M1614.32 1139.73 L1602.51 1158.18 L1614.32 1158.18 L1614.32 1139.73 M1613.09 1135.66 L1618.97 1135.66 L1618.97 1158.18 L1623.9 1158.18 L1623.9 1162.07 L1618.97 1162.07 L1618.97 1170.22 L1614.32 1170.22 L1614.32 1162.07 L1598.71 1162.07 L1598.71 1157.56 L1613.09 1135.66 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip880)\" d=\"M1943.03 1135.66 L1961.39 1135.66 L1961.39 1139.59 L1947.32 1139.59 L1947.32 1148.07 Q1948.33 1147.72 1949.35 1147.56 Q1950.37 1147.37 1951.39 1147.37 Q1957.18 1147.37 1960.56 1150.54 Q1963.94 1153.71 1963.94 1159.13 Q1963.94 1164.71 1960.46 1167.81 Q1956.99 1170.89 1950.67 1170.89 Q1948.5 1170.89 1946.23 1170.52 Q1943.98 1170.15 1941.58 1169.41 L1941.58 1164.71 Q1943.66 1165.84 1945.88 1166.4 Q1948.1 1166.95 1950.58 1166.95 Q1954.58 1166.95 1956.92 1164.85 Q1959.26 1162.74 1959.26 1159.13 Q1959.26 1155.52 1956.92 1153.41 Q1954.58 1151.31 1950.58 1151.31 Q1948.71 1151.31 1946.83 1151.72 Q1944.98 1152.14 1943.03 1153.02 L1943.03 1135.66 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><g clip-path=\"url(#clip880)\">\n<image width=\"20\" height=\"42\" xlink:href=\"data:image/png;base64,\niVBORw0KGgoAAAANSUhEUgAAABQAAAAqCAYAAACz+XvQAAABb0lEQVRIia2WXbGEMAyFT6+CggQk\noAUN4AANSAAL4KAaKgENAQfZhws70B8mLduZPADpafr1TAqYGSlBRNy2LVtrOfQ9SWyeZwbwjXVd\nPdEkwasYAB7H0RNUR6JoKKVuycys3Jw/qdg0TbKVpdvVWt+2+z/VzxNXuO/77bnv+2CemKGEHyBk\nuCyL/OQk/KqqEvET+9AVG4YhKihiKOUHCBgm8QMAa63HJze01mHDvokvw23bglsry/L2TETR3RZF\noZLaFR7sIrKN6z+t9TtBt7pQ/0vyYYr/zhH1obj/uUPa/yT8Hhkig98jwxx+QIRhNr9j5Z/xizJE\nJr8ow1x+QIDhK37H6j/jF2SIF/xEglKh8+K6vRzHMbn/XecR0fv+d92VV2EOP2MMA2BjDHs+zPHf\nOefMFf99hUbXdQw4F1fuCa/rygC4aZpb3qOpY2JEFD20Rx8SkTfhPISYA6KeckWvd3Rd19HqH/mE\nIlT1NT62/UqELBm6rwAAAABJRU5ErkJggg==\n\" transform=\"translate(1089, 1200)\"/>\n</g>\n<polyline clip-path=\"url(#clip880)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"245.508,1111.02 245.508,107.256 \"/>\n<polyline clip-path=\"url(#clip880)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"245.508,1000.16 264.405,1000.16 \"/>\n<polyline clip-path=\"url(#clip880)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"245.508,509.899 264.405,509.899 \"/>\n<path clip-path=\"url(#clip880)\" d=\"M113.675 1019.96 L121.314 1019.96 L121.314 993.592 L113.004 995.258 L113.004 990.999 L121.268 989.332 L125.944 989.332 L125.944 1019.96 L133.583 1019.96 L133.583 1023.89 L113.675 1023.89 L113.675 1019.96 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip880)\" d=\"M153.027 992.411 Q149.416 992.411 147.587 995.976 Q145.782 999.518 145.782 1006.65 Q145.782 1013.75 147.587 1017.32 Q149.416 1020.86 153.027 1020.86 Q156.661 1020.86 158.467 1017.32 Q160.295 1013.75 160.295 1006.65 Q160.295 999.518 158.467 995.976 Q156.661 992.411 153.027 992.411 M153.027 988.707 Q158.837 988.707 161.893 993.314 Q164.971 997.897 164.971 1006.65 Q164.971 1015.37 161.893 1019.98 Q158.837 1024.56 153.027 1024.56 Q147.217 1024.56 144.138 1019.98 Q141.082 1015.37 141.082 1006.65 Q141.082 997.897 144.138 993.314 Q147.217 988.707 153.027 988.707 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip880)\" d=\"M164.971 982.809 L189.083 982.809 L189.083 986.006 L164.971 986.006 L164.971 982.809 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip880)\" d=\"M207.721 971.712 L198.129 986.702 L207.721 986.702 L207.721 971.712 M206.724 968.402 L211.502 968.402 L211.502 986.702 L215.508 986.702 L215.508 989.862 L211.502 989.862 L211.502 996.482 L207.721 996.482 L207.721 989.862 L195.045 989.862 L195.045 986.194 L206.724 968.402 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip880)\" d=\"M115.368 529.691 L123.007 529.691 L123.007 503.326 L114.697 504.992 L114.697 500.733 L122.96 499.066 L127.636 499.066 L127.636 529.691 L135.275 529.691 L135.275 533.626 L115.368 533.626 L115.368 529.691 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip880)\" d=\"M154.72 502.145 Q151.108 502.145 149.28 505.71 Q147.474 509.252 147.474 516.381 Q147.474 523.488 149.28 527.052 Q151.108 530.594 154.72 530.594 Q158.354 530.594 160.159 527.052 Q161.988 523.488 161.988 516.381 Q161.988 509.252 160.159 505.71 Q158.354 502.145 154.72 502.145 M154.72 498.441 Q160.53 498.441 163.585 503.048 Q166.664 507.631 166.664 516.381 Q166.664 525.108 163.585 529.714 Q160.53 534.298 154.72 534.298 Q148.909 534.298 145.831 529.714 Q142.775 525.108 142.775 516.381 Q142.775 507.631 145.831 503.048 Q148.909 498.441 154.72 498.441 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip880)\" d=\"M166.664 492.543 L190.775 492.543 L190.775 495.74 L166.664 495.74 L166.664 492.543 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip880)\" d=\"M202.248 503.019 L215.508 503.019 L215.508 506.216 L197.678 506.216 L197.678 503.019 Q199.841 500.781 203.565 497.019 Q207.308 493.239 208.267 492.148 Q210.091 490.098 210.806 488.687 Q211.539 487.258 211.539 485.885 Q211.539 483.647 209.959 482.236 Q208.398 480.826 205.878 480.826 Q204.091 480.826 202.098 481.446 Q200.123 482.067 197.866 483.327 L197.866 479.49 Q200.161 478.569 202.154 478.098 Q204.148 477.628 205.803 477.628 Q210.166 477.628 212.762 479.81 Q215.357 481.992 215.357 485.64 Q215.357 487.371 214.699 488.932 Q214.06 490.474 212.348 492.58 Q211.878 493.126 209.358 495.74 Q206.837 498.336 202.248 503.019 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><g clip-path=\"url(#clip880)\">\n<text style=\"fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:66px; text-anchor:middle;\" transform=\"rotate(-90, 71.4418, 609.137)\" x=\"71.4418\" y=\"609.137\">step size</text>\n</g>\n<g clip-path=\"url(#clip880)\">\n<text style=\"fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:66px; text-anchor:middle;\" transform=\"rotate(0, 1099.13, 57.6)\" x=\"1099.13\" y=\"57.6\">Adaptive step sizes</text>\n</g>\n<polyline clip-path=\"url(#clip882)\" style=\"stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none\" points=\"245.508,501.98 249.186,354.395 263.898,325.393 283.218,336.127 300.685,343.179 317.033,346.864 332.824,348.257 348.409,347.805 364.062,345.672 380.031,341.853 396.583,336.198 414.038,328.349 432.829,317.582 453.619,302.269 477.626,277.557 507.905,262.52 542.778,255.132 580.158,273.539 611.602,278.885 641.505,280.343 671.003,280.884 700.35,281.538 729.518,282.904 758.314,285.377 786.449,289.188 813.595,294.41 839.441,300.988 863.739,308.773 886.323,317.581 907.113,327.224 926.104,337.54 943.34,348.396 958.906,359.692 972.904,371.354 985.45,383.325 996.662,395.566 1006.66,408.048 1015.54,420.747 1023.43,433.647 1030.42,446.734 1036.6,459.997 1042.06,473.426 1046.87,487.013 1051.1,500.75 1054.82,514.63 1058.09,528.646 1060.95,542.791 1063.46,557.057 1065.65,571.439 1067.57,585.929 1069.24,600.519 1070.7,615.203 1071.97,629.972 1073.07,644.819 1074.03,659.736 1074.87,674.713 1075.59,689.741 1076.22,704.811 1076.77,719.914 1077.25,735.037 1077.66,750.17 1078.02,765.302 1078.33,780.418 1078.6,795.504 1078.83,810.547 1079.03,825.529 1079.21,840.433 1079.36,855.239 1079.49,869.923 1079.61,884.463 1079.71,898.829 1079.8,912.99 1079.88,926.907 1079.95,940.535 1080,953.823 1080.06,966.702 1080.1,979.091 1080.15,990.88 1080.18,1001.92 1080.22,1012.01 1080.25,1020.82 1080.28,1027.84 1080.3,1032.06 1080.33,1031.14 1080.35,1016.34 1080.38,1063.72 1080.4,1053.13 1080.42,1073.01 1080.44,1081.82 1080.45,1082.61 1080.47,1077.39 1080.49,1065.47 1080.51,1042.48 1080.53,1017.51 1080.56,1014.28 1080.59,1027.3 1080.61,1025.75 1080.64,1019.66 1080.67,1011.54 1080.7,1002.14 1080.73,991.809 1080.77,980.762 1080.81,969.133 1080.86,957.018 1080.91,944.485 1080.97,931.587 1081.03,918.366 1081.1,904.855 1081.19,891.081 1081.28,877.068 1081.39,862.834 1081.52,848.398 1081.66,833.772 1081.82,818.972 1082.01,804.007 1082.22,788.888 1082.47,773.626 1082.76,758.227 1083.09,742.701 1083.47,727.053 1083.92,711.291 1084.43,695.421 1085.03,679.449 1085.72,663.379 1086.53,647.217 1087.47,630.967 1088.57,614.635 1089.84,598.223 1091.33,581.736 1093.07,565.178 1095.1,548.551 1097.48,531.86 1100.26,515.106 1103.51,498.294 1107.32,481.425 1111.78,464.501 1117.01,447.525 1123.14,430.499 1130.34,413.423 1138.79,396.298 1148.72,379.126 1160.38,361.905 1174.09,344.636 1190.22,327.317 1209.19,309.948 1231.53,292.526 1257.83,275.052 1288.83,257.529 1325.38,239.964 1368.48,222.384 1419.32,204.846 1479.27,187.479 1549.84,170.558 1632.56,154.658 1728.62,140.874 1837.94,135.664 \"/>\n</svg>\n","content_type":"image/svg+xml"}}}],"key":"R2dHrRNULI"}],"data":{},"key":"IRRcJElBUz"},{"type":"paragraph","position":{"start":{"line":503,"column":1},"end":{"line":503,"column":1}},"children":[{"type":"text","value":"If we had to run with a uniform step size to get this accuracy, it would be","position":{"start":{"line":503,"column":1},"end":{"line":503,"column":1}},"key":"ycfhzNMQjZ"}],"key":"acmhzer6oX"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"println(\"minimum step size = $(minimum(Δt))\")","key":"EN4qlsCKwM"},{"type":"output","id":"P_MWxMv2YO6NZhvYJ2Fkf","data":[{"output_type":"stream","name":"stdout","text":"minimum step size = 4.6096854609878335e-5\n"}],"key":"n1IECnBEIX"}],"data":{},"key":"LVBiRKstGe"},{"type":"paragraph","position":{"start":{"line":509,"column":1},"end":{"line":509,"column":1}},"children":[{"type":"text","value":"On the other hand, the average step size that was actually taken was","position":{"start":{"line":509,"column":1},"end":{"line":509,"column":1}},"key":"So5BgvXUPR"}],"key":"kWWii696xg"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"println(\"average step size = $(sum(Δt)/(length(t)-1))\")","key":"KGudO9wqhj"},{"type":"output","id":"8OP7S6PA2fF6E7dBZ5lAl","data":[{"output_type":"stream","name":"stdout","text":"average step size = 0.03205128205128205\n"}],"key":"s80hnKfZKz"}],"data":{},"key":"Imzi8GbyNv"},{"type":"paragraph","position":{"start":{"line":515,"column":1},"end":{"line":515,"column":1}},"children":[{"type":"text","value":"We took fewer steps by a factor of almost 1000! Even accounting for the extra stage per step and the occasional rejected step, the savings are clear.","position":{"start":{"line":515,"column":1},"end":{"line":515,"column":1}},"key":"FR2iH8mwcj"}],"key":"r94XaFKylx"}],"key":"alYm8N6Jkp"}],"key":"cm6wyiHAVV"}],"key":"YhrmCFX7PW"},{"type":"tabItem","title":"MATLAB","sync":"matlab","children":[{"type":"embed","source":{"url":"/chapter6-1","label":"demo-adapt-basic-matlab","kind":"Notebook","slug":"chapter6-1","location":"/matlab/chapter6.md","title":"Chapter 6"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-adapt-basic","label":"demo-adapt-basic","kind":"proof:example","position":{"start":{"line":423,"column":1},"end":{"line":423,"column":18}},"children":[{"type":"text","value":"Example ","key":"wZBGIakmjl"},{"type":"text","value":"6.5.1","key":"XOBe0AxKk7"}],"template":"Example %s","enumerator":"6.5.1","resolved":true,"html_id":"demo-adapt-basic","remote":true,"url":"/adaptive-rk","dataUrl":"/adaptive-rk.json","key":"nkKcKGb9MG"}],"key":"VdTC0rLwam"},{"type":"paragraph","position":{"start":{"line":425,"column":1},"end":{"line":425,"column":1}},"children":[{"type":"text","value":"Let’s run adaptive RK on  ","position":{"start":{"line":425,"column":1},"end":{"line":425,"column":1}},"key":"Ba7V4NOH1Z"},{"type":"inlineMath","value":"u'=e^{t-u\\sin u}","position":{"start":{"line":425,"column":1},"end":{"line":425,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>u</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo>=</mo><msup><mi>e</mi><mrow><mi>t</mi><mo>−</mo><mi>u</mi><mi>sin</mi><mo>⁡</mo><mi>u</mi></mrow></msup></mrow><annotation encoding=\"application/x-tex\">u&#x27;=e^{t-u\\sin u}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8305em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8305em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mbin mtight\">−</span><span class=\"mord mathnormal mtight\">u</span><span class=\"mspace mtight\" style=\"margin-right:0.1952em;\"></span><span class=\"mop mtight\"><span class=\"mtight\">s</span><span class=\"mtight\">i</span><span class=\"mtight\">n</span></span><span class=\"mspace mtight\" style=\"margin-right:0.1952em;\"></span><span class=\"mord mathnormal mtight\">u</span></span></span></span></span></span></span></span></span></span></span></span>","key":"oCDT3FwyrU"},{"type":"text","value":".","position":{"start":{"line":425,"column":1},"end":{"line":425,"column":1}},"key":"uyvBY089Xm"}],"key":"OjITwEiFtK"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"ivp = ode;\nivp.ODEFcn = @(t, u, p) exp(t - u * sin(u));\nivp.InitialValue = 0;\na = 0;  b = 5;\n\n[t, u] = rk23(ivp, a, b, 1e-5);\nclf, plot(t, u)\nxlabel(\"t\");  ylabel(\"u(t)\")\ntitle((\"Adaptive IVP solution\"));","key":"rzoPUYKbWO"},{"type":"output","id":"zilLmuqM7ooOX7dtY1RX-","data":[{"output_type":"execute_result","execution_count":27,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"b7655b9dbc10554bdcd78220c8aedd64","path":"/build/b7655b9dbc10554bdcd78220c8aedd64.png"}}}],"key":"zkerIBk3gH"}],"data":{},"key":"ByGb0ik9GN"},{"type":"paragraph","position":{"start":{"line":439,"column":1},"end":{"line":439,"column":1}},"children":[{"type":"text","value":"The solution makes a very abrupt change near ","position":{"start":{"line":439,"column":1},"end":{"line":439,"column":1}},"key":"NNqHHsCIAQ"},{"type":"inlineMath","value":"t=2.4","position":{"start":{"line":439,"column":1},"end":{"line":439,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi><mo>=</mo><mn>2.4</mn></mrow><annotation encoding=\"application/x-tex\">t=2.4</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2.4</span></span></span></span>","key":"jc0w3NKh9F"},{"type":"text","value":". The resulting time steps vary over three orders of magnitude.","position":{"start":{"line":439,"column":1},"end":{"line":439,"column":1}},"key":"sBQUqLbjdv"}],"key":"GVccNDapoo"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"Delta_t = diff(t);\nsemilogy(t(1:end-1), Delta_t) \nxlabel(\"t\");  ylabel(\"step size\")\ntitle((\"Adaptive step sizes\"));","key":"ZHTfzyESGZ"},{"type":"output","id":"hIaK8ehEOvjJmG5y5ZInj","data":[{"output_type":"execute_result","execution_count":28,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"d5c7b9332417b8169630c0d4f16506a9","path":"/build/d5c7b9332417b8169630c0d4f16506a9.png"}}}],"key":"jXvOdW2jM7"}],"data":{},"key":"IuSPI3gJe0"},{"type":"paragraph","position":{"start":{"line":448,"column":1},"end":{"line":448,"column":1}},"children":[{"type":"text","value":"If we had to run with a uniform step size to get this accuracy, it would be","position":{"start":{"line":448,"column":1},"end":{"line":448,"column":1}},"key":"uS5c33nzjQ"}],"key":"aQ0lcxO9VZ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"fprintf(\"minimum step size = %.2e\", min(Delta_t))","key":"ld2bphEYlw"},{"type":"output","id":"ZKfawd277mBLxEkDhvnNO","data":[{"output_type":"stream","name":"stdout","text":"minimum step size = "}],"key":"FFdJ9iR6uZ"}],"data":{},"key":"lQjzhDXIG8"},{"type":"paragraph","position":{"start":{"line":454,"column":1},"end":{"line":454,"column":1}},"children":[{"type":"text","value":"On the other hand, the average step size that was actually taken was","position":{"start":{"line":454,"column":1},"end":{"line":454,"column":1}},"key":"h8JB2QXLYQ"}],"key":"Al7sscYstJ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"fprintf(\"average step size = %.2e\", mean(Delta_t))","key":"hEPUM6Atuu"},{"type":"output","id":"JE7TsLL4vZ1h4HcZYSPLE","data":[{"output_type":"stream","name":"stdout","text":"average step size = "},{"output_type":"stream","name":"stdout","text":"NaN"}],"key":"sioVEo5Dxj"}],"data":{},"key":"DiBzR6AtTI"},{"type":"paragraph","position":{"start":{"line":460,"column":1},"end":{"line":460,"column":1}},"children":[{"type":"text","value":"We took fewer steps by a factor of almost 1000! Even accounting for the extra stage per step and the occasional rejected step, the savings are clear.","position":{"start":{"line":460,"column":1},"end":{"line":460,"column":1}},"key":"qGDUqsd5wu"}],"key":"wOHiKW7ks6"}],"key":"cDyihakS7k"}],"key":"hxRJRWUE6T"}],"key":"QzIubIJ5BV"},{"type":"tabItem","title":"Python","sync":"python","children":[{"type":"embed","source":{"url":"/chapter6-2","label":"demo-adapt-basic-python","kind":"Notebook","slug":"chapter6-2","location":"/python/chapter6.md","title":"Chapter 6"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-adapt-basic","label":"demo-adapt-basic","kind":"proof:example","position":{"start":{"line":438,"column":1},"end":{"line":438,"column":18}},"children":[{"type":"text","value":"Example ","key":"Y51zIBEhZ3"},{"type":"text","value":"6.5.1","key":"zwSEZE6dvb"}],"template":"Example %s","enumerator":"6.5.1","resolved":true,"html_id":"demo-adapt-basic","remote":true,"url":"/adaptive-rk","dataUrl":"/adaptive-rk.json","key":"uUNDrzDUbw"}],"key":"VF1u6IT514"},{"type":"paragraph","position":{"start":{"line":440,"column":1},"end":{"line":440,"column":1}},"children":[{"type":"text","value":"Let’s run adaptive RK on  ","position":{"start":{"line":440,"column":1},"end":{"line":440,"column":1}},"key":"tQNphgyEIZ"},{"type":"inlineMath","value":"u'=e^{t-u\\sin u}","position":{"start":{"line":440,"column":1},"end":{"line":440,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>u</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo>=</mo><msup><mi>e</mi><mrow><mi>t</mi><mo>−</mo><mi>u</mi><mi>sin</mi><mo>⁡</mo><mi>u</mi></mrow></msup></mrow><annotation encoding=\"application/x-tex\">u&#x27;=e^{t-u\\sin u}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8305em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8305em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mbin mtight\">−</span><span class=\"mord mathnormal mtight\">u</span><span class=\"mspace mtight\" style=\"margin-right:0.1952em;\"></span><span class=\"mop mtight\"><span class=\"mtight\">s</span><span class=\"mtight\">i</span><span class=\"mtight\">n</span></span><span class=\"mspace mtight\" style=\"margin-right:0.1952em;\"></span><span class=\"mord mathnormal mtight\">u</span></span></span></span></span></span></span></span></span></span></span></span>","key":"ptD7Vmymcg"},{"type":"text","value":".","position":{"start":{"line":440,"column":1},"end":{"line":440,"column":1}},"key":"bIEsGSvfI3"}],"key":"IcP6OYiI3o"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"f = lambda t, u: exp(t - u * sin(u))\nt, u = FNC.rk23(f, [0.0, 5.0], [0.0], 1e-5)\nscatter(t, u[0, :])\nxlabel(\"$t$\"), ylabel(\"$u(t)$\")\ntitle((\"Adaptive IVP solution\"));","key":"vYfxdIC898"},{"type":"output","id":"2GxsRz69bl5Nd5guPND_A","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"2c0ef544586d85369ca444b7e24692df","path":"/build/2c0ef544586d85369ca444b7e24692df.png"}}}],"key":"V2Gm1m4hla"}],"data":{},"key":"Lz0cNpNthY"},{"type":"paragraph","position":{"start":{"line":450,"column":1},"end":{"line":450,"column":1}},"children":[{"type":"text","value":"The solution makes a very abrupt change near ","position":{"start":{"line":450,"column":1},"end":{"line":450,"column":1}},"key":"MvcApUpU0z"},{"type":"inlineMath","value":"t=2.4","position":{"start":{"line":450,"column":1},"end":{"line":450,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi><mo>=</mo><mn>2.4</mn></mrow><annotation encoding=\"application/x-tex\">t=2.4</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2.4</span></span></span></span>","key":"omZL4gGAoc"},{"type":"text","value":". The resulting time steps vary over three orders of magnitude.","position":{"start":{"line":450,"column":1},"end":{"line":450,"column":1}},"key":"ySrluawZAt"}],"key":"ZBf5QWXBU6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"dt = [t[i + 1] - t[i] for i in range(t.size - 1)]\nsemilogy(t[:-1], dt)\nxlabel(\"$t$\"), ylabel(\"time step\")\ntitle((\"Adaptive step sizes\"));","key":"WjUD8s5Tbw"},{"type":"output","id":"207OEK_C7U4J422lA6WSh","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"6f5f1476588f27b429711a2efee7a657","path":"/build/6f5f1476588f27b429711a2efee7a657.png"}}}],"key":"vjytWPOJjN"}],"data":{},"key":"ukSPagKNSl"},{"type":"paragraph","position":{"start":{"line":459,"column":1},"end":{"line":459,"column":1}},"children":[{"type":"text","value":"If we had to run with a uniform step size to get this accuracy, it would be","position":{"start":{"line":459,"column":1},"end":{"line":459,"column":1}},"key":"VYqh4t4D3M"}],"key":"iymfrRicRf"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(f\"min step size was {min(dt):.2e}\")","key":"IbaT3O5Sb8"},{"type":"output","id":"RYxUq0BGq5AR6fg_GVUO0","data":[{"output_type":"stream","name":"stdout","text":"min step size was 4.61e-05\n"}],"key":"pmbzgk2xNG"}],"data":{},"key":"WXlYvLIDMO"},{"type":"paragraph","position":{"start":{"line":465,"column":1},"end":{"line":465,"column":1}},"children":[{"type":"text","value":"On the other hand, the average step size that was actually taken was","position":{"start":{"line":465,"column":1},"end":{"line":465,"column":1}},"key":"pwTE7c6aMX"}],"key":"Y8WWqqbcjl"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(f\"mean step size was {mean(dt):.2e}\")","key":"w6mtzAzloT"},{"type":"output","id":"qNgCwOSQaKHTgSZc9Oqcu","data":[{"output_type":"stream","name":"stdout","text":"mean step size was 3.21e-02\n"}],"key":"JQaoZq0R9g"}],"data":{},"key":"ZRpCZUXHkI"},{"type":"paragraph","position":{"start":{"line":471,"column":1},"end":{"line":471,"column":1}},"children":[{"type":"text","value":"We took fewer steps by a factor of 1000! Even accounting for the extra stage per step and the occasional rejected step, the savings are clear.","position":{"start":{"line":471,"column":1},"end":{"line":471,"column":1}},"key":"v9vqPewaK2"}],"key":"LUll3IQ8hk"}],"key":"ZqRUyZLsYN"}],"key":"fUdH0FHwtD"}],"key":"UtqHO7kdrB"}],"key":"BaLllNmu60"}],"label":"demo-adapt-basic","identifier":"demo-adapt-basic","html_id":"demo-adapt-basic","enumerator":"6.5.1","key":"FJxe74pU9T"},{"type":"proof","kind":"example","enumerated":true,"children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Adaptive step size near a singularity","position":{"start":{"line":134,"column":1},"end":{"line":134,"column":1}},"key":"RBrCRtqwXV"}],"key":"hHjKzZay7e"},{"type":"tabSet","children":[{"type":"tabItem","title":"Julia","sync":"julia","children":[{"type":"embed","source":{"url":"/chapter6","label":"demo-adapt-sing-julia","kind":"Notebook","slug":"chapter6","location":"/julia/chapter6.md","title":"Chapter 6"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-adapt-sing","label":"demo-adapt-sing","kind":"proof:example","position":{"start":{"line":520,"column":1},"end":{"line":520,"column":17}},"children":[{"type":"text","value":"Example ","key":"LnHfy4igHM"},{"type":"text","value":"6.5.2","key":"N6KIq2fqIK"}],"template":"Example %s","enumerator":"6.5.2","resolved":true,"html_id":"demo-adapt-sing","remote":true,"url":"/adaptive-rk","dataUrl":"/adaptive-rk.json","key":"dzgOvKEnhv"}],"key":"kTcf3O3tL6"},{"type":"paragraph","position":{"start":{"line":522,"column":1},"end":{"line":522,"column":1}},"children":[{"type":"text","value":"In ","position":{"start":{"line":522,"column":1},"end":{"line":522,"column":1}},"key":"aLyylyvzaV"},{"type":"crossReference","kind":"proof:example","identifier":"demo-basics-sing","label":"demo-basics-sing","children":[{"type":"text","value":"Demo ","key":"R7eTqPZvit"},{"type":"text","value":"6.1.3","key":"r3So90MAM7"}],"template":"Example %s","enumerator":"6.1.3","resolved":true,"html_id":"demo-basics-sing","remote":true,"url":"/basics","dataUrl":"/basics.json","key":"j7Z5YQM32D"},{"type":"text","value":" we saw an ","key":"bNgE62cUJv"},{"type":"abbreviation","title":"initial-value problem","children":[{"type":"text","value":"IVP","key":"yZtjctaZtH"}],"key":"pZ53ASQOEZ"},{"type":"text","value":" that appears to blow up in a finite amount of time. Because the solution increases so rapidly as it approaches the blowup, adaptive stepping is required even to get close.","key":"ixwu00BfMb"}],"key":"ZCwhMGQO2V"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"f(u, p, t) = (t + u)^2\nivp = ODEProblem(f, 1, (0.0, 1.0))\nt, u = FNC.rk23(ivp, 1e-5);","key":"sGaW19ep5n"},{"type":"output","id":"Un-yvgrsBst4u7O85SMnJ","data":[{"output_type":"stream","name":"stderr","text":"\u001b[33m\u001b[1m┌ \u001b[22m\u001b[39m\u001b[33m\u001b[1mWarning: \u001b[22m\u001b[39mStepsize too small near t=0.7854087204072808\n\u001b[33m\u001b[1m└ \u001b[22m\u001b[39m\u001b[90m@ FNCFunctions ~/.julia/packages/FNCFunctions/CAkzc/src/chapter06.jl:102\u001b[39m\n"}],"key":"TJQZxqlmCr"}],"data":{},"key":"TuXp4mftRe"},{"type":"paragraph","position":{"start":{"line":530,"column":1},"end":{"line":530,"column":1}},"children":[{"type":"text","value":"In fact, the failure of the adaptivity gives a decent idea of when the singularity occurs.","position":{"start":{"line":530,"column":1},"end":{"line":530,"column":1}},"key":"oa6FNjW4fx"}],"key":"Wb2cqVgCCG"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"plot(t, u;\n    legend=:none,\n    xlabel=L\"t\",  yaxis=(:log10, L\"u(t)\"), \n    title=\"Finite-time blowup\")\n\ntf = t[end]\nvline!([tf], l=:dash)\nannotate!(tf, 1e5, latexstring(@sprintf(\"t = %.6f \", tf)), :right)","key":"u2nJfz0G4f"},{"type":"output","id":"Vqax0QEK0_zuhgIOpZa9-","data":[{"output_type":"execute_result","execution_count":37,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"79dfa2cf97e3907772dff193a0db65fa","path":"/build/79dfa2cf97e3907772dff193a0db65fa.png"},"text/html":{"content_type":"text/html","hash":"c13d210a22c158a64a3786e84e7e33ff","path":"/build/c13d210a22c158a64a3786e84e7e33ff.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"606aedf7f3f514f3cc23ae27d945fa2d","path":"/build/606aedf7f3f514f3cc23ae27d945fa2d.svg"}}}],"key":"WI74tmCRwd"}],"data":{},"key":"hV3iUfxptL"}],"key":"aP105TpYln"}],"key":"SYWCRrmZpI"}],"key":"yfXkXOuikO"},{"type":"tabItem","title":"MATLAB","sync":"matlab","children":[{"type":"embed","source":{"url":"/chapter6-1","label":"demo-adapt-sing-matlab","kind":"Notebook","slug":"chapter6-1","location":"/matlab/chapter6.md","title":"Chapter 6"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-adapt-sing","label":"demo-adapt-sing","kind":"proof:example","position":{"start":{"line":465,"column":1},"end":{"line":465,"column":17}},"children":[{"type":"text","value":"Example ","key":"cUAZUGEFRq"},{"type":"text","value":"6.5.2","key":"giK9YWq0DH"}],"template":"Example %s","enumerator":"6.5.2","resolved":true,"html_id":"demo-adapt-sing","remote":true,"url":"/adaptive-rk","dataUrl":"/adaptive-rk.json","key":"dTqA6F4qJd"}],"key":"M5KMYPDGT3"},{"type":"paragraph","position":{"start":{"line":467,"column":1},"end":{"line":467,"column":1}},"children":[{"type":"text","value":"In ","position":{"start":{"line":467,"column":1},"end":{"line":467,"column":1}},"key":"bXQbMANIOI"},{"type":"crossReference","kind":"proof:example","identifier":"demo-basics-sing","label":"demo-basics-sing","children":[{"type":"text","value":"Demo ","key":"A3jgpVOS9k"},{"type":"text","value":"6.1.3","key":"dVkTAxi4No"}],"template":"Example %s","enumerator":"6.1.3","resolved":true,"html_id":"demo-basics-sing","remote":true,"url":"/basics","dataUrl":"/basics.json","key":"PaLmpn5ZMj"},{"type":"text","value":" we saw an ","key":"wbjE7yFUqC"},{"type":"abbreviation","title":"initial-value problem","children":[{"type":"text","value":"IVP","key":"UK5LdBoOfv"}],"key":"tqCmIG55ii"},{"type":"text","value":" that appears to blow up in a finite amount of time. Because the solution increases so rapidly as it approaches the blowup, adaptive stepping is required even to get close.","key":"Vvdzatoety"}],"key":"ZakPAiCfVc"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"ivp = ode;\nivp.ODEFcn = @(t, u, p) (t + u)^2;\nivp.InitialValue = 1;\n[t, u] = rk23(ivp, 0, 1, 1e-5);","key":"KoyOB0T08H"},{"type":"output","id":"zmdhKcDx8Pw1zzRwbMTPj","data":[],"key":"Qkl7znakkr"}],"data":{},"key":"acfW37Gw0w"},{"type":"paragraph","position":{"start":{"line":476,"column":1},"end":{"line":476,"column":1}},"children":[{"type":"text","value":"In fact, the failure of the adaptivity gives a decent idea of when the singularity occurs.","position":{"start":{"line":476,"column":1},"end":{"line":476,"column":1}},"key":"BMceXGKoOj"}],"key":"hckxwqbc12"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf, semilogy(t, u)\nxlabel(\"t\");  ylabel(\"u(t)\")\ntitle(\"Adaptive solution near a singularity\")\n\ntf = t(end);\nxline(tf, \"linestyle\", \"--\")\ntext(tf, 1e5, sprintf(\" t = %.6f \", tf))","key":"gr6elVkOzZ"},{"type":"output","id":"KlEoLihu57ZeUkasqxT0B","data":[{"output_type":"execute_result","execution_count":32,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"ad6d29b9b980b17b71877a37063f3990","path":"/build/ad6d29b9b980b17b71877a37063f3990.png"}}}],"key":"JURTvOCXwu"}],"data":{},"key":"AHQuDMpRfY"}],"key":"x0KRjdQZ1f"}],"key":"dQYkaGI4tD"}],"key":"LBx4Qvz3OA"},{"type":"tabItem","title":"Python","sync":"python","children":[{"type":"embed","source":{"url":"/chapter6-2","label":"demo-adapt-sing-python","kind":"Notebook","slug":"chapter6-2","location":"/python/chapter6.md","title":"Chapter 6"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-adapt-sing","label":"demo-adapt-sing","kind":"proof:example","position":{"start":{"line":476,"column":1},"end":{"line":476,"column":17}},"children":[{"type":"text","value":"Example ","key":"zQKvIWpzq1"},{"type":"text","value":"6.5.2","key":"uAd5AxfChn"}],"template":"Example %s","enumerator":"6.5.2","resolved":true,"html_id":"demo-adapt-sing","remote":true,"url":"/adaptive-rk","dataUrl":"/adaptive-rk.json","key":"U9cjdmOxPk"}],"key":"fbZeiLXF3N"},{"type":"paragraph","position":{"start":{"line":478,"column":1},"end":{"line":478,"column":1}},"children":[{"type":"text","value":"In ","position":{"start":{"line":478,"column":1},"end":{"line":478,"column":1}},"key":"OVdKDfP5Zi"},{"type":"crossReference","kind":"proof:example","identifier":"demo-basics-sing","label":"demo-basics-sing","children":[{"type":"text","value":"Demo ","key":"OShtru6T7k"},{"type":"text","value":"6.1.3","key":"IzzFPRJxWU"}],"template":"Example %s","enumerator":"6.1.3","resolved":true,"html_id":"demo-basics-sing","remote":true,"url":"/basics","dataUrl":"/basics.json","key":"tqR9zJO05C"},{"type":"text","value":" we saw an ","key":"cQN8idQVgV"},{"type":"abbreviation","title":"initial-value problem","children":[{"type":"text","value":"IVP","key":"kUjGp10rx7"}],"key":"yEjLyMzvoI"},{"type":"text","value":" that appears to blow up in a finite amount of time. Because the solution increases so rapidly as it approaches the blowup, adaptive stepping is required even to get close.","key":"PPLdiZmhuS"}],"key":"pd7uLDe6Wj"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"du_dt = lambda t, u: (t + u)**2\ntspan = (0.0, 2.0)\nu0 = [1.0]\nt, u = FNC.rk23(du_dt, tspan, u0, 1e-5)","key":"SnIphAL0WI"},{"type":"output","id":"-H7IRRJsNsdO-uV0---As","data":[{"output_type":"stream","name":"stderr","text":"/Users/driscoll/Dropbox/Mac/Documents/GitHub/fnc/python/fncbook/fncbook/chapter06.py:90: UserWarning: Stepsize too small near t=0.785408720407281\n  warnings.warn(f\"Stepsize too small near t={t[i]}\")\n"}],"key":"mh9x3NVQFB"}],"data":{},"key":"rJUElNViXT"},{"type":"paragraph","position":{"start":{"line":487,"column":1},"end":{"line":487,"column":1}},"children":[{"type":"text","value":"In fact, the failure of the adaptivity gives a decent idea of when the singularity occurs.","position":{"start":{"line":487,"column":1},"end":{"line":487,"column":1}},"key":"rMptGfXd0k"}],"key":"fJDfg0YifP"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"semilogy(t, u[0, :])\nxlabel(\"$t$\"),  ylabel(\"$u(t)$\")\ntitle(\"Finite-time blowup\")\n\ntf = t[-1]\naxvline(x=tf, color='k', linestyle='--', label=f\"t = {tf:.6f}\")\nlegend();","key":"NWOcbkzoqS"},{"type":"output","id":"dKjCrAr6DFPpBz5yRpNzc","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"9f9078bced9942279526825f3bba9ade","path":"/build/9f9078bced9942279526825f3bba9ade.png"}}}],"key":"gHTdl38bKS"}],"data":{},"key":"Q7CjsT6jRM"}],"key":"Kurz3xZmgF"}],"key":"E6x6rSwxIp"}],"key":"e0aVCC9aXI"}],"key":"cM03yYSpjb"}],"label":"demo-adapt-sing","identifier":"demo-adapt-sing","html_id":"demo-adapt-sing","enumerator":"6.5.2","key":"BF2mLZEd3m"},{"type":"paragraph","position":{"start":{"line":161,"column":1},"end":{"line":161,"column":1}},"children":[{"type":"text","value":"Often the adaptively chosen steps clearly correspond to identifiable features of the solution. However, there are so-called ","position":{"start":{"line":161,"column":1},"end":{"line":161,"column":1}},"key":"qbtUmh1YJ5"},{"type":"emphasis","position":{"start":{"line":161,"column":1},"end":{"line":161,"column":1}},"children":[{"type":"text","value":"stiff problems","position":{"start":{"line":161,"column":1},"end":{"line":161,"column":1}},"key":"fxtqzkwfTR"}],"key":"kuzKvUEdVq"},{"type":"text","value":" in which the time steps seem unreasonably small in relation to the observable behavior of the solution. These problems benefit from a particular type of solver that is considered in ","position":{"start":{"line":161,"column":1},"end":{"line":161,"column":1}},"key":"YYSmkhktlr"},{"type":"link","kind":"numref","identifier":"section-ivp-implicit","label":"section-ivp-implicit","url":"/implicit","internal":true,"dataUrl":"/implicit.json","children":[{"type":"text","value":"Implementation of multistep methods","key":"ZeA9pKz98H"}],"key":"Y93D0sqrrU"},{"type":"text","value":".","position":{"start":{"line":161,"column":1},"end":{"line":161,"column":1}},"key":"EOQI6spBXK"}],"indexEntries":[{"entry":"stiff differential equation","emphasis":false}],"label":"index-VdmwlLNVdY","identifier":"index-vdmwllnvdy","html_id":"index-vdmwllnvdy","key":"aha5cndu6R"},{"type":"heading","depth":2,"position":{"start":{"line":163,"column":1},"end":{"line":163,"column":1}},"children":[{"type":"text","value":"Exercises","position":{"start":{"line":163,"column":1},"end":{"line":163,"column":1}},"key":"PEDZssEsvU"}],"identifier":"exercises","label":"Exercises","html_id":"exercises","implicit":true,"enumerator":"6.5.4","key":"FYgD0xUh7L"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":165,"column":1},"end":{"line":180,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":165,"column":1},"end":{"line":174,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":165,"column":1},"end":{"line":165,"column":1}},"children":[{"type":"text","value":"⌨ Using ","position":{"start":{"line":165,"column":1},"end":{"line":165,"column":1}},"key":"jLIycXc2Jp"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-rk23","label":"function-rk23","children":[{"type":"text","value":"Function ","key":"DLZdwajl8F"},{"type":"text","value":"6.5.2","key":"WEfOmeL0PU"}],"template":"Algorithm %s","enumerator":"6.5.2","resolved":true,"html_id":"function-rk23","key":"qx6QCSxb5x"},{"type":"text","value":" with an error tolerance of ","position":{"start":{"line":165,"column":1},"end":{"line":165,"column":1}},"key":"uGRrpZkJio"},{"type":"span","position":{"start":{"line":165,"column":1},"end":{"line":165,"column":1}},"children":[{"type":"text","value":"10","key":"V643AIrliC"},{"type":"superscript","children":[{"type":"text","value":"-8","key":"ssqizfjgI5"}],"key":"fzasjCMLVI"}],"key":"Ts5YZc4RzP"},{"type":"text","value":", solve ","position":{"start":{"line":165,"column":1},"end":{"line":165,"column":1}},"key":"AosJ6aR4Hv"},{"type":"inlineMath","value":"y'' +(1+y')^3 y = 0","position":{"start":{"line":165,"column":1},"end":{"line":165,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>y</mi><mrow><mo mathvariant=\"normal\">′</mo><mo mathvariant=\"normal\">′</mo></mrow></msup><mo>+</mo><mo stretchy=\"false\">(</mo><mn>1</mn><mo>+</mo><msup><mi>y</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><msup><mo stretchy=\"false\">)</mo><mn>3</mn></msup><mi>y</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">y&#x27;&#x27; +(1+y&#x27;)^3 y = 0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9463em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′′</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span></span></span></span></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"vPN8lS2zrq"},{"type":"text","value":" over ","position":{"start":{"line":165,"column":1},"end":{"line":165,"column":1}},"key":"Ix2oT64j0i"},{"type":"inlineMath","value":" 0 \\le t \\le 4 \\pi","position":{"start":{"line":165,"column":1},"end":{"line":165,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0</mn><mo>≤</mo><mi>t</mi><mo>≤</mo><mn>4</mn><mi>π</mi></mrow><annotation encoding=\"application/x-tex\"> 0 \\le t \\le 4 \\pi</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7804em;vertical-align:-0.136em;\"></span><span class=\"mord\">0</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7719em;vertical-align:-0.136em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">4</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span></span></span></span>","key":"Ogl0ldd4it"},{"type":"text","value":" with the indicated initial conditions. Plot ","position":{"start":{"line":165,"column":1},"end":{"line":165,"column":1}},"key":"zG7PD5q5rZ"},{"type":"inlineMath","value":"y(t)","position":{"start":{"line":165,"column":1},"end":{"line":165,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">y(t)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span></span></span></span>","key":"ey2YVFVjDe"},{"type":"text","value":" and ","position":{"start":{"line":165,"column":1},"end":{"line":165,"column":1}},"key":"Xp6X1AGRLb"},{"type":"inlineMath","value":"y'(t)","position":{"start":{"line":165,"column":1},"end":{"line":165,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>y</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">y&#x27;(t)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0019em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span></span></span></span>","key":"d7nPbWMSRS"},{"type":"text","value":" as functions of ","position":{"start":{"line":165,"column":1},"end":{"line":165,"column":1}},"key":"Wiy7LhTU2E"},{"type":"inlineMath","value":"t","position":{"start":{"line":165,"column":1},"end":{"line":165,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span></span></span></span>","key":"AvjmMFfg3F"},{"type":"text","value":" and separately plot the time step size as a function of ","position":{"start":{"line":165,"column":1},"end":{"line":165,"column":1}},"key":"mXtdBzEsKI"},{"type":"inlineMath","value":"t","position":{"start":{"line":165,"column":1},"end":{"line":165,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span></span></span></span>","key":"llRMXl4DXI"},{"type":"text","value":".","position":{"start":{"line":165,"column":1},"end":{"line":165,"column":1}},"key":"xnc5xHJ6By"}],"key":"JIWgOOrdJD"},{"type":"paragraph","position":{"start":{"line":167,"column":1},"end":{"line":167,"column":1}},"children":[{"type":"strong","position":{"start":{"line":167,"column":1},"end":{"line":167,"column":1}},"children":[{"type":"text","value":"(a)","position":{"start":{"line":167,"column":1},"end":{"line":167,"column":1}},"key":"i0kiJQCqwb"}],"key":"Pu66uI35rV"},{"type":"text","value":" ","position":{"start":{"line":167,"column":1},"end":{"line":167,"column":1}},"key":"TV6yYnm5Eg"},{"type":"inlineMath","value":"y(0) = 0.1, \\quad y'(0) = 0","position":{"start":{"line":167,"column":1},"end":{"line":167,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi><mo stretchy=\"false\">(</mo><mn>0</mn><mo stretchy=\"false\">)</mo><mo>=</mo><mn>0.1</mn><mo separator=\"true\">,</mo><mspace width=\"1em\"/><msup><mi>y</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo stretchy=\"false\">(</mo><mn>0</mn><mo stretchy=\"false\">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">y(0) = 0.1, \\quad y&#x27;(0) = 0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0019em;vertical-align:-0.25em;\"></span><span class=\"mord\">0.1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:1em;\"></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"jfYRJUeCuq"}],"key":"CGBFHE3NLN"},{"type":"paragraph","position":{"start":{"line":169,"column":1},"end":{"line":169,"column":1}},"children":[{"type":"strong","position":{"start":{"line":169,"column":1},"end":{"line":169,"column":1}},"children":[{"type":"text","value":"(b)","position":{"start":{"line":169,"column":1},"end":{"line":169,"column":1}},"key":"Vl7pVsPD42"}],"key":"qOQLcZm78U"},{"type":"text","value":" ","position":{"start":{"line":169,"column":1},"end":{"line":169,"column":1}},"key":"M3wMaAzaqF"},{"type":"inlineMath","value":"y(0) = 0.5, \\quad y'(0) = 0","position":{"start":{"line":169,"column":1},"end":{"line":169,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi><mo stretchy=\"false\">(</mo><mn>0</mn><mo stretchy=\"false\">)</mo><mo>=</mo><mn>0.5</mn><mo separator=\"true\">,</mo><mspace width=\"1em\"/><msup><mi>y</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo stretchy=\"false\">(</mo><mn>0</mn><mo stretchy=\"false\">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">y(0) = 0.5, \\quad y&#x27;(0) = 0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0019em;vertical-align:-0.25em;\"></span><span class=\"mord\">0.5</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:1em;\"></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"fB5SXbK749"}],"key":"kGsxLQDdgk"},{"type":"paragraph","position":{"start":{"line":171,"column":1},"end":{"line":171,"column":1}},"children":[{"type":"strong","position":{"start":{"line":171,"column":1},"end":{"line":171,"column":1}},"children":[{"type":"text","value":"(c)","position":{"start":{"line":171,"column":1},"end":{"line":171,"column":1}},"key":"TGRBlfcOam"}],"key":"TX29JRCEGF"},{"type":"text","value":" ","position":{"start":{"line":171,"column":1},"end":{"line":171,"column":1}},"key":"K8bee4ir5p"},{"type":"inlineMath","value":"y(0) = 0.75, \\quad y'(0) = 0","position":{"start":{"line":171,"column":1},"end":{"line":171,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi><mo stretchy=\"false\">(</mo><mn>0</mn><mo stretchy=\"false\">)</mo><mo>=</mo><mn>0.75</mn><mo separator=\"true\">,</mo><mspace width=\"1em\"/><msup><mi>y</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo stretchy=\"false\">(</mo><mn>0</mn><mo stretchy=\"false\">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">y(0) = 0.75, \\quad y&#x27;(0) = 0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0019em;vertical-align:-0.25em;\"></span><span class=\"mord\">0.75</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:1em;\"></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"iXp4zd8oEr"}],"key":"NZuyd8uUYY"},{"type":"paragraph","position":{"start":{"line":173,"column":1},"end":{"line":173,"column":1}},"children":[{"type":"strong","position":{"start":{"line":173,"column":1},"end":{"line":173,"column":1}},"children":[{"type":"text","value":"(d)","position":{"start":{"line":173,"column":1},"end":{"line":173,"column":1}},"key":"SZk4bIMM2w"}],"key":"yQ6ChylLIY"},{"type":"text","value":" ","position":{"start":{"line":173,"column":1},"end":{"line":173,"column":1}},"key":"ymWc79FeQL"},{"type":"inlineMath","value":"y(0) = 0.95, \\quad y'(0) = 0","position":{"start":{"line":173,"column":1},"end":{"line":173,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi><mo stretchy=\"false\">(</mo><mn>0</mn><mo stretchy=\"false\">)</mo><mo>=</mo><mn>0.95</mn><mo separator=\"true\">,</mo><mspace width=\"1em\"/><msup><mi>y</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo stretchy=\"false\">(</mo><mn>0</mn><mo stretchy=\"false\">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">y(0) = 0.95, \\quad y&#x27;(0) = 0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0019em;vertical-align:-0.25em;\"></span><span class=\"mord\">0.95</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:1em;\"></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"IP14R2VhY1"}],"key":"b3kUuG1meY"}],"key":"xmuTMAYMae"},{"type":"listItem","spread":true,"position":{"start":{"line":175,"column":1},"end":{"line":176,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":175,"column":1},"end":{"line":175,"column":1}},"children":[{"type":"text","value":"⌨ Solve the FitzHugh–Nagumo system from ","position":{"start":{"line":175,"column":1},"end":{"line":175,"column":1}},"key":"L227llrNpW"},{"type":"crossReference","position":{"start":{"line":175,"column":1},"end":{"line":175,"column":1}},"children":[{"type":"text","value":"Exercise 4.3.6","position":{"start":{"line":175,"column":1},"end":{"line":175,"column":1}},"key":"eZoq9htzY8"}],"identifier":"problem-systems-fitznag","label":"problem-systems-fitznag","kind":"list","template":"List","resolved":true,"html_id":"problem-systems-fitznag","remote":true,"url":"/systems","dataUrl":"/systems.json","key":"jZywuQKpOW"},{"type":"text","value":" for ","position":{"start":{"line":175,"column":1},"end":{"line":175,"column":1}},"key":"qSFep9DCqg"},{"type":"inlineMath","value":"I=0.05740","position":{"start":{"line":175,"column":1},"end":{"line":175,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>I</mi><mo>=</mo><mn>0.05740</mn></mrow><annotation encoding=\"application/x-tex\">I=0.05740</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0.05740</span></span></span></span>","key":"qJUlVpV5cu"},{"type":"text","value":" using ","position":{"start":{"line":175,"column":1},"end":{"line":175,"column":1}},"key":"e2CG7nhkPA"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-rk23","label":"function-rk23","children":[{"type":"text","value":"Function ","key":"BayBXtAXM7"},{"type":"text","value":"6.5.2","key":"TjGpcFVMbK"}],"template":"Algorithm %s","enumerator":"6.5.2","resolved":true,"html_id":"function-rk23","key":"CGU4KNjbNH"},{"type":"text","value":" with error tolerance ","position":{"start":{"line":175,"column":1},"end":{"line":175,"column":1}},"key":"CngGzGIvoi"},{"type":"span","position":{"start":{"line":175,"column":1},"end":{"line":175,"column":1}},"children":[{"type":"text","value":"10","key":"WftphO0ic9"},{"type":"superscript","children":[{"type":"text","value":"-2","key":"VsIC8Jgz00"}],"key":"EIRXO63ljV"}],"key":"aQswH7Y6QS"},{"type":"text","value":", ","position":{"start":{"line":175,"column":1},"end":{"line":175,"column":1}},"key":"FhfTqJ2YIi"},{"type":"span","position":{"start":{"line":175,"column":1},"end":{"line":175,"column":1}},"children":[{"type":"text","value":"10","key":"C5haVXdS11"},{"type":"superscript","children":[{"type":"text","value":"-3","key":"NVkepMlwSP"}],"key":"lw0zYOVXwN"}],"key":"zYTQLoun7h"},{"type":"text","value":", and ","position":{"start":{"line":175,"column":1},"end":{"line":175,"column":1}},"key":"vrzCcdnJJa"},{"type":"span","position":{"start":{"line":175,"column":1},"end":{"line":175,"column":1}},"children":[{"type":"text","value":"10","key":"JrA3Y9OTbx"},{"type":"superscript","children":[{"type":"text","value":"-4","key":"CWPtf22S0A"}],"key":"pwoUa39dOt"}],"key":"dUMZKJnEo5"},{"type":"text","value":". (This illustrates that the error tolerance is a target, not a guarantee!)","position":{"start":{"line":175,"column":1},"end":{"line":175,"column":1}},"key":"OvwAs0KAfp"}],"key":"KOmTwo0Scd"}],"key":"Ibny07lqAg"},{"type":"listItem","spread":true,"position":{"start":{"line":177,"column":1},"end":{"line":178,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":177,"column":1},"end":{"line":177,"column":1}},"children":[{"type":"text","value":"✍ Derive Equation ","position":{"start":{"line":177,"column":1},"end":{"line":177,"column":1}},"key":"RM7jgulIFh"},{"type":"crossReference","kind":"equation","identifier":"adaptrkglobal","label":"adaptRKglobal","children":[{"type":"text","value":"(","key":"YzB7dbTCxJ"},{"type":"text","value":"6.5.4","key":"OjERHyGupj"},{"type":"text","value":")","key":"QnlC57Q2Ft"}],"template":"(%s)","enumerator":"6.5.4","resolved":true,"html_id":"adaptrkglobal","key":"eBgngNND0s"},{"type":"text","value":" using the stated assumption about controlling global rather than local error.","position":{"start":{"line":177,"column":1},"end":{"line":177,"column":1}},"key":"Fpucn3iQw9"}],"key":"cPlmhRLz3w"}],"key":"H4UgtE60KA"},{"type":"listItem","spread":true,"position":{"start":{"line":179,"column":1},"end":{"line":180,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":179,"column":1},"end":{"line":179,"column":1}},"children":[{"type":"text","value":"⌨ Solve the problem ","position":{"start":{"line":179,"column":1},"end":{"line":179,"column":1}},"key":"PIZTeOf08H"},{"type":"inlineMath","value":"u'=100u^2-u^3","position":{"start":{"line":179,"column":1},"end":{"line":179,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>u</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo>=</mo><mn>100</mn><msup><mi>u</mi><mn>2</mn></msup><mo>−</mo><msup><mi>u</mi><mn>3</mn></msup></mrow><annotation encoding=\"application/x-tex\">u&#x27;=100u^2-u^3</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8974em;vertical-align:-0.0833em;\"></span><span class=\"mord\">100</span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span></span></span></span></span></span></span></span>","key":"tESX6wNABo"},{"type":"text","value":", ","position":{"start":{"line":179,"column":1},"end":{"line":179,"column":1}},"key":"YPkqtwTjhg"},{"type":"inlineMath","value":"u(0)=0.0002","position":{"start":{"line":179,"column":1},"end":{"line":179,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo stretchy=\"false\">(</mo><mn>0</mn><mo stretchy=\"false\">)</mo><mo>=</mo><mn>0.0002</mn></mrow><annotation encoding=\"application/x-tex\">u(0)=0.0002</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0.0002</span></span></span></span>","key":"t8NHlAzo1P"},{"type":"text","value":", ","position":{"start":{"line":179,"column":1},"end":{"line":179,"column":1}},"key":"X0zQjQ3AeS"},{"type":"inlineMath","value":"0\\le t \\le 100","position":{"start":{"line":179,"column":1},"end":{"line":179,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0</mn><mo>≤</mo><mi>t</mi><mo>≤</mo><mn>100</mn></mrow><annotation encoding=\"application/x-tex\">0\\le t \\le 100</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7804em;vertical-align:-0.136em;\"></span><span class=\"mord\">0</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7719em;vertical-align:-0.136em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">100</span></span></span></span>","key":"fYH48xM2BE"},{"type":"text","value":", and make plots that show both the solution and the time steps taken. The solution makes a quick transition between two nearly constant states. Does the step size selection behave the same in both states?","position":{"start":{"line":179,"column":1},"end":{"line":179,"column":1}},"key":"AKhWy7R8N5"}],"key":"X1Fn8Xy1dS"}],"key":"yTfHTHi23I"}],"key":"KQUbcL4NFL"}],"key":"ftl2q1pszl"}],"key":"WGitsHRbOG"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Runge–Kutta methods","url":"/rk","group":"Preface"},"next":{"title":"Multistep methods","url":"/multistep","group":"Preface"}}},"domain":"http://localhost:3000"}