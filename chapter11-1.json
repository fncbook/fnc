{"kind":"Notebook","sha256":"0a5fca7810dc8ecbba470d5ab67569c95d5ea0d22e62d3be9f1dca2d9a55e347","slug":"chapter11-1","location":"/matlab/chapter11.md","dependencies":[],"frontmatter":{"title":"Chapter 11","numbering":{"heading_1":{"enabled":false},"heading_2":{"enabled":false},"heading_3":{"enabled":false},"heading_4":{"enabled":false},"heading_5":{"enabled":false},"heading_6":{"enabled":false}},"kernelspec":{"name":"jupyter_matlab_kernel","display_name":"MATLAB","language":"matlab"},"content_includes_title":false,"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"exports":[{"format":"md","filename":"chapter11.md","url":"/fnc/build/chapter11-076969bcd281bdf653331a8c2e4bb9b8.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Functions","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"miieqMcJ8z"}],"identifier":"functions","label":"Functions","html_id":"functions","implicit":true,"key":"KdULAvqIxY"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Differentiation matrices for periodic end conditions","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"tPBnofMahU"}],"key":"EpfxP6SM9b"},{"type":"include","file":"fnc/diffper.m","literal":true,"filter":{},"children":[{"type":"code","value":"function [x,Dx,Dxx] = diffper(n,xspan)\n%DIFFPER   Differentiation matrices for periodic end conditions. \n% Input:\n%   n      number of subintervals (integer)\n%   xspan  endpoints of domain (vector)\n% Output:\n%   x    equispaced nodes (length n)\n%   Dx   matrix for first derivative (n by n)\n%   Dxx  matrix for second derivative (n by n)\n\na = xspan(1);  b = xspan(2);\nh = (b-a)/n;\nx = a + h*(0:n-1)';   % nodes, omitting the repeated data\n\n% Construct Dx by diagonals, then correct the corners.\ndp = 0.5*ones(n-1,1)/h;      % superdiagonal\ndm = -0.5*ones(n-1,1)/h;     % subdiagonal\nDx = diag(dm,-1) + diag(dp,1);\nDx(1,n) = -1/(2*h);\nDx(n,1) = 1/(2*h);\n\n% Construct Dxx by diagonals, then correct the corners.\nd0 =  -2*ones(n,1)/h^2;      % main diagonal\ndp =  ones(n-1,1)/h^2;       % superdiagonal\ndm =  dp;                    % subdiagonal\nDxx = diag(dm,-1) + diag(d0) + diag(dp,1);\nDxx(1,n) = 1/(h^2);\nDxx(n,1) = 1/(h^2);\n    ","lang":"matlab","showLineNumbers":true,"filename":"diffper.m","key":"qOyAqTNt0p"}],"key":"z8oPEsCbz3"}],"label":"function-diffper-matlab","identifier":"function-diffper-matlab","html_id":"function-diffper-matlab","key":"ZBLw7zdaxR"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Solution of parabolic ","key":"rMFsJ4bPTB"},{"type":"abbreviation","title":"partial differential equation","children":[{"type":"text","value":"PDE","key":"ezSsySnQGP"}],"key":"jfyuBRVGjd"},{"type":"text","value":"s by the method of lines","key":"cKzLlf2Hg2"}],"key":"hmnANCg2eq"},{"type":"include","file":"fnc/parabolic.m","literal":true,"filter":{},"children":[{"type":"code","value":"function [x, u] = parabolic(phi, xspan, m, ga, gb, tspan, init)\n% PARABOLIC   Solve parabolic PDE by the method of lines.\n% Input:\n%   phi      defines ∂u/∂t = phi(t, x, u, ∂u/∂x, ∂^2u/∂x^2) \n%   xspan    spatial domain\n%   m        number of spatial nodes\n%   ga, gb   boundary conditions as functions of u and ∂u/∂x\n%   tspan    time interval\n%   init     initial condition as a function of x\n% Output:       \n%   x        spatial nodes (vector)\n%   u        function for the solution u(t) at nodes\n\n    [x, Dx, Dxx] = diffcheb(m, xspan);\n    int = 2:m;    % indexes of interior nodes\n\n    function u = extend(v)\n        function residual = objective(ubc)\n            ua = ubc(1);  ub = ubc(2);\n            ux = Dx * [ua; v; ub];\n            residual = [ga(ua, ux(1)); gb(ub, ux(end))];\n        end\n        ubc = levenberg(@objective, [0, 0]);\n        ubc = ubc(:, end);\n        u = [ubc(1); v; ubc(2)];\n    end\n\n    function f = mol_ode(t, v, p)\n        u = extend(v);\n        ux = Dx * u;\n        uxx = Dxx * u;\n        f = phi(t, x(int), u(int), ux(int), uxx(int));\n    end\n\n    ivp = ode(ODEFcn=@mol_ode);\n    ivp.InitialTime = tspan(1);\n    ivp.InitialValue = init(x(int));\n    ivp.Solver = \"stiff\";\n    sol = solutionFcn(ivp, tspan(1), tspan(2));\n    u = @(t) extend(sol(t));\nend","lang":"matlab","showLineNumbers":true,"filename":"parabolic.m","key":"bedSM7Q6fF"}],"key":"IKNgwleHem"}],"label":"function-parabolic-matlab","identifier":"function-parabolic-matlab","html_id":"function-parabolic-matlab","key":"QIqpEdNxU0"},{"type":"heading","depth":2,"position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"children":[{"type":"text","value":"Examples","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"h9EDtriQHr"}],"identifier":"examples","label":"Examples","html_id":"examples","implicit":true,"key":"KxkWyszD89"}],"key":"WkDl6bxARc"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"addpath /Users/driscoll/Documents/GitHub/fnc/matlab/fnc\naddpath /Users/driscoll/Documents/GitHub/fnc/matlab\nFNC_init","visibility":"show","key":"ZdcWrtneF6"},{"type":"output","id":"IkrRTY9vBaif0xAivVtE8","data":[{"output_type":"stream","name":"stdout","text":"Starting MATLAB ...\n"},{"output_type":"stream","name":"stdout","text":"Executing ..."},{"output_type":"execute_result","execution_count":1,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = \n  Figure (2) with properties:\n\n      Number: 2\n        Name: ''\n       Color: [1 1 1]\n    Position: [1224 1070 560 420]\n       Units: 'pixels'\n\n  Use GET to show all properties\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = \n  Figure (2) with properties:\n\n      Number: 2\n        Name: ''\n       Color: [1 1 1]\n    Position: [1224 1070 560 420]\n       Units: 'pixels'\n\n  Use GET to show all properties\n","content_type":"text/plain"}}}],"visibility":"show","key":"oqeqWGZrhc"}],"data":{"tags":[]},"visibility":"remove","key":"XCJVsirmxl"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"children":[{"type":"text","value":"11.1 ","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"key":"PjgtAUtlO7"},{"type":"link","identifier":"section-diffusion-blackscholes","label":"section-diffusion-blackscholes","kind":"narrative","position":{"start":{"line":38,"column":6},"end":{"line":38,"column":37}},"url":"/blackscholes","internal":true,"dataUrl":"/blackscholes.json","children":[{"type":"text","value":"Black–Scholes equation","key":"x7JdF0UTrC"}],"key":"GL1NB5uSUI"}],"identifier":"id-11-1","label":"11.1 ","html_id":"id-11-1","implicit":true,"key":"S4VvJTgPLs"},{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-blackscholes-solve","label":"demo-blackscholes-solve","kind":"proof:example","position":{"start":{"line":41,"column":1},"end":{"line":41,"column":25}},"children":[{"type":"text","value":"Example ","key":"vQUk1RvD83"},{"type":"text","value":"11.1.2","key":"cZgHlSYebe"}],"template":"Example %s","enumerator":"11.1.2","resolved":true,"html_id":"demo-blackscholes-solve","remote":true,"url":"/blackscholes","dataUrl":"/blackscholes.json","key":"jERBrfb6os"}],"key":"QI8k97F7VC"},{"type":"paragraph","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"children":[{"type":"text","value":"We consider the Black–Scholes problem for the following parameter values:","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"key":"l3MhD9MHcT"}],"key":"GiEHdJwUxL"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"Smax = 8;  T = 6;\nK = 3;  sigma = 0.06;  r = 0.08;","key":"kinuLyH7x9"},{"type":"output","id":"tBBUToCXXXIIttdaEGzms","data":[],"key":"ByRNRuDZ40"}],"data":{},"key":"DusOkh6bwE"},{"type":"paragraph","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"children":[{"type":"text","value":"We discretize space and time.","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"key":"N4HWYgqezN"}],"key":"v80sOpoNi6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"m = 200;  h = Smax / m;\nx = h*(0:m)';\nn = 1000;  tau = T / n;\nt = tau*(0:n)';\nlambda = tau / h^2;  mu = tau / h;","key":"AVt6lQ4oSL"},{"type":"output","id":"p33Q99w5EW6nE_MXbn3Rt","data":[],"key":"uEINB5TQOY"}],"data":{},"key":"kgp9rqercR"},{"type":"paragraph","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"children":[{"type":"text","value":"We set the initial condition and then march forward in time.","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"Ewa3PJspiS"}],"key":"YrSaDW4WnR"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"V = zeros(m+1,n+1);\nV(:,1) = max( 0, x-K );\nfor j = 1:n\n    % Fictitious value from Neumann condition.\n    Vfict = 2*h + V(m,j);\n    Vj = [ V(:,j); Vfict ];\n    % First row is zero by the Dirichlet condition.\n    for i = 2:m+1 \n        diff1 = (Vj(i+1) - Vj(i-1));\n        diff2 = (Vj(i+1) - 2*Vj(i) + Vj(i-1));\n        V(i,j+1) = Vj(i) ...\n            + (lambda * sigma^2* x(i)^2/2) * diff2  ...\n            + (r*mu * x(i))/2 * diff1 - r*tau * Vj(i);\n    end \nend","key":"fAuAyR4XAI"},{"type":"output","id":"1MzQ1NFwVt0wsNN06Kbr-","data":[],"key":"RFklpanML0"}],"data":{},"key":"V9C5OJpNi1"},{"type":"paragraph","position":{"start":{"line":79,"column":1},"end":{"line":79,"column":1}},"children":[{"type":"text","value":"Here is a plot of the solution after every 250 time steps.","position":{"start":{"line":79,"column":1},"end":{"line":79,"column":1}},"key":"rbckT1t2C4"}],"key":"SGlP6wyjIw"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"index_times = 1 + 250*(0:4);\nshow_times = t(index_times);\nclf\nfor j = index_times\n    str = sprintf(\"t = %.2f\", t(j));\n    plot(x, V(:, j), displayname=str) \n    hold on\nend\ntitle('Black-Scholes solution')\nxlabel('stock price'),  ylabel('option value')\naxis tight,  grid on\nlegend(location=\"northwest\")","key":"GRpqXLc34T"},{"type":"output","id":"FrXIpjC049gcQHqfLeawB","data":[{"output_type":"stream","name":"stderr","text":"Error using plot\nSpecify the coordinates as vectors or matrices of the same size, or as a vector and a matrix that share the same length in at least one dimension."}],"key":"LIppPhcC4v"}],"data":{},"key":"q6LAJyIcMB"},{"type":"paragraph","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"children":[{"type":"text","value":"Alternatively, here is an animation of the solution.","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"key":"DqJaSi5ASr"}],"indexEntries":[{"entry":"MATLAB","subEntry":{"value":"animation","kind":"entry"},"emphasis":true}],"label":"index-XrucLByf1S","identifier":"index-xruclbyf1s","html_id":"index-xruclbyf1s","key":"E3aCviQGIr"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf\nplot(x, V(:,1))\nhold on,  grid on\naxis([0, 8, 0, 6])\ntitle('Black-Scholes solution') \nxlabel('stock price'),  ylabel('option value')\nvid = VideoWriter(\"figures/black-scholes-6.mp4\",\"MPEG-4\");\nvid.Quality = 85;\nopen(vid)\nfor frame = 1:10:n+1\n    cla, plot(x, V(:, frame))\n    str = sprintf(\"t = %.2f\", t(frame));\n    text(0.4, 5.2, str);\n    writeVideo(vid, frame2im(getframe(gcf)));\nend\nclose(vid)","visibility":"show","key":"uoQeutiJNl"},{"type":"output","id":"qhzSvjCiBLTcg6uiSG3mv","data":[{"output_type":"stream","name":"stderr","text":"Error using plot\nSpecify the coordinates as vectors or matrices of the same size, or as a vector and a matrix that share the same length in at least one dimension."}],"visibility":"remove","key":"CeA4wfr5ef"}],"data":{"tags":[]},"visibility":"show","key":"uDAwW5cIvh"},{"type":"image","url":"/fnc/build/black-scholes-6-7266f11a0ebb7ff6beec307fb67dd015.mp4","alt":"Black–Scholes solution","position":{"start":{"line":121,"column":1},"end":{"line":121,"column":1}},"key":"POUGAeujY0","urlSource":"figures/black-scholes-6.mp4"},{"type":"paragraph","position":{"start":{"line":123,"column":1},"end":{"line":123,"column":1}},"children":[{"type":"text","value":"The results are easy to interpret, recalling that the time variable really means ","position":{"start":{"line":123,"column":1},"end":{"line":123,"column":1}},"key":"IzglZycyQN"},{"type":"emphasis","position":{"start":{"line":123,"column":1},"end":{"line":123,"column":1}},"children":[{"type":"text","value":"time until strike","position":{"start":{"line":123,"column":1},"end":{"line":123,"column":1}},"key":"izViCmZe5o"}],"key":"SbGZlMUkTF"},{"type":"text","value":". Say you are close to the option’s strike time. If the current stock price is, say, ","position":{"start":{"line":123,"column":1},"end":{"line":123,"column":1}},"key":"Rpz8QBH3Qy"},{"type":"inlineMath","value":"S=2","position":{"start":{"line":123,"column":1},"end":{"line":123,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>S</mi><mo>=</mo><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">S=2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span></span></span></span>","key":"FWFQvFC1yM"},{"type":"text","value":", then it’s not likely that the stock will end up over the strike price ","position":{"start":{"line":123,"column":1},"end":{"line":123,"column":1}},"key":"r7F0aLPvdV"},{"type":"inlineMath","value":"K=3","position":{"start":{"line":123,"column":1},"end":{"line":123,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>K</mi><mo>=</mo><mn>3</mn></mrow><annotation encoding=\"application/x-tex\">K=3</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">3</span></span></span></span>","key":"Gl2pZlGuq7"},{"type":"text","value":", and therefore the option has little value. On the other hand, if presently ","position":{"start":{"line":123,"column":1},"end":{"line":123,"column":1}},"key":"Z4uHlPGPrs"},{"type":"inlineMath","value":"S=3","position":{"start":{"line":123,"column":1},"end":{"line":123,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>S</mi><mo>=</mo><mn>3</mn></mrow><annotation encoding=\"application/x-tex\">S=3</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">3</span></span></span></span>","key":"TTBuT5FQtp"},{"type":"text","value":", then there are good odds that the option will be exercised at the strike time, and you will need to pay a substantial portion of the stock price in order to take advantage. As the time to strike increases, there is an expectation that the stock price is more likely to rise somewhat, making the value of the option larger at each fixed ","position":{"start":{"line":123,"column":1},"end":{"line":123,"column":1}},"key":"CQNSVDbhEs"},{"type":"inlineMath","value":"S","position":{"start":{"line":123,"column":1},"end":{"line":123,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>S</mi></mrow><annotation encoding=\"application/x-tex\">S</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span></span></span></span>","key":"JZu1KsmVRo"},{"type":"text","value":".","position":{"start":{"line":123,"column":1},"end":{"line":123,"column":1}},"key":"IgrlogtwlC"}],"key":"kbbGmbulT7"}],"label":"demo-blackscholes-solve-matlab","identifier":"demo-blackscholes-solve-matlab","html_id":"demo-blackscholes-solve-matlab","key":"wxPTCsPIS5"},{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-blackscholes-unstable","label":"demo-blackscholes-unstable","kind":"proof:example","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":28}},"children":[{"type":"text","value":"Example ","key":"HV7O48eCfy"},{"type":"text","value":"11.1.3","key":"f6Rm098no5"}],"template":"Example %s","enumerator":"11.1.3","resolved":true,"html_id":"demo-blackscholes-unstable","remote":true,"url":"/blackscholes","dataUrl":"/blackscholes.json","key":"APrGVUAvbu"}],"key":"GCGD8QYy0o"},{"type":"paragraph","position":{"start":{"line":128,"column":1},"end":{"line":128,"column":1}},"children":[{"type":"text","value":"Let’s try to do everything the same as in ","position":{"start":{"line":128,"column":1},"end":{"line":128,"column":1}},"key":"YTqKawZZgD"},{"type":"crossReference","kind":"proof:example","identifier":"demo-blackscholes-solve","label":"demo-blackscholes-solve","children":[{"type":"text","value":"Demo ","key":"JX8nYLkBBr"},{"type":"text","value":"11.1.2","key":"P5QWZXX9As"}],"template":"Example %s","enumerator":"11.1.2","resolved":true,"html_id":"demo-blackscholes-solve","remote":true,"url":"/blackscholes","dataUrl":"/blackscholes.json","key":"UuHClJBemP"},{"type":"text","value":", but extending the simulation time to ","position":{"start":{"line":128,"column":1},"end":{"line":128,"column":1}},"key":"zclqD91c91"},{"type":"inlineMath","value":"T=8","position":{"start":{"line":128,"column":1},"end":{"line":128,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>T</mi><mo>=</mo><mn>8</mn></mrow><annotation encoding=\"application/x-tex\">T=8</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">8</span></span></span></span>","key":"cCwH76LmfF"},{"type":"text","value":".","position":{"start":{"line":128,"column":1},"end":{"line":128,"column":1}},"key":"gElzV5RVfV"}],"key":"O7UQXBbUgb"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"T = 8;\nn = 1000;  tau = T / n;\nt = tau*(0:n)';\nlambda = tau / h^2;  mu = tau / h;\nfor j = 1:n\n    % Fictitious value from Neumann condition.\n    Vfict = 2*h + V(m,j);\n    Vj = [ V(:,j); Vfict ];\n    % First row is zero by the Dirichlet condition.\n    for i = 2:m+1 \n        diff1 = (Vj(i+1) - Vj(i-1));\n        diff2 = (Vj(i+1) - 2*Vj(i) + Vj(i-1));\n        V(i,j+1) = Vj(i) ...\n             + (lambda*sigma^2 * x(i)^2/2) * diff2  ...\n             + (r*mu * x(i))/2 * diff1 - r*tau * Vj(i);\n    end   \nend\nclf\nfor j = index_times\n    str = sprintf(\"t = %.2f\", t(j));\n    plot(x, V(:, j), displayname=str) \n    hold on\nend\ntitle('Black-Scholes instability')\nxlabel('stock price'),  ylabel('option value')\naxis tight,  grid on\nlegend(location=\"northwest\")","key":"hXZYopy2Lm"},{"type":"output","id":"QLwxiKe7WSHZuM7al3jbb","data":[{"output_type":"stream","name":"stderr","text":"Unable to perform assignment because the size of the left side is 1-by-1 and the size of the right side is 1-by-41."}],"key":"J33lZ1krZP"}],"data":{},"key":"Qnci3PO4FS"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf\nplot(x, V(:,1))\nhold on,  grid on\naxis([0, 8, 0, 6])\ntitle('Black-Scholes solution...?') \nxlabel('stock price'),  ylabel('option value')\nvid = VideoWriter(\"figures/black-scholes-8.mp4\",\"MPEG-4\");\nvid.Quality = 85;\nopen(vid);\nfor frame = 1:10:n+1\n    cla, plot(x, V(:, frame))\n    str = sprintf(\"t = %.2f\", t(frame));\n    text(0.4, 5.2, str);\n    writeVideo(vid, frame2im(getframe(gcf)));\nend\nclose(vid)","visibility":"show","key":"ipq5wQzrUO"},{"type":"output","id":"HarFQg37Ef8vfsxs08H9G","data":[{"output_type":"stream","name":"stderr","text":"Error using plot\nSpecify the coordinates as vectors or matrices of the same size, or as a vector and a matrix that share the same length in at least one dimension."}],"visibility":"remove","key":"tdN4HZaVsu"}],"data":{"tags":[]},"visibility":"show","key":"srhDEnMaJg"},{"type":"image","url":"/fnc/build/black-scholes-8-b4d42e0c9cde5cd09c1a89f761f2bbb0.mp4","alt":"Trouble in Black–Scholes solution","position":{"start":{"line":180,"column":1},"end":{"line":180,"column":1}},"key":"GGlpJb68n3","urlSource":"figures/black-scholes-8.mp4"},{"type":"paragraph","position":{"start":{"line":182,"column":1},"end":{"line":182,"column":1}},"children":[{"type":"text","value":"This so-called solution is nonsense!","position":{"start":{"line":182,"column":1},"end":{"line":182,"column":1}},"key":"dgWuxZ200i"}],"key":"pSizH70gry"}],"label":"demo-blackscholes-unstable-matlab","identifier":"demo-blackscholes-unstable-matlab","html_id":"demo-blackscholes-unstable-matlab","key":"JAB7gAnB9S"},{"type":"heading","depth":3,"position":{"start":{"line":185,"column":1},"end":{"line":185,"column":1}},"children":[{"type":"text","value":"11.2 ","position":{"start":{"line":185,"column":1},"end":{"line":185,"column":1}},"key":"rYVFhWSawI"},{"type":"link","identifier":"section-diffusion-methodlines","label":"section-diffusion-methodlines","kind":"narrative","position":{"start":{"line":185,"column":6},"end":{"line":185,"column":36}},"url":"/methodlines","internal":true,"dataUrl":"/methodlines.json","children":[{"type":"text","value":"The method of lines","key":"AldETmI2l2"}],"key":"h5dJXY2nxw"}],"identifier":"id-11-2","label":"11.2 ","html_id":"id-11-2","implicit":true,"key":"To3ged4jTd"},{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-methodlines-heatfe","label":"demo-methodlines-heatFE","kind":"proof:example","position":{"start":{"line":188,"column":1},"end":{"line":188,"column":25}},"children":[{"type":"text","value":"Example ","key":"aQYSlj0pBZ"},{"type":"text","value":"11.2.2","key":"WT59cmL0XJ"}],"template":"Example %s","enumerator":"11.2.2","resolved":true,"html_id":"demo-methodlines-heatfe","remote":true,"url":"/methodlines","dataUrl":"/methodlines.json","key":"pjIKKgVDLe"}],"key":"Lac1ZTzhVj"},{"type":"paragraph","position":{"start":{"line":189,"column":1},"end":{"line":189,"column":1}},"children":[{"type":"text","value":"Let’s implement the method of ","position":{"start":{"line":189,"column":1},"end":{"line":189,"column":1}},"key":"U7d5cSr59T"},{"type":"crossReference","kind":"proof:example","identifier":"example-methodlines-heatfe","label":"example-methodlines-heatFE","children":[{"type":"text","value":"Example ","key":"bNHMxWOh0j"},{"type":"text","value":"11.2.1","key":"LTx7B8UKQ7"}],"template":"Example %s","enumerator":"11.2.1","resolved":true,"html_id":"example-methodlines-heatfe","remote":true,"url":"/methodlines","dataUrl":"/methodlines.json","key":"M0wW8y1IyY"},{"type":"text","value":" with second-order space semidiscretization.","position":{"start":{"line":189,"column":1},"end":{"line":189,"column":1}},"key":"q8CnvLRfI6"}],"key":"joYcwWiZGW"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"m = 100;  \n[x, Dx, Dxx] = diffper(m, [0, 1]);\nIx = eye(m);","key":"W9QzF11w56"},{"type":"output","id":"5t7CeY5EDaXRn90U_TLfQ","data":[],"key":"nuz0lP1TjG"}],"data":{},"key":"XmkCdSMQwA"},{"type":"paragraph","position":{"start":{"line":197,"column":1},"end":{"line":197,"column":1}},"children":[{"type":"text","value":"Next we set an initial condition. It isn’t mathematically periodic, but the end values and derivatives are so small that for numerical purposes it may as well be.","position":{"start":{"line":197,"column":1},"end":{"line":197,"column":1}},"key":"Tugi78PEGt"}],"key":"JDHANrwcGV"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"tfinal = 0.15;  n = 2400;  \ntau = tfinal / n;  t = tau * (0:n)';\nU = zeros(m, n+1);\nU(:, 1) = exp( -60*(x - 0.5).^2 );","key":"z3lujvUi7b"},{"type":"output","id":"hZo1M0GJ8CaeCNPge1-Am","data":[],"key":"tAKNYopwcF"}],"data":{},"key":"gIwyIczThN"},{"type":"paragraph","position":{"start":{"line":206,"column":1},"end":{"line":206,"column":1}},"children":[{"type":"text","value":"The Euler time stepping simply multiplies the solution vector by the constant matrix in ","position":{"start":{"line":206,"column":1},"end":{"line":206,"column":1}},"key":"DUW1st02eU"},{"type":"crossReference","kind":"equation","identifier":"eulerxx","label":"Eulerxx","children":[{"type":"text","value":"(","key":"GcPBDZGZ4G"},{"type":"text","value":"11.2.6","key":"ZDQsbu7eJ0"},{"type":"text","value":")","key":"lbFmHd1ynG"}],"template":"(%s)","enumerator":"11.2.6","resolved":true,"html_id":"eulerxx","remote":true,"url":"/methodlines","dataUrl":"/methodlines.json","key":"TiSuoj5izl"},{"type":"text","value":" at each time step. Since that matrix is sparse, we will declare it as such, even though the run-time savings may not be detectable for this small value of ","position":{"start":{"line":206,"column":1},"end":{"line":206,"column":1}},"key":"bjmb9wy8ne"},{"type":"inlineMath","value":"m","position":{"start":{"line":206,"column":1},"end":{"line":206,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi></mrow><annotation encoding=\"application/x-tex\">m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">m</span></span></span></span>","key":"kGvPIA85Mu"},{"type":"text","value":".","position":{"start":{"line":206,"column":1},"end":{"line":206,"column":1}},"key":"HpCXd0OfBX"}],"key":"h9qlKhvXRT"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A = sparse(Ix + tau * Dxx);\nfor j = 1:n\n    U(:, j+1) = A * U(:,j);\nend\n\nindex_times = 1:10:31;\nshow_times = t(index_times);\nclf\nfor j = index_times\n    str = sprintf(\"t = %.2e\", t(j));\n    plot(x, U(:, j), displayname=str) \n    hold on\nend\nlegend(location=\"northwest\")\nxlabel('x'), ylabel('u(x,t)')\ntitle('Heat equation by forward Euler')","key":"rsybbmD1bh"},{"type":"output","id":"M2T3mqkp7PA2j5zSAeVkd","data":[{"output_type":"execute_result","execution_count":11,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"900c01e1ad40f699785453e1a9832e81","path":"/fnc/build/900c01e1ad40f699785453e1a9832e81.png"}}}],"key":"aYr6PCEWjE"}],"data":{},"key":"eNvKb2PSO3"},{"type":"paragraph","position":{"start":{"line":227,"column":1},"end":{"line":227,"column":1}},"children":[{"type":"text","value":"You see above that things seem to start well, with the initial peak widening and shrinking. But then there is a nonphysical growth in the solution.","position":{"start":{"line":227,"column":1},"end":{"line":227,"column":1}},"key":"N7O3S9Paam"}],"key":"yRoX4Xw0hZ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf\nindex_times = 1:101;\nplot(x, U(:, 1))\nhold on,  grid on\naxis([0, 1, -1, 2])\ntitle('Heat equation by forward Euler') \nxlabel('x'),  ylabel('u(x,t)')\nvid = VideoWriter(\"figures/diffusionFE.mp4\", \"MPEG-4\");\nvid.Quality = 85;\nopen(vid);\nfor frame = index_times\n    cla, plot(x, U(:, frame))\n    str = sprintf(\"t = %.3f\", t(frame));\n    text(0.05, 0.92, str);\n    writeVideo(vid, frame2im(getframe(gcf)));\nend\nclose(vid)","visibility":"hide","key":"fzSVl5k6uV"},{"type":"output","id":"BXnkmZ_oakg5sdtAK9rs8","data":[{"output_type":"stream","name":"stderr","text":"Error using plot\nSpecify the coordinates as vectors or matrices of the same size, or as a vector and a matrix that share the same length in at least one dimension."}],"visibility":"show","key":"gbxKWdq4ss"}],"data":{"tags":[]},"visibility":"show","key":"Bw7gQT66DF"},{"type":"image","url":"/fnc/build/diffusionFE-2f48f6afc8d1754130315d89673b9a65.mp4","alt":"Instability in Euler solution","position":{"start":{"line":250,"column":1},"end":{"line":250,"column":1}},"key":"ziUsOxMqH5","urlSource":"figures/diffusionFE.mp4"},{"type":"paragraph","position":{"start":{"line":252,"column":1},"end":{"line":252,"column":1}},"children":[{"type":"text","value":"The growth in norm is exponential in time.","position":{"start":{"line":252,"column":1},"end":{"line":252,"column":1}},"key":"hCLsGmsHGu"}],"key":"UH09APJ9Hp"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"M = max(abs(U), [], 1);     % max in each column\nclf,  semilogy(t, M)\nxlabel('t'), ylabel('max_x |u(x,t)|') \ntitle('Nonphysical growth')","key":"J9NgztgoGn"},{"type":"output","id":"_8PQwThHpv58tfV9XeFQj","data":[{"output_type":"execute_result","execution_count":13,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"84563d488b08b5398e01f9a9031c618a","path":"/fnc/build/84563d488b08b5398e01f9a9031c618a.png"}}}],"key":"LNzqCo8j3C"}],"data":{},"key":"FQzJQM1Qzl"}],"label":"demo-methodlines-heatFE-matlab","identifier":"demo-methodlines-heatfe-matlab","html_id":"demo-methodlines-heatfe-matlab","key":"nQ39AEKZg6"},{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-methodlines-heatbe","label":"demo-methodlines-heatBE","kind":"proof:example","position":{"start":{"line":263,"column":1},"end":{"line":263,"column":25}},"children":[{"type":"text","value":"Example ","key":"XlPcgj7U0Y"},{"type":"text","value":"11.2.4","key":"ONGZyLrawN"}],"template":"Example %s","enumerator":"11.2.4","resolved":true,"html_id":"demo-methodlines-heatbe","remote":true,"url":"/methodlines","dataUrl":"/methodlines.json","key":"PaLSJytEH0"}],"key":"BQx94D4qXy"},{"type":"paragraph","position":{"start":{"line":264,"column":1},"end":{"line":264,"column":1}},"children":[{"type":"text","value":"Now we apply backward Euler to the heat equation. Mathematically this means multiplying by the ","position":{"start":{"line":264,"column":1},"end":{"line":264,"column":1}},"key":"UzrPYExjJ0"},{"type":"emphasis","position":{"start":{"line":264,"column":1},"end":{"line":264,"column":1}},"children":[{"type":"text","value":"inverse","position":{"start":{"line":264,"column":1},"end":{"line":264,"column":1}},"key":"nFP1aeWP9S"}],"key":"vXwqOVpHyf"},{"type":"text","value":" of a matrix, but we interpret that numerically as a linear system solution. We will reuse the setup from ","position":{"start":{"line":264,"column":1},"end":{"line":264,"column":1}},"key":"QmKEU0PPgY"},{"type":"crossReference","kind":"proof:example","identifier":"demo-methodlines-heatfe","label":"demo-methodlines-heatFE","children":[{"type":"text","value":"Demo ","key":"gjLT3iOMa3"},{"type":"text","value":"11.2.2","key":"mpjWpBFNe5"}],"template":"Example %s","enumerator":"11.2.2","resolved":true,"html_id":"demo-methodlines-heatfe","remote":true,"url":"/methodlines","dataUrl":"/methodlines.json","key":"K39RqzFr6x"},{"type":"text","value":".","position":{"start":{"line":264,"column":1},"end":{"line":264,"column":1}},"key":"mcDdvTMNRT"}],"key":"KtaW87cYNB"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"B = sparse(Ix - tau * Dxx);\n[l, u] = lu(B);\nfor j = 1:n\n    U(:, j+1) = u \\ (l \\ U(:, j));\nend\n\nindex_times = 1:600:n+1;\nshow_times = t(index_times);\nclf\nfor j = index_times\n    str = sprintf(\"t = %.2e\", t(j));\n    plot(x, U(:, j), displayname=str) \n    hold on\nend\nlegend(location=\"northwest\")\nxlabel('x'), ylabel('u(x,t)')\ntitle('Heat equation by backward Euler')","key":"zukaaJHVdG"},{"type":"output","id":"-gJA-x5ZnwcFOeJLAgc7N","data":[{"output_type":"execute_result","execution_count":14,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"c20615568ad1d13f62215ab00dc4aaa3","path":"/fnc/build/c20615568ad1d13f62215ab00dc4aaa3.png"}}},{"output_type":"stream","name":"stderr","text":"Warning: Limiting legend entries to 50. Specify a vector of graphics objects to display more than 50 entries."}],"key":"bdWkCxJUjr"}],"data":{},"key":"iDS3qXyCRG"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf\nindex_times = 1:24:n+1;\nplot(x, U(:, 1))\nhold on,  grid on\naxis([0, 1, -0.25, 1])\ntitle('Heat equation by backward Euler') \nxlabel('x'),  ylabel('u(x,t)')\nvid = VideoWriter(\"figures/diffusionBE.mp4\", \"MPEG-4\");\nvid.Quality = 85;\nopen(vid);\nfor frame = index_times\n    cla, plot(x, U(:, frame))\n    str = sprintf(\"t = %.3f\", t(frame));\n    text(0.05, 0.92, str);\n    writeVideo(vid, frame2im(getframe(gcf)));\nend\nclose(vid)","visibility":"hide","key":"aOIbJtXB2y"},{"type":"output","id":"OWFlIKqM2Ho7FgRK2hCFW","data":[{"output_type":"stream","name":"stderr","text":"Error using plot\nSpecify the coordinates as vectors or matrices of the same size, or as a vector and a matrix that share the same length in at least one dimension."}],"visibility":"show","key":"vaPBbAzMAa"}],"data":{"tags":[]},"visibility":"show","key":"FIJiqzcC0P"},{"type":"image","url":"/fnc/build/diffusionBE-17c0adeaa3712b2647b8f63d65953560.mp4","alt":"Stable Backward Euler solution","position":{"start":{"line":307,"column":1},"end":{"line":307,"column":1}},"key":"bTCRMNo5oE","urlSource":"figures/diffusionBE.mp4"},{"type":"paragraph","position":{"start":{"line":309,"column":1},"end":{"line":309,"column":1}},"children":[{"type":"text","value":"This solution looks physically plausible, as the large concentration in the center diffuses outward until the solution is essentially constant. Observe that the solution remains periodic in space for all time.","position":{"start":{"line":309,"column":1},"end":{"line":309,"column":1}},"key":"C8HB4cCvBm"}],"key":"EwVk1xkoB2"}],"label":"demo-methodlines-heatBE-matlab","identifier":"demo-methodlines-heatbe-matlab","html_id":"demo-methodlines-heatbe-matlab","key":"swPmiT8Wys"},{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-methodlines-auto","label":"demo-methodlines-auto","kind":"proof:example","position":{"start":{"line":312,"column":1},"end":{"line":312,"column":23}},"children":[{"type":"text","value":"Example ","key":"r1wqGYumIs"},{"type":"text","value":"11.2.5","key":"Hg5LMpmtkr"}],"template":"Example %s","enumerator":"11.2.5","resolved":true,"html_id":"demo-methodlines-auto","remote":true,"url":"/methodlines","dataUrl":"/methodlines.json","key":"uP5HrLm7mV"}],"key":"o2tHS9Q434"},{"type":"paragraph","position":{"start":{"line":313,"column":1},"end":{"line":313,"column":1}},"children":[{"type":"text","value":"We set up the semidiscretization and initial condition in ","position":{"start":{"line":313,"column":1},"end":{"line":313,"column":1}},"key":"wS2QxII4p3"},{"type":"inlineMath","value":"x","position":{"start":{"line":313,"column":1},"end":{"line":313,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"sHv2kzWTrL"},{"type":"text","value":" just as before.","position":{"start":{"line":313,"column":1},"end":{"line":313,"column":1}},"key":"HBCNKKTEu6"}],"key":"J3KNVDQWL3"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"m = 100;  \n[x, Dx, Dxx] = diffper(m, [0, 1]);\nIx = eye(m);\nu0 = exp( -60 * (x - 0.5).^2 );","key":"aVUY1rRkT4"},{"type":"output","id":"2l7F7rF4ipXlHlYj1YJBl","data":[],"key":"NTSBYgswp7"}],"data":{},"key":"zjm5XPhPPn"},{"type":"paragraph","position":{"start":{"line":322,"column":1},"end":{"line":322,"column":1}},"children":[{"type":"text","value":"Now, however, we apply a standard solver using ","position":{"start":{"line":322,"column":1},"end":{"line":322,"column":1}},"key":"nEsPBtIHqB"},{"type":"inlineCode","value":"solve_ivp","position":{"start":{"line":322,"column":1},"end":{"line":322,"column":1}},"key":"qM4F87T9kh"},{"type":"text","value":" to the initial-value problem ","position":{"start":{"line":322,"column":1},"end":{"line":322,"column":1}},"key":"MzjyRfisnh"},{"type":"inlineMath","value":"\\mathbf{u}'=\\mathbf{D}_{xx}\\mathbf{u}","position":{"start":{"line":322,"column":1},"end":{"line":322,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi mathvariant=\"bold\">u</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo>=</mo><msub><mi mathvariant=\"bold\">D</mi><mrow><mi>x</mi><mi>x</mi></mrow></msub><mi mathvariant=\"bold\">u</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{u}&#x27;=\\mathbf{D}_{xx}\\mathbf{u}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">u</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8361em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">D</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">xx</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord mathbf\">u</span></span></span></span>","key":"PaaBKiDJjq"},{"type":"text","value":".","position":{"start":{"line":322,"column":1},"end":{"line":322,"column":1}},"key":"GxfANFy8ct"}],"key":"g2swXZqTym"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"tfinal = 0.05;\nf = @(t, u, p) Dxx * u;\nivp = ode(ODEFcn=f);\nivp.InitialTime = 0;\nivp.InitialValue = u0;\nivp.Solver = 'ode45';\n[u, sol] = solutionFcn(ivp, 0, tfinal);\n\nclf\nfor t = linspace(0, 0.05, 5)\n    str = sprintf(\"t = %.3f\", t);\n    plot(x, u(t), displayname=str)\n    hold on\nend\nxlabel(\"x\"),  ylabel(\"u(x,t)\")\nlegend()\ntitle(\"Heat equation by ode45\")","key":"YKQ3OuMfGE"},{"type":"output","id":"cjSJtdLN2xn2MBwLDEnzv","data":[{"output_type":"execute_result","execution_count":17,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"a04b7c4cedb18e15a2667ecfff14e775","path":"/fnc/build/a04b7c4cedb18e15a2667ecfff14e775.png"}}}],"key":"a6afacyYIG"}],"data":{},"key":"ag5g3zTAj1"},{"type":"paragraph","position":{"start":{"line":344,"column":1},"end":{"line":344,"column":1}},"children":[{"type":"text","value":"The solution appears to be correct. But the number of time steps that were selected automatically is surprisingly large, considering how smoothly the solution changes.","position":{"start":{"line":344,"column":1},"end":{"line":344,"column":1}},"key":"EEPPWGDVAH"}],"key":"Xg03rnGuMF"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"time_steps_ode45 = length(sol.Time) - 1","key":"VCdWuhwbKl"},{"type":"output","id":"0bQ0TkEyeY7z0TPnEifpO","data":[{"output_type":"execute_result","execution_count":18,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>time_steps_ode45 = 601</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"time_steps_ode45 = 601","content_type":"text/plain"}}}],"key":"cyKdzGlnMO"}],"data":{},"key":"SC9daa7zAR"},{"type":"paragraph","position":{"start":{"line":350,"column":1},"end":{"line":350,"column":1}},"children":[{"type":"text","value":"Now we apply a different solver called ","position":{"start":{"line":350,"column":1},"end":{"line":350,"column":1}},"key":"GvSUolo4AD"},{"type":"inlineCode","value":"BDF","position":{"start":{"line":350,"column":1},"end":{"line":350,"column":1}},"key":"onDg0O7Uzt"},{"type":"text","value":".","position":{"start":{"line":350,"column":1},"end":{"line":350,"column":1}},"key":"iRYGkqMG22"}],"key":"chEMd9U0t1"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"ivp.Solver = \"ode15s\";\n[u, sol] = solutionFcn(ivp, 0, tfinal);\ntime_steps_ode15s = length(sol.Time) - 1","key":"Qo1ZlWMIQ3"},{"type":"output","id":"43HqNN0DxjxtCLuSK6bni","data":[{"output_type":"execute_result","execution_count":19,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>time_steps_ode15s = 41</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"time_steps_ode15s = 41","content_type":"text/plain"}}}],"key":"j4IG7FhwUs"}],"data":{},"key":"cqUQbx5ov2"},{"type":"paragraph","position":{"start":{"line":358,"column":1},"end":{"line":358,"column":1}},"children":[{"type":"text","value":"The number of steps selected was reduced by a factor of 20!","position":{"start":{"line":358,"column":1},"end":{"line":358,"column":1}},"key":"lwuiFMFALg"}],"key":"vnFjeRH0XR"}],"label":"demo-methodlines-auto-matlab","identifier":"demo-methodlines-auto-matlab","html_id":"demo-methodlines-auto-matlab","key":"C9tb8x8jqW"},{"type":"heading","depth":3,"position":{"start":{"line":361,"column":1},"end":{"line":361,"column":1}},"children":[{"type":"text","value":"11.3 ","position":{"start":{"line":361,"column":1},"end":{"line":361,"column":1}},"key":"uObLN67GJ0"},{"type":"link","identifier":"section-diffusion-absstab","label":"section-diffusion-absstab","kind":"narrative","position":{"start":{"line":361,"column":6},"end":{"line":361,"column":32}},"url":"/absstab-diffusion","internal":true,"dataUrl":"/absstab-diffusion.json","children":[{"type":"text","value":"Absolute stability","key":"pLA20seC0A"}],"key":"DstClTf9TQ"}],"identifier":"id-11-3","label":"11.3 ","html_id":"id-11-3","implicit":true,"key":"TKrl5DgsSC"},{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-absstab-regions","label":"demo-absstab-regions","kind":"proof:example","position":{"start":{"line":363,"column":1},"end":{"line":363,"column":22}},"children":[{"type":"text","value":"Example ","key":"pf18CuHR0s"},{"type":"text","value":"11.3.5","key":"uqowadVIlh"}],"template":"Example %s","enumerator":"11.3.5","resolved":true,"html_id":"demo-absstab-regions","remote":true,"url":"/absstab-diffusion","dataUrl":"/absstab-diffusion.json","key":"Gjg3CzwA7G"}],"key":"t0HyDWiN8O"},{"type":"paragraph","position":{"start":{"line":364,"column":1},"end":{"line":364,"column":1}},"children":[{"type":"text","value":"Euler and Backward Euler time-stepping methods were used to solve ","position":{"start":{"line":364,"column":1},"end":{"line":364,"column":1}},"key":"fcFTTjFeBA"},{"type":"inlineMath","value":"\\mathbf{u}'=\\mathbf{D}_{xx}\\mathbf{u}","position":{"start":{"line":364,"column":1},"end":{"line":364,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi mathvariant=\"bold\">u</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo>=</mo><msub><mi mathvariant=\"bold\">D</mi><mrow><mi>x</mi><mi>x</mi></mrow></msub><mi mathvariant=\"bold\">u</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{u}&#x27;=\\mathbf{D}_{xx}\\mathbf{u}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">u</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8361em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">D</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">xx</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord mathbf\">u</span></span></span></span>","key":"uWbpnvMNzD"},{"type":"text","value":".","position":{"start":{"line":364,"column":1},"end":{"line":364,"column":1}},"key":"QVQ5TYdtrV"}],"key":"f13eMRPr0S"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"m = 40;  \n[x, Dx, Dxx] = diffper(m, [0, 1]);","key":"UbaTETeCfC"},{"type":"output","id":"FUuUTaGAlPjQV1qGBNAm3","data":[],"key":"UiPbd18AWv"}],"data":{},"key":"LHA6DKqyPy"},{"type":"paragraph","position":{"start":{"line":371,"column":1},"end":{"line":371,"column":1}},"children":[{"type":"text","value":"The eigenvalues of this matrix are real and negative:","position":{"start":{"line":371,"column":1},"end":{"line":371,"column":1}},"key":"aMVcHjIBdD"}],"key":"NLxkoWF8WP"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"lambda = eig(Dxx);\nclf\nplot(real(lambda), imag(lambda), 'o')\naxis equal, grid on\nxlabel('Re \\lambda'),  ylabel('Im \\lambda')\ntitle('Eigenvalues')","key":"p5k7dlaA9u"},{"type":"output","id":"JQEbMYQ-gdsxX5sbdHgc1","data":[{"output_type":"execute_result","execution_count":21,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"e52fcab054e178b6088850e0f17580e5","path":"/fnc/build/e52fcab054e178b6088850e0f17580e5.png"}}}],"key":"f7makeqIvT"}],"data":{},"key":"r0aDNaWWg9"},{"type":"paragraph","position":{"start":{"line":382,"column":1},"end":{"line":382,"column":1}},"children":[{"type":"text","value":"The Euler method is absolutely stable in the region ","position":{"start":{"line":382,"column":1},"end":{"line":382,"column":1}},"key":"XqJKVoXxsc"},{"type":"inlineMath","value":"|\\zeta+1| \\le 1","position":{"start":{"line":382,"column":1},"end":{"line":382,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">∣</mi><mi>ζ</mi><mo>+</mo><mn>1</mn><mi mathvariant=\"normal\">∣</mi><mo>≤</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">|\\zeta+1| \\le 1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">∣</span><span class=\"mord mathnormal\" style=\"margin-right:0.07378em;\">ζ</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1∣</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"In4kQTbuAW"},{"type":"text","value":" in the complex plane:","position":{"start":{"line":382,"column":1},"end":{"line":382,"column":1}},"key":"xwgi9BDuA9"}],"key":"mPGPTPWNhQ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"phi = linspace(0, 2*pi, 361);\nz = exp(1i*phi) - 1;   % unit circle shifted to the left by 1\nfill(real(z), imag(z), [.8, .8, 1])\naxis equal,  grid on\nxlabel('Re \\lambda'),  ylabel('Im \\lambda')\ntitle('Stability region')","visibility":"hide","key":"SAVbGjIJZt"},{"type":"output","id":"jJCpqBG-T8zRCJuvcBpCl","data":[{"output_type":"execute_result","execution_count":22,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"6c59964eb3091914542019c191bcc6db","path":"/fnc/build/6c59964eb3091914542019c191bcc6db.png"}}}],"visibility":"show","key":"c7LmRI8lF1"}],"data":{"tags":[]},"visibility":"show","key":"vzPL1gS0Rl"},{"type":"paragraph","position":{"start":{"line":394,"column":1},"end":{"line":394,"column":1}},"children":[{"type":"text","value":"In order to get inside this region, we have to find ","position":{"start":{"line":394,"column":1},"end":{"line":394,"column":1}},"key":"AoL4iSzDRO"},{"type":"text","value":"τ","position":{"start":{"line":394,"column":1},"end":{"line":394,"column":1}},"key":"Ol0dbKizMo"},{"type":"text","value":" such that ","position":{"start":{"line":394,"column":1},"end":{"line":394,"column":1}},"key":"i0Lk6WNrF9"},{"type":"inlineMath","value":"\\lambda \\tau > -2","position":{"start":{"line":394,"column":1},"end":{"line":394,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>λ</mi><mi>τ</mi><mo>&gt;</mo><mo>−</mo><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">\\lambda \\tau &gt; -2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7335em;vertical-align:-0.0391em;\"></span><span class=\"mord mathnormal\">λ</span><span class=\"mord mathnormal\" style=\"margin-right:0.1132em;\">τ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&gt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">−</span><span class=\"mord\">2</span></span></span></span>","key":"uUpDCaeOJr"},{"type":"text","value":" for all eigenvalues ","position":{"start":{"line":394,"column":1},"end":{"line":394,"column":1}},"key":"Mo5fURdmAq"},{"type":"text","value":"λ","position":{"start":{"line":394,"column":1},"end":{"line":394,"column":1}},"key":"JeuGqNfxy1"},{"type":"text","value":". This is an upper bound on ","position":{"start":{"line":394,"column":1},"end":{"line":394,"column":1}},"key":"l37YIxyVNF"},{"type":"text","value":"τ","position":{"start":{"line":394,"column":1},"end":{"line":394,"column":1}},"key":"yPL0rEwizY"},{"type":"text","value":".","position":{"start":{"line":394,"column":1},"end":{"line":394,"column":1}},"key":"t5FWzliyQp"}],"key":"DKXBrlcXWu"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"lambda_min = min(lambda)\nmax_tau = -2 / lambda_min","key":"rONtyXGVUn"},{"type":"output","id":"A5h1kMqvw39wzqzSPhmm1","data":[{"output_type":"execute_result","execution_count":23,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>lambda_min = -6400</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"lambda_min = -6400","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":23,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>max_tau = 3.1250e-04</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"max_tau = 3.1250e-04","content_type":"text/plain"}}}],"key":"qBR92ZkN8J"}],"data":{},"key":"Zuu8JNiNDt"},{"type":"paragraph","position":{"start":{"line":401,"column":1},"end":{"line":401,"column":1}},"children":[{"type":"text","value":"Here we plot the resulting values of ","position":{"start":{"line":401,"column":1},"end":{"line":401,"column":1}},"key":"XBAF6FFVzz"},{"type":"inlineMath","value":"\\zeta=\\lambda \\tau","position":{"start":{"line":401,"column":1},"end":{"line":401,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ζ</mi><mo>=</mo><mi>λ</mi><mi>τ</mi></mrow><annotation encoding=\"application/x-tex\">\\zeta=\\lambda \\tau</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07378em;\">ζ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">λ</span><span class=\"mord mathnormal\" style=\"margin-right:0.1132em;\">τ</span></span></span></span>","key":"tUStDiiSUQ"},{"type":"text","value":".","position":{"start":{"line":401,"column":1},"end":{"line":401,"column":1}},"key":"K2Et2FqxAx"}],"key":"wXHl9p2uKt"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"zeta = lambda * max_tau;\nhold on\nplot(real(zeta), imag(zeta), 'o')\ntitle('Stability region and \\zeta values')","key":"OA3PVFPyNg"},{"type":"output","id":"DABptcuiSj6aku7d2KZOE","data":[{"output_type":"execute_result","execution_count":24,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"8d60a92d9a6717f09f0296e152f0e71d","path":"/fnc/build/8d60a92d9a6717f09f0296e152f0e71d.png"}}}],"key":"gh4SXusbZC"}],"data":{},"key":"Lk0o9Uvide"},{"type":"paragraph","position":{"start":{"line":410,"column":1},"end":{"line":410,"column":1}},"children":[{"type":"text","value":"In backward Euler, the region is ","position":{"start":{"line":410,"column":1},"end":{"line":410,"column":1}},"key":"yftNUhomp8"},{"type":"inlineMath","value":"|\\zeta-1|\\ge 1","position":{"start":{"line":410,"column":1},"end":{"line":410,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">∣</mi><mi>ζ</mi><mo>−</mo><mn>1</mn><mi mathvariant=\"normal\">∣</mi><mo>≥</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">|\\zeta-1|\\ge 1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">∣</span><span class=\"mord mathnormal\" style=\"margin-right:0.07378em;\">ζ</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1∣</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≥</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"mCz0KksD9l"},{"type":"text","value":". Because they are all on the negative real axis, all of the ","position":{"start":{"line":410,"column":1},"end":{"line":410,"column":1}},"key":"mmOgXep2UB"},{"type":"text","value":"ζ","position":{"start":{"line":410,"column":1},"end":{"line":410,"column":1}},"key":"gfHKB0vD8y"},{"type":"text","value":" values will fit no matter what ","position":{"start":{"line":410,"column":1},"end":{"line":410,"column":1}},"key":"LomfUhTNM6"},{"type":"text","value":"τ","position":{"start":{"line":410,"column":1},"end":{"line":410,"column":1}},"key":"C07H4hdU2S"},{"type":"text","value":" is chosen.","position":{"start":{"line":410,"column":1},"end":{"line":410,"column":1}},"key":"qSnLNTmQQ0"}],"key":"y8vGvFePXl"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf,  fill([-6, 6, 6, -6],[-6, -6, 6, 6],[.8, .8, 1])\nhold on\nz = exp(1i*phi) + 1;   % unit circle shifted right by 1\nfill(real(z), imag(z), 'w')\nplot(real(zeta), imag(zeta), 'o')\naxis equal,  axis([-4, 2, -3, 3]), grid on\nxlabel('Re \\lambda'),  ylabel('Im \\lambda')\ntitle('Stability region and \\zeta values')","visibility":"hide","key":"JpSUCobPCB"},{"type":"output","id":"cAJMzKjjt14uB_dxX-3mU","data":[{"output_type":"execute_result","execution_count":25,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"7f3e7fc3bd8e01da8a195f97a128cb10","path":"/fnc/build/7f3e7fc3bd8e01da8a195f97a128cb10.png"}}}],"visibility":"show","key":"ihXIx12eMR"}],"data":{"tags":[]},"visibility":"show","key":"ql5YCtsCwd"}],"label":"demo-absstab-regions-matlab","identifier":"demo-absstab-regions-matlab","html_id":"demo-absstab-regions-matlab","key":"QanTviPxqv"},{"type":"heading","depth":3,"position":{"start":{"line":426,"column":1},"end":{"line":426,"column":1}},"children":[{"type":"text","value":"11.4 ","position":{"start":{"line":426,"column":1},"end":{"line":426,"column":1}},"key":"j0pjkN4Pcq"},{"type":"link","identifier":"section-diffusion-stiffness","label":"section-diffusion-stiffness","kind":"narrative","position":{"start":{"line":426,"column":6},"end":{"line":426,"column":34}},"url":"/stiffness","internal":true,"dataUrl":"/stiffness.json","children":[{"type":"text","value":"Stiffness","key":"PRsgVlGaDc"}],"key":"AlugZKfoQt"}],"identifier":"id-11-4","label":"11.4 ","html_id":"id-11-4","implicit":true,"key":"Q5p95uS40H"},{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-stiffness-oregon","label":"demo-stiffness-oregon","kind":"proof:example","position":{"start":{"line":428,"column":1},"end":{"line":428,"column":23}},"children":[{"type":"text","value":"Example ","key":"d8cSt1kQ0i"},{"type":"text","value":"11.4.2","key":"o7ihYLKjML"}],"template":"Example %s","enumerator":"11.4.2","resolved":true,"html_id":"demo-stiffness-oregon","remote":true,"url":"/stiffness","dataUrl":"/stiffness.json","key":"nPP5ZxQMbB"}],"key":"W3MAix2nR6"},{"type":"paragraph","position":{"start":{"line":429,"column":1},"end":{"line":429,"column":1}},"children":[{"type":"text","value":"In ","position":{"start":{"line":429,"column":1},"end":{"line":429,"column":1}},"key":"nOyFbGp9iB"},{"type":"crossReference","kind":"proof:example","identifier":"example-stiffness-oregon","label":"example-stiffness-oregon","children":[{"type":"text","value":"Example ","key":"p9EsXLaliv"},{"type":"text","value":"11.4.1","key":"Y4AF0YZIWC"}],"template":"Example %s","enumerator":"11.4.1","resolved":true,"html_id":"example-stiffness-oregon","remote":true,"url":"/stiffness","dataUrl":"/stiffness.json","key":"Yo9WCcFUYg"},{"type":"text","value":" we derived a Jacobian matrix for the Oregonator model. Here is a numerical solution of the ","key":"hC0ljDrO0J"},{"type":"abbreviation","title":"ordinary differential equation","children":[{"type":"text","value":"ODE","key":"e2vcLT76ah"}],"key":"QJXtcW7XXN"},{"type":"text","value":".","key":"Sq8LDzrCES"}],"key":"WrJUAVxNbI"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"q = 8.375e-6;  s = 77.27;  w = 0.161;\nf = @(t, u, p) [ s*(u(2)- u(1) * u(2) + u(1) - q * u(1)^2);...\n    (-u(2) - u(1) * u(2) + u(3)) / s; ...\n    w*(u(1) - u(3)) ];\n\nivp = ode(ODEFcn=f);\nivp.InitialTime = 0;\nivp.InitialValue = [1; 2; 3];\nivp.Solver = \"ode15s\";\nsol = solve(ivp, 0, 500); \nclf,  semilogy(sol.Time, sol.Solution)\nxlabel('t'),  ylabel('u(t)')\ntitle('Oregonator')","visibility":"hide","key":"zWXhr6f63b"},{"type":"output","id":"aq8gB8xx3rl_mJEGVhNe6","data":[{"output_type":"execute_result","execution_count":26,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"1d3b54647ad7c354fb27c458afcd3fbe","path":"/fnc/build/1d3b54647ad7c354fb27c458afcd3fbe.png"}}}],"visibility":"show","key":"MLW3sM6BZs"}],"data":{"tags":[]},"visibility":"show","key":"M4EGiLeIPJ"},{"type":"paragraph","position":{"start":{"line":448,"column":1},"end":{"line":448,"column":1}},"children":[{"type":"text","value":"At each value of the numerical solution, we can compute the eigenvalues of the Jacobian. Here we plot all of those eigenvalues in the complex plane.","position":{"start":{"line":448,"column":1},"end":{"line":448,"column":1}},"key":"NIluTmR7Xe"}],"key":"IgQ4bSx7kW"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"J = @(u) [ -s*(u(2)+1-2*q*u(1)), s*(1-u(1)), 0; ...\n    -u(2)/s, (-1-u(1))/s, 1/s; ...\n    w,0,-w];\n\nt = sol.Time;\nu = sol.Solution;\nlambda = zeros(length(t) - 1, 3);\nfor j = 1:length(t)-1\n    lambda(j, :) = eig(J(u(:, j)));\nend\nplot3(real(lambda), imag(lambda), t(1:end-1), 'o')\nxlabel(\"Re $\\\\lambda$\"),  ylabel(\"Im $\\\\lambda$\"),  zlabel(\"$t$\")\ntitle(\"Oregonator eigenvalues\")","visibility":"hide","key":"btTKX0eZpj"},{"type":"output","id":"fRm9Kp8u69xI88tESmDni","data":[{"output_type":"stream","name":"stderr","text":"Dot indexing is not supported for variables of this type."}],"visibility":"show","key":"LLp3VfN4ND"}],"data":{"tags":[]},"visibility":"show","key":"Ol5HV7jpVg"},{"type":"paragraph","position":{"start":{"line":467,"column":1},"end":{"line":467,"column":1}},"children":[{"type":"text","value":"You can see that there is one eigenvalue that ranges over a wide portion of the negative real axis and dominates stability considerations.","position":{"start":{"line":467,"column":1},"end":{"line":467,"column":1}},"key":"TBTWUB1Opy"}],"key":"QaGhfJ1h1w"}],"label":"demo-stiffness-oregon-matlab","identifier":"demo-stiffness-oregon-matlab","html_id":"demo-stiffness-oregon-matlab","key":"VsNbGoZRhf"},{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-stiffness-explicit","label":"demo-stiffness-explicit","kind":"proof:example","position":{"start":{"line":471,"column":1},"end":{"line":471,"column":25}},"children":[{"type":"text","value":"Example ","key":"uYB0a0O8iq"},{"type":"text","value":"11.4.3","key":"E8WJRGMUUA"}],"template":"Example %s","enumerator":"11.4.3","resolved":true,"html_id":"demo-stiffness-explicit","remote":true,"url":"/stiffness","dataUrl":"/stiffness.json","key":"UQClXOfna3"}],"key":"T51JbIXAK6"},{"type":"paragraph","position":{"start":{"line":472,"column":1},"end":{"line":472,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":472,"column":1},"end":{"line":472,"column":1}},"key":"OFlcM0PS0e"},{"type":"inlineCode","value":"ode15s","position":{"start":{"line":472,"column":1},"end":{"line":472,"column":1}},"key":"ghmEx1X3Cz"},{"type":"text","value":" solver is good for stiff problems and needs few time steps to solve the Oregonator from ","position":{"start":{"line":472,"column":1},"end":{"line":472,"column":1}},"key":"GXqFuXMFis"},{"type":"crossReference","kind":"proof:example","identifier":"demo-stiffness-oregon","label":"demo-stiffness-oregon","children":[{"type":"text","value":"Demo ","key":"FCKmXU0KtS"},{"type":"text","value":"11.4.2","key":"WHcuwUi0Aj"}],"template":"Example %s","enumerator":"11.4.2","resolved":true,"html_id":"demo-stiffness-oregon","remote":true,"url":"/stiffness","dataUrl":"/stiffness.json","key":"duFnkjBG3z"},{"type":"text","value":".","position":{"start":{"line":472,"column":1},"end":{"line":472,"column":1}},"key":"eYDh3BsJZ1"}],"key":"nARZmNGuny"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"tic,  sol = solve(ivp, 0, 26); \ntime_ode15s = toc\nnum_steps_ode15s = length(sol.Time) - 1","key":"ov1VfQQ8TE"},{"type":"output","id":"dPYuBGLU-8mw_HaD1FAUh","data":[{"output_type":"execute_result","execution_count":28,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>time_ode15s = 1.8241</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"time_ode15s = 1.8241","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":28,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>num_steps_ode15s = 19804</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"num_steps_ode15s = 19804","content_type":"text/plain"}}}],"key":"SbsZQApwlg"}],"data":{},"key":"OpKyO8z7RG"},{"type":"paragraph","position":{"start":{"line":480,"column":1},"end":{"line":480,"column":1}},"children":[{"type":"text","value":"But if we apply ","position":{"start":{"line":480,"column":1},"end":{"line":480,"column":1}},"key":"wnjxZDbkMR"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-rk23","label":"function-rk23","children":[{"type":"text","value":"Function ","key":"REgtKdswoK"},{"type":"text","value":"6.5.2","key":"amBQqh3Gxm"}],"template":"Algorithm %s","enumerator":"6.5.2","resolved":true,"html_id":"function-rk23","remote":true,"url":"/adaptive-rk","dataUrl":"/adaptive-rk.json","key":"Hao6t5OxEe"},{"type":"text","value":" to the problem, the step size will be made small enough to cope with the large negative eigenvalue.","position":{"start":{"line":480,"column":1},"end":{"line":480,"column":1}},"key":"gjOd1RJwIy"}],"key":"Atj4YauMH8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"tic, [t, u] = rk23(ivp, 0, 26, 1e-5);\ntime_rk23 = toc\nnum_steps_rk23 = length(t) - 1","key":"Tp4CV9IHOG"},{"type":"output","id":"8MJjzpU49WmDgoInruaGU","data":[{"output_type":"stream","name":"stderr","text":"Not enough input arguments.\n\nError in f13_2_wave (line 2)\n    [Dxx, Dyy, pack, unpack] = p{:};\n\nError in rk23 (line 19)\ns1 = du_dt(t(1), u(:, 1));"}],"key":"PjmWYv5HAU"}],"data":{},"key":"fpyHGVGGcN"},{"type":"paragraph","position":{"start":{"line":488,"column":1},"end":{"line":488,"column":1}},"children":[{"type":"text","value":"Starting from the eigenvalues of the Jacobian matrix, we can find an effective ","position":{"start":{"line":488,"column":1},"end":{"line":488,"column":1}},"key":"oaXPb0ay8v"},{"type":"inlineMath","value":"\\zeta(t)","position":{"start":{"line":488,"column":1},"end":{"line":488,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ζ</mi><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\zeta(t)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07378em;\">ζ</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span></span></span></span>","key":"iaWzkVT8Rl"},{"type":"text","value":" by multiplying with the local time step size. The values of ","position":{"start":{"line":488,"column":1},"end":{"line":488,"column":1}},"key":"p2UbctT9qo"},{"type":"inlineMath","value":"\\zeta(t)","position":{"start":{"line":488,"column":1},"end":{"line":488,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ζ</mi><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\zeta(t)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07378em;\">ζ</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span></span></span></span>","key":"vPhwGnPLfA"},{"type":"text","value":" for each time level are plotted below and color coded by component of the diagonalized system.","position":{"start":{"line":488,"column":1},"end":{"line":488,"column":1}},"key":"Fz6JEOXgIT"}],"key":"ZrZ8L6gdMh"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"zeta = zeros(length(t) - 1, 3);\nfor j = 1:length(t)-1\n    lambda = eig(J(u(:, j)));\n    zeta(j, :) = (t(j+1) - t(j)) * lambda;\nend\nplot(zeta, 'o')\naxis equal, grid on\nxlabel('Re \\zeta'),  ylabel('Im \\zeta')\ntitle(\"Oregonator stability\")","visibility":"hide","key":"m3ocbl6vcD"},{"type":"output","id":"YMNMpt9ESzA3xbEFjhoOs","data":[{"output_type":"execute_result","execution_count":30,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"c26f13bcb8877a33f5245205e94bf00f","path":"/fnc/build/c26f13bcb8877a33f5245205e94bf00f.png"}}}],"visibility":"show","key":"z8DLNmcZJL"}],"data":{"tags":[]},"visibility":"show","key":"EUoST4fV8A"},{"type":"paragraph","position":{"start":{"line":503,"column":1},"end":{"line":503,"column":1}},"children":[{"type":"text","value":"Roughly speaking, the ","position":{"start":{"line":503,"column":1},"end":{"line":503,"column":1}},"key":"VglQwkE90g"},{"type":"text","value":"ζ","position":{"start":{"line":503,"column":1},"end":{"line":503,"column":1}},"key":"hTK0lnonTW"},{"type":"text","value":" values stay within or close to the RK2 stability region in ","position":{"start":{"line":503,"column":1},"end":{"line":503,"column":1}},"key":"YmyJLtmaIG"},{"type":"crossReference","kind":"figure","identifier":"figure-stabreg_bd_rk","label":"figure-stabreg_bd_rk","children":[{"type":"text","value":"Figure ","key":"JyMx2Wsodd"},{"type":"text","value":"11.3.2","key":"OMsTLSaMM4"}],"template":"Figure %s","enumerator":"11.3.2","resolved":true,"html_id":"figure-stabreg-bd-rk","remote":true,"url":"/absstab-diffusion","dataUrl":"/absstab-diffusion.json","key":"yKjPwkWBtK"},{"type":"text","value":". Momentary departures from the region are possible, but time stepping repeatedly in that situation would cause instability.","position":{"start":{"line":503,"column":1},"end":{"line":503,"column":1}},"key":"koT43cPmwU"}],"key":"nMb83D4pqh"}],"label":"demo-stiffness-explicit-matlab","identifier":"demo-stiffness-explicit-matlab","html_id":"demo-stiffness-explicit-matlab","key":"PKZLqlOJBq"},{"type":"heading","depth":3,"position":{"start":{"line":506,"column":1},"end":{"line":506,"column":1}},"children":[{"type":"text","value":"11.5 ","position":{"start":{"line":506,"column":1},"end":{"line":506,"column":1}},"key":"sayFPPwjxR"},{"type":"link","identifier":"section-diffusion-boundaries","label":"section-diffusion-boundaries","kind":"narrative","position":{"start":{"line":506,"column":6},"end":{"line":506,"column":35}},"url":"/boundaries","internal":true,"dataUrl":"/boundaries.json","children":[{"type":"text","value":"Boundaries","key":"u1DgmOeaFl"}],"key":"jEVjf3IUNg"}],"identifier":"id-11-5","label":"11.5 ","html_id":"id-11-5","implicit":true,"key":"CIeACs661W"},{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-boundaries-heat","label":"demo-boundaries-heat","kind":"proof:example","position":{"start":{"line":508,"column":1},"end":{"line":508,"column":22}},"children":[{"type":"text","value":"Example ","key":"GEhWcVOkth"},{"type":"text","value":"11.5.3","key":"dbcICeNRy6"}],"template":"Example %s","enumerator":"11.5.3","resolved":true,"html_id":"demo-boundaries-heat","remote":true,"url":"/boundaries","dataUrl":"/boundaries.json","key":"C185RnDRGI"}],"key":"dz9RtDYhPH"},{"type":"paragraph","position":{"start":{"line":509,"column":1},"end":{"line":509,"column":1}},"children":[{"type":"text","value":"First, we define functions for the ","key":"gscvua53dz"},{"type":"abbreviation","title":"partial differential equation","children":[{"type":"text","value":"PDE","key":"anADt3sD1b"}],"key":"JJ2Wp731vw"},{"type":"text","value":" and each boundary condition.","key":"FYpHbBU3XK"}],"key":"pULCIiTeRK"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"phi = @(t, x, u, ux, uxx) uxx;\nga = @(u, ux) u;\ngb = @(u, ux) u - 2;","key":"AqkFjW4uSy"},{"type":"output","id":"1V174NEt59-rlKhfjACXD","data":[],"key":"jTb5ZDRYIw"}],"data":{},"key":"Zam44cR7TY"},{"type":"paragraph","position":{"start":{"line":517,"column":1},"end":{"line":517,"column":1}},"children":[{"type":"text","value":"Our next step is to write a function to define the initial condition. This one satisfies the boundary conditions exactly.","position":{"start":{"line":517,"column":1},"end":{"line":517,"column":1}},"key":"pEGUOxai3A"}],"key":"DDx7xWjNo9"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"init = @(x) 1 + sin(pi * x/2) + 3 * (1 - x.^2) .* exp(-4*x.^2);","key":"b7cEg4TSmL"},{"type":"output","id":"4B5ET7XTZfQdFh30_3uok","data":[],"key":"qSHGtAoIfc"}],"data":{},"key":"bWUo8LBPSu"},{"type":"paragraph","position":{"start":{"line":523,"column":1},"end":{"line":523,"column":1}},"children":[{"type":"text","value":"Now we can use ","position":{"start":{"line":523,"column":1},"end":{"line":523,"column":1}},"key":"p5WULAVDY0"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-parabolic","label":"function-parabolic","children":[{"type":"text","value":"Function ","key":"zF7PYoNjEz"},{"type":"text","value":"11.5.2","key":"cKAcLdYoIS"}],"template":"Algorithm %s","enumerator":"11.5.2","resolved":true,"html_id":"function-parabolic","remote":true,"url":"/boundaries","dataUrl":"/boundaries.json","key":"yVvGgt4Psf"},{"type":"text","value":" to solve the problem.","position":{"start":{"line":523,"column":1},"end":{"line":523,"column":1}},"key":"DLFEBgqIbi"}],"key":"wHsyr2t9Ob"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[x, u] = parabolic(phi, [-1, 1], 60, ga, gb, [0, 0.75], init);\n\nclf\nfor t = 0:0.1:0.5\n    str = sprintf(\"t = %.2f\", t);\n    plot(x, u(t), displayname=str)\n    hold on\nend\nxlabel(\"x\"),  ylabel(\"u(x,t)\")\nlegend()\ntitle(\"Heat equation with Dirichlet boundaries\")","key":"X0QEOCoJzJ"},{"type":"output","id":"hfw-MiGrpJmicsPC725dx","data":[{"output_type":"execute_result","execution_count":33,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"860ad704313c684278475c6916c2a30e","path":"/fnc/build/860ad704313c684278475c6916c2a30e.png"}}}],"key":"WuPRj3n2q8"}],"data":{},"key":"KbEB0kZjn2"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf\nplot(x, u(0))\nhold on,  grid on\naxis([-1, 1, 0, 4.2])\ntitle('Heat equation with Dirichlet boundaries') \nxlabel('x'),  ylabel('u(x,t)')\nvid = VideoWriter(\"figures/boundaries-heat.mp4\", \"MPEG-4\");\nvid.Quality = 85;\nopen(vid);\nfor t = linspace(0, 0.75, 201)\n    cla, plot(x, u(t))\n    str = sprintf(\"t = %.3f\", t);\n    text(-0.9, 3.8, str);\n    writeVideo(vid, frame2im(getframe(gcf)));\nend\nclose(vid)","visibility":"show","key":"sXQfA4Tovn"},{"type":"output","id":"l-3cEDvfBIxiunrZZfW33","data":[{"output_type":"execute_result","execution_count":34,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"15bb5fbdab66dfa7d232809e95655c2a","path":"/fnc/build/15bb5fbdab66dfa7d232809e95655c2a.png"}}},{"output_type":"stream","name":"stderr","text":"Cannot create file figures/boundaries-heat.mp4. Permission Denied."}],"visibility":"show","key":"xi2D2tvd59"}],"data":{"tags":[]},"visibility":"remove","key":"uZn1vF0VR9"},{"type":"image","url":"/fnc/build/boundaries-heat-645656178a7f3383fb383f4ad8fb50ef.mp4","alt":"Heat equation with Dirichlet boundaries","position":{"start":{"line":558,"column":1},"end":{"line":558,"column":1}},"key":"oPr32uDlPw","urlSource":"figures/boundaries-heat.mp4"}],"label":"demo-boundaries-heat-matlab","identifier":"demo-boundaries-heat-matlab","html_id":"demo-boundaries-heat-matlab","key":"lL4CVdyTfb"},{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-boundaries-bratu","label":"demo-boundaries-bratu","kind":"proof:example","position":{"start":{"line":564,"column":1},"end":{"line":564,"column":23}},"children":[{"type":"text","value":"Example ","key":"V3uICoGw1m"},{"type":"text","value":"11.5.4","key":"bVMOPT06Ar"}],"template":"Example %s","enumerator":"11.5.4","resolved":true,"html_id":"demo-boundaries-bratu","remote":true,"url":"/boundaries","dataUrl":"/boundaries.json","key":"rff7k9N32A"}],"key":"geULMMn28I"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"phi = @(t, x, u, ux, uxx) u.^2 + uxx;\nga = @(u, ux) u;\ngb = @(u, ux) ux;\n\ninit = @(x) 400 * x.^4 .* (1 - x).^2;\n[x, u] = parabolic(phi, [0, 1], 60, ga, gb, [0, 0.1], init);","key":"fkk6Mqi1Yq"},{"type":"output","id":"jeMupbECETQXh1fCbau7V","data":[],"key":"XnmMsSS4S0"}],"data":{},"key":"yYi5US55y6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf\nplot(x, u(0))\nhold on,  grid on\naxis([0, 1, 0, 10])\ntitle(\"Heat equation with source\")\nxlabel('x'),  ylabel('u(x,t)')\nvid = VideoWriter(\"figures/boundaries-source.mp4\", \"MPEG-4\");\nvid.Quality = 85;\nopen(vid);\nfor t = linspace(0, 0.1, 101)\n    cla, plot(x, u(t))\n    str = sprintf(\"t = %.3f\", t);\n    text(0.05, 9.2, str);\n    writeVideo(vid, frame2im(getframe(gcf)));\nend\nclose(vid)","visibility":"show","key":"vYkIlzNf65"},{"type":"output","id":"WBlohpSbgn4Omim1mX7PJ","data":[{"output_type":"execute_result","execution_count":36,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"b863206b9f34b7d11ab4195607403b47","path":"/fnc/build/b863206b9f34b7d11ab4195607403b47.png"}}},{"output_type":"stream","name":"stderr","text":"Cannot create file figures/boundaries-source.mp4. Permission Denied."}],"visibility":"show","key":"G8VAOlTsJf"}],"data":{"tags":[]},"visibility":"hide","key":"RYnaRc6BuS"},{"type":"image","url":"/fnc/build/boundaries-source-6f7115b077804a6eda45451ef4481648.mp4","alt":"Heat equation with source","position":{"start":{"line":595,"column":1},"end":{"line":595,"column":1}},"key":"EyTOoY6ZPP","urlSource":"figures/boundaries-source.mp4"}],"label":"demo-boundaries-bratu-matlab","identifier":"demo-boundaries-bratu-matlab","html_id":"demo-boundaries-bratu-matlab","key":"rQs4HbZsUs"},{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-boundaries-bs","label":"demo-boundaries-bs","kind":"proof:example","position":{"start":{"line":599,"column":1},"end":{"line":599,"column":20}},"children":[{"type":"text","value":"Example ","key":"Fdjz0Cg3v5"},{"type":"text","value":"11.5.5","key":"ipPTVFQ4pD"}],"template":"Example %s","enumerator":"11.5.5","resolved":true,"html_id":"demo-boundaries-bs","remote":true,"url":"/boundaries","dataUrl":"/boundaries.json","key":"XkazYangOy"}],"key":"BzD8MPeHLp"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"K = 3;  sigma = 0.06;  r = 0.08;  Smax = 8;\nphi = @(t, x, u, ux, uxx) sigma.^2/2 * (x.^2 .* uxx) + r * x.*ux - r*u;\nga = @(u, ux) u;\ngb = @(u, ux) ux - 1;","key":"R2ZyzxPhXc"},{"type":"output","id":"4iOXPYSD9AO_LP8fe7dZK","data":[],"key":"XKmwTkYaYc"}],"data":{},"key":"INxrlqB7ra"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"init = @(x) max(0, x - K);\n[x, u] = parabolic(phi, [0, Smax], 80, ga, gb, [0, 15], init);","key":"AQ0qiUFaVF"},{"type":"output","id":"uX2E9oCpPFSZNE1aSQAwP","data":[],"key":"bDovuME31m"}],"data":{},"key":"bXUT7qmtnF"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf\nplot(x, u(0))\nhold on,  grid on\naxis([0, Smax, -0.1, 8])\ntitle(\"Black–Scholes equation with boundaries\")\nxlabel('x'),  ylabel('u(x,t)')\nvid = VideoWriter(\"figures/boundaries-bs.mp4\", \"MPEG-4\");\nvid.Quality = 85;\nopen(vid);\nfor t = linspace(0, 15, 151)\n    cla, plot(x, u(t))\n    str = sprintf(\"t = %.1f\", t);\n    text(0.5, 7.1, str);\n    writeVideo(vid, frame2im(getframe(gcf)));\nend\nclose(vid)","visibility":"remove","key":"mnOs2Ny1AD"},{"type":"output","id":"GDi96wVZfPPANXbcHrSMU","data":[{"output_type":"execute_result","execution_count":39,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"e136b0325222256daaf0f139ef9a3b59","path":"/fnc/build/e136b0325222256daaf0f139ef9a3b59.png"}}},{"output_type":"stream","name":"stderr","text":"Cannot create file figures/boundaries-bs.mp4. Permission Denied."}],"visibility":"show","key":"taIqcQJbPu"}],"data":{"tags":[]},"visibility":"show","key":"Xkm2BQPQJ1"},{"type":"image","url":"/fnc/build/boundaries-bs-fff33c718b92a15b2474fc91988fef32.mp4","alt":"Black–Scholes equation with boundaries","position":{"start":{"line":632,"column":1},"end":{"line":632,"column":1}},"key":"XcQ50AWBUu","urlSource":"figures/boundaries-bs.mp4"},{"type":"paragraph","position":{"start":{"line":634,"column":1},"end":{"line":634,"column":1}},"children":[{"type":"text","value":"Recall that ","position":{"start":{"line":634,"column":1},"end":{"line":634,"column":1}},"key":"xDIvhkBneP"},{"type":"inlineMath","value":"u","position":{"start":{"line":634,"column":1},"end":{"line":634,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span>","key":"ipK7PH9RUd"},{"type":"text","value":" is the value of the call option, and time runs backward from the strike time. The longer the horizon, the more value the option has due to anticipated growth in the stock price.","position":{"start":{"line":634,"column":1},"end":{"line":634,"column":1}},"key":"HEQEPjpcrW"}],"key":"YoskEmZU7l"}],"label":"demo-boundaries-bs-matlab","identifier":"demo-boundaries-bs-matlab","html_id":"demo-boundaries-bs-matlab","key":"i4Rmd8jhT3"}],"key":"oWBjRFH3fT"}],"key":"GrdwQkpMci"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Chapter 10","url":"/chapter10-1","group":"MATLAB codes"},"next":{"title":"Chapter 12","url":"/chapter12-1","group":"MATLAB codes"}}},"domain":"http://localhost:3000"}