{"version":2,"kind":"Article","sha256":"627a77aafdbf3ca0d76cc07af9ddbe70625fce3fbb47a59c6f2ef7cfb5f34c3f","slug":"structure-1","location":"/chapter8/structure.md","dependencies":[{"url":"/chapter8","label":"demo-structure-sparse-julia","kind":"Notebook","slug":"chapter8","location":"/julia/chapter8.md","title":"Chapter 8"},{"url":"/chapter8-1","label":"demo-structure-sparse-matlab","kind":"Notebook","slug":"chapter8-1","location":"/matlab/chapter8.md","title":"Chapter 8"},{"url":"/chapter8-2","label":"demo-structure-sparse-python","kind":"Notebook","slug":"chapter8-2","location":"/python/chapter8.md","title":"Chapter 8"}],"frontmatter":{"title":"Sparsity and structure","numbering":{"heading_1":{"enabled":true},"heading_2":{"enabled":true},"heading_3":{"enabled":false},"enumerator":{"enumerator":"8.1.%s"},"title":{"offset":1}},"content_includes_title":false,"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","TPBVP":"two-point boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"edit_url":"https://github.com/fncbook/fnc/blob/master/chapter8/structure.md","exports":[{"format":"md","filename":"structure.md","url":"/build/structure-8e36be4b8e40f072f720e141b103cd30.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"Very large matrices cannot be stored all within primary memory of a computer unless they are ","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"b5dc1Ov40I"},{"type":"strong","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"sparse","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"eWsYOin0Za"}],"key":"lX3s0x7I7o"},{"type":"text","value":". A sparse matrix has ","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"w9ttT59SUV"},{"type":"emphasis","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"structural zeros","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"LvLFOLqnld"}],"key":"fDWY2wobUf"},{"type":"text","value":", meaning entries that are known to be exactly zero. For instance, the adjacency matrix of a graph has zeros where there are no links in the graph. To store and operate with a sparse matrix efficiently, it is not represented as an array of all of its values. There is a variety of sparse formats available; for the most part, you can imagine that the matrix is stored as triples ","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"XjIF06xXnc"},{"type":"inlineMath","value":"(i,j,A_{ij})","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>i</mi><mo separator=\"true\">,</mo><mi>j</mi><mo separator=\"true\">,</mo><msub><mi>A</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(i,j,A_{ij})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0361em;vertical-align:-0.2861em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">i</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">ij</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"r4bE4dkMxa"},{"type":"text","value":" for all the nonzero ","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"wFBV22PbYw"},{"type":"inlineMath","value":"(i,j)","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>i</mi><mo separator=\"true\">,</mo><mi>j</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(i,j)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">i</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span><span class=\"mclose\">)</span></span></span></span>","key":"Q4RRgs9shW"},{"type":"text","value":" locations.","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"WBJi2IMI3i"}],"indexEntries":[{"entry":"sparse matrix","emphasis":true}],"label":"index-vJjYpcZadI","identifier":"index-vjjypczadi","html_id":"index-vjjypczadi","key":"xvDmaORGVJ"},{"type":"heading","depth":2,"position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"Computing with sparse matrices","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"Tv7Eo81W6l"}],"identifier":"computing-with-sparse-matrices","label":"Computing with sparse matrices","html_id":"computing-with-sparse-matrices","implicit":true,"enumerator":"8.1.1","key":"vhfpRrSWZD"},{"type":"paragraph","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"Most graphs with real applications have many fewer edges than the maximum possible ","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"lEMTTELdBn"},{"type":"inlineMath","value":"n^2","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>n</mi><mn>2</mn></msup></mrow><annotation encoding=\"application/x-tex\">n^2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">n</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span>","key":"l47zRX0Ezm"},{"type":"text","value":" for ","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"DP8QrxsIR4"},{"type":"inlineMath","value":"n","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"W2KcEc3fie"},{"type":"text","value":" nodes. Accordingly, their adjacency matrices have mostly zero elements and should be represented sparsely.","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"uDf84NlkvT"}],"indexEntries":[{"entry":"adjacency matrix","emphasis":false}],"label":"index-wy1wKB9nPJ","identifier":"index-wy1wkb9npj","html_id":"index-wy1wkb9npj","key":"WeTAHf8NnV"},{"type":"proof","kind":"example","enumerated":true,"children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Sparsity","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"saGqIw7Fjc"}],"key":"wv2NGjtZRn"},{"type":"tabSet","children":[{"type":"tabItem","title":"Julia","sync":"julia","children":[{"type":"embed","source":{"url":"/chapter8","label":"demo-structure-sparse-julia","kind":"Notebook","slug":"chapter8","location":"/julia/chapter8.md","title":"Chapter 8"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-structure-sparse","label":"demo-structure-sparse","kind":"proof:example","position":{"start":{"line":71,"column":1},"end":{"line":71,"column":23}},"children":[{"type":"text","value":"Example ","key":"v4Zl8xaWXi"},{"type":"text","value":"8.1.1","key":"WwO4o1OP6I"}],"template":"Example %s","enumerator":"8.1.1","resolved":true,"html_id":"demo-structure-sparse","remote":true,"url":"/structure-1","dataUrl":"/structure-1.json","key":"rpQWQsZ3mh"}],"key":"zmJYyl9W5g"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"rNPL7XJT4y"}],"key":"zVwQiNTQSN"},{"type":"paragraph","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"children":[{"type":"text","value":"Julia functions to deal with sparse matrices are found in the ","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"key":"ugweFyUftT"},{"type":"inlineCode","value":"SparseArrays","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"key":"Yx0bNUNA0L"},{"type":"text","value":" package in the standard library.","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"key":"iSOOx49ttR"}],"key":"wrErXdrtOB"}],"key":"CYWVptKrQ3"},{"type":"paragraph","position":{"start":{"line":78,"column":1},"end":{"line":78,"column":1}},"children":[{"type":"text","value":"Here we load the adjacency matrix of a graph with 2790 nodes. Each node is a web page referring to Roswell, NM, and the edges represent links between web pages. (Credit goes to Panayiotis Tsaparas and the University of Toronto for making this data public.)","position":{"start":{"line":78,"column":1},"end":{"line":78,"column":1}},"key":"wC8K5GVU4d"}],"key":"mLmJtuWikX"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"using SparseArrays, JLD2\n@load \"roswell.jld2\" A;      # file is on the book's website","key":"VI0E2U3gCf"},{"type":"output","id":"bHGxOQnAEvzb--F0s6Gez","data":[],"key":"NbZsx7KvzC"}],"key":"ZYogzWoUSl"},{"type":"paragraph","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"children":[{"type":"text","value":"We may define the density of ","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"nJvtmAhjh2"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"TqAglwujPx"},{"type":"text","value":" as the number of nonzeros divided by the total number of entries.","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"aAYCtXgL8L"}],"indexEntries":[{"entry":"Julia","subEntry":{"value":"nnz","kind":"entry"},"emphasis":true}],"key":"mmxxk5cGA9"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"WNdtxsKeDu"}],"key":"NvayakB4EK"},{"type":"paragraph","position":{"start":{"line":90,"column":1},"end":{"line":90,"column":1}},"children":[{"type":"text","value":"Use ","position":{"start":{"line":90,"column":1},"end":{"line":90,"column":1}},"key":"qjeXMZlkVK"},{"type":"inlineCode","value":"nnz","position":{"start":{"line":90,"column":1},"end":{"line":90,"column":1}},"key":"D4C3pSpMJp"},{"type":"text","value":" to count the number of nonzeros in a sparse matrix.","position":{"start":{"line":90,"column":1},"end":{"line":90,"column":1}},"key":"zguqJfjTkh"}],"key":"qz3vOi3fkD"}],"class":"dropdown","key":"plUiJttrIf"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"m, n = size(A)\n@show density = nnz(A) / (m * n);","key":"HIJjFQ79Bq"},{"type":"output","id":"wHpM-gyOYKYcVQToepQXX","data":[{"output_type":"stream","name":"stdout","text":"density = nnz(A) / (m * n) = 0.0010902994565845762"},{"output_type":"stream","name":"stdout","text":"\n"}],"key":"wOcGIZo19J"}],"key":"fCvde3R5OI"},{"type":"paragraph","position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"children":[{"type":"text","value":"The computer memory consumed by any variable can be discovered using ","position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"key":"QF0hxxGdUx"},{"type":"inlineCode","value":"summarysize","position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"key":"HKDcZQcXhe"},{"type":"text","value":". We can use it to compare the space needed for the sparse representation to its dense counterpart, that is, the space needed to store all the elements, whether zero or not.","position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"key":"sX7e9p4XRg"}],"indexEntries":[{"entry":"Julia","subEntry":{"value":"summarysize","kind":"entry"},"emphasis":true}],"key":"UWuhIfqfaD"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"F = Matrix(A)\nBase.summarysize(F) / Base.summarysize(A)","key":"zyyjwC02CU"},{"type":"output","id":"olGxgVvNZz8kOneqwUPJi","data":[{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"text/plain":{"content":"550.2690513219285","content_type":"text/plain"}}}],"key":"DwYyrR9Uv3"}],"key":"dvY2FPsW5n"},{"type":"paragraph","position":{"start":{"line":108,"column":1},"end":{"line":108,"column":1}},"children":[{"type":"text","value":"As you can see, the storage savings are dramatic. Matrix-vector products are also much faster using the sparse form because operations with structural zeros are skipped.","position":{"start":{"line":108,"column":1},"end":{"line":108,"column":1}},"key":"yR15Vjus1E"}],"key":"CEcmQI4L7f"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"x = randn(n)\nA * x;   # make sure * is loaded and compiled\n@elapsed for i in 1:300\n    A * x\nend","key":"QChYoKgePz"},{"type":"output","id":"XcP6rDJhfdGYfGNIA0vr5","data":[{"output_type":"execute_result","execution_count":5,"metadata":{},"data":{"text/plain":{"content":"0.002516875","content_type":"text/plain"}}}],"key":"eqJ3ozRaIS"}],"key":"TWcrOBKMKb"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"F * x;\n@elapsed for i in 1:300\n    F * x\nend","key":"BnZNgW08w8"},{"type":"output","id":"7YUMsRHyFapPrl0yQF8kL","data":[{"output_type":"execute_result","execution_count":6,"metadata":{},"data":{"text/plain":{"content":"10.005612416","content_type":"text/plain"}}}],"key":"OIorOvDBlx"}],"key":"wFz2IyIcUE"}],"key":"QUAAciQiXP"}],"key":"XkdA9VX2zi"}],"key":"CA5x3Ciuy1"},{"type":"tabItem","title":"MATLAB","sync":"matlab","children":[{"type":"embed","source":{"url":"/chapter8-1","label":"demo-structure-sparse-matlab","kind":"Notebook","slug":"chapter8-1","location":"/matlab/chapter8.md","title":"Chapter 8"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-structure-sparse","label":"demo-structure-sparse","kind":"proof:example","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":23}},"children":[{"type":"text","value":"Example ","key":"EP71npRrtS"},{"type":"text","value":"8.1.1","key":"lFWyusnuRd"}],"template":"Example %s","enumerator":"8.1.1","resolved":true,"html_id":"demo-structure-sparse","remote":true,"url":"/structure-1","dataUrl":"/structure-1.json","key":"SXY7Qj3Eck"}],"key":"tEBbZ6X72q"},{"type":"paragraph","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"children":[{"type":"text","value":"Here we load the adjacency matrix of a graph with 2790 nodes. Each node is a web page referring to Roswell, NM, and the edges represent links between web pages. (Credit goes to Panayiotis Tsaparas and the University of Toronto for making this data public.)","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"key":"UOf3Pevb7F"}],"key":"ZXTvBCc2IE"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"load roswelladj\na = whos('A')","key":"EQ4KYYlKtg"},{"type":"output","id":"r_Kc4OIO2ww-7d9R3sKfJ","data":[{"output_type":"execute_result","execution_count":2,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>a = struct with fields:\n          name: 'A'\n          size: [2790 2790]\n         bytes: 158120\n         class: 'double'\n        global: 0\n        sparse: 1\n       complex: 0\n       nesting: [1x1 struct]\n    persistent: 0\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"a = struct with fields:\n          name: 'A'\n          size: [2790 2790]\n         bytes: 158120\n         class: 'double'\n        global: 0\n        sparse: 1\n       complex: 0\n       nesting: [1x1 struct]\n    persistent: 0\n","content_type":"text/plain"}}}],"key":"AUrXG6VhW6"}],"key":"CzehUWvEPG"},{"type":"paragraph","position":{"start":{"line":71,"column":1},"end":{"line":71,"column":1}},"children":[{"type":"text","value":"We may define the density of ","position":{"start":{"line":71,"column":1},"end":{"line":71,"column":1}},"key":"SckVbkjEly"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":71,"column":1},"end":{"line":71,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"a4361biw2w"},{"type":"text","value":" as the number of nonzeros divided by the total number of entries.","position":{"start":{"line":71,"column":1},"end":{"line":71,"column":1}},"key":"lHseaXK3tE"}],"indexEntries":[{"entry":"MATLAB","subEntry":{"value":"nnz","kind":"entry"},"emphasis":true}],"key":"tY6BDQtLkC"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"Tdy8ErR0dp"}],"key":"NlpOD5Ij1Y"},{"type":"paragraph","position":{"start":{"line":74,"column":1},"end":{"line":74,"column":1}},"children":[{"type":"text","value":"Use ","position":{"start":{"line":74,"column":1},"end":{"line":74,"column":1}},"key":"lm5j1j41Ga"},{"type":"inlineCode","value":"nnz","position":{"start":{"line":74,"column":1},"end":{"line":74,"column":1}},"key":"MkaRgJjiEZ"},{"type":"text","value":" to count the number of nonzeros in a sparse matrix.","position":{"start":{"line":74,"column":1},"end":{"line":74,"column":1}},"key":"IS8yLIQG1T"}],"key":"RUELfFUTby"}],"class":"dropdown","key":"xv1mgM36tG"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"sz = size(A);  n = sz(1);\ndensity = nnz(A) / prod(sz)","key":"onRpEH3msM"},{"type":"output","id":"fwIpzQDe5MUcfTi0jud2D","data":[{"output_type":"execute_result","execution_count":3,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>density = 0.0011</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"density = 0.0011","content_type":"text/plain"}}}],"key":"XLHGOe3mV2"}],"key":"cj77FnzoLg"},{"type":"paragraph","position":{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},"children":[{"type":"text","value":"The computer memory consumed by any variable can be discovered using ","position":{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},"key":"djpiiCtPzS"},{"type":"inlineCode","value":"whos","position":{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},"key":"DJ0552wTP6"},{"type":"text","value":". We can use it to compare the space needed for the sparse representation to its dense counterpart, that is, the space needed to store all the elements, whether zero or not.","position":{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},"key":"sNXCpFHsQ3"}],"key":"ISWUGuUKOi"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"F = full(A);\nf = whos('F');\nstorage_ratio = f.bytes / a.bytes","key":"NmNTElfnHg"},{"type":"output","id":"E1Vpww0je5yRdD9lxvbsi","data":[{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>storage_ratio = 393.8325</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"storage_ratio = 393.8325","content_type":"text/plain"}}}],"key":"r0fZdCEdkn"}],"key":"ENMOBQr73T"},{"type":"paragraph","position":{"start":{"line":90,"column":1},"end":{"line":90,"column":1}},"children":[{"type":"text","value":"Matrix-vector products are also much faster using the sparse form because operations with structural zeros are skipped.","position":{"start":{"line":90,"column":1},"end":{"line":90,"column":1}},"key":"HblO9Kja2B"}],"key":"L2NTMFXy2u"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"x = randn(n,1);\ntic, for i = 1:200, A*x; end\nsparse_time = toc","key":"ey4vKmkLMD"},{"type":"output","id":"A_rnEjEw8XuDWxJ-q_4rX","data":[{"output_type":"execute_result","execution_count":5,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>sparse_time = 0.0091</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"sparse_time = 0.0091","content_type":"text/plain"}}}],"key":"eLoI4cuxnk"}],"key":"novkQsDlV2"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"tic, for i = 1:200, F*x; end\ndense_time = toc","key":"sLnWH7OOQu"},{"type":"output","id":"71sjY1OdESmFJpfepXjGC","data":[{"output_type":"execute_result","execution_count":6,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>dense_time = 1.0572</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"dense_time = 1.0572","content_type":"text/plain"}}}],"key":"a9xrDM51Hl"}],"key":"BhuGxy1mK2"},{"type":"paragraph","position":{"start":{"line":103,"column":1},"end":{"line":103,"column":1}},"children":[{"type":"text","value":"However, the sparse storage format in MATLAB is column-oriented.  Operations on rows may take a lot longer than similar ones on columns.","position":{"start":{"line":103,"column":1},"end":{"line":103,"column":1}},"key":"ySsmDf8ByV"}],"key":"MhRyLDppgD"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"v = A(:, 1000);\ntic, for i = 1:n, A(:, i) = v; end\ncolumn_time = toc\nr = v';\ntic, for i = 1:n, A(i, :) = r; end\nrow_time = toc","key":"w6MtAz0Wtm"},{"type":"output","id":"7leiUe4HV8PVffFCTaEI6","data":[{"output_type":"execute_result","execution_count":7,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>column_time = 0.0087</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"column_time = 0.0087","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":7,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>row_time = 0.0397</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"row_time = 0.0397","content_type":"text/plain"}}}],"key":"tCEp88rXa2"}],"key":"LLra7iJGky"}],"key":"dMot87Zf5J"}],"key":"FHfvMqAbvF"}],"key":"Sb5a3gxFNo"},{"type":"tabItem","title":"Python","sync":"python","children":[{"type":"embed","source":{"url":"/chapter8-2","label":"demo-structure-sparse-python","kind":"Notebook","slug":"chapter8-2","location":"/python/chapter8.md","title":"Chapter 8"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-structure-sparse","label":"demo-structure-sparse","kind":"proof:example","position":{"start":{"line":71,"column":1},"end":{"line":71,"column":23}},"children":[{"type":"text","value":"Example ","key":"OTrkBnjbEa"},{"type":"text","value":"8.1.1","key":"mcJH9DO0IG"}],"template":"Example %s","enumerator":"8.1.1","resolved":true,"html_id":"demo-structure-sparse","remote":true,"url":"/structure-1","dataUrl":"/structure-1.json","key":"MQN8BZIk89"}],"key":"CseucaBLhr"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"f7jFY1gKL4"}],"key":"aIALZQjJWw"},{"type":"paragraph","position":{"start":{"line":74,"column":1},"end":{"line":74,"column":1}},"children":[{"type":"text","value":"Functions to work with sparse matrices are found in the ","position":{"start":{"line":74,"column":1},"end":{"line":74,"column":1}},"key":"O7kHoECW0L"},{"type":"inlineCode","value":"scipy.sparse","position":{"start":{"line":74,"column":1},"end":{"line":74,"column":1}},"key":"SRVuDG6oGv"},{"type":"text","value":" module.","position":{"start":{"line":74,"column":1},"end":{"line":74,"column":1}},"key":"SSKtkBdR9D"}],"key":"WKB8kibC3y"}],"key":"JsuvkraNiQ"},{"type":"paragraph","position":{"start":{"line":77,"column":1},"end":{"line":77,"column":1}},"children":[{"type":"text","value":"Here we load the adjacency matrix of a graph with 2790 nodes. Each node is a web page referring to Roswell, NM, and the edges represent links between web pages. (Credit goes to Panayiotis Tsaparas and the University of Toronto for making this data public.)","position":{"start":{"line":77,"column":1},"end":{"line":77,"column":1}},"key":"T8YkG2Bho3"}],"key":"t4JFxuEEUT"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import scipy.sparse as sp\nfrom scipy.io import loadmat\n\nvars = loadmat(\"roswelladj.mat\")    # get from the book's website\nA = sp.csr_matrix(vars[\"A\"])","key":"UpYE37FbM5"},{"type":"output","id":"W8NclhZGi22JiVmDjbnin","data":[],"key":"QcEmw7GDrx"}],"key":"Ew9en2tvsb"},{"type":"paragraph","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"children":[{"type":"text","value":"We may define the density of ","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"HYEiCHSDX8"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"pyTwNFgure"},{"type":"text","value":" as the number of nonzeros divided by the total number of entries.","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"PIwEtDMdds"}],"key":"NgM3c0GFEL"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"m, n = A.shape\nprint(f\"density is {A.nnz / (m * n):.3%}\")","key":"f6WkRzsb2J"},{"type":"output","id":"DZb_uQ2hJqJ3blozfPNJ3","data":[{"output_type":"stream","name":"stdout","text":"density is 0.109%\n"}],"key":"IP9kd5qin5"}],"indexEntries":[{"entry":"Python","subEntry":{"value":"nnz","kind":"entry"},"emphasis":true}],"key":"boVgm4uAIR"},{"type":"paragraph","position":{"start":{"line":97,"column":1},"end":{"line":97,"column":1}},"children":[{"type":"text","value":"We can compare the storage space needed for the sparse ","position":{"start":{"line":97,"column":1},"end":{"line":97,"column":1}},"key":"zNF6dBk9FP"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":97,"column":1},"end":{"line":97,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"AnfNHR1vm3"},{"type":"text","value":" with the space needed for its dense / full counterpart.","position":{"start":{"line":97,"column":1},"end":{"line":97,"column":1}},"key":"Co7TIcx2Y3"}],"key":"A4gcTxAqIu"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"F = A.todense()\nprint(f\"{A.data.nbytes/1e6:.3f} MB for sparse form, {F.nbytes/1e6:.3f} MB for dense form\")","key":"v6UOOfZ7Hy"},{"type":"output","id":"kXSZFD-_6RbhYw7Be60_G","data":[{"output_type":"stream","name":"stdout","text":"0.068 MB for sparse form, 62.273 MB for dense form\n"}],"key":"AAGSXl4vCU"}],"key":"YC5fpN1CwA"},{"type":"paragraph","position":{"start":{"line":105,"column":1},"end":{"line":105,"column":1}},"children":[{"type":"text","value":"Matrix-vector products are also much faster using the sparse form because operations with structural zeros are skipped.","position":{"start":{"line":105,"column":1},"end":{"line":105,"column":1}},"key":"HLTmaaxV3k"}],"key":"XY5PS7QFn5"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from timeit import default_timer as timer\nx = random.randn(n)\nstart = timer()\nfor i in range(1000):\n    A @ x\nprint(f\"sparse time: {timer() - start:.4g} sec\")","key":"kwAtxp0GMf"},{"type":"output","id":"-jsuEaTV9H2uy1eNRNW42","data":[{"output_type":"stream","name":"stdout","text":"sparse time: 0.00848 sec\n"}],"key":"yTv90Y8QCN"}],"key":"cI3c41mHEn"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"start = timer()\nfor i in range(1000):\n    F @ x\nprint(f\"dense time: {timer() - start:.4g} sec\")","key":"OIvEpdAXdW"},{"type":"output","id":"tPE-emONk5_0lrolwYOXc","data":[{"output_type":"stream","name":"stdout","text":"dense time: 0.3422 sec\n"}],"key":"Dw1hAlXKmO"}],"key":"RQXdquYUvA"}],"key":"WRsWGQjpBL"}],"key":"ji0lKXShAe"}],"key":"eubWY6KQim"}],"key":"GMnNc4Vk1l"}],"label":"demo-structure-sparse","identifier":"demo-structure-sparse","enumerator":"8.1.1","html_id":"demo-structure-sparse","key":"t0FkhP6OTB"},{"type":"paragraph","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"children":[{"type":"text","value":"Arithmetic operations such as ","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"key":"oh5UQB3DgT"},{"type":"inlineCode","value":"+","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"key":"RI8EfQeJn2"},{"type":"text","value":", ","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"key":"KW6ijNiig4"},{"type":"inlineCode","value":"-","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"key":"WntKiSf6h8"},{"type":"text","value":", ","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"key":"LOtzDwZUYo"},{"type":"inlineCode","value":"*","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"key":"mNELNus07E"},{"type":"text","value":", and ","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"key":"glUtSjf8xF"},{"type":"inlineCode","value":"^","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"key":"PptduAT4KD"},{"type":"text","value":" respect and exploit sparsity if the matrix operands are sparse. However, matrix operations may substantially decrease the amount of sparsity, a phenomenon known as ","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"key":"zh48B2uO4U"},{"type":"strong","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"children":[{"type":"text","value":"fill-in","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"key":"U3ivzTOdTY"}],"key":"pDtIHvK4oG"},{"type":"text","value":".","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"key":"OaNt2mBpzW"}],"indexEntries":[{"entry":"fill-in of sparse matrices","emphasis":false}],"label":"index-WmmwwFn9wq","identifier":"index-wmmwwfn9wq","html_id":"index-wmmwwfn9wq","key":"IeErXLfFn5"},{"type":"proof","kind":"example","enumerated":true,"children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Fill-in of a sparse matrix","position":{"start":{"line":51,"column":1},"end":{"line":51,"column":1}},"key":"HPmcPxl3L2"}],"key":"LddjQfoJRv"},{"type":"tabSet","children":[{"type":"tabItem","title":"Julia","sync":"julia","children":[{"type":"embed","source":{"url":"/chapter8","label":"demo-structure-fill-julia","kind":"Notebook","slug":"chapter8","location":"/julia/chapter8.md","title":"Chapter 8"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-structure-fill","label":"demo-structure-fill","kind":"proof:example","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":21}},"children":[{"type":"text","value":"Example ","key":"tnoZObuTNx"},{"type":"text","value":"8.1.2","key":"Pfbj5Jp4ZD"}],"template":"Example %s","enumerator":"8.1.2","resolved":true,"html_id":"demo-structure-fill","remote":true,"url":"/structure-1","dataUrl":"/structure-1.json","key":"tVMoLoUmhw"}],"key":"rPEEJGtPAz"},{"type":"paragraph","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"children":[{"type":"text","value":"Here is the adjacency matrix of a graph representing a small-world network, featuring connections to neighbors and a small number of distant contacts.","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"key":"G6Et4LpTy3"}],"indexEntries":[{"entry":"Julia","subEntry":{"value":"sprandsym","kind":"entry"},"emphasis":true}],"key":"ixQxnEzkNQ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"using GraphRecipes\n@load \"smallworld.jld2\" A\ngraphplot(A, linealpha=0.5)","key":"tWdEKO9zGN"},{"type":"output","id":"pCy4GhlyY15gMxHLz87av","data":[{"output_type":"execute_result","execution_count":7,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"e82690ef2bd56e05a63ed95ec259b9b4","path":"/build/e82690ef2bd56e05a63ed95ec259b9b4.png"},"text/html":{"content_type":"text/html","hash":"5c1904f224055e3f0b9e506b0b4cbf0e","path":"/build/5c1904f224055e3f0b9e506b0b4cbf0e.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"4d5b930e3c28e0da023b3194dfb218e2","path":"/build/4d5b930e3c28e0da023b3194dfb218e2.svg"}}}],"key":"UeaC8hD454"}],"key":"sIXveyhBji"},{"type":"paragraph","position":{"start":{"line":140,"column":1},"end":{"line":140,"column":1}},"children":[{"type":"text","value":"Because each node connects to relatively few others, the adjacency matrix is quite sparse.","position":{"start":{"line":140,"column":1},"end":{"line":140,"column":1}},"key":"nPUcFBDezs"}],"key":"dfQF0MVbGg"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"spy(A, title=\"Nonzero locations\", m=2, color=:blues)","key":"kcOFoL50zf"},{"type":"output","id":"zigazKNHFp_NenZQ6VZeu","data":[{"output_type":"execute_result","execution_count":8,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"6e5e16bb1dbb6a69591864d136ee14c7","path":"/build/6e5e16bb1dbb6a69591864d136ee14c7.png"},"text/html":{"content_type":"text/html","hash":"937a9b79c5a63fef796d8e528152d50b","path":"/build/937a9b79c5a63fef796d8e528152d50b.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"520e4213fa076506648d0697a94a939a","path":"/build/520e4213fa076506648d0697a94a939a.svg"}}}],"key":"SoggHiid5Q"}],"key":"bESqcySGso"},{"type":"paragraph","position":{"start":{"line":146,"column":1},"end":{"line":146,"column":1}},"children":[{"type":"text","value":"By ","position":{"start":{"line":146,"column":1},"end":{"line":146,"column":1}},"key":"QVMTKR9VaS"},{"type":"crossReference","kind":"proof:theorem","identifier":"theorem-insight-adjmat","label":"theorem-insight-adjmat","children":[{"type":"text","value":"Theorem ","key":"LHOh1bvyEh"},{"type":"text","value":"7.1.1","key":"syjEx7lxAA"}],"template":"Theorem %s","enumerator":"7.1.1","resolved":true,"html_id":"theorem-insight-adjmat","remote":true,"url":"/insight","dataUrl":"/insight.json","key":"NUleIoA67A"},{"type":"text","value":", the entries of ","position":{"start":{"line":146,"column":1},"end":{"line":146,"column":1}},"key":"Z7taSvkntX"},{"type":"inlineMath","value":"\\mathbf{A}^k","position":{"start":{"line":146,"column":1},"end":{"line":146,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi mathvariant=\"bold\">A</mi><mi>k</mi></msup></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}^k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8491em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">A</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span></span></span></span></span></span></span></span>","key":"DhufGufzZX"},{"type":"text","value":" give the number of walks of length ","position":{"start":{"line":146,"column":1},"end":{"line":146,"column":1}},"key":"lmkkiBuRCI"},{"type":"inlineMath","value":"k","position":{"start":{"line":146,"column":1},"end":{"line":146,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span>","key":"SpPbjRhQjz"},{"type":"text","value":" between pairs of nodes, as with “","position":{"start":{"line":146,"column":1},"end":{"line":146,"column":1}},"key":"nMDfPyYVam"},{"type":"emphasis","position":{"start":{"line":146,"column":1},"end":{"line":146,"column":1}},"children":[{"type":"text","value":"k","position":{"start":{"line":146,"column":1},"end":{"line":146,"column":1}},"key":"AX22VZNPXB"}],"key":"FRiLCmpZ10"},{"type":"text","value":" degrees of separation” within a social network. As ","position":{"start":{"line":146,"column":1},"end":{"line":146,"column":1}},"key":"X6qfnD7NHl"},{"type":"inlineMath","value":"k","position":{"start":{"line":146,"column":1},"end":{"line":146,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span>","key":"RoNMTREbyl"},{"type":"text","value":" grows, the density of ","position":{"start":{"line":146,"column":1},"end":{"line":146,"column":1}},"key":"ZLLBavs70I"},{"type":"inlineMath","value":"\\mathbf{A}^k","position":{"start":{"line":146,"column":1},"end":{"line":146,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi mathvariant=\"bold\">A</mi><mi>k</mi></msup></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}^k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8491em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">A</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span></span></span></span></span></span></span></span>","key":"gPfyeGMK5q"},{"type":"text","value":" also grows.","position":{"start":{"line":146,"column":1},"end":{"line":146,"column":1}},"key":"aeQn8J32gk"}],"key":"PhSeoMxsMN"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"plt = plot(layout=(1, 3), legend=:none, size=(600, 240))\nfor k in 2:4\n    spy!(A^k;\n        subplot=k - 1, color=:blues,\n        title=latexstring(\"\\\\mathbf{A}^$k\"))\nend\nplt","key":"dGfd7YkmhK"},{"type":"output","id":"fLp3eNDaUcTD2tN79QC2P","data":[{"output_type":"execute_result","execution_count":9,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"a8b0b253ce078e6d9a2c1c4671194b97","path":"/build/a8b0b253ce078e6d9a2c1c4671194b97.png"},"text/html":{"content_type":"text/html","hash":"2acf634d6af4cd2b1fb5ba26dd85c958","path":"/build/2acf634d6af4cd2b1fb5ba26dd85c958.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"4a5919b3a517694336c5da93da61eb39","path":"/build/4a5919b3a517694336c5da93da61eb39.svg"}}}],"key":"D1XQPkjKwF"}],"key":"GuqeXNej3O"}],"key":"zUDjcL0oUl"}],"key":"FDz4qhLaMc"}],"key":"GcQcM8D4QO"},{"type":"tabItem","title":"MATLAB","sync":"matlab","children":[{"type":"embed","source":{"url":"/chapter8-1","label":"demo-structure-fill-matlab","kind":"Notebook","slug":"chapter8-1","location":"/matlab/chapter8.md","title":"Chapter 8"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-structure-fill","label":"demo-structure-fill","kind":"proof:example","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":21}},"children":[{"type":"text","value":"Example ","key":"g8fbOMc5Ah"},{"type":"text","value":"8.1.2","key":"QlNbabtg0A"}],"template":"Example %s","enumerator":"8.1.2","resolved":true,"html_id":"demo-structure-fill","remote":true,"url":"/structure-1","dataUrl":"/structure-1.json","key":"nbqFtmCDZ1"}],"key":"gUlgdPjF2P"},{"type":"paragraph","position":{"start":{"line":118,"column":1},"end":{"line":118,"column":1}},"children":[{"type":"text","value":"Here is the adjacency matrix of a graph representing a small-world network, featuring connections to neighbors and a small number of distant contacts.","position":{"start":{"line":118,"column":1},"end":{"line":118,"column":1}},"key":"lgIXa9Ywk3"}],"key":"HZhtOHGWt5"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"load smallworld.mat\nG = graph(A);\nplot(G, nodecolor='r')","key":"oh0xbGjXIz"},{"type":"output","id":"1GGjIML9hYG5dFvc-Xx9b","data":[{"output_type":"execute_result","execution_count":8,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"06af98731e22bd72738a31fa9b9f57c6","path":"/build/06af98731e22bd72738a31fa9b9f57c6.png"}}}],"key":"GhQoKk4AsH"}],"key":"U7UzbM9BXd"},{"type":"paragraph","position":{"start":{"line":126,"column":1},"end":{"line":126,"column":1}},"children":[{"type":"text","value":"Because each node connects to relatively few others, the adjacency matrix is quite sparse.","position":{"start":{"line":126,"column":1},"end":{"line":126,"column":1}},"key":"FZyiEtBdZ7"}],"key":"eCbqC1OJou"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"spy(A)","key":"lGzHRWM4GZ"},{"type":"output","id":"RjbhqpdD4xkoKSTETLtbM","data":[{"output_type":"execute_result","execution_count":9,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"25ec60b062d19d0276512988c3a60d34","path":"/build/25ec60b062d19d0276512988c3a60d34.png"}}}],"key":"Lbmyyibw0L"}],"key":"c4402kBj1m"},{"type":"paragraph","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"children":[{"type":"text","value":"By ","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"key":"q5u6ieWyTJ"},{"type":"crossReference","kind":"proof:theorem","identifier":"theorem-insight-adjmat","label":"theorem-insight-adjmat","children":[{"type":"text","value":"Theorem ","key":"fJyB9cribj"},{"type":"text","value":"7.1.1","key":"K9Tb0qBwW6"}],"template":"Theorem %s","enumerator":"7.1.1","resolved":true,"html_id":"theorem-insight-adjmat","remote":true,"url":"/insight","dataUrl":"/insight.json","key":"gPjyx7wlXk"},{"type":"text","value":", the entries of ","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"key":"f0ZEw2Pcww"},{"type":"inlineMath","value":"\\mathbf{A}^k","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi mathvariant=\"bold\">A</mi><mi>k</mi></msup></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}^k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8491em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">A</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span></span></span></span></span></span></span></span>","key":"bT7JkwXoNk"},{"type":"text","value":" give the number of walks of length ","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"key":"II6M6BMZxE"},{"type":"inlineMath","value":"k","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span>","key":"JrVXlt550F"},{"type":"text","value":" between pairs of nodes, as with “","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"key":"tDXmR7YbiU"},{"type":"emphasis","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"children":[{"type":"text","value":"k","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"key":"m54CZvN9jj"}],"key":"O8W3UaONVb"},{"type":"text","value":" degrees of separation” within a social network. As ","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"key":"hVOkKY8M6X"},{"type":"inlineMath","value":"k","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span>","key":"ia1KZK0P1p"},{"type":"text","value":" grows, the density of ","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"key":"Ef22PFkzyi"},{"type":"inlineMath","value":"\\mathbf{A}^k","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi mathvariant=\"bold\">A</mi><mi>k</mi></msup></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}^k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8491em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">A</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span></span></span></span></span></span></span></span>","key":"Mz4uRfS1ot"},{"type":"text","value":" also grows.","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"key":"kuCAJUsFD5"}],"key":"PwkRmHr4yy"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf\ntiledlayout(2, 2)\nfor k = [2, 3, 4, 6]\n    nexttile\n    spy(A^k)\n    title(sprintf(\"A^{%d}\", k))\nend","key":"KM0N1a7Eef"},{"type":"output","id":"hTxf6TedV6zys8K5-WKIz","data":[{"output_type":"execute_result","execution_count":10,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"a228f8840ec9b338cf3ba9088c0c7884","path":"/build/a228f8840ec9b338cf3ba9088c0c7884.png"}}}],"key":"LdkOCR51wD"}],"key":"z1aX9sdxDA"}],"key":"Sdmt9glzOb"}],"key":"SAe29ciwMe"}],"key":"PMMd7EOX8j"},{"type":"tabItem","title":"Python","sync":"python","children":[{"type":"embed","source":{"url":"/chapter8-2","label":"demo-structure-fill-python","kind":"Notebook","slug":"chapter8-2","location":"/python/chapter8.md","title":"Chapter 8"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-structure-fill","label":"demo-structure-fill","kind":"proof:example","position":{"start":{"line":125,"column":1},"end":{"line":125,"column":21}},"children":[{"type":"text","value":"Example ","key":"gwcxu9OGEO"},{"type":"text","value":"8.1.2","key":"CzFMBd070x"}],"template":"Example %s","enumerator":"8.1.2","resolved":true,"html_id":"demo-structure-fill","remote":true,"url":"/structure-1","dataUrl":"/structure-1.json","key":"cWcewAArBo"}],"key":"d1AhrKVEJE"},{"type":"paragraph","position":{"start":{"line":128,"column":1},"end":{"line":128,"column":1}},"children":[{"type":"text","value":"Here is the adjacency matrix of a graph representing a small-world network, featuring connections to neighbors and a small number of distant contacts.","position":{"start":{"line":128,"column":1},"end":{"line":128,"column":1}},"key":"Bu3FZci9T2"}],"key":"fukMwKH6C5"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import networkx as nx\nwsg = nx.watts_strogatz_graph(200, 4, 0.02)","key":"RuthzCKz0f"},{"type":"output","id":"tEUeYCYMlPn0sQ2DRxxsJ","data":[],"key":"Yfx5ck9Lyl"}],"key":"mmIfGWWRjI"},{"type":"paragraph","position":{"start":{"line":135,"column":1},"end":{"line":135,"column":1}},"children":[{"type":"text","value":"Because each node connects to relatively few others, the adjacency matrix is quite sparse.","position":{"start":{"line":135,"column":1},"end":{"line":135,"column":1}},"key":"xEFqoBkoGg"}],"key":"Ej112JNpOc"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"A = nx.adjacency_matrix(wsg)\nspy(A)\ntitle(\"Adjacency matrix $A$\");","key":"BjkKAVnXlN"},{"type":"output","id":"FcD5MmZwxtmdxoWFHxRpS","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"1a7c5cfee005f98302329939db09e2cd","path":"/build/1a7c5cfee005f98302329939db09e2cd.png"}}}],"key":"dkyqtrGDAp"}],"key":"mt4wdy2Cpp"},{"type":"paragraph","position":{"start":{"line":143,"column":1},"end":{"line":143,"column":1}},"children":[{"type":"text","value":"By ","position":{"start":{"line":143,"column":1},"end":{"line":143,"column":1}},"key":"FlPFCAa4wb"},{"type":"crossReference","kind":"proof:theorem","identifier":"theorem-insight-adjmat","label":"theorem-insight-adjmat","children":[{"type":"text","value":"Theorem ","key":"RwzcjSQmid"},{"type":"text","value":"7.1.1","key":"iqOG4xDbYG"}],"template":"Theorem %s","enumerator":"7.1.1","resolved":true,"html_id":"theorem-insight-adjmat","remote":true,"url":"/insight","dataUrl":"/insight.json","key":"hgPUjQnazY"},{"type":"text","value":", the entries of ","position":{"start":{"line":143,"column":1},"end":{"line":143,"column":1}},"key":"kkL8gvfz3O"},{"type":"inlineMath","value":"\\mathbf{A}^k","position":{"start":{"line":143,"column":1},"end":{"line":143,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi mathvariant=\"bold\">A</mi><mi>k</mi></msup></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}^k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8491em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">A</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span></span></span></span></span></span></span></span>","key":"KfaMAslBul"},{"type":"text","value":" give the number of walks of length ","position":{"start":{"line":143,"column":1},"end":{"line":143,"column":1}},"key":"CyTkC0KBp5"},{"type":"inlineMath","value":"k","position":{"start":{"line":143,"column":1},"end":{"line":143,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span>","key":"dDYpSQFOdT"},{"type":"text","value":" between pairs of nodes, as with “","position":{"start":{"line":143,"column":1},"end":{"line":143,"column":1}},"key":"OI7eUo6py6"},{"type":"emphasis","position":{"start":{"line":143,"column":1},"end":{"line":143,"column":1}},"children":[{"type":"text","value":"k","position":{"start":{"line":143,"column":1},"end":{"line":143,"column":1}},"key":"ezgAmowGa8"}],"key":"Hp9GNQLTLd"},{"type":"text","value":" degrees of separation” within a social network. As ","position":{"start":{"line":143,"column":1},"end":{"line":143,"column":1}},"key":"HwnhypSJFl"},{"type":"inlineMath","value":"k","position":{"start":{"line":143,"column":1},"end":{"line":143,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span>","key":"y5IbVXiBUN"},{"type":"text","value":" grows, the density of ","position":{"start":{"line":143,"column":1},"end":{"line":143,"column":1}},"key":"oRB1Q8sNQR"},{"type":"inlineMath","value":"\\mathbf{A}^k","position":{"start":{"line":143,"column":1},"end":{"line":143,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi mathvariant=\"bold\">A</mi><mi>k</mi></msup></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}^k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8491em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">A</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span></span></span></span></span></span></span></span>","key":"wxy7eyokRv"},{"type":"text","value":" also grows.","position":{"start":{"line":143,"column":1},"end":{"line":143,"column":1}},"key":"sMsoTlbgle"}],"key":"jd4D95fskR"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"zHylVbqjzS"}],"key":"hUrY8ZlsYz"},{"type":"paragraph","position":{"start":{"line":146,"column":1},"end":{"line":146,"column":1}},"children":[{"type":"text","value":"While ","position":{"start":{"line":146,"column":1},"end":{"line":146,"column":1}},"key":"oVYKBmj0J9"},{"type":"inlineCode","value":"A**6","position":{"start":{"line":146,"column":1},"end":{"line":146,"column":1}},"key":"qjmRNYlu63"},{"type":"text","value":" is valid syntax here, it means elementwise power, not matrix power.","position":{"start":{"line":146,"column":1},"end":{"line":146,"column":1}},"key":"G8x8pkC1in"}],"key":"btHlaY67Ne"}],"class":"dropdown","key":"VpLgtTE6pb"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from scipy.sparse.linalg import matrix_power\nspy(matrix_power(A, 6))\ntitle((\"$A^6$\"));","key":"YwZ3uPvHML"},{"type":"output","id":"nVFQw5G8vAfmUUF58_VQO","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"2c9caf654d381ce52b5df3f44d06b0bb","path":"/build/2c9caf654d381ce52b5df3f44d06b0bb.png"}}}],"key":"j6i5an5bdU"}],"indexEntries":[{"entry":"Python","subEntry":{"value":"matrix_power","kind":"entry"},"emphasis":true}],"key":"s40434w6nz"}],"key":"OHmOa3vVfR"}],"key":"b3PbXqh2Be"}],"key":"PSE9Khn1lJ"}],"key":"q011jeNBs8"}],"label":"demo-structure-fill","identifier":"demo-structure-fill","enumerator":"8.1.2","html_id":"demo-structure-fill","key":"oY9pFXqxj5"},{"type":"heading","depth":2,"position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"children":[{"type":"text","value":"Banded matrices","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"key":"IBsPCwOmYL"}],"identifier":"banded-matrices","label":"Banded matrices","html_id":"banded-matrices","implicit":true,"enumerator":"8.1.2","key":"T0G12b5pjw"},{"type":"paragraph","position":{"start":{"line":81,"column":1},"end":{"line":81,"column":1}},"children":[{"type":"text","value":"A particularly important type of sparse matrix is a banded matrix. Recall from ","position":{"start":{"line":81,"column":1},"end":{"line":81,"column":1}},"key":"AxD8H5rEEf"},{"type":"link","kind":"numref","identifier":"section-linsys-structure","label":"section-linsys-structure","url":"/structure","internal":true,"dataUrl":"/structure.json","children":[{"type":"text","value":"Exploiting matrix structure","key":"PNC01xy8KM"}],"key":"r244jEymzD"},{"type":"text","value":" that ","position":{"start":{"line":81,"column":1},"end":{"line":81,"column":1}},"key":"dYE40jIryX"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":81,"column":1},"end":{"line":81,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"KF65nnWMUr"},{"type":"text","value":" has ","position":{"start":{"line":81,"column":1},"end":{"line":81,"column":1}},"key":"eBc7mA3itp"},{"type":"strong","position":{"start":{"line":81,"column":1},"end":{"line":81,"column":1}},"children":[{"type":"text","value":"upper bandwidth","position":{"start":{"line":81,"column":1},"end":{"line":81,"column":1}},"key":"DyWY2hFqEq"}],"key":"sy046wacNq"},{"type":"text","value":" ","position":{"start":{"line":81,"column":1},"end":{"line":81,"column":1}},"key":"Kflk0HAQWc"},{"type":"inlineMath","value":"p","position":{"start":{"line":81,"column":1},"end":{"line":81,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>p</mi></mrow><annotation encoding=\"application/x-tex\">p</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">p</span></span></span></span>","key":"UhVOaHm6RT"},{"type":"text","value":" if ","position":{"start":{"line":81,"column":1},"end":{"line":81,"column":1}},"key":"gLUPFF7mzj"},{"type":"inlineMath","value":"j-i > p","position":{"start":{"line":81,"column":1},"end":{"line":81,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>j</mi><mo>−</mo><mi>i</mi><mo>&gt;</mo><mi>p</mi></mrow><annotation encoding=\"application/x-tex\">j-i &gt; p</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6986em;vertical-align:-0.0391em;\"></span><span class=\"mord mathnormal\">i</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&gt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">p</span></span></span></span>","key":"wQOBw6lx8v"},{"type":"text","value":" implies ","position":{"start":{"line":81,"column":1},"end":{"line":81,"column":1}},"key":"gnjz8KdD3A"},{"type":"inlineMath","value":"A_{ij}=0","position":{"start":{"line":81,"column":1},"end":{"line":81,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>A</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">A_{ij}=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9694em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">ij</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"ogL4JN6RRt"},{"type":"text","value":", and ","position":{"start":{"line":81,"column":1},"end":{"line":81,"column":1}},"key":"MerklC475u"},{"type":"strong","position":{"start":{"line":81,"column":1},"end":{"line":81,"column":1}},"children":[{"type":"text","value":"lower bandwidth","position":{"start":{"line":81,"column":1},"end":{"line":81,"column":1}},"key":"GUpFQKIYZv"}],"key":"V3dCY2ZILd"},{"type":"text","value":" ","position":{"start":{"line":81,"column":1},"end":{"line":81,"column":1}},"key":"kbUrpcQdNm"},{"type":"inlineMath","value":"q","position":{"start":{"line":81,"column":1},"end":{"line":81,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>q</mi></mrow><annotation encoding=\"application/x-tex\">q</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span></span></span></span>","key":"vRLZexp2kx"},{"type":"text","value":" if ","position":{"start":{"line":81,"column":1},"end":{"line":81,"column":1}},"key":"wb1CruLVrl"},{"type":"inlineMath","value":"i-j > q","position":{"start":{"line":81,"column":1},"end":{"line":81,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi><mo>−</mo><mi>j</mi><mo>&gt;</mo><mi>q</mi></mrow><annotation encoding=\"application/x-tex\">i-j &gt; q</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7429em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">i</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&gt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span></span></span></span>","key":"H9ogGW6AvX"},{"type":"text","value":" implies ","position":{"start":{"line":81,"column":1},"end":{"line":81,"column":1}},"key":"Msi71j0Xu6"},{"type":"inlineMath","value":"A_{ij}=0","position":{"start":{"line":81,"column":1},"end":{"line":81,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>A</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">A_{ij}=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9694em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">ij</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"HsLWEF3JWj"},{"type":"text","value":". We say the total ","position":{"start":{"line":81,"column":1},"end":{"line":81,"column":1}},"key":"MqEv5r6BHp"},{"type":"strong","position":{"start":{"line":81,"column":1},"end":{"line":81,"column":1}},"children":[{"type":"text","value":"bandwidth","position":{"start":{"line":81,"column":1},"end":{"line":81,"column":1}},"key":"bJY9Ahbu32"}],"key":"dsFy4QlGXH"},{"type":"text","value":" is ","position":{"start":{"line":81,"column":1},"end":{"line":81,"column":1}},"key":"kir2LCugpg"},{"type":"inlineMath","value":"p+q+1","position":{"start":{"line":81,"column":1},"end":{"line":81,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>p</mi><mo>+</mo><mi>q</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">p+q+1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"tDw8I3Iz4G"},{"type":"text","value":". Banded matrices appear naturally in many applications where each element interacts directly with only a few neighbors.","position":{"start":{"line":81,"column":1},"end":{"line":81,"column":1}},"key":"aXwA5HttJ7"}],"indexEntries":[{"entry":"banded matrix","emphasis":false}],"label":"index-Mb2JrSfLS3","identifier":"index-mb2jrsfls3","html_id":"index-mb2jrsfls3","key":"G4OK8hSdxz"},{"type":"paragraph","position":{"start":{"line":86,"column":1},"end":{"line":86,"column":1}},"children":[{"type":"text","value":"Without pivoting, an LU factorization preserves bandwidth, but pivoting can change or destroy bandedness.","position":{"start":{"line":86,"column":1},"end":{"line":86,"column":1}},"key":"ssPhfW20f4"}],"indexEntries":[{"entry":"LU factorization","emphasis":false}],"label":"index-VnQBFgV4lC","identifier":"index-vnqbfgv4lc","html_id":"index-vnqbfgv4lc","key":"xw6hnoSItO"},{"type":"proof","kind":"example","enumerated":true,"children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Banded matrices","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"key":"D2934Yg4Mr"}],"key":"pRzVRD8PUE"},{"type":"tabSet","children":[{"type":"tabItem","title":"Julia","sync":"julia","children":[{"type":"embed","source":{"url":"/chapter8","label":"demo-structure-sparseband-julia","kind":"Notebook","slug":"chapter8","location":"/julia/chapter8.md","title":"Chapter 8"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-structure-sparseband","label":"demo-structure-sparseband","kind":"proof:example","position":{"start":{"line":160,"column":1},"end":{"line":160,"column":27}},"children":[{"type":"text","value":"Example ","key":"Oe50XdWs2G"},{"type":"text","value":"8.1.3","key":"KFW90wLF9N"}],"template":"Example %s","enumerator":"8.1.3","resolved":true,"html_id":"demo-structure-sparseband","remote":true,"url":"/structure-1","dataUrl":"/structure-1.json","key":"YRPZUNBKs3"}],"key":"PIV04Fh0M6"},{"type":"paragraph","position":{"start":{"line":166,"column":1},"end":{"line":166,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":166,"column":1},"end":{"line":166,"column":1}},"key":"WO2A72gqGh"},{"type":"inlineCode","value":"spdiagm","position":{"start":{"line":166,"column":1},"end":{"line":166,"column":1}},"key":"OhVBfEeCW2"},{"type":"text","value":" function creates a sparse matrix given its diagonal elements. The main or central diagonal is numbered zero, above and to the right of that is positive, and below and to the left is negative.","position":{"start":{"line":166,"column":1},"end":{"line":166,"column":1}},"key":"vdgYomL8lB"}],"indexEntries":[{"entry":"Julia","subEntry":{"value":"spdiagm","kind":"entry"},"emphasis":true}],"key":"n46TYxcDAj"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"n = 50;\nA = spdiagm(-3 => fill(n, n - 3),\n    0 => ones(n),\n    1 => -(1:n-1),\n    5 => fill(0.1, n - 5))\nMatrix(A[1:7, 1:7])","key":"wfKbAwHsSj"},{"type":"output","id":"Y1zQeJQqXWjvKYfCRaoC4","data":[{"output_type":"execute_result","execution_count":10,"metadata":{},"data":{"text/plain":{"content":"7×7 Matrix{Float64}:\n  1.0  -1.0   0.0   0.0   0.0   0.1   0.0\n  0.0   1.0  -2.0   0.0   0.0   0.0   0.1\n  0.0   0.0   1.0  -3.0   0.0   0.0   0.0\n 50.0   0.0   0.0   1.0  -4.0   0.0   0.0\n  0.0  50.0   0.0   0.0   1.0  -5.0   0.0\n  0.0   0.0  50.0   0.0   0.0   1.0  -6.0\n  0.0   0.0   0.0  50.0   0.0   0.0   1.0","content_type":"text/plain"}}}],"key":"iunJpAJTLU"}],"key":"y0ycbnQeIJ"},{"type":"paragraph","position":{"start":{"line":180,"column":1},"end":{"line":180,"column":1}},"children":[{"type":"text","value":"Without pivoting, the LU factors have the same lower and upper bandwidth as the original matrix.","position":{"start":{"line":180,"column":1},"end":{"line":180,"column":1}},"key":"nAwx7lk79c"}],"indexEntries":[{"entry":"Julia","subEntry":{"value":"sparse","kind":"entry"},"emphasis":true}],"key":"buVsfwb8m3"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"kq2LwNHFnf"}],"key":"wcvsnMQJR2"},{"type":"paragraph","position":{"start":{"line":184,"column":1},"end":{"line":184,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":184,"column":1},"end":{"line":184,"column":1}},"key":"gS5BuE55Zv"},{"type":"inlineCode","value":"sparse","position":{"start":{"line":184,"column":1},"end":{"line":184,"column":1}},"key":"qHzGbvnveD"},{"type":"text","value":" function converts any matrix to sparse form. But it’s usually better to construct a sparse matrix directly, as the standard form might not fit in memory.","position":{"start":{"line":184,"column":1},"end":{"line":184,"column":1}},"key":"fXc4cak5Ya"}],"key":"yov4SFihki"}],"class":"dropdown","key":"iqjpd3OExf"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"L, U = FNC.lufact(A)\nplot(layout=2)\nspy!(sparse(L), m=2, subplot=1, title=L\"\\mathbf{L}\", color=:blues)\nspy!(sparse(U), m=2, subplot=2, title=L\"\\mathbf{U}\", color=:blues)","key":"Y5fa49OgQ9"},{"type":"output","id":"psLmct-fgsBAenGxtiu97","data":[{"output_type":"execute_result","execution_count":11,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"78e11847faf7fd5e17fd901999586556","path":"/build/78e11847faf7fd5e17fd901999586556.png"},"text/html":{"content_type":"text/html","hash":"862b9369f72b1efad289a0d0f48fbe42","path":"/build/862b9369f72b1efad289a0d0f48fbe42.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"9330967553cc1d3324dbda818c419473","path":"/build/9330967553cc1d3324dbda818c419473.svg"}}}],"key":"TxK8a9D8Dp"}],"key":"eydw1Qme1A"},{"type":"paragraph","position":{"start":{"line":194,"column":1},"end":{"line":194,"column":1}},"children":[{"type":"text","value":"However, if we introduce row pivoting, bandedness may be expanded or destroyed.","position":{"start":{"line":194,"column":1},"end":{"line":194,"column":1}},"key":"rAgzp6z94z"}],"key":"f4jGMhfLcD"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"fact = lu(A)\nplot(layout=2)\nspy!(sparse(fact.L), m=2, subplot=1, title=L\"\\mathbf{L}\", color=:blues)\nspy!(sparse(fact.U), m=2, subplot=2, title=L\"\\mathbf{U}\", color=:blues)","key":"jnQufHAzFT"},{"type":"output","id":"Ac2Dx-Qep2ZvgZj1q0ppD","data":[{"output_type":"execute_result","execution_count":12,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"d733fc96dacd55427ae7fe3de0c6b525","path":"/build/d733fc96dacd55427ae7fe3de0c6b525.png"},"text/html":{"content_type":"text/html","hash":"185884f6b72440cf9f4afdc573e59e39","path":"/build/185884f6b72440cf9f4afdc573e59e39.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"10704dc2dfba3cdb6a7bf685ee3b9ac4","path":"/build/10704dc2dfba3cdb6a7bf685ee3b9ac4.svg"}}}],"key":"lVvlszVjEL"}],"key":"Q3VNErCQDP"}],"key":"DlhUlzXZHC"}],"key":"ZpCZP0ktni"}],"key":"qE9LewE32Z"},{"type":"tabItem","title":"MATLAB","sync":"matlab","children":[{"type":"embed","source":{"url":"/chapter8-1","label":"demo-structure-sparseband-matlab","kind":"Notebook","slug":"chapter8-1","location":"/matlab/chapter8.md","title":"Chapter 8"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-structure-sparseband","label":"demo-structure-sparseband","kind":"proof:example","position":{"start":{"line":146,"column":1},"end":{"line":146,"column":27}},"children":[{"type":"text","value":"Example ","key":"IOgULZcKwu"},{"type":"text","value":"8.1.3","key":"EzGUaFrOgz"}],"template":"Example %s","enumerator":"8.1.3","resolved":true,"html_id":"demo-structure-sparseband","remote":true,"url":"/structure-1","dataUrl":"/structure-1.json","key":"cm6uUlmdi6"}],"key":"P3B03Tb2xM"},{"type":"paragraph","position":{"start":{"line":152,"column":1},"end":{"line":152,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":152,"column":1},"end":{"line":152,"column":1}},"key":"AUGvRXiFL4"},{"type":"inlineCode","value":"spdiags","position":{"start":{"line":152,"column":1},"end":{"line":152,"column":1}},"key":"bUoUvh5uiy"},{"type":"text","value":" function creates a sparse matrix given its diagonal elements. The main or central diagonal is numbered zero, above and to the right of that is positive, and below and to the left is negative.","position":{"start":{"line":152,"column":1},"end":{"line":152,"column":1}},"key":"Hhp6v8Z2zH"}],"indexEntries":[{"entry":"MATLAB","subEntry":{"value":"spdiags","kind":"entry"},"emphasis":true}],"key":"zZAkDzcfcr"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"n = 50;\nn = 50;\n% Put constant values on 3 diagonals\nA = spdiags([n, 1, 0.1], [-3, 0, 5], n, n);\n% Put other values on 1st superdiagonal\nA = spdiags(-(0:n-1)', 1, A);\nfull(A(1:7, 1:7))","key":"l3eubWOLAG"},{"type":"output","id":"v_PHyaqzStZdLPedIZsbY","data":[{"output_type":"execute_result","execution_count":11,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = 7×7 double\n    1.0000   -1.0000         0         0         0    0.1000         0\n         0    1.0000   -2.0000         0         0         0    0.1000\n         0         0    1.0000   -3.0000         0         0         0\n   50.0000         0         0    1.0000   -4.0000         0         0\n         0   50.0000         0         0    1.0000   -5.0000         0\n         0         0   50.0000         0         0    1.0000   -6.0000\n         0         0         0   50.0000         0         0    1.0000\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = 7×7 double\n    1.0000   -1.0000         0         0         0    0.1000         0\n         0    1.0000   -2.0000         0         0         0    0.1000\n         0         0    1.0000   -3.0000         0         0         0\n   50.0000         0         0    1.0000   -4.0000         0         0\n         0   50.0000         0         0    1.0000   -5.0000         0\n         0         0   50.0000         0         0    1.0000   -6.0000\n         0         0         0   50.0000         0         0    1.0000\n","content_type":"text/plain"}}}],"key":"cwcQi2rmMC"}],"key":"U2QgbY0MtO"},{"type":"paragraph","position":{"start":{"line":167,"column":1},"end":{"line":167,"column":1}},"children":[{"type":"text","value":"Without pivoting, the LU factors have the same lower and upper bandwidth as the original matrix.","position":{"start":{"line":167,"column":1},"end":{"line":167,"column":1}},"key":"hfjo9a7i33"}],"indexEntries":[{"entry":"MATLAB","subEntry":{"value":"sparse","kind":"entry"},"emphasis":true}],"key":"RFjk4IMyy9"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"qsOVFrmrX1"}],"key":"ArHCNfQTTK"},{"type":"paragraph","position":{"start":{"line":170,"column":1},"end":{"line":170,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":170,"column":1},"end":{"line":170,"column":1}},"key":"ocVIQGx6JK"},{"type":"inlineCode","value":"sparse","position":{"start":{"line":170,"column":1},"end":{"line":170,"column":1}},"key":"bs8jsd4mhR"},{"type":"text","value":" function converts any matrix to sparse form. But it’s usually better to construct a sparse matrix directly, as the standard form might not fit in memory.","position":{"start":{"line":170,"column":1},"end":{"line":170,"column":1}},"key":"jV99YIQ3WJ"}],"key":"VocZGeFrLe"}],"class":"dropdown","key":"rIbOeYnily"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[L, U] = lufact(A);\nclf\nsubplot(1, 2, 1), spy(L), title('L')\nsubplot(1, 2, 2), spy(U), title(('U'));","key":"oAxr8ko9yl"},{"type":"output","id":"ZFibcz2zsE8W2uDXfCq1i","data":[{"output_type":"stream","name":"stderr","text":"Unrecognized function or variable 'lufact'."}],"key":"lzsLQpnX3e"}],"key":"k1o0mtxHMv"},{"type":"paragraph","position":{"start":{"line":182,"column":1},"end":{"line":182,"column":1}},"children":[{"type":"text","value":"However, if we introduce row pivoting, bandedness may be expanded or destroyed.","position":{"start":{"line":182,"column":1},"end":{"line":182,"column":1}},"key":"atYuvJkR1z"}],"key":"wEP3XkIliC"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[L, U, p] = plufact(A);\nsubplot(1, 2, 1), spy(L(p, :)), title('L')\nsubplot(1, 2, 2), spy(U), title(('U'));","key":"BF9uQuPMpQ"},{"type":"output","id":"h0QfpuhthDxoDZR20X1N8","data":[{"output_type":"stream","name":"stderr","text":"Unrecognized function or variable 'plufact'."}],"key":"m0rUmrkMjj"}],"key":"L435Zy2H3Q"}],"key":"T9gL2Utjwo"}],"key":"FMLa4HMGcG"}],"key":"cu4imYS3xi"},{"type":"tabItem","title":"Python","sync":"python","children":[{"type":"embed","source":{"url":"/chapter8-2","label":"demo-structure-sparseband-python","kind":"Notebook","slug":"chapter8-2","location":"/python/chapter8.md","title":"Chapter 8"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-structure-sparseband","label":"demo-structure-sparseband","kind":"proof:example","position":{"start":{"line":160,"column":1},"end":{"line":160,"column":27}},"children":[{"type":"text","value":"Example ","key":"R7LBKJRMIa"},{"type":"text","value":"8.1.3","key":"ojbkImj32z"}],"template":"Example %s","enumerator":"8.1.3","resolved":true,"html_id":"demo-structure-sparseband","remote":true,"url":"/structure-1","dataUrl":"/structure-1.json","key":"AkawZ2M9z0"}],"key":"amN01EESJQ"},{"type":"paragraph","position":{"start":{"line":165,"column":1},"end":{"line":165,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":165,"column":1},"end":{"line":165,"column":1}},"key":"xnMrHechTY"},{"type":"inlineCode","value":"scipi.sparse.diags","position":{"start":{"line":165,"column":1},"end":{"line":165,"column":1}},"key":"JVeZCmgdrq"},{"type":"text","value":" function creates a sparse matrix given its diagonal elements and the diagonal indexes to put them on. The main or central diagonal is numbered zero, above and to the right of that is positive, and below and to the left is negative.","position":{"start":{"line":165,"column":1},"end":{"line":165,"column":1}},"key":"OZSNXLBjsy"}],"indexEntries":[{"entry":"Python","subEntry":{"value":"diags","kind":"entry"},"emphasis":true}],"key":"E3lF4Ftp6m"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"n = 50\ndata = [n * ones(n-3), ones(n), linspace(-1, 1-n, n-1)]\noffsets = [-3, 0, 1]    # 3rd below, main, 1st above\nA = sp.diags(data, offsets, format=\"lil\")\nprint(A[:7, :7].todense())","key":"ZInD6Ffopm"},{"type":"output","id":"lZssgv9SPoiW7dszBWqcq","data":[{"output_type":"stream","name":"stdout","text":"[[ 1. -1.  0.  0.  0.  0.  0.]\n [ 0.  1. -2.  0.  0.  0.  0.]\n [ 0.  0.  1. -3.  0.  0.  0.]\n [50.  0.  0.  1. -4.  0.  0.]\n [ 0. 50.  0.  0.  1. -5.  0.]\n [ 0.  0. 50.  0.  0.  1. -6.]\n [ 0.  0.  0. 50.  0.  0.  1.]]\n"}],"key":"vN3qPbpZb8"}],"key":"wTBs8FMqTB"},{"type":"paragraph","position":{"start":{"line":175,"column":1},"end":{"line":175,"column":1}},"children":[{"type":"text","value":"Without pivoting, the LU factors have the same lower and upper bandwidth as the original matrix.","position":{"start":{"line":175,"column":1},"end":{"line":175,"column":1}},"key":"BVE24TfUAD"}],"key":"lNcQzsaicR"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"L, U = FNC.lufact(A.todense())\nsubplot(1, 2, 1), spy(L)\nsubplot(1, 2, 2), spy(U);","key":"qttncCtheu"},{"type":"output","id":"hdc-Xeq-Nl5PvCMi9xhG2","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 2 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"c4624ee6ba05ea981701f0d2d7cba873","path":"/build/c4624ee6ba05ea981701f0d2d7cba873.png"}}}],"key":"SxB3WW9ZwI"}],"key":"rqT87PPx2d"},{"type":"paragraph","position":{"start":{"line":183,"column":1},"end":{"line":183,"column":1}},"children":[{"type":"text","value":"However, if we introduce row pivoting, bandedness may be expanded or destroyed.","position":{"start":{"line":183,"column":1},"end":{"line":183,"column":1}},"key":"RWol04agyF"}],"key":"jfRxrpAakq"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"L, U, p = FNC.plufact(A.todense())\nsubplot(1, 2, 1), spy(L[p, :])\nsubplot(1, 2, 2), spy(U)","key":"sDARoUTPsj"},{"type":"output","id":"4fc0ehGQlOIQ5cChzUgiW","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 2 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"01ec7f999007143d1ca9144dfbd4734d","path":"/build/01ec7f999007143d1ca9144dfbd4734d.png"}}}],"key":"k8ZRRqRKYK"}],"key":"MvTgOSvGXs"}],"key":"lCHV5NtcwL"}],"key":"hE2o8ZBZOj"}],"key":"w8Iws6zYTQ"}],"key":"xQPlRy8y05"}],"label":"demo-structure-sparseband","identifier":"demo-structure-sparseband","enumerator":"8.1.3","html_id":"demo-structure-sparseband","key":"eKLlirW6KS"},{"type":"heading","depth":2,"position":{"start":{"line":113,"column":1},"end":{"line":113,"column":1}},"children":[{"type":"text","value":"Systems and eigenvalues","position":{"start":{"line":113,"column":1},"end":{"line":113,"column":1}},"key":"VgorRV274p"}],"identifier":"systems-and-eigenvalues","label":"Systems and eigenvalues","html_id":"systems-and-eigenvalues","implicit":true,"enumerator":"8.1.3","key":"Ti1RHTzkhi"},{"type":"paragraph","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"children":[{"type":"text","value":"If given a sparse matrix, the backslash operator will automatically try a form of sparse-aware Cholesky or pivoted LU factorization. Depending on the sparsity pattern of the matrix, the time taken to solve the linear system may be well below the ","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"key":"HH8Uu72Or7"},{"type":"inlineMath","value":"O(n^3)","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><msup><mi>n</mi><mn>3</mn></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(n^3)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">n</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"ehdceACb7P"},{"type":"text","value":" needed in the general case.","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"key":"p5rhVrGVXY"}],"key":"AOQnnTYGJf"},{"type":"paragraph","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"children":[{"type":"text","value":"For very large matrices, it’s unlikely that you will want to find all of its eigenvalues and eigenvectors. In ","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"key":"N3VqY9gwxY"},{"type":"link","kind":"numref","identifier":"section-krylov-subspace","label":"section-krylov-subspace","url":"/subspace","internal":true,"dataUrl":"/subspace.json","children":[{"type":"text","value":"Krylov subspaces","key":"otLjTMEEHa"}],"key":"eaUMtT6L49"},{"type":"text","value":" we describe some of the math behind an algorithm that can find a selected number of eigenvalues of largest magnitude, lying to the extreme left or right, or nearest a given complex number.","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"key":"BLHYn2FDWO"}],"indexEntries":[{"entry":"eigenvalue decomposition","emphasis":false}],"label":"index-EQcRtVQYx5","identifier":"index-eqcrtvqyx5","html_id":"index-eqcrtvqyx5","key":"QuPp7duTeP"},{"type":"proof","kind":"example","enumerated":true,"children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Eigenvalues of sparse matrices","position":{"start":{"line":122,"column":1},"end":{"line":122,"column":1}},"key":"rusYADseab"}],"key":"z6FByueBbR"},{"type":"tabSet","children":[{"type":"tabItem","title":"Julia","sync":"julia","children":[{"type":"embed","source":{"url":"/chapter8","label":"demo-structure-linalg-julia","kind":"Notebook","slug":"chapter8","location":"/julia/chapter8.md","title":"Chapter 8"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-structure-linalg","label":"demo-structure-linalg","kind":"proof:example","position":{"start":{"line":206,"column":1},"end":{"line":206,"column":23}},"children":[{"type":"text","value":"Example ","key":"hFr1aZnUxp"},{"type":"text","value":"8.1.4","key":"rvTzzElcHk"}],"template":"Example %s","enumerator":"8.1.4","resolved":true,"html_id":"demo-structure-linalg","remote":true,"url":"/structure-1","dataUrl":"/structure-1.json","key":"NKazGtpTxw"}],"key":"qjnCsz4ziQ"},{"type":"paragraph","position":{"start":{"line":208,"column":1},"end":{"line":208,"column":1}},"children":[{"type":"text","value":"The following generates a random sparse matrix with prescribed eigenvalues.","position":{"start":{"line":208,"column":1},"end":{"line":208,"column":1}},"key":"VZDoHdVpS7"}],"key":"xGPzlnXfH0"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"n = 4000\ndensity = 4e-4\nλ = @. 1 + 1 / (1:n)   # exact eigenvalues\nA = FNC.sprandsym(n, density, λ);","key":"WBZUebWeHg"},{"type":"output","id":"9NHKT22ednQ0jvqUBVuxR","data":[],"key":"KFqfqvSFbk"}],"key":"dAVGdTzMmn"},{"type":"paragraph","position":{"start":{"line":220,"column":1},"end":{"line":220,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":220,"column":1},"end":{"line":220,"column":1}},"key":"UnGd5uzScP"},{"type":"inlineCode","value":"eigs","position":{"start":{"line":220,"column":1},"end":{"line":220,"column":1}},"key":"TipWhA5j7L"},{"type":"text","value":" function from ","position":{"start":{"line":220,"column":1},"end":{"line":220,"column":1}},"key":"Os8YBeTKz9"},{"type":"inlineCode","value":"Arpack","position":{"start":{"line":220,"column":1},"end":{"line":220,"column":1}},"key":"WBOqQXgZaf"},{"type":"text","value":" finds a small number eigenvalues meeting some criterion. First, we ask for the 5 of largest (complex) magnitude using ","position":{"start":{"line":220,"column":1},"end":{"line":220,"column":1}},"key":"z65VBLWkKS"},{"type":"inlineCode","value":"which=:LM","position":{"start":{"line":220,"column":1},"end":{"line":220,"column":1}},"key":"Tef8cy9jBx"},{"type":"text","value":".","position":{"start":{"line":220,"column":1},"end":{"line":220,"column":1}},"key":"SGaebcu6J7"}],"indexEntries":[{"entry":"Julia","subEntry":{"value":"eigs","kind":"entry"},"emphasis":true}],"key":"VleFctH6lu"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"using Arpack\nλmax, V = eigs(A, nev=5, which=:LM)    # Largest Magnitude\nfmt = ft_printf(\"%20.15f\")\npretty_table([λmax λ[1:5]], header=[\"found\", \"exact\"], formatters=fmt)","key":"iHP6knH4jj"},{"type":"output","id":"Eiz26Oulz7wCUDPX2Fy-R","data":[{"output_type":"stream","name":"stdout","text":"┌──────────────────────┬──────────────────────┐\n│\u001b[1m                found \u001b[0m│\u001b[1m                exact \u001b[0m│\n├──────────────────────┼──────────────────────┤\n│    2.000000000000000 │    2.000000000000000 │\n│    1.500000000000002 │    1.500000000000000 │\n│    1.333333333333336 │    1.333333333333333 │\n│    1.250000000000002 │    1.250000000000000 │\n│    1.200000000000004 │    1.200000000000000 │\n└──────────────────────┴──────────────────────┘\n"}],"key":"xiiN8tgkDJ"}],"key":"D5mEfMxfQB"},{"type":"paragraph","position":{"start":{"line":229,"column":1},"end":{"line":229,"column":1}},"children":[{"type":"text","value":"Now we find the 5 closest to the value 1 in the complex plane, via ","position":{"start":{"line":229,"column":1},"end":{"line":229,"column":1}},"key":"Y6f0G5Lbn1"},{"type":"inlineCode","value":"sigma=1","position":{"start":{"line":229,"column":1},"end":{"line":229,"column":1}},"key":"knbsLIk1vj"},{"type":"text","value":".","position":{"start":{"line":229,"column":1},"end":{"line":229,"column":1}},"key":"lEIGzLItzc"}],"key":"S2auorh2Ye"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"λ1, V = eigs(A, nev=5, sigma=1)    # closest to sigma\ndata = [λ1 λ[end:-1:end-4]]\npretty_table(data, header=[\"found\", \"exact\"], formatters=fmt)","key":"PSAoaeudgV"},{"type":"output","id":"kXbTEsg9zHrwiQ9T2F9oq","data":[{"output_type":"stream","name":"stdout","text":"┌──────────────────────┬──────────────────────┐\n│\u001b[1m                found \u001b[0m│\u001b[1m                exact \u001b[0m│\n├──────────────────────┼──────────────────────┤\n│    1.000250000000000 │    1.000250000000000 │\n│    1.000250062515629 │    1.000250062515629 │\n│    1.000250125062531 │    1.000250125062531 │\n│    1.000250187640731 │    1.000250187640731 │\n│    1.000250250250250 │    1.000250250250250 │\n└──────────────────────┴──────────────────────┘\n"}],"key":"aRY7EdCfx5"}],"key":"LL8nPHAfbQ"},{"type":"paragraph","position":{"start":{"line":240,"column":1},"end":{"line":240,"column":1}},"children":[{"type":"text","value":"The time needed to solve a sparse linear system is not easy to predict unless you have some more information about the matrix. But it will typically be orders of magnitude faster than the dense version of the same problem.","position":{"start":{"line":240,"column":1},"end":{"line":240,"column":1}},"key":"DTItutj8lp"}],"indexEntries":[{"entry":"Julia","subEntry":{"value":"\\\\","kind":"entry"},"emphasis":false}],"key":"KyQj0VRurF"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"x = @. 1 / (1:n);\nb = A * x;","key":"QyMyPV3IkG"},{"type":"output","id":"IrbvTo3LQrx2RFkWempGz","data":[],"key":"qlxFYe6xFe"}],"key":"gg3tDywkxJ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"norm(x - A \\ b);  # force compilation\nt = @elapsed sparse_err = norm(x - A \\ b)\nprintln(\"Time for sparse solve: $t\")","key":"zMbQWdiYj5"},{"type":"output","id":"cdhQUzYBtf2UnA3PFe847","data":[{"output_type":"stream","name":"stdout","text":"Time for sparse solve: 0.000582083\n"}],"key":"ga5A9CDHcO"}],"key":"TR5B9OsxOP"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"D = Matrix(A)  # convert to regular matrix\nnorm(x - D \\ b);\nt = @elapsed dense_err = norm(x - D \\ b)\nprintln(\"Time for dense solve: $t\")","key":"mvUye2WzFC"},{"type":"output","id":"VxpCxI15honufx_2j1qGG","data":[{"output_type":"stream","name":"stdout","text":"Time for dense solve: 15.377480375\n"}],"key":"FJjTTHnFML"}],"key":"f3HiXKSl4h"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"@show sparse_err;\n@show dense_err;","key":"d8OdGqe8gr"},{"type":"output","id":"BuB-YUimsbY7IdnIiSpws","data":[{"output_type":"stream","name":"stdout","text":"sparse_err = 4.024723632301656e-17\ndense_err = 4.041471762201952e-18\n"}],"key":"V6OPjOVwl2"}],"key":"EodArhGWj8"}],"key":"zaOaO5mQa7"}],"key":"pbCLWo0VYE"}],"key":"eS1BcRep2U"},{"type":"tabItem","title":"MATLAB","sync":"matlab","children":[{"type":"embed","source":{"url":"/chapter8-1","label":"demo-structure-linalg-matlab","kind":"Notebook","slug":"chapter8-1","location":"/matlab/chapter8.md","title":"Chapter 8"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-structure-linalg","label":"demo-structure-linalg","kind":"proof:example","position":{"start":{"line":193,"column":1},"end":{"line":193,"column":23}},"children":[{"type":"text","value":"Example ","key":"WIDs8x8dvc"},{"type":"text","value":"8.1.4","key":"tRkuPHH1Js"}],"template":"Example %s","enumerator":"8.1.4","resolved":true,"html_id":"demo-structure-linalg","remote":true,"url":"/structure-1","dataUrl":"/structure-1.json","key":"mToVjW2rNl"}],"key":"J1CKhrj3az"},{"type":"paragraph","position":{"start":{"line":196,"column":1},"end":{"line":196,"column":1}},"children":[{"type":"text","value":"The following generates a random sparse matrix with prescribed eigenvalues.","position":{"start":{"line":196,"column":1},"end":{"line":196,"column":1}},"key":"peaU6A0ICK"}],"key":"oiwmx2xyPm"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"n = 4000;\ndensity = 4e-4;\nlambda = 1 ./ (1:n);\nA = sprandsym(n, density, lambda);\nclf,  spy(A)\ntitle('Sparse symmetric matrix')","key":"msrdzg5tDh"},{"type":"output","id":"ZoYS3uhNTwcQYteYwR31D","data":[{"output_type":"execute_result","execution_count":14,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"e2a84c6338d54312316ab906a5ad13f9","path":"/build/e2a84c6338d54312316ab906a5ad13f9.png"}}}],"key":"IvEJaDo6ce"}],"key":"rPUUP7pbGI"},{"type":"paragraph","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"key":"gVMP1NiNND"},{"type":"inlineCode","value":"eigs","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"key":"WhVQQYXkKm"},{"type":"text","value":" function finds a small number eigenvalues meeting some criterion. First, we ask for the 5 of largest (complex) magnitude.","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"key":"gUpzlk4R6z"}],"indexEntries":[{"entry":"MATLAB","subEntry":{"value":"eigs","kind":"entry"},"emphasis":true}],"key":"q7I3WINBBM"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[V, D] = eigs(A, 5);    % largest magnitude\n1 ./ diag(D)            % should be 1, 2, 3, 4, 5","key":"xQk2blocOO"},{"type":"output","id":"CkfpNCbC0JkstJAhMPD45","data":[{"output_type":"execute_result","execution_count":15,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = 5×1 double\n    1.0000\n    2.0000\n    3.0000\n    4.0000\n    5.0000\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = 5×1 double\n    1.0000\n    2.0000\n    3.0000\n    4.0000\n    5.0000\n","content_type":"text/plain"}}}],"key":"dCMlVIcuck"}],"key":"TLophO0tCm"},{"type":"paragraph","position":{"start":{"line":217,"column":1},"end":{"line":217,"column":1}},"children":[{"type":"text","value":"Now we find the 4 closest to the value 0.03 in the complex plane.","position":{"start":{"line":217,"column":1},"end":{"line":217,"column":1}},"key":"vGb0KtPdrb"}],"key":"QTM10NHoa0"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[V, D] = eigs(A, 4, 0.03);    % closest to 0.03\ndiag(D)","key":"DAYQm9QCQ9"},{"type":"output","id":"u-Rno9cpvvxdbc2LXlPrz","data":[{"output_type":"execute_result","execution_count":16,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = 4×1 double\n    0.0303\n    0.0294\n    0.0312\n    0.0286\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = 4×1 double\n    0.0303\n    0.0294\n    0.0312\n    0.0286\n","content_type":"text/plain"}}}],"key":"GnBgTEVqOp"}],"key":"E3vhPWz6gK"},{"type":"paragraph","position":{"start":{"line":227,"column":1},"end":{"line":227,"column":1}},"children":[{"type":"text","value":"The time needed to solve a sparse linear system is not easy to predict unless you have some more information about the matrix. But it will typically be orders of magnitude faster than the dense version of the same problem.","position":{"start":{"line":227,"column":1},"end":{"line":227,"column":1}},"key":"v31tatRtOV"}],"indexEntries":[{"entry":"MATLAB","subEntry":{"value":"\\\\","kind":"entry"},"emphasis":false}],"key":"mDU13pPfGF"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"x = 1 ./ (1:n)';  \nb = A * x;\ntic, sparse_err = norm(x - A\\b), sparse_time = toc","key":"NtOjBVGVWI"},{"type":"output","id":"8xXyp9vW7yFJ8JmWj8MJA","data":[{"output_type":"execute_result","execution_count":17,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>sparse_err = 2.3296e-14</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"sparse_err = 2.3296e-14","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":17,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>sparse_time = 0.0047</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"sparse_time = 0.0047","content_type":"text/plain"}}}],"key":"qpBbgSRs6O"}],"key":"UVORcCOhWZ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"F = full(A);\ntic, dense_err = norm(x - F\\b), dense_time = toc","key":"MnsgyQqv6a"},{"type":"output","id":"4xnTB732xDTloq_fvl3Zy","data":[{"output_type":"execute_result","execution_count":18,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>dense_err = 2.3277e-14</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"dense_err = 2.3277e-14","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":18,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>dense_time = 0.3468</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"dense_time = 0.3468","content_type":"text/plain"}}}],"key":"rgUOA9Dc0s"}],"key":"Kpp1gJEjxs"}],"key":"lMTHlaeIPv"}],"key":"lJvzOkbT0r"}],"key":"K5cTrFDD8n"},{"type":"tabItem","title":"Python","sync":"python","children":[{"type":"embed","source":{"url":"/chapter8-2","label":"demo-structure-linalg-python","kind":"Notebook","slug":"chapter8-2","location":"/python/chapter8.md","title":"Chapter 8"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-structure-linalg","label":"demo-structure-linalg","kind":"proof:example","position":{"start":{"line":194,"column":1},"end":{"line":194,"column":23}},"children":[{"type":"text","value":"Example ","key":"ki72L9gPvj"},{"type":"text","value":"8.1.4","key":"HZlBYCh33k"}],"template":"Example %s","enumerator":"8.1.4","resolved":true,"html_id":"demo-structure-linalg","remote":true,"url":"/structure-1","dataUrl":"/structure-1.json","key":"C7hfqczFUY"}],"key":"PfkGSaFTuy"},{"type":"paragraph","position":{"start":{"line":197,"column":1},"end":{"line":197,"column":1}},"children":[{"type":"text","value":"The following generates a random sparse matrix with prescribed eigenvalues.","position":{"start":{"line":197,"column":1},"end":{"line":197,"column":1}},"key":"meCS1rjM6o"}],"key":"Lo4GOgpDql"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"n = 4000\ndensity = 4e-4\nev = 1 / arange(1, n + 1)\nA = FNC.sprandsym(n, density, eigvals=ev)\nprint(f\"density is {A.nnz / prod(A.shape):.3%}\")","key":"h8bFP7pPsd"},{"type":"output","id":"jW2ZNATxF1N7s7miaonRz","data":[{"output_type":"stream","name":"stdout","text":"density is 0.040%\n"}],"key":"p6Jj7lPP7I"}],"key":"DhhdvIPAMv"},{"type":"paragraph","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"key":"fwzvgsCWt2"},{"type":"inlineCode","value":"eigs","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"key":"tVkr25BGmQ"},{"type":"text","value":" function finds a small number eigenvalues meeting some criterion. First, we ask for the 5 of largest (complex) magnitude using ","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"key":"Gl9nDMHpxj"},{"type":"inlineCode","value":"which=\"LM\"","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"key":"UanRRIEU5j"},{"type":"text","value":".","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"key":"CC5M8hWlqY"}],"indexEntries":[{"entry":"Python","subEntry":{"value":"eigs","kind":"entry"},"emphasis":true}],"key":"ObGVfiTnkk"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from scipy.sparse.linalg import eigs\nev, V = eigs(A, k=5, which=\"LM\")    # largest magnitude\nprint(1 / ev)","key":"XDyWoWqRQ1"},{"type":"output","id":"gvedtkbgfpicL6KDpCPLa","data":[{"output_type":"stream","name":"stdout","text":"[1.+0.j 2.+0.j 3.+0.j 4.+0.j 5.+0.j]\n"}],"key":"rLBwFiWMpp"}],"key":"WBkdhnz3z8"},{"type":"paragraph","position":{"start":{"line":218,"column":1},"end":{"line":218,"column":1}},"children":[{"type":"text","value":"Now we find the 4 closest to the value 1 in the complex plane, via ","position":{"start":{"line":218,"column":1},"end":{"line":218,"column":1}},"key":"W7vY8BdXaQ"},{"type":"inlineCode","value":"sigma=1","position":{"start":{"line":218,"column":1},"end":{"line":218,"column":1}},"key":"zZjt4Rkrhf"},{"type":"text","value":".","position":{"start":{"line":218,"column":1},"end":{"line":218,"column":1}},"key":"kq194nxGlr"}],"key":"KOsd0KqQri"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from scipy.sparse.linalg import eigs\nev, V = eigs(A, k=4, sigma=0.03)    # closest to sigma\nprint(ev)","key":"rafO8FoSKx"},{"type":"output","id":"xbFvUZMcjG9f-iPfX1PTg","data":[{"output_type":"stream","name":"stdout","text":"[0.03030303+0.j 0.02941176+0.j 0.03125   +0.j 0.02857143+0.j]\n"}],"key":"FWt9yCkfdR"}],"key":"OlxYaI3Qg1"},{"type":"paragraph","position":{"start":{"line":226,"column":1},"end":{"line":226,"column":1}},"children":[{"type":"text","value":"The time needed to solve a sparse linear system is not easy to predict unless you have some more information about the matrix. But it will typically be orders of magnitude faster than the dense version of the same problem.","position":{"start":{"line":226,"column":1},"end":{"line":226,"column":1}},"key":"Rjcp5S2eR5"}],"key":"mRkVttJ5id"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from scipy.sparse.linalg import spsolve\nx = 1 / arange(1, n + 1)\nb = A @ x\nstart = timer()\nxx = spsolve(A, b)\nprint(f\"sparse time: {timer() - start:.3g} sec\")\nprint(f\"residual: {norm(b - A @ xx, 2):.1e}\")","key":"NmEI7x25AM"},{"type":"output","id":"wILWHtF_ZLj9ALHTSBKvY","data":[{"output_type":"stream","name":"stdout","text":"sparse time: 0.0037 sec\nresidual: 1.1e-16\n"}],"key":"oWImoU40md"}],"key":"d7hOimHuRj"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from numpy.linalg import solve\nF = A.todense()\nstart = timer()\nxx = solve(F, b)\nprint(f\"dense time: {timer() - start:.3g} sec\")\nprint(f\"residual: {norm(b - A @ xx, 2):.1e}\")","key":"hRBAOcjf1f"},{"type":"output","id":"C8JluMlr52ooOaDZ5gYab","data":[{"output_type":"stream","name":"stdout","text":"dense time: 0.863 sec\nresidual: 1.1e-16\n"}],"key":"ReHzFG4tZ8"}],"key":"CkoQV9cCIP"}],"key":"Vd0wFtBW12"}],"key":"pzg0QIdLyP"}],"key":"OqcVvYKQQm"}],"key":"IDeQ9pEtxp"}],"label":"demo-structure-linalg","identifier":"demo-structure-linalg","enumerator":"8.1.4","html_id":"demo-structure-linalg","key":"rLIXurWzvK"},{"type":"heading","depth":2,"position":{"start":{"line":147,"column":1},"end":{"line":147,"column":1}},"children":[{"type":"text","value":"Exercises","position":{"start":{"line":147,"column":1},"end":{"line":147,"column":1}},"key":"gDoJCsl3zi"}],"identifier":"exercises","label":"Exercises","html_id":"exercises","implicit":true,"enumerator":"8.1.4","key":"PaYgSeAH91"},{"type":"exercise","children":[{"type":"paragraph","position":{"start":{"line":151,"column":1},"end":{"line":151,"column":1}},"children":[{"type":"text","value":"⌨ Use ","position":{"start":{"line":151,"column":1},"end":{"line":151,"column":1}},"key":"JnsnUf3ZBH"},{"type":"inlineCode","value":"spdiagm","position":{"start":{"line":151,"column":1},"end":{"line":151,"column":1}},"key":"nvND1KXf0y"},{"type":"text","value":" to build the ","position":{"start":{"line":151,"column":1},"end":{"line":151,"column":1}},"key":"qmNfDGOiqJ"},{"type":"inlineMath","value":"50\\times 50","position":{"start":{"line":151,"column":1},"end":{"line":151,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>50</mn><mo>×</mo><mn>50</mn></mrow><annotation encoding=\"application/x-tex\">50\\times 50</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">50</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">50</span></span></span></span>","key":"LeaslTbpgb"},{"type":"text","value":" matrices","position":{"start":{"line":151,"column":1},"end":{"line":151,"column":1}},"key":"t4mFaPBGrA"}],"key":"UDyishViVb"},{"type":"math","value":"\\mathbf{A} =\n\\begin{bmatrix}\n-2 & 1 & & &  \\\\\n1 & -2 & 1 & &  \\\\\n& \\ddots & \\ddots & \\ddots & \\\\\n& & 1 & -2 & 1 \\\\\n& & & 1 & -2\n\\end{bmatrix}, \\qquad\n\\mathbf{B} =\n\\begin{bmatrix}\n-2 & 1 & & & 1 \\\\\n1 & -2 & 1 & &  \\\\\n& \\ddots & \\ddots & \\ddots & \\\\\n& & 1 & -2 & 1 \\\\\n1 & & & 1 & -2\n\\end{bmatrix}.","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi mathvariant=\"bold\">A</mi><mo>=</mo><mrow><mo fence=\"true\">[</mo><mtable rowspacing=\"0.16em\" columnalign=\"center center center center center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mn>2</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mn>2</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mo lspace=\"0em\" rspace=\"0em\">⋱</mo></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mo lspace=\"0em\" rspace=\"0em\">⋱</mo></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mo lspace=\"0em\" rspace=\"0em\">⋱</mo></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mn>2</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mn>2</mn></mrow></mstyle></mtd></mtr></mtable><mo fence=\"true\">]</mo></mrow><mo separator=\"true\">,</mo><mspace width=\"2em\"/><mi mathvariant=\"bold\">B</mi><mo>=</mo><mrow><mo fence=\"true\">[</mo><mtable rowspacing=\"0.16em\" columnalign=\"center center center center center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mn>2</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mn>2</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mo lspace=\"0em\" rspace=\"0em\">⋱</mo></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mo lspace=\"0em\" rspace=\"0em\">⋱</mo></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mo lspace=\"0em\" rspace=\"0em\">⋱</mo></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mn>2</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mn>2</mn></mrow></mstyle></mtd></mtr></mtable><mo fence=\"true\">]</mo></mrow><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A} =\n\\begin{bmatrix}\n-2 &amp; 1 &amp; &amp; &amp;  \\\\\n1 &amp; -2 &amp; 1 &amp; &amp;  \\\\\n&amp; \\ddots &amp; \\ddots &amp; \\ddots &amp; \\\\\n&amp; &amp; 1 &amp; -2 &amp; 1 \\\\\n&amp; &amp; &amp; 1 &amp; -2\n\\end{bmatrix}, \\qquad\n\\mathbf{B} =\n\\begin{bmatrix}\n-2 &amp; 1 &amp; &amp; &amp; 1 \\\\\n1 &amp; -2 &amp; 1 &amp; &amp;  \\\\\n&amp; \\ddots &amp; \\ddots &amp; \\ddots &amp; \\\\\n&amp; &amp; 1 &amp; -2 &amp; 1 \\\\\n1 &amp; &amp; &amp; 1 &amp; -2\n\\end{bmatrix}.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:6.0001em;vertical-align:-2.75em;\"></span><span class=\"minner\"><span class=\"mopen\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.25em;\"><span style=\"top:-2.311em;\"><span class=\"pstrut\" style=\"height:4.416em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎣</span></span></span><span style=\"top:-3.458em;\"><span class=\"pstrut\" style=\"height:4.416em;\"></span><span style=\"height:2.416em;width:0.6667em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.6667em' height='2.416em' style='width:0.6667em' viewBox='0 0 666.67 2416' preserveAspectRatio='xMinYMin'><path d='M319 0 H403 V2416 H319z M319 0 H403 V2416 H319z'/></svg></span></span><span style=\"top:-6.5111em;\"><span class=\"pstrut\" style=\"height:4.416em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎡</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.75em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.25em;\"><span style=\"top:-5.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord\">2</span></span></span><span style=\"top:-4.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span><span style=\"top:-3.01em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span><span style=\"top:-1.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span><span style=\"top:-0.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.75em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.25em;\"><span style=\"top:-5.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span><span style=\"top:-4.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord\">2</span></span></span><span style=\"top:-3.01em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"minner\">⋱</span></span></span><span style=\"top:-1.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span><span style=\"top:-0.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.75em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.25em;\"><span style=\"top:-5.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span><span style=\"top:-4.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span><span style=\"top:-3.01em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"minner\">⋱</span></span></span><span style=\"top:-1.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span><span style=\"top:-0.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.75em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.25em;\"><span style=\"top:-5.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span><span style=\"top:-4.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span><span style=\"top:-3.01em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"minner\">⋱</span></span></span><span style=\"top:-1.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord\">2</span></span></span><span style=\"top:-0.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.75em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.25em;\"><span style=\"top:-5.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span><span style=\"top:-4.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span><span style=\"top:-3.01em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span><span style=\"top:-1.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span><span style=\"top:-0.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.75em;\"><span></span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.25em;\"><span style=\"top:-2.311em;\"><span class=\"pstrut\" style=\"height:4.416em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎦</span></span></span><span style=\"top:-3.458em;\"><span class=\"pstrut\" style=\"height:4.416em;\"></span><span style=\"height:2.416em;width:0.6667em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.6667em' height='2.416em' style='width:0.6667em' viewBox='0 0 666.67 2416' preserveAspectRatio='xMinYMin'><path d='M263 0 H347 V2416 H263z M263 0 H347 V2416 H263z'/></svg></span></span><span style=\"top:-6.5111em;\"><span class=\"pstrut\" style=\"height:4.416em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎤</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.75em;\"><span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:2em;\"></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathbf\">B</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:6.0001em;vertical-align:-2.75em;\"></span><span class=\"minner\"><span class=\"mopen\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.25em;\"><span style=\"top:-2.311em;\"><span class=\"pstrut\" style=\"height:4.416em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎣</span></span></span><span style=\"top:-3.458em;\"><span class=\"pstrut\" style=\"height:4.416em;\"></span><span style=\"height:2.416em;width:0.6667em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.6667em' height='2.416em' style='width:0.6667em' viewBox='0 0 666.67 2416' preserveAspectRatio='xMinYMin'><path d='M319 0 H403 V2416 H319z M319 0 H403 V2416 H319z'/></svg></span></span><span style=\"top:-6.5111em;\"><span class=\"pstrut\" style=\"height:4.416em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎡</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.75em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.25em;\"><span style=\"top:-5.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord\">2</span></span></span><span style=\"top:-4.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span><span style=\"top:-3.01em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span><span style=\"top:-1.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span><span style=\"top:-0.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.75em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.25em;\"><span style=\"top:-5.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span><span style=\"top:-4.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord\">2</span></span></span><span style=\"top:-3.01em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"minner\">⋱</span></span></span><span style=\"top:-1.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span><span style=\"top:-0.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.75em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.25em;\"><span style=\"top:-5.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span><span style=\"top:-4.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span><span style=\"top:-3.01em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"minner\">⋱</span></span></span><span style=\"top:-1.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span><span style=\"top:-0.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.75em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.25em;\"><span style=\"top:-5.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span><span style=\"top:-4.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span><span style=\"top:-3.01em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"minner\">⋱</span></span></span><span style=\"top:-1.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord\">2</span></span></span><span style=\"top:-0.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.75em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.25em;\"><span style=\"top:-5.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span><span style=\"top:-4.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span><span style=\"top:-3.01em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span><span style=\"top:-1.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span><span style=\"top:-0.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.75em;\"><span></span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.25em;\"><span style=\"top:-2.311em;\"><span class=\"pstrut\" style=\"height:4.416em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎦</span></span></span><span style=\"top:-3.458em;\"><span class=\"pstrut\" style=\"height:4.416em;\"></span><span style=\"height:2.416em;width:0.6667em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.6667em' height='2.416em' style='width:0.6667em' viewBox='0 0 666.67 2416' preserveAspectRatio='xMinYMin'><path d='M263 0 H347 V2416 H263z M263 0 H347 V2416 H263z'/></svg></span></span><span style=\"top:-6.5111em;\"><span class=\"pstrut\" style=\"height:4.416em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎤</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.75em;\"><span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">.</span></span></span></span></span>","enumerator":"8.1.1","key":"okuQM8hMfX"},{"type":"paragraph","position":{"start":{"line":172,"column":1},"end":{"line":172,"column":1}},"children":[{"type":"text","value":"For each matrix, use ","position":{"start":{"line":172,"column":1},"end":{"line":172,"column":1}},"key":"yzOornExF7"},{"type":"inlineCode","value":"spy","position":{"start":{"line":172,"column":1},"end":{"line":172,"column":1}},"key":"MGnfW2EMOM"},{"type":"text","value":" and an inspection of the ","position":{"start":{"line":172,"column":1},"end":{"line":172,"column":1}},"key":"RS2lxYZRRZ"},{"type":"inlineMath","value":"5\\times 5","position":{"start":{"line":172,"column":1},"end":{"line":172,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>5</mn><mo>×</mo><mn>5</mn></mrow><annotation encoding=\"application/x-tex\">5\\times 5</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">5</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">5</span></span></span></span>","key":"QRIRnJes7h"},{"type":"text","value":" submatrices in the corners to verify the correctness of your matrices.","position":{"start":{"line":172,"column":1},"end":{"line":172,"column":1}},"key":"iaFEQhR6iU"}],"key":"HaecKbIGAH"}],"label":"problem-structure-spdiagm","identifier":"problem-structure-spdiagm","enumerated":true,"enumerator":"8.1.1","html_id":"problem-structure-spdiagm","key":"ixG3XLyvRa"},{"type":"exercise","children":[{"type":"paragraph","position":{"start":{"line":177,"column":1},"end":{"line":177,"column":1}},"children":[{"type":"text","value":"⌨ This problem requires the matrix used in ","position":{"start":{"line":177,"column":1},"end":{"line":177,"column":1}},"key":"qnElcWU3gA"},{"type":"crossReference","identifier":"demo-structure-fill","label":"demo-structure-fill","kind":"proof:example","position":{"start":{"line":177,"column":44},"end":{"line":177,"column":64}},"children":[{"type":"text","value":"Example ","key":"VQMqOkyeG5"},{"type":"text","value":"8.1.2","key":"iyCg44j6pQ"}],"template":"Example %s","enumerator":"8.1.2","resolved":true,"html_id":"demo-structure-fill","key":"HUMVMcMQCn"},{"type":"text","value":".","position":{"start":{"line":177,"column":1},"end":{"line":177,"column":1}},"key":"uKockE5k6z"}],"key":"N7Lex4Z1NJ"},{"type":"tabSet","children":[{"type":"tabItem","title":"Julia","sync":"julia","children":[{"type":"paragraph","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"children":[{"type":"text","value":"Download ","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"key":"OdaP6vPUbq"},{"type":"link","url":"/build/smallworld-a41b872b4cf354d79f46e658ed6dccf4.mat","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"children":[{"type":"text","value":"smallworld.mat","key":"Z3NeaukhWq"}],"urlSource":"smallworld.mat","static":true,"protocol":"file","key":"hc6qlvQSBU"},{"type":"text","value":" by clicking the link and saving (you may need to fix the file name).","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"key":"srItAnm3uZ"}],"key":"yFQRIuMKF3"},{"type":"code","lang":"julia","value":"using MAT\nA = matread(\"smallworld.mat\")[\"A\"]","position":{"start":{"line":182,"column":1},"end":{"line":185,"column":1}},"key":"sSzUReKem2"}],"key":"nVb14l2XGd"},{"type":"tabItem","title":"MATLAB","sync":"matlab","children":[{"type":"paragraph","position":{"start":{"line":190,"column":1},"end":{"line":190,"column":1}},"children":[{"type":"text","value":"Download ","position":{"start":{"line":190,"column":1},"end":{"line":190,"column":1}},"key":"qf8dN8NzZX"},{"type":"link","url":"/build/smallworld-a41b872b4cf354d79f46e658ed6dccf4.mat","position":{"start":{"line":190,"column":1},"end":{"line":190,"column":1}},"children":[{"type":"text","value":"smallworld.mat","key":"WltlZHZHPm"}],"urlSource":"smallworld.mat","static":true,"protocol":"file","key":"l6HQh8tXWp"},{"type":"text","value":" by clicking the link and saving (you may need to fix the file name).","position":{"start":{"line":190,"column":1},"end":{"line":190,"column":1}},"key":"x9EunFEEd2"}],"key":"z1JGnMW7dC"},{"type":"code","lang":"matlab","value":"load smallworld","position":{"start":{"line":191,"column":1},"end":{"line":193,"column":1}},"key":"mk4M8b3zgd"}],"key":"PP679OPwLr"},{"type":"tabItem","title":"Python","sync":"python","children":[{"type":"paragraph","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"children":[{"type":"text","value":"Download ","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"key":"wOle7tJnPS"},{"type":"link","url":"/build/smallworld-91a805c73fca3d2ca85d6e344e632f24.mtx","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"children":[{"type":"text","value":"smallworld.mtx","key":"wdYPK56l1Y"}],"urlSource":"smallworld.mtx","static":true,"protocol":"file","key":"jrn12KOIOD"},{"type":"text","value":" by clicking the link and saving (you may need to fix the file name).","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"key":"zvfcTe19lt"}],"key":"nnlLhHiKD4"},{"type":"code","lang":"python","value":"import scipy.io as spio\nA = spio.mmread(\"smallworld.mtx\")","position":{"start":{"line":199,"column":1},"end":{"line":202,"column":1}},"key":"Hs7zNq4HRN"}],"key":"iWVyIB8Vu0"}],"key":"XIOx2gP8xe"},{"type":"paragraph","position":{"start":{"line":206,"column":1},"end":{"line":206,"column":1}},"children":[{"type":"strong","position":{"start":{"line":206,"column":1},"end":{"line":206,"column":1}},"children":[{"type":"text","value":"(a)","position":{"start":{"line":206,"column":1},"end":{"line":206,"column":1}},"key":"amWIqdiFIU"}],"key":"Vnbbuu6rhK"},{"type":"text","value":" Find the density of ","position":{"start":{"line":206,"column":1},"end":{"line":206,"column":1}},"key":"a3Dop5PL6A"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":206,"column":1},"end":{"line":206,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"e9h2fjoT4z"},{"type":"text","value":" (number of nonzeros divided by total number of elements), ","position":{"start":{"line":206,"column":1},"end":{"line":206,"column":1}},"key":"WVlSV8YW3z"},{"type":"inlineMath","value":"\\mathbf{A}^2","position":{"start":{"line":206,"column":1},"end":{"line":206,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi mathvariant=\"bold\">A</mi><mn>2</mn></msup></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}^2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">A</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span>","key":"XiVmrYme8W"},{"type":"text","value":", ","position":{"start":{"line":206,"column":1},"end":{"line":206,"column":1}},"key":"SwfM3ouz5s"},{"type":"inlineMath","value":"\\mathbf{A}^4","position":{"start":{"line":206,"column":1},"end":{"line":206,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi mathvariant=\"bold\">A</mi><mn>4</mn></msup></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}^4</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">A</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">4</span></span></span></span></span></span></span></span></span></span></span>","key":"GSXZ0NXOjt"},{"type":"text","value":", and ","position":{"start":{"line":206,"column":1},"end":{"line":206,"column":1}},"key":"Z7vBLzN7EI"},{"type":"inlineMath","value":"\\mathbf{A}^8","position":{"start":{"line":206,"column":1},"end":{"line":206,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi mathvariant=\"bold\">A</mi><mn>8</mn></msup></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}^8</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">A</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">8</span></span></span></span></span></span></span></span></span></span></span>","key":"LC4jyoPwYm"},{"type":"text","value":". (You should find that it increases with the power of ","position":{"start":{"line":206,"column":1},"end":{"line":206,"column":1}},"key":"dQxufX32hk"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":206,"column":1},"end":{"line":206,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"VmG9xy3ZGF"},{"type":"text","value":".)","position":{"start":{"line":206,"column":1},"end":{"line":206,"column":1}},"key":"JxVfivmvkC"}],"key":"VRwHur8fuh"},{"type":"paragraph","position":{"start":{"line":208,"column":1},"end":{"line":208,"column":1}},"children":[{"type":"strong","position":{"start":{"line":208,"column":1},"end":{"line":208,"column":1}},"children":[{"type":"text","value":"(b)","position":{"start":{"line":208,"column":1},"end":{"line":208,"column":1}},"key":"uFtYpoC6Cb"}],"key":"TgIjwMg7Wk"},{"type":"text","value":" The LU factors tend to at least partially retain sparsity. Find the density of the ","position":{"start":{"line":208,"column":1},"end":{"line":208,"column":1}},"key":"X5OhbGAKB0"},{"type":"inlineMath","value":"\\mathbf{L}","position":{"start":{"line":208,"column":1},"end":{"line":208,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">L</span></span></span></span>","key":"s4Y895WnHD"},{"type":"text","value":" and ","position":{"start":{"line":208,"column":1},"end":{"line":208,"column":1}},"key":"IKh03j7QRd"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":208,"column":1},"end":{"line":208,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"dsXcVkBEHP"},{"type":"text","value":" factors of ","position":{"start":{"line":208,"column":1},"end":{"line":208,"column":1}},"key":"ufjBqz9rBk"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":208,"column":1},"end":{"line":208,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"rqmzRBOrVh"},{"type":"text","value":" using ","position":{"start":{"line":208,"column":1},"end":{"line":208,"column":1}},"key":"GyvphQ87cL"},{"type":"inlineCode","value":"lufact","position":{"start":{"line":208,"column":1},"end":{"line":208,"column":1}},"key":"GABNokkGwX"},{"type":"text","value":" (","position":{"start":{"line":208,"column":1},"end":{"line":208,"column":1}},"key":"NiG6beZK26"},{"type":"crossReference","identifier":"function-lufact","label":"function-lufact","kind":"proof:algorithm","position":{"start":{"line":208,"column":162},"end":{"line":208,"column":178}},"children":[{"type":"text","value":"Algorithm ","key":"AKEEOu8Emh"},{"type":"text","value":"2.4.1","key":"MoTJ3gBNYH"}],"template":"Algorithm %s","enumerator":"2.4.1","resolved":true,"html_id":"function-lufact","remote":true,"url":"/lu","dataUrl":"/lu.json","key":"qFjgfWovG3"},{"type":"text","value":"). (If you get an error, convert the matrix to dense form first.)","position":{"start":{"line":208,"column":1},"end":{"line":208,"column":1}},"key":"x2h8K0bBRN"}],"key":"LXa0nrwAcP"},{"type":"paragraph","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"children":[{"type":"strong","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"children":[{"type":"text","value":"(c)","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"key":"tgWV2sKFD9"}],"key":"tAznKzTBLO"},{"type":"text","value":" Repeat part (b) for the QR factorization using ","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"key":"BbdM3ClgKZ"},{"type":"inlineCode","value":"qrfact","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"key":"aDF0wOGjLe"},{"type":"text","value":" (","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"key":"Xl3uRo6dm9"},{"type":"crossReference","identifier":"function-qrfact","label":"function-qrfact","kind":"proof:algorithm","position":{"start":{"line":210,"column":66},"end":{"line":210,"column":82}},"children":[{"type":"text","value":"Algorithm ","key":"HrREdvLaiO"},{"type":"text","value":"3.4.1","key":"NgcVLdyZzi"}],"template":"Algorithm %s","enumerator":"3.4.1","resolved":true,"html_id":"function-qrfact","remote":true,"url":"/house","dataUrl":"/house.json","key":"CdqVYjthsA"},{"type":"text","value":"). (If you get an error, convert the matrix to dense form first.)","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"key":"JwCuZczaaJ"}],"key":"JG4uQDZiiD"}],"label":"problem-structure-factoring","identifier":"problem-structure-factoring","enumerated":true,"enumerator":"8.1.2","html_id":"problem-structure-factoring","key":"TLb2huhQzh"},{"type":"exercise","children":[{"type":"paragraph","position":{"start":{"line":215,"column":1},"end":{"line":215,"column":1}},"children":[{"type":"text","value":"⌨ One use of adjacency matrices is to analyze the links between members of a collection. Obtain the adjacency matrix ","position":{"start":{"line":215,"column":1},"end":{"line":215,"column":1}},"key":"f3JBLIZ3pC"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":215,"column":1},"end":{"line":215,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"M3Ogq9slVp"},{"type":"text","value":" from ","position":{"start":{"line":215,"column":1},"end":{"line":215,"column":1}},"key":"JOAG33nfSj"},{"type":"crossReference","identifier":"demo-structure-sparse","label":"demo-structure-sparse","kind":"proof:example","position":{"start":{"line":215,"column":136},"end":{"line":215,"column":158}},"children":[{"type":"text","value":"Example ","key":"mW9pKx84bm"},{"type":"text","value":"8.1.1","key":"adIl83tqgR"}],"template":"Example %s","enumerator":"8.1.1","resolved":true,"html_id":"demo-structure-sparse","key":"BCVCxLxLBZ"},{"type":"text","value":" via the following:","position":{"start":{"line":215,"column":1},"end":{"line":215,"column":1}},"key":"NXWHT9QiOi"}],"key":"nDPEtInmOV"},{"type":"tabSet","children":[{"type":"tabItem","title":"Julia","sync":"julia","children":[{"type":"paragraph","position":{"start":{"line":220,"column":1},"end":{"line":220,"column":1}},"children":[{"type":"text","value":"Download ","position":{"start":{"line":220,"column":1},"end":{"line":220,"column":1}},"key":"p9woS6tjsl"},{"type":"link","url":"/build/roswell-77304b04410d4877330f7bb46bcf5c81.mat","position":{"start":{"line":220,"column":1},"end":{"line":220,"column":1}},"children":[{"type":"text","value":"roswell.mat","key":"o3YpTEJRwF"}],"urlSource":"roswell.mat","static":true,"protocol":"file","key":"BDySm80afY"},{"type":"text","value":" by clicking the link and saving (you may need to fix the file name).","position":{"start":{"line":220,"column":1},"end":{"line":220,"column":1}},"key":"b88J7mAeJA"}],"key":"Tkjoerp2Ri"},{"type":"code","lang":"julia","value":"using MAT\nA = matread(\"roswell.mat\")[\"A\"]","position":{"start":{"line":221,"column":1},"end":{"line":224,"column":1}},"key":"x7OJq5Utvx"}],"key":"qRlVJdVlSW"},{"type":"tabItem","title":"MATLAB","sync":"matlab","children":[{"type":"paragraph","position":{"start":{"line":229,"column":1},"end":{"line":229,"column":1}},"children":[{"type":"text","value":"Download ","position":{"start":{"line":229,"column":1},"end":{"line":229,"column":1}},"key":"Mw2NpHP01y"},{"type":"link","url":"/build/roswell-77304b04410d4877330f7bb46bcf5c81.mat","position":{"start":{"line":229,"column":1},"end":{"line":229,"column":1}},"children":[{"type":"text","value":"roswell.mat","key":"P0Y2DjFLRv"}],"urlSource":"roswell.mat","static":true,"protocol":"file","key":"gZ0mKyZXLz"},{"type":"text","value":" by clicking the link and saving (you may need to fix the file name).","position":{"start":{"line":229,"column":1},"end":{"line":229,"column":1}},"key":"DvYupYMbc3"}],"key":"dDmZPRtyeX"},{"type":"code","lang":"matlab","value":"load roswell","position":{"start":{"line":230,"column":1},"end":{"line":232,"column":1}},"key":"ImjMFYvafV"}],"key":"htTvDYbr8i"},{"type":"tabItem","title":"Python","sync":"python","children":[{"type":"paragraph","position":{"start":{"line":237,"column":1},"end":{"line":237,"column":1}},"children":[{"type":"text","value":"Download ","position":{"start":{"line":237,"column":1},"end":{"line":237,"column":1}},"key":"yhu0pIKYO7"},{"type":"link","url":"/build/roswell-bfeee0b66de9cbf536ee217e5499f6cb.mtx","position":{"start":{"line":237,"column":1},"end":{"line":237,"column":1}},"children":[{"type":"text","value":"roswell.mtx","key":"gjpnzYxZ7t"}],"urlSource":"roswell.mtx","static":true,"protocol":"file","key":"QDZicq640D"},{"type":"text","value":" by clicking the link and saving (you may need to fix the file name).","position":{"start":{"line":237,"column":1},"end":{"line":237,"column":1}},"key":"Lb8cEmFecW"}],"key":"T98IhW00sF"},{"type":"code","lang":"python","value":"import scipy.io as spio\nA = spio.mmread(\"roswell.mtx\")","position":{"start":{"line":238,"column":1},"end":{"line":241,"column":1}},"key":"HXR80Kl1mh"}],"key":"TMRWt2JXL3"}],"key":"UJ9FQJfCn1"},{"type":"paragraph","position":{"start":{"line":245,"column":1},"end":{"line":245,"column":1}},"children":[{"type":"text","value":"The matrix catalogs the links between web sites related to the town of Roswell, NM, with ","position":{"start":{"line":245,"column":1},"end":{"line":245,"column":1}},"key":"VfHqNJQ6MH"},{"type":"inlineMath","value":"A_{ij}=1","position":{"start":{"line":245,"column":1},"end":{"line":245,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>A</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">A_{ij}=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9694em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">ij</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"OoeOMD0GAH"},{"type":"text","value":" if and only if site ","position":{"start":{"line":245,"column":1},"end":{"line":245,"column":1}},"key":"CyjWz3nfIz"},{"type":"inlineMath","value":"i","position":{"start":{"line":245,"column":1},"end":{"line":245,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span>","key":"M4TntJHDAU"},{"type":"text","value":" links to site ","position":{"start":{"line":245,"column":1},"end":{"line":245,"column":1}},"key":"MZvMk905Ks"},{"type":"inlineMath","value":"j","position":{"start":{"line":245,"column":1},"end":{"line":245,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>j</mi></mrow><annotation encoding=\"application/x-tex\">j</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span></span></span></span>","key":"JYYu75MKlW"},{"type":"text","value":".","position":{"start":{"line":245,"column":1},"end":{"line":245,"column":1}},"key":"Cor6URs2Ql"}],"key":"U5pzVt5UgC"},{"type":"paragraph","position":{"start":{"line":247,"column":1},"end":{"line":247,"column":1}},"children":[{"type":"strong","position":{"start":{"line":247,"column":1},"end":{"line":247,"column":1}},"children":[{"type":"text","value":"(a)","position":{"start":{"line":247,"column":1},"end":{"line":247,"column":1}},"key":"j0Otmk0X6b"}],"key":"wPL6ajxVjA"},{"type":"text","value":" Verify numerically that the matrix does not include any links from a site to itself.","position":{"start":{"line":247,"column":1},"end":{"line":247,"column":1}},"key":"dl952A5A43"}],"key":"yixq566J3E"},{"type":"paragraph","position":{"start":{"line":249,"column":1},"end":{"line":249,"column":1}},"children":[{"type":"strong","position":{"start":{"line":249,"column":1},"end":{"line":249,"column":1}},"children":[{"type":"text","value":"(b)","position":{"start":{"line":249,"column":1},"end":{"line":249,"column":1}},"key":"omy05F8AF9"}],"key":"VhaCa7Qj8h"},{"type":"text","value":" Verify numerically that ","position":{"start":{"line":249,"column":1},"end":{"line":249,"column":1}},"key":"bquHBluNEh"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":249,"column":1},"end":{"line":249,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"FFOykBchGg"},{"type":"text","value":" is not symmetric. (Thus, its graph is a directed one.)","position":{"start":{"line":249,"column":1},"end":{"line":249,"column":1}},"key":"rAoGyC5NS5"}],"key":"b9W1LymiV5"},{"type":"paragraph","position":{"start":{"line":251,"column":1},"end":{"line":251,"column":1}},"children":[{"type":"strong","position":{"start":{"line":251,"column":1},"end":{"line":251,"column":1}},"children":[{"type":"text","value":"(c)","position":{"start":{"line":251,"column":1},"end":{"line":251,"column":1}},"key":"FNW5rL8TDI"}],"key":"lJjVaHmoSP"},{"type":"text","value":" How many sites in the group are not pointed to by any other sites in the group?","position":{"start":{"line":251,"column":1},"end":{"line":251,"column":1}},"key":"XWY6QpQz7O"}],"key":"CXhmA3HK1B"},{"type":"paragraph","position":{"start":{"line":253,"column":1},"end":{"line":253,"column":1}},"children":[{"type":"strong","position":{"start":{"line":253,"column":1},"end":{"line":253,"column":1}},"children":[{"type":"text","value":"(d)","position":{"start":{"line":253,"column":1},"end":{"line":253,"column":1}},"key":"w1YWFVG2XP"}],"key":"Q3Siy0IGZJ"},{"type":"text","value":" Which site points to the most other sites?","position":{"start":{"line":253,"column":1},"end":{"line":253,"column":1}},"key":"zfGoCLFpxr"}],"key":"URtV25ZhXw"},{"type":"paragraph","position":{"start":{"line":255,"column":1},"end":{"line":255,"column":1}},"children":[{"type":"strong","position":{"start":{"line":255,"column":1},"end":{"line":255,"column":1}},"children":[{"type":"text","value":"(e)","position":{"start":{"line":255,"column":1},"end":{"line":255,"column":1}},"key":"JmCAwJT3ig"}],"key":"FSRgVPuWza"},{"type":"text","value":" Which site is pointed to the most by the other sites? This is a crude way to establish the most important site.","position":{"start":{"line":255,"column":1},"end":{"line":255,"column":1}},"key":"fs1TMzwQqz"}],"key":"ishPM4q42n"},{"type":"paragraph","position":{"start":{"line":257,"column":1},"end":{"line":257,"column":1}},"children":[{"type":"strong","position":{"start":{"line":257,"column":1},"end":{"line":257,"column":1}},"children":[{"type":"text","value":"(f)","position":{"start":{"line":257,"column":1},"end":{"line":257,"column":1}},"key":"HtfB6dbiEL"}],"key":"nGdbroI5lN"},{"type":"text","value":" There are ","position":{"start":{"line":257,"column":1},"end":{"line":257,"column":1}},"key":"KnHM6AjY5A"},{"type":"span","position":{"start":{"line":257,"column":1},"end":{"line":257,"column":1}},"children":[{"type":"text","value":"2790","key":"UWoHXO1fJQ"},{"type":"superscript","children":[{"type":"text","value":"2","key":"p2U3p8JKj3"}],"key":"j7G6dzxbDV"}],"key":"xEL5Oq6s9I"},{"type":"text","value":" possible ways to connect ordered pairs of sites. What fraction of these pairs is connected by a walk of links that is no greater than three in length?","position":{"start":{"line":257,"column":1},"end":{"line":257,"column":1}},"key":"eEjqiWnQlD"}],"key":"mx7e2NU6KB"}],"label":"problem-structure-roswell","identifier":"problem-structure-roswell","enumerated":true,"enumerator":"8.1.3","html_id":"problem-structure-roswell","key":"xQOrTNQoyd"},{"type":"exercise","children":[{"type":"paragraph","position":{"start":{"line":266,"column":1},"end":{"line":266,"column":1}},"children":[{"type":"text","value":"⌨ The ","position":{"start":{"line":266,"column":1},"end":{"line":266,"column":1}},"key":"lRq9rTiFc8"},{"type":"link","url":"https://en.wikipedia.org/wiki/Laplacian_matrix","position":{"start":{"line":266,"column":1},"end":{"line":266,"column":1}},"children":[{"type":"text","value":"graph Laplacian matrix","position":{"start":{"line":266,"column":1},"end":{"line":266,"column":1}},"key":"CdJLQotZY3"}],"urlSource":"wiki:Laplacian_matrix","data":{"page":"Laplacian_matrix","wiki":"https://en.wikipedia.org/","lang":"en"},"internal":false,"protocol":"wiki","key":"j6GlGwXh7H"},{"type":"text","value":" is ","position":{"start":{"line":266,"column":1},"end":{"line":266,"column":1}},"key":"sDueGz4aU1"},{"type":"inlineMath","value":"\\mathbf{L}=\\mathbf{D}-\\mathbf{A}","position":{"start":{"line":266,"column":1},"end":{"line":266,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi><mo>=</mo><mi mathvariant=\"bold\">D</mi><mo>−</mo><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}=\\mathbf{D}-\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">L</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7694em;vertical-align:-0.0833em;\"></span><span class=\"mord mathbf\">D</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"H8sLAEm4JS"},{"type":"text","value":", where ","position":{"start":{"line":266,"column":1},"end":{"line":266,"column":1}},"key":"DnezIfOdK0"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":266,"column":1},"end":{"line":266,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"OSwhxbOBxB"},{"type":"text","value":" is the adjacency matrix and ","position":{"start":{"line":266,"column":1},"end":{"line":266,"column":1}},"key":"bnPJsDdTW4"},{"type":"inlineMath","value":"\\mathbf{D}","position":{"start":{"line":266,"column":1},"end":{"line":266,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">D</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{D}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">D</span></span></span></span>","key":"Soe64euLW4"},{"type":"text","value":" is the ","position":{"start":{"line":266,"column":1},"end":{"line":266,"column":1}},"key":"kv9XB0e3OU"},{"type":"emphasis","position":{"start":{"line":266,"column":1},"end":{"line":266,"column":1}},"children":[{"type":"text","value":"degree matrix","position":{"start":{"line":266,"column":1},"end":{"line":266,"column":1}},"key":"kNRBfIx9Nr"}],"key":"SS974CDxj1"},{"type":"text","value":", a diagonal matrix with diagonal entries ","position":{"start":{"line":266,"column":1},"end":{"line":266,"column":1}},"key":"ZvF2Zo0k3r"},{"type":"inlineMath","value":"d_{jj}=\\sum_{i=1}^n a_{ij}","position":{"start":{"line":266,"column":1},"end":{"line":266,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>d</mi><mrow><mi>j</mi><mi>j</mi></mrow></msub><mo>=</mo><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><msub><mi>a</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">d_{jj}=\\sum_{i=1}^n a_{ij}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9805em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">jj</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.104em;vertical-align:-0.2997em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">∑</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8043em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.2029em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2997em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">ij</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span>","key":"AuPO09YJMC"},{"type":"text","value":".","position":{"start":{"line":266,"column":1},"end":{"line":266,"column":1}},"key":"jd7Fp55gEY"}],"key":"HdvVi3Im98"},{"type":"paragraph","position":{"start":{"line":268,"column":1},"end":{"line":268,"column":1}},"children":[{"type":"text","value":"Follow the directions in ","position":{"start":{"line":268,"column":1},"end":{"line":268,"column":1}},"key":"lq6sXHCmKD"},{"type":"crossReference","identifier":"problem-structure-roswell","label":"problem-structure-roswell","kind":"exercise","position":{"start":{"line":268,"column":26},"end":{"line":268,"column":52}},"children":[{"type":"text","value":"Exercise ","key":"xaUNqKBRkn"},{"type":"text","value":"8.1.3","key":"xwxxdYZWjr"}],"template":"Exercise %s","enumerator":"8.1.3","resolved":true,"html_id":"problem-structure-roswell","key":"uPQNAicBqI"},{"type":"text","value":" to obtain an adjacency matrix ","position":{"start":{"line":268,"column":1},"end":{"line":268,"column":1}},"key":"bMGO8q7nCJ"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":268,"column":1},"end":{"line":268,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"X019ZDkYvg"},{"type":"text","value":". Then find the five eigenvalues of ","position":{"start":{"line":268,"column":1},"end":{"line":268,"column":1}},"key":"ffEileHtDu"},{"type":"inlineMath","value":"\\mathbf{L}","position":{"start":{"line":268,"column":1},"end":{"line":268,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">L</span></span></span></span>","key":"Uvk5INCYv3"},{"type":"text","value":" having largest magnitude.","position":{"start":{"line":268,"column":1},"end":{"line":268,"column":1}},"key":"UBEmUmPlKm"}],"key":"tPIc4quk6k"}],"label":"problem-structure-laplacian","identifier":"problem-structure-laplacian","enumerated":true,"enumerator":"8.1.4","html_id":"problem-structure-laplacian","key":"J8PrwgDB7U"},{"type":"exercise","children":[{"type":"paragraph","position":{"start":{"line":273,"column":1},"end":{"line":273,"column":1}},"children":[{"type":"text","value":"⌨ See ","position":{"start":{"line":273,"column":1},"end":{"line":273,"column":1}},"key":"syhfMo1jlr"},{"type":"crossReference","identifier":"problem-insight-actors","label":"problem-insight-actors","kind":"exercise","position":{"start":{"line":273,"column":7},"end":{"line":273,"column":30}},"children":[{"type":"text","value":"Exercise ","key":"PAEuP7fy1b"},{"type":"text","value":"7.1.5","key":"RpEYwagmT6"}],"template":"Exercise %s","enumerator":"7.1.5","resolved":true,"html_id":"problem-insight-actors","remote":true,"url":"/insight","dataUrl":"/insight.json","key":"sEdaysx20a"},{"type":"text","value":" for instructions on loading a matrix ","position":{"start":{"line":273,"column":1},"end":{"line":273,"column":1}},"key":"qe9HvdjEjD"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":273,"column":1},"end":{"line":273,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"DLO3egPfME"},{"type":"text","value":" that contains information about the appearances of 392,400 actors in 127,823 movies, as given by the ","position":{"start":{"line":273,"column":1},"end":{"line":273,"column":1}},"key":"igmw2nIFsK"},{"type":"link","url":"https://en.wikipedia.org/wiki/IMDb","position":{"start":{"line":273,"column":1},"end":{"line":273,"column":1}},"children":[{"type":"text","value":"Internet Movie Database","position":{"start":{"line":273,"column":1},"end":{"line":273,"column":1}},"key":"xfLQgenRSa"}],"urlSource":"wiki:IMDb","data":{"page":"IMDb","wiki":"https://en.wikipedia.org/","lang":"en"},"internal":false,"protocol":"wiki","key":"I3DF6HrYjn"},{"type":"text","value":". Specifically, ","position":{"start":{"line":273,"column":1},"end":{"line":273,"column":1}},"key":"Q9qCHvztkb"},{"type":"inlineMath","value":"A_{ij}=1","position":{"start":{"line":273,"column":1},"end":{"line":273,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>A</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">A_{ij}=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9694em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">ij</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"lIoLIajJLT"},{"type":"text","value":" if actor ","position":{"start":{"line":273,"column":1},"end":{"line":273,"column":1}},"key":"ZfvNhTZAkG"},{"type":"inlineMath","value":"j","position":{"start":{"line":273,"column":1},"end":{"line":273,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>j</mi></mrow><annotation encoding=\"application/x-tex\">j</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span></span></span></span>","key":"HXBzIl6fER"},{"type":"text","value":" appeared in movie ","position":{"start":{"line":273,"column":1},"end":{"line":273,"column":1}},"key":"QKJuugbenY"},{"type":"inlineMath","value":"i","position":{"start":{"line":273,"column":1},"end":{"line":273,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span>","key":"ADTa1KmJGh"},{"type":"text","value":", and all other elements are zero.","position":{"start":{"line":273,"column":1},"end":{"line":273,"column":1}},"key":"emL5KzXYkm"}],"key":"MXQVDDG469"},{"type":"paragraph","position":{"start":{"line":275,"column":1},"end":{"line":275,"column":1}},"children":[{"type":"strong","position":{"start":{"line":275,"column":1},"end":{"line":275,"column":1}},"children":[{"type":"text","value":"(a)","position":{"start":{"line":275,"column":1},"end":{"line":275,"column":1}},"key":"UyLBmvzafM"}],"key":"eg6yl5uAT8"},{"type":"text","value":" What is the maximum number of actors appearing in any one movie?","position":{"start":{"line":275,"column":1},"end":{"line":275,"column":1}},"key":"x0WDD92ayn"}],"key":"M83dYtbJk9"},{"type":"paragraph","position":{"start":{"line":277,"column":1},"end":{"line":277,"column":1}},"children":[{"type":"strong","position":{"start":{"line":277,"column":1},"end":{"line":277,"column":1}},"children":[{"type":"text","value":"(b)","position":{"start":{"line":277,"column":1},"end":{"line":277,"column":1}},"key":"eRWNaOG6em"}],"key":"o18giIPoqW"},{"type":"text","value":" How many actors appeared in exactly three movies?","position":{"start":{"line":277,"column":1},"end":{"line":277,"column":1}},"key":"fTJUW4iqQT"}],"key":"EWfj0Tjl7S"},{"type":"paragraph","position":{"start":{"line":279,"column":1},"end":{"line":279,"column":1}},"children":[{"type":"strong","position":{"start":{"line":279,"column":1},"end":{"line":279,"column":1}},"children":[{"type":"text","value":"(c)","position":{"start":{"line":279,"column":1},"end":{"line":279,"column":1}},"key":"ui5VQgpcYp"}],"key":"pYdAD3QN8s"},{"type":"text","value":" Define ","position":{"start":{"line":279,"column":1},"end":{"line":279,"column":1}},"key":"mjZEqUMehw"},{"type":"inlineMath","value":"\\mathbf{C}=\\mathbf{A}^T\\mathbf{A}","position":{"start":{"line":279,"column":1},"end":{"line":279,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">C</mi><mo>=</mo><msup><mi mathvariant=\"bold\">A</mi><mi>T</mi></msup><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{C}=\\mathbf{A}^T\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">C</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8413em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">A</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"OB4Q9Gkcpu"},{"type":"text","value":". How many nonzero entries does ","position":{"start":{"line":279,"column":1},"end":{"line":279,"column":1}},"key":"zoUEzsRiZa"},{"type":"inlineMath","value":"\\mathbf{C}","position":{"start":{"line":279,"column":1},"end":{"line":279,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">C</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{C}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">C</span></span></span></span>","key":"Df5oVWkxEt"},{"type":"text","value":" have? What is the interpretation of ","position":{"start":{"line":279,"column":1},"end":{"line":279,"column":1}},"key":"HdR3H1bL1M"},{"type":"inlineMath","value":"C_{ij}","position":{"start":{"line":279,"column":1},"end":{"line":279,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>C</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">C_{ij}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9694em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">ij</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span>","key":"NfrPYuA7Fw"},{"type":"text","value":"?","position":{"start":{"line":279,"column":1},"end":{"line":279,"column":1}},"key":"R4tts6FXm9"}],"key":"imgFsOqxkZ"}],"label":"problem-structure-actorsmat","identifier":"problem-structure-actorsmat","enumerated":true,"enumerator":"8.1.5","html_id":"problem-structure-actorsmat","key":"cMawiqEDIK"},{"type":"exercise","children":[{"type":"paragraph","position":{"start":{"line":287,"column":1},"end":{"line":287,"column":1}},"children":[{"type":"text","value":"⌨  A matrix that arises from the ","position":{"start":{"line":287,"column":1},"end":{"line":287,"column":1}},"key":"QUxZXsNHY9"},{"type":"link","url":"https://en.wikipedia.org/wiki/Helmholtz_equation","position":{"start":{"line":287,"column":1},"end":{"line":287,"column":1}},"children":[{"type":"text","value":"Helmholtz equation","position":{"start":{"line":287,"column":1},"end":{"line":287,"column":1}},"key":"kHfX2UUX4V"}],"urlSource":"wiki:Helmholtz_equation","data":{"page":"Helmholtz_equation","wiki":"https://en.wikipedia.org/","lang":"en"},"internal":false,"protocol":"wiki","key":"HWs9vsoqTu"},{"type":"text","value":" for wave propagation can be specified using","position":{"start":{"line":287,"column":1},"end":{"line":287,"column":1}},"key":"QtjGCBZl1M"}],"key":"VYs16acvko"},{"type":"code","lang":"julia","value":"A = FNC.poisson(n) - k^2*I;","position":{"start":{"line":289,"column":1},"end":{"line":291,"column":1}},"key":"vCgECznPuV"},{"type":"paragraph","position":{"start":{"line":292,"column":1},"end":{"line":292,"column":1}},"children":[{"type":"text","value":"where ","position":{"start":{"line":292,"column":1},"end":{"line":292,"column":1}},"key":"KgQNn7HRco"},{"type":"inlineMath","value":"k","position":{"start":{"line":292,"column":1},"end":{"line":292,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span>","key":"gqJ1el19N0"},{"type":"text","value":" is a real parameter. Let ","position":{"start":{"line":292,"column":1},"end":{"line":292,"column":1}},"key":"Pcu5865tCg"},{"type":"inlineMath","value":"n=50","position":{"start":{"line":292,"column":1},"end":{"line":292,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>=</mo><mn>50</mn></mrow><annotation encoding=\"application/x-tex\">n=50</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">50</span></span></span></span>","key":"B9niIOShH0"},{"type":"text","value":".","position":{"start":{"line":292,"column":1},"end":{"line":292,"column":1}},"key":"T9keV7I1te"}],"key":"mzb2fZDvmQ"},{"type":"paragraph","position":{"start":{"line":294,"column":1},"end":{"line":294,"column":1}},"children":[{"type":"strong","position":{"start":{"line":294,"column":1},"end":{"line":294,"column":1}},"children":[{"type":"text","value":"(a)","position":{"start":{"line":294,"column":1},"end":{"line":294,"column":1}},"key":"j87C9tnBrA"}],"key":"SYjfq4obkp"},{"type":"text","value":" Let ","position":{"start":{"line":294,"column":1},"end":{"line":294,"column":1}},"key":"ugWjZML9k8"},{"type":"inlineMath","value":"k=1","position":{"start":{"line":294,"column":1},"end":{"line":294,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">k=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"y6n3zky4dn"},{"type":"text","value":". What is the size of ","position":{"start":{"line":294,"column":1},"end":{"line":294,"column":1}},"key":"UADIYHw7tb"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":294,"column":1},"end":{"line":294,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"L2guNCNWH0"},{"type":"text","value":"? What is its density?","position":{"start":{"line":294,"column":1},"end":{"line":294,"column":1}},"key":"vH8i4rCVjr"}],"key":"jz7GQUVjEN"},{"type":"paragraph","position":{"start":{"line":296,"column":1},"end":{"line":296,"column":1}},"children":[{"type":"strong","position":{"start":{"line":296,"column":1},"end":{"line":296,"column":1}},"children":[{"type":"text","value":"(b)","position":{"start":{"line":296,"column":1},"end":{"line":296,"column":1}},"key":"qIdCccEPZ1"}],"key":"SCdxuEs21g"},{"type":"text","value":" Still with ","position":{"start":{"line":296,"column":1},"end":{"line":296,"column":1}},"key":"vb95lT3WMf"},{"type":"inlineMath","value":"k=1","position":{"start":{"line":296,"column":1},"end":{"line":296,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">k=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"H3gC0wQQWQ"},{"type":"text","value":", use ","position":{"start":{"line":296,"column":1},"end":{"line":296,"column":1}},"key":"w0lzOZE4N4"},{"type":"inlineCode","value":"eigs","position":{"start":{"line":296,"column":1},"end":{"line":296,"column":1}},"key":"gQ3Srsm5rA"},{"type":"text","value":" to find the four largest and four smallest (in magnitude) eigenvalues of ","position":{"start":{"line":296,"column":1},"end":{"line":296,"column":1}},"key":"TOYW6EinTj"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":296,"column":1},"end":{"line":296,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"X94v5Wqccg"},{"type":"text","value":". (See ","position":{"start":{"line":296,"column":1},"end":{"line":296,"column":1}},"key":"SRJtd1XF8Q"},{"type":"crossReference","identifier":"demo-structure-linalg","label":"demo-structure-linalg","kind":"proof:example","position":{"start":{"line":296,"column":130},"end":{"line":296,"column":152}},"children":[{"type":"text","value":"Example ","key":"h3YBolboeV"},{"type":"text","value":"8.1.4","key":"L3BzZgcxMk"}],"template":"Example %s","enumerator":"8.1.4","resolved":true,"html_id":"demo-structure-linalg","key":"DNeKLgMNFJ"},{"type":"text","value":" for examples.)","position":{"start":{"line":296,"column":1},"end":{"line":296,"column":1}},"key":"B6b9mMndnx"}],"key":"iLC2HiQgTY"},{"type":"paragraph","position":{"start":{"line":298,"column":1},"end":{"line":298,"column":1}},"children":[{"type":"strong","position":{"start":{"line":298,"column":1},"end":{"line":298,"column":1}},"children":[{"type":"text","value":"(c)","position":{"start":{"line":298,"column":1},"end":{"line":298,"column":1}},"key":"Gj8vviD77a"}],"key":"bXSXI5V0BY"},{"type":"text","value":" The eigenvalues are all real. Find a value of ","position":{"start":{"line":298,"column":1},"end":{"line":298,"column":1}},"key":"jFTsiNaa1l"},{"type":"inlineMath","value":"k","position":{"start":{"line":298,"column":1},"end":{"line":298,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span>","key":"dWIrePylSc"},{"type":"text","value":" so that ","position":{"start":{"line":298,"column":1},"end":{"line":298,"column":1}},"key":"qmCXZrsKQW"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":298,"column":1},"end":{"line":298,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"ygJ1GPhk70"},{"type":"text","value":" has exactly three negative eigenvalues.","position":{"start":{"line":298,"column":1},"end":{"line":298,"column":1}},"key":"AIZmZGlSqA"}],"key":"G9GAIuPnRt"}],"label":"problem-structure-helmholtz","identifier":"problem-structure-helmholtz","enumerated":true,"indexEntries":[{"entry":"Helmholtz equation","emphasis":true}],"enumerator":"8.1.6","html_id":"problem-structure-helmholtz","key":"MkDj2BUEa7"}],"key":"m22FhRbHVV"}],"key":"jnvIBQ5P9f"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"8. Krylov methods in linear algebra","url":"/overview-7","group":"Preface"},"next":{"title":"Power iteration","url":"/power","group":"Preface"}}},"domain":"http://localhost:3000"}