{"kind":"Notebook","sha256":"7b00e5e733eeed1f13e30cc81a66684bb59002a14438beb69c474ccf2f5e79ec","slug":"cholesky","location":"/chapter2/section9/julia/cholesky.ipynb","dependencies":[],"frontmatter":{"numbering":{"heading_1":{"enabled":false},"heading_2":{"enabled":false},"heading_3":{"enabled":false},"heading_4":{"enabled":false},"heading_5":{"enabled":false},"heading_6":{"enabled":false}},"kernelspec":{"name":"julia-1.11","display_name":"Julia 1","language":"julia"},"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"exports":[{"format":"ipynb","filename":"cholesky.ipynb","url":"/build/cholesky-cf3b61389e124a0ed806bd2622c332ae.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-05T09:36:23.210000Z","iopub.status.busy":"2025-01-05T09:36:22.921000Z","iopub.status.idle":"2025-01-05T09:36:30.323000Z","shell.execute_reply":"2025-01-05T09:36:30.278000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"include(\"../../../julia/FNC_init.jl\")","key":"ljSKlYdPbm"},{"type":"output","id":"uDwCAojpcpD9CkHMI8GTe","data":[{"name":"stderr","output_type":"stream","text":"\u001b[32m\u001b[1m  Activating\u001b[22m\u001b[39m "},{"name":"stderr","output_type":"stream","text":"project at `~/Documents/GitHub/fnc`\n"}],"key":"HCaudoS6zH"}],"key":"VWmcFUnqSa"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"Hk3lbislud"},{"type":"text","value":"2.9.3","key":"lRxiAtoNLx"}],"key":"DE5WZNrABn"}],"identifier":"demo-structure-cholesky","label":"demo-structure-cholesky","kind":"proof:example","template":"Example %s","enumerator":"2.9.3","resolved":true,"html_id":"demo-structure-cholesky","remote":true,"url":"/structure","dataUrl":"/structure.json","key":"w6R7GlGFNI"}],"key":"lB3sFNC4VA"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"A randomly chosen matrix is extremely unlikely to be symmetric. However, there is a simple way to symmetrize one.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"GXQvSWqMGq"}],"key":"aO5nj1Ef8E"}],"key":"hdl9xpjR66"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-05T09:36:30.474000Z","iopub.status.busy":"2025-01-05T09:36:30.325000Z","iopub.status.idle":"2025-01-05T09:36:31.846000Z","shell.execute_reply":"2025-01-05T09:36:31.846000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"A = rand(1.0:9.0, 4, 4)\nB = A + A'","key":"X78r7QPlf3"},{"type":"output","id":"0RY89oEq6XF4QNaFclilG","data":[{"output_type":"execute_result","execution_count":2,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n  8.0  10.0  17.0  13.0\n 10.0  16.0   9.0  10.0\n 17.0   9.0   2.0   9.0\n 13.0  10.0   9.0  18.0","content_type":"text/plain"}}}],"key":"a79fCSBGEZ"}],"key":"AV7bGbWUao"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Similarly, a random symmetric matrix is unlikely to be positive definite. The Cholesky algorithm always detects a non-PD matrix by quitting with an error.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"z5Jd6F0I5E"}],"indexEntries":[{"entry":"Julia","subEntry":{"value":"cholesky","kind":"entry"},"emphasis":true}],"label":"index-WmId3GEMBT","identifier":"index-wmid3gembt","html_id":"index-wmid3gembt","key":"HAoA4Fq2za"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"skDGkI4o0p"}],"key":"Anmb3UvToA"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"gWx1Hl4cZb"},{"type":"inlineCode","value":"cholesky","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"YpZXCxKq7b"},{"type":"text","value":" function computes a Cholesky factorization if possible, or throws an error for a non-positive-definite matrix. However, it does ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"TnDGcpMbfJ"},{"type":"emphasis","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"not","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"rMktkmdJmn"}],"key":"ZFj3yVWnrS"},{"type":"text","value":" check for symmetry.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"PNOfiNwoCW"}],"key":"zegM6xc2Pa"}],"class":"dropdown","key":"sP82UIYxyN"}],"key":"vhAm3USpdt"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-05T09:36:31.848000Z","iopub.status.busy":"2025-01-05T09:36:31.848000Z","iopub.status.idle":"2025-01-05T09:36:32.866000Z","shell.execute_reply":"2025-01-05T09:36:32.865000Z"},"tags":["raises-exception"]},"children":[{"type":"code","lang":"julia","executable":true,"value":"cholesky(B)    # throws an error","visibility":"show","key":"kWJ8OkezUZ"},{"type":"output","id":"-4dMbea6C8T0Six3z5Cwu","data":[{"ename":"LoadError","evalue":"PosDefException: matrix is not positive definite; Factorization failed.","output_type":"error","traceback":"PosDefException: matrix is not positive definite; Factorization failed.\n\nStacktrace:\n  [1] checkpositivedefinite\n    @ ~/.julia/juliaup/julia-1.11.2+0.aarch64.apple.darwin14/share/julia/stdlib/v1.11/LinearAlgebra/src/factorization.jl:68 [inlined]\n  [2] #cholesky!#163\n    @ ~/.julia/juliaup/julia-1.11.2+0.aarch64.apple.darwin14/share/julia/stdlib/v1.11/LinearAlgebra/src/cholesky.jl:269 [inlined]\n  [3] cholesky!\n    @ ~/.julia/juliaup/julia-1.11.2+0.aarch64.apple.darwin14/share/julia/stdlib/v1.11/LinearAlgebra/src/cholesky.jl:267 [inlined]\n  [4] #cholesky!#164\n    @ ~/.julia/juliaup/julia-1.11.2+0.aarch64.apple.darwin14/share/julia/stdlib/v1.11/LinearAlgebra/src/cholesky.jl:301 [inlined]\n  [5] cholesky! (repeats 2 times)\n    @ ~/.julia/juliaup/julia-1.11.2+0.aarch64.apple.darwin14/share/julia/stdlib/v1.11/LinearAlgebra/src/cholesky.jl:295 [inlined]\n  [6] _cholesky\n    @ ~/.julia/juliaup/julia-1.11.2+0.aarch64.apple.darwin14/share/julia/stdlib/v1.11/LinearAlgebra/src/cholesky.jl:411 [inlined]\n  [7] cholesky(A::Matrix{Float64}, ::NoPivot; check::Bool)\n    @ LinearAlgebra ~/.julia/juliaup/julia-1.11.2+0.aarch64.apple.darwin14/share/julia/stdlib/v1.11/LinearAlgebra/src/cholesky.jl:401\n  [8] cholesky\n    @ ~/.julia/juliaup/julia-1.11.2+0.aarch64.apple.darwin14/share/julia/stdlib/v1.11/LinearAlgebra/src/cholesky.jl:401 [inlined]\n  [9] cholesky(A::Matrix{Float64})\n    @ LinearAlgebra ~/.julia/juliaup/julia-1.11.2+0.aarch64.apple.darwin14/share/julia/stdlib/v1.11/LinearAlgebra/src/cholesky.jl:401\n [10] top-level scope\n    @ In[3]:1"}],"visibility":"show","key":"Nuh6FOywUF"}],"visibility":"show","key":"czsf8YFjHO"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"It’s not hard to manufacture an ","key":"JVJRVkhNog"},{"type":"abbreviation","title":"symmetric positive definite","children":[{"type":"text","value":"SPD","key":"g682rd0Is3"}],"key":"eI8LQdm6cX"},{"type":"text","value":" matrix to try out the Cholesky factorization.","key":"TmhBrmcPDX"}],"key":"MFcndPHqNB"}],"key":"U1elqJl54s"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-05T09:36:32.867000Z","iopub.status.busy":"2025-01-05T09:36:32.867000Z","iopub.status.idle":"2025-01-05T09:36:33.178000Z","shell.execute_reply":"2025-01-05T09:36:33.177000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"B = A' * A\ncf = cholesky(B)","key":"SIHZNLdGQp"},{"type":"output","id":"f_wbT1yj0K_n8PW2LqvlV","data":[{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"text/plain":{"content":"Cholesky{Float64, Matrix{Float64}}\nU factor:\n4×4 UpperTriangular{Float64, Matrix{Float64}}:\n 14.6287  7.45109  6.08391  14.6287\n   ⋅      6.4406   5.07223   2.48424\n   ⋅       ⋅       5.59092   0.0714277\n   ⋅       ⋅        ⋅        2.61217","content_type":"text/plain"}}}],"key":"VUXHAk50OD"}],"key":"nkN1JBlVI4"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"What’s returned is a factorization object. Another step is required to extract the factor as a matrix:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UCjfzoFtar"}],"key":"z0hZ8bp6ni"}],"key":"U1hc5OUw9t"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-05T09:36:33.179000Z","iopub.status.busy":"2025-01-05T09:36:33.179000Z","iopub.status.idle":"2025-01-05T09:36:33.243000Z","shell.execute_reply":"2025-01-05T09:36:33.243000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"R = cf.U","key":"sjxs1lGFlD"},{"type":"output","id":"PwlYdaQndo-nfTZfLWlm3","data":[{"output_type":"execute_result","execution_count":5,"metadata":{},"data":{"text/plain":{"content":"4×4 UpperTriangular{Float64, Matrix{Float64}}:\n 14.6287  7.45109  6.08391  14.6287\n   ⋅      6.4406   5.07223   2.48424\n   ⋅       ⋅       5.59092   0.0714277\n   ⋅       ⋅        ⋅        2.61217","content_type":"text/plain"}}}],"key":"OouOAKhSjz"}],"key":"niZqe6dbSs"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Here we validate the factorization:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"oifGLfQjhN"}],"key":"awxJtBfny8"}],"key":"jxftgsyEbl"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-05T09:36:33.245000Z","iopub.status.busy":"2025-01-05T09:36:33.245000Z","iopub.status.idle":"2025-01-05T09:36:33.375000Z","shell.execute_reply":"2025-01-05T09:36:33.374000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"opnorm(R' * R - B) / opnorm(B)","key":"GY9vIP7atx"},{"type":"output","id":"nlllKeDLNx4kyJEfPNoyN","data":[{"output_type":"execute_result","execution_count":6,"metadata":{},"data":{"text/plain":{"content":"5.73189211910541e-17","content_type":"text/plain"}}}],"key":"oQOJIRof0M"}],"key":"rt7ZVvWI0x"}],"key":"DzDLc13qZ7"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Symm","url":"/symm","group":"Chapter 2"},"next":{"title":"Tempinterp","url":"/tempinterp","group":"Chapter 3"}}},"domain":"http://localhost:3000"}