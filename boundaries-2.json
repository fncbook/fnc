{"kind":"Notebook","sha256":"2bd4b1fbf01debe4d2e9603422f41aa093f8b1485693c6f510a56f90157a4303","slug":"boundaries-2","location":"/chapter12/section4/matlab/boundaries.ipynb","dependencies":[],"frontmatter":{"numbering":{"heading_1":{"enabled":false},"heading_2":{"enabled":false},"heading_3":{"enabled":false},"heading_4":{"enabled":false},"heading_5":{"enabled":false},"heading_6":{"enabled":false}},"kernelspec":{"name":"jupyter_matlab_kernel","display_name":"MATLAB Kernel","language":"matlab"},"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"exports":[{"format":"ipynb","filename":"boundaries.ipynb","url":"/build/boundaries-883e7ad078c7191bb4f4939f2f0ddaa9.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"sQg2Xgm7VO"},{"type":"text","value":"12.4.1","key":"kctHLNBBcZ"}],"key":"NZq1qtyiLG"}],"identifier":"demo-wave-boundaries","label":"demo-wave-boundaries","kind":"proof:example","template":"ExampleÂ %s","enumerator":"12.4.1","resolved":true,"html_id":"demo-wave-boundaries","remote":true,"url":"/wave","dataUrl":"/wave.json","key":"UDjDvy8HHQ"}],"key":"DhIE8mBkp6"}],"key":"ONGSPYTeu8"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"c = 2;  m = 200;\n[x, Dx] = diffcheb(m, [-1, 1]);","key":"C37cKAfh2D"},{"type":"output","id":"C4WUZ1epYrAu5cFAjbd0r","data":[],"key":"fBe7TX9wzm"}],"key":"KXbwqdFqzp"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The boundary values of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MVG2WTDpLw"},{"type":"inlineMath","value":"u","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span>","key":"tmwOu2ieCZ"},{"type":"text","value":" are given to be zero, so they are not unknowns in the ","key":"TESDisSGXE"},{"type":"abbreviation","title":"ordinary differential equation","children":[{"type":"text","value":"ODE","key":"wnYxylREJ3"}],"key":"hSlLlsDEnY"},{"type":"text","value":"s. Instead they are added or removed as necessary.","key":"kr6QP3xx4K"}],"key":"FsHvmtO3E7"}],"key":"w4LAG0vFqn"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"chop = @(u) u(2:m);\nextend = @(v) [0; v; 0];","key":"kti8oesyTg"},{"type":"output","id":"rLiMPkeFv8Q2eCGmEGh4C","data":[],"key":"QuIwI4RY4a"}],"key":"nr9i7R8c3Z"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The following function computes the time derivative of the system at interior points.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KunPaZbLD6"}],"key":"aqVwMWxmK2"},{"type":"include","file":"f124wave.m","literal":true,"filter":{},"children":[{"type":"code","value":"function dw_dt = wave(t, w, param)\n    [c, m, Dx, chop, extend] = param{:};\n    u = extend(w(1:m-1));\n    z = w(m:2*m);\n    du_dt = Dx * z;\n    dz_dt = c.^2 .* (Dx * u);\n    dw_dt = [ chop(du_dt); dz_dt ];\nend","lang":"m","filename":"f124wave.m","key":"bNBXB4HHA9"}],"key":"SXtmbjYckf"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Our initial condition is a single hump for ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"LUdThFhQ16"},{"type":"inlineMath","value":"u","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span>","key":"HKbPzeiCdW"},{"type":"text","value":".","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"vfYdkpcskQ"}],"key":"Gb3bRzbYpm"}],"key":"NHhCNXFBo4"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"u_init = exp( -100*x.^2 );\nz_init = -u_init;\nw_init = [ chop(u_init); z_init ];  ","key":"c2NUFJJIP1"},{"type":"output","id":"n909V_uZxD1xdayp99DO7","data":[],"key":"TIVzKjSMhP"}],"key":"TbaqswnucY"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Because the wave equation is hyperbolic, we can use a nonstiff explicit solver.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ViFH4aISyC"}],"key":"V8MpWfgOWr"}],"key":"xFj7UmyntF"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"ivp = ode(ODEFcn=@f124wave);\nivp.InitialTime = 0;\nivp.InitialValue = w_init;\nivp.RelativeTolerance = 1e-4;\nivp.Parameters = {c, m, Dx, chop, extend};\nt = linspace(0, 2, 101);\nsol = solve(ivp, t);","key":"Q1roJA6hyG"},{"type":"output","id":"4tbOu5ANEj5h-cQHzOLxZ","data":[],"key":"Dv2hcFyYH5"}],"key":"ZUkxcyjtIh"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We plot the results for the original ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"uEOXLGmGBL"},{"type":"inlineMath","value":"u","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span>","key":"YdJOo27JFr"},{"type":"text","value":" variable only. Its interior values are at indices ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"k2YY1pCjoS"},{"type":"inlineCode","value":"1:m-1","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YGyQjtE70M"},{"type":"text","value":" of the composite ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"v4kvD2vAyl"},{"type":"inlineMath","value":"\\mathbf{w}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">w</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{w}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4444em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">w</span></span></span></span>","key":"d6DIsIfd8z"},{"type":"text","value":" variable.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"G3qBvzfNdu"}],"key":"HDbHNiOJ07"}],"key":"M2ItIXX2Ip"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"W = sol.Solution;\nn = length(t)-1;\nU = [ zeros(1, n+1); W(1:m-1, :); zeros(1, n+1) ];\n\ncmap = zeros(256, 3);\ncmap(129:end, 1) = 2/3;\ncmap(1:128, 2) = linspace(1, 0, 128);\ncmap(129:256, 2) = linspace(0, 1, 128);\ncmap(1:128, 3) = linspace(1, 0.5, 128);\ncmap(129:256, 3) = linspace(0.5, 1, 128);\ncmap = hsv2rgb(cmap);\n\nclf,  contour(x, t, U', 24, linewidth=2)\ncolormap(cmap),  clim([-1, 1])\nxlabel x,  ylabel t\ntitle(\"Wave equation with boundaries\")","key":"jJ84mNkQOo"},{"type":"output","id":"EJRqsIcMxbaECVjOFyAlS","data":[{"output_type":"execute_result","execution_count":6,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"5cad761554d3f97116e0ea4e15d55713","path":"/build/5cad761554d3f97116e0ea4e15d55713.png"}}}],"key":"BAv7hEBRHa"}],"key":"hEIydNzUeI"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"matlab","executable":true,"value":"clf\nplot(x, U(:, 1))\nhold on\naxis([-1, 1, -1.05, 1.05])\ntitle(\"Wave equation with boundaries\") \nxlabel('x'),  ylabel('u(x,t)')\nvid = VideoWriter(\"figures/wave-boundaries.mp4\", \"MPEG-4\");\nvid.Quality = 85;\nopen(vid);\nfor frame = 1:length(t)\n    cla, plot(x, U(:, frame))\n    str = sprintf(\"t = %.2f\", t(frame));\n    text(-0.92, 0.85, str, fontsize=16);\n    writeVideo(vid, frame2im(getframe(gcf)));\nend\nclose(vid)\nclose(gcf)","visibility":"hide","key":"XhFXRbnMHu"},{"type":"output","id":"gVvfBalP8rg4NphXIoOIL","data":[],"visibility":"remove","key":"lkTKglrtEN"}],"visibility":"show","key":"FgKpfOOL3C"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The original hump breaks into two pieces of different amplitudes, each traveling with speed ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LZihBappaq"},{"type":"inlineMath","value":"c=2","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>c</mi><mo>=</mo><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">c=2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">c</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span></span></span></span>","key":"jBFCixEDxK"},{"type":"text","value":". They pass through one another without interference. When a hump encounters a boundary, it is perfectly reflected, but with inverted shape. At time ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Exaimw5sv9"},{"type":"inlineMath","value":"t=2","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi><mo>=</mo><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">t=2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span></span></span></span>","key":"Er3BlnBqIt"},{"type":"text","value":", the solution looks just like the initial condition.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dDSckzVRWE"}],"key":"pqeYy3rKVl"}],"key":"zW6fCBvICi"}],"key":"NUqpJ7Jopa"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Inflow","url":"/inflow-1","group":"Chapter 12"},"next":{"title":"Speed","url":"/speed-1","group":"Chapter 12"}}},"domain":"http://localhost:3000"}