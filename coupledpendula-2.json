{"kind":"Notebook","sha256":"31e332652c11c2afcdca60ebffb705804f3673f57e366ba3c4b1dab541714eec","slug":"coupledpendula-2","location":"/chapter6/section3/python/coupledpendula.ipynb","dependencies":[],"frontmatter":{"numbering":{"heading_1":{"enabled":false},"heading_2":{"enabled":false},"heading_3":{"enabled":false},"heading_4":{"enabled":false},"heading_5":{"enabled":false},"heading_6":{"enabled":false}},"kernelspec":{"name":"python3","display_name":"myst","language":"python"},"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"exports":[{"format":"ipynb","filename":"coupledpendula.ipynb","url":"/fnc/build/coupledpendula-b47e4cb5cc747f0cfb2234da91f677c2.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"exec(open(\"../../../python/FNC_init.py\").read())","visibility":"show","key":"MbhIxaGrxC"},{"type":"output","id":"u7mMbEblMt1qBxaeOyo8q","data":[],"visibility":"show","key":"I7IN1zCHC8"}],"visibility":"remove","key":"fP9falBDPI"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"q6o4fIDQ0P"},{"type":"text","value":"6.3.5","key":"OZok4QiRdl"}],"key":"BgE5AhnON8"}],"identifier":"demo-systems-coupledpendula","label":"demo-systems-coupledpendula","kind":"proof:example","template":"Example %s","enumerator":"6.3.5","resolved":true,"html_id":"demo-systems-coupledpendula","remote":true,"url":"/systems","dataUrl":"/systems.json","key":"iFC1DDOdB0"}],"key":"bpTpFWuo9b"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Let’s implement the coupled pendulums from ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"o5iFhIX3ux"},{"type":"crossReference","kind":"proof:example","identifier":"example-systems-coupledpendula","label":"example-systems-coupledpendula","children":[{"type":"text","value":"Example ","key":"XEuudKX9iZ"},{"type":"text","value":"6.3.4","key":"u9WsjiAchs"}],"template":"Example %s","enumerator":"6.3.4","resolved":true,"html_id":"example-systems-coupledpendula","remote":true,"url":"/systems","dataUrl":"/systems.json","key":"gni7IEf9U2"},{"type":"text","value":". The pendulums will be pulled in opposite directions and then released together from rest.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"MwoVE4cgFQ"}],"key":"twdloErxvE"}],"key":"nbZ2SyFF9D"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"def couple(t, u, params):\n    gamma, L, k = params\n    g = 9.8\n    udot = copy(u)\n    udot[:2] = u[2:4]\n    udot[2] = -gamma * u[2] - (g / L) * sin(u[0]) + k * (u[1] - u[0])\n    udot[3] = -gamma * u[3] - (g / L) * sin(u[1]) + k * (u[0] - u[1])\n    return udot\n\nu0 = array([1.25, -0.5, 0, 0])\ntspan = [0.0, 50.0]","key":"UTOQoT7d6W"},{"type":"output","id":"jY4tG2GB0H90Q9Gw3HEvC","data":[],"key":"vOZEmTC1Tj"}],"key":"nPY6Oattxz"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"First we check the behavior of the system when the pendulums are uncoupled, i.e., when ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PDdRr2NuBG"},{"type":"inlineMath","value":"k=0","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">k=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"EgHAH2AXoU"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"gzYSAj0mNr"}],"key":"FVybnnrsHc"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"foWYpn15rL"}],"key":"bWF2gw0gGJ"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"We use a closure here to pass the fixed parameter values into ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"uZtiGsfAdx"},{"type":"inlineCode","value":"couple","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"dWJCVZeYiJ"},{"type":"text","value":".","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"anDDV04Hza"}],"key":"VdJYcnFD9k"}],"class":"dropdown","key":"WFmDpEO6id"}],"key":"zd96o4rX3T"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"from scipy.integrate import solve_ivp\ngamma, L, k = 0.01, 0.5, 0.0\ndu_dt = lambda t, u: couple(t, u, (gamma, L, k))\nsol = solve_ivp(du_dt, tspan, u0, t_eval=linspace(0, 50, 1000))\nplot(sol.t, sol.y[:2, :].T)    # first two components of solution\nxlabel(\"t\"), ylabel(\"angle\")\ntitle(\"Uncoupled pendulums\");","key":"nM3ZK73KFj"},{"type":"output","id":"pBnBq1e70TcXtxq23V_-J","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"25f23eeccdbebf72f89d5dce5c2a7b96","path":"/fnc/build/25f23eeccdbebf72f89d5dce5c2a7b96.png"},"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"}}}],"key":"KPf81m28TP"}],"key":"t2kx5esRpZ"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"You can see that the pendulums swing independently. Because the model is nonlinear and the initial angles are not small, they have slightly different periods of oscillation, and they go in and out of phase.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xqCOBBtw2H"}],"key":"RDtHwWNeRU"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"With coupling activated, a different behavior is seen.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"KuX2pvhWRm"}],"key":"e0OaiNLemh"}],"key":"elg6Tj85Cu"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"k = 0.75    # changes the value in the du_dt closure\nsol = solve_ivp(du_dt, tspan, u0, t_eval=linspace(0, 50, 1000))\nplot(sol.t, sol.y[:2, :].T)\nxlabel(\"t\"), ylabel(\"angle\")\ntitle(\"Coupled pendulums\");","key":"Na9p8ZBQRs"},{"type":"output","id":"nEySBbeUJFl6XAAf-IKfQ","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"ec445e39a7dd507b8a9483634d85fd51","path":"/fnc/build/ec445e39a7dd507b8a9483634d85fd51.png"},"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"}}}],"key":"W1RrRHzp4q"}],"key":"rSbxHKJXvG"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The coupling makes the pendulums swap energy back and forth.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"X0XTEoAc7g"}],"key":"mIlpAcUfDh"}],"key":"U19iptG7Nz"}],"key":"AcBhQv01tL"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Predator","url":"/predator-2","group":"Chapter 6"},"next":{"title":"Converge","url":"/converge-27","group":"Chapter 6"}}},"domain":"http://localhost:3000"}