{"kind":"Notebook","sha256":"b2701839fb23e73fc0774ea7999b099d7a5d6734f0521322f11f487789ef62d9","slug":"coupledpendula-1","location":"/chapter6/section3/matlab/coupledpendula.ipynb","dependencies":[],"frontmatter":{"numbering":{"heading_1":{"enabled":false},"heading_2":{"enabled":false},"heading_3":{"enabled":false},"heading_4":{"enabled":false},"heading_5":{"enabled":false},"heading_6":{"enabled":false}},"kernelspec":{"name":"jupyter_matlab_kernel","display_name":"MATLAB Kernel","language":"matlab"},"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"exports":[{"format":"ipynb","filename":"coupledpendula.ipynb","url":"/build/coupledpendula-92b0154f7760a1c3349fc32d8b1ca30a.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"jwhn1mA4dG"},{"type":"text","value":"6.3.5","key":"Y2L75P5HSb"}],"key":"OsJi1v2J43"}],"identifier":"demo-systems-coupledpendula","label":"demo-systems-coupledpendula","kind":"proof:example","template":"Example %s","enumerator":"6.3.5","resolved":true,"html_id":"demo-systems-coupledpendula","remote":true,"url":"/systems","dataUrl":"/systems.json","key":"JCnSKFUwly"}],"key":"T7gwpaWU90"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Let’s implement the coupled pendulums from ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"GuTN8KpjdN"},{"type":"crossReference","kind":"proof:example","identifier":"example-systems-coupledpendula","label":"example-systems-coupledpendula","children":[{"type":"text","value":"Example ","key":"FFR8lYmyP3"},{"type":"text","value":"6.3.4","key":"NRez6ajNjM"}],"template":"Example %s","enumerator":"6.3.4","resolved":true,"html_id":"example-systems-coupledpendula","remote":true,"url":"/systems","dataUrl":"/systems.json","key":"HIeAw3px8r"},{"type":"text","value":". The pendulums will be pulled in opposite directions and then released together from rest.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"SCOUqTWdvP"}],"key":"M7Ez5XuzZ0"},{"type":"include","file":"f63_pendulums.m","literal":true,"filter":{},"children":[{"type":"code","value":"function udot = pendulums(t, u, p)\n    gamma = p(1);  L = p(2);  k = p(3);\n    g = 9.8;\n    udot = zeros(4, 1);\n    udot(1:2) = u(3:4);\n    udot(3) = -gamma * u(3) - (g / L) * sin(u(1)) + k * (u(2) - u(1));\n    udot(4) = -gamma * u(4) - (g / L) * sin(u(2)) + k * (u(1) - u(2));\nend\n","lang":"matlab","filename":"f63_pendulums.m","key":"TxVqXJwxyv"}],"key":"kHwAi3DTHI"}],"key":"YWSu67hvCt"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"u0 = [1.25; -0.5; 0; 0];\na = 0; b = 50;","key":"hqI1Z9QVKU"},{"type":"output","id":"Xu_Qhouf01wfxxivxbhwr","data":[],"key":"Xg8e8uSLjw"}],"key":"s3n7qfKwgA"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"First we check the behavior of the system when the pendulums are uncoupled, i.e., when ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"oQVfEtRSnu"},{"type":"inlineMath","value":"k=0","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">k=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"nu08L2O4Uf"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"BZ7RLN0tF5"}],"key":"YBdEnU7it0"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"bWWFLg2ijh"}],"key":"mxetbwmTEN"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Here ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"zLSa8Lg5Mo"},{"type":"inlineCode","value":"OutputVariables","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"X06LU9NifI"},{"type":"text","value":" is used to restrict output to just ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"OLxpsAej0Y"},{"type":"inlineMath","value":"u_1","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>u</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">u_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"JLhyjUOnui"},{"type":"text","value":" and ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"FXZ0LcOXyg"},{"type":"inlineMath","value":"u_2","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>u</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">u_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"g8bGGzOmEd"},{"type":"text","value":".","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"KS0Fhl6kYi"}],"key":"Q94Vf65iii"}],"class":"dropdown","key":"ssC8QpFZ5f"}],"key":"M7gbQOdJJA"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"params =[0.01, 0.5, 0];    % gamma, L, k\nivp = ode(ODEFcn=@f63_pendulums, InitialValue=u0, Parameters=params);\ntheta = solutionFcn(ivp, a, b, OutputVariables = 1:2);\nt = linspace(a, b, 1001);\nclf, plot(t, theta(t))\nxlabel(\"t\");  ylabel(\"angle\")\ntitle(\"Uncoupled pendulums\")\nlegend(\"\\theta_1\", \"\\theta_2\");","key":"aXJanduVC4"},{"type":"output","id":"ioDnweL31VDjZkp5kPO8j","data":[{"output_type":"execute_result","execution_count":51,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"cfa833596861af85a41eefb7f16ab208","path":"/build/cfa833596861af85a41eefb7f16ab208.png"}}}],"key":"fTG3YbsXd3"}],"key":"bKJY3acTQ8"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"You can see that the pendulums swing independently. Because the model is nonlinear and the initial angles are not small, they have slightly different periods of oscillation, and they go in and out of phase.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mBLnyap91s"}],"key":"egkjcQ8C87"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"With coupling activated, a different behavior is seen.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"GJWhMz9GfH"}],"key":"K8hF0G8yT8"}],"key":"KViZ4835wm"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"params(3) = 1;\nivp = ode(ODEFcn=@f63_pendulums, InitialValue=u0, Parameters=params);\ntheta = solutionFcn(ivp, a, b, OutputVariables = 1:2);\nclf, plot(t, theta(t))\nxlabel(\"t\");  ylabel(\"angle\")\ntitle(\"Coupled pendulums\")\nlegend(\"\\theta_1\", \"\\theta_2\");","key":"ywjyhFoaHM"},{"type":"output","id":"InNlMZ3yDrjBAtmaGldcK","data":[{"output_type":"execute_result","execution_count":52,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"1a26bb63993fe1eab7099bde4e96a60f","path":"/build/1a26bb63993fe1eab7099bde4e96a60f.png"}}}],"key":"I9QjNGDRCC"}],"key":"YfVXD1JkeN"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The coupling makes the pendulums swap energy back and forth.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"N1YhC1eCnJ"}],"key":"xWJEjoHvMP"}],"key":"ZgofTaQZj6"}],"key":"JuRWkR4eGz"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Predator","url":"/predator-1","group":"Chapter 6"},"next":{"title":"Converge","url":"/converge-17","group":"Chapter 6"}}},"domain":"http://localhost:3000"}