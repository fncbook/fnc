{"kind":"Notebook","sha256":"16da90bdff7a676806d78753dc17a0bf8bc436a91e439333131d67e11d6cc204","slug":"linalg-1","location":"/chapter8/section1/matlab/linalg.ipynb","dependencies":[],"frontmatter":{"numbering":{"heading_1":{"enabled":false},"heading_2":{"enabled":false},"heading_3":{"enabled":false},"heading_4":{"enabled":false},"heading_5":{"enabled":false},"heading_6":{"enabled":false}},"kernelspec":{"name":"jupyter_matlab_kernel","display_name":"MATLAB Kernel","language":"matlab"},"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"exports":[{"format":"ipynb","filename":"linalg.ipynb","url":"/build/linalg-ec8c34def9462a6518d0c200a9a98b96.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"u1eLJn5uh5"},{"type":"text","value":"8.1.4","key":"A8Xjs5J87l"}],"key":"uegWlXxilz"}],"identifier":"demo-structure-linalg","label":"demo-structure-linalg","kind":"proof:example","template":"Example %s","enumerator":"8.1.4","resolved":true,"html_id":"demo-structure-linalg","remote":true,"url":"/structure-1","dataUrl":"/structure-1.json","key":"Upjy05fmWq"}],"key":"QrR7AAGfcg"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"The following generates a random sparse matrix with prescribed eigenvalues.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"k0YQ3aq5Rt"}],"key":"A42ufVR6T2"}],"key":"P6MdcYwax8"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"n = 4000;\ndensity = 4e-4;\nlambda = 1 ./ (1:n);\nA = sprandsym(n, density, lambda);\nclf,  spy(A)\ntitle('Sparse symmetric matrix')  ","key":"oG1PF6Y0ge"},{"type":"output","id":"zIpk1RRdRjn4o1JJWN1pR","data":[{"output_type":"execute_result","execution_count":2,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"2ba98b9f0e2a368c4576e744819230eb","path":"/build/2ba98b9f0e2a368c4576e744819230eb.png"}}}],"key":"vaz5Rd1gY6"}],"key":"oPQuZhKmEz"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"aJ02dVj09P"},{"type":"inlineCode","value":"eigs","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"e6aYq0rJlB"},{"type":"text","value":" function finds a small number eigenvalues meeting some criterion. First, we ask for the 5 of largest (complex) magnitude.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"rnKOZ16l5W"}],"indexEntries":[{"entry":"MATLAB","subEntry":{"value":"eigs","kind":"entry"},"emphasis":true}],"label":"index-IGoUaLADrF","identifier":"index-igoualadrf","html_id":"index-igoualadrf","key":"jemXiLf102"}],"key":"n54muqh0BV"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"[V, D] = eigs(A, 5);    % largest magnitude\n1 ./ diag(D)            % should be 1, 2, 3, 4, 5","key":"OAFr48usLi"},{"type":"output","id":"vsQUyUJWMsxI9KLIeppXn","data":[{"output_type":"execute_result","execution_count":3,"metadata":{},"data":{"text/plain":{"content":"ans = 5×1 double\n    1.0000\n    2.0000\n    3.0000\n    4.0000\n    5.0000\n","content_type":"text/plain"},"text/html":{"content":"<html><body><pre>ans = 5×1 double\n    1.0000\n    2.0000\n    3.0000\n    4.0000\n    5.0000\n</pre></body></html>","content_type":"text/html"}}}],"key":"eRtYEDH9Xc"}],"key":"VaFtgA3TDA"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now we find the 4 closest to the value 0.03 in the complex plane.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zMtKLYvJGQ"}],"key":"caqAKx0dJn"}],"key":"NWlv2JFSm7"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"[V, D] = eigs(A, 4, 0.03);    % closest to 0.03\ndiag(D)","key":"BwjW4AuInX"},{"type":"output","id":"xMHn35fdRTplwoQ3zc2HY","data":[{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"text/plain":{"content":"ans = 4×1 double\n    0.0303\n    0.0294\n    0.0312\n    0.0286\n","content_type":"text/plain"},"text/html":{"content":"<html><body><pre>ans = 4×1 double\n    0.0303\n    0.0294\n    0.0312\n    0.0286\n</pre></body></html>","content_type":"text/html"}}}],"key":"W1QXeE1qgH"}],"key":"WTQPtDJqsJ"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"The time needed to solve a sparse linear system is not easy to predict unless you have some more information about the matrix. But it will typically be orders of magnitude faster than the dense version of the same problem.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"RkeoJzoITU"}],"indexEntries":[{"entry":"MATLAB","subEntry":{"value":"\\\\","kind":"entry"},"emphasis":false}],"label":"index-zdarOrU9xS","identifier":"index-zdaroru9xs","html_id":"index-zdaroru9xs","key":"ReWmFFApom"}],"key":"ptyJxfDHtZ"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"x = 1 ./ (1:n)';  \nb = A * x;\ntic, sparse_err = norm(x - A\\b), sparse_time = toc","key":"zRmIiVmeZK"},{"type":"output","id":"8eYfvEBoc6jo4Cw_ui8BL","data":[{"output_type":"execute_result","execution_count":5,"metadata":{},"data":{"text/plain":{"content":"sparse_err = 1.0980e-13","content_type":"text/plain"},"text/html":{"content":"<html><body><pre>sparse_err = 1.0980e-13</pre></body></html>","content_type":"text/html"}}},{"output_type":"execute_result","execution_count":5,"metadata":{},"data":{"text/plain":{"content":"sparse_time = 0.0073","content_type":"text/plain"},"text/html":{"content":"<html><body><pre>sparse_time = 0.0073</pre></body></html>","content_type":"text/html"}}}],"key":"AkQWCpPhrn"}],"key":"h1apWjeO3x"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"F = full(A);\ntic, dense_err = norm(x - F\\b), dense_time = toc","key":"LNf5TWft8Q"},{"type":"output","id":"ZV05CJf5Oc0JNTl03hqV3","data":[{"output_type":"execute_result","execution_count":6,"metadata":{},"data":{"text/plain":{"content":"dense_err = 1.0982e-13","content_type":"text/plain"},"text/html":{"content":"<html><body><pre>dense_err = 1.0982e-13</pre></body></html>","content_type":"text/html"}}},{"output_type":"execute_result","execution_count":6,"metadata":{},"data":{"text/plain":{"content":"dense_time = 0.2560","content_type":"text/plain"},"text/html":{"content":"<html><body><pre>dense_time = 0.2560</pre></body></html>","content_type":"text/html"}}}],"key":"T9jhnZ2MZY"}],"key":"YoKNypwGZu"}],"key":"nVi6WgQID3"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Sparseband","url":"/sparseband-1","group":"Chapter 8"},"next":{"title":"One","url":"/one-1","group":"Chapter 8"}}},"domain":"http://localhost:3000"}