{"kind":"Notebook","sha256":"79878a8d124570c84c1d311479916617cd4e130c0c73000a569ff5187b400d33","slug":"compare","location":"/chapter9/section6/julia/compare.ipynb","dependencies":[],"frontmatter":{"numbering":{"heading_1":{"enabled":false},"heading_2":{"enabled":false},"heading_3":{"enabled":false},"heading_4":{"enabled":false},"heading_5":{"enabled":false},"heading_6":{"enabled":false}},"kernelspec":{"name":"julia-1.11","display_name":"Julia 1","language":"julia"},"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"exports":[{"format":"ipynb","filename":"compare.ipynb","url":"/build/compare-aad7e539d9379f84c3401236eee5326e.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"Qmlc9PJ6ve"},{"type":"text","value":"9.6.3","key":"ZAYZnw6dRQ"}],"key":"m5VrNPsI8J"}],"identifier":"demo-integration-compare","label":"demo-integration-compare","kind":"proof:example","template":"Example %s","enumerator":"9.6.3","resolved":true,"html_id":"demo-integration-compare","remote":true,"url":"/spectral-integration","dataUrl":"/spectral-integration.json","key":"BtmLJ5heGv"}],"key":"ae1ChBuVSs"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"First consider the integral","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"RjpBHbIXAU"}],"key":"uUxn8QME2X"},{"type":"math","value":"\\int_{-1}^1 \\frac{1}{1+4x^2} \\, dx = \\arctan(2).","position":{"start":{"line":5,"column":1},"end":{"line":7,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msubsup><mo>∫</mo><mrow><mo>−</mo><mn>1</mn></mrow><mn>1</mn></msubsup><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><mn>4</mn><msup><mi>x</mi><mn>2</mn></msup></mrow></mfrac><mtext> </mtext><mi>d</mi><mi>x</mi><mo>=</mo><mi>arctan</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mn>2</mn><mo stretchy=\"false\">)</mo><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">\\int_{-1}^1 \\frac{1}{1+4x^2} \\, dx = \\arctan(2).</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.5343em;vertical-align:-0.9703em;\"></span><span class=\"mop\"><span class=\"mop op-symbol large-op\" style=\"margin-right:0.44445em;position:relative;top:-0.0011em;\">∫</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.564em;\"><span style=\"top:-1.7881em;margin-left:-0.4445em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.8129em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9703em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">4</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7401em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7693em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop\">arctan</span><span class=\"mopen\">(</span><span class=\"mord\">2</span><span class=\"mclose\">)</span><span class=\"mord\">.</span></span></span></span></span>","enumerator":"1","key":"wjaSfLYEux"}],"key":"rfkZ9r8SM8"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:59:44.255000Z","iopub.status.busy":"2025-01-14T15:59:42.475000Z","iopub.execute_input":"2025-01-14T15:59:43.843000Z","shell.execute_reply":"2025-01-14T15:59:44.227000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"f(x)= 1 / (1 + 4x^2);\nexact = atan(2);","key":"narFnEtXwe"},{"type":"output","id":"6nmK_CyBKc5HWkHsoByqo","data":[],"key":"uRD0CEB4B4"}],"key":"jt8hmCqjm6"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We compare the two spectral integration methods for a range of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"iThE2SyFj2"},{"type":"inlineMath","value":"n","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"fcdnrS7Nhx"},{"type":"text","value":" values.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"n1nZ0Fygtt"}],"key":"geZcHvWLT5"}],"key":"wnnjRVrkRT"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T16:00:31.659000Z","iopub.status.busy":"2025-01-14T15:59:44.258000Z","iopub.execute_input":"2025-01-14T15:59:44.258000Z","shell.execute_reply":"2025-01-14T16:00:31.654000Z"},"tags":[]},"children":[{"type":"code","lang":"julia","executable":true,"value":"n = 8:4:96\nerr = zeros(length(n), 2)\nfor (k, n) in enumerate(n)\n  err[k, 1] = abs(exact - FNC.ccint(f, n)[1])\n  err[k, 2] = abs(exact - FNC.glint(f, n)[1])\nend\n\nerr[iszero.(err)] .= NaN    # remove from log-scale plot\nplot(n, err, m=:o, label=[\"CC\" \"GL\"],\n    xaxis=(\"number of nodes\"),  yaxis=(:log10, \"error\", [1e-16, 1]), \n    title=\"Spectral integration\")","visibility":"hide","key":"SMsAL2amDU"},{"type":"output","id":"h6R3x3DLmez9tojaoC1ZL","data":[{"output_type":"execute_result","execution_count":3,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"8d47b644d2800302276ec86fb8ef5c2b","path":"/build/8d47b644d2800302276ec86fb8ef5c2b.png"},"text/html":{"content_type":"text/html","hash":"f0d41304a842697fb3b6d8e078907ee5","path":"/build/f0d41304a842697fb3b6d8e078907ee5.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"462b934ad53af463870f1a973fe4e5c4","path":"/build/462b934ad53af463870f1a973fe4e5c4.svg"}}}],"visibility":"show","key":"hX7TeqyEYJ"}],"visibility":"show","key":"kfmc5s1Acu"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"(The missing dots are where the error is exactly zero.) Gauss–Legendre does converge faster here, but at something less than twice the rate.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"oJvAi5zSux"}],"key":"Fm8IjeRTZB"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Now we try a more sharply peaked integrand:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"UBL3EDWDie"}],"key":"fEkSm5UPeU"},{"type":"math","value":"\\int_{-1}^1 \\frac{1}{1+16x^2} \\, dx = \\frac{1}{2}\\arctan(4).","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msubsup><mo>∫</mo><mrow><mo>−</mo><mn>1</mn></mrow><mn>1</mn></msubsup><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><mn>16</mn><msup><mi>x</mi><mn>2</mn></msup></mrow></mfrac><mtext> </mtext><mi>d</mi><mi>x</mi><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mi>arctan</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mn>4</mn><mo stretchy=\"false\">)</mo><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">\\int_{-1}^1 \\frac{1}{1+16x^2} \\, dx = \\frac{1}{2}\\arctan(4).</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.5343em;vertical-align:-0.9703em;\"></span><span class=\"mop\"><span class=\"mop op-symbol large-op\" style=\"margin-right:0.44445em;position:relative;top:-0.0011em;\">∫</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.564em;\"><span style=\"top:-1.7881em;margin-left:-0.4445em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.8129em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9703em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">16</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7401em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7693em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.0074em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">2</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">arctan</span><span class=\"mopen\">(</span><span class=\"mord\">4</span><span class=\"mclose\">)</span><span class=\"mord\">.</span></span></span></span></span>","enumerator":"2","key":"VPAMWXoZL2"}],"key":"u58qGQyQ1Q"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T16:00:31.778000Z","iopub.status.busy":"2025-01-14T16:00:31.743000Z","iopub.execute_input":"2025-01-14T16:00:31.747000Z","shell.execute_reply":"2025-01-14T16:00:31.776000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"f(x) = 1 / (1 + 16x^2);\nexact = atan(4) / 2;","key":"cGoXhf4tZr"},{"type":"output","id":"dn_SeJGJqWqrreBJBzOh9","data":[],"key":"ZPRbh9ocTk"}],"key":"ToeqzwEkIJ"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T16:00:32.743000Z","iopub.status.busy":"2025-01-14T16:00:31.781000Z","iopub.execute_input":"2025-01-14T16:00:31.782000Z","shell.execute_reply":"2025-01-14T16:00:32.738000Z"},"tags":[]},"children":[{"type":"code","lang":"julia","executable":true,"value":"n = 8:4:96\nerr = zeros(length(n), 2)\nfor (k,n) in enumerate(n)\n  err[k, 1] = abs(exact - FNC.ccint(f, n)[1])\n  err[k, 2] = abs(exact - FNC.glint(f, n)[1])\nend\n\nerr[iszero.(err)] .= NaN    # remove from log-scale plot\nplot(n, err, m=:o, label=[\"CC\" \"GL\"],\n    xaxis=(\"number of nodes\"),  yaxis=(:log10, \"error\", [1e-16, 1]), \n    title=\"Spectral integration\")","visibility":"hide","key":"ZCxNYv1NEl"},{"type":"output","id":"98V61-LBg5CEtZgrhoXYJ","data":[{"output_type":"execute_result","execution_count":5,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"ad4ddc6290ba7658f204ce762b0ce8ce","path":"/build/ad4ddc6290ba7658f204ce762b0ce8ce.png"},"text/html":{"content_type":"text/html","hash":"6733c691773af55cac99c7285ad1f0cf","path":"/build/6733c691773af55cac99c7285ad1f0cf.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"5dbc480756593a5df230ebf4c4c8833e","path":"/build/5dbc480756593a5df230ebf4c4c8833e.svg"}}}],"visibility":"show","key":"sv4bz7fB7O"}],"visibility":"show","key":"Ln39CpaE4u"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The two are very close until about ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"lyloF9aB9E"},{"type":"inlineMath","value":"n=40","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>=</mo><mn>40</mn></mrow><annotation encoding=\"application/x-tex\">n=40</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">40</span></span></span></span>","key":"jLAln8X97V"},{"type":"text","value":", when the Clenshaw–Curtis method slows down.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"vVF0Nk6d7R"}],"key":"etMZU5ungp"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Now let’s compare the spectral performance to that of our earlier adaptive method in ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"RmXcByG6rL"},{"type":"inlineCode","value":"intadapt","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"dcr4BPiyRB"},{"type":"text","value":". We will specify varying error tolerances and record the error as well as the total number of evaluations of ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"DDk7lccBO3"},{"type":"inlineMath","value":"f","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>","key":"rWLQpS4KaM"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"sl4QIRSUU1"}],"key":"v2skf8030x"}],"key":"pBT4O4kfAL"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T16:00:40.593000Z","iopub.status.busy":"2025-01-14T16:00:32.755000Z","iopub.execute_input":"2025-01-14T16:00:32.756000Z","shell.execute_reply":"2025-01-14T16:00:40.588000Z"},"tags":[]},"children":[{"type":"code","lang":"julia","executable":true,"value":"tol = 10 .^(-2.0:-2:-14)\nn = zeros(size(tol))  \nerrAdapt = zeros(size(tol))\nfor (k, tol) in enumerate(tol)\n  Q, t = FNC.intadapt(f, -1, 1, tol)\n  errAdapt[k] = abs(exact - Q)\n  n[k] = length(t)\nend\n\nerrAdapt[iszero.(errAdapt)] .= NaN\nplot!(n, errAdapt, m=:o, label=\"intadapt\")\nplot!(n, n.^(-4), l=:dash, label=\"4th order\",\n        xaxis=(:log10),  title=\"Spectral vs 4th order\" )","visibility":"hide","key":"S07P1MhFqh"},{"type":"output","id":"u502fWRnrgkyCb_O-tqUy","data":[{"output_type":"execute_result","execution_count":6,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"d1ee6e833444e05839566b65d3d6463e","path":"/build/d1ee6e833444e05839566b65d3d6463e.png"},"text/html":{"content_type":"text/html","hash":"160544fa5d905985f06b9b5f5382740e","path":"/build/160544fa5d905985f06b9b5f5382740e.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"078713847a8c4a1b3985bcb5aac0e160","path":"/build/078713847a8c4a1b3985bcb5aac0e160.svg"}}}],"visibility":"show","key":"xDRQBuXGvG"}],"visibility":"show","key":"rrqguWq8la"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"At the core of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"eQD1QWHU9O"},{"type":"inlineCode","value":"intadapt","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"P4VtiFDzDy"},{"type":"text","value":" is a fourth-order formula, and the results track that rate closely. For all but the most relaxed error tolerances, both spectral methods are far more efficient than the low-order counterpart. For other integrands, particularly those that vary nonuniformly across the interval, the adaptive method might be more competitive.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"V9n8kz6VIc"}],"key":"Keg8PSjfzl"}],"key":"bamlQpkHac"}],"key":"k675x6dRUg"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Ellipse","url":"/ellipse","group":"Chapter 9"},"next":{"title":"Decay","url":"/decay","group":"Chapter 9"}}},"domain":"http://localhost:3000"}