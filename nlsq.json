{"version":2,"kind":"Article","sha256":"5613939098ba12e17e7fe9208ff3f45dd596af7644e30794e7e29a3b05f65b7c","slug":"nlsq","location":"/chapter4/nlsq.md","dependencies":[{"url":"/chapter4","label":"demo-nlsq-converge-julia","kind":"Notebook","slug":"chapter4","location":"/julia/chapter4.md","title":"Chapter 4"},{"url":"/chapter4-1","label":"demo-nlsq-converge-matlab","kind":"Notebook","slug":"chapter4-1","location":"/matlab/chapter4.md","title":"Chapter 4"},{"url":"/chapter4-2","label":"demo-nlsq-converge-python","kind":"Notebook","slug":"chapter4-2","location":"/python/chapter4.md","title":"Chapter 4"}],"frontmatter":{"title":"Nonlinear least squares","numbering":{"heading_1":{"enabled":true},"heading_2":{"enabled":true},"heading_3":{"enabled":false},"enumerator":{"enumerator":"4.7.%s"},"title":{"offset":1}},"content_includes_title":false,"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","TPBVP":"two-point boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"edit_url":"https://github.com/fncbook/fnc/blob/master/chapter4/nlsq.md","exports":[{"format":"md","filename":"nlsq.md","url":"/build/nlsq-51393235b7f81b439c3bafd7ccc3b53b.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"After the solution of square linear systems, we generalized to the case of having more constraints to satisfy than available variables. Our next step is to do the same for nonlinear equations, thus filling out this table:","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"QCwDkHV8og"}],"key":"mW9EzuUjdi"},{"type":"table","position":{"start":{"line":11,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"tableRow","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"tableCell","header":true,"align":"center","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[],"key":"SKwXsbCOyS"},{"type":"tableCell","header":true,"align":"center","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"strong","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"linear","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"acwuunzwl6"}],"key":"VWtvJVtAY3"}],"key":"eDZbdOIwEa"},{"type":"tableCell","header":true,"align":"center","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"strong","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"nonlinear","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"IdRTpag7TE"}],"key":"XVTwFhIIxM"}],"key":"XdEmH8OUCm"}],"key":"UD1Z6izrC7"},{"type":"tableRow","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"tableCell","align":"center","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"strong","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"square","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"wy0CPtnYM3"}],"key":"p6jHfmjory"}],"key":"O92IkO5XZF"},{"type":"tableCell","align":"center","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"inlineMath","value":"\\mathbf{A}\\mathbf{x}=\\mathbf{b}","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi><mi mathvariant=\"bold\">x</mi><mo>=</mo><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}\\mathbf{x}=\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">Ax</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"BFh9e2sufw"}],"key":"qJGg19UNPE"},{"type":"tableCell","align":"center","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"inlineMath","value":"\\mathbf{f}(\\mathbf{x})=\\boldsymbol{0}","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">f</mi><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi mathvariant=\"bold\">0</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{f}(\\mathbf{x})=\\boldsymbol{0}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.10903em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathbf\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">0</span></span></span></span></span></span>","key":"r3HXFZ4fME"}],"key":"L5uzzHK1Qj"}],"key":"bkQ1e0PxKD"},{"type":"tableRow","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"tableCell","align":"center","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"strong","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"overdetermined","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"ye2o0ujItd"}],"key":"J3xfC1LDgL"}],"key":"Zl6KnIeM6b"},{"type":"tableCell","align":"center","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"inlineMath","value":"\\min\\, \\bigl|\\mathbf{A}\\mathbf{x} - \\mathbf{b}\\bigr|_2","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>min</mi><mo>⁡</mo><mtext> </mtext><mo fence=\"true\" stretchy=\"true\" minsize=\"1.2em\" maxsize=\"1.2em\">∣</mo><mi mathvariant=\"bold\">A</mi><mi mathvariant=\"bold\">x</mi><mo>−</mo><mi mathvariant=\"bold\">b</mi><msub><mo fence=\"true\" stretchy=\"true\" minsize=\"1.2em\" maxsize=\"1.2em\">∣</mo><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\min\\, \\bigl|\\mathbf{A}\\mathbf{x} - \\mathbf{b}\\bigr|_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.212em;vertical-align:-0.35em;\"></span><span class=\"mop\">min</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mopen\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.862em;\"><span style=\"top:-2.256em;\"><span class=\"pstrut\" style=\"height:2.606em;\"></span><span class=\"delimsizinginner delim-size1\"><span>∣</span></span></span><span style=\"top:-2.854em;\"><span class=\"pstrut\" style=\"height:2.606em;\"></span><span style=\"height:0.016em;width:0.3333em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.3333em' height='0.016em' style='width:0.3333em' viewBox='0 0 333.33000000000004 16' preserveAspectRatio='xMinYMin'><path d='M145 0 H188 V16 H145z M145 0 H188 V16 H145z'/></svg></span></span><span style=\"top:-2.862em;\"><span class=\"pstrut\" style=\"height:2.606em;\"></span><span class=\"delimsizinginner delim-size1\"><span>∣</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.35em;\"><span></span></span></span></span></span></span><span class=\"mord mathbf\">Ax</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.2617em;vertical-align:-0.3997em;\"></span><span class=\"mord mathbf\">b</span><span class=\"mclose\"><span class=\"mclose\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.862em;\"><span style=\"top:-2.256em;\"><span class=\"pstrut\" style=\"height:2.606em;\"></span><span class=\"delimsizinginner delim-size1\"><span>∣</span></span></span><span style=\"top:-2.854em;\"><span class=\"pstrut\" style=\"height:2.606em;\"></span><span style=\"height:0.016em;width:0.3333em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.3333em' height='0.016em' style='width:0.3333em' viewBox='0 0 333.33000000000004 16' preserveAspectRatio='xMinYMin'><path d='M145 0 H188 V16 H145z M145 0 H188 V16 H145z'/></svg></span></span><span style=\"top:-2.862em;\"><span class=\"pstrut\" style=\"height:2.606em;\"></span><span class=\"delimsizinginner delim-size1\"><span>∣</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.35em;\"><span></span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.0514em;\"><span style=\"top:-2.3003em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3997em;\"><span></span></span></span></span></span></span></span></span></span>","key":"y7ZLBSqdok"}],"key":"ibXiRlsljY"},{"type":"tableCell","align":"center","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"inlineMath","value":"\\min\\, \\bigl|\\mathbf{f}(\\mathbf{x}) \\bigr|_2","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>min</mi><mo>⁡</mo><mtext> </mtext><mo fence=\"true\" stretchy=\"true\" minsize=\"1.2em\" maxsize=\"1.2em\">∣</mo><mi mathvariant=\"bold\">f</mi><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">x</mi><mo stretchy=\"false\">)</mo><msub><mo fence=\"true\" stretchy=\"true\" minsize=\"1.2em\" maxsize=\"1.2em\">∣</mo><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\min\\, \\bigl|\\mathbf{f}(\\mathbf{x}) \\bigr|_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.2617em;vertical-align:-0.3997em;\"></span><span class=\"mop\">min</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mopen\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.862em;\"><span style=\"top:-2.256em;\"><span class=\"pstrut\" style=\"height:2.606em;\"></span><span class=\"delimsizinginner delim-size1\"><span>∣</span></span></span><span style=\"top:-2.854em;\"><span class=\"pstrut\" style=\"height:2.606em;\"></span><span style=\"height:0.016em;width:0.3333em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.3333em' height='0.016em' style='width:0.3333em' viewBox='0 0 333.33000000000004 16' preserveAspectRatio='xMinYMin'><path d='M145 0 H188 V16 H145z M145 0 H188 V16 H145z'/></svg></span></span><span style=\"top:-2.862em;\"><span class=\"pstrut\" style=\"height:2.606em;\"></span><span class=\"delimsizinginner delim-size1\"><span>∣</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.35em;\"><span></span></span></span></span></span></span><span class=\"mord mathbf\" style=\"margin-right:0.10903em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathbf\">x</span><span class=\"mclose\">)</span><span class=\"mclose\"><span class=\"mclose\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.862em;\"><span style=\"top:-2.256em;\"><span class=\"pstrut\" style=\"height:2.606em;\"></span><span class=\"delimsizinginner delim-size1\"><span>∣</span></span></span><span style=\"top:-2.854em;\"><span class=\"pstrut\" style=\"height:2.606em;\"></span><span style=\"height:0.016em;width:0.3333em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.3333em' height='0.016em' style='width:0.3333em' viewBox='0 0 333.33000000000004 16' preserveAspectRatio='xMinYMin'><path d='M145 0 H188 V16 H145z M145 0 H188 V16 H145z'/></svg></span></span><span style=\"top:-2.862em;\"><span class=\"pstrut\" style=\"height:2.606em;\"></span><span class=\"delimsizinginner delim-size1\"><span>∣</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.35em;\"><span></span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.0514em;\"><span style=\"top:-2.3003em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3997em;\"><span></span></span></span></span></span></span></span></span></span>","key":"njetmtXQFK"}],"key":"EkjSjkZKZ0"}],"key":"cwsaDHKXgM"}],"key":"T2iooa2MW9"},{"type":"proof","kind":"definition","enumerated":true,"children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Nonlinear least-squares problem","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"sR8IvuvhjE"}],"key":"rhUvsh5ZeL"},{"type":"paragraph","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"Given a function ","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"hnKgFx92RQ"},{"type":"inlineMath","value":"\\mathbf{f}(\\mathbf{x})","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">f</mi><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\mathbf{f}(\\mathbf{x})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.10903em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathbf\">x</span><span class=\"mclose\">)</span></span></span></span>","key":"OjIy7sCF8N"},{"type":"text","value":" mapping from ","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"XbH3FLtmfJ"},{"type":"inlineMath","value":"\\real^n","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi mathvariant=\"double-struck\">R</mi><mi>n</mi></msup></mrow><annotation encoding=\"application/x-tex\">\\real^n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6889em;\"></span><span class=\"mord\"><span class=\"mord mathbb\">R</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span></span></span></span></span></span></span>","key":"jQER46n0MF"},{"type":"text","value":" to ","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"EXYesYwr3i"},{"type":"inlineMath","value":"\\real^m","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi mathvariant=\"double-struck\">R</mi><mi>m</mi></msup></mrow><annotation encoding=\"application/x-tex\">\\real^m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6889em;\"></span><span class=\"mord\"><span class=\"mord mathbb\">R</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span></span></span></span></span></span></span></span>","key":"XXzXh7VdF3"},{"type":"text","value":", the ","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"uyNqFw4FjL"},{"type":"crossReference","label":"nonlinear least-squares problem","identifier":"term-nonlinear least-squares problem","kind":"definitionTerm","children":[{"type":"text","value":"nonlinear least-squares problem","position":{"start":{"line":235,"column":1},"end":{"line":235,"column":1}},"key":"iqbW4ds6uU"}],"template":"{name}","resolved":true,"html_id":"term-nonlinear-least-squares-problem","remote":true,"url":"/glossary","dataUrl":"/glossary.json","key":"AhPHj8c7FW"},{"type":"text","value":" is to find ","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"Vw1eic3VbY"},{"type":"inlineMath","value":"\\mathbf{x}\\in\\real^n","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">x</mi><mo>∈</mo><msup><mi mathvariant=\"double-struck\">R</mi><mi>n</mi></msup></mrow><annotation encoding=\"application/x-tex\">\\mathbf{x}\\in\\real^n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span class=\"mord mathbf\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6889em;\"></span><span class=\"mord\"><span class=\"mord mathbb\">R</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span></span></span></span></span></span></span>","key":"FpHApOD2q9"},{"type":"text","value":" such that ","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"QMy1vYXWBC"},{"type":"inlineMath","value":"\\bigl\\|\\mathbf{f}(\\mathbf{x})\\bigr\\|_2","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo fence=\"true\" stretchy=\"true\" minsize=\"1.2em\" maxsize=\"1.2em\">∥</mo><mi mathvariant=\"bold\">f</mi><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">x</mi><mo stretchy=\"false\">)</mo><msub><mo fence=\"true\" stretchy=\"true\" minsize=\"1.2em\" maxsize=\"1.2em\">∥</mo><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\bigl\\|\\mathbf{f}(\\mathbf{x})\\bigr\\|_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.2617em;vertical-align:-0.3997em;\"></span><span class=\"mopen\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.862em;\"><span style=\"top:-2.256em;\"><span class=\"pstrut\" style=\"height:2.606em;\"></span><span class=\"delimsizinginner delim-size1\"><span>∥</span></span></span><span style=\"top:-2.854em;\"><span class=\"pstrut\" style=\"height:2.606em;\"></span><span style=\"height:0.016em;width:0.5556em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.5556em' height='0.016em' style='width:0.5556em' viewBox='0 0 555.5600000000001 16' preserveAspectRatio='xMinYMin'><path d='M145 0 H188 V16 H145z M145 0 H188 V16 H145zM367 0 H410 V16 H367z M367 0 H410 V16 H367z'/></svg></span></span><span style=\"top:-2.862em;\"><span class=\"pstrut\" style=\"height:2.606em;\"></span><span class=\"delimsizinginner delim-size1\"><span>∥</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.35em;\"><span></span></span></span></span></span></span><span class=\"mord mathbf\" style=\"margin-right:0.10903em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathbf\">x</span><span class=\"mclose\">)</span><span class=\"mclose\"><span class=\"mclose\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.862em;\"><span style=\"top:-2.256em;\"><span class=\"pstrut\" style=\"height:2.606em;\"></span><span class=\"delimsizinginner delim-size1\"><span>∥</span></span></span><span style=\"top:-2.854em;\"><span class=\"pstrut\" style=\"height:2.606em;\"></span><span style=\"height:0.016em;width:0.5556em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.5556em' height='0.016em' style='width:0.5556em' viewBox='0 0 555.5600000000001 16' preserveAspectRatio='xMinYMin'><path d='M145 0 H188 V16 H145z M145 0 H188 V16 H145zM367 0 H410 V16 H367z M367 0 H410 V16 H367z'/></svg></span></span><span style=\"top:-2.862em;\"><span class=\"pstrut\" style=\"height:2.606em;\"></span><span class=\"delimsizinginner delim-size1\"><span>∥</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.35em;\"><span></span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.0514em;\"><span style=\"top:-2.3003em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3997em;\"><span></span></span></span></span></span></span></span></span></span>","key":"GOVibVA3d2"},{"type":"text","value":" is minimized.","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"MNTWdUhYaM"}],"key":"yl50Ma62YY"}],"label":"definition-nlsq","identifier":"definition-nlsq","indexEntries":[{"entry":"nonlinear least squares","emphasis":true}],"enumerator":"4.7.1","html_id":"definition-nlsq","key":"jZC8zeLEDg"},{"type":"paragraph","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"As in the linear case, we consider only overdetermined problems, where ","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"Vsy9ZoHjh3"},{"type":"inlineMath","value":"m>n","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi><mo>&gt;</mo><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">m&gt;n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&gt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"OatvVEw6XQ"},{"type":"text","value":". Minimizing a positive quantity is equivalent to minimizing its square, so we could also define the result as minimizing ","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"R2e7UgOlxl"},{"type":"inlineMath","value":"\\phi(\\mathbf{x})=\\mathbf{f}(\\mathbf{x})^T\\mathbf{f}(\\mathbf{x})","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ϕ</mi><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi mathvariant=\"bold\">f</mi><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">x</mi><msup><mo stretchy=\"false\">)</mo><mi>T</mi></msup><mi mathvariant=\"bold\">f</mi><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\phi(\\mathbf{x})=\\mathbf{f}(\\mathbf{x})^T\\mathbf{f}(\\mathbf{x})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">ϕ</span><span class=\"mopen\">(</span><span class=\"mord mathbf\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0913em;vertical-align:-0.25em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.10903em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathbf\">x</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span><span class=\"mord mathbf\" style=\"margin-right:0.10903em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathbf\">x</span><span class=\"mclose\">)</span></span></span></span>","key":"VhxamBIuwn"},{"type":"text","value":".","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"uK1OpnlAgC"}],"key":"Q51bdVMpfu"},{"type":"heading","depth":2,"position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"text","value":"Gauss–Newton method","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"hTqLA1vggm"}],"identifier":"gauss-newton-method","label":"Gauss–Newton method","html_id":"gauss-newton-method","implicit":true,"enumerator":"4.7.1","key":"wpxqb9XGz5"},{"type":"paragraph","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"text","value":"You should not be surprised to learn that we can formulate an algorithm by substituting a linear model function for ","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"DgpAySsq8K"},{"type":"inlineMath","value":"\\mathbf{f}","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">f</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{f}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.10903em;\">f</span></span></span></span>","key":"Yui1xbPRWv"},{"type":"text","value":". At a current estimate ","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"IBPkl6ivp6"},{"type":"inlineMath","value":"\\mathbf{x}_k","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">x</mi><mi>k</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbf{x}_k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5944em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"o3hvetvZ8w"},{"type":"text","value":" we define","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"R5SWxwsjEK"}],"key":"YkkjwZe6lr"},{"type":"math","value":"  \\mathbf{q}(\\mathbf{x})  = \\mathbf{f}(\\mathbf{x}_k) + \\mathbf{A}_k(\\mathbf{x}-\\mathbf{x}_k),","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi mathvariant=\"bold\">q</mi><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi mathvariant=\"bold\">f</mi><mo stretchy=\"false\">(</mo><msub><mi mathvariant=\"bold\">x</mi><mi>k</mi></msub><mo stretchy=\"false\">)</mo><mo>+</mo><msub><mi mathvariant=\"bold\">A</mi><mi>k</mi></msub><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">x</mi><mo>−</mo><msub><mi mathvariant=\"bold\">x</mi><mi>k</mi></msub><mo stretchy=\"false\">)</mo><mo separator=\"true\">,</mo></mrow><annotation encoding=\"application/x-tex\">  \\mathbf{q}(\\mathbf{x})  = \\mathbf{f}(\\mathbf{x}_k) + \\mathbf{A}_k(\\mathbf{x}-\\mathbf{x}_k),</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathbf\">q</span><span class=\"mopen\">(</span><span class=\"mord mathbf\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.10903em;\">f</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathbf\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathbf\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mpunct\">,</span></span></span></span></span>","enumerator":"4.7.1","key":"Fn6YZvGu0d"},{"type":"paragraph","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"children":[{"type":"text","value":"where ","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"PSyssk3edX"},{"type":"inlineMath","value":"\\mathbf{A}_k","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">A</mi><mi>k</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}_k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8361em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"hDTSR5eRGZ"},{"type":"text","value":" is the exact ","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"AMlj4uornv"},{"type":"inlineMath","value":"m\\times n","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi><mo>×</mo><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">m\\times n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"ZB9cU61YxE"},{"type":"text","value":" Jacobian matrix, ","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"jV1JKElWBZ"},{"type":"inlineMath","value":"\\mathbf{J}(\\mathbf{x}_k)","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">J</mi><mo stretchy=\"false\">(</mo><msub><mi mathvariant=\"bold\">x</mi><mi>k</mi></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\mathbf{J}(\\mathbf{x}_k)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathbf\">J</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathbf\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"WTgOP5R3lq"},{"type":"text","value":", or an approximation of it as described in ","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"cmh42xb6N8"},{"type":"link","kind":"numref","identifier":"section-nonlineqn-quasinewton","label":"section-nonlineqn-quasinewton","url":"/quasinewton","internal":true,"dataUrl":"/quasinewton.json","children":[{"type":"text","value":"Quasi-Newton methods","key":"tDsQTA2zj9"}],"key":"O0uAwFyP0N"},{"type":"text","value":".","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"LiizQHbhGs"}],"key":"CTLP2b5A6m"},{"type":"paragraph","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"children":[{"type":"text","value":"In the square case, we solved ","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"g9kiIRk2Di"},{"type":"inlineMath","value":"\\mathbf{q}=\\boldsymbol{0}","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">q</mi><mo>=</mo><mi mathvariant=\"bold\">0</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{q}=\\boldsymbol{0}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6389em;vertical-align:-0.1944em;\"></span><span class=\"mord mathbf\">q</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">0</span></span></span></span></span></span>","key":"b6Zx0Klomw"},{"type":"text","value":" to define the new value for ","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"YL8zU3oBPD"},{"type":"inlineMath","value":"\\mathbf{x}","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">x</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{x}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4444em;\"></span><span class=\"mord mathbf\">x</span></span></span></span>","key":"bJyp03jSjY"},{"type":"text","value":", leading to the condition ","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"ZPPSvMKgDD"},{"type":"inlineMath","value":"\\mathbf{A}_k\\mathbf{s}_k=-\\mathbf{f}_k","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">A</mi><mi>k</mi></msub><msub><mi mathvariant=\"bold\">s</mi><mi>k</mi></msub><mo>=</mo><mo>−</mo><msub><mi mathvariant=\"bold\">f</mi><mi>k</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}_k\\mathbf{s}_k=-\\mathbf{f}_k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8361em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathbf\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\">−</span><span class=\"mord\"><span class=\"mord mathbf\" style=\"margin-right:0.10903em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.109em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"XTQkc9eMNs"},{"type":"text","value":", where ","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"YdqocSEnbT"},{"type":"inlineMath","value":"\\mathbf{s}_k=\\mathbf{x}_{k+1}-\\mathbf{x}_k","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">s</mi><mi>k</mi></msub><mo>=</mo><msub><mi mathvariant=\"bold\">x</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>−</mo><msub><mi mathvariant=\"bold\">x</mi><mi>k</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbf{s}_k=\\mathbf{x}_{k+1}-\\mathbf{x}_k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5944em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7917em;vertical-align:-0.2083em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.5944em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"TV4cbP95VN"},{"type":"text","value":". Now, with ","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"v0gSCmZ8Mo"},{"type":"inlineMath","value":"m>n","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi><mo>&gt;</mo><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">m&gt;n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&gt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"TVNC5z51fg"},{"type":"text","value":", we cannot expect to solve ","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"tPuxLzkVOj"},{"type":"inlineMath","value":"\\mathbf{q}=\\boldsymbol{0}","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">q</mi><mo>=</mo><mi mathvariant=\"bold\">0</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{q}=\\boldsymbol{0}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6389em;vertical-align:-0.1944em;\"></span><span class=\"mord mathbf\">q</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">0</span></span></span></span></span></span>","key":"Gk5SxYo5c1"},{"type":"text","value":", so instead we define ","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"fCVdlAOtGj"},{"type":"inlineMath","value":"\\mathbf{x}_{k+1}","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">x</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbf{x}_{k+1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6528em;vertical-align:-0.2083em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span></span></span></span>","key":"ouiZdkKEbG"},{"type":"text","value":" as the value that minimizes ","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"tNaeyHCFUF"},{"type":"inlineMath","value":"\\| \\mathbf{q} \\|_2","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">∥</mi><mi mathvariant=\"bold\">q</mi><msub><mi mathvariant=\"normal\">∥</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\| \\mathbf{q} \\|_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">∥</span><span class=\"mord mathbf\">q</span><span class=\"mord\"><span class=\"mord\">∥</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"ZJLRHLZrR6"},{"type":"text","value":".","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"J9Eu8RIK40"}],"key":"c2Ww1DF06W"},{"type":"proof","kind":"definition","enumerated":true,"children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Gauss–Newton method","position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"key":"cu8rkvggzS"}],"key":"V4Dkv2jp8j"},{"type":"paragraph","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"children":[{"type":"text","value":"Given ","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"QNRM2oK7Qf"},{"type":"inlineMath","value":"\\mathbf{f}","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">f</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{f}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.10903em;\">f</span></span></span></span>","key":"Y5RYcPNyDp"},{"type":"text","value":" and a starting value ","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"wliQcEa5cy"},{"type":"inlineMath","value":"\\mathbf{x}_1","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">x</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbf{x}_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5944em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"LpDHrajzgk"},{"type":"text","value":", for each ","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"Asx6FB1Rll"},{"type":"inlineMath","value":"k=1,2,3,\\ldots","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi><mo>=</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>2</mn><mo separator=\"true\">,</mo><mn>3</mn><mo separator=\"true\">,</mo><mo>…</mo></mrow><annotation encoding=\"application/x-tex\">k=1,2,3,\\ldots</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8389em;vertical-align:-0.1944em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">2</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">3</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span></span></span></span>","key":"R6PYAgK7AG"}],"key":"GtIg7krTpa"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":45,"column":1},"end":{"line":48,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":45,"column":1},"end":{"line":45,"column":1}},"children":[{"type":"text","value":"Compute ","position":{"start":{"line":45,"column":1},"end":{"line":45,"column":1}},"key":"GDmPhET3QP"},{"type":"inlineMath","value":"\\mathbf{y}_k = \\mathbf{f}(\\mathbf{x}_k)","position":{"start":{"line":45,"column":1},"end":{"line":45,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">y</mi><mi>k</mi></msub><mo>=</mo><mi mathvariant=\"bold\">f</mi><mo stretchy=\"false\">(</mo><msub><mi mathvariant=\"bold\">x</mi><mi>k</mi></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\mathbf{y}_k = \\mathbf{f}(\\mathbf{x}_k)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6389em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.016em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.10903em;\">f</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathbf\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"HAakHQUFQw"},{"type":"text","value":" and ","position":{"start":{"line":45,"column":1},"end":{"line":45,"column":1}},"key":"v7DI6Nhdqe"},{"type":"inlineMath","value":"\\mathbf{A}_k","position":{"start":{"line":45,"column":1},"end":{"line":45,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">A</mi><mi>k</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}_k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8361em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"w42JhW8xW7"},{"type":"text","value":", the exact or approximate Jacobian matrix at ","position":{"start":{"line":45,"column":1},"end":{"line":45,"column":1}},"key":"HSQypxhXe0"},{"type":"inlineMath","value":"\\mathbf{x}_k","position":{"start":{"line":45,"column":1},"end":{"line":45,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">x</mi><mi>k</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbf{x}_k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5944em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"IN5ochZtN2"},{"type":"text","value":".","position":{"start":{"line":45,"column":1},"end":{"line":45,"column":1}},"key":"DRXt7Av0nt"}],"key":"uHNEikhYNP"},{"type":"listItem","spread":true,"position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"children":[{"type":"text","value":"Solve the linear least squares problem ","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"key":"PXLeoFAa4N"},{"type":"inlineMath","value":"\\argmin \\| \\mathbf{A}_k\\mathbf{s}_k  + \\mathbf{y}_k\\|_2","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">argmin</mi><mo>⁡</mo><mi mathvariant=\"normal\">∥</mi><msub><mi mathvariant=\"bold\">A</mi><mi>k</mi></msub><msub><mi mathvariant=\"bold\">s</mi><mi>k</mi></msub><mo>+</mo><msub><mi mathvariant=\"bold\">y</mi><mi>k</mi></msub><msub><mi mathvariant=\"normal\">∥</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\argmin \\| \\mathbf{A}_k\\mathbf{s}_k  + \\mathbf{y}_k\\|_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop\"><span class=\"mord mathrm\">argmin</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">∥</span><span class=\"mord\"><span class=\"mord mathbf\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathbf\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.016em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord\">∥</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"CHbtoYGetn"},{"type":"text","value":" for ","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"key":"OMBn9Lm19a"},{"type":"inlineMath","value":"\\mathbf{s}_k","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">s</mi><mi>k</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbf{s}_k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5944em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"vyH0kdNamE"},{"type":"text","value":".","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"key":"bDnIW2zvTr"}],"key":"uzGRrfsnKT"},{"type":"listItem","spread":true,"position":{"start":{"line":47,"column":1},"end":{"line":48,"column":1}},"children":[{"type":"text","value":"Let ","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"key":"aXMKxTB9vF"},{"type":"inlineMath","value":"\\mathbf{x}_{k+1} = \\mathbf{x}_k + \\mathbf{s}_k","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">x</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi mathvariant=\"bold\">x</mi><mi>k</mi></msub><mo>+</mo><msub><mi mathvariant=\"bold\">s</mi><mi>k</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbf{x}_{k+1} = \\mathbf{x}_k + \\mathbf{s}_k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6528em;vertical-align:-0.2083em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.5944em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"vrnY4UHYkw"},{"type":"text","value":".","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"key":"xu5L4DU9Cw"}],"key":"Lhg7T9BVCI"}],"key":"jmqIpRZ66D"},{"type":"paragraph","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"children":[{"type":"text","value":"Under appropriate conditions, the sequence ","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"key":"F8rm84xPCV"},{"type":"inlineMath","value":"\\mathbf{x}_{1}, \\mathbf{x}_{2},\\dots","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">x</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><msub><mi mathvariant=\"bold\">x</mi><mn>2</mn></msub><mo separator=\"true\">,</mo><mo>…</mo></mrow><annotation encoding=\"application/x-tex\">\\mathbf{x}_{1}, \\mathbf{x}_{2},\\dots</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6389em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span></span></span></span>","key":"oy6fzpgZgp"},{"type":"text","value":" converges to a local minimizer of ","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"key":"ggW5PJS23B"},{"type":"inlineMath","value":"\\|\\mathbf{f}(\\mathbf{x})\\|_2","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">∥</mi><mi mathvariant=\"bold\">f</mi><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">x</mi><mo stretchy=\"false\">)</mo><msub><mi mathvariant=\"normal\">∥</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\|\\mathbf{f}(\\mathbf{x})\\|_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">∥</span><span class=\"mord mathbf\" style=\"margin-right:0.10903em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathbf\">x</span><span class=\"mclose\">)</span><span class=\"mord\"><span class=\"mord\">∥</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"mnljzfxOfW"},{"type":"text","value":".","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"key":"drWyJW6HwN"}],"key":"HfY7NDe9cv"}],"label":"definition-gaussnewton","identifier":"definition-gaussnewton","indexEntries":[{"entry":"Gauss–Newton method","emphasis":true}],"enumerator":"4.7.2","html_id":"definition-gaussnewton","key":"Up1AreivtF"},{"type":"paragraph","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"children":[{"type":"text","value":"In brief, Gauss–Newton solves a series of linear least-squares problems in order to solve a nonlinear least-squares problem.","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"key":"Klate14bwd"}],"key":"pRH87CtwRx"},{"type":"paragraph","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"children":[{"type":"text","value":"Surprisingly, ","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"key":"HfD4C5zvAv"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-newtonsys","label":"function-newtonsys","children":[{"type":"text","value":"Function ","key":"CQd7tg27wy"},{"type":"text","value":"4.5.2","key":"tqPZfK1pmL"}],"template":"Algorithm %s","enumerator":"4.5.2","resolved":true,"html_id":"function-newtonsys","remote":true,"url":"/newtonsys","dataUrl":"/newtonsys.json","key":"nUB49i9Z5l"},{"type":"text","value":" and ","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"key":"u2Tz7QOzPk"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-levenberg","label":"function-levenberg","children":[{"type":"text","value":"Function ","key":"GUeCZwtC3E"},{"type":"text","value":"4.6.3","key":"UJijUWlGsG"}],"template":"Algorithm %s","enumerator":"4.6.3","resolved":true,"html_id":"function-levenberg","remote":true,"url":"/quasinewton","dataUrl":"/quasinewton.json","key":"ri7tUiaJqC"},{"type":"text","value":", which were introduced for the case of ","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"key":"uiZa6fQd2G"},{"type":"inlineMath","value":"m=n","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi><mo>=</mo><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">m=n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"ogM6Lu2Jpf"},{"type":"text","value":" nonlinear equations, work ","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"key":"uJJKKkF3Qt"},{"type":"emphasis","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"children":[{"type":"text","value":"without modification","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"key":"XtAsr9w7gT"}],"key":"oCdZCQSdfJ"},{"type":"text","value":" as the Gauss–Newton method for the overdetermined case! The reason is that the backslash operator applies equally well to the linear system and linear least-squares problems, and nothing else in those functions was written with explicit reference to ","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"key":"K5G1oA1aIF"},{"type":"inlineMath","value":"n","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"d38MBqMDKQ"},{"type":"text","value":".","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"key":"UXExV1YOWk"}],"key":"rcVblJOVpB"},{"type":"heading","depth":2,"position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"children":[{"type":"text","value":"Convergence","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"key":"eTXW5l26jm"}],"identifier":"convergence","label":"Convergence","html_id":"convergence","implicit":true,"enumerator":"4.7.2","key":"VwxfAcNMAJ"},{"type":"paragraph","position":{"start":{"line":58,"column":1},"end":{"line":58,"column":1}},"children":[{"type":"text","value":"In the multidimensional Newton method for a nonlinear system, we expect quadratic convergence to a solution in the typical case. For the Gauss–Newton method, the picture is more complicated.","position":{"start":{"line":58,"column":1},"end":{"line":58,"column":1}},"key":"RfwA2l1FmO"}],"key":"SImfqIK1Do"},{"type":"paragraph","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"children":[{"type":"text","value":"As always in least-squares problems, the residual ","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"key":"qyRHzsV7jy"},{"type":"inlineMath","value":"\\mathbf{f}(\\mathbf{x})","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">f</mi><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\mathbf{f}(\\mathbf{x})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.10903em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathbf\">x</span><span class=\"mclose\">)</span></span></span></span>","key":"laxpXlWbZp"},{"type":"text","value":" will not necessarily be zero when ","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"key":"igPvRRSqpd"},{"type":"inlineMath","value":"\\|\\mathbf{f}\\|","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">∥</mi><mi mathvariant=\"bold\">f</mi><mi mathvariant=\"normal\">∥</mi></mrow><annotation encoding=\"application/x-tex\">\\|\\mathbf{f}\\|</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">∥</span><span class=\"mord mathbf\" style=\"margin-right:0.10903em;\">f</span><span class=\"mord\">∥</span></span></span></span>","key":"EAfTak8S4N"},{"type":"text","value":" is minimized. Suppose that the minimum value of ","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"key":"IHYVX5uWFz"},{"type":"inlineMath","value":"\\|\\mathbf{f}\\|","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">∥</mi><mi mathvariant=\"bold\">f</mi><mi mathvariant=\"normal\">∥</mi></mrow><annotation encoding=\"application/x-tex\">\\|\\mathbf{f}\\|</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">∥</span><span class=\"mord mathbf\" style=\"margin-right:0.10903em;\">f</span><span class=\"mord\">∥</span></span></span></span>","key":"Xnqpcv1PEn"},{"type":"text","value":" is ","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"key":"PjpokmpSwO"},{"type":"inlineMath","value":"R>0","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>R</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">R&gt;0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7224em;vertical-align:-0.0391em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&gt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"cEhOoUFVh9"},{"type":"text","value":". In general, we might observe quadratic-like convergence until the iterate ","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"key":"M5ZZhxqeAp"},{"type":"inlineMath","value":"\\|\\mathbf{x}_k\\|","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">∥</mi><msub><mi mathvariant=\"bold\">x</mi><mi>k</mi></msub><mi mathvariant=\"normal\">∥</mi></mrow><annotation encoding=\"application/x-tex\">\\|\\mathbf{x}_k\\|</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">∥</span><span class=\"mord\"><span class=\"mord mathbf\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">∥</span></span></span></span>","key":"IR6NVAsXCJ"},{"type":"text","value":" is within distance ","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"key":"XUkMKRlV6y"},{"type":"inlineMath","value":"R","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>R</mi></mrow><annotation encoding=\"application/x-tex\">R</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span></span></span></span>","key":"Wzlakqylru"},{"type":"text","value":" of a true minimizer, and linear convergence thereafter. When ","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"key":"sO4hvde71X"},{"type":"inlineMath","value":"R","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>R</mi></mrow><annotation encoding=\"application/x-tex\">R</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span></span></span></span>","key":"yPlTwLV5Lu"},{"type":"text","value":" is not sufficiently small, the convergence can be quite slow.","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"key":"Id08RActuK"}],"key":"whcXG03SwX"},{"type":"proof","kind":"example","enumerated":true,"children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Convergence of nonlinear least squares","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"key":"cLt9xVfirU"}],"key":"IeIu43Vvja"},{"type":"tabSet","children":[{"type":"tabItem","title":"Julia","sync":"julia","children":[{"type":"embed","source":{"url":"/chapter4","label":"demo-nlsq-converge-julia","kind":"Notebook","slug":"chapter4","location":"/julia/chapter4.md","title":"Chapter 4"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-nlsq-converge","label":"demo-nlsq-converge","kind":"proof:example","position":{"start":{"line":772,"column":1},"end":{"line":772,"column":20}},"children":[{"type":"text","value":"Example ","key":"h8Fi0UlSIj"},{"type":"text","value":"4.7.1","key":"SqyvcIXzu7"}],"template":"Example %s","enumerator":"4.7.1","resolved":true,"html_id":"demo-nlsq-converge","remote":true,"url":"/nlsq","dataUrl":"/nlsq.json","key":"ncPDXM1a0j"}],"key":"rpP5F3QTFp"},{"type":"paragraph","position":{"start":{"line":774,"column":1},"end":{"line":774,"column":1}},"children":[{"type":"text","value":"We will observe the convergence of ","position":{"start":{"line":774,"column":1},"end":{"line":774,"column":1}},"key":"rEoKTwqLPO"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-levenberg","label":"function-levenberg","children":[{"type":"text","value":"Function ","key":"JU1GGkYbge"},{"type":"text","value":"4.6.3","key":"IGsqMZX7k4"}],"template":"Algorithm %s","enumerator":"4.6.3","resolved":true,"html_id":"function-levenberg","remote":true,"url":"/quasinewton","dataUrl":"/quasinewton.json","key":"McMLez7ruW"},{"type":"text","value":" for different levels of the minimum least-squares residual. We start with a function mapping from ","position":{"start":{"line":774,"column":1},"end":{"line":774,"column":1}},"key":"Sm20dFc7Mq"},{"type":"inlineMath","value":"\\real^2","position":{"start":{"line":774,"column":1},"end":{"line":774,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi mathvariant=\"double-struck\">R</mi><mn>2</mn></msup></mrow><annotation encoding=\"application/x-tex\">\\real^2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathbb\">R</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span>","key":"mdJwpH52Ty"},{"type":"text","value":" into ","position":{"start":{"line":774,"column":1},"end":{"line":774,"column":1}},"key":"m1wwx4zLh0"},{"type":"inlineMath","value":"\\real^3","position":{"start":{"line":774,"column":1},"end":{"line":774,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi mathvariant=\"double-struck\">R</mi><mn>3</mn></msup></mrow><annotation encoding=\"application/x-tex\">\\real^3</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathbb\">R</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span></span></span></span></span></span></span></span>","key":"azJujwWR3b"},{"type":"text","value":", and a point that will be near the optimum.","position":{"start":{"line":774,"column":1},"end":{"line":774,"column":1}},"key":"D6ZfODGaNJ"}],"key":"kPsWBa199B"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"g(x) = [sin(x[1] + x[2]), cos(x[1] - x[2]), exp(x[1] - x[2])]\np = [1, 1];","key":"h7lZygrGfM"},{"type":"output","id":"E44F46oDCs4gZbDsgYXON","data":[],"key":"P6xbJxBULK"}],"key":"M2i7sLERnV"},{"type":"paragraph","position":{"start":{"line":784,"column":1},"end":{"line":784,"column":1}},"children":[{"type":"text","value":"The function ","position":{"start":{"line":784,"column":1},"end":{"line":784,"column":1}},"key":"B6w3c4uR9u"},{"type":"inlineMath","value":"\\mathbf{g}(\\mathbf{x}) - \\mathbf{g}(\\mathbf{p})","position":{"start":{"line":784,"column":1},"end":{"line":784,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">g</mi><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">x</mi><mo stretchy=\"false\">)</mo><mo>−</mo><mi mathvariant=\"bold\">g</mi><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">p</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\mathbf{g}(\\mathbf{x}) - \\mathbf{g}(\\mathbf{p})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">g</span><span class=\"mopen\">(</span><span class=\"mord mathbf\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">g</span><span class=\"mopen\">(</span><span class=\"mord mathbf\">p</span><span class=\"mclose\">)</span></span></span></span>","key":"dGDt5cOxPI"},{"type":"text","value":" obviously has a zero residual at ","position":{"start":{"line":784,"column":1},"end":{"line":784,"column":1}},"key":"C0EMho8Sdx"},{"type":"inlineMath","value":"\\mathbf{p}","position":{"start":{"line":784,"column":1},"end":{"line":784,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">p</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{p}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6389em;vertical-align:-0.1944em;\"></span><span class=\"mord mathbf\">p</span></span></span></span>","key":"AguX7vcOi8"},{"type":"text","value":". We’ll make different perturbations of that function in order to create nonzero residuals.","position":{"start":{"line":784,"column":1},"end":{"line":784,"column":1}},"key":"GCaSFCaDiq"}],"indexEntries":[{"entry":"Julia","subEntry":{"value":"@sprintf","kind":"entry"},"emphasis":true}],"key":"exSmh0V6lC"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"zrNYcMgcqc"}],"key":"QeUi7fOwQT"},{"type":"paragraph","position":{"start":{"line":787,"column":1},"end":{"line":787,"column":1}},"children":[{"type":"inlineCode","value":"@sprintf","position":{"start":{"line":787,"column":1},"end":{"line":787,"column":1}},"key":"kDRtPCahdB"},{"type":"text","value":" is a way to format numerical values as strings, patterned after the C function ","position":{"start":{"line":787,"column":1},"end":{"line":787,"column":1}},"key":"yKBESArOyY"},{"type":"inlineCode","value":"printf","position":{"start":{"line":787,"column":1},"end":{"line":787,"column":1}},"key":"jj1bnxJk5Y"},{"type":"text","value":".","position":{"start":{"line":787,"column":1},"end":{"line":787,"column":1}},"key":"p5ZizrEu4r"}],"key":"xlcJF1LDp2"}],"class":"dropdown","key":"okuKJiVG4M"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"using Printf\nplt = plot(xlabel=\"iteration\", yaxis=(:log10, \"error\"),\n    title=\"Convergence of Gauss–Newton\")\nfor R in [1e-3, 1e-2, 1e-1]\n    # Define the perturbed function.\n    f(x) = g(x) - g(p) + R * normalize([-1, 1, -1])\n    x = FNC.levenberg(f, [0, 0])\n    r = x[end]\n    err = [norm(x - r) for x in x[1:end-1]]\n    normres = norm(f(r))\n    plot!(err, label=@sprintf(\"R=%.2g\", normres))\nend\nplt","key":"HZhwJG7oYr"},{"type":"output","id":"phdPoBV4Czd4c9uOePO4p","data":[{"output_type":"execute_result","execution_count":66,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"7c902d5e1786850332630c5857f9f359","path":"/build/7c902d5e1786850332630c5857f9f359.png"},"text/html":{"content_type":"text/html","hash":"17a6df9dd5c04ea915cbf6baa9b3e998","path":"/build/17a6df9dd5c04ea915cbf6baa9b3e998.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"156e12c622946c400388c9ad5bfbdc52","path":"/build/156e12c622946c400388c9ad5bfbdc52.svg"}}}],"key":"fpgUpsLkf9"}],"key":"KFDCiscK0a"},{"type":"paragraph","position":{"start":{"line":806,"column":1},"end":{"line":806,"column":1}},"children":[{"type":"text","value":"In the least perturbed case, where the minimized residual is less than ","position":{"start":{"line":806,"column":1},"end":{"line":806,"column":1}},"key":"ddcTpcsrPo"},{"type":"span","position":{"start":{"line":806,"column":1},"end":{"line":806,"column":1}},"children":[{"type":"text","value":"10","key":"dZFDdia2Cw"},{"type":"superscript","children":[{"type":"text","value":"-3","key":"qp03bA6ncy"}],"key":"lvEmeynmok"}],"key":"x99mxzu4b3"},{"type":"text","value":", the convergence is plausibly quadratic. At the next level up, the convergence starts similarly but suddenly stagnates for a long time. In the most perturbed case, the quadratic phase is nearly gone and the overall shape looks linear.","position":{"start":{"line":806,"column":1},"end":{"line":806,"column":1}},"key":"fFbemtUgXG"}],"key":"Yh3zKM5BXv"}],"key":"hA34SIEH6F"}],"key":"lGX2t9BDVp"}],"key":"FNLOtdIZjk"},{"type":"tabItem","title":"MATLAB","sync":"matlab","children":[{"type":"embed","source":{"url":"/chapter4-1","label":"demo-nlsq-converge-matlab","kind":"Notebook","slug":"chapter4-1","location":"/matlab/chapter4.md","title":"Chapter 4"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-nlsq-converge","label":"demo-nlsq-converge","kind":"proof:example","position":{"start":{"line":689,"column":1},"end":{"line":689,"column":20}},"children":[{"type":"text","value":"Example ","key":"nDsUJZW8kT"},{"type":"text","value":"4.7.1","key":"QhIyUHQRlP"}],"template":"Example %s","enumerator":"4.7.1","resolved":true,"html_id":"demo-nlsq-converge","remote":true,"url":"/nlsq","dataUrl":"/nlsq.json","key":"XiZApOzezX"}],"key":"a6e0jnPLov"},{"type":"paragraph","position":{"start":{"line":691,"column":1},"end":{"line":691,"column":1}},"children":[{"type":"text","value":"We will observe the convergence of ","position":{"start":{"line":691,"column":1},"end":{"line":691,"column":1}},"key":"qnE10h55zn"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-levenberg","label":"function-levenberg","children":[{"type":"text","value":"Function ","key":"ZiL0ZI1kFk"},{"type":"text","value":"4.6.3","key":"Lzl99OO6Gs"}],"template":"Algorithm %s","enumerator":"4.6.3","resolved":true,"html_id":"function-levenberg","remote":true,"url":"/quasinewton","dataUrl":"/quasinewton.json","key":"eFTTpZNp5e"},{"type":"text","value":" for different levels of the minimum least-squares residual. We start with a function mapping from ","position":{"start":{"line":691,"column":1},"end":{"line":691,"column":1}},"key":"vZeC9QV8j6"},{"type":"inlineMath","value":"\\real^2","position":{"start":{"line":691,"column":1},"end":{"line":691,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi mathvariant=\"double-struck\">R</mi><mn>2</mn></msup></mrow><annotation encoding=\"application/x-tex\">\\real^2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathbb\">R</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span>","key":"HyJeNDYwQF"},{"type":"text","value":" into ","position":{"start":{"line":691,"column":1},"end":{"line":691,"column":1}},"key":"afDsMPdZTX"},{"type":"inlineMath","value":"\\real^3","position":{"start":{"line":691,"column":1},"end":{"line":691,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi mathvariant=\"double-struck\">R</mi><mn>3</mn></msup></mrow><annotation encoding=\"application/x-tex\">\\real^3</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathbb\">R</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span></span></span></span></span></span></span></span>","key":"T9dsJmfefV"},{"type":"text","value":", and a point that will be near the optimum.","position":{"start":{"line":691,"column":1},"end":{"line":691,"column":1}},"key":"JiyIyD10Kk"}],"key":"fa6mar2FJy"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"g = @(x) [sin(x(1) + x(2)); cos(x(1) - x(2)); exp(x(1) - x(2))];\np = [1; 1];","key":"zTV6s3xmzu"},{"type":"output","id":"8lsXc20U20vUXbbino7B9","data":[],"key":"Z8DToMKtgo"}],"key":"lvvdAReoWe"},{"type":"paragraph","position":{"start":{"line":699,"column":1},"end":{"line":699,"column":1}},"children":[{"type":"text","value":"The function ","position":{"start":{"line":699,"column":1},"end":{"line":699,"column":1}},"key":"SkbsiSGW5g"},{"type":"inlineMath","value":"\\mathbf{g}(\\mathbf{x}) - \\mathbf{g}(\\mathbf{p})","position":{"start":{"line":699,"column":1},"end":{"line":699,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">g</mi><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">x</mi><mo stretchy=\"false\">)</mo><mo>−</mo><mi mathvariant=\"bold\">g</mi><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">p</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\mathbf{g}(\\mathbf{x}) - \\mathbf{g}(\\mathbf{p})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">g</span><span class=\"mopen\">(</span><span class=\"mord mathbf\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">g</span><span class=\"mopen\">(</span><span class=\"mord mathbf\">p</span><span class=\"mclose\">)</span></span></span></span>","key":"ppErRP3hEg"},{"type":"text","value":" obviously has a zero residual at ","position":{"start":{"line":699,"column":1},"end":{"line":699,"column":1}},"key":"tfneAhiD1m"},{"type":"inlineMath","value":"\\mathbf{p}","position":{"start":{"line":699,"column":1},"end":{"line":699,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">p</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{p}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6389em;vertical-align:-0.1944em;\"></span><span class=\"mord mathbf\">p</span></span></span></span>","key":"Kxi5Jgm4UU"},{"type":"text","value":". We’ll make different perturbations of that function in order to create nonzero residuals.","position":{"start":{"line":699,"column":1},"end":{"line":699,"column":1}},"key":"G7tJvUR4U7"}],"indexEntries":[{"entry":"Julia","subEntry":{"value":"@sprintf","kind":"entry"},"emphasis":true}],"key":"OX6UocbCfW"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"lz0OrBp23Y"}],"key":"tvXEPEJu4G"},{"type":"paragraph","position":{"start":{"line":703,"column":1},"end":{"line":703,"column":1}},"children":[{"type":"inlineCode","value":"@sprintf","position":{"start":{"line":703,"column":1},"end":{"line":703,"column":1}},"key":"RMZo3iMaiF"},{"type":"text","value":" is a way to format numerical values as strings, patterned after the C function ","position":{"start":{"line":703,"column":1},"end":{"line":703,"column":1}},"key":"iZML9fpIvJ"},{"type":"inlineCode","value":"printf","position":{"start":{"line":703,"column":1},"end":{"line":703,"column":1}},"key":"E7KEfkLaAU"},{"type":"text","value":".","position":{"start":{"line":703,"column":1},"end":{"line":703,"column":1}},"key":"szMyRhFbSm"}],"key":"LfrOyrqFjR"}],"class":"dropdown","key":"FKqqR3zEpR"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf\nlabels = [];\nfor R = [1e-3, 1e-2, 1e-1]\n    % Define the perturbed function.\n    f = @(x) g(x) - g(p) + R * [-1; 1; -1] / sqrt(3)\n    x = levenberg(f, [0; 0]);\n    r = x(:, end);\n    err = abs(x(1, 1:end-1) - r(1));\n    normres = norm(f(r));\n    semilogy(err), hold on\n    labels = [labels; sprintf(\"R=%.2g\", normres)];\nend\nxlabel(\"iteration\"), ylabel(\"error\")\nlegend(labels);","key":"J7foYwKUgT"},{"type":"output","id":"95VROGAddhCOzE-bhIwzg","data":[{"output_type":"execute_result","execution_count":64,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"6f27cdbee48f3fe131234fd82fa93be7","path":"/build/6f27cdbee48f3fe131234fd82fa93be7.png"}}},{"output_type":"execute_result","execution_count":64,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>f = function_handle with value:\n    @(x)g(x)-g(p)+R*[-1;1;-1]/sqrt(3)\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"f = function_handle with value:\n    @(x)g(x)-g(p)+R*[-1;1;-1]/sqrt(3)\n","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":64,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>f = function_handle with value:\n    @(x)g(x)-g(p)+R*[-1;1;-1]/sqrt(3)\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"f = function_handle with value:\n    @(x)g(x)-g(p)+R*[-1;1;-1]/sqrt(3)\n","content_type":"text/plain"}}},{"output_type":"stream","name":"stderr","text":"Warning: Iteration did not find a root."},{"output_type":"execute_result","execution_count":64,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>f = function_handle with value:\n    @(x)g(x)-g(p)+R*[-1;1;-1]/sqrt(3)\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"f = function_handle with value:\n    @(x)g(x)-g(p)+R*[-1;1;-1]/sqrt(3)\n","content_type":"text/plain"}}},{"output_type":"stream","name":"stderr","text":"Warning: Iteration did not find a root."}],"key":"cA9p0DOwzK"}],"key":"tXLYJNqb5I"},{"type":"paragraph","position":{"start":{"line":723,"column":1},"end":{"line":723,"column":1}},"children":[{"type":"text","value":"In the least perturbed case, where the minimized residual is less than ","position":{"start":{"line":723,"column":1},"end":{"line":723,"column":1}},"key":"OTIApN801K"},{"type":"span","position":{"start":{"line":723,"column":1},"end":{"line":723,"column":1}},"children":[{"type":"text","value":"10","key":"E6wJfXDg4a"},{"type":"superscript","children":[{"type":"text","value":"-3","key":"hwQYx7tqGn"}],"key":"iibBBbgBwA"}],"key":"UE7PQDu6Na"},{"type":"text","value":", the convergence is plausibly quadratic. At the next level up, the convergence starts similarly but suddenly stagnates for a long time. In the most perturbed case, the quadratic phase is nearly gone and the overall shape looks linear.","position":{"start":{"line":723,"column":1},"end":{"line":723,"column":1}},"key":"RvCUNjbyv1"}],"key":"T6iDRkVk1m"}],"key":"UWZprpjNEM"}],"key":"IMfN4OJZjJ"}],"key":"OyYWHu6f8R"},{"type":"tabItem","title":"Python","sync":"python","children":[{"type":"embed","source":{"url":"/chapter4-2","label":"demo-nlsq-converge-python","kind":"Notebook","slug":"chapter4-2","location":"/python/chapter4.md","title":"Chapter 4"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-nlsq-converge","label":"demo-nlsq-converge","kind":"proof:example","position":{"start":{"line":772,"column":1},"end":{"line":772,"column":20}},"children":[{"type":"text","value":"Example ","key":"hTV7Rb8A2a"},{"type":"text","value":"4.7.1","key":"ERcGCuYOjP"}],"template":"Example %s","enumerator":"4.7.1","resolved":true,"html_id":"demo-nlsq-converge","remote":true,"url":"/nlsq","dataUrl":"/nlsq.json","key":"tJg0gG7DRm"}],"key":"Zp2lQDZo8C"},{"type":"paragraph","position":{"start":{"line":774,"column":1},"end":{"line":774,"column":1}},"children":[{"type":"text","value":"We will observe the convergence of ","position":{"start":{"line":774,"column":1},"end":{"line":774,"column":1}},"key":"YTaz86U5oS"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-levenberg","label":"function-levenberg","children":[{"type":"text","value":"Function ","key":"L6NWH8EOFz"},{"type":"text","value":"4.6.3","key":"ScilLhd4gm"}],"template":"Algorithm %s","enumerator":"4.6.3","resolved":true,"html_id":"function-levenberg","remote":true,"url":"/quasinewton","dataUrl":"/quasinewton.json","key":"R9AwUXmd4s"},{"type":"text","value":" for different levels of the minimum least-squares residual. We start with a function mapping from ","position":{"start":{"line":774,"column":1},"end":{"line":774,"column":1}},"key":"b6H6VE5I6S"},{"type":"inlineMath","value":"\\real^2","position":{"start":{"line":774,"column":1},"end":{"line":774,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi mathvariant=\"double-struck\">R</mi><mn>2</mn></msup></mrow><annotation encoding=\"application/x-tex\">\\real^2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathbb\">R</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span>","key":"Mix92Wm2TA"},{"type":"text","value":" into ","position":{"start":{"line":774,"column":1},"end":{"line":774,"column":1}},"key":"E6TRCCoSN1"},{"type":"inlineMath","value":"\\real^3","position":{"start":{"line":774,"column":1},"end":{"line":774,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi mathvariant=\"double-struck\">R</mi><mn>3</mn></msup></mrow><annotation encoding=\"application/x-tex\">\\real^3</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathbb\">R</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span></span></span></span></span></span></span></span>","key":"HyUZb107CL"},{"type":"text","value":", and a point that will be near the optimum.","position":{"start":{"line":774,"column":1},"end":{"line":774,"column":1}},"key":"cmHdthiGRh"}],"key":"kWL74eurbW"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"g = lambda x: array([sin(x[0] + x[1]), cos(x[0] - x[1]), exp(x[0] - x[1])])\np = array([1, 1])","key":"mxZVeX5Dju"},{"type":"output","id":"ocmPcionbft2babZG8NnI","data":[],"key":"mqKVDerpUE"}],"key":"SnlpW3THxm"},{"type":"paragraph","position":{"start":{"line":781,"column":1},"end":{"line":781,"column":1}},"children":[{"type":"text","value":"The function ","position":{"start":{"line":781,"column":1},"end":{"line":781,"column":1}},"key":"IF9qX1gGoU"},{"type":"inlineMath","value":"\\mathbf{g}(\\mathbf{x}) - \\mathbf{g}(\\mathbf{p})","position":{"start":{"line":781,"column":1},"end":{"line":781,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">g</mi><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">x</mi><mo stretchy=\"false\">)</mo><mo>−</mo><mi mathvariant=\"bold\">g</mi><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">p</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\mathbf{g}(\\mathbf{x}) - \\mathbf{g}(\\mathbf{p})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">g</span><span class=\"mopen\">(</span><span class=\"mord mathbf\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">g</span><span class=\"mopen\">(</span><span class=\"mord mathbf\">p</span><span class=\"mclose\">)</span></span></span></span>","key":"Ay7lyAfuyp"},{"type":"text","value":" obviously has a zero residual at ","position":{"start":{"line":781,"column":1},"end":{"line":781,"column":1}},"key":"V2OnuSxNfR"},{"type":"inlineMath","value":"\\mathbf{p}","position":{"start":{"line":781,"column":1},"end":{"line":781,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">p</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{p}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6389em;vertical-align:-0.1944em;\"></span><span class=\"mord mathbf\">p</span></span></span></span>","key":"khxxiq2z6V"},{"type":"text","value":". We’ll make different perturbations of that function in order to create nonzero residuals.","position":{"start":{"line":781,"column":1},"end":{"line":781,"column":1}},"key":"DY1Ryn9zOm"}],"key":"GXoyPX6MbO"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"for R in [1e-3, 1e-2, 1e-1]:\n    # Define the perturbed function.\n    f = lambda x: g(x) - g(p) + R * array([-1, 1, -1]) / sqrt(3)\n    x = FNC.levenberg(f, [0, 0])\n    r = x[-1]\n    err = [norm(x[j] - r) for j in range(len(x) - 1)]\n    normres = norm(f(r))\n    semilogy(err, label=f\"R={normres:.2g}\")\ntitle(\"Convergence of Gauss–Newton\")\nxlabel(\"iteration\"), ylabel(\"error\")\nlegend();","key":"OP3C6heIAW"},{"type":"output","id":"8zHWDuz0WKUAsk2NDoPZB","data":[{"output_type":"stream","name":"stderr","text":"/Users/driscoll/.local/share/mamba/envs/myst/lib/python3.13/site-packages/fncbook/chapter04.py:167: UserWarning: Iteration did not find a root.\n  warnings.warn(\"Iteration did not find a root.\")\n"},{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"fe3792337a04e20f7d0378f245484295","path":"/build/fe3792337a04e20f7d0378f245484295.png"}}}],"key":"ixUkJ7P6Zs"}],"key":"VNclQwwgxk"},{"type":"paragraph","position":{"start":{"line":797,"column":1},"end":{"line":797,"column":1}},"children":[{"type":"text","value":"In the least perturbed case, where the minimized residual is less than ","position":{"start":{"line":797,"column":1},"end":{"line":797,"column":1}},"key":"eZWNDSxWeW"},{"type":"span","position":{"start":{"line":797,"column":1},"end":{"line":797,"column":1}},"children":[{"type":"text","value":"10","key":"KTg4RuhrCr"},{"type":"superscript","children":[{"type":"text","value":"-3","key":"kXtAGTwQ4w"}],"key":"ohYC5mLfgQ"}],"key":"Nx1B2BYDHq"},{"type":"text","value":", the convergence is plausibly quadratic. At the next level up, the convergence starts similarly but suddenly stagnates for a long time. In the most perturbed case, the quadratic phase is nearly gone and the overall shape looks linear.","position":{"start":{"line":797,"column":1},"end":{"line":797,"column":1}},"key":"bZONqbDOm3"}],"key":"wQZq2fvitv"}],"key":"JKCzFOMVqL"}],"key":"TWsZ36r1Bs"}],"key":"isJDqWF3Q5"}],"key":"JcmqTqvBdn"}],"label":"demo-nlsq-converge","identifier":"demo-nlsq-converge","enumerator":"4.7.1","html_id":"demo-nlsq-converge","key":"KfUIS9WvGi"},{"type":"heading","depth":2,"position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"children":[{"type":"text","value":"Nonlinear data fitting","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"RBVKF4ILan"}],"identifier":"nonlinear-data-fitting","label":"Nonlinear data fitting","html_id":"nonlinear-data-fitting","implicit":true,"enumerator":"4.7.3","key":"DxgycZaLDo"},{"type":"paragraph","position":{"start":{"line":92,"column":1},"end":{"line":92,"column":1}},"children":[{"type":"text","value":"In ","position":{"start":{"line":92,"column":1},"end":{"line":92,"column":1}},"key":"TnUMFixSny"},{"type":"link","kind":"numref","identifier":"section-leastsq-fitting","label":"section-leastsq-fitting","url":"/fitting","internal":true,"dataUrl":"/fitting.json","children":[{"type":"text","value":"Fitting functions to data","key":"avycw5NsS1"}],"key":"js7jTKjwZ8"},{"type":"text","value":" we saw how to fit functions to data values, provided that the set of candidate fitting functions depends linearly on the undetermined coefficients. We now have a tool to generalize that process to fitting functions that depend nonlinearly on unknown parameters.","position":{"start":{"line":92,"column":1},"end":{"line":92,"column":1}},"key":"dvALhOmsbf"}],"indexEntries":[{"entry":"data fitting","subEntry":{"value":"nonlinear","kind":"entry"},"emphasis":false}],"label":"index-m6d6gnKUyF","identifier":"index-m6d6gnkuyf","html_id":"index-m6d6gnkuyf","key":"bzhXQKl35T"},{"type":"paragraph","position":{"start":{"line":94,"column":1},"end":{"line":94,"column":1}},"children":[{"type":"text","value":"Suppose that ","position":{"start":{"line":94,"column":1},"end":{"line":94,"column":1}},"key":"y7XO4yMe0C"},{"type":"inlineMath","value":"(t_i,y_i)","position":{"start":{"line":94,"column":1},"end":{"line":94,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><msub><mi>t</mi><mi>i</mi></msub><mo separator=\"true\">,</mo><msub><mi>y</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(t_i,y_i)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"yCL7X2wt5j"},{"type":"text","value":" for ","position":{"start":{"line":94,"column":1},"end":{"line":94,"column":1}},"key":"G5XzdBU5ix"},{"type":"inlineMath","value":"i=1,\\ldots,m","position":{"start":{"line":94,"column":1},"end":{"line":94,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi><mo>=</mo><mn>1</mn><mo separator=\"true\">,</mo><mo>…</mo><mo separator=\"true\">,</mo><mi>m</mi></mrow><annotation encoding=\"application/x-tex\">i=1,\\ldots,m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8389em;vertical-align:-0.1944em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">m</span></span></span></span>","key":"WKR6gaFx2C"},{"type":"text","value":" are given points. We wish to model the data by a function ","position":{"start":{"line":94,"column":1},"end":{"line":94,"column":1}},"key":"cfc1JxSqKL"},{"type":"inlineMath","value":"g(t,\\mathbf{x})","position":{"start":{"line":94,"column":1},"end":{"line":94,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>g</mi><mo stretchy=\"false\">(</mo><mi>t</mi><mo separator=\"true\">,</mo><mi mathvariant=\"bold\">x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">g(t,\\mathbf{x})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathbf\">x</span><span class=\"mclose\">)</span></span></span></span>","key":"CCiadDE76I"},{"type":"text","value":" that depends on unknown parameters ","position":{"start":{"line":94,"column":1},"end":{"line":94,"column":1}},"key":"YZ2bTVID9J"},{"type":"inlineMath","value":"x_1,\\ldots,x_n","position":{"start":{"line":94,"column":1},"end":{"line":94,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><mo>…</mo><mo separator=\"true\">,</mo><msub><mi>x</mi><mi>n</mi></msub></mrow><annotation encoding=\"application/x-tex\">x_1,\\ldots,x_n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"MTFznHBJB9"},{"type":"text","value":" in an arbitrary way. A standard approach is to minimize the discrepancy between the model and the observations, in a least-squares sense. Define","position":{"start":{"line":94,"column":1},"end":{"line":94,"column":1}},"key":"mvVpnouywi"}],"key":"ljwYAQm2M5"},{"type":"math","value":"\\mathbf{f}(\\mathbf{x}) = \\left[\\, g(t_i,\\mathbf{x})-y_i  \\, \\right]_{\\,i=1,\\ldots,m}.","label":"nlsq-misfit","identifier":"nlsq-misfit","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi mathvariant=\"bold\">f</mi><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mrow><mo fence=\"true\">[</mo><mtext> </mtext><mi>g</mi><mo stretchy=\"false\">(</mo><msub><mi>t</mi><mi>i</mi></msub><mo separator=\"true\">,</mo><mi mathvariant=\"bold\">x</mi><mo stretchy=\"false\">)</mo><mo>−</mo><msub><mi>y</mi><mi>i</mi></msub><mtext> </mtext><mo fence=\"true\">]</mo></mrow><mrow><mtext> </mtext><mi>i</mi><mo>=</mo><mn>1</mn><mo separator=\"true\">,</mo><mo>…</mo><mo separator=\"true\">,</mo><mi>m</mi></mrow></msub><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{f}(\\mathbf{x}) = \\left[\\, g(t_i,\\mathbf{x})-y_i  \\, \\right]_{\\,i=1,\\ldots,m}.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.10903em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathbf\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1858em;vertical-align:-0.4358em;\"></span><span class=\"minner\"><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\">[</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathbf\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mclose delimcenter\" style=\"top:0em;\">]</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.162em;\"><span style=\"top:-2.4003em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mspace mtight\" style=\"margin-right:0.1952em;\"></span><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span><span class=\"mpunct mtight\">,</span><span class=\"minner mtight\">…</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\">m</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4358em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">.</span></span></span></span></span>","enumerator":"4.7.2","html_id":"nlsq-misfit","key":"AQYcOCu6tO"},{"type":"paragraph","position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"children":[{"type":"text","value":"We call ","position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"key":"FnuJCzDc58"},{"type":"inlineMath","value":"\\mathbf{f}","position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">f</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{f}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.10903em;\">f</span></span></span></span>","key":"m9v39IEwRI"},{"type":"text","value":" a ","position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"key":"FripTKC7eZ"},{"type":"strong","position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"children":[{"type":"text","value":"misfit","position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"key":"VVKlvLF8Op"}],"key":"cgmO2vz2lu"},{"type":"text","value":" function. By minimizing ","position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"key":"C4UvDi0FUP"},{"type":"inlineMath","value":"\\bigl\\| \\mathbf{f}(\\mathbf{c}) \\bigr\\|^2","position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo fence=\"true\" stretchy=\"true\" minsize=\"1.2em\" maxsize=\"1.2em\">∥</mo><mi mathvariant=\"bold\">f</mi><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">c</mi><mo stretchy=\"false\">)</mo><msup><mo fence=\"true\" stretchy=\"true\" minsize=\"1.2em\" maxsize=\"1.2em\">∥</mo><mn>2</mn></msup></mrow><annotation encoding=\"application/x-tex\">\\bigl\\| \\mathbf{f}(\\mathbf{c}) \\bigr\\|^2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.416em;vertical-align:-0.35em;\"></span><span class=\"mopen\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.862em;\"><span style=\"top:-2.256em;\"><span class=\"pstrut\" style=\"height:2.606em;\"></span><span class=\"delimsizinginner delim-size1\"><span>∥</span></span></span><span style=\"top:-2.854em;\"><span class=\"pstrut\" style=\"height:2.606em;\"></span><span style=\"height:0.016em;width:0.5556em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.5556em' height='0.016em' style='width:0.5556em' viewBox='0 0 555.5600000000001 16' preserveAspectRatio='xMinYMin'><path d='M145 0 H188 V16 H145z M145 0 H188 V16 H145zM367 0 H410 V16 H367z M367 0 H410 V16 H367z'/></svg></span></span><span style=\"top:-2.862em;\"><span class=\"pstrut\" style=\"height:2.606em;\"></span><span class=\"delimsizinginner delim-size1\"><span>∥</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.35em;\"><span></span></span></span></span></span></span><span class=\"mord mathbf\" style=\"margin-right:0.10903em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathbf\">c</span><span class=\"mclose\">)</span><span class=\"mclose\"><span class=\"mclose\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.862em;\"><span style=\"top:-2.256em;\"><span class=\"pstrut\" style=\"height:2.606em;\"></span><span class=\"delimsizinginner delim-size1\"><span>∥</span></span></span><span style=\"top:-2.854em;\"><span class=\"pstrut\" style=\"height:2.606em;\"></span><span style=\"height:0.016em;width:0.5556em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.5556em' height='0.016em' style='width:0.5556em' viewBox='0 0 555.5600000000001 16' preserveAspectRatio='xMinYMin'><path d='M145 0 H188 V16 H145z M145 0 H188 V16 H145zM367 0 H410 V16 H367z M367 0 H410 V16 H367z'/></svg></span></span><span style=\"top:-2.862em;\"><span class=\"pstrut\" style=\"height:2.606em;\"></span><span class=\"delimsizinginner delim-size1\"><span>∥</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.35em;\"><span></span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.066em;\"><span style=\"top:-3.3149em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span>","key":"U6fkeLh8Zp"},{"type":"text","value":", we get the best possible fit to the data. If an explicit Jacobian matrix is desired for the minimization, we can compute","position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"key":"ZTcwmduDI6"}],"key":"MCXkpWwCp6"},{"type":"math","value":"\\mathbf{f}{\\,}'(\\mathbf{x}) = \\left[ \\frac{\\partial}{\\partial x_j} g(t_i,\\mathbf{x}) \\right]_{\\,i=1,\\ldots,m;\\,j=1,\\ldots,n.}","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi mathvariant=\"bold\">f</mi><msup><mtext> </mtext><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mrow><mo fence=\"true\">[</mo><mfrac><mi mathvariant=\"normal\">∂</mi><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>x</mi><mi>j</mi></msub></mrow></mfrac><mi>g</mi><mo stretchy=\"false\">(</mo><msub><mi>t</mi><mi>i</mi></msub><mo separator=\"true\">,</mo><mi mathvariant=\"bold\">x</mi><mo stretchy=\"false\">)</mo><mo fence=\"true\">]</mo></mrow><mrow><mtext> </mtext><mi>i</mi><mo>=</mo><mn>1</mn><mo separator=\"true\">,</mo><mo>…</mo><mo separator=\"true\">,</mo><mi>m</mi><mo separator=\"true\">;</mo><mtext> </mtext><mi>j</mi><mo>=</mo><mn>1</mn><mo separator=\"true\">,</mo><mo>…</mo><mo separator=\"true\">,</mo><mi>n</mi><mi mathvariant=\"normal\">.</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbf{f}{\\,}&#x27;(\\mathbf{x}) = \\left[ \\frac{\\partial}{\\partial x_j} g(t_i,\\mathbf{x}) \\right]_{\\,i=1,\\ldots,m;\\,j=1,\\ldots,n.}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0519em;vertical-align:-0.25em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.10903em;\">f</span><span class=\"mord\"><span class=\"mord\"><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8019em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathbf\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.6079em;vertical-align:-1.1579em;\"></span><span class=\"minner\"><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">[</span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9721em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathbf\">x</span><span class=\"mclose\">)</span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">]</span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:-0.5601em;\"><span style=\"top:-1.6782em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mspace mtight\" style=\"margin-right:0.1952em;\"></span><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span><span class=\"mpunct mtight\">,</span><span class=\"minner mtight\">…</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\">m</span><span class=\"mpunct mtight\">;</span><span class=\"mspace mtight\" style=\"margin-right:0.1952em;\"></span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span><span class=\"mpunct mtight\">,</span><span class=\"minner mtight\">…</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\">n</span><span class=\"mord mtight\">.</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.1579em;\"><span></span></span></span></span></span></span></span></span></span></span>","enumerator":"4.7.3","key":"r2HJFnO0Q4"},{"type":"paragraph","position":{"start":{"line":107,"column":1},"end":{"line":107,"column":1}},"children":[{"type":"text","value":"The form of ","position":{"start":{"line":107,"column":1},"end":{"line":107,"column":1}},"key":"htzEO36hDt"},{"type":"inlineMath","value":"g","position":{"start":{"line":107,"column":1},"end":{"line":107,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>g</mi></mrow><annotation encoding=\"application/x-tex\">g</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span></span></span></span>","key":"QXHS67wLwP"},{"type":"text","value":" is up to the modeler. There may be compelling theoretical choices, or you may just be looking for enough algebraic power to express the data well. Naturally, in the special case where the dependence on ","position":{"start":{"line":107,"column":1},"end":{"line":107,"column":1}},"key":"EFF0RDsBrd"},{"type":"inlineMath","value":"\\mathbf{c}","position":{"start":{"line":107,"column":1},"end":{"line":107,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">c</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{c}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4444em;\"></span><span class=\"mord mathbf\">c</span></span></span></span>","key":"WwXzFMuG4N"},{"type":"text","value":" is linear, i.e.,","position":{"start":{"line":107,"column":1},"end":{"line":107,"column":1}},"key":"GKCMmBdCm7"}],"key":"TkfDKmWjHL"},{"type":"math","value":"  g(t,\\mathbf{c}) = c_1 g_1(t) + c_2 g_2(t) + \\cdots + c_m g_m(t),","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>g</mi><mo stretchy=\"false\">(</mo><mi>t</mi><mo separator=\"true\">,</mo><mi mathvariant=\"bold\">c</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mi>c</mi><mn>1</mn></msub><msub><mi>g</mi><mn>1</mn></msub><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo>+</mo><msub><mi>c</mi><mn>2</mn></msub><msub><mi>g</mi><mn>2</mn></msub><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo>+</mo><mo>⋯</mo><mo>+</mo><msub><mi>c</mi><mi>m</mi></msub><msub><mi>g</mi><mi>m</mi></msub><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo separator=\"true\">,</mo></mrow><annotation encoding=\"application/x-tex\">  g(t,\\mathbf{c}) = c_1 g_1(t) + c_2 g_2(t) + \\cdots + c_m g_m(t),</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathbf\">c</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"minner\">⋯</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span><span class=\"mpunct\">,</span></span></span></span></span>","enumerator":"4.7.4","key":"eYrRNNDJrc"},{"type":"paragraph","position":{"start":{"line":113,"column":1},"end":{"line":113,"column":1}},"children":[{"type":"text","value":"then the misfit function is also linear in ","position":{"start":{"line":113,"column":1},"end":{"line":113,"column":1}},"key":"i85EaarLz1"},{"type":"inlineMath","value":"\\mathbf{c}","position":{"start":{"line":113,"column":1},"end":{"line":113,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">c</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{c}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4444em;\"></span><span class=\"mord mathbf\">c</span></span></span></span>","key":"UYR4LvdjAV"},{"type":"text","value":" and the fitting problem reduces to linear least squares.","position":{"start":{"line":113,"column":1},"end":{"line":113,"column":1}},"key":"KSOw5KEPne"}],"key":"v19xihtReE"},{"type":"proof","kind":"example","enumerated":true,"children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Nonlinear data fitting","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"key":"jCVzlCeJvJ"}],"key":"y8PSOW6Dp3"},{"type":"paragraph","position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"children":[{"type":"text","value":"Inhibited enzyme reactions often follow what are known as *Michaelis–Menten_ kinetics, in which a reaction rate ","position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"key":"Gn5pXv7Krb"},{"type":"inlineMath","value":"w","position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>w</mi></mrow><annotation encoding=\"application/x-tex\">w</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span></span></span></span>","key":"DG0EaOgB2c"},{"type":"text","value":" follows a law of the form","position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"key":"bwoNun8a6O"}],"key":"jdOvvkLS1O"},{"type":"math","value":"w(s) = \\frac{V s}{K_m + s},","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>w</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mfrac><mrow><mi>V</mi><mi>s</mi></mrow><mrow><msub><mi>K</mi><mi>m</mi></msub><mo>+</mo><mi>s</mi></mrow></mfrac><mo separator=\"true\">,</mo></mrow><annotation encoding=\"application/x-tex\">w(s) = \\frac{V s}{K_m + s},</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">s</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.1963em;vertical-align:-0.836em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3603em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\">s</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"mord mathnormal\">s</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mpunct\">,</span></span></span></span></span>","enumerator":"4.7.5","key":"HB1NE2p2ZR"},{"type":"paragraph","position":{"start":{"line":121,"column":1},"end":{"line":121,"column":1}},"children":[{"type":"text","value":"where ","position":{"start":{"line":121,"column":1},"end":{"line":121,"column":1}},"key":"UGqjfGWFjK"},{"type":"inlineMath","value":"s","position":{"start":{"line":121,"column":1},"end":{"line":121,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>s</mi></mrow><annotation encoding=\"application/x-tex\">s</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">s</span></span></span></span>","key":"O2Mw9TpL93"},{"type":"text","value":" is the concentration of a substrate. The real values ","position":{"start":{"line":121,"column":1},"end":{"line":121,"column":1}},"key":"XkgrdxzAQT"},{"type":"inlineMath","value":"V","position":{"start":{"line":121,"column":1},"end":{"line":121,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>V</mi></mrow><annotation encoding=\"application/x-tex\">V</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span></span></span></span>","key":"c5ujXrq1DV"},{"type":"text","value":" and ","position":{"start":{"line":121,"column":1},"end":{"line":121,"column":1}},"key":"QkON66X6NW"},{"type":"inlineMath","value":"K_m","position":{"start":{"line":121,"column":1},"end":{"line":121,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>K</mi><mi>m</mi></msub></mrow><annotation encoding=\"application/x-tex\">K_m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"OjpliVujsH"},{"type":"text","value":" are parameters that are free to fit to data. For this example, we cook up some artificial data with ","position":{"start":{"line":121,"column":1},"end":{"line":121,"column":1}},"key":"xrUcwPgfp6"},{"type":"inlineMath","value":"V=2","position":{"start":{"line":121,"column":1},"end":{"line":121,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>V</mi><mo>=</mo><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">V=2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span></span></span></span>","key":"MwHm2X2tdr"},{"type":"text","value":" and ","position":{"start":{"line":121,"column":1},"end":{"line":121,"column":1}},"key":"bJpGcXwqtf"},{"type":"inlineMath","value":"K_m=1/2","position":{"start":{"line":121,"column":1},"end":{"line":121,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>K</mi><mi>m</mi></msub><mo>=</mo><mn>1</mn><mi mathvariant=\"normal\">/</mi><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">K_m=1/2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1/2</span></span></span></span>","key":"xly70tyxqb"},{"type":"text","value":".","position":{"start":{"line":121,"column":1},"end":{"line":121,"column":1}},"key":"TsG1TP1F2h"}],"key":"A1zeDi6V1H"},{"type":"tabSet","children":[{"type":"tabItem","title":"Julia","sync":"julia","children":[{"type":"embed","source":{"url":"/chapter4","label":"demo-nlsq-MM-julia","kind":"Notebook","slug":"chapter4","location":"/julia/chapter4.md","title":"Chapter 4"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-nlsq-mm","label":"demo-nlsq-MM","kind":"proof:example","position":{"start":{"line":810,"column":1},"end":{"line":810,"column":14}},"children":[{"type":"text","value":"Example ","key":"Q16w5GKGht"},{"type":"text","value":"4.7.2","key":"kbYLGiNKBW"}],"template":"Example %s","enumerator":"4.7.2","resolved":true,"html_id":"demo-nlsq-mm","remote":true,"url":"/nlsq","dataUrl":"/nlsq.json","key":"zd6uW7JCVW"}],"key":"vW0JPn2dvH"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"m = 25;\ns = range(0.05, 6, length=m)\nŵ = @. 2 * s / (0.5 + s)                      # exactly on the curve\nw = @. ŵ + 0.15 * cos(2 * exp(s / 16) * s);     # smooth noise added","key":"JItA91PXhJ"},{"type":"output","id":"bX5VFFV_qOg5kfCasi0T0","data":[],"key":"R4FfOcDPpJ"}],"key":"tG3NTTIacM"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"scatter(s, w, label=\"noisy data\",\n    xlabel=\"s\", ylabel=\"v\", leg=:bottomright)\nplot!(s, ŵ, l=:dash, color=:black, label=\"perfect data\")","key":"Qq9tiA686q"},{"type":"output","id":"EnY-mTvbp5i8Y63-fUHs0","data":[{"output_type":"execute_result","execution_count":68,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"86e4b115be9f4a7bafe98c5611c0ffea","path":"/build/86e4b115be9f4a7bafe98c5611c0ffea.png"},"text/html":{"content_type":"text/html","hash":"dfc9c2a83cdfd7b634a6bdd10ae74a92","path":"/build/dfc9c2a83cdfd7b634a6bdd10ae74a92.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"d1a238357297fe88e469353fffee015c","path":"/build/d1a238357297fe88e469353fffee015c.svg"}}}],"key":"PHwWUKfETG"}],"key":"cWrgq44JRb"},{"type":"paragraph","position":{"start":{"line":828,"column":1},"end":{"line":828,"column":1}},"children":[{"type":"text","value":"The idea is to pretend that we know nothing of the origins of this data and use nonlinear least squares to find the parameters in the theoretical model function ","position":{"start":{"line":828,"column":1},"end":{"line":828,"column":1}},"key":"pgexc2PTrs"},{"type":"inlineMath","value":"v(s)","position":{"start":{"line":828,"column":1},"end":{"line":828,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>v</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">v(s)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">s</span><span class=\"mclose\">)</span></span></span></span>","key":"UfSqgmSBsY"},{"type":"text","value":". In ","position":{"start":{"line":828,"column":1},"end":{"line":828,"column":1}},"key":"mMiLdPeVfE"},{"type":"crossReference","kind":"equation","identifier":"nlsq-misfit","label":"nlsq-misfit","children":[{"type":"text","value":"(","key":"vJv7WB7D8y"},{"type":"text","value":"4.7.2","key":"W87igrjHJG"},{"type":"text","value":")","key":"eJUOZWUbok"}],"template":"(%s)","enumerator":"4.7.2","resolved":true,"html_id":"nlsq-misfit","remote":true,"url":"/nlsq","dataUrl":"/nlsq.json","key":"Uyej3FryxW"},{"type":"text","value":", the ","position":{"start":{"line":828,"column":1},"end":{"line":828,"column":1}},"key":"N9HdbNxDIX"},{"type":"inlineMath","value":"s","position":{"start":{"line":828,"column":1},"end":{"line":828,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>s</mi></mrow><annotation encoding=\"application/x-tex\">s</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">s</span></span></span></span>","key":"BnFRLkZPxR"},{"type":"text","value":" variable plays the role of ","position":{"start":{"line":828,"column":1},"end":{"line":828,"column":1}},"key":"CxeonKbEco"},{"type":"inlineMath","value":"t","position":{"start":{"line":828,"column":1},"end":{"line":828,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span></span></span></span>","key":"EQWUpUkR4m"},{"type":"text","value":", and ","position":{"start":{"line":828,"column":1},"end":{"line":828,"column":1}},"key":"LfgSQpeX8A"},{"type":"inlineMath","value":"v","position":{"start":{"line":828,"column":1},"end":{"line":828,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>v</mi></mrow><annotation encoding=\"application/x-tex\">v</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span></span></span></span>","key":"iRSxbzZoKQ"},{"type":"text","value":" plays the role of ","position":{"start":{"line":828,"column":1},"end":{"line":828,"column":1}},"key":"kXk5hm4cC1"},{"type":"inlineMath","value":"g","position":{"start":{"line":828,"column":1},"end":{"line":828,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>g</mi></mrow><annotation encoding=\"application/x-tex\">g</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span></span></span></span>","key":"uM3OEibvz7"},{"type":"text","value":".","position":{"start":{"line":828,"column":1},"end":{"line":828,"column":1}},"key":"zGA5HZlXUm"}],"indexEntries":[{"entry":"Julia","subEntry":{"value":"destructuring","kind":"entry"},"emphasis":true}],"key":"e89egbMQYQ"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"daNhVomlF5"}],"key":"SyNyrXXIeC"},{"type":"paragraph","position":{"start":{"line":831,"column":1},"end":{"line":831,"column":1}},"children":[{"type":"text","value":"Putting comma-separated values on the left of an assignment will ","position":{"start":{"line":831,"column":1},"end":{"line":831,"column":1}},"key":"fdyNU6OH3j"},{"type":"strong","position":{"start":{"line":831,"column":1},"end":{"line":831,"column":1}},"children":[{"type":"text","value":"destructure","position":{"start":{"line":831,"column":1},"end":{"line":831,"column":1}},"key":"sEjCEHXpoF"}],"key":"sjvNwjAqoa"},{"type":"text","value":" the right-hand side, drawing individual assignments from entries of a vector, for example.","position":{"start":{"line":831,"column":1},"end":{"line":831,"column":1}},"key":"XwpTYA4uYO"}],"key":"gbTfIIIODq"}],"class":"dropdown","key":"hjKAu8vgnx"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"function misfit(x)\n    V, Km = x   # rename components for clarity\n    return @. V * s / (Km + s) - w\nend","key":"GlsoTRoLaq"},{"type":"output","id":"TWLiRdO_D0qrcSch6FWO0","data":[{"output_type":"execute_result","execution_count":69,"metadata":{},"data":{"text/plain":{"content":"misfit (generic function with 1 method)","content_type":"text/plain"}}}],"key":"reg4Q8pNo3"}],"key":"jFAWRQFySY"},{"type":"paragraph","position":{"start":{"line":841,"column":1},"end":{"line":841,"column":1}},"children":[{"type":"text","value":"In the Jacobian the derivatives are with respect to the parameters in ","position":{"start":{"line":841,"column":1},"end":{"line":841,"column":1}},"key":"ePTabmz97K"},{"type":"inlineMath","value":"\\mathbf{x}","position":{"start":{"line":841,"column":1},"end":{"line":841,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">x</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{x}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4444em;\"></span><span class=\"mord mathbf\">x</span></span></span></span>","key":"OjMxHqL9LC"},{"type":"text","value":".","position":{"start":{"line":841,"column":1},"end":{"line":841,"column":1}},"key":"Uu46xnCmh3"}],"key":"ZiHyxRuxC5"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"function misfitjac(x)\n    V, Km = x   # rename components for clarity\n    J = zeros(m, 2)\n    J[:, 1] = @. s / (Km + s)              # dw/dV\n    J[:, 2] = @. -V * s / (Km + s)^2         # dw/d_Km\n    return J\nend","key":"KX5B1Vut3o"},{"type":"output","id":"T-iN7HXGfdc8P-mDbre-6","data":[{"output_type":"execute_result","execution_count":70,"metadata":{},"data":{"text/plain":{"content":"misfitjac (generic function with 1 method)","content_type":"text/plain"}}}],"key":"wHOujYcGmk"}],"key":"KOrmbMTxor"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"x₁ = [1, 0.75]\nx = FNC.newtonsys(misfit, misfitjac, x₁)\n\n@show V, Km = x[end]  # final values","key":"TFLLjSyWTC"},{"type":"output","id":"f5yep2ukvIvIKfD1F07wv","data":[{"output_type":"stream","name":"stdout","text":"(V, Km) = x[end] = [1.968652598378229, 0.4693037307416775]"},{"output_type":"stream","name":"stdout","text":"\n"},{"output_type":"execute_result","execution_count":71,"metadata":{},"data":{"text/plain":{"content":"2-element Vector{Float64}:\n 1.968652598378229\n 0.4693037307416775","content_type":"text/plain"}}}],"key":"TWkJHBcuxO"}],"key":"ccOlAJSISk"},{"type":"paragraph","position":{"start":{"line":860,"column":1},"end":{"line":860,"column":1}},"children":[{"type":"text","value":"The final values are reasonably close to the values ","position":{"start":{"line":860,"column":1},"end":{"line":860,"column":1}},"key":"gj07pQk3T6"},{"type":"inlineMath","value":"V=2","position":{"start":{"line":860,"column":1},"end":{"line":860,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>V</mi><mo>=</mo><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">V=2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span></span></span></span>","key":"HreKW0iVY1"},{"type":"text","value":", ","position":{"start":{"line":860,"column":1},"end":{"line":860,"column":1}},"key":"ErSJW2iMJI"},{"type":"inlineMath","value":"K_m=0.5","position":{"start":{"line":860,"column":1},"end":{"line":860,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>K</mi><mi>m</mi></msub><mo>=</mo><mn>0.5</mn></mrow><annotation encoding=\"application/x-tex\">K_m=0.5</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0.5</span></span></span></span>","key":"gALzPyr2kA"},{"type":"text","value":" that we used to generate the noise-free data. Graphically, the model looks close to the original data.","position":{"start":{"line":860,"column":1},"end":{"line":860,"column":1}},"key":"vx6sD5o9AE"}],"key":"lhvF8dKYLG"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"model(s) = V * s / (Km + s)\nplot!(model, 0, 6, label=\"nonlinear fit\")","key":"qIXsHN2QH9"},{"type":"output","id":"epPkh-oK3pNMkn8UTR1F7","data":[{"output_type":"execute_result","execution_count":72,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"cc5c28e4d10ae5ce0aa87ae5dd34d59e","path":"/build/cc5c28e4d10ae5ce0aa87ae5dd34d59e.png"},"text/html":{"content_type":"text/html","hash":"35f1b8741dfe43e5e6322169654319a7","path":"/build/35f1b8741dfe43e5e6322169654319a7.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"6254e0c66513b50a5a9f5a5a1078682a","path":"/build/6254e0c66513b50a5a9f5a5a1078682a.svg"}}}],"key":"E4wWTj4ijn"}],"key":"a6I7q6e6Xq"},{"type":"paragraph","position":{"start":{"line":867,"column":1},"end":{"line":867,"column":1}},"children":[{"type":"text","value":"For this particular model, we also have the option of linearizing the fit process. Rewrite the model as","position":{"start":{"line":867,"column":1},"end":{"line":867,"column":1}},"key":"iPPYwVBXUj"}],"key":"hsfvYKkenG"},{"type":"math","value":"\\frac{1}{w} = \\frac{\\alpha}{s} + \\beta = \\alpha \\cdot s^{-1} + \\beta","enumerated":false,"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mfrac><mn>1</mn><mi>w</mi></mfrac><mo>=</mo><mfrac><mi>α</mi><mi>s</mi></mfrac><mo>+</mo><mi>β</mi><mo>=</mo><mi>α</mi><mo>⋅</mo><msup><mi>s</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo>+</mo><mi>β</mi></mrow><annotation encoding=\"application/x-tex\">\\frac{1}{w} = \\frac{\\alpha}{s} + \\beta = \\alpha \\cdot s^{-1} + \\beta</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.0074em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.7936em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.1076em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">s</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05278em;\">β</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4445em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.9474em;vertical-align:-0.0833em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05278em;\">β</span></span></span></span></span>","key":"r1PoTAbn0y"},{"type":"paragraph","position":{"start":{"line":874,"column":1},"end":{"line":874,"column":1}},"children":[{"type":"text","value":"for the new fitting parameters ","position":{"start":{"line":874,"column":1},"end":{"line":874,"column":1}},"key":"mCanzISPQv"},{"type":"inlineMath","value":"\\alpha=K_m/V","position":{"start":{"line":874,"column":1},"end":{"line":874,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>α</mi><mo>=</mo><msub><mi>K</mi><mi>m</mi></msub><mi mathvariant=\"normal\">/</mi><mi>V</mi></mrow><annotation encoding=\"application/x-tex\">\\alpha=K_m/V</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">/</span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span></span></span></span>","key":"PA5pElCodl"},{"type":"text","value":" and ","position":{"start":{"line":874,"column":1},"end":{"line":874,"column":1}},"key":"qWB0ZSY0Oj"},{"type":"inlineMath","value":"\\beta=1/V","position":{"start":{"line":874,"column":1},"end":{"line":874,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>β</mi><mo>=</mo><mn>1</mn><mi mathvariant=\"normal\">/</mi><mi>V</mi></mrow><annotation encoding=\"application/x-tex\">\\beta=1/V</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05278em;\">β</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1/</span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span></span></span></span>","key":"DGHeqHH8ad"},{"type":"text","value":". This corresponds to the misfit function whose entries are","position":{"start":{"line":874,"column":1},"end":{"line":874,"column":1}},"key":"ZhmyKJtwwO"}],"key":"HrQPKYZo5R"},{"type":"math","value":"f_i([\\alpha,\\beta]) = \\left(\\alpha \\cdot \\frac{1}{s_i} + \\beta\\right) - \\frac{1}{w_i}","position":{"start":{"line":876,"column":1},"end":{"line":876,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>f</mi><mi>i</mi></msub><mo stretchy=\"false\">(</mo><mo stretchy=\"false\">[</mo><mi>α</mi><mo separator=\"true\">,</mo><mi>β</mi><mo stretchy=\"false\">]</mo><mo stretchy=\"false\">)</mo><mo>=</mo><mrow><mo fence=\"true\">(</mo><mi>α</mi><mo>⋅</mo><mfrac><mn>1</mn><msub><mi>s</mi><mi>i</mi></msub></mfrac><mo>+</mo><mi>β</mi><mo fence=\"true\">)</mo></mrow><mo>−</mo><mfrac><mn>1</mn><msub><mi>w</mi><mi>i</mi></msub></mfrac></mrow><annotation encoding=\"application/x-tex\">f_i([\\alpha,\\beta]) = \\left(\\alpha \\cdot \\frac{1}{s_i} + \\beta\\right) - \\frac{1}{w_i}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">([</span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05278em;\">β</span><span class=\"mclose\">])</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.4em;vertical-align:-0.95em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">(</span></span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05278em;\">β</span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">)</span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.1574em;vertical-align:-0.836em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span>","enumerator":"1","key":"GVFM6NZgWm"},{"type":"paragraph","position":{"start":{"line":877,"column":1},"end":{"line":877,"column":1}},"children":[{"type":"text","value":"for ","position":{"start":{"line":877,"column":1},"end":{"line":877,"column":1}},"key":"aR1al1afOf"},{"type":"inlineMath","value":"i=1,\\ldots,m","position":{"start":{"line":877,"column":1},"end":{"line":877,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi><mo>=</mo><mn>1</mn><mo separator=\"true\">,</mo><mo>…</mo><mo separator=\"true\">,</mo><mi>m</mi></mrow><annotation encoding=\"application/x-tex\">i=1,\\ldots,m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8389em;vertical-align:-0.1944em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">m</span></span></span></span>","key":"VrWzP24s9l"},{"type":"text","value":". Although this misfit is nonlinear in ","position":{"start":{"line":877,"column":1},"end":{"line":877,"column":1}},"key":"UkJ869OzXb"},{"type":"inlineMath","value":"s","position":{"start":{"line":877,"column":1},"end":{"line":877,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>s</mi></mrow><annotation encoding=\"application/x-tex\">s</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">s</span></span></span></span>","key":"po49hts45Y"},{"type":"text","value":" and ","position":{"start":{"line":877,"column":1},"end":{"line":877,"column":1}},"key":"JuaLPWGYTB"},{"type":"inlineMath","value":"w","position":{"start":{"line":877,"column":1},"end":{"line":877,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>w</mi></mrow><annotation encoding=\"application/x-tex\">w</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span></span></span></span>","key":"Ik7kbromTa"},{"type":"text","value":", it’s linear in the unknown parameters ","position":{"start":{"line":877,"column":1},"end":{"line":877,"column":1}},"key":"JFAg3Hghm8"},{"type":"inlineMath","value":"\\alpha","position":{"start":{"line":877,"column":1},"end":{"line":877,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>α</mi></mrow><annotation encoding=\"application/x-tex\">\\alpha</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span></span></span></span>","key":"MjBA8CGi0V"},{"type":"text","value":" and ","position":{"start":{"line":877,"column":1},"end":{"line":877,"column":1}},"key":"O7M88S23Sk"},{"type":"inlineMath","value":"\\beta","position":{"start":{"line":877,"column":1},"end":{"line":877,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>β</mi></mrow><annotation encoding=\"application/x-tex\">\\beta</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05278em;\">β</span></span></span></span>","key":"o66dD7dM2l"},{"type":"text","value":". This lets us pose and solve it as a linear least-squares problem.","position":{"start":{"line":877,"column":1},"end":{"line":877,"column":1}},"key":"XE8xuIjsNt"}],"key":"OSKM2mv4tb"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"A = [s .^ (-1) s .^ 0]\nu = 1 ./ w\nα, β = A \\ u","key":"uGgrteE711"},{"type":"output","id":"nAvJbw4wKlerMUSPoE8Hk","data":[{"output_type":"execute_result","execution_count":73,"metadata":{},"data":{"text/plain":{"content":"2-element Vector{Float64}:\n 0.12476333709901538\n 0.5713959100431231","content_type":"text/plain"}}}],"key":"rIlbg8tCeN"}],"key":"M197BFcG9g"},{"type":"paragraph","position":{"start":{"line":885,"column":1},"end":{"line":885,"column":1}},"children":[{"type":"text","value":"The two fits are different because they do not optimize the same quantities.","position":{"start":{"line":885,"column":1},"end":{"line":885,"column":1}},"key":"vRxYX5DQJM"}],"key":"z3Sy6WejYs"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"linmodel(x) = 1 / (β + α / x)\nplot!(linmodel, 0, 6, label=\"linearized fit\")","key":"WTyWusHYuc"},{"type":"output","id":"0cSMjT9-qBRd8LaY0a1T6","data":[{"output_type":"execute_result","execution_count":74,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"6d16fb2d17554d0668bdfb83825c10e7","path":"/build/6d16fb2d17554d0668bdfb83825c10e7.png"},"text/html":{"content_type":"text/html","hash":"7b5fb481292544713dccf16b04c7c33b","path":"/build/7b5fb481292544713dccf16b04c7c33b.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"d502fe58b73e8acc315134e74b268b74","path":"/build/d502fe58b73e8acc315134e74b268b74.svg"}}}],"key":"IhW6STKy5I"}],"key":"SlR4J5UZp6"},{"type":"paragraph","position":{"start":{"line":892,"column":1},"end":{"line":892,"column":1}},"children":[{"type":"text","value":"The truly nonlinear fit is clearly better in this case. It optimizes a residual for the original measured quantity rather than a transformed one we picked for algorithmic convenience.","position":{"start":{"line":892,"column":1},"end":{"line":892,"column":1}},"key":"kvFreoVFH0"}],"key":"yo7j8qBA4J"}],"key":"jptx6fs0d5"}],"key":"A8JpvzPvFP"}],"key":"IowE0OiB4y"},{"type":"tabItem","title":"MATLAB","sync":"matlab","children":[{"type":"embed","source":{"url":"/chapter4-1","label":"demo-nlsq-MM-matlab","kind":"Notebook","slug":"chapter4-1","location":"/matlab/chapter4.md","title":"Chapter 4"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-nlsq-mm","label":"demo-nlsq-MM","kind":"proof:example","position":{"start":{"line":727,"column":1},"end":{"line":727,"column":14}},"children":[{"type":"text","value":"Example ","key":"NSFBpG7Zxj"},{"type":"text","value":"4.7.2","key":"fiFiJDlaf1"}],"template":"Example %s","enumerator":"4.7.2","resolved":true,"html_id":"demo-nlsq-mm","remote":true,"url":"/nlsq","dataUrl":"/nlsq.json","key":"l1Gn9XcWDB"}],"key":"YbbbLvRnOB"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"m = 25; V = 2; Km = 0.5;\ns = linspace(0.05, 6, m)';\nw = V * s ./ (Km + s);                      % exactly on the curve\nw = w + 0.15 * cos(2 * exp(s / 16) .* s);   % noise added\nclf, fplot(@(s) V * s ./ (Km + s), [0, 6], '--')\nhold on, scatter(s, w)\nxlabel('concentration'), ylabel('reaction rate')    \nlabels = [\"ideal\", \"noisy data\"];    \nlegend(labels, 'location', 'east');","key":"qzTiz29GDa"},{"type":"output","id":"hi1XsZ9PGsrL_z5WO2kOw","data":[{"output_type":"execute_result","execution_count":65,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"f10d5f8f6418351ea45ce5bb2e1c6ac3","path":"/build/f10d5f8f6418351ea45ce5bb2e1c6ac3.png"}}}],"key":"SizwF9ubft"}],"key":"OFvDgSAOHI"},{"type":"paragraph","position":{"start":{"line":741,"column":1},"end":{"line":741,"column":1}},"children":[{"type":"text","value":"The idea is to pretend that we know nothing of the origins of this data and use nonlinear least squares to find the parameters in the theoretical model function ","position":{"start":{"line":741,"column":1},"end":{"line":741,"column":1}},"key":"rDTQiyxMAg"},{"type":"inlineMath","value":"v(s)","position":{"start":{"line":741,"column":1},"end":{"line":741,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>v</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">v(s)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">s</span><span class=\"mclose\">)</span></span></span></span>","key":"NqIaW8VD0k"},{"type":"text","value":". In ","position":{"start":{"line":741,"column":1},"end":{"line":741,"column":1}},"key":"whDAzDkFeR"},{"type":"crossReference","kind":"equation","identifier":"nlsq-misfit","label":"nlsq-misfit","children":[{"type":"text","value":"(","key":"Gw0B1HqS7r"},{"type":"text","value":"4.7.2","key":"rqoRHwiiyn"},{"type":"text","value":")","key":"pa8mXrYKiJ"}],"template":"(%s)","enumerator":"4.7.2","resolved":true,"html_id":"nlsq-misfit","remote":true,"url":"/nlsq","dataUrl":"/nlsq.json","key":"paf7aZ7G41"},{"type":"text","value":", the ","position":{"start":{"line":741,"column":1},"end":{"line":741,"column":1}},"key":"wqZbhMJqVb"},{"type":"inlineMath","value":"s","position":{"start":{"line":741,"column":1},"end":{"line":741,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>s</mi></mrow><annotation encoding=\"application/x-tex\">s</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">s</span></span></span></span>","key":"KNGwC3pnvj"},{"type":"text","value":" variable plays the role of ","position":{"start":{"line":741,"column":1},"end":{"line":741,"column":1}},"key":"axDXIcSxTO"},{"type":"inlineMath","value":"t","position":{"start":{"line":741,"column":1},"end":{"line":741,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span></span></span></span>","key":"T4Au2NDFX7"},{"type":"text","value":", and ","position":{"start":{"line":741,"column":1},"end":{"line":741,"column":1}},"key":"q81bhRj8u6"},{"type":"inlineMath","value":"v","position":{"start":{"line":741,"column":1},"end":{"line":741,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>v</mi></mrow><annotation encoding=\"application/x-tex\">v</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span></span></span></span>","key":"lpcGIYbaHS"},{"type":"text","value":" plays the role of ","position":{"start":{"line":741,"column":1},"end":{"line":741,"column":1}},"key":"XcAVA4uGcc"},{"type":"inlineMath","value":"g","position":{"start":{"line":741,"column":1},"end":{"line":741,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>g</mi></mrow><annotation encoding=\"application/x-tex\">g</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span></span></span></span>","key":"VqYQAPI4Jx"},{"type":"text","value":". In the Jacobian, the derivatives are with respect to the parameters in ","position":{"start":{"line":741,"column":1},"end":{"line":741,"column":1}},"key":"xblv3RVXax"},{"type":"inlineMath","value":"\\mathbf{x}","position":{"start":{"line":741,"column":1},"end":{"line":741,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">x</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{x}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4444em;\"></span><span class=\"mord mathbf\">x</span></span></span></span>","key":"FfMYeiHyEu"},{"type":"text","value":".","position":{"start":{"line":741,"column":1},"end":{"line":741,"column":1}},"key":"r7rasXX2mE"}],"key":"LlhXXYg6uX"},{"type":"include","file":"f47_misfit.m","literal":true,"children":[{"type":"code","value":"function [f, J] = misfit(c, s, w)\n    V = c(1);   Km = c(2);\n    f = V * s ./ (Km + s) - w;\n    J(:,1) = s ./ (Km + s);            % d/d(V)\n    J(:,2) = -V * s ./ (Km + s).^2;    % d/d(Km)\nend\n","lang":"matlab","filename":"f47_misfit.m","key":"sgaNrUVHTX"}],"key":"cePffjurjO"},{"type":"paragraph","position":{"start":{"line":747,"column":1},"end":{"line":747,"column":1}},"children":[{"type":"text","value":"The misfit function above has to know the parameters ","position":{"start":{"line":747,"column":1},"end":{"line":747,"column":1}},"key":"QD2q2fVYwI"},{"type":"inlineCode","value":"x","position":{"start":{"line":747,"column":1},"end":{"line":747,"column":1}},"key":"hZqlDsW6qw"},{"type":"text","value":" that are being optimized as well as the data ","position":{"start":{"line":747,"column":1},"end":{"line":747,"column":1}},"key":"BDGG4zXyw9"},{"type":"inlineCode","value":"s","position":{"start":{"line":747,"column":1},"end":{"line":747,"column":1}},"key":"TZsyiCCpEv"},{"type":"text","value":" and ","position":{"start":{"line":747,"column":1},"end":{"line":747,"column":1}},"key":"bgOSaW13He"},{"type":"inlineCode","value":"w","position":{"start":{"line":747,"column":1},"end":{"line":747,"column":1}},"key":"vfXuakzFhu"},{"type":"text","value":" that remain fixed. We use a closure to pass the data values along.","position":{"start":{"line":747,"column":1},"end":{"line":747,"column":1}},"key":"GWx854HoHv"}],"key":"hqEY1ZskZA"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"f = @(x) f47_misfit(x, s, w);","key":"IM4nIUEcZb"},{"type":"output","id":"Wx-ogL4L0bbDvzxVFfN3X","data":[],"key":"Y1k3Zetk4M"}],"key":"Ae6yrOgqzY"},{"type":"paragraph","position":{"start":{"line":753,"column":1},"end":{"line":753,"column":1}},"children":[{"type":"text","value":"Now we have a function that accepts a single 2-vector input and returns a 25-vector output. We can pass this function to ","position":{"start":{"line":753,"column":1},"end":{"line":753,"column":1}},"key":"c8sQZm5rUX"},{"type":"inlineCode","value":"levenberg","position":{"start":{"line":753,"column":1},"end":{"line":753,"column":1}},"key":"uHXpYAUjE9"},{"type":"text","value":" to find the best-fit parameters.","position":{"start":{"line":753,"column":1},"end":{"line":753,"column":1}},"key":"Qwomrj1Vln"}],"key":"EZtYuSaD2U"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"x1 = [1; 0.75];\nx = newtonsys(f, x1);\nV = x(1, end),  Km = x(2, end)     % final values\nmodel = @(s) V * s ./ (Km + s);    % best-fit model","key":"WMZcVStHmn"},{"type":"output","id":"q7qDBER04ThGLgV_pykq8","data":[{"output_type":"execute_result","execution_count":67,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>V = \n   1.9687e+00\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"V = \n   1.9687e+00\n","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":67,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>Km = \n   4.6930e-01\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"Km = \n   4.6930e-01\n","content_type":"text/plain"}}}],"key":"QcICRXvC5J"}],"key":"X0O5dyqvam"},{"type":"paragraph","position":{"start":{"line":762,"column":1},"end":{"line":762,"column":1}},"children":[{"type":"text","value":"The final values are reasonably close to the values ","position":{"start":{"line":762,"column":1},"end":{"line":762,"column":1}},"key":"ESwrMX5DKd"},{"type":"inlineMath","value":"V=2","position":{"start":{"line":762,"column":1},"end":{"line":762,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>V</mi><mo>=</mo><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">V=2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span></span></span></span>","key":"QmLvW8cjxh"},{"type":"text","value":", ","position":{"start":{"line":762,"column":1},"end":{"line":762,"column":1}},"key":"VoODHmfQHh"},{"type":"inlineMath","value":"K_m=0.5","position":{"start":{"line":762,"column":1},"end":{"line":762,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>K</mi><mi>m</mi></msub><mo>=</mo><mn>0.5</mn></mrow><annotation encoding=\"application/x-tex\">K_m=0.5</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0.5</span></span></span></span>","key":"WUA6rHEkBh"},{"type":"text","value":" that we used to generate the noise-free data. Graphically, the model looks close to the original data:","position":{"start":{"line":762,"column":1},"end":{"line":762,"column":1}},"key":"pqDTRXAept"}],"key":"xtKynma8tW"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"final_misfit_norm = norm(model(s) - w) \nhold on, fplot(model, [0, 6])\ntitle('Michaelis-Menten fitting')    \nlabels = [labels, \"nonlinear fit\"];    \nlegend(labels, 'location', 'east');","key":"T63b53k1Jh"},{"type":"output","id":"QRZErfMDFLVEtEhjRSGW6","data":[{"output_type":"execute_result","execution_count":68,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>final_misfit_norm = \n   5.2340e-01\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"final_misfit_norm = \n   5.2340e-01\n","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":68,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"20e0e7093c79e2d1535d5f9e743168fa","path":"/build/20e0e7093c79e2d1535d5f9e743168fa.png"}}}],"key":"TbB81LVgsX"}],"key":"IgbOb9lz7i"},{"type":"paragraph","position":{"start":{"line":772,"column":1},"end":{"line":772,"column":1}},"children":[{"type":"text","value":"For this particular model, we also have the option of linearizing the fit process. Rewrite the model as","position":{"start":{"line":772,"column":1},"end":{"line":772,"column":1}},"key":"Hc8K9hy6Pd"}],"key":"qYTgoDpYRN"},{"type":"math","value":"\\frac{1}{w} = \\frac{\\alpha}{s} + \\beta = \\alpha \\cdot s^{-1} + \\beta","enumerated":false,"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mfrac><mn>1</mn><mi>w</mi></mfrac><mo>=</mo><mfrac><mi>α</mi><mi>s</mi></mfrac><mo>+</mo><mi>β</mi><mo>=</mo><mi>α</mi><mo>⋅</mo><msup><mi>s</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo>+</mo><mi>β</mi></mrow><annotation encoding=\"application/x-tex\">\\frac{1}{w} = \\frac{\\alpha}{s} + \\beta = \\alpha \\cdot s^{-1} + \\beta</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.0074em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.7936em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.1076em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">s</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05278em;\">β</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4445em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.9474em;vertical-align:-0.0833em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05278em;\">β</span></span></span></span></span>","key":"njXhmqzmkU"},{"type":"paragraph","position":{"start":{"line":779,"column":1},"end":{"line":779,"column":1}},"children":[{"type":"text","value":"for the new fitting parameters ","position":{"start":{"line":779,"column":1},"end":{"line":779,"column":1}},"key":"uBGbGfVyoP"},{"type":"inlineMath","value":"\\alpha=K_m/V","position":{"start":{"line":779,"column":1},"end":{"line":779,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>α</mi><mo>=</mo><msub><mi>K</mi><mi>m</mi></msub><mi mathvariant=\"normal\">/</mi><mi>V</mi></mrow><annotation encoding=\"application/x-tex\">\\alpha=K_m/V</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">/</span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span></span></span></span>","key":"ZqgynLNrWg"},{"type":"text","value":" and ","position":{"start":{"line":779,"column":1},"end":{"line":779,"column":1}},"key":"bsUPiOZZwh"},{"type":"inlineMath","value":"\\beta=1/V","position":{"start":{"line":779,"column":1},"end":{"line":779,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>β</mi><mo>=</mo><mn>1</mn><mi mathvariant=\"normal\">/</mi><mi>V</mi></mrow><annotation encoding=\"application/x-tex\">\\beta=1/V</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05278em;\">β</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1/</span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span></span></span></span>","key":"WATOq8Fpsj"},{"type":"text","value":". This corresponds to the misfit function whose entries are","position":{"start":{"line":779,"column":1},"end":{"line":779,"column":1}},"key":"HUn1KOlqDH"}],"key":"Zkex2KC9ww"},{"type":"math","value":"f_i([\\alpha,\\beta]) = \\left(\\alpha \\cdot \\frac{1}{s_i} + \\beta\\right) - \\frac{1}{w_i}","position":{"start":{"line":781,"column":1},"end":{"line":781,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>f</mi><mi>i</mi></msub><mo stretchy=\"false\">(</mo><mo stretchy=\"false\">[</mo><mi>α</mi><mo separator=\"true\">,</mo><mi>β</mi><mo stretchy=\"false\">]</mo><mo stretchy=\"false\">)</mo><mo>=</mo><mrow><mo fence=\"true\">(</mo><mi>α</mi><mo>⋅</mo><mfrac><mn>1</mn><msub><mi>s</mi><mi>i</mi></msub></mfrac><mo>+</mo><mi>β</mi><mo fence=\"true\">)</mo></mrow><mo>−</mo><mfrac><mn>1</mn><msub><mi>w</mi><mi>i</mi></msub></mfrac></mrow><annotation encoding=\"application/x-tex\">f_i([\\alpha,\\beta]) = \\left(\\alpha \\cdot \\frac{1}{s_i} + \\beta\\right) - \\frac{1}{w_i}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">([</span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05278em;\">β</span><span class=\"mclose\">])</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.4em;vertical-align:-0.95em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">(</span></span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05278em;\">β</span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">)</span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.1574em;vertical-align:-0.836em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span>","enumerator":"1","key":"lINHGCPBNW"},{"type":"paragraph","position":{"start":{"line":783,"column":1},"end":{"line":783,"column":1}},"children":[{"type":"text","value":"for ","position":{"start":{"line":783,"column":1},"end":{"line":783,"column":1}},"key":"wA7we3VE6v"},{"type":"inlineMath","value":"i=1,\\ldots,m","position":{"start":{"line":783,"column":1},"end":{"line":783,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi><mo>=</mo><mn>1</mn><mo separator=\"true\">,</mo><mo>…</mo><mo separator=\"true\">,</mo><mi>m</mi></mrow><annotation encoding=\"application/x-tex\">i=1,\\ldots,m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8389em;vertical-align:-0.1944em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">m</span></span></span></span>","key":"bsMTrzKvzU"},{"type":"text","value":". Although this misfit is nonlinear in ","position":{"start":{"line":783,"column":1},"end":{"line":783,"column":1}},"key":"CQ5mhYOT4c"},{"type":"inlineMath","value":"s","position":{"start":{"line":783,"column":1},"end":{"line":783,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>s</mi></mrow><annotation encoding=\"application/x-tex\">s</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">s</span></span></span></span>","key":"okVJBEbDeR"},{"type":"text","value":" and ","position":{"start":{"line":783,"column":1},"end":{"line":783,"column":1}},"key":"Y01ckPhgVf"},{"type":"inlineMath","value":"w","position":{"start":{"line":783,"column":1},"end":{"line":783,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>w</mi></mrow><annotation encoding=\"application/x-tex\">w</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span></span></span></span>","key":"UI0mKdCS9F"},{"type":"text","value":", it’s linear in the unknown parameters ","position":{"start":{"line":783,"column":1},"end":{"line":783,"column":1}},"key":"lOGYRENF3o"},{"type":"inlineMath","value":"\\alpha","position":{"start":{"line":783,"column":1},"end":{"line":783,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>α</mi></mrow><annotation encoding=\"application/x-tex\">\\alpha</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span></span></span></span>","key":"hBFxjIkvwa"},{"type":"text","value":" and ","position":{"start":{"line":783,"column":1},"end":{"line":783,"column":1}},"key":"SQqaOm7NKL"},{"type":"inlineMath","value":"\\beta","position":{"start":{"line":783,"column":1},"end":{"line":783,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>β</mi></mrow><annotation encoding=\"application/x-tex\">\\beta</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05278em;\">β</span></span></span></span>","key":"Bhvu1lIhZc"},{"type":"text","value":". This lets us pose and solve it as a linear least-squares problem.","position":{"start":{"line":783,"column":1},"end":{"line":783,"column":1}},"key":"N4scXA6iV6"}],"key":"TIXsDtBBuz"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"u = 1 ./ w;\nA = [s.^(-1), s.^0];  \nz = A \\ u;\nalpha = z(1);  beta = z(2);","key":"vzVi83TDsa"},{"type":"output","id":"1i5ArULmzBsIQvQgkD6XP","data":[],"key":"MWotHpGf7P"}],"key":"sNT07Shlw1"},{"type":"paragraph","position":{"start":{"line":792,"column":1},"end":{"line":792,"column":1}},"children":[{"type":"text","value":"The two fits are different because they do not optimize the same quantities.","position":{"start":{"line":792,"column":1},"end":{"line":792,"column":1}},"key":"OKMdTNoE37"}],"key":"lCdLWJriZd"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"linmodel = @(s) 1 ./ (beta + alpha ./ s);\nfinal_misfit_linearized = norm(linmodel(s) - w)\nfplot(linmodel, [0, 6])\nlabels = [labels, \"linearized fit\"];    \nlegend(labels, 'location', 'east');","key":"k3tK557OKh"},{"type":"output","id":"t1E26DGdh9s8O-A1BZ3H1","data":[{"output_type":"execute_result","execution_count":70,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>final_misfit_linearized = \n   7.4871e-01\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"final_misfit_linearized = \n   7.4871e-01\n","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":70,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"46254c323ee040e7e5a2b1c780953873","path":"/build/46254c323ee040e7e5a2b1c780953873.png"}}}],"key":"Hkt0BS9Gby"}],"key":"y2RaDI5f8r"},{"type":"paragraph","position":{"start":{"line":802,"column":1},"end":{"line":802,"column":1}},"children":[{"type":"text","value":"The truly nonlinear fit is clearly better in this case. It optimizes a residual for the original measured quantity rather than a transformed one we picked for algorithmic convenience.","position":{"start":{"line":802,"column":1},"end":{"line":802,"column":1}},"key":"tqEyIoSHe3"}],"key":"K27hWVbT5k"}],"key":"EGiv0aHKNz"}],"key":"salANBAOmt"}],"key":"NSa0wtqhGn"},{"type":"tabItem","title":"Python","sync":"python","children":[{"type":"embed","source":{"url":"/chapter4-2","label":"demo-nlsq-MM-python","kind":"Notebook","slug":"chapter4-2","location":"/python/chapter4.md","title":"Chapter 4"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-nlsq-mm","label":"demo-nlsq-MM","kind":"proof:example","position":{"start":{"line":801,"column":1},"end":{"line":801,"column":14}},"children":[{"type":"text","value":"Example ","key":"Rra4RBltug"},{"type":"text","value":"4.7.2","key":"SVfj7yiXub"}],"template":"Example %s","enumerator":"4.7.2","resolved":true,"html_id":"demo-nlsq-mm","remote":true,"url":"/nlsq","dataUrl":"/nlsq.json","key":"OETELGooPF"}],"key":"rm7qgTbHPd"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"m = 25\nV, Km = 2, 0.5\ns = linspace(0.05, 6, m)\nmodel = lambda x: V * x / (Km + x)\nw = model(s) + 0.15 * cos(2 * exp(s / 16) * s)    # noise added\n\nfig, ax = subplots()\nax.scatter(s, w, label=\"data\")\nax.plot(s, model(s), 'k--', label=\"unperturbed model\")\nxlabel(\"s\"), ylabel(\"w\")\nlegend();","key":"J0YVo5efBz"},{"type":"output","id":"kGqCsPqfwR3GA_NJhquzC","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"58b1734c192de94e2091c2bb1c08fa3a","path":"/build/58b1734c192de94e2091c2bb1c08fa3a.png"}}}],"key":"mcTF9ahFGn"}],"key":"dZopRyRXDR"},{"type":"paragraph","position":{"start":{"line":820,"column":1},"end":{"line":820,"column":1}},"children":[{"type":"text","value":"The idea is to pretend that we know nothing of the origins of this data and use nonlinear least squares to find the parameters in the theoretical model function ","position":{"start":{"line":820,"column":1},"end":{"line":820,"column":1}},"key":"IFMtZHAIZN"},{"type":"inlineMath","value":"v(s)","position":{"start":{"line":820,"column":1},"end":{"line":820,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>v</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">v(s)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">s</span><span class=\"mclose\">)</span></span></span></span>","key":"ANmVcYT8BX"},{"type":"text","value":". In ","position":{"start":{"line":820,"column":1},"end":{"line":820,"column":1}},"key":"YiLzYnwy69"},{"type":"crossReference","kind":"equation","identifier":"nlsq-misfit","label":"nlsq-misfit","children":[{"type":"text","value":"(","key":"SulOziB74p"},{"type":"text","value":"4.7.2","key":"G3ZfrKD2re"},{"type":"text","value":")","key":"MW6ulzaFo5"}],"template":"(%s)","enumerator":"4.7.2","resolved":true,"html_id":"nlsq-misfit","remote":true,"url":"/nlsq","dataUrl":"/nlsq.json","key":"HpWwwDIRgw"},{"type":"text","value":", the ","position":{"start":{"line":820,"column":1},"end":{"line":820,"column":1}},"key":"z8mnOdrGTK"},{"type":"inlineMath","value":"s","position":{"start":{"line":820,"column":1},"end":{"line":820,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>s</mi></mrow><annotation encoding=\"application/x-tex\">s</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">s</span></span></span></span>","key":"JOXw3gvLNv"},{"type":"text","value":" variable plays the role of ","position":{"start":{"line":820,"column":1},"end":{"line":820,"column":1}},"key":"bcnm7KpPG6"},{"type":"inlineMath","value":"t","position":{"start":{"line":820,"column":1},"end":{"line":820,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span></span></span></span>","key":"y6lwtTt4Rb"},{"type":"text","value":", and ","position":{"start":{"line":820,"column":1},"end":{"line":820,"column":1}},"key":"cmRjiWcE1X"},{"type":"inlineMath","value":"v","position":{"start":{"line":820,"column":1},"end":{"line":820,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>v</mi></mrow><annotation encoding=\"application/x-tex\">v</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span></span></span></span>","key":"ELiDFUaTMg"},{"type":"text","value":" plays the role of ","position":{"start":{"line":820,"column":1},"end":{"line":820,"column":1}},"key":"ULj36BB5Z0"},{"type":"inlineMath","value":"g","position":{"start":{"line":820,"column":1},"end":{"line":820,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>g</mi></mrow><annotation encoding=\"application/x-tex\">g</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span></span></span></span>","key":"BpB2q2WUrs"},{"type":"text","value":".","position":{"start":{"line":820,"column":1},"end":{"line":820,"column":1}},"key":"tOtYqJ5Ebx"}],"indexEntries":[{"entry":"Python","subEntry":{"value":"destructuring","kind":"entry"},"emphasis":true}],"key":"D0n4iogcub"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"bFhX9sphZl"}],"key":"rlgolAN7nr"},{"type":"paragraph","position":{"start":{"line":823,"column":1},"end":{"line":823,"column":1}},"children":[{"type":"text","value":"Putting comma-separated values on the left of an assignment will ","position":{"start":{"line":823,"column":1},"end":{"line":823,"column":1}},"key":"RLi82u25Ol"},{"type":"strong","position":{"start":{"line":823,"column":1},"end":{"line":823,"column":1}},"children":[{"type":"text","value":"destructure","position":{"start":{"line":823,"column":1},"end":{"line":823,"column":1}},"key":"XBIRukCU6R"}],"key":"X0ElKA5C8Z"},{"type":"text","value":" the right-hand side, drawing individual assignments from entries of a vector, for example.","position":{"start":{"line":823,"column":1},"end":{"line":823,"column":1}},"key":"XQI0lw2d1k"}],"key":"OAX7OFOF9z"}],"class":"dropdown","key":"QJrWB0kPcB"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def misfit(c):\n    V, Km = c  # rename components for clarity\n    f = V * s / (Km + s) - w\n    return f","key":"IkUd4z8jy6"},{"type":"output","id":"sQbaql4GiDzn_Q6AmiEA3","data":[],"key":"oEtUIb9h15"}],"key":"XeLBf6P24S"},{"type":"paragraph","position":{"start":{"line":833,"column":1},"end":{"line":833,"column":1}},"children":[{"type":"text","value":"In the Jacobian the derivatives are with respect to the parameters in ","position":{"start":{"line":833,"column":1},"end":{"line":833,"column":1}},"key":"P6t5QTcvPR"},{"type":"inlineMath","value":"\\mathbf{x}","position":{"start":{"line":833,"column":1},"end":{"line":833,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">x</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{x}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4444em;\"></span><span class=\"mord mathbf\">x</span></span></span></span>","key":"FK3u1p0QoS"},{"type":"text","value":".","position":{"start":{"line":833,"column":1},"end":{"line":833,"column":1}},"key":"EiQsqmO9MS"}],"key":"yHXYRATJ3X"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def misfitjac(x):\n    V, Km = x   # rename components for clarity\n    J = zeros([m, 2])\n    J[:, 0] = s / (Km + s)          # d/d(V)\n    J[:, 1] = -V * s / (Km + s)**2  # d/d(Km)\n    return J","key":"WHjJNDWmKW"},{"type":"output","id":"C47EHZTuOlm_zZz8KcN1I","data":[],"key":"p2qxN7jvpc"}],"key":"QCdLJD2QAq"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"x1 = [1, 0.75]\nx = FNC.newtonsys(misfit, misfitjac, x1)\nV, Km = x[-1]  # final values\nprint(f\"estimates are V = {V:.3f}, Km = {Km:.3f}\")","key":"hnnDKynBqf"},{"type":"output","id":"pJDn6Li4B5GwYoZjcwOY-","data":[{"output_type":"stream","name":"stdout","text":"estimates are V = 1.969, Km = 0.469\n"}],"key":"shhpG9bSdz"}],"key":"wW8PzNySVQ"},{"type":"paragraph","position":{"start":{"line":851,"column":1},"end":{"line":851,"column":1}},"children":[{"type":"text","value":"The final values are reasonably close to the values ","position":{"start":{"line":851,"column":1},"end":{"line":851,"column":1}},"key":"RQZq52wH01"},{"type":"inlineMath","value":"V=2","position":{"start":{"line":851,"column":1},"end":{"line":851,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>V</mi><mo>=</mo><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">V=2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span></span></span></span>","key":"n8HT2TbxEV"},{"type":"text","value":", ","position":{"start":{"line":851,"column":1},"end":{"line":851,"column":1}},"key":"Jb9Q6kOZHQ"},{"type":"inlineMath","value":"K_m=0.5","position":{"start":{"line":851,"column":1},"end":{"line":851,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>K</mi><mi>m</mi></msub><mo>=</mo><mn>0.5</mn></mrow><annotation encoding=\"application/x-tex\">K_m=0.5</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0.5</span></span></span></span>","key":"A08JVeD34P"},{"type":"text","value":" that we used to generate the noise-free data. Graphically, the model looks close to the original data.","position":{"start":{"line":851,"column":1},"end":{"line":851,"column":1}},"key":"S2htL2Gap9"}],"key":"b37bwgBl9f"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# since V and Km have been updated, model() is too\nax.plot(s, model(s), label=\"nonlinear fit\")","key":"Y7WNGc2lAY"},{"type":"output","id":"CeanDx0i-WM2UNKhWc_eo","data":[],"key":"e9nMmjagkl"}],"key":"En10J4CFg2"},{"type":"paragraph","position":{"start":{"line":858,"column":1},"end":{"line":858,"column":1}},"children":[{"type":"text","value":"For this particular model, we also have the option of linearizing the fit process. Rewrite the model as","position":{"start":{"line":858,"column":1},"end":{"line":858,"column":1}},"key":"vhfp6smOqk"}],"key":"lb1loz1ra2"},{"type":"math","value":"\\frac{1}{w} = \\frac{\\alpha}{s} + \\beta = \\alpha \\cdot s^{-1} + \\beta","enumerated":false,"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mfrac><mn>1</mn><mi>w</mi></mfrac><mo>=</mo><mfrac><mi>α</mi><mi>s</mi></mfrac><mo>+</mo><mi>β</mi><mo>=</mo><mi>α</mi><mo>⋅</mo><msup><mi>s</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo>+</mo><mi>β</mi></mrow><annotation encoding=\"application/x-tex\">\\frac{1}{w} = \\frac{\\alpha}{s} + \\beta = \\alpha \\cdot s^{-1} + \\beta</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.0074em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.7936em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.1076em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">s</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05278em;\">β</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4445em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.9474em;vertical-align:-0.0833em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05278em;\">β</span></span></span></span></span>","key":"gTy010lj4W"},{"type":"paragraph","position":{"start":{"line":865,"column":1},"end":{"line":865,"column":1}},"children":[{"type":"text","value":"for the new fitting parameters ","position":{"start":{"line":865,"column":1},"end":{"line":865,"column":1}},"key":"WQTA8lILa4"},{"type":"inlineMath","value":"\\alpha=K_m/V","position":{"start":{"line":865,"column":1},"end":{"line":865,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>α</mi><mo>=</mo><msub><mi>K</mi><mi>m</mi></msub><mi mathvariant=\"normal\">/</mi><mi>V</mi></mrow><annotation encoding=\"application/x-tex\">\\alpha=K_m/V</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">/</span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span></span></span></span>","key":"YO2IeUnD1h"},{"type":"text","value":" and ","position":{"start":{"line":865,"column":1},"end":{"line":865,"column":1}},"key":"ygeQJ7cOfW"},{"type":"inlineMath","value":"\\beta=1/V","position":{"start":{"line":865,"column":1},"end":{"line":865,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>β</mi><mo>=</mo><mn>1</mn><mi mathvariant=\"normal\">/</mi><mi>V</mi></mrow><annotation encoding=\"application/x-tex\">\\beta=1/V</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05278em;\">β</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1/</span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span></span></span></span>","key":"hkPusx8HvQ"},{"type":"text","value":". This corresponds to the misfit function whose entries are","position":{"start":{"line":865,"column":1},"end":{"line":865,"column":1}},"key":"mtwWrnw5Cj"}],"key":"Fewoxtypxd"},{"type":"math","value":"f_i([\\alpha,\\beta]) = \\left(\\alpha \\cdot \\frac{1}{s_i} + \\beta\\right) - \\frac{1}{w_i}","position":{"start":{"line":867,"column":1},"end":{"line":867,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>f</mi><mi>i</mi></msub><mo stretchy=\"false\">(</mo><mo stretchy=\"false\">[</mo><mi>α</mi><mo separator=\"true\">,</mo><mi>β</mi><mo stretchy=\"false\">]</mo><mo stretchy=\"false\">)</mo><mo>=</mo><mrow><mo fence=\"true\">(</mo><mi>α</mi><mo>⋅</mo><mfrac><mn>1</mn><msub><mi>s</mi><mi>i</mi></msub></mfrac><mo>+</mo><mi>β</mi><mo fence=\"true\">)</mo></mrow><mo>−</mo><mfrac><mn>1</mn><msub><mi>w</mi><mi>i</mi></msub></mfrac></mrow><annotation encoding=\"application/x-tex\">f_i([\\alpha,\\beta]) = \\left(\\alpha \\cdot \\frac{1}{s_i} + \\beta\\right) - \\frac{1}{w_i}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">([</span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05278em;\">β</span><span class=\"mclose\">])</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.4em;vertical-align:-0.95em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">(</span></span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05278em;\">β</span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">)</span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.1574em;vertical-align:-0.836em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span>","enumerator":"1","key":"OOKPtvrIyW"},{"type":"paragraph","position":{"start":{"line":868,"column":1},"end":{"line":868,"column":1}},"children":[{"type":"text","value":"for ","position":{"start":{"line":868,"column":1},"end":{"line":868,"column":1}},"key":"DMOSB5sdPi"},{"type":"inlineMath","value":"i=1,\\ldots,m","position":{"start":{"line":868,"column":1},"end":{"line":868,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi><mo>=</mo><mn>1</mn><mo separator=\"true\">,</mo><mo>…</mo><mo separator=\"true\">,</mo><mi>m</mi></mrow><annotation encoding=\"application/x-tex\">i=1,\\ldots,m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8389em;vertical-align:-0.1944em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">m</span></span></span></span>","key":"H6Z553KR65"},{"type":"text","value":". Although this misfit is nonlinear in ","position":{"start":{"line":868,"column":1},"end":{"line":868,"column":1}},"key":"deuzxWBOmS"},{"type":"inlineMath","value":"s","position":{"start":{"line":868,"column":1},"end":{"line":868,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>s</mi></mrow><annotation encoding=\"application/x-tex\">s</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">s</span></span></span></span>","key":"I0eqFpTSdV"},{"type":"text","value":" and ","position":{"start":{"line":868,"column":1},"end":{"line":868,"column":1}},"key":"AOSnznoPgO"},{"type":"inlineMath","value":"w","position":{"start":{"line":868,"column":1},"end":{"line":868,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>w</mi></mrow><annotation encoding=\"application/x-tex\">w</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span></span></span></span>","key":"Zda32JjnFo"},{"type":"text","value":", it’s linear in the unknown parameters ","position":{"start":{"line":868,"column":1},"end":{"line":868,"column":1}},"key":"U5OiDLCc55"},{"type":"inlineMath","value":"\\alpha","position":{"start":{"line":868,"column":1},"end":{"line":868,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>α</mi></mrow><annotation encoding=\"application/x-tex\">\\alpha</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span></span></span></span>","key":"vFBDOAFUW8"},{"type":"text","value":" and ","position":{"start":{"line":868,"column":1},"end":{"line":868,"column":1}},"key":"shGfUH6NY7"},{"type":"inlineMath","value":"\\beta","position":{"start":{"line":868,"column":1},"end":{"line":868,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>β</mi></mrow><annotation encoding=\"application/x-tex\">\\beta</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05278em;\">β</span></span></span></span>","key":"ihfWzsdg4p"},{"type":"text","value":". This lets us pose and solve it as a linear least-squares problem.","position":{"start":{"line":868,"column":1},"end":{"line":868,"column":1}},"key":"WeR2D8NOF1"}],"key":"UpQL1wV6rH"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from numpy.linalg import lstsq\nA = array( [[1 / s[i], 1.0] for i in range(len(s))] )\nz = lstsq(A, 1 / w, rcond=None)[0]\nalpha, beta = z\nprint(\"alpha:\", alpha, \"beta:\", beta)","key":"DN8fImUc8H"},{"type":"output","id":"q6neFkF_8MOfsu2TDPU5i","data":[{"output_type":"stream","name":"stdout","text":"alpha: 0.12476333709901528 beta: 0.5713959100431233\n"}],"key":"rZbEJGZvHr"}],"key":"RzGNY7FxMY"},{"type":"paragraph","position":{"start":{"line":878,"column":1},"end":{"line":878,"column":1}},"children":[{"type":"text","value":"The two fits are different; they do not optimize the same quantities.","position":{"start":{"line":878,"column":1},"end":{"line":878,"column":1}},"key":"K6mgdfJm0f"}],"key":"aUjvLGBxh1"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"linmodel = lambda x: 1 / (beta + alpha / x)\nax.plot(s, linmodel(s), label=\"linear fit\")\nax.legend()\nfig","key":"rotXBs58Lv"},{"type":"output","id":"Gr07rS_N0qZ61c9bygYtN","data":[{"output_type":"execute_result","execution_count":71,"metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"7f52dbc8b1b5485971ae337c594fb7b2","path":"/build/7f52dbc8b1b5485971ae337c594fb7b2.png"}}}],"key":"N0IEUU6Pli"}],"key":"AcEcvItNPz"},{"type":"paragraph","position":{"start":{"line":887,"column":1},"end":{"line":887,"column":1}},"children":[{"type":"text","value":"The truly nonlinear fit is clearly better in this case. It optimizes a residual for the original measured quantity rather than a transformed one we picked for algorithmic convenience.","position":{"start":{"line":887,"column":1},"end":{"line":887,"column":1}},"key":"G0XsgkqoD8"}],"key":"EiqNgTq30J"}],"key":"nrdQ6etxtI"}],"key":"XZKO9UDGLH"}],"key":"uSjhylQGSb"}],"key":"t8XpgvJHGK"}],"label":"demo-nlsq-MM","identifier":"demo-nlsq-mm","enumerator":"4.7.2","html_id":"demo-nlsq-mm","key":"wCXJjAn4m1"},{"type":"heading","depth":2,"position":{"start":{"line":145,"column":1},"end":{"line":145,"column":1}},"children":[{"type":"text","value":"Exercises","position":{"start":{"line":145,"column":1},"end":{"line":145,"column":1}},"key":"H9Xu7HIkJx"}],"identifier":"exercises","label":"Exercises","html_id":"exercises","implicit":true,"enumerator":"4.7.4","key":"Bg6Edc4ve5"},{"type":"exercise","children":[{"type":"paragraph","position":{"start":{"line":149,"column":1},"end":{"line":149,"column":1}},"children":[{"type":"text","value":"✍ Define ","position":{"start":{"line":149,"column":1},"end":{"line":149,"column":1}},"key":"kZbrNhh2r3"},{"type":"inlineMath","value":"\\mathbf{f}(x)=[ x-8, \\; x^2-4 ]","position":{"start":{"line":149,"column":1},"end":{"line":149,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">f</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mo stretchy=\"false\">[</mo><mi>x</mi><mo>−</mo><mn>8</mn><mo separator=\"true\">,</mo><mtext>  </mtext><msup><mi>x</mi><mn>2</mn></msup><mo>−</mo><mn>4</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">\\mathbf{f}(x)=[ x-8, \\; x^2-4 ]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.10903em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0085em;vertical-align:-0.1944em;\"></span><span class=\"mord\">8</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">4</span><span class=\"mclose\">]</span></span></span></span>","key":"eTSpYswcar"},{"type":"text","value":".","position":{"start":{"line":149,"column":1},"end":{"line":149,"column":1}},"key":"C2HkxDA4wx"}],"key":"l8v0vs7zTN"},{"type":"paragraph","position":{"start":{"line":151,"column":1},"end":{"line":151,"column":1}},"children":[{"type":"strong","position":{"start":{"line":151,"column":1},"end":{"line":151,"column":1}},"children":[{"type":"text","value":"(a)","position":{"start":{"line":151,"column":1},"end":{"line":151,"column":1}},"key":"M0YKdGfD1C"}],"key":"fMdw7REVmS"},{"type":"text","value":" Write out the linear model of ","position":{"start":{"line":151,"column":1},"end":{"line":151,"column":1}},"key":"Cd42UJouyu"},{"type":"inlineMath","value":"\\mathbf{f}","position":{"start":{"line":151,"column":1},"end":{"line":151,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">f</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{f}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.10903em;\">f</span></span></span></span>","key":"F5wGAqBkeu"},{"type":"text","value":" at ","position":{"start":{"line":151,"column":1},"end":{"line":151,"column":1}},"key":"odqQFtgLu2"},{"type":"inlineMath","value":"x=2","position":{"start":{"line":151,"column":1},"end":{"line":151,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mo>=</mo><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">x=2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span></span></span></span>","key":"D4mHZbcDW7"},{"type":"text","value":".","position":{"start":{"line":151,"column":1},"end":{"line":151,"column":1}},"key":"vmN2bdUpgu"}],"key":"a93QJbv4f6"},{"type":"paragraph","position":{"start":{"line":153,"column":1},"end":{"line":153,"column":1}},"children":[{"type":"strong","position":{"start":{"line":153,"column":1},"end":{"line":153,"column":1}},"children":[{"type":"text","value":"(b)","position":{"start":{"line":153,"column":1},"end":{"line":153,"column":1}},"key":"BQhU9Cz3f1"}],"key":"eRzgh6w7pA"},{"type":"text","value":" Find the estimate produced by one step of the Gauss–Newton method, starting at ","position":{"start":{"line":153,"column":1},"end":{"line":153,"column":1}},"key":"s2v03yLbD1"},{"type":"inlineMath","value":"x=2","position":{"start":{"line":153,"column":1},"end":{"line":153,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mo>=</mo><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">x=2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span></span></span></span>","key":"hqxQykheqV"},{"type":"text","value":".","position":{"start":{"line":153,"column":1},"end":{"line":153,"column":1}},"key":"ETW9HO4yxb"}],"key":"MXtC2vlfc8"}],"label":"problem-nlsq-onevar","identifier":"problem-nlsq-onevar","enumerated":true,"enumerator":"4.7.1","html_id":"problem-nlsq-onevar","key":"w1QhnQGcev"},{"type":"exercise","children":[{"type":"paragraph","position":{"start":{"line":158,"column":1},"end":{"line":158,"column":1}},"children":[{"type":"text","value":"✍ (Continuation of ","position":{"start":{"line":158,"column":1},"end":{"line":158,"column":1}},"key":"QK7qJkE4kz"},{"type":"crossReference","identifier":"problem-nlsq-onevar","label":"problem-nlsq-onevar","kind":"exercise","position":{"start":{"line":158,"column":20},"end":{"line":158,"column":40}},"children":[{"type":"text","value":"Exercise ","key":"jOuHgsrntQ"},{"type":"text","value":"4.7.1","key":"dCmJu6jElM"}],"template":"Exercise %s","enumerator":"4.7.1","resolved":true,"html_id":"problem-nlsq-onevar","key":"MrhlJlsWHI"},{"type":"text","value":".) The Gauss–Newton method replaces ","position":{"start":{"line":158,"column":1},"end":{"line":158,"column":1}},"key":"govuvutcRa"},{"type":"inlineMath","value":"\\mathbf{f}(\\mathbf{x})","position":{"start":{"line":158,"column":1},"end":{"line":158,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">f</mi><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\mathbf{f}(\\mathbf{x})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.10903em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathbf\">x</span><span class=\"mclose\">)</span></span></span></span>","key":"GoRaGXLkxb"},{"type":"text","value":" by a linear model and minimizes the norm of its residual. An alternative is to replace ","position":{"start":{"line":158,"column":1},"end":{"line":158,"column":1}},"key":"nPcB4YqpnU"},{"type":"inlineMath","value":"\\| \\mathbf{f}(\\mathbf{x}) \\|_2^2","position":{"start":{"line":158,"column":1},"end":{"line":158,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">∥</mi><mi mathvariant=\"bold\">f</mi><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">x</mi><mo stretchy=\"false\">)</mo><msubsup><mi mathvariant=\"normal\">∥</mi><mn>2</mn><mn>2</mn></msubsup></mrow><annotation encoding=\"application/x-tex\">\\| \\mathbf{f}(\\mathbf{x}) \\|_2^2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord\">∥</span><span class=\"mord mathbf\" style=\"margin-right:0.10903em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathbf\">x</span><span class=\"mclose\">)</span><span class=\"mord\"><span class=\"mord\">∥</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-2.4519em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2481em;\"><span></span></span></span></span></span></span></span></span></span>","key":"AEbXgyDgRA"},{"type":"text","value":" by a scalar quadratic model ","position":{"start":{"line":158,"column":1},"end":{"line":158,"column":1}},"key":"Sfkkh8LbwT"},{"type":"inlineMath","value":"q(\\mathbf{x})","position":{"start":{"line":158,"column":1},"end":{"line":158,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>q</mi><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">q(\\mathbf{x})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"mopen\">(</span><span class=\"mord mathbf\">x</span><span class=\"mclose\">)</span></span></span></span>","key":"bjyGCpMdLZ"},{"type":"text","value":", and minimize ","position":{"start":{"line":158,"column":1},"end":{"line":158,"column":1}},"key":"OBTdyHyOj5"},{"type":"inlineMath","value":"q","position":{"start":{"line":158,"column":1},"end":{"line":158,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>q</mi></mrow><annotation encoding=\"application/x-tex\">q</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span></span></span></span>","key":"ewySJebhYO"},{"type":"text","value":".","position":{"start":{"line":158,"column":1},"end":{"line":158,"column":1}},"key":"zJkQ3EkSbb"}],"key":"L7UNVD0vDv"},{"type":"paragraph","position":{"start":{"line":160,"column":1},"end":{"line":160,"column":1}},"children":[{"type":"strong","position":{"start":{"line":160,"column":1},"end":{"line":160,"column":1}},"children":[{"type":"text","value":"(a)","position":{"start":{"line":160,"column":1},"end":{"line":160,"column":1}},"key":"yQvk7yVnkl"}],"key":"ebxHHjm9C3"},{"type":"text","value":" Using ","position":{"start":{"line":160,"column":1},"end":{"line":160,"column":1}},"key":"ArcHfIB2xy"},{"type":"inlineMath","value":"\\mathbf{f}(x) = [ x-8, \\; x^2-4 ]","position":{"start":{"line":160,"column":1},"end":{"line":160,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">f</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mo stretchy=\"false\">[</mo><mi>x</mi><mo>−</mo><mn>8</mn><mo separator=\"true\">,</mo><mtext>  </mtext><msup><mi>x</mi><mn>2</mn></msup><mo>−</mo><mn>4</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">\\mathbf{f}(x) = [ x-8, \\; x^2-4 ]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.10903em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0085em;vertical-align:-0.1944em;\"></span><span class=\"mord\">8</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">4</span><span class=\"mclose\">]</span></span></span></span>","key":"NHczsCYMVV"},{"type":"text","value":", let ","position":{"start":{"line":160,"column":1},"end":{"line":160,"column":1}},"key":"sf9h8Wamwo"},{"type":"inlineMath","value":"q(x)","position":{"start":{"line":160,"column":1},"end":{"line":160,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>q</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">q(x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span>","key":"htF6VVA1vH"},{"type":"text","value":" be defined by the first three terms in the Taylor series for ","position":{"start":{"line":160,"column":1},"end":{"line":160,"column":1}},"key":"FRHcJwzEAX"},{"type":"inlineMath","value":"\\phi(x) = \\| \\mathbf{f}(x) \\|_2^2","position":{"start":{"line":160,"column":1},"end":{"line":160,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ϕ</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi mathvariant=\"normal\">∥</mi><mi mathvariant=\"bold\">f</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><msubsup><mi mathvariant=\"normal\">∥</mi><mn>2</mn><mn>2</mn></msubsup></mrow><annotation encoding=\"application/x-tex\">\\phi(x) = \\| \\mathbf{f}(x) \\|_2^2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">ϕ</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord\">∥</span><span class=\"mord mathbf\" style=\"margin-right:0.10903em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mord\"><span class=\"mord\">∥</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-2.4519em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2481em;\"><span></span></span></span></span></span></span></span></span></span>","key":"S9W9pzNNGk"},{"type":"text","value":" at ","position":{"start":{"line":160,"column":1},"end":{"line":160,"column":1}},"key":"tQ4Ubig9Nl"},{"type":"inlineMath","value":"x=2","position":{"start":{"line":160,"column":1},"end":{"line":160,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mo>=</mo><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">x=2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span></span></span></span>","key":"D1cZfzasM9"},{"type":"text","value":".","position":{"start":{"line":160,"column":1},"end":{"line":160,"column":1}},"key":"ACEqJswr3x"}],"key":"l65cv1GSEZ"},{"type":"paragraph","position":{"start":{"line":162,"column":1},"end":{"line":162,"column":1}},"children":[{"type":"strong","position":{"start":{"line":162,"column":1},"end":{"line":162,"column":1}},"children":[{"type":"text","value":"(b)","position":{"start":{"line":162,"column":1},"end":{"line":162,"column":1}},"key":"pB0xgMDrdQ"}],"key":"MUMFVYc4WA"},{"type":"text","value":" Find the unique ","position":{"start":{"line":162,"column":1},"end":{"line":162,"column":1}},"key":"PP1JJU1vHp"},{"type":"inlineMath","value":"x","position":{"start":{"line":162,"column":1},"end":{"line":162,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"ltXri5vnKW"},{"type":"text","value":" that minimizes ","position":{"start":{"line":162,"column":1},"end":{"line":162,"column":1}},"key":"nQvlOHQZNY"},{"type":"inlineMath","value":"q(x)","position":{"start":{"line":162,"column":1},"end":{"line":162,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>q</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">q(x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span>","key":"vgkoCRMKLE"},{"type":"text","value":". Is the result the same as the estimate produced by Gauss–Newton?","position":{"start":{"line":162,"column":1},"end":{"line":162,"column":1}},"key":"bDI5f6ax67"}],"key":"JFgkU37mwo"}],"label":"problem-nlsq-quadratic","identifier":"problem-nlsq-quadratic","enumerated":true,"enumerator":"4.7.2","html_id":"problem-nlsq-quadratic","key":"ayuQ1MOHac"},{"type":"exercise","children":[{"type":"paragraph","position":{"start":{"line":167,"column":1},"end":{"line":167,"column":1}},"children":[{"type":"text","value":"⌨  A famous result by Kermack and McKendrick in 1927 ","position":{"start":{"line":167,"column":1},"end":{"line":167,"column":1}},"key":"XZVNxl94ig"},{"type":"cite","kind":"narrative","label":"kermackContributionMathematical1927","identifier":"kermackcontributionmathematical1927","children":[{"type":"text","value":"Kermack ","key":"SGXyAIWG2r"},{"type":"emphasis","children":[{"type":"text","value":"et al.","key":"jPNXTjjhIv"}],"key":"hBz1DA1G9V"},{"type":"text","value":" (1927)","key":"LfjjvntCiA"}],"enumerator":"1","key":"mk3Fvqj4Z2"},{"type":"text","value":" suggests that in epidemics that kill only a small fraction of a susceptible population, the death rate as a function of time is well modeled by","position":{"start":{"line":167,"column":1},"end":{"line":167,"column":1}},"key":"iaURCTqACe"}],"key":"qeYgVbGKr3"},{"type":"math","value":"w'(t) = A \\operatorname{sech}^2[B(t-C)]","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msup><mi>w</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>A</mi><msup><mrow><mi mathvariant=\"normal\">sech</mi><mo>⁡</mo></mrow><mn>2</mn></msup><mo stretchy=\"false\">[</mo><mi>B</mi><mo stretchy=\"false\">(</mo><mi>t</mi><mo>−</mo><mi>C</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">w&#x27;(t) = A \\operatorname{sech}^2[B(t-C)]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0519em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8019em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1484em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">A</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\"><span class=\"mop\"><span class=\"mord mathrm\">sech</span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8984em;\"><span style=\"top:-3.1473em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"mclose\">)]</span></span></span></span></span>","enumerator":"4.7.6","key":"WpOhWYksde"},{"type":"paragraph","position":{"start":{"line":173,"column":1},"end":{"line":174,"column":1}},"children":[{"type":"text","value":"for constant values of the parameters ","position":{"start":{"line":173,"column":1},"end":{"line":173,"column":1}},"key":"WUHSpIb1X6"},{"type":"inlineMath","value":"A,B,C","position":{"start":{"line":173,"column":1},"end":{"line":173,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi><mo separator=\"true\">,</mo><mi>B</mi><mo separator=\"true\">,</mo><mi>C</mi></mrow><annotation encoding=\"application/x-tex\">A,B,C</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">A</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span></span></span></span>","key":"BprjyGuAoa"},{"type":"text","value":". Since the maximum of sech is ","position":{"start":{"line":173,"column":1},"end":{"line":173,"column":1}},"key":"PPyMFU2Mrv"},{"type":"inlineMath","value":"\\operatorname{sech}(0)=1","position":{"start":{"line":173,"column":1},"end":{"line":173,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">sech</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mn>0</mn><mo stretchy=\"false\">)</mo><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">\\operatorname{sech}(0)=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop\"><span class=\"mord mathrm\">sech</span></span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"nTSWWDP5FJ"},{"type":"text","value":", ","position":{"start":{"line":173,"column":1},"end":{"line":173,"column":1}},"key":"iRwJVGJdM4"},{"type":"inlineMath","value":"A","position":{"start":{"line":173,"column":1},"end":{"line":173,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi></mrow><annotation encoding=\"application/x-tex\">A</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">A</span></span></span></span>","key":"J3Q20L9iER"},{"type":"text","value":" is the maximum death rate and ","position":{"start":{"line":173,"column":1},"end":{"line":173,"column":1}},"key":"e5a3GWfl2M"},{"type":"inlineMath","value":"C","position":{"start":{"line":173,"column":1},"end":{"line":173,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>C</mi></mrow><annotation encoding=\"application/x-tex\">C</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span></span></span></span>","key":"nsFW9lTpyB"},{"type":"text","value":" is the time of peak deaths. You will use this model to fit the deaths per week from plague recorded in Mumbai\nduring 1906:","position":{"start":{"line":173,"column":1},"end":{"line":173,"column":1}},"key":"ZugAiEUIdY"}],"key":"F1jo6Y9QxA"},{"type":"code","lang":"julia","value":"5, 10, 17, 22, 30, 50, 51, 90, 120, 180, 292, 395, 445, 775, 780,\n700, 698, 880, 925, 800, 578, 400, 350, 202, 105, 65, 55, 40, 30, 20","position":{"start":{"line":176,"column":1},"end":{"line":179,"column":1}},"key":"YDmQWWMKHo"},{"type":"paragraph","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"children":[{"type":"strong","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"children":[{"type":"text","value":"(a)","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"key":"kuYdWGcOTD"}],"key":"MqOojtImd0"},{"type":"text","value":" Use ","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"key":"dW0BZpZOU4"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-levenberg","label":"function-levenberg","children":[{"type":"text","value":"Function ","key":"iPE4xsFpAv"},{"type":"text","value":"4.6.3","key":"TTqceucnIg"}],"template":"Algorithm %s","enumerator":"4.6.3","resolved":true,"html_id":"function-levenberg","remote":true,"url":"/quasinewton","dataUrl":"/quasinewton.json","key":"XLTieLjDFU"},{"type":"text","value":" to find the best least-squares fit to the data using the ","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"key":"RhYH9RgppZ"},{"type":"inlineMath","value":"\\operatorname{sech}^2","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mrow><mi mathvariant=\"normal\">sech</mi><mo>⁡</mo></mrow><mn>2</mn></msup></mrow><annotation encoding=\"application/x-tex\">\\operatorname{sech}^2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8984em;\"></span><span class=\"mop\"><span class=\"mop\"><span class=\"mord mathrm\">sech</span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8984em;\"><span style=\"top:-3.1473em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span>","key":"tivLxA4YY5"},{"type":"text","value":" model. Make a plot of the model fit superimposed on the data.","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"key":"Rp4LjtpKD4"}],"key":"MxmArs0VLM"},{"type":"paragraph","position":{"start":{"line":183,"column":1},"end":{"line":183,"column":1}},"children":[{"type":"strong","position":{"start":{"line":183,"column":1},"end":{"line":183,"column":1}},"children":[{"type":"text","value":"(b)","position":{"start":{"line":183,"column":1},"end":{"line":183,"column":1}},"key":"tcPzrzc1WK"}],"key":"eFHCMMzEJZ"},{"type":"text","value":" Repeat part (a) using only the first 15 data values. (The fit will not be as good.)","position":{"start":{"line":183,"column":1},"end":{"line":183,"column":1}},"key":"lQpvJVvamy"}],"key":"SPsR6Zy1Wu"}],"label":"problem-nlsq-epidemic","identifier":"problem-nlsq-epidemic","enumerated":true,"enumerator":"4.7.3","html_id":"problem-nlsq-epidemic","key":"D1h543dKeF"},{"type":"exercise","children":[{"type":"paragraph","position":{"start":{"line":188,"column":1},"end":{"line":188,"column":1}},"children":[{"type":"text","value":"⌨  (Variation on ","position":{"start":{"line":188,"column":1},"end":{"line":188,"column":1}},"key":"hez5rFPqtm"},{"type":"crossReference","identifier":"problem-newtonsys-circlefit","label":"problem-newtonsys-circlefit","kind":"exercise","position":{"start":{"line":188,"column":18},"end":{"line":188,"column":46}},"children":[{"type":"text","value":"Exercise ","key":"OIDiofMN1n"},{"type":"text","value":"4.5.6","key":"itxv9x1eNI"}],"template":"Exercise %s","enumerator":"4.5.6","resolved":true,"html_id":"problem-newtonsys-circlefit","remote":true,"url":"/newtonsys","dataUrl":"/newtonsys.json","key":"cZx9YOOZBr"},{"type":"text","value":".) Suppose the points ","position":{"start":{"line":188,"column":1},"end":{"line":188,"column":1}},"key":"PMWIc45IjK"},{"type":"inlineMath","value":"(x_i,y_i)","position":{"start":{"line":188,"column":1},"end":{"line":188,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo separator=\"true\">,</mo><msub><mi>y</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(x_i,y_i)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"wreQb5gvT3"},{"type":"text","value":" for ","position":{"start":{"line":188,"column":1},"end":{"line":188,"column":1}},"key":"QT3exlgVrK"},{"type":"inlineMath","value":"i=1,\\ldots,m","position":{"start":{"line":188,"column":1},"end":{"line":188,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi><mo>=</mo><mn>1</mn><mo separator=\"true\">,</mo><mo>…</mo><mo separator=\"true\">,</mo><mi>m</mi></mrow><annotation encoding=\"application/x-tex\">i=1,\\ldots,m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8389em;vertical-align:-0.1944em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">m</span></span></span></span>","key":"jVEEDymAy8"},{"type":"text","value":" are given, and the goal is to find the circle with center ","position":{"start":{"line":188,"column":1},"end":{"line":188,"column":1}},"key":"icJ5yWDJXG"},{"type":"inlineMath","value":"(a,b)","position":{"start":{"line":188,"column":1},"end":{"line":188,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>a</mi><mo separator=\"true\">,</mo><mi>b</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(a,b)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">a</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">b</span><span class=\"mclose\">)</span></span></span></span>","key":"iebMzWPtDq"},{"type":"text","value":" and radius ","position":{"start":{"line":188,"column":1},"end":{"line":188,"column":1}},"key":"ruQoDwlsKJ"},{"type":"inlineMath","value":"r","position":{"start":{"line":188,"column":1},"end":{"line":188,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>r</mi></mrow><annotation encoding=\"application/x-tex\">r</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span></span></span></span>","key":"aD75Aa1zws"},{"type":"text","value":" that best fits the points. Define","position":{"start":{"line":188,"column":1},"end":{"line":188,"column":1}},"key":"gVRe61QABA"}],"key":"jWe6eGyJzR"},{"type":"math","value":"f_i(a,b,r) = (a-x_i)^2 + (b-y_i)^2 - r^2, \\qquad i=1,\\ldots,m.","position":{"start":{"line":190,"column":1},"end":{"line":190,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>f</mi><mi>i</mi></msub><mo stretchy=\"false\">(</mo><mi>a</mi><mo separator=\"true\">,</mo><mi>b</mi><mo separator=\"true\">,</mo><mi>r</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mo stretchy=\"false\">(</mo><mi>a</mi><mo>−</mo><msub><mi>x</mi><mi>i</mi></msub><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup><mo>+</mo><mo stretchy=\"false\">(</mo><mi>b</mi><mo>−</mo><msub><mi>y</mi><mi>i</mi></msub><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup><mo>−</mo><msup><mi>r</mi><mn>2</mn></msup><mo separator=\"true\">,</mo><mspace width=\"2em\"/><mi>i</mi><mo>=</mo><mn>1</mn><mo separator=\"true\">,</mo><mo>…</mo><mo separator=\"true\">,</mo><mi>m</mi><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">f_i(a,b,r) = (a-x_i)^2 + (b-y_i)^2 - r^2, \\qquad i=1,\\ldots,m.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">a</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">b</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">a</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1141em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">b</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1141em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0585em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:2em;\"></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">i</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8389em;vertical-align:-0.1944em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mord\">.</span></span></span></span></span>","enumerator":"4.7.7","key":"D4sEitW3S6"},{"type":"paragraph","position":{"start":{"line":192,"column":1},"end":{"line":192,"column":1}},"children":[{"type":"text","value":"Then we can define the best circle as the one that minimizes ","position":{"start":{"line":192,"column":1},"end":{"line":192,"column":1}},"key":"Ef1lRgcqfW"},{"type":"inlineMath","value":"\\|\\mathbf{f}\\|","position":{"start":{"line":192,"column":1},"end":{"line":192,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">∥</mi><mi mathvariant=\"bold\">f</mi><mi mathvariant=\"normal\">∥</mi></mrow><annotation encoding=\"application/x-tex\">\\|\\mathbf{f}\\|</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">∥</span><span class=\"mord mathbf\" style=\"margin-right:0.10903em;\">f</span><span class=\"mord\">∥</span></span></span></span>","key":"ULqoOYuLqJ"},{"type":"text","value":".","position":{"start":{"line":192,"column":1},"end":{"line":192,"column":1}},"key":"RydiqfDqIw"}],"key":"wBAYCyeaJB"},{"type":"paragraph","position":{"start":{"line":194,"column":1},"end":{"line":194,"column":1}},"children":[{"type":"text","value":"Define data points as follows:","position":{"start":{"line":194,"column":1},"end":{"line":194,"column":1}},"key":"ZSh2DF8two"}],"key":"kVffpfmWQi"},{"type":"tabSet","children":[{"type":"tabItem","title":"Julia","sync":"julia","children":[{"type":"code","lang":"julia","value":"m = 30\nt = 2π * rand(m)\nx = @. -2 + 5 * cos(t) + 0.2 * randn(m)\ny = @.  1 + 5 * sin(t) + 0.2 * randn(m);","position":{"start":{"line":199,"column":1},"end":{"line":204,"column":1}},"key":"DZtkUqOigF"}],"key":"dSOcUIgAdh"},{"type":"tabItem","title":"MATLAB","sync":"matlab","children":[{"type":"code","lang":"matlab","value":"m = 30; \nt = 2*pi * rand(m, 1);\nx = -2 + 5 * cos(t) + 0.2 * randn(m, 1);\ny =  1 + 5 * sin(t) + 0.2 * randn(m, 1);","position":{"start":{"line":209,"column":1},"end":{"line":214,"column":1}},"key":"GQQjnV7qmJ"}],"key":"QFxFa7810f"},{"type":"tabItem","title":"Python","sync":"python","children":[{"type":"code","lang":"python","value":"import numpy as np\nm = 30;\nt = 2*np.pi * np.random.rand(m)\nx = -2 + 5 * np.cos(t) + 0.2 * np.random.randn(m)\ny =  1 + 5 * np.sin(t) + 0.2 * np.random.randn(m)","position":{"start":{"line":218,"column":1},"end":{"line":224,"column":1}},"key":"BTaGPJgvpu"}],"key":"RoPxQJBorK"}],"key":"W5mDXcYqQp"},{"type":"paragraph","position":{"start":{"line":228,"column":1},"end":{"line":228,"column":1}},"children":[{"type":"text","value":"Use ","position":{"start":{"line":228,"column":1},"end":{"line":228,"column":1}},"key":"ljSZeow6Jb"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-levenberg","label":"function-levenberg","children":[{"type":"text","value":"Function ","key":"m4G4QKBwfI"},{"type":"text","value":"4.6.3","key":"oFwLw9tWIS"}],"template":"Algorithm %s","enumerator":"4.6.3","resolved":true,"html_id":"function-levenberg","remote":true,"url":"/quasinewton","dataUrl":"/quasinewton.json","key":"H3uXKYKYIY"},{"type":"text","value":" to find the best-fit circle, and make a plot of the circle superimposed on the points.","position":{"start":{"line":228,"column":1},"end":{"line":228,"column":1}},"key":"OWNkHF4oCv"}],"key":"p3xB2S1eTf"}],"label":"problem-nlsq-circlefit","identifier":"problem-nlsq-circlefit","enumerated":true,"enumerator":"4.7.4","html_id":"problem-nlsq-circlefit","key":"MNuexqKy1o"},{"type":"exercise","children":[{"type":"paragraph","position":{"start":{"line":233,"column":1},"end":{"line":233,"column":1}},"children":[{"type":"text","value":"⌨ The position of the upper lid during an eye blink can be measured from high-speed video ","position":{"start":{"line":233,"column":1},"end":{"line":233,"column":1}},"key":"bsaHMtdfwZ"},{"type":"cite","kind":"narrative","label":"wuEffectsMild2014","identifier":"wueffectsmild2014","children":[{"type":"text","value":"Wu ","key":"ZclONOg1Zo"},{"type":"emphasis","children":[{"type":"text","value":"et al.","key":"WvIcgT3s09"}],"key":"q2xFnBGoeq"},{"type":"text","value":" (2014)","key":"BQV2FdaCSC"}],"enumerator":"2","key":"S5RqOmVH8y"},{"type":"text","value":", and it may be possible to classify blinks based in part on fits to the lid position ","position":{"start":{"line":233,"column":1},"end":{"line":233,"column":1}},"key":"TVzX2k7dx1"},{"type":"cite","kind":"narrative","label":"broschBlinkCharacterization2017","identifier":"broschblinkcharacterization2017","children":[{"type":"text","value":"Brosch ","key":"DUzB8qtWLB"},{"type":"emphasis","children":[{"type":"text","value":"et al.","key":"CqFl7lTjCy"}],"key":"kItrezCpMX"},{"type":"text","value":" (2017)","key":"zoixEJSmCP"}],"enumerator":"3","key":"FffWkN71UW"},{"type":"text","value":". The lid position functions proposed to fit blinks is a product of a monomial or polynomial multiplying a decaying exponential ","position":{"start":{"line":233,"column":1},"end":{"line":233,"column":1}},"key":"uAO8dvE1Aw"},{"type":"cite","kind":"narrative","label":"berkeKineticsLid1998","identifier":"berkekineticslid1998","children":[{"type":"text","value":"Berke & Mueller (1998)","key":"dNB4j4HBMR"}],"enumerator":"4","key":"VPhkICIMod"},{"type":"text","value":".  In this problem, you will generate representative data, add a small amount of noise to it, and then perform nonlinear least-squares fits to the data.","position":{"start":{"line":233,"column":1},"end":{"line":233,"column":1}},"key":"FXu6RkjG91"}],"key":"TSx59DtALA"},{"type":"paragraph","position":{"start":{"line":235,"column":1},"end":{"line":235,"column":1}},"children":[{"type":"strong","position":{"start":{"line":235,"column":1},"end":{"line":235,"column":1}},"children":[{"type":"text","value":"(a)","position":{"start":{"line":235,"column":1},"end":{"line":235,"column":1}},"key":"uDw7q6SsOt"}],"key":"VMpE5mP0Qr"},{"type":"text","value":" Consider the fitting function ","position":{"start":{"line":235,"column":1},"end":{"line":235,"column":1}},"key":"myKieZeNki"},{"type":"inlineMath","value":"y(\\mathbf{a}) = a_1 t^2 \\exp \\left( -a_2 t^{a_3} \\right)","position":{"start":{"line":235,"column":1},"end":{"line":235,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">a</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mi>a</mi><mn>1</mn></msub><msup><mi>t</mi><mn>2</mn></msup><mi>exp</mi><mo>⁡</mo><mrow><mo fence=\"true\">(</mo><mo>−</mo><msub><mi>a</mi><mn>2</mn></msub><msup><mi>t</mi><msub><mi>a</mi><mn>3</mn></msub></msup><mo fence=\"true\">)</mo></mrow></mrow><annotation encoding=\"application/x-tex\">y(\\mathbf{a}) = a_1 t^2 \\exp \\left( -a_2 t^{a_3} \\right)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mopen\">(</span><span class=\"mord mathbf\">a</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">exp</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\">(</span><span class=\"mord\">−</span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3173em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\">3</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\">)</span></span></span></span></span>","key":"X9KHdEAfZV"},{"type":"text","value":", using the vector of coefficients ","position":{"start":{"line":235,"column":1},"end":{"line":235,"column":1}},"key":"y8r9IK12ql"},{"type":"inlineMath","value":"\\mathbf{a} = [a_1,a_2,a_3]","position":{"start":{"line":235,"column":1},"end":{"line":235,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">a</mi><mo>=</mo><mo stretchy=\"false\">[</mo><msub><mi>a</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><msub><mi>a</mi><mn>2</mn></msub><mo separator=\"true\">,</mo><msub><mi>a</mi><mn>3</mn></msub><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">\\mathbf{a} = [a_1,a_2,a_3]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4444em;\"></span><span class=\"mord mathbf\">a</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">]</span></span></span></span>","key":"Upii4Bu1S6"},{"type":"text","value":", and create synthetic eyelid position data as follows:","position":{"start":{"line":235,"column":1},"end":{"line":235,"column":1}},"key":"U7qCRB1dPG"}],"key":"M98am2NaEG"},{"type":"tabSet","children":[{"type":"tabItem","title":"Julia","sync":"julia","children":[{"type":"code","lang":"julia","value":"N = 20;                                # number of t values\nt = (1:N) / N;                         # equally spaced to t=1\na = [10, 10, 2];                       # baseline values\ny = @. a(1) * t^2 * exp(-a(2)*t^a(3)); # ideal data\nnoise = 0.03;                          # amplitude of noise\nym = y + noise * rand(N);              # add noise","position":{"start":{"line":240,"column":1},"end":{"line":247,"column":1}},"key":"mEY0d4YYfH"}],"key":"UbIINwsgYM"},{"type":"tabItem","title":"MATLAB","sync":"matlab","children":[{"type":"code","lang":"matlab","value":"N = 20;                              % number of t values\nt = (1:N)' / N;                      % equally spaced to t=1    \na = [10, 10, 2];                     % baseline values\ny = a(1) * t.^2.*exp(-a(2)*t.^a(3)); % ideal data\nnoise = 0.03;                        % amplitude of noise\nym = y + noise * rand(N, 1);         % add noise","position":{"start":{"line":252,"column":1},"end":{"line":259,"column":1}},"key":"Hvlolwpy01"}],"key":"muObVzd1SL"},{"type":"tabItem","title":"Python","sync":"python","children":[{"type":"code","lang":"python","value":"import numpy as np\nN = 20                                  # number of t values\nt = (np.arange(1, N+1)) / N;            # equally spaced to t=1\na = [10, 10, 2]                         # baseline values\ny = a[0] * t**2 * np.exp(-a[1]*t**a[2]) # ideal data\nnoise = 0.03                            # amplitude of noise\nym = y + noise * np.random.rand(N)      # add noise","position":{"start":{"line":263,"column":1},"end":{"line":271,"column":1}},"key":"rd7t3M0WUs"}],"key":"HLJBMK6NU1"}],"key":"FNipLwwhM2"},{"type":"paragraph","position":{"start":{"line":275,"column":1},"end":{"line":275,"column":1}},"children":[{"type":"strong","position":{"start":{"line":275,"column":1},"end":{"line":275,"column":1}},"children":[{"type":"text","value":"(b)","position":{"start":{"line":275,"column":1},"end":{"line":275,"column":1}},"key":"ahpKPoLTzt"}],"key":"jMuilZrO61"},{"type":"text","value":" Using the data ","position":{"start":{"line":275,"column":1},"end":{"line":275,"column":1}},"key":"Btic9nBFOK"},{"type":"inlineCode","value":"(t,ym)","position":{"start":{"line":275,"column":1},"end":{"line":275,"column":1}},"key":"ypgYYoHvx7"},{"type":"text","value":", find the nonlinear least-squares fit using ","position":{"start":{"line":275,"column":1},"end":{"line":275,"column":1}},"key":"JDG3YFfM8z"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-levenberg","label":"function-levenberg","children":[{"type":"text","value":"Function ","key":"ST86qFLGRL"},{"type":"text","value":"4.6.3","key":"LHsj6iWjTS"}],"template":"Algorithm %s","enumerator":"4.6.3","resolved":true,"html_id":"function-levenberg","remote":true,"url":"/quasinewton","dataUrl":"/quasinewton.json","key":"nmnfPkVbCH"},{"type":"text","value":".","position":{"start":{"line":275,"column":1},"end":{"line":275,"column":1}},"key":"PvbyI3VCzs"}],"key":"sDsDXoJxOQ"},{"type":"paragraph","position":{"start":{"line":277,"column":1},"end":{"line":277,"column":1}},"children":[{"type":"strong","position":{"start":{"line":277,"column":1},"end":{"line":277,"column":1}},"children":[{"type":"text","value":"(c)","position":{"start":{"line":277,"column":1},"end":{"line":277,"column":1}},"key":"rbyXbAFUk9"}],"key":"l116Y6j38k"},{"type":"text","value":" Plot the fit at 300 points in ","position":{"start":{"line":277,"column":1},"end":{"line":277,"column":1}},"key":"oewsc3HFZn"},{"type":"inlineMath","value":"t\\in[0,1]","position":{"start":{"line":277,"column":1},"end":{"line":277,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi><mo>∈</mo><mo stretchy=\"false\">[</mo><mn>0</mn><mo separator=\"true\">,</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">t\\in[0,1]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6542em;vertical-align:-0.0391em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]</span></span></span></span>","key":"bT1wKZACHa"},{"type":"text","value":", together with the measured data points ","position":{"start":{"line":277,"column":1},"end":{"line":277,"column":1}},"key":"Nf06xGzzGa"},{"type":"inlineCode","value":"ym","position":{"start":{"line":277,"column":1},"end":{"line":277,"column":1}},"key":"mGwyipQmYq"},{"type":"text","value":".","position":{"start":{"line":277,"column":1},"end":{"line":277,"column":1}},"key":"dNUf7kOP5F"}],"key":"uQ3vy8oXTx"},{"type":"paragraph","position":{"start":{"line":279,"column":1},"end":{"line":279,"column":1}},"children":[{"type":"strong","position":{"start":{"line":279,"column":1},"end":{"line":279,"column":1}},"children":[{"type":"text","value":"(d)","position":{"start":{"line":279,"column":1},"end":{"line":279,"column":1}},"key":"PUd2PsMKr8"}],"key":"aVM7U0l54H"},{"type":"text","value":" Increase the noise to 5% and 10%. You may have to increase the number of measured points ","position":{"start":{"line":279,"column":1},"end":{"line":279,"column":1}},"key":"cCTqdQYh5Q"},{"type":"inlineCode","value":"N","position":{"start":{"line":279,"column":1},"end":{"line":279,"column":1}},"key":"qmGPA4PQbf"},{"type":"text","value":" and/or the maximum number of iterations.  How close are the coefficients?  Plot the data and the resulting fit for each case.","position":{"start":{"line":279,"column":1},"end":{"line":279,"column":1}},"key":"j6KX6z4wo6"}],"key":"YrtTnmGWhi"}],"label":"problem-nlsq-blink","identifier":"problem-nlsq-blink","enumerated":true,"enumerator":"4.7.5","html_id":"problem-nlsq-blink","key":"lRDhccnaY8"},{"type":"exercise","children":[{"type":"paragraph","position":{"start":{"line":284,"column":1},"end":{"line":284,"column":1}},"children":[{"type":"text","value":"⌨ Repeat the previous problem using the fitting function ","position":{"start":{"line":284,"column":1},"end":{"line":284,"column":1}},"key":"wr8qKVWSWn"},{"type":"inlineMath","value":"y(\\mathbf{a}) = (a_1+a_2 t + a_3 t^2) t^2 \\exp \\left( -a_4 t^{a_5} \\right)","position":{"start":{"line":284,"column":1},"end":{"line":284,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">a</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mo stretchy=\"false\">(</mo><msub><mi>a</mi><mn>1</mn></msub><mo>+</mo><msub><mi>a</mi><mn>2</mn></msub><mi>t</mi><mo>+</mo><msub><mi>a</mi><mn>3</mn></msub><msup><mi>t</mi><mn>2</mn></msup><mo stretchy=\"false\">)</mo><msup><mi>t</mi><mn>2</mn></msup><mi>exp</mi><mo>⁡</mo><mrow><mo fence=\"true\">(</mo><mo>−</mo><msub><mi>a</mi><mn>4</mn></msub><msup><mi>t</mi><msub><mi>a</mi><mn>5</mn></msub></msup><mo fence=\"true\">)</mo></mrow></mrow><annotation encoding=\"application/x-tex\">y(\\mathbf{a}) = (a_1+a_2 t + a_3 t^2) t^2 \\exp \\left( -a_4 t^{a_5} \\right)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mopen\">(</span><span class=\"mord mathbf\">a</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7651em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">exp</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\">(</span><span class=\"mord\">−</span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">4</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3173em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\">5</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\">)</span></span></span></span></span>","key":"naRqHJdM3o"},{"type":"text","value":", using the vector of coefficients ","position":{"start":{"line":284,"column":1},"end":{"line":284,"column":1}},"key":"MblIHMalI9"},{"type":"inlineMath","value":"\\mathbf{a} = [a_1,\\ldots,a_5]","position":{"start":{"line":284,"column":1},"end":{"line":284,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">a</mi><mo>=</mo><mo stretchy=\"false\">[</mo><msub><mi>a</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><mo>…</mo><mo separator=\"true\">,</mo><msub><mi>a</mi><mn>5</mn></msub><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">\\mathbf{a} = [a_1,\\ldots,a_5]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4444em;\"></span><span class=\"mord mathbf\">a</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">5</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">]</span></span></span></span>","key":"JQ9aP16UWU"},{"type":"text","value":". (This was the choice used in Brosch et al ","position":{"start":{"line":284,"column":1},"end":{"line":284,"column":1}},"key":"Mng7s23Erq"},{"type":"cite","kind":"narrative","label":"broschBlinkCharacterization2017","identifier":"broschblinkcharacterization2017","children":[{"type":"text","value":"Brosch ","key":"KcOyOD2LZG"},{"type":"emphasis","children":[{"type":"text","value":"et al.","key":"lMx5uguJ9d"}],"key":"YiIjEOVCvH"},{"type":"text","value":" (2017)","key":"vgmTJqcsIi"}],"enumerator":"3","key":"tytiPv9v5k"},{"type":"text","value":".)  Use ","position":{"start":{"line":284,"column":1},"end":{"line":284,"column":1}},"key":"oWdHu2wszi"},{"type":"inlineCode","value":"a = [20, -10, -8, 7, 2]","position":{"start":{"line":284,"column":1},"end":{"line":284,"column":1}},"key":"XtMfZr2B0J"},{"type":"text","value":" to create the data and as an initial guess for the coefficients for the fit to the noisy data.","position":{"start":{"line":284,"column":1},"end":{"line":284,"column":1}},"key":"TikFy9hBKZ"}],"key":"iq5jHPdyCW"}],"label":"problem-nlsq-blink2","identifier":"problem-nlsq-blink2","enumerated":true,"enumerator":"4.7.6","html_id":"problem-nlsq-blink2","key":"oVSHysWivQ"}],"key":"dB6ZoZSoxt"}],"key":"gldfTHoICM"},"references":{"cite":{"order":["kermackContributionMathematical1927","wuEffectsMild2014","broschBlinkCharacterization2017","berkeKineticsLid1998"],"data":{"kermackContributionMathematical1927":{"label":"kermackContributionMathematical1927","enumerator":"1","doi":"10.1098/rspa.1927.0118","html":"Kermack, W. O., McKendrick, A. G., & Walker, G. T. (1927). A Contribution to the Mathematical Theory of Epidemics. <i>Proceedings of the Royal Society of London. Series A, Containing Papers of a Mathematical and Physical Character</i>, <i>115</i>(772), 700–721. <a target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.1098/rspa.1927.0118\">10.1098/rspa.1927.0118</a>","url":"https://doi.org/10.1098/rspa.1927.0118"},"wuEffectsMild2014":{"label":"wuEffectsMild2014","enumerator":"2","doi":"10.3109/02713683.2013.822896","html":"Wu, Z., Begley, C. G., Situ, P., Simpson, T., & Liu, H. (2014). The Effects of Mild Ocular Surface Stimulation and Concentration on Spontaneous Blink Parameters. <i>Current Eye Research</i>, <i>39</i>(1), 9–20. <a target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.3109/02713683.2013.822896\">10.3109/02713683.2013.822896</a>","url":"https://doi.org/10.3109/02713683.2013.822896"},"broschBlinkCharacterization2017":{"label":"broschBlinkCharacterization2017","enumerator":"3","doi":"10.35119/maio.v1i3.38","html":"Brosch, J. K., Wu, Z., Begley, C. G., Driscoll, T. A., & Braun, R. J. (2017). Blink Characterization Using Curve Fitting and Clustering Algorithms. <i>Journal for Modeling in Ophthalmology</i>, <i>1</i>(3), 60–81. <a target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.35119/maio.v1i3.38\">10.35119/maio.v1i3.38</a>","url":"https://doi.org/10.35119/maio.v1i3.38"},"berkeKineticsLid1998":{"label":"berkeKineticsLid1998","enumerator":"4","doi":"10.1007/978-1-4615-5359-5_58","html":"Berke, A., & Mueller, S. (1998). The Kinetics of Lid Motion and Its Effects on the Tear Film. In D. A. Sullivan, D. A. Dartt, & M. A. Meneray (Eds.), <i>Lacrimal Gland, Tear Film, and Dry Eye Syndromes 2</i> (Vol. 438, pp. 417–424). Springer US. <a target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.1007/978-1-4615-5359-5_58\">10.1007/978-1-4615-5359-5_58</a>","url":"https://doi.org/10.1007/978-1-4615-5359-5_58"}}}},"footer":{"navigation":{"prev":{"title":"Quasi-Newton methods","url":"/quasinewton","group":"Preface"},"next":{"title":"Next steps","url":"/next-3","group":"Preface"}}},"domain":"http://localhost:3000"}