{"kind":"Notebook","sha256":"4d00ef1fbf70dc053c5008006278733e2d4a46c11eddc05e7fb5852377687ed4","slug":"chapter10-1","location":"/matlab/chapter10.md","dependencies":[],"frontmatter":{"title":"Chapter 10","numbering":{"heading_1":{"enabled":false},"heading_2":{"enabled":false},"heading_3":{"enabled":false},"heading_4":{"enabled":false},"heading_5":{"enabled":false},"heading_6":{"enabled":false},"title":{"offset":2}},"kernelspec":{"name":"jupyter_matlab_kernel","display_name":"MATLAB","language":"matlab"},"content_includes_title":false,"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"edit_url":"https://github.com/fncbook/fnc/blob/master/matlab/chapter10.md","exports":[{"format":"md","filename":"chapter10.md","url":"/2025-02-12/build/chapter10-50220ea0d96913d867db006d7bce5384.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Functions","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"uZj82OLeyd"}],"identifier":"functions","label":"Functions","html_id":"functions","implicit":true,"key":"AxDIcDZ2LC"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Shooting method for a two-point boundary-value problem","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"yYtjBvbcgd"}],"key":"xrqzmLRIQg"},{"type":"include","file":"FNC-matlab/shoot.m","literal":true,"filter":{},"children":[{"type":"code","value":"function [x, u, du_dx] = shoot(phi, a, b, ga, gb, init, tol)\r\n%SHOOT   Shooting method for a two-point boundary-value problem.\r\n% Input:\r\n%   phi      defines u'' = phi(x, u, u') (function)\r\n%   a, b     endpoints of the domain (scalars)\r\n%   ga       residual boundary function of u(a), u'(a) \r\n%   gb       residual boundary function of u(b), u'(b) \r\n%   init     initial guess for u(a) and u'(a) (column vector)\r\n%   tol      error tolerance (scalar)\r\n% Output:\r\n%   x        nodes in x (length n+1)\r\n%   u        values of u(x)  (length n+1)\r\n%   du_dx    values of u'(x) (length n+1)\r\n\r\n% To be solved by the IVP solver\r\nfunction f = shootivp(x, y)\r\n  f = [ y(2); phi(x, y(1), y(2)) ];\r\nend\r\n\r\nivp = ode(ODEFcn=@shootivp);\r\nivp.InitialTime = a;\r\nivp.AbsoluteTolerance = tol / 10;\r\nivp.RelativeTolerance = tol / 10;\r\n\r\n% To be solved by levenberg\r\nfunction residual = objective(s)\r\n  ivp.InitialValue = s;\r\n  sol = solve(ivp, a, b);\r\n  x = sol.Time;  y = sol.Solution;\r\n  residual = [ga(y(1, 1), y(2, 1)); gb(y(1, end), y(2, end))];\r\nend\r\n\r\ny = [];    % shared variable\r\ns = levenberg(@objective, init, tol);\r\n\r\n% Don't need to solve the IVP again. It was done within the\r\n% objective function already.\r\nu = y(1, :);            % solution     \r\ndu_dx = y(2, :);         % derivative\r\n\r\nend","lang":"matlab","showLineNumbers":true,"filename":"shoot.m","key":"BP3zHxfmT6"}],"key":"I9xcDiZBLk"}],"label":"function-shoot-matlab","identifier":"function-shoot-matlab","html_id":"function-shoot-matlab","key":"DNYYXIPzM3"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Second-order differentiation matrices","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"dLcQfufqVp"}],"key":"mrjWYYOf7t"},{"type":"include","file":"FNC-matlab/diffmat2.m","literal":true,"filter":{},"children":[{"type":"code","value":"function [x,Dx,Dxx] = diffmat2(n,xspan)\n%DIFFMAT2   Second-order accurate differentiation matrices.\n% Input:\n%   n       number of subintervals (one less than the number of nodes)\n%   xspan   interval endpoints\n% Output:\n%   x       equispaced nodes\n%   Dx      matrix for first derivative \n%   Dxx     matrix for second derivative \n\na = xspan(1);  b = xspan(2);\nh = (b-a)/n;\nx = a + h*(0:n)';   % nodes\n\n% Define most of Dx by its diagonals.\ndp = 0.5*ones(n,1)/h;       % superdiagonal\ndm = -0.5*ones(n,1)/h;      % subdiagonal\nDx = diag(dm,-1) + diag(dp,1);\n\n% Fix first and last rows.\nDx(1,1:3) = [-1.5,2,-0.5]/h;\nDx(n+1,n-1:n+1) = [0.5,-2,1.5]/h;\n\n% Define most of Dxx by its diagonals.\nd0 =  -2*ones(n+1,1)/h^2;   % main diagonal\ndp =  ones(n,1)/h^2;        % superdiagonal and subdiagonal\nDxx = diag(dp,-1) + diag(d0) + diag(dp,1);\n\n% Fix first and last rows.\nDxx(1,1:4) = [2,-5,4,-1]/h^2;\nDxx(n+1,n-2:n+1) = [-1,4,-5,2]/h^2;\n    ","lang":"matlab","showLineNumbers":true,"filename":"diffmat2.m","key":"JL937De6ee"}],"key":"fW7rY0uarF"}],"label":"function-diffmats2-matlab","identifier":"function-diffmats2-matlab","html_id":"function-diffmats2-matlab","key":"ZJrBLocQ0R"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Chebyshev differentiation matrices","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"MiR1IVLz8B"}],"key":"JMODrdj3lD"},{"type":"include","file":"FNC-matlab/diffcheb.m","literal":true,"filter":{},"children":[{"type":"code","value":"function [x,Dx,Dxx] = diffcheb(n,xspan)\n%DIFFCHEB   Chebyshev differentiation matrices.\n% Input:\n%   n      number of subintervals (integer)\n%   xspan  interval endpoints (vector)\n% Output:\n%   x      Chebyshev nodes in domain (length n+1)\n%   Dx     matrix for first derivative (n+1 by n+1)\n%   Dxx    matrix for second derivative (n+1 by n+1)\n\nx = -cos( (0:n)'*pi/n );    % nodes in [-1,1]\nDx = zeros(n+1);\nc = [2; ones(n-1,1); 2];    % endpoint factors\ni = (0:n)';                 % row indices\n\n% Off-diagonal entries\nfor j = 0:n\n  num = c(i+1).*(-1).^(i+j);\n  den = c(j+1)*(x-x(j+1));\n  Dx(:,j+1) = num./den;\nend\n\n% Diagonal entries\nDx(isinf(Dx)) = 0;          % fix divisions by zero on diagonal\nDx = Dx - diag(sum(Dx,2));  % \"negative sum trick\" \n  \n% Transplant to [a,b]\na = xspan(1);  b = xspan(2);\nx = a + (b-a)*(x+1)/2;\nDx = 2*Dx/(b-a);\n\n% Second derivative\nDxx = Dx^2;","lang":"matlab","showLineNumbers":true,"filename":"diffcheb.m","key":"b1zMGzeM3C"}],"key":"XC6oPlmQHw"}],"label":"function-diffcheb-matlab","identifier":"function-diffcheb-matlab","html_id":"function-diffcheb-matlab","key":"i46XP9olD8"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Solution of a linear boundary-value problem","position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"key":"KiaOlScQZg"}],"key":"bbJ1p08iut"},{"type":"include","file":"FNC-matlab/bvplin.m","literal":true,"filter":{},"children":[{"type":"code","value":"function [x, u] = bvplin(p, q, r, a, b, ua, ub,n)\r\n% BVPLIN   Solve a linear boundary-value problem.\r\n% Input:\r\n%   p, q, r  u'' + pu' + qu = r (functions)\r\n%   a, b     endpoints of the domain (scalars)\r\n%   ua       value of u(a)\r\n%   ub       value of u(b)\r\n%   n        number of subintervals (integer)\r\n% Output:\r\n%   x       collocation nodes (vector, length n+1)\r\n%   u       solution at nodes (vector, length n+1)\r\n\r\n[x, Dx, Dxx] = diffmat2(n, [a, b]);\r\n\r\nP = diag(p(x));\r\nQ = diag(q(x));\r\nL = Dxx + P * Dx + Q;    % ODE expressed at the nodes\r\nr = r(x);    \r\n\r\n% Replace first and last rows using boundary conditions. \r\nI = speye(n+1); \r\nA = [ I(:, 1)'; L(2:n, :); I(:, n+1)' ];\r\n\r\nf = [ ua; r(2:n); ub ];\r\n\r\n% Solve the system.\r\nu = A \\ f;","lang":"matlab","showLineNumbers":true,"filename":"bvplin.m","key":"vuniZDlsYR"}],"key":"C4BwFetW89"}],"label":"function-bvplin-matlab","identifier":"function-bvplin-matlab","html_id":"function-bvplin-matlab","key":"CcwnAAWcMA"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Solution of a nonlinear boundary-value problem","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"key":"l2F2FkNeF3"}],"key":"iPHFSubLdT"},{"type":"include","file":"FNC-matlab/bvp.m","literal":true,"filter":{},"children":[{"type":"code","value":"  function [x,u] = bvp(phi, a, b, ga, gb, init)\n%BVP      Solve a boundary-value problem by finite differences\n%         with either Dirichlet or Neumann BCs.\n% Input:\n%   phi      defines u'' = phi(x,u,u') (function)\n%   a, b     endpoints of the domain (scalars)\n%   ga       residual boundary function of u(a), u'(a) \n%   gb       residual boundary function of u(b), u'(b) \n%   init     initial guess for the solution (length n+1 vector)\n% Output:\n%   x        nodes in x (vector, length n+1)\n%   u        values of u(x)  (vector, length n+1)\n%   res      function for computing the residual\n\nn = length(init) - 1;\n[x, Dx, Dxx] = diffmat2(n, [a, b]);\nh = x(2) - x(1);\n\nu = levenberg(@residual, init);\nu = u(:, end);\n\n    function f = residual(u)\n        % Computes the difference between u'' and phi(x,u,u') at the\n        % interior nodes and appends the error at the boundaries. \n        du_dx = Dx*u;                   % discrete u'\n        d2u_dx2 = Dxx*u;                % discrete u''\n        f = d2u_dx2 - phi(x,u,du_dx);\n        \n        % Replace first and last values by boundary conditions.\n        f(1) =   ga(  u(1),   du_dx(1)) / h;\n        f(end) = gb(u(end), du_dx(end)) / h;\n    end\n\nend","lang":"matlab","showLineNumbers":true,"filename":"bvp.m","key":"EMrbnPb429"}],"key":"ExnIVI1uOw"}],"label":"function-bvp-matlab","identifier":"function-bvp-matlab","html_id":"function-bvp-matlab","key":"hPEdLowk06"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Piecewise linear finite elements for a linear ","key":"QrTRlJASeI"},{"type":"abbreviation","title":"boundary-value problem","children":[{"type":"text","value":"BVP","key":"VlrJJb5ppK"}],"key":"nLDZRs6XwC"}],"key":"L0xb29jAkD"},{"type":"include","file":"FNC-matlab/fem.m","literal":true,"filter":{},"children":[{"type":"code","value":"function [x,u] = fem(c,s,f,a,b,n)\r\n%FEM     Piecewise linear finite elements for a linear BVP.\r\n% Input:\r\n%   c,s,f    coefficient functions of x describing the ODE (functions) \r\n%   a,b      domain of the independent variable (scalars)\r\n%   n        number of grid subintervals (scalar) \r\n% Output:\r\n%   x        grid points (vector, length n+1)\r\n%   u        solution values at x (vector, length n+1)\r\n\r\n% Define the grid.\r\nh = (b-a)/n;\r\nx = a + h*(0:n)';  \r\n\r\n% Templates for the subinterval matrix and vector contributions.\r\nKe = [1 -1; -1 1];\r\nMe = (1/6)*[2 1; 1 2];\r\nfe = (1/2)*[1; 1];\r\n\r\n% Evaluate coefficent functions and find average values.\r\ncval = c(x);   cbar = (cval(1:n)+cval(2:n+1)) / 2;\r\nsval = s(x);   sbar = (sval(1:n)+sval(2:n+1)) / 2;\r\nfval = f(x);   fbar = (fval(1:n)+fval(2:n+1)) / 2;\r\n\r\n% Assemble global system, one interval at a time.\r\nK = zeros(n-1,n-1);  M = zeros(n-1,n-1);  f = zeros(n-1,1);\r\nK(1,1) = cbar(1)/h;  M(1,1) = sbar(1)*h/3;  f(1) = fbar(1)*h/2;\r\nK(n-1,n-1) = cbar(n)/h;  M(n-1,n-1) = sbar(n)*h/3;  f(n-1) = fbar(n)*h/2;\r\nfor k = 2:n-1\r\n  K(k-1:k,k-1:k) = K(k-1:k,k-1:k) + (cbar(k)/h) * Ke;\r\n  M(k-1:k,k-1:k) = M(k-1:k,k-1:k) + (sbar(k)*h) * Me;\r\n  f(k-1:k) = f(k-1:k) + (fbar(k)*h) * fe;\r\nend  \r\n\r\n% Solve system for the interior values.\r\nu = (K+M) \\ f;\r\nu = [0; u; 0];      % put the boundary values into the result","lang":"matlab","showLineNumbers":true,"filename":"fem.m","key":"yn6qHi8bSY"}],"key":"m7e9oPkAaB"}],"label":"function-fem-matlab","identifier":"function-fem-matlab","html_id":"function-fem-matlab","key":"c1U83VyjaT"},{"type":"heading","depth":2,"position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"children":[{"type":"text","value":"Examples","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"key":"mgwqNJpEP5"}],"identifier":"examples","label":"Examples","html_id":"examples","implicit":true,"key":"CbYkhC2WHj"}],"key":"IKvduNvIwq"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"cd  /Users/driscoll/Documents/GitHub/fnc/matlab\nFNC_init;","visibility":"show","key":"ADigkZNXk6"},{"type":"output","id":"LV_s5dWxRgQrvEGad_yq6","data":[{"output_type":"stream","name":"stdout","text":"Executing ..."}],"visibility":"show","key":"HxdrTvmNGz"}],"data":{"tags":[]},"visibility":"remove","key":"NPMJSkjPt4"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"children":[{"type":"text","value":"10.1 ","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"key":"q7RpygmDrk"},{"type":"link","identifier":"section-bvp-tpbvp","label":"section-bvp-tpbvp","kind":"narrative","position":{"start":{"line":75,"column":6},"end":{"line":75,"column":24}},"url":"/tpbvp","internal":true,"dataUrl":"/tpbvp.json","children":[{"type":"text","value":"Two-point BVP","key":"mRJQnAFint"}],"key":"ruBadXp6En"}],"identifier":"id-10-1","label":"10.1 ","html_id":"id-10-1","implicit":true,"key":"mGztdgDeNP"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-tpbvp-mems","label":"demo-tpbvp-mems","kind":"proof:example","position":{"start":{"line":78,"column":1},"end":{"line":78,"column":17}},"children":[{"type":"text","value":"Example ","key":"YJzoyyvWuB"},{"type":"text","value":"10.1.3","key":"eycyCqDxdC"}],"template":"Example %s","enumerator":"10.1.3","resolved":true,"html_id":"demo-tpbvp-mems","remote":true,"url":"/tpbvp","dataUrl":"/tpbvp.json","key":"YRIdGvCgxn"}],"key":"XT76MWpIRH"},{"type":"paragraph","position":{"start":{"line":83,"column":1},"end":{"line":83,"column":1}},"children":[{"type":"text","value":"To define the ","key":"HZFD8LpXAO"},{"type":"abbreviation","title":"boundary-value problem","children":[{"type":"text","value":"BVP","key":"Cv6HiKJ6AQ"}],"key":"njWaFZeAdi"},{"type":"text","value":", we need to define some functions. (For this simple problem, we will use anonymous functions, but for a more substantial one, it would be better to use separate files.) The first defines ","key":"sfzoIB5mQR"},{"type":"inlineMath","value":"\\mathbf{f}(x, \\mathbf{y})","position":{"start":{"line":83,"column":1},"end":{"line":83,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">f</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo separator=\"true\">,</mo><mi mathvariant=\"bold\">y</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\mathbf{f}(x, \\mathbf{y})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.10903em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">y</span><span class=\"mclose\">)</span></span></span></span>","key":"OjUgAiMVyB"},{"type":"text","value":".","position":{"start":{"line":83,"column":1},"end":{"line":83,"column":1}},"key":"cGHUGp5vvb"}],"indexEntries":[{"entry":"Julia","subEntry":{"value":"in-place function","kind":"entry"},"emphasis":true}],"label":"index-PVlcAFUDye","identifier":"index-pvlcafudye","html_id":"index-pvlcafudye","key":"qITFUgn3RS"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"lambda = 0.6;\nbvpfcn = @(r, y) [ y(2); lambda / y(1)^2 - y(2) / r  ];    % column vector","key":"cc3DVl4YRP"},{"type":"output","id":"TGIJVTYgo_zWCiuRMpZNz","data":[],"key":"LMXYBV3ftD"}],"data":{},"key":"tLl3fFy1H4"},{"type":"paragraph","position":{"start":{"line":90,"column":1},"end":{"line":90,"column":1}},"children":[{"type":"text","value":"Our second function defines the boundary conditions. It takes ","position":{"start":{"line":90,"column":1},"end":{"line":90,"column":1}},"key":"AdBieJ7hSN"},{"type":"inlineMath","value":"\\mathbf{y}(a)","position":{"start":{"line":90,"column":1},"end":{"line":90,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">y</mi><mo stretchy=\"false\">(</mo><mi>a</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\mathbf{y}(a)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">y</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">a</span><span class=\"mclose\">)</span></span></span></span>","key":"kZ7mP7TZtj"},{"type":"text","value":" and ","position":{"start":{"line":90,"column":1},"end":{"line":90,"column":1}},"key":"C2YiD1LMjk"},{"type":"inlineMath","value":"\\mathbf{y}(b)","position":{"start":{"line":90,"column":1},"end":{"line":90,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">y</mi><mo stretchy=\"false\">(</mo><mi>b</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\mathbf{y}(b)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">y</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">b</span><span class=\"mclose\">)</span></span></span></span>","key":"jp3jrSTfu9"},{"type":"text","value":" as arguments and returns a vector of residuals; i.e., values that should be zero when the boundary conditions are satisfied.","position":{"start":{"line":90,"column":1},"end":{"line":90,"column":1}},"key":"c4zqPnyukr"}],"key":"J0uTaS10lN"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"bcfcn = @(ya, yb) [ ya(2); yb(1) - 1 ];    % y_2(a) = 0;  y_1(b) = 1","key":"oNTcsHlbXT"},{"type":"output","id":"MVOfne1Xek3Lj2hwY5VJY","data":[],"key":"nq2Zh4E1t7"}],"data":{},"key":"CujNX9kpKy"},{"type":"paragraph","position":{"start":{"line":96,"column":1},"end":{"line":96,"column":1}},"children":[{"type":"text","value":"The third function we define isn’t part of the mathematical formulation. Rather, it provides an initial guess for the solution. Here we choose both components to be constant.","position":{"start":{"line":96,"column":1},"end":{"line":96,"column":1}},"key":"kx9WuS75xY"}],"key":"Y6atS9vsew"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"y_init = @(r) [ 1; 0 ];","key":"WvRgfZl6ff"},{"type":"output","id":"RbolfRhiICpaDytbzjrmJ","data":[],"key":"KZaOeqZasR"}],"data":{},"key":"hbd7xh6eDT"},{"type":"paragraph","position":{"start":{"line":102,"column":1},"end":{"line":102,"column":1}},"children":[{"type":"text","value":"Now we can solve the ","key":"dPIX7sERdH"},{"type":"abbreviation","title":"boundary-value problem","children":[{"type":"text","value":"BVP","key":"hy8JVuEguc"}],"key":"vwGxHVEOWG"},{"type":"text","value":" using the ","key":"QX90iwJ8U0"},{"type":"inlineCode","value":"bvp4c","position":{"start":{"line":102,"column":1},"end":{"line":102,"column":1}},"key":"hNQjGUUWyl"},{"type":"text","value":" function. We need to specify the nodes on which to solve the problem. The domain of the mathematical problem is ","position":{"start":{"line":102,"column":1},"end":{"line":102,"column":1}},"key":"EZmVefIRK2"},{"type":"inlineMath","value":"r\\in [0,1]","position":{"start":{"line":102,"column":1},"end":{"line":102,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>r</mi><mo>∈</mo><mo stretchy=\"false\">[</mo><mn>0</mn><mo separator=\"true\">,</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">r\\in [0,1]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]</span></span></span></span>","key":"wEkvcvv5fG"},{"type":"text","value":".But since there is a division by ","position":{"start":{"line":102,"column":1},"end":{"line":102,"column":1}},"key":"yGwAFMf21G"},{"type":"inlineMath","value":"r","position":{"start":{"line":102,"column":1},"end":{"line":102,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>r</mi></mrow><annotation encoding=\"application/x-tex\">r</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span></span></span></span>","key":"Jx4BuiL1KB"},{"type":"text","value":" in the ","key":"esLZZLtf6h"},{"type":"abbreviation","title":"ordinary differential equation","children":[{"type":"text","value":"ODE","key":"gEuh94KG50"}],"key":"n7S6MCSOdO"},{"type":"text","value":", we want to avoid ","key":"toAU2JNIGi"},{"type":"inlineMath","value":"r=0","position":{"start":{"line":102,"column":1},"end":{"line":102,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>r</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">r=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"aDnVNiuyRh"},{"type":"text","value":" by truncating the domain a tiny bit.","position":{"start":{"line":102,"column":1},"end":{"line":102,"column":1}},"key":"wuGOL6sUVp"}],"key":"CALefCMA5W"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"nodes = linspace(eps, 1, 61);\nsol_init = bvpinit(nodes, y_init);\nsol = bvp4c(bvpfcn, bcfcn, sol_init);\nplot(sol.x, sol.y, '-o')\nxlabel('r'), ylabel('y(r)')\ntitle('Solution of the membrane problem')\nlegend(\"w(r)\", \"w'(r)\", location=\"east\");","key":"a1TuzKO166"},{"type":"output","id":"iFBT2ypWTcwqvqgT8CInw","data":[{"output_type":"execute_result","execution_count":5,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"9622146aaba60a2ab7a433030bc68413","path":"/2025-02-12/build/9622146aaba60a2ab7a433030bc68413.png"}}}],"key":"pB8c1jUsGf"}],"data":{},"key":"DBxyQi851l"},{"type":"paragraph","position":{"start":{"line":114,"column":1},"end":{"line":114,"column":1}},"children":[{"type":"text","value":"It’s smart to check visually that the boundary conditions are satisfied.","position":{"start":{"line":114,"column":1},"end":{"line":114,"column":1}},"key":"TYT2CeuNLP"}],"key":"iYaaUnUNOZ"}],"label":"demo-tpbvp-mems-matlab","identifier":"demo-tpbvp-mems-matlab","html_id":"demo-tpbvp-mems-matlab","key":"UJcnm5p961"},{"type":"heading","depth":3,"position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"children":[{"type":"text","value":"10.2 ","position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"key":"LahwNaVBlb"},{"type":"link","identifier":"section-bvp-shooting","label":"section-bvp-shooting","kind":"narrative","position":{"start":{"line":117,"column":6},"end":{"line":117,"column":27}},"url":"/shooting","internal":true,"dataUrl":"/shooting.json","children":[{"type":"text","value":"Shooting","key":"GqEFU1wapQ"}],"key":"Ktgtq2cxwO"}],"identifier":"id-10-2","label":"10.2 ","html_id":"id-10-2","implicit":true,"key":"mFxJA8bGDV"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-shooting-naive","label":"demo-shooting-naive","kind":"proof:example","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":21}},"children":[{"type":"text","value":"Example ","key":"mJX1Qvk6HV"},{"type":"text","value":"10.2.1","key":"mfhGJPmvwJ"}],"template":"Example %s","enumerator":"10.2.1","resolved":true,"html_id":"demo-shooting-naive","remote":true,"url":"/shooting","dataUrl":"/shooting.json","key":"kL3ZR9v7nn"}],"key":"ER46wmH9MF"},{"type":"paragraph","position":{"start":{"line":121,"column":1},"end":{"line":121,"column":1}},"children":[{"type":"text","value":"Let’s first examine the shooting approach for the TP","key":"FWCQS2daZ6"},{"type":"abbreviation","title":"boundary-value problem","children":[{"type":"text","value":"BVP","key":"p1Z1suhlkV"}],"key":"B8H1dup5JJ"},{"type":"text","value":" from ","key":"lIyjdu9JUS"},{"type":"crossReference","kind":"proof:example","identifier":"example-tpbvp-mems","label":"example-tpbvp-mems","children":[{"type":"text","value":"Example ","key":"d0FeL3o6P2"},{"type":"text","value":"10.1.2","key":"xb8KaxtVq3"}],"template":"Example %s","enumerator":"10.1.2","resolved":true,"html_id":"example-tpbvp-mems","remote":true,"url":"/tpbvp","dataUrl":"/tpbvp.json","key":"yHR0jYIdTn"},{"type":"text","value":" with ","position":{"start":{"line":121,"column":1},"end":{"line":121,"column":1}},"key":"MVhQAu0qTW"},{"type":"inlineMath","value":"\\lambda=0.6","position":{"start":{"line":121,"column":1},"end":{"line":121,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>λ</mi><mo>=</mo><mn>0.6</mn></mrow><annotation encoding=\"application/x-tex\">\\lambda=0.6</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">λ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0.6</span></span></span></span>","key":"phtR2BHupa"},{"type":"text","value":".","position":{"start":{"line":121,"column":1},"end":{"line":121,"column":1}},"key":"SZ3hhjrLZh"}],"key":"zwhtrX3oca"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"lambda = 0.6;\nphi = @(r, w, dwdr) lambda ./ w.^2 - dwdr ./ r;","key":"FcQpJZPGA3"},{"type":"output","id":"IxwAM82Qy_wN6W04Qtonq","data":[],"key":"gmbj6tQnvy"}],"data":{},"key":"WVQJSJUMEE"},{"type":"paragraph","position":{"start":{"line":128,"column":1},"end":{"line":128,"column":1}},"children":[{"type":"text","value":"We convert the ","key":"enoKVH81cO"},{"type":"abbreviation","title":"ordinary differential equation","children":[{"type":"text","value":"ODE","key":"VPvSP0qE0P"}],"key":"CPHWZZoW29"},{"type":"text","value":" to a first-order system in order to apply a numerical method. We also have to truncate the domain to avoid division by zero.","key":"zrdZoMXggU"}],"key":"bV2KGsyLu8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"f = @(r, w) [ w(2); phi(r, w(1), w(2)) ];\na = eps;  b = 1;","key":"cJHXDKRfFP"},{"type":"output","id":"IOngQdcecFUc9qzob_JgN","data":[],"key":"uHW9FVjVnv"}],"data":{},"key":"AkoHGjeZGl"},{"type":"paragraph","position":{"start":{"line":135,"column":1},"end":{"line":135,"column":1}},"children":[{"type":"text","value":"The ","key":"u0eGQ2lvhi"},{"type":"abbreviation","title":"boundary-value problem","children":[{"type":"text","value":"BVP","key":"whtU1TfNH0"}],"key":"W69a6gM7Yt"},{"type":"text","value":" specifies ","key":"dQ9fe6PpZP"},{"type":"inlineMath","value":"w'(0)=y_2(0)=0","position":{"start":{"line":135,"column":1},"end":{"line":135,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>w</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo stretchy=\"false\">(</mo><mn>0</mn><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mi>y</mi><mn>2</mn></msub><mo stretchy=\"false\">(</mo><mn>0</mn><mo stretchy=\"false\">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">w&#x27;(0)=y_2(0)=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0019em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"Ol8rscNh5B"},{"type":"text","value":". We can try multiple values for the unknown ","position":{"start":{"line":135,"column":1},"end":{"line":135,"column":1}},"key":"UZGyhUBsXF"},{"type":"inlineMath","value":"w(0)=y_1(0)","position":{"start":{"line":135,"column":1},"end":{"line":135,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>w</mi><mo stretchy=\"false\">(</mo><mn>0</mn><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mi>y</mi><mn>1</mn></msub><mo stretchy=\"false\">(</mo><mn>0</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">w(0)=y_1(0)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mclose\">)</span></span></span></span>","key":"UE6oE3jPES"},{"type":"text","value":" and plot the solutions.","position":{"start":{"line":135,"column":1},"end":{"line":135,"column":1}},"key":"u6j1An2Mta"}],"key":"jki9f3Etop"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf\nivp = ode;\nivp.ODEFcn = f;\nivp.InitialTime = a;\nfor w0 = 0.4:0.1:0.9\n    ivp.InitialValue = [w0; 0];\n    sol = solve(ivp, a, b);\n    plot(sol.Time, sol.Solution(1, :))\n    hold on\nend\nxlabel('r'),  ylabel('w(r)')\ntitle('Solutions for multiple choices of w(0)')","key":"h1ukS8rO9s"},{"type":"output","id":"3mtDUFiDANl2ANetekYzN","data":[{"output_type":"execute_result","execution_count":8,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"6039d73ba5952995bcf04f6e9b02ac74","path":"/2025-02-12/build/6039d73ba5952995bcf04f6e9b02ac74.png"}}}],"key":"WCypCiKNzh"}],"data":{},"key":"OMNY1PnVWd"},{"type":"paragraph","position":{"start":{"line":152,"column":1},"end":{"line":152,"column":1}},"children":[{"type":"text","value":"On the graph, it’s the curve starting at ","position":{"start":{"line":152,"column":1},"end":{"line":152,"column":1}},"key":"tuMHL6rZR9"},{"type":"inlineMath","value":"w(0)=0.8","position":{"start":{"line":152,"column":1},"end":{"line":152,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>w</mi><mo stretchy=\"false\">(</mo><mn>0</mn><mo stretchy=\"false\">)</mo><mo>=</mo><mn>0.8</mn></mrow><annotation encoding=\"application/x-tex\">w(0)=0.8</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0.8</span></span></span></span>","key":"IkUOFZPvMa"},{"type":"text","value":" that comes closest to the required condition ","position":{"start":{"line":152,"column":1},"end":{"line":152,"column":1}},"key":"ykxKrk5sUz"},{"type":"inlineMath","value":"w(1)=1","position":{"start":{"line":152,"column":1},"end":{"line":152,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>w</mi><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">w(1)=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"ToKFWVVun4"},{"type":"text","value":", but it’s a bit too large.","position":{"start":{"line":152,"column":1},"end":{"line":152,"column":1}},"key":"VX0b95NG0E"}],"key":"xSTHDs90tS"}],"label":"demo-shooting-naive-matlab","identifier":"demo-shooting-naive-matlab","html_id":"demo-shooting-naive-matlab","key":"yGS4FQ24Pe"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-shooting-mems","label":"demo-shooting-mems","kind":"proof:example","position":{"start":{"line":156,"column":1},"end":{"line":156,"column":20}},"children":[{"type":"text","value":"Example ","key":"sxKsK9925G"},{"type":"text","value":"10.2.2","key":"HjdcMMAZI9"}],"template":"Example %s","enumerator":"10.2.2","resolved":true,"html_id":"demo-shooting-mems","remote":true,"url":"/shooting","dataUrl":"/shooting.json","key":"nUpDVXdtSV"}],"key":"PI3YOkXisk"},{"type":"paragraph","position":{"start":{"line":158,"column":1},"end":{"line":158,"column":1}},"children":[{"type":"text","value":"We revisit ","position":{"start":{"line":158,"column":1},"end":{"line":158,"column":1}},"key":"o9YRze8dy9"},{"type":"crossReference","kind":"proof:example","identifier":"demo-shooting-naive","label":"demo-shooting-naive","children":[{"type":"text","value":"Demo ","key":"pMs9KESE7D"},{"type":"text","value":"10.2.1","key":"UhfVoeiITw"}],"template":"Example %s","enumerator":"10.2.1","resolved":true,"html_id":"demo-shooting-naive","remote":true,"url":"/shooting","dataUrl":"/shooting.json","key":"KVDCTyyVEo"},{"type":"text","value":" but let ","position":{"start":{"line":158,"column":1},"end":{"line":158,"column":1}},"key":"d29hGMsbLm"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-shoot","label":"function-shoot","children":[{"type":"text","value":"Function ","key":"c1QKHC4aXe"},{"type":"text","value":"10.2.1","key":"zjpER8coHT"}],"template":"Algorithm %s","enumerator":"10.2.1","resolved":true,"html_id":"function-shoot","remote":true,"url":"/shooting","dataUrl":"/shooting.json","key":"uLtL4Ay1YY"},{"type":"text","value":" do the heavy lifting.","position":{"start":{"line":158,"column":1},"end":{"line":158,"column":1}},"key":"RQEbQg0bI1"}],"key":"kXSYdRfPcM"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"lambda = 0.6;\nphi = @(r, w, dwdr) lambda ./ w.^2 - dwdr ./ r;   \na = eps;  b = 1;    % avoid r=0 in denominator","key":"OnDsou6XAX"},{"type":"output","id":"QUZ4pR_X7b3VptyirAIBt","data":[],"key":"XcNf1s00PG"}],"data":{},"key":"TLmmFrBZEi"},{"type":"paragraph","position":{"start":{"line":166,"column":1},"end":{"line":166,"column":1}},"children":[{"type":"text","value":"We specify the given and unknown endpoint values.","position":{"start":{"line":166,"column":1},"end":{"line":166,"column":1}},"key":"DNt7aCEpaO"}],"key":"qyPwJV2iNU"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"ga = @(u, du) du;\ngb = @(u, du) u - 1;","key":"JS6Nh3yiC6"},{"type":"output","id":"3pBsEqG3GwzkSbj7gJ7uN","data":[],"key":"EY07YMr2ur"}],"data":{},"key":"PZZCQRauie"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"init = [0.8; 0];    % initial guess for u(a) and u'(a)\n[r, w, dwdx] = shoot(phi, a, b, ga, gb, init, 1e-5);\nclf,  plot(r, w)\ntitle('Correct solution')\nxlabel('r'),  ylabel('w(r)')","key":"X16elJigLT"},{"type":"output","id":"L5KoYid8-UXV1C7Kw3c5d","data":[{"output_type":"execute_result","execution_count":11,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"171fc46edd179a0244c8a344c0d9340e","path":"/2025-02-12/build/171fc46edd179a0244c8a344c0d9340e.png"}}}],"key":"w5ougGkN4l"}],"data":{},"key":"IMMytD71U2"},{"type":"paragraph","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"children":[{"type":"text","value":"The value of ","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"key":"SBEDuDLrh7"},{"type":"inlineMath","value":"w","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>w</mi></mrow><annotation encoding=\"application/x-tex\">w</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span></span></span></span>","key":"hanyK8HTr9"},{"type":"text","value":" at ","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"key":"mtdc7uuB2H"},{"type":"inlineMath","value":"r=1","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>r</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">r=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"OrqSvJVltD"},{"type":"text","value":", meant to be exactly one, was computed to be","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"key":"b2hR0bIOiY"}],"key":"o0BJny32fv"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"format long\nw(end)","key":"pmqeXMKf30"},{"type":"output","id":"B0aIU7gh9D_XuC9cDOtYZ","data":[{"output_type":"execute_result","execution_count":12,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = \n   1.000000260413213\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = \n   1.000000260413213\n","content_type":"text/plain"}}}],"key":"nRBiWKO6Mp"}],"data":{},"key":"rdhnUIJpfj"},{"type":"paragraph","position":{"start":{"line":188,"column":1},"end":{"line":188,"column":1}},"children":[{"type":"text","value":"The accuracy is consistent with the error tolerance used for the ","key":"o4co4MuHUS"},{"type":"abbreviation","title":"initial-value problem","children":[{"type":"text","value":"IVP","key":"LWAL1CRvtF"}],"key":"uzaeNaU1dF"},{"type":"text","value":" solution. The initial value ","key":"Cn4y5rBipp"},{"type":"inlineMath","value":"w(0)","position":{"start":{"line":188,"column":1},"end":{"line":188,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>w</mi><mo stretchy=\"false\">(</mo><mn>0</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">w(0)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mclose\">)</span></span></span></span>","key":"IAMbzvSmXT"},{"type":"text","value":" that gave this solution is","position":{"start":{"line":188,"column":1},"end":{"line":188,"column":1}},"key":"Ekn2iLr2QB"}],"key":"uwxbDqK0z8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"w(1)","key":"CUqbbNV4ar"},{"type":"output","id":"-17lp1hdQOcbSH_YE39gZ","data":[{"output_type":"execute_result","execution_count":13,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = \n   0.787758137853413\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = \n   0.787758137853413\n","content_type":"text/plain"}}}],"key":"ZgOJfLC5d0"}],"data":{},"key":"Ugk0J3plF6"}],"label":"demo-shooting-mems-matlab","identifier":"demo-shooting-mems-matlab","html_id":"demo-shooting-mems-matlab","key":"BaA71ZmgcZ"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-shooting-unstable","label":"demo-shooting-unstable","kind":"proof:example","position":{"start":{"line":196,"column":1},"end":{"line":196,"column":24}},"children":[{"type":"text","value":"Example ","key":"Anu6FH4Vhw"},{"type":"text","value":"10.2.3","key":"KreoSth11U"}],"template":"Example %s","enumerator":"10.2.3","resolved":true,"html_id":"demo-shooting-unstable","remote":true,"url":"/shooting","dataUrl":"/shooting.json","key":"pPUbErhpZY"}],"key":"ptz9y0pmMF"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"ga = @(u, du) u + 1;\ngb = @(u, du) u;\nclf\nwarning off\nfor lambda = 16:4:28\n    phi = @(x, u, du_dx) lambda^2 * (u + 1);\n    [x, u, du_dx] = shoot(phi, 0.0, 1.0, ga, gb, [-1; 0], 1e-8);\n    plot(x, u, displayname=sprintf(\"lambda=%d\", lambda))\n    hold on\n    xlabel('x'),  ylabel('u(x)')\n    title('Shooting instability')\n    legend(location=\"northwest\");\nend","visibility":"show","key":"UTkLoSxOrk"},{"type":"output","id":"rIvj6Z1j-qHBKU_UI2s-w","data":[{"output_type":"execute_result","execution_count":14,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"d86f6c9881e507a427260a894c6fcd89","path":"/2025-02-12/build/d86f6c9881e507a427260a894c6fcd89.png"}}},{"output_type":"stream","name":"stderr","text":"Error using shoot/objective (line 27)\nError setting property 'InitialValue' of class 'ode'. Value must be finite.\n\nError in levenberg (line 27)\n    xnew = x(:,k) + s;   fnew = f(xnew);\n\nError in shoot (line 34)\ns = levenberg(@objective, init, tol);"}],"visibility":"show","key":"npEQwPdL4G"}],"data":{"tags":["raises-exception"]},"visibility":"show","key":"J0jJXT5gsd"},{"type":"paragraph","position":{"start":{"line":216,"column":1},"end":{"line":216,"column":1}},"children":[{"type":"text","value":"The numerical solution fails at the largest value of ","position":{"start":{"line":216,"column":1},"end":{"line":216,"column":1}},"key":"XT4cI4S536"},{"type":"text","value":"λ","position":{"start":{"line":216,"column":1},"end":{"line":216,"column":1}},"key":"yaWWs5kTPW"},{"type":"text","value":" because the initial condition became infinite.","position":{"start":{"line":216,"column":1},"end":{"line":216,"column":1}},"key":"QvrhxR6Kp8"}],"key":"Js4kNEETeS"}],"label":"demo-shooting-unstable-matlab","identifier":"demo-shooting-unstable-matlab","html_id":"demo-shooting-unstable-matlab","key":"YLplpdk6Iy"},{"type":"heading","depth":3,"position":{"start":{"line":219,"column":1},"end":{"line":219,"column":1}},"children":[{"type":"text","value":"10.3 ","position":{"start":{"line":219,"column":1},"end":{"line":219,"column":1}},"key":"OLxr7fyh86"},{"type":"link","identifier":"section-bvp-diffmats","label":"section-bvp-diffmats","kind":"narrative","position":{"start":{"line":219,"column":6},"end":{"line":219,"column":27}},"url":"/diffmats","internal":true,"dataUrl":"/diffmats.json","children":[{"type":"text","value":"Differentiation matrices","key":"yaDxfKDEkp"}],"key":"b1FVUcLxUS"}],"identifier":"id-10-3","label":"10.3 ","html_id":"id-10-3","implicit":true,"key":"GuYvu1DYwi"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-diffmats-2nd","label":"demo-diffmats-2nd","kind":"proof:example","position":{"start":{"line":221,"column":1},"end":{"line":221,"column":19}},"children":[{"type":"text","value":"Example ","key":"MVQIok1UTb"},{"type":"text","value":"10.3.1","key":"yE90slLhVZ"}],"template":"Example %s","enumerator":"10.3.1","resolved":true,"html_id":"demo-diffmats-2nd","remote":true,"url":"/diffmats","dataUrl":"/diffmats.json","key":"qrhxxhoWMU"}],"key":"zH6zV7pyva"},{"type":"paragraph","position":{"start":{"line":223,"column":1},"end":{"line":223,"column":1}},"children":[{"type":"text","value":"We test first-order and second-order differentiation matrices for the function ","position":{"start":{"line":223,"column":1},"end":{"line":223,"column":1}},"key":"bWUHbSsYnM"},{"type":"inlineMath","value":"x + \\exp(\\sin 4x)","position":{"start":{"line":223,"column":1},"end":{"line":223,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mo>+</mo><mi>exp</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mi>sin</mi><mo>⁡</mo><mn>4</mn><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">x + \\exp(\\sin 4x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop\">exp</span><span class=\"mopen\">(</span><span class=\"mop\">sin</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">4</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span>","key":"Xbl7qT719c"},{"type":"text","value":" over ","position":{"start":{"line":223,"column":1},"end":{"line":223,"column":1}},"key":"uuvolrdV2o"},{"type":"inlineMath","value":"[-1,1]","position":{"start":{"line":223,"column":1},"end":{"line":223,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mo>−</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[-1,1]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">−</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]</span></span></span></span>","key":"wBKsBmgSBd"},{"type":"text","value":".","position":{"start":{"line":223,"column":1},"end":{"line":223,"column":1}},"key":"hfuEt1O80t"}],"key":"vzCCm8oaWJ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"f = @(x) x + exp(sin(4*x));","key":"YfTPpt9z1g"},{"type":"output","id":"wUhGdVWGL78wBeIVVubQh","data":[],"key":"dv7IdCWdQK"}],"data":{},"key":"gkaVERzGw1"},{"type":"paragraph","position":{"start":{"line":229,"column":1},"end":{"line":229,"column":1}},"children":[{"type":"text","value":"For reference, here are the exact first and second derivatives.","position":{"start":{"line":229,"column":1},"end":{"line":229,"column":1}},"key":"OnL60TLq6n"}],"key":"DDBas68wq4"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"df_dx = @(x) 1 + 4 * exp(sin(4*x)) .* cos(4*x);\nd2f_dx2 = @(x) 4 * exp(sin(4*x)) .* (4*cos(4*x).^2 - 4*sin(4*x));","key":"LCPePWzIJQ"},{"type":"output","id":"FNCQZrJCw49M7LX3uvRuy","data":[],"key":"j0mDYnsEm0"}],"data":{},"key":"cVhMrR2DAB"},{"type":"paragraph","position":{"start":{"line":236,"column":1},"end":{"line":236,"column":1}},"children":[{"type":"text","value":"We discretize on equally spaced nodes and evaluate ","position":{"start":{"line":236,"column":1},"end":{"line":236,"column":1}},"key":"BhicZHxS0B"},{"type":"inlineMath","value":"f","position":{"start":{"line":236,"column":1},"end":{"line":236,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>","key":"KRLaqtTYGy"},{"type":"text","value":" at the nodes.","position":{"start":{"line":236,"column":1},"end":{"line":236,"column":1}},"key":"SRon7eTNOk"}],"key":"JKhTBgbEe1"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[t, Dx, Dxx] = diffmat2(12, [-1 1]);\ny = f(t);","key":"uylvLHwbb0"},{"type":"output","id":"Dl5f92dY4MEN_WD7HGj9j","data":[],"key":"lw0JhO0g5b"}],"data":{},"key":"bQtKlWOlYd"},{"type":"paragraph","position":{"start":{"line":243,"column":1},"end":{"line":243,"column":1}},"children":[{"type":"text","value":"Then the first two derivatives of ","position":{"start":{"line":243,"column":1},"end":{"line":243,"column":1}},"key":"hvlZC2POHD"},{"type":"inlineMath","value":"f","position":{"start":{"line":243,"column":1},"end":{"line":243,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>","key":"m3iPs2muKy"},{"type":"text","value":" each require one matrix-vector multiplication.","position":{"start":{"line":243,"column":1},"end":{"line":243,"column":1}},"key":"iox22NSk6i"}],"key":"MaBwjlgHnZ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"yx = Dx * y;\nyxx = Dxx * y;","key":"C6faTKTJc7"},{"type":"output","id":"dvYI9xUlJTctuFf1dW7Dz","data":[],"key":"pBj4aeuoXn"}],"data":{},"key":"SZWeTfwgOJ"},{"type":"paragraph","position":{"start":{"line":250,"column":1},"end":{"line":250,"column":1}},"children":[{"type":"text","value":"The results show poor accuracy for this small value of ","position":{"start":{"line":250,"column":1},"end":{"line":250,"column":1}},"key":"IlMidh42hz"},{"type":"inlineMath","value":"n","position":{"start":{"line":250,"column":1},"end":{"line":250,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"A3XtYcd7a9"},{"type":"text","value":".","position":{"start":{"line":250,"column":1},"end":{"line":250,"column":1}},"key":"MLJHAfQ8TG"}],"key":"UMxsq7Wzfv"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf,  subplot(2, 1, 1)\nfplot(df_dx, [-1, 1]),  hold on\nplot(t, yx, 'ko')\nxlabel('x'),  ylabel('f''(x)')\nsubplot(2, 1, 2)\nfplot(d2f_dx2, [-1, 1]),  hold on\nplot(t, yxx, 'ko')\nxlabel('x'),  ylabel('f''''(x)')","key":"DhWRxfbykP"},{"type":"output","id":"IcwN2LWlBiBbl0N_G0fIm","data":[{"output_type":"execute_result","execution_count":19,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"7bc2065e8562af6ef5865b0837ab7b39","path":"/2025-02-12/build/7bc2065e8562af6ef5865b0837ab7b39.png"}}}],"key":"M0OcvFgjiH"}],"data":{},"key":"zYPDfKB0OI"},{"type":"paragraph","position":{"start":{"line":263,"column":1},"end":{"line":263,"column":1}},"children":[{"type":"text","value":"An convergence experiment confirms the order of accuracy. Because we expect an algebraic convergence rate, we use a log-log plot of the errors.","position":{"start":{"line":263,"column":1},"end":{"line":263,"column":1}},"key":"oyyDWCjGUh"}],"key":"PzRH4EHEYS"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"n = round( 2 .^ (4:.5:11)' );\nerr = zeros(length(n), 2);\nfor k = 1:length(n)\n    [t, Dx, Dxx] = diffmat2(n(k), [-1, 1]);\n    y = f(t);\n    err(k, 1) = norm(df_dx(t) - Dx * y, Inf);\n    err(k, 2) = norm(d2f_dx2(t) - Dxx * y, Inf);\nend\nclf\nloglog(n, err, 'o-'), hold on\nloglog(n, 100 * n.^(-2), 'k--')\nlegend(\"f'\", \"f''\", '2nd order')\nxlabel('n'),  ylabel('max error')\ntitle('Convergence of finite differences')","key":"DhNMYqXMLh"},{"type":"output","id":"Kn4SSzMTtLG49fSh5s5I3","data":[{"output_type":"execute_result","execution_count":20,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"c8fb4f30d63c96c5670b85500df51ec7","path":"/2025-02-12/build/c8fb4f30d63c96c5670b85500df51ec7.png"}}}],"key":"OAXxyvUjAW"}],"data":{},"key":"blnKBpP4Fg"}],"label":"demo-diffmats-2nd-matlab","identifier":"demo-diffmats-2nd-matlab","html_id":"demo-diffmats-2nd-matlab","key":"i4RzFfLz5Q"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-diffmats-cheb","label":"demo-diffmats-cheb","kind":"proof:example","position":{"start":{"line":284,"column":1},"end":{"line":284,"column":20}},"children":[{"type":"text","value":"Example ","key":"Hjh35ZGlb0"},{"type":"text","value":"10.3.2","key":"Ax4QHxtrzU"}],"template":"Example %s","enumerator":"10.3.2","resolved":true,"html_id":"demo-diffmats-cheb","remote":true,"url":"/diffmats","dataUrl":"/diffmats.json","key":"WNnYDEooiz"}],"key":"v48o5Q1abj"},{"type":"paragraph","position":{"start":{"line":286,"column":1},"end":{"line":286,"column":1}},"children":[{"type":"text","value":"Here is a ","position":{"start":{"line":286,"column":1},"end":{"line":286,"column":1}},"key":"SnOaFHgdDG"},{"type":"inlineMath","value":"4\\times 4","position":{"start":{"line":286,"column":1},"end":{"line":286,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>4</mn><mo>×</mo><mn>4</mn></mrow><annotation encoding=\"application/x-tex\">4\\times 4</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">4</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">4</span></span></span></span>","key":"OzXbsV2GVR"},{"type":"text","value":" Chebyshev differentiation matrix.","position":{"start":{"line":286,"column":1},"end":{"line":286,"column":1}},"key":"osHjk83oi8"}],"key":"TtMVgzRxgS"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[t, Dx] = diffcheb(3, [-1, 1]);\nformat rat\nDx","key":"ti9Mp6nMjT"},{"type":"output","id":"GhKlxSxmbZ5xR3a_21ddn","data":[{"output_type":"execute_result","execution_count":21,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>Dx = \n     -19/6            4             -4/3            1/2     \n      -1              1/3            1             -1/3     \n       1/3           -1             -1/3            1       \n      -1/2            4/3           -4             19/6     \n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"Dx = \n     -19/6            4             -4/3            1/2     \n      -1              1/3            1             -1/3     \n       1/3           -1             -1/3            1       \n      -1/2            4/3           -4             19/6     \n","content_type":"text/plain"}}}],"key":"CwdZNRBXpL"}],"data":{},"key":"eE8xtTpsOI"},{"type":"paragraph","position":{"start":{"line":294,"column":1},"end":{"line":294,"column":1}},"children":[{"type":"text","value":"We again test the convergence rate.","position":{"start":{"line":294,"column":1},"end":{"line":294,"column":1}},"key":"W0Tjlp5WRc"}],"key":"KtyDeLAijO"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"f = @(x) x + exp(sin(4*x));\ndf_dx = @(x) 1 + 4 * exp(sin(4*x)) .* cos(4*x);\nd2f_dx2 = @(x) 4 * exp(sin(4*x)) .* (4*cos(4*x).^2 - 4*sin(4*x));","key":"Iza5L1mGWW"},{"type":"output","id":"RvKpQTsSe2ExmMLIGBk_w","data":[],"key":"dE2BJw7Zo3"}],"data":{},"key":"HWQnPvwsTJ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"n = 5:5:70;\nerr = zeros(length(n), 2);\nfor k = 1:length(n)\n    [t, Dx, Dxx] = diffcheb(n(k), [-1, 1]);\n    y = f(t);\n    err(k, 1) = norm(df_dx(t) - Dx * y, Inf);\n    err(k, 2) = norm(d2f_dx2(t) - Dxx * y, Inf);\nend","key":"kfQ3SdfGkU"},{"type":"output","id":"370By7wNJ5O7bXj-W7MCe","data":[],"key":"Zkw6W6gX5w"}],"data":{},"key":"nNJdkzd5u7"},{"type":"paragraph","position":{"start":{"line":314,"column":1},"end":{"line":314,"column":1}},"children":[{"type":"text","value":"Since we expect a spectral convergence rate, we use a semi-log plot for the error.","position":{"start":{"line":314,"column":1},"end":{"line":314,"column":1}},"key":"Y3MaGGZ2Jq"}],"key":"huItkuyHNY"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf,  format\nsemilogy(n, err, 'o-'), hold on\nlegend(\"f'\", \"f''\")\nxlabel('n'),  ylabel('max error')\ntitle('Convergence of finite differences')","key":"HY1fRf56ha"},{"type":"output","id":"qHpts6tqTMIotuU55BghF","data":[{"output_type":"execute_result","execution_count":24,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"fa8390d51812f9dbd1eb69fa62472f9e","path":"/2025-02-12/build/fa8390d51812f9dbd1eb69fa62472f9e.png"}}}],"key":"PmX9NzYVzF"}],"data":{},"key":"RcAoxymqrN"}],"label":"demo-diffmats-cheb-matlab","identifier":"demo-diffmats-cheb-matlab","html_id":"demo-diffmats-cheb-matlab","key":"Kck2HtCcv8"},{"type":"heading","depth":3,"position":{"start":{"line":325,"column":1},"end":{"line":325,"column":1}},"children":[{"type":"text","value":"10.4 ","position":{"start":{"line":325,"column":1},"end":{"line":325,"column":1}},"key":"gvaNMUq88p"},{"type":"link","identifier":"section-bvp-linear","label":"section-bvp-linear","kind":"narrative","position":{"start":{"line":325,"column":6},"end":{"line":325,"column":25}},"url":"/linear","internal":true,"dataUrl":"/linear.json","children":[{"type":"text","value":"Collocation for linear problems","key":"xQHdyNKjAb"}],"key":"rdsp30T2EJ"}],"identifier":"id-10-4","label":"10.4 ","html_id":"id-10-4","implicit":true,"key":"VuvsBEqyQw"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-linear-solve","label":"demo-linear-solve","kind":"proof:example","position":{"start":{"line":327,"column":1},"end":{"line":327,"column":19}},"children":[{"type":"text","value":"Example ","key":"j9tEccycDW"},{"type":"text","value":"10.4.1","key":"iAsIypv5F8"}],"template":"Example %s","enumerator":"10.4.1","resolved":true,"html_id":"demo-linear-solve","remote":true,"url":"/linear","dataUrl":"/linear.json","key":"J5XcM4UGFg"}],"key":"vho5eqLm7N"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"exact = @(x) exp(sin(x));","key":"iqlYyPodVD"},{"type":"output","id":"CbgiYbDos1ccG8aL_XDnw","data":[],"key":"ekx8sAttGr"}],"data":{},"key":"rDhVBKO8WX"},{"type":"paragraph","position":{"start":{"line":334,"column":1},"end":{"line":334,"column":1}},"children":[{"type":"text","value":"The problem is presented above in our standard form, so we can identify the coefficient functions in the ","key":"NgOC3ptY0k"},{"type":"abbreviation","title":"ordinary differential equation","children":[{"type":"text","value":"ODE","key":"U8vUgdjQkN"}],"key":"v24azZCX6e"},{"type":"text","value":". Each should be coded as a function.","key":"mqv23dci1Q"}],"key":"lbOv8I5wzC"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"p = @(x) -cos(x);\nq = @(x) sin(x);\nr = @(x) 0*x;      % not a scalar","key":"W4wIzc02fJ"},{"type":"output","id":"bKRIet7r1628QdJeGqZJ9","data":[],"key":"gHWkSXl9TI"}],"data":{},"key":"a6EuGABxbY"},{"type":"paragraph","position":{"start":{"line":342,"column":1},"end":{"line":342,"column":1}},"children":[{"type":"text","value":"We solve the ","key":"DD6PekSIKC"},{"type":"abbreviation","title":"boundary-value problem","children":[{"type":"text","value":"BVP","key":"HMoDybgBMO"}],"key":"LObCz4Li2i"},{"type":"text","value":" and compare the result to the exact solution.","key":"Y8DMTKjW5s"}],"key":"vqJ6klRB0g"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[x, u] = bvplin(p, q, r, 0, 3*pi/2, 1, exp(-1), 30);","key":"dVpGeBfp9p"},{"type":"output","id":"Kb5padRCM6-poGQU4CBik","data":[],"key":"ACP4Oy5Yx7"}],"data":{},"key":"SvFRag2tzU"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf,  subplot(2, 1, 1)\nplot(x, u)\nylabel('solution')\ntitle('Solution of a linear BVP')\nsubplot(2, 1, 2)\nplot(x, exact(x) - u, 'o-')\nylabel('error')","key":"iboqUDgnrg"},{"type":"output","id":"jw66fbKO8oOzi8yU4x_Vb","data":[{"output_type":"execute_result","execution_count":28,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"d6336f43f28936905081854f0b1c35e6","path":"/2025-02-12/build/d6336f43f28936905081854f0b1c35e6.png"}}}],"key":"CLAfxkAVbE"}],"data":{},"key":"NvJwlIZ9XQ"}],"label":"demo-linear-solve-matlab","identifier":"demo-linear-solve-matlab","html_id":"demo-linear-solve-matlab","key":"agHezY3mX9"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-linear-converge","label":"demo-linear-converge","kind":"proof:example","position":{"start":{"line":360,"column":1},"end":{"line":360,"column":22}},"children":[{"type":"text","value":"Example ","key":"VCBgkEm480"},{"type":"text","value":"10.4.2","key":"KZbCLkZiJh"}],"template":"Example %s","enumerator":"10.4.2","resolved":true,"html_id":"demo-linear-converge","remote":true,"url":"/linear","dataUrl":"/linear.json","key":"yTq92mGpgy"}],"key":"PBDPdyFVvO"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"lambda = 10;\nexact = @(x) sinh(lambda * x) / sinh(lambda) - 1;","key":"Ec4FgyBKKR"},{"type":"output","id":"BDLdyGkeJ-v5lFxKpoz7l","data":[],"key":"RZZBD2ENDd"}],"data":{},"key":"uUxyaTTiAs"},{"type":"paragraph","position":{"start":{"line":369,"column":1},"end":{"line":369,"column":1}},"children":[{"type":"text","value":"The following functions define the ","key":"byZQVED9ee"},{"type":"abbreviation","title":"ordinary differential equation","children":[{"type":"text","value":"ODE","key":"KrdqHoQH8a"}],"key":"yM5W5Y4VTu"},{"type":"text","value":".","key":"fnPRXANsLH"}],"key":"l1RKV5Gm4V"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"p = @(x) zeros(size(x));            \nq = @(x) -lambda^2 * ones(size(x));\nr = @(x) lambda^2 * ones(size(x));","key":"SsbILpFiIX"},{"type":"output","id":"QlB_nDZ9K9TijoOQE_4rk","data":[],"key":"x9fDAQi34m"}],"data":{},"key":"QDn94ozmB6"},{"type":"paragraph","position":{"start":{"line":377,"column":1},"end":{"line":377,"column":1}},"children":[{"type":"text","value":"We compare the computed solution to the exact one for increasing ","position":{"start":{"line":377,"column":1},"end":{"line":377,"column":1}},"key":"MKJwHg3U98"},{"type":"inlineMath","value":"n","position":{"start":{"line":377,"column":1},"end":{"line":377,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"DmZBZEfWtv"},{"type":"text","value":".","position":{"start":{"line":377,"column":1},"end":{"line":377,"column":1}},"key":"es8fAaxcmq"}],"key":"rATEMstIwb"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"p = @(x) zeros(size(x));            \nq = @(x) -lambda^2 * ones(size(x));\nr = @(x) lambda^2 * ones(size(x));\nn = 2 * round(10.^(1:0.25:3)');\nerr = zeros(size(n));\nfor k = 1:length(n)\n    [x, u] = bvplin(p, q, r, 0, 1, -1, 0, n(k));\n    err(k) = norm(exact(x) - u, Inf);\nend\ntable(n, err, variableNames = [\"n\", \"inf-norm error\"])","key":"FRKzgr6wtD"},{"type":"output","id":"3oyV_RlfwDWnVCxZhMD3B","data":[{"output_type":"execute_result","execution_count":31,"metadata":{},"data":{"text/html":{"content":"<html><head><style>.mwBasicVariableOutputWrapper .mwBasicVariableOutputHeader {font-style: italic;}</style></head><body><div class='mwBasicVariableOutputWrapper'><div>ans = <span class='mwBasicVariableOutputHeader'>9x2 table</span></div><table><thead><tr><th>n</th><th>inf-norm error</th></tr></thead><tbody><tr><td>20</td><td>0.0037</td></tr><tr><td>36</td><td>0.0012</td></tr><tr><td>64</td><td>3.7262e-04</td></tr><tr><td>112</td><td>1.2209e-04</td></tr><tr><td>200</td><td>3.8312e-05</td></tr><tr><td>356</td><td>1.2093e-05</td></tr><tr><td>632</td><td>3.8375e-06</td></tr><tr><td>1124</td><td>1.2133e-06</td></tr><tr><td>2000</td><td>3.8321e-07</td></tr></tbody></table></div></body></html>","content_type":"text/html"},"text/plain":{"content":"<html><head><style>.mwBasicVariableOutputWrapper .mwBasicVariableOutputHeader {font-style: italic;}</style></head><body><div class='mwBasicVariableOutputWrapper'><div>ans = <span class='mwBasicVariableOutputHeader'>9x2 table</span></div><table><thead><tr><th>n</th><th>inf-norm error</th></tr></thead><tbody><tr><td>20</td><td>0.0037</td></tr><tr><td>36</td><td>0.0012</td></tr><tr><td>64</td><td>3.7262e-04</td></tr><tr><td>112</td><td>1.2209e-04</td></tr><tr><td>200</td><td>3.8312e-05</td></tr><tr><td>356</td><td>1.2093e-05</td></tr><tr><td>632</td><td>3.8375e-06</td></tr><tr><td>1124</td><td>1.2133e-06</td></tr><tr><td>2000</td><td>3.8321e-07</td></tr></tbody></table></div></body></html>","content_type":"text/plain"}}}],"key":"KZKAubN35c"}],"data":{},"key":"kHkrpBN6i3"},{"type":"paragraph","position":{"start":{"line":392,"column":1},"end":{"line":392,"column":1}},"children":[{"type":"text","value":"Each factor of 10 in ","position":{"start":{"line":392,"column":1},"end":{"line":392,"column":1}},"key":"NdkpmbgNRZ"},{"type":"inlineMath","value":"n","position":{"start":{"line":392,"column":1},"end":{"line":392,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"UgpuAHJ8NZ"},{"type":"text","value":" reduces error by a factor of 100, which is indicative of second-order convergence.","position":{"start":{"line":392,"column":1},"end":{"line":392,"column":1}},"key":"RZN7emiQma"}],"key":"QoWbIauz5T"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf,  loglog(n, err, 'o-')\nhold on, loglog(n, n.^(-2), 'k--')\nxlabel('n'),  ylabel('max error')\ntitle('Convergence for a linear BVP') \nlegend('obs. error', '2nd order')","key":"agMKCwsbId"},{"type":"output","id":"atiZ3WCvmhPidjZo4qjAk","data":[{"output_type":"execute_result","execution_count":32,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"90dcfcad6b6476056539a46b59e447cf","path":"/2025-02-12/build/90dcfcad6b6476056539a46b59e447cf.png"}}}],"key":"asmWkCGJ26"}],"data":{},"key":"faeAmZWa9Z"}],"label":"demo-linear-converge-matlab","identifier":"demo-linear-converge-matlab","html_id":"demo-linear-converge-matlab","key":"z3kET9CZQd"},{"type":"heading","depth":3,"position":{"start":{"line":403,"column":1},"end":{"line":403,"column":1}},"children":[{"type":"text","value":"10.5 ","position":{"start":{"line":403,"column":1},"end":{"line":403,"column":1}},"key":"jabD9IUIKA"},{"type":"link","identifier":"section-bvp-nonlinear","label":"section-bvp-nonlinear","kind":"narrative","position":{"start":{"line":403,"column":6},"end":{"line":403,"column":28}},"url":"/nonlinear","internal":true,"dataUrl":"/nonlinear.json","children":[{"type":"text","value":"Nonlinearity and boundary conditions","key":"gg5nVvbfKr"}],"key":"KrmlJAM7us"}],"identifier":"id-10-5","label":"10.5 ","html_id":"id-10-5","implicit":true,"key":"kAM6fitaSF"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-nonlinear-pendulum","label":"demo-nonlinear-pendulum","kind":"proof:example","position":{"start":{"line":405,"column":1},"end":{"line":405,"column":25}},"children":[{"type":"text","value":"Example ","key":"apwXQrPWEG"},{"type":"text","value":"10.5.2","key":"D0xgp0omVK"}],"template":"Example %s","enumerator":"10.5.2","resolved":true,"html_id":"demo-nonlinear-pendulum","remote":true,"url":"/nonlinear","dataUrl":"/nonlinear.json","key":"a9xz0qWTBW"}],"key":"NTmR3SHNKB"},{"type":"paragraph","position":{"start":{"line":407,"column":1},"end":{"line":407,"column":1}},"children":[{"type":"text","value":"Suppose a damped pendulum satisfies the nonlinear equation ","position":{"start":{"line":407,"column":1},"end":{"line":407,"column":1}},"key":"xN0fs3li7L"},{"type":"inlineMath","value":"\\theta'' + 0.05\\theta'+\\sin \\theta =0","position":{"start":{"line":407,"column":1},"end":{"line":407,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>θ</mi><mrow><mo mathvariant=\"normal\">′</mo><mo mathvariant=\"normal\">′</mo></mrow></msup><mo>+</mo><mn>0.05</mn><msup><mi>θ</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo>+</mo><mi>sin</mi><mo>⁡</mo><mi>θ</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">\\theta&#x27;&#x27; + 0.05\\theta&#x27;+\\sin \\theta =0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8352em;vertical-align:-0.0833em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′′</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8352em;vertical-align:-0.0833em;\"></span><span class=\"mord\">0.05</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mop\">sin</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"YHGcDwHxt8"},{"type":"text","value":". We want to start the pendulum at ","position":{"start":{"line":407,"column":1},"end":{"line":407,"column":1}},"key":"pClGXkMI46"},{"type":"inlineMath","value":"\\theta=2.5","position":{"start":{"line":407,"column":1},"end":{"line":407,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>θ</mi><mo>=</mo><mn>2.5</mn></mrow><annotation encoding=\"application/x-tex\">\\theta=2.5</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2.5</span></span></span></span>","key":"DzcsJubf0T"},{"type":"text","value":" and give it the right initial velocity so that it reaches ","position":{"start":{"line":407,"column":1},"end":{"line":407,"column":1}},"key":"cx4uR0etGn"},{"type":"inlineMath","value":"\\theta=-2","position":{"start":{"line":407,"column":1},"end":{"line":407,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>θ</mi><mo>=</mo><mo>−</mo><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">\\theta=-2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">−</span><span class=\"mord\">2</span></span></span></span>","key":"MYZXUQY8QW"},{"type":"text","value":" at exactly ","position":{"start":{"line":407,"column":1},"end":{"line":407,"column":1}},"key":"YqcqqzvxDn"},{"type":"inlineMath","value":"t=5","position":{"start":{"line":407,"column":1},"end":{"line":407,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi><mo>=</mo><mn>5</mn></mrow><annotation encoding=\"application/x-tex\">t=5</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">5</span></span></span></span>","key":"gl8JbaG5Yp"},{"type":"text","value":". This is a boundary-value problem with Dirichlet conditions ","position":{"start":{"line":407,"column":1},"end":{"line":407,"column":1}},"key":"XCFdbhilIA"},{"type":"inlineMath","value":"\\theta(0)=2.5","position":{"start":{"line":407,"column":1},"end":{"line":407,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>θ</mi><mo stretchy=\"false\">(</mo><mn>0</mn><mo stretchy=\"false\">)</mo><mo>=</mo><mn>2.5</mn></mrow><annotation encoding=\"application/x-tex\">\\theta(0)=2.5</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2.5</span></span></span></span>","key":"Dq2Uv5KmuA"},{"type":"text","value":" and ","position":{"start":{"line":407,"column":1},"end":{"line":407,"column":1}},"key":"wsumTHCdIh"},{"type":"inlineMath","value":"\\theta(5)=-2","position":{"start":{"line":407,"column":1},"end":{"line":407,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>θ</mi><mo stretchy=\"false\">(</mo><mn>5</mn><mo stretchy=\"false\">)</mo><mo>=</mo><mo>−</mo><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">\\theta(5)=-2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"mopen\">(</span><span class=\"mord\">5</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">−</span><span class=\"mord\">2</span></span></span></span>","key":"weRxI2uGA3"},{"type":"text","value":".","position":{"start":{"line":407,"column":1},"end":{"line":407,"column":1}},"key":"wgTzOlvk9U"}],"key":"CPPIgfWFR2"},{"type":"paragraph","position":{"start":{"line":409,"column":1},"end":{"line":409,"column":1}},"children":[{"type":"text","value":"The first step is to define the function ","position":{"start":{"line":409,"column":1},"end":{"line":409,"column":1}},"key":"qnGn7QhYOK"},{"type":"text","value":"ϕ","position":{"start":{"line":409,"column":1},"end":{"line":409,"column":1}},"key":"RNrMRhFbIb"},{"type":"text","value":" that equals ","position":{"start":{"line":409,"column":1},"end":{"line":409,"column":1}},"key":"T4etmsAm9c"},{"type":"inlineMath","value":"\\theta''","position":{"start":{"line":409,"column":1},"end":{"line":409,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>θ</mi><mrow><mo mathvariant=\"normal\">′</mo><mo mathvariant=\"normal\">′</mo></mrow></msup></mrow><annotation encoding=\"application/x-tex\">\\theta&#x27;&#x27;</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′′</span></span></span></span></span></span></span></span></span></span></span></span>","key":"TSUlE5Gh33"},{"type":"text","value":".","position":{"start":{"line":409,"column":1},"end":{"line":409,"column":1}},"key":"JfvgbMS8Rv"}],"key":"FRG1Pvu8Z7"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"phi = @(t,theta,omega) -0.05 * omega - sin(theta);","key":"VkDhi9rPDe"},{"type":"output","id":"ipwkkd8Tv48ZNdHphJ6HN","data":[],"key":"BETpGnakcp"}],"data":{},"key":"ofiRqBrYe6"},{"type":"paragraph","position":{"start":{"line":415,"column":1},"end":{"line":415,"column":1}},"children":[{"type":"text","value":"Next, we define the boundary conditions.","position":{"start":{"line":415,"column":1},"end":{"line":415,"column":1}},"key":"Yq27uI0xuC"}],"key":"eZCZRFC8Aa"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"ga = @(u, du) u - 2.5;\ngb = @(u, du) u + 2;","key":"KJ1MpHCTiT"},{"type":"output","id":"wMvhcYrz72JVQ1U0XLYEh","data":[],"key":"dhOChoYBZN"}],"data":{},"key":"fGTYcrGDiQ"},{"type":"paragraph","position":{"start":{"line":422,"column":1},"end":{"line":422,"column":1}},"children":[{"type":"text","value":"The last ingredient is an initial estimate of the solution. Here we choose ","position":{"start":{"line":422,"column":1},"end":{"line":422,"column":1}},"key":"wN0l6UgCPi"},{"type":"inlineMath","value":"n=100","position":{"start":{"line":422,"column":1},"end":{"line":422,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>=</mo><mn>100</mn></mrow><annotation encoding=\"application/x-tex\">n=100</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">100</span></span></span></span>","key":"R8fO0MlKYi"},{"type":"text","value":" and a linear function between the endpoint values.","position":{"start":{"line":422,"column":1},"end":{"line":422,"column":1}},"key":"bhzHEFr2NK"}],"key":"iEgABqz58n"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"init = linspace(2.5, -2, 101)';","key":"QzK0wAjKum"},{"type":"output","id":"9yClpXKIofx2Hd58Khauc","data":[],"key":"mX6fqsHN6G"}],"data":{},"key":"FHxlHQ8uI0"},{"type":"paragraph","position":{"start":{"line":428,"column":1},"end":{"line":428,"column":1}},"children":[{"type":"text","value":"We find a solution with negative initial slope, i.e., the pendulum is initially pushed back toward equilibrium.","position":{"start":{"line":428,"column":1},"end":{"line":428,"column":1}},"key":"wHxyyq8JUD"}],"key":"l7EvCVXaRv"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[t, theta] = bvp(phi, 0, 5, ga, gb, init);\nclf,  plot(t, theta)\nxlabel('t'),  ylabel('\\theta(t)')\ntitle('Pendulum over [0,5]')","key":"FSgkqKMugM"},{"type":"output","id":"nV8s-K_yIgam737Da4bbZ","data":[{"output_type":"execute_result","execution_count":36,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"79489e202baac8dc70dd4a8961b713d7","path":"/2025-02-12/build/79489e202baac8dc70dd4a8961b713d7.png"}}}],"key":"ZC8IpGpZnY"}],"data":{},"key":"rqCznRHr9K"},{"type":"paragraph","position":{"start":{"line":437,"column":1},"end":{"line":437,"column":1}},"children":[{"type":"text","value":"If we extend the time interval longer for the same boundary values, then the initial slope must adjust.","position":{"start":{"line":437,"column":1},"end":{"line":437,"column":1}},"key":"bIytIopP78"}],"key":"NfzKmAyHhB"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[t, theta] = bvp(phi, 0, 8, ga, gb, init);\nplot(t,theta)\nxlabel('t'),  ylabel('\\theta(t)')\ntitle('Pendulum over [0,8]')","key":"Q7iL5yke2S"},{"type":"output","id":"ko9FNlk9FduJzQ0TVAkuH","data":[{"output_type":"execute_result","execution_count":37,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"3a50d8ea64445c8218d13b8d0efc0d83","path":"/2025-02-12/build/3a50d8ea64445c8218d13b8d0efc0d83.png"}}}],"key":"s1wrGDqN2f"}],"data":{},"key":"KhdchB6u8t"},{"type":"paragraph","position":{"start":{"line":446,"column":1},"end":{"line":446,"column":1}},"children":[{"type":"text","value":"This time, the pendulum is initially pushed toward the unstable equilibrium in the upright vertical position before gravity pulls it back down.","position":{"start":{"line":446,"column":1},"end":{"line":446,"column":1}},"key":"WG23sKNNkz"}],"key":"mR2JYFPs1U"}],"label":"demo-nonlinear-pendulum-matlab","identifier":"demo-nonlinear-pendulum-matlab","html_id":"demo-nonlinear-pendulum-matlab","key":"ckLNDjzKgd"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-nonlinear-mems","label":"demo-nonlinear-mems","kind":"proof:example","position":{"start":{"line":450,"column":1},"end":{"line":450,"column":21}},"children":[{"type":"text","value":"Example ","key":"UTD9oUu6TH"},{"type":"text","value":"10.5.3","key":"qZLs1oC4kg"}],"template":"Example %s","enumerator":"10.5.3","resolved":true,"html_id":"demo-nonlinear-mems","remote":true,"url":"/nonlinear","dataUrl":"/nonlinear.json","key":"vye46ed2qs"}],"key":"BfpMh4g3B1"},{"type":"paragraph","position":{"start":{"line":453,"column":1},"end":{"line":453,"column":1}},"children":[{"type":"text","value":"Here is the problem definition. We use a truncated domain to avoid division by zero at ","position":{"start":{"line":453,"column":1},"end":{"line":453,"column":1}},"key":"nyG48gp59h"},{"type":"inlineMath","value":"r=0","position":{"start":{"line":453,"column":1},"end":{"line":453,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>r</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">r=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"jNBhUSKFsP"},{"type":"text","value":".","position":{"start":{"line":453,"column":1},"end":{"line":453,"column":1}},"key":"UwQGfdCKeq"}],"key":"aKiINMouRA"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"lambda = 0.5;\nphi = @(r,w,dwdr) lambda./w.^2 - dwdr./r;\nga = @(w, dw) dw;\ngb = @(w, dw) w - 1;\na = eps;  b = 1;","key":"hgHAuHvgGT"},{"type":"output","id":"sfIoBWRFEHCr3Bv2IRJYC","data":[],"key":"gCxdCldBHG"}],"data":{},"key":"tbsygjdxiA"},{"type":"paragraph","position":{"start":{"line":463,"column":1},"end":{"line":463,"column":1}},"children":[{"type":"text","value":"First we try a constant function as the initialization.","position":{"start":{"line":463,"column":1},"end":{"line":463,"column":1}},"key":"uEFMQ3nYsw"}],"key":"MrAbBD8PAz"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"init = ones(301, 1);\n[r, w1] = bvp(phi, a, b, ga, gb, init);\n\nclf,  plot(r, w1)\nxlabel('r'),  ylabel('w(r)')\ntitle('Solution of the MEMS BVP')","key":"n9AKehw2Ps"},{"type":"output","id":"WOHhYL5HlvXESU0VUOi1X","data":[{"output_type":"execute_result","execution_count":39,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"507df464fdb2f26c171359d1248092b0","path":"/2025-02-12/build/507df464fdb2f26c171359d1248092b0.png"}}}],"key":"xwj5TYz65T"}],"data":{},"key":"HMtU5kEAYa"},{"type":"paragraph","position":{"start":{"line":474,"column":1},"end":{"line":474,"column":1}},"children":[{"type":"text","value":"It’s not necessary that the initialization satisfy the boundary conditions. In fact, by choosing a different constant function as the initial guess, we arrive at another valid solution.","position":{"start":{"line":474,"column":1},"end":{"line":474,"column":1}},"key":"c5MtxA17BD"}],"key":"owSIM3Uanr"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"init = 0.5 * ones(301, 1);\n[r, w2] = bvp(phi, a, b, ga, gb, init);\nhold on,  plot(r, w2)\ntitle(\"Two solutions of the MEMS BVP\")","key":"C45PiihbiI"},{"type":"output","id":"Ydg1QfU7Yq5yDLcQXoOta","data":[{"output_type":"execute_result","execution_count":40,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"d32595e3f4ea76977688dd2717153a93","path":"/2025-02-12/build/d32595e3f4ea76977688dd2717153a93.png"}}}],"key":"ZaWCIRQZkX"}],"data":{},"key":"yWu48W5OTu"}],"label":"demo-nonlinear-mems-matlab","identifier":"demo-nonlinear-mems-matlab","html_id":"demo-nonlinear-mems-matlab","key":"fdKaLYV93a"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-nonlinear-allencahn","label":"demo-nonlinear-allencahn","kind":"proof:example","position":{"start":{"line":485,"column":1},"end":{"line":485,"column":26}},"children":[{"type":"text","value":"Example ","key":"AawXBeQinD"},{"type":"text","value":"10.5.4","key":"kq6RVFYJSf"}],"template":"Example %s","enumerator":"10.5.4","resolved":true,"html_id":"demo-nonlinear-allencahn","remote":true,"url":"/nonlinear","dataUrl":"/nonlinear.json","key":"bSWsMuV6dJ"}],"key":"Qo6qWOMYRW"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"epsilon = 0.05;\nphi = @(x, u, du_dx) (u.^3 - u) / epsilon;\nga = @(u, du) du;\ngb = @(u, du) u - 1;","key":"moh9IWtWmI"},{"type":"output","id":"9nDhYrAMCuHM69tZNLyuT","data":[],"key":"ovv6sUgFf3"}],"data":{},"key":"TWxuytkfXs"},{"type":"paragraph","position":{"start":{"line":495,"column":1},"end":{"line":495,"column":1}},"children":[{"type":"text","value":"Finding a solution is easy at larger values of ","position":{"start":{"line":495,"column":1},"end":{"line":495,"column":1}},"key":"mj0eVVrLPz"},{"type":"text","value":"ε","position":{"start":{"line":495,"column":1},"end":{"line":495,"column":1}},"key":"RA3PbjSIhI"},{"type":"text","value":".","position":{"start":{"line":495,"column":1},"end":{"line":495,"column":1}},"key":"b6ZIi5lwB7"}],"key":"b6iVuu1Voe"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"init = linspace(-1, 1, 141)';\n[x, u1] = bvp(phi, 0, 1, ga, gb, init);\nclf,  plot(x, u1, displayname=\"\\epsilon = 0.05\")\nxlabel('x'),  ylabel('u(x)')\ntitle('Allen-Cahn solution') \nlegend(location=\"northwest\")","key":"gCdAJghciD"},{"type":"output","id":"SWofafCl3WPOuKNneoTXd","data":[{"output_type":"execute_result","execution_count":42,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"23d2009b0c60473d4396c951613f9e86","path":"/2025-02-12/build/23d2009b0c60473d4396c951613f9e86.png"}}}],"key":"Tw9oaXvnyW"}],"data":{},"key":"XXKISIYV3V"},{"type":"paragraph","position":{"start":{"line":506,"column":1},"end":{"line":506,"column":1}},"children":[{"type":"text","value":"However, finding a good initialization is not trivial for smaller values of ","position":{"start":{"line":506,"column":1},"end":{"line":506,"column":1}},"key":"ovWEdsSzdR"},{"type":"text","value":"ε","position":{"start":{"line":506,"column":1},"end":{"line":506,"column":1}},"key":"ZxFxhqEQRD"},{"type":"text","value":". Note below that the iteration stops without converging to a solution.","position":{"start":{"line":506,"column":1},"end":{"line":506,"column":1}},"key":"byFxfVLhRc"}],"key":"K0ZZiQ4QRZ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"epsilon = 0.002;\nphi = @(x, u, du_dx) (u.^3 - u) / epsilon;\n[x, z] = bvp(phi, 0, 1, ga, gb, init);","key":"Y4jyZjhS3m"},{"type":"output","id":"2L_dI_ZNfDg_6b3AohlHU","data":[],"key":"d4Ic1z1uFH"}],"data":{},"key":"cYzRJuVFro"},{"type":"paragraph","position":{"start":{"line":514,"column":1},"end":{"line":514,"column":1}},"children":[{"type":"text","value":"The iteration succeeds if we use the first solution instead as the initialization here.","position":{"start":{"line":514,"column":1},"end":{"line":514,"column":1}},"key":"noeCqamVTG"}],"key":"Fu52ALH6Jc"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[x, u2] = bvp(phi, 0, 1, ga, gb, u1);\nhold on,  plot(x, u2, displayname=\"\\epsilon = 0.002\")","key":"GmBQDzIg0F"},{"type":"output","id":"Gjl97ti9Gi5y-cAVeypLV","data":[{"output_type":"execute_result","execution_count":44,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"a0ed995c42faf8740e759051c7ae0a30","path":"/2025-02-12/build/a0ed995c42faf8740e759051c7ae0a30.png"}}}],"key":"GiOqItqEX5"}],"data":{},"key":"sfSxPCaVbY"},{"type":"paragraph","position":{"start":{"line":521,"column":1},"end":{"line":521,"column":1}},"children":[{"type":"text","value":"In this case we can continue further.","position":{"start":{"line":521,"column":1},"end":{"line":521,"column":1}},"key":"H9aloHi7E2"}],"key":"JVww8V6gAU"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"epsilon = 0.0005;\nphi = @(x, u, du_dx) (u.^3 - u) / epsilon;\n[x, u3] = bvp(phi, 0, 1, ga, gb, u2);\nplot(x, u3, displayname=\"\\epsilon = 0.0005\")","key":"zxqP4UGTTT"},{"type":"output","id":"LCs7OhdwtcmoNHPrMFsOl","data":[{"output_type":"execute_result","execution_count":45,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"4a96e7fa2ac699f2f0bc669f63594993","path":"/2025-02-12/build/4a96e7fa2ac699f2f0bc669f63594993.png"}}}],"key":"rkBSPfDZJ1"}],"data":{},"key":"n8d9lEsyGC"}],"label":"demo-nonlinear-allencahn-matlab","identifier":"demo-nonlinear-allencahn-matlab","html_id":"demo-nonlinear-allencahn-matlab","key":"ZRDZHUKqxo"},{"type":"heading","depth":3,"position":{"start":{"line":532,"column":1},"end":{"line":532,"column":1}},"children":[{"type":"text","value":"10.6 ","position":{"start":{"line":532,"column":1},"end":{"line":532,"column":1}},"key":"LgoW2DZFyq"},{"type":"link","identifier":"section-bvp-galerkin","label":"section-bvp-galerkin","kind":"narrative","position":{"start":{"line":532,"column":6},"end":{"line":532,"column":27}},"url":"/galerkin","internal":true,"dataUrl":"/galerkin.json","children":[{"type":"text","value":"The Galerkin method","key":"TaeO2hrWtK"}],"key":"DCGoCQCscW"}],"identifier":"id-10-6","label":"10.6 ","html_id":"id-10-6","implicit":true,"key":"vboFuFnC9C"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-galerkin-fem","label":"demo-galerkin-fem","kind":"proof:example","position":{"start":{"line":534,"column":1},"end":{"line":534,"column":19}},"children":[{"type":"text","value":"Example ","key":"bZYZDTzosg"},{"type":"text","value":"10.6.2","key":"N9EJEMcr36"}],"template":"Example %s","enumerator":"10.6.2","resolved":true,"html_id":"demo-galerkin-fem","remote":true,"url":"/galerkin","dataUrl":"/galerkin.json","key":"TVoQofFcFN"}],"key":"n0EL9msELj"},{"type":"paragraph","position":{"start":{"line":537,"column":1},"end":{"line":537,"column":1}},"children":[{"type":"text","value":"Here are the coefficient function definitions. Even though ","position":{"start":{"line":537,"column":1},"end":{"line":537,"column":1}},"key":"DHlWyYdSia"},{"type":"inlineMath","value":"s","position":{"start":{"line":537,"column":1},"end":{"line":537,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>s</mi></mrow><annotation encoding=\"application/x-tex\">s</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">s</span></span></span></span>","key":"zupgG3QQKa"},{"type":"text","value":" is a constant, it has to be defined as a function for ","position":{"start":{"line":537,"column":1},"end":{"line":537,"column":1}},"key":"ExFUkBptU5"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-fem","label":"function-fem","children":[{"type":"text","value":"Function ","key":"oVV5W6l4rw"},{"type":"text","value":"10.6.1","key":"sbYO9BEAG4"}],"template":"Algorithm %s","enumerator":"10.6.1","resolved":true,"html_id":"function-fem","remote":true,"url":"/galerkin","dataUrl":"/galerkin.json","key":"gSrJHeMLBS"},{"type":"text","value":" to use it.","position":{"start":{"line":537,"column":1},"end":{"line":537,"column":1}},"key":"sLGS09jrBc"}],"key":"NdjFCaiqkc"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"c = @(x) x.^2;\nq = @(x) 4 * ones(size(x));\nf = @(x) sin(pi * x);","key":"RWDOjJOr48"},{"type":"output","id":"3iWpOZhOdbVKfVJ4qREal","data":[],"key":"woljFiYjim"}],"data":{},"key":"oCrPzeEkDc"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[x,u] = fem(c, q, f, 0, 1, 50);\nclf,  plot(x, u)\nxlabel('x'),  ylabel('u')\ntitle('Solution by finite elements')","key":"aiegbaxa3I"},{"type":"output","id":"x9zD7oLU2oW0fOT5ggcTd","data":[{"output_type":"execute_result","execution_count":47,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"6c7e03d71fe61c4b9a907553d1cd7f7e","path":"/2025-02-12/build/6c7e03d71fe61c4b9a907553d1cd7f7e.png"}}}],"key":"D9wV6EAUta"}],"data":{},"key":"kCR76Uw3ie"}],"label":"demo-galerkin-fem-matlab","identifier":"demo-galerkin-fem-matlab","html_id":"demo-galerkin-fem-matlab","key":"Wq4Rbczz2k"}],"key":"Bz1Vz9CSDR"}],"key":"yK1vZ3SSdN"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Chapter 9","url":"/chapter9-1","group":"MATLAB codes"},"next":{"title":"Chapter 11","url":"/chapter11-1","group":"MATLAB codes"}}},"domain":"http://localhost:3000"}