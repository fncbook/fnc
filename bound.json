{"kind":"Notebook","sha256":"98a1e1aaf8973e1fc6dbc21449163ccd4233e35f5889e6cff0ec38320b788679","slug":"bound","location":"/chapter2/section8/julia/bound.ipynb","dependencies":[],"frontmatter":{"numbering":{"heading_1":{"enabled":false},"heading_2":{"enabled":false},"heading_3":{"enabled":false},"heading_4":{"enabled":false},"heading_5":{"enabled":false},"heading_6":{"enabled":false}},"kernelspec":{"name":"julia-1.11","display_name":"Julia 1","language":"julia"},"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"exports":[{"format":"ipynb","filename":"bound.ipynb","url":"/fnc/build/bound-0912bf0af85c4a8f9f66d2a173513f93.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-05T09:35:33.980000Z","iopub.status.busy":"2025-01-05T09:35:33.687000Z","iopub.status.idle":"2025-01-05T09:35:40.594000Z","shell.execute_reply":"2025-01-05T09:35:40.541000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"include(\"../../../julia/FNC_init.jl\")","key":"dQhT0BbWHL"},{"type":"output","id":"DSOkV0xolD-JZb-qi5FEc","data":[{"name":"stderr","output_type":"stream","text":"\u001b[32m\u001b[1m  Activating\u001b[22m\u001b[39m "},{"name":"stderr","output_type":"stream","text":"project at `~/Documents/GitHub/fnc`\n"}],"key":"fUHAB7PAq9"}],"key":"eAMX0TDZt2"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"RxV7VbFkNi"},{"type":"text","value":"2.8.1","key":"Ur88GWQ0UR"}],"key":"MWv4TCwXd2"}],"identifier":"demo-condition-bound","label":"demo-condition-bound","kind":"proof:example","template":"Example %s","enumerator":"2.8.1","resolved":true,"html_id":"demo-condition-bound","remote":true,"url":"/condition-number","dataUrl":"/condition-number.json","key":"siKMc9DrLt"}],"key":"LSFoJgmLWo"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Julia has a function ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"QSk9qDBItu"},{"type":"inlineCode","value":"cond","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"sJewvuCINh"},{"type":"text","value":" to compute matrix condition numbers. By default, the 2-norm is used. As an example, the family of ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"TJkvnZ4o1L"},{"type":"emphasis","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Hilbert matrices","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"HadSqdivlC"}],"key":"ze23LSKM2q"},{"type":"text","value":" is famously badly conditioned. Here is the ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"gQiuSdLK9d"},{"type":"inlineMath","value":"6\\times 6","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>6</mn><mo>×</mo><mn>6</mn></mrow><annotation encoding=\"application/x-tex\">6\\times 6</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">6</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">6</span></span></span></span>","key":"alr0hXabaa"},{"type":"text","value":"  case.","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"hkvFgNgmgw"}],"indexEntries":[{"entry":"Julia","subEntry":{"value":"cond","kind":"entry"},"emphasis":true}],"label":"index-gyFbGe0YKT","identifier":"index-gyfbge0ykt","html_id":"index-gyfbge0ykt","key":"hDoHFl16NF"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"j5LrkFviAb"}],"key":"WyJwEAjXjG"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Type ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"riUpJAXGu4"},{"type":"inlineCode","value":"\\kappa","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"YgNW5S7xGN"},{"type":"text","value":" followed by ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"sbJNMgrGce"},{"type":"keyboard","children":[{"type":"text","value":"Tab","key":"x4mkYFgpWX"}],"key":"RoEHIRwXaC"},{"type":"text","value":" to get the Greek letter ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"s7TZoZuOau"},{"type":"text","value":"κ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"kNs3y49VwF"},{"type":"text","value":".","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"UWhKVQ9G3p"}],"key":"OcmCfZqt2C"}],"class":"dropdown","key":"z3ix6D3rh1"}],"key":"x6IDMS75vz"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-05T09:35:40.734000Z","iopub.status.busy":"2025-01-05T09:35:40.595000Z","iopub.status.idle":"2025-01-05T09:35:41.022000Z","shell.execute_reply":"2025-01-05T09:35:41.022000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"A = [ 1 / (i + j) for i in 1:6, j in 1:6 ]\nκ = cond(A)","key":"gAP7cC4kQo"},{"type":"output","id":"JJZI3L7O3J3hSnGvslyXu","data":[{"output_type":"execute_result","execution_count":2,"metadata":{},"data":{"text/plain":{"content":"5.109816297946132e7","content_type":"text/plain"}}}],"key":"nRYwnnVigX"}],"key":"pQpP6iy3FN"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Because ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"IDILksUqWq"},{"type":"inlineMath","value":"\\kappa\\approx 10^8","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>κ</mi><mo>≈</mo><mn>1</mn><msup><mn>0</mn><mn>8</mn></msup></mrow><annotation encoding=\"application/x-tex\">\\kappa\\approx 10^8</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4831em;\"></span><span class=\"mord mathnormal\">κ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">8</span></span></span></span></span></span></span></span></span></span></span>","key":"v4lRFpJSJq"},{"type":"text","value":", it’s possible to lose nearly 8 digits of accuracy in the process of passing from ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JO87ATjBeC"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"UWZ4P952kQ"},{"type":"text","value":" and ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Xf0Vs3XYZh"},{"type":"inlineMath","value":"\\mathbf{b}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"V6z6bVAyM2"},{"type":"text","value":" to ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ls2lQOHf0U"},{"type":"inlineMath","value":"\\mathbf{x}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">x</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{x}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4444em;\"></span><span class=\"mord mathbf\">x</span></span></span></span>","key":"IPd8xmq4rk"},{"type":"text","value":". That fact is independent of the algorithm; it’s inevitable once the data are expressed in finite precision.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WB6QUGVEGO"}],"key":"QXkd2YF3zb"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Let’s engineer a linear system problem to observe the effect of a perturbation. We will make sure we know the exact answer.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"DxqTeLtn2I"}],"key":"C2wKKz86Xo"}],"key":"K0TRWZKTrN"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-05T09:35:41.024000Z","iopub.status.busy":"2025-01-05T09:35:41.024000Z","iopub.status.idle":"2025-01-05T09:35:42.099000Z","shell.execute_reply":"2025-01-05T09:35:42.099000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"x = 1:6\nb = A * x","key":"tvyWuQYC7Y"},{"type":"output","id":"r17oWzatP_lvkdE1bd13d","data":[{"output_type":"execute_result","execution_count":3,"metadata":{},"data":{"text/plain":{"content":"6-element Vector{Float64}:\n 4.407142857142857\n 3.564285714285714\n 3.013095238095238\n 2.6174603174603175\n 2.317279942279942\n 2.0807359307359308","content_type":"text/plain"}}}],"key":"eFI8nFVbHi"}],"key":"RbGDXKS9WG"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now we perturb the system matrix and vector randomly by ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jNNSxU5TAC"},{"type":"span","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"10","key":"IH5ma4mNTN"},{"type":"superscript","children":[{"type":"text","value":"-10","key":"MndPXOJffb"}],"key":"JNlZFEFfHE"}],"key":"bDxtEMUzdk"},{"type":"text","value":" in norm.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"gh8xCdAFvf"}],"key":"l9Ph2JlTkZ"}],"key":"tdDgEIHXIs"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-05T09:35:42.101000Z","iopub.status.busy":"2025-01-05T09:35:42.101000Z","iopub.status.idle":"2025-01-05T09:35:42.171000Z","shell.execute_reply":"2025-01-05T09:35:42.171000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"# type \\Delta then Tab to get Δ\nΔA = randn(size(A));  ΔA = 1e-10 * (ΔA / opnorm(ΔA));\nΔb = randn(size(b));  Δb = 1e-10 * normalize(Δb);","key":"Phe34OeTaV"},{"type":"output","id":"Wnz6c6WydfI0DOqmy6ToR","data":[],"key":"vILlQQ9UeC"}],"key":"XJTonQ7mWL"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We solve the perturbed problem using pivoted LU and see how the solution was changed.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bWgXyqIqEP"}],"key":"v97dnmlvnp"}],"key":"AvTeFMbw9Y"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-05T09:35:42.173000Z","iopub.status.busy":"2025-01-05T09:35:42.173000Z","iopub.status.idle":"2025-01-05T09:35:42.208000Z","shell.execute_reply":"2025-01-05T09:35:42.208000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"new_x = ((A + ΔA) \\ (b + Δb))\nΔx = new_x - x","key":"bLQlHqfaip"},{"type":"output","id":"lOr8CSkciPKM-PJJ0_Cif","data":[{"output_type":"execute_result","execution_count":5,"metadata":{},"data":{"text/plain":{"content":"6-element Vector{Float64}:\n  1.4593600563550524e-6\n -1.3922145710276723e-5\n  3.423236338306879e-5\n -1.4172928783029448e-5\n -3.212900976823363e-5\n  2.4795896792717542e-5","content_type":"text/plain"}}}],"key":"p6R2a9e6C6"}],"key":"m4gKCtsfA9"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Here is the relative error in the solution.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"x3IFUdidtL"}],"key":"dP3vDnDIuK"}],"key":"OZUtUoqbvz"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-05T09:35:42.210000Z","iopub.status.busy":"2025-01-05T09:35:42.210000Z","iopub.status.idle":"2025-01-05T09:35:42.825000Z","shell.execute_reply":"2025-01-05T09:35:42.824000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"@show relative_error = norm(Δx) / norm(x);","key":"RzjkRAMzA5"},{"type":"output","id":"ji1A3dLx8RgYFww0QUVuM","data":[{"name":"stdout","output_type":"stream","text":"relative_error = norm(Δx) / norm(x) = 5.944609020012348e-6"},{"name":"stdout","output_type":"stream","text":"\n"}],"key":"DlFlfGD304"}],"key":"kSD2KxT9s6"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"And here are upper bounds predicted using the condition number of the original matrix.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zmlp37IwbC"}],"key":"aTryhoqZXY"}],"key":"wbQSDPmyoR"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-05T09:35:42.826000Z","iopub.status.busy":"2025-01-05T09:35:42.826000Z","iopub.status.idle":"2025-01-05T09:35:42.832000Z","shell.execute_reply":"2025-01-05T09:35:42.832000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"println(\"Upper bound due to b: $(κ * norm(Δb) / norm(b))\")\nprintln(\"Upper bound due to A: $(κ * opnorm(ΔA) / opnorm(A))\")","key":"lFTIdGvy4F"},{"type":"output","id":"4ZPT4uw9NCVGDWpxEh9Am","data":[{"name":"stdout","output_type":"stream","text":"Upper bound due to b: 0.000672366771437133\nUpper bound due to A: 0.004566989873939065\n"}],"key":"XnwzANNuEQ"}],"key":"kt8qLMOfyw"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Even if we didn’t make any manual perturbations to the data, machine roundoff does so at the relative level of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"V8L7JcR4X6"},{"type":"inlineMath","value":"\\macheps","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>ϵ</mi><mtext>mach</mtext></msub></mrow><annotation encoding=\"application/x-tex\">\\macheps</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">ϵ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">mach</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"lzyJLpRBgO"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"koCggViP1A"}],"key":"QLVvvrZVB8"}],"key":"OCuyFIBQNj"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-05T09:35:42.833000Z","iopub.status.busy":"2025-01-05T09:35:42.833000Z","iopub.status.idle":"2025-01-05T09:35:42.835000Z","shell.execute_reply":"2025-01-05T09:35:42.835000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"Δx = A\\b - x\n@show relative_error = norm(Δx) / norm(x);\n@show rounding_bound = κ * eps();","key":"xqNh8DVtPj"},{"type":"output","id":"0MxqFBqKaPq4szUCbwGH1","data":[{"name":"stdout","output_type":"stream","text":"relative_error = norm(Δx) / norm(x) = 7.822650774976615e-10\nrounding_bound = κ * eps() = 1.134607141116935e-8\n"}],"key":"JjERVeCfkX"}],"key":"ORrZ53srgr"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Larger Hilbert matrices are even more poorly conditioned:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"A1rgkTly5R"}],"key":"isaKeIjK27"}],"key":"U8weyfGPvk"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-05T09:35:42.836000Z","iopub.status.busy":"2025-01-05T09:35:42.836000Z","iopub.status.idle":"2025-01-05T09:35:42.853000Z","shell.execute_reply":"2025-01-05T09:35:42.853000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"A = [ 1 / (i + j) for i=1:14, j=1:14 ];\nκ = cond(A)","key":"CQSWepTIoa"},{"type":"output","id":"cJADr-XCY-8FjJMttQSyq","data":[{"output_type":"execute_result","execution_count":9,"metadata":{},"data":{"text/plain":{"content":"5.802584125151949e17","content_type":"text/plain"}}}],"key":"OUR6KYP5DZ"}],"key":"BNd5XdIcyh"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Note that ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"QSXq7dsKQF"},{"type":"text","value":"κ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Pt7RP14ez4"},{"type":"text","value":" exceeds ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mnMNOmxNE0"},{"type":"inlineMath","value":"1/\\macheps","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mi mathvariant=\"normal\">/</mi><msub><mi>ϵ</mi><mtext>mach</mtext></msub></mrow><annotation encoding=\"application/x-tex\">1/\\macheps</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1/</span><span class=\"mord\"><span class=\"mord mathnormal\">ϵ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">mach</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"QRX1GOebEp"},{"type":"text","value":". In principle we therefore may end up with an answer that has relative error greater than 100%.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"J92RgaTDVe"}],"key":"yz8CfA3hoA"}],"key":"EOj6LFmgvM"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-05T09:35:42.855000Z","iopub.status.busy":"2025-01-05T09:35:42.855000Z","iopub.status.idle":"2025-01-05T09:35:42.855000Z","shell.execute_reply":"2025-01-05T09:35:42.855000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"rounding_bound = κ*eps()","key":"lbFUwlrsTb"},{"type":"output","id":"xC6IPaNNQRrNthz6kSLkF","data":[{"output_type":"execute_result","execution_count":10,"metadata":{},"data":{"text/plain":{"content":"128.8432499613623","content_type":"text/plain"}}}],"key":"A3F726w9Yo"}],"key":"vy9W2uXyQH"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Let’s put that prediction to the test.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Z6tANiXNeg"}],"key":"w2lGyVd3aw"}],"key":"hm741PnYlb"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-05T09:35:42.857000Z","iopub.status.busy":"2025-01-05T09:35:42.857000Z","iopub.status.idle":"2025-01-05T09:35:42.858000Z","shell.execute_reply":"2025-01-05T09:35:42.858000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"x = 1:14\nb = A * x  \nΔx = A\\b - x\n@show relative_error = norm(Δx) / norm(x);","key":"TMMI8ZX4EU"},{"type":"output","id":"jgRFqrZy3rhgP6yQT6TGp","data":[{"name":"stdout","output_type":"stream","text":"relative_error = norm(Δx) / norm(x) = 4.469466154206132\n"}],"key":"qu6plRImxO"}],"key":"oyXSIFz9Zg"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"As anticipated, the solution has zero accurate digits in the 2-norm.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Dqqhe6t0L5"}],"key":"nAdo5EuXVZ"}],"key":"gel6gCNPNw"}],"key":"bkY3vck7OQ"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Matrix","url":"/matrix","group":"Chapter 2"},"next":{"title":"Banded","url":"/banded","group":"Chapter 2"}}},"domain":"http://localhost:3000"}