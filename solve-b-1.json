{"kind":"Notebook","sha256":"c8127dff240130c2cbfb48cc5ba4d96e1db4190ad44f2e129d0ed5c93d2af6c7","slug":"solve-b-1","location":"/chapter12/section1/python/solve-b.ipynb","dependencies":[],"frontmatter":{"numbering":{"heading_1":{"enabled":false},"heading_2":{"enabled":false},"heading_3":{"enabled":false},"heading_4":{"enabled":false},"heading_5":{"enabled":false},"heading_6":{"enabled":false}},"kernelspec":{"name":"python3","display_name":"Python 3","language":"python"},"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"exports":[{"format":"ipynb","filename":"solve-b.ipynb","url":"/build/solve-b-5f46d4a420ddd0d196ff833ab86b3bc8.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-09T21:29:02.589994Z","iopub.status.busy":"2025-01-09T21:29:02.589905Z","iopub.status.idle":"2025-01-09T21:29:02.931504Z","shell.execute_reply":"2025-01-09T21:29:02.931172Z"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"exec(open(\"../../../python/FNC_init.py\").read())","visibility":"show","key":"iT039rimhi"},{"type":"output","id":"Ce358dp8rm1kYCBEPXz8T","data":[],"visibility":"show","key":"Z1wIZGHKRK"}],"visibility":"remove","key":"HjtMe00cSY"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now we use an initial condition with a larger bump. Note that the scale on the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Y71718WWU9"},{"type":"inlineMath","value":"y","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>","key":"MIQ8hAfwez"},{"type":"text","value":"-axis is much different for this solution.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bxugN4zWcg"}],"key":"GqtSnR9JGm"}],"key":"VufCoTA0VY"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-09T21:29:02.933127Z","iopub.status.busy":"2025-01-09T21:29:02.932997Z","iopub.status.idle":"2025-01-09T21:29:02.938099Z","shell.execute_reply":"2025-01-09T21:29:02.937844Z"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"from scipy.integrate import solve_ivp\nrho_c, rho_m, q_m, ep = (1080, 380, 10000, 0.02)\nQ0prime = (\n    lambda rho: q_m * 4 * rho_c**2 * (rho_c - rho_m) * rho_m * (rho_m - rho)\n    / (rho * (rho_c - 2 * rho_m) + rho_c * rho_m) ** 3\n)\nx, Dx, Dxx = FNC.diffper(800, [0, 4])\node = lambda t, rho: -Q0prime(rho) * (Dx @ rho) + ep * (Dxx @ rho)","visibility":"show","key":"Yz0oLLQ66F"},{"type":"output","id":"Id0jb3_isR07QRqfeLX9a","data":[],"visibility":"show","key":"YUKPAdBGh2"}],"visibility":"remove","key":"fccGwK125t"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-09T21:29:02.939402Z","iopub.status.busy":"2025-01-09T21:29:02.939312Z","iopub.status.idle":"2025-01-09T21:29:09.166930Z","shell.execute_reply":"2025-01-09T21:29:09.166512Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"rho_init = 400 + 80 * exp(-16 * (x - 3) ** 2)\nsol = solve_ivp(ode, [0, 0.5], rho_init, method=\"Radau\", dense_output=True)","key":"oO5G5GpWG9"},{"type":"output","id":"mndleslITcFNVMkj4vQN6","data":[],"key":"yYRlmoTI0S"}],"key":"EwcxYe3UVt"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-09T21:29:09.168515Z","iopub.status.busy":"2025-01-09T21:29:09.168396Z","iopub.status.idle":"2025-01-09T21:29:09.361900Z","shell.execute_reply":"2025-01-09T21:29:09.361641Z"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"for t in linspace(0, 0.5, 6):\n    plot(x, sol.sol(t), label=f\"t = {t:.1f}\")\nxlabel(\"$x$\"),  ylabel(\"car density\")\nlegend(),  title(\"Traffic jam\");","visibility":"hide","key":"UunlSbpA5c"},{"type":"output","id":"4FI6L6FuFvELL1EXsgMMJ","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"2f68ad8a46233750fdb440fd5cbdc67f","path":"/build/2f68ad8a46233750fdb440fd5cbdc67f.png"},"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"}}}],"visibility":"show","key":"fRyd1jJQh0"}],"visibility":"show","key":"oZ37vKcggf"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-09T21:29:09.366684Z","iopub.status.busy":"2025-01-09T21:29:09.366548Z","iopub.status.idle":"2025-01-09T21:29:11.656991Z","shell.execute_reply":"2025-01-09T21:29:11.656577Z"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"from matplotlib.animation import FuncAnimation\nfig, ax = subplots()\ncurve = ax.plot(x, rho_init)[0]\ntime_text = ax.text(0.05, 0.9, '', transform=ax.transAxes)\nax.set_xlabel(\"$x$\")\nax.set_ylabel(\"density\")\nax.set_ylim(400, 480)\nax.set_title(\"Traffic jam\")\ndef snapshot(t):\n    curve.set_ydata(sol.sol(t))\n    time_text.set_text(f\"t = {t:.2f}\")\n\nanim = FuncAnimation(fig, snapshot, frames=linspace(0, 0.5, 101))\nanim.save(\"traffic-jam.mp4\", fps=30)\nclose()","visibility":"hide","key":"zxTJAAfOaQ"},{"type":"output","id":"Y5I2OnvqV19_wP5cMEtW8","data":[],"visibility":"show","key":"h6RsOaRiPJ"}],"visibility":"show","key":"snPNq0el21"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"In this case the density bump travels backward along the road. It also steepens on the side facing the incoming traffic and decreases much more slowly on the other side. A motorist would experience this as an abrupt increase in density, followed by a much more gradual decrease in density and resulting gradual increase in speed. (You also see some transient, high-frequency oscillations. These are caused by instabilities, as we discuss in simpler situations later in this chapter.)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"t9hbJ0TZyL"}],"key":"IpFHDdiLv3"}],"key":"PG9x6xcPhy"}],"key":"XSzud9gkDH"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Solve A","url":"/solve-a-1","group":"Chapter 12"},"next":{"title":"Cfl","url":"/cfl-2","group":"Chapter 12"}}},"domain":"http://localhost:3000"}