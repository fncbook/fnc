{"kind":"Notebook","sha256":"f7f45be9a8c96d635b7ea2e128e275e196939d261e3fb5583d50beed42e41308","slug":"chapter2-2","location":"/python/chapter2.md","dependencies":[],"frontmatter":{"title":"Chapter 2","numbering":{"heading_1":{"enabled":false},"heading_2":{"enabled":false},"heading_3":{"enabled":false},"heading_4":{"enabled":false},"heading_5":{"enabled":false},"heading_6":{"enabled":false}},"kernelspec":{"name":"python3","display_name":"Python 3","language":"python"},"content_includes_title":false,"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"LU":"lower triangular times upper triangular","QR":"orthogonal times upper triangular"},"exports":[{"format":"md","filename":"chapter2.md","url":"/fnc/build/chapter2-fe53dddc81c2768e9eef37a665131147.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"Functions","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"V9v90J790D"}],"identifier":"functions","label":"Functions","html_id":"functions","implicit":true,"key":"EjapMW0Xsl"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Forward substitution","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"KEuOo5oTpa"}],"key":"XCr5SiNXx3"},{"type":"include","file":"../python/pkg/FNC/FNC02.py","literal":true,"filter":{"lines":[[3,15]]},"children":[{"type":"code","value":"def forwardsub(L,b):\n    \"\"\"\n     forwardsub(L,b)\n\n    Solve the lower-triangular linear system with matrix L and right-hand side\n    vector b.\n    \"\"\"\n    n = len(b)\n    x = np.zeros(n)\n    for i in range(n):\n        s = L[i,:i] @ x[:i]\n        x[i] = ( b[i] - s ) / L[i, i]\n    return x","lang":"python","showLineNumbers":true,"filename":"forwardsub.py","key":"s5z8wortgf"}],"key":"Hsl94yzUZB"}],"label":"function-forwardsub-python","identifier":"function-forwardsub-python","html_id":"function-forwardsub-python","key":"PjWubNOKYL"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Backward substitution","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"kaM9odMGE2"}],"key":"ZT6FMaL6XT"},{"type":"include","file":"../python/pkg/FNC/FNC02.py","literal":true,"filter":{"lines":[[18,30]]},"children":[{"type":"code","value":"def backsub(U,b):\n    \"\"\"\n    backsub(U,b)\n\n    Solve the upper-triangular linear system with matrix U and right-hand side\n    vector b.\n    \"\"\"\n    n = len(b)\n    x = np.zeros(n)\n    for i in range(n-1, -1, -1):\n        s = U[i, i+1:] @ x[i+1:]\n        x[i] = ( b[i] - s ) / U[i, i]\n    return x","lang":"python","showLineNumbers":true,"filename":"backsub.py","key":"GRdHwJKr3M"}],"key":"eZ6rZcZSaA"}],"label":"function-backsub-python","identifier":"function-backsub-python","html_id":"function-backsub-python","key":"VucRDBO5yG"},{"type":"details","children":[{"type":"summary","children":[{"type":"abbreviation","title":"lower triangular times upper triangular","children":[{"type":"text","value":"LU","key":"HmXMjayvZW"}],"key":"OniMZmwFbk"},{"type":"text","value":" factorization (not stable)","key":"s2RoGQyrwT"}],"key":"WZ6rYTIJHw"},{"type":"include","file":"../python/pkg/FNC/FNC02.py","literal":true,"filter":{"lines":[[32,50]]},"children":[{"type":"code","value":"def lufact(A):\n    \"\"\"\n    lufact(A)\n\n    Compute the LU factorization of square matrix `A`, returning the\n    factors.\n    \"\"\"\n    n = A.shape[0]     # detect the dimensions from the input\n    L = np.eye(n)      # ones on main diagonal, np.zeros elsewhere\n    U = np.zeros((n, n))\n    A_k = np.copy(A)   # make a working np.copy \n\n    # Reduction by np.outer products\n    for k in range(n-1):\n        U[k, :] = A_k[k, :]\n        L[:, k] = A_k[:, k] / U[k,k]\n        A_k -= np.outer(L[:,k], U[k,:])\n    U[n-1, n-1] = A_k[n-1, n-1]\n    return L, U","lang":"python","showLineNumbers":true,"filename":"lufact.py","key":"jOdyvDTKUT"}],"key":"cHryszdgLZ"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"About the code","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"key":"gUYIotYrQC"}],"key":"RE8dHQ1qCp"},{"type":"paragraph","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"children":[{"type":"text","value":"Line 11 of ","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"key":"VbeC16FnKh"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-lufact","label":"function-lufact","children":[{"type":"text","value":"Function ","key":"vGp58b3Xgv"},{"type":"text","value":"2.4.1","key":"UIyTLTiPFJ"}],"template":"Algorithm %s","enumerator":"2.4.1","resolved":true,"html_id":"function-lufact","remote":true,"url":"/lu","dataUrl":"/lu.json","key":"lbfwLAmubc"},{"type":"text","value":" points out a subtle issue. Array variables are really just references to blocks of memory. Such a reference is much more efficient to pass around than the complete contents of the array. However, it means that a statement ","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"key":"MUOOooHlLh"},{"type":"inlineCode","value":"A_k = A","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"key":"zhzWJpI8GQ"},{"type":"text","value":" would just clone the array reference of ","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"key":"uZunrrDGzD"},{"type":"inlineCode","value":"A","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"key":"KYvB78S9Zz"},{"type":"text","value":" into the new variable. Any changes made to entries of ","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"key":"ULpvSFD5Ek"},{"type":"inlineCode","value":"A_k","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"key":"pra92Y75zc"},{"type":"text","value":" would then also be made to entries of ","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"key":"BDQpRD03iN"},{"type":"inlineCode","value":"A","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"key":"DDljiRzIbW"},{"type":"text","value":", because they refer to the same location in memory. In this context, we don’t want to change the original matrix, so we use ","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"key":"Tew2ywauzV"},{"type":"inlineCode","value":"copy","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"key":"GPkoMFEpYY"},{"type":"text","value":" here to create an independent copy of the array contents and a new reference to them.","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"key":"yOhkMDEG5A"}],"key":"iVfgDGa1y1"}],"class":"dropdown","key":"LL6uDMrJFv"}],"label":"function-lufact-python","identifier":"function-lufact-python","html_id":"function-lufact-python","key":"DKXiABgbiL"},{"type":"details","children":[{"type":"summary","children":[{"type":"abbreviation","title":"lower triangular times upper triangular","children":[{"type":"text","value":"LU","key":"AfbbylWyG2"}],"key":"JYsp3ZQbQi"},{"type":"text","value":" factorization with partial pivoting","key":"eKiOFBWjzT"}],"key":"FPRp5XemuA"},{"type":"include","file":"../python/pkg/FNC/FNC02.py","literal":true,"filter":{"lines":[[52,72]]},"children":[{"type":"code","value":"def plufact(A):\n    \"\"\"\n        plufact(A)\n\n    Compute the PLU factorization of square matrix `A`, returning the\n    triangular factors and a row permutation vector.\n    \"\"\"\n    n = A.shape[0]\n    L = np.zeros((n, n))\n    U = np.zeros((n, n))\n    p = np.zeros(n, dtype=int)\n    A_k = np.copy(A)\n\n    # Reduction by np.outer products\n    for k in range(n):\n        p[k] = np.argmax(abs(A_k[:, k]))\n        U[k, :] = A_k[p[k], :]\n        L[:, k] = A_k[:, k] / U[k, k]\n        if k < n-1:\n            A_k -= np.outer(L[:, k], U[k, :])\n    return L[p, :], U, p","lang":"python","showLineNumbers":true,"filename":"plufact.py","key":"eFLMhAtP6K"}],"key":"S8szr8rNgm"}],"label":"function-plufact-python","identifier":"function-plufact-python","html_id":"function-plufact-python","key":"tZumwV817U"},{"type":"heading","depth":2,"position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"children":[{"type":"text","value":"Examples","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"key":"K2irTkjduX"}],"identifier":"examples","label":"Examples","html_id":"examples","implicit":true,"key":"S1p0sZaGSD"}],"key":"i1QokACWx2"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# from scipy import *\nfrom numpy import *\nfrom matplotlib.pyplot import *\nfrom numpy.linalg import solve\nimport scipy.sparse as sparse\nfrom timeit import default_timer as timer\nimport FNC","key":"ExAKDBdbSJ"},{"type":"output","id":"-YKDsIQ3zLMMu5hso5-i6","data":[],"key":"uSMYD6Tddo"}],"data":{},"key":"PmIN67KuMj"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# This (optional) block is for improving the display of plots.\n# from IPython.display import set_matplotlib_formats\n# set_matplotlib_formats(\"svg\",\"pdf\")\n# %config InlineBackend.figure_format = 'svg'\nrcParams[\"figure.figsize\"] = [7, 4]\nrcParams[\"lines.linewidth\"] = 2\nrcParams[\"lines.markersize\"] = 4\nrcParams['animation.html'] = \"jshtml\"  # or try \"html5\"","visibility":"show","key":"GRIkjY4EJ4"},{"type":"output","id":"N6_Q0Pje3dBnqxFRXhamw","data":[],"visibility":"show","key":"z7lfy9QpSb"}],"data":{"tags":[]},"visibility":"remove","key":"RCmw2DTBkO"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"children":[{"type":"text","value":"Section 2.1","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"SCHNl9Q3g7"}],"identifier":"section-2-1","label":"Section 2.1","html_id":"section-2-1","implicit":true,"key":"BMsIPPdjT2"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Linear system for polynomial interpolation","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"key":"CmH0zdu361"}],"key":"tDHdPAOGEO"},{"type":"paragraph","position":{"start":{"line":90,"column":1},"end":{"line":90,"column":1}},"children":[{"type":"text","value":"We create two vectors for data about the population of China. The first has the years of census data and the other has the population, in millions of people.","position":{"start":{"line":90,"column":1},"end":{"line":90,"column":1}},"key":"MmKb1s4vxH"}],"key":"B1qnE79P3r"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"year = arange(1980, 2020, 10)   # from 1980 to 2020 by 10\npop = array([984.736, 1148.364, 1263.638, 1330.141])","key":"XtyuvqGJH8"},{"type":"output","id":"Qbe9_AvJyT5xg9pWiOUPw","data":[],"key":"TB8LQGqi4c"}],"data":{},"key":"CCQbXxHoiT"},{"type":"paragraph","position":{"start":{"line":97,"column":1},"end":{"line":97,"column":1}},"children":[{"type":"text","value":"It’s convenient to measure time in years since 1980.","position":{"start":{"line":97,"column":1},"end":{"line":97,"column":1}},"key":"bwDlAw00Fe"}],"key":"HEB4kvvvYS"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"t = year - 1980\ny = pop","key":"YiSCIaXjnq"},{"type":"output","id":"nmucwkUvQ7CPwXEhDEMEG","data":[],"key":"XLxuiZkrgh"}],"data":{},"key":"SWT8FH2qzj"},{"type":"paragraph","position":{"start":{"line":104,"column":1},"end":{"line":104,"column":1}},"children":[{"type":"text","value":"Now we have four data points ","position":{"start":{"line":104,"column":1},"end":{"line":104,"column":1}},"key":"DMUY5ZteFA"},{"type":"inlineMath","value":"(t_1,y_1),\\dots,(t_4,y_4)","position":{"start":{"line":104,"column":1},"end":{"line":104,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><msub><mi>t</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><msub><mi>y</mi><mn>1</mn></msub><mo stretchy=\"false\">)</mo><mo separator=\"true\">,</mo><mo>…</mo><mo separator=\"true\">,</mo><mo stretchy=\"false\">(</mo><msub><mi>t</mi><mn>4</mn></msub><mo separator=\"true\">,</mo><msub><mi>y</mi><mn>4</mn></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(t_1,y_1),\\dots,(t_4,y_4)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">4</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">4</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"r3anEh0YKc"},{"type":"text","value":", so ","position":{"start":{"line":104,"column":1},"end":{"line":104,"column":1}},"key":"TAKn0bZJUy"},{"type":"inlineMath","value":"n=4","position":{"start":{"line":104,"column":1},"end":{"line":104,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>=</mo><mn>4</mn></mrow><annotation encoding=\"application/x-tex\">n=4</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">4</span></span></span></span>","key":"GLZMU9XCWe"},{"type":"text","value":" and we seek an interpolating cubic polynomial. We construct the associated Vandermonde matrix:","position":{"start":{"line":104,"column":1},"end":{"line":104,"column":1}},"key":"UtY2PWYf93"}],"key":"YZxaNbrjOX"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"V = vander(t)\nprint(V)","key":"js0tkI3pKA"},{"type":"output","id":"m8VeeuQhCH-IJm6E0z1v9","data":[{"output_type":"stream","name":"stdout","text":"[[    0     0     0     1]\n [ 1000   100    10     1]\n [ 8000   400    20     1]\n [27000   900    30     1]]\n"}],"key":"frVdi5zsSS"}],"data":{},"key":"PiXG0r2XzC"},{"type":"paragraph","position":{"start":{"line":111,"column":1},"end":{"line":111,"column":1}},"children":[{"type":"text","value":"To solve a linear system ","position":{"start":{"line":111,"column":1},"end":{"line":111,"column":1}},"key":"qKidi0mX2K"},{"type":"inlineMath","value":"\\mathbf{V} \\mathbf{c} = \\mathbf{y}","position":{"start":{"line":111,"column":1},"end":{"line":111,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">V</mi><mi mathvariant=\"bold\">c</mi><mo>=</mo><mi mathvariant=\"bold\">y</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{V} \\mathbf{c} = \\mathbf{y}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">Vc</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6389em;vertical-align:-0.1944em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">y</span></span></span></span>","key":"NIfnQ2duHY"},{"type":"text","value":" for the vector of polynomial coefficients, we use ","position":{"start":{"line":111,"column":1},"end":{"line":111,"column":1}},"key":"zYcPbhmaad"},{"type":"inlineCode","value":"solve","position":{"start":{"line":111,"column":1},"end":{"line":111,"column":1}},"key":"rnSrPC1RzO"},{"type":"text","value":" (imported from ","position":{"start":{"line":111,"column":1},"end":{"line":111,"column":1}},"key":"juOqXAPSau"},{"type":"inlineCode","value":"numpy.linalg","position":{"start":{"line":111,"column":1},"end":{"line":111,"column":1}},"key":"Res2Pk3y3X"},{"type":"text","value":"):","position":{"start":{"line":111,"column":1},"end":{"line":111,"column":1}},"key":"AB2UVWGyXa"}],"key":"bUTzqyMg2H"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"c = solve(V, y)\nprint(c)","key":"dnHG7Zrfk3"},{"type":"output","id":"K0Pmp38JIdJyfRQuTQI5T","data":[{"output_type":"stream","name":"stdout","text":"[-6.95000e-05 -2.39685e-01  1.87666e+01  9.84736e+02]\n"}],"key":"qQKKw03ns0"}],"data":{},"key":"ZG68qI8dZo"},{"type":"grid","columns":[1,1,2,2],"children":[{"type":"paragraph","position":{"start":{"line":118,"column":1},"end":{"line":118,"column":1}},"children":[{"type":"text","value":"The algorithms used by ","position":{"start":{"line":118,"column":1},"end":{"line":118,"column":1}},"key":"Ml68brbCE9"},{"type":"inlineCode","value":"solve","position":{"start":{"line":118,"column":1},"end":{"line":118,"column":1}},"key":"S9jG67C8Qw"},{"type":"text","value":" are the main topic of this chapter. As a check on the solution, we can compute the ","position":{"start":{"line":118,"column":1},"end":{"line":118,"column":1}},"key":"TA9KwlUBOI"},{"type":"emphasis","position":{"start":{"line":118,"column":1},"end":{"line":118,"column":1}},"children":[{"type":"text","value":"residual","position":{"start":{"line":118,"column":1},"end":{"line":118,"column":1}},"key":"CQYV57lCtH"}],"key":"zOLJeEbN1q"},{"type":"text","value":" ","position":{"start":{"line":118,"column":1},"end":{"line":118,"column":1}},"key":"hux2SjMbxB"},{"type":"inlineMath","value":"\\mathbf{y} - \\mathbf{V} \\mathbf{c}","position":{"start":{"line":118,"column":1},"end":{"line":118,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">y</mi><mo>−</mo><mi mathvariant=\"bold\">V</mi><mi mathvariant=\"bold\">c</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{y} - \\mathbf{V} \\mathbf{c}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">Vc</span></span></span></span>","key":"lRlbxTU1xK"},{"type":"text","value":", which should be small (near machine precision).","position":{"start":{"line":118,"column":1},"end":{"line":118,"column":1}},"key":"LhCfnh3s7F"}],"key":"thjQ5ccmCq"},{"type":"card","children":[{"type":"paragraph","position":{"start":{"line":121,"column":1},"end":{"line":121,"column":1}},"children":[{"type":"text","value":"Matrix multiplication in NumPy is done with ","position":{"start":{"line":121,"column":1},"end":{"line":121,"column":1}},"key":"MgIZhiRjyp"},{"type":"inlineCode","value":"@","position":{"start":{"line":121,"column":1},"end":{"line":121,"column":1}},"key":"gRbQVFeSrZ"},{"type":"text","value":" or ","position":{"start":{"line":121,"column":1},"end":{"line":121,"column":1}},"key":"OLpoM3B6YC"},{"type":"inlineCode","value":"matmul","position":{"start":{"line":121,"column":1},"end":{"line":121,"column":1}},"key":"BM6lOmXFbo"},{"type":"text","value":".","position":{"start":{"line":121,"column":1},"end":{"line":121,"column":1}},"key":"BEVywKApIe"}],"key":"SOAXLdS5QC"}],"key":"a6uhkoskJE"}],"key":"NEsGRyL14O"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(y - V @ c)","key":"xNCqEqQcaU"},{"type":"output","id":"klvSDuCRW5M7ZZ7bulwrk","data":[{"output_type":"stream","name":"stdout","text":"[0. 0. 0. 0.]\n"}],"key":"IXB6eWWLHS"}],"data":{},"key":"efdCHxWTE3"},{"type":"paragraph","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"children":[{"type":"text","value":"By our definitions, the coefficients in ","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"key":"ztfXfB5yDh"},{"type":"inlineCode","value":"c","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"key":"DLjHkJ7T0s"},{"type":"text","value":" are given in descending order of power in ","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"key":"oTu9BNxlsd"},{"type":"inlineMath","value":"t","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span></span></span></span>","key":"vnYm5SyzpZ"},{"type":"text","value":". We can use the resulting polynomial to estimate the population of China in 2005:","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"key":"lcVs815eGy"}],"key":"ISWPDcO7os"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"p = poly1d(c)          # construct a polynomial\nprint(p(2005 - 1980))     # apply the 1980 time shift","key":"ClHNB4IybG"},{"type":"output","id":"YvCw1qkiSJMRL9zfjqJs8","data":[{"output_type":"stream","name":"stdout","text":"1303.0119375\n"}],"key":"l7We3ClB8v"}],"data":{},"key":"IispHrKP23"},{"type":"paragraph","position":{"start":{"line":136,"column":1},"end":{"line":136,"column":1}},"children":[{"type":"text","value":"The official figure was 1303.72, so our result is rather good.","position":{"start":{"line":136,"column":1},"end":{"line":136,"column":1}},"key":"O7EvZiuGkI"}],"key":"TiPov7kiJf"},{"type":"paragraph","position":{"start":{"line":138,"column":1},"end":{"line":138,"column":1}},"children":[{"type":"text","value":"We can visualize the interpolation process. First, we plot the data as points. Then we add a plot of the interpolant, taking care to shift the ","position":{"start":{"line":138,"column":1},"end":{"line":138,"column":1}},"key":"jAzXG5oKwj"},{"type":"inlineMath","value":"t","position":{"start":{"line":138,"column":1},"end":{"line":138,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span></span></span></span>","key":"k4tFmTexwF"},{"type":"text","value":" variable back to actual years.","position":{"start":{"line":138,"column":1},"end":{"line":138,"column":1}},"key":"Jsk0cIy0uT"}],"key":"Vl4BKTIYrU"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"scatter(year, y, color=\"k\", label=\"data\");\ntt = linspace(0, 30, 300)   # 300 times from 1980 to 2010\nplot(1980 + tt, p(tt), label=\"interpolant\");\nxlabel(\"year\");\nylabel(\"population (millions)\");\ntitle(\"Population of China\");\nlegend();","key":"i7nejgpi73"},{"type":"output","id":"FKYDvJvKr-ss6lAa3ATzt","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"f1f42be1fd0952fe400cd791379f7e10","path":"/fnc/build/f1f42be1fd0952fe400cd791379f7e10.png"}}}],"key":"PFepXOYawW"}],"data":{},"key":"oVCmuGLt2x"}],"label":"demo-interp-vander-python","identifier":"demo-interp-vander-python","html_id":"demo-interp-vander-python","key":"GL6kRAcoV0"},{"type":"heading","depth":3,"position":{"start":{"line":151,"column":1},"end":{"line":151,"column":1}},"children":[{"type":"text","value":"Section 2.2","position":{"start":{"line":151,"column":1},"end":{"line":151,"column":1}},"key":"mVZuyQ4s4m"}],"identifier":"section-2-2","label":"Section 2.2","html_id":"section-2-2","implicit":true,"key":"OgIPrlH2q9"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Matrix operations","position":{"start":{"line":153,"column":1},"end":{"line":153,"column":1}},"key":"kCI0xxWY3b"}],"key":"C0TYrUtrTr"},{"type":"admonition","kind":"note","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Note","key":"PcfyQZckGm"}],"key":"tpUoaiJlmN"},{"type":"paragraph","position":{"start":{"line":155,"column":1},"end":{"line":155,"column":1}},"children":[{"type":"text","value":"While NumPy does have distinct representations for matrices and 2D arrays, use of the explicit matrix class is officially discouraged. We follow this advice here and use arrays to represent both matrices and vectors.","position":{"start":{"line":155,"column":1},"end":{"line":155,"column":1}},"key":"vAW8oN4r75"}],"key":"KAG14gPSEl"}],"key":"nTjQ6P4ygX"},{"type":"comment","value":" :::{index}\nsee: Python; size, Python; shape\n::: ","key":"rbNBsYKKx2"},{"type":"paragraph","position":{"start":{"line":165,"column":1},"end":{"line":165,"column":1}},"children":[{"type":"text","value":"A vector is created using square brackets and commas to enclose and separate its entries.","position":{"start":{"line":165,"column":1},"end":{"line":165,"column":1}},"key":"sAJPqL6FSi"}],"key":"hV1xFV0EVy"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"x = array([3, 3, 0, 1, 0 ])\nprint(x.shape)","key":"UeL5fqtMH0"},{"type":"output","id":"hFrXuqW56eoueVZ_JjBRD","data":[{"output_type":"stream","name":"stdout","text":"(5,)\n"}],"key":"Ek0m76YcvI"}],"data":{},"key":"ZI425nwZ0k"},{"type":"paragraph","position":{"start":{"line":172,"column":1},"end":{"line":172,"column":1}},"children":[{"type":"text","value":"To construct a matrix, you nest the brackets to create a “vector of vectors”. The inner vectors are the rows.","position":{"start":{"line":172,"column":1},"end":{"line":172,"column":1}},"key":"BFs3yY9yEJ"}],"key":"vujRkWp3Im"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"A = array([ \n    [1, 2, 3, 4, 5],\n    [50, 40, 30, 20, 10], \n    [pi, sqrt(2), exp(1), (1+sqrt(5))/2, log(3)] \n    ])\n\nprint(A)\nprint(A.shape)","key":"vuJTekhanz"},{"type":"output","id":"9xmBkseoiAswwYb5a43Za","data":[{"output_type":"stream","name":"stdout","text":"[[ 1.          2.          3.          4.          5.        ]\n [50.         40.         30.         20.         10.        ]\n [ 3.14159265  1.41421356  2.71828183  1.61803399  1.09861229]]\n(3, 5)\n"}],"key":"aU3oWqLV8J"}],"data":{},"key":"XV5NXwttZ6"},{"type":"paragraph","position":{"start":{"line":185,"column":1},"end":{"line":185,"column":1}},"children":[{"type":"text","value":"In this text, we treat all vectors as equivalent to matrices with a single column. That isn’t true in NumPy, because even an ","position":{"start":{"line":185,"column":1},"end":{"line":185,"column":1}},"key":"svcsko2FNt"},{"type":"inlineMath","value":"n \\times 1","position":{"start":{"line":185,"column":1},"end":{"line":185,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>×</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">n \\times 1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"PJuBafbCC0"},{"type":"text","value":" array has two dimensions, unlike a vector.","position":{"start":{"line":185,"column":1},"end":{"line":185,"column":1}},"key":"dkJ0Txw8rz"}],"key":"KO1hcL0zlW"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"array([[3], [1], [2]]).shape","key":"banzLNVWqQ"},{"type":"output","id":"K7YwcOkdVfKwTKgKJDURG","data":[{"output_type":"execute_result","execution_count":12,"metadata":{},"data":{"text/plain":{"content":"(3, 1)","content_type":"text/plain"}}}],"key":"MjAVoZBP9x"}],"data":{},"key":"syQUoJz8aD"},{"type":"paragraph","position":{"start":{"line":194,"column":1},"end":{"line":194,"column":1}},"children":[{"type":"text","value":"You can concatenate arrays with compatible dimensions using ","position":{"start":{"line":194,"column":1},"end":{"line":194,"column":1}},"key":"FBSBja0WIu"},{"type":"inlineCode","value":"hstack","position":{"start":{"line":194,"column":1},"end":{"line":194,"column":1}},"key":"kfyibxnOHl"},{"type":"text","value":" and ","position":{"start":{"line":194,"column":1},"end":{"line":194,"column":1}},"key":"QpH5C4QFUJ"},{"type":"inlineCode","value":"vstack","position":{"start":{"line":194,"column":1},"end":{"line":194,"column":1}},"key":"I0ewQ0K32x"},{"type":"text","value":".","position":{"start":{"line":194,"column":1},"end":{"line":194,"column":1}},"key":"XKWjNn4BNm"}],"indexEntries":[{"entry":"Python","subEntry":{"value":"hstack","kind":"entry"},"emphasis":true},{"entry":"Python","subEntry":{"value":"vstack","kind":"entry"},"emphasis":true}],"label":"index-X0jMiErJAe","identifier":"index-x0jmierjae","html_id":"index-x0jmierjae","key":"MYxcrTPTtZ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print( hstack([A, A]) )","key":"i1Gry7aXnz"},{"type":"output","id":"0tSVxR9wh9Np1JYvtnqUF","data":[{"output_type":"stream","name":"stdout","text":"[[ 1.          2.          3.          4.          5.          1.\n   2.          3.          4.          5.        ]\n [50.         40.         30.         20.         10.         50.\n  40.         30.         20.         10.        ]\n [ 3.14159265  1.41421356  2.71828183  1.61803399  1.09861229  3.14159265\n   1.41421356  2.71828183  1.61803399  1.09861229]]\n"}],"key":"FSr2augaju"}],"data":{},"key":"pMDmqIJahR"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print( vstack([A, A]) )","key":"VntyZ3QKv5"},{"type":"output","id":"BRBis-it1MSY74yJIpEIW","data":[{"output_type":"stream","name":"stdout","text":"[[ 1.          2.          3.          4.          5.        ]\n [50.         40.         30.         20.         10.        ]\n [ 3.14159265  1.41421356  2.71828183  1.61803399  1.09861229]\n [ 1.          2.          3.          4.          5.        ]\n [50.         40.         30.         20.         10.        ]\n [ 3.14159265  1.41421356  2.71828183  1.61803399  1.09861229]]\n"}],"key":"ihPHBl0s01"}],"data":{},"key":"yBYihQWQOv"},{"type":"paragraph","position":{"start":{"line":207,"column":1},"end":{"line":207,"column":1}},"children":[{"type":"text","value":"Transposing a matrix is done by appending ","position":{"start":{"line":207,"column":1},"end":{"line":207,"column":1}},"key":"miYMYOn3Fe"},{"type":"inlineCode","value":".T","position":{"start":{"line":207,"column":1},"end":{"line":207,"column":1}},"key":"mWTVTh6hJ8"},{"type":"text","value":" to it.","position":{"start":{"line":207,"column":1},"end":{"line":207,"column":1}},"key":"s5pbIIPgb7"}],"indexEntries":[{"entry":"Python","subEntry":{"value":"transpose","kind":"entry"},"emphasis":true},{"entry":"Python","subEntry":{"value":"adjoint","kind":"entry"},"emphasis":true}],"label":"index-lKnb5cTIku","identifier":"index-lknb5ctiku","html_id":"index-lknb5ctiku","key":"VOiIq9MG9P"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(A.T)","key":"jCH3tIjZ0V"},{"type":"output","id":"I23AfSN-yq0ob2y2Pr5CH","data":[{"output_type":"stream","name":"stdout","text":"[[ 1.         50.          3.14159265]\n [ 2.         40.          1.41421356]\n [ 3.         30.          2.71828183]\n [ 4.         20.          1.61803399]\n [ 5.         10.          1.09861229]]\n"}],"key":"AGR2NVcfn9"}],"data":{},"key":"dMpvqIODHw"},{"type":"paragraph","position":{"start":{"line":213,"column":1},"end":{"line":213,"column":1}},"children":[{"type":"text","value":"For matrices with complex values, we usually want instead the adjoint or hermitian, which is ","position":{"start":{"line":213,"column":1},"end":{"line":213,"column":1}},"key":"wD1xjf2KqH"},{"type":"inlineCode","value":".conj().T","position":{"start":{"line":213,"column":1},"end":{"line":213,"column":1}},"key":"fuiAh15l0H"},{"type":"text","value":".","position":{"start":{"line":213,"column":1},"end":{"line":213,"column":1}},"key":"cXKXQADvVH"}],"key":"wY88Wwj3LT"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print((x + 1j).conj().T)","key":"bQ2slrG2FO"},{"type":"output","id":"B3RSfq0HKFyI9il7_esxG","data":[{"output_type":"stream","name":"stdout","text":"[3.-1.j 3.-1.j 0.-1.j 1.-1.j 0.-1.j]\n"}],"key":"J5qVW4RSiM"}],"data":{},"key":"GLfHR3r6qP"},{"type":"paragraph","position":{"start":{"line":222,"column":1},"end":{"line":222,"column":1}},"children":[{"type":"text","value":"There are many convenient shorthand ways of building vectors and matrices other than entering all of their entries directly or in a loop. To get a vector with evenly spaced entries between two endpoints, you have two options.","position":{"start":{"line":222,"column":1},"end":{"line":222,"column":1}},"key":"bQVBtCAUzK"}],"indexEntries":[{"entry":"Python","subEntry":{"value":"arange","kind":"entry"},"emphasis":true},{"entry":"Python","subEntry":{"value":"linspace","kind":"entry"},"emphasis":true}],"label":"index-nPTLDmodQD","identifier":"index-nptldmodqd","html_id":"index-nptldmodqd","key":"HVoJHwJ4zn"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(arange(1, 7, 2))   # from 1 to 7 (not inclusive), step by 2","key":"syE1Hf7dhc"},{"type":"output","id":"dAXNPVM7kXh_fiflTXcMu","data":[{"output_type":"stream","name":"stdout","text":"[1 3 5]\n"}],"key":"d2MYoXZcJV"}],"data":{},"key":"Lysc1tNm8u"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(linspace(-1, 1, 5))   # from -1 to 1 (inclusive), with 5 total values","key":"Lj1aMRNCFa"},{"type":"output","id":"YEFp6C6mUX2GYy9Gj1cAN","data":[{"output_type":"stream","name":"stdout","text":"[-1.  -0.5  0.   0.5  1. ]\n"}],"key":"MwRL8CWjHq"}],"data":{},"key":"B3enMuXsgy"},{"type":"paragraph","position":{"start":{"line":232,"column":1},"end":{"line":232,"column":1}},"children":[{"type":"text","value":"The practical difference between these is whether you want to specify the step size in ","position":{"start":{"line":232,"column":1},"end":{"line":232,"column":1}},"key":"BkutmRFPSg"},{"type":"inlineCode","value":"arange","position":{"start":{"line":232,"column":1},"end":{"line":232,"column":1}},"key":"qotMjDrP2L"},{"type":"text","value":" or the number of points in ","position":{"start":{"line":232,"column":1},"end":{"line":232,"column":1}},"key":"JS6X7tEp7s"},{"type":"inlineCode","value":"linspace","position":{"start":{"line":232,"column":1},"end":{"line":232,"column":1}},"key":"T4VYjNcsEH"},{"type":"text","value":".","position":{"start":{"line":232,"column":1},"end":{"line":232,"column":1}},"key":"ro01LePS3G"}],"key":"GI1RSbUCxe"},{"type":"paragraph","position":{"start":{"line":234,"column":1},"end":{"line":234,"column":1}},"children":[{"type":"text","value":"Accessing an element is done by giving one (for a vector) or two index values in square brackets. ","position":{"start":{"line":234,"column":1},"end":{"line":234,"column":1}},"key":"k7qL8gjmPt"},{"type":"strong","position":{"start":{"line":234,"column":1},"end":{"line":234,"column":1}},"children":[{"type":"text","value":"In Python, indexing always starts with zero, not 1.","position":{"start":{"line":234,"column":1},"end":{"line":234,"column":1}},"key":"AFMHEMiBKR"}],"key":"s1mItG890c"}],"key":"KDdjQovJ8V"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"A = array([ \n    [1, 2, 3, 4, 5],\n    [50, 40, 30, 20, 10], \n    linspace(-5, 5, 5) \n    ])\nx = array([3, 2, 0, 1, -1 ])","key":"vTzi9BjJPO"},{"type":"output","id":"2kotZzrOM6-90QZ05YdbS","data":[],"key":"H0h74mc7Dt"}],"data":{},"key":"AmWL6a7c36"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(\"row 2, col 3 of A:\", A[1, 2])\nprint(\"first element of x:\", x[0])","key":"czgF1OkrkT"},{"type":"output","id":"-PEcDNBPPO-lWmvBWji8Y","data":[{"output_type":"stream","name":"stdout","text":"row 2, col 3 of A: 30.0\nfirst element of x: 3\n"}],"key":"yi1HkzEY8Z"}],"data":{},"key":"h0cK7Zyjlt"},{"type":"paragraph","position":{"start":{"line":255,"column":1},"end":{"line":255,"column":1}},"children":[{"type":"text","value":"The indices can be ranges, in which case a ","position":{"start":{"line":255,"column":1},"end":{"line":255,"column":1}},"key":"bKXyPFjPny"},{"type":"strong","position":{"start":{"line":255,"column":1},"end":{"line":255,"column":1}},"children":[{"type":"text","value":"slice","position":{"start":{"line":255,"column":1},"end":{"line":255,"column":1}},"key":"nNrMMK5h1n"}],"key":"eWEE5s6Y4C"},{"type":"text","value":" or block of the matrix is accessed. You build these using a colon in the form ","position":{"start":{"line":255,"column":1},"end":{"line":255,"column":1}},"key":"hIUTL72fZ7"},{"type":"inlineCode","value":"start:stop","position":{"start":{"line":255,"column":1},"end":{"line":255,"column":1}},"key":"X96zCgcGrw"},{"type":"text","value":". However, the last value of this range is ","position":{"start":{"line":255,"column":1},"end":{"line":255,"column":1}},"key":"mJThFGJorD"},{"type":"inlineCode","value":"stop-1","position":{"start":{"line":255,"column":1},"end":{"line":255,"column":1}},"key":"vGyQxCARqH"},{"type":"text","value":", not ","position":{"start":{"line":255,"column":1},"end":{"line":255,"column":1}},"key":"O1nqQoOukV"},{"type":"inlineCode","value":"stop","position":{"start":{"line":255,"column":1},"end":{"line":255,"column":1}},"key":"bXSSfzzZKJ"},{"type":"text","value":".","position":{"start":{"line":255,"column":1},"end":{"line":255,"column":1}},"key":"FuqNuqSgM2"}],"indexEntries":[{"entry":"Python","subEntry":{"value":"indexing arrays","kind":"entry"},"emphasis":true},{"entry":"Python","subEntry":{"value":"slice","kind":"entry"},"emphasis":true},{"entry":"Python","subEntry":{"value":":","kind":"entry"},"emphasis":true}],"label":"index-iyH26NxN1r","identifier":"index-iyh26nxn1r","html_id":"index-iyh26nxn1r","key":"AIamfrbz6g"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(A[1:3, 0:2])    # rows 2 and 3, cols 1 and 2","key":"yksLHKKVni"},{"type":"output","id":"YpiuIAJh6_WZawZ0SKP2L","data":[{"output_type":"stream","name":"stdout","text":"[[50.  40. ]\n [-5.  -2.5]]\n"}],"key":"l9H7IeKNi4"}],"data":{},"key":"ES8o02TKE1"},{"type":"paragraph","position":{"start":{"line":261,"column":1},"end":{"line":261,"column":1}},"children":[{"type":"text","value":"If ","position":{"start":{"line":261,"column":1},"end":{"line":261,"column":1}},"key":"B66faDZgMc"},{"type":"inlineCode","value":"start","position":{"start":{"line":261,"column":1},"end":{"line":261,"column":1}},"key":"LF0VRzzHQ5"},{"type":"text","value":" or ","position":{"start":{"line":261,"column":1},"end":{"line":261,"column":1}},"key":"re3QCJLK9e"},{"type":"inlineCode","value":"stop","position":{"start":{"line":261,"column":1},"end":{"line":261,"column":1}},"key":"iYvwdGHKQH"},{"type":"text","value":" is omitted, the range extends to the first or last index.","position":{"start":{"line":261,"column":1},"end":{"line":261,"column":1}},"key":"MYpeAqxImx"}],"key":"YatXiGp2eC"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(x[1:])  # elements 2 through the end","key":"yinOitUBPz"},{"type":"output","id":"upPh5IXukpMggltz0V9UZ","data":[{"output_type":"stream","name":"stdout","text":"[ 2  0  1 -1]\n"}],"key":"KIR22VvUls"}],"data":{},"key":"uJSy9ih9Fw"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(A[:2, 0])  # first two rows in column 1","key":"vqvEQrw4vu"},{"type":"output","id":"-sWBUMk-X1vjmn6iKJX5g","data":[{"output_type":"stream","name":"stdout","text":"[ 1. 50.]\n"}],"key":"mzwrgEyqwn"}],"data":{},"key":"rLfmI7h0ch"},{"type":"paragraph","position":{"start":{"line":271,"column":1},"end":{"line":271,"column":1}},"children":[{"type":"text","value":"Notice in the last case above that even when the slice is in the shape of a column vector, the result is just a vector with one dimension and neither row nor column shape.","position":{"start":{"line":271,"column":1},"end":{"line":271,"column":1}},"key":"Ee1DeDvX9U"}],"key":"uLl5WafeAO"},{"type":"paragraph","position":{"start":{"line":273,"column":1},"end":{"line":273,"column":1}},"children":[{"type":"text","value":"There are more variations on the colon ranges. A negative value means to count from the end rather than the beginning. And a colon by itself means to include everything from the relevant dimension.","position":{"start":{"line":273,"column":1},"end":{"line":273,"column":1}},"key":"sLl7WpuTF2"}],"key":"tgjNuhFfZz"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(A[:-1, :])    # all rows up to the last, all columns","key":"whV7DBKnfZ"},{"type":"output","id":"nl51AKbRC8MSbUoeNa7QE","data":[{"output_type":"stream","name":"stdout","text":"[[ 1.  2.  3.  4.  5.]\n [50. 40. 30. 20. 10.]]\n"}],"key":"VpCgUqV32D"}],"data":{},"key":"zf983Wj9eU"},{"type":"paragraph","position":{"start":{"line":279,"column":1},"end":{"line":279,"column":1}},"children":[{"type":"text","value":"Finally, ","position":{"start":{"line":279,"column":1},"end":{"line":279,"column":1}},"key":"C2aqxtKnxn"},{"type":"inlineCode","value":"start:stop:step","position":{"start":{"line":279,"column":1},"end":{"line":279,"column":1}},"key":"SsGshuTkFX"},{"type":"text","value":" means to step size or stride other than one. You can mix this with the other variations.","position":{"start":{"line":279,"column":1},"end":{"line":279,"column":1}},"key":"HjpqPordyd"}],"key":"TsUud4IoOZ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(x[::2])  # all the odd indexes","key":"PmMnkjjKvy"},{"type":"output","id":"RtuRfCYQ0aJSIfjophtEm","data":[{"output_type":"stream","name":"stdout","text":"[ 3  0 -1]\n"}],"key":"dziNq8J7TA"}],"data":{},"key":"wD8kPfYi7G"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(A[:, ::-1])  # reverse the columns","key":"T2UIzxe3rs"},{"type":"output","id":"wtNbz70HWRJw4lFLVRAhU","data":[{"output_type":"stream","name":"stdout","text":"[[ 5.   4.   3.   2.   1. ]\n [10.  20.  30.  40.  50. ]\n [ 5.   2.5  0.  -2.5 -5. ]]\n"}],"key":"pqEcsnL2zn"}],"data":{},"key":"m8S15CCE86"},{"type":"paragraph","position":{"start":{"line":289,"column":1},"end":{"line":289,"column":1}},"children":[{"type":"text","value":"The matrix and vector senses of addition, subtraction, and scalar multiplication and division are all handled by the usual symbols. Two matrices of the same size (what NumPy calls shape) are operated on elementwise.","position":{"start":{"line":289,"column":1},"end":{"line":289,"column":1}},"key":"ziBiDOPIkU"}],"key":"p9EGwFECOE"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(A - 2 * ones([3, 5]))  # subtract two from each element","key":"Hntv0jrtmL"},{"type":"output","id":"2IfyEJSFXLRyJO_M6EUHH","data":[{"output_type":"stream","name":"stdout","text":"[[-1.   0.   1.   2.   3. ]\n [48.  38.  28.  18.   8. ]\n [-7.  -4.5 -2.   0.5  3. ]]\n"}],"key":"IiFWsX1hw5"}],"data":{},"key":"XQJwNqCPpX"},{"type":"paragraph","position":{"start":{"line":298,"column":1},"end":{"line":298,"column":1}},"children":[{"type":"text","value":"If one operand has a smaller number of dimensions than the other, Python tries to ","position":{"start":{"line":298,"column":1},"end":{"line":298,"column":1}},"key":"wuJglz8556"},{"type":"strong","position":{"start":{"line":298,"column":1},"end":{"line":298,"column":1}},"children":[{"type":"text","value":"broadcast","position":{"start":{"line":298,"column":1},"end":{"line":298,"column":1}},"key":"gEnUu0x1rN"}],"key":"fqSyiZy9n1"},{"type":"text","value":" it in the “missing” dimension(s), and the operation proceeds if the resulting shapes are identical.","position":{"start":{"line":298,"column":1},"end":{"line":298,"column":1}},"key":"FrHZWkNXOt"}],"indexEntries":[{"entry":"Python","subEntry":{"value":"broadcast","kind":"entry"},"emphasis":true}],"label":"index-Um9UeFnFLj","identifier":"index-um9uefnflj","html_id":"index-um9uefnflj","key":"OIlBdPFG3R"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(A - 2)    # subtract two from each element","key":"dDgqDmsWst"},{"type":"output","id":"Bq193XW5IHEsLceEdQOYy","data":[{"output_type":"stream","name":"stdout","text":"[[-1.   0.   1.   2.   3. ]\n [48.  38.  28.  18.   8. ]\n [-7.  -4.5 -2.   0.5  3. ]]\n"}],"key":"ZYGdc63Vwy"}],"data":{},"key":"jvm8HG5aXh"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"u = array([1, 2, 3, 4, 5])\nprint(A - u)    # repeat this row for every row of A","key":"m6r2ZxYFgB"},{"type":"output","id":"AVwjYjjwCllYubCnZYnBt","data":[{"output_type":"stream","name":"stdout","text":"[[ 0.   0.   0.   0.   0. ]\n [49.  38.  27.  16.   5. ]\n [-6.  -4.5 -3.  -1.5  0. ]]\n"}],"key":"hOTnk4wWrF"}],"data":{},"key":"n6DyQHXA4O"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"v = array([1, 2, 3])\nprint(A - v)  # broadcasting this would be 3x3, so it's an error","visibility":"show","key":"VvfvdC255w"},{"type":"output","id":"b_R6pH--ZpkVmWLBQuEWx","data":[{"output_type":"error","traceback":"\u001b[0;31m---------------------------------------------------------------------------\u001b[0m\n\u001b[0;31mValueError\u001b[0m                                Traceback (most recent call last)\nCell \u001b[0;32mIn[30], line 2\u001b[0m\n\u001b[1;32m      1\u001b[0m v \u001b[38;5;241m=\u001b[39m array([\u001b[38;5;241m1\u001b[39m, \u001b[38;5;241m2\u001b[39m, \u001b[38;5;241m3\u001b[39m])\n\u001b[0;32m----> 2\u001b[0m \u001b[38;5;28mprint\u001b[39m(\u001b[43mA\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;241;43m-\u001b[39;49m\u001b[43m \u001b[49m\u001b[43mv\u001b[49m)  \u001b[38;5;66;03m# broadcasting this would be 3x3, so it's an error\u001b[39;00m\n\n\u001b[0;31mValueError\u001b[0m: operands could not be broadcast together with shapes (3,5) (3,) ","ename":"ValueError","evalue":"operands could not be broadcast together with shapes (3,5) (3,) "}],"visibility":"show","key":"p2jg0aKnjr"}],"data":{"tags":["raises-exception"]},"visibility":"show","key":"WRVAw9eDD7"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(A - v.reshape([3, 1]))    # broadcasts to each column of A","key":"h04YzdZUGp"},{"type":"output","id":"nSaXWrsimxaAjco_IouRB","data":[{"output_type":"stream","name":"stdout","text":"[[ 0.   1.   2.   3.   4. ]\n [48.  38.  28.  18.   8. ]\n [-8.  -5.5 -3.  -0.5  2. ]]\n"}],"key":"VBQChgSPm6"}],"data":{},"key":"ktphg9Nd8R"},{"type":"comment","value":" ```{index} \nsee: Python; matrix multiplication, Python; \\@\n``` ","key":"TDH28lETmV"},{"type":"paragraph","position":{"start":{"line":329,"column":1},"end":{"line":329,"column":1}},"children":[{"type":"text","value":"Matrix–matrix and matrix–vector products are computed using ","position":{"start":{"line":329,"column":1},"end":{"line":329,"column":1}},"key":"VLKssWJ9U4"},{"type":"inlineCode","value":"@","position":{"start":{"line":329,"column":1},"end":{"line":329,"column":1}},"key":"cXWCbvHgAc"},{"type":"text","value":" or ","position":{"start":{"line":329,"column":1},"end":{"line":329,"column":1}},"key":"lym4HvyPbQ"},{"type":"inlineCode","value":"matmul","position":{"start":{"line":329,"column":1},"end":{"line":329,"column":1}},"key":"QJjxVxUDiU"},{"type":"text","value":".","position":{"start":{"line":329,"column":1},"end":{"line":329,"column":1}},"key":"c31aRFgGwq"}],"indexEntries":[{"entry":"Python","subEntry":{"value":"diag","kind":"entry"},"emphasis":true}],"label":"index-Elo1y3mJB9","identifier":"index-elo1y3mjb9","html_id":"index-elo1y3mjb9","key":"anlM3UV8JI"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"B = diag([-1, 0, -5])    # create a diagonal 3x3\nprint(B @ A)    # matrix product","key":"WE8wxf5rHS"},{"type":"output","id":"tsBdNSDsivtwcJUIE66JH","data":[{"output_type":"stream","name":"stdout","text":"[[ -1.   -2.   -3.   -4.   -5. ]\n [  0.    0.    0.    0.    0. ]\n [ 25.   12.5   0.  -12.5 -25. ]]\n"}],"key":"P676qT0eeW"}],"data":{},"key":"aPNgMzLVjR"},{"type":"paragraph","position":{"start":{"line":336,"column":1},"end":{"line":336,"column":1}},"children":[{"type":"inlineMath","value":"AB","position":{"start":{"line":336,"column":1},"end":{"line":336,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi><mi>B</mi></mrow><annotation encoding=\"application/x-tex\">AB</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">A</span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span></span></span></span>","key":"TiO2NETje8"},{"type":"text","value":" is undefined for these matrix sizes.","position":{"start":{"line":336,"column":1},"end":{"line":336,"column":1}},"key":"bdpsTX4Mrh"}],"key":"ym3mhh5HIg"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(A @ B)    # incompatible sizes","visibility":"show","key":"OQA2DMNphj"},{"type":"output","id":"OsmU-4XQuYiT-DVlo4cl5","data":[{"output_type":"error","traceback":"\u001b[0;31m---------------------------------------------------------------------------\u001b[0m\n\u001b[0;31mValueError\u001b[0m                                Traceback (most recent call last)\nCell \u001b[0;32mIn[33], line 1\u001b[0m\n\u001b[0;32m----> 1\u001b[0m \u001b[38;5;28mprint\u001b[39m(\u001b[43mA\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;241;43m@\u001b[39;49m\u001b[43m \u001b[49m\u001b[43mB\u001b[49m)    \u001b[38;5;66;03m# incompatible sizes\u001b[39;00m\n\n\u001b[0;31mValueError\u001b[0m: matmul: Input operand 1 has a mismatch in its core dimension 0, with gufunc signature (n?,k),(k,m?)->(n?,m?) (size 3 is different from 5)","ename":"ValueError","evalue":"matmul: Input operand 1 has a mismatch in its core dimension 0, with gufunc signature (n?,k),(k,m?)->(n?,m?) (size 3 is different from 5)"}],"visibility":"show","key":"AKc32TFtAx"}],"data":{"tags":["raises-exception"]},"visibility":"show","key":"XDmSbbDVVL"},{"type":"paragraph","position":{"start":{"line":346,"column":1},"end":{"line":346,"column":1}},"children":[{"type":"text","value":"The multiplication operator ","position":{"start":{"line":346,"column":1},"end":{"line":346,"column":1}},"key":"JK6y6Mm8NE"},{"type":"inlineCode","value":"*","position":{"start":{"line":346,"column":1},"end":{"line":346,"column":1}},"key":"tbowsV7EJG"},{"type":"text","value":" is reserved for elementwise multiplication. Both operands have to be the same size, after any potential broadcasts.","position":{"start":{"line":346,"column":1},"end":{"line":346,"column":1}},"key":"KRgrgv9HFB"}],"indexEntries":[{"entry":"Python","subEntry":{"value":"elementwise multiplication","kind":"entry"},"emphasis":true},{"entry":"Python","subEntry":{"value":"broadcasting","kind":"entry"},"emphasis":false}],"label":"index-nyri1xsPSr","identifier":"index-nyri1xspsr","html_id":"index-nyri1xspsr","key":"nvbLsYUT9G"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(B * A)    # not the same size, so it's an error","visibility":"show","key":"i9JQ5EXVcz"},{"type":"output","id":"EdmgKzasfbpu8JLqRW77p","data":[{"output_type":"error","traceback":"\u001b[0;31m---------------------------------------------------------------------------\u001b[0m\n\u001b[0;31mValueError\u001b[0m                                Traceback (most recent call last)\nCell \u001b[0;32mIn[34], line 1\u001b[0m\n\u001b[0;32m----> 1\u001b[0m \u001b[38;5;28mprint\u001b[39m(\u001b[43mB\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[43m \u001b[49m\u001b[43mA\u001b[49m)    \u001b[38;5;66;03m# not the same size, so it's an error\u001b[39;00m\n\n\u001b[0;31mValueError\u001b[0m: operands could not be broadcast together with shapes (3,3) (3,5) ","ename":"ValueError","evalue":"operands could not be broadcast together with shapes (3,3) (3,5) "}],"visibility":"show","key":"mgBcEhY3L2"}],"data":{"tags":["raises-exception"]},"visibility":"show","key":"T2hFlGTMFV"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print((A / 2) * A)    # elementwise","key":"vY4IYXZ2pz"},{"type":"output","id":"UM8BCHRS763sBNqQQ7YOB","data":[{"output_type":"stream","name":"stdout","text":"[[5.000e-01 2.000e+00 4.500e+00 8.000e+00 1.250e+01]\n [1.250e+03 8.000e+02 4.500e+02 2.000e+02 5.000e+01]\n [1.250e+01 3.125e+00 0.000e+00 3.125e+00 1.250e+01]]\n"}],"key":"jNu8hQ7H5q"}],"data":{},"key":"AzOpsLaySS"},{"type":"paragraph","position":{"start":{"line":356,"column":1},"end":{"line":356,"column":1}},"children":[{"type":"text","value":"To raise to a power elementwise, use a double star. This will broadcast as well.","position":{"start":{"line":356,"column":1},"end":{"line":356,"column":1}},"key":"GFcb1Yq4aA"}],"key":"aUqBOkQPJ6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(B)\nprint(B**3)","key":"ONhN7MNODn"},{"type":"output","id":"NjdDLOxZYipy7TrdrMrgt","data":[{"output_type":"stream","name":"stdout","text":"[[-1  0  0]\n [ 0  0  0]\n [ 0  0 -5]]\n[[  -1    0    0]\n [   0    0    0]\n [   0    0 -125]]\n"}],"key":"dJxKko0hwb"}],"data":{},"key":"hRmScIk4g0"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(x)\nprint(2.0**x)","key":"fXMN2ZExpi"},{"type":"output","id":"236UsK-qxJR3OFa6Pegxx","data":[{"output_type":"stream","name":"stdout","text":"[ 3  2  0  1 -1]\n[8.  4.  1.  2.  0.5]\n"}],"key":"iVwilmvbyI"}],"data":{},"key":"cMcMXyPLJv"},{"type":"admonition","kind":"danger","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Danger","key":"OV92R9xADd"}],"key":"YcmaybviAp"},{"type":"paragraph","position":{"start":{"line":369,"column":1},"end":{"line":369,"column":1}},"children":[{"type":"text","value":"If ","position":{"start":{"line":369,"column":1},"end":{"line":369,"column":1}},"key":"r9eQvO7D1W"},{"type":"inlineCode","value":"A","position":{"start":{"line":369,"column":1},"end":{"line":369,"column":1}},"key":"AivSINKCsC"},{"type":"text","value":" is a matrix, ","position":{"start":{"line":369,"column":1},"end":{"line":369,"column":1}},"key":"dNJsGTG8BH"},{"type":"inlineCode","value":"A**2","position":{"start":{"line":369,"column":1},"end":{"line":369,"column":1}},"key":"sH9llKz5vR"},{"type":"text","value":" is ","position":{"start":{"line":369,"column":1},"end":{"line":369,"column":1}},"key":"EUdq9knHEv"},{"type":"emphasis","position":{"start":{"line":369,"column":1},"end":{"line":369,"column":1}},"children":[{"type":"text","value":"not","position":{"start":{"line":369,"column":1},"end":{"line":369,"column":1}},"key":"bvIDixqAyU"}],"key":"OcBokFQh19"},{"type":"text","value":" the same as mathematically raising it to the power 2.","position":{"start":{"line":369,"column":1},"end":{"line":369,"column":1}},"key":"q5OUI5prRf"}],"key":"bN9zyGnKy2"}],"key":"YBcqiYTo2F"},{"type":"paragraph","position":{"start":{"line":376,"column":1},"end":{"line":376,"column":1}},"children":[{"type":"text","value":"Most of the mathematical functions, such as cos, sin, log, exp and sqrt, expecting scalars as operands will be broadcast to arrays.","position":{"start":{"line":376,"column":1},"end":{"line":376,"column":1}},"key":"IkBLfM86mW"}],"indexEntries":[{"entry":"Python","subEntry":{"value":"broadcasting","kind":"entry"},"emphasis":false}],"label":"index-LR1qZ7Apxz","identifier":"index-lr1qz7apxz","html_id":"index-lr1qz7apxz","key":"JGKp0n5IxJ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(cos(pi * x))","key":"r5BGz8Az5T"},{"type":"output","id":"WqkRQ2vZMD0LwaZXOqeSk","data":[{"output_type":"stream","name":"stdout","text":"[-1.  1.  1. -1. -1.]\n"}],"key":"ok9KIQU5Kw"}],"data":{},"key":"QHZs4Adr2d"}],"label":"demo-matrices-python","identifier":"demo-matrices-python","html_id":"demo-matrices-python","key":"SJMQKkBnhS"},{"type":"heading","depth":3,"position":{"start":{"line":383,"column":1},"end":{"line":383,"column":1}},"children":[{"type":"text","value":"Section 2.3","position":{"start":{"line":383,"column":1},"end":{"line":383,"column":1}},"key":"B6fkUMSbhf"}],"identifier":"section-2-3","label":"Section 2.3","html_id":"section-2-3","implicit":true,"key":"bIwAuCEVQx"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Solving linear systems","position":{"start":{"line":385,"column":1},"end":{"line":385,"column":1}},"key":"xq1wbEHfN7"}],"key":"x7uNkmJ9eU"},{"type":"paragraph","position":{"start":{"line":386,"column":1},"end":{"line":386,"column":1}},"children":[{"type":"text","value":"For a square matrix ","position":{"start":{"line":386,"column":1},"end":{"line":386,"column":1}},"key":"dGtiWc4ars"},{"type":"inlineMath","value":"A","position":{"start":{"line":386,"column":1},"end":{"line":386,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi></mrow><annotation encoding=\"application/x-tex\">A</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">A</span></span></span></span>","key":"f4eIMgLRY8"},{"type":"text","value":", the command ","position":{"start":{"line":386,"column":1},"end":{"line":386,"column":1}},"key":"Q7EgzaYmDC"},{"type":"inlineCode","value":"solve(A, B)","position":{"start":{"line":386,"column":1},"end":{"line":386,"column":1}},"key":"dvBUm1s71L"},{"type":"text","value":" is mathematically equivalent to ","position":{"start":{"line":386,"column":1},"end":{"line":386,"column":1}},"key":"y3myytOVMw"},{"type":"inlineMath","value":"\\mathbf{A}^{-1} \\mathbf{b}","position":{"start":{"line":386,"column":1},"end":{"line":386,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi mathvariant=\"bold\">A</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}^{-1} \\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">A</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"Fe8QNOgeio"},{"type":"text","value":".","position":{"start":{"line":386,"column":1},"end":{"line":386,"column":1}},"key":"tmtWFoZw7E"}],"key":"f82GjeiDZH"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"A = array([[1, 0, -1], [2, 2, 1], [-1, -3, 0]])\nb = array([1, 2, 3])","key":"kN6UQLxvkv"},{"type":"output","id":"MSyCrw9RrSC2szUtjgs8Y","data":[],"key":"mSkcOnXaHI"}],"data":{},"key":"NS0LkYR0qz"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"x = solve(A, b)\nprint(x)","key":"wdAtQRDe4r"},{"type":"output","id":"6j-gHtAWlo-MobIUUPUvl","data":[{"output_type":"stream","name":"stdout","text":"[ 2.14285714 -1.71428571  1.14285714]\n"}],"key":"b5FE4SPtbJ"}],"data":{},"key":"ZwBlQvRaiu"},{"type":"paragraph","position":{"start":{"line":401,"column":1},"end":{"line":401,"column":1}},"children":[{"type":"text","value":"One way to check the answer is to compute a quantity known as the ","position":{"start":{"line":401,"column":1},"end":{"line":401,"column":1}},"key":"UBW1uHn5B6"},{"type":"strong","position":{"start":{"line":401,"column":1},"end":{"line":401,"column":1}},"children":[{"type":"text","value":"residual","position":{"start":{"line":401,"column":1},"end":{"line":401,"column":1}},"key":"GEsD2Q4QCW"}],"key":"acE2P364Vf"},{"type":"text","value":". It is (ideally) close to machine precision(relative to the elements in the data).","position":{"start":{"line":401,"column":1},"end":{"line":401,"column":1}},"key":"GDXJRdUMv7"}],"indexEntries":[{"entry":"residual","emphasis":false}],"label":"index-grcY75xHFs","identifier":"index-grcy75xhfs","html_id":"index-grcy75xhfs","key":"upacjgWlYg"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"residual = b - A @ x\nprint(residual)","key":"bghnfXOg1c"},{"type":"output","id":"Geo0rtPZ6sT9sVJpWeRLw","data":[{"output_type":"stream","name":"stdout","text":"[-4.4408921e-16 -4.4408921e-16  0.0000000e+00]\n"}],"key":"ohXgi8tnOT"}],"data":{},"key":"DYXjXvA9Qr"},{"type":"paragraph","position":{"start":{"line":408,"column":1},"end":{"line":408,"column":1}},"children":[{"type":"text","value":"If the matrix ","position":{"start":{"line":408,"column":1},"end":{"line":408,"column":1}},"key":"nNW2r9RY2d"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":408,"column":1},"end":{"line":408,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"kgTrLu6y5U"},{"type":"text","value":" is singular, you may get an error.","position":{"start":{"line":408,"column":1},"end":{"line":408,"column":1}},"key":"DAW0JwQdBM"}],"key":"Y4AlKsVMyx"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"A = array([[0, 1], [0, 0]])\nb = array([1, -1])\nsolve(A, b)    # error, singular matrix","visibility":"show","key":"sHaUAFmUpR"},{"type":"output","id":"VRaXILSCX1Io3rq5bVfAz","data":[{"output_type":"error","traceback":"\u001b[0;31m---------------------------------------------------------------------------\u001b[0m\n\u001b[0;31mLinAlgError\u001b[0m                               Traceback (most recent call last)\nCell \u001b[0;32mIn[42], line 3\u001b[0m\n\u001b[1;32m      1\u001b[0m A \u001b[38;5;241m=\u001b[39m array([[\u001b[38;5;241m0\u001b[39m, \u001b[38;5;241m1\u001b[39m], [\u001b[38;5;241m0\u001b[39m, \u001b[38;5;241m0\u001b[39m]])\n\u001b[1;32m      2\u001b[0m b \u001b[38;5;241m=\u001b[39m array([\u001b[38;5;241m1\u001b[39m, \u001b[38;5;241m-\u001b[39m\u001b[38;5;241m1\u001b[39m])\n\u001b[0;32m----> 3\u001b[0m \u001b[43msolve\u001b[49m\u001b[43m(\u001b[49m\u001b[43mA\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mb\u001b[49m\u001b[43m)\u001b[49m    \u001b[38;5;66;03m# error, singular matrix\u001b[39;00m\n\nFile \u001b[0;32m~/mambaforge/envs/myst/lib/python3.13/site-packages/numpy/linalg/_linalg.py:413\u001b[0m, in \u001b[0;36msolve\u001b[0;34m(a, b)\u001b[0m\n\u001b[1;32m    410\u001b[0m signature \u001b[38;5;241m=\u001b[39m \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mDD->D\u001b[39m\u001b[38;5;124m'\u001b[39m \u001b[38;5;28;01mif\u001b[39;00m isComplexType(t) \u001b[38;5;28;01melse\u001b[39;00m \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mdd->d\u001b[39m\u001b[38;5;124m'\u001b[39m\n\u001b[1;32m    411\u001b[0m \u001b[38;5;28;01mwith\u001b[39;00m errstate(call\u001b[38;5;241m=\u001b[39m_raise_linalgerror_singular, invalid\u001b[38;5;241m=\u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mcall\u001b[39m\u001b[38;5;124m'\u001b[39m,\n\u001b[1;32m    412\u001b[0m               over\u001b[38;5;241m=\u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mignore\u001b[39m\u001b[38;5;124m'\u001b[39m, divide\u001b[38;5;241m=\u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mignore\u001b[39m\u001b[38;5;124m'\u001b[39m, under\u001b[38;5;241m=\u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mignore\u001b[39m\u001b[38;5;124m'\u001b[39m):\n\u001b[0;32m--> 413\u001b[0m     r \u001b[38;5;241m=\u001b[39m \u001b[43mgufunc\u001b[49m\u001b[43m(\u001b[49m\u001b[43ma\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mb\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43msignature\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43msignature\u001b[49m\u001b[43m)\u001b[49m\n\u001b[1;32m    415\u001b[0m \u001b[38;5;28;01mreturn\u001b[39;00m wrap(r\u001b[38;5;241m.\u001b[39mastype(result_t, copy\u001b[38;5;241m=\u001b[39m\u001b[38;5;28;01mFalse\u001b[39;00m))\n\nFile \u001b[0;32m~/mambaforge/envs/myst/lib/python3.13/site-packages/numpy/linalg/_linalg.py:104\u001b[0m, in \u001b[0;36m_raise_linalgerror_singular\u001b[0;34m(err, flag)\u001b[0m\n\u001b[1;32m    103\u001b[0m \u001b[38;5;28;01mdef\u001b[39;00m \u001b[38;5;21m_raise_linalgerror_singular\u001b[39m(err, flag):\n\u001b[0;32m--> 104\u001b[0m     \u001b[38;5;28;01mraise\u001b[39;00m LinAlgError(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mSingular matrix\u001b[39m\u001b[38;5;124m\"\u001b[39m)\n\n\u001b[0;31mLinAlgError\u001b[0m: Singular matrix","ename":"LinAlgError","evalue":"Singular matrix"}],"visibility":"show","key":"PX5byzoPmz"}],"data":{"tags":["raises-exception"]},"visibility":"show","key":"eCHyWjnpoE"},{"type":"paragraph","position":{"start":{"line":417,"column":1},"end":{"line":417,"column":1}},"children":[{"type":"text","value":"A linear system with a singular matrix might have no solution or infinitely many solutions, but in either case, a numerical solution becomes trickier. Detecting singularity is a lot like checking whether two floating-point numbers are ","position":{"start":{"line":417,"column":1},"end":{"line":417,"column":1}},"key":"PEjAyRanFJ"},{"type":"emphasis","position":{"start":{"line":417,"column":1},"end":{"line":417,"column":1}},"children":[{"type":"text","value":"exactly","position":{"start":{"line":417,"column":1},"end":{"line":417,"column":1}},"key":"ZnjCwFfb1Q"}],"key":"dk2rdVqQhN"},{"type":"text","value":" equal: because of roundoff, it could be missed. We’re headed toward a more robust way to fully describe this situation.","position":{"start":{"line":417,"column":1},"end":{"line":417,"column":1}},"key":"CuV0vSl8iD"}],"key":"gvEAW6CaVA"}],"label":"demo-systems-backslash-python","identifier":"demo-systems-backslash-python","html_id":"demo-systems-backslash-python","key":"dGm3EooAWD"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Triangular systems of equations","position":{"start":{"line":421,"column":1},"end":{"line":421,"column":1}},"key":"Y9If7l40MP"}],"key":"SQrCeHFCBY"},{"type":"paragraph","position":{"start":{"line":426,"column":1},"end":{"line":426,"column":1}},"children":[{"type":"text","value":"It’s easy to get just the lower triangular part of any matrix using the ","position":{"start":{"line":426,"column":1},"end":{"line":426,"column":1}},"key":"HF2i0eTI0D"},{"type":"inlineCode","value":"tril","position":{"start":{"line":426,"column":1},"end":{"line":426,"column":1}},"key":"OzECIWeONj"},{"type":"text","value":" function.","position":{"start":{"line":426,"column":1},"end":{"line":426,"column":1}},"key":"lzibDt8i2s"}],"indexEntries":[{"entry":"Python","subEntry":{"value":"tril","kind":"entry"},"emphasis":true},{"entry":"Python","subEntry":{"value":"triu","kind":"entry"},"emphasis":true}],"label":"index-BOnyYvqy5F","identifier":"index-bonyyvqy5f","html_id":"index-bonyyvqy5f","key":"RmpR4b96JB"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"A = 1 + floor(9 * random.rand(5, 5))\nL = tril(A)\nprint(L)","key":"w9U1wZFrO8"},{"type":"output","id":"vzgH6vwKRTFOY567_CoHl","data":[{"output_type":"stream","name":"stdout","text":"[[7. 0. 0. 0. 0.]\n [1. 7. 0. 0. 0.]\n [3. 5. 1. 0. 0.]\n [9. 2. 2. 3. 0.]\n [1. 3. 6. 8. 2.]]\n"}],"key":"FxogPNkZzb"}],"data":{},"key":"dpS22OPfsp"},{"type":"paragraph","position":{"start":{"line":434,"column":1},"end":{"line":434,"column":1}},"children":[{"type":"text","value":"We’ll set up and solve a linear system with this matrix.","position":{"start":{"line":434,"column":1},"end":{"line":434,"column":1}},"key":"VExVKDK1UG"}],"key":"vL1ClC342T"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"b = ones(5)\nx = FNC.forwardsub(L, b)\nprint(x)","key":"La6YemFUco"},{"type":"output","id":"Db4JuMuj1ipsVFNxWXjov","data":[{"output_type":"stream","name":"stdout","text":"[ 0.14285714  0.12244898 -0.04081633 -0.14965986  0.96598639]\n"}],"key":"i1Fn9NmOua"}],"data":{},"key":"LpN6Y3X2zM"},{"type":"paragraph","position":{"start":{"line":442,"column":1},"end":{"line":442,"column":1}},"children":[{"type":"text","value":"It’s not clear how accurate this answer is. However, the residual should be zero or comparable to ","position":{"start":{"line":442,"column":1},"end":{"line":442,"column":1}},"key":"xntZQtAGYT"},{"type":"inlineMath","value":"\\macheps","position":{"start":{"line":442,"column":1},"end":{"line":442,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>ϵ</mi><mtext>mach</mtext></msub></mrow><annotation encoding=\"application/x-tex\">\\macheps</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">ϵ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">mach</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"egtUpct453"},{"type":"text","value":".","position":{"start":{"line":442,"column":1},"end":{"line":442,"column":1}},"key":"UCk2D3duUh"}],"key":"L3oZeCPJk8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"b - L @ x","key":"e2bOzYkUFe"},{"type":"output","id":"fvYQWuz4wtZTSbNdraDDQ","data":[{"output_type":"execute_result","execution_count":45,"metadata":{},"data":{"text/plain":{"content":"array([0., 0., 0., 0., 0.])","content_type":"text/plain"}}}],"key":"ZZAzkkzuJt"}],"data":{},"key":"NNODcq2Ao1"},{"type":"paragraph","position":{"start":{"line":448,"column":1},"end":{"line":448,"column":1}},"children":[{"type":"text","value":"Next we’ll engineer a problem to which we know the exact answer.","position":{"start":{"line":448,"column":1},"end":{"line":448,"column":1}},"key":"g9TCcMnZYm"}],"key":"F98Kfa3ugT"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"alpha = 0.3;\nbeta = 2.2;\nU = diag(ones(5)) + diag([-1, -1, -1, -1], k=1)\nU[0, 3:5] = [ alpha - beta, beta ]\nprint(U)","key":"CgVFmHtlTh"},{"type":"output","id":"hLoTpZnsHZ1lINfgfwYcw","data":[{"output_type":"stream","name":"stdout","text":"[[ 1.  -1.   0.  -1.9  2.2]\n [ 0.   1.  -1.   0.   0. ]\n [ 0.   0.   1.  -1.   0. ]\n [ 0.   0.   0.   1.  -1. ]\n [ 0.   0.   0.   0.   1. ]]\n"}],"key":"UgZu4S38Nn"}],"data":{},"key":"Z7D43RvhXj"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"x_exact = ones(5)\nb = array([alpha, 0, 0, 0, 1])\nx = FNC.backsub(U, b)\nprint(\"error:\", x - x_exact)","key":"P9xIUEk96S"},{"type":"output","id":"2xagF3EoGhf3isc2224dv","data":[{"output_type":"stream","name":"stdout","text":"error: [2.22044605e-16 0.00000000e+00 0.00000000e+00 0.00000000e+00\n 0.00000000e+00]\n"}],"key":"k0DvSKOanA"}],"data":{},"key":"zPBIXOJuod"},{"type":"paragraph","position":{"start":{"line":465,"column":1},"end":{"line":465,"column":1}},"children":[{"type":"text","value":"Everything seems OK here. But another example, with a different value for ","position":{"start":{"line":465,"column":1},"end":{"line":465,"column":1}},"key":"mYoWMySQnt"},{"type":"text","value":"β","position":{"start":{"line":465,"column":1},"end":{"line":465,"column":1}},"key":"JzQhElDiGh"},{"type":"text","value":", is more troubling.","position":{"start":{"line":465,"column":1},"end":{"line":465,"column":1}},"key":"jDSEa25pbG"}],"key":"xYjHnrlIlS"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"alpha = 0.3;\nbeta = 1e12;\nU = diag(ones(5)) + diag([-1, -1, -1, -1], k=1)\nU[0, 3:5] = [ alpha - beta, beta ]\nb = array([alpha, 0, 0, 0, 1])\n\nx = FNC.backsub(U, b)\nprint(\"error:\", x - x_exact)","key":"owwTUvnPaG"},{"type":"output","id":"MirfiJ1t3IGuBsndzmOx3","data":[{"output_type":"stream","name":"stdout","text":"error: [-4.8828125e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00\n  0.0000000e+00]\n"}],"key":"sD1K9EvPgT"}],"data":{},"key":"yviO5xJxsT"},{"type":"paragraph","position":{"start":{"line":478,"column":1},"end":{"line":478,"column":1}},"children":[{"type":"text","value":"It’s not so good to get 4 digits of accuracy after starting with sixteen! But the source of the error is not hard to track down. Solving for ","position":{"start":{"line":478,"column":1},"end":{"line":478,"column":1}},"key":"jh45avyF5G"},{"type":"inlineMath","value":"x_1","position":{"start":{"line":478,"column":1},"end":{"line":478,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">x_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"NqwVvi9TJI"},{"type":"text","value":" performs ","position":{"start":{"line":478,"column":1},"end":{"line":478,"column":1}},"key":"T3CHNDfk9G"},{"type":"inlineMath","value":"(\\alpha-\\beta)+\\beta","position":{"start":{"line":478,"column":1},"end":{"line":478,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>α</mi><mo>−</mo><mi>β</mi><mo stretchy=\"false\">)</mo><mo>+</mo><mi>β</mi></mrow><annotation encoding=\"application/x-tex\">(\\alpha-\\beta)+\\beta</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05278em;\">β</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05278em;\">β</span></span></span></span>","key":"mDhcDbv1XR"},{"type":"text","value":" in the first row. Since ","position":{"start":{"line":478,"column":1},"end":{"line":478,"column":1}},"key":"QiTVzQObwS"},{"type":"inlineMath","value":"|\\alpha|","position":{"start":{"line":478,"column":1},"end":{"line":478,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">∣</mi><mi>α</mi><mi mathvariant=\"normal\">∣</mi></mrow><annotation encoding=\"application/x-tex\">|\\alpha|</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">∣</span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span><span class=\"mord\">∣</span></span></span></span>","key":"hx20PwLwCC"},{"type":"text","value":" is so much smaller than ","position":{"start":{"line":478,"column":1},"end":{"line":478,"column":1}},"key":"HsI2bcsBV9"},{"type":"inlineMath","value":"|\\beta|","position":{"start":{"line":478,"column":1},"end":{"line":478,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">∣</mi><mi>β</mi><mi mathvariant=\"normal\">∣</mi></mrow><annotation encoding=\"application/x-tex\">|\\beta|</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">∣</span><span class=\"mord mathnormal\" style=\"margin-right:0.05278em;\">β</span><span class=\"mord\">∣</span></span></span></span>","key":"ia5eiVJ3Nc"},{"type":"text","value":", this a recipe for losing digits to subtractive cancellation.","position":{"start":{"line":478,"column":1},"end":{"line":478,"column":1}},"key":"vPFe5FQYPb"}],"key":"ShgoJXyMkG"}],"label":"demo-systems-triangular-python","identifier":"demo-systems-triangular-python","html_id":"demo-systems-triangular-python","key":"DbH8j72bvx"},{"type":"heading","depth":3,"position":{"start":{"line":481,"column":1},"end":{"line":481,"column":1}},"children":[{"type":"text","value":"Section 2.4","position":{"start":{"line":481,"column":1},"end":{"line":481,"column":1}},"key":"HKpmg4gb1P"}],"identifier":"section-2-4","label":"Section 2.4","html_id":"section-2-4","implicit":true,"key":"OIzK1n7yux"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Triangular outer products","position":{"start":{"line":483,"column":1},"end":{"line":483,"column":1}},"key":"m251ymP6pr"}],"key":"ix9VU6rvtW"},{"type":"paragraph","position":{"start":{"line":486,"column":1},"end":{"line":486,"column":1}},"children":[{"type":"text","value":"We explore the outer product formula for two random triangular matrices.","position":{"start":{"line":486,"column":1},"end":{"line":486,"column":1}},"key":"GvcD4BifLJ"}],"indexEntries":[{"entry":"Python","subEntry":{"value":"tril","kind":"entry"},"emphasis":false},{"entry":"Python","subEntry":{"value":"triu","kind":"entry"},"emphasis":false}],"label":"index-kcBdwW1y9A","identifier":"index-kcbdww1y9a","html_id":"index-kcbdww1y9a","key":"HPEVG3j3im"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from numpy.random import randint\nL = tril(randint(1, 10, size=(3, 3)))\nprint(L)","key":"tlTquaYlhK"},{"type":"output","id":"s3R8sdC-P2tyohMJTMLyY","data":[{"output_type":"stream","name":"stdout","text":"[[7 0 0]\n [2 2 0]\n [8 3 3]]\n"}],"key":"PzMYFAec9K"}],"data":{},"key":"W38GLcRjkM"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"U = triu(randint(1, 10, size=(3, 3)))\nprint(U)","key":"v98eQ80Z08"},{"type":"output","id":"122uwjXmFhFxj1PaY77kM","data":[{"output_type":"stream","name":"stdout","text":"[[3 2 4]\n [0 6 2]\n [0 0 8]]\n"}],"key":"gCNtETefu4"}],"data":{},"key":"TNWrYJv3Wr"},{"type":"paragraph","position":{"start":{"line":499,"column":1},"end":{"line":499,"column":1}},"children":[{"type":"text","value":"Here are the three outer products appearing in the sum in ","position":{"start":{"line":499,"column":1},"end":{"line":499,"column":1}},"key":"YOFWcxu8mg"},{"type":"crossReference","kind":"equation","identifier":"matrixouter","label":"matrixouter","children":[{"type":"text","value":"(","key":"jCHp59pWQj"},{"type":"text","value":"2.4.4","key":"IfFN3vZ9mG"},{"type":"text","value":")","key":"cqAOmgwpkG"}],"template":"(%s)","enumerator":"2.4.4","resolved":true,"html_id":"matrixouter","remote":true,"url":"/lu","dataUrl":"/lu.json","key":"l8W6M36cm8"},{"type":"text","value":":","position":{"start":{"line":499,"column":1},"end":{"line":499,"column":1}},"key":"LwrVcRWABu"}],"key":"tPU3YlSY6f"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(outer(L[:, 0], U[0, :]))","key":"gRVnfwv2zw"},{"type":"output","id":"8z7rCGwqOGEPrhO8W1ylC","data":[{"output_type":"stream","name":"stdout","text":"[[21 14 28]\n [ 6  4  8]\n [24 16 32]]\n"}],"key":"Iz3A2Q8Y1Y"}],"data":{},"key":"keJGTRrWF1"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(outer(L[:, 1], U[1, :]))","key":"nZnQDWU7tS"},{"type":"output","id":"3CKCg2YAd2VmTRyuF8Q88","data":[{"output_type":"stream","name":"stdout","text":"[[ 0  0  0]\n [ 0 12  4]\n [ 0 18  6]]\n"}],"key":"l4K7KNG8dw"}],"data":{},"key":"XmmwzMyGhp"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(outer(L[:, 2], U[2, :]))","key":"O1DaEmFmTn"},{"type":"output","id":"W_BQp8JIam5lcCq_lVD4V","data":[{"output_type":"stream","name":"stdout","text":"[[ 0  0  0]\n [ 0  0  0]\n [ 0  0 24]]\n"}],"key":"zMrn2QnOv4"}],"data":{},"key":"tB2Uhr0uhQ"},{"type":"paragraph","position":{"start":{"line":513,"column":1},"end":{"line":513,"column":1}},"children":[{"type":"text","value":"Simply because of the triangular zero structures, only the first outer product contributes to the first row and first column of the entire product.","position":{"start":{"line":513,"column":1},"end":{"line":513,"column":1}},"key":"K6iVkFiX2r"}],"key":"FyT5yAlBZR"}],"label":"demo-lu-outertri-python","identifier":"demo-lu-outertri-python","html_id":"demo-lu-outertri-python","key":"CsN6oiVyWC"},{"type":"details","children":[{"type":"summary","children":[{"type":"abbreviation","title":"lower triangular times upper triangular","children":[{"type":"text","value":"LU","key":"Z5YzfcvHoS"}],"key":"WCgs0TYd5r"},{"type":"text","value":" factorization","key":"fozLC5mqNe"}],"key":"ezJTyt3BxK"},{"type":"paragraph","position":{"start":{"line":519,"column":1},"end":{"line":519,"column":1}},"children":[{"type":"text","value":"For illustration, we work on a ","position":{"start":{"line":519,"column":1},"end":{"line":519,"column":1}},"key":"mY6f2JEeZe"},{"type":"inlineMath","value":"4 \\times 4","position":{"start":{"line":519,"column":1},"end":{"line":519,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>4</mn><mo>×</mo><mn>4</mn></mrow><annotation encoding=\"application/x-tex\">4 \\times 4</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">4</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">4</span></span></span></span>","key":"UycjCwCdYO"},{"type":"text","value":" matrix. We name it with a subscript in preparation for what comes.","position":{"start":{"line":519,"column":1},"end":{"line":519,"column":1}},"key":"JjeJSPjQHV"}],"key":"PxIHp89kwi"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"A_1 = array([\n     [2,    0,    4,    3], \n     [-4,    5,   -7,  -10], \n     [1,   15,    2,   -4.5],\n     [-2,    0,    2,  -13]\n        ])\nL = eye(4)\nU = zeros((4, 4));","key":"DOs2rr2ZaO"},{"type":"output","id":"0Mrt7NmvSFtlX0lEEqHaH","data":[],"key":"nCGXZHhsox"}],"data":{},"key":"Y12PBAKifY"},{"type":"paragraph","position":{"start":{"line":532,"column":1},"end":{"line":532,"column":1}},"children":[{"type":"text","value":"Now we appeal to ","position":{"start":{"line":532,"column":1},"end":{"line":532,"column":1}},"key":"JuJFKAGlKi"},{"type":"crossReference","kind":"equation","identifier":"outer-row1","label":"outer-row1","children":[{"type":"text","value":"(","key":"dhQia9E6Od"},{"type":"text","value":"2.4.5","key":"aLLCnzkNAD"},{"type":"text","value":")","key":"PSfwX6WfAV"}],"template":"(%s)","enumerator":"2.4.5","resolved":true,"html_id":"outer-row1","remote":true,"url":"/lu","dataUrl":"/lu.json","key":"Cx9H2AyDNj"},{"type":"text","value":". Since ","position":{"start":{"line":532,"column":1},"end":{"line":532,"column":1}},"key":"V7cnOaRGrJ"},{"type":"inlineMath","value":"L_{11}=1","position":{"start":{"line":532,"column":1},"end":{"line":532,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>L</mi><mn>11</mn></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">L_{11}=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">L</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">11</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"dorzHgLRXO"},{"type":"text","value":", we see that the first row of ","position":{"start":{"line":532,"column":1},"end":{"line":532,"column":1}},"key":"EWU5mYYTc1"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":532,"column":1},"end":{"line":532,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"pBb1Ej15On"},{"type":"text","value":" is just the first row of ","position":{"start":{"line":532,"column":1},"end":{"line":532,"column":1}},"key":"n2WazmPXrw"},{"type":"inlineMath","value":"\\mathbf{A}_1","position":{"start":{"line":532,"column":1},"end":{"line":532,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">A</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8361em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"zNL2okzCvM"},{"type":"text","value":".","position":{"start":{"line":532,"column":1},"end":{"line":532,"column":1}},"key":"W1Bead7MLn"}],"key":"oIFG0oUQGY"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"U[0, :] = A_1[0, :]\nprint(U)","key":"nkbr2X7HhG"},{"type":"output","id":"H7otW-AswqNYGVfMBvaYf","data":[{"output_type":"stream","name":"stdout","text":"[[2. 0. 4. 3.]\n [0. 0. 0. 0.]\n [0. 0. 0. 0.]\n [0. 0. 0. 0.]]\n"}],"key":"j1uvLg0RkH"}],"data":{},"key":"z05MksyYti"},{"type":"paragraph","position":{"start":{"line":539,"column":1},"end":{"line":539,"column":1}},"children":[{"type":"text","value":"From ","position":{"start":{"line":539,"column":1},"end":{"line":539,"column":1}},"key":"kqQNUh9JV2"},{"type":"crossReference","kind":"equation","identifier":"outer-col1","label":"outer-col1","children":[{"type":"text","value":"(","key":"FP5Jha8sz3"},{"type":"text","value":"2.4.6","key":"XANz9cQtLG"},{"type":"text","value":")","key":"nlV7hE6JMY"}],"template":"(%s)","enumerator":"2.4.6","resolved":true,"html_id":"outer-col1","remote":true,"url":"/lu","dataUrl":"/lu.json","key":"SJE3ZwydtL"},{"type":"text","value":", we see that we can find the first column of ","position":{"start":{"line":539,"column":1},"end":{"line":539,"column":1}},"key":"bnuqizXwLF"},{"type":"inlineMath","value":"\\mathbf{L}","position":{"start":{"line":539,"column":1},"end":{"line":539,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">L</span></span></span></span>","key":"jqEBg5YHpa"},{"type":"text","value":" from the first column of ","position":{"start":{"line":539,"column":1},"end":{"line":539,"column":1}},"key":"zfUP8zqHuP"},{"type":"inlineMath","value":"\\mathbf{A}_1","position":{"start":{"line":539,"column":1},"end":{"line":539,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">A</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8361em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"tl1mAAuCn9"},{"type":"text","value":".","position":{"start":{"line":539,"column":1},"end":{"line":539,"column":1}},"key":"uZ0gnsaH95"}],"key":"EwRYNJEdR2"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"L[:, 0] = A_1[:, 0] / U[0, 0]\nprint(L)","key":"mpULesDHqd"},{"type":"output","id":"4aLiPic0yzqxh_ID5vBY7","data":[{"output_type":"stream","name":"stdout","text":"[[ 1.   0.   0.   0. ]\n [-2.   1.   0.   0. ]\n [ 0.5  0.   1.   0. ]\n [-1.   0.   0.   1. ]]\n"}],"key":"P4QgjxDS9P"}],"data":{},"key":"fKePvd9UdF"},{"type":"paragraph","position":{"start":{"line":546,"column":1},"end":{"line":546,"column":1}},"children":[{"type":"text","value":"We have obtained the first term in the sum ","position":{"start":{"line":546,"column":1},"end":{"line":546,"column":1}},"key":"FXDU3RWkTc"},{"type":"crossReference","kind":"equation","identifier":"matrixouter","label":"matrixouter","children":[{"type":"text","value":"(","key":"BkUHtcRk50"},{"type":"text","value":"2.4.4","key":"e1XBlbgueW"},{"type":"text","value":")","key":"qkXZ9avMeM"}],"template":"(%s)","enumerator":"2.4.4","resolved":true,"html_id":"matrixouter","remote":true,"url":"/lu","dataUrl":"/lu.json","key":"igsBNbkZN2"},{"type":"text","value":" for ","position":{"start":{"line":546,"column":1},"end":{"line":546,"column":1}},"key":"cmOdqXtMPB"},{"type":"inlineMath","value":"\\mathbf{L}\\mathbf{U}","position":{"start":{"line":546,"column":1},"end":{"line":546,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">LU</span></span></span></span>","key":"PE11bExAu9"},{"type":"text","value":", and we subtract it away from ","position":{"start":{"line":546,"column":1},"end":{"line":546,"column":1}},"key":"jsctAfivYb"},{"type":"inlineMath","value":"\\mathbf{A}_1","position":{"start":{"line":546,"column":1},"end":{"line":546,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">A</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8361em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"pPtPt7eVFu"},{"type":"text","value":".","position":{"start":{"line":546,"column":1},"end":{"line":546,"column":1}},"key":"zI2yOwMU1b"}],"key":"XaWr9p28gh"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"A_2 = A_1 - outer(L[:, 0],  U[0, :])","key":"QdWAI27a1u"},{"type":"output","id":"OdL3EgZuJ2H9nbiPdLctF","data":[],"key":"Oa2ci9MvMO"}],"data":{},"key":"DoUg02SRCF"},{"type":"paragraph","position":{"start":{"line":552,"column":1},"end":{"line":552,"column":1}},"children":[{"type":"text","value":"Now ","position":{"start":{"line":552,"column":1},"end":{"line":552,"column":1}},"key":"BYrWhKolrc"},{"type":"inlineMath","value":"\\mathbf{A}_2 = \\boldsymbol{\\ell}_2\\mathbf{u}_2^T + \\boldsymbol{\\ell}_3\\mathbf{u}_3^T + \\boldsymbol{\\ell}_4\\mathbf{u}_4^T.","position":{"start":{"line":552,"column":1},"end":{"line":552,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">A</mi><mn>2</mn></msub><mo>=</mo><msub><mi mathvariant=\"bold\">ℓ</mi><mn>2</mn></msub><msubsup><mi mathvariant=\"bold\">u</mi><mn>2</mn><mi>T</mi></msubsup><mo>+</mo><msub><mi mathvariant=\"bold\">ℓ</mi><mn>3</mn></msub><msubsup><mi mathvariant=\"bold\">u</mi><mn>3</mn><mi>T</mi></msubsup><mo>+</mo><msub><mi mathvariant=\"bold\">ℓ</mi><mn>4</mn></msub><msubsup><mi mathvariant=\"bold\">u</mi><mn>4</mn><mi>T</mi></msubsup><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}_2 = \\boldsymbol{\\ell}_2\\mathbf{u}_2^T + \\boldsymbol{\\ell}_3\\mathbf{u}_3^T + \\boldsymbol{\\ell}_4\\mathbf{u}_4^T.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8361em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0894em;vertical-align:-0.2481em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">ℓ</span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathbf\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-2.4519em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2481em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0894em;vertical-align:-0.2481em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">ℓ</span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathbf\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-2.4519em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2481em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0894em;vertical-align:-0.2481em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">ℓ</span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">4</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathbf\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-2.4519em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">4</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2481em;\"><span></span></span></span></span></span></span><span class=\"mord\">.</span></span></span></span>","key":"aQQzdkbhkg"},{"type":"text","value":" If we ignore the first row and first column of the matrices in this equation, then in what remains we are in the same situation as at the start. Specifically, only ","position":{"start":{"line":552,"column":1},"end":{"line":552,"column":1}},"key":"sadrRq1R6r"},{"type":"inlineMath","value":"\\boldsymbol{\\ell}_2\\mathbf{u}_2^T","position":{"start":{"line":552,"column":1},"end":{"line":552,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">ℓ</mi><mn>2</mn></msub><msubsup><mi mathvariant=\"bold\">u</mi><mn>2</mn><mi>T</mi></msubsup></mrow><annotation encoding=\"application/x-tex\">\\boldsymbol{\\ell}_2\\mathbf{u}_2^T</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0894em;vertical-align:-0.2481em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">ℓ</span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathbf\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-2.4519em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2481em;\"><span></span></span></span></span></span></span></span></span></span>","key":"n8cHJvMdsb"},{"type":"text","value":" has any effect on the second row and column, so we can deduce them now.","position":{"start":{"line":552,"column":1},"end":{"line":552,"column":1}},"key":"Cee5F684NI"}],"key":"bc1HBloLuq"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"U[1, :] = A_2[1, :]\nL[:, 1] = A_2[:, 1] / U[1, 1]\nprint(L)","key":"YLgiboKmVC"},{"type":"output","id":"Xr6gP1lZ7v6GBr2r7gVqj","data":[{"output_type":"stream","name":"stdout","text":"[[ 1.   0.   0.   0. ]\n [-2.   1.   0.   0. ]\n [ 0.5  3.   1.   0. ]\n [-1.   0.   0.   1. ]]\n"}],"key":"BJL1rxNMRL"}],"data":{},"key":"heBv7wHnvT"},{"type":"paragraph","position":{"start":{"line":559,"column":1},"end":{"line":559,"column":1}},"children":[{"type":"text","value":"If we subtract off the latest outer product, we have a matrix that is zero in the first ","position":{"start":{"line":559,"column":1},"end":{"line":559,"column":1}},"key":"SXeYkHePPD"},{"type":"emphasis","position":{"start":{"line":559,"column":1},"end":{"line":559,"column":1}},"children":[{"type":"text","value":"two","position":{"start":{"line":559,"column":1},"end":{"line":559,"column":1}},"key":"lpyRbOaREq"}],"key":"MprtCOIGoH"},{"type":"text","value":" rows and columns.","position":{"start":{"line":559,"column":1},"end":{"line":559,"column":1}},"key":"JnGwtwT1K4"}],"key":"aBoS8Jxd33"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"A_3 = A_2 - outer(L[:, 1], U[1, :])","key":"mEkfR4NFqS"},{"type":"output","id":"XhTw4dZmtqXpQLM8iD9Qk","data":[],"key":"PGJshw8qCT"}],"data":{},"key":"SyN24aVImI"},{"type":"paragraph","position":{"start":{"line":565,"column":1},"end":{"line":565,"column":1}},"children":[{"type":"text","value":"Now we can deal with the lower right ","position":{"start":{"line":565,"column":1},"end":{"line":565,"column":1}},"key":"U1ICxnxdGw"},{"type":"inlineMath","value":"2\\times 2","position":{"start":{"line":565,"column":1},"end":{"line":565,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>2</mn><mo>×</mo><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">2\\times 2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">2</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span></span></span></span>","key":"wumGTsLMiH"},{"type":"text","value":" submatrix of the remainder in a similar fashion.","position":{"start":{"line":565,"column":1},"end":{"line":565,"column":1}},"key":"P2H0hDpPub"}],"key":"fzpPJNvqJ7"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"U[2, :] = A_3[2, :]\nL[:, 2] = A_3[:, 2] / U[2, 2]\nA_4 = A_3 - outer(L[:, 2], U[2, :])","key":"zW7pKDZu44"},{"type":"output","id":"WXcfl_miy9XQ5IITuJMg1","data":[],"key":"o6oS7pLE0t"}],"data":{},"key":"WcVFhhTta4"},{"type":"paragraph","position":{"start":{"line":573,"column":1},"end":{"line":573,"column":1}},"children":[{"type":"text","value":"Finally, we pick up the last unknown in the factors.","position":{"start":{"line":573,"column":1},"end":{"line":573,"column":1}},"key":"iSC6KCWCKD"}],"key":"V4BP5qWVGa"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"U[3, 3] = A_4[3, 3]","key":"HcCT9PiE4S"},{"type":"output","id":"MfEpzZDRJlXmAyR7HOJVZ","data":[],"key":"CeoSZKgjKx"}],"data":{},"key":"tWxIeD1tu9"},{"type":"paragraph","position":{"start":{"line":579,"column":1},"end":{"line":579,"column":1}},"children":[{"type":"text","value":"We now have all of ","position":{"start":{"line":579,"column":1},"end":{"line":579,"column":1}},"key":"BX0JIbVlE1"},{"type":"inlineMath","value":"\\mathbf{L}","position":{"start":{"line":579,"column":1},"end":{"line":579,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">L</span></span></span></span>","key":"XbIDO3qR8e"},{"type":"text","value":",","position":{"start":{"line":579,"column":1},"end":{"line":579,"column":1}},"key":"gMQKhUtnrz"}],"key":"jIjocAZhuD"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(L)","key":"ogLhTZrID4"},{"type":"output","id":"-57EnLrTrb07-maTRD_EW","data":[{"output_type":"stream","name":"stdout","text":"[[ 1.   0.  -0.   0. ]\n [-2.   1.  -0.   0. ]\n [ 0.5  3.   1.   0. ]\n [-1.   0.  -2.   1. ]]\n"}],"key":"SKH7q9tqjq"}],"data":{},"key":"QYn8MxmVk5"},{"type":"paragraph","position":{"start":{"line":585,"column":1},"end":{"line":585,"column":1}},"children":[{"type":"text","value":"and all of ","position":{"start":{"line":585,"column":1},"end":{"line":585,"column":1}},"key":"vpqYVT1j7i"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":585,"column":1},"end":{"line":585,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"gW4quTcbKd"},{"type":"text","value":",","position":{"start":{"line":585,"column":1},"end":{"line":585,"column":1}},"key":"jPKdTWSg2G"}],"key":"LvoyrmUpjn"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(U)","key":"BDsKCWQwZ1"},{"type":"output","id":"zmptGjXJwlYVwqnfcl7pE","data":[{"output_type":"stream","name":"stdout","text":"[[ 2.  0.  4.  3.]\n [ 0.  5.  1. -4.]\n [ 0.  0. -3.  6.]\n [ 0.  0.  0.  2.]]\n"}],"key":"UZT1cSrgVI"}],"data":{},"key":"RCeQFyRSM2"},{"type":"paragraph","position":{"start":{"line":591,"column":1},"end":{"line":591,"column":1}},"children":[{"type":"text","value":"We can verify that we have a correct factorization of the original matrix by computing the backward error:","position":{"start":{"line":591,"column":1},"end":{"line":591,"column":1}},"key":"fdpyvxlFPC"}],"key":"MCM4J5hpn6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"A_1 - L @ U","key":"YrcElvc0VG"},{"type":"output","id":"fNvoF5IzSm5Ngs8jnvICJ","data":[{"output_type":"execute_result","execution_count":64,"metadata":{},"data":{"text/plain":{"content":"array([[0., 0., 0., 0.],\n       [0., 0., 0., 0.],\n       [0., 0., 0., 0.],\n       [0., 0., 0., 0.]])","content_type":"text/plain"}}}],"key":"IgJ7zS59RJ"}],"data":{},"key":"cvZ6BVADtb"},{"type":"paragraph","position":{"start":{"line":597,"column":1},"end":{"line":597,"column":1}},"children":[{"type":"text","value":"In floating point, we cannot expect the difference to be exactly zero as we found in this toy example. Instead, we would be satisfied to see that each element of the difference above is comparable in size to machine precision.","position":{"start":{"line":597,"column":1},"end":{"line":597,"column":1}},"key":"KJXoWkTSaI"}],"key":"BjyGj21l7d"}],"label":"demo-lu-derive-python","identifier":"demo-lu-derive-python","html_id":"demo-lu-derive-python","key":"C76LzZSzKI"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Solving a linear system by ","key":"oKPWc4klcF"},{"type":"abbreviation","title":"lower triangular times upper triangular","children":[{"type":"text","value":"LU","key":"GSTwfL5rnw"}],"key":"F7rKuFL6vp"},{"type":"text","value":" factors","key":"t5xudUj3rO"}],"key":"TcMLYfr4rX"},{"type":"paragraph","position":{"start":{"line":603,"column":1},"end":{"line":603,"column":1}},"children":[{"type":"text","value":"Here are the data for a linear system ","position":{"start":{"line":603,"column":1},"end":{"line":603,"column":1}},"key":"AC2SDI8O37"},{"type":"inlineMath","value":"\\mathbf{A}\\mathbf{x}=\\mathbf{b}","position":{"start":{"line":603,"column":1},"end":{"line":603,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi><mi mathvariant=\"bold\">x</mi><mo>=</mo><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}\\mathbf{x}=\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">Ax</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"rCNLLgbGaK"},{"type":"text","value":".","position":{"start":{"line":603,"column":1},"end":{"line":603,"column":1}},"key":"Iyum0p8Rvv"}],"key":"x6R9hDx8UO"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"A = array([\n    [2, 0, 4, 3], \n    [-4, 5, -7, -10], \n    [1, 15, 2, -4.5],\n    [-2, 0, 2, -13]\n    ])\nb = array([4, 9, 9, 4])","key":"s45sUFRlIf"},{"type":"output","id":"lZkMfXmwPtleQ7kN4fBzZ","data":[],"key":"UhhEBM7qmL"}],"data":{},"key":"o68MrY0MXZ"},{"type":"paragraph","position":{"start":{"line":615,"column":1},"end":{"line":615,"column":1}},"children":[{"type":"text","value":"We apply ","position":{"start":{"line":615,"column":1},"end":{"line":615,"column":1}},"key":"g2aRbzbu9P"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-lufact","label":"function-lufact","children":[{"type":"text","value":"Function ","key":"AdIhlApui3"},{"type":"text","value":"2.4.1","key":"ZKdlobQQar"}],"template":"Algorithm %s","enumerator":"2.4.1","resolved":true,"html_id":"function-lufact","remote":true,"url":"/lu","dataUrl":"/lu.json","key":"vbrZtpZzFY"},{"type":"text","value":" and then do two triangular solves.","position":{"start":{"line":615,"column":1},"end":{"line":615,"column":1}},"key":"zDzVXON159"}],"key":"FiF3XXLXEI"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"L, U = FNC.lufact(A)\nz = FNC.forwardsub(L, b)\nx = FNC.backsub(U, z)","key":"zGnw7ovi10"},{"type":"output","id":"4nt0uXC9XOZFCWM4N5H-5","data":[],"key":"WYyru4B1p1"}],"data":{},"key":"b2zbq8T1gU"},{"type":"paragraph","position":{"start":{"line":623,"column":1},"end":{"line":623,"column":1}},"children":[{"type":"text","value":"A check on the residual assures us that we found the solution.","position":{"start":{"line":623,"column":1},"end":{"line":623,"column":1}},"key":"hZR4A4SYUr"}],"key":"tdUHjrbcjH"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"b - A @ x","key":"sG7y4fSRIM"},{"type":"output","id":"zdIXQx5YFY8Cnj-Kzq4KD","data":[{"output_type":"execute_result","execution_count":67,"metadata":{},"data":{"text/plain":{"content":"array([0.00000000e+00, 0.00000000e+00, 2.84217094e-14, 0.00000000e+00])","content_type":"text/plain"}}}],"key":"YduWOMtnZF"}],"data":{},"key":"AEH92N3Ljv"}],"label":"demo-lu-solve-python","identifier":"demo-lu-solve-python","html_id":"demo-lu-solve-python","key":"wA23tPs5FF"},{"type":"heading","depth":3,"position":{"start":{"line":631,"column":1},"end":{"line":631,"column":1}},"children":[{"type":"text","value":"Section 2.5","position":{"start":{"line":631,"column":1},"end":{"line":631,"column":1}},"key":"Q6HlHB5Dpj"}],"identifier":"section-2-5","label":"Section 2.5","html_id":"section-2-5","implicit":true,"key":"YT12ISog49"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Floating-point operations in matrix-vector multiplication","position":{"start":{"line":634,"column":1},"end":{"line":634,"column":1}},"key":"ZIBsrLpRB5"}],"key":"I3ChkJTohz"},{"type":"paragraph","position":{"start":{"line":636,"column":1},"end":{"line":636,"column":1}},"children":[{"type":"text","value":"Here is a straightforward implementation of matrix-vector multiplication.","position":{"start":{"line":636,"column":1},"end":{"line":636,"column":1}},"key":"C1I6wKBfOc"}],"key":"zlIQiFBYzf"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"n = 6\nA = random.rand(n, n)\nx = ones(n)\ny = zeros(n)\nfor i in range(n):\n    for j in range(n):\n        y[i] += A[i, j] * x[j]   # 2 flops","key":"RYdWHptFRT"},{"type":"output","id":"Y2aQSvJADgx-PPc1Bhhtd","data":[],"key":"kvexXCk5fM"}],"data":{},"key":"vD1VYD5FFw"},{"type":"paragraph","position":{"start":{"line":648,"column":1},"end":{"line":648,"column":1}},"children":[{"type":"text","value":"Each of the loops implies a summation of flops. The total flop count for this algorithm is","position":{"start":{"line":648,"column":1},"end":{"line":648,"column":1}},"key":"aWCl2xBI9F"}],"key":"NVKKfqObpp"},{"type":"math","value":"\\sum_{i=1}^n \\sum_{j=1}^n 2 = \\sum_{i=1}^n 2n = 2n^2.","position":{"start":{"line":650,"column":1},"end":{"line":652,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mn>2</mn><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mn>2</mn><mi>n</mi><mo>=</mo><mn>2</mn><msup><mi>n</mi><mn>2</mn></msup><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">\\sum_{i=1}^n \\sum_{j=1}^n 2 = \\sum_{i=1}^n 2n = 2n^2.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:3.0652em;vertical-align:-1.4138em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.6514em;\"><span style=\"top:-1.8723em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span><span style=\"top:-4.3em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.2777em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.6514em;\"><span style=\"top:-1.8723em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span><span style=\"top:-4.3em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.4138em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">2</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.9291em;vertical-align:-1.2777em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.6514em;\"><span style=\"top:-1.8723em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span><span style=\"top:-4.3em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.2777em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">2</span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8641em;\"></span><span class=\"mord\">2</span><span class=\"mord\"><span class=\"mord mathnormal\">n</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mord\">.</span></span></span></span></span>","enumerator":"1","key":"UUepJErgXR"},{"type":"paragraph","position":{"start":{"line":654,"column":1},"end":{"line":654,"column":1}},"children":[{"type":"text","value":"Since the matrix ","position":{"start":{"line":654,"column":1},"end":{"line":654,"column":1}},"key":"wlZy349Gw0"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":654,"column":1},"end":{"line":654,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"wVE1vavDOx"},{"type":"text","value":" has ","position":{"start":{"line":654,"column":1},"end":{"line":654,"column":1}},"key":"nL19OICIrO"},{"type":"inlineMath","value":"n^2","position":{"start":{"line":654,"column":1},"end":{"line":654,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>n</mi><mn>2</mn></msup></mrow><annotation encoding=\"application/x-tex\">n^2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">n</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span>","key":"zrTzNJCELR"},{"type":"text","value":" elements, all of which have to be involved in the product, it seems unlikely that we could get a flop count that is smaller than ","position":{"start":{"line":654,"column":1},"end":{"line":654,"column":1}},"key":"BO09Jmt6MP"},{"type":"inlineMath","value":"O(n^2)","position":{"start":{"line":654,"column":1},"end":{"line":654,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(n^2)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">n</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"GC7PiiFJZ0"},{"type":"text","value":" in general.","position":{"start":{"line":654,"column":1},"end":{"line":654,"column":1}},"key":"AQeI3jnF4W"}],"key":"fCLVziyEz5"},{"type":"paragraph","position":{"start":{"line":656,"column":1},"end":{"line":656,"column":1}},"children":[{"type":"text","value":"Let’s run an experiment with the built-in matrix-vector multiplication. We assume that flops dominate the computation time and thus measure elapsed time.","position":{"start":{"line":656,"column":1},"end":{"line":656,"column":1}},"key":"k20uzGwP1g"}],"key":"fnylBVNMR5"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"N = 400 * arange(1, 11)\nt = []\nprint(\"  n           t\")\nfor i, n in enumerate(N):\n    A = random.randn(n, n)  \n    x = random.randn(n)\n    start = timer()\n    for j in range(50): A @ x\n    t.append(timer() - start)\n    print(f\"{n:5}   {t[-1]:10.3e}\")","key":"qVq6FYiUjK"},{"type":"output","id":"VI_H9xipY9AzB-qlU-KWa","data":[{"output_type":"stream","name":"stdout","text":"  n           t\n  400    4.651e-04\n  800    1.035e-03\n"},{"output_type":"stream","name":"stdout","text":" 1200    3.659e-03\n"},{"output_type":"stream","name":"stdout","text":" 1600    1.234e-02\n"},{"output_type":"stream","name":"stdout","text":" 2000    2.326e-02\n"},{"output_type":"stream","name":"stdout","text":" 2400    3.738e-02\n"},{"output_type":"stream","name":"stdout","text":" 2800    6.964e-02\n"},{"output_type":"stream","name":"stdout","text":" 3200    7.433e-02\n"},{"output_type":"stream","name":"stdout","text":" 3600    1.018e-01\n"},{"output_type":"stream","name":"stdout","text":" 4000    1.256e-01\n"}],"key":"YpG6ntHvwy"}],"data":{},"key":"XfzQf5lajA"},{"type":"paragraph","position":{"start":{"line":671,"column":1},"end":{"line":671,"column":1}},"children":[{"type":"text","value":"The reason for doing multiple repetitions at each value of ","position":{"start":{"line":671,"column":1},"end":{"line":671,"column":1}},"key":"OMQYyW2WiK"},{"type":"inlineMath","value":"n","position":{"start":{"line":671,"column":1},"end":{"line":671,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"SL8AwoJ1Vk"},{"type":"text","value":" above is to avoid having times so short that the resolution of the timer is a factor.","position":{"start":{"line":671,"column":1},"end":{"line":671,"column":1}},"key":"QS1iAyzWaX"}],"key":"YGcU7rV4DW"},{"type":"paragraph","position":{"start":{"line":673,"column":1},"end":{"line":673,"column":1}},"children":[{"type":"text","value":"Looking at the timings just for ","position":{"start":{"line":673,"column":1},"end":{"line":673,"column":1}},"key":"HnpPvpcruv"},{"type":"inlineMath","value":"n=2000","position":{"start":{"line":673,"column":1},"end":{"line":673,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>=</mo><mn>2000</mn></mrow><annotation encoding=\"application/x-tex\">n=2000</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2000</span></span></span></span>","key":"e6wysqyuCS"},{"type":"text","value":" and ","position":{"start":{"line":673,"column":1},"end":{"line":673,"column":1}},"key":"JQ8AMgze1x"},{"type":"inlineMath","value":"n=4000","position":{"start":{"line":673,"column":1},"end":{"line":673,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>=</mo><mn>4000</mn></mrow><annotation encoding=\"application/x-tex\">n=4000</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">4000</span></span></span></span>","key":"FrnerxASso"},{"type":"text","value":", they have ratio:","position":{"start":{"line":673,"column":1},"end":{"line":673,"column":1}},"key":"tsATeoKoVy"}],"key":"Bx0VwsAQej"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(t[9] / t[4])","key":"ZiEiqIO9as"},{"type":"output","id":"1RoqVToIjHXRRr1BoSaID","data":[{"output_type":"stream","name":"stdout","text":"5.399025639913505\n"}],"key":"RUhQfD8WjD"}],"data":{},"key":"I2uonhF89p"},{"type":"paragraph","position":{"start":{"line":679,"column":1},"end":{"line":679,"column":1}},"children":[{"type":"text","value":"If the run time is dominated by flops, then we expect this ratio to be","position":{"start":{"line":679,"column":1},"end":{"line":679,"column":1}},"key":"O1LHDGSHM8"}],"key":"Cn3BWyGxTC"},{"type":"math","value":"\\frac{2(4000)^2}{2(2000)^2}=4.","position":{"start":{"line":681,"column":1},"end":{"line":683,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mfrac><mrow><mn>2</mn><mo stretchy=\"false\">(</mo><mn>4000</mn><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup></mrow><mrow><mn>2</mn><mo stretchy=\"false\">(</mo><mn>2000</mn><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup></mrow></mfrac><mo>=</mo><mn>4.</mn></mrow><annotation encoding=\"application/x-tex\">\\frac{2(4000)^2}{2(2000)^2}=4.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.4271em;vertical-align:-0.936em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.4911em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"mopen\">(</span><span class=\"mord\">2000</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7401em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"mopen\">(</span><span class=\"mord\">4000</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.936em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">4.</span></span></span></span></span>","enumerator":"2","key":"qgQmmZ2SEr"}],"label":"demo-flops-mvmult-python","identifier":"demo-flops-mvmult-python","html_id":"demo-flops-mvmult-python","key":"xjS8ITv1ye"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Asymptotics in log-log plots","position":{"start":{"line":688,"column":1},"end":{"line":688,"column":1}},"key":"e1eVSL3VM3"}],"key":"Su6E6EhYAa"},{"type":"paragraph","position":{"start":{"line":689,"column":1},"end":{"line":689,"column":1}},"children":[{"type":"text","value":"Let’s repeat the experiment of the previous example for more, and larger, values of ","position":{"start":{"line":689,"column":1},"end":{"line":689,"column":1}},"key":"x63yOIzR99"},{"type":"inlineMath","value":"n","position":{"start":{"line":689,"column":1},"end":{"line":689,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"dKOEgSRDiw"},{"type":"text","value":".","position":{"start":{"line":689,"column":1},"end":{"line":689,"column":1}},"key":"llfRzFdSOE"}],"key":"PqmjezwiXL"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"N = arange(400, 6200, 200)\nt = zeros(len(N))\nfor i, n in enumerate(N):\n    A = random.randn(n,n)  \n    x = random.randn(n)\n    start = timer()\n    for j in range(20): A@x\n    t[i] = timer() - start","key":"TSvvd1p97I"},{"type":"output","id":"Oi-DXoleQ9xbvd7Em8UH-","data":[],"key":"Keu5t1dnCe"}],"data":{},"key":"odR3PF9AQK"},{"type":"paragraph","position":{"start":{"line":702,"column":1},"end":{"line":702,"column":1}},"children":[{"type":"text","value":"Plotting the time as a function of ","position":{"start":{"line":702,"column":1},"end":{"line":702,"column":1}},"key":"dtNyPIW0uA"},{"type":"inlineMath","value":"n","position":{"start":{"line":702,"column":1},"end":{"line":702,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"XDISAOLSNG"},{"type":"text","value":" on log-log scales is equivalent to plotting the logs of the variables, but is formatted more neatly.","position":{"start":{"line":702,"column":1},"end":{"line":702,"column":1}},"key":"dmWHTbKUC7"}],"key":"bwNDhVTHPX"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"fig, ax = subplots()\nax.loglog(N, t, \"-o\", label=\"observed\")\nylabel(\"elapsed time (sec)\");\nxlabel(\"$n$\");\ntitle(\"Timing of matrix-vector multiplications\");","key":"dRdWF7736t"},{"type":"output","id":"C55yI8n2a8VMXx8uXIa_X","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"0935b5b13542af70a191d7743c0af458","path":"/fnc/build/0935b5b13542af70a191d7743c0af458.png"}}}],"key":"oLyn6x1jp9"}],"data":{},"key":"RGAGwwrHKr"},{"type":"paragraph","position":{"start":{"line":712,"column":1},"end":{"line":712,"column":1}},"children":[{"type":"text","value":"You can see that while the full story is complicated, the graph is trending to a straight line of positive slope. For comparison, we can plot a line that represents ","position":{"start":{"line":712,"column":1},"end":{"line":712,"column":1}},"key":"QDlfQWoQ8U"},{"type":"inlineMath","value":"O(n^2)","position":{"start":{"line":712,"column":1},"end":{"line":712,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(n^2)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">n</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"MYfjl0kwIl"},{"type":"text","value":" growth exactly. (All such lines have slope equal to 2.)","position":{"start":{"line":712,"column":1},"end":{"line":712,"column":1}},"key":"LgZtr9O59S"}],"key":"VrPQxfRqAF"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ax.loglog(N, t[-1] * (N/N[-1])**2, \"--\", label=\"$O(n^2)$\")\nax.legend();  fig","key":"FI28LIYBhc"},{"type":"output","id":"kiaUbVRlXl6QyBcPRo4fz","data":[{"output_type":"execute_result","execution_count":73,"metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"868164184ceb629ffdfeabab1443eb62","path":"/fnc/build/868164184ceb629ffdfeabab1443eb62.png"}}}],"key":"bWlFtk0Kxm"}],"data":{},"key":"Cf7oAvm47G"}],"label":"demo-flops-loglog-python","identifier":"demo-flops-loglog-python","html_id":"demo-flops-loglog-python","key":"anv1bMJL0C"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Floating-point operations in ","key":"ZHigfHF0Ea"},{"type":"abbreviation","title":"lower triangular times upper triangular","children":[{"type":"text","value":"LU","key":"AZn5IuXcFG"}],"key":"Gv56j26vSL"},{"type":"text","value":" factorization","key":"FEwFu4g8U1"}],"key":"LFZq7WTnb1"},{"type":"paragraph","position":{"start":{"line":723,"column":1},"end":{"line":723,"column":1}},"children":[{"type":"text","value":"We’ll test the conclusion of ","position":{"start":{"line":723,"column":1},"end":{"line":723,"column":1}},"key":"HnoZrNIK9y"},{"type":"inlineMath","value":"O(n^3)","position":{"start":{"line":723,"column":1},"end":{"line":723,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><msup><mi>n</mi><mn>3</mn></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(n^3)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">n</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"QKpZfdrFwB"},{"type":"text","value":" flops experimentally using the ","position":{"start":{"line":723,"column":1},"end":{"line":723,"column":1}},"key":"O0Th9SLfGI"},{"type":"inlineCode","value":"lu","position":{"start":{"line":723,"column":1},"end":{"line":723,"column":1}},"key":"UimAW011iB"},{"type":"text","value":" function imported from ","position":{"start":{"line":723,"column":1},"end":{"line":723,"column":1}},"key":"bhHD7Q7h5d"},{"type":"inlineCode","value":"scipi.linalg","position":{"start":{"line":723,"column":1},"end":{"line":723,"column":1}},"key":"YocnVJEEpx"},{"type":"text","value":".","position":{"start":{"line":723,"column":1},"end":{"line":723,"column":1}},"key":"cktNt6uWAe"}],"key":"cuQZnXs2H1"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from scipy.linalg import lu\nN = arange(200, 2600, 200)\nt = zeros(len(N))\nfor i, n in enumerate(N):\n    A = random.randn(n,n)  \n    start = timer()\n    for j in range(5): lu(A)\n    t[i] = timer() - start","key":"Hgk8oZoRzz"},{"type":"output","id":"stuB-tXlY-X_BFQvdGyk8","data":[],"key":"Pz6i6YKDrl"}],"data":{},"key":"RH0Nwfl3lz"},{"type":"paragraph","position":{"start":{"line":736,"column":1},"end":{"line":736,"column":1}},"children":[{"type":"text","value":"We plot the timings on a log-log graph and compare it to ","position":{"start":{"line":736,"column":1},"end":{"line":736,"column":1}},"key":"UYPLWYr1mW"},{"type":"inlineMath","value":"O(n^3)","position":{"start":{"line":736,"column":1},"end":{"line":736,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><msup><mi>n</mi><mn>3</mn></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(n^3)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">n</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"wbRkGCIZEi"},{"type":"text","value":". The result could vary significantly from machine to machine, but in theory the data should start to parallel the line as ","position":{"start":{"line":736,"column":1},"end":{"line":736,"column":1}},"key":"yrwPH2BZzA"},{"type":"inlineMath","value":"n\\to\\infty","position":{"start":{"line":736,"column":1},"end":{"line":736,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>→</mo><mi mathvariant=\"normal\">∞</mi></mrow><annotation encoding=\"application/x-tex\">n\\to\\infty</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord\">∞</span></span></span></span>","key":"Ky0TUvWfj1"},{"type":"text","value":".","position":{"start":{"line":736,"column":1},"end":{"line":736,"column":1}},"key":"dTvi1g8zkD"}],"key":"Wr9ISQpSVO"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"loglog(N, t, \"-o\", label=\"obseved\")\nloglog(N, t[-1] * (N / N[-1])**3, \"--\", label=\"$O(n^3)$\")\nlegend();\nxlabel(\"$n$\");\nylabel(\"elapsed time (sec)\");\ntitle(\"Timing of LU factorizations\");","key":"RNcMVz8UXJ"},{"type":"output","id":"imfDi2jHYByaYvJ7Oeolm","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"2c4d7574b49f5e3f260cfa8547dbb1b2","path":"/fnc/build/2c4d7574b49f5e3f260cfa8547dbb1b2.png"}}}],"key":"yaYRCxSV23"}],"data":{},"key":"xTxtJ6x9a4"}],"label":"demo-flops-lufact-python","identifier":"demo-flops-lufact-python","html_id":"demo-flops-lufact-python","key":"SqZYgOyY95"},{"type":"heading","depth":3,"position":{"start":{"line":748,"column":1},"end":{"line":748,"column":1}},"children":[{"type":"text","value":"Section 2.6","position":{"start":{"line":748,"column":1},"end":{"line":748,"column":1}},"key":"KIyMqwdKPk"}],"identifier":"section-2-6","label":"Section 2.6","html_id":"section-2-6","implicit":true,"key":"va94GxMBG5"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Failure of naive ","key":"HWqAkeRGyB"},{"type":"abbreviation","title":"lower triangular times upper triangular","children":[{"type":"text","value":"LU","key":"HY8Uxnnwjw"}],"key":"sw0dH2FCg9"},{"type":"text","value":" factorization","key":"qpms0mBGVD"}],"key":"GAj83FwygD"},{"type":"paragraph","position":{"start":{"line":751,"column":1},"end":{"line":751,"column":1}},"children":[{"type":"text","value":"Here is a previously encountered matrix that factors well.","position":{"start":{"line":751,"column":1},"end":{"line":751,"column":1}},"key":"TT7pv45zb4"}],"key":"UIw0tNxRQR"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"A = array([\n    [2, 0, 4, 3],\n    [-4, 5, -7, -10],\n    [1, 15, 2, -4.5],\n    [-2, 0, 2, -13]\n    ])\nL, U = FNC.lufact(A)\nprint(L)","key":"M2sEimygip"},{"type":"output","id":"JD-6vIZNpi5rKVs9_3ZgP","data":[{"output_type":"stream","name":"stdout","text":"[[ 1.   0.  -0.   0. ]\n [-2.   1.  -0.   0. ]\n [ 0.5  3.   1.   0. ]\n [-1.   0.  -2.   1. ]]\n"}],"key":"q2oO33v5y6"}],"data":{},"key":"M76tLOaX83"},{"type":"paragraph","position":{"start":{"line":764,"column":1},"end":{"line":764,"column":1}},"children":[{"type":"text","value":"If we swap the second and fourth rows of ","position":{"start":{"line":764,"column":1},"end":{"line":764,"column":1}},"key":"A854lzSWR7"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":764,"column":1},"end":{"line":764,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"pgWVPPvKKy"},{"type":"text","value":", the result is still nonsingular. However, the factorization now fails.","position":{"start":{"line":764,"column":1},"end":{"line":764,"column":1}},"key":"f1Z76i6tzO"}],"key":"uVYZjila2O"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"A[[1, 3], :] = A[[3, 1], :]  \nL, U = FNC.lufact(A)\nprint(L)","key":"poTc9p2ShP"},{"type":"output","id":"9iRuZIGOpgl_SAiCwowfb","data":[{"output_type":"stream","name":"stdout","text":"[[ 1.   nan  nan  0. ]\n [-1.   nan  nan  0. ]\n [ 0.5  inf  nan  0. ]\n [-2.   inf  nan  1. ]]\n"},{"output_type":"stream","name":"stderr","text":"/Users/driscoll/Dropbox/Mac/Documents/GitHub/fnc/python/FNC/FNC02.py:47: RuntimeWarning: divide by zero encountered in divide\n  L[:, k] = A_k[:, k] / U[k,k]\n/Users/driscoll/Dropbox/Mac/Documents/GitHub/fnc/python/FNC/FNC02.py:47: RuntimeWarning: invalid value encountered in divide\n  L[:, k] = A_k[:, k] / U[k,k]\n/Users/driscoll/mambaforge/envs/myst/lib/python3.13/site-packages/numpy/_core/numeric.py:983: RuntimeWarning: invalid value encountered in multiply\n  return multiply(a.ravel()[:, newaxis], b.ravel()[newaxis, :], out)\n"}],"key":"PfmcLFhBTM"}],"data":{},"key":"ZDgJG3QQSh"},{"type":"paragraph","position":{"start":{"line":775,"column":1},"end":{"line":775,"column":1}},"children":[{"type":"text","value":"The presence of ","position":{"start":{"line":775,"column":1},"end":{"line":775,"column":1}},"key":"MhKWcRES9Z"},{"type":"inlineCode","value":"NaN","position":{"start":{"line":775,"column":1},"end":{"line":775,"column":1}},"key":"chwiQ8aQqq"},{"type":"text","value":" in the result indicates that some impossible operation was required. The source of the problem is easy to locate. We can find the first outer product in the factorization just fine:","position":{"start":{"line":775,"column":1},"end":{"line":775,"column":1}},"key":"GCCLzf2G60"}],"indexEntries":[{"entry":"Python","subEntry":{"value":"NaN","kind":"entry"},"emphasis":false}],"label":"index-VnXPUP8a0K","identifier":"index-vnxpup8a0k","html_id":"index-vnxpup8a0k","key":"Cpt9SmwwoA"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"U[0, :] = A[0, :]\nL[:, 0] = A[:, 0] / U[0, 0]\nA -= outer(L[:, 0],  U[0, :])\nprint(A)","key":"TOthERIMZY"},{"type":"output","id":"FVnh57A7DFQHwoKjgE2Vz","data":[{"output_type":"stream","name":"stdout","text":"[[  0.   0.   0.   0.]\n [  0.   0.   6. -10.]\n [  0.  15.   0.  -6.]\n [  0.   5.   1.  -4.]]\n"}],"key":"W5gk3MHeIE"}],"data":{},"key":"nsr6EkxokV"},{"type":"paragraph","position":{"start":{"line":784,"column":1},"end":{"line":784,"column":1}},"children":[{"type":"text","value":"The next step is ","position":{"start":{"line":784,"column":1},"end":{"line":784,"column":1}},"key":"BM9P0KU4gP"},{"type":"inlineCode","value":"U[1, :] = A[1, :]","position":{"start":{"line":784,"column":1},"end":{"line":784,"column":1}},"key":"FwXLF57doY"},{"type":"text","value":", which is also OK. But then we are supposed to divide by ","position":{"start":{"line":784,"column":1},"end":{"line":784,"column":1}},"key":"zzP5c6xMoI"},{"type":"inlineCode","value":"U[1, 1]","position":{"start":{"line":784,"column":1},"end":{"line":784,"column":1}},"key":"eM84kXyb6G"},{"type":"text","value":", which is zero. The algorithm cannot continue.","position":{"start":{"line":784,"column":1},"end":{"line":784,"column":1}},"key":"IGrryalmGs"}],"key":"YcB35cboBC"}],"label":"demo-pivoting-fail-python","identifier":"demo-pivoting-fail-python","html_id":"demo-pivoting-fail-python","key":"XHcexy1JfI"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Row pivoting in ","key":"FtLfNs0c9N"},{"type":"abbreviation","title":"lower triangular times upper triangular","children":[{"type":"text","value":"LU","key":"Q1ZZw2gpCn"}],"key":"QOYYhl2P5A"},{"type":"text","value":" factorization","key":"HK136Ur2cQ"}],"key":"ZBTPTFbzIM"},{"type":"paragraph","position":{"start":{"line":789,"column":1},"end":{"line":789,"column":1}},"children":[{"type":"text","value":"Here is the trouble-making matrix from ","position":{"start":{"line":789,"column":1},"end":{"line":789,"column":1}},"key":"OZKXof1Dnj"},{"type":"crossReference","kind":"proof:example","identifier":"demo-pivoting-fail","label":"demo-pivoting-fail","children":[{"type":"text","value":"Demo ","key":"JIagOGblbm"},{"type":"text","value":"2.6.1","key":"Uftw12DCBT"}],"template":"Example %s","enumerator":"2.6.1","resolved":true,"html_id":"demo-pivoting-fail","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"oTdmLQLrkr"},{"type":"text","value":".","position":{"start":{"line":789,"column":1},"end":{"line":789,"column":1}},"key":"dNGHLwS1Vq"}],"key":"fr4yqaCTrd"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"A_1 = array([\n    [2, 0, 4, 3],\n    [-2, 0, 2, -13],\n    [1, 15, 2, -4.5],\n    [-4, 5, -7, -10]\n    ])","key":"iplZeewjss"},{"type":"output","id":"-pahrrPnJIKBQbfm3I3OT","data":[],"key":"kK8t4A97N6"}],"data":{},"key":"TLGKtyma3r"},{"type":"grid","columns":[1,1,2,2],"children":[{"type":"paragraph","position":{"start":{"line":801,"column":1},"end":{"line":801,"column":1}},"children":[{"type":"text","value":"We now find the largest candidate pivot in the first column. We don’t care about sign, so we take absolute values before finding the max.","position":{"start":{"line":801,"column":1},"end":{"line":801,"column":1}},"key":"u1Wmyd2aR0"}],"key":"ksyuxy6kJB"},{"type":"card","children":[{"type":"paragraph","position":{"start":{"line":803,"column":1},"end":{"line":803,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":803,"column":1},"end":{"line":803,"column":1}},"key":"ITlsnnVE7Q"},{"type":"inlineCode","value":"argmax","position":{"start":{"line":803,"column":1},"end":{"line":803,"column":1}},"key":"Fe2c1aUujq"},{"type":"text","value":" function returns the location of the largest element of a vector or matrix.","position":{"start":{"line":803,"column":1},"end":{"line":803,"column":1}},"key":"v5Lod5Goth"}],"key":"PVNs9rzIgw"}],"key":"f02LTGWaww"}],"key":"uE8b79xhiP"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"i = argmax( abs(A_1[:, 0]) )\nprint(i)","key":"xWMaLphnZa"},{"type":"output","id":"-UtQGH_vnvq0UQrxabuqd","data":[{"output_type":"stream","name":"stdout","text":"3\n"}],"key":"oqoPyWTmTv"}],"data":{},"key":"Dk8vURAFIj"},{"type":"paragraph","position":{"start":{"line":813,"column":1},"end":{"line":813,"column":1}},"children":[{"type":"text","value":"This is the row of the matrix that we extract to put into ","position":{"start":{"line":813,"column":1},"end":{"line":813,"column":1}},"key":"qXOrXqtVSG"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":813,"column":1},"end":{"line":813,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"Ga1j656N2s"},{"type":"text","value":". That guarantees that the division used to find ","position":{"start":{"line":813,"column":1},"end":{"line":813,"column":1}},"key":"gdm9jh3EJs"},{"type":"inlineMath","value":"\\boldsymbol{\\ell}_1","position":{"start":{"line":813,"column":1},"end":{"line":813,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">ℓ</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\boldsymbol{\\ell}_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">ℓ</span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"SzZGQbsVBg"},{"type":"text","value":" will be valid.","position":{"start":{"line":813,"column":1},"end":{"line":813,"column":1}},"key":"eX2R522G3F"}],"key":"txAuAdoFkO"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"L, U = eye(4), zeros((4, 4))\nU[0, :] = A_1[i, :]\nL[:, 0] = A_1[:, 0] / U[0, 0]\nA_2 = A_1 - outer(L[:, 0], U[0, :])\nprint(A_2)","key":"vvAvydTdv8"},{"type":"output","id":"l9SLQWfJRio74AI8ZzKCd","data":[{"output_type":"stream","name":"stdout","text":"[[ 0.    2.5   0.5  -2.  ]\n [ 0.   -2.5   5.5  -8.  ]\n [ 0.   16.25  0.25 -7.  ]\n [ 0.    0.    0.    0.  ]]\n"}],"key":"zeQGOEUg8X"}],"data":{},"key":"Sa5EBLwuLm"},{"type":"paragraph","position":{"start":{"line":823,"column":1},"end":{"line":823,"column":1}},"children":[{"type":"text","value":"Observe that ","position":{"start":{"line":823,"column":1},"end":{"line":823,"column":1}},"key":"hcGQpWNt1l"},{"type":"inlineMath","value":"\\mathbf{A}_2","position":{"start":{"line":823,"column":1},"end":{"line":823,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">A</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8361em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"M7HyfN8Qyv"},{"type":"text","value":" has a new zero row and zero column, but the zero row is the fourth rather than the first. However, we forge on by using the largest possible pivot in column 2 for the next outer product.","position":{"start":{"line":823,"column":1},"end":{"line":823,"column":1}},"key":"NbfJUng0yk"}],"key":"Ih58K41yO2"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"i = argmax( abs(A_2[:, 1]) ) \nprint(f\"new pivot row is {i}\")\nU[1, :] = A_2[i, :]\nL[:, 1] = A_2[:, 1] / U[1, 1]\nA_3 = A_2 - outer(L[:, 1], U[1, :])\nprint(A_3)","key":"m3G716ai4S"},{"type":"output","id":"OvtDQ9d0dcKpwCqtCVnOy","data":[{"output_type":"stream","name":"stdout","text":"new pivot row is 2\n[[ 0.          0.          0.46153846 -0.92307692]\n [ 0.          0.          5.53846154 -9.07692308]\n [ 0.          0.          0.          0.        ]\n [ 0.          0.          0.          0.        ]]\n"}],"key":"jSRkzYINYh"}],"data":{},"key":"REE5TsUS7o"},{"type":"paragraph","position":{"start":{"line":833,"column":1},"end":{"line":833,"column":1}},"children":[{"type":"text","value":"Now we have zeroed out the third row as well as the second column. We can finish out the procedure.","position":{"start":{"line":833,"column":1},"end":{"line":833,"column":1}},"key":"y47lfI1DPV"}],"key":"c2C7TKaAMU"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"i = argmax( abs(A_3[:, 2]) ) \nprint(f\"new pivot row is {i}\")\nU[2, :] = A_3[i, :]\nL[:, 2] = A_3[:, 2] / U[2, 2]\nA_4 = A_3 - outer(L[:, 2], U[2, :])\nprint(A_4)","key":"QipJ4S7fC8"},{"type":"output","id":"KgrWYv6Zj5gK5EHxgSY2o","data":[{"output_type":"stream","name":"stdout","text":"new pivot row is 1\n[[ 0.          0.          0.         -0.16666667]\n [ 0.          0.          0.          0.        ]\n [ 0.          0.          0.          0.        ]\n [ 0.          0.          0.          0.        ]]\n"}],"key":"nQEx6dRw7c"}],"data":{},"key":"xYjsN6Dypt"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"i = argmax( abs(A_4[:, 3]) ) \nprint(f\"new pivot row is {i}\")\nU[3, :] = A_4[i, :]\nL[:, 3] = A_4[:, 3] / U[3, 3];","key":"MeDF93Vpid"},{"type":"output","id":"rJIClJ51Kf7HClDSS1wDV","data":[{"output_type":"stream","name":"stdout","text":"new pivot row is 0\n"}],"key":"f4KnEWw7pA"}],"data":{},"key":"mdzKHkUKug"},{"type":"paragraph","position":{"start":{"line":851,"column":1},"end":{"line":851,"column":1}},"children":[{"type":"text","value":"We do have a factorization of the original matrix:","position":{"start":{"line":851,"column":1},"end":{"line":851,"column":1}},"key":"o78pewlT2v"}],"key":"RmaGtFpnYM"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"A_1 - L @ U","key":"xRcWpF102Y"},{"type":"output","id":"IvdzQtqiRGPZ79Vdo_mdm","data":[{"output_type":"execute_result","execution_count":85,"metadata":{},"data":{"text/plain":{"content":"array([[0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00],\n       [0.00000000e+00, 0.00000000e+00, 2.22044605e-16, 0.00000000e+00],\n       [0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00],\n       [0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00]])","content_type":"text/plain"}}}],"key":"f22BRHESKn"}],"data":{},"key":"yRzMejOqO9"},{"type":"paragraph","position":{"start":{"line":857,"column":1},"end":{"line":857,"column":1}},"children":[{"type":"text","value":"And ","position":{"start":{"line":857,"column":1},"end":{"line":857,"column":1}},"key":"UHXMnHPUDe"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":857,"column":1},"end":{"line":857,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"xf75ooSjs4"},{"type":"text","value":" has the required structure:","position":{"start":{"line":857,"column":1},"end":{"line":857,"column":1}},"key":"Di8K6ONLmx"}],"key":"N9oyViHgpC"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(U)","key":"BNV5ymS7gn"},{"type":"output","id":"SUtaMDnHpz5oJiRF-GHe1","data":[{"output_type":"stream","name":"stdout","text":"[[ -4.           5.          -7.         -10.        ]\n [  0.          16.25         0.25        -7.        ]\n [  0.           0.           5.53846154  -9.07692308]\n [  0.           0.           0.          -0.16666667]]\n"}],"key":"ADk14kALsC"}],"data":{},"key":"Ygy5zU3d2F"},{"type":"paragraph","position":{"start":{"line":863,"column":1},"end":{"line":863,"column":1}},"children":[{"type":"text","value":"However, the triangularity of ","position":{"start":{"line":863,"column":1},"end":{"line":863,"column":1}},"key":"njvQj9g4qJ"},{"type":"inlineMath","value":"\\mathbf{L}","position":{"start":{"line":863,"column":1},"end":{"line":863,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">L</span></span></span></span>","key":"D5ONuIxwrx"},{"type":"text","value":" has been broken.","position":{"start":{"line":863,"column":1},"end":{"line":863,"column":1}},"key":"Hfv392db6p"}],"key":"WmZpLfXmq3"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(L)","key":"Ks9aQh4r2S"},{"type":"output","id":"mV_Ndg9UrkuYXE6hySysS","data":[{"output_type":"stream","name":"stdout","text":"[[-0.5         0.15384615  0.08333333  1.        ]\n [ 0.5        -0.15384615  1.         -0.        ]\n [-0.25        1.          0.         -0.        ]\n [ 1.          0.          0.         -0.        ]]\n"}],"key":"qlQ0PFBggZ"}],"data":{},"key":"DHGDUskrYJ"}],"label":"demo-pivoting-fix-python","identifier":"demo-pivoting-fix-python","html_id":"demo-pivoting-fix-python","key":"KyAHL1ppIO"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Row permutation in ","key":"iuxfuy8H9T"},{"type":"abbreviation","title":"lower triangular times upper triangular","children":[{"type":"text","value":"LU","key":"gvnaIiaGEW"}],"key":"lFiNwvj2xV"},{"type":"text","value":" factorization","key":"Fk77qXYBqw"}],"key":"VkaMnb1TJI"},{"type":"paragraph","position":{"start":{"line":873,"column":1},"end":{"line":873,"column":1}},"children":[{"type":"text","value":"Here again is the matrix from ","position":{"start":{"line":873,"column":1},"end":{"line":873,"column":1}},"key":"DJknianHwG"},{"type":"crossReference","kind":"proof:example","identifier":"demo-pivoting-fix","label":"demo-pivoting-fix","children":[{"type":"text","value":"Demo ","key":"KLaW3gF0g3"},{"type":"text","value":"2.6.2","key":"BePQgefZgh"}],"template":"Example %s","enumerator":"2.6.2","resolved":true,"html_id":"demo-pivoting-fix","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"PRdogh6nxh"},{"type":"text","value":".","position":{"start":{"line":873,"column":1},"end":{"line":873,"column":1}},"key":"zKXvFXSoo6"}],"key":"SQP1cA7WB1"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"A = array([\n    [2, 0, 4, 3],\n    [-2, 0, 2, -13],\n    [1, 15, 2, -4.5],\n    [-4, 5, -7, -10]\n    ])","key":"B2CEKNVUaU"},{"type":"output","id":"yQluZRlEZQiXVdgynzHE6","data":[],"key":"v9j70WEgXz"}],"data":{},"key":"egHXGuTwuK"},{"type":"paragraph","position":{"start":{"line":884,"column":1},"end":{"line":884,"column":1}},"children":[{"type":"text","value":"As the factorization proceeded, the pivots were selected from rows 4, 3, 2, and finally 1 (with NumPy indices being one less). If we were to put the rows of ","position":{"start":{"line":884,"column":1},"end":{"line":884,"column":1}},"key":"fuxPbP8wAb"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":884,"column":1},"end":{"line":884,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"Dc9HVClKxX"},{"type":"text","value":" into that order, then the algorithm would run exactly like the plain ","key":"q3RT1ZkYkA"},{"type":"abbreviation","title":"lower triangular times upper triangular","children":[{"type":"text","value":"LU","key":"tkMpbsek0W"}],"key":"gLxSW1KTNb"},{"type":"text","value":" factorization from ","key":"vD95pwBkmJ"},{"type":"link","kind":"numref","identifier":"section-linsys-lu","label":"section-linsys-lu","url":"/lu","internal":true,"dataUrl":"/lu.json","children":[{"type":"text","value":"LU factorization","key":"TWDogrV3c0"}],"key":"kVQS2tNlAq"},{"type":"text","value":".","position":{"start":{"line":884,"column":1},"end":{"line":884,"column":1}},"key":"ry1AZLmD2W"}],"key":"UH1KQtZ740"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"B = A[[3, 2, 1, 0], :]\nL, U = FNC.lufact(B);","key":"bnc8HsVVo1"},{"type":"output","id":"hhR39zZbLmneXtJAPWOX9","data":[],"key":"wUZVrqUW9c"}],"data":{},"key":"WmQMuPWNmh"},{"type":"paragraph","position":{"start":{"line":891,"column":1},"end":{"line":891,"column":1}},"children":[{"type":"text","value":"We obtain the same ","position":{"start":{"line":891,"column":1},"end":{"line":891,"column":1}},"key":"XDa6G4cFrG"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":891,"column":1},"end":{"line":891,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"UMEX2IEMC9"},{"type":"text","value":" as before:","position":{"start":{"line":891,"column":1},"end":{"line":891,"column":1}},"key":"oARz6f7ilM"}],"key":"RvOag0f5FT"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(U)","key":"ShTrsmnqvq"},{"type":"output","id":"o61W8wVb8yK0mzyAa-su2","data":[{"output_type":"stream","name":"stdout","text":"[[ -4.           5.          -7.         -10.        ]\n [  0.          16.25         0.25        -7.        ]\n [  0.           0.           5.53846154  -9.07692308]\n [  0.           0.           0.          -0.16666667]]\n"}],"key":"kHFQZ7uGmS"}],"data":{},"key":"c4GBUtzDCB"},{"type":"paragraph","position":{"start":{"line":897,"column":1},"end":{"line":897,"column":1}},"children":[{"type":"text","value":"And ","position":{"start":{"line":897,"column":1},"end":{"line":897,"column":1}},"key":"W1fduAcM1O"},{"type":"inlineMath","value":"\\mathbf{L}","position":{"start":{"line":897,"column":1},"end":{"line":897,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">L</span></span></span></span>","key":"tA2o9ne6Wz"},{"type":"text","value":" has the same rows as before, but arranged into triangular order:","position":{"start":{"line":897,"column":1},"end":{"line":897,"column":1}},"key":"ODT3dDrDbk"}],"key":"PiJrjTo1LG"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(L)","key":"RFNqUmwF9p"},{"type":"output","id":"Yqk1tJK60PTmgiVz41Fss","data":[{"output_type":"stream","name":"stdout","text":"[[ 1.          0.          0.          0.        ]\n [-0.25        1.          0.          0.        ]\n [ 0.5        -0.15384615  1.          0.        ]\n [-0.5         0.15384615  0.08333333  1.        ]]\n"}],"key":"Y08PU6exoN"}],"data":{},"key":"EAvS7iAtBK"}],"label":"demo-pivoting-permute-python","identifier":"demo-pivoting-permute-python","html_id":"demo-pivoting-permute-python","key":"UM6psqiGza"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"P","key":"tpUDmA1lM1"},{"type":"abbreviation","title":"lower triangular times upper triangular","children":[{"type":"text","value":"LU","key":"QDzqjvErRn"}],"key":"niQgMlgYw1"},{"type":"text","value":" factorization for solving linear systems","key":"C86Ks6478Y"}],"key":"JldczFI9Z8"},{"type":"paragraph","position":{"start":{"line":906,"column":1},"end":{"line":906,"column":1}},"children":[{"type":"text","value":"The third output of ","position":{"start":{"line":906,"column":1},"end":{"line":906,"column":1}},"key":"O7zb7TGqpI"},{"type":"inlineCode","value":"plufact","position":{"start":{"line":906,"column":1},"end":{"line":906,"column":1}},"key":"LmqLVteoRo"},{"type":"text","value":" is the permutation vector we need to apply to ","position":{"start":{"line":906,"column":1},"end":{"line":906,"column":1}},"key":"SufSk6yzSm"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":906,"column":1},"end":{"line":906,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"x4mq6rtVwE"},{"type":"text","value":".","position":{"start":{"line":906,"column":1},"end":{"line":906,"column":1}},"key":"UyLCdK0KbL"}],"key":"odcTVSglMQ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"A = random.randn(4, 4)\nL, U, p = FNC.plufact(A)\nA[p, :] - L @ U   # should be ≈ 0","key":"rdFiPwsdlw"},{"type":"output","id":"QeSEt6k5xfuMr5dANnJ15","data":[{"output_type":"execute_result","execution_count":92,"metadata":{},"data":{"text/plain":{"content":"array([[ 0.00000000e+00,  0.00000000e+00,  0.00000000e+00,\n         0.00000000e+00],\n       [ 0.00000000e+00, -5.55111512e-17,  1.11022302e-16,\n         5.55111512e-17],\n       [ 0.00000000e+00,  0.00000000e+00, -1.11022302e-16,\n         1.11022302e-16],\n       [ 0.00000000e+00,  0.00000000e+00,  0.00000000e+00,\n         0.00000000e+00]])","content_type":"text/plain"}}}],"key":"JnVZGgEqil"}],"data":{},"key":"bAvyflDzZ8"},{"type":"paragraph","position":{"start":{"line":914,"column":1},"end":{"line":914,"column":1}},"children":[{"type":"text","value":"Given a vector ","position":{"start":{"line":914,"column":1},"end":{"line":914,"column":1}},"key":"Nl1exmqyxb"},{"type":"inlineMath","value":"\\mathbf{b}","position":{"start":{"line":914,"column":1},"end":{"line":914,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"U2wbE7K4kh"},{"type":"text","value":", we solve ","position":{"start":{"line":914,"column":1},"end":{"line":914,"column":1}},"key":"o0wYpeIx3B"},{"type":"inlineMath","value":"\\mathbf{A}\\mathbf{x}=\\mathbf{b}","position":{"start":{"line":914,"column":1},"end":{"line":914,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi><mi mathvariant=\"bold\">x</mi><mo>=</mo><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}\\mathbf{x}=\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">Ax</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"YKQakC9UnA"},{"type":"text","value":" by first permuting the entries of ","position":{"start":{"line":914,"column":1},"end":{"line":914,"column":1}},"key":"APmgMmevSu"},{"type":"inlineMath","value":"\\mathbf{b}","position":{"start":{"line":914,"column":1},"end":{"line":914,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"s5ds1n2iVB"},{"type":"text","value":" and then proceeding as before.","position":{"start":{"line":914,"column":1},"end":{"line":914,"column":1}},"key":"VLp0NFBAyb"}],"key":"VyLlDq4EWD"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"b = random.randn(4)\nz = FNC.forwardsub(L, b[p])\nx = FNC.backsub(U, z)","key":"Crt3aVUFdz"},{"type":"output","id":"tRQmqBmdvw5lP_Gb3Ginx","data":[],"key":"phX2Mo2DAe"}],"data":{},"key":"uknXiV6UOJ"},{"type":"paragraph","position":{"start":{"line":922,"column":1},"end":{"line":922,"column":1}},"children":[{"type":"text","value":"A residual check is successful:","position":{"start":{"line":922,"column":1},"end":{"line":922,"column":1}},"key":"hAkF8UaOgY"}],"key":"czHc1pgFNm"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"b - A @ x","key":"kl6XXk981J"},{"type":"output","id":"bNi5mBleRwf7z49gP5NVU","data":[{"output_type":"execute_result","execution_count":94,"metadata":{},"data":{"text/plain":{"content":"array([-1.24900090e-15,  2.66453526e-15,  2.22044605e-15, -3.94129174e-15])","content_type":"text/plain"}}}],"key":"T7EdJYFSOj"}],"data":{},"key":"F94PPUjV5I"}],"label":"demo-pivoting-usage-python","identifier":"demo-pivoting-usage-python","html_id":"demo-pivoting-usage-python","key":"wdWPZXizUq"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Built-in P","key":"SV8KfLQAvZ"},{"type":"abbreviation","title":"lower triangular times upper triangular","children":[{"type":"text","value":"LU","key":"WkIxc9hRQt"}],"key":"xfJhDjGttJ"},{"type":"text","value":" factorization","key":"WaZgiayMgF"}],"key":"lC5kRwl6cH"},{"type":"paragraph","position":{"start":{"line":931,"column":1},"end":{"line":931,"column":1}},"children":[{"type":"text","value":"In ","position":{"start":{"line":931,"column":1},"end":{"line":931,"column":1}},"key":"mkZcK9N3N8"},{"type":"inlineCode","value":"linalg.solve","position":{"start":{"line":931,"column":1},"end":{"line":931,"column":1}},"key":"M1jFklDUZi"},{"type":"text","value":", the matrix ","position":{"start":{"line":931,"column":1},"end":{"line":931,"column":1}},"key":"F6wNd838M9"},{"type":"inlineCode","value":"A","position":{"start":{"line":931,"column":1},"end":{"line":931,"column":1}},"key":"oh9j3PKmjB"},{"type":"text","value":" is P","key":"xB30dWd2xV"},{"type":"abbreviation","title":"lower triangular times upper triangular","children":[{"type":"text","value":"LU","key":"FQh0s3HGoP"}],"key":"AWD3FyrQNW"},{"type":"text","value":"-factored, followed by two triangular solves. If we want to do those steps seamlessly, we can use the ","key":"Ol9wtKrYDh"},{"type":"inlineCode","value":"lu_factor","position":{"start":{"line":931,"column":1},"end":{"line":931,"column":1}},"key":"eN8lSGBj2g"},{"type":"text","value":" and ","position":{"start":{"line":931,"column":1},"end":{"line":931,"column":1}},"key":"cp5omwio1z"},{"type":"inlineCode","value":"lu_solve","position":{"start":{"line":931,"column":1},"end":{"line":931,"column":1}},"key":"GoyzJJHuBt"},{"type":"text","value":" from ","position":{"start":{"line":931,"column":1},"end":{"line":931,"column":1}},"key":"F7sz6Pb8Du"},{"type":"inlineCode","value":"scipy.linalg","position":{"start":{"line":931,"column":1},"end":{"line":931,"column":1}},"key":"uUh2FOC9dg"},{"type":"text","value":".","position":{"start":{"line":931,"column":1},"end":{"line":931,"column":1}},"key":"PSExyRbvh0"}],"key":"l5qDKN7Xmq"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from scipy.linalg import lu_factor, lu_solve\nA = random.randn(500, 500) \nb = ones(500)  \nLU, perm = lu_factor(A)\nx = lu_solve((LU, perm), b)","key":"qDq7Ae9y5v"},{"type":"output","id":"geEcp6COeiLBbkXm6T7GS","data":[],"key":"YXddvbfyYH"}],"data":{},"key":"WifP1qifKl"},{"type":"paragraph","position":{"start":{"line":941,"column":1},"end":{"line":941,"column":1}},"children":[{"type":"text","value":"Why would we ever bother with this? In ","position":{"start":{"line":941,"column":1},"end":{"line":941,"column":1}},"key":"sxafyGMAi3"},{"type":"link","kind":"numref","identifier":"section-linsys-efficiency","label":"section-linsys-efficiency","url":"/efficiency","internal":true,"dataUrl":"/efficiency.json","children":[{"type":"text","value":"Efficiency of matrix computations","key":"DXdhq6p9p8"}],"key":"D2saS7FsZE"},{"type":"text","value":" we showed that the factorization is by far the most costly part of the solution process. A factorization object allows us to do that costly step only once per matrix, but solve with multiple right-hand sides.","position":{"start":{"line":941,"column":1},"end":{"line":941,"column":1}},"key":"boaXx14UIP"}],"key":"A2k1h5eBbc"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"start = timer()\nfor k in range(50): linalg.solve(A, random.rand(500))\nprint(f\"elapsed time for 50 full solves: {timer() - start}\")\n\nstart = timer()\nLU, perm = lu_factor(A)\nfor k in range(50): lu_solve((LU, perm), random.rand(500))\nprint(f\"elapsed time for 50 shortcut solves: {timer() - start}\")","key":"Ie8jFSSzGX"},{"type":"output","id":"UtEH5knB8nufX6ipS3Kge","data":[{"output_type":"stream","name":"stdout","text":"elapsed time for 50 full solves: 0.08334108398412354\nelapsed time for 50 shortcut solves: 0.00667974998941645\n"}],"key":"MM7pk4POxn"}],"data":{},"key":"xDhAIZ3XBD"}],"label":"demo-pivoting-builtin-python","identifier":"demo-pivoting-builtin-python","html_id":"demo-pivoting-builtin-python","key":"Ljmgae9kJ9"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Stability of P","key":"I1ePHrIGjP"},{"type":"abbreviation","title":"lower triangular times upper triangular","children":[{"type":"text","value":"LU","key":"WMPvrduZP1"}],"key":"qi1aEquGbT"},{"type":"text","value":" factorization","key":"sFqOUuxJfB"}],"key":"wxWmjCZDYf"},{"type":"paragraph","position":{"start":{"line":957,"column":1},"end":{"line":957,"column":1}},"children":[{"type":"text","value":"We construct a linear system for this matrix with ","position":{"start":{"line":957,"column":1},"end":{"line":957,"column":1}},"key":"PHeV6Bg9Ol"},{"type":"inlineMath","value":"\\epsilon=10^{-12}","position":{"start":{"line":957,"column":1},"end":{"line":957,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ϵ</mi><mo>=</mo><mn>1</mn><msup><mn>0</mn><mrow><mo>−</mo><mn>12</mn></mrow></msup></mrow><annotation encoding=\"application/x-tex\">\\epsilon=10^{-12}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">ϵ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">12</span></span></span></span></span></span></span></span></span></span></span></span>","key":"JvrQrWt8YX"},{"type":"text","value":" and exact solution ","position":{"start":{"line":957,"column":1},"end":{"line":957,"column":1}},"key":"kHaQSXsAa4"},{"type":"inlineMath","value":"[1,1]","position":{"start":{"line":957,"column":1},"end":{"line":957,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[1,1]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]</span></span></span></span>","key":"FJ5kChhc4I"},{"type":"text","value":":","position":{"start":{"line":957,"column":1},"end":{"line":957,"column":1}},"key":"U7ghO9wGly"}],"key":"rNMeDzjgNq"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ep = 1e-12\nA = array([[-ep, 1], [1, -1]])\nb = A @ array([1, 1])","key":"SavgZvmJef"},{"type":"output","id":"dZqH21RaLR63BT3MVV0mb","data":[],"key":"ISNXKEp9BB"}],"data":{},"key":"lQ0FO4SSfk"},{"type":"paragraph","position":{"start":{"line":965,"column":1},"end":{"line":965,"column":1}},"children":[{"type":"text","value":"We can factor the matrix without pivoting and solve for ","position":{"start":{"line":965,"column":1},"end":{"line":965,"column":1}},"key":"NkGtGq5NXV"},{"type":"inlineMath","value":"\\mathbf{x}","position":{"start":{"line":965,"column":1},"end":{"line":965,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">x</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{x}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4444em;\"></span><span class=\"mord mathbf\">x</span></span></span></span>","key":"DHAbFJan0X"},{"type":"text","value":".","position":{"start":{"line":965,"column":1},"end":{"line":965,"column":1}},"key":"K32ZKJTz1r"}],"key":"FrSp8gBARo"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"L, U = FNC.lufact(A)\nprint(FNC.backsub( U, FNC.forwardsub(L, b) ))","key":"Tzi7e2A4fA"},{"type":"output","id":"njElonOIGZbgZY2BT5Abh","data":[{"output_type":"stream","name":"stdout","text":"[0.99997788 1.        ]\n"}],"key":"BFlhPnaSMC"}],"data":{},"key":"CFlZ6y61T2"},{"type":"paragraph","position":{"start":{"line":972,"column":1},"end":{"line":972,"column":1}},"children":[{"type":"text","value":"Note that we have obtained only about 5 accurate digits for ","position":{"start":{"line":972,"column":1},"end":{"line":972,"column":1}},"key":"tVtps2D0Wv"},{"type":"inlineMath","value":"x_1","position":{"start":{"line":972,"column":1},"end":{"line":972,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">x_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"hiiz4iwOos"},{"type":"text","value":". We could make the result even more inaccurate by making ","position":{"start":{"line":972,"column":1},"end":{"line":972,"column":1}},"key":"GUHlKScYc6"},{"type":"text","value":"ε","position":{"start":{"line":972,"column":1},"end":{"line":972,"column":1}},"key":"jqnar8Jgm4"},{"type":"text","value":" even smaller:","position":{"start":{"line":972,"column":1},"end":{"line":972,"column":1}},"key":"ioHKFlU3Fc"}],"key":"gDxMV0jHif"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ep = 1e-20;\nA = array([[-ep, 1], [1, -1]])\nb = A @ array([1, 1])\nL, U = FNC.lufact(A)\nprint(FNC.backsub( U, FNC.forwardsub(L, b) ))","key":"NbWEC1oAvq"},{"type":"output","id":"3fu-Xd9STkxZ5MdZgqrBf","data":[{"output_type":"stream","name":"stdout","text":"[-0.  1.]\n"}],"key":"DCAd7Q5FL7"}],"data":{},"key":"jl5huAEr0c"},{"type":"paragraph","position":{"start":{"line":982,"column":1},"end":{"line":982,"column":1}},"children":[{"type":"text","value":"This effect is not due to ill conditioning of the problem—a solution with P","key":"FO3H4SDrs2"},{"type":"abbreviation","title":"lower triangular times upper triangular","children":[{"type":"text","value":"LU","key":"ephTwdLEzF"}],"key":"DCXgPAl990"},{"type":"text","value":" factorization works perfectly:","key":"iAD243xp5a"}],"key":"uULNs3E6Sv"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(solve(A, b))","key":"peGtarUPrv"},{"type":"output","id":"sO7wlgDeijwbZ1o3bYsbP","data":[{"output_type":"stream","name":"stdout","text":"[1. 1.]\n"}],"key":"Im3Tvz2mIF"}],"data":{},"key":"NNB7mbxILe"}],"label":"demo-pivoting-stable-python","identifier":"demo-pivoting-stable-python","html_id":"demo-pivoting-stable-python","key":"DknlsGcXuH"},{"type":"heading","depth":3,"position":{"start":{"line":989,"column":1},"end":{"line":989,"column":1}},"children":[{"type":"text","value":"Section 2.7","position":{"start":{"line":989,"column":1},"end":{"line":989,"column":1}},"key":"DDRGZpOc93"}],"identifier":"section-2-7","label":"Section 2.7","html_id":"section-2-7","implicit":true,"key":"ORvKoJyS7a"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Vector norms","position":{"start":{"line":991,"column":1},"end":{"line":991,"column":1}},"key":"OlP1Z6orPy"}],"key":"OvjAyHNnGk"},{"type":"paragraph","position":{"start":{"line":995,"column":1},"end":{"line":995,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":995,"column":1},"end":{"line":995,"column":1}},"key":"XCSybOjByX"},{"type":"inlineCode","value":"norm","position":{"start":{"line":995,"column":1},"end":{"line":995,"column":1}},"key":"Thy9fCH7vu"},{"type":"text","value":" function from ","position":{"start":{"line":995,"column":1},"end":{"line":995,"column":1}},"key":"PDHMuTUp3d"},{"type":"inlineCode","value":"numpy.linalg","position":{"start":{"line":995,"column":1},"end":{"line":995,"column":1}},"key":"gidjb3Q6Pv"},{"type":"text","value":" computes vector norms.","position":{"start":{"line":995,"column":1},"end":{"line":995,"column":1}},"key":"JJXhRksxiE"}],"indexEntries":[{"entry":"Python","subEntry":{"value":"norm","kind":"entry"},"emphasis":true}],"label":"index-TpAmIpnxBj","identifier":"index-tpamipnxbj","html_id":"index-tpamipnxbj","key":"KBAnAolkLc"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from numpy.linalg import norm\nx = array([2, -3, 1, -1])\nprint(norm(x))       # 2-norm by default","key":"PhrpAzPWSp"},{"type":"output","id":"ib0jMOfBZVkLfY23pebBi","data":[{"output_type":"stream","name":"stdout","text":"3.872983346207417\n"}],"key":"bW4mquFexi"}],"data":{},"key":"QRqEaBxXdE"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(norm(x, inf))","key":"WgzvTvm29R"},{"type":"output","id":"7aqbYgWFlNFlNcpVDKG0o","data":[{"output_type":"stream","name":"stdout","text":"3.0\n"}],"key":"GcvN6t5jpw"}],"data":{},"key":"kORgKjBYqm"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(norm(x, 1))","key":"TyKgnLdRfd"},{"type":"output","id":"7rwbPalz46geXrlvbzdE9","data":[{"output_type":"stream","name":"stdout","text":"7.0\n"}],"key":"vx88C2ERh8"}],"data":{},"key":"kLeOZ9jfOX"}],"label":"demo-norms-vector-python","identifier":"demo-norms-vector-python","html_id":"demo-norms-vector-python","key":"UXU7tdiOJX"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Matrix norms","position":{"start":{"line":1013,"column":1},"end":{"line":1013,"column":1}},"key":"cmC9sHmXkk"}],"key":"w3XF8yA6iK"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from numpy.linalg import norm\nA = array([ [2, 0], [1, -1] ])","key":"qk2MgnCf5p"},{"type":"output","id":"fcCJfeefdNYLWE3J70z8X","data":[],"key":"N3BYFVhUqy"}],"data":{},"key":"zNsJAodqTR"},{"type":"paragraph","position":{"start":{"line":1022,"column":1},"end":{"line":1022,"column":1}},"children":[{"type":"text","value":"The default matrix norm is ","position":{"start":{"line":1022,"column":1},"end":{"line":1022,"column":1}},"key":"aKszIaFOP3"},{"type":"emphasis","position":{"start":{"line":1022,"column":1},"end":{"line":1022,"column":1}},"children":[{"type":"text","value":"not","position":{"start":{"line":1022,"column":1},"end":{"line":1022,"column":1}},"key":"qqGMuMNLqn"}],"key":"ywgJaoCgLy"},{"type":"text","value":" the 2-norm. Instead, you must provide the 2 explicitly.","position":{"start":{"line":1022,"column":1},"end":{"line":1022,"column":1}},"key":"ZHwGb1XeFJ"}],"indexEntries":[{"entry":"Python","subEntry":{"value":"norm","kind":"entry"},"emphasis":true}],"label":"index-Rwjp76aJC9","identifier":"index-rwjp76ajc9","html_id":"index-rwjp76ajc9","key":"ZCgQovniJe"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(norm(A, 2))","key":"gOhqIpTG9x"},{"type":"output","id":"57iAY2sEvPuEh224MS_iO","data":[{"output_type":"stream","name":"stdout","text":"2.2882456112707374\n"}],"key":"FS41Z7jj27"}],"data":{},"key":"mVdHdU6pCr"},{"type":"paragraph","position":{"start":{"line":1028,"column":1},"end":{"line":1028,"column":1}},"children":[{"type":"text","value":"You can get the 1-norm as well.","position":{"start":{"line":1028,"column":1},"end":{"line":1028,"column":1}},"key":"fGwQpzhbGj"}],"key":"qUfgFX3Kn4"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(norm(A, 1))","key":"ZxdoA9PA1Y"},{"type":"output","id":"0plDTOsxqyGXTaf9pJQ7S","data":[{"output_type":"stream","name":"stdout","text":"3.0\n"}],"key":"yf2kc8GMQh"}],"data":{},"key":"GwttyWjcU3"},{"type":"paragraph","position":{"start":{"line":1037,"column":1},"end":{"line":1037,"column":1}},"children":[{"type":"text","value":"The 1-norm is equivalent to","position":{"start":{"line":1037,"column":1},"end":{"line":1037,"column":1}},"key":"oV9347d7v6"}],"indexEntries":[{"entry":"Python","subEntry":{"value":"max","kind":"entry"},"emphasis":true},{"entry":"Python","subEntry":{"value":"sum","kind":"entry"},"emphasis":false}],"label":"index-vhdgKLhPZJ","identifier":"index-vhdgklhpzj","html_id":"index-vhdgklhpzj","key":"Hwzt5jzBI1"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(max( sum(abs(A), axis=0)) )  # sum down the rows","key":"HO2mwg12aB"},{"type":"output","id":"ykkFZJVxnKqqtaaeqQAsN","data":[{"output_type":"stream","name":"stdout","text":"3\n"}],"key":"KVvovwG8ix"}],"data":{},"key":"yIGwoPN5lK"},{"type":"paragraph","position":{"start":{"line":1043,"column":1},"end":{"line":1043,"column":1}},"children":[{"type":"text","value":"Similarly, we can get the ","position":{"start":{"line":1043,"column":1},"end":{"line":1043,"column":1}},"key":"HBxQxvVg6E"},{"type":"text","value":"∞","position":{"start":{"line":1043,"column":1},"end":{"line":1043,"column":1}},"key":"ywH9r813m7"},{"type":"text","value":"-norm and check our formula for it.","position":{"start":{"line":1043,"column":1},"end":{"line":1043,"column":1}},"key":"mU77jWHqDs"}],"key":"Fey4UCFBMr"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(norm(A, inf))","key":"IEzssCKgzG"},{"type":"output","id":"6Niiz9Kv-iML1JXHbHM4H","data":[{"output_type":"stream","name":"stdout","text":"2.0\n"}],"key":"az7qJGBnvW"}],"data":{},"key":"sBAz2HqyNR"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(max( sum(abs(A), axis=1)) )  # sum across columns","key":"hh5zGu0jLN"},{"type":"output","id":"fXmTo60qfQbD349nrj-UO","data":[{"output_type":"stream","name":"stdout","text":"2\n"}],"key":"QOq1l8mUkG"}],"data":{},"key":"rj65JGCVCR"},{"type":"paragraph","position":{"start":{"line":1053,"column":1},"end":{"line":1053,"column":1}},"children":[{"type":"text","value":"Here we illustrate the geometric interpretation of the 2-norm. First, we will sample a lot of vectors on the unit circle in ","position":{"start":{"line":1053,"column":1},"end":{"line":1053,"column":1}},"key":"cgWE9XRd9A"},{"type":"inlineMath","value":"\\mathbb{R}^2","position":{"start":{"line":1053,"column":1},"end":{"line":1053,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi mathvariant=\"double-struck\">R</mi><mn>2</mn></msup></mrow><annotation encoding=\"application/x-tex\">\\mathbb{R}^2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathbb\">R</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span>","key":"mcQ6XcnHuq"},{"type":"text","value":".","position":{"start":{"line":1053,"column":1},"end":{"line":1053,"column":1}},"key":"drgslhRJGc"}],"key":"lChjNIR2Iy"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"theta = linspace(0, 2*pi, 601)\nx = vstack([cos(theta), sin(theta)])  # 601 unit columns","key":"q143cwzNAM"},{"type":"output","id":"Y-frTG_5uTAO1XFYgXr25","data":[],"key":"MTg4Ic40P4"}],"data":{},"key":"guDbDMvQbu"},{"type":"paragraph","position":{"start":{"line":1060,"column":1},"end":{"line":1060,"column":1}},"children":[{"type":"text","value":"The linear function ","position":{"start":{"line":1060,"column":1},"end":{"line":1060,"column":1}},"key":"kAdVR4txmk"},{"type":"inlineMath","value":"\\mathbf{f}(\\mathbf{x}) = \\mathbf{A}\\mathbf{x}","position":{"start":{"line":1060,"column":1},"end":{"line":1060,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">f</mi><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi mathvariant=\"bold\">A</mi><mi mathvariant=\"bold\">x</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{f}(\\mathbf{x}) = \\mathbf{A}\\mathbf{x}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.10903em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathbf\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">Ax</span></span></span></span>","key":"yvx2SesXWd"},{"type":"text","value":" defines a mapping from ","position":{"start":{"line":1060,"column":1},"end":{"line":1060,"column":1}},"key":"WaHaf4rfaq"},{"type":"inlineMath","value":"\\mathbb{R}^2","position":{"start":{"line":1060,"column":1},"end":{"line":1060,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi mathvariant=\"double-struck\">R</mi><mn>2</mn></msup></mrow><annotation encoding=\"application/x-tex\">\\mathbb{R}^2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathbb\">R</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span>","key":"iMaRdYcogc"},{"type":"text","value":" to ","position":{"start":{"line":1060,"column":1},"end":{"line":1060,"column":1}},"key":"CbG4IXRlyJ"},{"type":"inlineMath","value":"\\mathbb{R}^2","position":{"start":{"line":1060,"column":1},"end":{"line":1060,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi mathvariant=\"double-struck\">R</mi><mn>2</mn></msup></mrow><annotation encoding=\"application/x-tex\">\\mathbb{R}^2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathbb\">R</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span>","key":"l5D9kLf2zV"},{"type":"text","value":". We can apply ","position":{"start":{"line":1060,"column":1},"end":{"line":1060,"column":1}},"key":"F2TqLQrmoX"},{"type":"inlineCode","value":"A","position":{"start":{"line":1060,"column":1},"end":{"line":1060,"column":1}},"key":"el4VD0Zzup"},{"type":"text","value":" to every column of ","position":{"start":{"line":1060,"column":1},"end":{"line":1060,"column":1}},"key":"eRI6NOzvMb"},{"type":"inlineCode","value":"x","position":{"start":{"line":1060,"column":1},"end":{"line":1060,"column":1}},"key":"elSnWfFMfs"},{"type":"text","value":" simply by using a matrix multiplication.","position":{"start":{"line":1060,"column":1},"end":{"line":1060,"column":1}},"key":"uQln8SS2XO"}],"key":"x88yX4ncuf"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"y = A @ x","key":"Iw4HeRa8ci"},{"type":"output","id":"yooeMyJjNW4IS81VGdg6U","data":[],"key":"CTHXUecwRZ"}],"data":{},"key":"Zt0SMvCoGe"},{"type":"paragraph","position":{"start":{"line":1066,"column":1},"end":{"line":1066,"column":1}},"children":[{"type":"text","value":"We plot the unit circle on the left and the image of all mapped vectors on the right:","position":{"start":{"line":1066,"column":1},"end":{"line":1066,"column":1}},"key":"RJ4IXYH09f"}],"key":"XmyI1ZZfrH"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"subplot(1,2,1)\nplot(x[0, :], x[1, :])\naxis(\"equal\")\ntitle(\"Unit circle\")\nxlabel(\"$x_1$\")\nylabel(\"$x_2$\")\n\nsubplot(1,2,2)\nplot(y[0, :], y[1, :])\nplot(norm(A, 2) * x[0, :], norm(A,2) * x[1, :],\"--\")\naxis(\"equal\")\ntitle(\"Image under map\")\nxlabel(\"$y_1$\")\nylabel(\"$y_2$\");","key":"J0yVjDzH3L"},{"type":"output","id":"SYBNnWuzvPl6ZR1zV2Moa","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 2 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"fad65339a0a64c60751c8df3e4ba170d","path":"/fnc/build/fad65339a0a64c60751c8df3e4ba170d.png"}}}],"key":"nYIC4BrzcM"}],"data":{},"key":"o374va9TpU"},{"type":"paragraph","position":{"start":{"line":1085,"column":1},"end":{"line":1085,"column":1}},"children":[{"type":"text","value":"As seen on the right-side plot, the image of the transformed vectors is an ellipse that just touches the circle of radius ","position":{"start":{"line":1085,"column":1},"end":{"line":1085,"column":1}},"key":"zMF1V6hp5M"},{"type":"inlineMath","value":"\\|\\mathbf{A}\\|_2","position":{"start":{"line":1085,"column":1},"end":{"line":1085,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">∥</mi><mi mathvariant=\"bold\">A</mi><msub><mi mathvariant=\"normal\">∥</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\|\\mathbf{A}\\|_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">∥</span><span class=\"mord mathbf\">A</span><span class=\"mord\"><span class=\"mord\">∥</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"RN37ICXxjR"},{"type":"text","value":".","position":{"start":{"line":1085,"column":1},"end":{"line":1085,"column":1}},"key":"eTjdbhLCoa"}],"key":"xcE4SJ7Qwz"}],"label":"demo-norms-matrix-python","identifier":"demo-norms-matrix-python","html_id":"demo-norms-matrix-python","key":"O5A9hoN8vq"},{"type":"heading","depth":3,"position":{"start":{"line":1089,"column":1},"end":{"line":1089,"column":1}},"children":[{"type":"text","value":"Section 2.8","position":{"start":{"line":1089,"column":1},"end":{"line":1089,"column":1}},"key":"txJu7WHMgp"}],"identifier":"section-2-8","label":"Section 2.8","html_id":"section-2-8","implicit":true,"key":"g8DBniBmcY"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Matrix condition number","position":{"start":{"line":1091,"column":1},"end":{"line":1091,"column":1}},"key":"UKYhW86ZeK"}],"key":"xjYUKfK56X"},{"type":"paragraph","position":{"start":{"line":1096,"column":1},"end":{"line":1096,"column":1}},"children":[{"type":"text","value":"The function ","position":{"start":{"line":1096,"column":1},"end":{"line":1096,"column":1}},"key":"P8wtq7htNh"},{"type":"inlineCode","value":"cond","position":{"start":{"line":1096,"column":1},"end":{"line":1096,"column":1}},"key":"fTXDba0kkZ"},{"type":"text","value":" from ","position":{"start":{"line":1096,"column":1},"end":{"line":1096,"column":1}},"key":"Of2OsPEBFP"},{"type":"inlineCode","value":"numpy.linalg","position":{"start":{"line":1096,"column":1},"end":{"line":1096,"column":1}},"key":"IAWljPOAn9"},{"type":"text","value":" is used to computes matrix condition numbers. By default, the 2-norm is used. As an example, the family of ","position":{"start":{"line":1096,"column":1},"end":{"line":1096,"column":1}},"key":"IRic7HIRCJ"},{"type":"emphasis","position":{"start":{"line":1096,"column":1},"end":{"line":1096,"column":1}},"children":[{"type":"text","value":"Hilbert matrices","position":{"start":{"line":1096,"column":1},"end":{"line":1096,"column":1}},"key":"tOPpmBTN2J"}],"key":"BrQOhlEWTW"},{"type":"text","value":" is famously badly conditioned. Here is the ","position":{"start":{"line":1096,"column":1},"end":{"line":1096,"column":1}},"key":"mxyxm3qOFP"},{"type":"inlineMath","value":"6\\times 6","position":{"start":{"line":1096,"column":1},"end":{"line":1096,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>6</mn><mo>×</mo><mn>6</mn></mrow><annotation encoding=\"application/x-tex\">6\\times 6</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">6</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">6</span></span></span></span>","key":"b35bW8TofP"},{"type":"text","value":"  case.","position":{"start":{"line":1096,"column":1},"end":{"line":1096,"column":1}},"key":"Efktre6RPa"}],"indexEntries":[{"entry":"Python","subEntry":{"value":"cond","kind":"entry"},"emphasis":true}],"label":"index-Tw24eQDrp1","identifier":"index-tw24eqdrp1","html_id":"index-tw24eqdrp1","key":"IaQtCLap8z"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"A = array([ \n    [1/(i + j + 2) for j in range(6)] \n    for i in range(6) \n    ])\nprint(A)","key":"TsF3jhbdAu"},{"type":"output","id":"ddGnhQpZvA64rvADfvGsm","data":[{"output_type":"stream","name":"stdout","text":"[[0.5        0.33333333 0.25       0.2        0.16666667 0.14285714]\n [0.33333333 0.25       0.2        0.16666667 0.14285714 0.125     ]\n [0.25       0.2        0.16666667 0.14285714 0.125      0.11111111]\n [0.2        0.16666667 0.14285714 0.125      0.11111111 0.1       ]\n [0.16666667 0.14285714 0.125      0.11111111 0.1        0.09090909]\n [0.14285714 0.125      0.11111111 0.1        0.09090909 0.08333333]]\n"}],"key":"JKsNjvDCC7"}],"data":{},"key":"WM2f0WQQOs"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from numpy.linalg import cond\nkappa = cond(A)\nprint(f\"kappa is {kappa:.3e}\")","key":"VRLFF21y8Q"},{"type":"output","id":"AF2QVZ2IwSBknbdB-5U94","data":[{"output_type":"stream","name":"stdout","text":"kappa is 5.110e+07\n"}],"key":"UWnrWQPbNd"}],"data":{},"key":"nqKX41Z60Q"},{"type":"paragraph","position":{"start":{"line":1112,"column":1},"end":{"line":1112,"column":1}},"children":[{"type":"text","value":"Next we engineer a linear system problem to which we know the exact answer.","position":{"start":{"line":1112,"column":1},"end":{"line":1112,"column":1}},"key":"PHyhUNscVe"}],"key":"luPTjBbziF"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"x_exact = 1.0 + arange(6)\nb = A @ x_exact","key":"wkjtQJAHbx"},{"type":"output","id":"_ibo_3buSHLKVaHVOy-1H","data":[],"key":"i4IVrEGuQj"}],"data":{},"key":"EKlIBNfUlA"},{"type":"paragraph","position":{"start":{"line":1119,"column":1},"end":{"line":1119,"column":1}},"children":[{"type":"text","value":"Now we perturb the data randomly with a vector of norm ","position":{"start":{"line":1119,"column":1},"end":{"line":1119,"column":1}},"key":"Kaizxnd1Wk"},{"type":"span","position":{"start":{"line":1119,"column":1},"end":{"line":1119,"column":1}},"children":[{"type":"text","value":"10","key":"UM45N5T72X"},{"type":"superscript","children":[{"type":"text","value":"-12","key":"Y4kRcRTVlU"}],"key":"kT3ABZroVe"}],"key":"gpOc0SFgPw"},{"type":"text","value":".","position":{"start":{"line":1119,"column":1},"end":{"line":1119,"column":1}},"key":"Q3Sswyk3qZ"}],"key":"PwipMzaed6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"dA = random.randn(6, 6)\ndA = 1e-12 * (dA / norm(dA, 2))\ndb = random.randn(6)\ndb = 1e-12 * (db / norm(db, 2))","key":"i7a6vafprs"},{"type":"output","id":"AYWSsD102UMZYeP8-kwzf","data":[],"key":"rOZ3bcf18f"}],"data":{},"key":"FB8EKh7JJc"},{"type":"paragraph","position":{"start":{"line":1128,"column":1},"end":{"line":1128,"column":1}},"children":[{"type":"text","value":"We solve the perturbed problem using built-in pivoted ","key":"mhFVAmYHCR"},{"type":"abbreviation","title":"lower triangular times upper triangular","children":[{"type":"text","value":"LU","key":"UW5riaZeUi"}],"key":"RUykUIsTeh"},{"type":"text","value":" and see how the solution was changed.","key":"jJNBHvlK8v"}],"key":"qx18xi2GE0"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"x = solve(A + dA, b + db) \ndx = x - x_exact","key":"qlEveSxeos"},{"type":"output","id":"h-9impCcwk0rZ3duk-ihM","data":[],"key":"ndVeYZ4xIO"}],"data":{},"key":"XF2j0HJvby"},{"type":"paragraph","position":{"start":{"line":1135,"column":1},"end":{"line":1135,"column":1}},"children":[{"type":"text","value":"Here is the relative error in the solution.","position":{"start":{"line":1135,"column":1},"end":{"line":1135,"column":1}},"key":"qniLjrvaCl"}],"key":"jADLfgJLU3"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(f\"relative error is {norm(dx) / norm(x_exact):.2e}\")","key":"jLCFOfkiv4"},{"type":"output","id":"P2KWBdoFKFlWPuYW3WkXx","data":[{"output_type":"stream","name":"stdout","text":"relative error is 1.10e-05\n"}],"key":"ZupmGU65c0"}],"data":{},"key":"FChoSZFKwd"},{"type":"paragraph","position":{"start":{"line":1141,"column":1},"end":{"line":1141,"column":1}},"children":[{"type":"text","value":"And here are upper bounds predicted using the condition number of the original matrix.","position":{"start":{"line":1141,"column":1},"end":{"line":1141,"column":1}},"key":"iCduzK0gi3"}],"key":"z7bhTiyf7P"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(f\"b_bound: {kappa * 1e-12 / norm(b):.2e}\")\nprint(f\"A_bound: {kappa * 1e-12 / norm(A, 2):.2e}\")","key":"xxejLCZvta"},{"type":"output","id":"FxJa-8Ow6UBqOiDPvwsxP","data":[{"output_type":"stream","name":"stdout","text":"b_bound: 6.72e-06\nA_bound: 4.57e-05\n"}],"key":"gFw3SYJ0li"}],"data":{},"key":"Y1XIe9EpC5"},{"type":"paragraph","position":{"start":{"line":1148,"column":1},"end":{"line":1148,"column":1}},"children":[{"type":"text","value":"Even if we don’t make any manual perturbations to the data, machine epsilon does when we solve the linear system numerically.","position":{"start":{"line":1148,"column":1},"end":{"line":1148,"column":1}},"key":"hGOg5SSgKU"}],"key":"PbB6dU9GtY"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"x = solve(A, b)\nprint(f\"relative error: {norm(x - x_exact) / norm(x_exact):.2e}\")\nprint(f\"rounding bound: {kappa / 2**52:.2e}\")","key":"qn1RV7knPF"},{"type":"output","id":"m8zx0wewgvX4gd4kxJCHC","data":[{"output_type":"stream","name":"stdout","text":"relative error: 6.85e-10\nrounding bound: 1.13e-08\n"}],"key":"RR8iP2vk7t"}],"data":{},"key":"bGMoQkDjaD"},{"type":"paragraph","position":{"start":{"line":1157,"column":1},"end":{"line":1157,"column":1}},"children":[{"type":"text","value":"Because ","position":{"start":{"line":1157,"column":1},"end":{"line":1157,"column":1}},"key":"volcnL4YEa"},{"type":"inlineMath","value":"\\kappa\\approx 10^8","position":{"start":{"line":1157,"column":1},"end":{"line":1157,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>κ</mi><mo>≈</mo><mn>1</mn><msup><mn>0</mn><mn>8</mn></msup></mrow><annotation encoding=\"application/x-tex\">\\kappa\\approx 10^8</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4831em;\"></span><span class=\"mord mathnormal\">κ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">8</span></span></span></span></span></span></span></span></span></span></span>","key":"YwptSBEP3t"},{"type":"text","value":", it’s possible to lose 8 digits of accuracy in the process of passing from ","position":{"start":{"line":1157,"column":1},"end":{"line":1157,"column":1}},"key":"pNVWNMeRCf"},{"type":"inlineMath","value":"A","position":{"start":{"line":1157,"column":1},"end":{"line":1157,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi></mrow><annotation encoding=\"application/x-tex\">A</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">A</span></span></span></span>","key":"M0OA9N7pep"},{"type":"text","value":" and ","position":{"start":{"line":1157,"column":1},"end":{"line":1157,"column":1}},"key":"eDL1ZxGDAG"},{"type":"inlineMath","value":"b","position":{"start":{"line":1157,"column":1},"end":{"line":1157,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>b</mi></mrow><annotation encoding=\"application/x-tex\">b</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">b</span></span></span></span>","key":"YMohQj4Ob8"},{"type":"text","value":" to ","position":{"start":{"line":1157,"column":1},"end":{"line":1157,"column":1}},"key":"Qbmiiwk1sW"},{"type":"inlineMath","value":"x","position":{"start":{"line":1157,"column":1},"end":{"line":1157,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"KZSDfLwo5L"},{"type":"text","value":". That’s independent of the algorithm; it’s inevitable once the data are expressed in double precision.","position":{"start":{"line":1157,"column":1},"end":{"line":1157,"column":1}},"key":"gpYcB5FG7J"}],"key":"S0AtP30rN7"},{"type":"paragraph","position":{"start":{"line":1159,"column":1},"end":{"line":1159,"column":1}},"children":[{"type":"text","value":"Larger Hilbert matrices are even more poorly conditioned.","position":{"start":{"line":1159,"column":1},"end":{"line":1159,"column":1}},"key":"pPOqtxdcWi"}],"key":"XpebhCxl9z"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"A = array([ [1/(i+j+2) for j in range(14)] for i in range(14) ])\nkappa = cond(A)\nprint(f\"kappa is {kappa:.3e}\")","key":"beqScWpPCl"},{"type":"output","id":"NwqtPhpol7xmFv52Z0lI3","data":[{"output_type":"stream","name":"stdout","text":"kappa is 1.436e+19\n"}],"key":"iQXKXpcze4"}],"data":{},"key":"HCkERKOyKj"},{"type":"paragraph","position":{"start":{"line":1167,"column":1},"end":{"line":1167,"column":1}},"children":[{"type":"text","value":"Before we compute the solution, note that ","position":{"start":{"line":1167,"column":1},"end":{"line":1167,"column":1}},"key":"Mk87pM0WNi"},{"type":"text","value":"κ","position":{"start":{"line":1167,"column":1},"end":{"line":1167,"column":1}},"key":"DLFVyOwpBb"},{"type":"text","value":" exceeds ","position":{"start":{"line":1167,"column":1},"end":{"line":1167,"column":1}},"key":"sUvPmXHDrD"},{"type":"inlineCode","value":"1/eps","position":{"start":{"line":1167,"column":1},"end":{"line":1167,"column":1}},"key":"Mkuw4kHf6G"},{"type":"text","value":". In principle we therefore might end up with an answer that is completely wrong (i.e., a relative error greater than 100%).","position":{"start":{"line":1167,"column":1},"end":{"line":1167,"column":1}},"key":"D17WHdyc7N"}],"key":"MeCt4ukK4j"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(f\"rounding bound: {kappa / 2**52:.2e}\")","key":"hnT121psEV"},{"type":"output","id":"QFZu8V4eA0ZHxsnBsMVH7","data":[{"output_type":"stream","name":"stdout","text":"rounding bound: 3.19e+03\n"}],"key":"iIp9QM8lFJ"}],"data":{},"key":"T1ToJz1rzM"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"x_exact = 1.0 + arange(14)\nb = A @ x_exact  \nx = solve(A, b)","key":"M5x6RHplm7"},{"type":"output","id":"6PiOnFnkIH30pdbc-80Mf","data":[],"key":"sTzOlHVomJ"}],"data":{},"key":"QDebtmEZH6"},{"type":"paragraph","position":{"start":{"line":1179,"column":1},"end":{"line":1179,"column":1}},"children":[{"type":"text","value":"We got an answer. But in fact, the error does exceed 100%:","position":{"start":{"line":1179,"column":1},"end":{"line":1179,"column":1}},"key":"k8UqROzOnP"}],"key":"U895ooAbsP"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(f\"relative error: {norm(x - x_exact) / norm(x_exact):.2e}\")","key":"jFqw4GxG9T"},{"type":"output","id":"tSr5522DXapbXymqIjGJa","data":[{"output_type":"stream","name":"stdout","text":"relative error: 1.42e+01\n"}],"key":"OG7dJ7cu7H"}],"data":{},"key":"ej2B2XUYXX"}],"label":"demo-condition-bound-python","identifier":"demo-condition-bound-python","html_id":"demo-condition-bound-python","key":"gYXSAx2XO4"},{"type":"heading","depth":3,"position":{"start":{"line":1186,"column":1},"end":{"line":1186,"column":1}},"children":[{"type":"text","value":"Section 2.9","position":{"start":{"line":1186,"column":1},"end":{"line":1186,"column":1}},"key":"noXSMV8a57"}],"identifier":"section-2-9","label":"Section 2.9","html_id":"section-2-9","implicit":true,"key":"Jsjfoo9jsm"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Banded matrices","position":{"start":{"line":1188,"column":1},"end":{"line":1188,"column":1}},"key":"jdieMRzuj2"}],"key":"HO6cl9Y60y"},{"type":"paragraph","position":{"start":{"line":1189,"column":1},"end":{"line":1189,"column":1}},"children":[{"type":"text","value":"Here is a matrix with both lower and upper bandwidth equal to one. Such a matrix is called tridiagonal.","position":{"start":{"line":1189,"column":1},"end":{"line":1189,"column":1}},"key":"FtPAa6zSfB"}],"key":"D2CvpjO6yH"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"A = array([ \n    [2, -1,  0,  0,  0,  0],\n    [4,  2, -1,  0,  0,  0],\n    [0,  3,  0, -1,  0,  0],\n    [0,  0,  2,  2, -1,  0],\n    [0,  0,  0,  1,  1, -1],\n    [0,  0,  0,  0,  0,  2 ]\n    ])","key":"xtvh9Ngj6v"},{"type":"output","id":"3INgentszeWd2PBm9XVwC","data":[],"key":"Zqb35ZV17S"}],"data":{},"key":"ZSecPYv03k"},{"type":"paragraph","position":{"start":{"line":1205,"column":1},"end":{"line":1205,"column":1}},"children":[{"type":"text","value":"We can extract the elements on any diagonal using the ","position":{"start":{"line":1205,"column":1},"end":{"line":1205,"column":1}},"key":"uWOqdwdDpp"},{"type":"inlineCode","value":"diag","position":{"start":{"line":1205,"column":1},"end":{"line":1205,"column":1}},"key":"qQ2z1JeAqH"},{"type":"text","value":" command. The “main” or central diagonal is numbered zero, above and to the right of that is positive, and below and to the left is negative.","position":{"start":{"line":1205,"column":1},"end":{"line":1205,"column":1}},"key":"JQhHL6xV4X"}],"indexEntries":[{"entry":"Python","subEntry":{"value":"diag","kind":"entry"},"emphasis":true}],"label":"index-muplJcoVt1","identifier":"index-mupljcovt1","html_id":"index-mupljcovt1","key":"kbS53mRDYL"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print( diag(A) )","key":"XbKiDHbb6O"},{"type":"output","id":"h2WPqZdh0bTT9fip_jUNw","data":[{"output_type":"stream","name":"stdout","text":"[2 2 0 2 1 2]\n"}],"key":"DaeU0tafhy"}],"data":{},"key":"h8Bm2QKMAd"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print( diag(A, 1) )","key":"LoLznqaWMj"},{"type":"output","id":"T8-4m3XV5YePHIKyyo-wY","data":[{"output_type":"stream","name":"stdout","text":"[-1 -1 -1 -1 -1]\n"}],"key":"jyjpYJOsKE"}],"data":{},"key":"nibWfGgL3I"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print( diag(A, -1) )","key":"MFUi6P6JpG"},{"type":"output","id":"pd-EpA6okxUdkpl851xba","data":[{"output_type":"stream","name":"stdout","text":"[4 3 2 1 0]\n"}],"key":"sY4Xj8ssh9"}],"data":{},"key":"smkNaumm8w"},{"type":"paragraph","position":{"start":{"line":1219,"column":1},"end":{"line":1219,"column":1}},"children":[{"type":"text","value":"We can also construct matrices by specifying a diagonal with the ","position":{"start":{"line":1219,"column":1},"end":{"line":1219,"column":1}},"key":"jYz83FidQ2"},{"type":"inlineCode","value":"diag","position":{"start":{"line":1219,"column":1},"end":{"line":1219,"column":1}},"key":"R3hBEz1e68"},{"type":"text","value":" function.","position":{"start":{"line":1219,"column":1},"end":{"line":1219,"column":1}},"key":"Yp1T83qSxB"}],"key":"UBmFLyK5p5"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"A = A + diag([pi, 8, 6, 7], 2)\nprint(A)","key":"SMERRIjY5w"},{"type":"output","id":"5r2g_v0Wg_KF0XLOoSj0X","data":[{"output_type":"stream","name":"stdout","text":"[[ 2.         -1.          3.14159265  0.          0.          0.        ]\n [ 4.          2.         -1.          8.          0.          0.        ]\n [ 0.          3.          0.         -1.          6.          0.        ]\n [ 0.          0.          2.          2.         -1.          7.        ]\n [ 0.          0.          0.          1.          1.         -1.        ]\n [ 0.          0.          0.          0.          0.          2.        ]]\n"}],"key":"kFHHt59WZ6"}],"data":{},"key":"K39MZpizUB"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"L, U = FNC.lufact(A)\nprint(L)","key":"YwWbwBtBC6"},{"type":"output","id":"syLDEyrjI8Vs10cVy8wez","data":[{"output_type":"stream","name":"stdout","text":"[[1.         0.         0.         0.         0.         0.        ]\n [2.         1.         0.         0.         0.         0.        ]\n [0.         0.75       1.         0.         0.         0.        ]\n [0.         0.         0.36614016 1.         0.         0.        ]\n [0.         0.         0.         0.21915497 1.         0.        ]\n [0.         0.         0.         0.         0.         1.        ]]\n"}],"key":"lugZjoFQAs"}],"data":{},"key":"DrnmRo9v8J"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(U)","key":"ACEsLloooK"},{"type":"output","id":"ePQ45fY1PXnRl4nJuDXmV","data":[{"output_type":"stream","name":"stdout","text":"[[ 2.         -1.          3.14159265  0.          0.          0.        ]\n [ 0.          4.         -7.28318531  8.          0.          0.        ]\n [ 0.          0.          5.46238898 -7.          6.          0.        ]\n [ 0.          0.          0.          4.56298115 -3.19684099  7.        ]\n [ 0.          0.          0.          0.          1.70060359 -2.53408479]\n [ 0.          0.          0.          0.          0.          2.        ]]\n"}],"key":"rlhXd5LBI1"}],"data":{},"key":"ZYIuLFz5NT"},{"type":"paragraph","position":{"start":{"line":1235,"column":1},"end":{"line":1235,"column":1}},"children":[{"type":"text","value":"Observe above that the lower and upper bandwidths of ","position":{"start":{"line":1235,"column":1},"end":{"line":1235,"column":1}},"key":"xVVeSMXN43"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":1235,"column":1},"end":{"line":1235,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"Ug7xeSbOGC"},{"type":"text","value":" are preserved in the factor matrices.","position":{"start":{"line":1235,"column":1},"end":{"line":1235,"column":1}},"key":"dgiJTIEgG4"}],"key":"kcDIoTLLe3"}],"label":"demo-structure-banded-python","identifier":"demo-structure-banded-python","html_id":"demo-structure-banded-python","key":"PcsfPXsM1L"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Timing banded ","key":"cPfL9yfv03"},{"type":"abbreviation","title":"lower triangular times upper triangular","children":[{"type":"text","value":"LU","key":"kLYu1lTUhp"}],"key":"x8pS6Q3XAT"}],"key":"F7USO9H12p"},{"type":"paragraph","position":{"start":{"line":1241,"column":1},"end":{"line":1241,"column":1}},"children":[{"type":"text","value":"We’ll use a large banded matrix to observe the speedup possible in ","key":"q75lW3Bovd"},{"type":"abbreviation","title":"lower triangular times upper triangular","children":[{"type":"text","value":"LU","key":"SFjBNLFh5y"}],"key":"JiwjUfbtpG"},{"type":"text","value":" factorization. If we use an ordinary dense matrix, then there’s no way to exploit a banded structure:","key":"XrGTPy5Juh"}],"key":"AmGjm8czhP"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"n = 8000\nmain = 1 + arange(n)\nplusone = linspace(n-1, 1, n-1)\nminusone = ones(n-1)\nA = diag(main) + diag(plusone,1) + diag(minusone,1)","key":"YeSaxynPr8"},{"type":"output","id":"3sPzHMyVeBzTrEBnXiZge","data":[],"key":"izacw6V0cF"}],"data":{},"key":"YGD7li4O5i"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from scipy.linalg import lu\nstart = timer()\nlu(A)\nprint(f\"time for dense banded: {timer() - start:.5f}\")","key":"b5w3W6uj1E"},{"type":"output","id":"eD2D6f3uS5FB7GTQ99_RH","data":[{"output_type":"stream","name":"stdout","text":"time for dense banded: 2.49970\n"}],"key":"rvGedOBg7Z"}],"data":{},"key":"L0rSM0MKVV"},{"type":"paragraph","position":{"start":{"line":1258,"column":1},"end":{"line":1258,"column":1}},"children":[{"type":"text","value":"If instead we construct a proper sparse matrix, the speedup can be dramatic.","position":{"start":{"line":1258,"column":1},"end":{"line":1258,"column":1}},"key":"lQsf6bexxM"}],"key":"nFtpQr4vqg"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from scipy.sparse import diags\nfrom scipy.sparse.linalg import splu\nA = diags([main, plusone, minusone], [0, 1, -1], format=\"csc\")\nstart = timer()\nsplu(A)\nprint(f\"time for sparse banded: {timer() - start:.5f}\")","key":"yxbI1iTePT"},{"type":"output","id":"lrpVVypWOIHYkB5Eyf025","data":[{"output_type":"stream","name":"stdout","text":"time for sparse banded: 0.00422\n"}],"key":"dgcQ28hUNs"}],"data":{},"indexEntries":[{"entry":"Python","subEntry":{"value":"diags","kind":"entry"},"emphasis":true},{"entry":"Python","subEntry":{"value":"splu","kind":"entry"},"emphasis":true}],"label":"index-d7ZZLb8rDC","identifier":"index-d7zzlb8rdc","html_id":"index-d7zzlb8rdc","key":"CX5WmfjzUB"}],"label":"demo-structure-timing-python","identifier":"demo-structure-timing-python","html_id":"demo-structure-timing-python","key":"cfYx0qVynE"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Symmetric LDL","position":{"start":{"line":1274,"column":1},"end":{"line":1274,"column":1}},"key":"AOOzweaCtE"},{"type":"superscript","position":{"start":{"line":1274,"column":1},"end":{"line":1274,"column":1}},"children":[{"type":"text","value":"T","key":"qSi9olsKt4"}],"key":"z27sz7oFZ4"},{"type":"text","value":" factorization","position":{"start":{"line":1274,"column":1},"end":{"line":1274,"column":1}},"key":"lI72wvLD7Y"}],"key":"epGflOhWsu"},{"type":"paragraph","position":{"start":{"line":1275,"column":1},"end":{"line":1275,"column":1}},"children":[{"type":"text","value":"We begin with a symmetric ","position":{"start":{"line":1275,"column":1},"end":{"line":1275,"column":1}},"key":"UeByWfAgAn"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":1275,"column":1},"end":{"line":1275,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"OyX7BipVho"},{"type":"text","value":".","position":{"start":{"line":1275,"column":1},"end":{"line":1275,"column":1}},"key":"WGAf9SWwPv"}],"key":"NgjwETySsB"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"A_1 = array([\n    [2,     4,     4,     2],\n    [4,     5,     8,    -5],\n    [4,     8,     6,     2],\n    [2,    -5,     2,   -26]\n    ])","key":"He9pwcwsjm"},{"type":"output","id":"pDTcufjob1a1RPb0Lrj-t","data":[],"key":"D4SnAeuK5E"}],"data":{},"key":"sTix5xMmlh"},{"type":"paragraph","position":{"start":{"line":1286,"column":1},"end":{"line":1286,"column":1}},"children":[{"type":"text","value":"We won’t use pivoting, so the pivot element is at position (1,1). This will become the first element on the diagonal of ","position":{"start":{"line":1286,"column":1},"end":{"line":1286,"column":1}},"key":"EwPQSzbTqN"},{"type":"inlineMath","value":"\\mathbf{D}","position":{"start":{"line":1286,"column":1},"end":{"line":1286,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">D</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{D}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">D</span></span></span></span>","key":"drJlf3uufn"},{"type":"text","value":". Then we divide by that pivot to get the first column of ","position":{"start":{"line":1286,"column":1},"end":{"line":1286,"column":1}},"key":"XcLvp3pBUl"},{"type":"inlineMath","value":"\\mathbf{L}","position":{"start":{"line":1286,"column":1},"end":{"line":1286,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">L</span></span></span></span>","key":"OK0KJohvk1"},{"type":"text","value":".","position":{"start":{"line":1286,"column":1},"end":{"line":1286,"column":1}},"key":"OX5fdtLEle"}],"key":"SFvCQAPjAi"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"L = eye(4)\nd = zeros(4)\nd[0] = A_1[0, 0]\nL[:, 0] = A_1[:, 0] / d[0]\nA_2 = A_1 - d[0] * outer(L[:, 0], L[:, 0])\nprint(A_2)","key":"PSFYgK0Phs"},{"type":"output","id":"n7CqsRJt4gjqI0S3kiz-N","data":[{"output_type":"stream","name":"stdout","text":"[[  0.   0.   0.   0.]\n [  0.  -3.   0.  -9.]\n [  0.   0.  -2.  -2.]\n [  0.  -9.  -2. -28.]]\n"}],"key":"lWw2hQkBIM"}],"data":{},"key":"HLLSTNOjvt"},{"type":"paragraph","position":{"start":{"line":1296,"column":1},"end":{"line":1296,"column":1}},"children":[{"type":"text","value":"We are now set up the same way for the submatrix in rows and columns 2–4.","position":{"start":{"line":1296,"column":1},"end":{"line":1296,"column":1}},"key":"QIsxGr3Wzj"}],"key":"rEPevc3MkB"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"d[1] = A_2[1, 1]\nL[:, 1] = A_2[:, 1] / d[1]\nA_3 = A_2 - d[1] * outer(L[:, 1], L[:, 1])\nprint(A_3)","key":"hzt8mQJAzL"},{"type":"output","id":"h3w524tA8Gdx6lsb1Tpa8","data":[{"output_type":"stream","name":"stdout","text":"[[ 0.  0.  0.  0.]\n [ 0.  0.  0.  0.]\n [ 0.  0. -2. -2.]\n [ 0.  0. -2. -1.]]\n"}],"key":"ebRMpLlPid"}],"data":{},"key":"CNrmLE2YYP"},{"type":"paragraph","position":{"start":{"line":1305,"column":1},"end":{"line":1305,"column":1}},"children":[{"type":"text","value":"We continue working our way down the diagonal.","position":{"start":{"line":1305,"column":1},"end":{"line":1305,"column":1}},"key":"Ft9jFAloMM"}],"key":"Z22uRlqkNM"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"d[2] = A_3[2, 2]\nL[:, 2] = A_3[:, 2] / d[2]\nA_4 = A_3 - d[2] * outer(L[:, 2], L[:, 2])\nprint(A_4)","key":"dsW6ROPdDx"},{"type":"output","id":"DaeOKryBn3VqSrXs7uW4_","data":[{"output_type":"stream","name":"stdout","text":"[[0. 0. 0. 0.]\n [0. 0. 0. 0.]\n [0. 0. 0. 0.]\n [0. 0. 0. 1.]]\n"}],"key":"skyJBe6T4R"}],"data":{},"key":"pK9Gy1D5Xx"},{"type":"paragraph","position":{"start":{"line":1314,"column":1},"end":{"line":1314,"column":1}},"children":[{"type":"text","value":"We have arrived at the desired factorization.","position":{"start":{"line":1314,"column":1},"end":{"line":1314,"column":1}},"key":"ffC9bxtxLn"}],"key":"IVzVQPNJIJ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"d[3] = A_4[3, 3]\nprint(\"diagonal of D:\")\nprint(d)\nprint(\"L:\")\nprint(L)","key":"ghkgk06xiK"},{"type":"output","id":"mv0Vem3sVjOYCawot6DgJ","data":[{"output_type":"stream","name":"stdout","text":"diagonal of D:\n[ 2. -3. -2.  1.]\nL:\n[[ 1. -0. -0.  0.]\n [ 2.  1. -0.  0.]\n [ 2. -0.  1.  0.]\n [ 1.  3.  1.  1.]]\n"}],"key":"oFTniKl0tC"}],"data":{},"key":"JdhiTH1fr1"},{"type":"paragraph","position":{"start":{"line":1324,"column":1},"end":{"line":1324,"column":1}},"children":[{"type":"text","value":"This should be comparable to machine roundoff:","position":{"start":{"line":1324,"column":1},"end":{"line":1324,"column":1}},"key":"F8NW7qZkju"}],"key":"BYFfngWB60"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(norm(A_1 - (L @ diag(d) @ L.T), 2) / norm(A_1))","key":"o286f2SmVy"},{"type":"output","id":"g404lzLz7oqsDR2oZu21A","data":[{"output_type":"stream","name":"stdout","text":"0.0\n"}],"key":"veYQrtcWFn"}],"data":{},"key":"JZa38qmEfz"}],"label":"demo-structure-symm-python","identifier":"demo-structure-symm-python","html_id":"demo-structure-symm-python","key":"bPp1vA7mMG"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Cholesky factorization","position":{"start":{"line":1332,"column":1},"end":{"line":1332,"column":1}},"key":"dct9x8CF8C"}],"key":"jEZKma5xZF"},{"type":"paragraph","position":{"start":{"line":1333,"column":1},"end":{"line":1333,"column":1}},"children":[{"type":"text","value":"A randomly chosen matrix is extremely unlikely to be symmetric. However, there is a simple way to symmetrize one.","position":{"start":{"line":1333,"column":1},"end":{"line":1333,"column":1}},"key":"tEoCJF0sp7"}],"key":"zGEvU5lCJ5"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"A = 1.0 + floor(9 * random.rand(4, 4))\nB = A + A.T\nprint(B)","key":"iJ7ZpBNYky"},{"type":"output","id":"5cUOmIOuQZzQGNQkes1wD","data":[{"output_type":"stream","name":"stdout","text":"[[12. 15. 11. 13.]\n [15.  4.  7. 14.]\n [11.  7. 16. 12.]\n [13. 14. 12. 18.]]\n"}],"key":"AEefZm0yl9"}],"data":{},"key":"yeahoA7XPX"},{"type":"paragraph","position":{"start":{"line":1341,"column":1},"end":{"line":1341,"column":1}},"children":[{"type":"text","value":"Similarly, a random symmetric matrix is unlikely to be positive definite. The Cholesky algorithm always detects a non-PD matrix by quitting with an error.","position":{"start":{"line":1341,"column":1},"end":{"line":1341,"column":1}},"key":"YfhK38uI8k"}],"key":"xLozJzStcc"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from numpy.linalg import cholesky\ncholesky(B)","visibility":"show","key":"eXV8P3d8j1"},{"type":"output","id":"cJPy7A194GY6-FkxsS3GD","data":[{"output_type":"error","traceback":"\u001b[0;31m---------------------------------------------------------------------------\u001b[0m\n\u001b[0;31mLinAlgError\u001b[0m                               Traceback (most recent call last)\nCell \u001b[0;32mIn[142], line 2\u001b[0m\n\u001b[1;32m      1\u001b[0m \u001b[38;5;28;01mfrom\u001b[39;00m \u001b[38;5;21;01mnumpy\u001b[39;00m\u001b[38;5;21;01m.\u001b[39;00m\u001b[38;5;21;01mlinalg\u001b[39;00m \u001b[38;5;28;01mimport\u001b[39;00m cholesky\n\u001b[0;32m----> 2\u001b[0m \u001b[43mcholesky\u001b[49m\u001b[43m(\u001b[49m\u001b[43mB\u001b[49m\u001b[43m)\u001b[49m\n\nFile \u001b[0;32m~/mambaforge/envs/myst/lib/python3.13/site-packages/numpy/linalg/_linalg.py:848\u001b[0m, in \u001b[0;36mcholesky\u001b[0;34m(a, upper)\u001b[0m\n\u001b[1;32m    845\u001b[0m signature \u001b[38;5;241m=\u001b[39m \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mD->D\u001b[39m\u001b[38;5;124m'\u001b[39m \u001b[38;5;28;01mif\u001b[39;00m isComplexType(t) \u001b[38;5;28;01melse\u001b[39;00m \u001b[38;5;124m'\u001b[39m\u001b[38;5;124md->d\u001b[39m\u001b[38;5;124m'\u001b[39m\n\u001b[1;32m    846\u001b[0m \u001b[38;5;28;01mwith\u001b[39;00m errstate(call\u001b[38;5;241m=\u001b[39m_raise_linalgerror_nonposdef, invalid\u001b[38;5;241m=\u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mcall\u001b[39m\u001b[38;5;124m'\u001b[39m,\n\u001b[1;32m    847\u001b[0m               over\u001b[38;5;241m=\u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mignore\u001b[39m\u001b[38;5;124m'\u001b[39m, divide\u001b[38;5;241m=\u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mignore\u001b[39m\u001b[38;5;124m'\u001b[39m, under\u001b[38;5;241m=\u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mignore\u001b[39m\u001b[38;5;124m'\u001b[39m):\n\u001b[0;32m--> 848\u001b[0m     r \u001b[38;5;241m=\u001b[39m \u001b[43mgufunc\u001b[49m\u001b[43m(\u001b[49m\u001b[43ma\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43msignature\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43msignature\u001b[49m\u001b[43m)\u001b[49m\n\u001b[1;32m    849\u001b[0m \u001b[38;5;28;01mreturn\u001b[39;00m wrap(r\u001b[38;5;241m.\u001b[39mastype(result_t, copy\u001b[38;5;241m=\u001b[39m\u001b[38;5;28;01mFalse\u001b[39;00m))\n\nFile \u001b[0;32m~/mambaforge/envs/myst/lib/python3.13/site-packages/numpy/linalg/_linalg.py:107\u001b[0m, in \u001b[0;36m_raise_linalgerror_nonposdef\u001b[0;34m(err, flag)\u001b[0m\n\u001b[1;32m    106\u001b[0m \u001b[38;5;28;01mdef\u001b[39;00m \u001b[38;5;21m_raise_linalgerror_nonposdef\u001b[39m(err, flag):\n\u001b[0;32m--> 107\u001b[0m     \u001b[38;5;28;01mraise\u001b[39;00m LinAlgError(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mMatrix is not positive definite\u001b[39m\u001b[38;5;124m\"\u001b[39m)\n\n\u001b[0;31mLinAlgError\u001b[0m: Matrix is not positive definite","ename":"LinAlgError","evalue":"Matrix is not positive definite"}],"visibility":"show","key":"frrUqqxOA2"}],"data":{"tags":["raises-exception"]},"indexEntries":[{"entry":"Python","subEntry":{"value":"cholesky","kind":"entry"},"emphasis":true}],"label":"index-IIOJC2NCj0","identifier":"index-iiojc2ncj0","html_id":"index-iiojc2ncj0","visibility":"show","key":"HVpK5dQJDg"},{"type":"paragraph","position":{"start":{"line":1352,"column":1},"end":{"line":1352,"column":1}},"children":[{"type":"text","value":"It’s not hard to manufacture an SPD matrix to try out the Cholesky factorization:","position":{"start":{"line":1352,"column":1},"end":{"line":1352,"column":1}},"key":"khA1u40gRU"}],"key":"zTz0oCqMsy"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"B = A.T @ A\nR = cholesky(B)\nprint(R)","key":"jynD9yvtc6"},{"type":"output","id":"zGGutWK41RvXqyn1ViGwG","data":[{"output_type":"stream","name":"stdout","text":"[[15.71623365  0.          0.          0.        ]\n [ 9.79878535  4.89732638  0.          0.        ]\n [ 8.52621582  0.50097566  5.00526394  0.        ]\n [14.12552174  1.14083565  2.39572224  2.725554  ]]\n"}],"key":"ZXIfZZMGeC"}],"data":{},"key":"u8yJBOPblx"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(norm(R @ R.T - B) / norm(B))","key":"DY1VxLvwUW"},{"type":"output","id":"mMWnyRTZ78JFrjgk4mCiC","data":[{"output_type":"stream","name":"stdout","text":"7.741499988965021e-17\n"}],"key":"pxbxRXO1L0"}],"data":{},"key":"eur8Axj9wm"}],"label":"demo-structure-cholesky-python","identifier":"demo-structure-cholesky-python","html_id":"demo-structure-cholesky-python","key":"LKCxWpqxJ5"}],"key":"LSHZoShIMq"}],"key":"BCflgf3lgq"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Chapter 1","url":"/chapter1-2","group":"Python codes"},"next":{"title":"Chapter 3","url":"/chapter3-2","group":"Python codes"}}},"domain":"http://localhost:3000"}