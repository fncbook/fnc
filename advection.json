{"kind":"Notebook","sha256":"ea4636c83b4cf59417fcd6066d1659f67889a963d7a56cfa75cf30717904a525","slug":"advection","location":"/chapter12/section1/julia/advection.ipynb","dependencies":[],"frontmatter":{"numbering":{"heading_1":{"enabled":false},"heading_2":{"enabled":false},"heading_3":{"enabled":false},"heading_4":{"enabled":false},"heading_5":{"enabled":false},"heading_6":{"enabled":false}},"kernelspec":{"name":"julia-1.11","display_name":"Julia 1","language":"julia"},"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"exports":[{"format":"ipynb","filename":"advection.ipynb","url":"/build/advection-a8fb9859f785a931e15bfcc0c289b6c3.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"RXkyljSsPt"},{"type":"text","value":"12.1.1","key":"pAMJGQw4OE"}],"key":"k24eNHmBzQ"}],"identifier":"demo-traffic-advection","label":"demo-traffic-advection","kind":"proof:example","template":"Example %s","enumerator":"12.1.1","resolved":true,"html_id":"demo-traffic-advection","remote":true,"url":"/traffic","dataUrl":"/traffic.json","key":"spihfp9Ubw"}],"key":"Pk7w5KsyPl"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"In the following definition we allow the velocity ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"ULMJABv4T1"},{"type":"inlineMath","value":"c","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>c</mi></mrow><annotation encoding=\"application/x-tex\">c</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">c</span></span></span></span>","key":"sgccbnaSLu"},{"type":"text","value":" to be specified as a parameter in the ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"A6ccOsgw46"},{"type":"inlineCode","value":"ODEProblem","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"N2z2Y3Rabm"},{"type":"text","value":".","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"JM1KUh2i7F"}],"key":"BuEV6oUCkX"}],"key":"S4SCBuWbCE"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:34:20.824000Z","iopub.status.busy":"2025-01-14T15:34:14.493000Z","iopub.execute_input":"2025-01-14T15:34:16.484000Z","shell.execute_reply":"2025-01-14T15:34:20.817000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"x, Dₓ, Dₓₓ = FNC.diffper(300, [-4, 4])\nf = (u, c, t) -> -c * (Dₓ*u);","key":"vGCYRz2C0p"},{"type":"output","id":"ABzfeKBobL5g9setekPbq","data":[],"key":"IqNrXZCkpg"}],"key":"b3kdeM6mBM"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The following initial condition isn’t mathematically periodic, but the deviation is less than machine precision. We specify RK4 as the solver.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"a7QUJp1Ilb"}],"key":"V0WQESehlr"}],"key":"NjfwQ96H5V"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:34:34.859000Z","iopub.status.busy":"2025-01-14T15:34:20.839000Z","iopub.execute_input":"2025-01-14T15:34:20.840000Z","shell.execute_reply":"2025-01-14T15:34:34.858000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"using OrdinaryDiffEq\nu_init = @. 1 + exp( -3x^2 )\nIVP = ODEProblem(f, u_init, (0., 4.), 2)\nsol = solve(IVP, RK4());","key":"UAp593dnxx"},{"type":"output","id":"S3ru8LBESYGDa1W1aB6r9","data":[],"key":"jpALArkNQE"}],"key":"rrONwp2Q2G"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:35:16.904000Z","iopub.status.busy":"2025-01-14T15:34:34.880000Z","iopub.execute_input":"2025-01-14T15:34:34.880000Z","shell.execute_reply":"2025-01-14T15:35:16.903000Z"},"tags":[]},"children":[{"type":"code","lang":"julia","executable":true,"value":"using Plots\nplt = plot(\n    legend=:bottomleft,\n    title=\"Advection with periodic boundary\",\n    xaxis=(L\"x\"),  yaxis=(L\"u(x,t)\"))\nfor t in (0:4) * 2/3\n    plot!(x, sol(t), label=@sprintf(\"t=%.1f\", t))\nend\nplt","visibility":"hide","key":"juHVESqBAK"},{"type":"output","id":"WUfppQTsgIPIgxJspGb9C","data":[{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"3f0a22fd72789354fa8b05c10c3037ad","path":"/build/3f0a22fd72789354fa8b05c10c3037ad.png"},"text/html":{"content_type":"text/html","hash":"d75a1061ca95d6d57d7b1679b1d89b9a","path":"/build/d75a1061ca95d6d57d7b1679b1d89b9a.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"7f313c603441d9c3cd2e52cb4472fc27","path":"/build/7f313c603441d9c3cd2e52cb4472fc27.svg"}}}],"visibility":"show","key":"y21MzMcfH5"}],"visibility":"show","key":"xdPqhU0RdO"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"An animation shows the solution nicely. The bump moves with speed 2 to the right, reentering on the left as it exits to the right because of the periodic conditions.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"AFbXf7huLw"}],"key":"ubBsKvEvaa"}],"key":"ZTgZ7lPHYY"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:36:12.528000Z","iopub.status.busy":"2025-01-14T15:35:16.930000Z","iopub.execute_input":"2025-01-14T15:35:16.932000Z","shell.execute_reply":"2025-01-14T15:36:12.498000Z"},"tags":[]},"children":[{"type":"code","lang":"julia","executable":true,"value":"anim = @animate for t in range(0, 4, 120) \n    plot(x, sol(t),\n        title=@sprintf(\"Advection equation, t = %.2f\", t),\n        xaxis=(L\"x\"),  yaxis=([1, 2], L\"u(x,t)\"),\n        dpi=150)\nend\nmp4(anim, \"advection.mp4\")","visibility":"hide","key":"HKVcJil0se"},{"type":"output","id":"2nnGUDlUa5lBNNVt19G73","data":[{"name":"stderr","output_type":"stream","text":"\u001b[36m\u001b[1m[ \u001b[22m\u001b[39m\u001b[36m\u001b[1mInfo: \u001b[22m\u001b[39mSaved animation to /Users/driscoll/Dropbox/Mac/Documents/GitHub/fnc-notebooks/chapter12/section1/julia/advection.mp4\n"},{"output_type":"execute_result","execution_count":5,"metadata":{},"data":{"text/plain":{"content":"Plots.AnimatedGif(\"/Users/driscoll/Dropbox/Mac/Documents/GitHub/fnc-notebooks/chapter12/section1/julia/advection.mp4\")","content_type":"text/plain"},"text/html":{"content_type":"text/html","hash":"2aa36b0f116daf57a36937f6baad0023","path":"/build/2aa36b0f116daf57a36937f6baad0023.html"}}}],"visibility":"show","key":"CuHLxUp2oD"}],"visibility":"show","key":"Vd5zVW51jD"}],"key":"VCVPeYyzUU"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Bs","url":"/bs","group":"Chapter 11"},"next":{"title":"Solve","url":"/solve-3","group":"Chapter 12"}}},"domain":"http://localhost:3000"}