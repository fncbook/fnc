{"version":2,"kind":"Article","sha256":"8ee955fc4aa75148ec945de1f00da902e89fee51c996a6dad6b13ed6ed71ae9d","slug":"pivoting","location":"/chapter2/pivoting.md","dependencies":[{"url":"/chapter2","label":"demo-pivoting-fail-julia","kind":"Notebook","slug":"chapter2","location":"/julia/chapter2.md","title":"Chapter 2"},{"url":"/chapter2-1","label":"demo-pivoting-fail-matlab","kind":"Notebook","slug":"chapter2-1","location":"/matlab/chapter2.md","title":"Chapter 2"},{"url":"/chapter2-2","label":"demo-pivoting-fail-python","kind":"Notebook","slug":"chapter2-2","location":"/python/chapter2.md","title":"Chapter 2"}],"frontmatter":{"title":"Row pivoting","numbering":{"heading_1":{"enabled":true},"heading_2":{"enabled":true},"heading_3":{"enabled":false},"enumerator":{"enumerator":"2.6.%s"},"title":{"offset":1}},"content_includes_title":false,"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","TPBVP":"two-point boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"edit_url":"https://github.com/fncbook/fnc/blob/master/chapter2/pivoting.md","exports":[{"format":"md","filename":"pivoting.md","url":"/build/pivoting-d2c6f3f8179fdd54d99a5644d0bd8074.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"As mentioned in ","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"vXxuz46zhy"},{"type":"link","kind":"numref","identifier":"section-linsys-lu","label":"section-linsys-lu","url":"/lu","internal":true,"dataUrl":"/lu.json","children":[{"type":"text","value":"LU factorization","key":"OZNm3qRjt8"}],"key":"s3PcADG2KB"},{"type":"text","value":", the ","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"oAZRdSCEFs"},{"type":"inlineMath","value":"\\mathbf{A}=\\mathbf{L}\\mathbf{U}","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi><mo>=</mo><mi mathvariant=\"bold\">L</mi><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}=\\mathbf{L}\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">LU</span></span></span></span>","key":"MvVx06Wobo"},{"type":"text","value":" factorization is not stable for every nonsingular ","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"ObuzHQjTBm"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"suC7ObqwW4"},{"type":"text","value":". Indeed, the factorization does not always even exist.","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"xRBhA9HzRM"}],"indexEntries":[{"entry":"matrix factorization","subEntry":{"value":"LU","kind":"entry"},"emphasis":false}],"label":"index-bLeRozl0Ob","identifier":"index-blerozl0ob","html_id":"index-blerozl0ob","key":"rN3UmlSjjV"},{"type":"proof","kind":"example","enumerated":true,"children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Failure of naive LU factorization","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"WK9twReI2p"}],"key":"qaXFwcKqwW"},{"type":"tabSet","children":[{"type":"tabItem","title":"Julia","sync":"julia","children":[{"type":"embed","source":{"url":"/chapter2","label":"demo-pivoting-fail-julia","kind":"Notebook","slug":"chapter2","location":"/julia/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-pivoting-fail","label":"demo-pivoting-fail","kind":"proof:example","position":{"start":{"line":832,"column":1},"end":{"line":832,"column":20}},"children":[{"type":"text","value":"Example ","key":"VClaScpt1Z"},{"type":"text","value":"2.6.1","key":"J8njkYCjpj"}],"template":"Example %s","enumerator":"2.6.1","resolved":true,"html_id":"demo-pivoting-fail","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"WmDV1vvG2R"}],"key":"Zre5e42pX1"},{"type":"paragraph","position":{"start":{"line":834,"column":1},"end":{"line":834,"column":1}},"children":[{"type":"text","value":"Here is a previously encountered matrix that factors well.","position":{"start":{"line":834,"column":1},"end":{"line":834,"column":1}},"key":"A43FsJmGlM"}],"key":"rOgZ9AcHgO"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"A = [2 0 4 3 ; -4 5 -7 -10 ; 1 15 2 -4.5 ; -2 0 2 -13];\nL, U = FNC.lufact(A)\nL","key":"OcW6vEryqV"},{"type":"output","id":"huLU3Gxe0nMKBGg-iOAWT","data":[{"output_type":"execute_result","execution_count":78,"metadata":{},"data":{"text/plain":{"content":"4×4 LowerTriangular{Float64, Matrix{Float64}}:\n  1.0   ⋅     ⋅    ⋅ \n -2.0  1.0    ⋅    ⋅ \n  0.5  3.0   1.0   ⋅ \n -1.0  0.0  -2.0  1.0","content_type":"text/plain"}}}],"key":"WfCpHdOdlw"}],"key":"nonaAXv7fb"},{"type":"paragraph","position":{"start":{"line":842,"column":1},"end":{"line":842,"column":1}},"children":[{"type":"text","value":"If we swap the second and fourth rows of ","position":{"start":{"line":842,"column":1},"end":{"line":842,"column":1}},"key":"HUoURRXL9R"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":842,"column":1},"end":{"line":842,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"gvHaLX22YE"},{"type":"text","value":", the result is still nonsingular. However, the factorization now fails.","position":{"start":{"line":842,"column":1},"end":{"line":842,"column":1}},"key":"gQXLY4P6Ff"}],"key":"wQuSaGXXf4"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"A[[2, 4], :] = A[[4, 2], :]  \nL, U = FNC.lufact(A)\nL","key":"xUpNQkjgzG"},{"type":"output","id":"68QHpDewcRTQa0Z-Xbtoj","data":[{"output_type":"execute_result","execution_count":79,"metadata":{},"data":{"text/plain":{"content":"4×4 LowerTriangular{Float64, Matrix{Float64}}:\n  1.0     ⋅      ⋅    ⋅ \n -1.0  NaN       ⋅    ⋅ \n  0.5   Inf   NaN     ⋅ \n -2.0   Inf   NaN    1.0","content_type":"text/plain"}}}],"key":"umEar1z57P"}],"key":"pgXyABNyHL"},{"type":"paragraph","position":{"start":{"line":853,"column":1},"end":{"line":853,"column":1}},"children":[{"type":"text","value":"The presence of ","position":{"start":{"line":853,"column":1},"end":{"line":853,"column":1}},"key":"qc7quOBlIS"},{"type":"inlineCode","value":"NaN","position":{"start":{"line":853,"column":1},"end":{"line":853,"column":1}},"key":"CvDHhdcWnw"},{"type":"text","value":" in the result indicates that some impossible operation was required. The source of the problem is easy to locate. We can find the first outer product in the factorization just fine:","position":{"start":{"line":853,"column":1},"end":{"line":853,"column":1}},"key":"f0p2OP4KgN"}],"indexEntries":[{"entry":"Julia","subEntry":{"value":"NaN","kind":"entry"},"emphasis":false}],"key":"SD8gWohI4N"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"U[1, :] = A[1, :]\nL[:, 1] = A[:, 1] / U[1, 1]\nA -= L[:, 1] * U[1, :]'","key":"uuTY4xqJqf"},{"type":"output","id":"zr4gk9MN-Fr-LA1vm5yDa","data":[{"output_type":"execute_result","execution_count":80,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n 0.0   0.0  0.0    0.0\n 0.0   0.0  6.0  -10.0\n 0.0  15.0  0.0   -6.0\n 0.0   5.0  1.0   -4.0","content_type":"text/plain"}}}],"key":"JLg1wElvxm"}],"key":"eLI4VZGlx2"},{"type":"paragraph","position":{"start":{"line":861,"column":1},"end":{"line":861,"column":1}},"children":[{"type":"text","value":"The next step is ","position":{"start":{"line":861,"column":1},"end":{"line":861,"column":1}},"key":"xbIWHmumxO"},{"type":"inlineCode","value":"U[2, :] = A[2, :]","position":{"start":{"line":861,"column":1},"end":{"line":861,"column":1}},"key":"tY35WXphc6"},{"type":"text","value":", which is also OK. But then we are supposed to divide by ","position":{"start":{"line":861,"column":1},"end":{"line":861,"column":1}},"key":"l9zgzxKsIq"},{"type":"inlineCode","value":"U[2, 2]","position":{"start":{"line":861,"column":1},"end":{"line":861,"column":1}},"key":"L6vqf1g8SU"},{"type":"text","value":", which is zero. The algorithm cannot continue.","position":{"start":{"line":861,"column":1},"end":{"line":861,"column":1}},"key":"cYgyCMNKSq"}],"key":"IU2813LtFe"}],"key":"GghJYUbxsb"}],"key":"zBlfIh72LD"}],"key":"bhISRzdm0Z"},{"type":"tabItem","title":"MATLAB","sync":"matlab","children":[{"type":"embed","source":{"url":"/chapter2-1","label":"demo-pivoting-fail-matlab","kind":"Notebook","slug":"chapter2-1","location":"/matlab/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-pivoting-fail","label":"demo-pivoting-fail","kind":"proof:example","position":{"start":{"line":769,"column":1},"end":{"line":769,"column":20}},"children":[{"type":"text","value":"Example ","key":"WVTU0wXmkh"},{"type":"text","value":"2.6.1","key":"ZFT0MKTd82"}],"template":"Example %s","enumerator":"2.6.1","resolved":true,"html_id":"demo-pivoting-fail","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"PR57CpLXek"}],"key":"DkMnhrhYb5"},{"type":"paragraph","position":{"start":{"line":771,"column":1},"end":{"line":771,"column":1}},"children":[{"type":"text","value":"Here is a previously encountered matrix that factors well.","position":{"start":{"line":771,"column":1},"end":{"line":771,"column":1}},"key":"DPfvK3RvHQ"}],"key":"cyyewjvGXX"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A = [\n    2 0 4 3\n    -4 5 -7 -10\n    1 15 2 -4.5\n    -2 0 2 -13\n    ];\n[L, U] = lufact(A);\nL","key":"ColLHgKAXK"},{"type":"output","id":"9-IAxsxEFaAJqUZMk0nIv","data":[{"output_type":"execute_result","execution_count":76,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>L = 4×4 double\n    1.0000         0         0         0\n   -2.0000    1.0000         0         0\n    0.5000    3.0000    1.0000         0\n   -1.0000         0   -2.0000    1.0000\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"L = 4×4 double\n    1.0000         0         0         0\n   -2.0000    1.0000         0         0\n    0.5000    3.0000    1.0000         0\n   -1.0000         0   -2.0000    1.0000\n","content_type":"text/plain"}}}],"key":"jetKxDi7Kk"}],"key":"kXmA0ja9QF"},{"type":"paragraph","position":{"start":{"line":784,"column":1},"end":{"line":784,"column":1}},"children":[{"type":"text","value":"If we swap the second and fourth rows of ","position":{"start":{"line":784,"column":1},"end":{"line":784,"column":1}},"key":"ErDlMa39lK"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":784,"column":1},"end":{"line":784,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"NhLEowWbsd"},{"type":"text","value":", the result is still nonsingular. However, the factorization now fails.","position":{"start":{"line":784,"column":1},"end":{"line":784,"column":1}},"key":"jxITfkvdAu"}],"key":"b7NFvLfo2q"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A([2, 4], :) = A([4, 2], :);    % swap rows 2 and 4\n[L, U] = lufact(A);\nL","key":"Tyw156nbqA"},{"type":"output","id":"8ndMouq3jD98MfNa1e8xk","data":[{"output_type":"execute_result","execution_count":77,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>L = 4×4 double\n    1.0000         0         0         0\n   -1.0000       NaN         0         0\n    0.5000       Inf       NaN         0\n   -2.0000       Inf       NaN    1.0000\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"L = 4×4 double\n    1.0000         0         0         0\n   -1.0000       NaN         0         0\n    0.5000       Inf       NaN         0\n   -2.0000       Inf       NaN    1.0000\n","content_type":"text/plain"}}}],"key":"r8CGvr9rHc"}],"key":"d1ZEJnobfY"},{"type":"paragraph","position":{"start":{"line":795,"column":1},"end":{"line":795,"column":1}},"children":[{"type":"text","value":"The presence of ","position":{"start":{"line":795,"column":1},"end":{"line":795,"column":1}},"key":"YqpZa8yNXu"},{"type":"inlineCode","value":"NaN","position":{"start":{"line":795,"column":1},"end":{"line":795,"column":1}},"key":"zu5wo4aAkz"},{"type":"text","value":" in the result indicates that some impossible operation was required. The source of the problem is easy to locate. We can find the first outer product in the factorization just fine:","position":{"start":{"line":795,"column":1},"end":{"line":795,"column":1}},"key":"JbtyI8GPQE"}],"indexEntries":[{"entry":"MATLAB","subEntry":{"value":"NaN","kind":"entry"},"emphasis":false}],"key":"p7xkCbWRTV"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"U(1, :) = A(1, :);\nL(:, 1) = A(:, 1) / U(1, 1)\nA = A - L(:, 1) * U(1, :)","key":"gc11IoJzck"},{"type":"output","id":"lhedphiV3MBXWbHFQEu2r","data":[{"output_type":"execute_result","execution_count":78,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>L = 4×4 double\n    1.0000         0         0         0\n   -1.0000       NaN         0         0\n    0.5000       Inf       NaN         0\n   -2.0000       Inf       NaN    1.0000\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"L = 4×4 double\n    1.0000         0         0         0\n   -1.0000       NaN         0         0\n    0.5000       Inf       NaN         0\n   -2.0000       Inf       NaN    1.0000\n","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":78,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>A = 4×4 double\n     0     0     0     0\n     0     0     6   -10\n     0    15     0    -6\n     0     5     1    -4\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"A = 4×4 double\n     0     0     0     0\n     0     0     6   -10\n     0    15     0    -6\n     0     5     1    -4\n","content_type":"text/plain"}}}],"key":"ujqjdnaWhk"}],"key":"eIvvfiF5Ny"},{"type":"paragraph","position":{"start":{"line":803,"column":1},"end":{"line":803,"column":1}},"children":[{"type":"text","value":"The next step is ","position":{"start":{"line":803,"column":1},"end":{"line":803,"column":1}},"key":"UaqbwojqPz"},{"type":"inlineCode","value":"U(2, :) = A(2, :)","position":{"start":{"line":803,"column":1},"end":{"line":803,"column":1}},"key":"K2ZbVH198y"},{"type":"text","value":", which is also OK. But then we are supposed to divide by ","position":{"start":{"line":803,"column":1},"end":{"line":803,"column":1}},"key":"t51L3HwvoL"},{"type":"inlineCode","value":"U(2, 2)","position":{"start":{"line":803,"column":1},"end":{"line":803,"column":1}},"key":"FKwDXO0RUV"},{"type":"text","value":", which is zero. The algorithm cannot continue.","position":{"start":{"line":803,"column":1},"end":{"line":803,"column":1}},"key":"f4Zy3ddaPW"}],"key":"ofah4oZM8E"}],"key":"sqUm1CnrR8"}],"key":"A5VPILIlzj"}],"key":"T7YwHRugLl"},{"type":"tabItem","title":"Python","sync":"python","children":[{"type":"embed","source":{"url":"/chapter2-2","label":"demo-pivoting-fail-python","kind":"Notebook","slug":"chapter2-2","location":"/python/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-pivoting-fail","label":"demo-pivoting-fail","kind":"proof:example","position":{"start":{"line":749,"column":1},"end":{"line":749,"column":20}},"children":[{"type":"text","value":"Example ","key":"mf6v0eyX0A"},{"type":"text","value":"2.6.1","key":"qVSJI76PJ4"}],"template":"Example %s","enumerator":"2.6.1","resolved":true,"html_id":"demo-pivoting-fail","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"s97YWk0HGS"}],"key":"QkjhgzUPnW"},{"type":"paragraph","position":{"start":{"line":751,"column":1},"end":{"line":751,"column":1}},"children":[{"type":"text","value":"Here is a previously encountered matrix that factors well.","position":{"start":{"line":751,"column":1},"end":{"line":751,"column":1}},"key":"dXjVYTXlUN"}],"key":"sAPowszVEZ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"A = array([\n    [2, 0, 4, 3],\n    [-4, 5, -7, -10],\n    [1, 15, 2, -4.5],\n    [-2, 0, 2, -13]\n    ])\nL, U = FNC.lufact(A)\nprint(L)","key":"YBmJztXmPF"},{"type":"output","id":"gAnphe6GuyfxJ2sEX3OrR","data":[{"output_type":"stream","name":"stdout","text":"[[ 1.   0.  -0.   0. ]\n [-2.   1.  -0.   0. ]\n [ 0.5  3.   1.   0. ]\n [-1.   0.  -2.   1. ]]\n"}],"key":"aIVAYtnSCa"}],"key":"J3s1cbE9Sr"},{"type":"paragraph","position":{"start":{"line":764,"column":1},"end":{"line":764,"column":1}},"children":[{"type":"text","value":"If we swap the second and fourth rows of ","position":{"start":{"line":764,"column":1},"end":{"line":764,"column":1}},"key":"b9Xd1ROJ6x"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":764,"column":1},"end":{"line":764,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"DxW63r0qgY"},{"type":"text","value":", the result is still nonsingular. However, the factorization now fails.","position":{"start":{"line":764,"column":1},"end":{"line":764,"column":1}},"key":"UVY1jxNr2r"}],"key":"VLtQ93wfbR"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"A[[1, 3], :] = A[[3, 1], :]  \nL, U = FNC.lufact(A)\nprint(L)","key":"TbOnxjW9VV"},{"type":"output","id":"TaaXlpv0EutvLS4T9zT0C","data":[{"output_type":"stream","name":"stdout","text":"[[ 1.   nan  nan  0. ]\n [-1.   nan  nan  0. ]\n [ 0.5  inf  nan  0. ]\n [-2.   inf  nan  1. ]]\n"},{"output_type":"stream","name":"stderr","text":"/Users/driscoll/.local/share/mamba/envs/myst/lib/python3.13/site-packages/fncbook/chapter02.py:47: RuntimeWarning: divide by zero encountered in divide\n  L[:, k] = A_k[:, k] / U[k,k]\n/Users/driscoll/.local/share/mamba/envs/myst/lib/python3.13/site-packages/fncbook/chapter02.py:47: RuntimeWarning: invalid value encountered in divide\n  L[:, k] = A_k[:, k] / U[k,k]\n/Users/driscoll/.local/share/mamba/envs/myst/lib/python3.13/site-packages/numpy/_core/numeric.py:961: RuntimeWarning: invalid value encountered in multiply\n  return multiply(a.ravel()[:, newaxis], b.ravel()[newaxis, :], out)\n"}],"key":"tbKuRJeO5o"}],"key":"jcP6bOabS8"},{"type":"paragraph","position":{"start":{"line":775,"column":1},"end":{"line":775,"column":1}},"children":[{"type":"text","value":"The presence of ","position":{"start":{"line":775,"column":1},"end":{"line":775,"column":1}},"key":"pUu05DFeoa"},{"type":"inlineCode","value":"NaN","position":{"start":{"line":775,"column":1},"end":{"line":775,"column":1}},"key":"IVPlRW3a3a"},{"type":"text","value":" in the result indicates that some impossible operation was required. The source of the problem is easy to locate. We can find the first outer product in the factorization just fine:","position":{"start":{"line":775,"column":1},"end":{"line":775,"column":1}},"key":"yxHeQL7Vah"}],"indexEntries":[{"entry":"Python","subEntry":{"value":"NaN","kind":"entry"},"emphasis":false}],"key":"fjHKBUNOl0"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"U[0, :] = A[0, :]\nL[:, 0] = A[:, 0] / U[0, 0]\nA -= outer(L[:, 0],  U[0, :])\nprint(A)","key":"HPvrJwibIM"},{"type":"output","id":"iVWYYfUN4sj7CXxYStzbX","data":[{"output_type":"stream","name":"stdout","text":"[[  0.   0.   0.   0.]\n [  0.   0.   6. -10.]\n [  0.  15.   0.  -6.]\n [  0.   5.   1.  -4.]]\n"}],"key":"dslLC8qn0j"}],"key":"mXP9RanoB2"},{"type":"paragraph","position":{"start":{"line":784,"column":1},"end":{"line":784,"column":1}},"children":[{"type":"text","value":"The next step is ","position":{"start":{"line":784,"column":1},"end":{"line":784,"column":1}},"key":"zf9SrPsrDT"},{"type":"inlineCode","value":"U[1, :] = A[1, :]","position":{"start":{"line":784,"column":1},"end":{"line":784,"column":1}},"key":"iDtfZp1JRj"},{"type":"text","value":", which is also OK. But then we are supposed to divide by ","position":{"start":{"line":784,"column":1},"end":{"line":784,"column":1}},"key":"yW3XpeD9Yh"},{"type":"inlineCode","value":"U[1, 1]","position":{"start":{"line":784,"column":1},"end":{"line":784,"column":1}},"key":"eaoegElXnv"},{"type":"text","value":", which is zero. The algorithm cannot continue.","position":{"start":{"line":784,"column":1},"end":{"line":784,"column":1}},"key":"cRLsMSbKNc"}],"key":"F7pr3z7z8X"}],"key":"NWUE8XD6rZ"}],"key":"FHk6cUxZIl"}],"key":"HNSgrATMkj"}],"key":"irzSHkCgX0"}],"label":"demo-pivoting-fail","identifier":"demo-pivoting-fail","enumerator":"2.6.1","html_id":"demo-pivoting-fail","key":"se4FWmEAdz"},{"type":"paragraph","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"children":[{"type":"text","value":"In ","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"key":"HhtaMdLZG1"},{"type":"link","kind":"numref","identifier":"section-linsys-lu","label":"section-linsys-lu","url":"/lu","internal":true,"dataUrl":"/lu.json","children":[{"type":"text","value":"LU factorization","key":"AybrV7ejsY"}],"key":"ThM0TbOvt0"},{"type":"text","value":" we remarked that LU factorization is equivalent to Gaussian elimination with no row swaps. However, those swaps are necessary in situations like those encountered in ","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"key":"E2UIYmNn7Z"},{"type":"crossReference","identifier":"demo-pivoting-fail","label":"demo-pivoting-fail","kind":"proof:example","position":{"start":{"line":39,"column":198},"end":{"line":39,"column":217}},"children":[{"type":"text","value":"Example ","key":"XKFtzHODWu"},{"type":"text","value":"2.6.1","key":"Qdc7mP3mf1"}],"template":"Example %s","enumerator":"2.6.1","resolved":true,"html_id":"demo-pivoting-fail","key":"uifHaBfVlo"},{"type":"text","value":", in order to avoid division by zero. We will find a modification of the outer product procedure that allows us to do the same thing.","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"key":"sjI4aY8yyl"}],"key":"xYhGw6eyJq"},{"type":"heading","depth":2,"position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"children":[{"type":"text","value":"Choosing a pivot","position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"key":"OkAmr57Fgt"}],"identifier":"choosing-a-pivot","label":"Choosing a pivot","html_id":"choosing-a-pivot","implicit":true,"enumerator":"2.6.1","key":"RgttP5Jsnd"},{"type":"paragraph","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"children":[{"type":"text","value":"The diagonal element of ","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"key":"qdr8Akwkk3"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"vTVWahQqMR"},{"type":"text","value":" that appears in the denominator of line 17 of ","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"key":"r5s0OB33xS"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-lufact","label":"function-lufact","children":[{"type":"text","value":"Function ","key":"zO80RSZTON"},{"type":"text","value":"2.4.1","key":"q2Qjriwotm"}],"template":"Algorithm %s","enumerator":"2.4.1","resolved":true,"html_id":"function-lufact","remote":true,"url":"/lu","dataUrl":"/lu.json","key":"EmX9s48yOx"},{"type":"text","value":" is called the ","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"key":"WsIyGsxhgY"},{"type":"strong","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"children":[{"type":"text","value":"pivot element","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"key":"mOKvovABFU"}],"key":"HqwqMyCenI"},{"type":"text","value":" of its column. In order to avoid a zero pivot, we will use the largest available element in the column we are working on as the pivot. This technique is known as ","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"key":"bAtIJKLCme"},{"type":"strong","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"children":[{"type":"text","value":"row pivoting","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"key":"Md34TVI2y7"}],"key":"y1ldRSpr72"},{"type":"text","value":".","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"key":"cFZoN0Ae11"}],"indexEntries":[{"entry":"pivoting","emphasis":true}],"label":"index-FtY9eFwIo9","identifier":"index-fty9efwio9","html_id":"index-fty9efwio9","key":"KrHBeATcC3"},{"type":"proof","kind":"definition","enumerated":true,"children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Row pivoting","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"key":"AnWX8T2qVI"}],"key":"luURheBd8R"},{"type":"paragraph","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"children":[{"type":"text","value":"When performing elimination in column ","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"key":"OnAJFlVsIv"},{"type":"inlineMath","value":"j","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>j</mi></mrow><annotation encoding=\"application/x-tex\">j</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span></span></span></span>","key":"rfh8w559rh"},{"type":"text","value":", choose as the pivot the element in column ","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"key":"PO7Gmu2HlI"},{"type":"inlineMath","value":"j","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>j</mi></mrow><annotation encoding=\"application/x-tex\">j</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span></span></span></span>","key":"SCcs82Ldz3"},{"type":"text","value":" that is largest in absolute value. (In case of ties, choose the lowest row index.)","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"key":"TtyT3eiTqs"}],"key":"SCTpRbsRMV"}],"label":"definition-pivoting","identifier":"definition-pivoting","enumerator":"2.6.1","html_id":"definition-pivoting","key":"tgDj6kgQN6"},{"type":"proof","kind":"example","enumerated":true,"children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Row pivoting in LU factorization","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"ebtlCCtN9g"}],"key":"tEZj8fIFyy"},{"type":"tabSet","children":[{"type":"tabItem","title":"Julia","sync":"julia","children":[{"type":"embed","source":{"url":"/chapter2","label":"demo-pivoting-fix-julia","kind":"Notebook","slug":"chapter2","location":"/julia/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-pivoting-fix","label":"demo-pivoting-fix","kind":"proof:example","position":{"start":{"line":865,"column":1},"end":{"line":865,"column":19}},"children":[{"type":"text","value":"Example ","key":"PCZJpz2KNK"},{"type":"text","value":"2.6.2","key":"abtqDBMjq4"}],"template":"Example %s","enumerator":"2.6.2","resolved":true,"html_id":"demo-pivoting-fix","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"SmTE2y0M6q"}],"key":"KCjR5xisNT"},{"type":"paragraph","position":{"start":{"line":867,"column":1},"end":{"line":867,"column":1}},"children":[{"type":"text","value":"Here is the trouble-making matrix from ","position":{"start":{"line":867,"column":1},"end":{"line":867,"column":1}},"key":"VnMxjtGjRL"},{"type":"crossReference","identifier":"demo-pivoting-fail","label":"demo-pivoting-fail","kind":"proof:example","position":{"start":{"line":867,"column":40},"end":{"line":867,"column":59}},"children":[{"type":"text","value":"Example ","key":"uW08EHupw2"},{"type":"text","value":"2.6.1","key":"mF0qjIMgLl"}],"template":"Example %s","enumerator":"2.6.1","resolved":true,"html_id":"demo-pivoting-fail","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"fP0geWhL7o"},{"type":"text","value":".","position":{"start":{"line":867,"column":1},"end":{"line":867,"column":1}},"key":"N71BDRfziL"}],"key":"n26hyQ627Q"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"A₁ = [2 0 4 3 ; -2 0 2 -13; 1 15 2 -4.5 ; -4 5 -7 -10]","key":"e380ST0PIg"},{"type":"output","id":"7Z_FI3pQt54b4ein7L4Dr","data":[{"output_type":"execute_result","execution_count":81,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n  2.0   0.0   4.0    3.0\n -2.0   0.0   2.0  -13.0\n  1.0  15.0   2.0   -4.5\n -4.0   5.0  -7.0  -10.0","content_type":"text/plain"}}}],"key":"qdnq5SzYCI"}],"key":"rPtLOY4Ot2"},{"type":"paragraph","position":{"start":{"line":873,"column":1},"end":{"line":873,"column":1}},"children":[{"type":"text","value":"We now find the largest candidate pivot in the first column. We don’t care about sign, so we take absolute values before finding the max.","position":{"start":{"line":873,"column":1},"end":{"line":873,"column":1}},"key":"YYrlALT53M"}],"key":"IKmibXvtJq"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"Y5KrVp8qqJ"}],"key":"di74VeEJrV"},{"type":"paragraph","position":{"start":{"line":876,"column":1},"end":{"line":876,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":876,"column":1},"end":{"line":876,"column":1}},"key":"LydGtQi6Nd"},{"type":"inlineCode","value":"argmax","position":{"start":{"line":876,"column":1},"end":{"line":876,"column":1}},"key":"NYul95YACb"},{"type":"text","value":" function returns the location of the largest element of a vector or matrix.","position":{"start":{"line":876,"column":1},"end":{"line":876,"column":1}},"key":"QhmllMbi4H"}],"key":"BfeMuD6gW7"}],"class":"dropdown","key":"g6XgBUWiXY"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"i = argmax( abs.(A₁[:, 1]) )","key":"TudgitCoh5"},{"type":"output","id":"Ykt794qbWSQmBL0NXBie1","data":[{"output_type":"execute_result","execution_count":82,"metadata":{},"data":{"text/plain":{"content":"4","content_type":"text/plain"}}}],"key":"Mnov4aJk1V"}],"key":"vINUPRKbTn"},{"type":"paragraph","position":{"start":{"line":884,"column":1},"end":{"line":884,"column":1}},"children":[{"type":"text","value":"This is the row of the matrix that we extract to put into ","position":{"start":{"line":884,"column":1},"end":{"line":884,"column":1}},"key":"DYeq77duLh"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":884,"column":1},"end":{"line":884,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"tfp0NKSoBA"},{"type":"text","value":". That guarantees that the division used to find ","position":{"start":{"line":884,"column":1},"end":{"line":884,"column":1}},"key":"SqGAn2IUs7"},{"type":"inlineMath","value":"\\boldsymbol{\\ell}_1","position":{"start":{"line":884,"column":1},"end":{"line":884,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">ℓ</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\boldsymbol{\\ell}_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">ℓ</span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"I3z8fHS5ri"},{"type":"text","value":" will be valid.","position":{"start":{"line":884,"column":1},"end":{"line":884,"column":1}},"key":"XvfmZIr3BS"}],"key":"kpDuoLcsD9"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"L, U = zeros(4,4),zeros(4,4)\nU[1, :] = A₁[i, :]\nL[:, 1] = A₁[:, 1] / U[1, 1]\nA₂ = A₁ - L[:, 1] * U[1, :]'","key":"CrlKAvpFIF"},{"type":"output","id":"Nc_Q9eLar4lnSYxVPK28E","data":[{"output_type":"execute_result","execution_count":83,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n 0.0   2.5   0.5   -2.0\n 0.0  -2.5   5.5   -8.0\n 0.0  16.25  0.25  -7.0\n 0.0   0.0   0.0    0.0","content_type":"text/plain"}}}],"key":"QUZhFKQ3z9"}],"key":"ItLae2Z2Eh"},{"type":"paragraph","position":{"start":{"line":893,"column":1},"end":{"line":893,"column":1}},"children":[{"type":"text","value":"Observe that ","position":{"start":{"line":893,"column":1},"end":{"line":893,"column":1}},"key":"q9bBNfMQ9p"},{"type":"inlineMath","value":"\\mathbf{A}_2","position":{"start":{"line":893,"column":1},"end":{"line":893,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">A</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8361em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"F4Wi74g2hf"},{"type":"text","value":" has a new zero row and zero column, but the zero row is the fourth rather than the first. However, we forge on by using the largest possible pivot in column 2 for the next outer product.","position":{"start":{"line":893,"column":1},"end":{"line":893,"column":1}},"key":"ULh5L3T8U3"}],"key":"I90sfnalzg"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"@show i = argmax( abs.(A₂[:, 2]) ) \nU[2, :] = A₂[i, :]\nL[:, 2] = A₂[:, 2] / U[2, 2]\nA₃ = A₂ - L[:, 2] * U[2, :]'","key":"pcGY7m4OAo"},{"type":"output","id":"aiP5OAbI6_Or5066rUPzG","data":[{"output_type":"stream","name":"stdout","text":"i = argmax(abs.(A₂[:, 2])) = 3\n"},{"output_type":"execute_result","execution_count":84,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n 0.0  0.0  0.461538  -0.923077\n 0.0  0.0  5.53846   -9.07692\n 0.0  0.0  0.0        0.0\n 0.0  0.0  0.0        0.0","content_type":"text/plain"}}}],"key":"rwIeAFpwOX"}],"key":"FG56O006z3"},{"type":"paragraph","position":{"start":{"line":902,"column":1},"end":{"line":902,"column":1}},"children":[{"type":"text","value":"Now we have zeroed out the third row as well as the second column. We can finish out the procedure.","position":{"start":{"line":902,"column":1},"end":{"line":902,"column":1}},"key":"g8uKE1iiIv"}],"key":"hSJ5RWSQsU"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"@show i = argmax( abs.(A₃[:, 3]) ) \nU[3, :] = A₃[i, :]\nL[:, 3] = A₃[:, 3] / U[3, 3]\nA₄ = A₃ - L[:, 3] * U[3, :]'","key":"J3ljYkE3b8"},{"type":"output","id":"pubJ70jY9PLC7SKEpKi-h","data":[{"output_type":"stream","name":"stdout","text":"i = argmax(abs.(A₃[:, 3])) = 2\n"},{"output_type":"execute_result","execution_count":85,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n 0.0  0.0  0.0  -0.166667\n 0.0  0.0  0.0   0.0\n 0.0  0.0  0.0   0.0\n 0.0  0.0  0.0   0.0","content_type":"text/plain"}}}],"key":"i0Q4AvwJ6c"}],"key":"y8fRSGnIAf"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"@show i = argmax( abs.(A₄[:, 4]) ) \nU[4, :] = A₄[i, :]\nL[:, 4] = A₄[:, 4] / U[4, 4];","key":"jAqKpvuIsH"},{"type":"output","id":"gw4eODsy0uC8lwZ1-zJwz","data":[{"output_type":"stream","name":"stdout","text":"i = argmax(abs.(A₄[:, 4])) = 1\n"}],"key":"kmLX7vR5Iu"}],"key":"VsGQFGll2o"},{"type":"paragraph","position":{"start":{"line":917,"column":1},"end":{"line":917,"column":1}},"children":[{"type":"text","value":"We do have a factorization of the original matrix:","position":{"start":{"line":917,"column":1},"end":{"line":917,"column":1}},"key":"rP6EYA7q8W"}],"key":"lmXJSpub1q"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"A₁ - L * U","key":"n9azm10EhQ"},{"type":"output","id":"9bKuAaHEUOMeqGCtrd4kW","data":[{"output_type":"execute_result","execution_count":87,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n 0.0  -1.38778e-16  0.0  0.0\n 0.0   1.38778e-16  0.0  0.0\n 0.0   0.0          0.0  0.0\n 0.0   0.0          0.0  0.0","content_type":"text/plain"}}}],"key":"ZkLTrq7a0H"}],"key":"SDsXMlWD4g"},{"type":"paragraph","position":{"start":{"line":923,"column":1},"end":{"line":923,"column":1}},"children":[{"type":"text","value":"And ","position":{"start":{"line":923,"column":1},"end":{"line":923,"column":1}},"key":"Km6p8vGe6T"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":923,"column":1},"end":{"line":923,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"nVWt6T1mkZ"},{"type":"text","value":" has the required structure:","position":{"start":{"line":923,"column":1},"end":{"line":923,"column":1}},"key":"uL6i2Z2HjV"}],"key":"nAHYpU7bA6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"U","key":"QFc9Qz1CUQ"},{"type":"output","id":"HTs50kVp_8AmvtgrqXjCK","data":[{"output_type":"execute_result","execution_count":88,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n -4.0   5.0   -7.0      -10.0\n  0.0  16.25   0.25      -7.0\n  0.0   0.0    5.53846   -9.07692\n  0.0   0.0    0.0       -0.166667","content_type":"text/plain"}}}],"key":"JWaTVL7xxX"}],"key":"oo9SknM7TW"},{"type":"paragraph","position":{"start":{"line":929,"column":1},"end":{"line":929,"column":1}},"children":[{"type":"text","value":"However, the triangularity of ","position":{"start":{"line":929,"column":1},"end":{"line":929,"column":1}},"key":"EQ1CbDtWID"},{"type":"inlineMath","value":"\\mathbf{L}","position":{"start":{"line":929,"column":1},"end":{"line":929,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">L</span></span></span></span>","key":"GQhVX8M10w"},{"type":"text","value":" has been broken.","position":{"start":{"line":929,"column":1},"end":{"line":929,"column":1}},"key":"ZJ5HfwRTtZ"}],"key":"o2cJa1DmhD"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"L","key":"dI0W7hKIKR"},{"type":"output","id":"JBVYn8MIHV1AMxuk8B45m","data":[{"output_type":"execute_result","execution_count":89,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n -0.5    0.153846  0.0833333   1.0\n  0.5   -0.153846  1.0        -0.0\n -0.25   1.0       0.0        -0.0\n  1.0    0.0       0.0        -0.0","content_type":"text/plain"}}}],"key":"sufmKkHRxo"}],"key":"xVLTEl5KY5"}],"key":"ApI6YIjYXO"}],"key":"Y57HjbIYNC"}],"key":"xxkwLVcajJ"},{"type":"tabItem","title":"MATLAB","sync":"matlab","children":[{"type":"embed","source":{"url":"/chapter2-1","label":"demo-pivoting-fix-matlab","kind":"Notebook","slug":"chapter2-1","location":"/matlab/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-pivoting-fix","label":"demo-pivoting-fix","kind":"proof:example","position":{"start":{"line":807,"column":1},"end":{"line":807,"column":19}},"children":[{"type":"text","value":"Example ","key":"yZuF8SvHLU"},{"type":"text","value":"2.6.2","key":"MgETRQj9zk"}],"template":"Example %s","enumerator":"2.6.2","resolved":true,"html_id":"demo-pivoting-fix","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"R5ZYHxYvVp"}],"key":"KVHIAr24mU"},{"type":"paragraph","position":{"start":{"line":809,"column":1},"end":{"line":809,"column":1}},"children":[{"type":"text","value":"Here is the trouble-making matrix from ","position":{"start":{"line":809,"column":1},"end":{"line":809,"column":1}},"key":"msS4j5pJKa"},{"type":"crossReference","identifier":"demo-pivoting-fail","label":"demo-pivoting-fail","kind":"proof:example","position":{"start":{"line":809,"column":40},"end":{"line":809,"column":59}},"children":[{"type":"text","value":"Example ","key":"X31thJboNJ"},{"type":"text","value":"2.6.1","key":"lKANIeP7uD"}],"template":"Example %s","enumerator":"2.6.1","resolved":true,"html_id":"demo-pivoting-fail","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"P75ncYCP0p"},{"type":"text","value":".","position":{"start":{"line":809,"column":1},"end":{"line":809,"column":1}},"key":"QmyOdBgNcK"}],"key":"epo4wZVgLW"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A_1 = [2 0 4 3; -2 0 2 -13; 1 15 2 -4.5; -4 5 -7 -10]","key":"ZKgUp8S6UV"},{"type":"output","id":"M1BTkFVVLtUz_CCBJ1luG","data":[{"output_type":"execute_result","execution_count":79,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>A_1 = 4×4 double\n    2.0000         0    4.0000    3.0000\n   -2.0000         0    2.0000  -13.0000\n    1.0000   15.0000    2.0000   -4.5000\n   -4.0000    5.0000   -7.0000  -10.0000\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"A_1 = 4×4 double\n    2.0000         0    4.0000    3.0000\n   -2.0000         0    2.0000  -13.0000\n    1.0000   15.0000    2.0000   -4.5000\n   -4.0000    5.0000   -7.0000  -10.0000\n","content_type":"text/plain"}}}],"key":"PpuA6sIAQr"}],"key":"qFGM8nVlJw"},{"type":"paragraph","position":{"start":{"line":818,"column":1},"end":{"line":818,"column":1}},"children":[{"type":"text","value":"We now find the largest candidate pivot in the first column. We don’t care about sign, so we take absolute values before finding the max.","position":{"start":{"line":818,"column":1},"end":{"line":818,"column":1}},"key":"G4tWJm3C4B"}],"indexEntries":[{"entry":"MATLAB","subEntry":{"value":"max","kind":"entry"},"emphasis":true},{"entry":"MATLAB","subEntry":{"value":"\\~","kind":"entry"},"emphasis":true}],"key":"scPb60QtoV"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"bYzMUN105i"}],"key":"OzHTAhTdyL"},{"type":"paragraph","position":{"start":{"line":821,"column":1},"end":{"line":821,"column":1}},"children":[{"type":"text","value":"The second output of ","position":{"start":{"line":821,"column":1},"end":{"line":821,"column":1}},"key":"ClCYwGBcIm"},{"type":"inlineCode","value":"max","position":{"start":{"line":821,"column":1},"end":{"line":821,"column":1}},"key":"lTwdfFLjFc"},{"type":"text","value":" returns the location of the largest element of a vector. The ","position":{"start":{"line":821,"column":1},"end":{"line":821,"column":1}},"key":"BmgVdvPtMC"},{"type":"inlineCode","value":"~","position":{"start":{"line":821,"column":1},"end":{"line":821,"column":1}},"key":"WCBrXaFEFN"},{"type":"text","value":" symbol is used to ignore the value of the first output.","position":{"start":{"line":821,"column":1},"end":{"line":821,"column":1}},"key":"UoL7TEfmH1"}],"key":"ZNEg10lwbk"}],"class":"dropdown","key":"Vj9rj2YoXQ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[~, i] = max( abs(A_1(:, 1)) )","key":"n2UxDo70yF"},{"type":"output","id":"dxQr745hVoyjJ2Scm4emc","data":[{"output_type":"execute_result","execution_count":80,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>i = 4</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"i = 4","content_type":"text/plain"}}}],"key":"pwkwcuaH1T"}],"key":"fab5VCWcFs"},{"type":"paragraph","position":{"start":{"line":829,"column":1},"end":{"line":829,"column":1}},"children":[{"type":"text","value":"This is the row of the matrix that we extract to put into ","position":{"start":{"line":829,"column":1},"end":{"line":829,"column":1}},"key":"gQFcjhJYjk"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":829,"column":1},"end":{"line":829,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"cmK13NuUxG"},{"type":"text","value":". That guarantees that the division used to find ","position":{"start":{"line":829,"column":1},"end":{"line":829,"column":1}},"key":"OAHmXrATYp"},{"type":"inlineMath","value":"\\boldsymbol{\\ell}_1","position":{"start":{"line":829,"column":1},"end":{"line":829,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">ℓ</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\boldsymbol{\\ell}_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">ℓ</span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"O5xH0KnM3U"},{"type":"text","value":" will be valid.","position":{"start":{"line":829,"column":1},"end":{"line":829,"column":1}},"key":"i4UymbIbGW"}],"key":"EKdU80DyM8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"L = zeros(4, 4);\nU = zeros(4, 4);\nU(1, :) = A_1(i, :);\nL(:, 1) = A_1(:, 1) / U(1, 1);\nA_2 = A_1 - L(:, 1) * U(1, :)","key":"vCPCXIVgN0"},{"type":"output","id":"mpKg8ofae_tVznyW8AaV8","data":[{"output_type":"execute_result","execution_count":81,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>A_2 = 4×4 double\n         0    2.5000    0.5000   -2.0000\n         0   -2.5000    5.5000   -8.0000\n         0   16.2500    0.2500   -7.0000\n         0         0         0         0\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"A_2 = 4×4 double\n         0    2.5000    0.5000   -2.0000\n         0   -2.5000    5.5000   -8.0000\n         0   16.2500    0.2500   -7.0000\n         0         0         0         0\n","content_type":"text/plain"}}}],"key":"YuhqhTml9R"}],"key":"evbUOj68y6"},{"type":"paragraph","position":{"start":{"line":839,"column":1},"end":{"line":839,"column":1}},"children":[{"type":"text","value":"Observe that ","position":{"start":{"line":839,"column":1},"end":{"line":839,"column":1}},"key":"TyDipmJP0Q"},{"type":"inlineMath","value":"\\mathbf{A}_2","position":{"start":{"line":839,"column":1},"end":{"line":839,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">A</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8361em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"yCmVwnYlqz"},{"type":"text","value":" has a new zero row and zero column, but the zero row is the fourth rather than the first. However, we forge on by using the largest possible pivot in column 2 for the next outer product.","position":{"start":{"line":839,"column":1},"end":{"line":839,"column":1}},"key":"AfHPtM9Cdg"}],"key":"pEFiIWnIjY"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[~, i] = max( abs(A_2(:, 2)) )\nU(2, :) = A_2(i, :);\nL(:, 2) = A_2(:, 2) / U(2, 2);\nA_3 = A_2 - L(:, 2) * U(2, :)","key":"Vz2r1rnnzK"},{"type":"output","id":"dB8roXlvsH6m-ml_9JcUd","data":[{"output_type":"execute_result","execution_count":82,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>i = 3</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"i = 3","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":82,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>A_3 = 4×4 double\n         0         0    0.4615   -0.9231\n         0         0    5.5385   -9.0769\n         0         0         0         0\n         0         0         0         0\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"A_3 = 4×4 double\n         0         0    0.4615   -0.9231\n         0         0    5.5385   -9.0769\n         0         0         0         0\n         0         0         0         0\n","content_type":"text/plain"}}}],"key":"wGKq0UhYJt"}],"key":"QVw2NzTES5"},{"type":"paragraph","position":{"start":{"line":848,"column":1},"end":{"line":848,"column":1}},"children":[{"type":"text","value":"Now we have zeroed out the third row as well as the second column. We can finish out the procedure.","position":{"start":{"line":848,"column":1},"end":{"line":848,"column":1}},"key":"AnquhoemkO"}],"key":"f8vPZ8SVas"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[~, i] = max( abs(A_3(:, 3)) ) \nU(3, :) = A_3(i, :);\nL(:, 3) = A_3(:, 3) / U(3, 3);\nA_4 = A_3 - L(:, 3) * U(3, :)","key":"X3aJUbaswZ"},{"type":"output","id":"-4TkCQ7YX5nyq3NZczTwr","data":[{"output_type":"execute_result","execution_count":83,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>i = 2</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"i = 2","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":83,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>A_4 = 4×4 double\n         0         0         0   -0.1667\n         0         0         0         0\n         0         0         0         0\n         0         0         0         0\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"A_4 = 4×4 double\n         0         0         0   -0.1667\n         0         0         0         0\n         0         0         0         0\n         0         0         0         0\n","content_type":"text/plain"}}}],"key":"gpB2u4gOdR"}],"key":"HJWEIM3YV1"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[~, i] = max( abs(A_4(:, 4)) ) \nU(4, :) = A_4(i, :);\nL(:, 4) = A_4(:, 4) / U(4, 4);","key":"PtjVzfEU3A"},{"type":"output","id":"tvSTSXDPF7om5MH4d3ZWN","data":[{"output_type":"execute_result","execution_count":84,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>i = 1</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"i = 1","content_type":"text/plain"}}}],"key":"wBkiJgvmYh"}],"key":"ntM5wRpghX"},{"type":"paragraph","position":{"start":{"line":863,"column":1},"end":{"line":863,"column":1}},"children":[{"type":"text","value":"We do have a factorization of the original matrix:","position":{"start":{"line":863,"column":1},"end":{"line":863,"column":1}},"key":"CfPw12S2ZQ"}],"key":"hJuBgCLTpU"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A_1 - L * U","key":"ulTySFk2yS"},{"type":"output","id":"yFJXEFXk3MjTcKhluSU-c","data":[{"output_type":"execute_result","execution_count":85,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = 4×4 double\n     0     0     0     0\n     0     0     0     0\n     0     0     0     0\n     0     0     0     0\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = 4×4 double\n     0     0     0     0\n     0     0     0     0\n     0     0     0     0\n     0     0     0     0\n","content_type":"text/plain"}}}],"key":"sBd7EpTINy"}],"key":"jEeDY7aPBk"},{"type":"paragraph","position":{"start":{"line":869,"column":1},"end":{"line":869,"column":1}},"children":[{"type":"text","value":"And ","position":{"start":{"line":869,"column":1},"end":{"line":869,"column":1}},"key":"g48CaQcjyV"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":869,"column":1},"end":{"line":869,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"ETXgJlbgKF"},{"type":"text","value":" has the required structure:","position":{"start":{"line":869,"column":1},"end":{"line":869,"column":1}},"key":"AnLZOO3tJv"}],"key":"kLWkvZzjxX"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"U","key":"ZjCHa2KdhB"},{"type":"output","id":"c6BcYjF4q9WoUOltnlMQl","data":[{"output_type":"execute_result","execution_count":86,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>U = 4×4 double\n   -4.0000    5.0000   -7.0000  -10.0000\n         0   16.2500    0.2500   -7.0000\n         0         0    5.5385   -9.0769\n         0         0         0   -0.1667\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"U = 4×4 double\n   -4.0000    5.0000   -7.0000  -10.0000\n         0   16.2500    0.2500   -7.0000\n         0         0    5.5385   -9.0769\n         0         0         0   -0.1667\n","content_type":"text/plain"}}}],"key":"cfTrgPSQrm"}],"key":"bNTOiXfVUS"},{"type":"paragraph","position":{"start":{"line":875,"column":1},"end":{"line":875,"column":1}},"children":[{"type":"text","value":"However, the triangularity of ","position":{"start":{"line":875,"column":1},"end":{"line":875,"column":1}},"key":"ZsF0wtYa6F"},{"type":"inlineMath","value":"\\mathbf{L}","position":{"start":{"line":875,"column":1},"end":{"line":875,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">L</span></span></span></span>","key":"GeadRgvpIN"},{"type":"text","value":" has been broken.","position":{"start":{"line":875,"column":1},"end":{"line":875,"column":1}},"key":"xhlDx2H1eG"}],"key":"ZcUHEbLw6E"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"L","key":"c4gv75AzUh"},{"type":"output","id":"nxLKxrkmZ6Rx4ZPpoVll4","data":[{"output_type":"execute_result","execution_count":87,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>L = 4×4 double\n   -0.5000    0.1538    0.0833    1.0000\n    0.5000   -0.1538    1.0000         0\n   -0.2500    1.0000         0         0\n    1.0000         0         0         0\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"L = 4×4 double\n   -0.5000    0.1538    0.0833    1.0000\n    0.5000   -0.1538    1.0000         0\n   -0.2500    1.0000         0         0\n    1.0000         0         0         0\n","content_type":"text/plain"}}}],"key":"KAti0idigc"}],"key":"TIWvssy7TR"}],"key":"BgG2mFUZdF"}],"key":"ymyxLTAfcQ"}],"key":"cgvJT9zRB7"},{"type":"tabItem","title":"Python","sync":"python","children":[{"type":"embed","source":{"url":"/chapter2-2","label":"demo-pivoting-fix-python","kind":"Notebook","slug":"chapter2-2","location":"/python/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-pivoting-fix","label":"demo-pivoting-fix","kind":"proof:example","position":{"start":{"line":788,"column":1},"end":{"line":788,"column":19}},"children":[{"type":"text","value":"Example ","key":"B2hD3UDB6n"},{"type":"text","value":"2.6.2","key":"wRN1SKRC0E"}],"template":"Example %s","enumerator":"2.6.2","resolved":true,"html_id":"demo-pivoting-fix","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"yTAeEmrasL"}],"key":"hDBBc9B4Oi"},{"type":"paragraph","position":{"start":{"line":790,"column":1},"end":{"line":790,"column":1}},"children":[{"type":"text","value":"Here is the trouble-making matrix from ","position":{"start":{"line":790,"column":1},"end":{"line":790,"column":1}},"key":"JVpHtQGK5X"},{"type":"crossReference","identifier":"demo-pivoting-fail","label":"demo-pivoting-fail","kind":"proof:example","position":{"start":{"line":790,"column":40},"end":{"line":790,"column":59}},"children":[{"type":"text","value":"Example ","key":"CbcZxgitg2"},{"type":"text","value":"2.6.1","key":"n4agrXX15K"}],"template":"Example %s","enumerator":"2.6.1","resolved":true,"html_id":"demo-pivoting-fail","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"oJwTUxg1xv"},{"type":"text","value":".","position":{"start":{"line":790,"column":1},"end":{"line":790,"column":1}},"key":"izrmAT2Oxz"}],"key":"CxRtNJv0B4"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"A_1 = array([\n    [2, 0, 4, 3],\n    [-2, 0, 2, -13],\n    [1, 15, 2, -4.5],\n    [-4, 5, -7, -10]\n    ])","key":"yUzixrolbg"},{"type":"output","id":"0yBM4px9XyrJYCp5rD5Wc","data":[],"key":"qX0RHx9cK4"}],"key":"jnivDIhmp5"},{"type":"paragraph","position":{"start":{"line":801,"column":1},"end":{"line":801,"column":1}},"children":[{"type":"text","value":"We now find the largest candidate pivot in the first column. We don’t care about sign, so we take absolute values before finding the max.","position":{"start":{"line":801,"column":1},"end":{"line":801,"column":1}},"key":"MJYdLw93gx"}],"key":"G6dvuGO35K"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"ItUhCtu1qL"}],"key":"F4Piz4Ar2F"},{"type":"paragraph","position":{"start":{"line":804,"column":1},"end":{"line":804,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":804,"column":1},"end":{"line":804,"column":1}},"key":"n61lxvTaAb"},{"type":"inlineCode","value":"argmax","position":{"start":{"line":804,"column":1},"end":{"line":804,"column":1}},"key":"TsysFFpXTU"},{"type":"text","value":" function returns the location of the largest element of a vector or matrix.","position":{"start":{"line":804,"column":1},"end":{"line":804,"column":1}},"key":"bl1W2qfTYW"}],"key":"KoXq2qPMRY"}],"class":"dropdown","key":"bf7dwOEroL"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"i = argmax( abs(A_1[:, 0]) )\nprint(i)","key":"yXfgAkcqNp"},{"type":"output","id":"d7Prr6tAgGLMlBZRfb3yp","data":[{"output_type":"stream","name":"stdout","text":"3\n"}],"key":"sMqde7ISyu"}],"key":"JKY3I10p1y"},{"type":"paragraph","position":{"start":{"line":813,"column":1},"end":{"line":813,"column":1}},"children":[{"type":"text","value":"This is the row of the matrix that we extract to put into ","position":{"start":{"line":813,"column":1},"end":{"line":813,"column":1}},"key":"ehTJtmhxvu"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":813,"column":1},"end":{"line":813,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"Nj7WQEik6D"},{"type":"text","value":". That guarantees that the division used to find ","position":{"start":{"line":813,"column":1},"end":{"line":813,"column":1}},"key":"hsTHRF1Kwu"},{"type":"inlineMath","value":"\\boldsymbol{\\ell}_1","position":{"start":{"line":813,"column":1},"end":{"line":813,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">ℓ</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\boldsymbol{\\ell}_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">ℓ</span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"ao5OuK7V37"},{"type":"text","value":" will be valid.","position":{"start":{"line":813,"column":1},"end":{"line":813,"column":1}},"key":"B0VIi23IU5"}],"key":"Ax69f3uFCy"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"L, U = eye(4), zeros((4, 4))\nU[0, :] = A_1[i, :]\nL[:, 0] = A_1[:, 0] / U[0, 0]\nA_2 = A_1 - outer(L[:, 0], U[0, :])\nprint(A_2)","key":"rDM71l8vNd"},{"type":"output","id":"17gXEjsh06GlpEeC-GzUO","data":[{"output_type":"stream","name":"stdout","text":"[[ 0.    2.5   0.5  -2.  ]\n [ 0.   -2.5   5.5  -8.  ]\n [ 0.   16.25  0.25 -7.  ]\n [ 0.    0.    0.    0.  ]]\n"}],"key":"FNy3ItnwRF"}],"key":"uVRTUkgiST"},{"type":"paragraph","position":{"start":{"line":823,"column":1},"end":{"line":823,"column":1}},"children":[{"type":"text","value":"Observe that ","position":{"start":{"line":823,"column":1},"end":{"line":823,"column":1}},"key":"JcVIUJbIZf"},{"type":"inlineMath","value":"\\mathbf{A}_2","position":{"start":{"line":823,"column":1},"end":{"line":823,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">A</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8361em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"GuRqLPkCdh"},{"type":"text","value":" has a new zero row and zero column, but the zero row is the fourth rather than the first. However, we forge on by using the largest possible pivot in column 2 for the next outer product.","position":{"start":{"line":823,"column":1},"end":{"line":823,"column":1}},"key":"ic0CBiSgvw"}],"key":"Z4wcJSSNJ2"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"i = argmax( abs(A_2[:, 1]) ) \nprint(f\"new pivot row is {i}\")\nU[1, :] = A_2[i, :]\nL[:, 1] = A_2[:, 1] / U[1, 1]\nA_3 = A_2 - outer(L[:, 1], U[1, :])\nprint(A_3)","key":"duD76HxzS2"},{"type":"output","id":"Ff-iqEQIOkFPvI3VJ4Sfk","data":[{"output_type":"stream","name":"stdout","text":"new pivot row is 2\n[[ 0.          0.          0.46153846 -0.92307692]\n [ 0.          0.          5.53846154 -9.07692308]\n [ 0.          0.          0.          0.        ]\n [ 0.          0.          0.          0.        ]]\n"}],"key":"jyU0pKOGTX"}],"key":"gnEamDibaJ"},{"type":"paragraph","position":{"start":{"line":833,"column":1},"end":{"line":833,"column":1}},"children":[{"type":"text","value":"Now we have zeroed out the third row as well as the second column. We can finish out the procedure.","position":{"start":{"line":833,"column":1},"end":{"line":833,"column":1}},"key":"aiXPuhZdrx"}],"key":"SSsUpY4DUl"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"i = argmax( abs(A_3[:, 2]) ) \nprint(f\"new pivot row is {i}\")\nU[2, :] = A_3[i, :]\nL[:, 2] = A_3[:, 2] / U[2, 2]\nA_4 = A_3 - outer(L[:, 2], U[2, :])\nprint(A_4)","key":"IaKS7nAJhg"},{"type":"output","id":"fGCPnGMra-VEHeDOhJCsr","data":[{"output_type":"stream","name":"stdout","text":"new pivot row is 1\n[[ 0.          0.          0.         -0.16666667]\n [ 0.          0.          0.          0.        ]\n [ 0.          0.          0.          0.        ]\n [ 0.          0.          0.          0.        ]]\n"}],"key":"J7rbLMxCUx"}],"key":"Y7CLhqm4SV"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"i = argmax( abs(A_4[:, 3]) ) \nprint(f\"new pivot row is {i}\")\nU[3, :] = A_4[i, :]\nL[:, 3] = A_4[:, 3] / U[3, 3];","key":"Z3Kak9jDY3"},{"type":"output","id":"APzK0DnSP1FPhNYN__pUB","data":[{"output_type":"stream","name":"stdout","text":"new pivot row is 0\n"}],"key":"w2HtGPIYBz"}],"key":"hXqRJXYQ8H"},{"type":"paragraph","position":{"start":{"line":851,"column":1},"end":{"line":851,"column":1}},"children":[{"type":"text","value":"We do have a factorization of the original matrix:","position":{"start":{"line":851,"column":1},"end":{"line":851,"column":1}},"key":"mPnuduByYC"}],"key":"JAACC9BhnL"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"A_1 - L @ U","key":"IL5Eh85nl1"},{"type":"output","id":"xxEs6FbVidLbN5ivcl2Mp","data":[{"output_type":"execute_result","execution_count":84,"metadata":{},"data":{"text/plain":{"content":"array([[ 0.00000000e+00, -1.38777878e-16,  0.00000000e+00,\n         0.00000000e+00],\n       [ 0.00000000e+00,  1.38777878e-16,  0.00000000e+00,\n         0.00000000e+00],\n       [ 0.00000000e+00,  0.00000000e+00,  0.00000000e+00,\n         0.00000000e+00],\n       [ 0.00000000e+00,  0.00000000e+00,  0.00000000e+00,\n         0.00000000e+00]])","content_type":"text/plain"}}}],"key":"bb1CtkzMLr"}],"key":"Fq5EpweOWE"},{"type":"paragraph","position":{"start":{"line":857,"column":1},"end":{"line":857,"column":1}},"children":[{"type":"text","value":"And ","position":{"start":{"line":857,"column":1},"end":{"line":857,"column":1}},"key":"fwUtTwMUUG"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":857,"column":1},"end":{"line":857,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"lfKqqbtbke"},{"type":"text","value":" has the required structure:","position":{"start":{"line":857,"column":1},"end":{"line":857,"column":1}},"key":"t2EqJzdq6F"}],"key":"WpsPOU0PlY"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(U)","key":"U6Kn3nEHlO"},{"type":"output","id":"mA-P_Ns9xACSkZUd6EkwE","data":[{"output_type":"stream","name":"stdout","text":"[[ -4.           5.          -7.         -10.        ]\n [  0.          16.25         0.25        -7.        ]\n [  0.           0.           5.53846154  -9.07692308]\n [  0.           0.           0.          -0.16666667]]\n"}],"key":"wCDlSacZ6c"}],"key":"BBjTeubhZ1"},{"type":"paragraph","position":{"start":{"line":863,"column":1},"end":{"line":863,"column":1}},"children":[{"type":"text","value":"However, the triangularity of ","position":{"start":{"line":863,"column":1},"end":{"line":863,"column":1}},"key":"YXcpz0Jj4X"},{"type":"inlineMath","value":"\\mathbf{L}","position":{"start":{"line":863,"column":1},"end":{"line":863,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">L</span></span></span></span>","key":"qZhwAYL7uA"},{"type":"text","value":" has been broken.","position":{"start":{"line":863,"column":1},"end":{"line":863,"column":1}},"key":"XPf9T4bzkw"}],"key":"sJIuUgAnBf"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(L)","key":"e9jdnaCdC3"},{"type":"output","id":"PnmmAf8VsZePFAV-uReQX","data":[{"output_type":"stream","name":"stdout","text":"[[-0.5         0.15384615  0.08333333  1.        ]\n [ 0.5        -0.15384615  1.         -0.        ]\n [-0.25        1.          0.         -0.        ]\n [ 1.          0.          0.         -0.        ]]\n"}],"key":"bQVJ44UCCD"}],"key":"GqNk7WjN0Y"}],"key":"sSvryWr1Yp"}],"key":"VVZNBTNeQf"}],"key":"A1I24BUXhb"}],"key":"uiGPwB2TNi"}],"label":"demo-pivoting-fix","identifier":"demo-pivoting-fix","enumerator":"2.6.2","html_id":"demo-pivoting-fix","key":"XxAGfGSx9q"},{"type":"paragraph","position":{"start":{"line":78,"column":1},"end":{"line":78,"column":1}},"children":[{"type":"text","value":"We will return to the loss of triangularity in ","position":{"start":{"line":78,"column":1},"end":{"line":78,"column":1}},"key":"mMU7BIiEOe"},{"type":"inlineMath","value":"\\mathbf{L}","position":{"start":{"line":78,"column":1},"end":{"line":78,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">L</span></span></span></span>","key":"vXCrtJan5L"},{"type":"text","value":" momentarily. First, though, there is a question left to answer: what if at some stage, all the elements of the targeted column are zero, i.e., there are no available pivots? Fortunately that loose end ties up nicely, although a proof is a bit beyond our scope here.","position":{"start":{"line":78,"column":1},"end":{"line":78,"column":1}},"key":"cqqFIuGuVO"}],"key":"XQignUAsSW"},{"type":"proof","kind":"theorem","enumerated":true,"children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Row pivoting","position":{"start":{"line":80,"column":1},"end":{"line":80,"column":1}},"key":"asaWPPPvL9"}],"key":"y9ZIx04ZK5"},{"type":"paragraph","position":{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},"children":[{"type":"text","value":"The row-pivoted LU factorization runs to completion if and only if the original matrix is invertible.","position":{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},"key":"fuMklShNSq"}],"key":"DBMDmlHKkL"}],"label":"theorem-pivot","identifier":"theorem-pivot","enumerator":"2.6.1","html_id":"theorem-pivot","key":"wSrDQRA7rD"},{"type":"paragraph","position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"children":[{"type":"text","value":"A linear system with a singular matrix has either no solution or infinitely many solutions. Either way, a technique other than LU factorization is needed to handle it.","position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"key":"VbLpUvYtbl"}],"key":"kBxvTsbAih"},{"type":"heading","depth":2,"position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"children":[{"type":"text","value":"Permutations","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"fCqZ5LZDBg"}],"identifier":"permutations","label":"Permutations","html_id":"permutations","implicit":true,"enumerator":"2.6.2","key":"DRVYtwYyIg"},{"type":"paragraph","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"children":[{"type":"text","value":"Even though the resulting ","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"key":"pQYLSVH0v1"},{"type":"inlineMath","value":"\\mathbf{L}","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">L</span></span></span></span>","key":"kgu4yV8BoK"},{"type":"text","value":" in ","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"key":"Yr05i3RGg9"},{"type":"crossReference","identifier":"demo-pivoting-fix","label":"demo-pivoting-fix","kind":"proof:example","position":{"start":{"line":89,"column":43},"end":{"line":89,"column":61}},"children":[{"type":"text","value":"Example ","key":"CIdYT7fB9W"},{"type":"text","value":"2.6.2","key":"PC468UIMqm"}],"template":"Example %s","enumerator":"2.6.2","resolved":true,"html_id":"demo-pivoting-fix","key":"QuoUW8B1eP"},{"type":"text","value":" is no longer of unit lower triangular form, it is close. In fact, all that is needed is to reverse the order of its rows.","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"key":"xNS1JnddUG"}],"key":"S6oLJErHWl"},{"type":"proof","kind":"example","enumerated":true,"children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Pivoting as row permutation","position":{"start":{"line":91,"column":1},"end":{"line":91,"column":1}},"key":"PMmVwecVbG"}],"key":"qjj7m38LbJ"},{"type":"tabSet","children":[{"type":"tabItem","title":"Julia","sync":"julia","children":[{"type":"embed","source":{"url":"/chapter2","label":"demo-pivoting-permute-julia","kind":"Notebook","slug":"chapter2","location":"/julia/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-pivoting-permute","label":"demo-pivoting-permute","kind":"proof:example","position":{"start":{"line":937,"column":1},"end":{"line":937,"column":23}},"children":[{"type":"text","value":"Example ","key":"jaXzTb4MVO"},{"type":"text","value":"2.6.3","key":"gBWzGRxBXh"}],"template":"Example %s","enumerator":"2.6.3","resolved":true,"html_id":"demo-pivoting-permute","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"BUWjGWFILL"}],"key":"YgymlDI6Yr"},{"type":"paragraph","position":{"start":{"line":939,"column":1},"end":{"line":939,"column":1}},"children":[{"type":"text","value":"Here again is the matrix from ","position":{"start":{"line":939,"column":1},"end":{"line":939,"column":1}},"key":"gVVd4ZiHTL"},{"type":"crossReference","identifier":"demo-pivoting-fix","label":"demo-pivoting-fix","kind":"proof:example","position":{"start":{"line":939,"column":31},"end":{"line":939,"column":49}},"children":[{"type":"text","value":"Example ","key":"z7kUI2zWh2"},{"type":"text","value":"2.6.2","key":"YqEnZnHBwj"}],"template":"Example %s","enumerator":"2.6.2","resolved":true,"html_id":"demo-pivoting-fix","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"PA2qev8yag"},{"type":"text","value":".","position":{"start":{"line":939,"column":1},"end":{"line":939,"column":1}},"key":"Yb8e9fwzUL"}],"key":"iQmmRiyvOD"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"A = [2 0 4 3 ; -2 0 2 -13; 1 15 2 -4.5 ; -4 5 -7 -10]","key":"FK8lkhsZQX"},{"type":"output","id":"28X8YQCvgf-4FFTvNr_G_","data":[{"output_type":"execute_result","execution_count":90,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n  2.0   0.0   4.0    3.0\n -2.0   0.0   2.0  -13.0\n  1.0  15.0   2.0   -4.5\n -4.0   5.0  -7.0  -10.0","content_type":"text/plain"}}}],"key":"xHxAG9HHYC"}],"key":"THK1CAqw0C"},{"type":"paragraph","position":{"start":{"line":945,"column":1},"end":{"line":945,"column":1}},"children":[{"type":"text","value":"As the factorization proceeded, the pivots were selected from rows 4, 3, 2, and finally 1. If we were to put the rows of ","position":{"start":{"line":945,"column":1},"end":{"line":945,"column":1}},"key":"cACCbdx4uU"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":945,"column":1},"end":{"line":945,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"ZnI6P9FeaK"},{"type":"text","value":" into that order, then the algorithm would run exactly like the plain LU factorization from ","position":{"start":{"line":945,"column":1},"end":{"line":945,"column":1}},"key":"RmltD6CAva"},{"type":"link","kind":"numref","identifier":"section-linsys-lu","label":"section-linsys-lu","url":"/lu","internal":true,"dataUrl":"/lu.json","children":[{"type":"text","value":"LU factorization","key":"MxXU0OGR8J"}],"key":"kQMCiLLIm9"},{"type":"text","value":".","position":{"start":{"line":945,"column":1},"end":{"line":945,"column":1}},"key":"FtAMCAqJ5F"}],"key":"C5o0zJPlyE"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"B = A[[4, 3, 2, 1], :]\nL, U = FNC.lufact(B);","key":"lJMHfGkint"},{"type":"output","id":"xPaO7RgnrHLSq2wrC7X-O","data":[],"key":"xg1zoDeSw3"}],"key":"uMy2OgJoEH"},{"type":"paragraph","position":{"start":{"line":952,"column":1},"end":{"line":952,"column":1}},"children":[{"type":"text","value":"We obtain the same ","position":{"start":{"line":952,"column":1},"end":{"line":952,"column":1}},"key":"JINbKB2fvE"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":952,"column":1},"end":{"line":952,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"CqhvGCZSjh"},{"type":"text","value":" as before:","position":{"start":{"line":952,"column":1},"end":{"line":952,"column":1}},"key":"twkIb1XMht"}],"key":"cqHY9p1Yb5"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"U","key":"simhdxtJlc"},{"type":"output","id":"ko70Ukj1iA2uNE9Dd_52W","data":[{"output_type":"execute_result","execution_count":92,"metadata":{},"data":{"text/plain":{"content":"4×4 UpperTriangular{Float64, Matrix{Float64}}:\n -4.0   5.0   -7.0      -10.0\n   ⋅   16.25   0.25      -7.0\n   ⋅     ⋅     5.53846   -9.07692\n   ⋅     ⋅      ⋅        -0.166667","content_type":"text/plain"}}}],"key":"Aime4Pm3qm"}],"key":"x2mwLuwNXJ"},{"type":"paragraph","position":{"start":{"line":958,"column":1},"end":{"line":958,"column":1}},"children":[{"type":"text","value":"And ","position":{"start":{"line":958,"column":1},"end":{"line":958,"column":1}},"key":"HiFQg7Y5Zm"},{"type":"inlineMath","value":"\\mathbf{L}","position":{"start":{"line":958,"column":1},"end":{"line":958,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">L</span></span></span></span>","key":"a9yfLxkVM3"},{"type":"text","value":" has the same rows as before, but arranged into triangular order:","position":{"start":{"line":958,"column":1},"end":{"line":958,"column":1}},"key":"OJuT9qnyCm"}],"key":"h6oPpZe5mo"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"L","key":"grL4zl8jmW"},{"type":"output","id":"cGnGLhc2M2s3rxcnohGxJ","data":[{"output_type":"execute_result","execution_count":93,"metadata":{},"data":{"text/plain":{"content":"4×4 LowerTriangular{Float64, Matrix{Float64}}:\n  1.0     ⋅         ⋅          ⋅ \n -0.25   1.0        ⋅          ⋅ \n  0.5   -0.153846  1.0         ⋅ \n -0.5    0.153846  0.0833333  1.0","content_type":"text/plain"}}}],"key":"cffqxATmuQ"}],"key":"vEfcvY3g6c"}],"key":"eCbSoq8Jeh"}],"key":"ciLtYOk3KS"}],"key":"US0TiRp0Ul"},{"type":"tabItem","title":"MATLAB","sync":"matlab","children":[{"type":"embed","source":{"url":"/chapter2-1","label":"demo-pivoting-permute-matlab","kind":"Notebook","slug":"chapter2-1","location":"/matlab/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-pivoting-permute","label":"demo-pivoting-permute","kind":"proof:example","position":{"start":{"line":883,"column":1},"end":{"line":883,"column":23}},"children":[{"type":"text","value":"Example ","key":"g5iFXK65Pa"},{"type":"text","value":"2.6.3","key":"pu5U9LV5Dr"}],"template":"Example %s","enumerator":"2.6.3","resolved":true,"html_id":"demo-pivoting-permute","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"xjEIfZI5dN"}],"key":"ipv4xpaPgI"},{"type":"paragraph","position":{"start":{"line":885,"column":1},"end":{"line":885,"column":1}},"children":[{"type":"text","value":"Here again is the matrix from ","position":{"start":{"line":885,"column":1},"end":{"line":885,"column":1}},"key":"aUVl6OTZg0"},{"type":"crossReference","identifier":"demo-pivoting-fix","label":"demo-pivoting-fix","kind":"proof:example","position":{"start":{"line":885,"column":31},"end":{"line":885,"column":49}},"children":[{"type":"text","value":"Example ","key":"tvU6df04N2"},{"type":"text","value":"2.6.2","key":"PTAZT22sZN"}],"template":"Example %s","enumerator":"2.6.2","resolved":true,"html_id":"demo-pivoting-fix","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"VpIQcHG2dp"},{"type":"text","value":".","position":{"start":{"line":885,"column":1},"end":{"line":885,"column":1}},"key":"I9UpAeCgo4"}],"key":"nvbvOL7Mld"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A = [2 0 4 3; -2 0 2 -13; 1 15 2 -4.5; -4 5 -7 -10]","key":"PNUJvKVhIS"},{"type":"output","id":"kkxD7P1HJHj7zGGfEnx34","data":[{"output_type":"execute_result","execution_count":88,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>A = 4×4 double\n    2.0000         0    4.0000    3.0000\n   -2.0000         0    2.0000  -13.0000\n    1.0000   15.0000    2.0000   -4.5000\n   -4.0000    5.0000   -7.0000  -10.0000\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"A = 4×4 double\n    2.0000         0    4.0000    3.0000\n   -2.0000         0    2.0000  -13.0000\n    1.0000   15.0000    2.0000   -4.5000\n   -4.0000    5.0000   -7.0000  -10.0000\n","content_type":"text/plain"}}}],"key":"vcdmAArtcu"}],"key":"FVxAgadA4M"},{"type":"paragraph","position":{"start":{"line":891,"column":1},"end":{"line":891,"column":1}},"children":[{"type":"text","value":"As the factorization proceeded, the pivots were selected from rows 4, 3, 2, and finally 1. If we were to put the rows of ","position":{"start":{"line":891,"column":1},"end":{"line":891,"column":1}},"key":"sF5y3iIWJz"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":891,"column":1},"end":{"line":891,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"LG1gkBuWN8"},{"type":"text","value":" into that order, then the algorithm would run exactly like the plain LU factorization from ","position":{"start":{"line":891,"column":1},"end":{"line":891,"column":1}},"key":"LUkGEi9lkx"},{"type":"link","kind":"numref","identifier":"section-linsys-lu","label":"section-linsys-lu","url":"/lu","internal":true,"dataUrl":"/lu.json","children":[{"type":"text","value":"LU factorization","key":"Ps1Mfn0Fkf"}],"key":"z2ea1066da"},{"type":"text","value":".","position":{"start":{"line":891,"column":1},"end":{"line":891,"column":1}},"key":"v8rgIuq7aW"}],"key":"RUvntCcvWE"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"B = A([4, 3, 2, 1], :);\n[L, U] = lufact(B);","key":"HBnvY1H6J6"},{"type":"output","id":"4hzFgR-IxKF1l63pPiM04","data":[],"key":"hileMN3OZJ"}],"key":"jIaW50ll4N"},{"type":"paragraph","position":{"start":{"line":898,"column":1},"end":{"line":898,"column":1}},"children":[{"type":"text","value":"We obtain the same ","position":{"start":{"line":898,"column":1},"end":{"line":898,"column":1}},"key":"nN8qpxb3ZS"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":898,"column":1},"end":{"line":898,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"hgaOe7R2zQ"},{"type":"text","value":" as before:","position":{"start":{"line":898,"column":1},"end":{"line":898,"column":1}},"key":"EekQQor6jh"}],"key":"fg7l2fRMv6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"U","key":"TWweJv9XvP"},{"type":"output","id":"k4sOyqEQfVLZ0aK-h_cN6","data":[{"output_type":"execute_result","execution_count":90,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>U = 4×4 double\n   -4.0000    5.0000   -7.0000  -10.0000\n         0   16.2500    0.2500   -7.0000\n         0         0    5.5385   -9.0769\n         0         0         0   -0.1667\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"U = 4×4 double\n   -4.0000    5.0000   -7.0000  -10.0000\n         0   16.2500    0.2500   -7.0000\n         0         0    5.5385   -9.0769\n         0         0         0   -0.1667\n","content_type":"text/plain"}}}],"key":"MT8aghd8GI"}],"key":"jFYci1GD62"},{"type":"paragraph","position":{"start":{"line":904,"column":1},"end":{"line":904,"column":1}},"children":[{"type":"text","value":"And ","position":{"start":{"line":904,"column":1},"end":{"line":904,"column":1}},"key":"ARU0685c7s"},{"type":"inlineMath","value":"\\mathbf{L}","position":{"start":{"line":904,"column":1},"end":{"line":904,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">L</span></span></span></span>","key":"EEjh8S1ncr"},{"type":"text","value":" has the same rows as before, but arranged into triangular order:","position":{"start":{"line":904,"column":1},"end":{"line":904,"column":1}},"key":"Z7wTSsKAmb"}],"key":"A959z5drEY"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"L","key":"fN8j8H5WTk"},{"type":"output","id":"pjMnxCsN-nJO4s3uQbgnq","data":[{"output_type":"execute_result","execution_count":91,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>L = 4×4 double\n    1.0000         0         0         0\n   -0.2500    1.0000         0         0\n    0.5000   -0.1538    1.0000         0\n   -0.5000    0.1538    0.0833    1.0000\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"L = 4×4 double\n    1.0000         0         0         0\n   -0.2500    1.0000         0         0\n    0.5000   -0.1538    1.0000         0\n   -0.5000    0.1538    0.0833    1.0000\n","content_type":"text/plain"}}}],"key":"Sn4f0GvK93"}],"key":"oeiWayqwhP"}],"key":"sGuh8Hg0Um"}],"key":"hkynwdzX8L"}],"key":"bFmwHruVBl"},{"type":"tabItem","title":"Python","sync":"python","children":[{"type":"embed","source":{"url":"/chapter2-2","label":"demo-pivoting-permute-python","kind":"Notebook","slug":"chapter2-2","location":"/python/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-pivoting-permute","label":"demo-pivoting-permute","kind":"proof:example","position":{"start":{"line":872,"column":1},"end":{"line":872,"column":23}},"children":[{"type":"text","value":"Example ","key":"h9LPoba1yS"},{"type":"text","value":"2.6.3","key":"d90adxnBNe"}],"template":"Example %s","enumerator":"2.6.3","resolved":true,"html_id":"demo-pivoting-permute","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"d7EvcxDKg7"}],"key":"RnsB8FmE64"},{"type":"paragraph","position":{"start":{"line":874,"column":1},"end":{"line":874,"column":1}},"children":[{"type":"text","value":"Here again is the matrix from ","position":{"start":{"line":874,"column":1},"end":{"line":874,"column":1}},"key":"pUk8SocJae"},{"type":"crossReference","identifier":"demo-pivoting-fix","label":"demo-pivoting-fix","kind":"proof:example","position":{"start":{"line":874,"column":31},"end":{"line":874,"column":49}},"children":[{"type":"text","value":"Example ","key":"P3JhLHH3FQ"},{"type":"text","value":"2.6.2","key":"LkfITAfukS"}],"template":"Example %s","enumerator":"2.6.2","resolved":true,"html_id":"demo-pivoting-fix","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"vEEOxU5jOn"},{"type":"text","value":".","position":{"start":{"line":874,"column":1},"end":{"line":874,"column":1}},"key":"PhlqrQH3a1"}],"key":"MsT3OXVZzH"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"A = array([\n    [2, 0, 4, 3],\n    [-2, 0, 2, -13],\n    [1, 15, 2, -4.5],\n    [-4, 5, -7, -10]\n    ])","key":"Zrf11uwXLv"},{"type":"output","id":"X0ysPTkzQY9HeUjQeyqCB","data":[],"key":"DglDvfWzQa"}],"key":"igmQ11RDaq"},{"type":"paragraph","position":{"start":{"line":885,"column":1},"end":{"line":885,"column":1}},"children":[{"type":"text","value":"As the factorization proceeded, the pivots were selected from rows 4, 3, 2, and finally 1 (with NumPy indices being one less). If we were to put the rows of ","position":{"start":{"line":885,"column":1},"end":{"line":885,"column":1}},"key":"vPeFTs7IiE"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":885,"column":1},"end":{"line":885,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"QUXNaHCaNa"},{"type":"text","value":" into that order, then the algorithm would run exactly like the plain LU factorization from ","position":{"start":{"line":885,"column":1},"end":{"line":885,"column":1}},"key":"FJ5oBLnlvT"},{"type":"link","kind":"numref","identifier":"section-linsys-lu","label":"section-linsys-lu","url":"/lu","internal":true,"dataUrl":"/lu.json","children":[{"type":"text","value":"LU factorization","key":"Lg6Q9XI7Fm"}],"key":"pnWUgoZXbV"},{"type":"text","value":".","position":{"start":{"line":885,"column":1},"end":{"line":885,"column":1}},"key":"QWa1hSnPq9"}],"key":"sDEP3CQGd9"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"B = A[[3, 2, 1, 0], :]\nL, U = FNC.lufact(B);","key":"FSX3HtYE9p"},{"type":"output","id":"CbkeN7y9ePKHGewPH9GeY","data":[],"key":"C6iuYfKOTw"}],"key":"b2ci6TT1wA"},{"type":"paragraph","position":{"start":{"line":892,"column":1},"end":{"line":892,"column":1}},"children":[{"type":"text","value":"We obtain the same ","position":{"start":{"line":892,"column":1},"end":{"line":892,"column":1}},"key":"OcAnK7A81O"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":892,"column":1},"end":{"line":892,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"pjf5E7dEDb"},{"type":"text","value":" as before:","position":{"start":{"line":892,"column":1},"end":{"line":892,"column":1}},"key":"MbfTY7j8pX"}],"key":"gKwhg4SJ93"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(U)","key":"SNtN3ysADV"},{"type":"output","id":"ZpBHuanhr4H_0t-rNafEB","data":[{"output_type":"stream","name":"stdout","text":"[[ -4.           5.          -7.         -10.        ]\n [  0.          16.25         0.25        -7.        ]\n [  0.           0.           5.53846154  -9.07692308]\n [  0.           0.           0.          -0.16666667]]\n"}],"key":"OAuj5gixkc"}],"key":"yg8WH3W6el"},{"type":"paragraph","position":{"start":{"line":898,"column":1},"end":{"line":898,"column":1}},"children":[{"type":"text","value":"And ","position":{"start":{"line":898,"column":1},"end":{"line":898,"column":1}},"key":"TEHB2nmPiK"},{"type":"inlineMath","value":"\\mathbf{L}","position":{"start":{"line":898,"column":1},"end":{"line":898,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">L</span></span></span></span>","key":"QXIPguvahr"},{"type":"text","value":" has the same rows as before, but arranged into triangular order:","position":{"start":{"line":898,"column":1},"end":{"line":898,"column":1}},"key":"ASU2TuO2lt"}],"key":"DdDKiEuk8s"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(L)","key":"dDfNxKZxqw"},{"type":"output","id":"paPbW7RfSdf6mDfNh_lW4","data":[{"output_type":"stream","name":"stdout","text":"[[ 1.          0.          0.          0.        ]\n [-0.25        1.          0.          0.        ]\n [ 0.5        -0.15384615  1.          0.        ]\n [-0.5         0.15384615  0.08333333  1.        ]]\n"}],"key":"oX1Gb9i2ZU"}],"key":"ERcBf5PpGO"}],"key":"tear2sNAZY"}],"key":"VwWf9vzVto"}],"key":"knoI7ZaBg9"}],"key":"TgWQvxsr3L"}],"label":"demo-pivoting-permute","identifier":"demo-pivoting-permute","enumerator":"2.6.3","html_id":"demo-pivoting-permute","key":"p7UA9EjhCk"},{"type":"paragraph","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"children":[{"type":"text","value":"In principle, if the permutation of rows implied by the pivot locations is applied all at once to the original ","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"key":"miOjfNYQKy"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"EjzO58k6IZ"},{"type":"text","value":", no further pivoting is needed. In practice, this permutation cannot be determined immediately from the original ","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"key":"otiIqErVz7"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"YNGqiTFqQa"},{"type":"text","value":"; the only way to find it is to run the algorithm. Having obtained it at the end, though, we can use it to state a simple relationship.","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"key":"ZgTWnhgiO3"}],"key":"yv9CXactxs"},{"type":"proof","kind":"definition","enumerated":true,"children":[{"type":"admonitionTitle","children":[{"type":"text","value":"PLU factorization","position":{"start":{"line":121,"column":1},"end":{"line":121,"column":1}},"key":"zMS2dkIME3"}],"key":"Hq9Ip5kaxE"},{"type":"paragraph","position":{"start":{"line":123,"column":1},"end":{"line":123,"column":1}},"children":[{"type":"text","value":"Given ","position":{"start":{"line":123,"column":1},"end":{"line":123,"column":1}},"key":"zr2Yy5y7HX"},{"type":"inlineMath","value":"n\\times n","position":{"start":{"line":123,"column":1},"end":{"line":123,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>×</mo><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n\\times n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"jewdztC6Fk"},{"type":"text","value":" matrix ","position":{"start":{"line":123,"column":1},"end":{"line":123,"column":1}},"key":"nomUiXazOF"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":123,"column":1},"end":{"line":123,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"GnMv2ISPJS"},{"type":"text","value":", the ","position":{"start":{"line":123,"column":1},"end":{"line":123,"column":1}},"key":"MhwaZLMuIA"},{"type":"crossReference","label":"PLU factorization","identifier":"term-plu factorization","kind":"definitionTerm","children":[{"type":"text","value":"PLU factorization","position":{"start":{"line":280,"column":1},"end":{"line":280,"column":1}},"key":"gKRTO1ErBP"}],"template":"{name}","resolved":true,"html_id":"term-plu-factorization","remote":true,"url":"/glossary","dataUrl":"/glossary.json","key":"c4ZQ4LszKO"},{"type":"text","value":" is a unit lower triangular ","position":{"start":{"line":123,"column":1},"end":{"line":123,"column":1}},"key":"YsVs1AVfQk"},{"type":"inlineMath","value":"\\mathbf{L}","position":{"start":{"line":123,"column":1},"end":{"line":123,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">L</span></span></span></span>","key":"DzCpJmMFq9"},{"type":"text","value":", an upper triangular ","position":{"start":{"line":123,"column":1},"end":{"line":123,"column":1}},"key":"UwtPTQ8OXE"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":123,"column":1},"end":{"line":123,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"orb4SLefxf"},{"type":"text","value":", and a permutation ","position":{"start":{"line":123,"column":1},"end":{"line":123,"column":1}},"key":"IXLimZ3tNd"},{"type":"inlineMath","value":"i_1,\\ldots,i_n","position":{"start":{"line":123,"column":1},"end":{"line":123,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>i</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><mo>…</mo><mo separator=\"true\">,</mo><msub><mi>i</mi><mi>n</mi></msub></mrow><annotation encoding=\"application/x-tex\">i_1,\\ldots,i_n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"ms7uDWr4fZ"},{"type":"text","value":" of the integers ","position":{"start":{"line":123,"column":1},"end":{"line":123,"column":1}},"key":"hVSTbku7gI"},{"type":"inlineMath","value":"1,\\ldots,n","position":{"start":{"line":123,"column":1},"end":{"line":123,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mo separator=\"true\">,</mo><mo>…</mo><mo separator=\"true\">,</mo><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">1,\\ldots,n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8389em;vertical-align:-0.1944em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"FY6U2a5vcs"},{"type":"text","value":", such that","position":{"start":{"line":123,"column":1},"end":{"line":123,"column":1}},"key":"DgAMZNJIXg"}],"key":"zAB6VIP3At"},{"type":"math","value":"\\tilde{\\mathbf{A}} = \\mathbf{L}\\mathbf{U},","position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mover accent=\"true\"><mi mathvariant=\"bold\">A</mi><mo>~</mo></mover><mo>=</mo><mi mathvariant=\"bold\">L</mi><mi mathvariant=\"bold\">U</mi><mo separator=\"true\">,</mo></mrow><annotation encoding=\"application/x-tex\">\\tilde{\\mathbf{A}} = \\mathbf{L}\\mathbf{U},</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.923em;\"></span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.923em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathbf\">A</span></span><span style=\"top:-3.6051em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.1111em;\"><span class=\"mord\">~</span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8805em;vertical-align:-0.1944em;\"></span><span class=\"mord mathbf\">LU</span><span class=\"mpunct\">,</span></span></span></span></span>","enumerator":"2.6.1","key":"xXfMsSqkLD"},{"type":"paragraph","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"children":[{"type":"text","value":"where rows ","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"key":"nPKdwPVZh2"},{"type":"inlineMath","value":"1,\\ldots,n","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mo separator=\"true\">,</mo><mo>…</mo><mo separator=\"true\">,</mo><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">1,\\ldots,n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8389em;vertical-align:-0.1944em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"VU9OMTVor4"},{"type":"text","value":" of ","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"key":"ghYG8JpQQ4"},{"type":"inlineMath","value":"\\tilde{\\mathbf{A}}","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mover accent=\"true\"><mi mathvariant=\"bold\">A</mi><mo>~</mo></mover></mrow><annotation encoding=\"application/x-tex\">\\tilde{\\mathbf{A}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.923em;\"></span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.923em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathbf\">A</span></span><span style=\"top:-3.6051em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.1111em;\"><span class=\"mord\">~</span></span></span></span></span></span></span></span></span></span>","key":"iXkU2ZlcFN"},{"type":"text","value":" are rows ","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"key":"E3BVleUQyg"},{"type":"inlineMath","value":"i_1,\\ldots,i_n","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>i</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><mo>…</mo><mo separator=\"true\">,</mo><msub><mi>i</mi><mi>n</mi></msub></mrow><annotation encoding=\"application/x-tex\">i_1,\\ldots,i_n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"gji8YQ43qC"},{"type":"text","value":" of ","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"key":"ZKexnslnZb"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"caKBfHQxST"},{"type":"text","value":".","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"key":"ZXJoEu4ZWR"}],"key":"cNsTvwdRKu"}],"label":"definition-plu","identifier":"definition-plu","indexEntries":[{"entry":"matrix factorization","subEntry":{"value":"pivoted LU","kind":"entry"},"emphasis":true},{"entry":"PLU factorization","emphasis":true}],"enumerator":"2.6.2","html_id":"definition-plu","key":"DXtXoVpvjr"},{"type":"paragraph","position":{"start":{"line":130,"column":1},"end":{"line":130,"column":1}},"children":[{"type":"crossReference","kind":"proof:algorithm","identifier":"function-plufact","label":"function-plufact","children":[{"type":"text","value":"Function ","key":"P3Yc1sxYrT"},{"type":"text","value":"2.6.1","key":"qX9QPFToEy"}],"template":"Algorithm %s","enumerator":"2.6.1","resolved":true,"html_id":"function-plufact","key":"vX9m7uCpbF"},{"type":"text","value":" shows our implementation of PLU factorization.","position":{"start":{"line":130,"column":1},"end":{"line":130,"column":1}},"key":"yPhKXoQ5ln"},{"type":"footnoteReference","identifier":"plu","label":"PLU","position":{"start":{"line":130,"column":1},"end":{"line":130,"column":1}},"enumerator":"1","key":"D6KrDLP3j8"}],"key":"YpOnM68TKU"},{"type":"proof","kind":"algorithm","enumerated":true,"children":[{"type":"admonitionTitle","children":[{"type":"text","value":"plufact","position":{"start":{"line":134,"column":1},"end":{"line":134,"column":1}},"key":"eWh5n4JF3I"}],"key":"Rdns8haVQX"},{"type":"tabSet","children":[{"type":"tabItem","title":"Julia","sync":"julia","children":[{"type":"embed","source":{"url":"/chapter2","label":"function-plufact-julia","kind":"Notebook","slug":"chapter2","location":"/julia/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"LU factorization with partial pivoting","position":{"start":{"line":66,"column":1},"end":{"line":66,"column":1}},"key":"S1tSgiLcSr"}],"key":"qpoNhfCGgY"},{"type":"include","file":"FNCFunctions/src/chapter02.jl","literal":true,"filter":{"startAfter":"# begin plufact","endBefore":"# end plufact"},"children":[{"type":"code","value":"\"\"\"\n    plufact(A)\n\nCompute the PLU factorization of square matrix `A`, returning the\ntriangular factors and a row permutation vector.\n\"\"\"\nfunction plufact(A)\n    n = size(A, 1)\n    L = zeros(n, n)\n    U = zeros(n, n)\n    p = fill(0, n)\n    Aₖ = float(copy(A))\n\n    # Reduction by outer products\n    for k in 1:n\n        p[k] = argmax(abs.(Aₖ[:, k]))    # best pivot in column k\n        U[k, :] = Aₖ[p[k], :]\n        L[:, k] = Aₖ[:, k] / U[k, k]\n        if k < n    # no update needed on last iteration\n            Aₖ -= L[:, k] * U[k, :]'\n        end\n    end\n    return LowerTriangular(L[p, :]), U, p\nend","lang":"julia","showLineNumbers":true,"filename":"plufact.jl","key":"QRsA7DZbWI"}],"key":"rzV7P8BW8X"},{"type":"code","lang":"","value":"","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"key":"XYLFLbZnX4"}],"key":"lBxUhKdni8"}],"key":"iOMykvXG3h"}],"key":"wKicTuEhO4"},{"type":"tabItem","title":"MATLAB","sync":"matlab","children":[{"type":"embed","source":{"url":"/chapter2","label":"function-plufact-julia","kind":"Notebook","slug":"chapter2","location":"/julia/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"LU factorization with partial pivoting","position":{"start":{"line":66,"column":1},"end":{"line":66,"column":1}},"key":"cMTI3e2Dhn"}],"key":"aT9l8Flxlo"},{"type":"include","file":"FNCFunctions/src/chapter02.jl","literal":true,"filter":{"startAfter":"# begin plufact","endBefore":"# end plufact"},"children":[{"type":"code","value":"\"\"\"\n    plufact(A)\n\nCompute the PLU factorization of square matrix `A`, returning the\ntriangular factors and a row permutation vector.\n\"\"\"\nfunction plufact(A)\n    n = size(A, 1)\n    L = zeros(n, n)\n    U = zeros(n, n)\n    p = fill(0, n)\n    Aₖ = float(copy(A))\n\n    # Reduction by outer products\n    for k in 1:n\n        p[k] = argmax(abs.(Aₖ[:, k]))    # best pivot in column k\n        U[k, :] = Aₖ[p[k], :]\n        L[:, k] = Aₖ[:, k] / U[k, k]\n        if k < n    # no update needed on last iteration\n            Aₖ -= L[:, k] * U[k, :]'\n        end\n    end\n    return LowerTriangular(L[p, :]), U, p\nend","lang":"julia","showLineNumbers":true,"filename":"plufact.jl","key":"EHNAMSb2gq"}],"key":"H4crbkudtp"},{"type":"code","lang":"","value":"","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"key":"nZxbnKBUfg"}],"key":"HufqE2MhnJ"}],"key":"QMU5Kr3iYv"}],"key":"zKqppmkn3I"},{"type":"tabItem","title":"Python","sync":"python","children":[{"type":"embed","source":{"url":"/chapter2-2","label":"function-plufact-python","kind":"Notebook","slug":"chapter2-2","location":"/python/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"LU factorization with partial pivoting","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"key":"RlRshjyeUa"}],"key":"bSQol1oApK"},{"type":"include","file":"fncbook/fncbook/chapter02.py","literal":true,"filter":{"lines":[[52,72]]},"children":[{"type":"code","value":"def plufact(A):\n    \"\"\"\n        plufact(A)\n\n    Compute the PLU factorization of square matrix A, returning the\n    triangular factors and a row permutation vector.\n    \"\"\"\n    n = A.shape[0]\n    L = np.zeros((n, n))\n    U = np.zeros((n, n))\n    p = np.zeros(n, dtype=int)\n    A_k = np.copy(A.astype(float))\n\n    # Reduction by outer products\n    for k in range(n):\n        p[k] = np.argmax(abs(A_k[:, k]))\n        U[k, :] = A_k[p[k], :]\n        L[:, k] = A_k[:, k] / U[k, k]\n        if k < n-1:\n            A_k -= np.outer(L[:, k], U[k, :])\n    return L[p, :], U, p","lang":"python","showLineNumbers":true,"filename":"plufact.py","key":"x9WEm7rS1I"}],"key":"bRkGApxF6d"}],"key":"KWTZyEsqG1"}],"key":"EnSy4m4AYK"}],"key":"jY7loEL9D9"}],"key":"qsgrnm8yZg"}],"label":"function-plufact","identifier":"function-plufact","enumerator":"2.6.1","html_id":"function-plufact","key":"TOhmEGAsMf"},{"type":"paragraph","position":{"start":{"line":158,"column":1},"end":{"line":158,"column":1}},"children":[{"type":"text","value":"Ideally, the PLU factorization takes ","position":{"start":{"line":158,"column":1},"end":{"line":158,"column":1}},"key":"MgCaJhKMvr"},{"type":"inlineMath","value":"\\sim \\frac{2}{3}n^3","position":{"start":{"line":158,"column":1},"end":{"line":158,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>∼</mo><mfrac><mn>2</mn><mn>3</mn></mfrac><msup><mi>n</mi><mn>3</mn></msup></mrow><annotation encoding=\"application/x-tex\">\\sim \\frac{2}{3}n^3</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.3669em;\"></span><span class=\"mrel\">∼</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1901em;vertical-align:-0.345em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8451em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">3</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mord\"><span class=\"mord mathnormal\">n</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span></span></span></span></span></span></span></span>","key":"wZiREAIkiE"},{"type":"text","value":" flops asymptotically, just like LU without pivoting. The implementation in ","position":{"start":{"line":158,"column":1},"end":{"line":158,"column":1}},"key":"bkPQJ98yTy"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-plufact","label":"function-plufact","children":[{"type":"text","value":"Function ","key":"JHSQ3rpLiT"},{"type":"text","value":"2.6.1","key":"qzD6MYXnph"}],"template":"Algorithm %s","enumerator":"2.6.1","resolved":true,"html_id":"function-plufact","key":"JQrav0T6Fv"},{"type":"text","value":" does not achieve this optimal flop count, however. Like ","position":{"start":{"line":158,"column":1},"end":{"line":158,"column":1}},"key":"xprYL6lfcb"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-lufact","label":"function-lufact","children":[{"type":"text","value":"Function ","key":"ddLgMjifQe"},{"type":"text","value":"2.4.1","key":"Qdx3RjvAAZ"}],"template":"Algorithm %s","enumerator":"2.4.1","resolved":true,"html_id":"function-lufact","remote":true,"url":"/lu","dataUrl":"/lu.json","key":"sl4TftybBY"},{"type":"text","value":", it does unnecessary operations on structurally known zeros for the sake of being easier to understand.","position":{"start":{"line":158,"column":1},"end":{"line":158,"column":1}},"key":"e8NpHvrGfY"}],"key":"paP83fOUh4"},{"type":"heading","depth":2,"position":{"start":{"line":160,"column":1},"end":{"line":160,"column":1}},"children":[{"type":"text","value":"Linear systems","position":{"start":{"line":160,"column":1},"end":{"line":160,"column":1}},"key":"iJHs9nUH9s"}],"identifier":"linear-systems","label":"Linear systems","html_id":"linear-systems","implicit":true,"enumerator":"2.6.3","key":"v9aMk4PAmt"},{"type":"paragraph","position":{"start":{"line":162,"column":1},"end":{"line":162,"column":1}},"children":[{"type":"text","value":"The output of ","position":{"start":{"line":162,"column":1},"end":{"line":162,"column":1}},"key":"m2aVPKdguY"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-plufact","label":"function-plufact","children":[{"type":"text","value":"Function ","key":"XyP0GNYY1Q"},{"type":"text","value":"2.6.1","key":"uGex31dPyQ"}],"template":"Algorithm %s","enumerator":"2.6.1","resolved":true,"html_id":"function-plufact","key":"RTP14JbxCY"},{"type":"text","value":" is a factorization of a row-permuted ","position":{"start":{"line":162,"column":1},"end":{"line":162,"column":1}},"key":"kt2wx2Tyx2"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":162,"column":1},"end":{"line":162,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"T5yXz7O0Qj"},{"type":"text","value":". Therefore, given a linear system ","position":{"start":{"line":162,"column":1},"end":{"line":162,"column":1}},"key":"Vletz5Adbx"},{"type":"inlineMath","value":"\\mathbf{A}\\mathbf{x}=\\mathbf{b}","position":{"start":{"line":162,"column":1},"end":{"line":162,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi><mi mathvariant=\"bold\">x</mi><mo>=</mo><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}\\mathbf{x}=\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">Ax</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"LdvQxMKDUS"},{"type":"text","value":", we have to permute ","position":{"start":{"line":162,"column":1},"end":{"line":162,"column":1}},"key":"iHLoq7QMuM"},{"type":"inlineMath","value":"\\mathbf{b}","position":{"start":{"line":162,"column":1},"end":{"line":162,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"Zdt0zCa06m"},{"type":"text","value":" the same way before applying forward and backward substitution. This is equivalent to changing the order of the equations in a linear system, which does not affect its solution.","position":{"start":{"line":162,"column":1},"end":{"line":162,"column":1}},"key":"gdbkVLHfoG"}],"key":"C2pTBHV5Rr"},{"type":"proof","kind":"example","enumerated":true,"children":[{"type":"admonitionTitle","children":[{"type":"text","value":"PLU factorization for solving linear systems","position":{"start":{"line":164,"column":1},"end":{"line":164,"column":1}},"key":"IyNoIQ914d"}],"key":"YhaDxmooVO"},{"type":"tabSet","children":[{"type":"tabItem","title":"Julia","sync":"julia","children":[{"type":"embed","source":{"url":"/chapter2","label":"demo-pivoting-usage-julia","kind":"Notebook","slug":"chapter2","location":"/julia/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-pivoting-usage","label":"demo-pivoting-usage","kind":"proof:example","position":{"start":{"line":966,"column":1},"end":{"line":966,"column":21}},"children":[{"type":"text","value":"Example ","key":"DXTDJEAGEn"},{"type":"text","value":"2.6.4","key":"WhSEWaedAB"}],"template":"Example %s","enumerator":"2.6.4","resolved":true,"html_id":"demo-pivoting-usage","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"ZoJo6KBReL"}],"key":"aeT5SOCOiO"},{"type":"paragraph","position":{"start":{"line":968,"column":1},"end":{"line":968,"column":1}},"children":[{"type":"text","value":"The third output of ","position":{"start":{"line":968,"column":1},"end":{"line":968,"column":1}},"key":"jXIfNavpYF"},{"type":"inlineCode","value":"plufact","position":{"start":{"line":968,"column":1},"end":{"line":968,"column":1}},"key":"WYO79THrcC"},{"type":"text","value":" is the permutation vector we need to apply to ","position":{"start":{"line":968,"column":1},"end":{"line":968,"column":1}},"key":"vUpuhePmST"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":968,"column":1},"end":{"line":968,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"RGxoqO5rCD"},{"type":"text","value":".","position":{"start":{"line":968,"column":1},"end":{"line":968,"column":1}},"key":"yK3GkXDaYg"}],"key":"EazG8RLtXD"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"A = rand(1:20, 4, 4)\nL, U, p = FNC.plufact(A)\nA[p,:] - L * U   # should be ≈ 0","key":"ZtswhZhzUB"},{"type":"output","id":"Y42jejc9fEoeMp50larPy","data":[{"output_type":"execute_result","execution_count":94,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n 0.0  0.0  0.0          0.0\n 0.0  0.0  0.0          0.0\n 0.0  0.0  0.0          0.0\n 0.0  0.0  8.88178e-16  0.0","content_type":"text/plain"}}}],"key":"iTiXOwdW9G"}],"key":"Ly0uKg68OL"},{"type":"paragraph","position":{"start":{"line":976,"column":1},"end":{"line":976,"column":1}},"children":[{"type":"text","value":"Given a vector ","position":{"start":{"line":976,"column":1},"end":{"line":976,"column":1}},"key":"Ia0GgJdcGq"},{"type":"inlineMath","value":"\\mathbf{b}","position":{"start":{"line":976,"column":1},"end":{"line":976,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"b3bCFPs6P5"},{"type":"text","value":", we solve ","position":{"start":{"line":976,"column":1},"end":{"line":976,"column":1}},"key":"qTRRiJ28kX"},{"type":"inlineMath","value":"\\mathbf{A}\\mathbf{x}=\\mathbf{b}","position":{"start":{"line":976,"column":1},"end":{"line":976,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi><mi mathvariant=\"bold\">x</mi><mo>=</mo><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}\\mathbf{x}=\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">Ax</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"cHoCzFJ4Ll"},{"type":"text","value":" by first permuting the entries of ","position":{"start":{"line":976,"column":1},"end":{"line":976,"column":1}},"key":"gb3hoOhllE"},{"type":"inlineMath","value":"\\mathbf{b}","position":{"start":{"line":976,"column":1},"end":{"line":976,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"RFbObILKM9"},{"type":"text","value":" and then proceeding as before.","position":{"start":{"line":976,"column":1},"end":{"line":976,"column":1}},"key":"XmLlEe46rs"}],"key":"B6B5fZL2kT"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"b = rand(4)\nz = FNC.forwardsub(L,b[p])\nx = FNC.backsub(U,z)","key":"teIPrp1HHJ"},{"type":"output","id":"OUa8pJmZnElMAAg6rs3Z7","data":[{"output_type":"execute_result","execution_count":95,"metadata":{},"data":{"text/plain":{"content":"4-element Vector{Float64}:\n -0.017919223295716297\n  0.05327729444860891\n -0.04843588667431248\n  0.062460046127767246","content_type":"text/plain"}}}],"key":"fXhDfvlvjV"}],"key":"q7Ga1xe9F0"},{"type":"paragraph","position":{"start":{"line":984,"column":1},"end":{"line":984,"column":1}},"children":[{"type":"text","value":"A residual check is successful:","position":{"start":{"line":984,"column":1},"end":{"line":984,"column":1}},"key":"GwMVwWjsdU"}],"key":"IjjwGX2psz"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"b - A*x","key":"Y8CcGtjMWi"},{"type":"output","id":"6sln7jTfBwNpB8xYsK8HL","data":[{"output_type":"execute_result","execution_count":96,"metadata":{},"data":{"text/plain":{"content":"4-element Vector{Float64}:\n -1.1102230246251565e-16\n -1.1102230246251565e-16\n -1.1102230246251565e-16\n  0.0","content_type":"text/plain"}}}],"key":"c1V2APdtPF"}],"key":"iTZEiF0o1w"}],"key":"MIZJQPulWo"}],"key":"QGfAf4DXX7"}],"key":"LFkkXSnNC1"},{"type":"tabItem","title":"MATLAB","sync":"matlab","children":[{"type":"embed","source":{"url":"/chapter2-1","label":"demo-pivoting-usage-matlab","kind":"Notebook","slug":"chapter2-1","location":"/matlab/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-pivoting-usage","label":"demo-pivoting-usage","kind":"proof:example","position":{"start":{"line":912,"column":1},"end":{"line":912,"column":21}},"children":[{"type":"text","value":"Example ","key":"Cro4DkGvuN"},{"type":"text","value":"2.6.4","key":"ApMEc1qHbj"}],"template":"Example %s","enumerator":"2.6.4","resolved":true,"html_id":"demo-pivoting-usage","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"IdLhwk5Isl"}],"key":"etowHoi6RF"},{"type":"paragraph","position":{"start":{"line":914,"column":1},"end":{"line":914,"column":1}},"children":[{"type":"text","value":"The third output of ","position":{"start":{"line":914,"column":1},"end":{"line":914,"column":1}},"key":"msGcswmlPA"},{"type":"inlineCode","value":"plufact","position":{"start":{"line":914,"column":1},"end":{"line":914,"column":1}},"key":"uf2G77lSmF"},{"type":"text","value":" is the permutation vector we need to apply to ","position":{"start":{"line":914,"column":1},"end":{"line":914,"column":1}},"key":"NaDMJ5FZ0h"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":914,"column":1},"end":{"line":914,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"SYzhHmJ5y7"},{"type":"text","value":".","position":{"start":{"line":914,"column":1},"end":{"line":914,"column":1}},"key":"bBY1A0nGbL"}],"key":"OKELIQUC1Z"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A = randi(20, 4, 4);\n[L, U, p] = plufact(A);\nA(p, :) - L * U    % should be ≈ 0","key":"BuKCAi4BnU"},{"type":"output","id":"_GJRxZU2B-ng0DnqxHEq5","data":[{"output_type":"execute_result","execution_count":92,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = 4×4 double\n     0     0     0     0\n     0     0     0     0\n     0     0     0     0\n     0     0     0     0\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = 4×4 double\n     0     0     0     0\n     0     0     0     0\n     0     0     0     0\n     0     0     0     0\n","content_type":"text/plain"}}}],"key":"GHPyOkYlBq"}],"key":"FcYjX3H478"},{"type":"paragraph","position":{"start":{"line":922,"column":1},"end":{"line":922,"column":1}},"children":[{"type":"text","value":"Given a vector ","position":{"start":{"line":922,"column":1},"end":{"line":922,"column":1}},"key":"bjTvtGsipO"},{"type":"inlineMath","value":"\\mathbf{b}","position":{"start":{"line":922,"column":1},"end":{"line":922,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"E2Dxqadafb"},{"type":"text","value":", we solve ","position":{"start":{"line":922,"column":1},"end":{"line":922,"column":1}},"key":"HdFPv7SjLV"},{"type":"inlineMath","value":"\\mathbf{A}\\mathbf{x}=\\mathbf{b}","position":{"start":{"line":922,"column":1},"end":{"line":922,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi><mi mathvariant=\"bold\">x</mi><mo>=</mo><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}\\mathbf{x}=\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">Ax</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"Z5Yx3yi6IN"},{"type":"text","value":" by first permuting the entries of ","position":{"start":{"line":922,"column":1},"end":{"line":922,"column":1}},"key":"dJtt794xrq"},{"type":"inlineMath","value":"\\mathbf{b}","position":{"start":{"line":922,"column":1},"end":{"line":922,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"zBasg3NQpu"},{"type":"text","value":" and then proceeding as before.","position":{"start":{"line":922,"column":1},"end":{"line":922,"column":1}},"key":"RaX8dESDHK"}],"key":"CqKzKpkny3"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"b = rand(4, 1);\nz = forwardsub(L, b(p));\nx = backsub(U, z)","key":"hTxnoQIt1t"},{"type":"output","id":"MOVMXZfOYevdoX_c0WfXJ","data":[{"output_type":"execute_result","execution_count":93,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>x = 4×1 double\n    0.0239\n   -0.2909\n    0.2655\n   -0.0113\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"x = 4×1 double\n    0.0239\n   -0.2909\n    0.2655\n   -0.0113\n","content_type":"text/plain"}}}],"key":"pBcAnJzpcn"}],"key":"HBNosZvWFP"},{"type":"paragraph","position":{"start":{"line":930,"column":1},"end":{"line":930,"column":1}},"children":[{"type":"text","value":"A residual check is successful:","position":{"start":{"line":930,"column":1},"end":{"line":930,"column":1}},"key":"q4VGf6K9oF"}],"key":"YCsoMExfny"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"b - A*x","key":"isYsDQMHH1"},{"type":"output","id":"MQlmSzLXCiBJ21mN-vCyh","data":[{"output_type":"execute_result","execution_count":94,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = 4×1 double\n1.0e-15 *\n\n         0\n    0.0555\n   -0.6661\n    0.1110\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = 4×1 double\n1.0e-15 *\n\n         0\n    0.0555\n   -0.6661\n    0.1110\n","content_type":"text/plain"}}}],"key":"MGyEXXS3hU"}],"key":"iTBzQAXGTQ"}],"key":"R7uqLx9Mgh"}],"key":"XEuPe6jsFt"}],"key":"EOfqjplVzZ"},{"type":"tabItem","title":"Python","sync":"python","children":[{"type":"embed","source":{"url":"/chapter2-2","label":"demo-pivoting-usage-python","kind":"Notebook","slug":"chapter2-2","location":"/python/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-pivoting-usage","label":"demo-pivoting-usage","kind":"proof:example","position":{"start":{"line":906,"column":1},"end":{"line":906,"column":21}},"children":[{"type":"text","value":"Example ","key":"HWC7fps36R"},{"type":"text","value":"2.6.4","key":"t3896Uv4sC"}],"template":"Example %s","enumerator":"2.6.4","resolved":true,"html_id":"demo-pivoting-usage","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"T1sW8dG5CP"}],"key":"RbQ4AbzsUT"},{"type":"paragraph","position":{"start":{"line":908,"column":1},"end":{"line":908,"column":1}},"children":[{"type":"text","value":"The third output of ","position":{"start":{"line":908,"column":1},"end":{"line":908,"column":1}},"key":"Rf8hBC1Vmx"},{"type":"inlineCode","value":"plufact","position":{"start":{"line":908,"column":1},"end":{"line":908,"column":1}},"key":"EGhuCUA7mL"},{"type":"text","value":" is the permutation vector we need to apply to ","position":{"start":{"line":908,"column":1},"end":{"line":908,"column":1}},"key":"phpBDGYpYG"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":908,"column":1},"end":{"line":908,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"MuQohIhY0S"},{"type":"text","value":".","position":{"start":{"line":908,"column":1},"end":{"line":908,"column":1}},"key":"umLlPZR7KG"}],"key":"NLCqUJeJgU"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"A = random.randn(4, 4)\nL, U, p = FNC.plufact(A)\nA[p, :] - L @ U   # should be ≈ 0","key":"IK49Av4IEi"},{"type":"output","id":"9D0uFMYojDm5soOBjGY9y","data":[{"output_type":"execute_result","execution_count":91,"metadata":{},"data":{"text/plain":{"content":"array([[0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00],\n       [0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00],\n       [0.00000000e+00, 1.38777878e-17, 0.00000000e+00, 0.00000000e+00],\n       [0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00]])","content_type":"text/plain"}}}],"key":"mBPhNjNNxy"}],"key":"c6sUtIZMKn"},{"type":"paragraph","position":{"start":{"line":916,"column":1},"end":{"line":916,"column":1}},"children":[{"type":"text","value":"Given a vector ","position":{"start":{"line":916,"column":1},"end":{"line":916,"column":1}},"key":"ITq7grgwrV"},{"type":"inlineMath","value":"\\mathbf{b}","position":{"start":{"line":916,"column":1},"end":{"line":916,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"XZfWPTbtRc"},{"type":"text","value":", we solve ","position":{"start":{"line":916,"column":1},"end":{"line":916,"column":1}},"key":"uZFjisdnXS"},{"type":"inlineMath","value":"\\mathbf{A}\\mathbf{x}=\\mathbf{b}","position":{"start":{"line":916,"column":1},"end":{"line":916,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi><mi mathvariant=\"bold\">x</mi><mo>=</mo><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}\\mathbf{x}=\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">Ax</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"dmSDbwODDk"},{"type":"text","value":" by first permuting the entries of ","position":{"start":{"line":916,"column":1},"end":{"line":916,"column":1}},"key":"v7LcmnUIeN"},{"type":"inlineMath","value":"\\mathbf{b}","position":{"start":{"line":916,"column":1},"end":{"line":916,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"VNvUAjo7Pi"},{"type":"text","value":" and then proceeding as before.","position":{"start":{"line":916,"column":1},"end":{"line":916,"column":1}},"key":"m2V3UPmSSq"}],"key":"NTxUlkc5iL"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"b = random.randn(4)\nz = FNC.forwardsub(L, b[p])\nx = FNC.backsub(U, z)","key":"qFLTWJ1BHU"},{"type":"output","id":"tzBRrN640LdFmL3v0CRrU","data":[],"key":"f5N4LOfJIr"}],"key":"MRSk1BecW6"},{"type":"paragraph","position":{"start":{"line":924,"column":1},"end":{"line":924,"column":1}},"children":[{"type":"text","value":"A residual check is successful:","position":{"start":{"line":924,"column":1},"end":{"line":924,"column":1}},"key":"vbgJ7TqyVq"}],"key":"tc1wB3GspY"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"b - A @ x","key":"q3D8dlT4zH"},{"type":"output","id":"M1uEzX-eleTKD9arWBTdK","data":[{"output_type":"execute_result","execution_count":93,"metadata":{},"data":{"text/plain":{"content":"array([0.00000000e+00, 1.11022302e-16, 0.00000000e+00, 1.38777878e-16])","content_type":"text/plain"}}}],"key":"LHLbIAp6vN"}],"key":"sENcoeu8ud"}],"key":"lqDsZTux43"}],"key":"TsZ9Yaqujm"}],"key":"qIocU1hdef"}],"key":"hFuYnByTBq"}],"label":"demo-pivoting-usage","identifier":"demo-pivoting-usage","enumerator":"2.6.4","html_id":"demo-pivoting-usage","key":"UYUSMp5UCH"},{"type":"paragraph","position":{"start":{"line":189,"column":1},"end":{"line":189,"column":1}},"children":[{"type":"text","value":"While ","position":{"start":{"line":189,"column":1},"end":{"line":189,"column":1}},"key":"Gy4k6KQ67o"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-plufact","label":"function-plufact","children":[{"type":"text","value":"Function ","key":"cMa7JNMzfC"},{"type":"text","value":"2.6.1","key":"jNIJxnN6s8"}],"template":"Algorithm %s","enumerator":"2.6.1","resolved":true,"html_id":"function-plufact","key":"JfqWlug502"},{"type":"text","value":" is a serviceable implementation, it is not the gold standard for solving linear systems in practice. Each language offers its own built-in function for PLU factorization.","position":{"start":{"line":189,"column":1},"end":{"line":189,"column":1}},"key":"bcmPHVkrGG"}],"key":"eJ5DGJ9Uyu"},{"type":"proof","kind":"example","enumerated":true,"children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Built-in PLU factorization","position":{"start":{"line":191,"column":1},"end":{"line":191,"column":1}},"key":"uzRXSTy8VL"}],"key":"DTqrbSrbvV"},{"type":"tabSet","children":[{"type":"tabItem","title":"Julia","sync":"julia","children":[{"type":"embed","source":{"url":"/chapter2","label":"demo-pivoting-builtin-julia","kind":"Notebook","slug":"chapter2","location":"/julia/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-pivoting-builtin","label":"demo-pivoting-builtin","kind":"proof:example","position":{"start":{"line":992,"column":1},"end":{"line":992,"column":23}},"children":[{"type":"text","value":"Example ","key":"eOQOlje8ME"},{"type":"text","value":"2.6.5","key":"oJ7zahTMGK"}],"template":"Example %s","enumerator":"2.6.5","resolved":true,"html_id":"demo-pivoting-builtin","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"zqsmGETRZj"}],"key":"JKxNgNGgC3"},{"type":"paragraph","position":{"start":{"line":994,"column":1},"end":{"line":994,"column":1}},"children":[{"type":"text","value":"With the syntax ","position":{"start":{"line":994,"column":1},"end":{"line":994,"column":1}},"key":"MKOStz5smN"},{"type":"inlineCode","value":"A \\ b","position":{"start":{"line":994,"column":1},"end":{"line":994,"column":1}},"key":"kYtOqfy445"},{"type":"text","value":", the matrix ","position":{"start":{"line":994,"column":1},"end":{"line":994,"column":1}},"key":"XDUq8HX0uZ"},{"type":"inlineCode","value":"A","position":{"start":{"line":994,"column":1},"end":{"line":994,"column":1}},"key":"a7P0w1Gahc"},{"type":"text","value":" is PLU-factored, followed by two triangular solves.","position":{"start":{"line":994,"column":1},"end":{"line":994,"column":1}},"key":"vCwzgKeHk6"}],"key":"l2sEOsNrLn"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"A = randn(500, 500)    # 500x500 with normal random entries\nA \\ rand(500)          # force compilation for timing\n@elapsed for k=1:50; A \\ rand(500); end","key":"Ryr7qy7TgW"},{"type":"output","id":"IlqcuJztHOqLlr4CS_6PV","data":[{"output_type":"execute_result","execution_count":97,"metadata":{},"data":{"text/plain":{"content":"0.086060709","content_type":"text/plain"}}}],"key":"hCkXNzGC2R"}],"key":"sMFJuBgwDi"},{"type":"paragraph","position":{"start":{"line":1002,"column":1},"end":{"line":1002,"column":1}},"children":[{"type":"text","value":"In ","position":{"start":{"line":1002,"column":1},"end":{"line":1002,"column":1}},"key":"RLcDXe9rka"},{"type":"link","kind":"numref","identifier":"section-linsys-efficiency","label":"section-linsys-efficiency","url":"/efficiency","internal":true,"dataUrl":"/efficiency.json","children":[{"type":"text","value":"Efficiency of matrix computations","key":"tmNpUve5Od"}],"key":"uFUNN63AOh"},{"type":"text","value":" we showed that the factorization is by far the most costly part of the solution process. The ","position":{"start":{"line":1002,"column":1},"end":{"line":1002,"column":1}},"key":"ftwSZXYYcn"},{"type":"inlineCode","value":"lu","position":{"start":{"line":1002,"column":1},"end":{"line":1002,"column":1}},"key":"IErDqW20Ih"},{"type":"text","value":" function from the built-in package ","position":{"start":{"line":1002,"column":1},"end":{"line":1002,"column":1}},"key":"JJNOT3UglT"},{"type":"inlineCode","value":"LinearAlgebra","position":{"start":{"line":1002,"column":1},"end":{"line":1002,"column":1}},"key":"Tv5UMVvEul"},{"type":"text","value":" returns a factorization object that allows us to do that costly step only once per unique matrix.","position":{"start":{"line":1002,"column":1},"end":{"line":1002,"column":1}},"key":"HRqd4ow0OU"}],"key":"dKcnQhYV8T"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"factored = lu(A)       # store factorization result\nfactored \\ rand(500)   # force compilation for timing\n@elapsed for k=1:50; factored \\ rand(500); end","key":"Ea4gBtLA2V"},{"type":"output","id":"Hz7bGGXQsRi6KkchRmrO0","data":[{"output_type":"execute_result","execution_count":98,"metadata":{},"data":{"text/plain":{"content":"0.002334416","content_type":"text/plain"}}}],"key":"uzZtx0xqfd"}],"key":"REGkc8ZjgG"}],"key":"ngShmFATIP"}],"key":"uG7ScEirJM"}],"key":"BANN2JgLWj"},{"type":"tabItem","title":"MATLAB","sync":"matlab","children":[{"type":"embed","source":{"url":"/chapter2-1","label":"demo-pivoting-builtin-matlab","kind":"Notebook","slug":"chapter2-1","location":"/matlab/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-pivoting-builtin","label":"demo-pivoting-builtin","kind":"proof:example","position":{"start":{"line":938,"column":1},"end":{"line":938,"column":23}},"children":[{"type":"text","value":"Example ","key":"d9LMHOme5O"},{"type":"text","value":"2.6.5","key":"Inl1Yygptt"}],"template":"Example %s","enumerator":"2.6.5","resolved":true,"html_id":"demo-pivoting-builtin","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"a7AUrIzKQj"}],"key":"vH5gazxmOc"},{"type":"paragraph","position":{"start":{"line":940,"column":1},"end":{"line":940,"column":1}},"children":[{"type":"text","value":"With the syntax ","position":{"start":{"line":940,"column":1},"end":{"line":940,"column":1}},"key":"fI13U5cyLr"},{"type":"inlineCode","value":"A \\ b","position":{"start":{"line":940,"column":1},"end":{"line":940,"column":1}},"key":"ZfrOTTN9Rt"},{"type":"text","value":", the matrix ","position":{"start":{"line":940,"column":1},"end":{"line":940,"column":1}},"key":"LNtuJC6nm8"},{"type":"inlineCode","value":"A","position":{"start":{"line":940,"column":1},"end":{"line":940,"column":1}},"key":"M41WCzD8Oo"},{"type":"text","value":" is PLU-factored, followed by two triangular solves.","position":{"start":{"line":940,"column":1},"end":{"line":940,"column":1}},"key":"rbrpAzPo9g"}],"key":"kjwJ0RIndf"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A = randn(500, 500);    % 500x500 with normal random entries\ntic; for k=1:50; A \\ rand(500, 1); end; toc","key":"lpgFay62PI"},{"type":"output","id":"JuA5mwKWlbGlB3EDsoIyN","data":[{"output_type":"stream","name":"stdout","text":"Elapsed time is 0.207999 seconds.\n"}],"key":"XzJrkr2gMR"}],"key":"vUmhksuKjI"},{"type":"paragraph","position":{"start":{"line":947,"column":1},"end":{"line":947,"column":1}},"children":[{"type":"text","value":"In ","position":{"start":{"line":947,"column":1},"end":{"line":947,"column":1}},"key":"NSxUorF48t"},{"type":"link","kind":"numref","identifier":"section-linsys-efficiency","label":"section-linsys-efficiency","url":"/efficiency","internal":true,"dataUrl":"/efficiency.json","children":[{"type":"text","value":"Efficiency of matrix computations","key":"YN9MV2A9gS"}],"key":"kAiW9KdUPB"},{"type":"text","value":" we showed that the factorization is by far the most costly part of the solution process. A factorization object allows us to do that costly step only once per unique matrix.","position":{"start":{"line":947,"column":1},"end":{"line":947,"column":1}},"key":"ZQVAD5ggKm"}],"key":"LldVhVRKfj"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[L, U, p] = lu(A, 'vector');    % keep factorization result\ntic\nfor k=1:50\n    b = rand(500, 1);\n    U \\ (L \\ b(p));\nend\ntoc","key":"oMenNnUJ0a"},{"type":"output","id":"HVt128qkEYllTzzljZDqt","data":[{"output_type":"stream","name":"stdout","text":"Elapsed time is 0.007111 seconds.\n"}],"key":"lPV15hwN27"}],"key":"gw6XYrGkGH"}],"key":"r9F6w49pRx"}],"key":"Zj57ronqEs"}],"key":"KtUUkx3BDX"},{"type":"tabItem","title":"Python","sync":"python","children":[{"type":"embed","source":{"url":"/chapter2-2","label":"demo-pivoting-builtin-python","kind":"Notebook","slug":"chapter2-2","location":"/python/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-pivoting-builtin","label":"demo-pivoting-builtin","kind":"proof:example","position":{"start":{"line":932,"column":1},"end":{"line":932,"column":23}},"children":[{"type":"text","value":"Example ","key":"IlTT3dGaX7"},{"type":"text","value":"2.6.5","key":"c3KglPCl8O"}],"template":"Example %s","enumerator":"2.6.5","resolved":true,"html_id":"demo-pivoting-builtin","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"zh1s7PW2JT"}],"key":"tZxbWWrB72"},{"type":"paragraph","position":{"start":{"line":934,"column":1},"end":{"line":934,"column":1}},"children":[{"type":"text","value":"In ","position":{"start":{"line":934,"column":1},"end":{"line":934,"column":1}},"key":"A3kKaA7W3Q"},{"type":"inlineCode","value":"linalg.solve","position":{"start":{"line":934,"column":1},"end":{"line":934,"column":1}},"key":"ewZfyVmNNa"},{"type":"text","value":", the matrix ","position":{"start":{"line":934,"column":1},"end":{"line":934,"column":1}},"key":"s8krW7ltDP"},{"type":"inlineCode","value":"A","position":{"start":{"line":934,"column":1},"end":{"line":934,"column":1}},"key":"GuGpQIEeeY"},{"type":"text","value":" is PLU-factored, followed by two triangular solves. If we want to do those steps seamlessly, we can use the ","position":{"start":{"line":934,"column":1},"end":{"line":934,"column":1}},"key":"ZP0ULQqclU"},{"type":"inlineCode","value":"lu_factor","position":{"start":{"line":934,"column":1},"end":{"line":934,"column":1}},"key":"yeZkFGxxk3"},{"type":"text","value":" and ","position":{"start":{"line":934,"column":1},"end":{"line":934,"column":1}},"key":"MN2fbiI51x"},{"type":"inlineCode","value":"lu_solve","position":{"start":{"line":934,"column":1},"end":{"line":934,"column":1}},"key":"Kya5UD9saG"},{"type":"text","value":" from ","position":{"start":{"line":934,"column":1},"end":{"line":934,"column":1}},"key":"Pj2U7Dotod"},{"type":"inlineCode","value":"scipy.linalg","position":{"start":{"line":934,"column":1},"end":{"line":934,"column":1}},"key":"QXonTu55TX"},{"type":"text","value":".","position":{"start":{"line":934,"column":1},"end":{"line":934,"column":1}},"key":"rWM1QOZ4to"}],"key":"aAF8hhcOgs"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from scipy.linalg import lu_factor, lu_solve\nA = random.randn(500, 500) \nb = ones(500)  \nLU, perm = lu_factor(A)\nx = lu_solve((LU, perm), b)","key":"ZDc4niZh3n"},{"type":"output","id":"Ttm4A2eBeiV2LfK8DQnVm","data":[],"key":"vHhzbCwO96"}],"key":"cP7CEBCMDu"},{"type":"paragraph","position":{"start":{"line":944,"column":1},"end":{"line":944,"column":1}},"children":[{"type":"text","value":"Why would we ever bother with this? In ","position":{"start":{"line":944,"column":1},"end":{"line":944,"column":1}},"key":"SGor1M1ff3"},{"type":"link","kind":"numref","identifier":"section-linsys-efficiency","label":"section-linsys-efficiency","url":"/efficiency","internal":true,"dataUrl":"/efficiency.json","children":[{"type":"text","value":"Efficiency of matrix computations","key":"mPi16xaIeX"}],"key":"dICFNmZV5T"},{"type":"text","value":" we showed that the factorization is by far the most costly part of the solution process. A factorization object allows us to do that costly step only once per matrix, but solve with multiple right-hand sides.","position":{"start":{"line":944,"column":1},"end":{"line":944,"column":1}},"key":"cQfKe5RQ30"}],"key":"CYRTNV0xv0"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"start = timer()\nfor k in range(50): linalg.solve(A, random.rand(500))\nprint(f\"elapsed time for 50 full solves: {timer() - start}\")\n\nstart = timer()\nLU, perm = lu_factor(A)\nfor k in range(50): lu_solve((LU, perm), random.rand(500))\nprint(f\"elapsed time for 50 shortcut solves: {timer() - start}\")","key":"xQKDVNKDZ9"},{"type":"output","id":"_exNavt9bh39baQDj0erO","data":[{"output_type":"stream","name":"stdout","text":"elapsed time for 50 full solves: 0.17202883306890726\nelapsed time for 50 shortcut solves: 0.011634583002887666\n"}],"key":"yY7JprUZG1"}],"key":"OOYkEfdZG2"}],"key":"zBKQQZ7ZhE"}],"key":"zFbFe75n5M"}],"key":"FKiR6d4DD4"}],"key":"NMsxJbbH8E"}],"label":"demo-pivoting-builtin","identifier":"demo-pivoting-builtin","enumerator":"2.6.5","html_id":"demo-pivoting-builtin","key":"GMgYPBKUBe"},{"type":"heading","depth":2,"position":{"start":{"line":216,"column":1},"end":{"line":216,"column":1}},"children":[{"type":"text","value":"Stability","position":{"start":{"line":216,"column":1},"end":{"line":216,"column":1}},"key":"cbD5S87cwL"}],"identifier":"stability","label":"Stability","html_id":"stability","implicit":true,"enumerator":"2.6.4","key":"ZFM2NaNUMB"},{"type":"paragraph","position":{"start":{"line":221,"column":1},"end":{"line":221,"column":1}},"children":[{"type":"text","value":"There is one detail of the row pivoting algorithm that might seem arbitrary: why choose the pivot of largest magnitude within a column, rather than, say, the uppermost nonzero in the column? The answer is numerical stability.","position":{"start":{"line":221,"column":1},"end":{"line":221,"column":1}},"key":"hWLLvyMhTR"}],"indexEntries":[{"entry":"stability","emphasis":false}],"label":"index-GOZ1Y4A3cJ","identifier":"index-goz1y4a3cj","html_id":"index-goz1y4a3cj","key":"GxxiF6n4pc"},{"type":"proof","kind":"example","enumerated":true,"children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Stability of PLU factorization","position":{"start":{"line":223,"column":1},"end":{"line":223,"column":1}},"key":"eTPKCHDRje"}],"key":"jO5MgqoO5n"},{"type":"paragraph","position":{"start":{"line":225,"column":1},"end":{"line":225,"column":1}},"children":[{"type":"text","value":"Let","position":{"start":{"line":225,"column":1},"end":{"line":225,"column":1}},"key":"NrZ4e4LKiN"}],"key":"Brg2wUvxAY"},{"type":"math","value":"\\mathbf{A} =\n  \\begin{bmatrix}\n    -\\epsilon & 1 \\\\ 1 & -1\n  \\end{bmatrix}.","label":"plu-stab-A","identifier":"plu-stab-a","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi mathvariant=\"bold\">A</mi><mo>=</mo><mrow><mo fence=\"true\">[</mo><mtable rowspacing=\"0.16em\" columnalign=\"center center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mi>ϵ</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mn>1</mn></mrow></mstyle></mtd></mtr></mtable><mo fence=\"true\">]</mo></mrow><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A} =\n  \\begin{bmatrix}\n    -\\epsilon &amp; 1 \\\\ 1 &amp; -1\n  \\end{bmatrix}.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.4em;vertical-align:-0.95em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">[</span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord mathnormal\">ϵ</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.95em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.95em;\"><span></span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">]</span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">.</span></span></span></span></span>","enumerator":"2.6.2","html_id":"plu-stab-a","key":"q9ECiA9lI6"},{"type":"paragraph","position":{"start":{"line":235,"column":1},"end":{"line":235,"column":1}},"children":[{"type":"text","value":"If ","position":{"start":{"line":235,"column":1},"end":{"line":235,"column":1}},"key":"JQZBIVUnlV"},{"type":"inlineMath","value":"\\epsilon=0","position":{"start":{"line":235,"column":1},"end":{"line":235,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ϵ</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">\\epsilon=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">ϵ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"cvK3sCLCPk"},{"type":"text","value":", LU factorization without pivoting fails for ","position":{"start":{"line":235,"column":1},"end":{"line":235,"column":1}},"key":"OVwJH6wGhf"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":235,"column":1},"end":{"line":235,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"tucESNbr6r"},{"type":"text","value":". But if ","position":{"start":{"line":235,"column":1},"end":{"line":235,"column":1}},"key":"wHXsQWvsWD"},{"type":"inlineMath","value":"\\epsilon\\neq 0","position":{"start":{"line":235,"column":1},"end":{"line":235,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ϵ</mi><mo mathvariant=\"normal\">≠</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">\\epsilon\\neq 0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">ϵ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\"><span class=\"mrel\"><span class=\"mord vbox\"><span class=\"thinbox\"><span class=\"rlap\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"inner\"><span class=\"mord\"><span class=\"mrel\"></span></span></span><span class=\"fix\"></span></span></span></span></span><span class=\"mrel\">=</span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"TT2ib9ONob"},{"type":"text","value":", we can go without pivoting, at least in principle.","position":{"start":{"line":235,"column":1},"end":{"line":235,"column":1}},"key":"VzdhQI0jnM"}],"key":"sGQ9mShafq"},{"type":"tabSet","children":[{"type":"tabItem","title":"Julia","sync":"julia","children":[{"type":"embed","source":{"url":"/chapter2","label":"demo-pivoting-stable-julia","kind":"Notebook","slug":"chapter2","location":"/julia/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-pivoting-stable","label":"demo-pivoting-stable","kind":"proof:example","position":{"start":{"line":1012,"column":1},"end":{"line":1012,"column":22}},"children":[{"type":"text","value":"Example ","key":"B7D7QG071O"},{"type":"text","value":"2.6.6","key":"xaUOgBFCOo"}],"template":"Example %s","enumerator":"2.6.6","resolved":true,"html_id":"demo-pivoting-stable","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"FpmsfHntsu"}],"key":"fPCXDAQ1bq"},{"type":"paragraph","position":{"start":{"line":1014,"column":1},"end":{"line":1014,"column":1}},"children":[{"type":"text","value":"We construct a linear system for this matrix with ","position":{"start":{"line":1014,"column":1},"end":{"line":1014,"column":1}},"key":"tWXTysJ7b3"},{"type":"inlineMath","value":"\\epsilon=10^{-12}","position":{"start":{"line":1014,"column":1},"end":{"line":1014,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ϵ</mi><mo>=</mo><mn>1</mn><msup><mn>0</mn><mrow><mo>−</mo><mn>12</mn></mrow></msup></mrow><annotation encoding=\"application/x-tex\">\\epsilon=10^{-12}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">ϵ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">12</span></span></span></span></span></span></span></span></span></span></span></span>","key":"MnN9dnk0lB"},{"type":"text","value":" and exact solution ","position":{"start":{"line":1014,"column":1},"end":{"line":1014,"column":1}},"key":"hJdH2pXiy1"},{"type":"inlineMath","value":"[1,1]","position":{"start":{"line":1014,"column":1},"end":{"line":1014,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[1,1]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]</span></span></span></span>","key":"BoConAjwzX"},{"type":"text","value":":","position":{"start":{"line":1014,"column":1},"end":{"line":1014,"column":1}},"key":"WY0CYCimuV"}],"key":"nWLMrNodnk"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"ϵ = 1e-12\nA = [-ϵ 1; 1 -1]\nb = A * [1, 1]","key":"yVxzz05Apq"},{"type":"output","id":"hmekzGDKsszyOf8Itq4mW","data":[{"output_type":"execute_result","execution_count":99,"metadata":{},"data":{"text/plain":{"content":"2-element Vector{Float64}:\n 0.999999999999\n 0.0","content_type":"text/plain"}}}],"key":"IIxr7JZLGY"}],"key":"qAHrtdOLaO"},{"type":"paragraph","position":{"start":{"line":1022,"column":1},"end":{"line":1022,"column":1}},"children":[{"type":"text","value":"We can factor the matrix without pivoting and solve for ","position":{"start":{"line":1022,"column":1},"end":{"line":1022,"column":1}},"key":"mX38BOS7SI"},{"type":"inlineMath","value":"\\mathbf{x}","position":{"start":{"line":1022,"column":1},"end":{"line":1022,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">x</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{x}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4444em;\"></span><span class=\"mord mathbf\">x</span></span></span></span>","key":"Zn31ClnR0M"},{"type":"text","value":".","position":{"start":{"line":1022,"column":1},"end":{"line":1022,"column":1}},"key":"un2mHH9S9Q"}],"key":"C3JlzzzrnV"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"L, U = FNC.lufact(A)\nx = FNC.backsub( U, FNC.forwardsub(L, b) )","key":"Rliv8VzUUx"},{"type":"output","id":"i-RDgsLUhJgSua9OXdgEr","data":[{"output_type":"execute_result","execution_count":100,"metadata":{},"data":{"text/plain":{"content":"2-element Vector{Float64}:\n 0.9999778782798785\n 1.0","content_type":"text/plain"}}}],"key":"HfWpq6rs3s"}],"key":"cVIyYqsF4Y"},{"type":"paragraph","position":{"start":{"line":1029,"column":1},"end":{"line":1029,"column":1}},"children":[{"type":"text","value":"Note that we have obtained only about 5 accurate digits for ","position":{"start":{"line":1029,"column":1},"end":{"line":1029,"column":1}},"key":"Ppjrc8G6MS"},{"type":"inlineMath","value":"x_1","position":{"start":{"line":1029,"column":1},"end":{"line":1029,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">x_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"bm49UglnkJ"},{"type":"text","value":". We could make the result even more inaccurate by making ","position":{"start":{"line":1029,"column":1},"end":{"line":1029,"column":1}},"key":"NVR7Hwp0zU"},{"type":"text","value":"ε","position":{"start":{"line":1029,"column":1},"end":{"line":1029,"column":1}},"key":"wQHZbiSWqN"},{"type":"text","value":" even smaller:","position":{"start":{"line":1029,"column":1},"end":{"line":1029,"column":1}},"key":"RnYBVRzPKh"}],"key":"EowXMXWe6B"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"ϵ = 1e-20; A = [-ϵ 1; 1 -1]\nb = A * [1, 1]\nL, U = FNC.lufact(A)\nx = FNC.backsub( U, FNC.forwardsub(L, b) )","key":"DoqYEYLAv4"},{"type":"output","id":"TlhmS-uW_z9pdKoooMqiD","data":[{"output_type":"execute_result","execution_count":101,"metadata":{},"data":{"text/plain":{"content":"2-element Vector{Float64}:\n -0.0\n  1.0","content_type":"text/plain"}}}],"key":"Ffw4y7lcke"}],"key":"ngC7oJ462D"},{"type":"paragraph","position":{"start":{"line":1038,"column":1},"end":{"line":1038,"column":1}},"children":[{"type":"text","value":"This effect is not due to ill conditioning of the problem—a solution with PLU factorization works perfectly:","position":{"start":{"line":1038,"column":1},"end":{"line":1038,"column":1}},"key":"nQPcNyb32I"}],"key":"iYCzZsW8VZ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"A \\ b","key":"oEZ4Kedgua"},{"type":"output","id":"Z65jQw4aGVdnjT84QcGce","data":[{"output_type":"execute_result","execution_count":102,"metadata":{},"data":{"text/plain":{"content":"2-element Vector{Float64}:\n 1.0\n 1.0","content_type":"text/plain"}}}],"key":"uhVEo4jLHe"}],"key":"IN0hG0Y4l8"}],"key":"oEXYuD5AuA"}],"key":"v3zAnNlEOk"}],"key":"Vvb5SeIzpo"},{"type":"tabItem","title":"MATLAB","sync":"matlab","children":[{"type":"embed","source":{"url":"/chapter2-1","label":"demo-pivoting-stable-matlab","kind":"Notebook","slug":"chapter2-1","location":"/matlab/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-pivoting-stable","label":"demo-pivoting-stable","kind":"proof:example","position":{"start":{"line":961,"column":1},"end":{"line":961,"column":22}},"children":[{"type":"text","value":"Example ","key":"vLvHhe4rgn"},{"type":"text","value":"2.6.6","key":"VER1sCWDiW"}],"template":"Example %s","enumerator":"2.6.6","resolved":true,"html_id":"demo-pivoting-stable","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"z9bNbOtII4"}],"key":"dqbzFLffgS"},{"type":"paragraph","position":{"start":{"line":963,"column":1},"end":{"line":963,"column":1}},"children":[{"type":"text","value":"We construct a linear system for this matrix with ","position":{"start":{"line":963,"column":1},"end":{"line":963,"column":1}},"key":"xJcREDEmez"},{"type":"inlineMath","value":"\\epsilon=10^{-12}","position":{"start":{"line":963,"column":1},"end":{"line":963,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ϵ</mi><mo>=</mo><mn>1</mn><msup><mn>0</mn><mrow><mo>−</mo><mn>12</mn></mrow></msup></mrow><annotation encoding=\"application/x-tex\">\\epsilon=10^{-12}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">ϵ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">12</span></span></span></span></span></span></span></span></span></span></span></span>","key":"Mv48Vec9iC"},{"type":"text","value":" and exact solution ","position":{"start":{"line":963,"column":1},"end":{"line":963,"column":1}},"key":"c482FO1z15"},{"type":"inlineMath","value":"[1, 1]","position":{"start":{"line":963,"column":1},"end":{"line":963,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[1, 1]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]</span></span></span></span>","key":"Ug09fGvZi6"},{"type":"text","value":":","position":{"start":{"line":963,"column":1},"end":{"line":963,"column":1}},"key":"mLDS1xWdYN"}],"key":"J8w2UqpLOi"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"ep = 1e-12\nA = [-ep 1; 1 -1];\nb = A * [1; 1];","key":"Nk7Q6tbUIH"},{"type":"output","id":"Yiiq1xryDRi3zg7V9ilaC","data":[{"output_type":"execute_result","execution_count":97,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ep = 1.0000e-12</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ep = 1.0000e-12","content_type":"text/plain"}}}],"key":"kPQN40YQNv"}],"key":"dEUOgS6RXE"},{"type":"paragraph","position":{"start":{"line":971,"column":1},"end":{"line":971,"column":1}},"children":[{"type":"text","value":"We can factor the matrix without pivoting and solve for ","position":{"start":{"line":971,"column":1},"end":{"line":971,"column":1}},"key":"bFPi8sebvG"},{"type":"inlineMath","value":"\\mathbf{x}","position":{"start":{"line":971,"column":1},"end":{"line":971,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">x</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{x}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4444em;\"></span><span class=\"mord mathbf\">x</span></span></span></span>","key":"vagV6RzVQb"},{"type":"text","value":".","position":{"start":{"line":971,"column":1},"end":{"line":971,"column":1}},"key":"XsS9ZOINkJ"}],"key":"gnGHbUh0Vy"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[L, U] = lufact(A);\nx = backsub( U, forwardsub(L, b) )","key":"o2Fi4y9mov"},{"type":"output","id":"SdTBhmh7wQXcMoy_Sj3Ld","data":[{"output_type":"execute_result","execution_count":98,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>x = 2×1 double\n    1.0000\n    1.0000\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"x = 2×1 double\n    1.0000\n    1.0000\n","content_type":"text/plain"}}}],"key":"N69BEXedHL"}],"key":"wj43icVV8U"},{"type":"paragraph","position":{"start":{"line":978,"column":1},"end":{"line":978,"column":1}},"children":[{"type":"text","value":"Note that we have obtained only about 5 accurate digits for ","position":{"start":{"line":978,"column":1},"end":{"line":978,"column":1}},"key":"DLr8hXv672"},{"type":"inlineMath","value":"x_1","position":{"start":{"line":978,"column":1},"end":{"line":978,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">x_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"mnqUJuXqJV"},{"type":"text","value":". We could make the result even more inaccurate by making ","position":{"start":{"line":978,"column":1},"end":{"line":978,"column":1}},"key":"rXdEpNZDVA"},{"type":"text","value":"ε","position":{"start":{"line":978,"column":1},"end":{"line":978,"column":1}},"key":"sSyDunc9iz"},{"type":"text","value":" even smaller:","position":{"start":{"line":978,"column":1},"end":{"line":978,"column":1}},"key":"M2CYuYG2Vv"}],"key":"rnGry8AP4C"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"ep = 1e-20; A = [-ep 1; 1 -1];\nb = A * [1; 1];\n[L, U] = lufact(A);\nx = backsub( U, forwardsub(L, b) )","key":"yHaa99QXXK"},{"type":"output","id":"LIGyqzJk1bAsAbNlDqf-9","data":[{"output_type":"execute_result","execution_count":99,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>x = 2×1 double\n     0\n     1\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"x = 2×1 double\n     0\n     1\n","content_type":"text/plain"}}}],"key":"OME2yxjcPJ"}],"key":"XqC0OUnqr5"},{"type":"paragraph","position":{"start":{"line":987,"column":1},"end":{"line":987,"column":1}},"children":[{"type":"text","value":"This effect is not due to ill conditioning of the problem—a solution with PLU factorization works perfectly:","position":{"start":{"line":987,"column":1},"end":{"line":987,"column":1}},"key":"laWpXeXA0V"}],"key":"CmpsdQX4jo"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A \\ b","key":"EOd5BUVyj0"},{"type":"output","id":"rD0yPkn1hbFNJmL_kxevI","data":[{"output_type":"execute_result","execution_count":100,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = 2×1 double\n     1\n     1\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = 2×1 double\n     1\n     1\n","content_type":"text/plain"}}}],"key":"m8zaVEILPd"}],"key":"V6wETh8g4K"}],"key":"MWvLOK3X4N"}],"key":"KrBw2lJCf3"}],"key":"lleNavYfee"},{"type":"tabItem","title":"Python","sync":"python","children":[{"type":"embed","source":{"url":"/chapter2-2","label":"demo-pivoting-stable-python","kind":"Notebook","slug":"chapter2-2","location":"/python/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-pivoting-stable","label":"demo-pivoting-stable","kind":"proof:example","position":{"start":{"line":959,"column":1},"end":{"line":959,"column":22}},"children":[{"type":"text","value":"Example ","key":"SkOwgOUS1e"},{"type":"text","value":"2.6.6","key":"mfpVMUQn2t"}],"template":"Example %s","enumerator":"2.6.6","resolved":true,"html_id":"demo-pivoting-stable","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"smpwbwBKiy"}],"key":"BbHdJ8TGtd"},{"type":"paragraph","position":{"start":{"line":961,"column":1},"end":{"line":961,"column":1}},"children":[{"type":"text","value":"We construct a linear system for this matrix with ","position":{"start":{"line":961,"column":1},"end":{"line":961,"column":1}},"key":"gxgE00yabn"},{"type":"inlineMath","value":"\\epsilon=10^{-12}","position":{"start":{"line":961,"column":1},"end":{"line":961,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ϵ</mi><mo>=</mo><mn>1</mn><msup><mn>0</mn><mrow><mo>−</mo><mn>12</mn></mrow></msup></mrow><annotation encoding=\"application/x-tex\">\\epsilon=10^{-12}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">ϵ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">12</span></span></span></span></span></span></span></span></span></span></span></span>","key":"HvF7ZqxfCU"},{"type":"text","value":" and exact solution ","position":{"start":{"line":961,"column":1},"end":{"line":961,"column":1}},"key":"XN2BMBBAZU"},{"type":"inlineMath","value":"[1,1]","position":{"start":{"line":961,"column":1},"end":{"line":961,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[1,1]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]</span></span></span></span>","key":"evGRX2c58S"},{"type":"text","value":":","position":{"start":{"line":961,"column":1},"end":{"line":961,"column":1}},"key":"xFzvggpeIl"}],"key":"zzKdVdY5Ws"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ep = 1e-12\nA = array([[-ep, 1], [1, -1]])\nb = A @ array([1, 1])","key":"bm3IoXW7AV"},{"type":"output","id":"XagCJbjPMmfPIIg3qkmuX","data":[],"key":"aAKcmcTh5D"}],"key":"MePmCqhL6U"},{"type":"paragraph","position":{"start":{"line":969,"column":1},"end":{"line":969,"column":1}},"children":[{"type":"text","value":"We can factor the matrix without pivoting and solve for ","position":{"start":{"line":969,"column":1},"end":{"line":969,"column":1}},"key":"LY0TrFGDQG"},{"type":"inlineMath","value":"\\mathbf{x}","position":{"start":{"line":969,"column":1},"end":{"line":969,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">x</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{x}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4444em;\"></span><span class=\"mord mathbf\">x</span></span></span></span>","key":"xcnck4050y"},{"type":"text","value":".","position":{"start":{"line":969,"column":1},"end":{"line":969,"column":1}},"key":"ecpAkfvRMy"}],"key":"Po0bmr8184"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"L, U = FNC.lufact(A)\nprint(FNC.backsub( U, FNC.forwardsub(L, b) ))","key":"JJ9PsL3gCq"},{"type":"output","id":"OjWcsUvRkSmprnRWWoyfK","data":[{"output_type":"stream","name":"stdout","text":"[0.99997788 1.        ]\n"}],"key":"eB0N4qIcBH"}],"key":"kHXXQTKGNG"},{"type":"paragraph","position":{"start":{"line":976,"column":1},"end":{"line":976,"column":1}},"children":[{"type":"text","value":"Note that we have obtained only about 5 accurate digits for ","position":{"start":{"line":976,"column":1},"end":{"line":976,"column":1}},"key":"VxFvy6uov3"},{"type":"inlineMath","value":"x_1","position":{"start":{"line":976,"column":1},"end":{"line":976,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">x_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"e7XdSdQN5E"},{"type":"text","value":". We could make the result even more inaccurate by making ","position":{"start":{"line":976,"column":1},"end":{"line":976,"column":1}},"key":"UcfaFHIfRC"},{"type":"text","value":"ε","position":{"start":{"line":976,"column":1},"end":{"line":976,"column":1}},"key":"sNEOO68JJe"},{"type":"text","value":" even smaller:","position":{"start":{"line":976,"column":1},"end":{"line":976,"column":1}},"key":"KvPdnledOq"}],"key":"NbzuHM6X7D"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ep = 1e-20;\nA = array([[-ep, 1], [1, -1]])\nb = A @ array([1, 1])\nL, U = FNC.lufact(A)\nprint(FNC.backsub( U, FNC.forwardsub(L, b) ))","key":"FfSgd1l4Gx"},{"type":"output","id":"nCq4QBoWoxHR4DBgia3UJ","data":[{"output_type":"stream","name":"stdout","text":"[-0.  1.]\n"}],"key":"TAjhSehdca"}],"key":"jjIWvBQkNl"},{"type":"paragraph","position":{"start":{"line":986,"column":1},"end":{"line":986,"column":1}},"children":[{"type":"text","value":"This effect is not due to ill conditioning of the problem—a solution with PLU factorization works perfectly:","position":{"start":{"line":986,"column":1},"end":{"line":986,"column":1}},"key":"PbfZgBoOab"}],"key":"pBOre8x8If"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(linalg.solve(A, b))","key":"XDHWeI9wuD"},{"type":"output","id":"SjIpqJLp7lWN-C9p14Tme","data":[{"output_type":"stream","name":"stdout","text":"[1. 1.]\n"}],"key":"QBjiTeqZ4O"}],"key":"UmEBxBBja5"}],"key":"dmmbjfbMhO"}],"key":"EzuwEU5rxM"}],"key":"TYYHmwkWFc"}],"key":"jglkoZOQKB"}],"label":"demo-pivoting-stable","identifier":"demo-pivoting-stable","enumerator":"2.6.6","html_id":"demo-pivoting-stable","key":"cjn5TnmbDr"},{"type":"paragraph","position":{"start":{"line":259,"column":1},"end":{"line":259,"column":1}},"children":[{"type":"text","value":"The factors of this ","position":{"start":{"line":259,"column":1},"end":{"line":259,"column":1}},"key":"KLRDa73gAn"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":259,"column":1},"end":{"line":259,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"NWJLg0e2bl"},{"type":"text","value":" without pivoting are found to be","position":{"start":{"line":259,"column":1},"end":{"line":259,"column":1}},"key":"gfy3P3i2La"}],"key":"ik4Q9uaM6G"},{"type":"math","value":"  \\mathbf{L} = \n  \\begin{bmatrix}\n    1 & 0 \\\\ -\\epsilon^{-1} & 1 \n  \\end{bmatrix}, \\qquad \n  \\mathbf{U} = \n  \\begin{bmatrix}\n    -\\epsilon & 1 \\\\ 0 & \\epsilon^{-1}-1 \n  \\end{bmatrix}.","label":"plu-stab-LU","identifier":"plu-stab-lu","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi mathvariant=\"bold\">L</mi><mo>=</mo><mrow><mo fence=\"true\">[</mo><mtable rowspacing=\"0.16em\" columnalign=\"center center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>0</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><msup><mi>ϵ</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd></mtr></mtable><mo fence=\"true\">]</mo></mrow><mo separator=\"true\">,</mo><mspace width=\"2em\"/><mi mathvariant=\"bold\">U</mi><mo>=</mo><mrow><mo fence=\"true\">[</mo><mtable rowspacing=\"0.16em\" columnalign=\"center center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mi>ϵ</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><msup><mi>ϵ</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo>−</mo><mn>1</mn></mrow></mstyle></mtd></mtr></mtable><mo fence=\"true\">]</mo></mrow><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">  \\mathbf{L} = \n  \\begin{bmatrix}\n    1 &amp; 0 \\\\ -\\epsilon^{-1} &amp; 1 \n  \\end{bmatrix}, \\qquad \n  \\mathbf{U} = \n  \\begin{bmatrix}\n    -\\epsilon &amp; 1 \\\\ 0 &amp; \\epsilon^{-1}-1 \n  \\end{bmatrix}.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">L</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.4em;vertical-align:-0.95em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">[</span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord\"><span class=\"mord mathnormal\">ϵ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.95em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">0</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.95em;\"><span></span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">]</span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:2em;\"></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathbf\">U</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.4em;vertical-align:-0.95em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">[</span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord mathnormal\">ϵ</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.95em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">ϵ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.95em;\"><span></span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">]</span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">.</span></span></span></span></span>","enumerator":"2.6.3","html_id":"plu-stab-lu","key":"Si11KLOkMo"},{"type":"paragraph","position":{"start":{"line":273,"column":1},"end":{"line":273,"column":1}},"children":[{"type":"text","value":"For reasons we will quantify in ","position":{"start":{"line":273,"column":1},"end":{"line":273,"column":1}},"key":"sO85Xxfb75"},{"type":"link","kind":"numref","identifier":"section-linsys-condition-number","label":"section-linsys-condition-number","url":"/condition-number","internal":true,"dataUrl":"/condition-number.json","children":[{"type":"text","value":"Conditioning of linear systems","key":"KhrlhbECqc"}],"key":"gKBXbyqMKO"},{"type":"text","value":", the solution of ","position":{"start":{"line":273,"column":1},"end":{"line":273,"column":1}},"key":"HxXso8Bsty"},{"type":"inlineMath","value":"\\mathbf{A}\\mathbf{x}=\\mathbf{b}","position":{"start":{"line":273,"column":1},"end":{"line":273,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi><mi mathvariant=\"bold\">x</mi><mo>=</mo><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}\\mathbf{x}=\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">Ax</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"KijDd3X7v1"},{"type":"text","value":" is well-conditioned, but the problems of solving ","position":{"start":{"line":273,"column":1},"end":{"line":273,"column":1}},"key":"b7QuXCqSSk"},{"type":"inlineMath","value":"\\mathbf{L}\\mathbf{z}=\\mathbf{b}","position":{"start":{"line":273,"column":1},"end":{"line":273,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi><mi mathvariant=\"bold\">z</mi><mo>=</mo><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}\\mathbf{z}=\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">Lz</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"wa76xtiyma"},{"type":"text","value":" and ","position":{"start":{"line":273,"column":1},"end":{"line":273,"column":1}},"key":"LRZJYwss4k"},{"type":"inlineMath","value":"\\mathbf{U}\\mathbf{x}=\\mathbf{z}","position":{"start":{"line":273,"column":1},"end":{"line":273,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi><mi mathvariant=\"bold\">x</mi><mo>=</mo><mi mathvariant=\"bold\">z</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}\\mathbf{x}=\\mathbf{z}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">Ux</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4444em;\"></span><span class=\"mord mathbf\">z</span></span></span></span>","key":"MpewQmMN81"},{"type":"text","value":" have condition numbers essentially ","position":{"start":{"line":273,"column":1},"end":{"line":273,"column":1}},"key":"GsGerA2mD1"},{"type":"inlineMath","value":"1/\\epsilon^2","position":{"start":{"line":273,"column":1},"end":{"line":273,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mi mathvariant=\"normal\">/</mi><msup><mi>ϵ</mi><mn>2</mn></msup></mrow><annotation encoding=\"application/x-tex\">1/\\epsilon^2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord\">1/</span><span class=\"mord\"><span class=\"mord mathnormal\">ϵ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span>","key":"l2dmx0421q"},{"type":"text","value":" each. Thus, for small ","position":{"start":{"line":273,"column":1},"end":{"line":273,"column":1}},"key":"uMVLI2Ud4i"},{"type":"text","value":"ε","position":{"start":{"line":273,"column":1},"end":{"line":273,"column":1}},"key":"A0OcxM3a1s"},{"type":"text","value":", solution of the original linear system by unpivoted LU factorization is highly unstable.","position":{"start":{"line":273,"column":1},"end":{"line":273,"column":1}},"key":"LukTmR6EN5"}],"key":"KDkZWQIbhp"},{"type":"paragraph","position":{"start":{"line":275,"column":1},"end":{"line":275,"column":1}},"children":[{"type":"text","value":"Somewhat surprisingly, solving ","position":{"start":{"line":275,"column":1},"end":{"line":275,"column":1}},"key":"NGgZJFUie2"},{"type":"inlineMath","value":"\\mathbf{A}\\mathbf{x}=\\mathbf{b}","position":{"start":{"line":275,"column":1},"end":{"line":275,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi><mi mathvariant=\"bold\">x</mi><mo>=</mo><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}\\mathbf{x}=\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">Ax</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"xZyUk8m0r4"},{"type":"text","value":" via PLU factorization is technically also unstable. In fact, examples of unstable solutions are well-known, but they have been nonexistent in practice. While there is a lot of evidence and some reasoning about why this is the case, the situation is not completely understood. Yet PLU factorization remains the algorithm of choice for general linear systems.","position":{"start":{"line":275,"column":1},"end":{"line":275,"column":1}},"key":"njveI2v84s"}],"key":"hiBTM0NFsT"},{"type":"heading","depth":2,"position":{"start":{"line":277,"column":1},"end":{"line":277,"column":1}},"children":[{"type":"text","value":"Exercises","position":{"start":{"line":277,"column":1},"end":{"line":277,"column":1}},"key":"Sp6FtmCmCI"}],"identifier":"exercises","label":"Exercises","html_id":"exercises","implicit":true,"enumerator":"2.6.5","key":"PSkHEhK52O"},{"type":"exercise","children":[{"type":"paragraph","position":{"start":{"line":282,"column":1},"end":{"line":282,"column":1}},"children":[{"type":"text","value":"✍ Perform by hand the pivoted LU factorization of each matrix.","position":{"start":{"line":282,"column":1},"end":{"line":282,"column":1}},"key":"xAUYcIR7Hp"}],"key":"YwP1i3cYw8"},{"type":"paragraph","position":{"start":{"line":284,"column":1},"end":{"line":294,"column":1}},"children":[{"type":"strong","position":{"start":{"line":284,"column":1},"end":{"line":284,"column":1}},"children":[{"type":"text","value":"(a)","position":{"start":{"line":284,"column":1},"end":{"line":284,"column":1}},"key":"ddZTQqC6oD"}],"key":"zlfSVDUXgP"},{"type":"text","value":" ","position":{"start":{"line":284,"column":1},"end":{"line":284,"column":1}},"key":"EYpabinF6H"},{"type":"inlineMath","value":"\\quad \\displaystyle \\begin{bmatrix}\n2 & 3 & 4 \\\\\n4 & 5 & 10 \\\\\n4 & 8 & 2\n\\end{bmatrix},\\qquad","position":{"start":{"line":284,"column":1},"end":{"line":284,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mspace width=\"1em\"/><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mo fence=\"true\">[</mo><mtable rowspacing=\"0.16em\" columnalign=\"center center center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>2</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>3</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>4</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>4</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>5</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>10</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>4</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>8</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>2</mn></mstyle></mtd></mtr></mtable><mo fence=\"true\">]</mo></mrow><mo separator=\"true\">,</mo><mspace width=\"2em\"/></mstyle></mrow><annotation encoding=\"application/x-tex\">\\quad \\displaystyle \\begin{bmatrix}\n2 &amp; 3 &amp; 4 \\\\\n4 &amp; 5 &amp; 10 \\\\\n4 &amp; 8 &amp; 2\n\\end{bmatrix},\\qquad</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:3.6em;vertical-align:-1.55em;\"></span><span class=\"mspace\" style=\"margin-right:1em;\"></span><span class=\"minner\"><span class=\"mopen\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.05em;\"><span style=\"top:-2.25em;\"><span class=\"pstrut\" style=\"height:3.155em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎣</span></span></span><span style=\"top:-3.397em;\"><span class=\"pstrut\" style=\"height:3.155em;\"></span><span style=\"height:0.016em;width:0.6667em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.6667em' height='0.016em' style='width:0.6667em' viewBox='0 0 666.67 16' preserveAspectRatio='xMinYMin'><path d='M319 0 H403 V16 H319z M319 0 H403 V16 H319z'/></svg></span></span><span style=\"top:-4.05em;\"><span class=\"pstrut\" style=\"height:3.155em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎡</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.55em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.05em;\"><span style=\"top:-4.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">2</span></span></span><span style=\"top:-3.01em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">4</span></span></span><span style=\"top:-1.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">4</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.55em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.05em;\"><span style=\"top:-4.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">3</span></span></span><span style=\"top:-3.01em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">5</span></span></span><span style=\"top:-1.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">8</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.55em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.05em;\"><span style=\"top:-4.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">4</span></span></span><span style=\"top:-3.01em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">10</span></span></span><span style=\"top:-1.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.55em;\"><span></span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.05em;\"><span style=\"top:-2.25em;\"><span class=\"pstrut\" style=\"height:3.155em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎦</span></span></span><span style=\"top:-3.397em;\"><span class=\"pstrut\" style=\"height:3.155em;\"></span><span style=\"height:0.016em;width:0.6667em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.6667em' height='0.016em' style='width:0.6667em' viewBox='0 0 666.67 16' preserveAspectRatio='xMinYMin'><path d='M263 0 H347 V16 H263z M263 0 H347 V16 H263z'/></svg></span></span><span style=\"top:-4.05em;\"><span class=\"pstrut\" style=\"height:3.155em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎤</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.55em;\"><span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:2em;\"></span></span></span></span>","key":"d8UJ4wmcGc"},{"type":"text","value":"\n","position":{"start":{"line":284,"column":1},"end":{"line":284,"column":1}},"key":"HTgVnCas8T"},{"type":"strong","position":{"start":{"line":284,"column":1},"end":{"line":284,"column":1}},"children":[{"type":"text","value":"(b)","position":{"start":{"line":284,"column":1},"end":{"line":284,"column":1}},"key":"TaqQ9psuET"}],"key":"U1lRdMOmkv"},{"type":"text","value":" ","position":{"start":{"line":284,"column":1},"end":{"line":284,"column":1}},"key":"tX9i8cZtcK"},{"type":"inlineMath","value":"\\quad \\displaystyle \\begin{bmatrix}\n1 & 4 & 5 & -5 \\\\\n-1 & 0 & -1 & -5 \\\\\n1 & 3 & -1 & 2 \\\\\n1 & -1 & 5 & -1 \n\\end{bmatrix}","position":{"start":{"line":284,"column":1},"end":{"line":284,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mspace width=\"1em\"/><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mo fence=\"true\">[</mo><mtable rowspacing=\"0.16em\" columnalign=\"center center center center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>4</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>5</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mn>5</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mn>1</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mn>1</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mn>5</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>3</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mn>1</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>2</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mn>1</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>5</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mn>1</mn></mrow></mstyle></mtd></mtr></mtable><mo fence=\"true\">]</mo></mrow></mstyle></mrow><annotation encoding=\"application/x-tex\">\\quad \\displaystyle \\begin{bmatrix}\n1 &amp; 4 &amp; 5 &amp; -5 \\\\\n-1 &amp; 0 &amp; -1 &amp; -5 \\\\\n1 &amp; 3 &amp; -1 &amp; 2 \\\\\n1 &amp; -1 &amp; 5 &amp; -1 \n\\end{bmatrix}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:4.8001em;vertical-align:-2.15em;\"></span><span class=\"mspace\" style=\"margin-right:1em;\"></span><span class=\"minner\"><span class=\"mopen\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.65em;\"><span style=\"top:-1.711em;\"><span class=\"pstrut\" style=\"height:3.216em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎣</span></span></span><span style=\"top:-2.858em;\"><span class=\"pstrut\" style=\"height:3.216em;\"></span><span style=\"height:1.216em;width:0.6667em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.6667em' height='1.216em' style='width:0.6667em' viewBox='0 0 666.67 1216' preserveAspectRatio='xMinYMin'><path d='M319 0 H403 V1216 H319z M319 0 H403 V1216 H319z'/></svg></span></span><span style=\"top:-4.7111em;\"><span class=\"pstrut\" style=\"height:3.216em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎡</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.65em;\"><span style=\"top:-4.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord\">1</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span><span style=\"top:-1.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.15em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.65em;\"><span style=\"top:-4.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">4</span></span></span><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">0</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">3</span></span></span><span style=\"top:-1.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.15em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.65em;\"><span style=\"top:-4.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">5</span></span></span><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord\">1</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord\">1</span></span></span><span style=\"top:-1.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">5</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.15em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.65em;\"><span style=\"top:-4.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord\">5</span></span></span><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord\">5</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">2</span></span></span><span style=\"top:-1.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.15em;\"><span></span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.65em;\"><span style=\"top:-1.711em;\"><span class=\"pstrut\" style=\"height:3.216em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎦</span></span></span><span style=\"top:-2.858em;\"><span class=\"pstrut\" style=\"height:3.216em;\"></span><span style=\"height:1.216em;width:0.6667em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.6667em' height='1.216em' style='width:0.6667em' viewBox='0 0 666.67 1216' preserveAspectRatio='xMinYMin'><path d='M263 0 H347 V1216 H263z M263 0 H347 V1216 H263z'/></svg></span></span><span style=\"top:-4.7111em;\"><span class=\"pstrut\" style=\"height:3.216em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎤</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.15em;\"><span></span></span></span></span></span></span></span></span></span></span>","key":"K6cueAsWv6"},{"type":"text","value":".","position":{"start":{"line":284,"column":1},"end":{"line":284,"column":1}},"key":"APKUkwLIWT"}],"key":"RQc94KbTCM"}],"label":"problem-pivoting-byhand","identifier":"problem-pivoting-byhand","enumerated":true,"enumerator":"2.6.1","html_id":"problem-pivoting-byhand","key":"oGHayzN97d"},{"type":"exercise","children":[{"type":"paragraph","position":{"start":{"line":300,"column":1},"end":{"line":300,"column":1}},"children":[{"type":"text","value":"✍ Let ","position":{"start":{"line":300,"column":1},"end":{"line":300,"column":1}},"key":"aXCuRavZYy"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":300,"column":1},"end":{"line":300,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"OeOoTTpIgh"},{"type":"text","value":" be a square matrix and ","position":{"start":{"line":300,"column":1},"end":{"line":300,"column":1}},"key":"vjdrZ7ZLnX"},{"type":"inlineMath","value":"\\mathbf{b}","position":{"start":{"line":300,"column":1},"end":{"line":300,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"Ir5Lq85ZD8"},{"type":"text","value":" be a column vector of compatible length.","position":{"start":{"line":300,"column":1},"end":{"line":300,"column":1}},"key":"k0hyRwjSGl"}],"key":"NAUNScxgUa"},{"type":"tabSet","children":[{"type":"tabItem","title":"Julia","sync":"julia","children":[{"type":"paragraph","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":1}},"children":[{"type":"text","value":"Here is correct code to solve ","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":1}},"key":"jcMSypN4RD"},{"type":"inlineMath","value":"\\mathbf{A}\\mathbf{x}=\\mathbf{b}","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi><mi mathvariant=\"bold\">x</mi><mo>=</mo><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}\\mathbf{x}=\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">Ax</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"toIOoxoXqj"},{"type":"text","value":":","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":1}},"key":"ipReQUUdy9"}],"key":"InppdmJYze"},{"type":"code","lang":"julia","value":"L, U, p = lu(A)\nx = U \\ (L \\ b[p])","position":{"start":{"line":307,"column":1},"end":{"line":310,"column":1}},"key":"XHtoyuka77"},{"type":"paragraph","position":{"start":{"line":312,"column":1},"end":{"line":312,"column":1}},"children":[{"type":"text","value":"Suppose instead you replace the last line above with","position":{"start":{"line":312,"column":1},"end":{"line":312,"column":1}},"key":"cCrwtNgOq7"}],"key":"WvLxfJXQML"},{"type":"code","lang":"julia","value":"x = U \\ L \\ b[p]","position":{"start":{"line":314,"column":1},"end":{"line":316,"column":1}},"key":"Pi057hl9Dz"}],"key":"wmCF89yxt6"},{"type":"tabItem","title":"MATLAB","sync":"matlab","children":[{"type":"paragraph","position":{"start":{"line":321,"column":1},"end":{"line":321,"column":1}},"children":[{"type":"text","value":"Here is correct code to solve ","position":{"start":{"line":321,"column":1},"end":{"line":321,"column":1}},"key":"pKIKTvSV1P"},{"type":"inlineMath","value":"\\mathbf{A}\\mathbf{x}=\\mathbf{b}","position":{"start":{"line":321,"column":1},"end":{"line":321,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi><mi mathvariant=\"bold\">x</mi><mo>=</mo><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}\\mathbf{x}=\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">Ax</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"dGizxJaSnm"},{"type":"text","value":":","position":{"start":{"line":321,"column":1},"end":{"line":321,"column":1}},"key":"qgLvQnC9w9"}],"key":"MgRexDqOdC"},{"type":"code","lang":"matlab","value":"[L, U, p]= lu(A, 'vector');\nx = U \\ (L \\ b(p));","position":{"start":{"line":323,"column":1},"end":{"line":326,"column":1}},"key":"CUe6S1Yw39"},{"type":"paragraph","position":{"start":{"line":328,"column":1},"end":{"line":328,"column":1}},"children":[{"type":"text","value":"Suppose instead you replace the last line above with","position":{"start":{"line":328,"column":1},"end":{"line":328,"column":1}},"key":"FGpzFvWrNR"}],"key":"R2ILylZSPS"},{"type":"code","lang":"matlab","value":"x = U \\ L \\ b(p);","position":{"start":{"line":330,"column":1},"end":{"line":332,"column":1}},"key":"z3aniualEX"}],"key":"rhT3Jtdc99"},{"type":"tabItem","title":"Python","sync":"python","children":[{"type":"paragraph","position":{"start":{"line":337,"column":1},"end":{"line":337,"column":1}},"children":[{"type":"text","value":"Here is correct code to solve ","position":{"start":{"line":337,"column":1},"end":{"line":337,"column":1}},"key":"ap9offoqx9"},{"type":"inlineMath","value":"\\mathbf{A}\\mathbf{x}=\\mathbf{b}","position":{"start":{"line":337,"column":1},"end":{"line":337,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi><mi mathvariant=\"bold\">x</mi><mo>=</mo><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}\\mathbf{x}=\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">Ax</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"O7Noks4gER"},{"type":"text","value":":","position":{"start":{"line":337,"column":1},"end":{"line":337,"column":1}},"key":"zlH3EKPAZ4"}],"key":"EM4q0YyZZQ"},{"type":"code","lang":"python","value":"from scipy.linalg import lu\np, L, U = lu(A, p_indices=True)\nx = U @ (L @ b[p])","position":{"start":{"line":339,"column":1},"end":{"line":343,"column":1}},"key":"T0tFlpt2Gr"},{"type":"paragraph","position":{"start":{"line":345,"column":1},"end":{"line":345,"column":1}},"children":[{"type":"text","value":"Suppose instead you replace the last line above with","position":{"start":{"line":345,"column":1},"end":{"line":345,"column":1}},"key":"zJGLWCeySa"}],"key":"IffFelgNBT"},{"type":"code","lang":"python","value":"x = U @ L @ b[p]","position":{"start":{"line":347,"column":1},"end":{"line":349,"column":1}},"key":"J4q7UjL0BS"}],"key":"xniKR2XrWR"}],"key":"rIwfq8vITy"},{"type":"paragraph","position":{"start":{"line":353,"column":1},"end":{"line":353,"column":1}},"children":[{"type":"text","value":"Mathematically in terms of ","position":{"start":{"line":353,"column":1},"end":{"line":353,"column":1}},"key":"deoo3E8XJg"},{"type":"inlineMath","value":"\\mathbf{L}","position":{"start":{"line":353,"column":1},"end":{"line":353,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">L</span></span></span></span>","key":"rUW5MS9V5z"},{"type":"text","value":", ","position":{"start":{"line":353,"column":1},"end":{"line":353,"column":1}},"key":"HIJyL5rCu6"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":353,"column":1},"end":{"line":353,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"Uz3vFH6gyH"},{"type":"text","value":", ","position":{"start":{"line":353,"column":1},"end":{"line":353,"column":1}},"key":"CJBturtYta"},{"type":"inlineMath","value":"\\mathbf{p}","position":{"start":{"line":353,"column":1},"end":{"line":353,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">p</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{p}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6389em;vertical-align:-0.1944em;\"></span><span class=\"mord mathbf\">p</span></span></span></span>","key":"oLmgEN3OJA"},{"type":"text","value":", and ","position":{"start":{"line":353,"column":1},"end":{"line":353,"column":1}},"key":"jMK6ubJuT9"},{"type":"inlineMath","value":"\\mathbf{b}","position":{"start":{"line":353,"column":1},"end":{"line":353,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"m6V6Xy6lpe"},{"type":"text","value":", what vector is found?","position":{"start":{"line":353,"column":1},"end":{"line":353,"column":1}},"key":"TjQ9wP2Qdv"}],"key":"uV2ijAgA95"}],"label":"problem-pivoting-grouping","identifier":"problem-pivoting-grouping","enumerated":true,"enumerator":"2.6.2","html_id":"problem-pivoting-grouping","key":"cHzTFKVQ8w"},{"type":"exercise","children":[{"type":"paragraph","position":{"start":{"line":359,"column":1},"end":{"line":359,"column":1}},"children":[{"type":"text","value":"✍ Suppose that ","position":{"start":{"line":359,"column":1},"end":{"line":359,"column":1}},"key":"MuLzK6uHPN"},{"type":"inlineCode","value":"A","position":{"start":{"line":359,"column":1},"end":{"line":359,"column":1}},"key":"GPqXrcwzlb"},{"type":"text","value":" is a ","position":{"start":{"line":359,"column":1},"end":{"line":359,"column":1}},"key":"VYlPtFyIJi"},{"type":"inlineMath","value":"4\\times 6","position":{"start":{"line":359,"column":1},"end":{"line":359,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>4</mn><mo>×</mo><mn>6</mn></mrow><annotation encoding=\"application/x-tex\">4\\times 6</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">4</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">6</span></span></span></span>","key":"LCTCjeeM2W"},{"type":"text","value":" matrix and you define","position":{"start":{"line":359,"column":1},"end":{"line":359,"column":1}},"key":"mj81tdoML8"}],"key":"xarXt8SJzY"},{"type":"tabSet","children":[{"type":"tabItem","title":"Julia","sync":"julia","children":[{"type":"code","lang":"julia","value":"B = A[end:-1:1, end:-1:1]","position":{"start":{"line":364,"column":1},"end":{"line":366,"column":1}},"key":"YXPgbuk21N"}],"key":"WW2nNvIn61"},{"type":"tabItem","title":"MATLAB","sync":"matlab","children":[{"type":"code","lang":"matlab","value":"B = A(end:-1:1, end:-1:1)","position":{"start":{"line":371,"column":1},"end":{"line":373,"column":1}},"key":"uxmVhcMB42"}],"key":"jSs1prR6ZO"},{"type":"tabItem","title":"Python","sync":"python","children":[{"type":"code","lang":"python","value":"B = A[::-1, ::-1]","position":{"start":{"line":378,"column":1},"end":{"line":379,"column":1}},"key":"qp4d5APZLB"}],"key":"zhWWoVDYi4"}],"key":"QspDETtPZU"},{"type":"paragraph","position":{"start":{"line":383,"column":1},"end":{"line":383,"column":1}},"children":[{"type":"text","value":"Show that ","position":{"start":{"line":383,"column":1},"end":{"line":383,"column":1}},"key":"c8rzv42EMd"},{"type":"inlineMath","value":"\\mathbf{B} = \\mathbf{P} \\mathbf{A} \\mathbf{Q}","position":{"start":{"line":383,"column":1},"end":{"line":383,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">B</mi><mo>=</mo><mi mathvariant=\"bold\">P</mi><mi mathvariant=\"bold\">A</mi><mi mathvariant=\"bold\">Q</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{B} = \\mathbf{P} \\mathbf{A} \\mathbf{Q}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">B</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8805em;vertical-align:-0.1944em;\"></span><span class=\"mord mathbf\">PAQ</span></span></span></span>","key":"FTwosbIJBu"},{"type":"text","value":" for certain matrices ","position":{"start":{"line":383,"column":1},"end":{"line":383,"column":1}},"key":"oYUFX25CKp"},{"type":"inlineMath","value":"\\mathbf{P}","position":{"start":{"line":383,"column":1},"end":{"line":383,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">P</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{P}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">P</span></span></span></span>","key":"QF0GUSZLur"},{"type":"text","value":" and ","position":{"start":{"line":383,"column":1},"end":{"line":383,"column":1}},"key":"mO164LfjFy"},{"type":"inlineMath","value":"\\mathbf{Q}","position":{"start":{"line":383,"column":1},"end":{"line":383,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">Q</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{Q}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8805em;vertical-align:-0.1944em;\"></span><span class=\"mord mathbf\">Q</span></span></span></span>","key":"XvKgHill5Y"},{"type":"text","value":".","position":{"start":{"line":383,"column":1},"end":{"line":383,"column":1}},"key":"H1Eem7yJkZ"}],"key":"x4s1V3Ct1r"}],"label":"problem-pivoting-flip","identifier":"problem-pivoting-flip","enumerated":true,"enumerator":"2.6.3","html_id":"problem-pivoting-flip","key":"rCc8ZOjbI7"},{"type":"exercise","children":[{"type":"paragraph","position":{"start":{"line":388,"column":1},"end":{"line":388,"column":1}},"children":[{"type":"text","value":"✍ An ","position":{"start":{"line":388,"column":1},"end":{"line":388,"column":1}},"key":"OF3dB1wHJW"},{"type":"inlineMath","value":"n\\times n","position":{"start":{"line":388,"column":1},"end":{"line":388,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>×</mo><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n\\times n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"FT8uKq0PaV"},{"type":"text","value":" ","position":{"start":{"line":388,"column":1},"end":{"line":388,"column":1}},"key":"WXRBgl0W7V"},{"type":"emphasis","position":{"start":{"line":388,"column":1},"end":{"line":388,"column":1}},"children":[{"type":"text","value":"permutation matrix","position":{"start":{"line":388,"column":1},"end":{"line":388,"column":1}},"key":"Y5KBKkb3n4"}],"key":"KrivkEqjDY"},{"type":"text","value":" ","position":{"start":{"line":388,"column":1},"end":{"line":388,"column":1}},"key":"AbzNIj8Hwj"},{"type":"inlineMath","value":"\\mathbf{P}","position":{"start":{"line":388,"column":1},"end":{"line":388,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">P</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{P}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">P</span></span></span></span>","key":"oVMTUyBp4T"},{"type":"text","value":" is a reordering of the rows of an identity matrix such that ","position":{"start":{"line":388,"column":1},"end":{"line":388,"column":1}},"key":"oFFQVApVVa"},{"type":"inlineMath","value":"\\mathbf{P} \\mathbf{A}","position":{"start":{"line":388,"column":1},"end":{"line":388,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">P</mi><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{P} \\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">PA</span></span></span></span>","key":"g8pQsTf481"},{"type":"text","value":"  has the effect of moving rows ","position":{"start":{"line":388,"column":1},"end":{"line":388,"column":1}},"key":"OxiNBUOBhp"},{"type":"inlineMath","value":"1,2,\\ldots,n","position":{"start":{"line":388,"column":1},"end":{"line":388,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mo separator=\"true\">,</mo><mn>2</mn><mo separator=\"true\">,</mo><mo>…</mo><mo separator=\"true\">,</mo><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">1,2,\\ldots,n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8389em;vertical-align:-0.1944em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">2</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"BvzziAw9Gl"},{"type":"text","value":" of ","position":{"start":{"line":388,"column":1},"end":{"line":388,"column":1}},"key":"Rh4DJhSqXc"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":388,"column":1},"end":{"line":388,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"bUv49HuQ2h"},{"type":"text","value":" to new positions ","position":{"start":{"line":388,"column":1},"end":{"line":388,"column":1}},"key":"tVgd3w4udr"},{"type":"inlineMath","value":"i_1,i_2,\\ldots,i_n","position":{"start":{"line":388,"column":1},"end":{"line":388,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>i</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><msub><mi>i</mi><mn>2</mn></msub><mo separator=\"true\">,</mo><mo>…</mo><mo separator=\"true\">,</mo><msub><mi>i</mi><mi>n</mi></msub></mrow><annotation encoding=\"application/x-tex\">i_1,i_2,\\ldots,i_n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"D8HV3fy7UY"},{"type":"text","value":". Then ","position":{"start":{"line":388,"column":1},"end":{"line":388,"column":1}},"key":"xpuPpNoMSy"},{"type":"inlineMath","value":"\\mathbf{P}","position":{"start":{"line":388,"column":1},"end":{"line":388,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">P</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{P}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">P</span></span></span></span>","key":"On7tO9BzxA"},{"type":"text","value":" can be expressed as","position":{"start":{"line":388,"column":1},"end":{"line":388,"column":1}},"key":"zki7sGuvpI"}],"key":"O2BFkMLWCc"},{"type":"math","value":"\\mathbf{P} = \\mathbf{e}_{i_1}\\mathbf{e}_1^T + \\mathbf{e}_{i_2}\\mathbf{e}_2^T + \\cdots + \\mathbf{e}_{i_n}\\mathbf{e}_n^T.","enumerated":false,"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi mathvariant=\"bold\">P</mi><mo>=</mo><msub><mi mathvariant=\"bold\">e</mi><msub><mi>i</mi><mn>1</mn></msub></msub><msubsup><mi mathvariant=\"bold\">e</mi><mn>1</mn><mi>T</mi></msubsup><mo>+</mo><msub><mi mathvariant=\"bold\">e</mi><msub><mi>i</mi><mn>2</mn></msub></msub><msubsup><mi mathvariant=\"bold\">e</mi><mn>2</mn><mi>T</mi></msubsup><mo>+</mo><mo>⋯</mo><mo>+</mo><msub><mi mathvariant=\"bold\">e</mi><msub><mi>i</mi><mi>n</mi></msub></msub><msubsup><mi mathvariant=\"bold\">e</mi><mi>n</mi><mi>T</mi></msubsup><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{P} = \\mathbf{e}_{i_1}\\mathbf{e}_1^T + \\mathbf{e}_{i_2}\\mathbf{e}_2^T + \\cdots + \\mathbf{e}_{i_n}\\mathbf{e}_n^T.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">P</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1414em;vertical-align:-0.2501em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">e</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3173em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2501em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathbf\">e</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913em;\"><span style=\"top:-2.453em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1414em;vertical-align:-0.2501em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">e</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3173em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2501em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathbf\">e</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913em;\"><span style=\"top:-2.453em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"minner\">⋯</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1414em;vertical-align:-0.2501em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">e</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1645em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2501em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathbf\">e</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913em;\"><span style=\"top:-2.453em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span><span class=\"mord\">.</span></span></span></span></span>","key":"sVCbOl21mm"},{"type":"paragraph","position":{"start":{"line":395,"column":1},"end":{"line":395,"column":1}},"children":[{"type":"strong","position":{"start":{"line":395,"column":1},"end":{"line":395,"column":1}},"children":[{"type":"text","value":"(a)","position":{"start":{"line":395,"column":1},"end":{"line":395,"column":1}},"key":"PJTdRtaJou"}],"key":"OdBhHOYbAs"},{"type":"text","value":" For the case ","position":{"start":{"line":395,"column":1},"end":{"line":395,"column":1}},"key":"Bgyt8WORNQ"},{"type":"inlineMath","value":"n=4","position":{"start":{"line":395,"column":1},"end":{"line":395,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>=</mo><mn>4</mn></mrow><annotation encoding=\"application/x-tex\">n=4</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">4</span></span></span></span>","key":"cOaDO0yEkg"},{"type":"text","value":" and ","position":{"start":{"line":395,"column":1},"end":{"line":395,"column":1}},"key":"s28HgKieT4"},{"type":"inlineMath","value":"i_1=3","position":{"start":{"line":395,"column":1},"end":{"line":395,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>i</mi><mn>1</mn></msub><mo>=</mo><mn>3</mn></mrow><annotation encoding=\"application/x-tex\">i_1=3</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8095em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">3</span></span></span></span>","key":"sUfpW5svYl"},{"type":"text","value":", ","position":{"start":{"line":395,"column":1},"end":{"line":395,"column":1}},"key":"zbtyzOmtgv"},{"type":"inlineMath","value":"i_2=2","position":{"start":{"line":395,"column":1},"end":{"line":395,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>i</mi><mn>2</mn></msub><mo>=</mo><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">i_2=2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8095em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span></span></span></span>","key":"PY25xnCkvL"},{"type":"text","value":", ","position":{"start":{"line":395,"column":1},"end":{"line":395,"column":1}},"key":"WMcN9ffX6u"},{"type":"inlineMath","value":"i_3=4","position":{"start":{"line":395,"column":1},"end":{"line":395,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>i</mi><mn>3</mn></msub><mo>=</mo><mn>4</mn></mrow><annotation encoding=\"application/x-tex\">i_3=4</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8095em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">4</span></span></span></span>","key":"cXesSTCG2r"},{"type":"text","value":", ","position":{"start":{"line":395,"column":1},"end":{"line":395,"column":1}},"key":"KmcDE54l0m"},{"type":"inlineMath","value":"i_4=1","position":{"start":{"line":395,"column":1},"end":{"line":395,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>i</mi><mn>4</mn></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">i_4=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8095em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">4</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"hMV4BfnMnm"},{"type":"text","value":", write out separately, as matrices, all four of the terms in the sum. Then add them together to find ","position":{"start":{"line":395,"column":1},"end":{"line":395,"column":1}},"key":"KJ5S9AEP7v"},{"type":"inlineMath","value":"\\mathbf{P}","position":{"start":{"line":395,"column":1},"end":{"line":395,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">P</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{P}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">P</span></span></span></span>","key":"Hw84mIWTJs"},{"type":"text","value":".","position":{"start":{"line":395,"column":1},"end":{"line":395,"column":1}},"key":"rBnZDuhbsG"}],"key":"zWakBbb4ER"},{"type":"paragraph","position":{"start":{"line":397,"column":1},"end":{"line":397,"column":1}},"children":[{"type":"strong","position":{"start":{"line":397,"column":1},"end":{"line":397,"column":1}},"children":[{"type":"text","value":"(b)","position":{"start":{"line":397,"column":1},"end":{"line":397,"column":1}},"key":"aUCzoHqHNj"}],"key":"iRmYmTZJux"},{"type":"text","value":" Use the formula in the general case to show that ","position":{"start":{"line":397,"column":1},"end":{"line":397,"column":1}},"key":"H6Y1gkQNN9"},{"type":"inlineMath","value":"\\mathbf{P}^{-1}=\\mathbf{P}^T","position":{"start":{"line":397,"column":1},"end":{"line":397,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi mathvariant=\"bold\">P</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo>=</mo><msup><mi mathvariant=\"bold\">P</mi><mi>T</mi></msup></mrow><annotation encoding=\"application/x-tex\">\\mathbf{P}^{-1}=\\mathbf{P}^T</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">P</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8413em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">P</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span></span></span></span>","key":"CmdTybVB8o"},{"type":"text","value":". (Hint: To show that ","position":{"start":{"line":397,"column":1},"end":{"line":397,"column":1}},"key":"uxJb6OIZKN"},{"type":"inlineMath","value":"\\mathbf{Z}","position":{"start":{"line":397,"column":1},"end":{"line":397,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">Z</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{Z}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">Z</span></span></span></span>","key":"MF5608S9Df"},{"type":"text","value":" is the inverse of ","position":{"start":{"line":397,"column":1},"end":{"line":397,"column":1}},"key":"EOyqKMr8Cq"},{"type":"inlineMath","value":"\\mathbf{P}","position":{"start":{"line":397,"column":1},"end":{"line":397,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">P</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{P}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">P</span></span></span></span>","key":"Y8AvaW0i8a"},{"type":"text","value":", show that ","position":{"start":{"line":397,"column":1},"end":{"line":397,"column":1}},"key":"W7bf7K8F7c"},{"type":"inlineMath","value":"\\mathbf{P}\\mathbf{Z}=\\mathbf{I}","position":{"start":{"line":397,"column":1},"end":{"line":397,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">P</mi><mi mathvariant=\"bold\">Z</mi><mo>=</mo><mi mathvariant=\"bold\">I</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{P}\\mathbf{Z}=\\mathbf{I}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">PZ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">I</span></span></span></span>","key":"FY7JtecTbS"},{"type":"text","value":" or ","position":{"start":{"line":397,"column":1},"end":{"line":397,"column":1}},"key":"Dp3rCIYlnY"},{"type":"inlineMath","value":"\\mathbf{Z}\\mathbf{P}=\\mathbf{I}","position":{"start":{"line":397,"column":1},"end":{"line":397,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">Z</mi><mi mathvariant=\"bold\">P</mi><mo>=</mo><mi mathvariant=\"bold\">I</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{Z}\\mathbf{P}=\\mathbf{I}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">ZP</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">I</span></span></span></span>","key":"fD4tVAo4ox"},{"type":"text","value":".)","position":{"start":{"line":397,"column":1},"end":{"line":397,"column":1}},"key":"PHSWGgoZcZ"}],"key":"mos5cnEihW"}],"label":"problem-pivoting-perminverse","identifier":"problem-pivoting-perminverse","enumerated":true,"enumerator":"2.6.4","html_id":"problem-pivoting-perminverse","key":"AaTWIpJDMH"},{"type":"footnoteDefinition","identifier":"plu","label":"PLU","position":{"start":{"line":397,"column":1},"end":{"line":397,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"children":[{"type":"text","value":"Because unpivoted LU factorization is not useful, in practice the term ","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"key":"DS9UYspNGM"},{"type":"emphasis","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"children":[{"type":"text","value":"LU factorization","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"key":"zjPpPIPM67"}],"key":"QaY6gxHR6e"},{"type":"text","value":" mostly refers to pivoted LU.","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"key":"PYUZnDRRZX"}],"key":"C1XQvZnkQ5"}],"enumerator":"1","key":"dm4QClVJJO"}],"key":"KRlwQRlGqw"}],"key":"mVCtU7WoB6"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Efficiency of matrix computations","url":"/efficiency","group":"Preface"},"next":{"title":"Vector and matrix norms","url":"/norms","group":"Preface"}}},"domain":"http://localhost:3000"}