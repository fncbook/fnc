{"kind":"Article","sha256":"ee0f481c6a23ab3ca31ee3daa637f33fd83299fcb799b9edb8987079af4dc26f","slug":"pivoting","location":"/chapter2/section6/pivoting.md","dependencies":[],"frontmatter":{"title":"Row pivoting","numbering":{"heading_1":{"enabled":true},"heading_2":{"enabled":true},"heading_3":{"enabled":false},"enumerator":{"template":"2.6.%s"}},"content_includes_title":false,"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"exports":[{"format":"md","filename":"pivoting.md","url":"/fnc/build/pivoting-7e27313d3c34cb3a4ebd55b4a94a26bd.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"As mentioned in ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"Xc4qS7w8Cw"},{"type":"link","kind":"numref","identifier":"section-linsys-lu","label":"section-linsys-lu","url":"/lu","internal":true,"dataUrl":"/lu.json","children":[{"type":"text","value":"LU factorization","key":"vRXU5n1kCm"}],"key":"iQXIzEkASz"},{"type":"text","value":", the ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"Q39rpOxq89"},{"type":"inlineMath","value":"\\mathbf{A}=\\mathbf{L}\\mathbf{U}","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi><mo>=</mo><mi mathvariant=\"bold\">L</mi><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}=\\mathbf{L}\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">LU</span></span></span></span>","key":"F9McRMPnLn"},{"type":"text","value":" factorization is not stable for every nonsingular ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"of4oOLkIiM"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"UyzoARMcER"},{"type":"text","value":". Indeed, the factorization does not always even exist.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"eits1KYnEo"}],"indexEntries":[{"entry":"matrix factorization","subEntry":{"value":"LU","kind":"entry"},"emphasis":false}],"label":"index-GPdsTtvqB3","identifier":"index-gpdsttvqb3","html_id":"index-gpdsttvqb3","key":"sSR0meW1y1"},{"type":"proof","kind":"example","enumerated":true,"children":[{"type":"tabSet","children":[{"type":"tabItem","title":"Julia","sync":"julia","children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Failure of naive LU factorization","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"knrk6lWEaK"}],"key":"hmEcFThtiJ"},{"type":"include","file":"julia/fail.ipynb","children":[{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-05T09:33:19.478000Z","iopub.status.busy":"2025-01-05T09:33:19.209000Z","iopub.status.idle":"2025-01-05T09:33:25.748000Z","shell.execute_reply":"2025-01-05T09:33:25.695000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"include(\"../../../julia/FNC_init.jl\")","key":"OyD03cB1rv"},{"type":"output","id":"d8jwXC-G5T0MOerMIJZZT","data":[{"name":"stderr","output_type":"stream","text":"\u001b[32m\u001b[1m  Activating\u001b[22m\u001b[39m "},{"name":"stderr","output_type":"stream","text":"project at `~/Documents/GitHub/fnc`\n"}],"key":"JYLoUbCMtQ"}],"key":"Nma0eibTDB"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"KijCx6up0s"},{"type":"text","value":"2.6.1","key":"SPxW6kezWF"}],"key":"RQkOYhjlj4"}],"identifier":"demo-pivoting-fail","label":"demo-pivoting-fail","kind":"proof:example","template":"Example %s","enumerator":"2.6.1","resolved":true,"html_id":"demo-pivoting-fail","key":"Pdv4dlNEto"}],"key":"Kyvj5vEAZ9"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Here is a previously encountered matrix that factors well.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"o1t00g5W2N"}],"key":"HeJN2YphBn"}],"key":"eeH4EM2SYV"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-05T09:33:25.891000Z","iopub.status.busy":"2025-01-05T09:33:25.749000Z","iopub.status.idle":"2025-01-05T09:33:27.259000Z","shell.execute_reply":"2025-01-05T09:33:27.259000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"A = [2 0 4 3 ; -4 5 -7 -10 ; 1 15 2 -4.5 ; -2 0 2 -13];\nL, U = FNC.lufact(A)\nL","key":"e9yVmX4VMG"},{"type":"output","id":"Vj7BuQFXMOVy1Wq9HLrfo","data":[{"output_type":"execute_result","execution_count":2,"metadata":{},"data":{"text/plain":{"content":"4×4 LowerTriangular{Float64, Matrix{Float64}}:\n  1.0   ⋅     ⋅    ⋅ \n -2.0  1.0    ⋅    ⋅ \n  0.5  3.0   1.0   ⋅ \n -1.0  0.0  -2.0  1.0","content_type":"text/plain"}}}],"key":"CG54yxglBV"}],"key":"pCc6MeDKar"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"If we swap the second and fourth rows of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"A7SB5zvcPe"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"qubp6lkVHs"},{"type":"text","value":", the result is still nonsingular. However, the factorization now fails.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jcGJ0DLEC1"}],"key":"szJutQMVkG"}],"key":"RzgFytHlPG"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-05T09:33:27.262000Z","iopub.status.busy":"2025-01-05T09:33:27.262000Z","iopub.status.idle":"2025-01-05T09:33:27.315000Z","shell.execute_reply":"2025-01-05T09:33:27.315000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"A[[2, 4], :] = A[[4, 2], :]  \nL, U = FNC.lufact(A)\nL","key":"eqRZjtsZHU"},{"type":"output","id":"PLWKjsGDb8i74x7GP7RJ9","data":[{"output_type":"execute_result","execution_count":3,"metadata":{},"data":{"text/plain":{"content":"4×4 LowerTriangular{Float64, Matrix{Float64}}:\n  1.0     ⋅      ⋅    ⋅ \n -1.0  NaN       ⋅    ⋅ \n  0.5   Inf   NaN     ⋅ \n -2.0   Inf   NaN    1.0","content_type":"text/plain"}}}],"key":"m7bKl056wa"}],"key":"dbUXQ76pHq"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"The presence of ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"xpbGXSSOjs"},{"type":"inlineCode","value":"NaN","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"JScDdUNGol"},{"type":"text","value":" in the result indicates that some impossible operation was required. The source of the problem is easy to locate. We can find the first outer product in the factorization just fine:","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"tRczbI6GB3"}],"indexEntries":[{"entry":"Julia","subEntry":{"value":"NaN","kind":"entry"},"emphasis":false}],"label":"index-n4HBv0LiaL","identifier":"index-n4hbv0lial","html_id":"index-n4hbv0lial","key":"l9Q7tORZm0"}],"key":"nVMeqQOdW3"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-05T09:33:27.317000Z","iopub.status.busy":"2025-01-05T09:33:27.317000Z","iopub.status.idle":"2025-01-05T09:33:27.518000Z","shell.execute_reply":"2025-01-05T09:33:27.518000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"U[1, :] = A[1, :]\nL[:, 1] = A[:, 1] / U[1, 1]\nA -= L[:, 1] * U[1, :]'","key":"fotPRSSl3T"},{"type":"output","id":"gnkzDT_ScI9k8_g4nMY6b","data":[{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n 0.0   0.0  0.0    0.0\n 0.0   0.0  6.0  -10.0\n 0.0  15.0  0.0   -6.0\n 0.0   5.0  1.0   -4.0","content_type":"text/plain"}}}],"key":"cS9jv0bQpV"}],"key":"psjnFSqhe5"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The next step is ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Jd7bKG6SMz"},{"type":"inlineCode","value":"U[2, :] = A[2, :]","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"sYNmwjvdRM"},{"type":"text","value":", which is also OK. But then we are supposed to divide by ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rERZ7yb5xY"},{"type":"inlineCode","value":"U[2, 2]","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"NjlLMhvqhF"},{"type":"text","value":", which is zero. The algorithm cannot continue.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YrXt42f8t5"}],"key":"uCAGsgyx9y"}],"key":"w9HBM5dumS"}],"key":"pyGXHHTkzv"}],"key":"Q4FCXKEeoX"}],"key":"AijNEJsjcV"},{"type":"tabItem","title":"MATLAB","sync":"matlab","children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Failure of naive LU factorization","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"K94d4Kixck"}],"key":"HR4HD96DsQ"},{"type":"include","file":"matlab/fail.ipynb","children":[{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"zEyfv7SI6I"},{"type":"text","value":"2.6.1","key":"OXePvFGHNd"}],"key":"NinwGObTNu"}],"identifier":"demo-pivoting-fail","label":"demo-pivoting-fail","kind":"proof:example","template":"Example %s","enumerator":"2.6.1","resolved":true,"html_id":"demo-pivoting-fail","key":"iHuLUC2w79"}],"key":"PcHRslj4Du"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Here is a previously encountered matrix that factors well.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"TIJ6ITRnc2"}],"key":"brGXXvbRMh"}],"key":"cwGRA60Rqw"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"A = [\n    2 0 4 3\n    -4 5 -7 -10\n    1 15 2 -4.5\n    -2 0 2 -13\n    ];\n[L, U] = lufact(A);\nL","key":"GuuFNNO5j9"},{"type":"output","id":"KeyFHXK1VjVHkpa8KXrui","data":[{"output_type":"execute_result","execution_count":2,"metadata":{},"data":{"text/plain":{"content":"L = 4×4 double\n    1.0000         0         0         0\n   -2.0000    1.0000         0         0\n    0.5000    3.0000    1.0000         0\n   -1.0000         0   -2.0000    1.0000\n","content_type":"text/plain"},"text/html":{"content":"<html><body><pre>L = 4×4 double\n    1.0000         0         0         0\n   -2.0000    1.0000         0         0\n    0.5000    3.0000    1.0000         0\n   -1.0000         0   -2.0000    1.0000\n</pre></body></html>","content_type":"text/html"}}}],"key":"dY3bV78wUZ"}],"key":"OtEMmvfIPe"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"If we swap the second and fourth rows of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"yEmtjh373M"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"IjaSnQKHub"},{"type":"text","value":", the result is still nonsingular. However, the factorization now fails.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"lJcRHOlK8q"}],"key":"esW0RSXBaB"}],"key":"eHFuWuflrY"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"A([2, 4], :) = A([4, 2], :);    % swap rows 2 and 4\n[L, U] = lufact(A);\nL","key":"ijQVYvB2OZ"},{"type":"output","id":"bzVtJdgQJug1pXyLBBJea","data":[{"output_type":"execute_result","execution_count":3,"metadata":{},"data":{"text/plain":{"content":"L = 4×4 double\n    1.0000         0         0         0\n   -1.0000       NaN         0         0\n    0.5000       Inf       NaN         0\n   -2.0000       Inf       NaN    1.0000\n","content_type":"text/plain"},"text/html":{"content":"<html><body><pre>L = 4×4 double\n    1.0000         0         0         0\n   -1.0000       NaN         0         0\n    0.5000       Inf       NaN         0\n   -2.0000       Inf       NaN    1.0000\n</pre></body></html>","content_type":"text/html"}}}],"key":"yGTkrDUg64"}],"key":"kONW2gQzaN"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"The presence of ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"mHMxOkH6yt"},{"type":"inlineCode","value":"NaN","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"WX3v8XYKSK"},{"type":"text","value":" in the result indicates that some impossible operation was required. The source of the problem is easy to locate. We can find the first outer product in the factorization just fine:","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"uZJy5OmBVL"}],"indexEntries":[{"entry":"MATLAB","subEntry":{"value":"NaN","kind":"entry"},"emphasis":false}],"label":"index-h7DqAvnTNx","identifier":"index-h7dqavntnx","html_id":"index-h7dqavntnx","key":"hbOYrV43w3"}],"key":"MVXbkT2CRL"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"U(1, :) = A(1, :);\nL(:, 1) = A(:, 1) / U(1, 1)\nA = A - L(:, 1) * U(1, :)","key":"bDkm5PAtp9"},{"type":"output","id":"BYxeh9Iz9iclmggk0izo1","data":[{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"text/plain":{"content":"L = 4×4 double\n    1.0000         0         0         0\n   -1.0000       NaN         0         0\n    0.5000       Inf       NaN         0\n   -2.0000       Inf       NaN    1.0000\n","content_type":"text/plain"},"text/html":{"content":"<html><body><pre>L = 4×4 double\n    1.0000         0         0         0\n   -1.0000       NaN         0         0\n    0.5000       Inf       NaN         0\n   -2.0000       Inf       NaN    1.0000\n</pre></body></html>","content_type":"text/html"}}},{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"text/plain":{"content":"A = 4×4 double\n     0     0     0     0\n     0     0     6   -10\n     0    15     0    -6\n     0     5     1    -4\n","content_type":"text/plain"},"text/html":{"content":"<html><body><pre>A = 4×4 double\n     0     0     0     0\n     0     0     6   -10\n     0    15     0    -6\n     0     5     1    -4\n</pre></body></html>","content_type":"text/html"}}}],"key":"Uob7kWBB0r"}],"key":"WPVBiYpcH1"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The next step is ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OmnQZsmM1m"},{"type":"inlineCode","value":"U(2, :) = A(2, :)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wi0j5jfabN"},{"type":"text","value":", which is also OK. But then we are supposed to divide by ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PKd7Rr7du1"},{"type":"inlineCode","value":"U(2, 2)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"uC51MrawPi"},{"type":"text","value":", which is zero. The algorithm cannot continue.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jqP4EFh04z"}],"key":"zLw7iuN1XB"}],"key":"oQZj6HeGqf"}],"key":"iI1mnDGEWG"}],"key":"IFuQVhpolP"}],"key":"AhBbBcfPI9"},{"type":"tabItem","title":"Python","sync":"python","children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Failure of naive LU factorization","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"zb2LFF7wDI"}],"key":"sfF4D9k610"},{"type":"include","file":"python/fail.ipynb","children":[{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:43:40.004703Z","iopub.status.busy":"2025-01-11T17:43:40.004443Z","iopub.status.idle":"2025-01-11T17:43:40.328749Z","shell.execute_reply":"2025-01-11T17:43:40.328378Z"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"exec(open(\"../../../python/FNC_init.py\").read())","visibility":"show","key":"ZlOs1AdPdb"},{"type":"output","id":"p5RoRRPh2OWfHUBIHRvq1","data":[],"visibility":"show","key":"mtb8F8O54c"}],"visibility":"remove","key":"RyGbvrM46z"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"X0LNwqJ15G"},{"type":"text","value":"2.6.1","key":"sD7azxD5Gd"}],"key":"rw3uftXFSt"}],"identifier":"demo-pivoting-fail","label":"demo-pivoting-fail","kind":"proof:example","template":"Example %s","enumerator":"2.6.1","resolved":true,"html_id":"demo-pivoting-fail","key":"ks7PnFd3Pr"}],"key":"AZVt4J2JOX"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Here is a previously encountered matrix that factors well.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"estCOma9Ux"}],"key":"IC3SqaXXEm"}],"key":"F7G9S6MHBI"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:43:40.330377Z","iopub.status.busy":"2025-01-11T17:43:40.330253Z","iopub.status.idle":"2025-01-11T17:43:40.332641Z","shell.execute_reply":"2025-01-11T17:43:40.332382Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"A = array([\n    [2, 0, 4, 3],\n    [-4, 5, -7, -10],\n    [1, 15, 2, -4.5],\n    [-2, 0, 2, -13]\n    ])\nL, U = FNC.lufact(A)\nprint(L)","key":"VhsUKCLPAR"},{"type":"output","id":"aXiMIlEZ6wgKti-jBGa4U","data":[{"name":"stdout","output_type":"stream","text":"[[ 1.   0.  -0.   0. ]\n [-2.   1.  -0.   0. ]\n [ 0.5  3.   1.   0. ]\n [-1.   0.  -2.   1. ]]\n"}],"key":"o3xH5322Ns"}],"key":"uQr1eGZ0uR"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"If we swap the second and fourth rows of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"j35oqjsCEy"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"URFdGEyH0h"},{"type":"text","value":", the result is still nonsingular. However, the factorization now fails.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hkoy30fFTa"}],"key":"qRtZsxWiqY"}],"key":"ujRxrUSLXf"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:43:40.333897Z","iopub.status.busy":"2025-01-11T17:43:40.333777Z","iopub.status.idle":"2025-01-11T17:43:40.337813Z","shell.execute_reply":"2025-01-11T17:43:40.337546Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"A[[1, 3], :] = A[[3, 1], :]  \nL, U = FNC.lufact(A)\nprint(L)","key":"zGoDkEVb7S"},{"type":"output","id":"XVIH96elTTydxXoBxbf56","data":[{"name":"stdout","output_type":"stream","text":"[[ 1.   nan  nan  0. ]\n [-1.   nan  nan  0. ]\n [ 0.5  inf  nan  0. ]\n [-2.   inf  nan  1. ]]\n"},{"name":"stderr","output_type":"stream","text":"/Users/driscoll/Documents/GitHub/fnc/python/fncbook/fncbook/chapter02.py:47: RuntimeWarning: divide by zero encountered in divide\n  L[:, k] = A_k[:, k] / U[k,k]\n/Users/driscoll/Documents/GitHub/fnc/python/fncbook/fncbook/chapter02.py:47: RuntimeWarning: invalid value encountered in divide\n  L[:, k] = A_k[:, k] / U[k,k]\n/Users/driscoll/mambaforge/envs/myst/lib/python3.13/site-packages/numpy/_core/numeric.py:983: RuntimeWarning: invalid value encountered in multiply\n  return multiply(a.ravel()[:, newaxis], b.ravel()[newaxis, :], out)\n"}],"key":"sn4Jn5Dmyl"}],"key":"QcwH6hkvda"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"The presence of ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"Xca19rPjw2"},{"type":"inlineCode","value":"NaN","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"GRvdSn6141"},{"type":"text","value":" in the result indicates that some impossible operation was required. The source of the problem is easy to locate. We can find the first outer product in the factorization just fine:","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"aH3urJErtk"}],"indexEntries":[{"entry":"Python","subEntry":{"value":"NaN","kind":"entry"},"emphasis":false}],"label":"index-akYzWINscQ","identifier":"index-akyzwinscq","html_id":"index-akyzwinscq","key":"JToNTwZ8Wo"}],"key":"L1fatKUBO1"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:43:40.339029Z","iopub.status.busy":"2025-01-11T17:43:40.338939Z","iopub.status.idle":"2025-01-11T17:43:40.341092Z","shell.execute_reply":"2025-01-11T17:43:40.340821Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"U[0, :] = A[0, :]\nL[:, 0] = A[:, 0] / U[0, 0]\nA -= outer(L[:, 0],  U[0, :])\nprint(A)","key":"YLz24M7SdT"},{"type":"output","id":"qjmIcBnLJFTvIMi4Qo4PQ","data":[{"name":"stdout","output_type":"stream","text":"[[  0.   0.   0.   0.]\n [  0.   0.   6. -10.]\n [  0.  15.   0.  -6.]\n [  0.   5.   1.  -4.]]\n"}],"key":"AI16Blj27L"}],"key":"mhcPAAhrGW"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The next step is ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"P5R5NzaMxx"},{"type":"inlineCode","value":"U[1, :] = A[1, :]","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cdXE7lICql"},{"type":"text","value":", which is also OK. But then we are supposed to divide by ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"INOGbEL1RP"},{"type":"inlineCode","value":"U[1, 1]","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DIveGvkMDi"},{"type":"text","value":", which is zero. The algorithm cannot continue.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"HLlYHQuMWT"}],"key":"sq35rMG2t4"}],"key":"sPZqLBLbKQ"}],"key":"tnqa0Uh9Hq"}],"key":"QS9ytIXVEU"}],"key":"sgjojYfXMk"}],"key":"UwkRSCRgF9"}],"label":"demo-pivoting-fail","identifier":"demo-pivoting-fail","html_id":"demo-pivoting-fail","enumerator":"2.6.1","key":"hcad47vIsP"},{"type":"paragraph","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"children":[{"type":"text","value":"In ","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"key":"wN5AjzkU16"},{"type":"link","kind":"numref","identifier":"section-linsys-lu","label":"section-linsys-lu","url":"/lu","internal":true,"dataUrl":"/lu.json","children":[{"type":"text","value":"LU factorization","key":"kbf37itvVP"}],"key":"qWujpyfIKh"},{"type":"text","value":" we remarked that LU factorization is equivalent to Gaussian elimination with no row swaps. However, those swaps are necessary in situations like those encountered in ","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"key":"DMCkm4MX1A"},{"type":"crossReference","kind":"proof:example","identifier":"demo-pivoting-fail","label":"demo-pivoting-fail","children":[{"type":"text","value":"Demo ","key":"CUByEN7DTx"},{"type":"text","value":"2.6.1","key":"eNjNgtL9EY"}],"template":"Example %s","enumerator":"2.6.1","resolved":true,"html_id":"demo-pivoting-fail","key":"MRnzmRFMVF"},{"type":"text","value":", in order to avoid division by zero. We will find a modification of the outer product procedure that allows us to do the same thing.","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"key":"H83jlOA1cb"}],"key":"vssfv44JOk"},{"type":"heading","depth":2,"position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"children":[{"type":"text","value":"Choosing a pivot","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"key":"xikvbiEKcM"}],"identifier":"choosing-a-pivot","label":"Choosing a pivot","html_id":"choosing-a-pivot","implicit":true,"enumerator":"2.6.1","key":"DmXuRePIm2"},{"type":"paragraph","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"children":[{"type":"text","value":"The diagonal element of ","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"FyEvTOIbeX"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"tV60ftjmk2"},{"type":"text","value":" that appears in the denominator of line 17 of ","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"GZOJv7gPw2"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-lufact","label":"function-lufact","children":[{"type":"text","value":"Function ","key":"xeeL33lBXC"},{"type":"text","value":"2.4.1","key":"tgtqf3Dwun"}],"template":"Algorithm %s","enumerator":"2.4.1","resolved":true,"html_id":"function-lufact","remote":true,"url":"/lu","dataUrl":"/lu.json","key":"ubEDCrZmI6"},{"type":"text","value":" is called the ","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"WqQS4xozyf"},{"type":"strong","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"children":[{"type":"text","value":"pivot element","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"YZF0ZSmUPx"}],"key":"LeroulWuqP"},{"type":"text","value":" of its column. In order to avoid a zero pivot, we will use the largest available element in the column we are working on as the pivot. This technique is known as ","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"QpwnVWZL9z"},{"type":"strong","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"children":[{"type":"text","value":"row pivoting","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"bRxTBgudg8"}],"key":"wkCSVaPus3"},{"type":"text","value":".","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"DOJFTbNQm0"}],"indexEntries":[{"entry":"pivoting","emphasis":true}],"label":"index-nuEGSBrC9v","identifier":"index-nuegsbrc9v","html_id":"index-nuegsbrc9v","key":"mz5Ox5Oaq6"},{"type":"proof","kind":"algorithm","enumerated":true,"children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Row pivoting","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"key":"CCzxnfk63b"}],"key":"ZOY3mbx4OZ"},{"type":"paragraph","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"children":[{"type":"text","value":"When performing elimination in column ","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"RsZvIznVRG"},{"type":"inlineMath","value":"j","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>j</mi></mrow><annotation encoding=\"application/x-tex\">j</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span></span></span></span>","key":"takTeZTKtB"},{"type":"text","value":", choose as the pivot the element in column ","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"abhamB4Eps"},{"type":"inlineMath","value":"j","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>j</mi></mrow><annotation encoding=\"application/x-tex\">j</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span></span></span></span>","key":"VUWuZbtD9n"},{"type":"text","value":" that is largest in absolute value. (In case of ties, choose the lowest row index.)","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"Ej6sHJF0It"}],"key":"dfcg39GbUQ"}],"label":"rule-pivoting","identifier":"rule-pivoting","html_id":"rule-pivoting","enumerator":"2.6.1","key":"PZpaHxCOYu"},{"type":"proof","kind":"example","enumerated":true,"children":[{"type":"tabSet","children":[{"type":"tabItem","title":"Julia","sync":"julia","children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Row pivoting in LU factorization","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"xKYf5y6yFK"}],"key":"amcsvCJbms"},{"type":"include","file":"julia/fix.ipynb","children":[{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-05T09:33:35.371000Z","iopub.status.busy":"2025-01-05T09:33:34.405000Z","iopub.status.idle":"2025-01-05T09:33:41.736000Z","shell.execute_reply":"2025-01-05T09:33:41.689000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"include(\"../../../julia/FNC_init.jl\")","key":"c78kfIKF8P"},{"type":"output","id":"VhE0QvraRjRLTQXkS3KhM","data":[{"name":"stderr","output_type":"stream","text":"\u001b[32m\u001b[1m  Activating\u001b[22m\u001b[39m "},{"name":"stderr","output_type":"stream","text":"project at `~/Documents/GitHub/fnc`\n"}],"key":"DGeuJtWDRR"}],"key":"ICWZvfMNS0"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"ip4Qa5OP7A"},{"type":"text","value":"2.6.2","key":"tufaK3quP5"}],"key":"axyK1p66Mt"}],"identifier":"demo-pivoting-fix","label":"demo-pivoting-fix","kind":"proof:example","template":"Example %s","enumerator":"2.6.2","resolved":true,"html_id":"demo-pivoting-fix","key":"ZEVFHh6sfz"}],"key":"G8uv7LLTw7"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Here is the trouble-making matrix from ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"D93Fsl9wZB"},{"type":"crossReference","kind":"proof:example","identifier":"demo-pivoting-fail","label":"demo-pivoting-fail","children":[{"type":"text","value":"Demo ","key":"uGo8diHcwC"},{"type":"text","value":"2.6.1","key":"gJQ4GZEMCE"}],"template":"Example %s","enumerator":"2.6.1","resolved":true,"html_id":"demo-pivoting-fail","key":"eULGVKrQAH"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"TwYyalxWOP"}],"key":"V7Egu9ufGv"}],"key":"FeP9ap4z1T"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-05T09:33:41.871000Z","iopub.status.busy":"2025-01-05T09:33:41.738000Z","iopub.status.idle":"2025-01-05T09:33:43.144000Z","shell.execute_reply":"2025-01-05T09:33:43.144000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"A₁ = [2 0 4 3 ; -2 0 2 -13; 1 15 2 -4.5 ; -4 5 -7 -10]","key":"Mbqe6IeWxm"},{"type":"output","id":"M9PhX3JH1a2zSkw1sv_H1","data":[{"output_type":"execute_result","execution_count":2,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n  2.0   0.0   4.0    3.0\n -2.0   0.0   2.0  -13.0\n  1.0  15.0   2.0   -4.5\n -4.0   5.0  -7.0  -10.0","content_type":"text/plain"}}}],"key":"gV9v0fZXtj"}],"key":"wxIHx7Drv2"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We now find the largest candidate pivot in the first column. We don’t care about sign, so we take absolute values before finding the max.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"QaGs6lZrB2"}],"key":"TKgWB1qFRh"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"lJ1LlF9QD9"}],"key":"o0yZ7AWmfm"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"xkAK8N2Xwa"},{"type":"inlineCode","value":"argmax","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"JVvSH7Wn6o"},{"type":"text","value":" function returns the location of the largest element of a vector or matrix.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"Xq5yWGLwIM"}],"key":"I2IF207RfS"}],"class":"dropdown","key":"oMZlzF24zp"}],"key":"orGFa7JHoY"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-05T09:33:43.146000Z","iopub.status.busy":"2025-01-05T09:33:43.146000Z","iopub.status.idle":"2025-01-05T09:33:43.234000Z","shell.execute_reply":"2025-01-05T09:33:43.234000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"i = argmax( abs.(A₁[:, 1]) ) ","key":"LJoJc6GEMK"},{"type":"output","id":"j8b2CGCHY1Zm9u5yg7x7u","data":[{"output_type":"execute_result","execution_count":3,"metadata":{},"data":{"text/plain":{"content":"4","content_type":"text/plain"}}}],"key":"hkfQdv01Rf"}],"key":"yrYQtcjii2"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"This is the row of the matrix that we extract to put into ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bHB26vAlGr"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"UGrSvAACNX"},{"type":"text","value":". That guarantees that the division used to find ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hqCVSea0Mk"},{"type":"inlineMath","value":"\\boldsymbol{\\ell}_1","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">ℓ</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\boldsymbol{\\ell}_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">ℓ</span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"te7FqxQFNQ"},{"type":"text","value":" will be valid.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"oKPe1k7mwo"}],"key":"TCEAQTX7Rg"}],"key":"D8y1UVyqq8"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-05T09:33:43.236000Z","iopub.status.busy":"2025-01-05T09:33:43.236000Z","iopub.status.idle":"2025-01-05T09:33:43.248000Z","shell.execute_reply":"2025-01-05T09:33:43.248000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"L, U = zeros(4,4),zeros(4,4)\nU[1, :] = A₁[i, :]\nL[:, 1] = A₁[:, 1] / U[1, 1]\nA₂ = A₁ - L[:, 1] * U[1, :]'","key":"EVLlK4kgD9"},{"type":"output","id":"maAV-n5cJ4UvLahSMfaDE","data":[{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n 0.0   2.5   0.5   -2.0\n 0.0  -2.5   5.5   -8.0\n 0.0  16.25  0.25  -7.0\n 0.0   0.0   0.0    0.0","content_type":"text/plain"}}}],"key":"YusMxHRk62"}],"key":"icgb1WcXBB"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Observe that ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"vr2RzwAzOW"},{"type":"inlineMath","value":"\\mathbf{A}_2","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">A</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8361em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"vBFTzkFo6O"},{"type":"text","value":" has a new zero row and zero column, but the zero row is the fourth rather than the first. However, we forge on by using the largest possible pivot in column 2 for the next outer product.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"m3UMLmSoWx"}],"key":"YtcDHyG4MI"}],"key":"ruj1nYdujN"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-05T09:33:43.249000Z","iopub.status.busy":"2025-01-05T09:33:43.249000Z","iopub.status.idle":"2025-01-05T09:33:43.742000Z","shell.execute_reply":"2025-01-05T09:33:43.742000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"@show i = argmax( abs.(A₂[:, 2]) ) \nU[2, :] = A₂[i, :]\nL[:, 2] = A₂[:, 2] / U[2, 2]\nA₃ = A₂ - L[:, 2] * U[2, :]'","key":"r6MSn11Akf"},{"type":"output","id":"-sMdvebHNrIr4gN8Gnshv","data":[{"name":"stdout","output_type":"stream","text":"i = argmax(abs.(A₂[:, 2])) = 3"},{"name":"stdout","output_type":"stream","text":"\n"},{"output_type":"execute_result","execution_count":5,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n 0.0  0.0  0.461538  -0.923077\n 0.0  0.0  5.53846   -9.07692\n 0.0  0.0  0.0        0.0\n 0.0  0.0  0.0        0.0","content_type":"text/plain"}}}],"key":"oa39LzwOx5"}],"key":"ZozLe7eMVo"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now we have zeroed out the third row as well as the second column. We can finish out the procedure.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"FaY74Jd8lc"}],"key":"cp71ztN6Mq"}],"key":"oKySDPC90O"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-05T09:33:43.744000Z","iopub.status.busy":"2025-01-05T09:33:43.744000Z","iopub.status.idle":"2025-01-05T09:33:43.746000Z","shell.execute_reply":"2025-01-05T09:33:43.745000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"@show i = argmax( abs.(A₃[:, 3]) ) \nU[3, :] = A₃[i, :]\nL[:, 3] = A₃[:, 3] / U[3, 3]\nA₄ = A₃ - L[:, 3] * U[3, :]'","key":"UMWl1Id92X"},{"type":"output","id":"JchjldH-GYzA2rbMaZDtM","data":[{"name":"stdout","output_type":"stream","text":"i = argmax(abs.(A₃[:, 3])) = 2\n"},{"output_type":"execute_result","execution_count":6,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n 0.0  0.0  0.0  -0.166667\n 0.0  0.0  0.0   0.0\n 0.0  0.0  0.0   0.0\n 0.0  0.0  0.0   0.0","content_type":"text/plain"}}}],"key":"g5kmQ1gBf0"}],"key":"UkdGCLNSl6"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-05T09:33:43.747000Z","iopub.status.busy":"2025-01-05T09:33:43.747000Z","iopub.status.idle":"2025-01-05T09:33:43.754000Z","shell.execute_reply":"2025-01-05T09:33:43.754000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"@show i = argmax( abs.(A₄[:, 4]) ) \nU[4, :] = A₄[i, :]\nL[:, 4] = A₄[:, 4] / U[4, 4];","key":"LAOU5JQrNr"},{"type":"output","id":"SrbBynbiNo-DXxIx9KrHy","data":[{"name":"stdout","output_type":"stream","text":"i = argmax(abs.(A₄[:, 4])) = 1\n"}],"key":"LR9GtsC7ds"}],"key":"HHBpF0jtTb"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We do have a factorization of the original matrix:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"g3UqCRPJDX"}],"key":"zedHPsmkSY"}],"key":"Rz5ilJN4Tw"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-05T09:33:43.755000Z","iopub.status.busy":"2025-01-05T09:33:43.755000Z","iopub.status.idle":"2025-01-05T09:33:43.761000Z","shell.execute_reply":"2025-01-05T09:33:43.761000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"A₁ - L * U","key":"xywaJFAzii"},{"type":"output","id":"PS-JBgIth89zaLwtR5N8t","data":[{"output_type":"execute_result","execution_count":8,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n 0.0  -1.38778e-16  0.0  0.0\n 0.0   1.38778e-16  0.0  0.0\n 0.0   0.0          0.0  0.0\n 0.0   0.0          0.0  0.0","content_type":"text/plain"}}}],"key":"aKRQULsYvc"}],"key":"cDMMGzz2kX"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"And ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zyE0Yu8k7z"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"hvUM5gE7ru"},{"type":"text","value":" has the required structure:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"HPEB4ONCU4"}],"key":"S8xVZwjaZu"}],"key":"oX7VS6ficN"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-05T09:33:43.762000Z","iopub.status.busy":"2025-01-05T09:33:43.762000Z","iopub.status.idle":"2025-01-05T09:33:43.763000Z","shell.execute_reply":"2025-01-05T09:33:43.763000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"U","key":"DBeW4JDO5z"},{"type":"output","id":"z9kdwDUjMWrkW-H7NwjAJ","data":[{"output_type":"execute_result","execution_count":9,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n -4.0   5.0   -7.0      -10.0\n  0.0  16.25   0.25      -7.0\n  0.0   0.0    5.53846   -9.07692\n  0.0   0.0    0.0       -0.166667","content_type":"text/plain"}}}],"key":"iIAr1q7hst"}],"key":"uHzMzomZ2d"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"However, the triangularity of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"QtRqUoCccX"},{"type":"inlineMath","value":"\\mathbf{L}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">L</span></span></span></span>","key":"XDYeH7X4SD"},{"type":"text","value":" has been broken.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kFndA5SnII"}],"key":"vGL3jmBz47"}],"key":"pJpzyCVnUp"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-05T09:33:43.764000Z","iopub.status.busy":"2025-01-05T09:33:43.764000Z","iopub.status.idle":"2025-01-05T09:33:43.765000Z","shell.execute_reply":"2025-01-05T09:33:43.765000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"L","key":"UB91fwQqmy"},{"type":"output","id":"J6WIfGGu76UkB2VcAx9mg","data":[{"output_type":"execute_result","execution_count":10,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n -0.5    0.153846  0.0833333   1.0\n  0.5   -0.153846  1.0        -0.0\n -0.25   1.0       0.0        -0.0\n  1.0    0.0       0.0        -0.0","content_type":"text/plain"}}}],"key":"IHowbXY8jn"}],"key":"zQZa0gxSwe"}],"key":"PeXjWDMyg7"}],"key":"wWyCWdvCfV"}],"key":"LReIJmMoSg"},{"type":"tabItem","title":"MATLAB","sync":"matlab","children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Row pivoting in LU factorization","position":{"start":{"line":74,"column":1},"end":{"line":74,"column":1}},"key":"HBlaWdkiNZ"}],"key":"Hil7UmFzHt"},{"type":"include","file":"matlab/fix.ipynb","children":[{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"KlwVqfMNp5"},{"type":"text","value":"2.6.2","key":"G7V0dpDqVg"}],"key":"tjhRhXjQ4S"}],"identifier":"demo-pivoting-fix","label":"demo-pivoting-fix","kind":"proof:example","template":"Example %s","enumerator":"2.6.2","resolved":true,"html_id":"demo-pivoting-fix","key":"n87Io1H3Pg"}],"key":"fRx3nzfbrs"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Here is the trouble-making matrix from ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"KwRqHutNb1"},{"type":"crossReference","kind":"proof:example","identifier":"demo-pivoting-fail","label":"demo-pivoting-fail","children":[{"type":"text","value":"Demo ","key":"zwwaDE9pGM"},{"type":"text","value":"2.6.1","key":"EpWh7G38PP"}],"template":"Example %s","enumerator":"2.6.1","resolved":true,"html_id":"demo-pivoting-fail","key":"FvP2esMsPI"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"sVU8qC5yUp"}],"key":"OQWAO4wkVU"}],"key":"OZ5Ih3eKuE"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"A_1 = [2 0 4 3; -2 0 2 -13; 1 15 2 -4.5; -4 5 -7 -10]","key":"WgjVFrMKQn"},{"type":"output","id":"YxiYCtQt8hBHMaFK2hOdo","data":[{"output_type":"execute_result","execution_count":2,"metadata":{},"data":{"text/plain":{"content":"A_1 = 4×4 double\n    2.0000         0    4.0000    3.0000\n   -2.0000         0    2.0000  -13.0000\n    1.0000   15.0000    2.0000   -4.5000\n   -4.0000    5.0000   -7.0000  -10.0000\n","content_type":"text/plain"},"text/html":{"content":"<html><body><pre>A_1 = 4×4 double\n    2.0000         0    4.0000    3.0000\n   -2.0000         0    2.0000  -13.0000\n    1.0000   15.0000    2.0000   -4.5000\n   -4.0000    5.0000   -7.0000  -10.0000\n</pre></body></html>","content_type":"text/html"}}}],"key":"Swcg3XaKVI"}],"key":"Nqzi0HLM6n"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"We now find the largest candidate pivot in the first column. We don’t care about sign, so we take absolute values before finding the max.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"r1WvL4Yx2a"}],"indexEntries":[{"entry":"MATLAB","subEntry":{"value":"max","kind":"entry"},"emphasis":true},{"entry":"MATLAB","subEntry":{"value":"\\~","kind":"entry"},"emphasis":true}],"label":"index-TGd5342CL2","identifier":"index-tgd5342cl2","html_id":"index-tgd5342cl2","key":"DQqJzYKZhy"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"xfrMyHbmM3"}],"key":"x9yHK1gMZg"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"The second output of ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"DVn6pMw3qB"},{"type":"inlineCode","value":"max","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"hB5fTMygZ5"},{"type":"text","value":" returns the location of the largest element of a vector. The ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"ijjRRgS3FU"},{"type":"inlineCode","value":"~","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"Y63tRKKAfG"},{"type":"text","value":" symbol is used to ignore the value of the first output.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"bBhzs1d8mg"}],"key":"YW2jlWWKf2"}],"class":"dropdown","key":"BJ2wAn9KKA"}],"key":"KnHXNm9B9p"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"[~, i] = max( abs(A_1(:, 1)) ) ","key":"kRevfthIDI"},{"type":"output","id":"gqXzJhUiWHvpOXygj4xMn","data":[{"output_type":"execute_result","execution_count":3,"metadata":{},"data":{"text/plain":{"content":"i = 4","content_type":"text/plain"},"text/html":{"content":"<html><body><pre>i = 4</pre></body></html>","content_type":"text/html"}}}],"key":"VgTJJcH81J"}],"key":"Hhm1BCNp3d"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"This is the row of the matrix that we extract to put into ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XCFaTVpr6C"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"QplXXpvoLT"},{"type":"text","value":". That guarantees that the division used to find ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KYRFE41hQS"},{"type":"inlineMath","value":"\\boldsymbol{\\ell}_1","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">ℓ</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\boldsymbol{\\ell}_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">ℓ</span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"KTXWkR22zm"},{"type":"text","value":" will be valid.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"yIENhnd9Vw"}],"key":"lGHsf8tj8p"}],"key":"sROZUdUgOu"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"L = zeros(4, 4);\nU = zeros(4, 4);\nU(1, :) = A_1(i, :);\nL(:, 1) = A_1(:, 1) / U(1, 1);\nA_2 = A_1 - L(:, 1) * U(1, :)","key":"CIqluXnxy2"},{"type":"output","id":"P1bGlGEFtVLitM-lRCP7a","data":[{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"text/plain":{"content":"A_2 = 4×4 double\n         0    2.5000    0.5000   -2.0000\n         0   -2.5000    5.5000   -8.0000\n         0   16.2500    0.2500   -7.0000\n         0         0         0         0\n","content_type":"text/plain"},"text/html":{"content":"<html><body><pre>A_2 = 4×4 double\n         0    2.5000    0.5000   -2.0000\n         0   -2.5000    5.5000   -8.0000\n         0   16.2500    0.2500   -7.0000\n         0         0         0         0\n</pre></body></html>","content_type":"text/html"}}}],"key":"We2DLnWHfE"}],"key":"t623cdQQGz"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Observe that ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MKGGc0RA0f"},{"type":"inlineMath","value":"\\mathbf{A}_2","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">A</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8361em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"vgbE5XfFd5"},{"type":"text","value":" has a new zero row and zero column, but the zero row is the fourth rather than the first. However, we forge on by using the largest possible pivot in column 2 for the next outer product.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OIOtKiQ2mW"}],"key":"aHIK8TWEV0"}],"key":"fP6hAv5foX"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"[~, i] = max( abs(A_2(:, 2)) )\nU(2, :) = A_2(i, :);\nL(:, 2) = A_2(:, 2) / U(2, 2);\nA_3 = A_2 - L(:, 2) * U(2, :)","key":"nQgaED3KDJ"},{"type":"output","id":"m_urPr2xZOKARk46c9h-T","data":[{"output_type":"execute_result","execution_count":5,"metadata":{},"data":{"text/plain":{"content":"i = 3","content_type":"text/plain"},"text/html":{"content":"<html><body><pre>i = 3</pre></body></html>","content_type":"text/html"}}},{"output_type":"execute_result","execution_count":5,"metadata":{},"data":{"text/plain":{"content":"A_3 = 4×4 double\n         0         0    0.4615   -0.9231\n         0         0    5.5385   -9.0769\n         0         0         0         0\n         0         0         0         0\n","content_type":"text/plain"},"text/html":{"content":"<html><body><pre>A_3 = 4×4 double\n         0         0    0.4615   -0.9231\n         0         0    5.5385   -9.0769\n         0         0         0         0\n         0         0         0         0\n</pre></body></html>","content_type":"text/html"}}}],"key":"n79xL4UY5s"}],"key":"PCLdXnQI4h"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now we have zeroed out the third row as well as the second column. We can finish out the procedure.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Ts0j36p8TH"}],"key":"tylE7IO4HS"}],"key":"K1BIed6Gov"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"[~, i] = max( abs(A_3(:, 3)) ) \nU(3, :) = A_3(i, :);\nL(:, 3) = A_3(:, 3) / U(3, 3);\nA_4 = A_3 - L(:, 3) * U(3, :)","key":"fQdAg8SzWJ"},{"type":"output","id":"wLMHy-hmHUjeBdywBhWZO","data":[{"output_type":"execute_result","execution_count":6,"metadata":{},"data":{"text/plain":{"content":"i = 2","content_type":"text/plain"},"text/html":{"content":"<html><body><pre>i = 2</pre></body></html>","content_type":"text/html"}}},{"output_type":"execute_result","execution_count":6,"metadata":{},"data":{"text/plain":{"content":"A_4 = 4×4 double\n         0         0         0   -0.1667\n         0         0         0         0\n         0         0         0         0\n         0         0         0         0\n","content_type":"text/plain"},"text/html":{"content":"<html><body><pre>A_4 = 4×4 double\n         0         0         0   -0.1667\n         0         0         0         0\n         0         0         0         0\n         0         0         0         0\n</pre></body></html>","content_type":"text/html"}}}],"key":"vi5aigcbXD"}],"key":"R8E2YiTVU9"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"[~, i] = max( abs(A_4(:, 4)) ) \nU(4, :) = A_4(i, :);\nL(:, 4) = A_4(:, 4) / U(4, 4);","key":"TGhijHJst2"},{"type":"output","id":"eQUV-oz-4wuyYc_DfnPHk","data":[{"output_type":"execute_result","execution_count":7,"metadata":{},"data":{"text/plain":{"content":"i = 1","content_type":"text/plain"},"text/html":{"content":"<html><body><pre>i = 1</pre></body></html>","content_type":"text/html"}}}],"key":"oZ8G3OtWTx"}],"key":"OkUbpOYzcS"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We do have a factorization of the original matrix:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Cuz1SnnXft"}],"key":"ggplhpRqGb"}],"key":"bPKZWqmIeg"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"A_1 - L * U","key":"vIbFemyRTq"},{"type":"output","id":"CNKP1RveaJqkEYjF72qmE","data":[{"output_type":"execute_result","execution_count":8,"metadata":{},"data":{"text/plain":{"content":"ans = 4×4 double\n     0     0     0     0\n     0     0     0     0\n     0     0     0     0\n     0     0     0     0\n","content_type":"text/plain"},"text/html":{"content":"<html><body><pre>ans = 4×4 double\n     0     0     0     0\n     0     0     0     0\n     0     0     0     0\n     0     0     0     0\n</pre></body></html>","content_type":"text/html"}}}],"key":"VYI8fU5yrD"}],"key":"IIoHlLhG8A"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"And ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Yia3mHkVDh"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"Pe37eRnwnA"},{"type":"text","value":" has the required structure:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KJ3rpWlfKX"}],"key":"LCvYr1sNfH"}],"key":"tc082aaJ0J"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"U","key":"oJ8wwclAlD"},{"type":"output","id":"a9jVW_2tqlYbjNJi43iOO","data":[{"output_type":"execute_result","execution_count":9,"metadata":{},"data":{"text/plain":{"content":"U = 4×4 double\n   -4.0000    5.0000   -7.0000  -10.0000\n         0   16.2500    0.2500   -7.0000\n         0         0    5.5385   -9.0769\n         0         0         0   -0.1667\n","content_type":"text/plain"},"text/html":{"content":"<html><body><pre>U = 4×4 double\n   -4.0000    5.0000   -7.0000  -10.0000\n         0   16.2500    0.2500   -7.0000\n         0         0    5.5385   -9.0769\n         0         0         0   -0.1667\n</pre></body></html>","content_type":"text/html"}}}],"key":"ZAVKTpKAeY"}],"key":"afw3UcsGhc"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"However, the triangularity of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"QW49yatdc4"},{"type":"inlineMath","value":"\\mathbf{L}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">L</span></span></span></span>","key":"K73mT4F74O"},{"type":"text","value":" has been broken.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cVJ0ePw9TW"}],"key":"LTsnINjQIk"}],"key":"OunTtnVsvU"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"L","key":"xNg502zVIz"},{"type":"output","id":"sEGN1E_rkww4tz7bphzy6","data":[{"output_type":"execute_result","execution_count":10,"metadata":{},"data":{"text/plain":{"content":"L = 4×4 double\n   -0.5000    0.1538    0.0833    1.0000\n    0.5000   -0.1538    1.0000         0\n   -0.2500    1.0000         0         0\n    1.0000         0         0         0\n","content_type":"text/plain"},"text/html":{"content":"<html><body><pre>L = 4×4 double\n   -0.5000    0.1538    0.0833    1.0000\n    0.5000   -0.1538    1.0000         0\n   -0.2500    1.0000         0         0\n    1.0000         0         0         0\n</pre></body></html>","content_type":"text/html"}}}],"key":"kFFBJtaqGD"}],"key":"C4O26yivo5"}],"key":"BHaw6EPt1d"}],"key":"nrJ4DXs5MW"}],"key":"xB6Zu5Pt9e"},{"type":"tabItem","title":"Python","sync":"python","children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Row pivoting in LU factorization","position":{"start":{"line":83,"column":1},"end":{"line":83,"column":1}},"key":"GXvPwR7sYm"}],"key":"FWP2IfZPrb"},{"type":"include","file":"python/fix.ipynb","children":[{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:43:41.283307Z","iopub.status.busy":"2025-01-11T17:43:41.283182Z","iopub.status.idle":"2025-01-11T17:43:41.622058Z","shell.execute_reply":"2025-01-11T17:43:41.621657Z"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"exec(open(\"../../../python/FNC_init.py\").read())","visibility":"show","key":"fnM59fA4k1"},{"type":"output","id":"sBhbOID3UBU0iqhnNzn8t","data":[],"visibility":"show","key":"s7SydmM12a"}],"visibility":"remove","key":"J8ZGZSuMrf"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"HDblDydDok"},{"type":"text","value":"2.6.2","key":"wtwAy0vZ6W"}],"key":"qtUocUV3oT"}],"identifier":"demo-pivoting-fix","label":"demo-pivoting-fix","kind":"proof:example","template":"Example %s","enumerator":"2.6.2","resolved":true,"html_id":"demo-pivoting-fix","key":"UldwCV6o9u"}],"key":"qu3IzTXkaI"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Here is the trouble-making matrix from ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"arhMnIwjeV"},{"type":"crossReference","kind":"proof:example","identifier":"demo-pivoting-fail","label":"demo-pivoting-fail","children":[{"type":"text","value":"Demo ","key":"OmWvoFrKdr"},{"type":"text","value":"2.6.1","key":"q76IhdFFVY"}],"template":"Example %s","enumerator":"2.6.1","resolved":true,"html_id":"demo-pivoting-fail","key":"YC2oi5Uddo"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"buK3TN8Ssg"}],"key":"VOB5r3HiXM"}],"key":"OHPDpYoIRh"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:43:41.624016Z","iopub.status.busy":"2025-01-11T17:43:41.623713Z","iopub.status.idle":"2025-01-11T17:43:41.625707Z","shell.execute_reply":"2025-01-11T17:43:41.625497Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"A_1 = array([\n    [2, 0, 4, 3],\n    [-2, 0, 2, -13],\n    [1, 15, 2, -4.5],\n    [-4, 5, -7, -10]\n    ])","key":"Ryrqyyhe49"},{"type":"output","id":"2ok1H8v4jyRkFFKUkfeDA","data":[],"key":"fxrbytMZx6"}],"key":"U8lJkFtbMx"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We now find the largest candidate pivot in the first column. We don’t care about sign, so we take absolute values before finding the max.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"uQXsDZXOJW"}],"key":"qhgFRHLG6Z"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"BRxKvHGi1E"}],"key":"bGoEKr8pBe"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"V2W7O36taA"},{"type":"inlineCode","value":"argmax","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"BlR9h4gUEe"},{"type":"text","value":" function returns the location of the largest element of a vector or matrix.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"ig32v9m2os"}],"key":"EimcJuU9oO"}],"class":"dropdown","key":"T5ZzNsNXWP"}],"key":"sYNXLBhk0B"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:43:41.626845Z","iopub.status.busy":"2025-01-11T17:43:41.626746Z","iopub.status.idle":"2025-01-11T17:43:41.628569Z","shell.execute_reply":"2025-01-11T17:43:41.628339Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"i = argmax( abs(A_1[:, 0]) )\nprint(i)","key":"wHhqK9MYXw"},{"type":"output","id":"WAnAPmkEovkhWubyJy_CX","data":[{"name":"stdout","output_type":"stream","text":"3\n"}],"key":"UQYHCUkNQl"}],"key":"qDZ3a79seV"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"This is the row of the matrix that we extract to put into ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wgRt9sOUgs"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"dILp9zKHmq"},{"type":"text","value":". That guarantees that the division used to find ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XkGdXwfG0i"},{"type":"inlineMath","value":"\\boldsymbol{\\ell}_1","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">ℓ</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\boldsymbol{\\ell}_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">ℓ</span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"K7EVoLdEIy"},{"type":"text","value":" will be valid.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TwkXiz7eSq"}],"key":"uXoVGsxH2u"}],"key":"eBc3OvI8y5"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:43:41.629797Z","iopub.status.busy":"2025-01-11T17:43:41.629717Z","iopub.status.idle":"2025-01-11T17:43:41.631990Z","shell.execute_reply":"2025-01-11T17:43:41.631750Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"L, U = eye(4), zeros((4, 4))\nU[0, :] = A_1[i, :]\nL[:, 0] = A_1[:, 0] / U[0, 0]\nA_2 = A_1 - outer(L[:, 0], U[0, :])\nprint(A_2)","key":"N5y0CozxO2"},{"type":"output","id":"xTLiJeGh6lv6S4DHO8T9p","data":[{"name":"stdout","output_type":"stream","text":"[[ 0.    2.5   0.5  -2.  ]\n [ 0.   -2.5   5.5  -8.  ]\n [ 0.   16.25  0.25 -7.  ]\n [ 0.    0.    0.    0.  ]]\n"}],"key":"pfNrCaUemN"}],"key":"i1Aubt65ed"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Observe that ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"eQBWKquJFM"},{"type":"inlineMath","value":"\\mathbf{A}_2","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">A</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8361em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"lbSKziOcnn"},{"type":"text","value":" has a new zero row and zero column, but the zero row is the fourth rather than the first. However, we forge on by using the largest possible pivot in column 2 for the next outer product.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"fStL7ePKgw"}],"key":"FNl86ejZxw"}],"key":"WWEoFUPbVA"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:43:41.633203Z","iopub.status.busy":"2025-01-11T17:43:41.633111Z","iopub.status.idle":"2025-01-11T17:43:41.635362Z","shell.execute_reply":"2025-01-11T17:43:41.635089Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"i = argmax( abs(A_2[:, 1]) ) \nprint(f\"new pivot row is {i}\")\nU[1, :] = A_2[i, :]\nL[:, 1] = A_2[:, 1] / U[1, 1]\nA_3 = A_2 - outer(L[:, 1], U[1, :])\nprint(A_3)","key":"Iyee8XFqPS"},{"type":"output","id":"D9YnLEYxhYVSGqapY-wX0","data":[{"name":"stdout","output_type":"stream","text":"new pivot row is 2\n[[ 0.          0.          0.46153846 -0.92307692]\n [ 0.          0.          5.53846154 -9.07692308]\n [ 0.          0.          0.          0.        ]\n [ 0.          0.          0.          0.        ]]\n"}],"key":"OpHVKVl4Tn"}],"key":"nDMrKdfvGA"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now we have zeroed out the third row as well as the second column. We can finish out the procedure.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"AD3aeUirfI"}],"key":"p7QXXW1Mvz"}],"key":"Fy8v2SiYEY"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:43:41.636463Z","iopub.status.busy":"2025-01-11T17:43:41.636368Z","iopub.status.idle":"2025-01-11T17:43:41.638488Z","shell.execute_reply":"2025-01-11T17:43:41.638224Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"i = argmax( abs(A_3[:, 2]) ) \nprint(f\"new pivot row is {i}\")\nU[2, :] = A_3[i, :]\nL[:, 2] = A_3[:, 2] / U[2, 2]\nA_4 = A_3 - outer(L[:, 2], U[2, :])\nprint(A_4)","key":"gLG67AZzFg"},{"type":"output","id":"mQJJYgcotbKrwZS0efXzQ","data":[{"name":"stdout","output_type":"stream","text":"new pivot row is 1\n[[ 0.          0.          0.         -0.16666667]\n [ 0.          0.          0.          0.        ]\n [ 0.          0.          0.          0.        ]\n [ 0.          0.          0.          0.        ]]\n"}],"key":"a3jydpjf1Z"}],"key":"aJHqKVow8z"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:43:41.640055Z","iopub.status.busy":"2025-01-11T17:43:41.639921Z","iopub.status.idle":"2025-01-11T17:43:41.641839Z","shell.execute_reply":"2025-01-11T17:43:41.641604Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"i = argmax( abs(A_4[:, 3]) ) \nprint(f\"new pivot row is {i}\")\nU[3, :] = A_4[i, :]\nL[:, 3] = A_4[:, 3] / U[3, 3];","key":"QnwDXuYEfL"},{"type":"output","id":"-XVoXw-IDBAHdy0ObJ8ZY","data":[{"name":"stdout","output_type":"stream","text":"new pivot row is 0\n"}],"key":"DsYQApKVDf"}],"key":"I2mIKkYuLV"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We do have a factorization of the original matrix:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DJCv9w1SC6"}],"key":"MRfvnjQ9Rh"}],"key":"zkIY9CPBzN"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:43:41.643036Z","iopub.status.busy":"2025-01-11T17:43:41.642935Z","iopub.status.idle":"2025-01-11T17:43:41.645923Z","shell.execute_reply":"2025-01-11T17:43:41.645690Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"A_1 - L @ U","key":"TcEMCyECeW"},{"type":"output","id":"m4rlIjNtRe_ym3U8A_mkK","data":[{"output_type":"execute_result","execution_count":8,"metadata":{},"data":{"text/plain":{"content":"array([[0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00],\n       [0.00000000e+00, 0.00000000e+00, 2.22044605e-16, 0.00000000e+00],\n       [0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00],\n       [0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00]])","content_type":"text/plain"}}}],"key":"aZVhXdLzfL"}],"key":"i2jxuqTkWK"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"And ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Gt2ahLN1SV"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"FPwQLKkgfd"},{"type":"text","value":" has the required structure:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TYS4OrfEBS"}],"key":"dOPYpdKHau"}],"key":"hkcSYlrqiO"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:43:41.647049Z","iopub.status.busy":"2025-01-11T17:43:41.646962Z","iopub.status.idle":"2025-01-11T17:43:41.648864Z","shell.execute_reply":"2025-01-11T17:43:41.648638Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"print(U)","key":"sqD8DVQjgn"},{"type":"output","id":"q_m-DFD4ZDcXNtnlbwMbi","data":[{"name":"stdout","output_type":"stream","text":"[[ -4.           5.          -7.         -10.        ]\n [  0.          16.25         0.25        -7.        ]\n [  0.           0.           5.53846154  -9.07692308]\n [  0.           0.           0.          -0.16666667]]\n"}],"key":"GniTPhRnHt"}],"key":"dRFKVLUyDc"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"However, the triangularity of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xNVPZArr9Q"},{"type":"inlineMath","value":"\\mathbf{L}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">L</span></span></span></span>","key":"UGoQmra4Ov"},{"type":"text","value":" has been broken.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OwJIl8l0kF"}],"key":"uUF84qXgtb"}],"key":"KdR6aMTvf8"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:43:41.649921Z","iopub.status.busy":"2025-01-11T17:43:41.649850Z","iopub.status.idle":"2025-01-11T17:43:41.651628Z","shell.execute_reply":"2025-01-11T17:43:41.651406Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"print(L)","key":"RR8N5VYc87"},{"type":"output","id":"JypG-i5b6TtEZlTDvyh7q","data":[{"name":"stdout","output_type":"stream","text":"[[-0.5         0.15384615  0.08333333  1.        ]\n [ 0.5        -0.15384615  1.         -0.        ]\n [-0.25        1.          0.         -0.        ]\n [ 1.          0.          0.         -0.        ]]\n"}],"key":"Z92Q7oiVHo"}],"key":"s439mcXbIy"}],"key":"pFwkzKzAqY"}],"key":"TSIsGqqMAQ"}],"key":"jUUaTek3je"}],"key":"CEuLGVYiY7"}],"label":"demo-pivoting-fix","identifier":"demo-pivoting-fix","html_id":"demo-pivoting-fix","enumerator":"2.6.2","key":"GZmqMolqRB"},{"type":"paragraph","position":{"start":{"line":93,"column":1},"end":{"line":93,"column":1}},"children":[{"type":"text","value":"We will return to the loss of triangularity in ","position":{"start":{"line":93,"column":1},"end":{"line":93,"column":1}},"key":"b4Mzdt8Tfx"},{"type":"inlineMath","value":"\\mathbf{L}","position":{"start":{"line":93,"column":1},"end":{"line":93,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">L</span></span></span></span>","key":"J2SJZLHuJK"},{"type":"text","value":" momentarily. First, though, there is a question left to answer: what if at some stage, all the elements of the targeted column are zero, i.e., there are no available pivots? Fortunately that loose end ties up nicely, although a proof is a bit beyond our scope here.","position":{"start":{"line":93,"column":1},"end":{"line":93,"column":1}},"key":"q6OXREQW1g"}],"key":"FwP6Jnuxi9"},{"type":"proof","kind":"theorem","enumerated":true,"children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Row pivoting","position":{"start":{"line":96,"column":1},"end":{"line":96,"column":1}},"key":"aGGktmr08d"}],"key":"vcpEdFp3sf"},{"type":"paragraph","position":{"start":{"line":97,"column":1},"end":{"line":97,"column":1}},"children":[{"type":"text","value":"The row-pivoted LU factorization runs to completion if and only if the original matrix is invertible.","position":{"start":{"line":97,"column":1},"end":{"line":97,"column":1}},"key":"q4W9Xnp1QS"}],"key":"VXynEbzRxX"}],"label":"theorem-pivot","identifier":"theorem-pivot","html_id":"theorem-pivot","enumerator":"2.6.1","key":"repr6A0SsE"},{"type":"paragraph","position":{"start":{"line":100,"column":1},"end":{"line":100,"column":1}},"children":[{"type":"text","value":"A linear system with a singular matrix has either no solution or infinitely many solutions. Either way, a technique other than LU factorization is needed to handle it.","position":{"start":{"line":100,"column":1},"end":{"line":100,"column":1}},"key":"xS8eyPPitN"}],"key":"iA9S10Ff1N"},{"type":"heading","depth":2,"position":{"start":{"line":102,"column":1},"end":{"line":102,"column":1}},"children":[{"type":"text","value":"Permutations","position":{"start":{"line":102,"column":1},"end":{"line":102,"column":1}},"key":"Ool4TEgQJH"}],"identifier":"permutations","label":"Permutations","html_id":"permutations","implicit":true,"enumerator":"2.6.2","key":"VxV1jOqCq5"},{"type":"paragraph","position":{"start":{"line":104,"column":1},"end":{"line":104,"column":1}},"children":[{"type":"text","value":"Even though the resulting ","position":{"start":{"line":104,"column":1},"end":{"line":104,"column":1}},"key":"LHUxZPXHKS"},{"type":"inlineMath","value":"\\mathbf{L}","position":{"start":{"line":104,"column":1},"end":{"line":104,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">L</span></span></span></span>","key":"hwnGGIrvTB"},{"type":"text","value":" in ","position":{"start":{"line":104,"column":1},"end":{"line":104,"column":1}},"key":"VgcS75uBgs"},{"type":"crossReference","kind":"proof:example","identifier":"demo-pivoting-fix","label":"demo-pivoting-fix","children":[{"type":"text","value":"Demo ","key":"jGzJ5hGZbY"},{"type":"text","value":"2.6.2","key":"b8gF8av298"}],"template":"Example %s","enumerator":"2.6.2","resolved":true,"html_id":"demo-pivoting-fix","key":"cAkgAA9ISf"},{"type":"text","value":" is no longer of unit lower triangular form, it is close. In fact, all that is needed is to reverse the order of its rows.","position":{"start":{"line":104,"column":1},"end":{"line":104,"column":1}},"key":"MfsokRfHwb"}],"key":"Xki75tnmuH"},{"type":"proof","kind":"example","enumerated":true,"children":[{"type":"tabSet","children":[{"type":"tabItem","title":"Julia","sync":"julia","children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Pivoting as row permutation","position":{"start":{"line":111,"column":1},"end":{"line":111,"column":1}},"key":"DIJpbeIjap"}],"key":"ETuykBTO7X"},{"type":"include","file":"julia/permute.ipynb","children":[{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-05T09:33:51.318000Z","iopub.status.busy":"2025-01-05T09:33:51.033000Z","iopub.status.idle":"2025-01-05T09:33:58.371000Z","shell.execute_reply":"2025-01-05T09:33:58.327000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"include(\"../../../julia/FNC_init.jl\")","key":"YDcYnu5YM0"},{"type":"output","id":"EuPMFefjsVEfkBviM9QLQ","data":[{"name":"stderr","output_type":"stream","text":"\u001b[32m\u001b[1m  Activating\u001b[22m\u001b[39m "},{"name":"stderr","output_type":"stream","text":"project at `~/Documents/GitHub/fnc`\n"}],"key":"Jjq6pS3vLP"}],"key":"RnWSMSbMhf"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"P7bvPMmCce"},{"type":"text","value":"2.6.3","key":"byEJ06V0lV"}],"key":"Ur6lcGkKDj"}],"identifier":"demo-pivoting-permute","label":"demo-pivoting-permute","kind":"proof:example","template":"Example %s","enumerator":"2.6.3","resolved":true,"html_id":"demo-pivoting-permute","key":"pHoifyMTgu"}],"key":"KRr695ykmY"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Here again is the matrix from ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"OUCO2Ug5wp"},{"type":"crossReference","kind":"proof:example","identifier":"demo-pivoting-fix","label":"demo-pivoting-fix","children":[{"type":"text","value":"Demo ","key":"XiLeNm2YEo"},{"type":"text","value":"2.6.2","key":"WLNANwLIba"}],"template":"Example %s","enumerator":"2.6.2","resolved":true,"html_id":"demo-pivoting-fix","key":"w0M6pgvrAE"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"eJc4iXRKum"}],"key":"hnVM4tyGja"}],"key":"kX8iKkjO9c"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-05T09:33:58.512000Z","iopub.status.busy":"2025-01-05T09:33:58.373000Z","iopub.status.idle":"2025-01-05T09:34:00.000000Z","shell.execute_reply":"2025-01-05T09:34:00.000000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"A = [2 0 4 3 ; -2 0 2 -13; 1 15 2 -4.5 ; -4 5 -7 -10]","key":"XyGsVl6ZXD"},{"type":"output","id":"ngoOeBafnQPtIx14lvH5Q","data":[{"output_type":"execute_result","execution_count":2,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n  2.0   0.0   4.0    3.0\n -2.0   0.0   2.0  -13.0\n  1.0  15.0   2.0   -4.5\n -4.0   5.0  -7.0  -10.0","content_type":"text/plain"}}}],"key":"iDyHM1rkUQ"}],"key":"szP1p1eIFF"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"As the factorization proceeded, the pivots were selected from rows 4, 3, 2, and finally 1. If we were to put the rows of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kFMMnWDOhf"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"d5BMaKJvne"},{"type":"text","value":" into that order, then the algorithm would run exactly like the plain LU factorization from ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"fRiIn4Ndgr"},{"type":"link","kind":"numref","identifier":"section-linsys-lu","label":"section-linsys-lu","url":"/lu","internal":true,"dataUrl":"/lu.json","children":[{"type":"text","value":"LU factorization","key":"f9rY6dDN4O"}],"key":"G4ErFXdK35"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zTC2TjDYc6"}],"key":"iMh0wFc6Ba"}],"key":"hSVZkIgUi7"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-05T09:34:00.002000Z","iopub.status.busy":"2025-01-05T09:34:00.002000Z","iopub.status.idle":"2025-01-05T09:34:00.093000Z","shell.execute_reply":"2025-01-05T09:34:00.093000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"B = A[[4, 3, 2, 1], :]\nL, U = FNC.lufact(B);","key":"PAQAG5gKNc"},{"type":"output","id":"veTofHkLnwiGY0XWXBT5P","data":[],"key":"v3Tu7HKrRd"}],"key":"Nd9RGe6aQV"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We obtain the same ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"S6NChAsOuV"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"scHrbUC55D"},{"type":"text","value":" as before:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"SUQPDU0nPV"}],"key":"uWOZjk7aqt"}],"key":"iJfK25eTJr"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-05T09:34:00.095000Z","iopub.status.busy":"2025-01-05T09:34:00.095000Z","iopub.status.idle":"2025-01-05T09:34:00.267000Z","shell.execute_reply":"2025-01-05T09:34:00.263000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"U","key":"Qi9DWOYAzH"},{"type":"output","id":"gBOsOtP5Ivmi0rhljZnlH","data":[{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"text/plain":{"content":"4×4 UpperTriangular{Float64, Matrix{Float64}}:\n -4.0   5.0   -7.0      -10.0\n   ⋅   16.25   0.25      -7.0\n   ⋅     ⋅     5.53846   -9.07692\n   ⋅     ⋅      ⋅        -0.166667","content_type":"text/plain"}}}],"key":"HmRWWpB163"}],"key":"Popxh0XLZ5"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"And ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"BKEjzXJluB"},{"type":"inlineMath","value":"\\mathbf{L}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">L</span></span></span></span>","key":"yJH8kqIWmy"},{"type":"text","value":" has the same rows as before, but arranged into triangular order:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LWxqmBaoWS"}],"key":"EhOmiLACG5"}],"key":"dvvFUQjhPS"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-05T09:34:00.269000Z","iopub.status.busy":"2025-01-05T09:34:00.269000Z","iopub.status.idle":"2025-01-05T09:34:00.423000Z","shell.execute_reply":"2025-01-05T09:34:00.423000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"L","key":"yeg3xtwyfu"},{"type":"output","id":"Ubjac7DnGGgQu-YGqbaA5","data":[{"output_type":"execute_result","execution_count":5,"metadata":{},"data":{"text/plain":{"content":"4×4 LowerTriangular{Float64, Matrix{Float64}}:\n  1.0     ⋅         ⋅          ⋅ \n -0.25   1.0        ⋅          ⋅ \n  0.5   -0.153846  1.0         ⋅ \n -0.5    0.153846  0.0833333  1.0","content_type":"text/plain"}}}],"key":"Vl4pr6Lt7B"}],"key":"RCwKMxjwBm"}],"key":"GZWgqv0O3Y"}],"key":"PG151kHYLn"}],"key":"Wquug7WJlQ"},{"type":"tabItem","title":"MATLAB","sync":"matlab","children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Pivoting as row permutation","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"key":"ma0VgWdeKQ"}],"key":"gbn0YInV1R"},{"type":"include","file":"matlab/permute.ipynb","children":[{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"l3Sl3EyDHf"},{"type":"text","value":"2.6.3","key":"VLMXB0LSKJ"}],"key":"YtmUd2jNp7"}],"identifier":"demo-pivoting-permute","label":"demo-pivoting-permute","kind":"proof:example","template":"Example %s","enumerator":"2.6.3","resolved":true,"html_id":"demo-pivoting-permute","key":"XMLI6AtvPl"}],"key":"NKZOuuFUh1"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Here again is the matrix from ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"oiWN4VfG6X"},{"type":"crossReference","kind":"proof:example","identifier":"demo-pivoting-fix","label":"demo-pivoting-fix","children":[{"type":"text","value":"Demo ","key":"s9eoALBqoP"},{"type":"text","value":"2.6.2","key":"TOglNuT7nt"}],"template":"Example %s","enumerator":"2.6.2","resolved":true,"html_id":"demo-pivoting-fix","key":"nijWjSnhhg"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"t8jhoKRExd"}],"key":"HwwmlJbYLx"}],"key":"lMdD2oTNco"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"A = [2 0 4 3; -2 0 2 -13; 1 15 2 -4.5; -4 5 -7 -10]","key":"X37ZNpvHMo"},{"type":"output","id":"8js43ljVvNUzMn8G2uYox","data":[{"output_type":"execute_result","execution_count":2,"metadata":{},"data":{"text/plain":{"content":"A = 4×4 double\n    2.0000         0    4.0000    3.0000\n   -2.0000         0    2.0000  -13.0000\n    1.0000   15.0000    2.0000   -4.5000\n   -4.0000    5.0000   -7.0000  -10.0000\n","content_type":"text/plain"},"text/html":{"content":"<html><body><pre>A = 4×4 double\n    2.0000         0    4.0000    3.0000\n   -2.0000         0    2.0000  -13.0000\n    1.0000   15.0000    2.0000   -4.5000\n   -4.0000    5.0000   -7.0000  -10.0000\n</pre></body></html>","content_type":"text/html"}}}],"key":"RpP3NEbqbG"}],"key":"sLeJBzzlfo"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"As the factorization proceeded, the pivots were selected from rows 4, 3, 2, and finally 1. If we were to put the rows of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"BdA4DKzZm2"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"aLvdg0MMzE"},{"type":"text","value":" into that order, then the algorithm would run exactly like the plain LU factorization from ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"sprHOoMCst"},{"type":"link","kind":"numref","identifier":"section-linsys-lu","label":"section-linsys-lu","url":"/lu","internal":true,"dataUrl":"/lu.json","children":[{"type":"text","value":"LU factorization","key":"jLb8D2ORuO"}],"key":"SRiHerMK1s"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"oBhkUplbPh"}],"key":"hbDw1h6qUP"}],"key":"Z2NW8ntAyY"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"B = A([4, 3, 2, 1], :);\n[L, U] = lufact(B);","key":"rxnlDkTiBW"},{"type":"output","id":"1YZRefSGBhlg9hEwlFY_r","data":[],"key":"D3c7RMLnz6"}],"key":"zviI7vUeKL"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We obtain the same ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"sawOZrOHSJ"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"yev7axfUlj"},{"type":"text","value":" as before:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"FWk4nPwiPi"}],"key":"Zg6cVXcsp6"}],"key":"yPtWwzX3bN"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"U","key":"Zn1PppMtLj"},{"type":"output","id":"Nji9GiGe9Km2Q1NYvKN-4","data":[{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"text/plain":{"content":"U = 4×4 double\n   -4.0000    5.0000   -7.0000  -10.0000\n         0   16.2500    0.2500   -7.0000\n         0         0    5.5385   -9.0769\n         0         0         0   -0.1667\n","content_type":"text/plain"},"text/html":{"content":"<html><body><pre>U = 4×4 double\n   -4.0000    5.0000   -7.0000  -10.0000\n         0   16.2500    0.2500   -7.0000\n         0         0    5.5385   -9.0769\n         0         0         0   -0.1667\n</pre></body></html>","content_type":"text/html"}}}],"key":"sJyrRHJvce"}],"key":"HwGzBfoNVa"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"And ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"M4v8bDdtUk"},{"type":"inlineMath","value":"\\mathbf{L}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">L</span></span></span></span>","key":"BT1aVywt1l"},{"type":"text","value":" has the same rows as before, but arranged into triangular order:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cRjpc0PptU"}],"key":"XuC3XZ3a2t"}],"key":"wGci3gqTQZ"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"L","key":"IkQUQ6snvu"},{"type":"output","id":"moJAL_jyHKx9P4BPpezoI","data":[{"output_type":"execute_result","execution_count":5,"metadata":{},"data":{"text/plain":{"content":"L = 4×4 double\n    1.0000         0         0         0\n   -0.2500    1.0000         0         0\n    0.5000   -0.1538    1.0000         0\n   -0.5000    0.1538    0.0833    1.0000\n","content_type":"text/plain"},"text/html":{"content":"<html><body><pre>L = 4×4 double\n    1.0000         0         0         0\n   -0.2500    1.0000         0         0\n    0.5000   -0.1538    1.0000         0\n   -0.5000    0.1538    0.0833    1.0000\n</pre></body></html>","content_type":"text/html"}}}],"key":"bkirWsWWAH"}],"key":"lNToZh1IsU"}],"key":"XgCHVZmmDb"}],"key":"O0JUc1Nps6"}],"key":"lvp1l7TmYC"},{"type":"tabItem","title":"Python","sync":"python","children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Pivoting as row permutation","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"key":"rLmQ5oa1k5"}],"key":"SaRrA3IYmb"},{"type":"include","file":"python/permute.ipynb","children":[{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:43:42.616599Z","iopub.status.busy":"2025-01-11T17:43:42.616135Z","iopub.status.idle":"2025-01-11T17:43:42.934508Z","shell.execute_reply":"2025-01-11T17:43:42.934144Z"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"exec(open(\"../../../python/FNC_init.py\").read())","visibility":"show","key":"LXMeEb2SAc"},{"type":"output","id":"zYLSWW6McpfR_Nhn-M7p9","data":[],"visibility":"show","key":"cQ00HyMJPN"}],"visibility":"remove","key":"REuqoFkUqM"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"wiI3Gd5FQT"},{"type":"text","value":"2.6.3","key":"LrPQvmiJQY"}],"key":"YOOtW17NwD"}],"identifier":"demo-pivoting-permute","label":"demo-pivoting-permute","kind":"proof:example","template":"Example %s","enumerator":"2.6.3","resolved":true,"html_id":"demo-pivoting-permute","key":"lfYcY2fjKp"}],"key":"tVJo67axrt"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Here again is the matrix from ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"CKpDgyRaet"},{"type":"crossReference","kind":"proof:example","identifier":"demo-pivoting-fix","label":"demo-pivoting-fix","children":[{"type":"text","value":"Demo ","key":"rwqE8edXe2"},{"type":"text","value":"2.6.2","key":"Jeh0vMDsJH"}],"template":"Example %s","enumerator":"2.6.2","resolved":true,"html_id":"demo-pivoting-fix","key":"U98tDQuFQA"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Rxv06inSlp"}],"key":"P5ajNInD0g"}],"key":"sHZaJMHUxT"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:43:42.936157Z","iopub.status.busy":"2025-01-11T17:43:42.936030Z","iopub.status.idle":"2025-01-11T17:43:42.937878Z","shell.execute_reply":"2025-01-11T17:43:42.937636Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"A = array([\n    [2, 0, 4, 3],\n    [-2, 0, 2, -13],\n    [1, 15, 2, -4.5],\n    [-4, 5, -7, -10]\n    ])","key":"DiD4GvLGdD"},{"type":"output","id":"YbQvFq4dtDLXVrSFdu-r8","data":[],"key":"tLt7akcNga"}],"key":"J0HwBLf5tp"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"As the factorization proceeded, the pivots were selected from rows 4, 3, 2, and finally 1 (with NumPy indices being one less). If we were to put the rows of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"fmnODoBDX5"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"d7r9L3o4IF"},{"type":"text","value":" into that order, then the algorithm would run exactly like the plain LU factorization from ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"BVmqJAQktk"},{"type":"link","kind":"numref","identifier":"section-linsys-lu","label":"section-linsys-lu","url":"/lu","internal":true,"dataUrl":"/lu.json","children":[{"type":"text","value":"LU factorization","key":"CJuhCeyC6v"}],"key":"URHJUOXNjW"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LiChr8y9lK"}],"key":"Yhm86Lrv0n"}],"key":"jbjGzxvIqG"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:43:42.939204Z","iopub.status.busy":"2025-01-11T17:43:42.939105Z","iopub.status.idle":"2025-01-11T17:43:42.940952Z","shell.execute_reply":"2025-01-11T17:43:42.940698Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"B = A[[3, 2, 1, 0], :]\nL, U = FNC.lufact(B);","key":"eki7YlrWGm"},{"type":"output","id":"Qd5WwCgRHqAdj24ivVOVR","data":[],"key":"knZno9JQ12"}],"key":"WwNqFoGAfl"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We obtain the same ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"N27prBkt47"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"lOR5OXMYZ7"},{"type":"text","value":" as before:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"aKXbCG4keA"}],"key":"mUj5E4ULs6"}],"key":"hnSc5y9Py1"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:43:42.942107Z","iopub.status.busy":"2025-01-11T17:43:42.941991Z","iopub.status.idle":"2025-01-11T17:43:42.943731Z","shell.execute_reply":"2025-01-11T17:43:42.943513Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"print(U)","key":"cBMp5WqPMr"},{"type":"output","id":"1r-Qo34AC5jh8rK4LYKpD","data":[{"name":"stdout","output_type":"stream","text":"[[ -4.           5.          -7.         -10.        ]\n [  0.          16.25         0.25        -7.        ]\n [  0.           0.           5.53846154  -9.07692308]\n [  0.           0.           0.          -0.16666667]]\n"}],"key":"PAmJVAxfg2"}],"key":"QLkQXGhOLm"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"And ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"l7HmiEo5f8"},{"type":"inlineMath","value":"\\mathbf{L}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">L</span></span></span></span>","key":"Np0KVBkTB2"},{"type":"text","value":" has the same rows as before, but arranged into triangular order:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LpWD6m1bC8"}],"key":"bkrHnBBA2h"}],"key":"ItGoPbMlHA"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:43:42.945206Z","iopub.status.busy":"2025-01-11T17:43:42.945118Z","iopub.status.idle":"2025-01-11T17:43:42.947009Z","shell.execute_reply":"2025-01-11T17:43:42.946769Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"print(L)","key":"vKh5eNTK2t"},{"type":"output","id":"ctmh9E2cjguRLEpNgNH4v","data":[{"name":"stdout","output_type":"stream","text":"[[ 1.          0.          0.          0.        ]\n [-0.25        1.          0.          0.        ]\n [ 0.5        -0.15384615  1.          0.        ]\n [-0.5         0.15384615  0.08333333  1.        ]]\n"}],"key":"TVvfTBirx8"}],"key":"wIyyREWnTA"}],"key":"JSlulJdcwe"}],"key":"K7YX8xDRmV"}],"key":"QmICF6ejkm"}],"key":"hc0zBIpnLp"}],"label":"demo-pivoting-permute","identifier":"demo-pivoting-permute","html_id":"demo-pivoting-permute","enumerator":"2.6.3","key":"GusW7fDzFl"},{"type":"paragraph","position":{"start":{"line":140,"column":1},"end":{"line":140,"column":1}},"children":[{"type":"text","value":"In principle, if the permutation of rows implied by the pivot locations is applied all at once to the original ","position":{"start":{"line":140,"column":1},"end":{"line":140,"column":1}},"key":"XZru3UA0KY"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":140,"column":1},"end":{"line":140,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"FLBS43nI7Z"},{"type":"text","value":", no further pivoting is needed. In practice, this permutation cannot be determined immediately from the original ","position":{"start":{"line":140,"column":1},"end":{"line":140,"column":1}},"key":"H5ZlFQoedA"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":140,"column":1},"end":{"line":140,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"E6iuqOWOL9"},{"type":"text","value":"; the only way to find it is to run the algorithm. Having obtained it at the end, though, we can use it to state a simple relationship.","position":{"start":{"line":140,"column":1},"end":{"line":140,"column":1}},"key":"l4jllejAph"}],"key":"Xx1o0hilY9"},{"type":"proof","kind":"definition","enumerated":true,"children":[{"type":"admonitionTitle","children":[{"type":"text","value":"PLU factorization","position":{"start":{"line":145,"column":1},"end":{"line":145,"column":1}},"key":"Df5OfxHDOi"}],"key":"QV2CcfC1GD"},{"type":"paragraph","position":{"start":{"line":146,"column":1},"end":{"line":146,"column":1}},"children":[{"type":"text","value":"Given ","position":{"start":{"line":146,"column":1},"end":{"line":146,"column":1}},"key":"WOVgLu98Jv"},{"type":"inlineMath","value":"n\\times n","position":{"start":{"line":146,"column":1},"end":{"line":146,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>×</mo><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n\\times n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"VpeKfsWPE1"},{"type":"text","value":" matrix ","position":{"start":{"line":146,"column":1},"end":{"line":146,"column":1}},"key":"tzHwU5tQC7"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":146,"column":1},"end":{"line":146,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"XRSRbjWSuv"},{"type":"text","value":", the ","position":{"start":{"line":146,"column":1},"end":{"line":146,"column":1}},"key":"Oq9g7F62AE"},{"type":"strong","position":{"start":{"line":146,"column":1},"end":{"line":146,"column":1}},"children":[{"type":"text","value":"PLU factorization","position":{"start":{"line":146,"column":1},"end":{"line":146,"column":1}},"key":"hmM8DWQYgq"}],"key":"z5AK2FnNkC"},{"type":"text","value":" is a unit lower triangular ","position":{"start":{"line":146,"column":1},"end":{"line":146,"column":1}},"key":"f2WSfeTn95"},{"type":"inlineMath","value":"\\mathbf{L}","position":{"start":{"line":146,"column":1},"end":{"line":146,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">L</span></span></span></span>","key":"ucK69GkueT"},{"type":"text","value":", an upper triangular ","position":{"start":{"line":146,"column":1},"end":{"line":146,"column":1}},"key":"EYOPxhSEcQ"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":146,"column":1},"end":{"line":146,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"bu35PA4guB"},{"type":"text","value":", and a permutation ","position":{"start":{"line":146,"column":1},"end":{"line":146,"column":1}},"key":"xYjY5ytW5o"},{"type":"inlineMath","value":"i_1,\\ldots,i_n","position":{"start":{"line":146,"column":1},"end":{"line":146,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>i</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><mo>…</mo><mo separator=\"true\">,</mo><msub><mi>i</mi><mi>n</mi></msub></mrow><annotation encoding=\"application/x-tex\">i_1,\\ldots,i_n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"yFsi9cyNdM"},{"type":"text","value":" of the integers ","position":{"start":{"line":146,"column":1},"end":{"line":146,"column":1}},"key":"LhuchJ7LN0"},{"type":"inlineMath","value":"1,\\ldots,n","position":{"start":{"line":146,"column":1},"end":{"line":146,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mo separator=\"true\">,</mo><mo>…</mo><mo separator=\"true\">,</mo><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">1,\\ldots,n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8389em;vertical-align:-0.1944em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"Pdd9QcYS1a"},{"type":"text","value":", such that","position":{"start":{"line":146,"column":1},"end":{"line":146,"column":1}},"key":"yKwaCw0YzF"}],"key":"phDqc024mk"},{"type":"math","value":"\\tilde{\\mathbf{A}} = \\mathbf{L}\\mathbf{U},","position":{"start":{"line":148,"column":1},"end":{"line":148,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mover accent=\"true\"><mi mathvariant=\"bold\">A</mi><mo>~</mo></mover><mo>=</mo><mi mathvariant=\"bold\">L</mi><mi mathvariant=\"bold\">U</mi><mo separator=\"true\">,</mo></mrow><annotation encoding=\"application/x-tex\">\\tilde{\\mathbf{A}} = \\mathbf{L}\\mathbf{U},</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.923em;\"></span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.923em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathbf\">A</span></span><span style=\"top:-3.6051em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.1111em;\"><span class=\"mord\">~</span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8805em;vertical-align:-0.1944em;\"></span><span class=\"mord mathbf\">LU</span><span class=\"mpunct\">,</span></span></span></span></span>","enumerator":"2.6.1","key":"Z52mJYYGAE"},{"type":"paragraph","position":{"start":{"line":150,"column":1},"end":{"line":150,"column":1}},"children":[{"type":"text","value":"where rows ","position":{"start":{"line":150,"column":1},"end":{"line":150,"column":1}},"key":"ve3s8bu9SE"},{"type":"inlineMath","value":"1,\\ldots,n","position":{"start":{"line":150,"column":1},"end":{"line":150,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mo separator=\"true\">,</mo><mo>…</mo><mo separator=\"true\">,</mo><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">1,\\ldots,n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8389em;vertical-align:-0.1944em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"A3Xh1VqdqG"},{"type":"text","value":" of ","position":{"start":{"line":150,"column":1},"end":{"line":150,"column":1}},"key":"ivhOr5gYvP"},{"type":"inlineMath","value":"\\tilde{\\mathbf{A}}","position":{"start":{"line":150,"column":1},"end":{"line":150,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mover accent=\"true\"><mi mathvariant=\"bold\">A</mi><mo>~</mo></mover></mrow><annotation encoding=\"application/x-tex\">\\tilde{\\mathbf{A}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.923em;\"></span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.923em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathbf\">A</span></span><span style=\"top:-3.6051em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.1111em;\"><span class=\"mord\">~</span></span></span></span></span></span></span></span></span></span>","key":"gRhyTt6lLy"},{"type":"text","value":" are rows ","position":{"start":{"line":150,"column":1},"end":{"line":150,"column":1}},"key":"zdZ5KZ3MVx"},{"type":"inlineMath","value":"i_1,\\ldots,i_n","position":{"start":{"line":150,"column":1},"end":{"line":150,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>i</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><mo>…</mo><mo separator=\"true\">,</mo><msub><mi>i</mi><mi>n</mi></msub></mrow><annotation encoding=\"application/x-tex\">i_1,\\ldots,i_n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"pPSvUeukvn"},{"type":"text","value":" of ","position":{"start":{"line":150,"column":1},"end":{"line":150,"column":1}},"key":"iZpclIqIRH"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":150,"column":1},"end":{"line":150,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"f9zHo4qW3B"},{"type":"text","value":".","position":{"start":{"line":150,"column":1},"end":{"line":150,"column":1}},"key":"NLeTCGZWJv"}],"key":"vh4RFOQMgn"}],"indexEntries":[{"entry":"matrix factorization","subEntry":{"value":"pivoted LU","kind":"entry"},"emphasis":true},{"entry":"PLU factorization","emphasis":true}],"label":"index-QzPUhMBUO4","identifier":"index-qzpuhmbuo4","html_id":"index-qzpuhmbuo4","enumerator":"2.6.1","key":"V3ZDLojJFO"},{"type":"paragraph","position":{"start":{"line":153,"column":1},"end":{"line":153,"column":1}},"children":[{"type":"crossReference","kind":"proof:algorithm","identifier":"function-plufact","label":"function-plufact","children":[{"type":"text","value":"Function ","key":"H4Yhir2DX5"},{"type":"text","value":"2.6.2","key":"XXsnwwrw7M"}],"template":"Algorithm %s","enumerator":"2.6.2","resolved":true,"html_id":"function-plufact","key":"Ow9qaPFJKJ"},{"type":"text","value":" shows our implementation of PLU factorization.","position":{"start":{"line":153,"column":1},"end":{"line":153,"column":1}},"key":"FhY2Ei4jFw"},{"type":"footnoteReference","identifier":"plu","label":"PLU","position":{"start":{"line":153,"column":1},"end":{"line":153,"column":1}},"number":1,"enumerator":"1","key":"Bg7nIvfR7r"}],"key":"QPHXf0HQwG"},{"type":"proof","kind":"algorithm","enumerated":true,"children":[{"type":"admonitionTitle","children":[{"type":"text","value":"plufact","position":{"start":{"line":158,"column":1},"end":{"line":158,"column":1}},"key":"VPdWi32VCT"}],"key":"jVtea9P9iS"},{"type":"tabSet","children":[{"type":"tabItem","title":"Julia","sync":"julia","children":[{"type":"embed","source":{"label":"function-plufact-julia"},"key":"YiFuWpWscv"}],"key":"vSt3KYdfGh"},{"type":"tabItem","title":"MATLAB","sync":"matlab","children":[{"type":"embed","source":{"label":"function-plufact-julia"},"key":"tqDyfYqmYz"}],"key":"mKKzoCGrZj"},{"type":"tabItem","title":"Python","sync":"python","children":[{"type":"embed","source":{"label":"function-plufact-python"},"key":"xwfDwGdxx2"}],"key":"AN78AmID2Z"}],"key":"dRlW7tGAdq"}],"label":"function-plufact","identifier":"function-plufact","html_id":"function-plufact","enumerator":"2.6.2","key":"zhDYekmgLs"},{"type":"paragraph","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"children":[{"type":"text","value":"Ideally, the PLU factorization takes ","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"key":"EqCtbUHm2u"},{"type":"inlineMath","value":"\\sim \\frac{2}{3}n^3","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>∼</mo><mfrac><mn>2</mn><mn>3</mn></mfrac><msup><mi>n</mi><mn>3</mn></msup></mrow><annotation encoding=\"application/x-tex\">\\sim \\frac{2}{3}n^3</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.3669em;\"></span><span class=\"mrel\">∼</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1901em;vertical-align:-0.345em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8451em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">3</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mord\"><span class=\"mord mathnormal\">n</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span></span></span></span></span></span></span></span>","key":"fnF9OyS3a9"},{"type":"text","value":" flops asymptotically, just like LU without pivoting. The implementation in ","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"key":"JNX9MGfy7p"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-plufact","label":"function-plufact","children":[{"type":"text","value":"Function ","key":"Er1SRxhfOl"},{"type":"text","value":"2.6.2","key":"gOgYXDiCJ4"}],"template":"Algorithm %s","enumerator":"2.6.2","resolved":true,"html_id":"function-plufact","key":"iOESIYj0Bm"},{"type":"text","value":" does not achieve this optimal flop count, however. Like ","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"key":"JdbZPTuAUC"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-lufact","label":"function-lufact","children":[{"type":"text","value":"Function ","key":"BSFTD0VFds"},{"type":"text","value":"2.4.1","key":"XaO0N5l3xt"}],"template":"Algorithm %s","enumerator":"2.4.1","resolved":true,"html_id":"function-lufact","remote":true,"url":"/lu","dataUrl":"/lu.json","key":"T2BsMds0BS"},{"type":"text","value":", it does unnecessary operations on structurally known zeros for the sake of being easier to understand.","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"key":"AKpEvNCXbw"}],"key":"mhPGQTg5Ti"},{"type":"heading","depth":2,"position":{"start":{"line":183,"column":1},"end":{"line":183,"column":1}},"children":[{"type":"text","value":"Linear systems","position":{"start":{"line":183,"column":1},"end":{"line":183,"column":1}},"key":"pNe1OwPa24"}],"identifier":"linear-systems","label":"Linear systems","html_id":"linear-systems","implicit":true,"enumerator":"2.6.3","key":"MY4oLgnW15"},{"type":"paragraph","position":{"start":{"line":185,"column":1},"end":{"line":185,"column":1}},"children":[{"type":"text","value":"The output of ","position":{"start":{"line":185,"column":1},"end":{"line":185,"column":1}},"key":"iOemddDe15"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-plufact","label":"function-plufact","children":[{"type":"text","value":"Function ","key":"t1voGC2X3t"},{"type":"text","value":"2.6.2","key":"mcrsUdO3qB"}],"template":"Algorithm %s","enumerator":"2.6.2","resolved":true,"html_id":"function-plufact","key":"mSEq5mPjFC"},{"type":"text","value":" is a factorization of a row-permuted ","position":{"start":{"line":185,"column":1},"end":{"line":185,"column":1}},"key":"b9Q7NAMCmo"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":185,"column":1},"end":{"line":185,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"v0cB6IwByD"},{"type":"text","value":". Therefore, given a linear system ","position":{"start":{"line":185,"column":1},"end":{"line":185,"column":1}},"key":"Nlp8yTUrCS"},{"type":"inlineMath","value":"\\mathbf{A}\\mathbf{x}=\\mathbf{b}","position":{"start":{"line":185,"column":1},"end":{"line":185,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi><mi mathvariant=\"bold\">x</mi><mo>=</mo><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}\\mathbf{x}=\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">Ax</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"yR8xsHn4eV"},{"type":"text","value":", we have to permute ","position":{"start":{"line":185,"column":1},"end":{"line":185,"column":1}},"key":"cHFUvMMejp"},{"type":"inlineMath","value":"\\mathbf{b}","position":{"start":{"line":185,"column":1},"end":{"line":185,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"n2doHqHYQQ"},{"type":"text","value":" the same way before applying forward and backward substitution. This is equivalent to changing the order of the equations in a linear system, which does not affect its solution.","position":{"start":{"line":185,"column":1},"end":{"line":185,"column":1}},"key":"D7vdwN07J2"}],"key":"mzbCn2ZjZb"},{"type":"proof","kind":"example","enumerated":true,"children":[{"type":"tabSet","children":[{"type":"tabItem","title":"Julia","sync":"julia","children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"PLU factorization for solving linear systems","position":{"start":{"line":192,"column":1},"end":{"line":192,"column":1}},"key":"IuR95FRiTn"}],"key":"e63z6BGwrd"},{"type":"include","file":"julia/usage.ipynb","children":[{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-05T09:34:08.220000Z","iopub.status.busy":"2025-01-05T09:34:07.927000Z","iopub.status.idle":"2025-01-05T09:34:14.716000Z","shell.execute_reply":"2025-01-05T09:34:14.670000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"include(\"../../../julia/FNC_init.jl\")","key":"J8ySF0e7X0"},{"type":"output","id":"gEMHiCTyRPaFMqSOOk6tl","data":[{"name":"stderr","output_type":"stream","text":"\u001b[32m\u001b[1m  Activating\u001b[22m\u001b[39m "},{"name":"stderr","output_type":"stream","text":"project at `~/Documents/GitHub/fnc`\n"}],"key":"oNbVn3dyED"}],"key":"TNYzaI4q1M"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"ht74BDo7wV"},{"type":"text","value":"2.6.4","key":"CM2WdCHnhw"}],"key":"GFpELCdEtl"}],"identifier":"demo-pivoting-usage","label":"demo-pivoting-usage","kind":"proof:example","template":"Example %s","enumerator":"2.6.4","resolved":true,"html_id":"demo-pivoting-usage","key":"GudB64NvEf"}],"key":"awSJMMcTPW"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The third output of ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"VyvSEwmH6W"},{"type":"inlineCode","value":"plufact","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"D7Eo2wJPJ6"},{"type":"text","value":" is the permutation vector we need to apply to ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"IqiaBA1xHk"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"WFKxGJLGaL"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"GYVOlkarOV"}],"key":"iDLPkP4To5"}],"key":"qEIx5ByiAh"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-05T09:34:14.862000Z","iopub.status.busy":"2025-01-05T09:34:14.718000Z","iopub.status.idle":"2025-01-05T09:34:17.221000Z","shell.execute_reply":"2025-01-05T09:34:17.221000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"A = rand(1:20, 4, 4)\nL, U, p = FNC.plufact(A)\nA[p,:] - L * U   # should be ≈ 0","key":"Wl6sdu4ZeK"},{"type":"output","id":"tcniZjSwdl63H1T8BsWdY","data":[{"output_type":"execute_result","execution_count":2,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n 0.0  0.0  0.0  0.0\n 0.0  0.0  0.0  0.0\n 0.0  0.0  0.0  0.0\n 0.0  0.0  0.0  0.0","content_type":"text/plain"}}}],"key":"s1T3n0aCdW"}],"key":"iNjHA0twy5"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Given a vector ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Pl8QVAJZHS"},{"type":"inlineMath","value":"\\mathbf{b}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"jkacxY9xns"},{"type":"text","value":", we solve ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"vK9wG9CF69"},{"type":"inlineMath","value":"\\mathbf{A}\\mathbf{x}=\\mathbf{b}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi><mi mathvariant=\"bold\">x</mi><mo>=</mo><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}\\mathbf{x}=\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">Ax</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"OSwsD64ZmX"},{"type":"text","value":" by first permuting the entries of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wCT6n7kBX0"},{"type":"inlineMath","value":"\\mathbf{b}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"TBV2K6rsrG"},{"type":"text","value":" and then proceeding as before.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zu33n6P705"}],"key":"e2XMJYiYWK"}],"key":"LsmOLn7QXi"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-05T09:34:17.225000Z","iopub.status.busy":"2025-01-05T09:34:17.224000Z","iopub.status.idle":"2025-01-05T09:34:17.529000Z","shell.execute_reply":"2025-01-05T09:34:17.529000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"b = rand(4)\nz = FNC.forwardsub(L,b[p])\nx = FNC.backsub(U,z)","key":"k1BKB5IngF"},{"type":"output","id":"AWD68IpV0TrUv4Pcmal4Z","data":[{"output_type":"execute_result","execution_count":3,"metadata":{},"data":{"text/plain":{"content":"4-element Vector{Float64}:\n  0.02749801420636107\n -0.12548794082958492\n  0.07681772246882936\n  0.0531377259493499","content_type":"text/plain"}}}],"key":"lOuKVjbTcW"}],"key":"y2BVNlaTPe"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"A residual check is successful:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"vMrxEQGGsJ"}],"key":"Ytbhsjd0XD"}],"key":"UNsSnrBCB4"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-05T09:34:17.531000Z","iopub.status.busy":"2025-01-05T09:34:17.531000Z","iopub.status.idle":"2025-01-05T09:34:17.638000Z","shell.execute_reply":"2025-01-05T09:34:17.638000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"b - A*x","key":"DN2FyxlKoC"},{"type":"output","id":"OV-FU-CSe-0cZzAKH8kzy","data":[{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"text/plain":{"content":"4-element Vector{Float64}:\n -2.220446049250313e-16\n -1.1102230246251565e-16\n  1.1102230246251565e-16\n  0.0","content_type":"text/plain"}}}],"key":"e5fIQYPhX9"}],"key":"H2yLN2qAhf"}],"key":"ayT1UVOTgo"}],"key":"R8sIQKVCIY"}],"key":"iwdmP2osT4"},{"type":"tabItem","title":"MATLAB","sync":"matlab","children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"PLU factorization for solving linear systems","position":{"start":{"line":201,"column":1},"end":{"line":201,"column":1}},"key":"owOW4UCrA5"}],"key":"nbL5aRI355"},{"type":"include","file":"matlab/usage.ipynb","children":[{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"lYC1dQf7hg"},{"type":"text","value":"2.6.4","key":"j0L6MFmFzl"}],"key":"AoykTQjqnm"}],"identifier":"demo-pivoting-usage","label":"demo-pivoting-usage","kind":"proof:example","template":"Example %s","enumerator":"2.6.4","resolved":true,"html_id":"demo-pivoting-usage","key":"zHJPfF2XBR"}],"key":"hghRwUrk6J"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The third output of ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"szoqwAozvn"},{"type":"inlineCode","value":"plufact","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"JEMvmALNcx"},{"type":"text","value":" is the permutation vector we need to apply to ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"QgNEk98QVP"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"m2joPdZYX1"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Y4SYraxu5U"}],"key":"ZkAuMPTIkf"}],"key":"FNIdxAR3jy"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"A = randi(20, 4, 4);\n[L, U, p] = plufact(A);\nA(p, :) - L * U    % should be ≈ 0","key":"jNeZHt3IHA"},{"type":"output","id":"ffE-NjctTW8DJ34It9m1T","data":[{"output_type":"execute_result","execution_count":2,"metadata":{},"data":{"text/plain":{"content":"ans = 4×4 double\n1.0e-15 *\n\n         0         0         0         0\n         0         0         0         0\n         0         0         0         0\n         0         0    0.4441         0\n","content_type":"text/plain"},"text/html":{"content":"<html><body><pre>ans = 4×4 double\n1.0e-15 *\n\n         0         0         0         0\n         0         0         0         0\n         0         0         0         0\n         0         0    0.4441         0\n</pre></body></html>","content_type":"text/html"}}}],"key":"t1eFqOAvjV"}],"key":"wJxpGOkOJZ"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Given a vector ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TR9tx5n2lg"},{"type":"inlineMath","value":"\\mathbf{b}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"p3GyCipOp6"},{"type":"text","value":", we solve ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cx75xeUNSy"},{"type":"inlineMath","value":"\\mathbf{A}\\mathbf{x}=\\mathbf{b}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi><mi mathvariant=\"bold\">x</mi><mo>=</mo><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}\\mathbf{x}=\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">Ax</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"SPD5zjCXVb"},{"type":"text","value":" by first permuting the entries of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dkTVhv0euo"},{"type":"inlineMath","value":"\\mathbf{b}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"ZJ5EsJRUCj"},{"type":"text","value":" and then proceeding as before.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RDGwwy28Up"}],"key":"uNkx6BEQPF"}],"key":"qSX4Vukm9b"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"b = rand(4, 1);\nz = forwardsub(L, b(p));\nx = backsub(U, z)","key":"KKRJpYctGP"},{"type":"output","id":"BauZarylJgP7LMzPgnDUI","data":[{"output_type":"execute_result","execution_count":3,"metadata":{},"data":{"text/plain":{"content":"x = 4×1 double\n   -0.3567\n    0.0548\n    0.2904\n    0.1998\n","content_type":"text/plain"},"text/html":{"content":"<html><body><pre>x = 4×1 double\n   -0.3567\n    0.0548\n    0.2904\n    0.1998\n</pre></body></html>","content_type":"text/html"}}}],"key":"V2Madkutpm"}],"key":"z20ycJ6lf2"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"A residual check is successful:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"N7DhoaGyci"}],"key":"oXPJrrB8QO"}],"key":"OdZCUoF5Kp"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"b - A*x","key":"qX78lbp8sw"},{"type":"output","id":"QGA8nCmrl9iAjTwQCoMWc","data":[{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"text/plain":{"content":"ans = 4×1 double\n1.0e-15 *\n\n   -0.3331\n    0.1110\n         0\n   -0.3331\n","content_type":"text/plain"},"text/html":{"content":"<html><body><pre>ans = 4×1 double\n1.0e-15 *\n\n   -0.3331\n    0.1110\n         0\n   -0.3331\n</pre></body></html>","content_type":"text/html"}}}],"key":"HkezQSf5jd"}],"key":"enUG3W5SF3"}],"key":"tl3ech7W20"}],"key":"uRFAHOnB7B"}],"key":"V612JnJzkf"},{"type":"tabItem","title":"Python","sync":"python","children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"PLU factorization for solving linear systems","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"key":"axxXXvcGBE"}],"key":"PlnFiuQQ5b"},{"type":"include","file":"python/usage.ipynb","children":[{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:43:44.823672Z","iopub.status.busy":"2025-01-11T17:43:44.823455Z","iopub.status.idle":"2025-01-11T17:43:45.160076Z","shell.execute_reply":"2025-01-11T17:43:45.159560Z"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"exec(open(\"../../../python/FNC_init.py\").read())","visibility":"show","key":"z5jnbFPZzs"},{"type":"output","id":"ecvCDqJ8QDlUOO_OKwTY9","data":[],"visibility":"show","key":"RnjIcSt37L"}],"visibility":"remove","key":"DoiMG7MmEi"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"xveC89Ttvx"},{"type":"text","value":"2.6.4","key":"DdLRVWhBhV"}],"key":"YmIZyTsCtU"}],"identifier":"demo-pivoting-usage","label":"demo-pivoting-usage","kind":"proof:example","template":"Example %s","enumerator":"2.6.4","resolved":true,"html_id":"demo-pivoting-usage","key":"v6EuYU3kpL"}],"key":"qUQgQB9ewl"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The third output of ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"q7xYykOZJQ"},{"type":"inlineCode","value":"plufact","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"SFxFDFOGcu"},{"type":"text","value":" is the permutation vector we need to apply to ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"hTY9rttz0y"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"JAv1fBpR0O"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ZE8kdCzlvm"}],"key":"t7B3GqGING"}],"key":"i6XtWtfc4L"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:43:45.162657Z","iopub.status.busy":"2025-01-11T17:43:45.162370Z","iopub.status.idle":"2025-01-11T17:43:45.169964Z","shell.execute_reply":"2025-01-11T17:43:45.169527Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"A = random.randn(4, 4)\nL, U, p = FNC.plufact(A)\nA[p, :] - L @ U   # should be ≈ 0","key":"CtyBQkHcG0"},{"type":"output","id":"qH5SO61bhRFX4wz5qWEYu","data":[{"output_type":"execute_result","execution_count":2,"metadata":{},"data":{"text/plain":{"content":"array([[ 0.00000000e+00,  0.00000000e+00,  0.00000000e+00,\n         0.00000000e+00],\n       [ 0.00000000e+00,  0.00000000e+00, -1.11022302e-16,\n         0.00000000e+00],\n       [ 0.00000000e+00, -1.11022302e-16, -5.55111512e-17,\n         0.00000000e+00],\n       [ 0.00000000e+00,  0.00000000e+00,  0.00000000e+00,\n        -2.22044605e-16]])","content_type":"text/plain"}}}],"key":"J81P25WDRB"}],"key":"B0wL7gMuNx"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Given a vector ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"a3HdjjiTGC"},{"type":"inlineMath","value":"\\mathbf{b}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"ctYo3EfXS0"},{"type":"text","value":", we solve ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"sGNeqoWYvL"},{"type":"inlineMath","value":"\\mathbf{A}\\mathbf{x}=\\mathbf{b}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi><mi mathvariant=\"bold\">x</mi><mo>=</mo><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}\\mathbf{x}=\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">Ax</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"Q4HcbkUJQ8"},{"type":"text","value":" by first permuting the entries of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"sefXjFbudD"},{"type":"inlineMath","value":"\\mathbf{b}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"znAPMqr4qP"},{"type":"text","value":" and then proceeding as before.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bGuoDCU7KO"}],"key":"o7si92w5ya"}],"key":"kQGydEak0s"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:43:45.172299Z","iopub.status.busy":"2025-01-11T17:43:45.172034Z","iopub.status.idle":"2025-01-11T17:43:45.174566Z","shell.execute_reply":"2025-01-11T17:43:45.174268Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"b = random.randn(4)\nz = FNC.forwardsub(L, b[p])\nx = FNC.backsub(U, z)","key":"v6JxFv5zYj"},{"type":"output","id":"nvd16CFxVFzfGyMgswhkq","data":[],"key":"ULOPz4fyAN"}],"key":"g8eu9w4DJ9"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"A residual check is successful:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DyaUmzsACK"}],"key":"LHx6CMOFaL"}],"key":"KQfvVzI16Q"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:43:45.176281Z","iopub.status.busy":"2025-01-11T17:43:45.176174Z","iopub.status.idle":"2025-01-11T17:43:45.178265Z","shell.execute_reply":"2025-01-11T17:43:45.178018Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"b - A @ x","key":"C85tQOcVyF"},{"type":"output","id":"Tw3YxOVNg49lsESS6eMD2","data":[{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"text/plain":{"content":"array([-5.55111512e-17,  2.22044605e-16,  0.00000000e+00,  2.22044605e-16])","content_type":"text/plain"}}}],"key":"bnLU8MmQ7J"}],"key":"kI799Z5eFy"}],"key":"zAjEauSU1S"}],"key":"cY32UL1QGP"}],"key":"jlw3Zjcr8z"}],"key":"Lk15TzLLIN"}],"label":"demo-pivoting-usage","identifier":"demo-pivoting-usage","html_id":"demo-pivoting-usage","enumerator":"2.6.4","key":"ND2kO31mtI"},{"type":"paragraph","position":{"start":{"line":220,"column":1},"end":{"line":220,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":220,"column":1},"end":{"line":220,"column":1}},"key":"No92qd6lDD"},{"type":"inlineCode","value":"lu","position":{"start":{"line":220,"column":1},"end":{"line":220,"column":1}},"key":"Ff5fkIgjvl"},{"type":"text","value":" function from the built-in package ","position":{"start":{"line":220,"column":1},"end":{"line":220,"column":1}},"key":"NAsbbkGroX"},{"type":"inlineCode","value":"LinearAlgebra","position":{"start":{"line":220,"column":1},"end":{"line":220,"column":1}},"key":"HpcDvjftqb"},{"type":"text","value":" returns the same three outputs as ","position":{"start":{"line":220,"column":1},"end":{"line":220,"column":1}},"key":"wvWGB8UAfF"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-plufact","label":"function-plufact","children":[{"type":"text","value":"Function ","key":"DY88gq6cwW"},{"type":"text","value":"2.6.2","key":"yJumz6xr7e"}],"template":"Algorithm %s","enumerator":"2.6.2","resolved":true,"html_id":"function-plufact","key":"dCaBdM56KS"},{"type":"text","value":". If you only request one output, it will be a factorization object that can be used with a backslash. This is useful when you want to solve with multiple versions of ","position":{"start":{"line":220,"column":1},"end":{"line":220,"column":1}},"key":"xpEBisEnJM"},{"type":"inlineMath","value":"\\mathbf{b}","position":{"start":{"line":220,"column":1},"end":{"line":220,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"tU3oQlnKlw"},{"type":"text","value":" but do the factorization only once.","position":{"start":{"line":220,"column":1},"end":{"line":220,"column":1}},"key":"XVQJmyyRdF"}],"key":"F8plm5wzC8"},{"type":"proof","kind":"example","enumerated":true,"children":[{"type":"tabSet","children":[{"type":"tabItem","title":"Julia","sync":"julia","children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Built-in PLU factorization","position":{"start":{"line":227,"column":1},"end":{"line":227,"column":1}},"key":"mvBLejrQIc"}],"key":"GB4M5fPbxH"},{"type":"include","file":"julia/builtin.ipynb","children":[{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-05T09:34:25.206000Z","iopub.status.busy":"2025-01-05T09:34:24.922000Z","iopub.status.idle":"2025-01-05T09:34:31.449000Z","shell.execute_reply":"2025-01-05T09:34:31.403000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"include(\"../../../julia/FNC_init.jl\")","key":"r3sN5F7n4P"},{"type":"output","id":"eCnCrptKIb72yl1bdAmgU","data":[{"name":"stderr","output_type":"stream","text":"\u001b[32m\u001b[1m  Activating\u001b[22m\u001b[39m "},{"name":"stderr","output_type":"stream","text":"project at `~/Documents/GitHub/fnc`\n"}],"key":"DKsDdtzH0Z"}],"key":"pasazQoFCM"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"JA6MGpWvva"},{"type":"text","value":"2.6.5","key":"YjRYVlGm3x"}],"key":"o2ix6hz12t"}],"identifier":"demo-pivoting-builtin","label":"demo-pivoting-builtin","kind":"proof:example","template":"Example %s","enumerator":"2.6.5","resolved":true,"html_id":"demo-pivoting-builtin","key":"mHXpwXJ9RF"}],"key":"e72iVWruiW"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"With the syntax ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"m2qeL5QQf5"},{"type":"inlineCode","value":"A \\ b","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"OMHnZhwRbh"},{"type":"text","value":", the matrix ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"go9e4jJECQ"},{"type":"inlineCode","value":"A","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"TkmQEM0xxO"},{"type":"text","value":" is PLU-factored, followed by two triangular solves.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"t0adNZvpz7"}],"key":"cw1qAkAUTW"}],"key":"tFwesZwINJ"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-05T09:34:31.580000Z","iopub.status.busy":"2025-01-05T09:34:31.451000Z","iopub.status.idle":"2025-01-05T09:34:31.996000Z","shell.execute_reply":"2025-01-05T09:34:31.996000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"A = randn(500, 500)   # 500x500 with normal random entries\nA \\ rand(500)          # force compilation\n@elapsed for k=1:50; A \\ rand(500); end","key":"XuUGw3gw53"},{"type":"output","id":"JZ57SMkk3El1nikqvSUF3","data":[{"output_type":"execute_result","execution_count":2,"metadata":{},"data":{"text/plain":{"content":"0.139001208","content_type":"text/plain"}}}],"key":"feQGfe2v5Y"}],"key":"W9harQ8yCe"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"In ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Gd6K9b0MQr"},{"type":"link","kind":"numref","identifier":"section-linsys-efficiency","label":"section-linsys-efficiency","url":"/efficiency","internal":true,"dataUrl":"/efficiency.json","children":[{"type":"text","value":"Efficiency of matrix computations","key":"s3Gy9cc3dj"}],"key":"U1d7axBCNc"},{"type":"text","value":" we showed that the factorization is by far the most costly part of the solution process. A factorization object allows us to do that costly step only once per unique matrix.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"G2wBMq2JjY"}],"key":"tx3BhKLnGM"}],"key":"RQJunO8k51"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-05T09:34:31.998000Z","iopub.status.busy":"2025-01-05T09:34:31.998000Z","iopub.status.idle":"2025-01-05T09:34:32.015000Z","shell.execute_reply":"2025-01-05T09:34:32.014000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"factored = lu(A)     # store factorization result\nfactored \\ rand(500)   # force compilation\n@elapsed for k=1:50; factored \\ rand(500); end","key":"MTOSP5eqSH"},{"type":"output","id":"ahPlra-dlWb6G19t1fv6V","data":[{"output_type":"execute_result","execution_count":3,"metadata":{},"data":{"text/plain":{"content":"0.002763166","content_type":"text/plain"}}}],"key":"aMgLHXzzep"}],"key":"fVVWK8lOAR"}],"key":"byQl3Awhys"}],"key":"dN1jId0KPV"}],"key":"KA8MTjaPKe"},{"type":"tabItem","title":"MATLAB","sync":"matlab","children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Built-in PLU factorization","position":{"start":{"line":236,"column":1},"end":{"line":236,"column":1}},"key":"xrbLSdzDoM"}],"key":"YHcvZC5O9O"},{"type":"include","file":"matlab/builtin.ipynb","children":[{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"cKgXxdSNo7"},{"type":"text","value":"2.6.5","key":"AhZJhg1cGE"}],"key":"gBTqk9L3JV"}],"identifier":"demo-pivoting-builtin","label":"demo-pivoting-builtin","kind":"proof:example","template":"Example %s","enumerator":"2.6.5","resolved":true,"html_id":"demo-pivoting-builtin","key":"SmOwVI9kqZ"}],"key":"BlIo6f0mpg"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"With the syntax ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"mzTbTNttSW"},{"type":"inlineCode","value":"A \\ b","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"pWDO3agE2U"},{"type":"text","value":", the matrix ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"tKzLGHlemh"},{"type":"inlineCode","value":"A","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"bmu4PMKaos"},{"type":"text","value":" is PLU-factored, followed by two triangular solves.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"CQnMtfUT4M"}],"key":"C3otIecSDL"}],"key":"QqICQOq4X1"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"A = randn(500, 500);    % 500x500 with normal random entries\ntic; for k=1:50; A \\ rand(500, 1); end; toc","key":"BdIFwLRpCy"},{"type":"output","id":"zpLxe7D0DIYJ7cxac_Sme","data":[{"name":"stdout","output_type":"stream","text":"Elapsed time is 0.406799 seconds.\n"}],"key":"pm5M9ar16m"}],"key":"tYrLtLqqdK"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"In ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"gQRf8Pq4HZ"},{"type":"link","kind":"numref","identifier":"section-linsys-efficiency","label":"section-linsys-efficiency","url":"/efficiency","internal":true,"dataUrl":"/efficiency.json","children":[{"type":"text","value":"Efficiency of matrix computations","key":"pNQEcl7wUg"}],"key":"TE0n6TuHSZ"},{"type":"text","value":" we showed that the factorization is by far the most costly part of the solution process. A factorization object allows us to do that costly step only once per unique matrix.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RQUi7v1RJd"}],"key":"sOqJijCsg6"}],"key":"K1RkMonrYn"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"[L, U, p] = lu(A, 'vector');    % keep factorization result\ntic\nfor k=1:50\n    b = rand(500, 1);\n    U \\ (L \\ b(p));\nend\ntoc","key":"D33BB6aQZh"},{"type":"output","id":"-sT49MpW0cqmIC2sCFajm","data":[{"name":"stdout","output_type":"stream","text":"Elapsed time is 0.010508 seconds.\n"}],"key":"TiDeVbahvc"}],"key":"FrKOLrOVfV"}],"key":"YnfTlAoivR"}],"key":"JneqQbKOmn"}],"key":"jDFkvVueAT"},{"type":"tabItem","title":"Python","sync":"python","children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Built-in PLU factorization","position":{"start":{"line":245,"column":1},"end":{"line":245,"column":1}},"key":"zt6FNgazhz"}],"key":"yAetYhpXSw"},{"type":"include","file":"python/builtin.ipynb","children":[{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:43:38.837957Z","iopub.status.busy":"2025-01-11T17:43:38.837824Z","iopub.status.idle":"2025-01-11T17:43:39.165661Z","shell.execute_reply":"2025-01-11T17:43:39.165402Z"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"exec(open(\"../../../python/FNC_init.py\").read())","visibility":"show","key":"DoNfVxVOsX"},{"type":"output","id":"c4cQ-qJonT_x6kY4J_KSz","data":[],"visibility":"show","key":"twZCdWYvwR"}],"visibility":"remove","key":"TfUysE0Znw"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"eG8XvcRaSH"},{"type":"text","value":"2.6.5","key":"d9aa4QPcGx"}],"key":"uvnXzdMZqG"}],"identifier":"demo-pivoting-builtin","label":"demo-pivoting-builtin","kind":"proof:example","template":"Example %s","enumerator":"2.6.5","resolved":true,"html_id":"demo-pivoting-builtin","key":"Dkp3LPXMY7"}],"key":"ynt2D7MjuA"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"In ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Z9f0FV2uYX"},{"type":"inlineCode","value":"linalg.solve","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"jFYE4Aby5X"},{"type":"text","value":", the matrix ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"AQGeg6a23N"},{"type":"inlineCode","value":"A","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"AshytT6b0P"},{"type":"text","value":" is PLU-factored, followed by two triangular solves. If we want to do those steps seamlessly, we can use the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"DDh6NzMupv"},{"type":"inlineCode","value":"lu_factor","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"MX5qlrqTWt"},{"type":"text","value":" and ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"gFg2S5JZ5k"},{"type":"inlineCode","value":"lu_solve","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Xvt5Q0tOst"},{"type":"text","value":" from ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"dCvdTcjHhI"},{"type":"inlineCode","value":"scipy.linalg","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"weuJnnlc3o"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"NhlOyxRdqZ"}],"key":"rClEzAHU17"}],"key":"FyH6exm4o8"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:43:39.167080Z","iopub.status.busy":"2025-01-11T17:43:39.166950Z","iopub.status.idle":"2025-01-11T17:43:39.175263Z","shell.execute_reply":"2025-01-11T17:43:39.175029Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"from scipy.linalg import lu_factor, lu_solve\nA = random.randn(500, 500) \nb = ones(500)  \nLU, perm = lu_factor(A)\nx = lu_solve((LU, perm), b)","key":"cQDQJIW22Q"},{"type":"output","id":"sl6oe_rrPV5nKe5H6awNC","data":[],"key":"Z2lXvDyvuP"}],"key":"Y77hOAqiQn"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Why would we ever bother with this? In ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LLS3Oeu8eJ"},{"type":"link","kind":"numref","identifier":"section-linsys-efficiency","label":"section-linsys-efficiency","url":"/efficiency","internal":true,"dataUrl":"/efficiency.json","children":[{"type":"text","value":"Efficiency of matrix computations","key":"OcuHWD2Ev4"}],"key":"lhKp4VNfVL"},{"type":"text","value":" we showed that the factorization is by far the most costly part of the solution process. A factorization object allows us to do that costly step only once per matrix, but solve with multiple right-hand sides.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"AUQrgOUhTP"}],"key":"oHaMohwiPr"}],"key":"Vc4wodcp8j"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:43:39.176523Z","iopub.status.busy":"2025-01-11T17:43:39.176432Z","iopub.status.idle":"2025-01-11T17:43:39.251308Z","shell.execute_reply":"2025-01-11T17:43:39.251048Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"start = timer()\nfor k in range(50): linalg.solve(A, random.rand(500))\nprint(f\"elapsed time for 50 full solves: {timer() - start}\")\n\nstart = timer()\nLU, perm = lu_factor(A)\nfor k in range(50): lu_solve((LU, perm), random.rand(500))\nprint(f\"elapsed time for 50 shortcut solves: {timer() - start}\")","key":"TNsGOVe6Ns"},{"type":"output","id":"h8hwUT415siNYyJVP5-Ba","data":[{"name":"stdout","output_type":"stream","text":"elapsed time for 50 full solves: 0.06624250000004395\nelapsed time for 50 shortcut solves: 0.0065611250001893495\n"}],"key":"NgdaLWPjJa"}],"key":"UfGz6Tb4Ap"}],"key":"WwGf4EChgT"}],"key":"YgzZuvepJx"}],"key":"zACcE53RUm"}],"key":"m780d3HVMe"}],"label":"demo-pivoting-builtin","identifier":"demo-pivoting-builtin","html_id":"demo-pivoting-builtin","enumerator":"2.6.5","key":"gRnT6BILdY"},{"type":"heading","depth":2,"position":{"start":{"line":255,"column":1},"end":{"line":255,"column":1}},"children":[{"type":"text","value":"Stability","position":{"start":{"line":255,"column":1},"end":{"line":255,"column":1}},"key":"lbssHOBmjq"}],"identifier":"stability","label":"Stability","html_id":"stability","implicit":true,"enumerator":"2.6.4","key":"AYrJ24MTpD"},{"type":"paragraph","position":{"start":{"line":260,"column":1},"end":{"line":260,"column":1}},"children":[{"type":"text","value":"There is one detail of the row pivoting algorithm that might seem arbitrary: why choose the pivot of largest magnitude in a column, rather than, say, the uppermost nonzero in the column? The answer is numerical stability.","position":{"start":{"line":260,"column":1},"end":{"line":260,"column":1}},"key":"gU5VBU2idB"}],"indexEntries":[{"entry":"stability","emphasis":false}],"label":"index-gaUqDpjUJq","identifier":"index-gauqdpjujq","html_id":"index-gauqdpjujq","key":"NlWzMlAG1p"},{"type":"proof","kind":"example","enumerated":true,"children":[{"type":"tabSet","children":[{"type":"tabItem","title":"Julia","sync":"julia","children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Stability of PLU factorization","position":{"start":{"line":267,"column":1},"end":{"line":267,"column":1}},"key":"m8gjGzL8J1"}],"key":"I97d363RVc"},{"type":"include","file":"julia/stable.ipynb","children":[{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-05T09:34:39.545000Z","iopub.status.busy":"2025-01-05T09:34:39.259000Z","iopub.status.idle":"2025-01-05T09:34:46.520000Z","shell.execute_reply":"2025-01-05T09:34:46.464000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"include(\"../../../julia/FNC_init.jl\")","key":"nROEgVOmIu"},{"type":"output","id":"gj9pdw9R9PQXFyiaUwoWk","data":[{"name":"stderr","output_type":"stream","text":"\u001b[32m\u001b[1m  Activating\u001b[22m\u001b[39m "},{"name":"stderr","output_type":"stream","text":"project at `~/Documents/GitHub/fnc`\n"}],"key":"XiU1iqv6Vf"}],"key":"O59haLIM9Y"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"xv9inAR0jS"},{"type":"text","value":"2.6.6","key":"uPG1GMiXK7"}],"key":"hANgk5z8Ft"}],"identifier":"demo-pivoting-stable","label":"demo-pivoting-stable","kind":"proof:example","template":"Example %s","enumerator":"2.6.6","resolved":true,"html_id":"demo-pivoting-stable","key":"wJ1wq0XO0a"}],"key":"mBykzZ7YX5"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We construct a linear system for this matrix with ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"SM6gOPXDh4"},{"type":"inlineMath","value":"\\epsilon=10^{-12}","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ϵ</mi><mo>=</mo><mn>1</mn><msup><mn>0</mn><mrow><mo>−</mo><mn>12</mn></mrow></msup></mrow><annotation encoding=\"application/x-tex\">\\epsilon=10^{-12}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">ϵ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">12</span></span></span></span></span></span></span></span></span></span></span></span>","key":"FVvkj1gbaN"},{"type":"text","value":" and exact solution ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"RTMGByf2An"},{"type":"inlineMath","value":"[1,1]","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[1,1]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]</span></span></span></span>","key":"ao9cSWyl83"},{"type":"text","value":":","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"qTg3C2InAh"}],"key":"pww5zFOyLq"}],"key":"KQk1yvjNqm"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-05T09:34:46.676000Z","iopub.status.busy":"2025-01-05T09:34:46.522000Z","iopub.status.idle":"2025-01-05T09:34:48.028000Z","shell.execute_reply":"2025-01-05T09:34:48.028000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"ϵ = 1e-12\nA = [-ϵ 1; 1 -1]\nb = A * [1, 1]","key":"ieJ33JphSP"},{"type":"output","id":"1qwTq1eGKu37OCU4IR3aw","data":[{"output_type":"execute_result","execution_count":2,"metadata":{},"data":{"text/plain":{"content":"2-element Vector{Float64}:\n 0.999999999999\n 0.0","content_type":"text/plain"}}}],"key":"LlWa54IXIv"}],"key":"hkuKsYDY0T"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We can factor the matrix without pivoting and solve for ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"gtDyQN5IzL"},{"type":"inlineMath","value":"\\mathbf{x}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">x</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{x}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4444em;\"></span><span class=\"mord mathbf\">x</span></span></span></span>","key":"Spkt5jP768"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ExcOAOXbqp"}],"key":"Heq9ykQFh2"}],"key":"vWPWW0uGzB"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-05T09:34:48.030000Z","iopub.status.busy":"2025-01-05T09:34:48.030000Z","iopub.status.idle":"2025-01-05T09:34:48.158000Z","shell.execute_reply":"2025-01-05T09:34:48.158000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"L, U = FNC.lufact(A)\nx = FNC.backsub( U, FNC.forwardsub(L, b) )","key":"ivvud4GQUY"},{"type":"output","id":"I5P2ALskQb4QdT4yQIkHg","data":[{"output_type":"execute_result","execution_count":3,"metadata":{},"data":{"text/plain":{"content":"2-element Vector{Float64}:\n 0.9999778782798785\n 1.0","content_type":"text/plain"}}}],"key":"LDfAJFZ2Z2"}],"key":"vaJpdEjjeP"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Note that we have obtained only about 5 accurate digits for ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ihwP9DPlcm"},{"type":"inlineMath","value":"x_1","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">x_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"tTsNW3G6EX"},{"type":"text","value":". We could make the result even more inaccurate by making ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zzhtrTMFoR"},{"type":"text","value":"ε","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"V6eV8SeZ2E"},{"type":"text","value":" even smaller:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Zzin7h5tKM"}],"key":"lPm5HETVYh"}],"key":"aTDmTeKgm2"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-05T09:34:48.160000Z","iopub.status.busy":"2025-01-05T09:34:48.160000Z","iopub.status.idle":"2025-01-05T09:34:48.162000Z","shell.execute_reply":"2025-01-05T09:34:48.161000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"ϵ = 1e-20; A = [-ϵ 1; 1 -1]\nb = A * [1, 1]\nL, U = FNC.lufact(A)\nx = FNC.backsub( U, FNC.forwardsub(L, b) )","key":"NT9uRz3Zxm"},{"type":"output","id":"3TDD8jPO_fOM3Vu1zzgyG","data":[{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"text/plain":{"content":"2-element Vector{Float64}:\n -0.0\n  1.0","content_type":"text/plain"}}}],"key":"gAO7iDvpAA"}],"key":"EUdWo4bZc5"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"This effect is not due to ill conditioning of the problem—a solution with PLU factorization works perfectly:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wIPRAd2hzN"}],"key":"WgmKzeRrZe"}],"key":"i4bKgwSSMf"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-05T09:34:48.163000Z","iopub.status.busy":"2025-01-05T09:34:48.163000Z","iopub.status.idle":"2025-01-05T09:34:48.164000Z","shell.execute_reply":"2025-01-05T09:34:48.164000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"A \\ b","key":"sLSJJMKItW"},{"type":"output","id":"9PdkFHl4g5S6T6SzZab35","data":[{"output_type":"execute_result","execution_count":5,"metadata":{},"data":{"text/plain":{"content":"2-element Vector{Float64}:\n 1.0\n 1.0","content_type":"text/plain"}}}],"key":"dXQY4guHke"}],"key":"wqAe7DlLdG"}],"key":"eZPb3Zz48g"}],"key":"EkDVFm5etT"}],"key":"BNJIyM8djw"},{"type":"tabItem","title":"MATLAB","sync":"matlab","children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Stability of PLU factorization","position":{"start":{"line":276,"column":1},"end":{"line":276,"column":1}},"key":"kfBhIwsCLE"}],"key":"JMtEDAuyzV"},{"type":"include","file":"matlab/stable.ipynb","children":[{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"lC63y8DB3L"},{"type":"text","value":"2.6.6","key":"dzvz4MSTdm"}],"key":"HMDo1nfyZ7"}],"identifier":"demo-pivoting-stable","label":"demo-pivoting-stable","kind":"proof:example","template":"Example %s","enumerator":"2.6.6","resolved":true,"html_id":"demo-pivoting-stable","key":"KB08neYZ8F"}],"key":"dcPUEs75G5"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We construct a linear system for this matrix with ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Dy8Kw33MLT"},{"type":"inlineMath","value":"\\epsilon=10^{-12}","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ϵ</mi><mo>=</mo><mn>1</mn><msup><mn>0</mn><mrow><mo>−</mo><mn>12</mn></mrow></msup></mrow><annotation encoding=\"application/x-tex\">\\epsilon=10^{-12}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">ϵ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">12</span></span></span></span></span></span></span></span></span></span></span></span>","key":"OG3cEMPhfL"},{"type":"text","value":" and exact solution ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"gMNUthruey"},{"type":"inlineMath","value":"[1, 1]","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[1, 1]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]</span></span></span></span>","key":"XbAYZDzGQR"},{"type":"text","value":":","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"LBLs8WdPN8"}],"key":"wk3BE2DPvQ"}],"key":"NaM39vbq7b"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"ep = 1e-12\nA = [-ep 1; 1 -1];\nb = A * [1; 1];","key":"yO5ZBHBwXo"},{"type":"output","id":"3QtemFOENSSDMw-mt_iCK","data":[{"output_type":"execute_result","execution_count":2,"metadata":{},"data":{"text/plain":{"content":"ep = 1.0000e-12","content_type":"text/plain"},"text/html":{"content":"<html><body><pre>ep = 1.0000e-12</pre></body></html>","content_type":"text/html"}}}],"key":"u8X065apQs"}],"key":"QD8LZBIiz5"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We can factor the matrix without pivoting and solve for ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"gd36HNTI6s"},{"type":"inlineMath","value":"\\mathbf{x}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">x</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{x}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4444em;\"></span><span class=\"mord mathbf\">x</span></span></span></span>","key":"G8zG78TEfk"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bQdkbdSGxR"}],"key":"u1vScVzuiw"}],"key":"I454Pp5gG1"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"[L, U] = lufact(A);\nx = backsub( U, forwardsub(L, b) )","key":"cSjNmMQFpK"},{"type":"output","id":"R284TtF6BpEPGCy7i-Sdl","data":[{"output_type":"execute_result","execution_count":3,"metadata":{},"data":{"text/plain":{"content":"x = 2×1 double\n    1.0000\n    1.0000\n","content_type":"text/plain"},"text/html":{"content":"<html><body><pre>x = 2×1 double\n    1.0000\n    1.0000\n</pre></body></html>","content_type":"text/html"}}}],"key":"iZtEbrZbgL"}],"key":"UwdNCRPvv2"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Note that we have obtained only about 5 accurate digits for ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cMHKnKbZGM"},{"type":"inlineMath","value":"x_1","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">x_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"ecGJ9ahf3k"},{"type":"text","value":". We could make the result even more inaccurate by making ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"y53XQX0Tvk"},{"type":"text","value":"ε","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"k0RX1moOhj"},{"type":"text","value":" even smaller:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"f92lnitvEO"}],"key":"T1TxNgDUqD"}],"key":"MmKAVPp6Z9"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"ep = 1e-20; A = [-ep 1; 1 -1];\nb = A * [1; 1];\n[L, U] = lufact(A);\nx = backsub( U, forwardsub(L, b) )","key":"E4tLBRfE8g"},{"type":"output","id":"-pYWkeVEA_PiBq9XrLrAi","data":[{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"text/plain":{"content":"x = 2×1 double\n     0\n     1\n","content_type":"text/plain"},"text/html":{"content":"<html><body><pre>x = 2×1 double\n     0\n     1\n</pre></body></html>","content_type":"text/html"}}}],"key":"kCk214gzqo"}],"key":"koGDgsx1ob"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"This effect is not due to ill conditioning of the problem—a solution with PLU factorization works perfectly:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Xu4pz3cDSX"}],"key":"h8kgbXEWd1"}],"key":"NCgh9DVcjx"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"A \\ b","key":"aW0w6vttOw"},{"type":"output","id":"Et9RimqvCAzCro45gGxRp","data":[{"output_type":"execute_result","execution_count":5,"metadata":{},"data":{"text/plain":{"content":"ans = 2×1 double\n     1\n     1\n","content_type":"text/plain"},"text/html":{"content":"<html><body><pre>ans = 2×1 double\n     1\n     1\n</pre></body></html>","content_type":"text/html"}}}],"key":"ar8onR0Bm0"}],"key":"sQsjfy9PnA"}],"key":"o728KDZGd8"}],"key":"Ecj7izT8Ev"}],"key":"NFZe8ZYrsi"},{"type":"tabItem","title":"Python","sync":"python","children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Stability of PLU factorization","position":{"start":{"line":285,"column":1},"end":{"line":285,"column":1}},"key":"qzctCckGbs"}],"key":"Fa41lgAY74"},{"type":"include","file":"python/stable.ipynb","children":[{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:43:43.709319Z","iopub.status.busy":"2025-01-11T17:43:43.709198Z","iopub.status.idle":"2025-01-11T17:43:44.035696Z","shell.execute_reply":"2025-01-11T17:43:44.035331Z"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"exec(open(\"../../../python/FNC_init.py\").read())","visibility":"show","key":"fOzz9Iw1sQ"},{"type":"output","id":"jEapUZpSAPZ9HYanddaDl","data":[],"visibility":"show","key":"KIXPpuVs2b"}],"visibility":"remove","key":"wGOSFCSqXB"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"ikjakb7VkL"},{"type":"text","value":"2.6.6","key":"wpPOR6YWn6"}],"key":"GGDYhMRVl4"}],"identifier":"demo-pivoting-stable","label":"demo-pivoting-stable","kind":"proof:example","template":"Example %s","enumerator":"2.6.6","resolved":true,"html_id":"demo-pivoting-stable","key":"aZ3J1HUc0G"}],"key":"C94m7ue9uw"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We construct a linear system for this matrix with ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"NYGvnIWzn7"},{"type":"inlineMath","value":"\\epsilon=10^{-12}","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ϵ</mi><mo>=</mo><mn>1</mn><msup><mn>0</mn><mrow><mo>−</mo><mn>12</mn></mrow></msup></mrow><annotation encoding=\"application/x-tex\">\\epsilon=10^{-12}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">ϵ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">12</span></span></span></span></span></span></span></span></span></span></span></span>","key":"fHU1iUhGOs"},{"type":"text","value":" and exact solution ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"QrsWb4tW9L"},{"type":"inlineMath","value":"[1,1]","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[1,1]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]</span></span></span></span>","key":"PblAofw8BG"},{"type":"text","value":":","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"hizLUrOM5w"}],"key":"rzTdjPP7xC"}],"key":"vgpyMpsjjI"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:43:44.037306Z","iopub.status.busy":"2025-01-11T17:43:44.037179Z","iopub.status.idle":"2025-01-11T17:43:44.039170Z","shell.execute_reply":"2025-01-11T17:43:44.038896Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"ep = 1e-12\nA = array([[-ep, 1], [1, -1]])\nb = A @ array([1, 1])","key":"dcTGWf96dU"},{"type":"output","id":"avF2dC0LDzpb51GuSmjqt","data":[],"key":"Yid3svWs5p"}],"key":"oM5uKo47iN"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We can factor the matrix without pivoting and solve for ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"aUaFZNbUDI"},{"type":"inlineMath","value":"\\mathbf{x}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">x</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{x}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4444em;\"></span><span class=\"mord mathbf\">x</span></span></span></span>","key":"bgN6BPOlqZ"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qgT0ZIirHi"}],"key":"jxp2sbBw38"}],"key":"TxoUkyTKNP"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:43:44.040552Z","iopub.status.busy":"2025-01-11T17:43:44.040358Z","iopub.status.idle":"2025-01-11T17:43:44.042891Z","shell.execute_reply":"2025-01-11T17:43:44.042625Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"L, U = FNC.lufact(A)\nprint(FNC.backsub( U, FNC.forwardsub(L, b) ))","key":"LlECv8vufN"},{"type":"output","id":"4qh7swdxDQBBshqL51mq_","data":[{"name":"stdout","output_type":"stream","text":"[0.99997788 1.        ]\n"}],"key":"Tyx513vsCo"}],"key":"dHboZnpYGe"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Note that we have obtained only about 5 accurate digits for ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"tOfMMe5vLU"},{"type":"inlineMath","value":"x_1","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">x_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"ExQEYAUp5h"},{"type":"text","value":". We could make the result even more inaccurate by making ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zxRvRJkOp5"},{"type":"text","value":"ε","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"iiceKn0z4i"},{"type":"text","value":" even smaller:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qjTGS8jkMB"}],"key":"xoj01cQuOf"}],"key":"WZDsS5BOl3"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:43:44.044089Z","iopub.status.busy":"2025-01-11T17:43:44.044006Z","iopub.status.idle":"2025-01-11T17:43:44.046113Z","shell.execute_reply":"2025-01-11T17:43:44.045864Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"ep = 1e-20;\nA = array([[-ep, 1], [1, -1]])\nb = A @ array([1, 1])\nL, U = FNC.lufact(A)\nprint(FNC.backsub( U, FNC.forwardsub(L, b) ))","key":"p5oZ1VaOLD"},{"type":"output","id":"iV8NwkZymvtcvIVl5LnHt","data":[{"name":"stdout","output_type":"stream","text":"[-0.  1.]\n"}],"key":"akZAdyRNTu"}],"key":"UCFnqENQHu"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"This effect is not due to ill conditioning of the problem—a solution with PLU factorization works perfectly:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bYVIjaJhkr"}],"key":"ICxtSr5u9x"}],"key":"QaR11nAtcz"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:43:44.047325Z","iopub.status.busy":"2025-01-11T17:43:44.047247Z","iopub.status.idle":"2025-01-11T17:43:44.049179Z","shell.execute_reply":"2025-01-11T17:43:44.048933Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"print(linalg.solve(A, b))","key":"FUqBPqy3aH"},{"type":"output","id":"c2CMuCLD5zpRguDU3UCZk","data":[{"name":"stdout","output_type":"stream","text":"[1. 1.]\n"}],"key":"DLJXdSAHlx"}],"key":"QLPoxgEt60"}],"key":"j5AaMN9tpp"}],"key":"HAfgxOSqJC"}],"key":"SHWbUqn43u"}],"key":"awfupvVO4r"}],"label":"demo-pivoting-stable","identifier":"demo-pivoting-stable","html_id":"demo-pivoting-stable","enumerator":"2.6.6","key":"nF61QPOvqB"},{"type":"paragraph","position":{"start":{"line":295,"column":1},"end":{"line":295,"column":1}},"children":[{"type":"text","value":"The factors of this ","position":{"start":{"line":295,"column":1},"end":{"line":295,"column":1}},"key":"i9xmLlpoDk"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":295,"column":1},"end":{"line":295,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"hoEkOjhB07"},{"type":"text","value":" without pivoting are found to be","position":{"start":{"line":295,"column":1},"end":{"line":295,"column":1}},"key":"TTY6cSq56C"}],"key":"ouGBAGzF6c"},{"type":"math","value":"  \\mathbf{L} = \n  \\begin{bmatrix}\n    1 & 0 \\\\ -\\epsilon^{-1} & 1 \n  \\end{bmatrix}, \\qquad \n  \\mathbf{U} = \n  \\begin{bmatrix}\n    -\\epsilon & 1 \\\\ 0 & \\epsilon^{-1}-1 \n  \\end{bmatrix}.","label":"plu-stab-LU","identifier":"plu-stab-lu","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi mathvariant=\"bold\">L</mi><mo>=</mo><mrow><mo fence=\"true\">[</mo><mtable rowspacing=\"0.16em\" columnalign=\"center center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>0</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><msup><mi>ϵ</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd></mtr></mtable><mo fence=\"true\">]</mo></mrow><mo separator=\"true\">,</mo><mspace width=\"2em\"/><mi mathvariant=\"bold\">U</mi><mo>=</mo><mrow><mo fence=\"true\">[</mo><mtable rowspacing=\"0.16em\" columnalign=\"center center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mi>ϵ</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><msup><mi>ϵ</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo>−</mo><mn>1</mn></mrow></mstyle></mtd></mtr></mtable><mo fence=\"true\">]</mo></mrow><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">  \\mathbf{L} = \n  \\begin{bmatrix}\n    1 &amp; 0 \\\\ -\\epsilon^{-1} &amp; 1 \n  \\end{bmatrix}, \\qquad \n  \\mathbf{U} = \n  \\begin{bmatrix}\n    -\\epsilon &amp; 1 \\\\ 0 &amp; \\epsilon^{-1}-1 \n  \\end{bmatrix}.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">L</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.4em;vertical-align:-0.95em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">[</span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord\"><span class=\"mord mathnormal\">ϵ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.95em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">0</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.95em;\"><span></span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">]</span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:2em;\"></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathbf\">U</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.4em;vertical-align:-0.95em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">[</span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord mathnormal\">ϵ</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.95em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">ϵ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.95em;\"><span></span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">]</span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">.</span></span></span></span></span>","enumerator":"2.6.2","html_id":"plu-stab-lu","key":"kaNvGSg8Fj"},{"type":"paragraph","position":{"start":{"line":309,"column":1},"end":{"line":309,"column":1}},"children":[{"type":"text","value":"For reasons we will quantify in ","position":{"start":{"line":309,"column":1},"end":{"line":309,"column":1}},"key":"V23tAvqvBR"},{"type":"link","kind":"numref","identifier":"section-linsys-condition-number","label":"section-linsys-condition-number","url":"/condition-number","internal":true,"dataUrl":"/condition-number.json","children":[{"type":"text","value":"Conditioning of linear systems","key":"nUKTpcBkIs"}],"key":"Y91ss0oGHL"},{"type":"text","value":", the solution of ","position":{"start":{"line":309,"column":1},"end":{"line":309,"column":1}},"key":"SN8A6dp56G"},{"type":"inlineMath","value":"\\mathbf{A}\\mathbf{x}=\\mathbf{b}","position":{"start":{"line":309,"column":1},"end":{"line":309,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi><mi mathvariant=\"bold\">x</mi><mo>=</mo><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}\\mathbf{x}=\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">Ax</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"pzFvFL2QRe"},{"type":"text","value":" is well-conditioned, but the problems of solving ","position":{"start":{"line":309,"column":1},"end":{"line":309,"column":1}},"key":"F0r3oC4xr5"},{"type":"inlineMath","value":"\\mathbf{L}\\mathbf{z}=\\mathbf{b}","position":{"start":{"line":309,"column":1},"end":{"line":309,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi><mi mathvariant=\"bold\">z</mi><mo>=</mo><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}\\mathbf{z}=\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">Lz</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"R7sCHH19PW"},{"type":"text","value":" and ","position":{"start":{"line":309,"column":1},"end":{"line":309,"column":1}},"key":"u6cFCXHFT3"},{"type":"inlineMath","value":"\\mathbf{U}\\mathbf{x}=\\mathbf{z}","position":{"start":{"line":309,"column":1},"end":{"line":309,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi><mi mathvariant=\"bold\">x</mi><mo>=</mo><mi mathvariant=\"bold\">z</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}\\mathbf{x}=\\mathbf{z}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">Ux</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4444em;\"></span><span class=\"mord mathbf\">z</span></span></span></span>","key":"v0ZdErc5nO"},{"type":"text","value":" have condition numbers essentially ","position":{"start":{"line":309,"column":1},"end":{"line":309,"column":1}},"key":"J3zpYHQODu"},{"type":"inlineMath","value":"1/\\epsilon^2","position":{"start":{"line":309,"column":1},"end":{"line":309,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mi mathvariant=\"normal\">/</mi><msup><mi>ϵ</mi><mn>2</mn></msup></mrow><annotation encoding=\"application/x-tex\">1/\\epsilon^2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord\">1/</span><span class=\"mord\"><span class=\"mord mathnormal\">ϵ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span>","key":"LUXtffc31a"},{"type":"text","value":" each. Thus, for small ","position":{"start":{"line":309,"column":1},"end":{"line":309,"column":1}},"key":"ghzALa65uL"},{"type":"text","value":"ε","position":{"start":{"line":309,"column":1},"end":{"line":309,"column":1}},"key":"Kl2Uhwj51l"},{"type":"text","value":", solution of the original linear system by unpivoted LU factorization is highly unstable.","position":{"start":{"line":309,"column":1},"end":{"line":309,"column":1}},"key":"SNpOgK3sKT"}],"key":"cYkVgD3mv8"},{"type":"paragraph","position":{"start":{"line":311,"column":1},"end":{"line":311,"column":1}},"children":[{"type":"text","value":"Somewhat surprisingly, solving ","position":{"start":{"line":311,"column":1},"end":{"line":311,"column":1}},"key":"eVF76b18Zy"},{"type":"inlineMath","value":"\\mathbf{A}\\mathbf{x}=\\mathbf{b}","position":{"start":{"line":311,"column":1},"end":{"line":311,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi><mi mathvariant=\"bold\">x</mi><mo>=</mo><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}\\mathbf{x}=\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">Ax</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"uzGghGXcDA"},{"type":"text","value":" via PLU factorization is technically also unstable. In fact, examples of unstable solutions are well-known, but they have been nonexistent in practice. While there is a lot of evidence and some reasoning about why this is the case, the situation is not completely understood. Yet PLU factorization remains the algorithm of choice for general linear systems.","position":{"start":{"line":311,"column":1},"end":{"line":311,"column":1}},"key":"xTYNoPnPKb"}],"key":"rrUp25z9vv"},{"type":"heading","depth":2,"position":{"start":{"line":313,"column":1},"end":{"line":313,"column":1}},"children":[{"type":"text","value":"Exercises","position":{"start":{"line":313,"column":1},"end":{"line":313,"column":1}},"key":"hNCwLCOIO8"}],"identifier":"exercises","label":"Exercises","html_id":"exercises","implicit":true,"enumerator":"2.6.5","key":"RjgUCjsBYQ"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":315,"column":1},"end":{"line":351,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":315,"column":1},"end":{"line":328,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":315,"column":1},"end":{"line":315,"column":1}},"children":[{"type":"text","value":"✍ Perform by hand the pivoted LU factorization of each matrix.","position":{"start":{"line":315,"column":1},"end":{"line":315,"column":1}},"key":"gRO4UTQhWG"}],"key":"uxsadWMUPk"},{"type":"paragraph","position":{"start":{"line":317,"column":1},"end":{"line":327,"column":1}},"children":[{"type":"strong","position":{"start":{"line":317,"column":1},"end":{"line":317,"column":1}},"children":[{"type":"text","value":"(a)","position":{"start":{"line":317,"column":1},"end":{"line":317,"column":1}},"key":"pmjJROE5S2"}],"key":"qFx2GIRYWV"},{"type":"text","value":" ","position":{"start":{"line":317,"column":1},"end":{"line":317,"column":1}},"key":"hVAqIWANAy"},{"type":"inlineMath","value":"\\quad \\displaystyle \\begin{bmatrix}\n 2 & 3 & 4 \\\\\n 4 & 5 & 10 \\\\\n 4 & 8 & 2\n \\end{bmatrix},\\qquad","position":{"start":{"line":317,"column":1},"end":{"line":317,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mspace width=\"1em\"/><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mo fence=\"true\">[</mo><mtable rowspacing=\"0.16em\" columnalign=\"center center center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>2</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>3</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>4</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>4</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>5</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>10</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>4</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>8</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>2</mn></mstyle></mtd></mtr></mtable><mo fence=\"true\">]</mo></mrow><mo separator=\"true\">,</mo><mspace width=\"2em\"/></mstyle></mrow><annotation encoding=\"application/x-tex\">\\quad \\displaystyle \\begin{bmatrix}\n 2 &amp; 3 &amp; 4 \\\\\n 4 &amp; 5 &amp; 10 \\\\\n 4 &amp; 8 &amp; 2\n \\end{bmatrix},\\qquad</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:3.6em;vertical-align:-1.55em;\"></span><span class=\"mspace\" style=\"margin-right:1em;\"></span><span class=\"minner\"><span class=\"mopen\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.05em;\"><span style=\"top:-2.25em;\"><span class=\"pstrut\" style=\"height:3.155em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎣</span></span></span><span style=\"top:-3.397em;\"><span class=\"pstrut\" style=\"height:3.155em;\"></span><span style=\"height:0.016em;width:0.6667em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.6667em' height='0.016em' style='width:0.6667em' viewBox='0 0 666.67 16' preserveAspectRatio='xMinYMin'><path d='M319 0 H403 V16 H319z M319 0 H403 V16 H319z'/></svg></span></span><span style=\"top:-4.05em;\"><span class=\"pstrut\" style=\"height:3.155em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎡</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.55em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.05em;\"><span style=\"top:-4.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">2</span></span></span><span style=\"top:-3.01em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">4</span></span></span><span style=\"top:-1.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">4</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.55em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.05em;\"><span style=\"top:-4.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">3</span></span></span><span style=\"top:-3.01em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">5</span></span></span><span style=\"top:-1.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">8</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.55em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.05em;\"><span style=\"top:-4.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">4</span></span></span><span style=\"top:-3.01em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">10</span></span></span><span style=\"top:-1.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.55em;\"><span></span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.05em;\"><span style=\"top:-2.25em;\"><span class=\"pstrut\" style=\"height:3.155em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎦</span></span></span><span style=\"top:-3.397em;\"><span class=\"pstrut\" style=\"height:3.155em;\"></span><span style=\"height:0.016em;width:0.6667em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.6667em' height='0.016em' style='width:0.6667em' viewBox='0 0 666.67 16' preserveAspectRatio='xMinYMin'><path d='M263 0 H347 V16 H263z M263 0 H347 V16 H263z'/></svg></span></span><span style=\"top:-4.05em;\"><span class=\"pstrut\" style=\"height:3.155em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎤</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.55em;\"><span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:2em;\"></span></span></span></span>","key":"NJRdniEmV1"},{"type":"text","value":"\n","position":{"start":{"line":317,"column":1},"end":{"line":317,"column":1}},"key":"sFLvAXs5j7"},{"type":"strong","position":{"start":{"line":317,"column":1},"end":{"line":317,"column":1}},"children":[{"type":"text","value":"(b)","position":{"start":{"line":317,"column":1},"end":{"line":317,"column":1}},"key":"Jad7LiRAek"}],"key":"AFYRIqHo3q"},{"type":"text","value":" ","position":{"start":{"line":317,"column":1},"end":{"line":317,"column":1}},"key":"caeSk7hEbE"},{"type":"inlineMath","value":"\\quad \\displaystyle \\begin{bmatrix}\n 1 & 4 & 5 & -5 \\\\\n -1 & 0 & -1 & -5 \\\\\n 1 & 3 & -1 & 2 \\\\\n 1 & -1 & 5 & -1 \n \\end{bmatrix}","position":{"start":{"line":317,"column":1},"end":{"line":317,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mspace width=\"1em\"/><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mo fence=\"true\">[</mo><mtable rowspacing=\"0.16em\" columnalign=\"center center center center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>4</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>5</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mn>5</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mn>1</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mn>1</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mn>5</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>3</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mn>1</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>2</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mn>1</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>5</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mn>1</mn></mrow></mstyle></mtd></mtr></mtable><mo fence=\"true\">]</mo></mrow></mstyle></mrow><annotation encoding=\"application/x-tex\">\\quad \\displaystyle \\begin{bmatrix}\n 1 &amp; 4 &amp; 5 &amp; -5 \\\\\n -1 &amp; 0 &amp; -1 &amp; -5 \\\\\n 1 &amp; 3 &amp; -1 &amp; 2 \\\\\n 1 &amp; -1 &amp; 5 &amp; -1 \n \\end{bmatrix}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:4.8001em;vertical-align:-2.15em;\"></span><span class=\"mspace\" style=\"margin-right:1em;\"></span><span class=\"minner\"><span class=\"mopen\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.65em;\"><span style=\"top:-1.711em;\"><span class=\"pstrut\" style=\"height:3.216em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎣</span></span></span><span style=\"top:-2.858em;\"><span class=\"pstrut\" style=\"height:3.216em;\"></span><span style=\"height:1.216em;width:0.6667em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.6667em' height='1.216em' style='width:0.6667em' viewBox='0 0 666.67 1216' preserveAspectRatio='xMinYMin'><path d='M319 0 H403 V1216 H319z M319 0 H403 V1216 H319z'/></svg></span></span><span style=\"top:-4.7111em;\"><span class=\"pstrut\" style=\"height:3.216em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎡</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.65em;\"><span style=\"top:-4.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord\">1</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span><span style=\"top:-1.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.15em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.65em;\"><span style=\"top:-4.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">4</span></span></span><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">0</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">3</span></span></span><span style=\"top:-1.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.15em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.65em;\"><span style=\"top:-4.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">5</span></span></span><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord\">1</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord\">1</span></span></span><span style=\"top:-1.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">5</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.15em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.65em;\"><span style=\"top:-4.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord\">5</span></span></span><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord\">5</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">2</span></span></span><span style=\"top:-1.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.15em;\"><span></span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.65em;\"><span style=\"top:-1.711em;\"><span class=\"pstrut\" style=\"height:3.216em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎦</span></span></span><span style=\"top:-2.858em;\"><span class=\"pstrut\" style=\"height:3.216em;\"></span><span style=\"height:1.216em;width:0.6667em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.6667em' height='1.216em' style='width:0.6667em' viewBox='0 0 666.67 1216' preserveAspectRatio='xMinYMin'><path d='M263 0 H347 V1216 H263z M263 0 H347 V1216 H263z'/></svg></span></span><span style=\"top:-4.7111em;\"><span class=\"pstrut\" style=\"height:3.216em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎤</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.15em;\"><span></span></span></span></span></span></span></span></span></span></span>","key":"a4AJZrMq3X"},{"type":"text","value":".","position":{"start":{"line":317,"column":1},"end":{"line":317,"column":1}},"key":"j8RHVqExwE"}],"key":"F4raXkcSSh"}],"key":"xj4eyFAmCz"},{"type":"listItem","spread":true,"position":{"start":{"line":329,"column":1},"end":{"line":343,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":329,"column":1},"end":{"line":329,"column":1}},"children":[{"type":"text","value":"✍ Let ","position":{"start":{"line":329,"column":1},"end":{"line":329,"column":1}},"key":"DeHFejQHdA"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":329,"column":1},"end":{"line":329,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"SQlMJkVlg9"},{"type":"text","value":" be a square matrix and ","position":{"start":{"line":329,"column":1},"end":{"line":329,"column":1}},"key":"V8jXGq0QjU"},{"type":"inlineMath","value":"\\mathbf{b}","position":{"start":{"line":329,"column":1},"end":{"line":329,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"EO36Xfwl5n"},{"type":"text","value":" be a column vector of compatible length. Here is correct Julia code to solve ","position":{"start":{"line":329,"column":1},"end":{"line":329,"column":1}},"key":"gdo9noDKyB"},{"type":"inlineMath","value":"\\mathbf{A}\\mathbf{x}=\\mathbf{b}","position":{"start":{"line":329,"column":1},"end":{"line":329,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi><mi mathvariant=\"bold\">x</mi><mo>=</mo><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}\\mathbf{x}=\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">Ax</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"aL4oZsw5YS"},{"type":"text","value":":","position":{"start":{"line":329,"column":1},"end":{"line":329,"column":1}},"key":"lS8ChMT40L"}],"key":"sbfOFnYG3n"},{"type":"code","lang":"julia","value":"L,U,p = lu(A)\nx = U \\ (L\\b[p])","position":{"start":{"line":331,"column":1},"end":{"line":334,"column":1}},"key":"PlsYGiRzed"},{"type":"paragraph","position":{"start":{"line":336,"column":1},"end":{"line":336,"column":1}},"children":[{"type":"text","value":"Suppose instead you replace the last line above with","position":{"start":{"line":336,"column":1},"end":{"line":336,"column":1}},"key":"wczLOGjLe0"}],"key":"yU1IS0Yy0o"},{"type":"code","lang":"julia","value":"x = U \\ L \\ b[p]","position":{"start":{"line":338,"column":1},"end":{"line":340,"column":1}},"key":"Y0Mdea0r0K"},{"type":"paragraph","position":{"start":{"line":342,"column":1},"end":{"line":342,"column":1}},"children":[{"type":"text","value":"Mathematically in terms of ","position":{"start":{"line":342,"column":1},"end":{"line":342,"column":1}},"key":"OWIrP5Elgi"},{"type":"inlineMath","value":"\\mathbf{L}","position":{"start":{"line":342,"column":1},"end":{"line":342,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">L</span></span></span></span>","key":"xuSszaoTfF"},{"type":"text","value":", ","position":{"start":{"line":342,"column":1},"end":{"line":342,"column":1}},"key":"LW5XLBwnnz"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":342,"column":1},"end":{"line":342,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"clorQ6QRwu"},{"type":"text","value":", ","position":{"start":{"line":342,"column":1},"end":{"line":342,"column":1}},"key":"bupsSRGSo6"},{"type":"inlineMath","value":"\\mathbf{p}","position":{"start":{"line":342,"column":1},"end":{"line":342,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">p</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{p}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6389em;vertical-align:-0.1944em;\"></span><span class=\"mord mathbf\">p</span></span></span></span>","key":"u20OWcyUFa"},{"type":"text","value":", and ","position":{"start":{"line":342,"column":1},"end":{"line":342,"column":1}},"key":"gjGjGCwJkX"},{"type":"inlineMath","value":"\\mathbf{b}","position":{"start":{"line":342,"column":1},"end":{"line":342,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"ZwyoS0l4n4"},{"type":"text","value":", what vector is found?","position":{"start":{"line":342,"column":1},"end":{"line":342,"column":1}},"key":"POcfEFwaik"}],"key":"vXrca8fCVD"}],"key":"VbjkV08xlH"},{"type":"listItem","spread":true,"position":{"start":{"line":344,"column":1},"end":{"line":351,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":344,"column":1},"end":{"line":344,"column":1}},"children":[{"type":"text","value":"✍ Suppose that ","position":{"start":{"line":344,"column":1},"end":{"line":344,"column":1}},"key":"YjrmKP6rBj"},{"type":"inlineCode","value":"A","position":{"start":{"line":344,"column":1},"end":{"line":344,"column":1}},"key":"aYuEG05Cd3"},{"type":"text","value":" is a ","position":{"start":{"line":344,"column":1},"end":{"line":344,"column":1}},"key":"ImAAUpGey5"},{"type":"inlineMath","value":"4\\times 6","position":{"start":{"line":344,"column":1},"end":{"line":344,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>4</mn><mo>×</mo><mn>6</mn></mrow><annotation encoding=\"application/x-tex\">4\\times 6</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">4</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">6</span></span></span></span>","key":"Sz7JZUywFi"},{"type":"text","value":" matrix in Julia and you define","position":{"start":{"line":344,"column":1},"end":{"line":344,"column":1}},"key":"MdpzOx3YWY"}],"key":"f5SLF9pq0d"},{"type":"code","lang":"julia","value":"B = A[end:-1:1,end:-1:1]","position":{"start":{"line":346,"column":1},"end":{"line":348,"column":1}},"key":"l4C3mQGxyE"},{"type":"paragraph","position":{"start":{"line":350,"column":1},"end":{"line":350,"column":1}},"children":[{"type":"text","value":"Show that ","position":{"start":{"line":350,"column":1},"end":{"line":350,"column":1}},"key":"unfFE2UYjP"},{"type":"inlineMath","value":"\\mathbf{B} = \\mathbf{P} \\mathbf{A} \\mathbf{Q}","position":{"start":{"line":350,"column":1},"end":{"line":350,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">B</mi><mo>=</mo><mi mathvariant=\"bold\">P</mi><mi mathvariant=\"bold\">A</mi><mi mathvariant=\"bold\">Q</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{B} = \\mathbf{P} \\mathbf{A} \\mathbf{Q}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">B</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8805em;vertical-align:-0.1944em;\"></span><span class=\"mord mathbf\">PAQ</span></span></span></span>","key":"j2x9ScqGZU"},{"type":"text","value":" for certain matrices ","position":{"start":{"line":350,"column":1},"end":{"line":350,"column":1}},"key":"MHfzpmfnnl"},{"type":"inlineMath","value":"\\mathbf{P}","position":{"start":{"line":350,"column":1},"end":{"line":350,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">P</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{P}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">P</span></span></span></span>","key":"EZe38V3921"},{"type":"text","value":" and ","position":{"start":{"line":350,"column":1},"end":{"line":350,"column":1}},"key":"iZNW66pPtw"},{"type":"inlineMath","value":"\\mathbf{Q}","position":{"start":{"line":350,"column":1},"end":{"line":350,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">Q</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{Q}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8805em;vertical-align:-0.1944em;\"></span><span class=\"mord mathbf\">Q</span></span></span></span>","key":"E0VuuJE8lm"},{"type":"text","value":".","position":{"start":{"line":350,"column":1},"end":{"line":350,"column":1}},"key":"HsdDtxtcY1"}],"key":"Ja2oIFpxn4"}],"key":"yL14W4YQOu"}],"key":"iW3olDFWpK"},{"type":"list","ordered":true,"start":4,"spread":false,"position":{"start":{"line":353,"column":1},"end":{"line":363,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":353,"column":1},"end":{"line":363,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":353,"column":1},"end":{"line":353,"column":1}},"children":[{"type":"text","value":"✍ An ","position":{"start":{"line":353,"column":1},"end":{"line":353,"column":1}},"key":"ag5orw3Kxe"},{"type":"inlineMath","value":"n\\times n","position":{"start":{"line":353,"column":1},"end":{"line":353,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>×</mo><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n\\times n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"BVk1eH4KKE"},{"type":"text","value":" ","position":{"start":{"line":353,"column":1},"end":{"line":353,"column":1}},"key":"i5HXH1Rwpt"},{"type":"emphasis","position":{"start":{"line":353,"column":1},"end":{"line":353,"column":1}},"children":[{"type":"text","value":"permutation matrix","position":{"start":{"line":353,"column":1},"end":{"line":353,"column":1}},"key":"PIheKNczcx"}],"key":"B0kJ2htgJm"},{"type":"text","value":" ","position":{"start":{"line":353,"column":1},"end":{"line":353,"column":1}},"key":"afteZF35NU"},{"type":"inlineMath","value":"\\mathbf{P}","position":{"start":{"line":353,"column":1},"end":{"line":353,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">P</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{P}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">P</span></span></span></span>","key":"Ui6S9jQ7uv"},{"type":"text","value":" is a reordering of the rows of an identity matrix such that ","position":{"start":{"line":353,"column":1},"end":{"line":353,"column":1}},"key":"lDuivkP1Dp"},{"type":"inlineMath","value":"\\mathbf{P} \\mathbf{A}","position":{"start":{"line":353,"column":1},"end":{"line":353,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">P</mi><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{P} \\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">PA</span></span></span></span>","key":"FYYFgItxVz"},{"type":"text","value":"  has the effect of moving rows ","position":{"start":{"line":353,"column":1},"end":{"line":353,"column":1}},"key":"YdLUusifwg"},{"type":"inlineMath","value":"1,2,\\ldots,n","position":{"start":{"line":353,"column":1},"end":{"line":353,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mo separator=\"true\">,</mo><mn>2</mn><mo separator=\"true\">,</mo><mo>…</mo><mo separator=\"true\">,</mo><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">1,2,\\ldots,n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8389em;vertical-align:-0.1944em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">2</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"enjaqWkVmd"},{"type":"text","value":" of ","position":{"start":{"line":353,"column":1},"end":{"line":353,"column":1}},"key":"ooDktYi8Me"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":353,"column":1},"end":{"line":353,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"TSBy16U6KB"},{"type":"text","value":" to new positions ","position":{"start":{"line":353,"column":1},"end":{"line":353,"column":1}},"key":"BYZKvIjY6r"},{"type":"inlineMath","value":"i_1,i_2,\\ldots,i_n","position":{"start":{"line":353,"column":1},"end":{"line":353,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>i</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><msub><mi>i</mi><mn>2</mn></msub><mo separator=\"true\">,</mo><mo>…</mo><mo separator=\"true\">,</mo><msub><mi>i</mi><mi>n</mi></msub></mrow><annotation encoding=\"application/x-tex\">i_1,i_2,\\ldots,i_n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"C31q79J4jm"},{"type":"text","value":". Then ","position":{"start":{"line":353,"column":1},"end":{"line":353,"column":1}},"key":"Vs1Rq64bRP"},{"type":"inlineMath","value":"\\mathbf{P}","position":{"start":{"line":353,"column":1},"end":{"line":353,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">P</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{P}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">P</span></span></span></span>","key":"SKIp8J9Xx8"},{"type":"text","value":" can be expressed as","position":{"start":{"line":353,"column":1},"end":{"line":353,"column":1}},"key":"ib6p9zS5Cp"}],"key":"f5IBALLvNz"},{"type":"math","value":"\\mathbf{P} = \\mathbf{e}_{i_1}\\mathbf{e}_1^T + \\mathbf{e}_{i_2}\\mathbf{e}_2^T + \\cdots + \\mathbf{e}_{i_n}\\mathbf{e}_n^T.","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi mathvariant=\"bold\">P</mi><mo>=</mo><msub><mi mathvariant=\"bold\">e</mi><msub><mi>i</mi><mn>1</mn></msub></msub><msubsup><mi mathvariant=\"bold\">e</mi><mn>1</mn><mi>T</mi></msubsup><mo>+</mo><msub><mi mathvariant=\"bold\">e</mi><msub><mi>i</mi><mn>2</mn></msub></msub><msubsup><mi mathvariant=\"bold\">e</mi><mn>2</mn><mi>T</mi></msubsup><mo>+</mo><mo>⋯</mo><mo>+</mo><msub><mi mathvariant=\"bold\">e</mi><msub><mi>i</mi><mi>n</mi></msub></msub><msubsup><mi mathvariant=\"bold\">e</mi><mi>n</mi><mi>T</mi></msubsup><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{P} = \\mathbf{e}_{i_1}\\mathbf{e}_1^T + \\mathbf{e}_{i_2}\\mathbf{e}_2^T + \\cdots + \\mathbf{e}_{i_n}\\mathbf{e}_n^T.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">P</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1414em;vertical-align:-0.2501em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">e</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3173em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2501em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathbf\">e</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913em;\"><span style=\"top:-2.453em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1414em;vertical-align:-0.2501em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">e</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3173em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2501em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathbf\">e</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913em;\"><span style=\"top:-2.453em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"minner\">⋯</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1414em;vertical-align:-0.2501em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">e</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1645em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2501em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathbf\">e</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913em;\"><span style=\"top:-2.453em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span><span class=\"mord\">.</span></span></span></span></span>","enumerator":"2.6.3","key":"jpnnCfbgpt"},{"type":"paragraph","position":{"start":{"line":359,"column":1},"end":{"line":359,"column":1}},"children":[{"type":"strong","position":{"start":{"line":359,"column":1},"end":{"line":359,"column":1}},"children":[{"type":"text","value":"(a)","position":{"start":{"line":359,"column":1},"end":{"line":359,"column":1}},"key":"fgwHU6RxXw"}],"key":"fi4N4Z43qR"},{"type":"text","value":" For the case ","position":{"start":{"line":359,"column":1},"end":{"line":359,"column":1}},"key":"VV8uWCSX6A"},{"type":"inlineMath","value":"n=4","position":{"start":{"line":359,"column":1},"end":{"line":359,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>=</mo><mn>4</mn></mrow><annotation encoding=\"application/x-tex\">n=4</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">4</span></span></span></span>","key":"f1tI9zCx7l"},{"type":"text","value":" and ","position":{"start":{"line":359,"column":1},"end":{"line":359,"column":1}},"key":"b9hwSJ3CJ5"},{"type":"inlineMath","value":"i_1=3","position":{"start":{"line":359,"column":1},"end":{"line":359,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>i</mi><mn>1</mn></msub><mo>=</mo><mn>3</mn></mrow><annotation encoding=\"application/x-tex\">i_1=3</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8095em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">3</span></span></span></span>","key":"WuIEF5BnWo"},{"type":"text","value":", ","position":{"start":{"line":359,"column":1},"end":{"line":359,"column":1}},"key":"UXh3YMxDPr"},{"type":"inlineMath","value":"i_2=2","position":{"start":{"line":359,"column":1},"end":{"line":359,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>i</mi><mn>2</mn></msub><mo>=</mo><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">i_2=2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8095em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span></span></span></span>","key":"PTHtcMS526"},{"type":"text","value":", ","position":{"start":{"line":359,"column":1},"end":{"line":359,"column":1}},"key":"feiEVP5UqX"},{"type":"inlineMath","value":"i_3=4","position":{"start":{"line":359,"column":1},"end":{"line":359,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>i</mi><mn>3</mn></msub><mo>=</mo><mn>4</mn></mrow><annotation encoding=\"application/x-tex\">i_3=4</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8095em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">4</span></span></span></span>","key":"KmXzWJG8Gc"},{"type":"text","value":", ","position":{"start":{"line":359,"column":1},"end":{"line":359,"column":1}},"key":"uxf2TF4YFH"},{"type":"inlineMath","value":"i_4=1","position":{"start":{"line":359,"column":1},"end":{"line":359,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>i</mi><mn>4</mn></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">i_4=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8095em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">4</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"UuReWXXacK"},{"type":"text","value":", write out separately, as matrices, all four of the terms in the sum. Then add them together to find ","position":{"start":{"line":359,"column":1},"end":{"line":359,"column":1}},"key":"hp0wxDLOeF"},{"type":"inlineMath","value":"\\mathbf{P}","position":{"start":{"line":359,"column":1},"end":{"line":359,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">P</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{P}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">P</span></span></span></span>","key":"oA0yzfhRzH"},{"type":"text","value":".","position":{"start":{"line":359,"column":1},"end":{"line":359,"column":1}},"key":"twu6Tx5gOp"}],"key":"QzyC9j8zSR"},{"type":"paragraph","position":{"start":{"line":361,"column":1},"end":{"line":361,"column":1}},"children":[{"type":"strong","position":{"start":{"line":361,"column":1},"end":{"line":361,"column":1}},"children":[{"type":"text","value":"(b)","position":{"start":{"line":361,"column":1},"end":{"line":361,"column":1}},"key":"UV4iUJJhmr"}],"key":"lS3RbNQ1Jp"},{"type":"text","value":" Use the formula in the general case to show that ","position":{"start":{"line":361,"column":1},"end":{"line":361,"column":1}},"key":"qMliSogduI"},{"type":"inlineMath","value":"\\mathbf{P}^{-1}=\\mathbf{P}^T","position":{"start":{"line":361,"column":1},"end":{"line":361,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi mathvariant=\"bold\">P</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo>=</mo><msup><mi mathvariant=\"bold\">P</mi><mi>T</mi></msup></mrow><annotation encoding=\"application/x-tex\">\\mathbf{P}^{-1}=\\mathbf{P}^T</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">P</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8413em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">P</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span></span></span></span>","key":"wDqFU3Czbz"},{"type":"text","value":".","position":{"start":{"line":361,"column":1},"end":{"line":361,"column":1}},"key":"wDYuzFJiFs"}],"key":"ftSguu5vfk"}],"key":"FcL1AVzkwZ"}],"label":"problem-perminverse","identifier":"problem-perminverse","html_id":"problem-perminverse","key":"pNdVX1S8I0"},{"type":"footnoteDefinition","identifier":"plu","label":"PLU","position":{"start":{"line":361,"column":1},"end":{"line":361,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":155,"column":1},"end":{"line":155,"column":1}},"children":[{"type":"text","value":"Because unpivoted LU factorization is not useful, in practice the term ","position":{"start":{"line":155,"column":1},"end":{"line":155,"column":1}},"key":"cbutCcttfC"},{"type":"emphasis","position":{"start":{"line":155,"column":1},"end":{"line":155,"column":1}},"children":[{"type":"text","value":"LU factorization","position":{"start":{"line":155,"column":1},"end":{"line":155,"column":1}},"key":"QAEi9mliX1"}],"key":"IWHPfny8UB"},{"type":"text","value":" mostly refers to pivoted LU.","position":{"start":{"line":155,"column":1},"end":{"line":155,"column":1}},"key":"OilIEZ8Lbp"}],"key":"IEiCGW06eM"}],"number":1,"enumerator":"1","key":"nqzOx5iYNF"}],"key":"f8GAxzHmVi"}],"key":"UXvIXk7fVf"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Efficiency of matrix computations","url":"/efficiency","group":"Preface"},"next":{"title":"Vector and matrix norms","url":"/norms","group":"Preface"}}},"domain":"http://localhost:3000"}