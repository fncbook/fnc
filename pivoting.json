{"version":1,"kind":"Article","sha256":"9943caaa3608cc7dba7fb2247eaa267ef01b5d0c7680167d5fdcda3ea07873f8","slug":"pivoting","location":"/chapter2/pivoting.md","dependencies":[{"url":"/chapter2","label":"demo-pivoting-fail-julia","kind":"Notebook","slug":"chapter2","location":"/julia/chapter2.md","title":"Chapter 2"},{"url":"/chapter2-1","label":"demo-pivoting-fail-matlab","kind":"Notebook","slug":"chapter2-1","location":"/matlab/chapter2.md","title":"Chapter 2"},{"url":"/chapter2-2","label":"demo-pivoting-fail-python","kind":"Notebook","slug":"chapter2-2","location":"/python/chapter2.md","title":"Chapter 2"}],"frontmatter":{"title":"Row pivoting","numbering":{"heading_1":{"enabled":true},"heading_2":{"enabled":true},"heading_3":{"enabled":false},"enumerator":{"enumerator":"2.6.%s"},"title":{"offset":1}},"content_includes_title":false,"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","TPBVP":"two-point boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"edit_url":"https://github.com/fncbook/fnc/blob/master/chapter2/pivoting.md","exports":[{"format":"md","filename":"pivoting.md","url":"/build/pivoting-322f1780bde0b866ed551613c5b78c2f.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"As mentioned in ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"VS1IF5Godb"},{"type":"link","kind":"numref","identifier":"section-linsys-lu","label":"section-linsys-lu","url":"/lu","internal":true,"dataUrl":"/lu.json","children":[{"type":"text","value":"LU factorization","key":"vKkv7pdgun"}],"key":"Mam6Qo3GTk"},{"type":"text","value":", the ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"P1lyMlFxxx"},{"type":"inlineMath","value":"\\mathbf{A}=\\mathbf{L}\\mathbf{U}","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi><mo>=</mo><mi mathvariant=\"bold\">L</mi><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}=\\mathbf{L}\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">LU</span></span></span></span>","key":"H1FTIFiUz9"},{"type":"text","value":" factorization is not stable for every nonsingular ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"jNZZGRxPBX"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"JImDIBD3V6"},{"type":"text","value":". Indeed, the factorization does not always even exist.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"IcIvQdXwaT"}],"indexEntries":[{"entry":"matrix factorization","subEntry":{"value":"LU","kind":"entry"},"emphasis":false}],"label":"index-AxfF7slTSA","identifier":"index-axff7sltsa","html_id":"index-axff7sltsa","key":"yOzYzsCDb1"},{"type":"proof","kind":"example","enumerated":true,"children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Failure of naive LU factorization","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"GZ61EUgtE3"}],"key":"OADH4g1Uwi"},{"type":"tabSet","children":[{"type":"tabItem","title":"Julia","sync":"julia","children":[{"type":"embed","source":{"url":"/chapter2","label":"demo-pivoting-fail-julia","kind":"Notebook","slug":"chapter2","location":"/julia/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-pivoting-fail","label":"demo-pivoting-fail","kind":"proof:example","position":{"start":{"line":832,"column":1},"end":{"line":832,"column":20}},"children":[{"type":"text","value":"Example ","key":"MCsnojx37g"},{"type":"text","value":"2.6.1","key":"Wn2bU4FtKj"}],"template":"Example %s","enumerator":"2.6.1","resolved":true,"html_id":"demo-pivoting-fail","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"JVs7NcG2fP"}],"key":"dpd4pgzKCA"},{"type":"paragraph","position":{"start":{"line":834,"column":1},"end":{"line":834,"column":1}},"children":[{"type":"text","value":"Here is a previously encountered matrix that factors well.","position":{"start":{"line":834,"column":1},"end":{"line":834,"column":1}},"key":"pQ2gOfEk4d"}],"key":"lVBaT6LD8M"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"A = [2 0 4 3 ; -4 5 -7 -10 ; 1 15 2 -4.5 ; -2 0 2 -13];\nL, U = FNC.lufact(A)\nL","key":"Aj62ITj07D"},{"type":"output","id":"FeWYLEHqhQAw2r4G4oPJO","data":[{"output_type":"execute_result","execution_count":78,"metadata":{},"data":{"text/plain":{"content":"4×4 LowerTriangular{Float64, Matrix{Float64}}:\n  1.0   ⋅     ⋅    ⋅ \n -2.0  1.0    ⋅    ⋅ \n  0.5  3.0   1.0   ⋅ \n -1.0  0.0  -2.0  1.0","content_type":"text/plain"}}}],"key":"wtCO6Fywxs"}],"data":{},"key":"wcWhzsa86D"},{"type":"paragraph","position":{"start":{"line":842,"column":1},"end":{"line":842,"column":1}},"children":[{"type":"text","value":"If we swap the second and fourth rows of ","position":{"start":{"line":842,"column":1},"end":{"line":842,"column":1}},"key":"NBQyczSYgG"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":842,"column":1},"end":{"line":842,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"iUQMlakN3R"},{"type":"text","value":", the result is still nonsingular. However, the factorization now fails.","position":{"start":{"line":842,"column":1},"end":{"line":842,"column":1}},"key":"a9eD9dFppP"}],"key":"E84CGqgGWg"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"A[[2, 4], :] = A[[4, 2], :]  \nL, U = FNC.lufact(A)\nL","key":"OhkHNFTUQP"},{"type":"output","id":"ULxB4W4Ufwy9FrJEhxo1U","data":[{"output_type":"execute_result","execution_count":79,"metadata":{},"data":{"text/plain":{"content":"4×4 LowerTriangular{Float64, Matrix{Float64}}:\n  1.0     ⋅      ⋅    ⋅ \n -1.0  NaN       ⋅    ⋅ \n  0.5   Inf   NaN     ⋅ \n -2.0   Inf   NaN    1.0","content_type":"text/plain"}}}],"key":"CDXAZsl2fS"}],"data":{},"key":"Lz9aAY0HgH"},{"type":"paragraph","position":{"start":{"line":853,"column":1},"end":{"line":853,"column":1}},"children":[{"type":"text","value":"The presence of ","position":{"start":{"line":853,"column":1},"end":{"line":853,"column":1}},"key":"pCmiaazgKz"},{"type":"inlineCode","value":"NaN","position":{"start":{"line":853,"column":1},"end":{"line":853,"column":1}},"key":"JDFXdBmZqz"},{"type":"text","value":" in the result indicates that some impossible operation was required. The source of the problem is easy to locate. We can find the first outer product in the factorization just fine:","position":{"start":{"line":853,"column":1},"end":{"line":853,"column":1}},"key":"dWPLao0ZSM"}],"indexEntries":[{"entry":"Julia","subEntry":{"value":"NaN","kind":"entry"},"emphasis":false}],"key":"lu1NrGkGKZ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"U[1, :] = A[1, :]\nL[:, 1] = A[:, 1] / U[1, 1]\nA -= L[:, 1] * U[1, :]'","key":"YGFBWQbgg9"},{"type":"output","id":"mI6xNSc_Ee_T2EI1pgxEk","data":[{"output_type":"execute_result","execution_count":80,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n 0.0   0.0  0.0    0.0\n 0.0   0.0  6.0  -10.0\n 0.0  15.0  0.0   -6.0\n 0.0   5.0  1.0   -4.0","content_type":"text/plain"}}}],"key":"HUIxTWeBhQ"}],"data":{},"key":"hs6qiYAmUJ"},{"type":"paragraph","position":{"start":{"line":861,"column":1},"end":{"line":861,"column":1}},"children":[{"type":"text","value":"The next step is ","position":{"start":{"line":861,"column":1},"end":{"line":861,"column":1}},"key":"Of765cn4KX"},{"type":"inlineCode","value":"U[2, :] = A[2, :]","position":{"start":{"line":861,"column":1},"end":{"line":861,"column":1}},"key":"nzWI4NuXCA"},{"type":"text","value":", which is also OK. But then we are supposed to divide by ","position":{"start":{"line":861,"column":1},"end":{"line":861,"column":1}},"key":"pyDtiZkqHS"},{"type":"inlineCode","value":"U[2, 2]","position":{"start":{"line":861,"column":1},"end":{"line":861,"column":1}},"key":"YycMgjjPK8"},{"type":"text","value":", which is zero. The algorithm cannot continue.","position":{"start":{"line":861,"column":1},"end":{"line":861,"column":1}},"key":"LnpSaOvKqI"}],"key":"V71qFZCdEP"}],"key":"mUZnIiNjDG"}],"key":"sjsYfe6k85"}],"key":"F2wLNdRTO3"},{"type":"tabItem","title":"MATLAB","sync":"matlab","children":[{"type":"embed","source":{"url":"/chapter2-1","label":"demo-pivoting-fail-matlab","kind":"Notebook","slug":"chapter2-1","location":"/matlab/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-pivoting-fail","label":"demo-pivoting-fail","kind":"proof:example","position":{"start":{"line":770,"column":1},"end":{"line":770,"column":20}},"children":[{"type":"text","value":"Example ","key":"UVL6x9lSQC"},{"type":"text","value":"2.6.1","key":"btrZCEpIf7"}],"template":"Example %s","enumerator":"2.6.1","resolved":true,"html_id":"demo-pivoting-fail","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"FAmecAj4oN"}],"key":"pzEpJUORqV"},{"type":"paragraph","position":{"start":{"line":772,"column":1},"end":{"line":772,"column":1}},"children":[{"type":"text","value":"Here is a previously encountered matrix that factors well.","position":{"start":{"line":772,"column":1},"end":{"line":772,"column":1}},"key":"JUoWc7lNbv"}],"key":"xIR6UP26fa"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A = [\n    2 0 4 3\n    -4 5 -7 -10\n    1 15 2 -4.5\n    -2 0 2 -13\n    ];\n[L, U] = lufact(A);\nL","key":"WQeojZt6NM"},{"type":"output","id":"oP2kS4675H2b8RsQSa8gd","data":[{"output_type":"stream","name":"stderr","text":"Failed to execute. Operation may have interrupted by user."}],"key":"kceUhHkGOw"}],"data":{},"key":"sKcQS5TElS"},{"type":"paragraph","position":{"start":{"line":785,"column":1},"end":{"line":785,"column":1}},"children":[{"type":"text","value":"If we swap the second and fourth rows of ","position":{"start":{"line":785,"column":1},"end":{"line":785,"column":1}},"key":"lMzsqerkuR"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":785,"column":1},"end":{"line":785,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"hFxuVTUf5h"},{"type":"text","value":", the result is still nonsingular. However, the factorization now fails.","position":{"start":{"line":785,"column":1},"end":{"line":785,"column":1}},"key":"AXra5AefwD"}],"key":"lJTDI0lUBs"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A([2, 4], :) = A([4, 2], :);    % swap rows 2 and 4\n[L, U] = lufact(A);\nL","key":"zb3psms3SY"},{"type":"output","id":"9JefGBBFtV2y1O-rqiUuD","data":[{"output_type":"execute_result","execution_count":77,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>L = 4×4 double\n   1.0000e+00            0            0            0\n  -1.0000e+00          NaN            0            0\n   5.0000e-01          Inf          NaN            0\n  -2.0000e+00          Inf          NaN   1.0000e+00\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"L = 4×4 double\n   1.0000e+00            0            0            0\n  -1.0000e+00          NaN            0            0\n   5.0000e-01          Inf          NaN            0\n  -2.0000e+00          Inf          NaN   1.0000e+00\n","content_type":"text/plain"}}}],"key":"YkGOoiu1B5"}],"data":{},"key":"zmLHhzMJ00"},{"type":"paragraph","position":{"start":{"line":796,"column":1},"end":{"line":796,"column":1}},"children":[{"type":"text","value":"The presence of ","position":{"start":{"line":796,"column":1},"end":{"line":796,"column":1}},"key":"BRQ7GpvjdF"},{"type":"inlineCode","value":"NaN","position":{"start":{"line":796,"column":1},"end":{"line":796,"column":1}},"key":"AizceQaYQQ"},{"type":"text","value":" in the result indicates that some impossible operation was required. The source of the problem is easy to locate. We can find the first outer product in the factorization just fine:","position":{"start":{"line":796,"column":1},"end":{"line":796,"column":1}},"key":"XjCFFf3ZCS"}],"indexEntries":[{"entry":"MATLAB","subEntry":{"value":"NaN","kind":"entry"},"emphasis":false}],"key":"ukZd1LjG9J"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"U(1, :) = A(1, :);\nL(:, 1) = A(:, 1) / U(1, 1)\nA = A - L(:, 1) * U(1, :)","key":"nmllxCUDJ3"},{"type":"output","id":"29nWx2N22rzxVaXABYJOI","data":[{"output_type":"execute_result","execution_count":78,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>L = 4×4 double\n   1.0000e+00            0            0            0\n  -1.0000e+00          NaN            0            0\n   5.0000e-01          Inf          NaN            0\n  -2.0000e+00          Inf          NaN   1.0000e+00\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"L = 4×4 double\n   1.0000e+00            0            0            0\n  -1.0000e+00          NaN            0            0\n   5.0000e-01          Inf          NaN            0\n  -2.0000e+00          Inf          NaN   1.0000e+00\n","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":78,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>A = 4×4 double\n     0     0     0     0\n     0     0     6   -10\n     0    15     0    -6\n     0     5     1    -4\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"A = 4×4 double\n     0     0     0     0\n     0     0     6   -10\n     0    15     0    -6\n     0     5     1    -4\n","content_type":"text/plain"}}}],"key":"fM2yfkEvVo"}],"data":{},"key":"fh1aVnfnDy"},{"type":"paragraph","position":{"start":{"line":804,"column":1},"end":{"line":804,"column":1}},"children":[{"type":"text","value":"The next step is ","position":{"start":{"line":804,"column":1},"end":{"line":804,"column":1}},"key":"Sga5cfsExT"},{"type":"inlineCode","value":"U(2, :) = A(2, :)","position":{"start":{"line":804,"column":1},"end":{"line":804,"column":1}},"key":"glBJYEobqW"},{"type":"text","value":", which is also OK. But then we are supposed to divide by ","position":{"start":{"line":804,"column":1},"end":{"line":804,"column":1}},"key":"inQR5I3gJU"},{"type":"inlineCode","value":"U(2, 2)","position":{"start":{"line":804,"column":1},"end":{"line":804,"column":1}},"key":"RWsD8B0CsO"},{"type":"text","value":", which is zero. The algorithm cannot continue.","position":{"start":{"line":804,"column":1},"end":{"line":804,"column":1}},"key":"Xd9OJtJQUT"}],"key":"OUWphcHVGj"}],"key":"f9tqk8jd9W"}],"key":"psyEaKSNoB"}],"key":"Whu0qzGSMU"},{"type":"tabItem","title":"Python","sync":"python","children":[{"type":"embed","source":{"url":"/chapter2-2","label":"demo-pivoting-fail-python","kind":"Notebook","slug":"chapter2-2","location":"/python/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-pivoting-fail","label":"demo-pivoting-fail","kind":"proof:example","position":{"start":{"line":746,"column":1},"end":{"line":746,"column":20}},"children":[{"type":"text","value":"Example ","key":"J6YN7ha7gg"},{"type":"text","value":"2.6.1","key":"qVm3PG4DQv"}],"template":"Example %s","enumerator":"2.6.1","resolved":true,"html_id":"demo-pivoting-fail","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"r8Imf7HDGF"}],"key":"jKTQ0xPtH2"},{"type":"paragraph","position":{"start":{"line":748,"column":1},"end":{"line":748,"column":1}},"children":[{"type":"text","value":"Here is a previously encountered matrix that factors well.","position":{"start":{"line":748,"column":1},"end":{"line":748,"column":1}},"key":"LiCq8cVQlw"}],"key":"f82E9BIxJ0"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"A = array([\n    [2, 0, 4, 3],\n    [-4, 5, -7, -10],\n    [1, 15, 2, -4.5],\n    [-2, 0, 2, -13]\n    ])\nL, U = FNC.lufact(A)\nprint(L)","key":"w3P0eclJxC"},{"type":"output","id":"5xlL1QqWJVQEdqgXvnu6h","data":[{"output_type":"stream","name":"stdout","text":"[[ 1.   0.  -0.   0. ]\n [-2.   1.  -0.   0. ]\n [ 0.5  3.   1.   0. ]\n [-1.   0.  -2.   1. ]]\n"}],"key":"dvkziaGO0j"}],"data":{},"key":"nEJbC2XZsp"},{"type":"paragraph","position":{"start":{"line":761,"column":1},"end":{"line":761,"column":1}},"children":[{"type":"text","value":"If we swap the second and fourth rows of ","position":{"start":{"line":761,"column":1},"end":{"line":761,"column":1}},"key":"xVh3DCU1VN"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":761,"column":1},"end":{"line":761,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"nTYAw5oGlg"},{"type":"text","value":", the result is still nonsingular. However, the factorization now fails.","position":{"start":{"line":761,"column":1},"end":{"line":761,"column":1}},"key":"J0ntacVIS0"}],"key":"luteXr3Dbm"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"A[[1, 3], :] = A[[3, 1], :]  \nL, U = FNC.lufact(A)\nprint(L)","key":"cCtnwQDzvu"},{"type":"output","id":"EFsWBsY3MiRbePVLEgRxR","data":[{"output_type":"stream","name":"stdout","text":"[[ 1.   nan  nan  0. ]\n [-1.   nan  nan  0. ]\n [ 0.5  inf  nan  0. ]\n [-2.   inf  nan  1. ]]\n"},{"output_type":"stream","name":"stderr","text":"/Users/driscoll/Documents/GitHub/fnc/python/fncbook/fncbook/chapter02.py:47: RuntimeWarning: divide by zero encountered in divide\n  L[:, k] = A_k[:, k] / U[k,k]\n/Users/driscoll/Documents/GitHub/fnc/python/fncbook/fncbook/chapter02.py:47: RuntimeWarning: invalid value encountered in divide\n  L[:, k] = A_k[:, k] / U[k,k]\n/Users/driscoll/mambaforge/envs/myst/lib/python3.13/site-packages/numpy/_core/numeric.py:983: RuntimeWarning: invalid value encountered in multiply\n  return multiply(a.ravel()[:, newaxis], b.ravel()[newaxis, :], out)\n"}],"key":"ONktDro9Ni"}],"data":{},"key":"Pqht3IlyM0"},{"type":"paragraph","position":{"start":{"line":772,"column":1},"end":{"line":772,"column":1}},"children":[{"type":"text","value":"The presence of ","position":{"start":{"line":772,"column":1},"end":{"line":772,"column":1}},"key":"L0LrcGYtDa"},{"type":"inlineCode","value":"NaN","position":{"start":{"line":772,"column":1},"end":{"line":772,"column":1}},"key":"HFvPGsZfUj"},{"type":"text","value":" in the result indicates that some impossible operation was required. The source of the problem is easy to locate. We can find the first outer product in the factorization just fine:","position":{"start":{"line":772,"column":1},"end":{"line":772,"column":1}},"key":"yVPmhAH6Xv"}],"indexEntries":[{"entry":"Python","subEntry":{"value":"NaN","kind":"entry"},"emphasis":false}],"key":"pMEVKxgf7r"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"U[0, :] = A[0, :]\nL[:, 0] = A[:, 0] / U[0, 0]\nA -= outer(L[:, 0],  U[0, :])\nprint(A)","key":"iwvutawuWv"},{"type":"output","id":"LfCadQ22yk0OPy7LLYSNN","data":[{"output_type":"stream","name":"stdout","text":"[[  0.   0.   0.   0.]\n [  0.   0.   6. -10.]\n [  0.  15.   0.  -6.]\n [  0.   5.   1.  -4.]]\n"}],"key":"q6mpXQ96YL"}],"data":{},"key":"GC3EjICZQa"},{"type":"paragraph","position":{"start":{"line":781,"column":1},"end":{"line":781,"column":1}},"children":[{"type":"text","value":"The next step is ","position":{"start":{"line":781,"column":1},"end":{"line":781,"column":1}},"key":"igk32vudBj"},{"type":"inlineCode","value":"U[1, :] = A[1, :]","position":{"start":{"line":781,"column":1},"end":{"line":781,"column":1}},"key":"NOrBgb3SK8"},{"type":"text","value":", which is also OK. But then we are supposed to divide by ","position":{"start":{"line":781,"column":1},"end":{"line":781,"column":1}},"key":"X3W3DpgGSo"},{"type":"inlineCode","value":"U[1, 1]","position":{"start":{"line":781,"column":1},"end":{"line":781,"column":1}},"key":"MtnRQZ9kSE"},{"type":"text","value":", which is zero. The algorithm cannot continue.","position":{"start":{"line":781,"column":1},"end":{"line":781,"column":1}},"key":"p1av3rpSkF"}],"key":"Yc5ndCrk71"}],"key":"k2KN34wpmZ"}],"key":"LeMNQ3jMLH"}],"key":"HGNbGU5iXk"}],"key":"hnVfUWqLlm"}],"label":"demo-pivoting-fail","identifier":"demo-pivoting-fail","html_id":"demo-pivoting-fail","enumerator":"2.6.1","key":"eJUWRtLBEx"},{"type":"paragraph","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"children":[{"type":"text","value":"In ","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"JvTGMwip2o"},{"type":"link","kind":"numref","identifier":"section-linsys-lu","label":"section-linsys-lu","url":"/lu","internal":true,"dataUrl":"/lu.json","children":[{"type":"text","value":"LU factorization","key":"sGU1cSw2QR"}],"key":"YZzjvmKPOj"},{"type":"text","value":" we remarked that LU factorization is equivalent to Gaussian elimination with no row swaps. However, those swaps are necessary in situations like those encountered in ","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"smzVOR49kx"},{"type":"crossReference","kind":"proof:example","identifier":"demo-pivoting-fail","label":"demo-pivoting-fail","children":[{"type":"text","value":"Demo ","key":"sHFgjVFJHo"},{"type":"text","value":"2.6.1","key":"UiX3g3Mo3y"}],"template":"Example %s","enumerator":"2.6.1","resolved":true,"html_id":"demo-pivoting-fail","key":"FqAX5czGgJ"},{"type":"text","value":", in order to avoid division by zero. We will find a modification of the outer product procedure that allows us to do the same thing.","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"izkOrNpWVv"}],"key":"KnijrIgKLo"},{"type":"heading","depth":2,"position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"children":[{"type":"text","value":"Choosing a pivot","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"key":"ZWHYcM4wbi"}],"identifier":"choosing-a-pivot","label":"Choosing a pivot","html_id":"choosing-a-pivot","implicit":true,"enumerator":"2.6.1","key":"o2Uj3VxTuw"},{"type":"paragraph","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"children":[{"type":"text","value":"The diagonal element of ","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"VcmF9E15o0"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"J0UMQRVI3H"},{"type":"text","value":" that appears in the denominator of line 17 of ","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"zqlIBCdf1D"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-lufact","label":"function-lufact","children":[{"type":"text","value":"Function ","key":"nmOWrnfvlE"},{"type":"text","value":"2.4.1","key":"fKMahFSaHj"}],"template":"Algorithm %s","enumerator":"2.4.1","resolved":true,"html_id":"function-lufact","remote":true,"url":"/lu","dataUrl":"/lu.json","key":"QqolH7roEx"},{"type":"text","value":" is called the ","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"zQm8FJrpd6"},{"type":"strong","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"children":[{"type":"text","value":"pivot element","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"yPTeIGHIAD"}],"key":"anwaeP1AX9"},{"type":"text","value":" of its column. In order to avoid a zero pivot, we will use the largest available element in the column we are working on as the pivot. This technique is known as ","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"bwiwfh7sxg"},{"type":"strong","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"children":[{"type":"text","value":"row pivoting","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"JrXvedWzsK"}],"key":"IYh4JrOq58"},{"type":"text","value":".","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"wmwLRadIkT"}],"indexEntries":[{"entry":"pivoting","emphasis":true}],"label":"index-OcQPSESmcr","identifier":"index-ocqpsesmcr","html_id":"index-ocqpsesmcr","key":"IS2EVEASmG"},{"type":"proof","kind":"algorithm","enumerated":true,"children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Row pivoting","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"key":"NuVQXQMnuA"}],"key":"w7zVAnTxpL"},{"type":"paragraph","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"children":[{"type":"text","value":"When performing elimination in column ","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"key":"lKz7oD5F8W"},{"type":"inlineMath","value":"j","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>j</mi></mrow><annotation encoding=\"application/x-tex\">j</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span></span></span></span>","key":"vig2Cz9cNS"},{"type":"text","value":", choose as the pivot the element in column ","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"key":"m658wToDG0"},{"type":"inlineMath","value":"j","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>j</mi></mrow><annotation encoding=\"application/x-tex\">j</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span></span></span></span>","key":"hZm7p3h13r"},{"type":"text","value":" that is largest in absolute value. (In case of ties, choose the lowest row index.)","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"key":"wmYe4dh3d9"}],"key":"iHvb1uTVix"}],"label":"rule-pivoting","identifier":"rule-pivoting","html_id":"rule-pivoting","enumerator":"2.6.1","key":"cg4gDIN6bF"},{"type":"proof","kind":"example","enumerated":true,"children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Row pivoting in LU factorization","position":{"start":{"line":51,"column":1},"end":{"line":51,"column":1}},"key":"uBxZ23sgoP"}],"key":"sUVCuVX8ee"},{"type":"tabSet","children":[{"type":"tabItem","title":"Julia","sync":"julia","children":[{"type":"embed","source":{"url":"/chapter2","label":"demo-pivoting-fix-julia","kind":"Notebook","slug":"chapter2","location":"/julia/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-pivoting-fix","label":"demo-pivoting-fix","kind":"proof:example","position":{"start":{"line":865,"column":1},"end":{"line":865,"column":19}},"children":[{"type":"text","value":"Example ","key":"W36XzEyzgf"},{"type":"text","value":"2.6.2","key":"eWNdNGA8FV"}],"template":"Example %s","enumerator":"2.6.2","resolved":true,"html_id":"demo-pivoting-fix","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"GIg3pGBD4P"}],"key":"Uc28ceRa4n"},{"type":"paragraph","position":{"start":{"line":867,"column":1},"end":{"line":867,"column":1}},"children":[{"type":"text","value":"Here is the trouble-making matrix from ","position":{"start":{"line":867,"column":1},"end":{"line":867,"column":1}},"key":"Ubuh9FuUSu"},{"type":"crossReference","kind":"proof:example","identifier":"demo-pivoting-fail","label":"demo-pivoting-fail","children":[{"type":"text","value":"Demo ","key":"aaL9Q4DOgp"},{"type":"text","value":"2.6.1","key":"tVHLsoPu7r"}],"template":"Example %s","enumerator":"2.6.1","resolved":true,"html_id":"demo-pivoting-fail","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"qRC6haDC5S"},{"type":"text","value":".","position":{"start":{"line":867,"column":1},"end":{"line":867,"column":1}},"key":"SUPl9iy433"}],"key":"aXg9fW0MPZ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"A₁ = [2 0 4 3 ; -2 0 2 -13; 1 15 2 -4.5 ; -4 5 -7 -10]","key":"Ryf2ssn98m"},{"type":"output","id":"-fVOz2kWy4MDSQrXKAsU7","data":[{"output_type":"execute_result","execution_count":81,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n  2.0   0.0   4.0    3.0\n -2.0   0.0   2.0  -13.0\n  1.0  15.0   2.0   -4.5\n -4.0   5.0  -7.0  -10.0","content_type":"text/plain"}}}],"key":"WWw49oANjO"}],"data":{},"key":"MlP8kXNsO1"},{"type":"paragraph","position":{"start":{"line":873,"column":1},"end":{"line":873,"column":1}},"children":[{"type":"text","value":"We now find the largest candidate pivot in the first column. We don’t care about sign, so we take absolute values before finding the max.","position":{"start":{"line":873,"column":1},"end":{"line":873,"column":1}},"key":"yx81CbbQaP"}],"key":"cQE4oTX5GK"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"a7HBYXBgxG"}],"key":"K3cGUdpVG4"},{"type":"paragraph","position":{"start":{"line":876,"column":1},"end":{"line":876,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":876,"column":1},"end":{"line":876,"column":1}},"key":"RyD11mpUcX"},{"type":"inlineCode","value":"argmax","position":{"start":{"line":876,"column":1},"end":{"line":876,"column":1}},"key":"ZsypUwDL3u"},{"type":"text","value":" function returns the location of the largest element of a vector or matrix.","position":{"start":{"line":876,"column":1},"end":{"line":876,"column":1}},"key":"VIKMVkturD"}],"key":"wpxQftg1Eu"}],"class":"dropdown","key":"AigzSMds5z"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"i = argmax( abs.(A₁[:, 1]) )","key":"vqUHWig3Zw"},{"type":"output","id":"tmGPGW5SGM5Ep90cwniCK","data":[{"output_type":"execute_result","execution_count":82,"metadata":{},"data":{"text/plain":{"content":"4","content_type":"text/plain"}}}],"key":"smL0v5g7Bg"}],"data":{},"key":"p6lCETtIUB"},{"type":"paragraph","position":{"start":{"line":884,"column":1},"end":{"line":884,"column":1}},"children":[{"type":"text","value":"This is the row of the matrix that we extract to put into ","position":{"start":{"line":884,"column":1},"end":{"line":884,"column":1}},"key":"A4mTmCEv9f"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":884,"column":1},"end":{"line":884,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"ee72p3yqKQ"},{"type":"text","value":". That guarantees that the division used to find ","position":{"start":{"line":884,"column":1},"end":{"line":884,"column":1}},"key":"Ys80Nl5S7o"},{"type":"inlineMath","value":"\\boldsymbol{\\ell}_1","position":{"start":{"line":884,"column":1},"end":{"line":884,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">ℓ</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\boldsymbol{\\ell}_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">ℓ</span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"H2Yv2S3rgo"},{"type":"text","value":" will be valid.","position":{"start":{"line":884,"column":1},"end":{"line":884,"column":1}},"key":"iBvHIWCg4P"}],"key":"xiewVm6hKD"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"L, U = zeros(4,4),zeros(4,4)\nU[1, :] = A₁[i, :]\nL[:, 1] = A₁[:, 1] / U[1, 1]\nA₂ = A₁ - L[:, 1] * U[1, :]'","key":"Ehf5lWANGF"},{"type":"output","id":"wN_OQv56J8NaFkKwZvnhj","data":[{"output_type":"execute_result","execution_count":83,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n 0.0   2.5   0.5   -2.0\n 0.0  -2.5   5.5   -8.0\n 0.0  16.25  0.25  -7.0\n 0.0   0.0   0.0    0.0","content_type":"text/plain"}}}],"key":"brfRWJIpC6"}],"data":{},"key":"H2ZJvy7JLc"},{"type":"paragraph","position":{"start":{"line":893,"column":1},"end":{"line":893,"column":1}},"children":[{"type":"text","value":"Observe that ","position":{"start":{"line":893,"column":1},"end":{"line":893,"column":1}},"key":"QDpSKCKgm7"},{"type":"inlineMath","value":"\\mathbf{A}_2","position":{"start":{"line":893,"column":1},"end":{"line":893,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">A</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8361em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"gZyaqU1Lj6"},{"type":"text","value":" has a new zero row and zero column, but the zero row is the fourth rather than the first. However, we forge on by using the largest possible pivot in column 2 for the next outer product.","position":{"start":{"line":893,"column":1},"end":{"line":893,"column":1}},"key":"RSaGxoGhZq"}],"key":"YKXmx38k3p"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"@show i = argmax( abs.(A₂[:, 2]) ) \nU[2, :] = A₂[i, :]\nL[:, 2] = A₂[:, 2] / U[2, 2]\nA₃ = A₂ - L[:, 2] * U[2, :]'","key":"MKcZaiRk9i"},{"type":"output","id":"x7BRK6YQEwabFaLTNS1_Y","data":[{"output_type":"stream","name":"stdout","text":"i = argmax(abs.(A₂[:, 2])) = 3\n"},{"output_type":"execute_result","execution_count":84,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n 0.0  0.0  0.461538  -0.923077\n 0.0  0.0  5.53846   -9.07692\n 0.0  0.0  0.0        0.0\n 0.0  0.0  0.0        0.0","content_type":"text/plain"}}}],"key":"KbnBgKpbwd"}],"data":{},"key":"Mad0e89ftN"},{"type":"paragraph","position":{"start":{"line":902,"column":1},"end":{"line":902,"column":1}},"children":[{"type":"text","value":"Now we have zeroed out the third row as well as the second column. We can finish out the procedure.","position":{"start":{"line":902,"column":1},"end":{"line":902,"column":1}},"key":"fqcHKXBww0"}],"key":"IGrFJvi3IX"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"@show i = argmax( abs.(A₃[:, 3]) ) \nU[3, :] = A₃[i, :]\nL[:, 3] = A₃[:, 3] / U[3, 3]\nA₄ = A₃ - L[:, 3] * U[3, :]'","key":"xn3vU9ksTA"},{"type":"output","id":"e1ivmvTMGG0tmQMpqhy1m","data":[{"output_type":"stream","name":"stdout","text":"i = argmax(abs.(A₃[:, 3])) = 2\n"},{"output_type":"execute_result","execution_count":85,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n 0.0  0.0  0.0  -0.166667\n 0.0  0.0  0.0   0.0\n 0.0  0.0  0.0   0.0\n 0.0  0.0  0.0   0.0","content_type":"text/plain"}}}],"key":"z4T1qfKNlK"}],"data":{},"key":"HuXTRtHBt1"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"@show i = argmax( abs.(A₄[:, 4]) ) \nU[4, :] = A₄[i, :]\nL[:, 4] = A₄[:, 4] / U[4, 4];","key":"J912gED9SA"},{"type":"output","id":"voUM83yiakXnRoEt1MLZr","data":[{"output_type":"stream","name":"stdout","text":"i = argmax(abs.(A₄[:, 4])) = 1\n"}],"key":"dzunYXFY3C"}],"data":{},"key":"YRAg93E9Du"},{"type":"paragraph","position":{"start":{"line":917,"column":1},"end":{"line":917,"column":1}},"children":[{"type":"text","value":"We do have a factorization of the original matrix:","position":{"start":{"line":917,"column":1},"end":{"line":917,"column":1}},"key":"LzRAnGrqZL"}],"key":"KsVWFTCOmj"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"A₁ - L * U","key":"yd0apTPuEN"},{"type":"output","id":"70tCcPfxdGuOc6WgP88G1","data":[{"output_type":"execute_result","execution_count":87,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n 0.0  -1.38778e-16  0.0  0.0\n 0.0   1.38778e-16  0.0  0.0\n 0.0   0.0          0.0  0.0\n 0.0   0.0          0.0  0.0","content_type":"text/plain"}}}],"key":"seTiTTYPzr"}],"data":{},"key":"pp0z6jzDof"},{"type":"paragraph","position":{"start":{"line":923,"column":1},"end":{"line":923,"column":1}},"children":[{"type":"text","value":"And ","position":{"start":{"line":923,"column":1},"end":{"line":923,"column":1}},"key":"VpwdHiPbGN"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":923,"column":1},"end":{"line":923,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"WllRpBVOTm"},{"type":"text","value":" has the required structure:","position":{"start":{"line":923,"column":1},"end":{"line":923,"column":1}},"key":"O8AGJTMKna"}],"key":"Mz9fdzh0Cw"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"U","key":"VSks3Eqoiy"},{"type":"output","id":"oDQz6turb0vr4cw5pWG0r","data":[{"output_type":"execute_result","execution_count":88,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n -4.0   5.0   -7.0      -10.0\n  0.0  16.25   0.25      -7.0\n  0.0   0.0    5.53846   -9.07692\n  0.0   0.0    0.0       -0.166667","content_type":"text/plain"}}}],"key":"r5qC5PyE82"}],"data":{},"key":"lt9knojSuS"},{"type":"paragraph","position":{"start":{"line":929,"column":1},"end":{"line":929,"column":1}},"children":[{"type":"text","value":"However, the triangularity of ","position":{"start":{"line":929,"column":1},"end":{"line":929,"column":1}},"key":"T5qocvTXmF"},{"type":"inlineMath","value":"\\mathbf{L}","position":{"start":{"line":929,"column":1},"end":{"line":929,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">L</span></span></span></span>","key":"GziBvIoB01"},{"type":"text","value":" has been broken.","position":{"start":{"line":929,"column":1},"end":{"line":929,"column":1}},"key":"eNcdDQIpE2"}],"key":"KEnbrmSEDB"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"L","key":"EwLAQisDTp"},{"type":"output","id":"srwnFA9cx6PlGm4FbUNXd","data":[{"output_type":"execute_result","execution_count":89,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n -0.5    0.153846  0.0833333   1.0\n  0.5   -0.153846  1.0        -0.0\n -0.25   1.0       0.0        -0.0\n  1.0    0.0       0.0        -0.0","content_type":"text/plain"}}}],"key":"qvpR4YccFn"}],"data":{},"key":"kGVmHJmpcE"}],"key":"TP6Ngv8bF9"}],"key":"YdxuFeKu2K"}],"key":"WaXs4h7314"},{"type":"tabItem","title":"MATLAB","sync":"matlab","children":[{"type":"embed","source":{"url":"/chapter2-1","label":"demo-pivoting-fix-matlab","kind":"Notebook","slug":"chapter2-1","location":"/matlab/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-pivoting-fix","label":"demo-pivoting-fix","kind":"proof:example","position":{"start":{"line":808,"column":1},"end":{"line":808,"column":19}},"children":[{"type":"text","value":"Example ","key":"GmtGziA6wC"},{"type":"text","value":"2.6.2","key":"Kg1IR2pTKT"}],"template":"Example %s","enumerator":"2.6.2","resolved":true,"html_id":"demo-pivoting-fix","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"pXaE5vLdDX"}],"key":"zL8M7KSQhe"},{"type":"paragraph","position":{"start":{"line":810,"column":1},"end":{"line":810,"column":1}},"children":[{"type":"text","value":"Here is the trouble-making matrix from ","position":{"start":{"line":810,"column":1},"end":{"line":810,"column":1}},"key":"y2myzVo3i5"},{"type":"crossReference","kind":"proof:example","identifier":"demo-pivoting-fail","label":"demo-pivoting-fail","children":[{"type":"text","value":"Demo ","key":"vmJXQuCJch"},{"type":"text","value":"2.6.1","key":"D6gAnPbfoU"}],"template":"Example %s","enumerator":"2.6.1","resolved":true,"html_id":"demo-pivoting-fail","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"wTe7Hg9Erj"},{"type":"text","value":".","position":{"start":{"line":810,"column":1},"end":{"line":810,"column":1}},"key":"ZvXUZHvqCS"}],"key":"VuuGyKuNu6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A_1 = [2 0 4 3; -2 0 2 -13; 1 15 2 -4.5; -4 5 -7 -10]","key":"dz6iwNmwyF"},{"type":"output","id":"51yf-1iBK3HL5Kcvjh5ee","data":[{"output_type":"execute_result","execution_count":79,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>A_1 = 4×4 double\n   2.0000e+00            0   4.0000e+00   3.0000e+00\n  -2.0000e+00            0   2.0000e+00  -1.3000e+01\n   1.0000e+00   1.5000e+01   2.0000e+00  -4.5000e+00\n  -4.0000e+00   5.0000e+00  -7.0000e+00  -1.0000e+01\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"A_1 = 4×4 double\n   2.0000e+00            0   4.0000e+00   3.0000e+00\n  -2.0000e+00            0   2.0000e+00  -1.3000e+01\n   1.0000e+00   1.5000e+01   2.0000e+00  -4.5000e+00\n  -4.0000e+00   5.0000e+00  -7.0000e+00  -1.0000e+01\n","content_type":"text/plain"}}}],"key":"zCzFEgeuf3"}],"data":{},"key":"HOYEWMAFMU"},{"type":"paragraph","position":{"start":{"line":819,"column":1},"end":{"line":819,"column":1}},"children":[{"type":"text","value":"We now find the largest candidate pivot in the first column. We don’t care about sign, so we take absolute values before finding the max.","position":{"start":{"line":819,"column":1},"end":{"line":819,"column":1}},"key":"JVpaPpxxYE"}],"indexEntries":[{"entry":"MATLAB","subEntry":{"value":"max","kind":"entry"},"emphasis":true},{"entry":"MATLAB","subEntry":{"value":"\\~","kind":"entry"},"emphasis":true}],"key":"KtaymVmnQv"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"rbY2NridSV"}],"key":"ViUy6ubJOW"},{"type":"paragraph","position":{"start":{"line":822,"column":1},"end":{"line":822,"column":1}},"children":[{"type":"text","value":"The second output of ","position":{"start":{"line":822,"column":1},"end":{"line":822,"column":1}},"key":"oLjeNt9h7B"},{"type":"inlineCode","value":"max","position":{"start":{"line":822,"column":1},"end":{"line":822,"column":1}},"key":"D2xO60lMUk"},{"type":"text","value":" returns the location of the largest element of a vector. The ","position":{"start":{"line":822,"column":1},"end":{"line":822,"column":1}},"key":"WUapaomt3v"},{"type":"inlineCode","value":"~","position":{"start":{"line":822,"column":1},"end":{"line":822,"column":1}},"key":"iYxcjJzd16"},{"type":"text","value":" symbol is used to ignore the value of the first output.","position":{"start":{"line":822,"column":1},"end":{"line":822,"column":1}},"key":"DTW0I4PVHh"}],"key":"VFGnaTIHPo"}],"class":"dropdown","key":"dZn5dm9YxM"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[~, i] = max( abs(A_1(:, 1)) )","key":"iSCpCGSlFH"},{"type":"output","id":"KHSOXze6AcQUW0tLna1Xy","data":[{"output_type":"execute_result","execution_count":80,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>i = \n     4\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"i = \n     4\n","content_type":"text/plain"}}}],"key":"EeXaAMieP1"}],"data":{},"key":"a7qgo8s7fn"},{"type":"paragraph","position":{"start":{"line":830,"column":1},"end":{"line":830,"column":1}},"children":[{"type":"text","value":"This is the row of the matrix that we extract to put into ","position":{"start":{"line":830,"column":1},"end":{"line":830,"column":1}},"key":"c9ieDft6kS"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":830,"column":1},"end":{"line":830,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"QO4ccPQ4Z9"},{"type":"text","value":". That guarantees that the division used to find ","position":{"start":{"line":830,"column":1},"end":{"line":830,"column":1}},"key":"LiaeJnoedH"},{"type":"inlineMath","value":"\\boldsymbol{\\ell}_1","position":{"start":{"line":830,"column":1},"end":{"line":830,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">ℓ</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\boldsymbol{\\ell}_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">ℓ</span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"ovpdnu7UkG"},{"type":"text","value":" will be valid.","position":{"start":{"line":830,"column":1},"end":{"line":830,"column":1}},"key":"GLy9mVzWKG"}],"key":"TdXB8Zes2o"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"L = zeros(4, 4);\nU = zeros(4, 4);\nU(1, :) = A_1(i, :);\nL(:, 1) = A_1(:, 1) / U(1, 1);\nA_2 = A_1 - L(:, 1) * U(1, :)","key":"axLA3yYcDy"},{"type":"output","id":"40krmLfOGBcS5yaKTzaJd","data":[{"output_type":"execute_result","execution_count":81,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>A_2 = 4×4 double\n            0   2.5000e+00   5.0000e-01  -2.0000e+00\n            0  -2.5000e+00   5.5000e+00  -8.0000e+00\n            0   1.6250e+01   2.5000e-01  -7.0000e+00\n            0            0            0            0\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"A_2 = 4×4 double\n            0   2.5000e+00   5.0000e-01  -2.0000e+00\n            0  -2.5000e+00   5.5000e+00  -8.0000e+00\n            0   1.6250e+01   2.5000e-01  -7.0000e+00\n            0            0            0            0\n","content_type":"text/plain"}}}],"key":"yFGPL0P0Y3"}],"data":{},"key":"tS7sk339mw"},{"type":"paragraph","position":{"start":{"line":840,"column":1},"end":{"line":840,"column":1}},"children":[{"type":"text","value":"Observe that ","position":{"start":{"line":840,"column":1},"end":{"line":840,"column":1}},"key":"xjISnVyx0G"},{"type":"inlineMath","value":"\\mathbf{A}_2","position":{"start":{"line":840,"column":1},"end":{"line":840,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">A</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8361em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"CnR1mbKYiw"},{"type":"text","value":" has a new zero row and zero column, but the zero row is the fourth rather than the first. However, we forge on by using the largest possible pivot in column 2 for the next outer product.","position":{"start":{"line":840,"column":1},"end":{"line":840,"column":1}},"key":"uocwrczr0Y"}],"key":"XuM9NTb1wq"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[~, i] = max( abs(A_2(:, 2)) )\nU(2, :) = A_2(i, :);\nL(:, 2) = A_2(:, 2) / U(2, 2);\nA_3 = A_2 - L(:, 2) * U(2, :)","key":"PJhYiJ5m0f"},{"type":"output","id":"l5oYq-MdeixoAJEwE3UBM","data":[{"output_type":"execute_result","execution_count":82,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>i = \n     3\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"i = \n     3\n","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":82,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>A_3 = 4×4 double\n            0            0   4.6154e-01  -9.2308e-01\n            0            0   5.5385e+00  -9.0769e+00\n            0            0            0            0\n            0            0            0            0\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"A_3 = 4×4 double\n            0            0   4.6154e-01  -9.2308e-01\n            0            0   5.5385e+00  -9.0769e+00\n            0            0            0            0\n            0            0            0            0\n","content_type":"text/plain"}}}],"key":"g4cVvmN1vz"}],"data":{},"key":"LSHXvOyWEX"},{"type":"paragraph","position":{"start":{"line":849,"column":1},"end":{"line":849,"column":1}},"children":[{"type":"text","value":"Now we have zeroed out the third row as well as the second column. We can finish out the procedure.","position":{"start":{"line":849,"column":1},"end":{"line":849,"column":1}},"key":"nmJ5gpAyY3"}],"key":"AOf3w0iVEC"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[~, i] = max( abs(A_3(:, 3)) ) \nU(3, :) = A_3(i, :);\nL(:, 3) = A_3(:, 3) / U(3, 3);\nA_4 = A_3 - L(:, 3) * U(3, :)","key":"vsgBybWM7m"},{"type":"output","id":"DqoYPYVFJmoT_347mbULP","data":[{"output_type":"execute_result","execution_count":83,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>i = \n     2\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"i = \n     2\n","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":83,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>A_4 = 4×4 double\n            0            0            0  -1.6667e-01\n            0            0            0            0\n            0            0            0            0\n            0            0            0            0\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"A_4 = 4×4 double\n            0            0            0  -1.6667e-01\n            0            0            0            0\n            0            0            0            0\n            0            0            0            0\n","content_type":"text/plain"}}}],"key":"KYwRnmNPIj"}],"data":{},"key":"zyzoCBZxtc"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[~, i] = max( abs(A_4(:, 4)) ) \nU(4, :) = A_4(i, :);\nL(:, 4) = A_4(:, 4) / U(4, 4);","key":"eHnqHM1ljY"},{"type":"output","id":"OruvTIXZamQbSxOebXUTC","data":[{"output_type":"execute_result","execution_count":84,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>i = \n     1\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"i = \n     1\n","content_type":"text/plain"}}}],"key":"fM2tRnV0QL"}],"data":{},"key":"c88GRvCKWk"},{"type":"paragraph","position":{"start":{"line":864,"column":1},"end":{"line":864,"column":1}},"children":[{"type":"text","value":"We do have a factorization of the original matrix:","position":{"start":{"line":864,"column":1},"end":{"line":864,"column":1}},"key":"TGipZUsD0R"}],"key":"Hx50Dhh5pE"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A_1 - L * U","key":"CQ7TxgM2Zy"},{"type":"output","id":"5u6KziW0U1KVx-dS7YL_p","data":[{"output_type":"execute_result","execution_count":85,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = 4×4 double\n     0     0     0     0\n     0     0     0     0\n     0     0     0     0\n     0     0     0     0\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = 4×4 double\n     0     0     0     0\n     0     0     0     0\n     0     0     0     0\n     0     0     0     0\n","content_type":"text/plain"}}}],"key":"qbHgiS2aBU"}],"data":{},"key":"gfPSZyhWF5"},{"type":"paragraph","position":{"start":{"line":870,"column":1},"end":{"line":870,"column":1}},"children":[{"type":"text","value":"And ","position":{"start":{"line":870,"column":1},"end":{"line":870,"column":1}},"key":"QDqrV1W35Y"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":870,"column":1},"end":{"line":870,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"zakCsyyXEb"},{"type":"text","value":" has the required structure:","position":{"start":{"line":870,"column":1},"end":{"line":870,"column":1}},"key":"DoLB5j2gGN"}],"key":"Mr4B5S5eIl"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"U","key":"jDu7rOh188"},{"type":"output","id":"xOLWHOulUz8_5FA7i-KeN","data":[{"output_type":"execute_result","execution_count":86,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>U = 4×4 double\n  -4.0000e+00   5.0000e+00  -7.0000e+00  -1.0000e+01\n            0   1.6250e+01   2.5000e-01  -7.0000e+00\n            0            0   5.5385e+00  -9.0769e+00\n            0            0            0  -1.6667e-01\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"U = 4×4 double\n  -4.0000e+00   5.0000e+00  -7.0000e+00  -1.0000e+01\n            0   1.6250e+01   2.5000e-01  -7.0000e+00\n            0            0   5.5385e+00  -9.0769e+00\n            0            0            0  -1.6667e-01\n","content_type":"text/plain"}}}],"key":"GCTbXAqeAh"}],"data":{},"key":"NUgODvrm9a"},{"type":"paragraph","position":{"start":{"line":876,"column":1},"end":{"line":876,"column":1}},"children":[{"type":"text","value":"However, the triangularity of ","position":{"start":{"line":876,"column":1},"end":{"line":876,"column":1}},"key":"jsTFAyy3al"},{"type":"inlineMath","value":"\\mathbf{L}","position":{"start":{"line":876,"column":1},"end":{"line":876,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">L</span></span></span></span>","key":"GAmeyZTmJ5"},{"type":"text","value":" has been broken.","position":{"start":{"line":876,"column":1},"end":{"line":876,"column":1}},"key":"TkhT2UPtCR"}],"key":"rSUJIHKKMR"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"L","key":"NFRmNvHQWm"},{"type":"output","id":"aebOOb_i25hww_6CJV_Ng","data":[{"output_type":"execute_result","execution_count":87,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>L = 4×4 double\n  -5.0000e-01   1.5385e-01   8.3333e-02   1.0000e+00\n   5.0000e-01  -1.5385e-01   1.0000e+00            0\n  -2.5000e-01   1.0000e+00            0            0\n   1.0000e+00            0            0            0\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"L = 4×4 double\n  -5.0000e-01   1.5385e-01   8.3333e-02   1.0000e+00\n   5.0000e-01  -1.5385e-01   1.0000e+00            0\n  -2.5000e-01   1.0000e+00            0            0\n   1.0000e+00            0            0            0\n","content_type":"text/plain"}}}],"key":"Xnn4eU2D1X"}],"data":{},"key":"uv6zJgstXl"}],"key":"UU486bigEv"}],"key":"j3ftxmxTS3"}],"key":"ibbMqvX1XD"},{"type":"tabItem","title":"Python","sync":"python","children":[{"type":"embed","source":{"url":"/chapter2-2","label":"demo-pivoting-fix-python","kind":"Notebook","slug":"chapter2-2","location":"/python/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-pivoting-fix","label":"demo-pivoting-fix","kind":"proof:example","position":{"start":{"line":785,"column":1},"end":{"line":785,"column":19}},"children":[{"type":"text","value":"Example ","key":"fSbUbIwKiL"},{"type":"text","value":"2.6.2","key":"R7YRh9ZMEt"}],"template":"Example %s","enumerator":"2.6.2","resolved":true,"html_id":"demo-pivoting-fix","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"fkI0jdbSGs"}],"key":"sw1NoQ79m0"},{"type":"paragraph","position":{"start":{"line":787,"column":1},"end":{"line":787,"column":1}},"children":[{"type":"text","value":"Here is the trouble-making matrix from ","position":{"start":{"line":787,"column":1},"end":{"line":787,"column":1}},"key":"V3YAW683W9"},{"type":"crossReference","kind":"proof:example","identifier":"demo-pivoting-fail","label":"demo-pivoting-fail","children":[{"type":"text","value":"Demo ","key":"gvBsfjh868"},{"type":"text","value":"2.6.1","key":"lXW4mptNs4"}],"template":"Example %s","enumerator":"2.6.1","resolved":true,"html_id":"demo-pivoting-fail","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"RpHEfshhFj"},{"type":"text","value":".","position":{"start":{"line":787,"column":1},"end":{"line":787,"column":1}},"key":"UdmR0ghWjJ"}],"key":"tyCpP7TWQt"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"A_1 = array([\n    [2, 0, 4, 3],\n    [-2, 0, 2, -13],\n    [1, 15, 2, -4.5],\n    [-4, 5, -7, -10]\n    ])","key":"qUq0BiWbWF"},{"type":"output","id":"99rG8uUz-M-Fimrzk6YEG","data":[],"key":"ARMmUyRPQ8"}],"data":{},"key":"LoM0ogTZ8Z"},{"type":"paragraph","position":{"start":{"line":798,"column":1},"end":{"line":798,"column":1}},"children":[{"type":"text","value":"We now find the largest candidate pivot in the first column. We don’t care about sign, so we take absolute values before finding the max.","position":{"start":{"line":798,"column":1},"end":{"line":798,"column":1}},"key":"ryoTKM4BJ0"}],"key":"sukPkIFp0o"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"XQUFbntquM"}],"key":"CkAfEwUuCv"},{"type":"paragraph","position":{"start":{"line":801,"column":1},"end":{"line":801,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":801,"column":1},"end":{"line":801,"column":1}},"key":"ZWiXJQ3uCP"},{"type":"inlineCode","value":"argmax","position":{"start":{"line":801,"column":1},"end":{"line":801,"column":1}},"key":"B7UQgGMHjf"},{"type":"text","value":" function returns the location of the largest element of a vector or matrix.","position":{"start":{"line":801,"column":1},"end":{"line":801,"column":1}},"key":"Hs9mfoD2R4"}],"key":"UfN4nedC2o"}],"class":"dropdown","key":"tkzE8DuRBH"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"i = argmax( abs(A_1[:, 0]) )\nprint(i)","key":"lb6pZUVaob"},{"type":"output","id":"rjshWuFznM6BJ63UxhHOM","data":[{"output_type":"stream","name":"stdout","text":"3\n"}],"key":"GUHL87Mheb"}],"data":{},"key":"kZwLcCfNhG"},{"type":"paragraph","position":{"start":{"line":810,"column":1},"end":{"line":810,"column":1}},"children":[{"type":"text","value":"This is the row of the matrix that we extract to put into ","position":{"start":{"line":810,"column":1},"end":{"line":810,"column":1}},"key":"ojJC4pTLsu"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":810,"column":1},"end":{"line":810,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"pkhs2dpCVY"},{"type":"text","value":". That guarantees that the division used to find ","position":{"start":{"line":810,"column":1},"end":{"line":810,"column":1}},"key":"nwy5PdiTi8"},{"type":"inlineMath","value":"\\boldsymbol{\\ell}_1","position":{"start":{"line":810,"column":1},"end":{"line":810,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">ℓ</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\boldsymbol{\\ell}_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">ℓ</span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"cQhPLMVEji"},{"type":"text","value":" will be valid.","position":{"start":{"line":810,"column":1},"end":{"line":810,"column":1}},"key":"x9Lo9EC29k"}],"key":"fdqKuJCRNh"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"L, U = eye(4), zeros((4, 4))\nU[0, :] = A_1[i, :]\nL[:, 0] = A_1[:, 0] / U[0, 0]\nA_2 = A_1 - outer(L[:, 0], U[0, :])\nprint(A_2)","key":"e3mR2MUitj"},{"type":"output","id":"GMmKyNRzN8WKE52fSKDuE","data":[{"output_type":"stream","name":"stdout","text":"[[ 0.    2.5   0.5  -2.  ]\n [ 0.   -2.5   5.5  -8.  ]\n [ 0.   16.25  0.25 -7.  ]\n [ 0.    0.    0.    0.  ]]\n"}],"key":"BdU4yuAoZr"}],"data":{},"key":"FztZJkEiKQ"},{"type":"paragraph","position":{"start":{"line":820,"column":1},"end":{"line":820,"column":1}},"children":[{"type":"text","value":"Observe that ","position":{"start":{"line":820,"column":1},"end":{"line":820,"column":1}},"key":"KXeKBMeBtM"},{"type":"inlineMath","value":"\\mathbf{A}_2","position":{"start":{"line":820,"column":1},"end":{"line":820,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">A</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8361em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"iVn5OVdaa6"},{"type":"text","value":" has a new zero row and zero column, but the zero row is the fourth rather than the first. However, we forge on by using the largest possible pivot in column 2 for the next outer product.","position":{"start":{"line":820,"column":1},"end":{"line":820,"column":1}},"key":"zOWyoL0oGL"}],"key":"yNqqqn1lIg"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"i = argmax( abs(A_2[:, 1]) ) \nprint(f\"new pivot row is {i}\")\nU[1, :] = A_2[i, :]\nL[:, 1] = A_2[:, 1] / U[1, 1]\nA_3 = A_2 - outer(L[:, 1], U[1, :])\nprint(A_3)","key":"sz32J4L7YZ"},{"type":"output","id":"XlpvcE7CtaUiLL0okk3Lr","data":[{"output_type":"stream","name":"stdout","text":"new pivot row is 2\n[[ 0.          0.          0.46153846 -0.92307692]\n [ 0.          0.          5.53846154 -9.07692308]\n [ 0.          0.          0.          0.        ]\n [ 0.          0.          0.          0.        ]]\n"}],"key":"JGdDY0ikll"}],"data":{},"key":"FsBewfvT7V"},{"type":"paragraph","position":{"start":{"line":830,"column":1},"end":{"line":830,"column":1}},"children":[{"type":"text","value":"Now we have zeroed out the third row as well as the second column. We can finish out the procedure.","position":{"start":{"line":830,"column":1},"end":{"line":830,"column":1}},"key":"OgZop3wN4e"}],"key":"DUx4v5NZtH"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"i = argmax( abs(A_3[:, 2]) ) \nprint(f\"new pivot row is {i}\")\nU[2, :] = A_3[i, :]\nL[:, 2] = A_3[:, 2] / U[2, 2]\nA_4 = A_3 - outer(L[:, 2], U[2, :])\nprint(A_4)","key":"GsB0WPv5iz"},{"type":"output","id":"h1hCDVpOj_SQ1vBVsGmQU","data":[{"output_type":"stream","name":"stdout","text":"new pivot row is 1\n[[ 0.          0.          0.         -0.16666667]\n [ 0.          0.          0.          0.        ]\n [ 0.          0.          0.          0.        ]\n [ 0.          0.          0.          0.        ]]\n"}],"key":"Sj9SUGNLcg"}],"data":{},"key":"aHDDWVJ7Aa"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"i = argmax( abs(A_4[:, 3]) ) \nprint(f\"new pivot row is {i}\")\nU[3, :] = A_4[i, :]\nL[:, 3] = A_4[:, 3] / U[3, 3];","key":"rQqrkHAOXM"},{"type":"output","id":"ld924SonT3at98w5IbQqn","data":[{"output_type":"stream","name":"stdout","text":"new pivot row is 0\n"}],"key":"muNI9SAA5E"}],"data":{},"key":"MoUnpYMcRU"},{"type":"paragraph","position":{"start":{"line":848,"column":1},"end":{"line":848,"column":1}},"children":[{"type":"text","value":"We do have a factorization of the original matrix:","position":{"start":{"line":848,"column":1},"end":{"line":848,"column":1}},"key":"hFLmWUXsmj"}],"key":"AoiPFvLVtV"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"A_1 - L @ U","key":"Muo59WOXTS"},{"type":"output","id":"mN_E95qB1QMpMRlXruT2A","data":[{"output_type":"execute_result","execution_count":84,"metadata":{},"data":{"text/plain":{"content":"array([[0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00],\n       [0.00000000e+00, 0.00000000e+00, 2.22044605e-16, 0.00000000e+00],\n       [0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00],\n       [0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00]])","content_type":"text/plain"}}}],"key":"UsACKweJpq"}],"data":{},"key":"v8EKrNv6si"},{"type":"paragraph","position":{"start":{"line":854,"column":1},"end":{"line":854,"column":1}},"children":[{"type":"text","value":"And ","position":{"start":{"line":854,"column":1},"end":{"line":854,"column":1}},"key":"acToMw71YU"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":854,"column":1},"end":{"line":854,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"aaR4q5xVT3"},{"type":"text","value":" has the required structure:","position":{"start":{"line":854,"column":1},"end":{"line":854,"column":1}},"key":"cVW6GBdxED"}],"key":"x62IpnGr8U"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(U)","key":"yZlnyNKnEB"},{"type":"output","id":"XazYi-bMH1N0rju8wDTRm","data":[{"output_type":"stream","name":"stdout","text":"[[ -4.           5.          -7.         -10.        ]\n [  0.          16.25         0.25        -7.        ]\n [  0.           0.           5.53846154  -9.07692308]\n [  0.           0.           0.          -0.16666667]]\n"}],"key":"jXni5lYrDv"}],"data":{},"key":"Bqf985rcan"},{"type":"paragraph","position":{"start":{"line":860,"column":1},"end":{"line":860,"column":1}},"children":[{"type":"text","value":"However, the triangularity of ","position":{"start":{"line":860,"column":1},"end":{"line":860,"column":1}},"key":"OoJEzCAwkY"},{"type":"inlineMath","value":"\\mathbf{L}","position":{"start":{"line":860,"column":1},"end":{"line":860,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">L</span></span></span></span>","key":"GrOuodFtr1"},{"type":"text","value":" has been broken.","position":{"start":{"line":860,"column":1},"end":{"line":860,"column":1}},"key":"WQB6R5MYVU"}],"key":"eCZxv58YZT"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(L)","key":"MlEvHZmT9P"},{"type":"output","id":"WSswytGNdPS7PfB-eh2XI","data":[{"output_type":"stream","name":"stdout","text":"[[-0.5         0.15384615  0.08333333  1.        ]\n [ 0.5        -0.15384615  1.         -0.        ]\n [-0.25        1.          0.         -0.        ]\n [ 1.          0.          0.         -0.        ]]\n"}],"key":"INFyS68qfT"}],"data":{},"key":"L0ngaAj835"}],"key":"ss3OXkgrHD"}],"key":"NNXrs6MGlN"}],"key":"z4bGznaHlT"}],"key":"mhj3KP639h"}],"label":"demo-pivoting-fix","identifier":"demo-pivoting-fix","html_id":"demo-pivoting-fix","enumerator":"2.6.2","key":"ISap5o219N"},{"type":"paragraph","position":{"start":{"line":73,"column":1},"end":{"line":73,"column":1}},"children":[{"type":"text","value":"We will return to the loss of triangularity in ","position":{"start":{"line":73,"column":1},"end":{"line":73,"column":1}},"key":"FW3qB11GaO"},{"type":"inlineMath","value":"\\mathbf{L}","position":{"start":{"line":73,"column":1},"end":{"line":73,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">L</span></span></span></span>","key":"dRyXcZSCmQ"},{"type":"text","value":" momentarily. First, though, there is a question left to answer: what if at some stage, all the elements of the targeted column are zero, i.e., there are no available pivots? Fortunately that loose end ties up nicely, although a proof is a bit beyond our scope here.","position":{"start":{"line":73,"column":1},"end":{"line":73,"column":1}},"key":"WoBJBWWKJT"}],"key":"V449h9pLn5"},{"type":"proof","kind":"theorem","enumerated":true,"children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Row pivoting","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"key":"NJJMIe26RB"}],"key":"yadtxdcCBH"},{"type":"paragraph","position":{"start":{"line":77,"column":1},"end":{"line":77,"column":1}},"children":[{"type":"text","value":"The row-pivoted LU factorization runs to completion if and only if the original matrix is invertible.","position":{"start":{"line":77,"column":1},"end":{"line":77,"column":1}},"key":"ZRRypfVOL4"}],"key":"CAECjq0xCt"}],"label":"theorem-pivot","identifier":"theorem-pivot","html_id":"theorem-pivot","enumerator":"2.6.1","key":"E5bS6x83aY"},{"type":"paragraph","position":{"start":{"line":80,"column":1},"end":{"line":80,"column":1}},"children":[{"type":"text","value":"A linear system with a singular matrix has either no solution or infinitely many solutions. Either way, a technique other than LU factorization is needed to handle it.","position":{"start":{"line":80,"column":1},"end":{"line":80,"column":1}},"key":"ylMSbj3vM6"}],"key":"A1LrXnJSNI"},{"type":"heading","depth":2,"position":{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},"children":[{"type":"text","value":"Permutations","position":{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},"key":"HIBwE27OjF"}],"identifier":"permutations","label":"Permutations","html_id":"permutations","implicit":true,"enumerator":"2.6.2","key":"DRpQJ46brF"},{"type":"paragraph","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"children":[{"type":"text","value":"Even though the resulting ","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"key":"vOHKGdonZg"},{"type":"inlineMath","value":"\\mathbf{L}","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">L</span></span></span></span>","key":"fBic4DPvp2"},{"type":"text","value":" in ","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"key":"jZMBHV3LSe"},{"type":"crossReference","kind":"proof:example","identifier":"demo-pivoting-fix","label":"demo-pivoting-fix","children":[{"type":"text","value":"Demo ","key":"bxE8tnmBpN"},{"type":"text","value":"2.6.2","key":"l7oppZQkOc"}],"template":"Example %s","enumerator":"2.6.2","resolved":true,"html_id":"demo-pivoting-fix","key":"FygniEjvef"},{"type":"text","value":" is no longer of unit lower triangular form, it is close. In fact, all that is needed is to reverse the order of its rows.","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"key":"b0IEf10KY6"}],"key":"zmx0joXPwf"},{"type":"proof","kind":"example","enumerated":true,"children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Pivoting as row permutation","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"R4kP9LjAqF"}],"key":"KKcYltuEVr"},{"type":"tabSet","children":[{"type":"tabItem","title":"Julia","sync":"julia","children":[{"type":"embed","source":{"url":"/chapter2","label":"demo-pivoting-permute-julia","kind":"Notebook","slug":"chapter2","location":"/julia/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-pivoting-permute","label":"demo-pivoting-permute","kind":"proof:example","position":{"start":{"line":937,"column":1},"end":{"line":937,"column":23}},"children":[{"type":"text","value":"Example ","key":"lm7Rv0yXSi"},{"type":"text","value":"2.6.3","key":"y2XtdIM5IS"}],"template":"Example %s","enumerator":"2.6.3","resolved":true,"html_id":"demo-pivoting-permute","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"vGzY8F4bcb"}],"key":"b9wJ1rP349"},{"type":"paragraph","position":{"start":{"line":939,"column":1},"end":{"line":939,"column":1}},"children":[{"type":"text","value":"Here again is the matrix from ","position":{"start":{"line":939,"column":1},"end":{"line":939,"column":1}},"key":"VLdBfgX71n"},{"type":"crossReference","kind":"proof:example","identifier":"demo-pivoting-fix","label":"demo-pivoting-fix","children":[{"type":"text","value":"Demo ","key":"xt4swzMmQj"},{"type":"text","value":"2.6.2","key":"vRdBRh7IoG"}],"template":"Example %s","enumerator":"2.6.2","resolved":true,"html_id":"demo-pivoting-fix","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"W3SacmfRGh"},{"type":"text","value":".","position":{"start":{"line":939,"column":1},"end":{"line":939,"column":1}},"key":"FaYufbxEbR"}],"key":"bqntSqPcYt"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"A = [2 0 4 3 ; -2 0 2 -13; 1 15 2 -4.5 ; -4 5 -7 -10]","key":"gJehMY1wBt"},{"type":"output","id":"3hwFEFjgodAF7U2yq6yJy","data":[{"output_type":"execute_result","execution_count":90,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n  2.0   0.0   4.0    3.0\n -2.0   0.0   2.0  -13.0\n  1.0  15.0   2.0   -4.5\n -4.0   5.0  -7.0  -10.0","content_type":"text/plain"}}}],"key":"RMsIaH0Zcf"}],"data":{},"key":"aL4w4zouQd"},{"type":"paragraph","position":{"start":{"line":945,"column":1},"end":{"line":945,"column":1}},"children":[{"type":"text","value":"As the factorization proceeded, the pivots were selected from rows 4, 3, 2, and finally 1. If we were to put the rows of ","position":{"start":{"line":945,"column":1},"end":{"line":945,"column":1}},"key":"jlBuVMDEDa"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":945,"column":1},"end":{"line":945,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"W2qDElrXDM"},{"type":"text","value":" into that order, then the algorithm would run exactly like the plain LU factorization from ","position":{"start":{"line":945,"column":1},"end":{"line":945,"column":1}},"key":"shNnDqDhjy"},{"type":"link","kind":"numref","identifier":"section-linsys-lu","label":"section-linsys-lu","url":"/lu","internal":true,"dataUrl":"/lu.json","children":[{"type":"text","value":"LU factorization","key":"l1GGVM1aEU"}],"key":"i0F7KNABpF"},{"type":"text","value":".","position":{"start":{"line":945,"column":1},"end":{"line":945,"column":1}},"key":"EVwaAKTebp"}],"key":"wuOPK6QbO4"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"B = A[[4, 3, 2, 1], :]\nL, U = FNC.lufact(B);","key":"Wt4CyfDLXb"},{"type":"output","id":"uK8TrLx5xw0b-DbD4vC7m","data":[],"key":"OtGqxDIedN"}],"data":{},"key":"zVIN1F03Ca"},{"type":"paragraph","position":{"start":{"line":952,"column":1},"end":{"line":952,"column":1}},"children":[{"type":"text","value":"We obtain the same ","position":{"start":{"line":952,"column":1},"end":{"line":952,"column":1}},"key":"CUFoOyE2P2"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":952,"column":1},"end":{"line":952,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"aSeNGjirkR"},{"type":"text","value":" as before:","position":{"start":{"line":952,"column":1},"end":{"line":952,"column":1}},"key":"HuUn2RKpgw"}],"key":"TQFgQvLmzx"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"U","key":"VwfU4eLuoU"},{"type":"output","id":"ww8IOJjFF7v8U7lqy_AfW","data":[{"output_type":"execute_result","execution_count":92,"metadata":{},"data":{"text/plain":{"content":"4×4 UpperTriangular{Float64, Matrix{Float64}}:\n -4.0   5.0   -7.0      -10.0\n   ⋅   16.25   0.25      -7.0\n   ⋅     ⋅     5.53846   -9.07692\n   ⋅     ⋅      ⋅        -0.166667","content_type":"text/plain"}}}],"key":"apzxG5Yx9y"}],"data":{},"key":"N4d7fGan4C"},{"type":"paragraph","position":{"start":{"line":958,"column":1},"end":{"line":958,"column":1}},"children":[{"type":"text","value":"And ","position":{"start":{"line":958,"column":1},"end":{"line":958,"column":1}},"key":"G67rb9LmMb"},{"type":"inlineMath","value":"\\mathbf{L}","position":{"start":{"line":958,"column":1},"end":{"line":958,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">L</span></span></span></span>","key":"tztaLRnxtD"},{"type":"text","value":" has the same rows as before, but arranged into triangular order:","position":{"start":{"line":958,"column":1},"end":{"line":958,"column":1}},"key":"j5YimC5uwg"}],"key":"u5U15aDUWL"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"L","key":"tbF7qICksy"},{"type":"output","id":"-oRCgxmOSUA5eOnzCxDPK","data":[{"output_type":"execute_result","execution_count":93,"metadata":{},"data":{"text/plain":{"content":"4×4 LowerTriangular{Float64, Matrix{Float64}}:\n  1.0     ⋅         ⋅          ⋅ \n -0.25   1.0        ⋅          ⋅ \n  0.5   -0.153846  1.0         ⋅ \n -0.5    0.153846  0.0833333  1.0","content_type":"text/plain"}}}],"key":"Q5Q5LQQwMZ"}],"data":{},"key":"K7YGmrD2Zl"}],"key":"AFTDVDa8c4"}],"key":"jnwOuFPNT7"}],"key":"uE99hG7el1"},{"type":"tabItem","title":"MATLAB","sync":"matlab","children":[{"type":"embed","source":{"url":"/chapter2-1","label":"demo-pivoting-permute-matlab","kind":"Notebook","slug":"chapter2-1","location":"/matlab/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-pivoting-permute","label":"demo-pivoting-permute","kind":"proof:example","position":{"start":{"line":884,"column":1},"end":{"line":884,"column":23}},"children":[{"type":"text","value":"Example ","key":"ORYC3elb8J"},{"type":"text","value":"2.6.3","key":"NEuwoDigRZ"}],"template":"Example %s","enumerator":"2.6.3","resolved":true,"html_id":"demo-pivoting-permute","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"Q0rf3KnN8C"}],"key":"sWeQLxN7SK"},{"type":"paragraph","position":{"start":{"line":886,"column":1},"end":{"line":886,"column":1}},"children":[{"type":"text","value":"Here again is the matrix from ","position":{"start":{"line":886,"column":1},"end":{"line":886,"column":1}},"key":"KX7rhJCCYY"},{"type":"crossReference","kind":"proof:example","identifier":"demo-pivoting-fix","label":"demo-pivoting-fix","children":[{"type":"text","value":"Demo ","key":"pLhNdKls2q"},{"type":"text","value":"2.6.2","key":"wZwB51I6YG"}],"template":"Example %s","enumerator":"2.6.2","resolved":true,"html_id":"demo-pivoting-fix","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"ABZplXMjp1"},{"type":"text","value":".","position":{"start":{"line":886,"column":1},"end":{"line":886,"column":1}},"key":"PCQTYdEsI3"}],"key":"vlQLDy5LwT"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A = [2 0 4 3; -2 0 2 -13; 1 15 2 -4.5; -4 5 -7 -10]","key":"FTHc9v45ut"},{"type":"output","id":"pbXFvtNwJiU0WQeuJY-2y","data":[{"output_type":"execute_result","execution_count":88,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>A = 4×4 double\n   2.0000e+00            0   4.0000e+00   3.0000e+00\n  -2.0000e+00            0   2.0000e+00  -1.3000e+01\n   1.0000e+00   1.5000e+01   2.0000e+00  -4.5000e+00\n  -4.0000e+00   5.0000e+00  -7.0000e+00  -1.0000e+01\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"A = 4×4 double\n   2.0000e+00            0   4.0000e+00   3.0000e+00\n  -2.0000e+00            0   2.0000e+00  -1.3000e+01\n   1.0000e+00   1.5000e+01   2.0000e+00  -4.5000e+00\n  -4.0000e+00   5.0000e+00  -7.0000e+00  -1.0000e+01\n","content_type":"text/plain"}}}],"key":"MManXC6StU"}],"data":{},"key":"WvSh38IbF3"},{"type":"paragraph","position":{"start":{"line":892,"column":1},"end":{"line":892,"column":1}},"children":[{"type":"text","value":"As the factorization proceeded, the pivots were selected from rows 4, 3, 2, and finally 1. If we were to put the rows of ","position":{"start":{"line":892,"column":1},"end":{"line":892,"column":1}},"key":"Tx5tDaUNWQ"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":892,"column":1},"end":{"line":892,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"c01svs71vK"},{"type":"text","value":" into that order, then the algorithm would run exactly like the plain LU factorization from ","position":{"start":{"line":892,"column":1},"end":{"line":892,"column":1}},"key":"eKDZFo7aWU"},{"type":"link","kind":"numref","identifier":"section-linsys-lu","label":"section-linsys-lu","url":"/lu","internal":true,"dataUrl":"/lu.json","children":[{"type":"text","value":"LU factorization","key":"jpGgNAaf2i"}],"key":"rhkFOdLSwW"},{"type":"text","value":".","position":{"start":{"line":892,"column":1},"end":{"line":892,"column":1}},"key":"eJzdJpvOTL"}],"key":"EQpNlF1d83"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"B = A([4, 3, 2, 1], :);\n[L, U] = lufact(B);","key":"xAINlGW2wt"},{"type":"output","id":"1WsbtleyKOvyhD0dlFDc8","data":[],"key":"JREHeFbrVu"}],"data":{},"key":"zaHlSrCPKf"},{"type":"paragraph","position":{"start":{"line":899,"column":1},"end":{"line":899,"column":1}},"children":[{"type":"text","value":"We obtain the same ","position":{"start":{"line":899,"column":1},"end":{"line":899,"column":1}},"key":"HmFDyIcRtj"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":899,"column":1},"end":{"line":899,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"S5J5VwQV0D"},{"type":"text","value":" as before:","position":{"start":{"line":899,"column":1},"end":{"line":899,"column":1}},"key":"VZTw3mITrU"}],"key":"OZqYwv1EXe"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"U","key":"ozDcaJaZqr"},{"type":"output","id":"bcu1xguQa3PK2yWiwVhaJ","data":[{"output_type":"execute_result","execution_count":90,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>U = 4×4 double\n  -4.0000e+00   5.0000e+00  -7.0000e+00  -1.0000e+01\n            0   1.6250e+01   2.5000e-01  -7.0000e+00\n            0            0   5.5385e+00  -9.0769e+00\n            0            0            0  -1.6667e-01\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"U = 4×4 double\n  -4.0000e+00   5.0000e+00  -7.0000e+00  -1.0000e+01\n            0   1.6250e+01   2.5000e-01  -7.0000e+00\n            0            0   5.5385e+00  -9.0769e+00\n            0            0            0  -1.6667e-01\n","content_type":"text/plain"}}}],"key":"AEtuosyhZg"}],"data":{},"key":"Lj2JwRE6Ev"},{"type":"paragraph","position":{"start":{"line":905,"column":1},"end":{"line":905,"column":1}},"children":[{"type":"text","value":"And ","position":{"start":{"line":905,"column":1},"end":{"line":905,"column":1}},"key":"Vv2Yt6klPE"},{"type":"inlineMath","value":"\\mathbf{L}","position":{"start":{"line":905,"column":1},"end":{"line":905,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">L</span></span></span></span>","key":"zlemmqaUGk"},{"type":"text","value":" has the same rows as before, but arranged into triangular order:","position":{"start":{"line":905,"column":1},"end":{"line":905,"column":1}},"key":"P2SMVW8lGz"}],"key":"TcmMTNxBPF"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"L","key":"j7YbK5c4px"},{"type":"output","id":"aiZ4C7yL86Ts6zb2eLrgi","data":[{"output_type":"execute_result","execution_count":91,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>L = 4×4 double\n   1.0000e+00            0            0            0\n  -2.5000e-01   1.0000e+00            0            0\n   5.0000e-01  -1.5385e-01   1.0000e+00            0\n  -5.0000e-01   1.5385e-01   8.3333e-02   1.0000e+00\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"L = 4×4 double\n   1.0000e+00            0            0            0\n  -2.5000e-01   1.0000e+00            0            0\n   5.0000e-01  -1.5385e-01   1.0000e+00            0\n  -5.0000e-01   1.5385e-01   8.3333e-02   1.0000e+00\n","content_type":"text/plain"}}}],"key":"vGgY9Dtj5v"}],"data":{},"key":"btnZnNb7hL"}],"key":"Sq2RPSF5df"}],"key":"zWR9TVVMX1"}],"key":"ypG9VqHSpC"},{"type":"tabItem","title":"Python","sync":"python","children":[{"type":"embed","source":{"url":"/chapter2-2","label":"demo-pivoting-permute-python","kind":"Notebook","slug":"chapter2-2","location":"/python/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-pivoting-permute","label":"demo-pivoting-permute","kind":"proof:example","position":{"start":{"line":869,"column":1},"end":{"line":869,"column":23}},"children":[{"type":"text","value":"Example ","key":"npP807ES6u"},{"type":"text","value":"2.6.3","key":"Qtup9wEtqm"}],"template":"Example %s","enumerator":"2.6.3","resolved":true,"html_id":"demo-pivoting-permute","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"OFCDE86xEy"}],"key":"pyGtn8rmZz"},{"type":"paragraph","position":{"start":{"line":871,"column":1},"end":{"line":871,"column":1}},"children":[{"type":"text","value":"Here again is the matrix from ","position":{"start":{"line":871,"column":1},"end":{"line":871,"column":1}},"key":"SuHuQfCNJP"},{"type":"crossReference","kind":"proof:example","identifier":"demo-pivoting-fix","label":"demo-pivoting-fix","children":[{"type":"text","value":"Demo ","key":"w5FKKtOkFK"},{"type":"text","value":"2.6.2","key":"TDz2VR9hVo"}],"template":"Example %s","enumerator":"2.6.2","resolved":true,"html_id":"demo-pivoting-fix","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"uZyVrp4ipu"},{"type":"text","value":".","position":{"start":{"line":871,"column":1},"end":{"line":871,"column":1}},"key":"rJUEeR3NUW"}],"key":"QqiBLL5TrT"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"A = array([\n    [2, 0, 4, 3],\n    [-2, 0, 2, -13],\n    [1, 15, 2, -4.5],\n    [-4, 5, -7, -10]\n    ])","key":"q1WuUQ4xXS"},{"type":"output","id":"P-9a5CO1Cd9bMIVD3IDEr","data":[],"key":"s0PP3zy4tU"}],"data":{},"key":"fVaEkKzcTJ"},{"type":"paragraph","position":{"start":{"line":882,"column":1},"end":{"line":882,"column":1}},"children":[{"type":"text","value":"As the factorization proceeded, the pivots were selected from rows 4, 3, 2, and finally 1 (with NumPy indices being one less). If we were to put the rows of ","position":{"start":{"line":882,"column":1},"end":{"line":882,"column":1}},"key":"dtAKCp6jAo"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":882,"column":1},"end":{"line":882,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"xxjuGdW9wk"},{"type":"text","value":" into that order, then the algorithm would run exactly like the plain LU factorization from ","position":{"start":{"line":882,"column":1},"end":{"line":882,"column":1}},"key":"Mmxrf7k82m"},{"type":"link","kind":"numref","identifier":"section-linsys-lu","label":"section-linsys-lu","url":"/lu","internal":true,"dataUrl":"/lu.json","children":[{"type":"text","value":"LU factorization","key":"gt7b01ig65"}],"key":"UWGkTLgVpQ"},{"type":"text","value":".","position":{"start":{"line":882,"column":1},"end":{"line":882,"column":1}},"key":"saHq86mQRH"}],"key":"sV1QQew4gc"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"B = A[[3, 2, 1, 0], :]\nL, U = FNC.lufact(B);","key":"HJsnYkiSuW"},{"type":"output","id":"i-a8913qvEy063rokBC7d","data":[],"key":"nYLPIlOron"}],"data":{},"key":"VQsholWMJh"},{"type":"paragraph","position":{"start":{"line":889,"column":1},"end":{"line":889,"column":1}},"children":[{"type":"text","value":"We obtain the same ","position":{"start":{"line":889,"column":1},"end":{"line":889,"column":1}},"key":"VRwnzb7ZFp"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":889,"column":1},"end":{"line":889,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"nFkLhOwtjk"},{"type":"text","value":" as before:","position":{"start":{"line":889,"column":1},"end":{"line":889,"column":1}},"key":"s2xwqShgm6"}],"key":"f1pGTVDK9S"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(U)","key":"SP2o4BDyat"},{"type":"output","id":"SH9iChTjk56p3xcxRG8dw","data":[{"output_type":"stream","name":"stdout","text":"[[ -4.           5.          -7.         -10.        ]\n [  0.          16.25         0.25        -7.        ]\n [  0.           0.           5.53846154  -9.07692308]\n [  0.           0.           0.          -0.16666667]]\n"}],"key":"fowe7PfoUo"}],"data":{},"key":"ePdsI6qGTk"},{"type":"paragraph","position":{"start":{"line":895,"column":1},"end":{"line":895,"column":1}},"children":[{"type":"text","value":"And ","position":{"start":{"line":895,"column":1},"end":{"line":895,"column":1}},"key":"SWZmY9ewT2"},{"type":"inlineMath","value":"\\mathbf{L}","position":{"start":{"line":895,"column":1},"end":{"line":895,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">L</span></span></span></span>","key":"wbNg526HVt"},{"type":"text","value":" has the same rows as before, but arranged into triangular order:","position":{"start":{"line":895,"column":1},"end":{"line":895,"column":1}},"key":"juH0Nxo7v4"}],"key":"OgLDkf9Lhr"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(L)","key":"Ek9OwFsPhO"},{"type":"output","id":"0xFUNJHuEizPIcW9v2NTY","data":[{"output_type":"stream","name":"stdout","text":"[[ 1.          0.          0.          0.        ]\n [-0.25        1.          0.          0.        ]\n [ 0.5        -0.15384615  1.          0.        ]\n [-0.5         0.15384615  0.08333333  1.        ]]\n"}],"key":"gzbyWf7IAR"}],"data":{},"key":"aogoVJvSEI"}],"key":"NX1DvbfMxd"}],"key":"JXicAvfQsT"}],"key":"oogRyYa0Cm"}],"key":"lEja7pfSWV"}],"label":"demo-pivoting-permute","identifier":"demo-pivoting-permute","html_id":"demo-pivoting-permute","enumerator":"2.6.3","key":"g5akCSi3q8"},{"type":"paragraph","position":{"start":{"line":110,"column":1},"end":{"line":110,"column":1}},"children":[{"type":"text","value":"In principle, if the permutation of rows implied by the pivot locations is applied all at once to the original ","position":{"start":{"line":110,"column":1},"end":{"line":110,"column":1}},"key":"woYd5jDRTr"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":110,"column":1},"end":{"line":110,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"LJwvuWPcjV"},{"type":"text","value":", no further pivoting is needed. In practice, this permutation cannot be determined immediately from the original ","position":{"start":{"line":110,"column":1},"end":{"line":110,"column":1}},"key":"BY9tg2MOaT"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":110,"column":1},"end":{"line":110,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"DYhmophKp5"},{"type":"text","value":"; the only way to find it is to run the algorithm. Having obtained it at the end, though, we can use it to state a simple relationship.","position":{"start":{"line":110,"column":1},"end":{"line":110,"column":1}},"key":"NG02Hxsv8D"}],"key":"kv4PgXFwdu"},{"type":"proof","kind":"definition","enumerated":true,"children":[{"type":"admonitionTitle","children":[{"type":"text","value":"PLU factorization","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"key":"TLbByvhOru"}],"key":"mZDsNGcLq3"},{"type":"paragraph","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"children":[{"type":"text","value":"Given ","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"key":"cTwXQ2qd0K"},{"type":"inlineMath","value":"n\\times n","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>×</mo><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n\\times n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"pYY1beMU6u"},{"type":"text","value":" matrix ","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"key":"gVeWDUSdHs"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"eHy1KWCTJw"},{"type":"text","value":", the ","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"key":"bqx1ZFeDh6"},{"type":"strong","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"children":[{"type":"text","value":"PLU factorization","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"key":"XL21pH8TZV"}],"key":"Sj55RYPNBg"},{"type":"text","value":" is a unit lower triangular ","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"key":"poidp75wmd"},{"type":"inlineMath","value":"\\mathbf{L}","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">L</span></span></span></span>","key":"QbOjy9NoPF"},{"type":"text","value":", an upper triangular ","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"key":"cnFJ0CCuAw"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"iQJoZhQzb9"},{"type":"text","value":", and a permutation ","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"key":"NlyZ3ko0Rw"},{"type":"inlineMath","value":"i_1,\\ldots,i_n","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>i</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><mo>…</mo><mo separator=\"true\">,</mo><msub><mi>i</mi><mi>n</mi></msub></mrow><annotation encoding=\"application/x-tex\">i_1,\\ldots,i_n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"pk4ciTRPjx"},{"type":"text","value":" of the integers ","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"key":"yAn3xOsO6y"},{"type":"inlineMath","value":"1,\\ldots,n","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mo separator=\"true\">,</mo><mo>…</mo><mo separator=\"true\">,</mo><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">1,\\ldots,n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8389em;vertical-align:-0.1944em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"F1V2EGz9C3"},{"type":"text","value":", such that","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"key":"FjrrNrbtpa"}],"key":"e0hVqdjOfC"},{"type":"math","value":"\\tilde{\\mathbf{A}} = \\mathbf{L}\\mathbf{U},","position":{"start":{"line":118,"column":1},"end":{"line":118,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mover accent=\"true\"><mi mathvariant=\"bold\">A</mi><mo>~</mo></mover><mo>=</mo><mi mathvariant=\"bold\">L</mi><mi mathvariant=\"bold\">U</mi><mo separator=\"true\">,</mo></mrow><annotation encoding=\"application/x-tex\">\\tilde{\\mathbf{A}} = \\mathbf{L}\\mathbf{U},</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.923em;\"></span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.923em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathbf\">A</span></span><span style=\"top:-3.6051em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.1111em;\"><span class=\"mord\">~</span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8805em;vertical-align:-0.1944em;\"></span><span class=\"mord mathbf\">LU</span><span class=\"mpunct\">,</span></span></span></span></span>","enumerator":"2.6.1","key":"IxhehzlvZJ"},{"type":"paragraph","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"children":[{"type":"text","value":"where rows ","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"key":"JwtmVnJQNy"},{"type":"inlineMath","value":"1,\\ldots,n","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mo separator=\"true\">,</mo><mo>…</mo><mo separator=\"true\">,</mo><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">1,\\ldots,n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8389em;vertical-align:-0.1944em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"quC40h5fU3"},{"type":"text","value":" of ","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"key":"aOqYlNUXqf"},{"type":"inlineMath","value":"\\tilde{\\mathbf{A}}","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mover accent=\"true\"><mi mathvariant=\"bold\">A</mi><mo>~</mo></mover></mrow><annotation encoding=\"application/x-tex\">\\tilde{\\mathbf{A}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.923em;\"></span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.923em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathbf\">A</span></span><span style=\"top:-3.6051em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.1111em;\"><span class=\"mord\">~</span></span></span></span></span></span></span></span></span></span>","key":"bT9LsMt4bz"},{"type":"text","value":" are rows ","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"key":"FHAQrpeIvB"},{"type":"inlineMath","value":"i_1,\\ldots,i_n","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>i</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><mo>…</mo><mo separator=\"true\">,</mo><msub><mi>i</mi><mi>n</mi></msub></mrow><annotation encoding=\"application/x-tex\">i_1,\\ldots,i_n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"MMQwcCuqyz"},{"type":"text","value":" of ","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"key":"tYiTgB1bqG"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"Xn4day8qQ0"},{"type":"text","value":".","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"key":"Gvn9diSFEB"}],"key":"h6A3BNhWdd"}],"indexEntries":[{"entry":"matrix factorization","subEntry":{"value":"pivoted LU","kind":"entry"},"emphasis":true},{"entry":"PLU factorization","emphasis":true}],"label":"index-XPA3lV1yhR","identifier":"index-xpa3lv1yhr","html_id":"index-xpa3lv1yhr","enumerator":"2.6.1","key":"cEFsLdTZUR"},{"type":"paragraph","position":{"start":{"line":123,"column":1},"end":{"line":123,"column":1}},"children":[{"type":"crossReference","kind":"proof:algorithm","identifier":"function-plufact","label":"function-plufact","children":[{"type":"text","value":"Function ","key":"lh2EjPC3aY"},{"type":"text","value":"2.6.2","key":"TvPKT66OOx"}],"template":"Algorithm %s","enumerator":"2.6.2","resolved":true,"html_id":"function-plufact","key":"c0ExYJmsAS"},{"type":"text","value":" shows our implementation of PLU factorization.","position":{"start":{"line":123,"column":1},"end":{"line":123,"column":1}},"key":"aXZxvISk2B"},{"type":"footnoteReference","identifier":"plu","label":"PLU","position":{"start":{"line":123,"column":1},"end":{"line":123,"column":1}},"enumerator":"1","key":"P9FHxwJcTF"}],"key":"Q8Zy0HbAbv"},{"type":"proof","kind":"algorithm","enumerated":true,"children":[{"type":"admonitionTitle","children":[{"type":"text","value":"plufact","position":{"start":{"line":128,"column":1},"end":{"line":128,"column":1}},"key":"m8zKECtAw7"}],"key":"dGAWnX2sLB"},{"type":"tabSet","children":[{"type":"tabItem","title":"Julia","sync":"julia","children":[{"type":"embed","source":{"url":"/chapter2","label":"function-plufact-julia","kind":"Notebook","slug":"chapter2","location":"/julia/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"LU factorization with partial pivoting","position":{"start":{"line":66,"column":1},"end":{"line":66,"column":1}},"key":"ZtSKYnY9Ly"}],"key":"KIjvOHSSrv"},{"type":"include","file":"FNCFunctions/src/chapter02.jl","literal":true,"filter":{"startAfter":"# begin plufact","endBefore":"# end plufact"},"children":[{"type":"code","value":"\"\"\"\n    plufact(A)\n\nCompute the PLU factorization of square matrix `A`, returning the\ntriangular factors and a row permutation vector.\n\"\"\"\nfunction plufact(A)\n    n = size(A, 1)\n    L = zeros(n, n)\n    U = zeros(n, n)\n    p = fill(0, n)\n    Aₖ = float(copy(A))\n\n    # Reduction by outer products\n    for k in 1:n\n        p[k] = argmax(abs.(Aₖ[:, k]))    # best pivot in column k\n        U[k, :] = Aₖ[p[k], :]\n        L[:, k] = Aₖ[:, k] / U[k, k]\n        if k < n    # no update needed on last iteration\n            Aₖ -= L[:, k] * U[k, :]'\n        end\n    end\n    return LowerTriangular(L[p, :]), U, p\nend","lang":"julia","showLineNumbers":true,"filename":"plufact.jl","key":"uQvZj6yqz2"}],"key":"lIGo000ZOv"},{"type":"code","lang":"","value":"","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"key":"rzuEW9Wqy3"}],"key":"raZmXNholf"}],"key":"MVeDRunQ15"}],"key":"biZOeejIF6"},{"type":"tabItem","title":"MATLAB","sync":"matlab","children":[{"type":"embed","source":{"url":"/chapter2","label":"function-plufact-julia","kind":"Notebook","slug":"chapter2","location":"/julia/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"LU factorization with partial pivoting","position":{"start":{"line":66,"column":1},"end":{"line":66,"column":1}},"key":"CnfaL6gl1H"}],"key":"fpTWz74Mb0"},{"type":"include","file":"FNCFunctions/src/chapter02.jl","literal":true,"filter":{"startAfter":"# begin plufact","endBefore":"# end plufact"},"children":[{"type":"code","value":"\"\"\"\n    plufact(A)\n\nCompute the PLU factorization of square matrix `A`, returning the\ntriangular factors and a row permutation vector.\n\"\"\"\nfunction plufact(A)\n    n = size(A, 1)\n    L = zeros(n, n)\n    U = zeros(n, n)\n    p = fill(0, n)\n    Aₖ = float(copy(A))\n\n    # Reduction by outer products\n    for k in 1:n\n        p[k] = argmax(abs.(Aₖ[:, k]))    # best pivot in column k\n        U[k, :] = Aₖ[p[k], :]\n        L[:, k] = Aₖ[:, k] / U[k, k]\n        if k < n    # no update needed on last iteration\n            Aₖ -= L[:, k] * U[k, :]'\n        end\n    end\n    return LowerTriangular(L[p, :]), U, p\nend","lang":"julia","showLineNumbers":true,"filename":"plufact.jl","key":"KA8akxgenP"}],"key":"YSmrsmo4wP"},{"type":"code","lang":"","value":"","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"key":"R58z9VLgOQ"}],"key":"Hh5kvhG7tH"}],"key":"nzvcMkps9D"}],"key":"daaWhYC1UP"},{"type":"tabItem","title":"Python","sync":"python","children":[{"type":"embed","source":{"url":"/chapter2-2","label":"function-plufact-python","kind":"Notebook","slug":"chapter2-2","location":"/python/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"LU factorization with partial pivoting","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"key":"WYxI0Pt7vG"}],"key":"CHAKJwdrzR"},{"type":"include","file":"fncbook/fncbook/chapter02.py","literal":true,"filter":{"lines":[[52,72]]},"children":[{"type":"code","value":"def plufact(A):\n    \"\"\"\n        plufact(A)\n\n    Compute the PLU factorization of square matrix A, returning the\n    triangular factors and a row permutation vector.\n    \"\"\"\n    n = A.shape[0]\n    L = np.zeros((n, n))\n    U = np.zeros((n, n))\n    p = np.zeros(n, dtype=int)\n    A_k = np.copy(A)\n\n    # Reduction by np.outer products\n    for k in range(n):\n        p[k] = np.argmax(abs(A_k[:, k]))\n        U[k, :] = A_k[p[k], :]\n        L[:, k] = A_k[:, k] / U[k, k]\n        if k < n-1:\n            A_k -= np.outer(L[:, k], U[k, :])\n    return L[p, :], U, p","lang":"python","showLineNumbers":true,"filename":"plufact.py","key":"YB3YrcFQ5K"}],"key":"NsQpambvlm"}],"key":"ylSKdvEgtG"}],"key":"pBmpCP9sC0"}],"key":"RjXXvcXbfM"}],"key":"vfBTKs3vCE"}],"label":"function-plufact","identifier":"function-plufact","html_id":"function-plufact","enumerator":"2.6.2","key":"xwQhiTRswn"},{"type":"paragraph","position":{"start":{"line":151,"column":1},"end":{"line":151,"column":1}},"children":[{"type":"text","value":"Ideally, the PLU factorization takes ","position":{"start":{"line":151,"column":1},"end":{"line":151,"column":1}},"key":"hxNKG93M9O"},{"type":"inlineMath","value":"\\sim \\frac{2}{3}n^3","position":{"start":{"line":151,"column":1},"end":{"line":151,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>∼</mo><mfrac><mn>2</mn><mn>3</mn></mfrac><msup><mi>n</mi><mn>3</mn></msup></mrow><annotation encoding=\"application/x-tex\">\\sim \\frac{2}{3}n^3</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.3669em;\"></span><span class=\"mrel\">∼</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1901em;vertical-align:-0.345em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8451em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">3</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mord\"><span class=\"mord mathnormal\">n</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span></span></span></span></span></span></span></span>","key":"SZNBZatgLV"},{"type":"text","value":" flops asymptotically, just like LU without pivoting. The implementation in ","position":{"start":{"line":151,"column":1},"end":{"line":151,"column":1}},"key":"tKJiptSNf3"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-plufact","label":"function-plufact","children":[{"type":"text","value":"Function ","key":"matdihllFY"},{"type":"text","value":"2.6.2","key":"qQjVwq5hxg"}],"template":"Algorithm %s","enumerator":"2.6.2","resolved":true,"html_id":"function-plufact","key":"VE5tSPmjtj"},{"type":"text","value":" does not achieve this optimal flop count, however. Like ","position":{"start":{"line":151,"column":1},"end":{"line":151,"column":1}},"key":"AoAV5iAABP"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-lufact","label":"function-lufact","children":[{"type":"text","value":"Function ","key":"QEhTIU7DD4"},{"type":"text","value":"2.4.1","key":"Z3MSHdxkUm"}],"template":"Algorithm %s","enumerator":"2.4.1","resolved":true,"html_id":"function-lufact","remote":true,"url":"/lu","dataUrl":"/lu.json","key":"hLhZQqvoMl"},{"type":"text","value":", it does unnecessary operations on structurally known zeros for the sake of being easier to understand.","position":{"start":{"line":151,"column":1},"end":{"line":151,"column":1}},"key":"oZawLT0hGF"}],"key":"cjNlMTPgpM"},{"type":"heading","depth":2,"position":{"start":{"line":153,"column":1},"end":{"line":153,"column":1}},"children":[{"type":"text","value":"Linear systems","position":{"start":{"line":153,"column":1},"end":{"line":153,"column":1}},"key":"p0KJ9cXeaJ"}],"identifier":"linear-systems","label":"Linear systems","html_id":"linear-systems","implicit":true,"enumerator":"2.6.3","key":"CdoGOTvUYs"},{"type":"paragraph","position":{"start":{"line":155,"column":1},"end":{"line":155,"column":1}},"children":[{"type":"text","value":"The output of ","position":{"start":{"line":155,"column":1},"end":{"line":155,"column":1}},"key":"OXNZWGpS3I"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-plufact","label":"function-plufact","children":[{"type":"text","value":"Function ","key":"e7Yd0SDOpa"},{"type":"text","value":"2.6.2","key":"ynRO5jw2bW"}],"template":"Algorithm %s","enumerator":"2.6.2","resolved":true,"html_id":"function-plufact","key":"TihHXw3NQN"},{"type":"text","value":" is a factorization of a row-permuted ","position":{"start":{"line":155,"column":1},"end":{"line":155,"column":1}},"key":"QmNr9DtdG5"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":155,"column":1},"end":{"line":155,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"HJQ7ohOEWE"},{"type":"text","value":". Therefore, given a linear system ","position":{"start":{"line":155,"column":1},"end":{"line":155,"column":1}},"key":"zEEUl2X3Gw"},{"type":"inlineMath","value":"\\mathbf{A}\\mathbf{x}=\\mathbf{b}","position":{"start":{"line":155,"column":1},"end":{"line":155,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi><mi mathvariant=\"bold\">x</mi><mo>=</mo><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}\\mathbf{x}=\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">Ax</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"HhM3YOTT6O"},{"type":"text","value":", we have to permute ","position":{"start":{"line":155,"column":1},"end":{"line":155,"column":1}},"key":"ygBNdLJKSO"},{"type":"inlineMath","value":"\\mathbf{b}","position":{"start":{"line":155,"column":1},"end":{"line":155,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"ShxzfPvMAd"},{"type":"text","value":" the same way before applying forward and backward substitution. This is equivalent to changing the order of the equations in a linear system, which does not affect its solution.","position":{"start":{"line":155,"column":1},"end":{"line":155,"column":1}},"key":"G0gJtahxwY"}],"key":"VdALH9NF8e"},{"type":"proof","kind":"example","enumerated":true,"children":[{"type":"admonitionTitle","children":[{"type":"text","value":"PLU factorization for solving linear systems","position":{"start":{"line":158,"column":1},"end":{"line":158,"column":1}},"key":"NW2iAt47G1"}],"key":"T9EWhJ8KLA"},{"type":"tabSet","children":[{"type":"tabItem","title":"Julia","sync":"julia","children":[{"type":"embed","source":{"url":"/chapter2","label":"demo-pivoting-usage-julia","kind":"Notebook","slug":"chapter2","location":"/julia/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-pivoting-usage","label":"demo-pivoting-usage","kind":"proof:example","position":{"start":{"line":966,"column":1},"end":{"line":966,"column":21}},"children":[{"type":"text","value":"Example ","key":"FU6zKxBYky"},{"type":"text","value":"2.6.4","key":"YunUeDnCAG"}],"template":"Example %s","enumerator":"2.6.4","resolved":true,"html_id":"demo-pivoting-usage","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"JbfN9Tjq7t"}],"key":"c0fCBIuu6D"},{"type":"paragraph","position":{"start":{"line":968,"column":1},"end":{"line":968,"column":1}},"children":[{"type":"text","value":"The third output of ","position":{"start":{"line":968,"column":1},"end":{"line":968,"column":1}},"key":"RSbm5jYWJQ"},{"type":"inlineCode","value":"plufact","position":{"start":{"line":968,"column":1},"end":{"line":968,"column":1}},"key":"JyhpFRxZ0e"},{"type":"text","value":" is the permutation vector we need to apply to ","position":{"start":{"line":968,"column":1},"end":{"line":968,"column":1}},"key":"VrXRAo2o8i"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":968,"column":1},"end":{"line":968,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"xibZzMjFOV"},{"type":"text","value":".","position":{"start":{"line":968,"column":1},"end":{"line":968,"column":1}},"key":"sOuOdJ4JUV"}],"key":"CkD4VkkLNv"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"A = rand(1:20, 4, 4)\nL, U, p = FNC.plufact(A)\nA[p,:] - L * U   # should be ≈ 0","key":"xq1LckSJV4"},{"type":"output","id":"tUUccKVN7pURKDXAxro5k","data":[{"output_type":"execute_result","execution_count":94,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n 0.0  0.0   0.0          0.0\n 0.0  0.0   0.0          0.0\n 0.0  0.0   0.0          0.0\n 0.0  0.0  -2.22045e-16  0.0","content_type":"text/plain"}}}],"key":"v3HmlaBiza"}],"data":{},"key":"ZZnZkoa7FY"},{"type":"paragraph","position":{"start":{"line":976,"column":1},"end":{"line":976,"column":1}},"children":[{"type":"text","value":"Given a vector ","position":{"start":{"line":976,"column":1},"end":{"line":976,"column":1}},"key":"PZTSOwF6Ye"},{"type":"inlineMath","value":"\\mathbf{b}","position":{"start":{"line":976,"column":1},"end":{"line":976,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"i16Cnev06t"},{"type":"text","value":", we solve ","position":{"start":{"line":976,"column":1},"end":{"line":976,"column":1}},"key":"alcV1KWPeS"},{"type":"inlineMath","value":"\\mathbf{A}\\mathbf{x}=\\mathbf{b}","position":{"start":{"line":976,"column":1},"end":{"line":976,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi><mi mathvariant=\"bold\">x</mi><mo>=</mo><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}\\mathbf{x}=\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">Ax</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"a6DspxdH2d"},{"type":"text","value":" by first permuting the entries of ","position":{"start":{"line":976,"column":1},"end":{"line":976,"column":1}},"key":"ROuYhbo0uP"},{"type":"inlineMath","value":"\\mathbf{b}","position":{"start":{"line":976,"column":1},"end":{"line":976,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"HkZk4ql0rt"},{"type":"text","value":" and then proceeding as before.","position":{"start":{"line":976,"column":1},"end":{"line":976,"column":1}},"key":"wUvHxTolCt"}],"key":"fqnj4NqmzG"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"b = rand(4)\nz = FNC.forwardsub(L,b[p])\nx = FNC.backsub(U,z)","key":"r644Z5lpUg"},{"type":"output","id":"0N-4Q3DoftMxcEuIa1LIq","data":[{"output_type":"execute_result","execution_count":95,"metadata":{},"data":{"text/plain":{"content":"4-element Vector{Float64}:\n  0.06975240623150412\n  0.10509064980619284\n -0.08183997688444361\n -0.01630557799194048","content_type":"text/plain"}}}],"key":"ywGmcIUv3b"}],"data":{},"key":"jHQzb2qo5c"},{"type":"paragraph","position":{"start":{"line":984,"column":1},"end":{"line":984,"column":1}},"children":[{"type":"text","value":"A residual check is successful:","position":{"start":{"line":984,"column":1},"end":{"line":984,"column":1}},"key":"wBRz3D6sh8"}],"key":"Qn6hhlkVoY"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"b - A*x","key":"JQ7EZBdcxm"},{"type":"output","id":"rLLXp4cJkLcHBfWAkmeWJ","data":[{"output_type":"execute_result","execution_count":96,"metadata":{},"data":{"text/plain":{"content":"4-element Vector{Float64}:\n -1.1102230246251565e-16\n  3.3306690738754696e-16\n  2.7755575615628914e-17\n  0.0","content_type":"text/plain"}}}],"key":"tamS38U1Bh"}],"data":{},"key":"f0YASkUEXe"}],"key":"w18KIThQ3L"}],"key":"H4GJ3oyEdQ"}],"key":"On6kvnAWz5"},{"type":"tabItem","title":"MATLAB","sync":"matlab","children":[{"type":"embed","source":{"url":"/chapter2-1","label":"demo-pivoting-usage-matlab","kind":"Notebook","slug":"chapter2-1","location":"/matlab/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-pivoting-usage","label":"demo-pivoting-usage","kind":"proof:example","position":{"start":{"line":913,"column":1},"end":{"line":913,"column":21}},"children":[{"type":"text","value":"Example ","key":"lk2UhGEWM6"},{"type":"text","value":"2.6.4","key":"wyV69bVszZ"}],"template":"Example %s","enumerator":"2.6.4","resolved":true,"html_id":"demo-pivoting-usage","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"XcPxA4zg7H"}],"key":"TPf7VllM9M"},{"type":"paragraph","position":{"start":{"line":915,"column":1},"end":{"line":915,"column":1}},"children":[{"type":"text","value":"The third output of ","position":{"start":{"line":915,"column":1},"end":{"line":915,"column":1}},"key":"vM1H29oC9H"},{"type":"inlineCode","value":"plufact","position":{"start":{"line":915,"column":1},"end":{"line":915,"column":1}},"key":"qPNR20bC4K"},{"type":"text","value":" is the permutation vector we need to apply to ","position":{"start":{"line":915,"column":1},"end":{"line":915,"column":1}},"key":"eVS6JhtfCn"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":915,"column":1},"end":{"line":915,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"Pxj8NEa0kR"},{"type":"text","value":".","position":{"start":{"line":915,"column":1},"end":{"line":915,"column":1}},"key":"W6SjiyZFYi"}],"key":"qpEuii4LH9"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A = randi(20, 4, 4);\n[L, U, p] = plufact(A);\nA(p, :) - L * U    % should be ≈ 0","key":"Tx1Hk5gX86"},{"type":"output","id":"z0VYCnbFDTcQ6UMl0zS2J","data":[{"output_type":"execute_result","execution_count":92,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = 4×4 double\n     0     0     0     0\n     0     0     0     0\n     0     0     0     0\n     0     0     0     0\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = 4×4 double\n     0     0     0     0\n     0     0     0     0\n     0     0     0     0\n     0     0     0     0\n","content_type":"text/plain"}}}],"key":"bf4QRFUZdx"}],"data":{},"key":"Xqyu6GLacc"},{"type":"paragraph","position":{"start":{"line":923,"column":1},"end":{"line":923,"column":1}},"children":[{"type":"text","value":"Given a vector ","position":{"start":{"line":923,"column":1},"end":{"line":923,"column":1}},"key":"yJF5MQwUvv"},{"type":"inlineMath","value":"\\mathbf{b}","position":{"start":{"line":923,"column":1},"end":{"line":923,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"JU6XyYbdYh"},{"type":"text","value":", we solve ","position":{"start":{"line":923,"column":1},"end":{"line":923,"column":1}},"key":"t9vPlp96zl"},{"type":"inlineMath","value":"\\mathbf{A}\\mathbf{x}=\\mathbf{b}","position":{"start":{"line":923,"column":1},"end":{"line":923,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi><mi mathvariant=\"bold\">x</mi><mo>=</mo><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}\\mathbf{x}=\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">Ax</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"whimUHKdUv"},{"type":"text","value":" by first permuting the entries of ","position":{"start":{"line":923,"column":1},"end":{"line":923,"column":1}},"key":"GIM10F7lUK"},{"type":"inlineMath","value":"\\mathbf{b}","position":{"start":{"line":923,"column":1},"end":{"line":923,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"OYQnULEaPs"},{"type":"text","value":" and then proceeding as before.","position":{"start":{"line":923,"column":1},"end":{"line":923,"column":1}},"key":"OOmkMUSb6c"}],"key":"GOpkpzFtso"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"b = rand(4, 1);\nz = forwardsub(L, b(p));\nx = backsub(U, z)","key":"rJk9kHYN2u"},{"type":"output","id":"Z4Ybl5j1qIiBcpaYXK0Ob","data":[{"output_type":"execute_result","execution_count":93,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>x = 4×1 double\n   4.1449e-03\n   2.9307e-02\n  -1.4960e-02\n   9.8275e-02\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"x = 4×1 double\n   4.1449e-03\n   2.9307e-02\n  -1.4960e-02\n   9.8275e-02\n","content_type":"text/plain"}}}],"key":"kY00rjnFZ8"}],"data":{},"key":"XUjmvmYzY5"},{"type":"paragraph","position":{"start":{"line":931,"column":1},"end":{"line":931,"column":1}},"children":[{"type":"text","value":"A residual check is successful:","position":{"start":{"line":931,"column":1},"end":{"line":931,"column":1}},"key":"hx2OgCRokj"}],"key":"anmffQ413L"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"b - A*x","key":"tWIF662Kgj"},{"type":"output","id":"Bb6Pdku97UOVwtMIHoGyo","data":[{"output_type":"execute_result","execution_count":94,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = 4×1 double\n     0\n     0\n     0\n     0\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = 4×1 double\n     0\n     0\n     0\n     0\n","content_type":"text/plain"}}}],"key":"NxN0HH5931"}],"data":{},"key":"C1gqUICzVi"}],"key":"yppcaBs3kC"}],"key":"OJpV7UDkQC"}],"key":"J2ygT5MhKC"},{"type":"tabItem","title":"Python","sync":"python","children":[{"type":"embed","source":{"url":"/chapter2-2","label":"demo-pivoting-usage-python","kind":"Notebook","slug":"chapter2-2","location":"/python/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-pivoting-usage","label":"demo-pivoting-usage","kind":"proof:example","position":{"start":{"line":903,"column":1},"end":{"line":903,"column":21}},"children":[{"type":"text","value":"Example ","key":"LNQcbi0BSt"},{"type":"text","value":"2.6.4","key":"UxgAUnMb9s"}],"template":"Example %s","enumerator":"2.6.4","resolved":true,"html_id":"demo-pivoting-usage","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"LkyHr8UWFR"}],"key":"kLw0hhn4K1"},{"type":"paragraph","position":{"start":{"line":905,"column":1},"end":{"line":905,"column":1}},"children":[{"type":"text","value":"The third output of ","position":{"start":{"line":905,"column":1},"end":{"line":905,"column":1}},"key":"fCuhf6CVjO"},{"type":"inlineCode","value":"plufact","position":{"start":{"line":905,"column":1},"end":{"line":905,"column":1}},"key":"ZgsIfpeoNt"},{"type":"text","value":" is the permutation vector we need to apply to ","position":{"start":{"line":905,"column":1},"end":{"line":905,"column":1}},"key":"eIbmq4JGAi"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":905,"column":1},"end":{"line":905,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"ylXIZBWDhp"},{"type":"text","value":".","position":{"start":{"line":905,"column":1},"end":{"line":905,"column":1}},"key":"PKzHXT2OhI"}],"key":"DLesgFayj3"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"A = random.randn(4, 4)\nL, U, p = FNC.plufact(A)\nA[p, :] - L @ U   # should be ≈ 0","key":"sUDGkzZH5W"},{"type":"output","id":"O3xAy-cdtLomek1KXX-KH","data":[{"output_type":"execute_result","execution_count":91,"metadata":{},"data":{"text/plain":{"content":"array([[ 0.00000000e+00,  0.00000000e+00,  0.00000000e+00,\n         0.00000000e+00],\n       [ 0.00000000e+00,  1.11022302e-16,  0.00000000e+00,\n         0.00000000e+00],\n       [ 0.00000000e+00,  0.00000000e+00,  8.32667268e-17,\n         0.00000000e+00],\n       [ 0.00000000e+00,  0.00000000e+00,  1.11022302e-16,\n        -5.55111512e-17]])","content_type":"text/plain"}}}],"key":"M4XkfMundk"}],"data":{},"key":"wuIwYrzDNR"},{"type":"paragraph","position":{"start":{"line":913,"column":1},"end":{"line":913,"column":1}},"children":[{"type":"text","value":"Given a vector ","position":{"start":{"line":913,"column":1},"end":{"line":913,"column":1}},"key":"isTzPJVXP2"},{"type":"inlineMath","value":"\\mathbf{b}","position":{"start":{"line":913,"column":1},"end":{"line":913,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"uI14QwKFYq"},{"type":"text","value":", we solve ","position":{"start":{"line":913,"column":1},"end":{"line":913,"column":1}},"key":"SsYWp6Eomr"},{"type":"inlineMath","value":"\\mathbf{A}\\mathbf{x}=\\mathbf{b}","position":{"start":{"line":913,"column":1},"end":{"line":913,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi><mi mathvariant=\"bold\">x</mi><mo>=</mo><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}\\mathbf{x}=\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">Ax</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"pv2Ri0eksL"},{"type":"text","value":" by first permuting the entries of ","position":{"start":{"line":913,"column":1},"end":{"line":913,"column":1}},"key":"KFWiMbfIbW"},{"type":"inlineMath","value":"\\mathbf{b}","position":{"start":{"line":913,"column":1},"end":{"line":913,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"U84Rfvp9AF"},{"type":"text","value":" and then proceeding as before.","position":{"start":{"line":913,"column":1},"end":{"line":913,"column":1}},"key":"OtOnS7iB7M"}],"key":"VtdF89KLnv"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"b = random.randn(4)\nz = FNC.forwardsub(L, b[p])\nx = FNC.backsub(U, z)","key":"cpnQ048uGM"},{"type":"output","id":"xjjAdv_OCupa-2_xBISrn","data":[],"key":"ymT7ecQ8TS"}],"data":{},"key":"T7DNRxjbZr"},{"type":"paragraph","position":{"start":{"line":921,"column":1},"end":{"line":921,"column":1}},"children":[{"type":"text","value":"A residual check is successful:","position":{"start":{"line":921,"column":1},"end":{"line":921,"column":1}},"key":"urN2dVcc90"}],"key":"aOE22aY4Pi"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"b - A @ x","key":"PhqGJYES2W"},{"type":"output","id":"4Va9hoos5mXNF6NVNRGCV","data":[{"output_type":"execute_result","execution_count":93,"metadata":{},"data":{"text/plain":{"content":"array([-1.11022302e-16, -2.77555756e-17, -1.11022302e-16,  5.55111512e-17])","content_type":"text/plain"}}}],"key":"QfMjwHyvSZ"}],"data":{},"key":"muaxyEQyZu"}],"key":"GZeJc6u4Ju"}],"key":"mXDjdtqd0m"}],"key":"TYafJOEMiK"}],"key":"puOggwDRHr"}],"label":"demo-pivoting-usage","identifier":"demo-pivoting-usage","html_id":"demo-pivoting-usage","enumerator":"2.6.4","key":"AbxN82iN6S"},{"type":"paragraph","position":{"start":{"line":180,"column":1},"end":{"line":180,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":180,"column":1},"end":{"line":180,"column":1}},"key":"gCCQoqpXZk"},{"type":"inlineCode","value":"lu","position":{"start":{"line":180,"column":1},"end":{"line":180,"column":1}},"key":"xuxe4PdFqb"},{"type":"text","value":" function from the built-in package ","position":{"start":{"line":180,"column":1},"end":{"line":180,"column":1}},"key":"QmNPwmqIRr"},{"type":"inlineCode","value":"LinearAlgebra","position":{"start":{"line":180,"column":1},"end":{"line":180,"column":1}},"key":"XeGn3LOYWT"},{"type":"text","value":" returns the same three outputs as ","position":{"start":{"line":180,"column":1},"end":{"line":180,"column":1}},"key":"UCB7VY2R2v"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-plufact","label":"function-plufact","children":[{"type":"text","value":"Function ","key":"z4b7nel0lQ"},{"type":"text","value":"2.6.2","key":"q7KiCVuymz"}],"template":"Algorithm %s","enumerator":"2.6.2","resolved":true,"html_id":"function-plufact","key":"EyRXdrSvcE"},{"type":"text","value":". If you only request one output, it will be a factorization object that can be used with a backslash. This is useful when you want to solve with multiple versions of ","position":{"start":{"line":180,"column":1},"end":{"line":180,"column":1}},"key":"LxVgrviVdv"},{"type":"inlineMath","value":"\\mathbf{b}","position":{"start":{"line":180,"column":1},"end":{"line":180,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"j9RJrafeE5"},{"type":"text","value":" but do the factorization only once.","position":{"start":{"line":180,"column":1},"end":{"line":180,"column":1}},"key":"SXF3r2i7ri"}],"key":"ccPvxsrGKh"},{"type":"proof","kind":"example","enumerated":true,"children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Built-in PLU factorization","position":{"start":{"line":183,"column":1},"end":{"line":183,"column":1}},"key":"MJb9UG6ZRD"}],"key":"QkQKZ7irY6"},{"type":"tabSet","children":[{"type":"tabItem","title":"Julia","sync":"julia","children":[{"type":"embed","source":{"url":"/chapter2","label":"demo-pivoting-builtin-julia","kind":"Notebook","slug":"chapter2","location":"/julia/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-pivoting-builtin","label":"demo-pivoting-builtin","kind":"proof:example","position":{"start":{"line":992,"column":1},"end":{"line":992,"column":23}},"children":[{"type":"text","value":"Example ","key":"AjaU6Y3tMz"},{"type":"text","value":"2.6.5","key":"z5dKhzsqsD"}],"template":"Example %s","enumerator":"2.6.5","resolved":true,"html_id":"demo-pivoting-builtin","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"vGA3uAB0TJ"}],"key":"t8WHWkQDxb"},{"type":"paragraph","position":{"start":{"line":994,"column":1},"end":{"line":994,"column":1}},"children":[{"type":"text","value":"With the syntax ","position":{"start":{"line":994,"column":1},"end":{"line":994,"column":1}},"key":"nnTT5fkzAU"},{"type":"inlineCode","value":"A \\ b","position":{"start":{"line":994,"column":1},"end":{"line":994,"column":1}},"key":"KRwK4k7tQY"},{"type":"text","value":", the matrix ","position":{"start":{"line":994,"column":1},"end":{"line":994,"column":1}},"key":"u4K37yDWt5"},{"type":"inlineCode","value":"A","position":{"start":{"line":994,"column":1},"end":{"line":994,"column":1}},"key":"eG9Ddl7Dll"},{"type":"text","value":" is PLU-factored, followed by two triangular solves.","position":{"start":{"line":994,"column":1},"end":{"line":994,"column":1}},"key":"ZQBms8Wl0f"}],"key":"n7GY2EaTTU"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"A = randn(500, 500)   # 500x500 with normal random entries\nA \\ rand(500)          # force compilation\n@elapsed for k=1:50; A \\ rand(500); end","key":"g9Y2pOoJjb"},{"type":"output","id":"lw4vV1Qm3V70hoXdg6VDs","data":[{"output_type":"execute_result","execution_count":97,"metadata":{},"data":{"text/plain":{"content":"0.107924542","content_type":"text/plain"}}}],"key":"MEeyiBcb8Y"}],"data":{},"key":"yvq1nHI4Bt"},{"type":"paragraph","position":{"start":{"line":1002,"column":1},"end":{"line":1002,"column":1}},"children":[{"type":"text","value":"In ","position":{"start":{"line":1002,"column":1},"end":{"line":1002,"column":1}},"key":"L0Ds6rnvP7"},{"type":"link","kind":"numref","identifier":"section-linsys-efficiency","label":"section-linsys-efficiency","url":"/efficiency","internal":true,"dataUrl":"/efficiency.json","children":[{"type":"text","value":"Efficiency of matrix computations","key":"AVjljAgW15"}],"key":"tZsI2WMHWS"},{"type":"text","value":" we showed that the factorization is by far the most costly part of the solution process. A factorization object allows us to do that costly step only once per unique matrix.","position":{"start":{"line":1002,"column":1},"end":{"line":1002,"column":1}},"key":"JS6DskFKhT"}],"key":"nR4PAWjOjA"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"factored = lu(A)     # store factorization result\nfactored \\ rand(500)   # force compilation\n@elapsed for k=1:50; factored \\ rand(500); end","key":"cpRY1cBq58"},{"type":"output","id":"wZa1oAibRuTRT-Mu8a6H8","data":[{"output_type":"execute_result","execution_count":98,"metadata":{},"data":{"text/plain":{"content":"0.002937459","content_type":"text/plain"}}}],"key":"fUi40uZS9S"}],"data":{},"key":"Y1kiJ6jNwo"}],"key":"WA7SCjW3Bl"}],"key":"bXO0ymeqdJ"}],"key":"iuDyupNi46"},{"type":"tabItem","title":"MATLAB","sync":"matlab","children":[{"type":"embed","source":{"url":"/chapter2-1","label":"demo-pivoting-builtin-matlab","kind":"Notebook","slug":"chapter2-1","location":"/matlab/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-pivoting-builtin","label":"demo-pivoting-builtin","kind":"proof:example","position":{"start":{"line":939,"column":1},"end":{"line":939,"column":23}},"children":[{"type":"text","value":"Example ","key":"qyC8Ypw0Ih"},{"type":"text","value":"2.6.5","key":"E0PDCqoFqU"}],"template":"Example %s","enumerator":"2.6.5","resolved":true,"html_id":"demo-pivoting-builtin","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"WV8AjQJmr9"}],"key":"EMfCRXuT9q"},{"type":"paragraph","position":{"start":{"line":941,"column":1},"end":{"line":941,"column":1}},"children":[{"type":"text","value":"With the syntax ","position":{"start":{"line":941,"column":1},"end":{"line":941,"column":1}},"key":"JbtA2YtcWk"},{"type":"inlineCode","value":"A \\ b","position":{"start":{"line":941,"column":1},"end":{"line":941,"column":1}},"key":"IEjz9VlgyI"},{"type":"text","value":", the matrix ","position":{"start":{"line":941,"column":1},"end":{"line":941,"column":1}},"key":"sbxTrxS7wu"},{"type":"inlineCode","value":"A","position":{"start":{"line":941,"column":1},"end":{"line":941,"column":1}},"key":"VQAzVDgEIE"},{"type":"text","value":" is PLU-factored, followed by two triangular solves.","position":{"start":{"line":941,"column":1},"end":{"line":941,"column":1}},"key":"EmcuqlTmGD"}],"key":"VRYtdf8Nmk"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A = randn(500, 500);    % 500x500 with normal random entries\ntic; for k=1:50; A \\ rand(500, 1); end; toc","key":"cWC9ZAm5IJ"},{"type":"output","id":"LefmryMXZj3ZpyEXoUSFG","data":[{"output_type":"stream","name":"stdout","text":"Elapsed time is 1.071237 seconds.\n"}],"key":"gslBKgUl3P"}],"data":{},"key":"hqFRaNUIsZ"},{"type":"paragraph","position":{"start":{"line":948,"column":1},"end":{"line":948,"column":1}},"children":[{"type":"text","value":"In ","position":{"start":{"line":948,"column":1},"end":{"line":948,"column":1}},"key":"IRsLFkZzTE"},{"type":"link","kind":"numref","identifier":"section-linsys-efficiency","label":"section-linsys-efficiency","url":"/efficiency","internal":true,"dataUrl":"/efficiency.json","children":[{"type":"text","value":"Efficiency of matrix computations","key":"pFGfOGqO3v"}],"key":"cNblc0tVsU"},{"type":"text","value":" we showed that the factorization is by far the most costly part of the solution process. A factorization object allows us to do that costly step only once per unique matrix.","position":{"start":{"line":948,"column":1},"end":{"line":948,"column":1}},"key":"EoV9cHcUZH"}],"key":"m5TmQY7nHM"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[L, U, p] = lu(A, 'vector');    % keep factorization result\ntic\nfor k=1:50\n    b = rand(500, 1);\n    U \\ (L \\ b(p));\nend\ntoc","key":"Y17xMzehgp"},{"type":"output","id":"-TPPTFSn0IbMnZwtU1tQw","data":[{"output_type":"stream","name":"stdout","text":"Elapsed time is 0.010074 seconds.\n"}],"key":"hG6qOuFxo0"}],"data":{},"key":"rTYkMcKMYx"}],"key":"D1jBLdnc3F"}],"key":"Q7fI09AiAi"}],"key":"tplKKKzjPe"},{"type":"tabItem","title":"Python","sync":"python","children":[{"type":"embed","source":{"url":"/chapter2-2","label":"demo-pivoting-builtin-python","kind":"Notebook","slug":"chapter2-2","location":"/python/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-pivoting-builtin","label":"demo-pivoting-builtin","kind":"proof:example","position":{"start":{"line":929,"column":1},"end":{"line":929,"column":23}},"children":[{"type":"text","value":"Example ","key":"IJNr2yFNE3"},{"type":"text","value":"2.6.5","key":"AM45JDT0WZ"}],"template":"Example %s","enumerator":"2.6.5","resolved":true,"html_id":"demo-pivoting-builtin","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"jsUM3LqXPS"}],"key":"x2YwZK70eW"},{"type":"paragraph","position":{"start":{"line":931,"column":1},"end":{"line":931,"column":1}},"children":[{"type":"text","value":"In ","position":{"start":{"line":931,"column":1},"end":{"line":931,"column":1}},"key":"F5y5LkKGq1"},{"type":"inlineCode","value":"linalg.solve","position":{"start":{"line":931,"column":1},"end":{"line":931,"column":1}},"key":"jZok9sQJ3I"},{"type":"text","value":", the matrix ","position":{"start":{"line":931,"column":1},"end":{"line":931,"column":1}},"key":"UnpnzB1HWK"},{"type":"inlineCode","value":"A","position":{"start":{"line":931,"column":1},"end":{"line":931,"column":1}},"key":"anw6OYDIw5"},{"type":"text","value":" is PLU-factored, followed by two triangular solves. If we want to do those steps seamlessly, we can use the ","position":{"start":{"line":931,"column":1},"end":{"line":931,"column":1}},"key":"Z4FSahiyTI"},{"type":"inlineCode","value":"lu_factor","position":{"start":{"line":931,"column":1},"end":{"line":931,"column":1}},"key":"MaUoOGr44y"},{"type":"text","value":" and ","position":{"start":{"line":931,"column":1},"end":{"line":931,"column":1}},"key":"OZauL5Fgga"},{"type":"inlineCode","value":"lu_solve","position":{"start":{"line":931,"column":1},"end":{"line":931,"column":1}},"key":"ZUNCrJsju4"},{"type":"text","value":" from ","position":{"start":{"line":931,"column":1},"end":{"line":931,"column":1}},"key":"E6LWW93IhI"},{"type":"inlineCode","value":"scipy.linalg","position":{"start":{"line":931,"column":1},"end":{"line":931,"column":1}},"key":"bShykRYiae"},{"type":"text","value":".","position":{"start":{"line":931,"column":1},"end":{"line":931,"column":1}},"key":"NvEccTbPuO"}],"key":"pMiE9IO8Ky"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from scipy.linalg import lu_factor, lu_solve\nA = random.randn(500, 500) \nb = ones(500)  \nLU, perm = lu_factor(A)\nx = lu_solve((LU, perm), b)","key":"NCvsvfjQBE"},{"type":"output","id":"ErL3JgCd_qL3W7-gBR6cK","data":[],"key":"Vt9VWQnKop"}],"data":{},"key":"Jhv4p7tx9c"},{"type":"paragraph","position":{"start":{"line":941,"column":1},"end":{"line":941,"column":1}},"children":[{"type":"text","value":"Why would we ever bother with this? In ","position":{"start":{"line":941,"column":1},"end":{"line":941,"column":1}},"key":"zxQ5SDzauV"},{"type":"link","kind":"numref","identifier":"section-linsys-efficiency","label":"section-linsys-efficiency","url":"/efficiency","internal":true,"dataUrl":"/efficiency.json","children":[{"type":"text","value":"Efficiency of matrix computations","key":"VwS4CeE49y"}],"key":"iBjxWbO5ak"},{"type":"text","value":" we showed that the factorization is by far the most costly part of the solution process. A factorization object allows us to do that costly step only once per matrix, but solve with multiple right-hand sides.","position":{"start":{"line":941,"column":1},"end":{"line":941,"column":1}},"key":"LmZ5T6pWMh"}],"key":"Q95ux0WArW"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"start = timer()\nfor k in range(50): linalg.solve(A, random.rand(500))\nprint(f\"elapsed time for 50 full solves: {timer() - start}\")\n\nstart = timer()\nLU, perm = lu_factor(A)\nfor k in range(50): lu_solve((LU, perm), random.rand(500))\nprint(f\"elapsed time for 50 shortcut solves: {timer() - start}\")","key":"H3baUms24l"},{"type":"output","id":"TSIxRo0nHlQ0otOIBD4DA","data":[{"output_type":"stream","name":"stdout","text":"elapsed time for 50 full solves: 0.11021366692148149\nelapsed time for 50 shortcut solves: 0.010174958035349846\n"}],"key":"dJPb3xPoGX"}],"data":{},"key":"MalCzkSHhO"}],"key":"C7H3kFwGcy"}],"key":"eTtQZ0HOoe"}],"key":"a3fM5l3x8t"}],"key":"LrXZOJ80Lf"}],"label":"demo-pivoting-builtin","identifier":"demo-pivoting-builtin","html_id":"demo-pivoting-builtin","enumerator":"2.6.5","key":"mpowxrRMjU"},{"type":"heading","depth":2,"position":{"start":{"line":205,"column":1},"end":{"line":205,"column":1}},"children":[{"type":"text","value":"Stability","position":{"start":{"line":205,"column":1},"end":{"line":205,"column":1}},"key":"Y3u9HsG7K4"}],"identifier":"stability","label":"Stability","html_id":"stability","implicit":true,"enumerator":"2.6.4","key":"bKrEelVo1P"},{"type":"paragraph","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"children":[{"type":"text","value":"There is one detail of the row pivoting algorithm that might seem arbitrary: why choose the pivot of largest magnitude in a column, rather than, say, the uppermost nonzero in the column? The answer is numerical stability.","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"key":"uzYM9G7WSp"}],"indexEntries":[{"entry":"stability","emphasis":false}],"label":"index-TzcTtkGJGS","identifier":"index-tzcttkgjgs","html_id":"index-tzcttkgjgs","key":"N4kHOi8c5F"},{"type":"proof","kind":"example","enumerated":true,"children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Stability of PLU factorization","position":{"start":{"line":213,"column":1},"end":{"line":213,"column":1}},"key":"aAR5y89pgy"}],"key":"IVT6JchecB"},{"type":"paragraph","position":{"start":{"line":214,"column":1},"end":{"line":214,"column":1}},"children":[{"type":"text","value":"Let","position":{"start":{"line":214,"column":1},"end":{"line":214,"column":1}},"key":"thgEhrjQCU"}],"key":"mlC5GILtXb"},{"type":"math","value":"\\mathbf{A} =\n  \\begin{bmatrix}\n    -\\epsilon & 1 \\\\ 1 & -1\n  \\end{bmatrix}.","label":"plu-stab-A","identifier":"plu-stab-a","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi mathvariant=\"bold\">A</mi><mo>=</mo><mrow><mo fence=\"true\">[</mo><mtable rowspacing=\"0.16em\" columnalign=\"center center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mi>ϵ</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mn>1</mn></mrow></mstyle></mtd></mtr></mtable><mo fence=\"true\">]</mo></mrow><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A} =\n  \\begin{bmatrix}\n    -\\epsilon &amp; 1 \\\\ 1 &amp; -1\n  \\end{bmatrix}.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.4em;vertical-align:-0.95em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">[</span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord mathnormal\">ϵ</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.95em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.95em;\"><span></span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">]</span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">.</span></span></span></span></span>","enumerator":"2.6.2","html_id":"plu-stab-a","key":"qR1LqlDsj5"},{"type":"paragraph","position":{"start":{"line":224,"column":1},"end":{"line":224,"column":1}},"children":[{"type":"text","value":"If ","position":{"start":{"line":224,"column":1},"end":{"line":224,"column":1}},"key":"L4EMixlbXo"},{"type":"inlineMath","value":"\\epsilon=0","position":{"start":{"line":224,"column":1},"end":{"line":224,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ϵ</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">\\epsilon=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">ϵ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"TaB8oooTZu"},{"type":"text","value":", LU factorization without pivoting fails for ","position":{"start":{"line":224,"column":1},"end":{"line":224,"column":1}},"key":"skNJdGEju6"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":224,"column":1},"end":{"line":224,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"DbW43kzoEl"},{"type":"text","value":". But if ","position":{"start":{"line":224,"column":1},"end":{"line":224,"column":1}},"key":"DXpQ8yZvrW"},{"type":"inlineMath","value":"\\epsilon\\neq 0","position":{"start":{"line":224,"column":1},"end":{"line":224,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ϵ</mi><mo mathvariant=\"normal\">≠</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">\\epsilon\\neq 0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">ϵ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\"><span class=\"mrel\"><span class=\"mord vbox\"><span class=\"thinbox\"><span class=\"rlap\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"inner\"><span class=\"mord\"><span class=\"mrel\"></span></span></span><span class=\"fix\"></span></span></span></span></span><span class=\"mrel\">=</span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"nLbt42ICWZ"},{"type":"text","value":", we can go without pivoting, at least in principle.","position":{"start":{"line":224,"column":1},"end":{"line":224,"column":1}},"key":"rWXWBk0xbA"}],"key":"l27HoVtufI"},{"type":"tabSet","children":[{"type":"tabItem","title":"Julia","sync":"julia","children":[{"type":"embed","source":{"url":"/chapter2","label":"demo-pivoting-stable-julia","kind":"Notebook","slug":"chapter2","location":"/julia/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-pivoting-stable","label":"demo-pivoting-stable","kind":"proof:example","position":{"start":{"line":1012,"column":1},"end":{"line":1012,"column":22}},"children":[{"type":"text","value":"Example ","key":"Z7ZehJV1Up"},{"type":"text","value":"2.6.6","key":"mJFFtGOq0u"}],"template":"Example %s","enumerator":"2.6.6","resolved":true,"html_id":"demo-pivoting-stable","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"r1Fsi90nxe"}],"key":"HTQFdeWv0w"},{"type":"paragraph","position":{"start":{"line":1014,"column":1},"end":{"line":1014,"column":1}},"children":[{"type":"text","value":"We construct a linear system for this matrix with ","position":{"start":{"line":1014,"column":1},"end":{"line":1014,"column":1}},"key":"fWBQyvQh8p"},{"type":"inlineMath","value":"\\epsilon=10^{-12}","position":{"start":{"line":1014,"column":1},"end":{"line":1014,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ϵ</mi><mo>=</mo><mn>1</mn><msup><mn>0</mn><mrow><mo>−</mo><mn>12</mn></mrow></msup></mrow><annotation encoding=\"application/x-tex\">\\epsilon=10^{-12}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">ϵ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">12</span></span></span></span></span></span></span></span></span></span></span></span>","key":"Wke02eM37q"},{"type":"text","value":" and exact solution ","position":{"start":{"line":1014,"column":1},"end":{"line":1014,"column":1}},"key":"LTL5yjKR0y"},{"type":"inlineMath","value":"[1,1]","position":{"start":{"line":1014,"column":1},"end":{"line":1014,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[1,1]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]</span></span></span></span>","key":"mpos6nf9Sv"},{"type":"text","value":":","position":{"start":{"line":1014,"column":1},"end":{"line":1014,"column":1}},"key":"GgbYXr6KIH"}],"key":"ZBgo7Adv2v"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"ϵ = 1e-12\nA = [-ϵ 1; 1 -1]\nb = A * [1, 1]","key":"SZQG2vpX3p"},{"type":"output","id":"D8XifK_c1XNI_yb9YU8SI","data":[{"output_type":"execute_result","execution_count":99,"metadata":{},"data":{"text/plain":{"content":"2-element Vector{Float64}:\n 0.999999999999\n 0.0","content_type":"text/plain"}}}],"key":"NrihHwoaow"}],"data":{},"key":"qSHdPGhplg"},{"type":"paragraph","position":{"start":{"line":1022,"column":1},"end":{"line":1022,"column":1}},"children":[{"type":"text","value":"We can factor the matrix without pivoting and solve for ","position":{"start":{"line":1022,"column":1},"end":{"line":1022,"column":1}},"key":"uP0WUAEViT"},{"type":"inlineMath","value":"\\mathbf{x}","position":{"start":{"line":1022,"column":1},"end":{"line":1022,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">x</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{x}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4444em;\"></span><span class=\"mord mathbf\">x</span></span></span></span>","key":"Uf71MBUwJe"},{"type":"text","value":".","position":{"start":{"line":1022,"column":1},"end":{"line":1022,"column":1}},"key":"AR71n1m5Mg"}],"key":"mwfXhGXJZS"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"L, U = FNC.lufact(A)\nx = FNC.backsub( U, FNC.forwardsub(L, b) )","key":"ZmBuMpkior"},{"type":"output","id":"nEMkf-dczMeRQxMFDuQa1","data":[{"output_type":"execute_result","execution_count":100,"metadata":{},"data":{"text/plain":{"content":"2-element Vector{Float64}:\n 0.9999778782798785\n 1.0","content_type":"text/plain"}}}],"key":"p7ZbIXgNFj"}],"data":{},"key":"BL0zYoG2zC"},{"type":"paragraph","position":{"start":{"line":1029,"column":1},"end":{"line":1029,"column":1}},"children":[{"type":"text","value":"Note that we have obtained only about 5 accurate digits for ","position":{"start":{"line":1029,"column":1},"end":{"line":1029,"column":1}},"key":"TmijimPzvd"},{"type":"inlineMath","value":"x_1","position":{"start":{"line":1029,"column":1},"end":{"line":1029,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">x_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"dFN6PDHVEq"},{"type":"text","value":". We could make the result even more inaccurate by making ","position":{"start":{"line":1029,"column":1},"end":{"line":1029,"column":1}},"key":"thUuBRb8Sb"},{"type":"text","value":"ε","position":{"start":{"line":1029,"column":1},"end":{"line":1029,"column":1}},"key":"sbvkvZa9OP"},{"type":"text","value":" even smaller:","position":{"start":{"line":1029,"column":1},"end":{"line":1029,"column":1}},"key":"G4YhYtB6Ac"}],"key":"qWUp2HgyRH"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"ϵ = 1e-20; A = [-ϵ 1; 1 -1]\nb = A * [1, 1]\nL, U = FNC.lufact(A)\nx = FNC.backsub( U, FNC.forwardsub(L, b) )","key":"HM4KUVbbw5"},{"type":"output","id":"zBIhBAl3N6GkxUfpyyLFR","data":[{"output_type":"execute_result","execution_count":101,"metadata":{},"data":{"text/plain":{"content":"2-element Vector{Float64}:\n -0.0\n  1.0","content_type":"text/plain"}}}],"key":"HTcBfXAiBA"}],"data":{},"key":"a5kwoWw7zB"},{"type":"paragraph","position":{"start":{"line":1038,"column":1},"end":{"line":1038,"column":1}},"children":[{"type":"text","value":"This effect is not due to ill conditioning of the problem—a solution with PLU factorization works perfectly:","position":{"start":{"line":1038,"column":1},"end":{"line":1038,"column":1}},"key":"KJGm5ooGck"}],"key":"ZA0X5QnFKa"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"A \\ b","key":"YbshXNEeE5"},{"type":"output","id":"a9UC-qXcQjqhnixM2Fakl","data":[{"output_type":"execute_result","execution_count":102,"metadata":{},"data":{"text/plain":{"content":"2-element Vector{Float64}:\n 1.0\n 1.0","content_type":"text/plain"}}}],"key":"e5FMQTnWBA"}],"data":{},"key":"tTngkcZjjk"}],"key":"biGJIUWIHH"}],"key":"dOZSs7GP13"}],"key":"ZrLEP7ytXm"},{"type":"tabItem","title":"MATLAB","sync":"matlab","children":[{"type":"embed","source":{"url":"/chapter2-1","label":"demo-pivoting-stable-matlab","kind":"Notebook","slug":"chapter2-1","location":"/matlab/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-pivoting-stable","label":"demo-pivoting-stable","kind":"proof:example","position":{"start":{"line":962,"column":1},"end":{"line":962,"column":22}},"children":[{"type":"text","value":"Example ","key":"aJSvidtZ9E"},{"type":"text","value":"2.6.6","key":"fe346nJmAO"}],"template":"Example %s","enumerator":"2.6.6","resolved":true,"html_id":"demo-pivoting-stable","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"RRk5UWl4yY"}],"key":"IHo6qvfdfv"},{"type":"paragraph","position":{"start":{"line":964,"column":1},"end":{"line":964,"column":1}},"children":[{"type":"text","value":"We construct a linear system for this matrix with ","position":{"start":{"line":964,"column":1},"end":{"line":964,"column":1}},"key":"FRyM7Cz351"},{"type":"inlineMath","value":"\\epsilon=10^{-12}","position":{"start":{"line":964,"column":1},"end":{"line":964,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ϵ</mi><mo>=</mo><mn>1</mn><msup><mn>0</mn><mrow><mo>−</mo><mn>12</mn></mrow></msup></mrow><annotation encoding=\"application/x-tex\">\\epsilon=10^{-12}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">ϵ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">12</span></span></span></span></span></span></span></span></span></span></span></span>","key":"nwNeTXyCrP"},{"type":"text","value":" and exact solution ","position":{"start":{"line":964,"column":1},"end":{"line":964,"column":1}},"key":"lihWKz7pOZ"},{"type":"inlineMath","value":"[1, 1]","position":{"start":{"line":964,"column":1},"end":{"line":964,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[1, 1]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]</span></span></span></span>","key":"vb5B4KRSRw"},{"type":"text","value":":","position":{"start":{"line":964,"column":1},"end":{"line":964,"column":1}},"key":"WTWpF4maot"}],"key":"YFJ5vP4eRq"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"ep = 1e-12\nA = [-ep 1; 1 -1];\nb = A * [1; 1];","key":"iATcGTOWzx"},{"type":"output","id":"Hv6MXBMPXSjWDqhtMH-Ws","data":[{"output_type":"execute_result","execution_count":97,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ep = \n   1.0000e-12\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ep = \n   1.0000e-12\n","content_type":"text/plain"}}}],"key":"AVHzb92Zma"}],"data":{},"key":"XRnkqdIMP1"},{"type":"paragraph","position":{"start":{"line":972,"column":1},"end":{"line":972,"column":1}},"children":[{"type":"text","value":"We can factor the matrix without pivoting and solve for ","position":{"start":{"line":972,"column":1},"end":{"line":972,"column":1}},"key":"MqgofVKIFg"},{"type":"inlineMath","value":"\\mathbf{x}","position":{"start":{"line":972,"column":1},"end":{"line":972,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">x</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{x}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4444em;\"></span><span class=\"mord mathbf\">x</span></span></span></span>","key":"c4gZF02PC2"},{"type":"text","value":".","position":{"start":{"line":972,"column":1},"end":{"line":972,"column":1}},"key":"FhsCx9XoFz"}],"key":"qyjm1akyvM"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[L, U] = lufact(A);\nx = backsub( U, forwardsub(L, b) )","key":"lHgzeKBv2i"},{"type":"output","id":"fZpsh7gGKEbQNm6xhLzIG","data":[{"output_type":"execute_result","execution_count":98,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>x = 2×1 double\n   9.9998e-01\n   1.0000e+00\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"x = 2×1 double\n   9.9998e-01\n   1.0000e+00\n","content_type":"text/plain"}}}],"key":"XCEmJFgyH6"}],"data":{},"key":"xXBCrjiHhl"},{"type":"paragraph","position":{"start":{"line":979,"column":1},"end":{"line":979,"column":1}},"children":[{"type":"text","value":"Note that we have obtained only about 5 accurate digits for ","position":{"start":{"line":979,"column":1},"end":{"line":979,"column":1}},"key":"RkPmAcBSpY"},{"type":"inlineMath","value":"x_1","position":{"start":{"line":979,"column":1},"end":{"line":979,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">x_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"tLSWEE5JrZ"},{"type":"text","value":". We could make the result even more inaccurate by making ","position":{"start":{"line":979,"column":1},"end":{"line":979,"column":1}},"key":"Z9bAqsEKu6"},{"type":"text","value":"ε","position":{"start":{"line":979,"column":1},"end":{"line":979,"column":1}},"key":"APJx1YOOoy"},{"type":"text","value":" even smaller:","position":{"start":{"line":979,"column":1},"end":{"line":979,"column":1}},"key":"UTsNQu3k1g"}],"key":"DIhT2iR1dw"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"ep = 1e-20; A = [-ep 1; 1 -1];\nb = A * [1; 1];\n[L, U] = lufact(A);\nx = backsub( U, forwardsub(L, b) )","key":"K8ehbTHSGl"},{"type":"output","id":"44AOI0t8bLo2d3kRppkYN","data":[{"output_type":"execute_result","execution_count":99,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>x = 2×1 double\n     0\n     1\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"x = 2×1 double\n     0\n     1\n","content_type":"text/plain"}}}],"key":"ZH6Crek0nE"}],"data":{},"key":"iTxsoX7iu1"},{"type":"paragraph","position":{"start":{"line":988,"column":1},"end":{"line":988,"column":1}},"children":[{"type":"text","value":"This effect is not due to ill conditioning of the problem—a solution with PLU factorization works perfectly:","position":{"start":{"line":988,"column":1},"end":{"line":988,"column":1}},"key":"DLjOgCj0mF"}],"key":"X4KqJX2nPD"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A \\ b","key":"l4z1MRvBGx"},{"type":"output","id":"5YqcG8Vh9lv5wCuIPAo4z","data":[{"output_type":"execute_result","execution_count":100,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = 2×1 double\n     1\n     1\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = 2×1 double\n     1\n     1\n","content_type":"text/plain"}}}],"key":"NBiQ7KTpiI"}],"data":{},"key":"cinqlGDayf"}],"key":"SUTOIjW7ZE"}],"key":"KmNMmOoEiW"}],"key":"aw1yDQQnFP"},{"type":"tabItem","title":"Python","sync":"python","children":[{"type":"embed","source":{"url":"/chapter2-2","label":"demo-pivoting-stable-python","kind":"Notebook","slug":"chapter2-2","location":"/python/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-pivoting-stable","label":"demo-pivoting-stable","kind":"proof:example","position":{"start":{"line":956,"column":1},"end":{"line":956,"column":22}},"children":[{"type":"text","value":"Example ","key":"aaSDPnJNmf"},{"type":"text","value":"2.6.6","key":"DI7l96WQEE"}],"template":"Example %s","enumerator":"2.6.6","resolved":true,"html_id":"demo-pivoting-stable","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"u2vE4F1PRf"}],"key":"dkh80QAUbn"},{"type":"paragraph","position":{"start":{"line":958,"column":1},"end":{"line":958,"column":1}},"children":[{"type":"text","value":"We construct a linear system for this matrix with ","position":{"start":{"line":958,"column":1},"end":{"line":958,"column":1}},"key":"wNfX8s9env"},{"type":"inlineMath","value":"\\epsilon=10^{-12}","position":{"start":{"line":958,"column":1},"end":{"line":958,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ϵ</mi><mo>=</mo><mn>1</mn><msup><mn>0</mn><mrow><mo>−</mo><mn>12</mn></mrow></msup></mrow><annotation encoding=\"application/x-tex\">\\epsilon=10^{-12}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">ϵ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">12</span></span></span></span></span></span></span></span></span></span></span></span>","key":"cBb6ufdCer"},{"type":"text","value":" and exact solution ","position":{"start":{"line":958,"column":1},"end":{"line":958,"column":1}},"key":"L3w9isrSkV"},{"type":"inlineMath","value":"[1,1]","position":{"start":{"line":958,"column":1},"end":{"line":958,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[1,1]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]</span></span></span></span>","key":"d4yqWx7QrY"},{"type":"text","value":":","position":{"start":{"line":958,"column":1},"end":{"line":958,"column":1}},"key":"hekAp2FJDU"}],"key":"J2n9q2eP9V"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ep = 1e-12\nA = array([[-ep, 1], [1, -1]])\nb = A @ array([1, 1])","key":"swAkFsfKnE"},{"type":"output","id":"Tkx5d-mSc9OCohd_PnhSp","data":[],"key":"WXHRXNkfPa"}],"data":{},"key":"RPUq1RmvOZ"},{"type":"paragraph","position":{"start":{"line":966,"column":1},"end":{"line":966,"column":1}},"children":[{"type":"text","value":"We can factor the matrix without pivoting and solve for ","position":{"start":{"line":966,"column":1},"end":{"line":966,"column":1}},"key":"DKXUJ55iFv"},{"type":"inlineMath","value":"\\mathbf{x}","position":{"start":{"line":966,"column":1},"end":{"line":966,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">x</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{x}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4444em;\"></span><span class=\"mord mathbf\">x</span></span></span></span>","key":"YW0fAI275b"},{"type":"text","value":".","position":{"start":{"line":966,"column":1},"end":{"line":966,"column":1}},"key":"CwXwxI40sT"}],"key":"hkNQ3zmVUK"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"L, U = FNC.lufact(A)\nprint(FNC.backsub( U, FNC.forwardsub(L, b) ))","key":"wvvdETyv5S"},{"type":"output","id":"nBSkWYtzzybPor8BRiTOJ","data":[{"output_type":"stream","name":"stdout","text":"[0.99997788 1.        ]\n"}],"key":"uoAGrKfx7d"}],"data":{},"key":"G3qCQUITGB"},{"type":"paragraph","position":{"start":{"line":973,"column":1},"end":{"line":973,"column":1}},"children":[{"type":"text","value":"Note that we have obtained only about 5 accurate digits for ","position":{"start":{"line":973,"column":1},"end":{"line":973,"column":1}},"key":"Y8JER4IZHz"},{"type":"inlineMath","value":"x_1","position":{"start":{"line":973,"column":1},"end":{"line":973,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">x_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"lG1zlvoVlg"},{"type":"text","value":". We could make the result even more inaccurate by making ","position":{"start":{"line":973,"column":1},"end":{"line":973,"column":1}},"key":"WotKDI0D7G"},{"type":"text","value":"ε","position":{"start":{"line":973,"column":1},"end":{"line":973,"column":1}},"key":"kkGMz7oQaw"},{"type":"text","value":" even smaller:","position":{"start":{"line":973,"column":1},"end":{"line":973,"column":1}},"key":"zlpcjjkLtK"}],"key":"IToG03qzSz"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ep = 1e-20;\nA = array([[-ep, 1], [1, -1]])\nb = A @ array([1, 1])\nL, U = FNC.lufact(A)\nprint(FNC.backsub( U, FNC.forwardsub(L, b) ))","key":"eMKWR4fsK9"},{"type":"output","id":"i794cC1QIXvbEqNJkDGeF","data":[{"output_type":"stream","name":"stdout","text":"[-0.  1.]\n"}],"key":"bz0OyeYwET"}],"data":{},"key":"Y6ynTav93T"},{"type":"paragraph","position":{"start":{"line":983,"column":1},"end":{"line":983,"column":1}},"children":[{"type":"text","value":"This effect is not due to ill conditioning of the problem—a solution with PLU factorization works perfectly:","position":{"start":{"line":983,"column":1},"end":{"line":983,"column":1}},"key":"rXbI0nIRpu"}],"key":"ANSGmEv4mV"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(linalg.solve(A, b))","key":"hvD9JCVZCL"},{"type":"output","id":"DEF8uGbIzUl56S1bQqqGq","data":[{"output_type":"stream","name":"stdout","text":"[1. 1.]\n"}],"key":"jtlXgutTiN"}],"data":{},"key":"OUfqbnUigq"}],"key":"L0o4NpgSbN"}],"key":"GIjtvTsadc"}],"key":"pDQSYaaiLb"}],"key":"AGxBFyugXw"}],"label":"demo-pivoting-stable","identifier":"demo-pivoting-stable","html_id":"demo-pivoting-stable","enumerator":"2.6.6","key":"RUMrNlxCCu"},{"type":"paragraph","position":{"start":{"line":247,"column":1},"end":{"line":247,"column":1}},"children":[{"type":"text","value":"The factors of this ","position":{"start":{"line":247,"column":1},"end":{"line":247,"column":1}},"key":"me1wi3gXmx"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":247,"column":1},"end":{"line":247,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"UKLAmOefnT"},{"type":"text","value":" without pivoting are found to be","position":{"start":{"line":247,"column":1},"end":{"line":247,"column":1}},"key":"p6aQ9NoyLZ"}],"key":"sc3RmWVOiM"},{"type":"math","value":"  \\mathbf{L} = \n  \\begin{bmatrix}\n    1 & 0 \\\\ -\\epsilon^{-1} & 1 \n  \\end{bmatrix}, \\qquad \n  \\mathbf{U} = \n  \\begin{bmatrix}\n    -\\epsilon & 1 \\\\ 0 & \\epsilon^{-1}-1 \n  \\end{bmatrix}.","label":"plu-stab-LU","identifier":"plu-stab-lu","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi mathvariant=\"bold\">L</mi><mo>=</mo><mrow><mo fence=\"true\">[</mo><mtable rowspacing=\"0.16em\" columnalign=\"center center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>0</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><msup><mi>ϵ</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd></mtr></mtable><mo fence=\"true\">]</mo></mrow><mo separator=\"true\">,</mo><mspace width=\"2em\"/><mi mathvariant=\"bold\">U</mi><mo>=</mo><mrow><mo fence=\"true\">[</mo><mtable rowspacing=\"0.16em\" columnalign=\"center center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mi>ϵ</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><msup><mi>ϵ</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo>−</mo><mn>1</mn></mrow></mstyle></mtd></mtr></mtable><mo fence=\"true\">]</mo></mrow><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">  \\mathbf{L} = \n  \\begin{bmatrix}\n    1 &amp; 0 \\\\ -\\epsilon^{-1} &amp; 1 \n  \\end{bmatrix}, \\qquad \n  \\mathbf{U} = \n  \\begin{bmatrix}\n    -\\epsilon &amp; 1 \\\\ 0 &amp; \\epsilon^{-1}-1 \n  \\end{bmatrix}.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">L</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.4em;vertical-align:-0.95em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">[</span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord\"><span class=\"mord mathnormal\">ϵ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.95em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">0</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.95em;\"><span></span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">]</span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:2em;\"></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathbf\">U</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.4em;vertical-align:-0.95em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">[</span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord mathnormal\">ϵ</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.95em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">ϵ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.95em;\"><span></span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">]</span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">.</span></span></span></span></span>","enumerator":"2.6.3","html_id":"plu-stab-lu","key":"ee11W2bn8Q"},{"type":"paragraph","position":{"start":{"line":261,"column":1},"end":{"line":261,"column":1}},"children":[{"type":"text","value":"For reasons we will quantify in ","position":{"start":{"line":261,"column":1},"end":{"line":261,"column":1}},"key":"ag9nUyk7dP"},{"type":"link","kind":"numref","identifier":"section-linsys-condition-number","label":"section-linsys-condition-number","url":"/condition-number","internal":true,"dataUrl":"/condition-number.json","children":[{"type":"text","value":"Conditioning of linear systems","key":"dTfPLDQxxx"}],"key":"DeWrudgcg8"},{"type":"text","value":", the solution of ","position":{"start":{"line":261,"column":1},"end":{"line":261,"column":1}},"key":"HfsM9pfvNj"},{"type":"inlineMath","value":"\\mathbf{A}\\mathbf{x}=\\mathbf{b}","position":{"start":{"line":261,"column":1},"end":{"line":261,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi><mi mathvariant=\"bold\">x</mi><mo>=</mo><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}\\mathbf{x}=\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">Ax</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"U1TTYpg3Du"},{"type":"text","value":" is well-conditioned, but the problems of solving ","position":{"start":{"line":261,"column":1},"end":{"line":261,"column":1}},"key":"NpkuU8hhib"},{"type":"inlineMath","value":"\\mathbf{L}\\mathbf{z}=\\mathbf{b}","position":{"start":{"line":261,"column":1},"end":{"line":261,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi><mi mathvariant=\"bold\">z</mi><mo>=</mo><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}\\mathbf{z}=\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">Lz</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"JlbDNtuE3M"},{"type":"text","value":" and ","position":{"start":{"line":261,"column":1},"end":{"line":261,"column":1}},"key":"ctARod8Xfm"},{"type":"inlineMath","value":"\\mathbf{U}\\mathbf{x}=\\mathbf{z}","position":{"start":{"line":261,"column":1},"end":{"line":261,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi><mi mathvariant=\"bold\">x</mi><mo>=</mo><mi mathvariant=\"bold\">z</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}\\mathbf{x}=\\mathbf{z}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">Ux</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4444em;\"></span><span class=\"mord mathbf\">z</span></span></span></span>","key":"aAZrqDcAf7"},{"type":"text","value":" have condition numbers essentially ","position":{"start":{"line":261,"column":1},"end":{"line":261,"column":1}},"key":"qG5kLHe1Me"},{"type":"inlineMath","value":"1/\\epsilon^2","position":{"start":{"line":261,"column":1},"end":{"line":261,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mi mathvariant=\"normal\">/</mi><msup><mi>ϵ</mi><mn>2</mn></msup></mrow><annotation encoding=\"application/x-tex\">1/\\epsilon^2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord\">1/</span><span class=\"mord\"><span class=\"mord mathnormal\">ϵ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span>","key":"VQyZ4yrbZF"},{"type":"text","value":" each. Thus, for small ","position":{"start":{"line":261,"column":1},"end":{"line":261,"column":1}},"key":"Vcoc4pGxMU"},{"type":"text","value":"ε","position":{"start":{"line":261,"column":1},"end":{"line":261,"column":1}},"key":"Y8Mna31cDD"},{"type":"text","value":", solution of the original linear system by unpivoted LU factorization is highly unstable.","position":{"start":{"line":261,"column":1},"end":{"line":261,"column":1}},"key":"O8bVBZKx3h"}],"key":"nfG6qwGUY1"},{"type":"paragraph","position":{"start":{"line":263,"column":1},"end":{"line":263,"column":1}},"children":[{"type":"text","value":"Somewhat surprisingly, solving ","position":{"start":{"line":263,"column":1},"end":{"line":263,"column":1}},"key":"h2QDy5Geig"},{"type":"inlineMath","value":"\\mathbf{A}\\mathbf{x}=\\mathbf{b}","position":{"start":{"line":263,"column":1},"end":{"line":263,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi><mi mathvariant=\"bold\">x</mi><mo>=</mo><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}\\mathbf{x}=\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">Ax</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"gKPvVG022A"},{"type":"text","value":" via PLU factorization is technically also unstable. In fact, examples of unstable solutions are well-known, but they have been nonexistent in practice. While there is a lot of evidence and some reasoning about why this is the case, the situation is not completely understood. Yet PLU factorization remains the algorithm of choice for general linear systems.","position":{"start":{"line":263,"column":1},"end":{"line":263,"column":1}},"key":"Nids267Zih"}],"key":"o8smWQ3kmj"},{"type":"heading","depth":2,"position":{"start":{"line":265,"column":1},"end":{"line":265,"column":1}},"children":[{"type":"text","value":"Exercises","position":{"start":{"line":265,"column":1},"end":{"line":265,"column":1}},"key":"orkCTl9BbN"}],"identifier":"exercises","label":"Exercises","html_id":"exercises","implicit":true,"enumerator":"2.6.5","key":"ZUYYQ4mquj"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":267,"column":1},"end":{"line":303,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":267,"column":1},"end":{"line":280,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":267,"column":1},"end":{"line":267,"column":1}},"children":[{"type":"text","value":"✍ Perform by hand the pivoted LU factorization of each matrix.","position":{"start":{"line":267,"column":1},"end":{"line":267,"column":1}},"key":"s0kcAEkfaR"}],"key":"RNqhN5iCXF"},{"type":"paragraph","position":{"start":{"line":269,"column":1},"end":{"line":279,"column":1}},"children":[{"type":"strong","position":{"start":{"line":269,"column":1},"end":{"line":269,"column":1}},"children":[{"type":"text","value":"(a)","position":{"start":{"line":269,"column":1},"end":{"line":269,"column":1}},"key":"m1A0aAXkJy"}],"key":"DKJiqkWrKu"},{"type":"text","value":" ","position":{"start":{"line":269,"column":1},"end":{"line":269,"column":1}},"key":"aTpcnJsFKR"},{"type":"inlineMath","value":"\\quad \\displaystyle \\begin{bmatrix}\n 2 & 3 & 4 \\\\\n 4 & 5 & 10 \\\\\n 4 & 8 & 2\n \\end{bmatrix},\\qquad","position":{"start":{"line":269,"column":1},"end":{"line":269,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mspace width=\"1em\"/><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mo fence=\"true\">[</mo><mtable rowspacing=\"0.16em\" columnalign=\"center center center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>2</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>3</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>4</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>4</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>5</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>10</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>4</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>8</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>2</mn></mstyle></mtd></mtr></mtable><mo fence=\"true\">]</mo></mrow><mo separator=\"true\">,</mo><mspace width=\"2em\"/></mstyle></mrow><annotation encoding=\"application/x-tex\">\\quad \\displaystyle \\begin{bmatrix}\n 2 &amp; 3 &amp; 4 \\\\\n 4 &amp; 5 &amp; 10 \\\\\n 4 &amp; 8 &amp; 2\n \\end{bmatrix},\\qquad</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:3.6em;vertical-align:-1.55em;\"></span><span class=\"mspace\" style=\"margin-right:1em;\"></span><span class=\"minner\"><span class=\"mopen\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.05em;\"><span style=\"top:-2.25em;\"><span class=\"pstrut\" style=\"height:3.155em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎣</span></span></span><span style=\"top:-3.397em;\"><span class=\"pstrut\" style=\"height:3.155em;\"></span><span style=\"height:0.016em;width:0.6667em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.6667em' height='0.016em' style='width:0.6667em' viewBox='0 0 666.67 16' preserveAspectRatio='xMinYMin'><path d='M319 0 H403 V16 H319z M319 0 H403 V16 H319z'/></svg></span></span><span style=\"top:-4.05em;\"><span class=\"pstrut\" style=\"height:3.155em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎡</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.55em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.05em;\"><span style=\"top:-4.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">2</span></span></span><span style=\"top:-3.01em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">4</span></span></span><span style=\"top:-1.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">4</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.55em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.05em;\"><span style=\"top:-4.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">3</span></span></span><span style=\"top:-3.01em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">5</span></span></span><span style=\"top:-1.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">8</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.55em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.05em;\"><span style=\"top:-4.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">4</span></span></span><span style=\"top:-3.01em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">10</span></span></span><span style=\"top:-1.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.55em;\"><span></span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.05em;\"><span style=\"top:-2.25em;\"><span class=\"pstrut\" style=\"height:3.155em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎦</span></span></span><span style=\"top:-3.397em;\"><span class=\"pstrut\" style=\"height:3.155em;\"></span><span style=\"height:0.016em;width:0.6667em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.6667em' height='0.016em' style='width:0.6667em' viewBox='0 0 666.67 16' preserveAspectRatio='xMinYMin'><path d='M263 0 H347 V16 H263z M263 0 H347 V16 H263z'/></svg></span></span><span style=\"top:-4.05em;\"><span class=\"pstrut\" style=\"height:3.155em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎤</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.55em;\"><span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:2em;\"></span></span></span></span>","key":"amRy8C7UG9"},{"type":"text","value":"\n","position":{"start":{"line":269,"column":1},"end":{"line":269,"column":1}},"key":"DjHLVobKYe"},{"type":"strong","position":{"start":{"line":269,"column":1},"end":{"line":269,"column":1}},"children":[{"type":"text","value":"(b)","position":{"start":{"line":269,"column":1},"end":{"line":269,"column":1}},"key":"qnQu1mbMyQ"}],"key":"BEM6vMBDC3"},{"type":"text","value":" ","position":{"start":{"line":269,"column":1},"end":{"line":269,"column":1}},"key":"JYoj12PQ8P"},{"type":"inlineMath","value":"\\quad \\displaystyle \\begin{bmatrix}\n 1 & 4 & 5 & -5 \\\\\n -1 & 0 & -1 & -5 \\\\\n 1 & 3 & -1 & 2 \\\\\n 1 & -1 & 5 & -1 \n \\end{bmatrix}","position":{"start":{"line":269,"column":1},"end":{"line":269,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mspace width=\"1em\"/><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mo fence=\"true\">[</mo><mtable rowspacing=\"0.16em\" columnalign=\"center center center center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>4</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>5</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mn>5</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mn>1</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mn>1</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mn>5</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>3</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mn>1</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>2</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mn>1</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>5</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mn>1</mn></mrow></mstyle></mtd></mtr></mtable><mo fence=\"true\">]</mo></mrow></mstyle></mrow><annotation encoding=\"application/x-tex\">\\quad \\displaystyle \\begin{bmatrix}\n 1 &amp; 4 &amp; 5 &amp; -5 \\\\\n -1 &amp; 0 &amp; -1 &amp; -5 \\\\\n 1 &amp; 3 &amp; -1 &amp; 2 \\\\\n 1 &amp; -1 &amp; 5 &amp; -1 \n \\end{bmatrix}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:4.8001em;vertical-align:-2.15em;\"></span><span class=\"mspace\" style=\"margin-right:1em;\"></span><span class=\"minner\"><span class=\"mopen\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.65em;\"><span style=\"top:-1.711em;\"><span class=\"pstrut\" style=\"height:3.216em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎣</span></span></span><span style=\"top:-2.858em;\"><span class=\"pstrut\" style=\"height:3.216em;\"></span><span style=\"height:1.216em;width:0.6667em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.6667em' height='1.216em' style='width:0.6667em' viewBox='0 0 666.67 1216' preserveAspectRatio='xMinYMin'><path d='M319 0 H403 V1216 H319z M319 0 H403 V1216 H319z'/></svg></span></span><span style=\"top:-4.7111em;\"><span class=\"pstrut\" style=\"height:3.216em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎡</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.65em;\"><span style=\"top:-4.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord\">1</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span><span style=\"top:-1.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.15em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.65em;\"><span style=\"top:-4.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">4</span></span></span><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">0</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">3</span></span></span><span style=\"top:-1.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.15em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.65em;\"><span style=\"top:-4.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">5</span></span></span><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord\">1</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord\">1</span></span></span><span style=\"top:-1.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">5</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.15em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.65em;\"><span style=\"top:-4.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord\">5</span></span></span><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord\">5</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">2</span></span></span><span style=\"top:-1.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.15em;\"><span></span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.65em;\"><span style=\"top:-1.711em;\"><span class=\"pstrut\" style=\"height:3.216em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎦</span></span></span><span style=\"top:-2.858em;\"><span class=\"pstrut\" style=\"height:3.216em;\"></span><span style=\"height:1.216em;width:0.6667em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.6667em' height='1.216em' style='width:0.6667em' viewBox='0 0 666.67 1216' preserveAspectRatio='xMinYMin'><path d='M263 0 H347 V1216 H263z M263 0 H347 V1216 H263z'/></svg></span></span><span style=\"top:-4.7111em;\"><span class=\"pstrut\" style=\"height:3.216em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎤</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.15em;\"><span></span></span></span></span></span></span></span></span></span></span>","key":"gbrG9kk9wD"},{"type":"text","value":".","position":{"start":{"line":269,"column":1},"end":{"line":269,"column":1}},"key":"LFZtKn1YFA"}],"key":"iwPAfNbc1n"}],"key":"XFvodzNxEU"},{"type":"listItem","spread":true,"position":{"start":{"line":281,"column":1},"end":{"line":295,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":281,"column":1},"end":{"line":281,"column":1}},"children":[{"type":"text","value":"✍ Let ","position":{"start":{"line":281,"column":1},"end":{"line":281,"column":1}},"key":"ZliKS22JJN"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":281,"column":1},"end":{"line":281,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"Req9RcHxUI"},{"type":"text","value":" be a square matrix and ","position":{"start":{"line":281,"column":1},"end":{"line":281,"column":1}},"key":"amgKB34hpO"},{"type":"inlineMath","value":"\\mathbf{b}","position":{"start":{"line":281,"column":1},"end":{"line":281,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"oO9XNadYw1"},{"type":"text","value":" be a column vector of compatible length. Here is correct Julia code to solve ","position":{"start":{"line":281,"column":1},"end":{"line":281,"column":1}},"key":"e5KWsyQh7P"},{"type":"inlineMath","value":"\\mathbf{A}\\mathbf{x}=\\mathbf{b}","position":{"start":{"line":281,"column":1},"end":{"line":281,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi><mi mathvariant=\"bold\">x</mi><mo>=</mo><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}\\mathbf{x}=\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">Ax</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"It7Xy93RTo"},{"type":"text","value":":","position":{"start":{"line":281,"column":1},"end":{"line":281,"column":1}},"key":"KHQS9iPAq5"}],"key":"hkLt1O8tWg"},{"type":"code","lang":"julia","value":"L,U,p = lu(A)\nx = U \\ (L\\b[p])","position":{"start":{"line":283,"column":1},"end":{"line":286,"column":1}},"key":"duKUpzAAlh"},{"type":"paragraph","position":{"start":{"line":288,"column":1},"end":{"line":288,"column":1}},"children":[{"type":"text","value":"Suppose instead you replace the last line above with","position":{"start":{"line":288,"column":1},"end":{"line":288,"column":1}},"key":"xGVazqwSy3"}],"key":"CzX2DYQJ4L"},{"type":"code","lang":"julia","value":"x = U \\ L \\ b[p]","position":{"start":{"line":290,"column":1},"end":{"line":292,"column":1}},"key":"qdMTTCPtXf"},{"type":"paragraph","position":{"start":{"line":294,"column":1},"end":{"line":294,"column":1}},"children":[{"type":"text","value":"Mathematically in terms of ","position":{"start":{"line":294,"column":1},"end":{"line":294,"column":1}},"key":"VVzG6q9h9P"},{"type":"inlineMath","value":"\\mathbf{L}","position":{"start":{"line":294,"column":1},"end":{"line":294,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">L</span></span></span></span>","key":"C9U6mDqXh2"},{"type":"text","value":", ","position":{"start":{"line":294,"column":1},"end":{"line":294,"column":1}},"key":"VmD2KR38j9"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":294,"column":1},"end":{"line":294,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"bhrV6YWsZY"},{"type":"text","value":", ","position":{"start":{"line":294,"column":1},"end":{"line":294,"column":1}},"key":"quLFcaCs5h"},{"type":"inlineMath","value":"\\mathbf{p}","position":{"start":{"line":294,"column":1},"end":{"line":294,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">p</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{p}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6389em;vertical-align:-0.1944em;\"></span><span class=\"mord mathbf\">p</span></span></span></span>","key":"YOFJ1tfFKs"},{"type":"text","value":", and ","position":{"start":{"line":294,"column":1},"end":{"line":294,"column":1}},"key":"SXtoyMnYYS"},{"type":"inlineMath","value":"\\mathbf{b}","position":{"start":{"line":294,"column":1},"end":{"line":294,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"PGOHC41Wp2"},{"type":"text","value":", what vector is found?","position":{"start":{"line":294,"column":1},"end":{"line":294,"column":1}},"key":"topZ6a4s54"}],"key":"J9sDEok13s"}],"key":"vC1vLFgYm8"},{"type":"listItem","spread":true,"position":{"start":{"line":296,"column":1},"end":{"line":303,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":296,"column":1},"end":{"line":296,"column":1}},"children":[{"type":"text","value":"✍ Suppose that ","position":{"start":{"line":296,"column":1},"end":{"line":296,"column":1}},"key":"WCr3xwLrVX"},{"type":"inlineCode","value":"A","position":{"start":{"line":296,"column":1},"end":{"line":296,"column":1}},"key":"UE2zTPcXlN"},{"type":"text","value":" is a ","position":{"start":{"line":296,"column":1},"end":{"line":296,"column":1}},"key":"RrvV5o3ik0"},{"type":"inlineMath","value":"4\\times 6","position":{"start":{"line":296,"column":1},"end":{"line":296,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>4</mn><mo>×</mo><mn>6</mn></mrow><annotation encoding=\"application/x-tex\">4\\times 6</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">4</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">6</span></span></span></span>","key":"qhsbkZxZun"},{"type":"text","value":" matrix in Julia and you define","position":{"start":{"line":296,"column":1},"end":{"line":296,"column":1}},"key":"zYpuQUS5EB"}],"key":"D8Y3kae3NH"},{"type":"code","lang":"julia","value":"B = A[end:-1:1,end:-1:1]","position":{"start":{"line":298,"column":1},"end":{"line":300,"column":1}},"key":"P1o21oix8r"},{"type":"paragraph","position":{"start":{"line":302,"column":1},"end":{"line":302,"column":1}},"children":[{"type":"text","value":"Show that ","position":{"start":{"line":302,"column":1},"end":{"line":302,"column":1}},"key":"pC0tosM7BZ"},{"type":"inlineMath","value":"\\mathbf{B} = \\mathbf{P} \\mathbf{A} \\mathbf{Q}","position":{"start":{"line":302,"column":1},"end":{"line":302,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">B</mi><mo>=</mo><mi mathvariant=\"bold\">P</mi><mi mathvariant=\"bold\">A</mi><mi mathvariant=\"bold\">Q</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{B} = \\mathbf{P} \\mathbf{A} \\mathbf{Q}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">B</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8805em;vertical-align:-0.1944em;\"></span><span class=\"mord mathbf\">PAQ</span></span></span></span>","key":"VVcYCJHRzr"},{"type":"text","value":" for certain matrices ","position":{"start":{"line":302,"column":1},"end":{"line":302,"column":1}},"key":"sisNimOrEN"},{"type":"inlineMath","value":"\\mathbf{P}","position":{"start":{"line":302,"column":1},"end":{"line":302,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">P</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{P}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">P</span></span></span></span>","key":"w2FpQDsz18"},{"type":"text","value":" and ","position":{"start":{"line":302,"column":1},"end":{"line":302,"column":1}},"key":"PDwXN3gIzA"},{"type":"inlineMath","value":"\\mathbf{Q}","position":{"start":{"line":302,"column":1},"end":{"line":302,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">Q</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{Q}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8805em;vertical-align:-0.1944em;\"></span><span class=\"mord mathbf\">Q</span></span></span></span>","key":"qaYqpgfAyC"},{"type":"text","value":".","position":{"start":{"line":302,"column":1},"end":{"line":302,"column":1}},"key":"JT5kk2By7o"}],"key":"aSwGanwQvO"}],"key":"mWKB6EEMPd"}],"key":"JwXGypXbeL"},{"type":"list","ordered":true,"start":4,"spread":false,"position":{"start":{"line":305,"column":1},"end":{"line":315,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":305,"column":1},"end":{"line":315,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":1}},"children":[{"type":"text","value":"✍ An ","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":1}},"key":"u0D4YW8GSG"},{"type":"inlineMath","value":"n\\times n","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>×</mo><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n\\times n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"OHsskFr343"},{"type":"text","value":" ","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":1}},"key":"vD8sYuBsJg"},{"type":"emphasis","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":1}},"children":[{"type":"text","value":"permutation matrix","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":1}},"key":"L7NSQgZzfh"}],"key":"m4nkUcFcle"},{"type":"text","value":" ","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":1}},"key":"uwpgM4sxSu"},{"type":"inlineMath","value":"\\mathbf{P}","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">P</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{P}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">P</span></span></span></span>","key":"LixaJGlrY4"},{"type":"text","value":" is a reordering of the rows of an identity matrix such that ","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":1}},"key":"VnxIJa2fhi"},{"type":"inlineMath","value":"\\mathbf{P} \\mathbf{A}","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">P</mi><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{P} \\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">PA</span></span></span></span>","key":"tWK4LuhrYq"},{"type":"text","value":"  has the effect of moving rows ","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":1}},"key":"waLDp4n70N"},{"type":"inlineMath","value":"1,2,\\ldots,n","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mo separator=\"true\">,</mo><mn>2</mn><mo separator=\"true\">,</mo><mo>…</mo><mo separator=\"true\">,</mo><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">1,2,\\ldots,n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8389em;vertical-align:-0.1944em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">2</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"OBZ3hn6AOO"},{"type":"text","value":" of ","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":1}},"key":"aShMa7jVcr"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"nsLOqvdR3f"},{"type":"text","value":" to new positions ","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":1}},"key":"thCaT1uCxg"},{"type":"inlineMath","value":"i_1,i_2,\\ldots,i_n","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>i</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><msub><mi>i</mi><mn>2</mn></msub><mo separator=\"true\">,</mo><mo>…</mo><mo separator=\"true\">,</mo><msub><mi>i</mi><mi>n</mi></msub></mrow><annotation encoding=\"application/x-tex\">i_1,i_2,\\ldots,i_n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"yigM2grKGE"},{"type":"text","value":". Then ","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":1}},"key":"LvSyBPOzjQ"},{"type":"inlineMath","value":"\\mathbf{P}","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">P</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{P}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">P</span></span></span></span>","key":"O8CwW4XaXi"},{"type":"text","value":" can be expressed as","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":1}},"key":"dNRXrx7jO3"}],"key":"oj9Ovsb0pL"},{"type":"math","value":"\\mathbf{P} = \\mathbf{e}_{i_1}\\mathbf{e}_1^T + \\mathbf{e}_{i_2}\\mathbf{e}_2^T + \\cdots + \\mathbf{e}_{i_n}\\mathbf{e}_n^T.","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi mathvariant=\"bold\">P</mi><mo>=</mo><msub><mi mathvariant=\"bold\">e</mi><msub><mi>i</mi><mn>1</mn></msub></msub><msubsup><mi mathvariant=\"bold\">e</mi><mn>1</mn><mi>T</mi></msubsup><mo>+</mo><msub><mi mathvariant=\"bold\">e</mi><msub><mi>i</mi><mn>2</mn></msub></msub><msubsup><mi mathvariant=\"bold\">e</mi><mn>2</mn><mi>T</mi></msubsup><mo>+</mo><mo>⋯</mo><mo>+</mo><msub><mi mathvariant=\"bold\">e</mi><msub><mi>i</mi><mi>n</mi></msub></msub><msubsup><mi mathvariant=\"bold\">e</mi><mi>n</mi><mi>T</mi></msubsup><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{P} = \\mathbf{e}_{i_1}\\mathbf{e}_1^T + \\mathbf{e}_{i_2}\\mathbf{e}_2^T + \\cdots + \\mathbf{e}_{i_n}\\mathbf{e}_n^T.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">P</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1414em;vertical-align:-0.2501em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">e</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3173em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2501em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathbf\">e</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913em;\"><span style=\"top:-2.453em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1414em;vertical-align:-0.2501em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">e</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3173em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2501em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathbf\">e</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913em;\"><span style=\"top:-2.453em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"minner\">⋯</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1414em;vertical-align:-0.2501em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">e</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1645em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2501em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathbf\">e</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913em;\"><span style=\"top:-2.453em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span><span class=\"mord\">.</span></span></span></span></span>","enumerator":"2.6.4","key":"mO7RyYtSDc"},{"type":"paragraph","position":{"start":{"line":311,"column":1},"end":{"line":311,"column":1}},"children":[{"type":"strong","position":{"start":{"line":311,"column":1},"end":{"line":311,"column":1}},"children":[{"type":"text","value":"(a)","position":{"start":{"line":311,"column":1},"end":{"line":311,"column":1}},"key":"qWKtrle8p7"}],"key":"TPejiohscy"},{"type":"text","value":" For the case ","position":{"start":{"line":311,"column":1},"end":{"line":311,"column":1}},"key":"nNIv3wGDUS"},{"type":"inlineMath","value":"n=4","position":{"start":{"line":311,"column":1},"end":{"line":311,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>=</mo><mn>4</mn></mrow><annotation encoding=\"application/x-tex\">n=4</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">4</span></span></span></span>","key":"UMaOqKkvrF"},{"type":"text","value":" and ","position":{"start":{"line":311,"column":1},"end":{"line":311,"column":1}},"key":"JJHUuKaOwv"},{"type":"inlineMath","value":"i_1=3","position":{"start":{"line":311,"column":1},"end":{"line":311,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>i</mi><mn>1</mn></msub><mo>=</mo><mn>3</mn></mrow><annotation encoding=\"application/x-tex\">i_1=3</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8095em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">3</span></span></span></span>","key":"HdrhvWztQe"},{"type":"text","value":", ","position":{"start":{"line":311,"column":1},"end":{"line":311,"column":1}},"key":"ncrMQpLHxQ"},{"type":"inlineMath","value":"i_2=2","position":{"start":{"line":311,"column":1},"end":{"line":311,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>i</mi><mn>2</mn></msub><mo>=</mo><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">i_2=2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8095em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span></span></span></span>","key":"K7xkUI7kWl"},{"type":"text","value":", ","position":{"start":{"line":311,"column":1},"end":{"line":311,"column":1}},"key":"PEsZ3lN0ML"},{"type":"inlineMath","value":"i_3=4","position":{"start":{"line":311,"column":1},"end":{"line":311,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>i</mi><mn>3</mn></msub><mo>=</mo><mn>4</mn></mrow><annotation encoding=\"application/x-tex\">i_3=4</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8095em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">4</span></span></span></span>","key":"mwDKClbVus"},{"type":"text","value":", ","position":{"start":{"line":311,"column":1},"end":{"line":311,"column":1}},"key":"iapfco0aaj"},{"type":"inlineMath","value":"i_4=1","position":{"start":{"line":311,"column":1},"end":{"line":311,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>i</mi><mn>4</mn></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">i_4=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8095em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">4</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"tg4I1AtVaa"},{"type":"text","value":", write out separately, as matrices, all four of the terms in the sum. Then add them together to find ","position":{"start":{"line":311,"column":1},"end":{"line":311,"column":1}},"key":"MYm7lGErsq"},{"type":"inlineMath","value":"\\mathbf{P}","position":{"start":{"line":311,"column":1},"end":{"line":311,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">P</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{P}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">P</span></span></span></span>","key":"ryCs4xEfF7"},{"type":"text","value":".","position":{"start":{"line":311,"column":1},"end":{"line":311,"column":1}},"key":"jMGjBPAQ7Q"}],"key":"JHxK5pICHx"},{"type":"paragraph","position":{"start":{"line":313,"column":1},"end":{"line":313,"column":1}},"children":[{"type":"strong","position":{"start":{"line":313,"column":1},"end":{"line":313,"column":1}},"children":[{"type":"text","value":"(b)","position":{"start":{"line":313,"column":1},"end":{"line":313,"column":1}},"key":"C96hi1r4ec"}],"key":"TiYehCnWbP"},{"type":"text","value":" Use the formula in the general case to show that ","position":{"start":{"line":313,"column":1},"end":{"line":313,"column":1}},"key":"EU3MuHlGIU"},{"type":"inlineMath","value":"\\mathbf{P}^{-1}=\\mathbf{P}^T","position":{"start":{"line":313,"column":1},"end":{"line":313,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi mathvariant=\"bold\">P</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo>=</mo><msup><mi mathvariant=\"bold\">P</mi><mi>T</mi></msup></mrow><annotation encoding=\"application/x-tex\">\\mathbf{P}^{-1}=\\mathbf{P}^T</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">P</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8413em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">P</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span></span></span></span>","key":"tJnYSn4KOr"},{"type":"text","value":".","position":{"start":{"line":313,"column":1},"end":{"line":313,"column":1}},"key":"NR5UZyR3dQ"}],"key":"DnBsKB6zJi"}],"key":"hiZ634ITj8"}],"label":"problem-perminverse","identifier":"problem-perminverse","html_id":"problem-perminverse","key":"htORfE9u0q"},{"type":"footnoteDefinition","identifier":"plu","label":"PLU","position":{"start":{"line":313,"column":1},"end":{"line":313,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"children":[{"type":"text","value":"Because unpivoted LU factorization is not useful, in practice the term ","position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"key":"ayJ32Qc89V"},{"type":"emphasis","position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"children":[{"type":"text","value":"LU factorization","position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"key":"tLeazCyzmT"}],"key":"IKaahVBIKr"},{"type":"text","value":" mostly refers to pivoted LU.","position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"key":"t62qFQV1W8"}],"key":"cMDjqgd5e4"}],"enumerator":"1","key":"kjy2R8HGz7"}],"key":"nEO99WzpW7"}],"key":"dkd5HOZNxZ"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Efficiency of matrix computations","url":"/efficiency","group":"Preface"},"next":{"title":"Vector and matrix norms","url":"/norms","group":"Preface"}}},"domain":"http://localhost:3000"}