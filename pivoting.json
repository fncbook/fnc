{"kind":"Article","sha256":"ee0f481c6a23ab3ca31ee3daa637f33fd83299fcb799b9edb8987079af4dc26f","slug":"pivoting","location":"/chapter2/section6/pivoting.md","dependencies":[],"frontmatter":{"title":"Row pivoting","numbering":{"heading_1":{"enabled":true},"heading_2":{"enabled":true},"heading_3":{"enabled":false},"enumerator":{"template":"2.6.%s"}},"content_includes_title":false,"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"exports":[{"format":"md","filename":"pivoting.md","url":"/build/pivoting-7e27313d3c34cb3a4ebd55b4a94a26bd.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"As mentioned in ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"SprZcdi4Bv"},{"type":"link","kind":"numref","identifier":"section-linsys-lu","label":"section-linsys-lu","url":"/lu","internal":true,"dataUrl":"/lu.json","children":[{"type":"text","value":"LU factorization","key":"UNqAFBjDVY"}],"key":"xNMe5GranO"},{"type":"text","value":", the ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"UWIpRbTjGp"},{"type":"inlineMath","value":"\\mathbf{A}=\\mathbf{L}\\mathbf{U}","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi><mo>=</mo><mi mathvariant=\"bold\">L</mi><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}=\\mathbf{L}\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">LU</span></span></span></span>","key":"ujKQg2vCP2"},{"type":"text","value":" factorization is not stable for every nonsingular ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"gbFu77hXus"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"y3aj0k5dB0"},{"type":"text","value":". Indeed, the factorization does not always even exist.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"OGiuTCU8yM"}],"indexEntries":[{"entry":"matrix factorization","subEntry":{"value":"LU","kind":"entry"},"emphasis":false}],"label":"index-y2wiynVImw","identifier":"index-y2wiynvimw","html_id":"index-y2wiynvimw","key":"e1pY942AUN"},{"type":"proof","kind":"example","enumerated":true,"children":[{"type":"tabSet","children":[{"type":"tabItem","title":"Julia","sync":"julia","children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Failure of naive LU factorization","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"oqTGqhqxOX"}],"key":"XiDLuw3hrn"},{"type":"include","file":"julia/fail.ipynb","children":[{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-05T09:33:19.478000Z","iopub.status.busy":"2025-01-05T09:33:19.209000Z","iopub.status.idle":"2025-01-05T09:33:25.748000Z","shell.execute_reply":"2025-01-05T09:33:25.695000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"include(\"../../../julia/FNC_init.jl\")","key":"Iv6IzJ6KnP"},{"type":"output","id":"elfFwLJFFE1nppBwzVoBk","data":[{"name":"stderr","output_type":"stream","text":"\u001b[32m\u001b[1m  Activating\u001b[22m\u001b[39m "},{"name":"stderr","output_type":"stream","text":"project at `~/Documents/GitHub/fnc`\n"}],"key":"Zp0ZeyNHC6"}],"key":"XcLpb5SiVj"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"K0gLIiC11N"},{"type":"text","value":"2.6.1","key":"yx5TpITi6T"}],"key":"CFlhfToiXh"}],"identifier":"demo-pivoting-fail","label":"demo-pivoting-fail","kind":"proof:example","template":"Example %s","enumerator":"2.6.1","resolved":true,"html_id":"demo-pivoting-fail","key":"mTpaWJi1Hn"}],"key":"DLOqtmokRQ"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Here is a previously encountered matrix that factors well.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"X03b2RHFQC"}],"key":"ww77PslORf"}],"key":"wK7nmixEhp"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-05T09:33:25.891000Z","iopub.status.busy":"2025-01-05T09:33:25.749000Z","iopub.status.idle":"2025-01-05T09:33:27.259000Z","shell.execute_reply":"2025-01-05T09:33:27.259000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"A = [2 0 4 3 ; -4 5 -7 -10 ; 1 15 2 -4.5 ; -2 0 2 -13];\nL, U = FNC.lufact(A)\nL","key":"yoRBhtPKZu"},{"type":"output","id":"sfJ3Jwx7Xzyw_wYXmRTmf","data":[{"output_type":"execute_result","execution_count":2,"metadata":{},"data":{"text/plain":{"content":"4×4 LowerTriangular{Float64, Matrix{Float64}}:\n  1.0   ⋅     ⋅    ⋅ \n -2.0  1.0    ⋅    ⋅ \n  0.5  3.0   1.0   ⋅ \n -1.0  0.0  -2.0  1.0","content_type":"text/plain"}}}],"key":"mQpdAiU5fr"}],"key":"bA93bQHS6S"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"If we swap the second and fourth rows of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"eNWJJ3ugSU"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"QKpXX5FWuE"},{"type":"text","value":", the result is still nonsingular. However, the factorization now fails.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"p1UaekEPM0"}],"key":"vMbG0bnOTF"}],"key":"iQK5eUI1S3"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-05T09:33:27.262000Z","iopub.status.busy":"2025-01-05T09:33:27.262000Z","iopub.status.idle":"2025-01-05T09:33:27.315000Z","shell.execute_reply":"2025-01-05T09:33:27.315000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"A[[2, 4], :] = A[[4, 2], :]  \nL, U = FNC.lufact(A)\nL","key":"n4zfsWi4pE"},{"type":"output","id":"LSf9W-ovZ9v8yZrWPPYMX","data":[{"output_type":"execute_result","execution_count":3,"metadata":{},"data":{"text/plain":{"content":"4×4 LowerTriangular{Float64, Matrix{Float64}}:\n  1.0     ⋅      ⋅    ⋅ \n -1.0  NaN       ⋅    ⋅ \n  0.5   Inf   NaN     ⋅ \n -2.0   Inf   NaN    1.0","content_type":"text/plain"}}}],"key":"QbKoYmPLMX"}],"key":"WuqktAlSTb"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"The presence of ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"iXofd5vItv"},{"type":"inlineCode","value":"NaN","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"ySwCiu884p"},{"type":"text","value":" in the result indicates that some impossible operation was required. The source of the problem is easy to locate. We can find the first outer product in the factorization just fine:","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"v5pp4zAmIJ"}],"indexEntries":[{"entry":"Julia","subEntry":{"value":"NaN","kind":"entry"},"emphasis":false}],"label":"index-kaObC95VRo","identifier":"index-kaobc95vro","html_id":"index-kaobc95vro","key":"LoMem1WuW2"}],"key":"cGqFWk71Dy"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-05T09:33:27.317000Z","iopub.status.busy":"2025-01-05T09:33:27.317000Z","iopub.status.idle":"2025-01-05T09:33:27.518000Z","shell.execute_reply":"2025-01-05T09:33:27.518000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"U[1, :] = A[1, :]\nL[:, 1] = A[:, 1] / U[1, 1]\nA -= L[:, 1] * U[1, :]'","key":"tqOu6UI34c"},{"type":"output","id":"aWgsHVjcVPJOqJmmSC6q_","data":[{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n 0.0   0.0  0.0    0.0\n 0.0   0.0  6.0  -10.0\n 0.0  15.0  0.0   -6.0\n 0.0   5.0  1.0   -4.0","content_type":"text/plain"}}}],"key":"FXWVHezKOT"}],"key":"jmfLp9DN4A"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The next step is ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"NtG4mqQ43u"},{"type":"inlineCode","value":"U[2, :] = A[2, :]","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"EKJAyfyJUV"},{"type":"text","value":", which is also OK. But then we are supposed to divide by ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hFfki2i2sY"},{"type":"inlineCode","value":"U[2, 2]","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mXvIa7NMub"},{"type":"text","value":", which is zero. The algorithm cannot continue.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bqZh6aNpih"}],"key":"BcPQyyTHdx"}],"key":"mCrR98EVMX"}],"key":"S0g15v4Hyi"}],"key":"DJjXqajhWw"}],"key":"QfvIo5B865"},{"type":"tabItem","title":"MATLAB","sync":"matlab","children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Failure of naive LU factorization","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"ddO1ek5PAl"}],"key":"wxtjnSqu7t"},{"type":"include","file":"matlab/fail.ipynb","children":[{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"ur5C6AM9cV"},{"type":"text","value":"2.6.1","key":"kglSKsc4k6"}],"key":"fOMKcfECuQ"}],"identifier":"demo-pivoting-fail","label":"demo-pivoting-fail","kind":"proof:example","template":"Example %s","enumerator":"2.6.1","resolved":true,"html_id":"demo-pivoting-fail","key":"MEUuHZRfrN"}],"key":"eOWqIz6fqZ"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Here is a previously encountered matrix that factors well.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"dEPxhQ2WEt"}],"key":"l0FCz2Rh6p"}],"key":"Pj6ch1LujJ"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"A = [\n    2 0 4 3\n    -4 5 -7 -10\n    1 15 2 -4.5\n    -2 0 2 -13\n    ];\n[L, U] = lufact(A);\nL","key":"d7P1L5Y7yE"},{"type":"output","id":"Z5DrczOT2YV4_tLKZ01u9","data":[{"output_type":"execute_result","execution_count":2,"metadata":{},"data":{"text/plain":{"content":"L = 4×4 double\n    1.0000         0         0         0\n   -2.0000    1.0000         0         0\n    0.5000    3.0000    1.0000         0\n   -1.0000         0   -2.0000    1.0000\n","content_type":"text/plain"},"text/html":{"content":"<html><body><pre>L = 4×4 double\n    1.0000         0         0         0\n   -2.0000    1.0000         0         0\n    0.5000    3.0000    1.0000         0\n   -1.0000         0   -2.0000    1.0000\n</pre></body></html>","content_type":"text/html"}}}],"key":"CoGMykDQc3"}],"key":"cvkXv5DRRn"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"If we swap the second and fourth rows of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"b9nSmMYAce"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"rlC8l8S4BI"},{"type":"text","value":", the result is still nonsingular. However, the factorization now fails.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"BMvAL5VSGw"}],"key":"WezrnYblys"}],"key":"wu810uPBVe"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"A([2, 4], :) = A([4, 2], :);    % swap rows 2 and 4\n[L, U] = lufact(A);\nL","key":"vp3HBK9mtM"},{"type":"output","id":"Nc_VwDBUhXgcj-Ro1O7NW","data":[{"output_type":"execute_result","execution_count":3,"metadata":{},"data":{"text/plain":{"content":"L = 4×4 double\n    1.0000         0         0         0\n   -1.0000       NaN         0         0\n    0.5000       Inf       NaN         0\n   -2.0000       Inf       NaN    1.0000\n","content_type":"text/plain"},"text/html":{"content":"<html><body><pre>L = 4×4 double\n    1.0000         0         0         0\n   -1.0000       NaN         0         0\n    0.5000       Inf       NaN         0\n   -2.0000       Inf       NaN    1.0000\n</pre></body></html>","content_type":"text/html"}}}],"key":"R7VT8bb4gl"}],"key":"JhSHtYnnmn"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"The presence of ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"tFQdXgp73x"},{"type":"inlineCode","value":"NaN","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"tIOncaRlqt"},{"type":"text","value":" in the result indicates that some impossible operation was required. The source of the problem is easy to locate. We can find the first outer product in the factorization just fine:","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"Q4EAaQrHA8"}],"indexEntries":[{"entry":"MATLAB","subEntry":{"value":"NaN","kind":"entry"},"emphasis":false}],"label":"index-Y98QsCmP3q","identifier":"index-y98qscmp3q","html_id":"index-y98qscmp3q","key":"yWfWtybYzQ"}],"key":"Ta5jLUn39n"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"U(1, :) = A(1, :);\nL(:, 1) = A(:, 1) / U(1, 1)\nA = A - L(:, 1) * U(1, :)","key":"YeRlKMk5Wc"},{"type":"output","id":"Wmy6-ViCl7ZhVuxrsCmOs","data":[{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"text/plain":{"content":"L = 4×4 double\n    1.0000         0         0         0\n   -1.0000       NaN         0         0\n    0.5000       Inf       NaN         0\n   -2.0000       Inf       NaN    1.0000\n","content_type":"text/plain"},"text/html":{"content":"<html><body><pre>L = 4×4 double\n    1.0000         0         0         0\n   -1.0000       NaN         0         0\n    0.5000       Inf       NaN         0\n   -2.0000       Inf       NaN    1.0000\n</pre></body></html>","content_type":"text/html"}}},{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"text/plain":{"content":"A = 4×4 double\n     0     0     0     0\n     0     0     6   -10\n     0    15     0    -6\n     0     5     1    -4\n","content_type":"text/plain"},"text/html":{"content":"<html><body><pre>A = 4×4 double\n     0     0     0     0\n     0     0     6   -10\n     0    15     0    -6\n     0     5     1    -4\n</pre></body></html>","content_type":"text/html"}}}],"key":"rDmsbVcfr0"}],"key":"rc5fpfrejn"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The next step is ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"aVJTfT7ke9"},{"type":"inlineCode","value":"U(2, :) = A(2, :)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"m2mu7vnnge"},{"type":"text","value":", which is also OK. But then we are supposed to divide by ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WUoykjhQDR"},{"type":"inlineCode","value":"U(2, 2)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"tPZfhatAVY"},{"type":"text","value":", which is zero. The algorithm cannot continue.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"oI4c8EkCGl"}],"key":"cPyiZqqWGa"}],"key":"STgXyPhS1X"}],"key":"AD06FfxGcC"}],"key":"kTMZylVGQ1"}],"key":"inAyPR8hHv"},{"type":"tabItem","title":"Python","sync":"python","children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Failure of naive LU factorization","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"fyji6NL9o1"}],"key":"OYndv9PkBy"},{"type":"include","file":"python/fail.ipynb","children":[{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:43:40.004703Z","iopub.status.busy":"2025-01-11T17:43:40.004443Z","iopub.status.idle":"2025-01-11T17:43:40.328749Z","shell.execute_reply":"2025-01-11T17:43:40.328378Z"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"exec(open(\"../../../python/FNC_init.py\").read())","visibility":"show","key":"nM7NMW01CP"},{"type":"output","id":"yphwZXpF_h_p3afn6ZGDS","data":[],"visibility":"show","key":"JvGc6P3Mqc"}],"visibility":"remove","key":"AXNbso2IJV"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"xiCLdPiVSj"},{"type":"text","value":"2.6.1","key":"HqF4uhcKOl"}],"key":"KIXKlfWJd4"}],"identifier":"demo-pivoting-fail","label":"demo-pivoting-fail","kind":"proof:example","template":"Example %s","enumerator":"2.6.1","resolved":true,"html_id":"demo-pivoting-fail","key":"sqcI16bEzT"}],"key":"x1sIkADUi9"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Here is a previously encountered matrix that factors well.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"lLAp8GBzfc"}],"key":"KOoRmcyI9D"}],"key":"oEDBXaYggr"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:43:40.330377Z","iopub.status.busy":"2025-01-11T17:43:40.330253Z","iopub.status.idle":"2025-01-11T17:43:40.332641Z","shell.execute_reply":"2025-01-11T17:43:40.332382Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"A = array([\n    [2, 0, 4, 3],\n    [-4, 5, -7, -10],\n    [1, 15, 2, -4.5],\n    [-2, 0, 2, -13]\n    ])\nL, U = FNC.lufact(A)\nprint(L)","key":"O7WFNUQuCU"},{"type":"output","id":"HUevdx6CX5wo2bmoefVnu","data":[{"name":"stdout","output_type":"stream","text":"[[ 1.   0.  -0.   0. ]\n [-2.   1.  -0.   0. ]\n [ 0.5  3.   1.   0. ]\n [-1.   0.  -2.   1. ]]\n"}],"key":"RHw7s4MztR"}],"key":"wNpzV0EzGr"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"If we swap the second and fourth rows of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"V8Zf2df7Ks"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"v7oaIuLNG7"},{"type":"text","value":", the result is still nonsingular. However, the factorization now fails.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RyvhV5icUX"}],"key":"p2MX5ml24S"}],"key":"D7hq2SuIeZ"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:43:40.333897Z","iopub.status.busy":"2025-01-11T17:43:40.333777Z","iopub.status.idle":"2025-01-11T17:43:40.337813Z","shell.execute_reply":"2025-01-11T17:43:40.337546Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"A[[1, 3], :] = A[[3, 1], :]  \nL, U = FNC.lufact(A)\nprint(L)","key":"invMAT92Q5"},{"type":"output","id":"iSrWPbsSCHNSb40WKX02C","data":[{"name":"stdout","output_type":"stream","text":"[[ 1.   nan  nan  0. ]\n [-1.   nan  nan  0. ]\n [ 0.5  inf  nan  0. ]\n [-2.   inf  nan  1. ]]\n"},{"name":"stderr","output_type":"stream","text":"/Users/driscoll/Documents/GitHub/fnc/python/fncbook/fncbook/chapter02.py:47: RuntimeWarning: divide by zero encountered in divide\n  L[:, k] = A_k[:, k] / U[k,k]\n/Users/driscoll/Documents/GitHub/fnc/python/fncbook/fncbook/chapter02.py:47: RuntimeWarning: invalid value encountered in divide\n  L[:, k] = A_k[:, k] / U[k,k]\n/Users/driscoll/mambaforge/envs/myst/lib/python3.13/site-packages/numpy/_core/numeric.py:983: RuntimeWarning: invalid value encountered in multiply\n  return multiply(a.ravel()[:, newaxis], b.ravel()[newaxis, :], out)\n"}],"key":"eAebBqONWH"}],"key":"rxavEjQjEl"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"The presence of ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"gL9hqECyyT"},{"type":"inlineCode","value":"NaN","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"sF0PTVIVo1"},{"type":"text","value":" in the result indicates that some impossible operation was required. The source of the problem is easy to locate. We can find the first outer product in the factorization just fine:","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"sCvfLObKk7"}],"indexEntries":[{"entry":"Python","subEntry":{"value":"NaN","kind":"entry"},"emphasis":false}],"label":"index-PuHP7alGsl","identifier":"index-puhp7algsl","html_id":"index-puhp7algsl","key":"EUT1zhohja"}],"key":"I248XbuuyU"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:43:40.339029Z","iopub.status.busy":"2025-01-11T17:43:40.338939Z","iopub.status.idle":"2025-01-11T17:43:40.341092Z","shell.execute_reply":"2025-01-11T17:43:40.340821Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"U[0, :] = A[0, :]\nL[:, 0] = A[:, 0] / U[0, 0]\nA -= outer(L[:, 0],  U[0, :])\nprint(A)","key":"Nz2FNRWWBb"},{"type":"output","id":"TvsqfByat45ATlLLs1SYH","data":[{"name":"stdout","output_type":"stream","text":"[[  0.   0.   0.   0.]\n [  0.   0.   6. -10.]\n [  0.  15.   0.  -6.]\n [  0.   5.   1.  -4.]]\n"}],"key":"hC9eskewz4"}],"key":"UHMfPRjeYr"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The next step is ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PVVerHnJvr"},{"type":"inlineCode","value":"U[1, :] = A[1, :]","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wtLu1TayWt"},{"type":"text","value":", which is also OK. But then we are supposed to divide by ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Ag74CkHKh3"},{"type":"inlineCode","value":"U[1, 1]","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LUR62GZyOd"},{"type":"text","value":", which is zero. The algorithm cannot continue.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"NdZqsLoqLt"}],"key":"v8RZzvwFoT"}],"key":"dXSASh6nUc"}],"key":"yfHhMAGW65"}],"key":"tohgljPncQ"}],"key":"sZX9Qw5yfR"}],"key":"elrT0iRCgT"}],"label":"demo-pivoting-fail","identifier":"demo-pivoting-fail","html_id":"demo-pivoting-fail","enumerator":"2.6.1","key":"vxW0OXy8vO"},{"type":"paragraph","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"children":[{"type":"text","value":"In ","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"key":"PvvEBENXLC"},{"type":"link","kind":"numref","identifier":"section-linsys-lu","label":"section-linsys-lu","url":"/lu","internal":true,"dataUrl":"/lu.json","children":[{"type":"text","value":"LU factorization","key":"DZFe3cUhRK"}],"key":"rYeJYeQqUr"},{"type":"text","value":" we remarked that LU factorization is equivalent to Gaussian elimination with no row swaps. However, those swaps are necessary in situations like those encountered in ","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"key":"gElCp33e5C"},{"type":"crossReference","kind":"proof:example","identifier":"demo-pivoting-fail","label":"demo-pivoting-fail","children":[{"type":"text","value":"Demo ","key":"H0icz7qjUn"},{"type":"text","value":"2.6.1","key":"u9vJugPggy"}],"template":"Example %s","enumerator":"2.6.1","resolved":true,"html_id":"demo-pivoting-fail","key":"l0V5qYDY8B"},{"type":"text","value":", in order to avoid division by zero. We will find a modification of the outer product procedure that allows us to do the same thing.","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"key":"gERbRj2Oxf"}],"key":"w8wNUfjiLx"},{"type":"heading","depth":2,"position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"children":[{"type":"text","value":"Choosing a pivot","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"key":"Ii0KQkeXQp"}],"identifier":"choosing-a-pivot","label":"Choosing a pivot","html_id":"choosing-a-pivot","implicit":true,"enumerator":"2.6.1","key":"EBNNLjrOkV"},{"type":"paragraph","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"children":[{"type":"text","value":"The diagonal element of ","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"EnCbWsS0Fr"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"Gmf9fVkw8w"},{"type":"text","value":" that appears in the denominator of line 17 of ","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"F4GqU9msXn"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-lufact","label":"function-lufact","children":[{"type":"text","value":"Function ","key":"VC44bp6u2N"},{"type":"text","value":"2.4.1","key":"S7vYozHdFs"}],"template":"Algorithm %s","enumerator":"2.4.1","resolved":true,"html_id":"function-lufact","remote":true,"url":"/lu","dataUrl":"/lu.json","key":"Bv3eYMytW6"},{"type":"text","value":" is called the ","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"vTjKDAWt5g"},{"type":"strong","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"children":[{"type":"text","value":"pivot element","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"Aw4nILFYkg"}],"key":"igQu5GgX1E"},{"type":"text","value":" of its column. In order to avoid a zero pivot, we will use the largest available element in the column we are working on as the pivot. This technique is known as ","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"FL5aEkM18J"},{"type":"strong","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"children":[{"type":"text","value":"row pivoting","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"ZIMV0ISXr6"}],"key":"YS7p8j3Eim"},{"type":"text","value":".","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"HW9N3joGjt"}],"indexEntries":[{"entry":"pivoting","emphasis":true}],"label":"index-yEGDumzqNl","identifier":"index-yegdumzqnl","html_id":"index-yegdumzqnl","key":"ati822Hxwl"},{"type":"proof","kind":"algorithm","enumerated":true,"children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Row pivoting","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"key":"mppUWiJ6M5"}],"key":"JCnrvYMfRi"},{"type":"paragraph","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"children":[{"type":"text","value":"When performing elimination in column ","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"PGC45ptW7U"},{"type":"inlineMath","value":"j","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>j</mi></mrow><annotation encoding=\"application/x-tex\">j</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span></span></span></span>","key":"vVyRsjJNus"},{"type":"text","value":", choose as the pivot the element in column ","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"Sc62DM94Zv"},{"type":"inlineMath","value":"j","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>j</mi></mrow><annotation encoding=\"application/x-tex\">j</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span></span></span></span>","key":"nW3rzzUasd"},{"type":"text","value":" that is largest in absolute value. (In case of ties, choose the lowest row index.)","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"zIRBXOT6RW"}],"key":"NIliamSlhv"}],"label":"rule-pivoting","identifier":"rule-pivoting","html_id":"rule-pivoting","enumerator":"2.6.1","key":"r2EZWPcJ6W"},{"type":"proof","kind":"example","enumerated":true,"children":[{"type":"tabSet","children":[{"type":"tabItem","title":"Julia","sync":"julia","children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Row pivoting in LU factorization","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"JJb7hEodVh"}],"key":"lXhmaxrP8y"},{"type":"include","file":"julia/fix.ipynb","children":[{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-05T09:33:35.371000Z","iopub.status.busy":"2025-01-05T09:33:34.405000Z","iopub.status.idle":"2025-01-05T09:33:41.736000Z","shell.execute_reply":"2025-01-05T09:33:41.689000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"include(\"../../../julia/FNC_init.jl\")","key":"HtlxPJ3vcY"},{"type":"output","id":"raXHQuEdaRaPQkVX6Zxr0","data":[{"name":"stderr","output_type":"stream","text":"\u001b[32m\u001b[1m  Activating\u001b[22m\u001b[39m "},{"name":"stderr","output_type":"stream","text":"project at `~/Documents/GitHub/fnc`\n"}],"key":"V8NtEUbmLI"}],"key":"Gbw1WffhTR"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"GWuAjwIPu5"},{"type":"text","value":"2.6.2","key":"ZEaCY7INXU"}],"key":"bgNqD7Qvwb"}],"identifier":"demo-pivoting-fix","label":"demo-pivoting-fix","kind":"proof:example","template":"Example %s","enumerator":"2.6.2","resolved":true,"html_id":"demo-pivoting-fix","key":"VGz9h53AJP"}],"key":"sHOiMoJZpD"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Here is the trouble-making matrix from ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"BYsYSMsmiP"},{"type":"crossReference","kind":"proof:example","identifier":"demo-pivoting-fail","label":"demo-pivoting-fail","children":[{"type":"text","value":"Demo ","key":"y543ayJwYX"},{"type":"text","value":"2.6.1","key":"IwZF8zLfe1"}],"template":"Example %s","enumerator":"2.6.1","resolved":true,"html_id":"demo-pivoting-fail","key":"lHVoCI6K7k"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"u62Yw29CVN"}],"key":"Ua1ttF3Dsb"}],"key":"CrcTxSbhMt"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-05T09:33:41.871000Z","iopub.status.busy":"2025-01-05T09:33:41.738000Z","iopub.status.idle":"2025-01-05T09:33:43.144000Z","shell.execute_reply":"2025-01-05T09:33:43.144000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"A₁ = [2 0 4 3 ; -2 0 2 -13; 1 15 2 -4.5 ; -4 5 -7 -10]","key":"qGUFOreSR3"},{"type":"output","id":"nCz1UXBRtdHMNdBOsQaUe","data":[{"output_type":"execute_result","execution_count":2,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n  2.0   0.0   4.0    3.0\n -2.0   0.0   2.0  -13.0\n  1.0  15.0   2.0   -4.5\n -4.0   5.0  -7.0  -10.0","content_type":"text/plain"}}}],"key":"eQbfkN3en1"}],"key":"AjqA1TosNv"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We now find the largest candidate pivot in the first column. We don’t care about sign, so we take absolute values before finding the max.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"J23N1CejTP"}],"key":"hRYTGXHKNc"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"WWmlGF2bPv"}],"key":"zvlR3D6KG3"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"FArl5lH067"},{"type":"inlineCode","value":"argmax","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"mmiv3IiuaP"},{"type":"text","value":" function returns the location of the largest element of a vector or matrix.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"er8gbfvJSQ"}],"key":"PELEL074ze"}],"class":"dropdown","key":"yFoQkrIfUr"}],"key":"Fuv1KQ4pxf"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-05T09:33:43.146000Z","iopub.status.busy":"2025-01-05T09:33:43.146000Z","iopub.status.idle":"2025-01-05T09:33:43.234000Z","shell.execute_reply":"2025-01-05T09:33:43.234000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"i = argmax( abs.(A₁[:, 1]) ) ","key":"MeJInJFB6b"},{"type":"output","id":"G9f7wIeW9UIH1JFVzTZ1o","data":[{"output_type":"execute_result","execution_count":3,"metadata":{},"data":{"text/plain":{"content":"4","content_type":"text/plain"}}}],"key":"qGXWyX7ZMk"}],"key":"P3ETBDKnmh"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"This is the row of the matrix that we extract to put into ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GzQ4hGiFmD"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"KyOZLWBWIZ"},{"type":"text","value":". That guarantees that the division used to find ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"FzwWNcZdFy"},{"type":"inlineMath","value":"\\boldsymbol{\\ell}_1","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">ℓ</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\boldsymbol{\\ell}_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">ℓ</span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"mfqnCSCsGH"},{"type":"text","value":" will be valid.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RID5fTaMrn"}],"key":"oydwlpV3OV"}],"key":"TK2Z6SCx3V"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-05T09:33:43.236000Z","iopub.status.busy":"2025-01-05T09:33:43.236000Z","iopub.status.idle":"2025-01-05T09:33:43.248000Z","shell.execute_reply":"2025-01-05T09:33:43.248000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"L, U = zeros(4,4),zeros(4,4)\nU[1, :] = A₁[i, :]\nL[:, 1] = A₁[:, 1] / U[1, 1]\nA₂ = A₁ - L[:, 1] * U[1, :]'","key":"Xl4tXjVUzu"},{"type":"output","id":"gFDgPj-uuSAijMrbaZnMg","data":[{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n 0.0   2.5   0.5   -2.0\n 0.0  -2.5   5.5   -8.0\n 0.0  16.25  0.25  -7.0\n 0.0   0.0   0.0    0.0","content_type":"text/plain"}}}],"key":"ZfrWXM3Zsx"}],"key":"aFh6oz7gS0"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Observe that ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TzXxbGYI3c"},{"type":"inlineMath","value":"\\mathbf{A}_2","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">A</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8361em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"vYaBXrkQwn"},{"type":"text","value":" has a new zero row and zero column, but the zero row is the fourth rather than the first. However, we forge on by using the largest possible pivot in column 2 for the next outer product.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JDZfSXZtWa"}],"key":"QMV6Ctgi7v"}],"key":"Pwtlsp7Gmp"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-05T09:33:43.249000Z","iopub.status.busy":"2025-01-05T09:33:43.249000Z","iopub.status.idle":"2025-01-05T09:33:43.742000Z","shell.execute_reply":"2025-01-05T09:33:43.742000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"@show i = argmax( abs.(A₂[:, 2]) ) \nU[2, :] = A₂[i, :]\nL[:, 2] = A₂[:, 2] / U[2, 2]\nA₃ = A₂ - L[:, 2] * U[2, :]'","key":"P9iccDE1Ox"},{"type":"output","id":"eed0TEJ2Ay9J2du6Q07QU","data":[{"name":"stdout","output_type":"stream","text":"i = argmax(abs.(A₂[:, 2])) = 3"},{"name":"stdout","output_type":"stream","text":"\n"},{"output_type":"execute_result","execution_count":5,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n 0.0  0.0  0.461538  -0.923077\n 0.0  0.0  5.53846   -9.07692\n 0.0  0.0  0.0        0.0\n 0.0  0.0  0.0        0.0","content_type":"text/plain"}}}],"key":"pqwQBFhdmC"}],"key":"t9qw5x4VUa"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now we have zeroed out the third row as well as the second column. We can finish out the procedure.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GJXwapGG1K"}],"key":"DlRTZKV0Va"}],"key":"ClZl4hlFac"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-05T09:33:43.744000Z","iopub.status.busy":"2025-01-05T09:33:43.744000Z","iopub.status.idle":"2025-01-05T09:33:43.746000Z","shell.execute_reply":"2025-01-05T09:33:43.745000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"@show i = argmax( abs.(A₃[:, 3]) ) \nU[3, :] = A₃[i, :]\nL[:, 3] = A₃[:, 3] / U[3, 3]\nA₄ = A₃ - L[:, 3] * U[3, :]'","key":"nlfV0noQbB"},{"type":"output","id":"Q4hy-A95klsC4Tdn_jr8n","data":[{"name":"stdout","output_type":"stream","text":"i = argmax(abs.(A₃[:, 3])) = 2\n"},{"output_type":"execute_result","execution_count":6,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n 0.0  0.0  0.0  -0.166667\n 0.0  0.0  0.0   0.0\n 0.0  0.0  0.0   0.0\n 0.0  0.0  0.0   0.0","content_type":"text/plain"}}}],"key":"SSPPNMShhy"}],"key":"QzsqJf6pZi"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-05T09:33:43.747000Z","iopub.status.busy":"2025-01-05T09:33:43.747000Z","iopub.status.idle":"2025-01-05T09:33:43.754000Z","shell.execute_reply":"2025-01-05T09:33:43.754000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"@show i = argmax( abs.(A₄[:, 4]) ) \nU[4, :] = A₄[i, :]\nL[:, 4] = A₄[:, 4] / U[4, 4];","key":"RAGyfu1r0S"},{"type":"output","id":"csVIz85s84OtMwx9Dfp2u","data":[{"name":"stdout","output_type":"stream","text":"i = argmax(abs.(A₄[:, 4])) = 1\n"}],"key":"PAKlsV3oxJ"}],"key":"LQEHlPruXW"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We do have a factorization of the original matrix:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LpYJgsxmAx"}],"key":"CN0D89D0vs"}],"key":"Nm2f745FzZ"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-05T09:33:43.755000Z","iopub.status.busy":"2025-01-05T09:33:43.755000Z","iopub.status.idle":"2025-01-05T09:33:43.761000Z","shell.execute_reply":"2025-01-05T09:33:43.761000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"A₁ - L * U","key":"owXYrNAq8o"},{"type":"output","id":"Djo-YaCHj1F5AHIDel9QM","data":[{"output_type":"execute_result","execution_count":8,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n 0.0  -1.38778e-16  0.0  0.0\n 0.0   1.38778e-16  0.0  0.0\n 0.0   0.0          0.0  0.0\n 0.0   0.0          0.0  0.0","content_type":"text/plain"}}}],"key":"d7MqOhR4sM"}],"key":"i4CvNMibXd"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"And ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"NWNxJvpjgb"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"RaEhrvmSES"},{"type":"text","value":" has the required structure:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"USnFHacMFO"}],"key":"ODQAGZyDU1"}],"key":"P7T8FiaEnz"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-05T09:33:43.762000Z","iopub.status.busy":"2025-01-05T09:33:43.762000Z","iopub.status.idle":"2025-01-05T09:33:43.763000Z","shell.execute_reply":"2025-01-05T09:33:43.763000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"U","key":"LWXAMpJEpP"},{"type":"output","id":"RoJ-a_T_6Ip8NvTBM6gtG","data":[{"output_type":"execute_result","execution_count":9,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n -4.0   5.0   -7.0      -10.0\n  0.0  16.25   0.25      -7.0\n  0.0   0.0    5.53846   -9.07692\n  0.0   0.0    0.0       -0.166667","content_type":"text/plain"}}}],"key":"Djw50Tc6K8"}],"key":"e5OCNp8bWd"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"However, the triangularity of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"sq1DO3v3ow"},{"type":"inlineMath","value":"\\mathbf{L}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">L</span></span></span></span>","key":"G2hvB6l5Q9"},{"type":"text","value":" has been broken.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"anO0kDtm7E"}],"key":"e7gy2kS1y9"}],"key":"RxQPnm6Szb"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-05T09:33:43.764000Z","iopub.status.busy":"2025-01-05T09:33:43.764000Z","iopub.status.idle":"2025-01-05T09:33:43.765000Z","shell.execute_reply":"2025-01-05T09:33:43.765000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"L","key":"n8raD6CcRg"},{"type":"output","id":"qYHrecwVq9fwYwPXETWMX","data":[{"output_type":"execute_result","execution_count":10,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n -0.5    0.153846  0.0833333   1.0\n  0.5   -0.153846  1.0        -0.0\n -0.25   1.0       0.0        -0.0\n  1.0    0.0       0.0        -0.0","content_type":"text/plain"}}}],"key":"ced9yZepzn"}],"key":"jolvYgv57u"}],"key":"peqWcT4b7a"}],"key":"iEMXtFmPLT"}],"key":"wWtiQSsufX"},{"type":"tabItem","title":"MATLAB","sync":"matlab","children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Row pivoting in LU factorization","position":{"start":{"line":74,"column":1},"end":{"line":74,"column":1}},"key":"SUUPSxMMHj"}],"key":"IVVczXPfjy"},{"type":"include","file":"matlab/fix.ipynb","children":[{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"cX8iUcKjvn"},{"type":"text","value":"2.6.2","key":"Few2bhV8wc"}],"key":"p7dQhGprOa"}],"identifier":"demo-pivoting-fix","label":"demo-pivoting-fix","kind":"proof:example","template":"Example %s","enumerator":"2.6.2","resolved":true,"html_id":"demo-pivoting-fix","key":"Hre1Gm4LlF"}],"key":"a54xUiwuOp"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Here is the trouble-making matrix from ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"DdAGKU3fQu"},{"type":"crossReference","kind":"proof:example","identifier":"demo-pivoting-fail","label":"demo-pivoting-fail","children":[{"type":"text","value":"Demo ","key":"RNStpoD0fo"},{"type":"text","value":"2.6.1","key":"iKqkNs0fRU"}],"template":"Example %s","enumerator":"2.6.1","resolved":true,"html_id":"demo-pivoting-fail","key":"yv2vX4OxeN"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"vsrekJeelR"}],"key":"qWF7GWoydr"}],"key":"BDvFcRg89k"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"A_1 = [2 0 4 3; -2 0 2 -13; 1 15 2 -4.5; -4 5 -7 -10]","key":"DsFSEKDqtv"},{"type":"output","id":"5JfhkSHt_BFRqy7YAx_JZ","data":[{"output_type":"execute_result","execution_count":2,"metadata":{},"data":{"text/plain":{"content":"A_1 = 4×4 double\n    2.0000         0    4.0000    3.0000\n   -2.0000         0    2.0000  -13.0000\n    1.0000   15.0000    2.0000   -4.5000\n   -4.0000    5.0000   -7.0000  -10.0000\n","content_type":"text/plain"},"text/html":{"content":"<html><body><pre>A_1 = 4×4 double\n    2.0000         0    4.0000    3.0000\n   -2.0000         0    2.0000  -13.0000\n    1.0000   15.0000    2.0000   -4.5000\n   -4.0000    5.0000   -7.0000  -10.0000\n</pre></body></html>","content_type":"text/html"}}}],"key":"xesbrCl5h9"}],"key":"IC89gD2dn5"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"We now find the largest candidate pivot in the first column. We don’t care about sign, so we take absolute values before finding the max.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"Q5UbiK95e5"}],"indexEntries":[{"entry":"MATLAB","subEntry":{"value":"max","kind":"entry"},"emphasis":true},{"entry":"MATLAB","subEntry":{"value":"\\~","kind":"entry"},"emphasis":true}],"label":"index-KH4sKRZLSG","identifier":"index-kh4skrzlsg","html_id":"index-kh4skrzlsg","key":"r6AoqCaAa8"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"kyzFD663OK"}],"key":"AJwvehI9Oh"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"The second output of ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"cbmmRB8yM7"},{"type":"inlineCode","value":"max","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"x5p0Kw0197"},{"type":"text","value":" returns the location of the largest element of a vector. The ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"YapCvtnNyU"},{"type":"inlineCode","value":"~","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"dodjPHPrKS"},{"type":"text","value":" symbol is used to ignore the value of the first output.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"cJ2ioLTsia"}],"key":"PNnp1AHqVX"}],"class":"dropdown","key":"eoKSTDkRzX"}],"key":"oAMqKchnVC"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"[~, i] = max( abs(A_1(:, 1)) ) ","key":"PuLiIfSco1"},{"type":"output","id":"O4cjHEHGFGzwCWfz4p6LG","data":[{"output_type":"execute_result","execution_count":3,"metadata":{},"data":{"text/plain":{"content":"i = 4","content_type":"text/plain"},"text/html":{"content":"<html><body><pre>i = 4</pre></body></html>","content_type":"text/html"}}}],"key":"X0kJ2LxvZx"}],"key":"BiEnsGbeh4"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"This is the row of the matrix that we extract to put into ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qXrXBvMkYC"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"WjXiwskaYu"},{"type":"text","value":". That guarantees that the division used to find ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nyfARMwSK8"},{"type":"inlineMath","value":"\\boldsymbol{\\ell}_1","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">ℓ</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\boldsymbol{\\ell}_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">ℓ</span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"seoDiGLKlb"},{"type":"text","value":" will be valid.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Eahdfngdle"}],"key":"Dc5L01x2mB"}],"key":"O4AhqfsPei"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"L = zeros(4, 4);\nU = zeros(4, 4);\nU(1, :) = A_1(i, :);\nL(:, 1) = A_1(:, 1) / U(1, 1);\nA_2 = A_1 - L(:, 1) * U(1, :)","key":"hdl3Mov5zO"},{"type":"output","id":"YoFzS7VT7OG77ULOw9Mrx","data":[{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"text/plain":{"content":"A_2 = 4×4 double\n         0    2.5000    0.5000   -2.0000\n         0   -2.5000    5.5000   -8.0000\n         0   16.2500    0.2500   -7.0000\n         0         0         0         0\n","content_type":"text/plain"},"text/html":{"content":"<html><body><pre>A_2 = 4×4 double\n         0    2.5000    0.5000   -2.0000\n         0   -2.5000    5.5000   -8.0000\n         0   16.2500    0.2500   -7.0000\n         0         0         0         0\n</pre></body></html>","content_type":"text/html"}}}],"key":"XW0qfctRmA"}],"key":"EReFKcGNDx"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Observe that ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"fuVBAuQAis"},{"type":"inlineMath","value":"\\mathbf{A}_2","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">A</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8361em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"QlIrMs3XYx"},{"type":"text","value":" has a new zero row and zero column, but the zero row is the fourth rather than the first. However, we forge on by using the largest possible pivot in column 2 for the next outer product.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"d23JXEU6Si"}],"key":"DACmxTbi5X"}],"key":"QdThviKANh"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"[~, i] = max( abs(A_2(:, 2)) )\nU(2, :) = A_2(i, :);\nL(:, 2) = A_2(:, 2) / U(2, 2);\nA_3 = A_2 - L(:, 2) * U(2, :)","key":"L3UuEZr9LJ"},{"type":"output","id":"LuXjASRdHGm8tWbLEKWZJ","data":[{"output_type":"execute_result","execution_count":5,"metadata":{},"data":{"text/plain":{"content":"i = 3","content_type":"text/plain"},"text/html":{"content":"<html><body><pre>i = 3</pre></body></html>","content_type":"text/html"}}},{"output_type":"execute_result","execution_count":5,"metadata":{},"data":{"text/plain":{"content":"A_3 = 4×4 double\n         0         0    0.4615   -0.9231\n         0         0    5.5385   -9.0769\n         0         0         0         0\n         0         0         0         0\n","content_type":"text/plain"},"text/html":{"content":"<html><body><pre>A_3 = 4×4 double\n         0         0    0.4615   -0.9231\n         0         0    5.5385   -9.0769\n         0         0         0         0\n         0         0         0         0\n</pre></body></html>","content_type":"text/html"}}}],"key":"d638X28LUs"}],"key":"jlMLJKut7J"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now we have zeroed out the third row as well as the second column. We can finish out the procedure.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"U1QKfCHbsd"}],"key":"HXyK1fXIS3"}],"key":"qYRy4xN6Ei"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"[~, i] = max( abs(A_3(:, 3)) ) \nU(3, :) = A_3(i, :);\nL(:, 3) = A_3(:, 3) / U(3, 3);\nA_4 = A_3 - L(:, 3) * U(3, :)","key":"LiFNy67Oov"},{"type":"output","id":"adu4rjN3zx-5W0HRRVayP","data":[{"output_type":"execute_result","execution_count":6,"metadata":{},"data":{"text/plain":{"content":"i = 2","content_type":"text/plain"},"text/html":{"content":"<html><body><pre>i = 2</pre></body></html>","content_type":"text/html"}}},{"output_type":"execute_result","execution_count":6,"metadata":{},"data":{"text/plain":{"content":"A_4 = 4×4 double\n         0         0         0   -0.1667\n         0         0         0         0\n         0         0         0         0\n         0         0         0         0\n","content_type":"text/plain"},"text/html":{"content":"<html><body><pre>A_4 = 4×4 double\n         0         0         0   -0.1667\n         0         0         0         0\n         0         0         0         0\n         0         0         0         0\n</pre></body></html>","content_type":"text/html"}}}],"key":"dxJ4hIX3Ut"}],"key":"itk5mIl9nm"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"[~, i] = max( abs(A_4(:, 4)) ) \nU(4, :) = A_4(i, :);\nL(:, 4) = A_4(:, 4) / U(4, 4);","key":"kdAIkLMtIT"},{"type":"output","id":"ttAR4q0qrBXYvprfad3jx","data":[{"output_type":"execute_result","execution_count":7,"metadata":{},"data":{"text/plain":{"content":"i = 1","content_type":"text/plain"},"text/html":{"content":"<html><body><pre>i = 1</pre></body></html>","content_type":"text/html"}}}],"key":"ythHN6eiVY"}],"key":"s6MX84bFJH"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We do have a factorization of the original matrix:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"FZHsKQHwN9"}],"key":"h36PHqlYfa"}],"key":"nrAjwcYXK3"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"A_1 - L * U","key":"T2lCM9YB9E"},{"type":"output","id":"1chCIKPLqHuReyqseg9Cq","data":[{"output_type":"execute_result","execution_count":8,"metadata":{},"data":{"text/plain":{"content":"ans = 4×4 double\n     0     0     0     0\n     0     0     0     0\n     0     0     0     0\n     0     0     0     0\n","content_type":"text/plain"},"text/html":{"content":"<html><body><pre>ans = 4×4 double\n     0     0     0     0\n     0     0     0     0\n     0     0     0     0\n     0     0     0     0\n</pre></body></html>","content_type":"text/html"}}}],"key":"fpm2ZiFH30"}],"key":"CHCAIyN16w"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"And ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cN3VVgpBBP"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"poruIUxCAQ"},{"type":"text","value":" has the required structure:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"em65LTBPOL"}],"key":"UrmKKgXVrN"}],"key":"Rr8ka4GW6x"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"U","key":"U6Bdm2RSjX"},{"type":"output","id":"RflQmdVH2OkR_vE9pkfq2","data":[{"output_type":"execute_result","execution_count":9,"metadata":{},"data":{"text/plain":{"content":"U = 4×4 double\n   -4.0000    5.0000   -7.0000  -10.0000\n         0   16.2500    0.2500   -7.0000\n         0         0    5.5385   -9.0769\n         0         0         0   -0.1667\n","content_type":"text/plain"},"text/html":{"content":"<html><body><pre>U = 4×4 double\n   -4.0000    5.0000   -7.0000  -10.0000\n         0   16.2500    0.2500   -7.0000\n         0         0    5.5385   -9.0769\n         0         0         0   -0.1667\n</pre></body></html>","content_type":"text/html"}}}],"key":"ckPfmnXSZ2"}],"key":"mKzQytQNMG"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"However, the triangularity of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PMw4WZ9rey"},{"type":"inlineMath","value":"\\mathbf{L}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">L</span></span></span></span>","key":"RkKK1C0KRh"},{"type":"text","value":" has been broken.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Dlzm0MMTeL"}],"key":"LCjEdVR4FV"}],"key":"eUZfEcoIjL"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"L","key":"W3k92iB9NA"},{"type":"output","id":"NdsAe1jlIYlMojV70Pzkl","data":[{"output_type":"execute_result","execution_count":10,"metadata":{},"data":{"text/plain":{"content":"L = 4×4 double\n   -0.5000    0.1538    0.0833    1.0000\n    0.5000   -0.1538    1.0000         0\n   -0.2500    1.0000         0         0\n    1.0000         0         0         0\n","content_type":"text/plain"},"text/html":{"content":"<html><body><pre>L = 4×4 double\n   -0.5000    0.1538    0.0833    1.0000\n    0.5000   -0.1538    1.0000         0\n   -0.2500    1.0000         0         0\n    1.0000         0         0         0\n</pre></body></html>","content_type":"text/html"}}}],"key":"V0iwFt1cNS"}],"key":"CaAEktSClF"}],"key":"QeQly8ZsMk"}],"key":"OtpwGHuCPB"}],"key":"nY0o20AOhX"},{"type":"tabItem","title":"Python","sync":"python","children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Row pivoting in LU factorization","position":{"start":{"line":83,"column":1},"end":{"line":83,"column":1}},"key":"bVscSGr6Ms"}],"key":"VLYOQIGRCG"},{"type":"include","file":"python/fix.ipynb","children":[{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:43:41.283307Z","iopub.status.busy":"2025-01-11T17:43:41.283182Z","iopub.status.idle":"2025-01-11T17:43:41.622058Z","shell.execute_reply":"2025-01-11T17:43:41.621657Z"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"exec(open(\"../../../python/FNC_init.py\").read())","visibility":"show","key":"vJ68sVKvxG"},{"type":"output","id":"IV1FgwbeU_rRvXfBxiXzn","data":[],"visibility":"show","key":"SAkK6FY6YC"}],"visibility":"remove","key":"vQhEn0P99W"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"rRc0M5Iv2h"},{"type":"text","value":"2.6.2","key":"XMgVAMz5eb"}],"key":"KXtWGIJL1U"}],"identifier":"demo-pivoting-fix","label":"demo-pivoting-fix","kind":"proof:example","template":"Example %s","enumerator":"2.6.2","resolved":true,"html_id":"demo-pivoting-fix","key":"CJ4rwFto4m"}],"key":"tn3H9ROR0N"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Here is the trouble-making matrix from ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"J7zDnJXe8o"},{"type":"crossReference","kind":"proof:example","identifier":"demo-pivoting-fail","label":"demo-pivoting-fail","children":[{"type":"text","value":"Demo ","key":"WT7K42rtH8"},{"type":"text","value":"2.6.1","key":"T5VAj1dzIj"}],"template":"Example %s","enumerator":"2.6.1","resolved":true,"html_id":"demo-pivoting-fail","key":"GXknsohR3t"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"uELy1WFV9C"}],"key":"zSZyCSoFN4"}],"key":"bEAbBaLR5O"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:43:41.624016Z","iopub.status.busy":"2025-01-11T17:43:41.623713Z","iopub.status.idle":"2025-01-11T17:43:41.625707Z","shell.execute_reply":"2025-01-11T17:43:41.625497Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"A_1 = array([\n    [2, 0, 4, 3],\n    [-2, 0, 2, -13],\n    [1, 15, 2, -4.5],\n    [-4, 5, -7, -10]\n    ])","key":"vY9pJxsYSm"},{"type":"output","id":"qs99KxfcLIwJTZ2ZhEksd","data":[],"key":"PnzzBANjj4"}],"key":"SWOkadazcb"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We now find the largest candidate pivot in the first column. We don’t care about sign, so we take absolute values before finding the max.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"VVdjDKjxdr"}],"key":"jO4yyFv5US"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"ljmnOuskxm"}],"key":"XAlMo58382"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"yVCjLoq2PA"},{"type":"inlineCode","value":"argmax","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"CqqA5kPmXZ"},{"type":"text","value":" function returns the location of the largest element of a vector or matrix.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"Ty0HMxcHk6"}],"key":"qw1128IOD1"}],"class":"dropdown","key":"Bl5RFQsEQP"}],"key":"j1lm29VblU"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:43:41.626845Z","iopub.status.busy":"2025-01-11T17:43:41.626746Z","iopub.status.idle":"2025-01-11T17:43:41.628569Z","shell.execute_reply":"2025-01-11T17:43:41.628339Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"i = argmax( abs(A_1[:, 0]) )\nprint(i)","key":"NR62YLAyFU"},{"type":"output","id":"3rYIc-qtDdXuERrLynElS","data":[{"name":"stdout","output_type":"stream","text":"3\n"}],"key":"ALIWIZB9zs"}],"key":"iGTQpDrV6n"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"This is the row of the matrix that we extract to put into ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"BXS7YqtWbN"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"gmc5FBTQtM"},{"type":"text","value":". That guarantees that the division used to find ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ZGfWVzZGNO"},{"type":"inlineMath","value":"\\boldsymbol{\\ell}_1","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">ℓ</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\boldsymbol{\\ell}_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">ℓ</span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"wzXdBEgttv"},{"type":"text","value":" will be valid.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pU7HPbFJyN"}],"key":"QgblfZCPis"}],"key":"Xdr9NW7i6X"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:43:41.629797Z","iopub.status.busy":"2025-01-11T17:43:41.629717Z","iopub.status.idle":"2025-01-11T17:43:41.631990Z","shell.execute_reply":"2025-01-11T17:43:41.631750Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"L, U = eye(4), zeros((4, 4))\nU[0, :] = A_1[i, :]\nL[:, 0] = A_1[:, 0] / U[0, 0]\nA_2 = A_1 - outer(L[:, 0], U[0, :])\nprint(A_2)","key":"ARI4CRD1HE"},{"type":"output","id":"7YPSb7m2_EHh88bxqEfNe","data":[{"name":"stdout","output_type":"stream","text":"[[ 0.    2.5   0.5  -2.  ]\n [ 0.   -2.5   5.5  -8.  ]\n [ 0.   16.25  0.25 -7.  ]\n [ 0.    0.    0.    0.  ]]\n"}],"key":"k5veYa22E5"}],"key":"kGsinPPVlY"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Observe that ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"eg7Aavw0yH"},{"type":"inlineMath","value":"\\mathbf{A}_2","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">A</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8361em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"VDOtoVlvxs"},{"type":"text","value":" has a new zero row and zero column, but the zero row is the fourth rather than the first. However, we forge on by using the largest possible pivot in column 2 for the next outer product.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RiukfLLxpR"}],"key":"XVOLVbUxq7"}],"key":"e5e2YA9kRA"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:43:41.633203Z","iopub.status.busy":"2025-01-11T17:43:41.633111Z","iopub.status.idle":"2025-01-11T17:43:41.635362Z","shell.execute_reply":"2025-01-11T17:43:41.635089Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"i = argmax( abs(A_2[:, 1]) ) \nprint(f\"new pivot row is {i}\")\nU[1, :] = A_2[i, :]\nL[:, 1] = A_2[:, 1] / U[1, 1]\nA_3 = A_2 - outer(L[:, 1], U[1, :])\nprint(A_3)","key":"kBv39BQesb"},{"type":"output","id":"0VaKADD16Ea2009c_6hj3","data":[{"name":"stdout","output_type":"stream","text":"new pivot row is 2\n[[ 0.          0.          0.46153846 -0.92307692]\n [ 0.          0.          5.53846154 -9.07692308]\n [ 0.          0.          0.          0.        ]\n [ 0.          0.          0.          0.        ]]\n"}],"key":"sjOj8SQvSJ"}],"key":"knn4H3WID7"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now we have zeroed out the third row as well as the second column. We can finish out the procedure.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"NpcB3372Wf"}],"key":"pOAwE6rrBj"}],"key":"rgGrLBAiYw"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:43:41.636463Z","iopub.status.busy":"2025-01-11T17:43:41.636368Z","iopub.status.idle":"2025-01-11T17:43:41.638488Z","shell.execute_reply":"2025-01-11T17:43:41.638224Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"i = argmax( abs(A_3[:, 2]) ) \nprint(f\"new pivot row is {i}\")\nU[2, :] = A_3[i, :]\nL[:, 2] = A_3[:, 2] / U[2, 2]\nA_4 = A_3 - outer(L[:, 2], U[2, :])\nprint(A_4)","key":"sCkN3AsWZz"},{"type":"output","id":"vpJBKmwWfS-Tqao7GUlIN","data":[{"name":"stdout","output_type":"stream","text":"new pivot row is 1\n[[ 0.          0.          0.         -0.16666667]\n [ 0.          0.          0.          0.        ]\n [ 0.          0.          0.          0.        ]\n [ 0.          0.          0.          0.        ]]\n"}],"key":"TODagplHz1"}],"key":"y32Mv7iQYG"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:43:41.640055Z","iopub.status.busy":"2025-01-11T17:43:41.639921Z","iopub.status.idle":"2025-01-11T17:43:41.641839Z","shell.execute_reply":"2025-01-11T17:43:41.641604Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"i = argmax( abs(A_4[:, 3]) ) \nprint(f\"new pivot row is {i}\")\nU[3, :] = A_4[i, :]\nL[:, 3] = A_4[:, 3] / U[3, 3];","key":"Tpmg8Y2jel"},{"type":"output","id":"x-MgwH-RNOdwLGxfBvso-","data":[{"name":"stdout","output_type":"stream","text":"new pivot row is 0\n"}],"key":"P1wxP1jrJK"}],"key":"sPpgfk9maT"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We do have a factorization of the original matrix:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bVx09BFRpm"}],"key":"C9BigHFF7n"}],"key":"uMeSF2jqQe"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:43:41.643036Z","iopub.status.busy":"2025-01-11T17:43:41.642935Z","iopub.status.idle":"2025-01-11T17:43:41.645923Z","shell.execute_reply":"2025-01-11T17:43:41.645690Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"A_1 - L @ U","key":"u49AxnbI5s"},{"type":"output","id":"y3We8915OyAVvPnBxw9GV","data":[{"output_type":"execute_result","execution_count":8,"metadata":{},"data":{"text/plain":{"content":"array([[0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00],\n       [0.00000000e+00, 0.00000000e+00, 2.22044605e-16, 0.00000000e+00],\n       [0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00],\n       [0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00]])","content_type":"text/plain"}}}],"key":"yGEm46OuVZ"}],"key":"zAn9XZdAZp"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"And ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MXjiD957ok"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"Xl1zfY9ft2"},{"type":"text","value":" has the required structure:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"iOT01sxUUP"}],"key":"oIxBA63pDi"}],"key":"fH559DauOr"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:43:41.647049Z","iopub.status.busy":"2025-01-11T17:43:41.646962Z","iopub.status.idle":"2025-01-11T17:43:41.648864Z","shell.execute_reply":"2025-01-11T17:43:41.648638Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"print(U)","key":"DPqLioHVk6"},{"type":"output","id":"4ZrWoND0TMnZpc-g-BrMA","data":[{"name":"stdout","output_type":"stream","text":"[[ -4.           5.          -7.         -10.        ]\n [  0.          16.25         0.25        -7.        ]\n [  0.           0.           5.53846154  -9.07692308]\n [  0.           0.           0.          -0.16666667]]\n"}],"key":"gHn5wFRDpl"}],"key":"kZRQWYwwKX"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"However, the triangularity of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"SoPBHNxZg5"},{"type":"inlineMath","value":"\\mathbf{L}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">L</span></span></span></span>","key":"H4xLAxPwsF"},{"type":"text","value":" has been broken.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"waZrriBltL"}],"key":"zpOXDHzrze"}],"key":"BzrIwEiA2H"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:43:41.649921Z","iopub.status.busy":"2025-01-11T17:43:41.649850Z","iopub.status.idle":"2025-01-11T17:43:41.651628Z","shell.execute_reply":"2025-01-11T17:43:41.651406Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"print(L)","key":"nOJ5Fp9LeF"},{"type":"output","id":"Wd_6R7lUyC-5xMh9-mTUr","data":[{"name":"stdout","output_type":"stream","text":"[[-0.5         0.15384615  0.08333333  1.        ]\n [ 0.5        -0.15384615  1.         -0.        ]\n [-0.25        1.          0.         -0.        ]\n [ 1.          0.          0.         -0.        ]]\n"}],"key":"DFMr1u25KV"}],"key":"YphND6l4Zz"}],"key":"RgotIKQrdA"}],"key":"gqPJE9Jdfl"}],"key":"ce93e4dHpn"}],"key":"NBunyQueJS"}],"label":"demo-pivoting-fix","identifier":"demo-pivoting-fix","html_id":"demo-pivoting-fix","enumerator":"2.6.2","key":"t0ZfuwSdh3"},{"type":"paragraph","position":{"start":{"line":93,"column":1},"end":{"line":93,"column":1}},"children":[{"type":"text","value":"We will return to the loss of triangularity in ","position":{"start":{"line":93,"column":1},"end":{"line":93,"column":1}},"key":"SawigJCWOi"},{"type":"inlineMath","value":"\\mathbf{L}","position":{"start":{"line":93,"column":1},"end":{"line":93,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">L</span></span></span></span>","key":"kd6sPdDzui"},{"type":"text","value":" momentarily. First, though, there is a question left to answer: what if at some stage, all the elements of the targeted column are zero, i.e., there are no available pivots? Fortunately that loose end ties up nicely, although a proof is a bit beyond our scope here.","position":{"start":{"line":93,"column":1},"end":{"line":93,"column":1}},"key":"CowfjmOB31"}],"key":"UHVTfWoAbX"},{"type":"proof","kind":"theorem","enumerated":true,"children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Row pivoting","position":{"start":{"line":96,"column":1},"end":{"line":96,"column":1}},"key":"cW0CrG77t7"}],"key":"zJx9JXGBbP"},{"type":"paragraph","position":{"start":{"line":97,"column":1},"end":{"line":97,"column":1}},"children":[{"type":"text","value":"The row-pivoted LU factorization runs to completion if and only if the original matrix is invertible.","position":{"start":{"line":97,"column":1},"end":{"line":97,"column":1}},"key":"E3gMzAmzAB"}],"key":"jg5ijVFTS3"}],"label":"theorem-pivot","identifier":"theorem-pivot","html_id":"theorem-pivot","enumerator":"2.6.1","key":"moy5x1WPad"},{"type":"paragraph","position":{"start":{"line":100,"column":1},"end":{"line":100,"column":1}},"children":[{"type":"text","value":"A linear system with a singular matrix has either no solution or infinitely many solutions. Either way, a technique other than LU factorization is needed to handle it.","position":{"start":{"line":100,"column":1},"end":{"line":100,"column":1}},"key":"k1A9aan8KE"}],"key":"pBhFMhLhSk"},{"type":"heading","depth":2,"position":{"start":{"line":102,"column":1},"end":{"line":102,"column":1}},"children":[{"type":"text","value":"Permutations","position":{"start":{"line":102,"column":1},"end":{"line":102,"column":1}},"key":"HaQoe5kfcB"}],"identifier":"permutations","label":"Permutations","html_id":"permutations","implicit":true,"enumerator":"2.6.2","key":"zooMFN2wUZ"},{"type":"paragraph","position":{"start":{"line":104,"column":1},"end":{"line":104,"column":1}},"children":[{"type":"text","value":"Even though the resulting ","position":{"start":{"line":104,"column":1},"end":{"line":104,"column":1}},"key":"WhoqpxKcKs"},{"type":"inlineMath","value":"\\mathbf{L}","position":{"start":{"line":104,"column":1},"end":{"line":104,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">L</span></span></span></span>","key":"LDbF7IDDQn"},{"type":"text","value":" in ","position":{"start":{"line":104,"column":1},"end":{"line":104,"column":1}},"key":"HO2X1lCpfn"},{"type":"crossReference","kind":"proof:example","identifier":"demo-pivoting-fix","label":"demo-pivoting-fix","children":[{"type":"text","value":"Demo ","key":"FljfHF59lr"},{"type":"text","value":"2.6.2","key":"wgl2JzptaU"}],"template":"Example %s","enumerator":"2.6.2","resolved":true,"html_id":"demo-pivoting-fix","key":"aU27K79Gdc"},{"type":"text","value":" is no longer of unit lower triangular form, it is close. In fact, all that is needed is to reverse the order of its rows.","position":{"start":{"line":104,"column":1},"end":{"line":104,"column":1}},"key":"kBO6wLrpdx"}],"key":"yLjLvJMVax"},{"type":"proof","kind":"example","enumerated":true,"children":[{"type":"tabSet","children":[{"type":"tabItem","title":"Julia","sync":"julia","children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Pivoting as row permutation","position":{"start":{"line":111,"column":1},"end":{"line":111,"column":1}},"key":"IVwNwDvUTM"}],"key":"osPYEpAnAN"},{"type":"include","file":"julia/permute.ipynb","children":[{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-05T09:33:51.318000Z","iopub.status.busy":"2025-01-05T09:33:51.033000Z","iopub.status.idle":"2025-01-05T09:33:58.371000Z","shell.execute_reply":"2025-01-05T09:33:58.327000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"include(\"../../../julia/FNC_init.jl\")","key":"uwlxgscIkw"},{"type":"output","id":"VKmk20V_Q-Y6Hr69y50yE","data":[{"name":"stderr","output_type":"stream","text":"\u001b[32m\u001b[1m  Activating\u001b[22m\u001b[39m "},{"name":"stderr","output_type":"stream","text":"project at `~/Documents/GitHub/fnc`\n"}],"key":"dUhotXluTW"}],"key":"hebrH046o2"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"Iau5pdWcJk"},{"type":"text","value":"2.6.3","key":"m1SIYEj0lC"}],"key":"p6OCG8q4GR"}],"identifier":"demo-pivoting-permute","label":"demo-pivoting-permute","kind":"proof:example","template":"Example %s","enumerator":"2.6.3","resolved":true,"html_id":"demo-pivoting-permute","key":"fcpM7l9TLl"}],"key":"mFSUKobmzH"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Here again is the matrix from ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"D9ATnKZ6GU"},{"type":"crossReference","kind":"proof:example","identifier":"demo-pivoting-fix","label":"demo-pivoting-fix","children":[{"type":"text","value":"Demo ","key":"Pf3erh1Hgv"},{"type":"text","value":"2.6.2","key":"jyiWuGzqe6"}],"template":"Example %s","enumerator":"2.6.2","resolved":true,"html_id":"demo-pivoting-fix","key":"tNlqIrqjlJ"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"EIefZ5nIoe"}],"key":"hFd1jrnVnJ"}],"key":"LyHvcCU4GZ"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-05T09:33:58.512000Z","iopub.status.busy":"2025-01-05T09:33:58.373000Z","iopub.status.idle":"2025-01-05T09:34:00.000000Z","shell.execute_reply":"2025-01-05T09:34:00.000000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"A = [2 0 4 3 ; -2 0 2 -13; 1 15 2 -4.5 ; -4 5 -7 -10]","key":"kBDof79gYF"},{"type":"output","id":"MSwTLHLeIoPwdctVIlZUx","data":[{"output_type":"execute_result","execution_count":2,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n  2.0   0.0   4.0    3.0\n -2.0   0.0   2.0  -13.0\n  1.0  15.0   2.0   -4.5\n -4.0   5.0  -7.0  -10.0","content_type":"text/plain"}}}],"key":"wdq79rxgHR"}],"key":"PZFdj9H0j1"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"As the factorization proceeded, the pivots were selected from rows 4, 3, 2, and finally 1. If we were to put the rows of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"inIqdBx8w8"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"Tllcm7FVRx"},{"type":"text","value":" into that order, then the algorithm would run exactly like the plain LU factorization from ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rTqJGBzjR8"},{"type":"link","kind":"numref","identifier":"section-linsys-lu","label":"section-linsys-lu","url":"/lu","internal":true,"dataUrl":"/lu.json","children":[{"type":"text","value":"LU factorization","key":"Z891QcdcmW"}],"key":"oHTYhm8Uxw"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YFeie5wBD6"}],"key":"kgN1gKTqrC"}],"key":"VkQLitJRJd"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-05T09:34:00.002000Z","iopub.status.busy":"2025-01-05T09:34:00.002000Z","iopub.status.idle":"2025-01-05T09:34:00.093000Z","shell.execute_reply":"2025-01-05T09:34:00.093000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"B = A[[4, 3, 2, 1], :]\nL, U = FNC.lufact(B);","key":"Vws2YjW9yW"},{"type":"output","id":"a2tOcWFYagfMGTSsl4Hj9","data":[],"key":"yLuSoygF8G"}],"key":"tlnnwC1sjR"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We obtain the same ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nT2AKzi2Re"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"Kg8JB7BE8M"},{"type":"text","value":" as before:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"swNZBoVjdw"}],"key":"g4T3ySxFMh"}],"key":"xwLoN4TNP4"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-05T09:34:00.095000Z","iopub.status.busy":"2025-01-05T09:34:00.095000Z","iopub.status.idle":"2025-01-05T09:34:00.267000Z","shell.execute_reply":"2025-01-05T09:34:00.263000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"U","key":"cutYcOXAUo"},{"type":"output","id":"7ooTC4FXZgKVC-ObXY1JT","data":[{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"text/plain":{"content":"4×4 UpperTriangular{Float64, Matrix{Float64}}:\n -4.0   5.0   -7.0      -10.0\n   ⋅   16.25   0.25      -7.0\n   ⋅     ⋅     5.53846   -9.07692\n   ⋅     ⋅      ⋅        -0.166667","content_type":"text/plain"}}}],"key":"aqCIQuYRn3"}],"key":"zbGhB1pvjz"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"And ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JJJzp9vxhk"},{"type":"inlineMath","value":"\\mathbf{L}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">L</span></span></span></span>","key":"TmuUIazxtL"},{"type":"text","value":" has the same rows as before, but arranged into triangular order:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PbJMGaLZku"}],"key":"QjreKKViVP"}],"key":"oh5hUfdnqQ"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-05T09:34:00.269000Z","iopub.status.busy":"2025-01-05T09:34:00.269000Z","iopub.status.idle":"2025-01-05T09:34:00.423000Z","shell.execute_reply":"2025-01-05T09:34:00.423000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"L","key":"dbs2WS8Pwu"},{"type":"output","id":"n_QeviPvkt5XfyVpX56ny","data":[{"output_type":"execute_result","execution_count":5,"metadata":{},"data":{"text/plain":{"content":"4×4 LowerTriangular{Float64, Matrix{Float64}}:\n  1.0     ⋅         ⋅          ⋅ \n -0.25   1.0        ⋅          ⋅ \n  0.5   -0.153846  1.0         ⋅ \n -0.5    0.153846  0.0833333  1.0","content_type":"text/plain"}}}],"key":"u1dMqOV28g"}],"key":"hCHDNURRmz"}],"key":"DfEGhBaQuN"}],"key":"kU39K1OYVI"}],"key":"sorvDzjZ1e"},{"type":"tabItem","title":"MATLAB","sync":"matlab","children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Pivoting as row permutation","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"key":"UXzE3RMJ5s"}],"key":"R445rAWGIJ"},{"type":"include","file":"matlab/permute.ipynb","children":[{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"Lm7pF5CRev"},{"type":"text","value":"2.6.3","key":"kydvWKyWp4"}],"key":"KDNMsCdlVw"}],"identifier":"demo-pivoting-permute","label":"demo-pivoting-permute","kind":"proof:example","template":"Example %s","enumerator":"2.6.3","resolved":true,"html_id":"demo-pivoting-permute","key":"l3TLQH4lqC"}],"key":"qRTZ3M2aEh"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Here again is the matrix from ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"X6dmh2dUJs"},{"type":"crossReference","kind":"proof:example","identifier":"demo-pivoting-fix","label":"demo-pivoting-fix","children":[{"type":"text","value":"Demo ","key":"c9aNPXgNpa"},{"type":"text","value":"2.6.2","key":"X9waE5hb5P"}],"template":"Example %s","enumerator":"2.6.2","resolved":true,"html_id":"demo-pivoting-fix","key":"Gk4uaVZz3C"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"caDJQj0Szj"}],"key":"kxjJbqc0kw"}],"key":"kcxjMx8mCw"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"A = [2 0 4 3; -2 0 2 -13; 1 15 2 -4.5; -4 5 -7 -10]","key":"fiVgSIcd9H"},{"type":"output","id":"ngYhm6UyTcVSuzKZ1ozPP","data":[{"output_type":"execute_result","execution_count":2,"metadata":{},"data":{"text/plain":{"content":"A = 4×4 double\n    2.0000         0    4.0000    3.0000\n   -2.0000         0    2.0000  -13.0000\n    1.0000   15.0000    2.0000   -4.5000\n   -4.0000    5.0000   -7.0000  -10.0000\n","content_type":"text/plain"},"text/html":{"content":"<html><body><pre>A = 4×4 double\n    2.0000         0    4.0000    3.0000\n   -2.0000         0    2.0000  -13.0000\n    1.0000   15.0000    2.0000   -4.5000\n   -4.0000    5.0000   -7.0000  -10.0000\n</pre></body></html>","content_type":"text/html"}}}],"key":"EUL5Lt89g8"}],"key":"IA8D8j7DXr"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"As the factorization proceeded, the pivots were selected from rows 4, 3, 2, and finally 1. If we were to put the rows of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TbFmNJwSdX"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"EtIJjEezO8"},{"type":"text","value":" into that order, then the algorithm would run exactly like the plain LU factorization from ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"FcsBHBNapi"},{"type":"link","kind":"numref","identifier":"section-linsys-lu","label":"section-linsys-lu","url":"/lu","internal":true,"dataUrl":"/lu.json","children":[{"type":"text","value":"LU factorization","key":"oJsEILoMEB"}],"key":"HqTebhvS1h"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ZKFILK184G"}],"key":"tQuQT0vjD9"}],"key":"og8yDmifk1"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"B = A([4, 3, 2, 1], :);\n[L, U] = lufact(B);","key":"bsKaQ0Aena"},{"type":"output","id":"ZoVaDbA_XnQEUVwTCRCg2","data":[],"key":"F2L6DjQt0V"}],"key":"i2ooZn18QL"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We obtain the same ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"a7dLYhZZKd"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"NyZy9ECNaH"},{"type":"text","value":" as before:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OYyg3sDCI1"}],"key":"YjVYPV6XjW"}],"key":"xocOoKZS5K"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"U","key":"pUnbjNEymv"},{"type":"output","id":"1AKMYi5o62TQ1wE4uLSMh","data":[{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"text/plain":{"content":"U = 4×4 double\n   -4.0000    5.0000   -7.0000  -10.0000\n         0   16.2500    0.2500   -7.0000\n         0         0    5.5385   -9.0769\n         0         0         0   -0.1667\n","content_type":"text/plain"},"text/html":{"content":"<html><body><pre>U = 4×4 double\n   -4.0000    5.0000   -7.0000  -10.0000\n         0   16.2500    0.2500   -7.0000\n         0         0    5.5385   -9.0769\n         0         0         0   -0.1667\n</pre></body></html>","content_type":"text/html"}}}],"key":"XJsQ1j7wdE"}],"key":"w2byrIHZZd"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"And ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WBIbtDbucd"},{"type":"inlineMath","value":"\\mathbf{L}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">L</span></span></span></span>","key":"SGPlTKs0AW"},{"type":"text","value":" has the same rows as before, but arranged into triangular order:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pO23KTMzR9"}],"key":"HiHLrUP1vD"}],"key":"MGYmmNNzj8"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"L","key":"jZV3ihXHng"},{"type":"output","id":"-hlKB4h94FRWH7z7KbqMS","data":[{"output_type":"execute_result","execution_count":5,"metadata":{},"data":{"text/plain":{"content":"L = 4×4 double\n    1.0000         0         0         0\n   -0.2500    1.0000         0         0\n    0.5000   -0.1538    1.0000         0\n   -0.5000    0.1538    0.0833    1.0000\n","content_type":"text/plain"},"text/html":{"content":"<html><body><pre>L = 4×4 double\n    1.0000         0         0         0\n   -0.2500    1.0000         0         0\n    0.5000   -0.1538    1.0000         0\n   -0.5000    0.1538    0.0833    1.0000\n</pre></body></html>","content_type":"text/html"}}}],"key":"OX6epEQhYw"}],"key":"kHBe2xShYp"}],"key":"NsKY9zPbUX"}],"key":"NxUytTdF8k"}],"key":"bmKqq0Ggf2"},{"type":"tabItem","title":"Python","sync":"python","children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Pivoting as row permutation","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"key":"ZJMYvcvV8k"}],"key":"s4foPHCYdX"},{"type":"include","file":"python/permute.ipynb","children":[{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:43:42.616599Z","iopub.status.busy":"2025-01-11T17:43:42.616135Z","iopub.status.idle":"2025-01-11T17:43:42.934508Z","shell.execute_reply":"2025-01-11T17:43:42.934144Z"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"exec(open(\"../../../python/FNC_init.py\").read())","visibility":"show","key":"ZfDDLRlWqo"},{"type":"output","id":"L9m7OGTUsoHy-rpWs7PbP","data":[],"visibility":"show","key":"mghMpiP0uJ"}],"visibility":"remove","key":"wQxOq4slHn"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"nhEQp9OFR7"},{"type":"text","value":"2.6.3","key":"jKlLHezGl5"}],"key":"uR93KqWWba"}],"identifier":"demo-pivoting-permute","label":"demo-pivoting-permute","kind":"proof:example","template":"Example %s","enumerator":"2.6.3","resolved":true,"html_id":"demo-pivoting-permute","key":"QV2LkFzcq1"}],"key":"HfKLYFjnZ0"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Here again is the matrix from ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"aZ8sYtWeDr"},{"type":"crossReference","kind":"proof:example","identifier":"demo-pivoting-fix","label":"demo-pivoting-fix","children":[{"type":"text","value":"Demo ","key":"Upo89RC4la"},{"type":"text","value":"2.6.2","key":"dFY6SwapI5"}],"template":"Example %s","enumerator":"2.6.2","resolved":true,"html_id":"demo-pivoting-fix","key":"tdyFB48ZAv"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"dSSXzy2CeJ"}],"key":"zFaS2dLUSD"}],"key":"BGN8qV6vjg"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:43:42.936157Z","iopub.status.busy":"2025-01-11T17:43:42.936030Z","iopub.status.idle":"2025-01-11T17:43:42.937878Z","shell.execute_reply":"2025-01-11T17:43:42.937636Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"A = array([\n    [2, 0, 4, 3],\n    [-2, 0, 2, -13],\n    [1, 15, 2, -4.5],\n    [-4, 5, -7, -10]\n    ])","key":"CsLeS1DFeO"},{"type":"output","id":"RQ20qF5FGN_lX7m3ax7Zk","data":[],"key":"vHaAbExLf2"}],"key":"HLkS2FmGt9"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"As the factorization proceeded, the pivots were selected from rows 4, 3, 2, and finally 1 (with NumPy indices being one less). If we were to put the rows of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GSe0lnJKMm"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"RzQEiBy0o8"},{"type":"text","value":" into that order, then the algorithm would run exactly like the plain LU factorization from ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"j9e6JcITjC"},{"type":"link","kind":"numref","identifier":"section-linsys-lu","label":"section-linsys-lu","url":"/lu","internal":true,"dataUrl":"/lu.json","children":[{"type":"text","value":"LU factorization","key":"GUzXcR5lMl"}],"key":"uC75TQjTkb"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"L3IdcJpPqZ"}],"key":"gh1AvwjWIu"}],"key":"R8jS4Gs6kv"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:43:42.939204Z","iopub.status.busy":"2025-01-11T17:43:42.939105Z","iopub.status.idle":"2025-01-11T17:43:42.940952Z","shell.execute_reply":"2025-01-11T17:43:42.940698Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"B = A[[3, 2, 1, 0], :]\nL, U = FNC.lufact(B);","key":"gan5hPELfN"},{"type":"output","id":"6XMKRT8CB0q6Im3HSiKOh","data":[],"key":"hOJIlJksY8"}],"key":"ZRwGE7Aq3N"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We obtain the same ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MxTOz93gq8"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"MeDdprIrYe"},{"type":"text","value":" as before:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"BF5LvEiqpa"}],"key":"RrKZlqUcz0"}],"key":"isbkd73Wfo"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:43:42.942107Z","iopub.status.busy":"2025-01-11T17:43:42.941991Z","iopub.status.idle":"2025-01-11T17:43:42.943731Z","shell.execute_reply":"2025-01-11T17:43:42.943513Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"print(U)","key":"H5Y44SRkXf"},{"type":"output","id":"SCgspj3GT86r-rf6tNloT","data":[{"name":"stdout","output_type":"stream","text":"[[ -4.           5.          -7.         -10.        ]\n [  0.          16.25         0.25        -7.        ]\n [  0.           0.           5.53846154  -9.07692308]\n [  0.           0.           0.          -0.16666667]]\n"}],"key":"r6q96gaejm"}],"key":"gYgfOhAlJu"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"And ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Rs7h4pmPD6"},{"type":"inlineMath","value":"\\mathbf{L}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">L</span></span></span></span>","key":"bOmpRsN4qE"},{"type":"text","value":" has the same rows as before, but arranged into triangular order:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"uouW8iOL17"}],"key":"MC2Y0dnFga"}],"key":"eYjsYpVZ8L"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:43:42.945206Z","iopub.status.busy":"2025-01-11T17:43:42.945118Z","iopub.status.idle":"2025-01-11T17:43:42.947009Z","shell.execute_reply":"2025-01-11T17:43:42.946769Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"print(L)","key":"L5qu2F9DZe"},{"type":"output","id":"Q58LV0gnCVzB2AIPp1iTN","data":[{"name":"stdout","output_type":"stream","text":"[[ 1.          0.          0.          0.        ]\n [-0.25        1.          0.          0.        ]\n [ 0.5        -0.15384615  1.          0.        ]\n [-0.5         0.15384615  0.08333333  1.        ]]\n"}],"key":"b162KaEQJz"}],"key":"LTqMjcCVTs"}],"key":"oTsolikvSd"}],"key":"r7O2dq0fHw"}],"key":"iWVIaVDW8S"}],"key":"ahDKiQPseQ"}],"label":"demo-pivoting-permute","identifier":"demo-pivoting-permute","html_id":"demo-pivoting-permute","enumerator":"2.6.3","key":"qXLSYkgnff"},{"type":"paragraph","position":{"start":{"line":140,"column":1},"end":{"line":140,"column":1}},"children":[{"type":"text","value":"In principle, if the permutation of rows implied by the pivot locations is applied all at once to the original ","position":{"start":{"line":140,"column":1},"end":{"line":140,"column":1}},"key":"GnkZ3AOTsv"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":140,"column":1},"end":{"line":140,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"DFTrDgAjBb"},{"type":"text","value":", no further pivoting is needed. In practice, this permutation cannot be determined immediately from the original ","position":{"start":{"line":140,"column":1},"end":{"line":140,"column":1}},"key":"yjn1wItdCX"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":140,"column":1},"end":{"line":140,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"U05CyW6KkM"},{"type":"text","value":"; the only way to find it is to run the algorithm. Having obtained it at the end, though, we can use it to state a simple relationship.","position":{"start":{"line":140,"column":1},"end":{"line":140,"column":1}},"key":"epAl7JACB1"}],"key":"ZYZbQ2SmJn"},{"type":"proof","kind":"definition","enumerated":true,"children":[{"type":"admonitionTitle","children":[{"type":"text","value":"PLU factorization","position":{"start":{"line":145,"column":1},"end":{"line":145,"column":1}},"key":"xal1BjRJP3"}],"key":"GSfx5RC6iP"},{"type":"paragraph","position":{"start":{"line":146,"column":1},"end":{"line":146,"column":1}},"children":[{"type":"text","value":"Given ","position":{"start":{"line":146,"column":1},"end":{"line":146,"column":1}},"key":"Iax5qOnJzG"},{"type":"inlineMath","value":"n\\times n","position":{"start":{"line":146,"column":1},"end":{"line":146,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>×</mo><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n\\times n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"fFTUL4eRzj"},{"type":"text","value":" matrix ","position":{"start":{"line":146,"column":1},"end":{"line":146,"column":1}},"key":"AJWn5dllaT"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":146,"column":1},"end":{"line":146,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"FZtoQj45NU"},{"type":"text","value":", the ","position":{"start":{"line":146,"column":1},"end":{"line":146,"column":1}},"key":"iGW0PgPnvy"},{"type":"strong","position":{"start":{"line":146,"column":1},"end":{"line":146,"column":1}},"children":[{"type":"text","value":"PLU factorization","position":{"start":{"line":146,"column":1},"end":{"line":146,"column":1}},"key":"PIzMwvqhh4"}],"key":"LdXRcBeTLy"},{"type":"text","value":" is a unit lower triangular ","position":{"start":{"line":146,"column":1},"end":{"line":146,"column":1}},"key":"eIec2lnkZk"},{"type":"inlineMath","value":"\\mathbf{L}","position":{"start":{"line":146,"column":1},"end":{"line":146,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">L</span></span></span></span>","key":"SovxPv6tu7"},{"type":"text","value":", an upper triangular ","position":{"start":{"line":146,"column":1},"end":{"line":146,"column":1}},"key":"YAmxqFjwUM"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":146,"column":1},"end":{"line":146,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"Lly0exPEG4"},{"type":"text","value":", and a permutation ","position":{"start":{"line":146,"column":1},"end":{"line":146,"column":1}},"key":"To25UmiemN"},{"type":"inlineMath","value":"i_1,\\ldots,i_n","position":{"start":{"line":146,"column":1},"end":{"line":146,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>i</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><mo>…</mo><mo separator=\"true\">,</mo><msub><mi>i</mi><mi>n</mi></msub></mrow><annotation encoding=\"application/x-tex\">i_1,\\ldots,i_n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"loPcr4xr0U"},{"type":"text","value":" of the integers ","position":{"start":{"line":146,"column":1},"end":{"line":146,"column":1}},"key":"S6baFk2z0M"},{"type":"inlineMath","value":"1,\\ldots,n","position":{"start":{"line":146,"column":1},"end":{"line":146,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mo separator=\"true\">,</mo><mo>…</mo><mo separator=\"true\">,</mo><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">1,\\ldots,n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8389em;vertical-align:-0.1944em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"cJDh9dPcTR"},{"type":"text","value":", such that","position":{"start":{"line":146,"column":1},"end":{"line":146,"column":1}},"key":"zAmTLcjEkP"}],"key":"u5FeQiCtWY"},{"type":"math","value":"\\tilde{\\mathbf{A}} = \\mathbf{L}\\mathbf{U},","position":{"start":{"line":148,"column":1},"end":{"line":148,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mover accent=\"true\"><mi mathvariant=\"bold\">A</mi><mo>~</mo></mover><mo>=</mo><mi mathvariant=\"bold\">L</mi><mi mathvariant=\"bold\">U</mi><mo separator=\"true\">,</mo></mrow><annotation encoding=\"application/x-tex\">\\tilde{\\mathbf{A}} = \\mathbf{L}\\mathbf{U},</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.923em;\"></span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.923em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathbf\">A</span></span><span style=\"top:-3.6051em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.1111em;\"><span class=\"mord\">~</span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8805em;vertical-align:-0.1944em;\"></span><span class=\"mord mathbf\">LU</span><span class=\"mpunct\">,</span></span></span></span></span>","enumerator":"2.6.1","key":"tmqIIsChV3"},{"type":"paragraph","position":{"start":{"line":150,"column":1},"end":{"line":150,"column":1}},"children":[{"type":"text","value":"where rows ","position":{"start":{"line":150,"column":1},"end":{"line":150,"column":1}},"key":"eRX5zbd4DN"},{"type":"inlineMath","value":"1,\\ldots,n","position":{"start":{"line":150,"column":1},"end":{"line":150,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mo separator=\"true\">,</mo><mo>…</mo><mo separator=\"true\">,</mo><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">1,\\ldots,n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8389em;vertical-align:-0.1944em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"sGPbq7zBOm"},{"type":"text","value":" of ","position":{"start":{"line":150,"column":1},"end":{"line":150,"column":1}},"key":"Dx17l8VWZZ"},{"type":"inlineMath","value":"\\tilde{\\mathbf{A}}","position":{"start":{"line":150,"column":1},"end":{"line":150,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mover accent=\"true\"><mi mathvariant=\"bold\">A</mi><mo>~</mo></mover></mrow><annotation encoding=\"application/x-tex\">\\tilde{\\mathbf{A}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.923em;\"></span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.923em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathbf\">A</span></span><span style=\"top:-3.6051em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.1111em;\"><span class=\"mord\">~</span></span></span></span></span></span></span></span></span></span>","key":"YIYj6Clk6T"},{"type":"text","value":" are rows ","position":{"start":{"line":150,"column":1},"end":{"line":150,"column":1}},"key":"b44Ti4jcAk"},{"type":"inlineMath","value":"i_1,\\ldots,i_n","position":{"start":{"line":150,"column":1},"end":{"line":150,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>i</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><mo>…</mo><mo separator=\"true\">,</mo><msub><mi>i</mi><mi>n</mi></msub></mrow><annotation encoding=\"application/x-tex\">i_1,\\ldots,i_n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"zluiSqKT0i"},{"type":"text","value":" of ","position":{"start":{"line":150,"column":1},"end":{"line":150,"column":1}},"key":"YEIix1P9Oj"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":150,"column":1},"end":{"line":150,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"KPSWV2N5HU"},{"type":"text","value":".","position":{"start":{"line":150,"column":1},"end":{"line":150,"column":1}},"key":"EtYTDzktdD"}],"key":"NbRXzUZMoO"}],"indexEntries":[{"entry":"matrix factorization","subEntry":{"value":"pivoted LU","kind":"entry"},"emphasis":true},{"entry":"PLU factorization","emphasis":true}],"label":"index-bn3ySjPSTk","identifier":"index-bn3ysjpstk","html_id":"index-bn3ysjpstk","enumerator":"2.6.1","key":"BtKXJRM5BE"},{"type":"paragraph","position":{"start":{"line":153,"column":1},"end":{"line":153,"column":1}},"children":[{"type":"crossReference","kind":"proof:algorithm","identifier":"function-plufact","label":"function-plufact","children":[{"type":"text","value":"Function ","key":"ywKYzDfUXa"},{"type":"text","value":"2.6.2","key":"j9Miegsgg0"}],"template":"Algorithm %s","enumerator":"2.6.2","resolved":true,"html_id":"function-plufact","key":"AGflR8himo"},{"type":"text","value":" shows our implementation of PLU factorization.","position":{"start":{"line":153,"column":1},"end":{"line":153,"column":1}},"key":"Swl4UPnSEv"},{"type":"footnoteReference","identifier":"plu","label":"PLU","position":{"start":{"line":153,"column":1},"end":{"line":153,"column":1}},"number":1,"enumerator":"1","key":"Am4S5xqJs5"}],"key":"EyEYbJR17m"},{"type":"proof","kind":"algorithm","enumerated":true,"children":[{"type":"admonitionTitle","children":[{"type":"text","value":"plufact","position":{"start":{"line":158,"column":1},"end":{"line":158,"column":1}},"key":"hlS7mjz7wZ"}],"key":"p4qABiR0gV"},{"type":"tabSet","children":[{"type":"tabItem","title":"Julia","sync":"julia","children":[{"type":"embed","source":{"label":"function-plufact-julia"},"key":"DLCffgo0AV"}],"key":"bDUH9U20Nf"},{"type":"tabItem","title":"MATLAB","sync":"matlab","children":[{"type":"embed","source":{"label":"function-plufact-julia"},"key":"gYS1qywqUz"}],"key":"yFJKKMKHYA"},{"type":"tabItem","title":"Python","sync":"python","children":[{"type":"embed","source":{"label":"function-plufact-python"},"key":"zEQ4FH4V2n"}],"key":"ivxwCfT2bL"}],"key":"qKdmAeF78U"}],"label":"function-plufact","identifier":"function-plufact","html_id":"function-plufact","enumerator":"2.6.2","key":"vs6Ip8YLbr"},{"type":"paragraph","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"children":[{"type":"text","value":"Ideally, the PLU factorization takes ","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"key":"VYy0sfSxBY"},{"type":"inlineMath","value":"\\sim \\frac{2}{3}n^3","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>∼</mo><mfrac><mn>2</mn><mn>3</mn></mfrac><msup><mi>n</mi><mn>3</mn></msup></mrow><annotation encoding=\"application/x-tex\">\\sim \\frac{2}{3}n^3</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.3669em;\"></span><span class=\"mrel\">∼</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1901em;vertical-align:-0.345em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8451em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">3</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mord\"><span class=\"mord mathnormal\">n</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span></span></span></span></span></span></span></span>","key":"TaplgYeEiP"},{"type":"text","value":" flops asymptotically, just like LU without pivoting. The implementation in ","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"key":"HMH2KHH9nL"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-plufact","label":"function-plufact","children":[{"type":"text","value":"Function ","key":"enqydkRYNU"},{"type":"text","value":"2.6.2","key":"c3yk2wTQue"}],"template":"Algorithm %s","enumerator":"2.6.2","resolved":true,"html_id":"function-plufact","key":"PbFFkSu86C"},{"type":"text","value":" does not achieve this optimal flop count, however. Like ","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"key":"jUcy3Jwwpa"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-lufact","label":"function-lufact","children":[{"type":"text","value":"Function ","key":"xnVGR45pOr"},{"type":"text","value":"2.4.1","key":"mo7QiugHuh"}],"template":"Algorithm %s","enumerator":"2.4.1","resolved":true,"html_id":"function-lufact","remote":true,"url":"/lu","dataUrl":"/lu.json","key":"SBSbRGnjOF"},{"type":"text","value":", it does unnecessary operations on structurally known zeros for the sake of being easier to understand.","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"key":"mqdnzd1EWK"}],"key":"GKNaTC46Uz"},{"type":"heading","depth":2,"position":{"start":{"line":183,"column":1},"end":{"line":183,"column":1}},"children":[{"type":"text","value":"Linear systems","position":{"start":{"line":183,"column":1},"end":{"line":183,"column":1}},"key":"FbTVlvQIti"}],"identifier":"linear-systems","label":"Linear systems","html_id":"linear-systems","implicit":true,"enumerator":"2.6.3","key":"pK20uXFtXP"},{"type":"paragraph","position":{"start":{"line":185,"column":1},"end":{"line":185,"column":1}},"children":[{"type":"text","value":"The output of ","position":{"start":{"line":185,"column":1},"end":{"line":185,"column":1}},"key":"KWDM2jQSKY"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-plufact","label":"function-plufact","children":[{"type":"text","value":"Function ","key":"Ao5oWhGj0o"},{"type":"text","value":"2.6.2","key":"wlyJ8NkxyJ"}],"template":"Algorithm %s","enumerator":"2.6.2","resolved":true,"html_id":"function-plufact","key":"m6s9zgjjhk"},{"type":"text","value":" is a factorization of a row-permuted ","position":{"start":{"line":185,"column":1},"end":{"line":185,"column":1}},"key":"VO5pdM8gSj"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":185,"column":1},"end":{"line":185,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"xB5k85JoAc"},{"type":"text","value":". Therefore, given a linear system ","position":{"start":{"line":185,"column":1},"end":{"line":185,"column":1}},"key":"TnbKkoEb5A"},{"type":"inlineMath","value":"\\mathbf{A}\\mathbf{x}=\\mathbf{b}","position":{"start":{"line":185,"column":1},"end":{"line":185,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi><mi mathvariant=\"bold\">x</mi><mo>=</mo><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}\\mathbf{x}=\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">Ax</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"nKYNHMCEg4"},{"type":"text","value":", we have to permute ","position":{"start":{"line":185,"column":1},"end":{"line":185,"column":1}},"key":"bKl2QTd78B"},{"type":"inlineMath","value":"\\mathbf{b}","position":{"start":{"line":185,"column":1},"end":{"line":185,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"ugJltZpcvz"},{"type":"text","value":" the same way before applying forward and backward substitution. This is equivalent to changing the order of the equations in a linear system, which does not affect its solution.","position":{"start":{"line":185,"column":1},"end":{"line":185,"column":1}},"key":"VnBi66herF"}],"key":"QBE5u3OhHt"},{"type":"proof","kind":"example","enumerated":true,"children":[{"type":"tabSet","children":[{"type":"tabItem","title":"Julia","sync":"julia","children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"PLU factorization for solving linear systems","position":{"start":{"line":192,"column":1},"end":{"line":192,"column":1}},"key":"xXKcud1xJJ"}],"key":"IasK3MGlKN"},{"type":"include","file":"julia/usage.ipynb","children":[{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-05T09:34:08.220000Z","iopub.status.busy":"2025-01-05T09:34:07.927000Z","iopub.status.idle":"2025-01-05T09:34:14.716000Z","shell.execute_reply":"2025-01-05T09:34:14.670000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"include(\"../../../julia/FNC_init.jl\")","key":"deKCW8Wfg5"},{"type":"output","id":"ciZPh5FP228cOxBweRgVw","data":[{"name":"stderr","output_type":"stream","text":"\u001b[32m\u001b[1m  Activating\u001b[22m\u001b[39m "},{"name":"stderr","output_type":"stream","text":"project at `~/Documents/GitHub/fnc`\n"}],"key":"VAu4WmYv4i"}],"key":"pjAYLJn6tB"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"EZ7SXg2V1B"},{"type":"text","value":"2.6.4","key":"E8cHmHk8bd"}],"key":"afKW6QS61g"}],"identifier":"demo-pivoting-usage","label":"demo-pivoting-usage","kind":"proof:example","template":"Example %s","enumerator":"2.6.4","resolved":true,"html_id":"demo-pivoting-usage","key":"JmRXWQ769t"}],"key":"Gbah1m2UFs"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The third output of ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"qoYlGv3O3M"},{"type":"inlineCode","value":"plufact","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"wuiVpTo3jj"},{"type":"text","value":" is the permutation vector we need to apply to ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"TfMBWJkpLR"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"hMh18eZKqu"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"O0fcrgZxJB"}],"key":"a4qLO7Qmn6"}],"key":"NtIJMQazGd"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-05T09:34:14.862000Z","iopub.status.busy":"2025-01-05T09:34:14.718000Z","iopub.status.idle":"2025-01-05T09:34:17.221000Z","shell.execute_reply":"2025-01-05T09:34:17.221000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"A = rand(1:20, 4, 4)\nL, U, p = FNC.plufact(A)\nA[p,:] - L * U   # should be ≈ 0","key":"NDeK9MAw6q"},{"type":"output","id":"6mV0QsF5qr8YcEN6uiEwB","data":[{"output_type":"execute_result","execution_count":2,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n 0.0  0.0  0.0  0.0\n 0.0  0.0  0.0  0.0\n 0.0  0.0  0.0  0.0\n 0.0  0.0  0.0  0.0","content_type":"text/plain"}}}],"key":"F5xsO7gI3n"}],"key":"yr0hE3FzGi"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Given a vector ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"AwJtdxvjkv"},{"type":"inlineMath","value":"\\mathbf{b}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"ylMXZxBn9u"},{"type":"text","value":", we solve ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Iyq5Es62IY"},{"type":"inlineMath","value":"\\mathbf{A}\\mathbf{x}=\\mathbf{b}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi><mi mathvariant=\"bold\">x</mi><mo>=</mo><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}\\mathbf{x}=\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">Ax</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"Ym1tnMnHG5"},{"type":"text","value":" by first permuting the entries of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"IM20JOaL2z"},{"type":"inlineMath","value":"\\mathbf{b}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"F9gsrAJE5x"},{"type":"text","value":" and then proceeding as before.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YNcZqcZUSd"}],"key":"lPz1NE0Rtx"}],"key":"dQFw1hhA08"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-05T09:34:17.225000Z","iopub.status.busy":"2025-01-05T09:34:17.224000Z","iopub.status.idle":"2025-01-05T09:34:17.529000Z","shell.execute_reply":"2025-01-05T09:34:17.529000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"b = rand(4)\nz = FNC.forwardsub(L,b[p])\nx = FNC.backsub(U,z)","key":"pQRquiGMza"},{"type":"output","id":"L4ZO5az5b7FQHrK9tIeTO","data":[{"output_type":"execute_result","execution_count":3,"metadata":{},"data":{"text/plain":{"content":"4-element Vector{Float64}:\n  0.02749801420636107\n -0.12548794082958492\n  0.07681772246882936\n  0.0531377259493499","content_type":"text/plain"}}}],"key":"M4Y5HyK9HA"}],"key":"joaqpaHUyG"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"A residual check is successful:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"l8XzctTyTw"}],"key":"CkpelZUcuE"}],"key":"EY26YozQie"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-05T09:34:17.531000Z","iopub.status.busy":"2025-01-05T09:34:17.531000Z","iopub.status.idle":"2025-01-05T09:34:17.638000Z","shell.execute_reply":"2025-01-05T09:34:17.638000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"b - A*x","key":"qSklPm3wr6"},{"type":"output","id":"sqR6kmIexyBObW2Sg-mq1","data":[{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"text/plain":{"content":"4-element Vector{Float64}:\n -2.220446049250313e-16\n -1.1102230246251565e-16\n  1.1102230246251565e-16\n  0.0","content_type":"text/plain"}}}],"key":"SPJRAWrPuH"}],"key":"YZMU2K7SMQ"}],"key":"IMLuTEUHV1"}],"key":"vrhfhUPJxG"}],"key":"B09mlh61zY"},{"type":"tabItem","title":"MATLAB","sync":"matlab","children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"PLU factorization for solving linear systems","position":{"start":{"line":201,"column":1},"end":{"line":201,"column":1}},"key":"XLttoQskWk"}],"key":"pY9I2R6t2H"},{"type":"include","file":"matlab/usage.ipynb","children":[{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"pG4n6Xdbug"},{"type":"text","value":"2.6.4","key":"BYP9ZyrgDL"}],"key":"TF3u1hVdj7"}],"identifier":"demo-pivoting-usage","label":"demo-pivoting-usage","kind":"proof:example","template":"Example %s","enumerator":"2.6.4","resolved":true,"html_id":"demo-pivoting-usage","key":"EuUiY1e8zK"}],"key":"vJLgQVAa2j"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The third output of ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"xnoL6MjRzl"},{"type":"inlineCode","value":"plufact","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ZdLz3clJ51"},{"type":"text","value":" is the permutation vector we need to apply to ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"fn0vwIh4j1"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"OyciSORPD3"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ZUOTeYf29e"}],"key":"AYjsopMXv9"}],"key":"PEhVyJIVNy"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"A = randi(20, 4, 4);\n[L, U, p] = plufact(A);\nA(p, :) - L * U    % should be ≈ 0","key":"iPlEEBp7HE"},{"type":"output","id":"Q7Ks9dVncx3xoq1VAJcH6","data":[{"output_type":"execute_result","execution_count":2,"metadata":{},"data":{"text/plain":{"content":"ans = 4×4 double\n1.0e-15 *\n\n         0         0         0         0\n         0         0         0         0\n         0         0         0         0\n         0         0    0.4441         0\n","content_type":"text/plain"},"text/html":{"content":"<html><body><pre>ans = 4×4 double\n1.0e-15 *\n\n         0         0         0         0\n         0         0         0         0\n         0         0         0         0\n         0         0    0.4441         0\n</pre></body></html>","content_type":"text/html"}}}],"key":"XWf9s9rrwS"}],"key":"hY47wfhvl3"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Given a vector ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LnJrVganbO"},{"type":"inlineMath","value":"\\mathbf{b}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"SQZUVbecjL"},{"type":"text","value":", we solve ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XzQIJCbE2f"},{"type":"inlineMath","value":"\\mathbf{A}\\mathbf{x}=\\mathbf{b}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi><mi mathvariant=\"bold\">x</mi><mo>=</mo><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}\\mathbf{x}=\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">Ax</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"t9AlwJgKNV"},{"type":"text","value":" by first permuting the entries of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RADSa7cqYB"},{"type":"inlineMath","value":"\\mathbf{b}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"MTX6Lr9Wuf"},{"type":"text","value":" and then proceeding as before.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"O6195Js53g"}],"key":"ZIcwSPKVWR"}],"key":"IERYELJGHu"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"b = rand(4, 1);\nz = forwardsub(L, b(p));\nx = backsub(U, z)","key":"kgsV9sdqO4"},{"type":"output","id":"mKN7xS2-0V8ETyfXk_oNm","data":[{"output_type":"execute_result","execution_count":3,"metadata":{},"data":{"text/plain":{"content":"x = 4×1 double\n   -0.3567\n    0.0548\n    0.2904\n    0.1998\n","content_type":"text/plain"},"text/html":{"content":"<html><body><pre>x = 4×1 double\n   -0.3567\n    0.0548\n    0.2904\n    0.1998\n</pre></body></html>","content_type":"text/html"}}}],"key":"uPFafUlwpt"}],"key":"Luwsu5b7PO"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"A residual check is successful:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"V8UITV1MBp"}],"key":"y5UeW1kMEC"}],"key":"CE2WvUxV2h"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"b - A*x","key":"bMpXXaA0Ig"},{"type":"output","id":"HHNgluiyuRB8qcWFfvbXL","data":[{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"text/plain":{"content":"ans = 4×1 double\n1.0e-15 *\n\n   -0.3331\n    0.1110\n         0\n   -0.3331\n","content_type":"text/plain"},"text/html":{"content":"<html><body><pre>ans = 4×1 double\n1.0e-15 *\n\n   -0.3331\n    0.1110\n         0\n   -0.3331\n</pre></body></html>","content_type":"text/html"}}}],"key":"AwMa7XnxxA"}],"key":"oZXEfZ8sPA"}],"key":"GjKHLTU1A8"}],"key":"c9UALQHABr"}],"key":"SvPKlJO8aU"},{"type":"tabItem","title":"Python","sync":"python","children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"PLU factorization for solving linear systems","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"key":"clilG5cQuV"}],"key":"HuHz0cjG7Y"},{"type":"include","file":"python/usage.ipynb","children":[{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:43:44.823672Z","iopub.status.busy":"2025-01-11T17:43:44.823455Z","iopub.status.idle":"2025-01-11T17:43:45.160076Z","shell.execute_reply":"2025-01-11T17:43:45.159560Z"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"exec(open(\"../../../python/FNC_init.py\").read())","visibility":"show","key":"byLgAUJX0r"},{"type":"output","id":"lgE8cTrG9bFlignp4XcGm","data":[],"visibility":"show","key":"zBpne57YRB"}],"visibility":"remove","key":"auX2FFLGLd"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"dgO21ipIHN"},{"type":"text","value":"2.6.4","key":"aq1sooHd1K"}],"key":"cSrTBFEI2W"}],"identifier":"demo-pivoting-usage","label":"demo-pivoting-usage","kind":"proof:example","template":"Example %s","enumerator":"2.6.4","resolved":true,"html_id":"demo-pivoting-usage","key":"GuTw4r1H0L"}],"key":"Y7lUXYEjEV"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The third output of ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"mpprGy6Lpm"},{"type":"inlineCode","value":"plufact","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"s4KzVizhYN"},{"type":"text","value":" is the permutation vector we need to apply to ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"hdk091O9E3"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"RPaB4hinoz"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"wM70iyoGTa"}],"key":"sAbBQ0ATVV"}],"key":"trAmrDZfXA"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:43:45.162657Z","iopub.status.busy":"2025-01-11T17:43:45.162370Z","iopub.status.idle":"2025-01-11T17:43:45.169964Z","shell.execute_reply":"2025-01-11T17:43:45.169527Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"A = random.randn(4, 4)\nL, U, p = FNC.plufact(A)\nA[p, :] - L @ U   # should be ≈ 0","key":"l8SVL9EKYX"},{"type":"output","id":"Ehm9se7vpDwzf2Gc4vREs","data":[{"output_type":"execute_result","execution_count":2,"metadata":{},"data":{"text/plain":{"content":"array([[ 0.00000000e+00,  0.00000000e+00,  0.00000000e+00,\n         0.00000000e+00],\n       [ 0.00000000e+00,  0.00000000e+00, -1.11022302e-16,\n         0.00000000e+00],\n       [ 0.00000000e+00, -1.11022302e-16, -5.55111512e-17,\n         0.00000000e+00],\n       [ 0.00000000e+00,  0.00000000e+00,  0.00000000e+00,\n        -2.22044605e-16]])","content_type":"text/plain"}}}],"key":"ivkfLxes3i"}],"key":"REhCANtqTX"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Given a vector ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YlbFR4snTL"},{"type":"inlineMath","value":"\\mathbf{b}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"se2VakGeen"},{"type":"text","value":", we solve ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"lyGA2UnRvv"},{"type":"inlineMath","value":"\\mathbf{A}\\mathbf{x}=\\mathbf{b}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi><mi mathvariant=\"bold\">x</mi><mo>=</mo><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}\\mathbf{x}=\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">Ax</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"SvXRGKVyuO"},{"type":"text","value":" by first permuting the entries of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"oMUqKISewi"},{"type":"inlineMath","value":"\\mathbf{b}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"qTo6edDfLc"},{"type":"text","value":" and then proceeding as before.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JDETpVpYqB"}],"key":"aZ6YofUvhP"}],"key":"cmuQb3H3CE"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:43:45.172299Z","iopub.status.busy":"2025-01-11T17:43:45.172034Z","iopub.status.idle":"2025-01-11T17:43:45.174566Z","shell.execute_reply":"2025-01-11T17:43:45.174268Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"b = random.randn(4)\nz = FNC.forwardsub(L, b[p])\nx = FNC.backsub(U, z)","key":"Tg7bnN2IPw"},{"type":"output","id":"4hT2tBDVnDd7swjN69-7U","data":[],"key":"WKaRItKBUr"}],"key":"ooteammn07"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"A residual check is successful:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"D5KxG9yqrD"}],"key":"OShmPHWem6"}],"key":"iLFT52K2YA"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:43:45.176281Z","iopub.status.busy":"2025-01-11T17:43:45.176174Z","iopub.status.idle":"2025-01-11T17:43:45.178265Z","shell.execute_reply":"2025-01-11T17:43:45.178018Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"b - A @ x","key":"eQH09wjZW3"},{"type":"output","id":"X8a1OpfnetatcX9vX3qLa","data":[{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"text/plain":{"content":"array([-5.55111512e-17,  2.22044605e-16,  0.00000000e+00,  2.22044605e-16])","content_type":"text/plain"}}}],"key":"gSFmnYC477"}],"key":"YvDaCKOH6l"}],"key":"w1lmQHDKb9"}],"key":"QMx9GofOPG"}],"key":"sHMFMUftwJ"}],"key":"KJ5wMKsdwi"}],"label":"demo-pivoting-usage","identifier":"demo-pivoting-usage","html_id":"demo-pivoting-usage","enumerator":"2.6.4","key":"cbqfGKgxzq"},{"type":"paragraph","position":{"start":{"line":220,"column":1},"end":{"line":220,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":220,"column":1},"end":{"line":220,"column":1}},"key":"feAAUz9Lax"},{"type":"inlineCode","value":"lu","position":{"start":{"line":220,"column":1},"end":{"line":220,"column":1}},"key":"XUaKvQYHwb"},{"type":"text","value":" function from the built-in package ","position":{"start":{"line":220,"column":1},"end":{"line":220,"column":1}},"key":"xxyKgwdKce"},{"type":"inlineCode","value":"LinearAlgebra","position":{"start":{"line":220,"column":1},"end":{"line":220,"column":1}},"key":"ZJhrXGSibl"},{"type":"text","value":" returns the same three outputs as ","position":{"start":{"line":220,"column":1},"end":{"line":220,"column":1}},"key":"UCq4D0suCV"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-plufact","label":"function-plufact","children":[{"type":"text","value":"Function ","key":"xx2ESpv9uf"},{"type":"text","value":"2.6.2","key":"pQEdnWBeqr"}],"template":"Algorithm %s","enumerator":"2.6.2","resolved":true,"html_id":"function-plufact","key":"qvvtku83dz"},{"type":"text","value":". If you only request one output, it will be a factorization object that can be used with a backslash. This is useful when you want to solve with multiple versions of ","position":{"start":{"line":220,"column":1},"end":{"line":220,"column":1}},"key":"LGxrjd3TRU"},{"type":"inlineMath","value":"\\mathbf{b}","position":{"start":{"line":220,"column":1},"end":{"line":220,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"jEPb9KHGuC"},{"type":"text","value":" but do the factorization only once.","position":{"start":{"line":220,"column":1},"end":{"line":220,"column":1}},"key":"v6RF9vaYp0"}],"key":"tw1APvFOHf"},{"type":"proof","kind":"example","enumerated":true,"children":[{"type":"tabSet","children":[{"type":"tabItem","title":"Julia","sync":"julia","children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Built-in PLU factorization","position":{"start":{"line":227,"column":1},"end":{"line":227,"column":1}},"key":"yyTL5W2rOD"}],"key":"MedvkcW1uQ"},{"type":"include","file":"julia/builtin.ipynb","children":[{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-05T09:34:25.206000Z","iopub.status.busy":"2025-01-05T09:34:24.922000Z","iopub.status.idle":"2025-01-05T09:34:31.449000Z","shell.execute_reply":"2025-01-05T09:34:31.403000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"include(\"../../../julia/FNC_init.jl\")","key":"fGGw0VDh59"},{"type":"output","id":"hLMIJ0VLyz5KHdiFIG5Re","data":[{"name":"stderr","output_type":"stream","text":"\u001b[32m\u001b[1m  Activating\u001b[22m\u001b[39m "},{"name":"stderr","output_type":"stream","text":"project at `~/Documents/GitHub/fnc`\n"}],"key":"FY5daN6es1"}],"key":"mZHCVMr82t"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"AGbyxnfbsh"},{"type":"text","value":"2.6.5","key":"ZOx3M5AFHO"}],"key":"qlpWgeuEym"}],"identifier":"demo-pivoting-builtin","label":"demo-pivoting-builtin","kind":"proof:example","template":"Example %s","enumerator":"2.6.5","resolved":true,"html_id":"demo-pivoting-builtin","key":"ND4lo3LJLu"}],"key":"tuR1WT8o7o"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"With the syntax ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"YtEEuVLHI9"},{"type":"inlineCode","value":"A \\ b","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ZbrMwXsAOO"},{"type":"text","value":", the matrix ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"eNKuL1iHV0"},{"type":"inlineCode","value":"A","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"aDnYTyR6cs"},{"type":"text","value":" is PLU-factored, followed by two triangular solves.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"tdNm8pqehS"}],"key":"tNNSFMXcnu"}],"key":"H66WFDlAaO"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-05T09:34:31.580000Z","iopub.status.busy":"2025-01-05T09:34:31.451000Z","iopub.status.idle":"2025-01-05T09:34:31.996000Z","shell.execute_reply":"2025-01-05T09:34:31.996000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"A = randn(500, 500)   # 500x500 with normal random entries\nA \\ rand(500)          # force compilation\n@elapsed for k=1:50; A \\ rand(500); end","key":"IDymZSf9S5"},{"type":"output","id":"SP0HbF-35phm1SI3N-ipx","data":[{"output_type":"execute_result","execution_count":2,"metadata":{},"data":{"text/plain":{"content":"0.139001208","content_type":"text/plain"}}}],"key":"PLA7JJ4LUK"}],"key":"i2yWFpLejU"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"In ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bSjLWgVGQa"},{"type":"link","kind":"numref","identifier":"section-linsys-efficiency","label":"section-linsys-efficiency","url":"/efficiency","internal":true,"dataUrl":"/efficiency.json","children":[{"type":"text","value":"Efficiency of matrix computations","key":"uEf9ba4fAm"}],"key":"kyQr1dO8Pr"},{"type":"text","value":" we showed that the factorization is by far the most costly part of the solution process. A factorization object allows us to do that costly step only once per unique matrix.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Pkh5IwVIUQ"}],"key":"kOVd7VmrCU"}],"key":"zADmukB6TA"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-05T09:34:31.998000Z","iopub.status.busy":"2025-01-05T09:34:31.998000Z","iopub.status.idle":"2025-01-05T09:34:32.015000Z","shell.execute_reply":"2025-01-05T09:34:32.014000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"factored = lu(A)     # store factorization result\nfactored \\ rand(500)   # force compilation\n@elapsed for k=1:50; factored \\ rand(500); end","key":"TjOTiulRo1"},{"type":"output","id":"wLM1Daj6TXcNuO3XR-YOj","data":[{"output_type":"execute_result","execution_count":3,"metadata":{},"data":{"text/plain":{"content":"0.002763166","content_type":"text/plain"}}}],"key":"Ues6xJ55Tn"}],"key":"qxdRJWQv7e"}],"key":"aByHCvXvJL"}],"key":"FgINRZJIs9"}],"key":"mBVe7NDF4A"},{"type":"tabItem","title":"MATLAB","sync":"matlab","children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Built-in PLU factorization","position":{"start":{"line":236,"column":1},"end":{"line":236,"column":1}},"key":"x3KS7h4jb4"}],"key":"tErvhxclhc"},{"type":"include","file":"matlab/builtin.ipynb","children":[{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"lw6mosFvwI"},{"type":"text","value":"2.6.5","key":"EbhO6T3nha"}],"key":"SgkHefmmCQ"}],"identifier":"demo-pivoting-builtin","label":"demo-pivoting-builtin","kind":"proof:example","template":"Example %s","enumerator":"2.6.5","resolved":true,"html_id":"demo-pivoting-builtin","key":"s3irTvXCE3"}],"key":"qfpV06T0ej"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"With the syntax ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"AZMJmk7L2i"},{"type":"inlineCode","value":"A \\ b","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"UCNpeqTM7j"},{"type":"text","value":", the matrix ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"K9fsaFflfI"},{"type":"inlineCode","value":"A","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"TG5Gxm2hCK"},{"type":"text","value":" is PLU-factored, followed by two triangular solves.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"FUYEcIPMwn"}],"key":"m1VKvflqME"}],"key":"Y8ZkDlHIXd"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"A = randn(500, 500);    % 500x500 with normal random entries\ntic; for k=1:50; A \\ rand(500, 1); end; toc","key":"GAaggqrXQO"},{"type":"output","id":"4onUXLDWldaD9IONQkQpX","data":[{"name":"stdout","output_type":"stream","text":"Elapsed time is 0.406799 seconds.\n"}],"key":"zRvYRZup5R"}],"key":"QkgtXFpylG"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"In ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jkXyYmnRQW"},{"type":"link","kind":"numref","identifier":"section-linsys-efficiency","label":"section-linsys-efficiency","url":"/efficiency","internal":true,"dataUrl":"/efficiency.json","children":[{"type":"text","value":"Efficiency of matrix computations","key":"vvcyiIMwCv"}],"key":"zXl8mXz6wl"},{"type":"text","value":" we showed that the factorization is by far the most costly part of the solution process. A factorization object allows us to do that costly step only once per unique matrix.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"z3bnG8BZz4"}],"key":"CRZPX8eKOP"}],"key":"ojp4jePfqx"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"[L, U, p] = lu(A, 'vector');    % keep factorization result\ntic\nfor k=1:50\n    b = rand(500, 1);\n    U \\ (L \\ b(p));\nend\ntoc","key":"ReSLlpPMbX"},{"type":"output","id":"xFkRLdS_4ZJYw_uD-Z_kw","data":[{"name":"stdout","output_type":"stream","text":"Elapsed time is 0.010508 seconds.\n"}],"key":"hEL5MvABri"}],"key":"eZ2MwtFWff"}],"key":"sqiQcgtCpm"}],"key":"x32VnV8UXx"}],"key":"qrX59Q0lVN"},{"type":"tabItem","title":"Python","sync":"python","children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Built-in PLU factorization","position":{"start":{"line":245,"column":1},"end":{"line":245,"column":1}},"key":"ENGebh8Qa5"}],"key":"x7U2p00fxz"},{"type":"include","file":"python/builtin.ipynb","children":[{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:43:38.837957Z","iopub.status.busy":"2025-01-11T17:43:38.837824Z","iopub.status.idle":"2025-01-11T17:43:39.165661Z","shell.execute_reply":"2025-01-11T17:43:39.165402Z"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"exec(open(\"../../../python/FNC_init.py\").read())","visibility":"show","key":"raErcQCOQ0"},{"type":"output","id":"RUSe0Hk0jOJalJd2fQyTx","data":[],"visibility":"show","key":"Jp8E4nOtkx"}],"visibility":"remove","key":"xRGePH3hzR"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"dGuKj4uaP4"},{"type":"text","value":"2.6.5","key":"nLtT1nF23f"}],"key":"Uoe5ByYzpF"}],"identifier":"demo-pivoting-builtin","label":"demo-pivoting-builtin","kind":"proof:example","template":"Example %s","enumerator":"2.6.5","resolved":true,"html_id":"demo-pivoting-builtin","key":"KnwLz16ezd"}],"key":"AiH8WKeN37"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"In ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"DW6Q8xRR9x"},{"type":"inlineCode","value":"linalg.solve","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ZlIuVZxk5T"},{"type":"text","value":", the matrix ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"b8upIwqQbb"},{"type":"inlineCode","value":"A","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"sIFosdL7G7"},{"type":"text","value":" is PLU-factored, followed by two triangular solves. If we want to do those steps seamlessly, we can use the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"XFko6bSJZM"},{"type":"inlineCode","value":"lu_factor","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"CE0toIazuj"},{"type":"text","value":" and ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Tag7MlNhor"},{"type":"inlineCode","value":"lu_solve","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"m8y8QveJux"},{"type":"text","value":" from ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Z25o4qqxaS"},{"type":"inlineCode","value":"scipy.linalg","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"HPX4Ihx2kX"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"XpLXlQYkAi"}],"key":"VWTX4v5o3k"}],"key":"IoCOGnTySF"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:43:39.167080Z","iopub.status.busy":"2025-01-11T17:43:39.166950Z","iopub.status.idle":"2025-01-11T17:43:39.175263Z","shell.execute_reply":"2025-01-11T17:43:39.175029Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"from scipy.linalg import lu_factor, lu_solve\nA = random.randn(500, 500) \nb = ones(500)  \nLU, perm = lu_factor(A)\nx = lu_solve((LU, perm), b)","key":"HKt0XIEyco"},{"type":"output","id":"TaQTspM6-bOkNvwUE9HhR","data":[],"key":"cgiWBaznLy"}],"key":"UlaFr740xX"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Why would we ever bother with this? In ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rZWEmkQUp6"},{"type":"link","kind":"numref","identifier":"section-linsys-efficiency","label":"section-linsys-efficiency","url":"/efficiency","internal":true,"dataUrl":"/efficiency.json","children":[{"type":"text","value":"Efficiency of matrix computations","key":"YbpZkExfgN"}],"key":"N97A5vgUP8"},{"type":"text","value":" we showed that the factorization is by far the most costly part of the solution process. A factorization object allows us to do that costly step only once per matrix, but solve with multiple right-hand sides.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RgCVYMwZiD"}],"key":"ZacaIc7IZV"}],"key":"mvVEdtLu1j"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:43:39.176523Z","iopub.status.busy":"2025-01-11T17:43:39.176432Z","iopub.status.idle":"2025-01-11T17:43:39.251308Z","shell.execute_reply":"2025-01-11T17:43:39.251048Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"start = timer()\nfor k in range(50): linalg.solve(A, random.rand(500))\nprint(f\"elapsed time for 50 full solves: {timer() - start}\")\n\nstart = timer()\nLU, perm = lu_factor(A)\nfor k in range(50): lu_solve((LU, perm), random.rand(500))\nprint(f\"elapsed time for 50 shortcut solves: {timer() - start}\")","key":"aN5YdBmlPt"},{"type":"output","id":"9ujyjd2YfPZ-TUz40fRGU","data":[{"name":"stdout","output_type":"stream","text":"elapsed time for 50 full solves: 0.06624250000004395\nelapsed time for 50 shortcut solves: 0.0065611250001893495\n"}],"key":"fNfwZ0nk5H"}],"key":"UTeu2YFSly"}],"key":"a0ULlkxgMv"}],"key":"vmigIwpOvY"}],"key":"cdfI4fTW3C"}],"key":"P8J2Z8cQmD"}],"label":"demo-pivoting-builtin","identifier":"demo-pivoting-builtin","html_id":"demo-pivoting-builtin","enumerator":"2.6.5","key":"MsObGPzJBr"},{"type":"heading","depth":2,"position":{"start":{"line":255,"column":1},"end":{"line":255,"column":1}},"children":[{"type":"text","value":"Stability","position":{"start":{"line":255,"column":1},"end":{"line":255,"column":1}},"key":"GnBWXmxCaK"}],"identifier":"stability","label":"Stability","html_id":"stability","implicit":true,"enumerator":"2.6.4","key":"llfDZcIbm4"},{"type":"paragraph","position":{"start":{"line":260,"column":1},"end":{"line":260,"column":1}},"children":[{"type":"text","value":"There is one detail of the row pivoting algorithm that might seem arbitrary: why choose the pivot of largest magnitude in a column, rather than, say, the uppermost nonzero in the column? The answer is numerical stability.","position":{"start":{"line":260,"column":1},"end":{"line":260,"column":1}},"key":"KmDv51SF5Z"}],"indexEntries":[{"entry":"stability","emphasis":false}],"label":"index-VPcLBwSt1Q","identifier":"index-vpclbwst1q","html_id":"index-vpclbwst1q","key":"lIwSgAgV9m"},{"type":"proof","kind":"example","enumerated":true,"children":[{"type":"tabSet","children":[{"type":"tabItem","title":"Julia","sync":"julia","children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Stability of PLU factorization","position":{"start":{"line":267,"column":1},"end":{"line":267,"column":1}},"key":"au8XI2zOVb"}],"key":"L0AW2N42aj"},{"type":"include","file":"julia/stable.ipynb","children":[{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-05T09:34:39.545000Z","iopub.status.busy":"2025-01-05T09:34:39.259000Z","iopub.status.idle":"2025-01-05T09:34:46.520000Z","shell.execute_reply":"2025-01-05T09:34:46.464000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"include(\"../../../julia/FNC_init.jl\")","key":"DNQL5EmbBW"},{"type":"output","id":"i79f3iGdvfi-93NgHG4M1","data":[{"name":"stderr","output_type":"stream","text":"\u001b[32m\u001b[1m  Activating\u001b[22m\u001b[39m "},{"name":"stderr","output_type":"stream","text":"project at `~/Documents/GitHub/fnc`\n"}],"key":"xjhiED04ee"}],"key":"s85m8WqgKC"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"OWLU126EJE"},{"type":"text","value":"2.6.6","key":"XvwaAH1Sa6"}],"key":"fzW3wygsGL"}],"identifier":"demo-pivoting-stable","label":"demo-pivoting-stable","kind":"proof:example","template":"Example %s","enumerator":"2.6.6","resolved":true,"html_id":"demo-pivoting-stable","key":"wIdKcEjKR3"}],"key":"zowZtL5Ajy"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We construct a linear system for this matrix with ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"dV8OPT16eU"},{"type":"inlineMath","value":"\\epsilon=10^{-12}","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ϵ</mi><mo>=</mo><mn>1</mn><msup><mn>0</mn><mrow><mo>−</mo><mn>12</mn></mrow></msup></mrow><annotation encoding=\"application/x-tex\">\\epsilon=10^{-12}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">ϵ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">12</span></span></span></span></span></span></span></span></span></span></span></span>","key":"VMyubHQxoh"},{"type":"text","value":" and exact solution ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"m1i5I5Je2d"},{"type":"inlineMath","value":"[1,1]","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[1,1]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]</span></span></span></span>","key":"ShFmd1AFRB"},{"type":"text","value":":","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"IrYHdXDhIc"}],"key":"kJJvGyH0SP"}],"key":"ONSiRx6GYu"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-05T09:34:46.676000Z","iopub.status.busy":"2025-01-05T09:34:46.522000Z","iopub.status.idle":"2025-01-05T09:34:48.028000Z","shell.execute_reply":"2025-01-05T09:34:48.028000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"ϵ = 1e-12\nA = [-ϵ 1; 1 -1]\nb = A * [1, 1]","key":"sbSgdrwkCn"},{"type":"output","id":"pdhklyVn72quhl_NS_BLj","data":[{"output_type":"execute_result","execution_count":2,"metadata":{},"data":{"text/plain":{"content":"2-element Vector{Float64}:\n 0.999999999999\n 0.0","content_type":"text/plain"}}}],"key":"NAZsrIMK2V"}],"key":"qPjEbrzhln"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We can factor the matrix without pivoting and solve for ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"oYsFoGWHsw"},{"type":"inlineMath","value":"\\mathbf{x}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">x</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{x}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4444em;\"></span><span class=\"mord mathbf\">x</span></span></span></span>","key":"xvf6SZQDjJ"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GAIcgOTe94"}],"key":"GsjSUrbxMB"}],"key":"Ma5lg70k48"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-05T09:34:48.030000Z","iopub.status.busy":"2025-01-05T09:34:48.030000Z","iopub.status.idle":"2025-01-05T09:34:48.158000Z","shell.execute_reply":"2025-01-05T09:34:48.158000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"L, U = FNC.lufact(A)\nx = FNC.backsub( U, FNC.forwardsub(L, b) )","key":"eZBdzkJRbl"},{"type":"output","id":"z6XWDPGSwbLAuWLZtac9h","data":[{"output_type":"execute_result","execution_count":3,"metadata":{},"data":{"text/plain":{"content":"2-element Vector{Float64}:\n 0.9999778782798785\n 1.0","content_type":"text/plain"}}}],"key":"xsNqcDpHa1"}],"key":"nrCesvR3ST"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Note that we have obtained only about 5 accurate digits for ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"goo2QAqt0n"},{"type":"inlineMath","value":"x_1","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">x_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"zlt8sy43mG"},{"type":"text","value":". We could make the result even more inaccurate by making ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"VVHUf1gFDg"},{"type":"text","value":"ε","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Uuik0LHyY8"},{"type":"text","value":" even smaller:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kGkWnlbI2m"}],"key":"LnZgw5UtwF"}],"key":"mCtXTUsIHF"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-05T09:34:48.160000Z","iopub.status.busy":"2025-01-05T09:34:48.160000Z","iopub.status.idle":"2025-01-05T09:34:48.162000Z","shell.execute_reply":"2025-01-05T09:34:48.161000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"ϵ = 1e-20; A = [-ϵ 1; 1 -1]\nb = A * [1, 1]\nL, U = FNC.lufact(A)\nx = FNC.backsub( U, FNC.forwardsub(L, b) )","key":"WI3ILoZpcM"},{"type":"output","id":"LDHkCQdmnW_S2beG7kclh","data":[{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"text/plain":{"content":"2-element Vector{Float64}:\n -0.0\n  1.0","content_type":"text/plain"}}}],"key":"aHXBwERQj2"}],"key":"EFwy8ZIh7e"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"This effect is not due to ill conditioning of the problem—a solution with PLU factorization works perfectly:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"yAAdPOJSuT"}],"key":"K2ul0HrlzQ"}],"key":"os0eJqYiC2"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-05T09:34:48.163000Z","iopub.status.busy":"2025-01-05T09:34:48.163000Z","iopub.status.idle":"2025-01-05T09:34:48.164000Z","shell.execute_reply":"2025-01-05T09:34:48.164000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"A \\ b","key":"kNxBx4iEQM"},{"type":"output","id":"hQEPxE4NmBCL3A79udLsv","data":[{"output_type":"execute_result","execution_count":5,"metadata":{},"data":{"text/plain":{"content":"2-element Vector{Float64}:\n 1.0\n 1.0","content_type":"text/plain"}}}],"key":"iCODAWPnNu"}],"key":"PFcRzFzpDt"}],"key":"AXKqg5RgiH"}],"key":"RIp4oUkPUE"}],"key":"i9jPnTbMdL"},{"type":"tabItem","title":"MATLAB","sync":"matlab","children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Stability of PLU factorization","position":{"start":{"line":276,"column":1},"end":{"line":276,"column":1}},"key":"AX4ljDRFCb"}],"key":"JgVucINSCn"},{"type":"include","file":"matlab/stable.ipynb","children":[{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"e2SquYftNq"},{"type":"text","value":"2.6.6","key":"OVxrT9LhSl"}],"key":"BBkiAOly1p"}],"identifier":"demo-pivoting-stable","label":"demo-pivoting-stable","kind":"proof:example","template":"Example %s","enumerator":"2.6.6","resolved":true,"html_id":"demo-pivoting-stable","key":"pr8s2VAMlO"}],"key":"jCyvYn9y9e"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We construct a linear system for this matrix with ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"qdh3j54Uho"},{"type":"inlineMath","value":"\\epsilon=10^{-12}","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ϵ</mi><mo>=</mo><mn>1</mn><msup><mn>0</mn><mrow><mo>−</mo><mn>12</mn></mrow></msup></mrow><annotation encoding=\"application/x-tex\">\\epsilon=10^{-12}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">ϵ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">12</span></span></span></span></span></span></span></span></span></span></span></span>","key":"ANwXIZTP1D"},{"type":"text","value":" and exact solution ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"W5deIAaJI2"},{"type":"inlineMath","value":"[1, 1]","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[1, 1]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]</span></span></span></span>","key":"vgGo1F7UEB"},{"type":"text","value":":","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"TnFR14IH6l"}],"key":"zl0ZjTnHvz"}],"key":"OIhfw9XrIu"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"ep = 1e-12\nA = [-ep 1; 1 -1];\nb = A * [1; 1];","key":"a1C8f72sy4"},{"type":"output","id":"cKRglX_CLepLbhp_CLp-1","data":[{"output_type":"execute_result","execution_count":2,"metadata":{},"data":{"text/plain":{"content":"ep = 1.0000e-12","content_type":"text/plain"},"text/html":{"content":"<html><body><pre>ep = 1.0000e-12</pre></body></html>","content_type":"text/html"}}}],"key":"T3xxLID6hg"}],"key":"NdimF4xYSH"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We can factor the matrix without pivoting and solve for ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"a6gK6Xiy4w"},{"type":"inlineMath","value":"\\mathbf{x}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">x</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{x}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4444em;\"></span><span class=\"mord mathbf\">x</span></span></span></span>","key":"FyaebgTZRl"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ABSk2F8H6K"}],"key":"mqjZijDf61"}],"key":"xf1lL09r1P"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"[L, U] = lufact(A);\nx = backsub( U, forwardsub(L, b) )","key":"fvxPUfHy95"},{"type":"output","id":"KdCYaDVPE9LhhCNBa2WJq","data":[{"output_type":"execute_result","execution_count":3,"metadata":{},"data":{"text/plain":{"content":"x = 2×1 double\n    1.0000\n    1.0000\n","content_type":"text/plain"},"text/html":{"content":"<html><body><pre>x = 2×1 double\n    1.0000\n    1.0000\n</pre></body></html>","content_type":"text/html"}}}],"key":"amkuWZEXF4"}],"key":"h91fiyKDuP"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Note that we have obtained only about 5 accurate digits for ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"m01NMzx0rp"},{"type":"inlineMath","value":"x_1","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">x_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"IiB57mxtlv"},{"type":"text","value":". We could make the result even more inaccurate by making ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"eaXM9P4mCu"},{"type":"text","value":"ε","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Q5VCRB3SAc"},{"type":"text","value":" even smaller:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"gxCz9gZ4NO"}],"key":"RXZ3FhC1qx"}],"key":"PycIAtcd0A"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"ep = 1e-20; A = [-ep 1; 1 -1];\nb = A * [1; 1];\n[L, U] = lufact(A);\nx = backsub( U, forwardsub(L, b) )","key":"rh57Gw09uE"},{"type":"output","id":"n90lLErprgDUOGIyQgKRS","data":[{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"text/plain":{"content":"x = 2×1 double\n     0\n     1\n","content_type":"text/plain"},"text/html":{"content":"<html><body><pre>x = 2×1 double\n     0\n     1\n</pre></body></html>","content_type":"text/html"}}}],"key":"EtM4ucfy6P"}],"key":"CHo31IQnZr"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"This effect is not due to ill conditioning of the problem—a solution with PLU factorization works perfectly:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"l4XAJGlNgL"}],"key":"WrMLTeISbZ"}],"key":"yPi0ZsuRbw"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"A \\ b","key":"JUBPNUPF4k"},{"type":"output","id":"5cUTwHK6tV48zFKJrM43Z","data":[{"output_type":"execute_result","execution_count":5,"metadata":{},"data":{"text/plain":{"content":"ans = 2×1 double\n     1\n     1\n","content_type":"text/plain"},"text/html":{"content":"<html><body><pre>ans = 2×1 double\n     1\n     1\n</pre></body></html>","content_type":"text/html"}}}],"key":"LHN00sRJpK"}],"key":"Z4qGpZKuCh"}],"key":"luIpSzhVa5"}],"key":"xXj926xcKF"}],"key":"pTuCQgCuXW"},{"type":"tabItem","title":"Python","sync":"python","children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Stability of PLU factorization","position":{"start":{"line":285,"column":1},"end":{"line":285,"column":1}},"key":"XpTscZjuzQ"}],"key":"pwWMId13lD"},{"type":"include","file":"python/stable.ipynb","children":[{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:43:43.709319Z","iopub.status.busy":"2025-01-11T17:43:43.709198Z","iopub.status.idle":"2025-01-11T17:43:44.035696Z","shell.execute_reply":"2025-01-11T17:43:44.035331Z"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"exec(open(\"../../../python/FNC_init.py\").read())","visibility":"show","key":"E3eoUPbcQH"},{"type":"output","id":"eLQm6n5Bs-yeIB11vaEEM","data":[],"visibility":"show","key":"mgLCl7IUon"}],"visibility":"remove","key":"ecnZPF1ugG"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"FGJthsJipa"},{"type":"text","value":"2.6.6","key":"LYeeL82t7Q"}],"key":"QRN5JK9Ygm"}],"identifier":"demo-pivoting-stable","label":"demo-pivoting-stable","kind":"proof:example","template":"Example %s","enumerator":"2.6.6","resolved":true,"html_id":"demo-pivoting-stable","key":"D3vlckkqsJ"}],"key":"v8tsDETpvj"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We construct a linear system for this matrix with ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"CvHfq3u7jn"},{"type":"inlineMath","value":"\\epsilon=10^{-12}","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ϵ</mi><mo>=</mo><mn>1</mn><msup><mn>0</mn><mrow><mo>−</mo><mn>12</mn></mrow></msup></mrow><annotation encoding=\"application/x-tex\">\\epsilon=10^{-12}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">ϵ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">12</span></span></span></span></span></span></span></span></span></span></span></span>","key":"SsmwkoF1qd"},{"type":"text","value":" and exact solution ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"sBiWUZA7yN"},{"type":"inlineMath","value":"[1,1]","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[1,1]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]</span></span></span></span>","key":"ruA1OdYQ29"},{"type":"text","value":":","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"SJtzcN6uj9"}],"key":"GYCaPwRk3G"}],"key":"S0TvMa2jLq"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:43:44.037306Z","iopub.status.busy":"2025-01-11T17:43:44.037179Z","iopub.status.idle":"2025-01-11T17:43:44.039170Z","shell.execute_reply":"2025-01-11T17:43:44.038896Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"ep = 1e-12\nA = array([[-ep, 1], [1, -1]])\nb = A @ array([1, 1])","key":"HioYSFlG9g"},{"type":"output","id":"kfnDwX7VzioBM-ldYk27Z","data":[],"key":"WBz8KQ6Gg6"}],"key":"lhW7vmHYAR"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We can factor the matrix without pivoting and solve for ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"szdX1hHC1t"},{"type":"inlineMath","value":"\\mathbf{x}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">x</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{x}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4444em;\"></span><span class=\"mord mathbf\">x</span></span></span></span>","key":"KPuSDV5uas"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JJw13n0tUF"}],"key":"DjdKsEE1QZ"}],"key":"p9n3XMfMpk"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:43:44.040552Z","iopub.status.busy":"2025-01-11T17:43:44.040358Z","iopub.status.idle":"2025-01-11T17:43:44.042891Z","shell.execute_reply":"2025-01-11T17:43:44.042625Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"L, U = FNC.lufact(A)\nprint(FNC.backsub( U, FNC.forwardsub(L, b) ))","key":"Zr0JTFnaga"},{"type":"output","id":"Xq6EzUOw6rHkmQrBPlHP7","data":[{"name":"stdout","output_type":"stream","text":"[0.99997788 1.        ]\n"}],"key":"DMrBC7N1zf"}],"key":"KNZOjouthu"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Note that we have obtained only about 5 accurate digits for ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WC4kNE11MZ"},{"type":"inlineMath","value":"x_1","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">x_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"v4aGMZjO0w"},{"type":"text","value":". We could make the result even more inaccurate by making ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"U2lULpkyRK"},{"type":"text","value":"ε","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dSL8BJpqz2"},{"type":"text","value":" even smaller:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"yDyFxJoVc5"}],"key":"wpeR1BzPZE"}],"key":"UJzcCyEwGM"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:43:44.044089Z","iopub.status.busy":"2025-01-11T17:43:44.044006Z","iopub.status.idle":"2025-01-11T17:43:44.046113Z","shell.execute_reply":"2025-01-11T17:43:44.045864Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"ep = 1e-20;\nA = array([[-ep, 1], [1, -1]])\nb = A @ array([1, 1])\nL, U = FNC.lufact(A)\nprint(FNC.backsub( U, FNC.forwardsub(L, b) ))","key":"NP7xFknHI1"},{"type":"output","id":"7HEBjK3F1GctS39reAdck","data":[{"name":"stdout","output_type":"stream","text":"[-0.  1.]\n"}],"key":"ZpG1Hk1pKF"}],"key":"sszEcveyBt"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"This effect is not due to ill conditioning of the problem—a solution with PLU factorization works perfectly:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"NRtKl5LhYl"}],"key":"kQ7I6phuJr"}],"key":"GAj6Uwuf1L"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:43:44.047325Z","iopub.status.busy":"2025-01-11T17:43:44.047247Z","iopub.status.idle":"2025-01-11T17:43:44.049179Z","shell.execute_reply":"2025-01-11T17:43:44.048933Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"print(linalg.solve(A, b))","key":"uxR2Jo6C8B"},{"type":"output","id":"qdRO9Z_0cawgG5AHRscUl","data":[{"name":"stdout","output_type":"stream","text":"[1. 1.]\n"}],"key":"JoSw3zPMFt"}],"key":"p0c93vIXVk"}],"key":"oe7BnYqYf2"}],"key":"UbaLIJAFyP"}],"key":"ma4xLytJAk"}],"key":"YkUKGXzn3Z"}],"label":"demo-pivoting-stable","identifier":"demo-pivoting-stable","html_id":"demo-pivoting-stable","enumerator":"2.6.6","key":"hZXviVgSo3"},{"type":"paragraph","position":{"start":{"line":295,"column":1},"end":{"line":295,"column":1}},"children":[{"type":"text","value":"The factors of this ","position":{"start":{"line":295,"column":1},"end":{"line":295,"column":1}},"key":"vlOZDGFAdj"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":295,"column":1},"end":{"line":295,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"DTomEmGYWM"},{"type":"text","value":" without pivoting are found to be","position":{"start":{"line":295,"column":1},"end":{"line":295,"column":1}},"key":"wECmlAVD34"}],"key":"kj5v16m3Ly"},{"type":"math","value":"  \\mathbf{L} = \n  \\begin{bmatrix}\n    1 & 0 \\\\ -\\epsilon^{-1} & 1 \n  \\end{bmatrix}, \\qquad \n  \\mathbf{U} = \n  \\begin{bmatrix}\n    -\\epsilon & 1 \\\\ 0 & \\epsilon^{-1}-1 \n  \\end{bmatrix}.","label":"plu-stab-LU","identifier":"plu-stab-lu","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi mathvariant=\"bold\">L</mi><mo>=</mo><mrow><mo fence=\"true\">[</mo><mtable rowspacing=\"0.16em\" columnalign=\"center center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>0</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><msup><mi>ϵ</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd></mtr></mtable><mo fence=\"true\">]</mo></mrow><mo separator=\"true\">,</mo><mspace width=\"2em\"/><mi mathvariant=\"bold\">U</mi><mo>=</mo><mrow><mo fence=\"true\">[</mo><mtable rowspacing=\"0.16em\" columnalign=\"center center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mi>ϵ</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><msup><mi>ϵ</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo>−</mo><mn>1</mn></mrow></mstyle></mtd></mtr></mtable><mo fence=\"true\">]</mo></mrow><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">  \\mathbf{L} = \n  \\begin{bmatrix}\n    1 &amp; 0 \\\\ -\\epsilon^{-1} &amp; 1 \n  \\end{bmatrix}, \\qquad \n  \\mathbf{U} = \n  \\begin{bmatrix}\n    -\\epsilon &amp; 1 \\\\ 0 &amp; \\epsilon^{-1}-1 \n  \\end{bmatrix}.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">L</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.4em;vertical-align:-0.95em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">[</span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord\"><span class=\"mord mathnormal\">ϵ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.95em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">0</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.95em;\"><span></span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">]</span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:2em;\"></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathbf\">U</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.4em;vertical-align:-0.95em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">[</span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord mathnormal\">ϵ</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.95em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">ϵ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.95em;\"><span></span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">]</span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">.</span></span></span></span></span>","enumerator":"2.6.2","html_id":"plu-stab-lu","key":"MGObsGUwfk"},{"type":"paragraph","position":{"start":{"line":309,"column":1},"end":{"line":309,"column":1}},"children":[{"type":"text","value":"For reasons we will quantify in ","position":{"start":{"line":309,"column":1},"end":{"line":309,"column":1}},"key":"d393OJrwRG"},{"type":"link","kind":"numref","identifier":"section-linsys-condition-number","label":"section-linsys-condition-number","url":"/condition-number","internal":true,"dataUrl":"/condition-number.json","children":[{"type":"text","value":"Conditioning of linear systems","key":"JX8ZzUkTrT"}],"key":"cbdQbyTER9"},{"type":"text","value":", the solution of ","position":{"start":{"line":309,"column":1},"end":{"line":309,"column":1}},"key":"rLi3E5Uy43"},{"type":"inlineMath","value":"\\mathbf{A}\\mathbf{x}=\\mathbf{b}","position":{"start":{"line":309,"column":1},"end":{"line":309,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi><mi mathvariant=\"bold\">x</mi><mo>=</mo><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}\\mathbf{x}=\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">Ax</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"Jp3z2V5j86"},{"type":"text","value":" is well-conditioned, but the problems of solving ","position":{"start":{"line":309,"column":1},"end":{"line":309,"column":1}},"key":"rOaLrGXuZe"},{"type":"inlineMath","value":"\\mathbf{L}\\mathbf{z}=\\mathbf{b}","position":{"start":{"line":309,"column":1},"end":{"line":309,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi><mi mathvariant=\"bold\">z</mi><mo>=</mo><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}\\mathbf{z}=\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">Lz</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"fXbL6fyl7d"},{"type":"text","value":" and ","position":{"start":{"line":309,"column":1},"end":{"line":309,"column":1}},"key":"O2xBVl7BqW"},{"type":"inlineMath","value":"\\mathbf{U}\\mathbf{x}=\\mathbf{z}","position":{"start":{"line":309,"column":1},"end":{"line":309,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi><mi mathvariant=\"bold\">x</mi><mo>=</mo><mi mathvariant=\"bold\">z</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}\\mathbf{x}=\\mathbf{z}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">Ux</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4444em;\"></span><span class=\"mord mathbf\">z</span></span></span></span>","key":"HLqLJFbzfy"},{"type":"text","value":" have condition numbers essentially ","position":{"start":{"line":309,"column":1},"end":{"line":309,"column":1}},"key":"Q5J7nUIi5B"},{"type":"inlineMath","value":"1/\\epsilon^2","position":{"start":{"line":309,"column":1},"end":{"line":309,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mi mathvariant=\"normal\">/</mi><msup><mi>ϵ</mi><mn>2</mn></msup></mrow><annotation encoding=\"application/x-tex\">1/\\epsilon^2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord\">1/</span><span class=\"mord\"><span class=\"mord mathnormal\">ϵ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span>","key":"Il2XBlpGfr"},{"type":"text","value":" each. Thus, for small ","position":{"start":{"line":309,"column":1},"end":{"line":309,"column":1}},"key":"mjRkZNbbge"},{"type":"text","value":"ε","position":{"start":{"line":309,"column":1},"end":{"line":309,"column":1}},"key":"xj0wh1XqvR"},{"type":"text","value":", solution of the original linear system by unpivoted LU factorization is highly unstable.","position":{"start":{"line":309,"column":1},"end":{"line":309,"column":1}},"key":"vatlyYgyo0"}],"key":"vhMZ5HtjJ7"},{"type":"paragraph","position":{"start":{"line":311,"column":1},"end":{"line":311,"column":1}},"children":[{"type":"text","value":"Somewhat surprisingly, solving ","position":{"start":{"line":311,"column":1},"end":{"line":311,"column":1}},"key":"SfYmRwKlHi"},{"type":"inlineMath","value":"\\mathbf{A}\\mathbf{x}=\\mathbf{b}","position":{"start":{"line":311,"column":1},"end":{"line":311,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi><mi mathvariant=\"bold\">x</mi><mo>=</mo><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}\\mathbf{x}=\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">Ax</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"IqaI44j9lR"},{"type":"text","value":" via PLU factorization is technically also unstable. In fact, examples of unstable solutions are well-known, but they have been nonexistent in practice. While there is a lot of evidence and some reasoning about why this is the case, the situation is not completely understood. Yet PLU factorization remains the algorithm of choice for general linear systems.","position":{"start":{"line":311,"column":1},"end":{"line":311,"column":1}},"key":"fojrY2njaO"}],"key":"RuPNerRQVL"},{"type":"heading","depth":2,"position":{"start":{"line":313,"column":1},"end":{"line":313,"column":1}},"children":[{"type":"text","value":"Exercises","position":{"start":{"line":313,"column":1},"end":{"line":313,"column":1}},"key":"p67gFJzFfh"}],"identifier":"exercises","label":"Exercises","html_id":"exercises","implicit":true,"enumerator":"2.6.5","key":"OB4gEz64kr"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":315,"column":1},"end":{"line":351,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":315,"column":1},"end":{"line":328,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":315,"column":1},"end":{"line":315,"column":1}},"children":[{"type":"text","value":"✍ Perform by hand the pivoted LU factorization of each matrix.","position":{"start":{"line":315,"column":1},"end":{"line":315,"column":1}},"key":"aq5JCuVTcz"}],"key":"XY15h8qwJS"},{"type":"paragraph","position":{"start":{"line":317,"column":1},"end":{"line":327,"column":1}},"children":[{"type":"strong","position":{"start":{"line":317,"column":1},"end":{"line":317,"column":1}},"children":[{"type":"text","value":"(a)","position":{"start":{"line":317,"column":1},"end":{"line":317,"column":1}},"key":"kP5H5nTv3i"}],"key":"PNClmkekbB"},{"type":"text","value":" ","position":{"start":{"line":317,"column":1},"end":{"line":317,"column":1}},"key":"XpoOB3Ikou"},{"type":"inlineMath","value":"\\quad \\displaystyle \\begin{bmatrix}\n 2 & 3 & 4 \\\\\n 4 & 5 & 10 \\\\\n 4 & 8 & 2\n \\end{bmatrix},\\qquad","position":{"start":{"line":317,"column":1},"end":{"line":317,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mspace width=\"1em\"/><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mo fence=\"true\">[</mo><mtable rowspacing=\"0.16em\" columnalign=\"center center center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>2</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>3</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>4</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>4</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>5</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>10</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>4</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>8</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>2</mn></mstyle></mtd></mtr></mtable><mo fence=\"true\">]</mo></mrow><mo separator=\"true\">,</mo><mspace width=\"2em\"/></mstyle></mrow><annotation encoding=\"application/x-tex\">\\quad \\displaystyle \\begin{bmatrix}\n 2 &amp; 3 &amp; 4 \\\\\n 4 &amp; 5 &amp; 10 \\\\\n 4 &amp; 8 &amp; 2\n \\end{bmatrix},\\qquad</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:3.6em;vertical-align:-1.55em;\"></span><span class=\"mspace\" style=\"margin-right:1em;\"></span><span class=\"minner\"><span class=\"mopen\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.05em;\"><span style=\"top:-2.25em;\"><span class=\"pstrut\" style=\"height:3.155em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎣</span></span></span><span style=\"top:-3.397em;\"><span class=\"pstrut\" style=\"height:3.155em;\"></span><span style=\"height:0.016em;width:0.6667em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.6667em' height='0.016em' style='width:0.6667em' viewBox='0 0 666.67 16' preserveAspectRatio='xMinYMin'><path d='M319 0 H403 V16 H319z M319 0 H403 V16 H319z'/></svg></span></span><span style=\"top:-4.05em;\"><span class=\"pstrut\" style=\"height:3.155em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎡</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.55em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.05em;\"><span style=\"top:-4.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">2</span></span></span><span style=\"top:-3.01em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">4</span></span></span><span style=\"top:-1.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">4</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.55em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.05em;\"><span style=\"top:-4.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">3</span></span></span><span style=\"top:-3.01em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">5</span></span></span><span style=\"top:-1.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">8</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.55em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.05em;\"><span style=\"top:-4.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">4</span></span></span><span style=\"top:-3.01em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">10</span></span></span><span style=\"top:-1.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.55em;\"><span></span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.05em;\"><span style=\"top:-2.25em;\"><span class=\"pstrut\" style=\"height:3.155em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎦</span></span></span><span style=\"top:-3.397em;\"><span class=\"pstrut\" style=\"height:3.155em;\"></span><span style=\"height:0.016em;width:0.6667em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.6667em' height='0.016em' style='width:0.6667em' viewBox='0 0 666.67 16' preserveAspectRatio='xMinYMin'><path d='M263 0 H347 V16 H263z M263 0 H347 V16 H263z'/></svg></span></span><span style=\"top:-4.05em;\"><span class=\"pstrut\" style=\"height:3.155em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎤</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.55em;\"><span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:2em;\"></span></span></span></span>","key":"RCHGo68XfX"},{"type":"text","value":"\n","position":{"start":{"line":317,"column":1},"end":{"line":317,"column":1}},"key":"vYl0fmCVBO"},{"type":"strong","position":{"start":{"line":317,"column":1},"end":{"line":317,"column":1}},"children":[{"type":"text","value":"(b)","position":{"start":{"line":317,"column":1},"end":{"line":317,"column":1}},"key":"IWOsfbUuWE"}],"key":"JYEPyNO0Mk"},{"type":"text","value":" ","position":{"start":{"line":317,"column":1},"end":{"line":317,"column":1}},"key":"GRPSaFdxAn"},{"type":"inlineMath","value":"\\quad \\displaystyle \\begin{bmatrix}\n 1 & 4 & 5 & -5 \\\\\n -1 & 0 & -1 & -5 \\\\\n 1 & 3 & -1 & 2 \\\\\n 1 & -1 & 5 & -1 \n \\end{bmatrix}","position":{"start":{"line":317,"column":1},"end":{"line":317,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mspace width=\"1em\"/><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mo fence=\"true\">[</mo><mtable rowspacing=\"0.16em\" columnalign=\"center center center center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>4</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>5</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mn>5</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mn>1</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mn>1</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mn>5</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>3</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mn>1</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>2</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mn>1</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>5</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mn>1</mn></mrow></mstyle></mtd></mtr></mtable><mo fence=\"true\">]</mo></mrow></mstyle></mrow><annotation encoding=\"application/x-tex\">\\quad \\displaystyle \\begin{bmatrix}\n 1 &amp; 4 &amp; 5 &amp; -5 \\\\\n -1 &amp; 0 &amp; -1 &amp; -5 \\\\\n 1 &amp; 3 &amp; -1 &amp; 2 \\\\\n 1 &amp; -1 &amp; 5 &amp; -1 \n \\end{bmatrix}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:4.8001em;vertical-align:-2.15em;\"></span><span class=\"mspace\" style=\"margin-right:1em;\"></span><span class=\"minner\"><span class=\"mopen\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.65em;\"><span style=\"top:-1.711em;\"><span class=\"pstrut\" style=\"height:3.216em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎣</span></span></span><span style=\"top:-2.858em;\"><span class=\"pstrut\" style=\"height:3.216em;\"></span><span style=\"height:1.216em;width:0.6667em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.6667em' height='1.216em' style='width:0.6667em' viewBox='0 0 666.67 1216' preserveAspectRatio='xMinYMin'><path d='M319 0 H403 V1216 H319z M319 0 H403 V1216 H319z'/></svg></span></span><span style=\"top:-4.7111em;\"><span class=\"pstrut\" style=\"height:3.216em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎡</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.65em;\"><span style=\"top:-4.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord\">1</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span><span style=\"top:-1.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.15em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.65em;\"><span style=\"top:-4.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">4</span></span></span><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">0</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">3</span></span></span><span style=\"top:-1.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.15em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.65em;\"><span style=\"top:-4.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">5</span></span></span><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord\">1</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord\">1</span></span></span><span style=\"top:-1.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">5</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.15em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.65em;\"><span style=\"top:-4.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord\">5</span></span></span><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord\">5</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">2</span></span></span><span style=\"top:-1.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.15em;\"><span></span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.65em;\"><span style=\"top:-1.711em;\"><span class=\"pstrut\" style=\"height:3.216em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎦</span></span></span><span style=\"top:-2.858em;\"><span class=\"pstrut\" style=\"height:3.216em;\"></span><span style=\"height:1.216em;width:0.6667em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.6667em' height='1.216em' style='width:0.6667em' viewBox='0 0 666.67 1216' preserveAspectRatio='xMinYMin'><path d='M263 0 H347 V1216 H263z M263 0 H347 V1216 H263z'/></svg></span></span><span style=\"top:-4.7111em;\"><span class=\"pstrut\" style=\"height:3.216em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎤</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.15em;\"><span></span></span></span></span></span></span></span></span></span></span>","key":"VvpN4ruhHa"},{"type":"text","value":".","position":{"start":{"line":317,"column":1},"end":{"line":317,"column":1}},"key":"oGI6cGrtjS"}],"key":"Lv1f8qlVCS"}],"key":"MTGiQAyIlm"},{"type":"listItem","spread":true,"position":{"start":{"line":329,"column":1},"end":{"line":343,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":329,"column":1},"end":{"line":329,"column":1}},"children":[{"type":"text","value":"✍ Let ","position":{"start":{"line":329,"column":1},"end":{"line":329,"column":1}},"key":"XowBzFJYPE"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":329,"column":1},"end":{"line":329,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"MzJx02Ym7v"},{"type":"text","value":" be a square matrix and ","position":{"start":{"line":329,"column":1},"end":{"line":329,"column":1}},"key":"Rz4If6e6zV"},{"type":"inlineMath","value":"\\mathbf{b}","position":{"start":{"line":329,"column":1},"end":{"line":329,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"pNSD8zxCpJ"},{"type":"text","value":" be a column vector of compatible length. Here is correct Julia code to solve ","position":{"start":{"line":329,"column":1},"end":{"line":329,"column":1}},"key":"otd9vVvVCM"},{"type":"inlineMath","value":"\\mathbf{A}\\mathbf{x}=\\mathbf{b}","position":{"start":{"line":329,"column":1},"end":{"line":329,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi><mi mathvariant=\"bold\">x</mi><mo>=</mo><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}\\mathbf{x}=\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">Ax</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"MrNGZI7MHj"},{"type":"text","value":":","position":{"start":{"line":329,"column":1},"end":{"line":329,"column":1}},"key":"StgCWtqLVN"}],"key":"NgbAmQgyNc"},{"type":"code","lang":"julia","value":"L,U,p = lu(A)\nx = U \\ (L\\b[p])","position":{"start":{"line":331,"column":1},"end":{"line":334,"column":1}},"key":"LfXXFSisu6"},{"type":"paragraph","position":{"start":{"line":336,"column":1},"end":{"line":336,"column":1}},"children":[{"type":"text","value":"Suppose instead you replace the last line above with","position":{"start":{"line":336,"column":1},"end":{"line":336,"column":1}},"key":"TCr5CIj0kP"}],"key":"WlaU4BaIea"},{"type":"code","lang":"julia","value":"x = U \\ L \\ b[p]","position":{"start":{"line":338,"column":1},"end":{"line":340,"column":1}},"key":"K2FpefgUlN"},{"type":"paragraph","position":{"start":{"line":342,"column":1},"end":{"line":342,"column":1}},"children":[{"type":"text","value":"Mathematically in terms of ","position":{"start":{"line":342,"column":1},"end":{"line":342,"column":1}},"key":"KbsmjFUGZQ"},{"type":"inlineMath","value":"\\mathbf{L}","position":{"start":{"line":342,"column":1},"end":{"line":342,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">L</span></span></span></span>","key":"j18tXGzdXV"},{"type":"text","value":", ","position":{"start":{"line":342,"column":1},"end":{"line":342,"column":1}},"key":"jsDv1RSbLI"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":342,"column":1},"end":{"line":342,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"xsr4XnZrrl"},{"type":"text","value":", ","position":{"start":{"line":342,"column":1},"end":{"line":342,"column":1}},"key":"BxwoMeJLJM"},{"type":"inlineMath","value":"\\mathbf{p}","position":{"start":{"line":342,"column":1},"end":{"line":342,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">p</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{p}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6389em;vertical-align:-0.1944em;\"></span><span class=\"mord mathbf\">p</span></span></span></span>","key":"QqK6QnxQGG"},{"type":"text","value":", and ","position":{"start":{"line":342,"column":1},"end":{"line":342,"column":1}},"key":"Hf2dKW2IRt"},{"type":"inlineMath","value":"\\mathbf{b}","position":{"start":{"line":342,"column":1},"end":{"line":342,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"Yqqda5r4Ak"},{"type":"text","value":", what vector is found?","position":{"start":{"line":342,"column":1},"end":{"line":342,"column":1}},"key":"CBr27QxFfe"}],"key":"Fex3BgJDLu"}],"key":"o7HqlK6Z2r"},{"type":"listItem","spread":true,"position":{"start":{"line":344,"column":1},"end":{"line":351,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":344,"column":1},"end":{"line":344,"column":1}},"children":[{"type":"text","value":"✍ Suppose that ","position":{"start":{"line":344,"column":1},"end":{"line":344,"column":1}},"key":"P09FyKc65O"},{"type":"inlineCode","value":"A","position":{"start":{"line":344,"column":1},"end":{"line":344,"column":1}},"key":"lKyDCPxH2g"},{"type":"text","value":" is a ","position":{"start":{"line":344,"column":1},"end":{"line":344,"column":1}},"key":"NcPfGTDqij"},{"type":"inlineMath","value":"4\\times 6","position":{"start":{"line":344,"column":1},"end":{"line":344,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>4</mn><mo>×</mo><mn>6</mn></mrow><annotation encoding=\"application/x-tex\">4\\times 6</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">4</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">6</span></span></span></span>","key":"KmiGSVsamS"},{"type":"text","value":" matrix in Julia and you define","position":{"start":{"line":344,"column":1},"end":{"line":344,"column":1}},"key":"XZ83K7ple5"}],"key":"uUYxODFNCB"},{"type":"code","lang":"julia","value":"B = A[end:-1:1,end:-1:1]","position":{"start":{"line":346,"column":1},"end":{"line":348,"column":1}},"key":"CdQZcw5xz8"},{"type":"paragraph","position":{"start":{"line":350,"column":1},"end":{"line":350,"column":1}},"children":[{"type":"text","value":"Show that ","position":{"start":{"line":350,"column":1},"end":{"line":350,"column":1}},"key":"KC79piSr9T"},{"type":"inlineMath","value":"\\mathbf{B} = \\mathbf{P} \\mathbf{A} \\mathbf{Q}","position":{"start":{"line":350,"column":1},"end":{"line":350,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">B</mi><mo>=</mo><mi mathvariant=\"bold\">P</mi><mi mathvariant=\"bold\">A</mi><mi mathvariant=\"bold\">Q</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{B} = \\mathbf{P} \\mathbf{A} \\mathbf{Q}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">B</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8805em;vertical-align:-0.1944em;\"></span><span class=\"mord mathbf\">PAQ</span></span></span></span>","key":"NhjvCdJLN5"},{"type":"text","value":" for certain matrices ","position":{"start":{"line":350,"column":1},"end":{"line":350,"column":1}},"key":"p11opBkDdZ"},{"type":"inlineMath","value":"\\mathbf{P}","position":{"start":{"line":350,"column":1},"end":{"line":350,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">P</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{P}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">P</span></span></span></span>","key":"EneX0elmIM"},{"type":"text","value":" and ","position":{"start":{"line":350,"column":1},"end":{"line":350,"column":1}},"key":"NYQlK47UTb"},{"type":"inlineMath","value":"\\mathbf{Q}","position":{"start":{"line":350,"column":1},"end":{"line":350,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">Q</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{Q}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8805em;vertical-align:-0.1944em;\"></span><span class=\"mord mathbf\">Q</span></span></span></span>","key":"ghEJGyOYaY"},{"type":"text","value":".","position":{"start":{"line":350,"column":1},"end":{"line":350,"column":1}},"key":"wzRtMFAn9P"}],"key":"C3rQ0BLMvg"}],"key":"PFUiBaOwcF"}],"key":"tvPVeA1Hjd"},{"type":"list","ordered":true,"start":4,"spread":false,"position":{"start":{"line":353,"column":1},"end":{"line":363,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":353,"column":1},"end":{"line":363,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":353,"column":1},"end":{"line":353,"column":1}},"children":[{"type":"text","value":"✍ An ","position":{"start":{"line":353,"column":1},"end":{"line":353,"column":1}},"key":"F0hckB0m55"},{"type":"inlineMath","value":"n\\times n","position":{"start":{"line":353,"column":1},"end":{"line":353,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>×</mo><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n\\times n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"YGKm2BgVSF"},{"type":"text","value":" ","position":{"start":{"line":353,"column":1},"end":{"line":353,"column":1}},"key":"R1npzA3A7h"},{"type":"emphasis","position":{"start":{"line":353,"column":1},"end":{"line":353,"column":1}},"children":[{"type":"text","value":"permutation matrix","position":{"start":{"line":353,"column":1},"end":{"line":353,"column":1}},"key":"hxsaU2TOWE"}],"key":"dEq3lyqgPL"},{"type":"text","value":" ","position":{"start":{"line":353,"column":1},"end":{"line":353,"column":1}},"key":"SbNDWCHaQR"},{"type":"inlineMath","value":"\\mathbf{P}","position":{"start":{"line":353,"column":1},"end":{"line":353,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">P</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{P}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">P</span></span></span></span>","key":"XTkLV0qFdv"},{"type":"text","value":" is a reordering of the rows of an identity matrix such that ","position":{"start":{"line":353,"column":1},"end":{"line":353,"column":1}},"key":"YQK8MnCl4G"},{"type":"inlineMath","value":"\\mathbf{P} \\mathbf{A}","position":{"start":{"line":353,"column":1},"end":{"line":353,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">P</mi><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{P} \\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">PA</span></span></span></span>","key":"aICTjbXjVr"},{"type":"text","value":"  has the effect of moving rows ","position":{"start":{"line":353,"column":1},"end":{"line":353,"column":1}},"key":"AJBkiTdmYS"},{"type":"inlineMath","value":"1,2,\\ldots,n","position":{"start":{"line":353,"column":1},"end":{"line":353,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mo separator=\"true\">,</mo><mn>2</mn><mo separator=\"true\">,</mo><mo>…</mo><mo separator=\"true\">,</mo><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">1,2,\\ldots,n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8389em;vertical-align:-0.1944em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">2</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"y79m55VKdS"},{"type":"text","value":" of ","position":{"start":{"line":353,"column":1},"end":{"line":353,"column":1}},"key":"xdxPqluDuV"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":353,"column":1},"end":{"line":353,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"FlZampyg9R"},{"type":"text","value":" to new positions ","position":{"start":{"line":353,"column":1},"end":{"line":353,"column":1}},"key":"vLsueuOdFA"},{"type":"inlineMath","value":"i_1,i_2,\\ldots,i_n","position":{"start":{"line":353,"column":1},"end":{"line":353,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>i</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><msub><mi>i</mi><mn>2</mn></msub><mo separator=\"true\">,</mo><mo>…</mo><mo separator=\"true\">,</mo><msub><mi>i</mi><mi>n</mi></msub></mrow><annotation encoding=\"application/x-tex\">i_1,i_2,\\ldots,i_n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"m3hLPGDQo2"},{"type":"text","value":". Then ","position":{"start":{"line":353,"column":1},"end":{"line":353,"column":1}},"key":"hsODImJdDe"},{"type":"inlineMath","value":"\\mathbf{P}","position":{"start":{"line":353,"column":1},"end":{"line":353,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">P</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{P}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">P</span></span></span></span>","key":"HPDhc6FcL7"},{"type":"text","value":" can be expressed as","position":{"start":{"line":353,"column":1},"end":{"line":353,"column":1}},"key":"W6PuRlqASu"}],"key":"qaFNoJkFq6"},{"type":"math","value":"\\mathbf{P} = \\mathbf{e}_{i_1}\\mathbf{e}_1^T + \\mathbf{e}_{i_2}\\mathbf{e}_2^T + \\cdots + \\mathbf{e}_{i_n}\\mathbf{e}_n^T.","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi mathvariant=\"bold\">P</mi><mo>=</mo><msub><mi mathvariant=\"bold\">e</mi><msub><mi>i</mi><mn>1</mn></msub></msub><msubsup><mi mathvariant=\"bold\">e</mi><mn>1</mn><mi>T</mi></msubsup><mo>+</mo><msub><mi mathvariant=\"bold\">e</mi><msub><mi>i</mi><mn>2</mn></msub></msub><msubsup><mi mathvariant=\"bold\">e</mi><mn>2</mn><mi>T</mi></msubsup><mo>+</mo><mo>⋯</mo><mo>+</mo><msub><mi mathvariant=\"bold\">e</mi><msub><mi>i</mi><mi>n</mi></msub></msub><msubsup><mi mathvariant=\"bold\">e</mi><mi>n</mi><mi>T</mi></msubsup><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{P} = \\mathbf{e}_{i_1}\\mathbf{e}_1^T + \\mathbf{e}_{i_2}\\mathbf{e}_2^T + \\cdots + \\mathbf{e}_{i_n}\\mathbf{e}_n^T.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">P</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1414em;vertical-align:-0.2501em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">e</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3173em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2501em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathbf\">e</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913em;\"><span style=\"top:-2.453em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1414em;vertical-align:-0.2501em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">e</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3173em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2501em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathbf\">e</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913em;\"><span style=\"top:-2.453em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"minner\">⋯</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1414em;vertical-align:-0.2501em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">e</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1645em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2501em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathbf\">e</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913em;\"><span style=\"top:-2.453em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span><span class=\"mord\">.</span></span></span></span></span>","enumerator":"2.6.3","key":"e9WmxzCzka"},{"type":"paragraph","position":{"start":{"line":359,"column":1},"end":{"line":359,"column":1}},"children":[{"type":"strong","position":{"start":{"line":359,"column":1},"end":{"line":359,"column":1}},"children":[{"type":"text","value":"(a)","position":{"start":{"line":359,"column":1},"end":{"line":359,"column":1}},"key":"avKcyhhyoM"}],"key":"QbjDDmTkQV"},{"type":"text","value":" For the case ","position":{"start":{"line":359,"column":1},"end":{"line":359,"column":1}},"key":"AyqzCjQJsV"},{"type":"inlineMath","value":"n=4","position":{"start":{"line":359,"column":1},"end":{"line":359,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>=</mo><mn>4</mn></mrow><annotation encoding=\"application/x-tex\">n=4</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">4</span></span></span></span>","key":"xiqDdEBduX"},{"type":"text","value":" and ","position":{"start":{"line":359,"column":1},"end":{"line":359,"column":1}},"key":"oJ3p1jHCef"},{"type":"inlineMath","value":"i_1=3","position":{"start":{"line":359,"column":1},"end":{"line":359,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>i</mi><mn>1</mn></msub><mo>=</mo><mn>3</mn></mrow><annotation encoding=\"application/x-tex\">i_1=3</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8095em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">3</span></span></span></span>","key":"C7DSlX0Y2q"},{"type":"text","value":", ","position":{"start":{"line":359,"column":1},"end":{"line":359,"column":1}},"key":"Jz0rSGtzTZ"},{"type":"inlineMath","value":"i_2=2","position":{"start":{"line":359,"column":1},"end":{"line":359,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>i</mi><mn>2</mn></msub><mo>=</mo><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">i_2=2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8095em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span></span></span></span>","key":"tDZDC9626D"},{"type":"text","value":", ","position":{"start":{"line":359,"column":1},"end":{"line":359,"column":1}},"key":"EqjingQtwV"},{"type":"inlineMath","value":"i_3=4","position":{"start":{"line":359,"column":1},"end":{"line":359,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>i</mi><mn>3</mn></msub><mo>=</mo><mn>4</mn></mrow><annotation encoding=\"application/x-tex\">i_3=4</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8095em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">4</span></span></span></span>","key":"YLYdoJtCtH"},{"type":"text","value":", ","position":{"start":{"line":359,"column":1},"end":{"line":359,"column":1}},"key":"Fnr43Y8zGO"},{"type":"inlineMath","value":"i_4=1","position":{"start":{"line":359,"column":1},"end":{"line":359,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>i</mi><mn>4</mn></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">i_4=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8095em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">4</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"Lx0nTyE4Ke"},{"type":"text","value":", write out separately, as matrices, all four of the terms in the sum. Then add them together to find ","position":{"start":{"line":359,"column":1},"end":{"line":359,"column":1}},"key":"i0c4IEZlfX"},{"type":"inlineMath","value":"\\mathbf{P}","position":{"start":{"line":359,"column":1},"end":{"line":359,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">P</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{P}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">P</span></span></span></span>","key":"lgSkmWcBXi"},{"type":"text","value":".","position":{"start":{"line":359,"column":1},"end":{"line":359,"column":1}},"key":"Cp3nGqAG7W"}],"key":"vrhRrhxIsn"},{"type":"paragraph","position":{"start":{"line":361,"column":1},"end":{"line":361,"column":1}},"children":[{"type":"strong","position":{"start":{"line":361,"column":1},"end":{"line":361,"column":1}},"children":[{"type":"text","value":"(b)","position":{"start":{"line":361,"column":1},"end":{"line":361,"column":1}},"key":"ytJXauW4Gv"}],"key":"AXKMoRFfzc"},{"type":"text","value":" Use the formula in the general case to show that ","position":{"start":{"line":361,"column":1},"end":{"line":361,"column":1}},"key":"Pne3JVRbaS"},{"type":"inlineMath","value":"\\mathbf{P}^{-1}=\\mathbf{P}^T","position":{"start":{"line":361,"column":1},"end":{"line":361,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi mathvariant=\"bold\">P</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo>=</mo><msup><mi mathvariant=\"bold\">P</mi><mi>T</mi></msup></mrow><annotation encoding=\"application/x-tex\">\\mathbf{P}^{-1}=\\mathbf{P}^T</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">P</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8413em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">P</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span></span></span></span>","key":"Zg9pj7zvTe"},{"type":"text","value":".","position":{"start":{"line":361,"column":1},"end":{"line":361,"column":1}},"key":"HGj9usDcDU"}],"key":"ggl2q9nBdI"}],"key":"USuVUto71O"}],"label":"problem-perminverse","identifier":"problem-perminverse","html_id":"problem-perminverse","key":"Cd3rok0sNi"},{"type":"footnoteDefinition","identifier":"plu","label":"PLU","position":{"start":{"line":361,"column":1},"end":{"line":361,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":155,"column":1},"end":{"line":155,"column":1}},"children":[{"type":"text","value":"Because unpivoted LU factorization is not useful, in practice the term ","position":{"start":{"line":155,"column":1},"end":{"line":155,"column":1}},"key":"DnuIMz2Fym"},{"type":"emphasis","position":{"start":{"line":155,"column":1},"end":{"line":155,"column":1}},"children":[{"type":"text","value":"LU factorization","position":{"start":{"line":155,"column":1},"end":{"line":155,"column":1}},"key":"Gymv9pSevA"}],"key":"jm7BEjgVIo"},{"type":"text","value":" mostly refers to pivoted LU.","position":{"start":{"line":155,"column":1},"end":{"line":155,"column":1}},"key":"IxS5zVqoA1"}],"key":"nKJfXtBagQ"}],"number":1,"enumerator":"1","key":"ZJHOOkyRif"}],"key":"HL9lZ9pMzP"}],"key":"Cg0lDYIyCZ"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Efficiency of matrix computations","url":"/efficiency","group":"Preface"},"next":{"title":"Vector and matrix norms","url":"/norms","group":"Preface"}}},"domain":"http://localhost:3000"}