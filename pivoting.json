{"version":2,"kind":"Article","sha256":"7d789f0b760e2b6eaf673c8332f1286dd089960ce22c83e2dc8b7efc67eb8ce4","slug":"pivoting","location":"/chapter2/pivoting.md","dependencies":[{"url":"/chapter2","label":"demo-pivoting-fail-julia","kind":"Notebook","slug":"chapter2","location":"/julia/chapter2.md","title":"Chapter 2"},{"url":"/chapter2-1","label":"demo-pivoting-fail-matlab","kind":"Notebook","slug":"chapter2-1","location":"/matlab/chapter2.md","title":"Chapter 2"},{"url":"/chapter2-2","label":"demo-pivoting-fail-python","kind":"Notebook","slug":"chapter2-2","location":"/python/chapter2.md","title":"Chapter 2"}],"frontmatter":{"title":"Row pivoting","numbering":{"heading_1":{"enabled":true},"heading_2":{"enabled":true},"heading_3":{"enabled":false},"enumerator":{"enumerator":"2.6.%s"},"title":{"offset":1}},"content_includes_title":false,"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","TPBVP":"two-point boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"source_url":"https://github.com/fncbook/fnc/blob/master/chapter2/pivoting.md","edit_url":"https://github.com/fncbook/fnc/edit/master/chapter2/pivoting.md","exports":[{"format":"md","filename":"pivoting.md","url":"/build/pivoting-9fec202d2bf0b08f388a566e0a45d06a.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"As mentioned in ","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"UWwI8CwR1z"},{"type":"link","kind":"numref","identifier":"section-linsys-lu","label":"section-linsys-lu","url":"/lu","internal":true,"dataUrl":"/lu.json","children":[{"type":"text","value":"LU factorization","key":"a02b7gszVc"}],"key":"redIUX8wTC"},{"type":"text","value":", the ","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"HoFsYwXC12"},{"type":"inlineMath","value":"\\mathbf{A}=\\mathbf{L}\\mathbf{U}","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi><mo>=</mo><mi mathvariant=\"bold\">L</mi><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}=\\mathbf{L}\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">LU</span></span></span></span>","key":"UrC4qYT0K9"},{"type":"text","value":" factorization is not stable for every nonsingular ","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"TrjMEVLvmi"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"HEoXM8HGsu"},{"type":"text","value":". Indeed, the factorization does not always even exist.","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"qhDISWtTw2"}],"indexEntries":[{"entry":"matrix factorization","subEntry":{"value":"LU","kind":"entry"},"emphasis":false}],"label":"index-wVGCqpuRho","identifier":"index-wvgcqpurho","html_id":"index-wvgcqpurho","key":"VXWbcQ9ut8"},{"type":"proof","kind":"example","enumerated":true,"children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Failure of naive LU factorization","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"tCfFyC0KZC"}],"key":"y0ggMTfwJv"},{"type":"tabSet","children":[{"type":"tabItem","title":"Julia","sync":"julia","children":[{"type":"embed","source":{"url":"/chapter2","label":"demo-pivoting-fail-julia","kind":"Notebook","slug":"chapter2","location":"/julia/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-pivoting-fail","label":"demo-pivoting-fail","kind":"proof:example","position":{"start":{"line":833,"column":1},"end":{"line":833,"column":20}},"children":[{"type":"text","value":"Example ","key":"fma8pptM55"},{"type":"text","value":"2.6.1","key":"o75LQn9K3E"}],"template":"Example %s","enumerator":"2.6.1","resolved":true,"html_id":"demo-pivoting-fail","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"nfP3m2VnBM"}],"key":"fIcyZ6ehyA"},{"type":"paragraph","position":{"start":{"line":835,"column":1},"end":{"line":835,"column":1}},"children":[{"type":"text","value":"Here is a previously encountered matrix that factors well.","position":{"start":{"line":835,"column":1},"end":{"line":835,"column":1}},"key":"gKxdnugLQ0"}],"key":"y4jm76Fgv6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"A = [2 0 4 3 ; -4 5 -7 -10 ; 1 15 2 -4.5 ; -2 0 2 -13];\nL, U = FNC.lufact(A)\nL","key":"E2On14tBZj"},{"type":"output","id":"M3QmaPEe3nXfOfI8Aak7l","data":[{"output_type":"execute_result","execution_count":78,"metadata":{},"data":{"text/plain":{"content":"4×4 LowerTriangular{Float64, Matrix{Float64}}:\n  1.0   ⋅     ⋅    ⋅ \n -2.0  1.0    ⋅    ⋅ \n  0.5  3.0   1.0   ⋅ \n -1.0  0.0  -2.0  1.0","content_type":"text/plain"}}}],"key":"fUDE3fnEVE"}],"key":"NLmkjrzHQx"},{"type":"paragraph","position":{"start":{"line":843,"column":1},"end":{"line":843,"column":1}},"children":[{"type":"text","value":"If we swap the second and fourth rows of ","position":{"start":{"line":843,"column":1},"end":{"line":843,"column":1}},"key":"wvR1O6wN0j"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":843,"column":1},"end":{"line":843,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"fab0kuvDkq"},{"type":"text","value":", the result is still nonsingular. However, the factorization now fails.","position":{"start":{"line":843,"column":1},"end":{"line":843,"column":1}},"key":"fI3PP7p38U"}],"key":"m7To5AwpGz"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"A[[2, 4], :] = A[[4, 2], :]  \nL, U = FNC.lufact(A)\nL","key":"ix3chKNGl7"},{"type":"output","id":"zAoi3WVjaQJVdSIpw8107","data":[{"output_type":"execute_result","execution_count":79,"metadata":{},"data":{"text/plain":{"content":"4×4 LowerTriangular{Float64, Matrix{Float64}}:\n  1.0     ⋅      ⋅    ⋅ \n -1.0  NaN       ⋅    ⋅ \n  0.5   Inf   NaN     ⋅ \n -2.0   Inf   NaN    1.0","content_type":"text/plain"}}}],"key":"cCsA7j1GU8"}],"key":"gJwps3Drat"},{"type":"paragraph","position":{"start":{"line":854,"column":1},"end":{"line":854,"column":1}},"children":[{"type":"text","value":"The presence of ","position":{"start":{"line":854,"column":1},"end":{"line":854,"column":1}},"key":"W5v66ZKOeS"},{"type":"inlineCode","value":"NaN","position":{"start":{"line":854,"column":1},"end":{"line":854,"column":1}},"key":"le28T1qSMP"},{"type":"text","value":" in the result indicates that some impossible operation was required. The source of the problem is easy to locate. We can find the first outer product in the factorization just fine:","position":{"start":{"line":854,"column":1},"end":{"line":854,"column":1}},"key":"zqa2Ddto4Q"}],"indexEntries":[{"entry":"Julia","subEntry":{"value":"NaN","kind":"entry"},"emphasis":false}],"key":"dHLtEVshnu"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"U[1, :] = A[1, :]\nL[:, 1] = A[:, 1] / U[1, 1]\nA -= L[:, 1] * U[1, :]'","key":"bKAn7KOWlE"},{"type":"output","id":"S1jgQACvN-qlLNXshJdv_","data":[{"output_type":"execute_result","execution_count":80,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n 0.0   0.0  0.0    0.0\n 0.0   0.0  6.0  -10.0\n 0.0  15.0  0.0   -6.0\n 0.0   5.0  1.0   -4.0","content_type":"text/plain"}}}],"key":"bBDg0P3j8z"}],"key":"guiFmk4jIb"},{"type":"paragraph","position":{"start":{"line":862,"column":1},"end":{"line":862,"column":1}},"children":[{"type":"text","value":"The next step is ","position":{"start":{"line":862,"column":1},"end":{"line":862,"column":1}},"key":"xbIgM0JIwl"},{"type":"inlineCode","value":"U[2, :] = A[2, :]","position":{"start":{"line":862,"column":1},"end":{"line":862,"column":1}},"key":"g6VJzZlRQJ"},{"type":"text","value":", which is also OK. But then we are supposed to divide by ","position":{"start":{"line":862,"column":1},"end":{"line":862,"column":1}},"key":"C2M3Cv3pTj"},{"type":"inlineCode","value":"U[2, 2]","position":{"start":{"line":862,"column":1},"end":{"line":862,"column":1}},"key":"zTCFXevhUH"},{"type":"text","value":", which is zero. The algorithm cannot continue.","position":{"start":{"line":862,"column":1},"end":{"line":862,"column":1}},"key":"QI9VYsWfP7"}],"key":"LMzNBk3mwH"}],"key":"wpJsJtoEss"}],"key":"M7WacGL1EB"}],"key":"keB877CpxR"},{"type":"tabItem","title":"MATLAB","sync":"matlab","children":[{"type":"embed","source":{"url":"/chapter2-1","label":"demo-pivoting-fail-matlab","kind":"Notebook","slug":"chapter2-1","location":"/matlab/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-pivoting-fail","label":"demo-pivoting-fail","kind":"proof:example","position":{"start":{"line":769,"column":1},"end":{"line":769,"column":20}},"children":[{"type":"text","value":"Example ","key":"yfhJHljWdT"},{"type":"text","value":"2.6.1","key":"yz9e3RLlCx"}],"template":"Example %s","enumerator":"2.6.1","resolved":true,"html_id":"demo-pivoting-fail","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"SW3ZD9l43a"}],"key":"GpR5yUrbOV"},{"type":"paragraph","position":{"start":{"line":771,"column":1},"end":{"line":771,"column":1}},"children":[{"type":"text","value":"Here is a previously encountered matrix that factors well.","position":{"start":{"line":771,"column":1},"end":{"line":771,"column":1}},"key":"IJybpRF0HJ"}],"key":"GptHZgFeyC"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A = [\n    2 0 4 3\n    -4 5 -7 -10\n    1 15 2 -4.5\n    -2 0 2 -13\n    ];\n[L, U] = lufact(A);\nL","key":"hAHAanLn3u"},{"type":"output","id":"GKnf5y5sW0qNxV-WW2hB9","data":[{"output_type":"execute_result","execution_count":76,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>L = 4×4 double\n    1.0000         0         0         0\n   -2.0000    1.0000         0         0\n    0.5000    3.0000    1.0000         0\n   -1.0000         0   -2.0000    1.0000\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"L = 4×4 double\n    1.0000         0         0         0\n   -2.0000    1.0000         0         0\n    0.5000    3.0000    1.0000         0\n   -1.0000         0   -2.0000    1.0000\n","content_type":"text/plain"}}}],"key":"eV0lJp0PoN"}],"key":"UKLP3XWdtv"},{"type":"paragraph","position":{"start":{"line":784,"column":1},"end":{"line":784,"column":1}},"children":[{"type":"text","value":"If we swap the second and fourth rows of ","position":{"start":{"line":784,"column":1},"end":{"line":784,"column":1}},"key":"wo3V2j9xIN"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":784,"column":1},"end":{"line":784,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"fHNiFPjEyi"},{"type":"text","value":", the result is still nonsingular. However, the factorization now fails.","position":{"start":{"line":784,"column":1},"end":{"line":784,"column":1}},"key":"LdktltecPt"}],"key":"CANmyNTaWB"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A([2, 4], :) = A([4, 2], :);    % swap rows 2 and 4\n[L, U] = lufact(A);\nL","key":"El93yOCX3J"},{"type":"output","id":"fIBDH-Az4MmaaEdwVk4cD","data":[{"output_type":"execute_result","execution_count":77,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>L = 4×4 double\n    1.0000         0         0         0\n   -1.0000       NaN         0         0\n    0.5000       Inf       NaN         0\n   -2.0000       Inf       NaN    1.0000\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"L = 4×4 double\n    1.0000         0         0         0\n   -1.0000       NaN         0         0\n    0.5000       Inf       NaN         0\n   -2.0000       Inf       NaN    1.0000\n","content_type":"text/plain"}}}],"key":"Bhq7QWycve"}],"key":"FxmkizoIaa"},{"type":"paragraph","position":{"start":{"line":795,"column":1},"end":{"line":795,"column":1}},"children":[{"type":"text","value":"The presence of ","position":{"start":{"line":795,"column":1},"end":{"line":795,"column":1}},"key":"fI8cZQzkeL"},{"type":"inlineCode","value":"NaN","position":{"start":{"line":795,"column":1},"end":{"line":795,"column":1}},"key":"CK4FBhsOru"},{"type":"text","value":" in the result indicates that some impossible operation was required. The source of the problem is easy to locate. We can find the first outer product in the factorization just fine:","position":{"start":{"line":795,"column":1},"end":{"line":795,"column":1}},"key":"oKMjcBxhkh"}],"indexEntries":[{"entry":"MATLAB","subEntry":{"value":"NaN","kind":"entry"},"emphasis":false}],"key":"yn7QyIHMRq"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"U(1, :) = A(1, :);\nL(:, 1) = A(:, 1) / U(1, 1)\nA = A - L(:, 1) * U(1, :)","key":"nzQZEXcdzG"},{"type":"output","id":"lBQKmQ0XpEQEb5fPpBM61","data":[{"output_type":"execute_result","execution_count":78,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>L = 4×4 double\n    1.0000         0         0         0\n   -1.0000       NaN         0         0\n    0.5000       Inf       NaN         0\n   -2.0000       Inf       NaN    1.0000\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"L = 4×4 double\n    1.0000         0         0         0\n   -1.0000       NaN         0         0\n    0.5000       Inf       NaN         0\n   -2.0000       Inf       NaN    1.0000\n","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":78,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>A = 4×4 double\n     0     0     0     0\n     0     0     6   -10\n     0    15     0    -6\n     0     5     1    -4\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"A = 4×4 double\n     0     0     0     0\n     0     0     6   -10\n     0    15     0    -6\n     0     5     1    -4\n","content_type":"text/plain"}}}],"key":"vSVsV9IjQg"}],"key":"Q1SZkpkdUd"},{"type":"paragraph","position":{"start":{"line":803,"column":1},"end":{"line":803,"column":1}},"children":[{"type":"text","value":"The next step is ","position":{"start":{"line":803,"column":1},"end":{"line":803,"column":1}},"key":"PWs5H3s28i"},{"type":"inlineCode","value":"U(2, :) = A(2, :)","position":{"start":{"line":803,"column":1},"end":{"line":803,"column":1}},"key":"Pk2iKwBBBN"},{"type":"text","value":", which is also OK. But then we are supposed to divide by ","position":{"start":{"line":803,"column":1},"end":{"line":803,"column":1}},"key":"HVPmqiuIsC"},{"type":"inlineCode","value":"U(2, 2)","position":{"start":{"line":803,"column":1},"end":{"line":803,"column":1}},"key":"dXMskRyjMe"},{"type":"text","value":", which is zero. The algorithm cannot continue.","position":{"start":{"line":803,"column":1},"end":{"line":803,"column":1}},"key":"MgwOvKhtBG"}],"key":"aVc0CZ0FKk"}],"key":"bArdrgwvNz"}],"key":"F2NokVkzDW"}],"key":"MQ9reKv86I"},{"type":"tabItem","title":"Python","sync":"python","children":[{"type":"embed","source":{"url":"/chapter2-2","label":"demo-pivoting-fail-python","kind":"Notebook","slug":"chapter2-2","location":"/python/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-pivoting-fail","label":"demo-pivoting-fail","kind":"proof:example","position":{"start":{"line":752,"column":1},"end":{"line":752,"column":20}},"children":[{"type":"text","value":"Example ","key":"hUofqFgWoX"},{"type":"text","value":"2.6.1","key":"pHN0uU5V7T"}],"template":"Example %s","enumerator":"2.6.1","resolved":true,"html_id":"demo-pivoting-fail","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"NwRnCgX4ab"}],"key":"eDlEaucvv5"},{"type":"paragraph","position":{"start":{"line":754,"column":1},"end":{"line":754,"column":1}},"children":[{"type":"text","value":"Here is a previously encountered matrix that factors well.","position":{"start":{"line":754,"column":1},"end":{"line":754,"column":1}},"key":"wSHaCHfKpJ"}],"key":"KZGayCUq0C"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"A = array([\n    [2, 0, 4, 3],\n    [-4, 5, -7, -10],\n    [1, 15, 2, -4.5],\n    [-2, 0, 2, -13]\n    ])\nL, U = FNC.lufact(A)\nprint(L)","key":"eyqrlKK47j"},{"type":"output","id":"JxfDSeu3U_c4PRdpIN328","data":[{"output_type":"stream","name":"stdout","text":"[[ 1.   0.  -0.   0. ]\n [-2.   1.  -0.   0. ]\n [ 0.5  3.   1.   0. ]\n [-1.   0.  -2.   1. ]]\n"}],"key":"a5uj0rvga4"}],"key":"HrdjXwJUcg"},{"type":"paragraph","position":{"start":{"line":767,"column":1},"end":{"line":767,"column":1}},"children":[{"type":"text","value":"If we swap the second and fourth rows of ","position":{"start":{"line":767,"column":1},"end":{"line":767,"column":1}},"key":"G29irObKA7"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":767,"column":1},"end":{"line":767,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"JGp0Ga895x"},{"type":"text","value":", the result is still nonsingular. However, the factorization now fails.","position":{"start":{"line":767,"column":1},"end":{"line":767,"column":1}},"key":"JKDreMPGbW"}],"key":"eXB3tuYPyg"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"A[[1, 3], :] = A[[3, 1], :]  \nL, U = FNC.lufact(A)\nprint(L)","key":"Tr69gVFUTP"},{"type":"output","id":"TIPNlfbtk9ydHWeKqoPLI","data":[{"output_type":"stream","name":"stdout","text":"[[ 1.   nan  nan  0. ]\n [-1.   nan  nan  0. ]\n [ 0.5  inf  nan  0. ]\n [-2.   inf  nan  1. ]]\n"},{"output_type":"stream","name":"stderr","text":"/Users/driscoll/miniforge3/envs/myst/lib/python3.13/site-packages/fncbook/chapter02.py:47: RuntimeWarning: divide by zero encountered in divide\n  L[:, k] = A_k[:, k] / U[k,k]\n/Users/driscoll/miniforge3/envs/myst/lib/python3.13/site-packages/fncbook/chapter02.py:47: RuntimeWarning: invalid value encountered in divide\n  L[:, k] = A_k[:, k] / U[k,k]\n/Users/driscoll/miniforge3/envs/myst/lib/python3.13/site-packages/numpy/_core/numeric.py:961: RuntimeWarning: invalid value encountered in multiply\n  return multiply(a.ravel()[:, newaxis], b.ravel()[newaxis, :], out)\n"}],"key":"ImVu0RMcHd"}],"key":"BcIetrGnMO"},{"type":"paragraph","position":{"start":{"line":778,"column":1},"end":{"line":778,"column":1}},"children":[{"type":"text","value":"The presence of ","position":{"start":{"line":778,"column":1},"end":{"line":778,"column":1}},"key":"wThOxHfGeU"},{"type":"inlineCode","value":"NaN","position":{"start":{"line":778,"column":1},"end":{"line":778,"column":1}},"key":"hi67JefnJ4"},{"type":"text","value":" in the result indicates that some impossible operation was required. The source of the problem is easy to locate. We can find the first outer product in the factorization just fine:","position":{"start":{"line":778,"column":1},"end":{"line":778,"column":1}},"key":"pkxEGmOuMg"}],"indexEntries":[{"entry":"Python","subEntry":{"value":"NaN","kind":"entry"},"emphasis":false}],"key":"vghStcjxyV"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"U[0, :] = A[0, :]\nL[:, 0] = A[:, 0] / U[0, 0]\nA -= outer(L[:, 0],  U[0, :])\nprint(A)","key":"vd8IZ3zOiw"},{"type":"output","id":"cPtGrzfXrQi5oIv8f9ycL","data":[{"output_type":"stream","name":"stdout","text":"[[  0.   0.   0.   0.]\n [  0.   0.   6. -10.]\n [  0.  15.   0.  -6.]\n [  0.   5.   1.  -4.]]\n"}],"key":"xiY51pGuxu"}],"key":"fp2JiDOEZS"},{"type":"paragraph","position":{"start":{"line":787,"column":1},"end":{"line":787,"column":1}},"children":[{"type":"text","value":"The next step is ","position":{"start":{"line":787,"column":1},"end":{"line":787,"column":1}},"key":"pzjt1vSgtm"},{"type":"inlineCode","value":"U[1, :] = A[1, :]","position":{"start":{"line":787,"column":1},"end":{"line":787,"column":1}},"key":"rjS6gpSyJb"},{"type":"text","value":", which is also OK. But then we are supposed to divide by ","position":{"start":{"line":787,"column":1},"end":{"line":787,"column":1}},"key":"wqaULLYZfq"},{"type":"inlineCode","value":"U[1, 1]","position":{"start":{"line":787,"column":1},"end":{"line":787,"column":1}},"key":"tJPP3zL3lG"},{"type":"text","value":", which is zero. The algorithm cannot continue.","position":{"start":{"line":787,"column":1},"end":{"line":787,"column":1}},"key":"PDTD1mCj3n"}],"key":"XUm6zEN3Dz"}],"key":"jkywTHucRk"}],"key":"rOvfdYxOFK"}],"key":"B7DoRYJ1vg"}],"key":"XoElEJJtct"}],"label":"demo-pivoting-fail","identifier":"demo-pivoting-fail","enumerator":"2.6.1","html_id":"demo-pivoting-fail","key":"UEe2kbwit4"},{"type":"paragraph","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"children":[{"type":"text","value":"In ","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"key":"P8G26HqUpj"},{"type":"link","kind":"numref","identifier":"section-linsys-lu","label":"section-linsys-lu","url":"/lu","internal":true,"dataUrl":"/lu.json","children":[{"type":"text","value":"LU factorization","key":"rdmfb9dkyU"}],"key":"tzXe7fVM7P"},{"type":"text","value":" we remarked that LU factorization is equivalent to Gaussian elimination with no row swaps. However, those swaps are necessary in situations like those encountered in ","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"key":"wJ2joSFQUI"},{"type":"crossReference","identifier":"demo-pivoting-fail","label":"demo-pivoting-fail","kind":"proof:example","position":{"start":{"line":39,"column":198},"end":{"line":39,"column":217}},"children":[{"type":"text","value":"Example ","key":"ehncyRqSs5"},{"type":"text","value":"2.6.1","key":"Ld7DYEfwbw"}],"template":"Example %s","enumerator":"2.6.1","resolved":true,"html_id":"demo-pivoting-fail","key":"ZZns344jfS"},{"type":"text","value":", in order to avoid division by zero. We will find a modification of the outer product procedure that allows us to do the same thing.","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"key":"nrUUldxj1p"}],"key":"BrEchNtnMz"},{"type":"heading","depth":2,"position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"children":[{"type":"text","value":"Choosing a pivot","position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"key":"FScel7EVFy"}],"identifier":"choosing-a-pivot","label":"Choosing a pivot","html_id":"choosing-a-pivot","implicit":true,"enumerator":"2.6.1","key":"LqaThVakRT"},{"type":"paragraph","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"children":[{"type":"text","value":"The diagonal element of ","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"key":"XTm48gccff"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"g9ctbDLxB3"},{"type":"text","value":" that appears in the denominator of line 17 of ","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"key":"MzhDTr1dHH"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-lufact","label":"function-lufact","children":[{"type":"text","value":"Function ","key":"Ws6a0xtJbK"},{"type":"text","value":"2.4.1","key":"rhM8jgOipf"}],"template":"Algorithm %s","enumerator":"2.4.1","resolved":true,"html_id":"function-lufact","remote":true,"url":"/lu","dataUrl":"/lu.json","key":"BeTlOuXAxE"},{"type":"text","value":" is called the ","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"key":"vUUVMage6A"},{"type":"strong","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"children":[{"type":"text","value":"pivot element","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"key":"isnCjNy8Rj"}],"key":"MlE97F4ts7"},{"type":"text","value":" of its column. In order to avoid a zero pivot, we will use the largest available element in the column we are working on as the pivot. This technique is known as ","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"key":"FTvNaQeNNY"},{"type":"strong","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"children":[{"type":"text","value":"row pivoting","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"key":"HxBDNCqAwS"}],"key":"O1oTDxtRWT"},{"type":"text","value":".","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"key":"u4cJMcvLnM"}],"indexEntries":[{"entry":"pivoting","emphasis":true}],"label":"index-UJR2PhDqth","identifier":"index-ujr2phdqth","html_id":"index-ujr2phdqth","key":"hhcfFuDL5x"},{"type":"proof","kind":"definition","enumerated":true,"children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Row pivoting","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"key":"PEXDkCUxFL"}],"key":"cGeRzqxEQD"},{"type":"paragraph","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"children":[{"type":"text","value":"When performing elimination in column ","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"key":"Uv3tYs5qH4"},{"type":"inlineMath","value":"j","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>j</mi></mrow><annotation encoding=\"application/x-tex\">j</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span></span></span></span>","key":"LSTChtWtq5"},{"type":"text","value":", choose as the pivot the element in column ","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"key":"EL0tA9idQ9"},{"type":"inlineMath","value":"j","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>j</mi></mrow><annotation encoding=\"application/x-tex\">j</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span></span></span></span>","key":"o536nQQDSL"},{"type":"text","value":" that is largest in absolute value. (In case of ties, choose the lowest row index.)","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"key":"xyeNeocLlN"}],"key":"qDIGHdl5ju"}],"label":"definition-pivoting","identifier":"definition-pivoting","enumerator":"2.6.1","html_id":"definition-pivoting","key":"Ex3t9lRgPi"},{"type":"proof","kind":"example","enumerated":true,"children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Row pivoting in LU factorization","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"pwzsWwljw8"}],"key":"Md9Tp9CXO8"},{"type":"tabSet","children":[{"type":"tabItem","title":"Julia","sync":"julia","children":[{"type":"embed","source":{"url":"/chapter2","label":"demo-pivoting-fix-julia","kind":"Notebook","slug":"chapter2","location":"/julia/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-pivoting-fix","label":"demo-pivoting-fix","kind":"proof:example","position":{"start":{"line":866,"column":1},"end":{"line":866,"column":19}},"children":[{"type":"text","value":"Example ","key":"NDZmaOpFUs"},{"type":"text","value":"2.6.2","key":"ac1CQjqIXF"}],"template":"Example %s","enumerator":"2.6.2","resolved":true,"html_id":"demo-pivoting-fix","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"HpcNZsHxGm"}],"key":"OWitiB8Dba"},{"type":"paragraph","position":{"start":{"line":868,"column":1},"end":{"line":868,"column":1}},"children":[{"type":"text","value":"Here is the trouble-making matrix from ","position":{"start":{"line":868,"column":1},"end":{"line":868,"column":1}},"key":"dfIzlWD8Kg"},{"type":"crossReference","identifier":"demo-pivoting-fail","label":"demo-pivoting-fail","kind":"proof:example","position":{"start":{"line":868,"column":40},"end":{"line":868,"column":59}},"children":[{"type":"text","value":"Example ","key":"eZSkgCxT4d"},{"type":"text","value":"2.6.1","key":"YAcnp2r4jU"}],"template":"Example %s","enumerator":"2.6.1","resolved":true,"html_id":"demo-pivoting-fail","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"PRJR3ehw9I"},{"type":"text","value":".","position":{"start":{"line":868,"column":1},"end":{"line":868,"column":1}},"key":"vHwdgwKRd1"}],"key":"WusbCiaJvS"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"A₁ = [2 0 4 3 ; -2 0 2 -13; 1 15 2 -4.5 ; -4 5 -7 -10]","key":"R3xD4nvp1p"},{"type":"output","id":"5OCm6TpcFnYdP7G_-nvsC","data":[{"output_type":"execute_result","execution_count":81,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n  2.0   0.0   4.0    3.0\n -2.0   0.0   2.0  -13.0\n  1.0  15.0   2.0   -4.5\n -4.0   5.0  -7.0  -10.0","content_type":"text/plain"}}}],"key":"TkXpSs8J8j"}],"key":"YsLRapgmb1"},{"type":"paragraph","position":{"start":{"line":874,"column":1},"end":{"line":874,"column":1}},"children":[{"type":"text","value":"We now find the largest candidate pivot in the first column. We don’t care about sign, so we take absolute values before finding the max.","position":{"start":{"line":874,"column":1},"end":{"line":874,"column":1}},"key":"uOhaSs1n5u"}],"key":"qdRFFBgkPU"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"HrT8xWk6cr"}],"key":"Y3N7ekWNPs"},{"type":"paragraph","position":{"start":{"line":877,"column":1},"end":{"line":877,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":877,"column":1},"end":{"line":877,"column":1}},"key":"QLLNtmEerT"},{"type":"inlineCode","value":"argmax","position":{"start":{"line":877,"column":1},"end":{"line":877,"column":1}},"key":"n9FyBpVb8W"},{"type":"text","value":" function returns the location of the largest element of a vector or matrix.","position":{"start":{"line":877,"column":1},"end":{"line":877,"column":1}},"key":"THLhKZF0xZ"}],"key":"jQYMyaYDCI"}],"class":"dropdown","key":"ce4oMHD0fz"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"i = argmax( abs.(A₁[:, 1]) )","key":"LUKxkhJFtW"},{"type":"output","id":"HtzqGcI0L93rOazoIuGtt","data":[{"output_type":"execute_result","execution_count":82,"metadata":{},"data":{"text/plain":{"content":"4","content_type":"text/plain"}}}],"key":"L6j8OKkUld"}],"key":"whcZCLedNh"},{"type":"paragraph","position":{"start":{"line":885,"column":1},"end":{"line":885,"column":1}},"children":[{"type":"text","value":"This is the row of the matrix that we extract to put into ","position":{"start":{"line":885,"column":1},"end":{"line":885,"column":1}},"key":"I7NuDWGEeT"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":885,"column":1},"end":{"line":885,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"jiPfcuREdI"},{"type":"text","value":". That guarantees that the division used to find ","position":{"start":{"line":885,"column":1},"end":{"line":885,"column":1}},"key":"XWKUnb1JAg"},{"type":"inlineMath","value":"\\boldsymbol{\\ell}_1","position":{"start":{"line":885,"column":1},"end":{"line":885,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">ℓ</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\boldsymbol{\\ell}_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">ℓ</span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"r9LmeXsDJz"},{"type":"text","value":" will be valid.","position":{"start":{"line":885,"column":1},"end":{"line":885,"column":1}},"key":"ZtHrDkakWi"}],"key":"cVa7Op4vBM"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"L, U = zeros(4,4),zeros(4,4)\nU[1, :] = A₁[i, :]\nL[:, 1] = A₁[:, 1] / U[1, 1]\nA₂ = A₁ - L[:, 1] * U[1, :]'","key":"F95wPigQkU"},{"type":"output","id":"-VAPKOy_-Q5F0Jj8V_ggT","data":[{"output_type":"execute_result","execution_count":83,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n 0.0   2.5   0.5   -2.0\n 0.0  -2.5   5.5   -8.0\n 0.0  16.25  0.25  -7.0\n 0.0   0.0   0.0    0.0","content_type":"text/plain"}}}],"key":"thtBXxnW0M"}],"key":"biB2HTfKJs"},{"type":"paragraph","position":{"start":{"line":894,"column":1},"end":{"line":894,"column":1}},"children":[{"type":"text","value":"Observe that ","position":{"start":{"line":894,"column":1},"end":{"line":894,"column":1}},"key":"q7ZGoUz6uU"},{"type":"inlineMath","value":"\\mathbf{A}_2","position":{"start":{"line":894,"column":1},"end":{"line":894,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">A</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8361em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"QeAXsgGnii"},{"type":"text","value":" has a new zero row and zero column, but the zero row is the fourth rather than the first. However, we forge on by using the largest possible pivot in column 2 for the next outer product.","position":{"start":{"line":894,"column":1},"end":{"line":894,"column":1}},"key":"W1CWxLuc4d"}],"key":"L61MHa1aNA"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"@show i = argmax( abs.(A₂[:, 2]) ) \nU[2, :] = A₂[i, :]\nL[:, 2] = A₂[:, 2] / U[2, 2]\nA₃ = A₂ - L[:, 2] * U[2, :]'","key":"hZ7pixMpwb"},{"type":"output","id":"3le3jBWkvQPNMA2fmRWVI","data":[{"output_type":"stream","name":"stdout","text":"i = argmax(abs.(A₂[:, 2])) = 3\n"},{"output_type":"execute_result","execution_count":84,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n 0.0  0.0  0.461538  -0.923077\n 0.0  0.0  5.53846   -9.07692\n 0.0  0.0  0.0        0.0\n 0.0  0.0  0.0        0.0","content_type":"text/plain"}}}],"key":"qC1Z0PKgwT"}],"key":"yJbddxkAyG"},{"type":"paragraph","position":{"start":{"line":903,"column":1},"end":{"line":903,"column":1}},"children":[{"type":"text","value":"Now we have zeroed out the third row as well as the second column. We can finish out the procedure.","position":{"start":{"line":903,"column":1},"end":{"line":903,"column":1}},"key":"qpe329ii6A"}],"key":"yuJS1fu4Yq"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"@show i = argmax( abs.(A₃[:, 3]) ) \nU[3, :] = A₃[i, :]\nL[:, 3] = A₃[:, 3] / U[3, 3]\nA₄ = A₃ - L[:, 3] * U[3, :]'","key":"OUtMj37BRn"},{"type":"output","id":"8e_L04uRu1BScv1r1TRCV","data":[{"output_type":"stream","name":"stdout","text":"i = argmax(abs.(A₃[:, 3])) = 2\n"},{"output_type":"execute_result","execution_count":85,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n 0.0  0.0  0.0  -0.166667\n 0.0  0.0  0.0   0.0\n 0.0  0.0  0.0   0.0\n 0.0  0.0  0.0   0.0","content_type":"text/plain"}}}],"key":"d8ADlSZlFU"}],"key":"zrZA43ae30"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"@show i = argmax( abs.(A₄[:, 4]) ) \nU[4, :] = A₄[i, :]\nL[:, 4] = A₄[:, 4] / U[4, 4];","key":"wjWLrRHRpX"},{"type":"output","id":"cw2N8Kerda0RWPntLMTOk","data":[{"output_type":"stream","name":"stdout","text":"i = argmax(abs.(A₄[:, 4])) = 1\n"}],"key":"xbkC6SYMma"}],"key":"KPNL6Wtn11"},{"type":"paragraph","position":{"start":{"line":918,"column":1},"end":{"line":918,"column":1}},"children":[{"type":"text","value":"We do have a factorization of the original matrix:","position":{"start":{"line":918,"column":1},"end":{"line":918,"column":1}},"key":"JdXEpC7nYA"}],"key":"exyKDfAtCb"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"A₁ - L * U","key":"qhC7HN0zZ1"},{"type":"output","id":"yWHKoQ_Sr2oqoyruQZy8y","data":[{"output_type":"execute_result","execution_count":87,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n 0.0  -1.38778e-16  0.0  0.0\n 0.0   1.38778e-16  0.0  0.0\n 0.0   0.0          0.0  0.0\n 0.0   0.0          0.0  0.0","content_type":"text/plain"}}}],"key":"YALRAc9jlc"}],"key":"qC2EtDfbMi"},{"type":"paragraph","position":{"start":{"line":924,"column":1},"end":{"line":924,"column":1}},"children":[{"type":"text","value":"And ","position":{"start":{"line":924,"column":1},"end":{"line":924,"column":1}},"key":"QmcJCCqTa3"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":924,"column":1},"end":{"line":924,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"FlE2aTrZhz"},{"type":"text","value":" has the required structure:","position":{"start":{"line":924,"column":1},"end":{"line":924,"column":1}},"key":"gciINgwh30"}],"key":"gG55ytQC3X"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"U","key":"mK7Hwa1xd5"},{"type":"output","id":"LtQpCvMCTXDq1F7ao1kNV","data":[{"output_type":"execute_result","execution_count":88,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n -4.0   5.0   -7.0      -10.0\n  0.0  16.25   0.25      -7.0\n  0.0   0.0    5.53846   -9.07692\n  0.0   0.0    0.0       -0.166667","content_type":"text/plain"}}}],"key":"a1s6Ysz3ae"}],"key":"VQf2Zn5WrT"},{"type":"paragraph","position":{"start":{"line":930,"column":1},"end":{"line":930,"column":1}},"children":[{"type":"text","value":"However, the triangularity of ","position":{"start":{"line":930,"column":1},"end":{"line":930,"column":1}},"key":"owMne8RbAP"},{"type":"inlineMath","value":"\\mathbf{L}","position":{"start":{"line":930,"column":1},"end":{"line":930,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">L</span></span></span></span>","key":"a5wPLpdYNn"},{"type":"text","value":" has been broken.","position":{"start":{"line":930,"column":1},"end":{"line":930,"column":1}},"key":"V38nptbSHS"}],"key":"oQwIWOCkle"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"L","key":"U9sJ4BJn2F"},{"type":"output","id":"o9EdNmAADBmjVHoK1kBkB","data":[{"output_type":"execute_result","execution_count":89,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n -0.5    0.153846  0.0833333   1.0\n  0.5   -0.153846  1.0        -0.0\n -0.25   1.0       0.0        -0.0\n  1.0    0.0       0.0        -0.0","content_type":"text/plain"}}}],"key":"GzZu9Yv3Kp"}],"key":"qAt9RbhNgh"}],"key":"nmChpQsH7X"}],"key":"ywbMwX61D9"}],"key":"luYYuOFDZ8"},{"type":"tabItem","title":"MATLAB","sync":"matlab","children":[{"type":"embed","source":{"url":"/chapter2-1","label":"demo-pivoting-fix-matlab","kind":"Notebook","slug":"chapter2-1","location":"/matlab/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-pivoting-fix","label":"demo-pivoting-fix","kind":"proof:example","position":{"start":{"line":807,"column":1},"end":{"line":807,"column":19}},"children":[{"type":"text","value":"Example ","key":"pwT2JS953u"},{"type":"text","value":"2.6.2","key":"TqCJf3hjHD"}],"template":"Example %s","enumerator":"2.6.2","resolved":true,"html_id":"demo-pivoting-fix","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"vJ1MxsLmR3"}],"key":"GS9Zpnkis1"},{"type":"paragraph","position":{"start":{"line":809,"column":1},"end":{"line":809,"column":1}},"children":[{"type":"text","value":"Here is the trouble-making matrix from ","position":{"start":{"line":809,"column":1},"end":{"line":809,"column":1}},"key":"Mv1M0kRyC3"},{"type":"crossReference","identifier":"demo-pivoting-fail","label":"demo-pivoting-fail","kind":"proof:example","position":{"start":{"line":809,"column":40},"end":{"line":809,"column":59}},"children":[{"type":"text","value":"Example ","key":"SUUsS5XjLi"},{"type":"text","value":"2.6.1","key":"KvQC0HTotu"}],"template":"Example %s","enumerator":"2.6.1","resolved":true,"html_id":"demo-pivoting-fail","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"DHrOkBDEcJ"},{"type":"text","value":".","position":{"start":{"line":809,"column":1},"end":{"line":809,"column":1}},"key":"TcsURTL8mZ"}],"key":"Af357yTbtH"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A_1 = [2 0 4 3; -2 0 2 -13; 1 15 2 -4.5; -4 5 -7 -10]","key":"TYK08nIdMp"},{"type":"output","id":"X6IywnKr9o7x12H_8F_jX","data":[{"output_type":"execute_result","execution_count":79,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>A_1 = 4×4 double\n    2.0000         0    4.0000    3.0000\n   -2.0000         0    2.0000  -13.0000\n    1.0000   15.0000    2.0000   -4.5000\n   -4.0000    5.0000   -7.0000  -10.0000\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"A_1 = 4×4 double\n    2.0000         0    4.0000    3.0000\n   -2.0000         0    2.0000  -13.0000\n    1.0000   15.0000    2.0000   -4.5000\n   -4.0000    5.0000   -7.0000  -10.0000\n","content_type":"text/plain"}}}],"key":"WQByoZrU73"}],"key":"rQ6v8Tnagd"},{"type":"paragraph","position":{"start":{"line":818,"column":1},"end":{"line":818,"column":1}},"children":[{"type":"text","value":"We now find the largest candidate pivot in the first column. We don’t care about sign, so we take absolute values before finding the max.","position":{"start":{"line":818,"column":1},"end":{"line":818,"column":1}},"key":"S90t0C1xX7"}],"indexEntries":[{"entry":"MATLAB","subEntry":{"value":"max","kind":"entry"},"emphasis":true},{"entry":"MATLAB","subEntry":{"value":"\\~","kind":"entry"},"emphasis":true}],"key":"I7XNGQTpUY"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"xtTCn55oSl"}],"key":"BU64DBZQtM"},{"type":"paragraph","position":{"start":{"line":821,"column":1},"end":{"line":821,"column":1}},"children":[{"type":"text","value":"The second output of ","position":{"start":{"line":821,"column":1},"end":{"line":821,"column":1}},"key":"sRpcjU0uQ9"},{"type":"inlineCode","value":"max","position":{"start":{"line":821,"column":1},"end":{"line":821,"column":1}},"key":"OyEnOg2kzd"},{"type":"text","value":" returns the location of the largest element of a vector. The ","position":{"start":{"line":821,"column":1},"end":{"line":821,"column":1}},"key":"Ox98lc2bdT"},{"type":"inlineCode","value":"~","position":{"start":{"line":821,"column":1},"end":{"line":821,"column":1}},"key":"tYf9aOR3BL"},{"type":"text","value":" symbol is used to ignore the value of the first output.","position":{"start":{"line":821,"column":1},"end":{"line":821,"column":1}},"key":"u7iiZYVQcs"}],"key":"fnjT1CYdFL"}],"class":"dropdown","key":"f2LJMeFbPF"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[~, i] = max( abs(A_1(:, 1)) )","key":"LE0dVV3gkP"},{"type":"output","id":"JR4yzKVhrYZaM-UMEcLp8","data":[{"output_type":"execute_result","execution_count":80,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>i = 4</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"i = 4","content_type":"text/plain"}}}],"key":"zKzC1JmImh"}],"key":"ijDkWj7H9E"},{"type":"paragraph","position":{"start":{"line":829,"column":1},"end":{"line":829,"column":1}},"children":[{"type":"text","value":"This is the row of the matrix that we extract to put into ","position":{"start":{"line":829,"column":1},"end":{"line":829,"column":1}},"key":"TlKlE5faEP"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":829,"column":1},"end":{"line":829,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"VqmNiFVlmc"},{"type":"text","value":". That guarantees that the division used to find ","position":{"start":{"line":829,"column":1},"end":{"line":829,"column":1}},"key":"G87R2y6jWq"},{"type":"inlineMath","value":"\\boldsymbol{\\ell}_1","position":{"start":{"line":829,"column":1},"end":{"line":829,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">ℓ</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\boldsymbol{\\ell}_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">ℓ</span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"Y7Ola26Jxd"},{"type":"text","value":" will be valid.","position":{"start":{"line":829,"column":1},"end":{"line":829,"column":1}},"key":"mDzujF2ixh"}],"key":"wwPk3uuBg6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"L = zeros(4, 4);\nU = zeros(4, 4);\nU(1, :) = A_1(i, :);\nL(:, 1) = A_1(:, 1) / U(1, 1);\nA_2 = A_1 - L(:, 1) * U(1, :)","key":"pZVAZFqDJg"},{"type":"output","id":"jzH_KFturbXA1QXgFQNYn","data":[{"output_type":"execute_result","execution_count":81,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>A_2 = 4×4 double\n         0    2.5000    0.5000   -2.0000\n         0   -2.5000    5.5000   -8.0000\n         0   16.2500    0.2500   -7.0000\n         0         0         0         0\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"A_2 = 4×4 double\n         0    2.5000    0.5000   -2.0000\n         0   -2.5000    5.5000   -8.0000\n         0   16.2500    0.2500   -7.0000\n         0         0         0         0\n","content_type":"text/plain"}}}],"key":"p7Jb6tERin"}],"key":"aewuxY4xi1"},{"type":"paragraph","position":{"start":{"line":839,"column":1},"end":{"line":839,"column":1}},"children":[{"type":"text","value":"Observe that ","position":{"start":{"line":839,"column":1},"end":{"line":839,"column":1}},"key":"iivWi2jHMA"},{"type":"inlineMath","value":"\\mathbf{A}_2","position":{"start":{"line":839,"column":1},"end":{"line":839,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">A</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8361em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"F73H228s29"},{"type":"text","value":" has a new zero row and zero column, but the zero row is the fourth rather than the first. However, we forge on by using the largest possible pivot in column 2 for the next outer product.","position":{"start":{"line":839,"column":1},"end":{"line":839,"column":1}},"key":"y1TM4UrHPW"}],"key":"RDpTNXYfgH"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[~, i] = max( abs(A_2(:, 2)) )\nU(2, :) = A_2(i, :);\nL(:, 2) = A_2(:, 2) / U(2, 2);\nA_3 = A_2 - L(:, 2) * U(2, :)","key":"rTreWekUj6"},{"type":"output","id":"1yXsvoKZ4HPIHMhs_Sw6B","data":[{"output_type":"execute_result","execution_count":82,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>i = 3</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"i = 3","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":82,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>A_3 = 4×4 double\n         0         0    0.4615   -0.9231\n         0         0    5.5385   -9.0769\n         0         0         0         0\n         0         0         0         0\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"A_3 = 4×4 double\n         0         0    0.4615   -0.9231\n         0         0    5.5385   -9.0769\n         0         0         0         0\n         0         0         0         0\n","content_type":"text/plain"}}}],"key":"xQEKdnNx0k"}],"key":"vifVRca1B8"},{"type":"paragraph","position":{"start":{"line":848,"column":1},"end":{"line":848,"column":1}},"children":[{"type":"text","value":"Now we have zeroed out the third row as well as the second column. We can finish out the procedure.","position":{"start":{"line":848,"column":1},"end":{"line":848,"column":1}},"key":"KJyWl1GPRe"}],"key":"Z0koNPGElG"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[~, i] = max( abs(A_3(:, 3)) ) \nU(3, :) = A_3(i, :);\nL(:, 3) = A_3(:, 3) / U(3, 3);\nA_4 = A_3 - L(:, 3) * U(3, :)","key":"hUbOmXAnid"},{"type":"output","id":"6ia54dDe6PYruu0mfPwls","data":[{"output_type":"execute_result","execution_count":83,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>i = 2</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"i = 2","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":83,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>A_4 = 4×4 double\n         0         0         0   -0.1667\n         0         0         0         0\n         0         0         0         0\n         0         0         0         0\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"A_4 = 4×4 double\n         0         0         0   -0.1667\n         0         0         0         0\n         0         0         0         0\n         0         0         0         0\n","content_type":"text/plain"}}}],"key":"ACtLdh1Twj"}],"key":"HUxRBLGvjR"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[~, i] = max( abs(A_4(:, 4)) ) \nU(4, :) = A_4(i, :);\nL(:, 4) = A_4(:, 4) / U(4, 4);","key":"mK4jkWogI3"},{"type":"output","id":"bMFEa2uzWktHgT8Veqxwo","data":[{"output_type":"execute_result","execution_count":84,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>i = 1</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"i = 1","content_type":"text/plain"}}}],"key":"Qk6mpXabnV"}],"key":"GGncy3pywN"},{"type":"paragraph","position":{"start":{"line":863,"column":1},"end":{"line":863,"column":1}},"children":[{"type":"text","value":"We do have a factorization of the original matrix:","position":{"start":{"line":863,"column":1},"end":{"line":863,"column":1}},"key":"OnfhGwEXPt"}],"key":"zcQsUVSb9W"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A_1 - L * U","key":"Rto7SIp4js"},{"type":"output","id":"a3fhMYPLisN48RLdng_06","data":[{"output_type":"execute_result","execution_count":85,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = 4×4 double\n     0     0     0     0\n     0     0     0     0\n     0     0     0     0\n     0     0     0     0\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = 4×4 double\n     0     0     0     0\n     0     0     0     0\n     0     0     0     0\n     0     0     0     0\n","content_type":"text/plain"}}}],"key":"PhqKZgSBKq"}],"key":"IeVDch13X3"},{"type":"paragraph","position":{"start":{"line":869,"column":1},"end":{"line":869,"column":1}},"children":[{"type":"text","value":"And ","position":{"start":{"line":869,"column":1},"end":{"line":869,"column":1}},"key":"fiROEoUn7o"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":869,"column":1},"end":{"line":869,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"TUTJpPgeiL"},{"type":"text","value":" has the required structure:","position":{"start":{"line":869,"column":1},"end":{"line":869,"column":1}},"key":"WlqtxrFrfU"}],"key":"y7CS6gIVWg"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"U","key":"GCqTWLYf7I"},{"type":"output","id":"ecvPH6fmmug2Zprg6Nf5y","data":[{"output_type":"execute_result","execution_count":86,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>U = 4×4 double\n   -4.0000    5.0000   -7.0000  -10.0000\n         0   16.2500    0.2500   -7.0000\n         0         0    5.5385   -9.0769\n         0         0         0   -0.1667\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"U = 4×4 double\n   -4.0000    5.0000   -7.0000  -10.0000\n         0   16.2500    0.2500   -7.0000\n         0         0    5.5385   -9.0769\n         0         0         0   -0.1667\n","content_type":"text/plain"}}}],"key":"h6ZCf6IlEp"}],"key":"aUKHefiEUs"},{"type":"paragraph","position":{"start":{"line":875,"column":1},"end":{"line":875,"column":1}},"children":[{"type":"text","value":"However, the triangularity of ","position":{"start":{"line":875,"column":1},"end":{"line":875,"column":1}},"key":"fFI9aXsfhG"},{"type":"inlineMath","value":"\\mathbf{L}","position":{"start":{"line":875,"column":1},"end":{"line":875,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">L</span></span></span></span>","key":"ZLJe4Yo1vz"},{"type":"text","value":" has been broken.","position":{"start":{"line":875,"column":1},"end":{"line":875,"column":1}},"key":"FeuVY3Cw3f"}],"key":"hZvbaOdREA"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"L","key":"qB4aUsRuBV"},{"type":"output","id":"ITDW08ilt4rWpea929Sqo","data":[{"output_type":"execute_result","execution_count":87,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>L = 4×4 double\n   -0.5000    0.1538    0.0833    1.0000\n    0.5000   -0.1538    1.0000         0\n   -0.2500    1.0000         0         0\n    1.0000         0         0         0\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"L = 4×4 double\n   -0.5000    0.1538    0.0833    1.0000\n    0.5000   -0.1538    1.0000         0\n   -0.2500    1.0000         0         0\n    1.0000         0         0         0\n","content_type":"text/plain"}}}],"key":"kKzaCGCClt"}],"key":"unoRA5po6x"}],"key":"E1MRcqKBjB"}],"key":"gpmSfXApj4"}],"key":"KafV8ZgSXx"},{"type":"tabItem","title":"Python","sync":"python","children":[{"type":"embed","source":{"url":"/chapter2-2","label":"demo-pivoting-fix-python","kind":"Notebook","slug":"chapter2-2","location":"/python/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-pivoting-fix","label":"demo-pivoting-fix","kind":"proof:example","position":{"start":{"line":791,"column":1},"end":{"line":791,"column":19}},"children":[{"type":"text","value":"Example ","key":"G6u25H1cCm"},{"type":"text","value":"2.6.2","key":"KJ7I0io7vh"}],"template":"Example %s","enumerator":"2.6.2","resolved":true,"html_id":"demo-pivoting-fix","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"TwuulSzcAf"}],"key":"JH6M3UUgNF"},{"type":"paragraph","position":{"start":{"line":793,"column":1},"end":{"line":793,"column":1}},"children":[{"type":"text","value":"Here is the trouble-making matrix from ","position":{"start":{"line":793,"column":1},"end":{"line":793,"column":1}},"key":"yoUt2Iq0qY"},{"type":"crossReference","identifier":"demo-pivoting-fail","label":"demo-pivoting-fail","kind":"proof:example","position":{"start":{"line":793,"column":40},"end":{"line":793,"column":59}},"children":[{"type":"text","value":"Example ","key":"OkGLwqtdRn"},{"type":"text","value":"2.6.1","key":"vkGW84Hzkf"}],"template":"Example %s","enumerator":"2.6.1","resolved":true,"html_id":"demo-pivoting-fail","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"jwUr7HnnXd"},{"type":"text","value":".","position":{"start":{"line":793,"column":1},"end":{"line":793,"column":1}},"key":"FRdXblr4Ui"}],"key":"BzHM3ZaQHy"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"A_1 = array([\n    [2, 0, 4, 3],\n    [-2, 0, 2, -13],\n    [1, 15, 2, -4.5],\n    [-4, 5, -7, -10]\n    ])","key":"KX5yhgsN76"},{"type":"output","id":"ApJtuxUGNTvMYEk8PgmRY","data":[],"key":"SAqBS9CKU6"}],"key":"shvxxp21ow"},{"type":"paragraph","position":{"start":{"line":804,"column":1},"end":{"line":804,"column":1}},"children":[{"type":"text","value":"We now find the largest candidate pivot in the first column. We don’t care about sign, so we take absolute values before finding the max.","position":{"start":{"line":804,"column":1},"end":{"line":804,"column":1}},"key":"DNsKxCYzJu"}],"key":"rHPf2J4QLr"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"AEgp8YUCwT"}],"key":"JpeyAtGn6r"},{"type":"paragraph","position":{"start":{"line":807,"column":1},"end":{"line":807,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":807,"column":1},"end":{"line":807,"column":1}},"key":"LyjZVAsLlk"},{"type":"inlineCode","value":"argmax","position":{"start":{"line":807,"column":1},"end":{"line":807,"column":1}},"key":"pgMQfPdPC5"},{"type":"text","value":" function returns the location of the largest element of a vector or matrix.","position":{"start":{"line":807,"column":1},"end":{"line":807,"column":1}},"key":"DaweTbq9CN"}],"key":"mH4FaezWXs"}],"class":"dropdown","key":"gpvYldnGH0"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"i = argmax( abs(A_1[:, 0]) )\nprint(i)","key":"RQYpvnmGYj"},{"type":"output","id":"XNDGksjdsVmJBbtHfsxXY","data":[{"output_type":"stream","name":"stdout","text":"3\n"}],"key":"Jlsiucz4vg"}],"key":"tdLeYQiRky"},{"type":"paragraph","position":{"start":{"line":816,"column":1},"end":{"line":816,"column":1}},"children":[{"type":"text","value":"This is the row of the matrix that we extract to put into ","position":{"start":{"line":816,"column":1},"end":{"line":816,"column":1}},"key":"mYeCfGWITh"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":816,"column":1},"end":{"line":816,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"JRj50UGvBr"},{"type":"text","value":". That guarantees that the division used to find ","position":{"start":{"line":816,"column":1},"end":{"line":816,"column":1}},"key":"km6wbBOifM"},{"type":"inlineMath","value":"\\boldsymbol{\\ell}_1","position":{"start":{"line":816,"column":1},"end":{"line":816,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">ℓ</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\boldsymbol{\\ell}_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">ℓ</span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"WOhKyO4PzM"},{"type":"text","value":" will be valid.","position":{"start":{"line":816,"column":1},"end":{"line":816,"column":1}},"key":"X1fGc6rIFd"}],"key":"vlVQiF1sXw"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"L, U = eye(4), zeros((4, 4))\nU[0, :] = A_1[i, :]\nL[:, 0] = A_1[:, 0] / U[0, 0]\nA_2 = A_1 - outer(L[:, 0], U[0, :])\nprint(A_2)","key":"dKDGXKPVjs"},{"type":"output","id":"-gyoSZEPNIboE3tHhCaBx","data":[{"output_type":"stream","name":"stdout","text":"[[ 0.    2.5   0.5  -2.  ]\n [ 0.   -2.5   5.5  -8.  ]\n [ 0.   16.25  0.25 -7.  ]\n [ 0.    0.    0.    0.  ]]\n"}],"key":"SisrrupZPe"}],"key":"QmRTWzCfb8"},{"type":"paragraph","position":{"start":{"line":826,"column":1},"end":{"line":826,"column":1}},"children":[{"type":"text","value":"Observe that ","position":{"start":{"line":826,"column":1},"end":{"line":826,"column":1}},"key":"rLskQHllK6"},{"type":"inlineMath","value":"\\mathbf{A}_2","position":{"start":{"line":826,"column":1},"end":{"line":826,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">A</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8361em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"zsYuGWz8P1"},{"type":"text","value":" has a new zero row and zero column, but the zero row is the fourth rather than the first. However, we forge on by using the largest possible pivot in column 2 for the next outer product.","position":{"start":{"line":826,"column":1},"end":{"line":826,"column":1}},"key":"qidtlb0Dyx"}],"key":"Be4nCAQ09P"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"i = argmax( abs(A_2[:, 1]) ) \nprint(f\"new pivot row is {i}\")\nU[1, :] = A_2[i, :]\nL[:, 1] = A_2[:, 1] / U[1, 1]\nA_3 = A_2 - outer(L[:, 1], U[1, :])\nprint(A_3)","key":"mxJncsvaej"},{"type":"output","id":"9EXwqdQmHbEEEmluAV18P","data":[{"output_type":"stream","name":"stdout","text":"new pivot row is 2\n[[ 0.          0.          0.46153846 -0.92307692]\n [ 0.          0.          5.53846154 -9.07692308]\n [ 0.          0.          0.          0.        ]\n [ 0.          0.          0.          0.        ]]\n"}],"key":"q9eHf968yd"}],"key":"EVieeBsMuG"},{"type":"paragraph","position":{"start":{"line":836,"column":1},"end":{"line":836,"column":1}},"children":[{"type":"text","value":"Now we have zeroed out the third row as well as the second column. We can finish out the procedure.","position":{"start":{"line":836,"column":1},"end":{"line":836,"column":1}},"key":"kbgqWzPrGd"}],"key":"wUWBT2zmLA"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"i = argmax( abs(A_3[:, 2]) ) \nprint(f\"new pivot row is {i}\")\nU[2, :] = A_3[i, :]\nL[:, 2] = A_3[:, 2] / U[2, 2]\nA_4 = A_3 - outer(L[:, 2], U[2, :])\nprint(A_4)","key":"G1W3C5nqTr"},{"type":"output","id":"MBHUuyIFanvKtUZAJ3YEm","data":[{"output_type":"stream","name":"stdout","text":"new pivot row is 1\n[[ 0.          0.          0.         -0.16666667]\n [ 0.          0.          0.          0.        ]\n [ 0.          0.          0.          0.        ]\n [ 0.          0.          0.          0.        ]]\n"}],"key":"Rd8WmGTSB4"}],"key":"fYz6qlAlw5"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"i = argmax( abs(A_4[:, 3]) ) \nprint(f\"new pivot row is {i}\")\nU[3, :] = A_4[i, :]\nL[:, 3] = A_4[:, 3] / U[3, 3];","key":"OTIo2Wr7fs"},{"type":"output","id":"o8eB4osYkYwG2VFIGLL9_","data":[{"output_type":"stream","name":"stdout","text":"new pivot row is 0\n"}],"key":"yrhucjDrWp"}],"key":"KFfVa4osGR"},{"type":"paragraph","position":{"start":{"line":854,"column":1},"end":{"line":854,"column":1}},"children":[{"type":"text","value":"We do have a factorization of the original matrix:","position":{"start":{"line":854,"column":1},"end":{"line":854,"column":1}},"key":"LWGQdPDgVO"}],"key":"C5r0FhuZIv"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"A_1 - L @ U","key":"JtHjRuZId2"},{"type":"output","id":"Fys918j98yDhK905P9qjO","data":[{"output_type":"execute_result","execution_count":84,"metadata":{},"data":{"text/plain":{"content":"array([[ 0.00000000e+00, -1.38777878e-16,  0.00000000e+00,\n         0.00000000e+00],\n       [ 0.00000000e+00,  1.38777878e-16,  0.00000000e+00,\n         0.00000000e+00],\n       [ 0.00000000e+00,  0.00000000e+00,  0.00000000e+00,\n         0.00000000e+00],\n       [ 0.00000000e+00,  0.00000000e+00,  0.00000000e+00,\n         0.00000000e+00]])","content_type":"text/plain"}}}],"key":"wBWZGzY7Qo"}],"key":"krXmJroe9z"},{"type":"paragraph","position":{"start":{"line":860,"column":1},"end":{"line":860,"column":1}},"children":[{"type":"text","value":"And ","position":{"start":{"line":860,"column":1},"end":{"line":860,"column":1}},"key":"fsLdu6gxFs"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":860,"column":1},"end":{"line":860,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"h9piwEema2"},{"type":"text","value":" has the required structure:","position":{"start":{"line":860,"column":1},"end":{"line":860,"column":1}},"key":"V1pNRBjgDT"}],"key":"YUgzf56eMh"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(U)","key":"aIBwTZ18AD"},{"type":"output","id":"IWJ98hHf0FAU4PcshpCWw","data":[{"output_type":"stream","name":"stdout","text":"[[ -4.           5.          -7.         -10.        ]\n [  0.          16.25         0.25        -7.        ]\n [  0.           0.           5.53846154  -9.07692308]\n [  0.           0.           0.          -0.16666667]]\n"}],"key":"AdASyBxWA5"}],"key":"BwlXqgGu5t"},{"type":"paragraph","position":{"start":{"line":866,"column":1},"end":{"line":866,"column":1}},"children":[{"type":"text","value":"However, the triangularity of ","position":{"start":{"line":866,"column":1},"end":{"line":866,"column":1}},"key":"XU6zCJ5EeH"},{"type":"inlineMath","value":"\\mathbf{L}","position":{"start":{"line":866,"column":1},"end":{"line":866,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">L</span></span></span></span>","key":"agZWI0bLX5"},{"type":"text","value":" has been broken.","position":{"start":{"line":866,"column":1},"end":{"line":866,"column":1}},"key":"O6VFMk8pi3"}],"key":"E8pOq7BNCN"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(L)","key":"YEST7i3koo"},{"type":"output","id":"dUFf6D-E0cDJk5icoIH1U","data":[{"output_type":"stream","name":"stdout","text":"[[-0.5         0.15384615  0.08333333  1.        ]\n [ 0.5        -0.15384615  1.         -0.        ]\n [-0.25        1.          0.         -0.        ]\n [ 1.          0.          0.         -0.        ]]\n"}],"key":"pPGIwO7AWw"}],"key":"JtcYd7jAuZ"}],"key":"ydXz6T3uZ9"}],"key":"q5WZ4DWVEl"}],"key":"QeEHzIpjVT"}],"key":"E9pPbAcu01"}],"label":"demo-pivoting-fix","identifier":"demo-pivoting-fix","enumerator":"2.6.2","html_id":"demo-pivoting-fix","key":"b4yZc7CTiC"},{"type":"paragraph","position":{"start":{"line":78,"column":1},"end":{"line":78,"column":1}},"children":[{"type":"text","value":"We will return to the loss of triangularity in ","position":{"start":{"line":78,"column":1},"end":{"line":78,"column":1}},"key":"Z5JxQRjJpy"},{"type":"inlineMath","value":"\\mathbf{L}","position":{"start":{"line":78,"column":1},"end":{"line":78,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">L</span></span></span></span>","key":"EOpnzlBVZj"},{"type":"text","value":" momentarily. First, though, there is a question left to answer: what if at some stage, all the elements of the targeted column are zero, i.e., there are no available pivots? Fortunately that loose end ties up nicely, although a proof is a bit beyond our scope here.","position":{"start":{"line":78,"column":1},"end":{"line":78,"column":1}},"key":"tPegmTksqW"}],"key":"GMBl8UA92F"},{"type":"proof","kind":"theorem","enumerated":true,"children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Row pivoting","position":{"start":{"line":80,"column":1},"end":{"line":80,"column":1}},"key":"imp0kOSQAK"}],"key":"AKzUpRKtHi"},{"type":"paragraph","position":{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},"children":[{"type":"text","value":"The row-pivoted LU factorization runs to completion if and only if the original matrix is invertible.","position":{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},"key":"Y5OCrvfcEH"}],"key":"GCbYfWY0At"}],"label":"theorem-pivot","identifier":"theorem-pivot","enumerator":"2.6.1","html_id":"theorem-pivot","key":"FU0QAYhMPX"},{"type":"paragraph","position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"children":[{"type":"text","value":"A linear system with a singular matrix has either no solution or infinitely many solutions. Either way, a technique other than LU factorization is needed to handle it.","position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"key":"F3pPUkbEDh"}],"key":"VwbpAc4sIh"},{"type":"heading","depth":2,"position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"children":[{"type":"text","value":"Permutations","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"gffbeob2LC"}],"identifier":"permutations","label":"Permutations","html_id":"permutations","implicit":true,"enumerator":"2.6.2","key":"FEHhi5QVx2"},{"type":"paragraph","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"children":[{"type":"text","value":"Even though the resulting ","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"key":"pfR0Yvcamm"},{"type":"inlineMath","value":"\\mathbf{L}","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">L</span></span></span></span>","key":"D7h4zbdwoo"},{"type":"text","value":" in ","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"key":"nY9VKVtflU"},{"type":"crossReference","identifier":"demo-pivoting-fix","label":"demo-pivoting-fix","kind":"proof:example","position":{"start":{"line":89,"column":43},"end":{"line":89,"column":61}},"children":[{"type":"text","value":"Example ","key":"LQTi0cbZ8c"},{"type":"text","value":"2.6.2","key":"nbn9rI121I"}],"template":"Example %s","enumerator":"2.6.2","resolved":true,"html_id":"demo-pivoting-fix","key":"DZKvcLdYiQ"},{"type":"text","value":" is no longer of unit lower triangular form, it is close. In fact, all that is needed is to reverse the order of its rows.","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"key":"iwS6X3M3VH"}],"key":"Sgy2AivCtw"},{"type":"proof","kind":"example","enumerated":true,"children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Pivoting as row permutation","position":{"start":{"line":91,"column":1},"end":{"line":91,"column":1}},"key":"adOp1AlY33"}],"key":"iuY1AyzPh0"},{"type":"tabSet","children":[{"type":"tabItem","title":"Julia","sync":"julia","children":[{"type":"embed","source":{"url":"/chapter2","label":"demo-pivoting-permute-julia","kind":"Notebook","slug":"chapter2","location":"/julia/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-pivoting-permute","label":"demo-pivoting-permute","kind":"proof:example","position":{"start":{"line":938,"column":1},"end":{"line":938,"column":23}},"children":[{"type":"text","value":"Example ","key":"gQslNoOYxy"},{"type":"text","value":"2.6.3","key":"FQahLW8wEM"}],"template":"Example %s","enumerator":"2.6.3","resolved":true,"html_id":"demo-pivoting-permute","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"ZQjitrIEZB"}],"key":"IVCLhCIOnQ"},{"type":"paragraph","position":{"start":{"line":940,"column":1},"end":{"line":940,"column":1}},"children":[{"type":"text","value":"Here again is the matrix from ","position":{"start":{"line":940,"column":1},"end":{"line":940,"column":1}},"key":"E7kV6BAaAX"},{"type":"crossReference","identifier":"demo-pivoting-fix","label":"demo-pivoting-fix","kind":"proof:example","position":{"start":{"line":940,"column":31},"end":{"line":940,"column":49}},"children":[{"type":"text","value":"Example ","key":"dJ28c9yn1a"},{"type":"text","value":"2.6.2","key":"WSQ69mlaTx"}],"template":"Example %s","enumerator":"2.6.2","resolved":true,"html_id":"demo-pivoting-fix","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"Vn0hWBFNPz"},{"type":"text","value":".","position":{"start":{"line":940,"column":1},"end":{"line":940,"column":1}},"key":"Zx26TyhjhT"}],"key":"eOxR8X8wZB"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"A = [2 0 4 3 ; -2 0 2 -13; 1 15 2 -4.5 ; -4 5 -7 -10]","key":"B0LxTVXXuI"},{"type":"output","id":"P7TalCRom5u0yqh4BNmd4","data":[{"output_type":"execute_result","execution_count":90,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n  2.0   0.0   4.0    3.0\n -2.0   0.0   2.0  -13.0\n  1.0  15.0   2.0   -4.5\n -4.0   5.0  -7.0  -10.0","content_type":"text/plain"}}}],"key":"zpogCFo6eg"}],"key":"ThENy3F0II"},{"type":"paragraph","position":{"start":{"line":946,"column":1},"end":{"line":946,"column":1}},"children":[{"type":"text","value":"As the factorization proceeded, the pivots were selected from rows 4, 3, 2, and finally 1. If we were to put the rows of ","position":{"start":{"line":946,"column":1},"end":{"line":946,"column":1}},"key":"EY1eI2srpw"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":946,"column":1},"end":{"line":946,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"MVbZyittzl"},{"type":"text","value":" into that order, then the algorithm would run exactly like the plain LU factorization from ","position":{"start":{"line":946,"column":1},"end":{"line":946,"column":1}},"key":"PUDOsrAJoz"},{"type":"link","kind":"numref","identifier":"section-linsys-lu","label":"section-linsys-lu","url":"/lu","internal":true,"dataUrl":"/lu.json","children":[{"type":"text","value":"LU factorization","key":"tGzAzQKxqI"}],"key":"jqAAzRLBQR"},{"type":"text","value":".","position":{"start":{"line":946,"column":1},"end":{"line":946,"column":1}},"key":"U4qbUAECYh"}],"key":"gIStdC0cVk"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"B = A[[4, 3, 2, 1], :]\nL, U = FNC.lufact(B);","key":"YWuCEco3w8"},{"type":"output","id":"dg04lve9wd3R2VCTOVA31","data":[],"key":"PNwUSoPQRx"}],"key":"mxiqgn2ADT"},{"type":"paragraph","position":{"start":{"line":953,"column":1},"end":{"line":953,"column":1}},"children":[{"type":"text","value":"We obtain the same ","position":{"start":{"line":953,"column":1},"end":{"line":953,"column":1}},"key":"oUqnvuhlBc"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":953,"column":1},"end":{"line":953,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"IKZX8D7suU"},{"type":"text","value":" as before:","position":{"start":{"line":953,"column":1},"end":{"line":953,"column":1}},"key":"bhx2jCsrcs"}],"key":"cH8OyLP0IN"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"U","key":"PiDO38Dg4N"},{"type":"output","id":"qqcD-pm48TBAV3k4CqrNs","data":[{"output_type":"execute_result","execution_count":92,"metadata":{},"data":{"text/plain":{"content":"4×4 UpperTriangular{Float64, Matrix{Float64}}:\n -4.0   5.0   -7.0      -10.0\n   ⋅   16.25   0.25      -7.0\n   ⋅     ⋅     5.53846   -9.07692\n   ⋅     ⋅      ⋅        -0.166667","content_type":"text/plain"}}}],"key":"sx6pyj31kK"}],"key":"QpCYG0jKqb"},{"type":"paragraph","position":{"start":{"line":959,"column":1},"end":{"line":959,"column":1}},"children":[{"type":"text","value":"And ","position":{"start":{"line":959,"column":1},"end":{"line":959,"column":1}},"key":"EonmRc95vi"},{"type":"inlineMath","value":"\\mathbf{L}","position":{"start":{"line":959,"column":1},"end":{"line":959,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">L</span></span></span></span>","key":"JGIAcPmfru"},{"type":"text","value":" has the same rows as before, but arranged into triangular order:","position":{"start":{"line":959,"column":1},"end":{"line":959,"column":1}},"key":"rfvSpK2y45"}],"key":"LDqLA9LLTi"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"L","key":"eiRmgJXbBY"},{"type":"output","id":"cO5SmgaPvFFhAyhMgYdll","data":[{"output_type":"execute_result","execution_count":93,"metadata":{},"data":{"text/plain":{"content":"4×4 LowerTriangular{Float64, Matrix{Float64}}:\n  1.0     ⋅         ⋅          ⋅ \n -0.25   1.0        ⋅          ⋅ \n  0.5   -0.153846  1.0         ⋅ \n -0.5    0.153846  0.0833333  1.0","content_type":"text/plain"}}}],"key":"nWEgo596h7"}],"key":"NINX6J6QYC"}],"key":"QRlFBAL7H8"}],"key":"Zt0TmvBi4s"}],"key":"x6kl5wpFvF"},{"type":"tabItem","title":"MATLAB","sync":"matlab","children":[{"type":"embed","source":{"url":"/chapter2-1","label":"demo-pivoting-permute-matlab","kind":"Notebook","slug":"chapter2-1","location":"/matlab/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-pivoting-permute","label":"demo-pivoting-permute","kind":"proof:example","position":{"start":{"line":883,"column":1},"end":{"line":883,"column":23}},"children":[{"type":"text","value":"Example ","key":"OEyT4DODpe"},{"type":"text","value":"2.6.3","key":"mSmMV5yK5c"}],"template":"Example %s","enumerator":"2.6.3","resolved":true,"html_id":"demo-pivoting-permute","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"ZV8tvAOaRz"}],"key":"ZOI7WPrUb0"},{"type":"paragraph","position":{"start":{"line":885,"column":1},"end":{"line":885,"column":1}},"children":[{"type":"text","value":"Here again is the matrix from ","position":{"start":{"line":885,"column":1},"end":{"line":885,"column":1}},"key":"A8adHNJpoe"},{"type":"crossReference","identifier":"demo-pivoting-fix","label":"demo-pivoting-fix","kind":"proof:example","position":{"start":{"line":885,"column":31},"end":{"line":885,"column":49}},"children":[{"type":"text","value":"Example ","key":"Nq0LVEV9Nn"},{"type":"text","value":"2.6.2","key":"wZXKDqxzsb"}],"template":"Example %s","enumerator":"2.6.2","resolved":true,"html_id":"demo-pivoting-fix","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"dEWL26H7nM"},{"type":"text","value":".","position":{"start":{"line":885,"column":1},"end":{"line":885,"column":1}},"key":"VRAocmwmX1"}],"key":"JwsoZ58UhH"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A = [2 0 4 3; -2 0 2 -13; 1 15 2 -4.5; -4 5 -7 -10]","key":"XjsvB85shh"},{"type":"output","id":"aNl7b-NkZwHICVBpI3EZh","data":[{"output_type":"execute_result","execution_count":88,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>A = 4×4 double\n    2.0000         0    4.0000    3.0000\n   -2.0000         0    2.0000  -13.0000\n    1.0000   15.0000    2.0000   -4.5000\n   -4.0000    5.0000   -7.0000  -10.0000\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"A = 4×4 double\n    2.0000         0    4.0000    3.0000\n   -2.0000         0    2.0000  -13.0000\n    1.0000   15.0000    2.0000   -4.5000\n   -4.0000    5.0000   -7.0000  -10.0000\n","content_type":"text/plain"}}}],"key":"dYr2MTFmaN"}],"key":"qXnZd5s27d"},{"type":"paragraph","position":{"start":{"line":891,"column":1},"end":{"line":891,"column":1}},"children":[{"type":"text","value":"As the factorization proceeded, the pivots were selected from rows 4, 3, 2, and finally 1. If we were to put the rows of ","position":{"start":{"line":891,"column":1},"end":{"line":891,"column":1}},"key":"KBq5LLwqTH"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":891,"column":1},"end":{"line":891,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"cZ7QWW9WC0"},{"type":"text","value":" into that order, then the algorithm would run exactly like the plain LU factorization from ","position":{"start":{"line":891,"column":1},"end":{"line":891,"column":1}},"key":"vOf4OsQlxW"},{"type":"link","kind":"numref","identifier":"section-linsys-lu","label":"section-linsys-lu","url":"/lu","internal":true,"dataUrl":"/lu.json","children":[{"type":"text","value":"LU factorization","key":"eS6An2facJ"}],"key":"QiJyZCHMyu"},{"type":"text","value":".","position":{"start":{"line":891,"column":1},"end":{"line":891,"column":1}},"key":"ZCuCvbtCBR"}],"key":"dLhViN0BIK"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"B = A([4, 3, 2, 1], :);\n[L, U] = lufact(B);","key":"QfARHRgAtk"},{"type":"output","id":"dNuNpTNiXbRzeimRoLnc4","data":[],"key":"baTl8rhacY"}],"key":"jUVpDUjLB0"},{"type":"paragraph","position":{"start":{"line":898,"column":1},"end":{"line":898,"column":1}},"children":[{"type":"text","value":"We obtain the same ","position":{"start":{"line":898,"column":1},"end":{"line":898,"column":1}},"key":"MdQulpPjnm"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":898,"column":1},"end":{"line":898,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"Iyi8vuTsye"},{"type":"text","value":" as before:","position":{"start":{"line":898,"column":1},"end":{"line":898,"column":1}},"key":"oMtQRcGMeU"}],"key":"zdHdA3M4XT"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"U","key":"oHVyvT7i6E"},{"type":"output","id":"nB3fpelnXG16ElhxvqtFQ","data":[{"output_type":"execute_result","execution_count":90,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>U = 4×4 double\n   -4.0000    5.0000   -7.0000  -10.0000\n         0   16.2500    0.2500   -7.0000\n         0         0    5.5385   -9.0769\n         0         0         0   -0.1667\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"U = 4×4 double\n   -4.0000    5.0000   -7.0000  -10.0000\n         0   16.2500    0.2500   -7.0000\n         0         0    5.5385   -9.0769\n         0         0         0   -0.1667\n","content_type":"text/plain"}}}],"key":"UkWJPFz3ry"}],"key":"k2aonPXUoN"},{"type":"paragraph","position":{"start":{"line":904,"column":1},"end":{"line":904,"column":1}},"children":[{"type":"text","value":"And ","position":{"start":{"line":904,"column":1},"end":{"line":904,"column":1}},"key":"Z36AVN0uyN"},{"type":"inlineMath","value":"\\mathbf{L}","position":{"start":{"line":904,"column":1},"end":{"line":904,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">L</span></span></span></span>","key":"Xw4t7e0O6m"},{"type":"text","value":" has the same rows as before, but arranged into triangular order:","position":{"start":{"line":904,"column":1},"end":{"line":904,"column":1}},"key":"Q0Rw1hTWok"}],"key":"N04qH4AGhE"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"L","key":"n1neLJXxuC"},{"type":"output","id":"0w4yzA1TFn9bnW0GP1-tf","data":[{"output_type":"execute_result","execution_count":91,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>L = 4×4 double\n    1.0000         0         0         0\n   -0.2500    1.0000         0         0\n    0.5000   -0.1538    1.0000         0\n   -0.5000    0.1538    0.0833    1.0000\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"L = 4×4 double\n    1.0000         0         0         0\n   -0.2500    1.0000         0         0\n    0.5000   -0.1538    1.0000         0\n   -0.5000    0.1538    0.0833    1.0000\n","content_type":"text/plain"}}}],"key":"yf2FlO77Aw"}],"key":"tZG8yrK09u"}],"key":"QEbQ6aRf9L"}],"key":"jOMjLYl1Qm"}],"key":"XCAwwAOXFx"},{"type":"tabItem","title":"Python","sync":"python","children":[{"type":"embed","source":{"url":"/chapter2-2","label":"demo-pivoting-permute-python","kind":"Notebook","slug":"chapter2-2","location":"/python/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-pivoting-permute","label":"demo-pivoting-permute","kind":"proof:example","position":{"start":{"line":875,"column":1},"end":{"line":875,"column":23}},"children":[{"type":"text","value":"Example ","key":"PhDaQYfnm9"},{"type":"text","value":"2.6.3","key":"ao2VTpCqTh"}],"template":"Example %s","enumerator":"2.6.3","resolved":true,"html_id":"demo-pivoting-permute","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"SedFaLfxB8"}],"key":"LC5kPpxXiz"},{"type":"paragraph","position":{"start":{"line":877,"column":1},"end":{"line":877,"column":1}},"children":[{"type":"text","value":"Here again is the matrix from ","position":{"start":{"line":877,"column":1},"end":{"line":877,"column":1}},"key":"o9LPIhuIL2"},{"type":"crossReference","identifier":"demo-pivoting-fix","label":"demo-pivoting-fix","kind":"proof:example","position":{"start":{"line":877,"column":31},"end":{"line":877,"column":49}},"children":[{"type":"text","value":"Example ","key":"lkKQgt7ZUd"},{"type":"text","value":"2.6.2","key":"VfG27LSob6"}],"template":"Example %s","enumerator":"2.6.2","resolved":true,"html_id":"demo-pivoting-fix","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"uGU0KhZDxW"},{"type":"text","value":".","position":{"start":{"line":877,"column":1},"end":{"line":877,"column":1}},"key":"g5yFXEopQQ"}],"key":"K7WRpC9TQr"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"A = array([\n    [2, 0, 4, 3],\n    [-2, 0, 2, -13],\n    [1, 15, 2, -4.5],\n    [-4, 5, -7, -10]\n    ])","key":"YjQnHjUL8R"},{"type":"output","id":"w4A23Qjfeda9xRHU7dIaY","data":[],"key":"m1EArtKnq7"}],"key":"m6KQQoIVZx"},{"type":"paragraph","position":{"start":{"line":888,"column":1},"end":{"line":888,"column":1}},"children":[{"type":"text","value":"As the factorization proceeded, the pivots were selected from rows 4, 3, 2, and finally 1 (with NumPy indices being one less). If we were to put the rows of ","position":{"start":{"line":888,"column":1},"end":{"line":888,"column":1}},"key":"IlM2TKxEhE"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":888,"column":1},"end":{"line":888,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"JUqn5KlFRM"},{"type":"text","value":" into that order, then the algorithm would run exactly like the plain LU factorization from ","position":{"start":{"line":888,"column":1},"end":{"line":888,"column":1}},"key":"P1PvkhUZiD"},{"type":"link","kind":"numref","identifier":"section-linsys-lu","label":"section-linsys-lu","url":"/lu","internal":true,"dataUrl":"/lu.json","children":[{"type":"text","value":"LU factorization","key":"oVGQ9HI6A2"}],"key":"HDyIdqhWvn"},{"type":"text","value":".","position":{"start":{"line":888,"column":1},"end":{"line":888,"column":1}},"key":"BgO4ZBYD9S"}],"key":"qFn47KfKn6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"B = A[[3, 2, 1, 0], :]\nL, U = FNC.lufact(B);","key":"bqnkkbaAcl"},{"type":"output","id":"ph3KYD2K1AiyLZaaCASqO","data":[],"key":"jXPvgfFGMq"}],"key":"nU74p8psur"},{"type":"paragraph","position":{"start":{"line":895,"column":1},"end":{"line":895,"column":1}},"children":[{"type":"text","value":"We obtain the same ","position":{"start":{"line":895,"column":1},"end":{"line":895,"column":1}},"key":"eJXAT1TXR5"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":895,"column":1},"end":{"line":895,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"EL8WuHcvMU"},{"type":"text","value":" as before:","position":{"start":{"line":895,"column":1},"end":{"line":895,"column":1}},"key":"nP1DFznKyg"}],"key":"l6jJFc980y"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(U)","key":"cRCAYz1QfL"},{"type":"output","id":"IBFnPgefc3kze2hx7Ldov","data":[{"output_type":"stream","name":"stdout","text":"[[ -4.           5.          -7.         -10.        ]\n [  0.          16.25         0.25        -7.        ]\n [  0.           0.           5.53846154  -9.07692308]\n [  0.           0.           0.          -0.16666667]]\n"}],"key":"vo3L27N1ia"}],"key":"Dl6uAtFQkw"},{"type":"paragraph","position":{"start":{"line":901,"column":1},"end":{"line":901,"column":1}},"children":[{"type":"text","value":"And ","position":{"start":{"line":901,"column":1},"end":{"line":901,"column":1}},"key":"hlF3i8zoML"},{"type":"inlineMath","value":"\\mathbf{L}","position":{"start":{"line":901,"column":1},"end":{"line":901,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">L</span></span></span></span>","key":"LFGNGIQEls"},{"type":"text","value":" has the same rows as before, but arranged into triangular order:","position":{"start":{"line":901,"column":1},"end":{"line":901,"column":1}},"key":"JJw48MaokI"}],"key":"cGntmhAbXe"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(L)","key":"sJ3xbRZ2eS"},{"type":"output","id":"xCv2470B04HT3T5yvQUov","data":[{"output_type":"stream","name":"stdout","text":"[[ 1.          0.          0.          0.        ]\n [-0.25        1.          0.          0.        ]\n [ 0.5        -0.15384615  1.          0.        ]\n [-0.5         0.15384615  0.08333333  1.        ]]\n"}],"key":"mjYzysACwS"}],"key":"gOYhTzohRE"}],"key":"UPYDkXfu0F"}],"key":"ntJPo4gGy2"}],"key":"exiE7QVr1l"}],"key":"AuWCcNU0Ez"}],"label":"demo-pivoting-permute","identifier":"demo-pivoting-permute","enumerator":"2.6.3","html_id":"demo-pivoting-permute","key":"Vrydh9vxI3"},{"type":"paragraph","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"children":[{"type":"text","value":"In principle, if the permutation of rows implied by the pivot locations is applied all at once to the original ","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"key":"lNr28qKRBf"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"Fx2g0TJo31"},{"type":"text","value":", no further pivoting is needed. In practice, this permutation cannot be determined immediately from the original ","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"key":"RjzW0BhPLI"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"fCoYOlhV8x"},{"type":"text","value":"; the only way to find it is to run the algorithm. Having obtained it at the end, though, we can use it to state a simple relationship.","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"key":"aPp9c9YNcg"}],"key":"LTrmcOuX24"},{"type":"proof","kind":"definition","enumerated":true,"children":[{"type":"admonitionTitle","children":[{"type":"text","value":"PLU factorization","position":{"start":{"line":121,"column":1},"end":{"line":121,"column":1}},"key":"qETqXXuJC9"}],"key":"BwWdt3sgiE"},{"type":"paragraph","position":{"start":{"line":123,"column":1},"end":{"line":123,"column":1}},"children":[{"type":"text","value":"Given ","position":{"start":{"line":123,"column":1},"end":{"line":123,"column":1}},"key":"bvY1PXEbmj"},{"type":"inlineMath","value":"n\\times n","position":{"start":{"line":123,"column":1},"end":{"line":123,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>×</mo><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n\\times n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"Hpb6O3ibf4"},{"type":"text","value":" matrix ","position":{"start":{"line":123,"column":1},"end":{"line":123,"column":1}},"key":"nhoEyYZwei"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":123,"column":1},"end":{"line":123,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"hSPUBMoyfk"},{"type":"text","value":", the ","position":{"start":{"line":123,"column":1},"end":{"line":123,"column":1}},"key":"tLzHGHEuIm"},{"type":"crossReference","label":"PLU factorization","identifier":"term-plu factorization","kind":"definitionTerm","children":[{"type":"text","value":"PLU factorization","position":{"start":{"line":280,"column":1},"end":{"line":280,"column":1}},"key":"bDDZNI39FQ"}],"template":"{name}","resolved":true,"html_id":"term-plu-factorization","remote":true,"url":"/glossary","dataUrl":"/glossary.json","key":"sqz5fK6Sy1"},{"type":"text","value":" is a unit lower triangular ","position":{"start":{"line":123,"column":1},"end":{"line":123,"column":1}},"key":"T1mhy5EWW6"},{"type":"inlineMath","value":"\\mathbf{L}","position":{"start":{"line":123,"column":1},"end":{"line":123,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">L</span></span></span></span>","key":"jke6VSXdPj"},{"type":"text","value":", an upper triangular ","position":{"start":{"line":123,"column":1},"end":{"line":123,"column":1}},"key":"cs3maeLMjZ"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":123,"column":1},"end":{"line":123,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"awMZnk61j1"},{"type":"text","value":", and a permutation ","position":{"start":{"line":123,"column":1},"end":{"line":123,"column":1}},"key":"IvkUeY00pN"},{"type":"inlineMath","value":"i_1,\\ldots,i_n","position":{"start":{"line":123,"column":1},"end":{"line":123,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>i</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><mo>…</mo><mo separator=\"true\">,</mo><msub><mi>i</mi><mi>n</mi></msub></mrow><annotation encoding=\"application/x-tex\">i_1,\\ldots,i_n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"M1MKALT3Sx"},{"type":"text","value":" of the integers ","position":{"start":{"line":123,"column":1},"end":{"line":123,"column":1}},"key":"clbZKypiGe"},{"type":"inlineMath","value":"1,\\ldots,n","position":{"start":{"line":123,"column":1},"end":{"line":123,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mo separator=\"true\">,</mo><mo>…</mo><mo separator=\"true\">,</mo><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">1,\\ldots,n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8389em;vertical-align:-0.1944em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"JTOXXBRNlo"},{"type":"text","value":", such that","position":{"start":{"line":123,"column":1},"end":{"line":123,"column":1}},"key":"dDpWePNypB"}],"key":"e6auHyxM1A"},{"type":"math","value":"\\tilde{\\mathbf{A}} = \\mathbf{L}\\mathbf{U},","position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mover accent=\"true\"><mi mathvariant=\"bold\">A</mi><mo>~</mo></mover><mo>=</mo><mi mathvariant=\"bold\">L</mi><mi mathvariant=\"bold\">U</mi><mo separator=\"true\">,</mo></mrow><annotation encoding=\"application/x-tex\">\\tilde{\\mathbf{A}} = \\mathbf{L}\\mathbf{U},</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.923em;\"></span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.923em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathbf\">A</span></span><span style=\"top:-3.6051em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.1111em;\"><span class=\"mord\">~</span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8805em;vertical-align:-0.1944em;\"></span><span class=\"mord mathbf\">LU</span><span class=\"mpunct\">,</span></span></span></span></span>","enumerator":"2.6.1","key":"x3dNeBgG6p"},{"type":"paragraph","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"children":[{"type":"text","value":"where rows ","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"key":"hHTpyFUA1L"},{"type":"inlineMath","value":"1,\\ldots,n","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mo separator=\"true\">,</mo><mo>…</mo><mo separator=\"true\">,</mo><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">1,\\ldots,n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8389em;vertical-align:-0.1944em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"hV0tjIBCNz"},{"type":"text","value":" of ","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"key":"mEb4I9VJW8"},{"type":"inlineMath","value":"\\tilde{\\mathbf{A}}","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mover accent=\"true\"><mi mathvariant=\"bold\">A</mi><mo>~</mo></mover></mrow><annotation encoding=\"application/x-tex\">\\tilde{\\mathbf{A}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.923em;\"></span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.923em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathbf\">A</span></span><span style=\"top:-3.6051em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.1111em;\"><span class=\"mord\">~</span></span></span></span></span></span></span></span></span></span>","key":"xYLLYcyDJN"},{"type":"text","value":" are rows ","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"key":"mvpRemdDqd"},{"type":"inlineMath","value":"i_1,\\ldots,i_n","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>i</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><mo>…</mo><mo separator=\"true\">,</mo><msub><mi>i</mi><mi>n</mi></msub></mrow><annotation encoding=\"application/x-tex\">i_1,\\ldots,i_n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"Flwxqm5BJh"},{"type":"text","value":" of ","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"key":"g1zPAHbVmq"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"BmGrDoQs8J"},{"type":"text","value":".","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"key":"muZQJKdosG"}],"key":"G5CnmH6VsG"}],"label":"definition-plu","identifier":"definition-plu","indexEntries":[{"entry":"matrix factorization","subEntry":{"value":"pivoted LU","kind":"entry"},"emphasis":true},{"entry":"PLU factorization","emphasis":true}],"enumerator":"2.6.2","html_id":"definition-plu","key":"rMRJ8T3IWL"},{"type":"paragraph","position":{"start":{"line":130,"column":1},"end":{"line":130,"column":1}},"children":[{"type":"crossReference","kind":"proof:algorithm","identifier":"function-plufact","label":"function-plufact","children":[{"type":"text","value":"Function ","key":"MKqZ9Qi5ZS"},{"type":"text","value":"2.6.1","key":"SRh6JGmQMp"}],"template":"Algorithm %s","enumerator":"2.6.1","resolved":true,"html_id":"function-plufact","key":"kH0KgEV5op"},{"type":"text","value":" shows our implementation of PLU factorization.","position":{"start":{"line":130,"column":1},"end":{"line":130,"column":1}},"key":"fhxHRo7DXt"},{"type":"footnoteReference","identifier":"plu","label":"PLU","position":{"start":{"line":130,"column":1},"end":{"line":130,"column":1}},"enumerator":"1","key":"AQBwP7aOFg"}],"key":"IIPC3G6ryL"},{"type":"proof","kind":"algorithm","enumerated":true,"children":[{"type":"admonitionTitle","children":[{"type":"text","value":"plufact","position":{"start":{"line":134,"column":1},"end":{"line":134,"column":1}},"key":"H9Aqb0aNiz"}],"key":"oJl0KegIFS"},{"type":"tabSet","children":[{"type":"tabItem","title":"Julia","sync":"julia","children":[{"type":"embed","source":{"url":"/chapter2","label":"function-plufact-julia","kind":"Notebook","slug":"chapter2","location":"/julia/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"LU factorization with partial pivoting","position":{"start":{"line":66,"column":1},"end":{"line":66,"column":1}},"key":"NglacXhsVE"}],"key":"hsOqyxrQ1T"},{"type":"include","file":"FNCFunctions/src/chapter02.jl","literal":true,"filter":{"startAfter":"# begin plufact","endBefore":"# end plufact"},"children":[{"type":"code","value":"\"\"\"\n    plufact(A)\n\nCompute the PLU factorization of square matrix `A`, returning the\ntriangular factors and a row permutation vector.\n\"\"\"\nfunction plufact(A)\n    n = size(A, 1)\n    L = zeros(n, n)\n    U = zeros(n, n)\n    p = fill(0, n)\n    Aₖ = float(copy(A))\n\n    # Reduction by outer products\n    for k in 1:n\n        p[k] = argmax(abs.(Aₖ[:, k]))    # best pivot in column k\n        U[k, :] = Aₖ[p[k], :]\n        L[:, k] = Aₖ[:, k] / U[k, k]\n        if k < n    # no update needed on last iteration\n            Aₖ -= L[:, k] * U[k, :]'\n        end\n    end\n    return LowerTriangular(L[p, :]), U, p\nend","lang":"julia","showLineNumbers":true,"filename":"plufact.jl","key":"j09LvWpeEC"}],"key":"aWmlpBqSET"},{"type":"code","lang":"","value":"","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"key":"OhBBHC2Q4F"}],"key":"Em7a63ohvQ"}],"key":"tH0jKYFy3D"}],"key":"f8THhzEGEf"},{"type":"tabItem","title":"MATLAB","sync":"matlab","children":[{"type":"embed","source":{"url":"/chapter2","label":"function-plufact-julia","kind":"Notebook","slug":"chapter2","location":"/julia/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"LU factorization with partial pivoting","position":{"start":{"line":66,"column":1},"end":{"line":66,"column":1}},"key":"eSNOskDVaw"}],"key":"K4lJl1jBd8"},{"type":"include","file":"FNCFunctions/src/chapter02.jl","literal":true,"filter":{"startAfter":"# begin plufact","endBefore":"# end plufact"},"children":[{"type":"code","value":"\"\"\"\n    plufact(A)\n\nCompute the PLU factorization of square matrix `A`, returning the\ntriangular factors and a row permutation vector.\n\"\"\"\nfunction plufact(A)\n    n = size(A, 1)\n    L = zeros(n, n)\n    U = zeros(n, n)\n    p = fill(0, n)\n    Aₖ = float(copy(A))\n\n    # Reduction by outer products\n    for k in 1:n\n        p[k] = argmax(abs.(Aₖ[:, k]))    # best pivot in column k\n        U[k, :] = Aₖ[p[k], :]\n        L[:, k] = Aₖ[:, k] / U[k, k]\n        if k < n    # no update needed on last iteration\n            Aₖ -= L[:, k] * U[k, :]'\n        end\n    end\n    return LowerTriangular(L[p, :]), U, p\nend","lang":"julia","showLineNumbers":true,"filename":"plufact.jl","key":"zbUfZn6I7P"}],"key":"YNPox2AoRk"},{"type":"code","lang":"","value":"","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"key":"ftbNjwDJim"}],"key":"iugqUJ2ZwH"}],"key":"KWAUEOOtUK"}],"key":"Qb16QmEgN6"},{"type":"tabItem","title":"Python","sync":"python","children":[{"type":"embed","source":{"url":"/chapter2-2","label":"function-plufact-python","kind":"Notebook","slug":"chapter2-2","location":"/python/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"LU factorization with partial pivoting","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"key":"bnlp1jZphY"}],"key":"j3Ln42739u"},{"type":"include","file":"fncbook/fncbook/chapter02.py","literal":true,"filter":{"lines":[[52,72]]},"children":[{"type":"code","value":"def plufact(A):\n    \"\"\"\n        plufact(A)\n\n    Compute the PLU factorization of square matrix A, returning the\n    triangular factors and a row permutation vector.\n    \"\"\"\n    n = A.shape[0]\n    L = np.zeros((n, n))\n    U = np.zeros((n, n))\n    p = np.zeros(n, dtype=int)\n    A_k = np.copy(A.astype(float))\n\n    # Reduction by outer products\n    for k in range(n):\n        p[k] = np.argmax(abs(A_k[:, k]))\n        U[k, :] = A_k[p[k], :]\n        L[:, k] = A_k[:, k] / U[k, k]\n        if k < n-1:\n            A_k -= np.outer(L[:, k], U[k, :])\n    return L[p, :], U, p","lang":"python","showLineNumbers":true,"filename":"plufact.py","key":"DOXxgffzYr"}],"key":"UVq16b4qCO"}],"key":"EnWpF39PFK"}],"key":"Mta8QnwzOZ"}],"key":"y0N6wWQAls"}],"key":"gwCJbzgTqP"}],"label":"function-plufact","identifier":"function-plufact","enumerator":"2.6.1","html_id":"function-plufact","key":"WWCLuj8VK6"},{"type":"paragraph","position":{"start":{"line":158,"column":1},"end":{"line":158,"column":1}},"children":[{"type":"text","value":"Ideally, the PLU factorization takes ","position":{"start":{"line":158,"column":1},"end":{"line":158,"column":1}},"key":"D6e81fIVkk"},{"type":"inlineMath","value":"\\sim \\frac{2}{3}n^3","position":{"start":{"line":158,"column":1},"end":{"line":158,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>∼</mo><mfrac><mn>2</mn><mn>3</mn></mfrac><msup><mi>n</mi><mn>3</mn></msup></mrow><annotation encoding=\"application/x-tex\">\\sim \\frac{2}{3}n^3</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.3669em;\"></span><span class=\"mrel\">∼</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1901em;vertical-align:-0.345em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8451em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">3</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mord\"><span class=\"mord mathnormal\">n</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span></span></span></span></span></span></span></span>","key":"yuS5G6aUkg"},{"type":"text","value":" flops asymptotically, just like LU without pivoting. The implementation in ","position":{"start":{"line":158,"column":1},"end":{"line":158,"column":1}},"key":"sbngIJ8VO7"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-plufact","label":"function-plufact","children":[{"type":"text","value":"Function ","key":"lhWf7P3bfa"},{"type":"text","value":"2.6.1","key":"Q9VNjqxCak"}],"template":"Algorithm %s","enumerator":"2.6.1","resolved":true,"html_id":"function-plufact","key":"smm6304QlY"},{"type":"text","value":" does not achieve this optimal flop count, however. Like ","position":{"start":{"line":158,"column":1},"end":{"line":158,"column":1}},"key":"QqEmBupBYo"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-lufact","label":"function-lufact","children":[{"type":"text","value":"Function ","key":"CNMRDXcPkP"},{"type":"text","value":"2.4.1","key":"vmpHFa6VaC"}],"template":"Algorithm %s","enumerator":"2.4.1","resolved":true,"html_id":"function-lufact","remote":true,"url":"/lu","dataUrl":"/lu.json","key":"XcyHSStMQ8"},{"type":"text","value":", it does unnecessary operations on structurally known zeros for the sake of being easier to understand.","position":{"start":{"line":158,"column":1},"end":{"line":158,"column":1}},"key":"Y9EaBoALA4"}],"key":"C5FdXxkcgL"},{"type":"heading","depth":2,"position":{"start":{"line":160,"column":1},"end":{"line":160,"column":1}},"children":[{"type":"text","value":"Linear systems","position":{"start":{"line":160,"column":1},"end":{"line":160,"column":1}},"key":"bQAodH64hs"}],"identifier":"linear-systems","label":"Linear systems","html_id":"linear-systems","implicit":true,"enumerator":"2.6.3","key":"UkgfdoNh1w"},{"type":"paragraph","position":{"start":{"line":162,"column":1},"end":{"line":162,"column":1}},"children":[{"type":"text","value":"The output of ","position":{"start":{"line":162,"column":1},"end":{"line":162,"column":1}},"key":"TtCIeGeo7q"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-plufact","label":"function-plufact","children":[{"type":"text","value":"Function ","key":"AXSfUK3hQe"},{"type":"text","value":"2.6.1","key":"NlM2vapZTP"}],"template":"Algorithm %s","enumerator":"2.6.1","resolved":true,"html_id":"function-plufact","key":"ur48M4d6tt"},{"type":"text","value":" is a factorization of a row-permuted ","position":{"start":{"line":162,"column":1},"end":{"line":162,"column":1}},"key":"t4Q78c6Lgj"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":162,"column":1},"end":{"line":162,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"bqw8a7lb8e"},{"type":"text","value":". Therefore, given a linear system ","position":{"start":{"line":162,"column":1},"end":{"line":162,"column":1}},"key":"naCAtiJ71l"},{"type":"inlineMath","value":"\\mathbf{A}\\mathbf{x}=\\mathbf{b}","position":{"start":{"line":162,"column":1},"end":{"line":162,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi><mi mathvariant=\"bold\">x</mi><mo>=</mo><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}\\mathbf{x}=\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">Ax</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"WYs6hDKEHE"},{"type":"text","value":", we have to permute ","position":{"start":{"line":162,"column":1},"end":{"line":162,"column":1}},"key":"AITAnJaJj7"},{"type":"inlineMath","value":"\\mathbf{b}","position":{"start":{"line":162,"column":1},"end":{"line":162,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"gcSUsTZGy9"},{"type":"text","value":" the same way before applying forward and backward substitution. This is equivalent to changing the order of the equations in a linear system, which does not affect its solution.","position":{"start":{"line":162,"column":1},"end":{"line":162,"column":1}},"key":"oXBlLeSGFT"}],"key":"dCufLBShU7"},{"type":"proof","kind":"example","enumerated":true,"children":[{"type":"admonitionTitle","children":[{"type":"text","value":"PLU factorization for solving linear systems","position":{"start":{"line":164,"column":1},"end":{"line":164,"column":1}},"key":"LQ8IInYJ9X"}],"key":"RTGeMC8yWk"},{"type":"tabSet","children":[{"type":"tabItem","title":"Julia","sync":"julia","children":[{"type":"embed","source":{"url":"/chapter2","label":"demo-pivoting-usage-julia","kind":"Notebook","slug":"chapter2","location":"/julia/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-pivoting-usage","label":"demo-pivoting-usage","kind":"proof:example","position":{"start":{"line":967,"column":1},"end":{"line":967,"column":21}},"children":[{"type":"text","value":"Example ","key":"T3g1ugzI0f"},{"type":"text","value":"2.6.4","key":"bOamzbHEt2"}],"template":"Example %s","enumerator":"2.6.4","resolved":true,"html_id":"demo-pivoting-usage","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"npc702vJTS"}],"key":"z3QaZe4jR9"},{"type":"paragraph","position":{"start":{"line":969,"column":1},"end":{"line":969,"column":1}},"children":[{"type":"text","value":"The third output of ","position":{"start":{"line":969,"column":1},"end":{"line":969,"column":1}},"key":"IjXYXEmLDB"},{"type":"inlineCode","value":"plufact","position":{"start":{"line":969,"column":1},"end":{"line":969,"column":1}},"key":"mHxpIBTk7p"},{"type":"text","value":" is the permutation vector we need to apply to ","position":{"start":{"line":969,"column":1},"end":{"line":969,"column":1}},"key":"tRtZC2D8Rj"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":969,"column":1},"end":{"line":969,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"wpa9SLm0d1"},{"type":"text","value":".","position":{"start":{"line":969,"column":1},"end":{"line":969,"column":1}},"key":"cn3avNgrLC"}],"key":"N87IJNhoAt"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"A = rand(1:20, 4, 4)\nL, U, p = FNC.plufact(A)\nA[p,:] - L * U   # should be ≈ 0","key":"TI8yxlEdp0"},{"type":"output","id":"Q03xYP-pjFMNtolry6sci","data":[{"output_type":"execute_result","execution_count":94,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n 0.0  0.0  0.0   0.0\n 0.0  0.0  0.0   0.0\n 0.0  0.0  0.0   0.0\n 0.0  0.0  0.0  -1.77636e-15","content_type":"text/plain"}}}],"key":"MOGQLKbagG"}],"key":"UY48gOtI57"},{"type":"paragraph","position":{"start":{"line":977,"column":1},"end":{"line":977,"column":1}},"children":[{"type":"text","value":"Given a vector ","position":{"start":{"line":977,"column":1},"end":{"line":977,"column":1}},"key":"FACyhfqyBl"},{"type":"inlineMath","value":"\\mathbf{b}","position":{"start":{"line":977,"column":1},"end":{"line":977,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"epNLVXNffz"},{"type":"text","value":", we solve ","position":{"start":{"line":977,"column":1},"end":{"line":977,"column":1}},"key":"jaOW4OPyQz"},{"type":"inlineMath","value":"\\mathbf{A}\\mathbf{x}=\\mathbf{b}","position":{"start":{"line":977,"column":1},"end":{"line":977,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi><mi mathvariant=\"bold\">x</mi><mo>=</mo><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}\\mathbf{x}=\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">Ax</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"nzA5n7i4tB"},{"type":"text","value":" by first permuting the entries of ","position":{"start":{"line":977,"column":1},"end":{"line":977,"column":1}},"key":"piBXm8LJO0"},{"type":"inlineMath","value":"\\mathbf{b}","position":{"start":{"line":977,"column":1},"end":{"line":977,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"Q70kJ0r6XI"},{"type":"text","value":" and then proceeding as before.","position":{"start":{"line":977,"column":1},"end":{"line":977,"column":1}},"key":"pixZLtockT"}],"key":"OlRIvHAOWu"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"b = rand(4)\nz = FNC.forwardsub(L,b[p])\nx = FNC.backsub(U,z)","key":"IgbxBBDavj"},{"type":"output","id":"lrA7GBxIJZtQhdyS_o5FV","data":[{"output_type":"execute_result","execution_count":95,"metadata":{},"data":{"text/plain":{"content":"4-element Vector{Float64}:\n 0.023039667356802046\n 0.014121742816367747\n 0.003961251561819696\n 0.006337814525664121","content_type":"text/plain"}}}],"key":"WcJIZiNVOi"}],"key":"VZLCFeeyKs"},{"type":"paragraph","position":{"start":{"line":985,"column":1},"end":{"line":985,"column":1}},"children":[{"type":"text","value":"A residual check is successful:","position":{"start":{"line":985,"column":1},"end":{"line":985,"column":1}},"key":"JFGEMguEtj"}],"key":"mO25VJR7A4"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"b - A*x","key":"UDXZNTkBgy"},{"type":"output","id":"eox5-1uVKgt5JxVoJKC82","data":[{"output_type":"execute_result","execution_count":96,"metadata":{},"data":{"text/plain":{"content":"4-element Vector{Float64}:\n 0.0\n 1.1102230246251565e-16\n 0.0\n 0.0","content_type":"text/plain"}}}],"key":"pT1HOg4NGY"}],"key":"vfxG16VIec"}],"key":"z01yUB2Dlw"}],"key":"cyEKGh6Jc4"}],"key":"kCDsm92ezO"},{"type":"tabItem","title":"MATLAB","sync":"matlab","children":[{"type":"embed","source":{"url":"/chapter2-1","label":"demo-pivoting-usage-matlab","kind":"Notebook","slug":"chapter2-1","location":"/matlab/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-pivoting-usage","label":"demo-pivoting-usage","kind":"proof:example","position":{"start":{"line":912,"column":1},"end":{"line":912,"column":21}},"children":[{"type":"text","value":"Example ","key":"PARTxa4wuU"},{"type":"text","value":"2.6.4","key":"F24c2f4tNh"}],"template":"Example %s","enumerator":"2.6.4","resolved":true,"html_id":"demo-pivoting-usage","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"f2HwpWFBpS"}],"key":"URUY1NwmCN"},{"type":"paragraph","position":{"start":{"line":914,"column":1},"end":{"line":914,"column":1}},"children":[{"type":"text","value":"The third output of ","position":{"start":{"line":914,"column":1},"end":{"line":914,"column":1}},"key":"wC1cRhqV8m"},{"type":"inlineCode","value":"plufact","position":{"start":{"line":914,"column":1},"end":{"line":914,"column":1}},"key":"rDRRbGas3W"},{"type":"text","value":" is the permutation vector we need to apply to ","position":{"start":{"line":914,"column":1},"end":{"line":914,"column":1}},"key":"Kp9rB84tV7"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":914,"column":1},"end":{"line":914,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"UNtdxdy5BG"},{"type":"text","value":".","position":{"start":{"line":914,"column":1},"end":{"line":914,"column":1}},"key":"WbIzoTWNIN"}],"key":"tzMt3NPQds"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A = randi(20, 4, 4);\n[L, U, p] = plufact(A);\nA(p, :) - L * U    % should be ≈ 0","key":"w51qyh5dBT"},{"type":"output","id":"WDXtd3LMfezl5kUJs9JKP","data":[{"output_type":"execute_result","execution_count":92,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = 4×4 double\n     0     0     0     0\n     0     0     0     0\n     0     0     0     0\n     0     0     0     0\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = 4×4 double\n     0     0     0     0\n     0     0     0     0\n     0     0     0     0\n     0     0     0     0\n","content_type":"text/plain"}}}],"key":"r0ulkABtbC"}],"key":"Wcf5hxewpq"},{"type":"paragraph","position":{"start":{"line":922,"column":1},"end":{"line":922,"column":1}},"children":[{"type":"text","value":"Given a vector ","position":{"start":{"line":922,"column":1},"end":{"line":922,"column":1}},"key":"m9sHCr6Adn"},{"type":"inlineMath","value":"\\mathbf{b}","position":{"start":{"line":922,"column":1},"end":{"line":922,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"i8HmvzNris"},{"type":"text","value":", we solve ","position":{"start":{"line":922,"column":1},"end":{"line":922,"column":1}},"key":"p2kmKbUDEy"},{"type":"inlineMath","value":"\\mathbf{A}\\mathbf{x}=\\mathbf{b}","position":{"start":{"line":922,"column":1},"end":{"line":922,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi><mi mathvariant=\"bold\">x</mi><mo>=</mo><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}\\mathbf{x}=\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">Ax</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"siIwMOabzJ"},{"type":"text","value":" by first permuting the entries of ","position":{"start":{"line":922,"column":1},"end":{"line":922,"column":1}},"key":"l6q9w60PXg"},{"type":"inlineMath","value":"\\mathbf{b}","position":{"start":{"line":922,"column":1},"end":{"line":922,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"PaGXqftww0"},{"type":"text","value":" and then proceeding as before.","position":{"start":{"line":922,"column":1},"end":{"line":922,"column":1}},"key":"BX5zF6dSez"}],"key":"HPzsvFWQ21"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"b = rand(4, 1);\nz = forwardsub(L, b(p));\nx = backsub(U, z)","key":"C2c8hHvbwA"},{"type":"output","id":"BEfdUaFhR45gXdVjsh_pB","data":[{"output_type":"execute_result","execution_count":93,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>x = 4×1 double\n    0.0239\n   -0.2909\n    0.2655\n   -0.0113\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"x = 4×1 double\n    0.0239\n   -0.2909\n    0.2655\n   -0.0113\n","content_type":"text/plain"}}}],"key":"nf5MED63fX"}],"key":"F8wGfE4PMq"},{"type":"paragraph","position":{"start":{"line":930,"column":1},"end":{"line":930,"column":1}},"children":[{"type":"text","value":"A residual check is successful:","position":{"start":{"line":930,"column":1},"end":{"line":930,"column":1}},"key":"u2alFHrtI5"}],"key":"oKsZDac1Y6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"b - A*x","key":"eRP9hk5tPb"},{"type":"output","id":"B3aQn3Ljqy3VXzZbxURE6","data":[{"output_type":"execute_result","execution_count":94,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = 4×1 double\n1.0e-15 *\n\n         0\n    0.0555\n   -0.6661\n    0.1110\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = 4×1 double\n1.0e-15 *\n\n         0\n    0.0555\n   -0.6661\n    0.1110\n","content_type":"text/plain"}}}],"key":"DryrGyABzT"}],"key":"MziBKQ4wFc"}],"key":"ojkTOhgZ7q"}],"key":"hReWXdjshB"}],"key":"MKsSwJO2ip"},{"type":"tabItem","title":"Python","sync":"python","children":[{"type":"embed","source":{"url":"/chapter2-2","label":"demo-pivoting-usage-python","kind":"Notebook","slug":"chapter2-2","location":"/python/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-pivoting-usage","label":"demo-pivoting-usage","kind":"proof:example","position":{"start":{"line":909,"column":1},"end":{"line":909,"column":21}},"children":[{"type":"text","value":"Example ","key":"pDiEjs7D1l"},{"type":"text","value":"2.6.4","key":"NvJneqCj8b"}],"template":"Example %s","enumerator":"2.6.4","resolved":true,"html_id":"demo-pivoting-usage","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"h8t57RdYBd"}],"key":"VT2xIlN6WM"},{"type":"paragraph","position":{"start":{"line":911,"column":1},"end":{"line":911,"column":1}},"children":[{"type":"text","value":"The third output of ","position":{"start":{"line":911,"column":1},"end":{"line":911,"column":1}},"key":"iGQMAenaTi"},{"type":"inlineCode","value":"plufact","position":{"start":{"line":911,"column":1},"end":{"line":911,"column":1}},"key":"eSCxddm43o"},{"type":"text","value":" is the permutation vector we need to apply to ","position":{"start":{"line":911,"column":1},"end":{"line":911,"column":1}},"key":"v2UxMz1Cb3"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":911,"column":1},"end":{"line":911,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"Oig74kK653"},{"type":"text","value":".","position":{"start":{"line":911,"column":1},"end":{"line":911,"column":1}},"key":"UETEkUd2CS"}],"key":"EWPPO61s1y"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"A = random.randn(4, 4)\nL, U, p = FNC.plufact(A)\nA[p, :] - L @ U   # should be ≈ 0","key":"w8khklK8qp"},{"type":"output","id":"f73zTiIoB3oCKajbvxp2-","data":[{"output_type":"execute_result","execution_count":91,"metadata":{},"data":{"text/plain":{"content":"array([[ 0.00000000e+00,  0.00000000e+00,  0.00000000e+00,\n         0.00000000e+00],\n       [ 0.00000000e+00,  0.00000000e+00,  0.00000000e+00,\n         0.00000000e+00],\n       [ 0.00000000e+00,  0.00000000e+00,  0.00000000e+00,\n         0.00000000e+00],\n       [ 0.00000000e+00, -1.11022302e-16,  0.00000000e+00,\n        -2.77555756e-17]])","content_type":"text/plain"}}}],"key":"QvjJVMwd4e"}],"key":"gYh5IaGWAU"},{"type":"paragraph","position":{"start":{"line":919,"column":1},"end":{"line":919,"column":1}},"children":[{"type":"text","value":"Given a vector ","position":{"start":{"line":919,"column":1},"end":{"line":919,"column":1}},"key":"RZkm3BUIJQ"},{"type":"inlineMath","value":"\\mathbf{b}","position":{"start":{"line":919,"column":1},"end":{"line":919,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"uv3MSZPHK2"},{"type":"text","value":", we solve ","position":{"start":{"line":919,"column":1},"end":{"line":919,"column":1}},"key":"p1GdvH8QlO"},{"type":"inlineMath","value":"\\mathbf{A}\\mathbf{x}=\\mathbf{b}","position":{"start":{"line":919,"column":1},"end":{"line":919,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi><mi mathvariant=\"bold\">x</mi><mo>=</mo><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}\\mathbf{x}=\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">Ax</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"cIdoVUCvoF"},{"type":"text","value":" by first permuting the entries of ","position":{"start":{"line":919,"column":1},"end":{"line":919,"column":1}},"key":"UWVCyFPEhM"},{"type":"inlineMath","value":"\\mathbf{b}","position":{"start":{"line":919,"column":1},"end":{"line":919,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"UofG3G8RUC"},{"type":"text","value":" and then proceeding as before.","position":{"start":{"line":919,"column":1},"end":{"line":919,"column":1}},"key":"l3aQ05mjds"}],"key":"KUanXF2ZDQ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"b = random.randn(4)\nz = FNC.forwardsub(L, b[p])\nx = FNC.backsub(U, z)","key":"a4Hi5vBmIx"},{"type":"output","id":"jYjnfjVpARO344ljR-klr","data":[],"key":"d1rSSkoWWE"}],"key":"Ap1Hw6RAHZ"},{"type":"paragraph","position":{"start":{"line":927,"column":1},"end":{"line":927,"column":1}},"children":[{"type":"text","value":"A residual check is successful:","position":{"start":{"line":927,"column":1},"end":{"line":927,"column":1}},"key":"cQmUcaQxwZ"}],"key":"BqO0OCGrnx"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"b - A @ x","key":"rAH3dTzPC3"},{"type":"output","id":"_RRySd49JfOsHIscmTenC","data":[{"output_type":"execute_result","execution_count":93,"metadata":{},"data":{"text/plain":{"content":"array([-8.32667268e-16, -2.22044605e-16,  4.44089210e-16,  3.33066907e-16])","content_type":"text/plain"}}}],"key":"c54mXlg2G8"}],"key":"aPfetO2Rxj"}],"key":"sDUBXcUWOj"}],"key":"IFOTzbb2Lf"}],"key":"uSPDqpF8Aw"}],"key":"LRayHMPUMV"}],"label":"demo-pivoting-usage","identifier":"demo-pivoting-usage","enumerator":"2.6.4","html_id":"demo-pivoting-usage","key":"RAfUzZEcRY"},{"type":"paragraph","position":{"start":{"line":189,"column":1},"end":{"line":189,"column":1}},"children":[{"type":"text","value":"While ","position":{"start":{"line":189,"column":1},"end":{"line":189,"column":1}},"key":"rHMbOiT9kO"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-plufact","label":"function-plufact","children":[{"type":"text","value":"Function ","key":"gwQ5rLXmAM"},{"type":"text","value":"2.6.1","key":"OYydOBI3V0"}],"template":"Algorithm %s","enumerator":"2.6.1","resolved":true,"html_id":"function-plufact","key":"mz0yGQlrK6"},{"type":"text","value":" is a serviceable implementation, it is not the gold standard for solving linear systems in practice. Each language offers its own built-in function for PLU factorization.","position":{"start":{"line":189,"column":1},"end":{"line":189,"column":1}},"key":"zD2GaUPI0r"}],"key":"zUjrA01JbI"},{"type":"proof","kind":"example","enumerated":true,"children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Built-in PLU factorization","position":{"start":{"line":191,"column":1},"end":{"line":191,"column":1}},"key":"Trcnh9IXlq"}],"key":"xt1JfJrLWm"},{"type":"tabSet","children":[{"type":"tabItem","title":"Julia","sync":"julia","children":[{"type":"embed","source":{"url":"/chapter2","label":"demo-pivoting-builtin-julia","kind":"Notebook","slug":"chapter2","location":"/julia/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-pivoting-builtin","label":"demo-pivoting-builtin","kind":"proof:example","position":{"start":{"line":993,"column":1},"end":{"line":993,"column":23}},"children":[{"type":"text","value":"Example ","key":"p7GgPedDnu"},{"type":"text","value":"2.6.5","key":"lQ8TxncNbn"}],"template":"Example %s","enumerator":"2.6.5","resolved":true,"html_id":"demo-pivoting-builtin","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"Vsc7oikrUj"}],"key":"WjlmKo2doD"},{"type":"paragraph","position":{"start":{"line":995,"column":1},"end":{"line":995,"column":1}},"children":[{"type":"text","value":"With the syntax ","position":{"start":{"line":995,"column":1},"end":{"line":995,"column":1}},"key":"F48jNSWsIe"},{"type":"inlineCode","value":"A \\ b","position":{"start":{"line":995,"column":1},"end":{"line":995,"column":1}},"key":"XnDHvdkadc"},{"type":"text","value":", the matrix ","position":{"start":{"line":995,"column":1},"end":{"line":995,"column":1}},"key":"wmNBlvFXkN"},{"type":"inlineCode","value":"A","position":{"start":{"line":995,"column":1},"end":{"line":995,"column":1}},"key":"aO2LekRtLZ"},{"type":"text","value":" is PLU-factored, followed by two triangular solves.","position":{"start":{"line":995,"column":1},"end":{"line":995,"column":1}},"key":"f51TWySkGD"}],"key":"tH1jrCs03v"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"A = randn(500, 500)    # 500x500 with normal random entries\nA \\ rand(500)          # force compilation for timing\n@elapsed for k=1:50; A \\ rand(500); end","key":"Jq6e6zCn2k"},{"type":"output","id":"BCz36Sh7aPdLYbaVI5ExA","data":[{"output_type":"execute_result","execution_count":97,"metadata":{},"data":{"text/plain":{"content":"0.11633175","content_type":"text/plain"}}}],"key":"Xz0NoVzFSG"}],"key":"JOM78cJ2F2"},{"type":"paragraph","position":{"start":{"line":1003,"column":1},"end":{"line":1003,"column":1}},"children":[{"type":"text","value":"In ","position":{"start":{"line":1003,"column":1},"end":{"line":1003,"column":1}},"key":"gONkEmYCMc"},{"type":"link","kind":"numref","identifier":"section-linsys-efficiency","label":"section-linsys-efficiency","url":"/efficiency","internal":true,"dataUrl":"/efficiency.json","children":[{"type":"text","value":"Efficiency of matrix computations","key":"iQDtyTJOG7"}],"key":"g8MV2EpuaS"},{"type":"text","value":" we showed that the factorization is by far the most costly part of the solution process. The ","position":{"start":{"line":1003,"column":1},"end":{"line":1003,"column":1}},"key":"b02x0qipoT"},{"type":"inlineCode","value":"lu","position":{"start":{"line":1003,"column":1},"end":{"line":1003,"column":1}},"key":"wuDeNoOkqI"},{"type":"text","value":" function from the built-in package ","position":{"start":{"line":1003,"column":1},"end":{"line":1003,"column":1}},"key":"NK0f1k8064"},{"type":"inlineCode","value":"LinearAlgebra","position":{"start":{"line":1003,"column":1},"end":{"line":1003,"column":1}},"key":"lfq9pgrKZc"},{"type":"text","value":" returns a factorization object that allows us to do that costly step only once per unique matrix.","position":{"start":{"line":1003,"column":1},"end":{"line":1003,"column":1}},"key":"UWXmxpGf9h"}],"key":"M7hx1cqScN"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"factored = lu(A)       # store factorization result\nfactored \\ rand(500)   # force compilation for timing\n@elapsed for k=1:50; factored \\ rand(500); end","key":"YlyDq5qHGj"},{"type":"output","id":"bdKqZdxZ-0-zF7rSRoRLO","data":[{"output_type":"execute_result","execution_count":98,"metadata":{},"data":{"text/plain":{"content":"0.002107","content_type":"text/plain"}}}],"key":"fxcJKLeT75"}],"key":"WAYPjguRCV"}],"key":"agdmSIAD1Y"}],"key":"A9dvFjhVaO"}],"key":"uSrdem90Ta"},{"type":"tabItem","title":"MATLAB","sync":"matlab","children":[{"type":"embed","source":{"url":"/chapter2-1","label":"demo-pivoting-builtin-matlab","kind":"Notebook","slug":"chapter2-1","location":"/matlab/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-pivoting-builtin","label":"demo-pivoting-builtin","kind":"proof:example","position":{"start":{"line":938,"column":1},"end":{"line":938,"column":23}},"children":[{"type":"text","value":"Example ","key":"e4uCGFHqua"},{"type":"text","value":"2.6.5","key":"hlMi3p1BWb"}],"template":"Example %s","enumerator":"2.6.5","resolved":true,"html_id":"demo-pivoting-builtin","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"UJCDd7pHf4"}],"key":"pbfoA5py9L"},{"type":"paragraph","position":{"start":{"line":940,"column":1},"end":{"line":940,"column":1}},"children":[{"type":"text","value":"With the syntax ","position":{"start":{"line":940,"column":1},"end":{"line":940,"column":1}},"key":"oBjmWCFWEr"},{"type":"inlineCode","value":"A \\ b","position":{"start":{"line":940,"column":1},"end":{"line":940,"column":1}},"key":"h9kv5gshhJ"},{"type":"text","value":", the matrix ","position":{"start":{"line":940,"column":1},"end":{"line":940,"column":1}},"key":"fDVPc4TTrS"},{"type":"inlineCode","value":"A","position":{"start":{"line":940,"column":1},"end":{"line":940,"column":1}},"key":"ejpIqr9JcL"},{"type":"text","value":" is PLU-factored, followed by two triangular solves.","position":{"start":{"line":940,"column":1},"end":{"line":940,"column":1}},"key":"vQwTYFj2S9"}],"key":"CV4rMuSpao"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A = randn(500, 500);    % 500x500 with normal random entries\ntic; for k=1:50; A \\ rand(500, 1); end; toc","key":"LO7GFN6BsK"},{"type":"output","id":"_cBp0RNhA4e7g0bXQhsDt","data":[{"output_type":"stream","name":"stdout","text":"Elapsed time is 1.885598 seconds.\n"}],"key":"DZ1XmF0lrf"}],"key":"ek1beuoucb"},{"type":"paragraph","position":{"start":{"line":947,"column":1},"end":{"line":947,"column":1}},"children":[{"type":"text","value":"In ","position":{"start":{"line":947,"column":1},"end":{"line":947,"column":1}},"key":"v4oMNuGGhX"},{"type":"link","kind":"numref","identifier":"section-linsys-efficiency","label":"section-linsys-efficiency","url":"/efficiency","internal":true,"dataUrl":"/efficiency.json","children":[{"type":"text","value":"Efficiency of matrix computations","key":"FNwSO7NVNh"}],"key":"Btg2nZzzk4"},{"type":"text","value":" we showed that the factorization is by far the most costly part of the solution process. A factorization object allows us to do that costly step only once per unique matrix.","position":{"start":{"line":947,"column":1},"end":{"line":947,"column":1}},"key":"qErYvQ4d5V"}],"key":"jsUugUMeeA"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[L, U, p] = lu(A, 'vector');    % keep factorization result\ntic\nfor k=1:50\n    b = rand(500, 1);\n    U \\ (L \\ b(p));\nend\ntoc","key":"TCH8FQW2J4"},{"type":"output","id":"Ln_fOCniCOJPpifBGFRMR","data":[{"output_type":"stream","name":"stdout","text":"Elapsed time is 0.007785 seconds.\n"}],"key":"uNCTf72rSc"}],"key":"loIvDXuDxA"}],"key":"xyZ2ye8bFd"}],"key":"NT6joNNYk6"}],"key":"TWxUFem6hN"},{"type":"tabItem","title":"Python","sync":"python","children":[{"type":"embed","source":{"url":"/chapter2-2","label":"demo-pivoting-builtin-python","kind":"Notebook","slug":"chapter2-2","location":"/python/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-pivoting-builtin","label":"demo-pivoting-builtin","kind":"proof:example","position":{"start":{"line":935,"column":1},"end":{"line":935,"column":23}},"children":[{"type":"text","value":"Example ","key":"XxnogXeoRt"},{"type":"text","value":"2.6.5","key":"Q6146FUhYo"}],"template":"Example %s","enumerator":"2.6.5","resolved":true,"html_id":"demo-pivoting-builtin","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"ybUT9vGGJ4"}],"key":"RuKmKWEmlF"},{"type":"paragraph","position":{"start":{"line":937,"column":1},"end":{"line":937,"column":1}},"children":[{"type":"text","value":"In ","position":{"start":{"line":937,"column":1},"end":{"line":937,"column":1}},"key":"SK6L1TnvUl"},{"type":"inlineCode","value":"scipy.solve","position":{"start":{"line":937,"column":1},"end":{"line":937,"column":1}},"key":"SwMDiacbVx"},{"type":"text","value":", the matrix ","position":{"start":{"line":937,"column":1},"end":{"line":937,"column":1}},"key":"nw7Yeofwfn"},{"type":"inlineCode","value":"A","position":{"start":{"line":937,"column":1},"end":{"line":937,"column":1}},"key":"UDITn6fFxg"},{"type":"text","value":" is PLU-factored, followed by two triangular solves. If we want to do those steps seamlessly, we can use ","position":{"start":{"line":937,"column":1},"end":{"line":937,"column":1}},"key":"SyTwdISKOn"},{"type":"inlineCode","value":"lu_factor","position":{"start":{"line":937,"column":1},"end":{"line":937,"column":1}},"key":"FoYWQF23o1"},{"type":"text","value":" and ","position":{"start":{"line":937,"column":1},"end":{"line":937,"column":1}},"key":"Bqj2ov1KKY"},{"type":"inlineCode","value":"lu_solve","position":{"start":{"line":937,"column":1},"end":{"line":937,"column":1}},"key":"nl1hojAPH0"},{"type":"text","value":".","position":{"start":{"line":937,"column":1},"end":{"line":937,"column":1}},"key":"TAnq2OwdaM"}],"key":"ZW07aYH2TA"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from scipy.linalg import lu_factor, lu_solve\nA = random.randn(500, 500) \nb = ones(500)  \nLU, perm = lu_factor(A)\nx = lu_solve((LU, perm), b)\nprint(linalg.norm(b - A @ x))","key":"P3zv0ad2jw"},{"type":"output","id":"ci0gpEhEO5c35qkHFdQfd","data":[{"output_type":"stream","name":"stdout","text":"9.429465997300639e-12\n"}],"key":"Y3K80rJEBY"}],"key":"zyK74if5S8"},{"type":"paragraph","position":{"start":{"line":948,"column":1},"end":{"line":948,"column":1}},"children":[{"type":"text","value":"Why would we ever bother with this? In ","position":{"start":{"line":948,"column":1},"end":{"line":948,"column":1}},"key":"H9SB4uBqyd"},{"type":"link","kind":"numref","identifier":"section-linsys-efficiency","label":"section-linsys-efficiency","url":"/efficiency","internal":true,"dataUrl":"/efficiency.json","children":[{"type":"text","value":"Efficiency of matrix computations","key":"pYS00Q3R1k"}],"key":"QmDqmFBs48"},{"type":"text","value":" we showed that the factorization is by far the most costly part of the solution process. A factorization object allows us to do that costly step only once per matrix, but solve with multiple right-hand sides.","position":{"start":{"line":948,"column":1},"end":{"line":948,"column":1}},"key":"V9yME4EY1s"}],"key":"szDgDpvgSp"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"start = timer()\nfor k in range(50): linalg.solve(A, random.rand(500))\nprint(f\"elapsed time for 50 full solves: {timer() - start}\")\n\nstart = timer()\nLU, perm = lu_factor(A)\nfor k in range(50): lu_solve((LU, perm), random.rand(500))\nprint(f\"elapsed time for 50 shortcut solves: {timer() - start}\")","key":"QYerX7H9pp"},{"type":"output","id":"r7HW40iQA9bBDoxApzVaw","data":[{"output_type":"stream","name":"stdout","text":"elapsed time for 50 full solves: 0.15610912488773465\n"},{"output_type":"stream","name":"stdout","text":"elapsed time for 50 shortcut solves: 0.005021916935220361\n"}],"key":"BmkODbq5ae"}],"key":"ISgF13WJ6h"}],"key":"XZm9lNfQFZ"}],"key":"Rh7TTEWHwN"}],"key":"ArEOzKnPhN"}],"key":"mxuiX4aVFV"}],"label":"demo-pivoting-builtin","identifier":"demo-pivoting-builtin","enumerator":"2.6.5","html_id":"demo-pivoting-builtin","key":"bb0F2xFopG"},{"type":"heading","depth":2,"position":{"start":{"line":216,"column":1},"end":{"line":216,"column":1}},"children":[{"type":"text","value":"Stability","position":{"start":{"line":216,"column":1},"end":{"line":216,"column":1}},"key":"ir1NG7mYjQ"}],"identifier":"stability","label":"Stability","html_id":"stability","implicit":true,"enumerator":"2.6.4","key":"OOLvYtYLmc"},{"type":"paragraph","position":{"start":{"line":221,"column":1},"end":{"line":221,"column":1}},"children":[{"type":"text","value":"There is one detail of the row pivoting algorithm that might seem arbitrary: why choose the pivot of largest magnitude within a column, rather than, say, the uppermost nonzero in the column? The answer is numerical stability.","position":{"start":{"line":221,"column":1},"end":{"line":221,"column":1}},"key":"r05Z1feMSY"}],"indexEntries":[{"entry":"stability","emphasis":false}],"label":"index-WlDFANTPRv","identifier":"index-wldfantprv","html_id":"index-wldfantprv","key":"GSfFzFlFYi"},{"type":"proof","kind":"example","enumerated":true,"children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Stability of PLU factorization","position":{"start":{"line":223,"column":1},"end":{"line":223,"column":1}},"key":"xmQtUGdVP6"}],"key":"UmfUyAf5cP"},{"type":"paragraph","position":{"start":{"line":225,"column":1},"end":{"line":225,"column":1}},"children":[{"type":"text","value":"Let","position":{"start":{"line":225,"column":1},"end":{"line":225,"column":1}},"key":"uzAsT4Bedh"}],"key":"pfRMQNPcZE"},{"type":"math","value":"\\mathbf{A} =\n  \\begin{bmatrix}\n    -\\epsilon & 1 \\\\ 1 & -1\n  \\end{bmatrix}.","label":"plu-stab-A","identifier":"plu-stab-a","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi mathvariant=\"bold\">A</mi><mo>=</mo><mrow><mo fence=\"true\">[</mo><mtable rowspacing=\"0.16em\" columnalign=\"center center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mi>ϵ</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mn>1</mn></mrow></mstyle></mtd></mtr></mtable><mo fence=\"true\">]</mo></mrow><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A} =\n  \\begin{bmatrix}\n    -\\epsilon &amp; 1 \\\\ 1 &amp; -1\n  \\end{bmatrix}.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.4em;vertical-align:-0.95em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">[</span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord mathnormal\">ϵ</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.95em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.95em;\"><span></span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">]</span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">.</span></span></span></span></span>","enumerator":"2.6.2","html_id":"plu-stab-a","key":"w74yMZWU3c"},{"type":"paragraph","position":{"start":{"line":235,"column":1},"end":{"line":235,"column":1}},"children":[{"type":"text","value":"If ","position":{"start":{"line":235,"column":1},"end":{"line":235,"column":1}},"key":"Krgg0a76U3"},{"type":"inlineMath","value":"\\epsilon=0","position":{"start":{"line":235,"column":1},"end":{"line":235,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ϵ</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">\\epsilon=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">ϵ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"JYEcBotJcD"},{"type":"text","value":", LU factorization without pivoting fails for ","position":{"start":{"line":235,"column":1},"end":{"line":235,"column":1}},"key":"IOVpNTUOnI"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":235,"column":1},"end":{"line":235,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"BmsDRyINnY"},{"type":"text","value":". But if ","position":{"start":{"line":235,"column":1},"end":{"line":235,"column":1}},"key":"QoItOV5Ybm"},{"type":"inlineMath","value":"\\epsilon\\neq 0","position":{"start":{"line":235,"column":1},"end":{"line":235,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ϵ</mi><mo mathvariant=\"normal\">≠</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">\\epsilon\\neq 0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">ϵ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\"><span class=\"mrel\"><span class=\"mord vbox\"><span class=\"thinbox\"><span class=\"rlap\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"inner\"><span class=\"mord\"><span class=\"mrel\"></span></span></span><span class=\"fix\"></span></span></span></span></span><span class=\"mrel\">=</span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"RKFf9Qo8px"},{"type":"text","value":", we can go without pivoting, at least in principle.","position":{"start":{"line":235,"column":1},"end":{"line":235,"column":1}},"key":"OKVhiGEQJl"}],"key":"Ad37T4Prct"},{"type":"tabSet","children":[{"type":"tabItem","title":"Julia","sync":"julia","children":[{"type":"embed","source":{"url":"/chapter2","label":"demo-pivoting-stable-julia","kind":"Notebook","slug":"chapter2","location":"/julia/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-pivoting-stable","label":"demo-pivoting-stable","kind":"proof:example","position":{"start":{"line":1013,"column":1},"end":{"line":1013,"column":22}},"children":[{"type":"text","value":"Example ","key":"Hswp4j73d2"},{"type":"text","value":"2.6.6","key":"IElJj4KUtA"}],"template":"Example %s","enumerator":"2.6.6","resolved":true,"html_id":"demo-pivoting-stable","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"RyzqqXyOzt"}],"key":"Fr4QV4Qejq"},{"type":"paragraph","position":{"start":{"line":1015,"column":1},"end":{"line":1015,"column":1}},"children":[{"type":"text","value":"We construct a linear system for this matrix with ","position":{"start":{"line":1015,"column":1},"end":{"line":1015,"column":1}},"key":"XOe3SOAkqS"},{"type":"inlineMath","value":"\\epsilon=10^{-12}","position":{"start":{"line":1015,"column":1},"end":{"line":1015,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ϵ</mi><mo>=</mo><mn>1</mn><msup><mn>0</mn><mrow><mo>−</mo><mn>12</mn></mrow></msup></mrow><annotation encoding=\"application/x-tex\">\\epsilon=10^{-12}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">ϵ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">12</span></span></span></span></span></span></span></span></span></span></span></span>","key":"M3dwQYki2b"},{"type":"text","value":" and exact solution ","position":{"start":{"line":1015,"column":1},"end":{"line":1015,"column":1}},"key":"uv6BizR7eW"},{"type":"inlineMath","value":"[1,1]","position":{"start":{"line":1015,"column":1},"end":{"line":1015,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[1,1]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]</span></span></span></span>","key":"BB72fpaNFF"},{"type":"text","value":":","position":{"start":{"line":1015,"column":1},"end":{"line":1015,"column":1}},"key":"UJjbqJdo6I"}],"key":"cYlDL0GDob"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"ϵ = 1e-12\nA = [-ϵ 1; 1 -1]\nb = A * [1, 1]","key":"KY0hgfrgHL"},{"type":"output","id":"mm_NpbdWzKCdena6V93AQ","data":[{"output_type":"execute_result","execution_count":99,"metadata":{},"data":{"text/plain":{"content":"2-element Vector{Float64}:\n 0.999999999999\n 0.0","content_type":"text/plain"}}}],"key":"HRfm7DrYGc"}],"key":"zZOCKxbm1d"},{"type":"paragraph","position":{"start":{"line":1023,"column":1},"end":{"line":1023,"column":1}},"children":[{"type":"text","value":"We can factor the matrix without pivoting and solve for ","position":{"start":{"line":1023,"column":1},"end":{"line":1023,"column":1}},"key":"COSp5BmlYO"},{"type":"inlineMath","value":"\\mathbf{x}","position":{"start":{"line":1023,"column":1},"end":{"line":1023,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">x</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{x}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4444em;\"></span><span class=\"mord mathbf\">x</span></span></span></span>","key":"KlxBT4bjDJ"},{"type":"text","value":".","position":{"start":{"line":1023,"column":1},"end":{"line":1023,"column":1}},"key":"qAwBBTubQD"}],"key":"jMX9XG4fFQ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"L, U = FNC.lufact(A)\nx = FNC.backsub( U, FNC.forwardsub(L, b) )","key":"AtmxTDtY9C"},{"type":"output","id":"eTLmFqcgXHttz_aZ9lfd_","data":[{"output_type":"execute_result","execution_count":100,"metadata":{},"data":{"text/plain":{"content":"2-element Vector{Float64}:\n 0.9999778782798785\n 1.0","content_type":"text/plain"}}}],"key":"xJW6uKk6Wm"}],"key":"xSCtptj1JK"},{"type":"paragraph","position":{"start":{"line":1030,"column":1},"end":{"line":1030,"column":1}},"children":[{"type":"text","value":"Note that we have obtained only about 5 accurate digits for ","position":{"start":{"line":1030,"column":1},"end":{"line":1030,"column":1}},"key":"j4CUWOSwNm"},{"type":"inlineMath","value":"x_1","position":{"start":{"line":1030,"column":1},"end":{"line":1030,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">x_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"PcueNsWC16"},{"type":"text","value":". We could make the result even more inaccurate by making ","position":{"start":{"line":1030,"column":1},"end":{"line":1030,"column":1}},"key":"uOK7khV1tG"},{"type":"inlineMath","value":"\\epsilon","position":{"start":{"line":1030,"column":1},"end":{"line":1030,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ϵ</mi></mrow><annotation encoding=\"application/x-tex\">\\epsilon</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">ϵ</span></span></span></span>","key":"cfudiY763n"},{"type":"text","value":" even smaller:","position":{"start":{"line":1030,"column":1},"end":{"line":1030,"column":1}},"key":"Vz9vV3GNWk"}],"key":"iQZPzctBAI"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"ϵ = 1e-20; A = [-ϵ 1; 1 -1]\nb = A * [1, 1]\nL, U = FNC.lufact(A)\nx = FNC.backsub( U, FNC.forwardsub(L, b) )","key":"jAO4O7HDIY"},{"type":"output","id":"WEQij57iZAr11waMseM7X","data":[{"output_type":"execute_result","execution_count":101,"metadata":{},"data":{"text/plain":{"content":"2-element Vector{Float64}:\n -0.0\n  1.0","content_type":"text/plain"}}}],"key":"JIy7cfKpa4"}],"key":"vakwmLXWUl"},{"type":"paragraph","position":{"start":{"line":1039,"column":1},"end":{"line":1039,"column":1}},"children":[{"type":"text","value":"This effect is not due to ill conditioning of the problem—a solution with PLU factorization works perfectly:","position":{"start":{"line":1039,"column":1},"end":{"line":1039,"column":1}},"key":"nCs70iQf9D"}],"key":"NFaTxRwYQJ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"A \\ b","key":"bp63cCxFNd"},{"type":"output","id":"PvR1H36tm5QoX1C7aqIdt","data":[{"output_type":"execute_result","execution_count":102,"metadata":{},"data":{"text/plain":{"content":"2-element Vector{Float64}:\n 1.0\n 1.0","content_type":"text/plain"}}}],"key":"pcPdLloqQs"}],"key":"QGuOrAtPLh"}],"key":"PYbdaDcQM4"}],"key":"kSTf92eRrn"}],"key":"Yihx6oGi9C"},{"type":"tabItem","title":"MATLAB","sync":"matlab","children":[{"type":"embed","source":{"url":"/chapter2-1","label":"demo-pivoting-stable-matlab","kind":"Notebook","slug":"chapter2-1","location":"/matlab/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-pivoting-stable","label":"demo-pivoting-stable","kind":"proof:example","position":{"start":{"line":961,"column":1},"end":{"line":961,"column":22}},"children":[{"type":"text","value":"Example ","key":"S16QSH3DCX"},{"type":"text","value":"2.6.6","key":"I2WGs5EAVM"}],"template":"Example %s","enumerator":"2.6.6","resolved":true,"html_id":"demo-pivoting-stable","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"sSACH5XND4"}],"key":"AblaLf9dMo"},{"type":"paragraph","position":{"start":{"line":963,"column":1},"end":{"line":963,"column":1}},"children":[{"type":"text","value":"We construct a linear system for this matrix with ","position":{"start":{"line":963,"column":1},"end":{"line":963,"column":1}},"key":"QnOY30OWPT"},{"type":"inlineMath","value":"\\epsilon=10^{-12}","position":{"start":{"line":963,"column":1},"end":{"line":963,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ϵ</mi><mo>=</mo><mn>1</mn><msup><mn>0</mn><mrow><mo>−</mo><mn>12</mn></mrow></msup></mrow><annotation encoding=\"application/x-tex\">\\epsilon=10^{-12}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">ϵ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">12</span></span></span></span></span></span></span></span></span></span></span></span>","key":"unv0yWjGOe"},{"type":"text","value":" and exact solution ","position":{"start":{"line":963,"column":1},"end":{"line":963,"column":1}},"key":"SbCjT1rQaF"},{"type":"inlineMath","value":"[1, 1]","position":{"start":{"line":963,"column":1},"end":{"line":963,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[1, 1]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]</span></span></span></span>","key":"PVZDLKWRAK"},{"type":"text","value":":","position":{"start":{"line":963,"column":1},"end":{"line":963,"column":1}},"key":"jRy5ltX5tj"}],"key":"JCBB05yiug"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"ep = 1e-12\nA = [-ep 1; 1 -1];\nb = A * [1; 1];","key":"DAq50yCJ3m"},{"type":"output","id":"jTMuRyjYKTO-wD3VDF3W2","data":[{"output_type":"execute_result","execution_count":97,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ep = 1.0000e-12</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ep = 1.0000e-12","content_type":"text/plain"}}}],"key":"sfzEJEXdIB"}],"key":"BSpW1EJzTT"},{"type":"paragraph","position":{"start":{"line":971,"column":1},"end":{"line":971,"column":1}},"children":[{"type":"text","value":"We can factor the matrix without pivoting and solve for ","position":{"start":{"line":971,"column":1},"end":{"line":971,"column":1}},"key":"Dg1lCjzNVZ"},{"type":"inlineMath","value":"\\mathbf{x}","position":{"start":{"line":971,"column":1},"end":{"line":971,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">x</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{x}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4444em;\"></span><span class=\"mord mathbf\">x</span></span></span></span>","key":"ArSrCdbuL7"},{"type":"text","value":".","position":{"start":{"line":971,"column":1},"end":{"line":971,"column":1}},"key":"FO8jq4VdnB"}],"key":"Iv0TElkg1g"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[L, U] = lufact(A);\nx = backsub( U, forwardsub(L, b) )","key":"Vrmo5oOBpn"},{"type":"output","id":"NjczVD4Y2E1PNCimJPWwS","data":[{"output_type":"execute_result","execution_count":98,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>x = 2×1 double\n    1.0000\n    1.0000\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"x = 2×1 double\n    1.0000\n    1.0000\n","content_type":"text/plain"}}}],"key":"nA4Hnp3SaC"}],"key":"MbehgnDXii"},{"type":"paragraph","position":{"start":{"line":978,"column":1},"end":{"line":978,"column":1}},"children":[{"type":"text","value":"Note that we have obtained only about 5 accurate digits for ","position":{"start":{"line":978,"column":1},"end":{"line":978,"column":1}},"key":"Z7kYq9sQ3G"},{"type":"inlineMath","value":"x_1","position":{"start":{"line":978,"column":1},"end":{"line":978,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">x_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"jwttrMbcki"},{"type":"text","value":". We could make the result even more inaccurate by making ","position":{"start":{"line":978,"column":1},"end":{"line":978,"column":1}},"key":"lAbiqg81qE"},{"type":"inlineMath","value":"\\epsilon","position":{"start":{"line":978,"column":1},"end":{"line":978,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ϵ</mi></mrow><annotation encoding=\"application/x-tex\">\\epsilon</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">ϵ</span></span></span></span>","key":"Td8UOZjPdm"},{"type":"text","value":" even smaller:","position":{"start":{"line":978,"column":1},"end":{"line":978,"column":1}},"key":"U7g4mgq2BZ"}],"key":"VuDF18Y8ny"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"ep = 1e-20; A = [-ep 1; 1 -1];\nb = A * [1; 1];\n[L, U] = lufact(A);\nx = backsub( U, forwardsub(L, b) )","key":"ZgtOQaaB9f"},{"type":"output","id":"UKuq9nkQbVbdqD_AmoP4c","data":[{"output_type":"execute_result","execution_count":99,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>x = 2×1 double\n     0\n     1\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"x = 2×1 double\n     0\n     1\n","content_type":"text/plain"}}}],"key":"U4tWz9utb2"}],"key":"jKZGlM6A62"},{"type":"paragraph","position":{"start":{"line":987,"column":1},"end":{"line":987,"column":1}},"children":[{"type":"text","value":"This effect is not due to ill conditioning of the problem—a solution with PLU factorization works perfectly:","position":{"start":{"line":987,"column":1},"end":{"line":987,"column":1}},"key":"fe3CtR8kjm"}],"key":"W7JJJt7PCu"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A \\ b","key":"lNayIVMHbU"},{"type":"output","id":"bkVpDLeUvPsIY-LKKO3Xv","data":[{"output_type":"execute_result","execution_count":100,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = 2×1 double\n     1\n     1\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = 2×1 double\n     1\n     1\n","content_type":"text/plain"}}}],"key":"H0Boz2Ei7l"}],"key":"qFddqilpsV"}],"key":"VEF8pzOt3y"}],"key":"t4qLIiV63Y"}],"key":"khq3kqG2pm"},{"type":"tabItem","title":"Python","sync":"python","children":[{"type":"embed","source":{"url":"/chapter2-2","label":"demo-pivoting-stable-python","kind":"Notebook","slug":"chapter2-2","location":"/python/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-pivoting-stable","label":"demo-pivoting-stable","kind":"proof:example","position":{"start":{"line":963,"column":1},"end":{"line":963,"column":22}},"children":[{"type":"text","value":"Example ","key":"ZfFO7LJVik"},{"type":"text","value":"2.6.6","key":"MOXRWndtnt"}],"template":"Example %s","enumerator":"2.6.6","resolved":true,"html_id":"demo-pivoting-stable","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"vZb6yuFBml"}],"key":"v5TRngHAwu"},{"type":"paragraph","position":{"start":{"line":965,"column":1},"end":{"line":965,"column":1}},"children":[{"type":"text","value":"We construct a linear system for this matrix with ","position":{"start":{"line":965,"column":1},"end":{"line":965,"column":1}},"key":"hsrHqE9sA8"},{"type":"inlineMath","value":"\\epsilon=10^{-12}","position":{"start":{"line":965,"column":1},"end":{"line":965,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ϵ</mi><mo>=</mo><mn>1</mn><msup><mn>0</mn><mrow><mo>−</mo><mn>12</mn></mrow></msup></mrow><annotation encoding=\"application/x-tex\">\\epsilon=10^{-12}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">ϵ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">12</span></span></span></span></span></span></span></span></span></span></span></span>","key":"R2Eitdn03j"},{"type":"text","value":" and exact solution ","position":{"start":{"line":965,"column":1},"end":{"line":965,"column":1}},"key":"a4mIdz8wsD"},{"type":"inlineMath","value":"[1,1]","position":{"start":{"line":965,"column":1},"end":{"line":965,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[1,1]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]</span></span></span></span>","key":"YxujGgUeSP"},{"type":"text","value":":","position":{"start":{"line":965,"column":1},"end":{"line":965,"column":1}},"key":"kLCfX7KUtR"}],"key":"seygkFuREr"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ep = 1e-12\nA = array([[-ep, 1], [1, -1]])\nb = A @ array([1, 1])","key":"xGt1kgDJzU"},{"type":"output","id":"VfkUd02YwT_-nVwQ2hGa5","data":[],"key":"skYfGjXhJJ"}],"key":"fz145pE77L"},{"type":"paragraph","position":{"start":{"line":973,"column":1},"end":{"line":973,"column":1}},"children":[{"type":"text","value":"We can factor the matrix without pivoting and solve for ","position":{"start":{"line":973,"column":1},"end":{"line":973,"column":1}},"key":"DjWiosl2U9"},{"type":"inlineMath","value":"\\mathbf{x}","position":{"start":{"line":973,"column":1},"end":{"line":973,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">x</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{x}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4444em;\"></span><span class=\"mord mathbf\">x</span></span></span></span>","key":"nclLZMq2bD"},{"type":"text","value":".","position":{"start":{"line":973,"column":1},"end":{"line":973,"column":1}},"key":"Im99FeOklD"}],"key":"EvfwjYBsWi"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"L, U = FNC.lufact(A)\nprint(FNC.backsub( U, FNC.forwardsub(L, b) ))","key":"Wqhwxm7tOV"},{"type":"output","id":"i2OMo67ocgETTj5JJJaTL","data":[{"output_type":"stream","name":"stdout","text":"[0.99997788 1.        ]\n"}],"key":"Htd1H4BBzl"}],"key":"lFYkwKD9TX"},{"type":"paragraph","position":{"start":{"line":980,"column":1},"end":{"line":980,"column":1}},"children":[{"type":"text","value":"Note that we have obtained only about 5 accurate digits for ","position":{"start":{"line":980,"column":1},"end":{"line":980,"column":1}},"key":"jSg6bV1Tv5"},{"type":"inlineMath","value":"x_1","position":{"start":{"line":980,"column":1},"end":{"line":980,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">x_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"Gl57furAaD"},{"type":"text","value":". We could make the result even more inaccurate by making ","position":{"start":{"line":980,"column":1},"end":{"line":980,"column":1}},"key":"cDY7d1K6tz"},{"type":"inlineMath","value":"\\epsilon","position":{"start":{"line":980,"column":1},"end":{"line":980,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ϵ</mi></mrow><annotation encoding=\"application/x-tex\">\\epsilon</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">ϵ</span></span></span></span>","key":"RVFX2Aiha9"},{"type":"text","value":" even smaller:","position":{"start":{"line":980,"column":1},"end":{"line":980,"column":1}},"key":"VAUarZh2lJ"}],"key":"DacE2fRoFD"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ep = 1e-20;\nA = array([[-ep, 1], [1, -1]])\nb = A @ array([1, 1])\nL, U = FNC.lufact(A)\nprint(FNC.backsub( U, FNC.forwardsub(L, b) ))","key":"mcTa80ekEi"},{"type":"output","id":"m1N9tIXhy8gYp6FqvG5kH","data":[{"output_type":"stream","name":"stdout","text":"[-0.  1.]\n"}],"key":"AZUxe1PF3l"}],"key":"LnVGUV1LbX"},{"type":"paragraph","position":{"start":{"line":990,"column":1},"end":{"line":990,"column":1}},"children":[{"type":"text","value":"This effect is not due to ill conditioning of the problem—a solution with PLU factorization works perfectly:","position":{"start":{"line":990,"column":1},"end":{"line":990,"column":1}},"key":"ouOzmUvpX9"}],"key":"q0sJZaCA5o"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from scipy import linalg\nprint(linalg.solve(A, b))","key":"T5zKvec9UP"},{"type":"output","id":"At8J_uhGAcucPBaKzj0xB","data":[{"output_type":"stream","name":"stdout","text":"[1. 1.]\n"}],"key":"Ua6D2hyKXG"}],"key":"DgSfflAABt"}],"key":"cOFn6IjuTZ"}],"key":"saYKp4r7wa"}],"key":"y5KawrxFbA"}],"key":"vFvsKMS5s6"}],"label":"demo-pivoting-stable","identifier":"demo-pivoting-stable","enumerator":"2.6.6","html_id":"demo-pivoting-stable","key":"xOTKG2R0n0"},{"type":"paragraph","position":{"start":{"line":259,"column":1},"end":{"line":259,"column":1}},"children":[{"type":"text","value":"The factors of this ","position":{"start":{"line":259,"column":1},"end":{"line":259,"column":1}},"key":"UyBNL9tFgB"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":259,"column":1},"end":{"line":259,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"R3Blz8aIhE"},{"type":"text","value":" without pivoting are found to be","position":{"start":{"line":259,"column":1},"end":{"line":259,"column":1}},"key":"tROflyuMJQ"}],"key":"FpW9j1hBYI"},{"type":"math","value":"  \\mathbf{L} = \n  \\begin{bmatrix}\n    1 & 0 \\\\ -\\epsilon^{-1} & 1 \n  \\end{bmatrix}, \\qquad \n  \\mathbf{U} = \n  \\begin{bmatrix}\n    -\\epsilon & 1 \\\\ 0 & \\epsilon^{-1}-1 \n  \\end{bmatrix}.","label":"plu-stab-LU","identifier":"plu-stab-lu","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi mathvariant=\"bold\">L</mi><mo>=</mo><mrow><mo fence=\"true\">[</mo><mtable rowspacing=\"0.16em\" columnalign=\"center center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>0</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><msup><mi>ϵ</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd></mtr></mtable><mo fence=\"true\">]</mo></mrow><mo separator=\"true\">,</mo><mspace width=\"2em\"/><mi mathvariant=\"bold\">U</mi><mo>=</mo><mrow><mo fence=\"true\">[</mo><mtable rowspacing=\"0.16em\" columnalign=\"center center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mi>ϵ</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><msup><mi>ϵ</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo>−</mo><mn>1</mn></mrow></mstyle></mtd></mtr></mtable><mo fence=\"true\">]</mo></mrow><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">  \\mathbf{L} = \n  \\begin{bmatrix}\n    1 &amp; 0 \\\\ -\\epsilon^{-1} &amp; 1 \n  \\end{bmatrix}, \\qquad \n  \\mathbf{U} = \n  \\begin{bmatrix}\n    -\\epsilon &amp; 1 \\\\ 0 &amp; \\epsilon^{-1}-1 \n  \\end{bmatrix}.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">L</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.4em;vertical-align:-0.95em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">[</span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord\"><span class=\"mord mathnormal\">ϵ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.95em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">0</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.95em;\"><span></span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">]</span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:2em;\"></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathbf\">U</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.4em;vertical-align:-0.95em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">[</span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord mathnormal\">ϵ</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.95em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">ϵ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.95em;\"><span></span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">]</span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">.</span></span></span></span></span>","enumerator":"2.6.3","html_id":"plu-stab-lu","key":"WGw54i3aro"},{"type":"paragraph","position":{"start":{"line":273,"column":1},"end":{"line":273,"column":1}},"children":[{"type":"text","value":"For reasons we will quantify in ","position":{"start":{"line":273,"column":1},"end":{"line":273,"column":1}},"key":"tDXInjDJcX"},{"type":"link","kind":"numref","identifier":"section-linsys-condition-number","label":"section-linsys-condition-number","url":"/condition-number","internal":true,"dataUrl":"/condition-number.json","children":[{"type":"text","value":"Conditioning of linear systems","key":"UQQvjCbcFx"}],"key":"C97GPqXxfQ"},{"type":"text","value":", the solution of ","position":{"start":{"line":273,"column":1},"end":{"line":273,"column":1}},"key":"WBpoheOxXa"},{"type":"inlineMath","value":"\\mathbf{A}\\mathbf{x}=\\mathbf{b}","position":{"start":{"line":273,"column":1},"end":{"line":273,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi><mi mathvariant=\"bold\">x</mi><mo>=</mo><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}\\mathbf{x}=\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">Ax</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"S0ufmYYYfG"},{"type":"text","value":" is well-conditioned, but the problems of solving ","position":{"start":{"line":273,"column":1},"end":{"line":273,"column":1}},"key":"RKwpulUzrO"},{"type":"inlineMath","value":"\\mathbf{L}\\mathbf{z}=\\mathbf{b}","position":{"start":{"line":273,"column":1},"end":{"line":273,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi><mi mathvariant=\"bold\">z</mi><mo>=</mo><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}\\mathbf{z}=\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">Lz</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"sm36ueEvpb"},{"type":"text","value":" and ","position":{"start":{"line":273,"column":1},"end":{"line":273,"column":1}},"key":"SbM382kkz4"},{"type":"inlineMath","value":"\\mathbf{U}\\mathbf{x}=\\mathbf{z}","position":{"start":{"line":273,"column":1},"end":{"line":273,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi><mi mathvariant=\"bold\">x</mi><mo>=</mo><mi mathvariant=\"bold\">z</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}\\mathbf{x}=\\mathbf{z}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">Ux</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4444em;\"></span><span class=\"mord mathbf\">z</span></span></span></span>","key":"dv8xi0cg9L"},{"type":"text","value":" have condition numbers essentially ","position":{"start":{"line":273,"column":1},"end":{"line":273,"column":1}},"key":"PW0BsD5TvH"},{"type":"inlineMath","value":"1/\\epsilon^2","position":{"start":{"line":273,"column":1},"end":{"line":273,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mi mathvariant=\"normal\">/</mi><msup><mi>ϵ</mi><mn>2</mn></msup></mrow><annotation encoding=\"application/x-tex\">1/\\epsilon^2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord\">1/</span><span class=\"mord\"><span class=\"mord mathnormal\">ϵ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span>","key":"l2ZziRi1RP"},{"type":"text","value":" each. Thus, for small ","position":{"start":{"line":273,"column":1},"end":{"line":273,"column":1}},"key":"QaXtbwAioY"},{"type":"inlineMath","value":"\\epsilon","position":{"start":{"line":273,"column":1},"end":{"line":273,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ϵ</mi></mrow><annotation encoding=\"application/x-tex\">\\epsilon</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">ϵ</span></span></span></span>","key":"oykPu42Zhw"},{"type":"text","value":", solution of the original linear system by unpivoted LU factorization is highly unstable.","position":{"start":{"line":273,"column":1},"end":{"line":273,"column":1}},"key":"q9sMBPk6e2"}],"key":"NiLo3CuZra"},{"type":"paragraph","position":{"start":{"line":275,"column":1},"end":{"line":275,"column":1}},"children":[{"type":"text","value":"Somewhat surprisingly, solving ","position":{"start":{"line":275,"column":1},"end":{"line":275,"column":1}},"key":"eqordC3UZe"},{"type":"inlineMath","value":"\\mathbf{A}\\mathbf{x}=\\mathbf{b}","position":{"start":{"line":275,"column":1},"end":{"line":275,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi><mi mathvariant=\"bold\">x</mi><mo>=</mo><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}\\mathbf{x}=\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">Ax</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"zo0py8KZvp"},{"type":"text","value":" via PLU factorization is technically also unstable. In fact, examples of unstable solutions are well-known, but they have been nonexistent in practice. While there is a lot of evidence and some reasoning about why this is the case, the situation is not completely understood. Yet PLU factorization remains the algorithm of choice for general linear systems.","position":{"start":{"line":275,"column":1},"end":{"line":275,"column":1}},"key":"KcBrXkzx50"}],"key":"nOEI78By5a"},{"type":"heading","depth":2,"position":{"start":{"line":277,"column":1},"end":{"line":277,"column":1}},"children":[{"type":"text","value":"Exercises","position":{"start":{"line":277,"column":1},"end":{"line":277,"column":1}},"key":"S3N56P3AZK"}],"identifier":"exercises","label":"Exercises","html_id":"exercises","implicit":true,"enumerator":"2.6.5","key":"QgU5H5DMEi"},{"type":"exercise","children":[{"type":"paragraph","position":{"start":{"line":282,"column":1},"end":{"line":282,"column":1}},"children":[{"type":"text","value":"✍ Perform by hand the pivoted LU factorization of each matrix.","position":{"start":{"line":282,"column":1},"end":{"line":282,"column":1}},"key":"SOLE3gDB1v"}],"key":"taHctWlZnp"},{"type":"paragraph","position":{"start":{"line":284,"column":1},"end":{"line":294,"column":1}},"children":[{"type":"strong","position":{"start":{"line":284,"column":1},"end":{"line":284,"column":1}},"children":[{"type":"text","value":"(a)","position":{"start":{"line":284,"column":1},"end":{"line":284,"column":1}},"key":"yK8D6T7uor"}],"key":"JlqAkexQI6"},{"type":"text","value":" ","position":{"start":{"line":284,"column":1},"end":{"line":284,"column":1}},"key":"ri661sSL1J"},{"type":"inlineMath","value":"\\quad \\displaystyle \\begin{bmatrix}\n2 & 3 & 4 \\\\\n4 & 5 & 10 \\\\\n4 & 8 & 2\n\\end{bmatrix},\\qquad","position":{"start":{"line":284,"column":1},"end":{"line":284,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mspace width=\"1em\"/><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mo fence=\"true\">[</mo><mtable rowspacing=\"0.16em\" columnalign=\"center center center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>2</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>3</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>4</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>4</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>5</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>10</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>4</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>8</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>2</mn></mstyle></mtd></mtr></mtable><mo fence=\"true\">]</mo></mrow><mo separator=\"true\">,</mo><mspace width=\"2em\"/></mstyle></mrow><annotation encoding=\"application/x-tex\">\\quad \\displaystyle \\begin{bmatrix}\n2 &amp; 3 &amp; 4 \\\\\n4 &amp; 5 &amp; 10 \\\\\n4 &amp; 8 &amp; 2\n\\end{bmatrix},\\qquad</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:3.6em;vertical-align:-1.55em;\"></span><span class=\"mspace\" style=\"margin-right:1em;\"></span><span class=\"minner\"><span class=\"mopen\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.05em;\"><span style=\"top:-2.25em;\"><span class=\"pstrut\" style=\"height:3.155em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎣</span></span></span><span style=\"top:-3.397em;\"><span class=\"pstrut\" style=\"height:3.155em;\"></span><span style=\"height:0.016em;width:0.6667em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.6667em' height='0.016em' style='width:0.6667em' viewBox='0 0 666.67 16' preserveAspectRatio='xMinYMin'><path d='M319 0 H403 V16 H319z M319 0 H403 V16 H319z'/></svg></span></span><span style=\"top:-4.05em;\"><span class=\"pstrut\" style=\"height:3.155em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎡</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.55em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.05em;\"><span style=\"top:-4.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">2</span></span></span><span style=\"top:-3.01em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">4</span></span></span><span style=\"top:-1.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">4</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.55em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.05em;\"><span style=\"top:-4.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">3</span></span></span><span style=\"top:-3.01em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">5</span></span></span><span style=\"top:-1.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">8</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.55em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.05em;\"><span style=\"top:-4.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">4</span></span></span><span style=\"top:-3.01em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">10</span></span></span><span style=\"top:-1.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.55em;\"><span></span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.05em;\"><span style=\"top:-2.25em;\"><span class=\"pstrut\" style=\"height:3.155em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎦</span></span></span><span style=\"top:-3.397em;\"><span class=\"pstrut\" style=\"height:3.155em;\"></span><span style=\"height:0.016em;width:0.6667em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.6667em' height='0.016em' style='width:0.6667em' viewBox='0 0 666.67 16' preserveAspectRatio='xMinYMin'><path d='M263 0 H347 V16 H263z M263 0 H347 V16 H263z'/></svg></span></span><span style=\"top:-4.05em;\"><span class=\"pstrut\" style=\"height:3.155em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎤</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.55em;\"><span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:2em;\"></span></span></span></span>","key":"oAmiNWTx0r"},{"type":"text","value":"\n","position":{"start":{"line":284,"column":1},"end":{"line":284,"column":1}},"key":"V3rkhezR8c"},{"type":"strong","position":{"start":{"line":284,"column":1},"end":{"line":284,"column":1}},"children":[{"type":"text","value":"(b)","position":{"start":{"line":284,"column":1},"end":{"line":284,"column":1}},"key":"GxDILp6CQ8"}],"key":"ytFTioaaO4"},{"type":"text","value":" ","position":{"start":{"line":284,"column":1},"end":{"line":284,"column":1}},"key":"hZyVfTaYMN"},{"type":"inlineMath","value":"\\quad \\displaystyle \\begin{bmatrix}\n1 & 4 & 5 & -5 \\\\\n-1 & 0 & -1 & -5 \\\\\n1 & 3 & -1 & 2 \\\\\n1 & -1 & 5 & -1 \n\\end{bmatrix}","position":{"start":{"line":284,"column":1},"end":{"line":284,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mspace width=\"1em\"/><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mo fence=\"true\">[</mo><mtable rowspacing=\"0.16em\" columnalign=\"center center center center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>4</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>5</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mn>5</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mn>1</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mn>1</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mn>5</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>3</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mn>1</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>2</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mn>1</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>5</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mn>1</mn></mrow></mstyle></mtd></mtr></mtable><mo fence=\"true\">]</mo></mrow></mstyle></mrow><annotation encoding=\"application/x-tex\">\\quad \\displaystyle \\begin{bmatrix}\n1 &amp; 4 &amp; 5 &amp; -5 \\\\\n-1 &amp; 0 &amp; -1 &amp; -5 \\\\\n1 &amp; 3 &amp; -1 &amp; 2 \\\\\n1 &amp; -1 &amp; 5 &amp; -1 \n\\end{bmatrix}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:4.8001em;vertical-align:-2.15em;\"></span><span class=\"mspace\" style=\"margin-right:1em;\"></span><span class=\"minner\"><span class=\"mopen\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.65em;\"><span style=\"top:-1.711em;\"><span class=\"pstrut\" style=\"height:3.216em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎣</span></span></span><span style=\"top:-2.858em;\"><span class=\"pstrut\" style=\"height:3.216em;\"></span><span style=\"height:1.216em;width:0.6667em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.6667em' height='1.216em' style='width:0.6667em' viewBox='0 0 666.67 1216' preserveAspectRatio='xMinYMin'><path d='M319 0 H403 V1216 H319z M319 0 H403 V1216 H319z'/></svg></span></span><span style=\"top:-4.7111em;\"><span class=\"pstrut\" style=\"height:3.216em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎡</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.65em;\"><span style=\"top:-4.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord\">1</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span><span style=\"top:-1.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.15em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.65em;\"><span style=\"top:-4.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">4</span></span></span><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">0</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">3</span></span></span><span style=\"top:-1.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.15em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.65em;\"><span style=\"top:-4.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">5</span></span></span><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord\">1</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord\">1</span></span></span><span style=\"top:-1.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">5</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.15em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.65em;\"><span style=\"top:-4.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord\">5</span></span></span><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord\">5</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">2</span></span></span><span style=\"top:-1.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.15em;\"><span></span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.65em;\"><span style=\"top:-1.711em;\"><span class=\"pstrut\" style=\"height:3.216em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎦</span></span></span><span style=\"top:-2.858em;\"><span class=\"pstrut\" style=\"height:3.216em;\"></span><span style=\"height:1.216em;width:0.6667em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.6667em' height='1.216em' style='width:0.6667em' viewBox='0 0 666.67 1216' preserveAspectRatio='xMinYMin'><path d='M263 0 H347 V1216 H263z M263 0 H347 V1216 H263z'/></svg></span></span><span style=\"top:-4.7111em;\"><span class=\"pstrut\" style=\"height:3.216em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎤</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.15em;\"><span></span></span></span></span></span></span></span></span></span></span>","key":"vPyZyvd6Mg"},{"type":"text","value":".","position":{"start":{"line":284,"column":1},"end":{"line":284,"column":1}},"key":"XZBiH5WHtt"}],"key":"P93kpmguQ5"}],"label":"problem-pivoting-byhand","identifier":"problem-pivoting-byhand","enumerated":true,"enumerator":"2.6.1","html_id":"problem-pivoting-byhand","key":"w7SS01wTJD"},{"type":"exercise","children":[{"type":"paragraph","position":{"start":{"line":300,"column":1},"end":{"line":300,"column":1}},"children":[{"type":"text","value":"✍ Let ","position":{"start":{"line":300,"column":1},"end":{"line":300,"column":1}},"key":"piei1n8D5h"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":300,"column":1},"end":{"line":300,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"EKsR1U8xvB"},{"type":"text","value":" be a square matrix and ","position":{"start":{"line":300,"column":1},"end":{"line":300,"column":1}},"key":"BSMU6fjZYH"},{"type":"inlineMath","value":"\\mathbf{b}","position":{"start":{"line":300,"column":1},"end":{"line":300,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"M5dHPZ0H4W"},{"type":"text","value":" be a column vector of compatible length.","position":{"start":{"line":300,"column":1},"end":{"line":300,"column":1}},"key":"cmZfhKFrN8"}],"key":"k09sNC0dGV"},{"type":"tabSet","children":[{"type":"tabItem","title":"Julia","sync":"julia","children":[{"type":"paragraph","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":1}},"children":[{"type":"text","value":"Here is correct code to solve ","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":1}},"key":"M8SNELtL1h"},{"type":"inlineMath","value":"\\mathbf{A}\\mathbf{x}=\\mathbf{b}","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi><mi mathvariant=\"bold\">x</mi><mo>=</mo><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}\\mathbf{x}=\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">Ax</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"mZQKFFkWfC"},{"type":"text","value":":","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":1}},"key":"ZneVy5i5Id"}],"key":"q0Lt91qfZ2"},{"type":"code","lang":"julia","value":"L, U, p = lu(A)\nx = U \\ (L \\ b[p])","position":{"start":{"line":307,"column":1},"end":{"line":310,"column":1}},"key":"Zk22halqAw"},{"type":"paragraph","position":{"start":{"line":312,"column":1},"end":{"line":312,"column":1}},"children":[{"type":"text","value":"Suppose instead you replace the last line above with","position":{"start":{"line":312,"column":1},"end":{"line":312,"column":1}},"key":"z2fwyNo7k6"}],"key":"f7K8LrvW9v"},{"type":"code","lang":"julia","value":"x = U \\ L \\ b[p]","position":{"start":{"line":314,"column":1},"end":{"line":316,"column":1}},"key":"zBIM2r4yt7"}],"key":"VwKw3Paurp"},{"type":"tabItem","title":"MATLAB","sync":"matlab","children":[{"type":"paragraph","position":{"start":{"line":321,"column":1},"end":{"line":321,"column":1}},"children":[{"type":"text","value":"Here is correct code to solve ","position":{"start":{"line":321,"column":1},"end":{"line":321,"column":1}},"key":"KcHVbHbSH5"},{"type":"inlineMath","value":"\\mathbf{A}\\mathbf{x}=\\mathbf{b}","position":{"start":{"line":321,"column":1},"end":{"line":321,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi><mi mathvariant=\"bold\">x</mi><mo>=</mo><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}\\mathbf{x}=\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">Ax</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"LDTCT6kDoL"},{"type":"text","value":":","position":{"start":{"line":321,"column":1},"end":{"line":321,"column":1}},"key":"PM8PetdwxI"}],"key":"Xwk0lZmKE9"},{"type":"code","lang":"matlab","value":"[L, U, p] = lu(A, 'vector');\nx = U \\ (L \\ b(p));","position":{"start":{"line":323,"column":1},"end":{"line":326,"column":1}},"key":"g4Tx4PB0TT"},{"type":"paragraph","position":{"start":{"line":328,"column":1},"end":{"line":328,"column":1}},"children":[{"type":"text","value":"Suppose instead you replace the last line above with","position":{"start":{"line":328,"column":1},"end":{"line":328,"column":1}},"key":"P6dTMW9AZ0"}],"key":"U4UdbQDN3y"},{"type":"code","lang":"matlab","value":"x = U \\ L \\ b(p);","position":{"start":{"line":330,"column":1},"end":{"line":332,"column":1}},"key":"hdezFZ6Gye"}],"key":"T2laM180Pa"},{"type":"tabItem","title":"Python","sync":"python","children":[{"type":"paragraph","position":{"start":{"line":337,"column":1},"end":{"line":337,"column":1}},"children":[{"type":"text","value":"Here is correct code to solve ","position":{"start":{"line":337,"column":1},"end":{"line":337,"column":1}},"key":"JKkOt3juwC"},{"type":"inlineMath","value":"\\mathbf{A}\\mathbf{x}=\\mathbf{b}","position":{"start":{"line":337,"column":1},"end":{"line":337,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi><mi mathvariant=\"bold\">x</mi><mo>=</mo><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}\\mathbf{x}=\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">Ax</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"uarTOrcpYw"},{"type":"text","value":":","position":{"start":{"line":337,"column":1},"end":{"line":337,"column":1}},"key":"TIi7OZUxMr"}],"key":"RryDe6uMUn"},{"type":"code","lang":"python","value":"from scipy.linalg import lu, solve\np, L, U = lu(A, p_indices=True)\nx = solve(U, solve(L, b[p]))","position":{"start":{"line":339,"column":1},"end":{"line":343,"column":1}},"key":"qyiJUdVtSd"},{"type":"paragraph","position":{"start":{"line":345,"column":1},"end":{"line":345,"column":1}},"children":[{"type":"text","value":"Suppose instead you replace the last line above with","position":{"start":{"line":345,"column":1},"end":{"line":345,"column":1}},"key":"Y8Thrr4O5u"}],"key":"PM2pQ1ChL9"},{"type":"code","lang":"python","value":"x = solve(solve(U, L), b[p])","position":{"start":{"line":347,"column":1},"end":{"line":349,"column":1}},"key":"FQ61FjSnJd"}],"key":"wtXDLzi6EW"}],"key":"xFTETWzDnS"},{"type":"paragraph","position":{"start":{"line":353,"column":1},"end":{"line":353,"column":1}},"children":[{"type":"text","value":"Mathematically in terms of ","position":{"start":{"line":353,"column":1},"end":{"line":353,"column":1}},"key":"oPrRuGPXQG"},{"type":"inlineMath","value":"\\mathbf{L}","position":{"start":{"line":353,"column":1},"end":{"line":353,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">L</span></span></span></span>","key":"DyazGclzjj"},{"type":"text","value":", ","position":{"start":{"line":353,"column":1},"end":{"line":353,"column":1}},"key":"HmvFJgKA3O"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":353,"column":1},"end":{"line":353,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"YPSdxDkyWS"},{"type":"text","value":", ","position":{"start":{"line":353,"column":1},"end":{"line":353,"column":1}},"key":"QnQ1NtusuB"},{"type":"inlineMath","value":"\\mathbf{p}","position":{"start":{"line":353,"column":1},"end":{"line":353,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">p</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{p}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6389em;vertical-align:-0.1944em;\"></span><span class=\"mord mathbf\">p</span></span></span></span>","key":"mZH6vsoTlq"},{"type":"text","value":", and ","position":{"start":{"line":353,"column":1},"end":{"line":353,"column":1}},"key":"pYIFF0PAPY"},{"type":"inlineMath","value":"\\mathbf{b}","position":{"start":{"line":353,"column":1},"end":{"line":353,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"PHHEJQiujA"},{"type":"text","value":", what vector is found?","position":{"start":{"line":353,"column":1},"end":{"line":353,"column":1}},"key":"mqhWLxss9G"}],"key":"dA7JAsHd6K"}],"label":"problem-pivoting-grouping","identifier":"problem-pivoting-grouping","enumerated":true,"enumerator":"2.6.2","html_id":"problem-pivoting-grouping","key":"PXJYZfXRAF"},{"type":"exercise","children":[{"type":"paragraph","position":{"start":{"line":359,"column":1},"end":{"line":359,"column":1}},"children":[{"type":"text","value":"✍ Suppose that ","position":{"start":{"line":359,"column":1},"end":{"line":359,"column":1}},"key":"MIxKIe3nNq"},{"type":"inlineCode","value":"A","position":{"start":{"line":359,"column":1},"end":{"line":359,"column":1}},"key":"WTR7MR6WpX"},{"type":"text","value":" is a ","position":{"start":{"line":359,"column":1},"end":{"line":359,"column":1}},"key":"JKu7VsBTKS"},{"type":"inlineMath","value":"4\\times 6","position":{"start":{"line":359,"column":1},"end":{"line":359,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>4</mn><mo>×</mo><mn>6</mn></mrow><annotation encoding=\"application/x-tex\">4\\times 6</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">4</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">6</span></span></span></span>","key":"PxJjXFluQ8"},{"type":"text","value":" matrix and you define","position":{"start":{"line":359,"column":1},"end":{"line":359,"column":1}},"key":"Yy6pDYsTzA"}],"key":"U8Yteu8Epo"},{"type":"tabSet","children":[{"type":"tabItem","title":"Julia","sync":"julia","children":[{"type":"code","lang":"julia","value":"B = A[end:-1:1, end:-1:1]","position":{"start":{"line":364,"column":1},"end":{"line":366,"column":1}},"key":"Bq728o7mZg"}],"key":"CkXNQoculk"},{"type":"tabItem","title":"MATLAB","sync":"matlab","children":[{"type":"code","lang":"matlab","value":"B = A(end:-1:1, end:-1:1)","position":{"start":{"line":371,"column":1},"end":{"line":373,"column":1}},"key":"ja68S1SlGc"}],"key":"Nec8IbOGty"},{"type":"tabItem","title":"Python","sync":"python","children":[{"type":"code","lang":"python","value":"B = A[::-1, ::-1]","position":{"start":{"line":378,"column":1},"end":{"line":379,"column":1}},"key":"P7aW4OyzB0"}],"key":"aJ6pTZnZ9W"}],"key":"x1RBRGbPj5"},{"type":"paragraph","position":{"start":{"line":383,"column":1},"end":{"line":383,"column":1}},"children":[{"type":"text","value":"Show that ","position":{"start":{"line":383,"column":1},"end":{"line":383,"column":1}},"key":"ruFkBQJMGb"},{"type":"inlineMath","value":"\\mathbf{B} = \\mathbf{P} \\mathbf{A} \\mathbf{Q}","position":{"start":{"line":383,"column":1},"end":{"line":383,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">B</mi><mo>=</mo><mi mathvariant=\"bold\">P</mi><mi mathvariant=\"bold\">A</mi><mi mathvariant=\"bold\">Q</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{B} = \\mathbf{P} \\mathbf{A} \\mathbf{Q}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">B</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8805em;vertical-align:-0.1944em;\"></span><span class=\"mord mathbf\">PAQ</span></span></span></span>","key":"VkuigKfJEs"},{"type":"text","value":" for certain matrices ","position":{"start":{"line":383,"column":1},"end":{"line":383,"column":1}},"key":"EIJomyHZv9"},{"type":"inlineMath","value":"\\mathbf{P}","position":{"start":{"line":383,"column":1},"end":{"line":383,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">P</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{P}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">P</span></span></span></span>","key":"VqCie8715V"},{"type":"text","value":" and ","position":{"start":{"line":383,"column":1},"end":{"line":383,"column":1}},"key":"A5rmVTdlhg"},{"type":"inlineMath","value":"\\mathbf{Q}","position":{"start":{"line":383,"column":1},"end":{"line":383,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">Q</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{Q}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8805em;vertical-align:-0.1944em;\"></span><span class=\"mord mathbf\">Q</span></span></span></span>","key":"aW2JengRNp"},{"type":"text","value":".","position":{"start":{"line":383,"column":1},"end":{"line":383,"column":1}},"key":"QioozPniVD"}],"key":"n8k39thk8g"}],"label":"problem-pivoting-flip","identifier":"problem-pivoting-flip","enumerated":true,"enumerator":"2.6.3","html_id":"problem-pivoting-flip","key":"dcKTdZZbJj"},{"type":"exercise","children":[{"type":"paragraph","position":{"start":{"line":388,"column":1},"end":{"line":388,"column":1}},"children":[{"type":"text","value":"✍ An ","position":{"start":{"line":388,"column":1},"end":{"line":388,"column":1}},"key":"NwuDNB6zGf"},{"type":"inlineMath","value":"n\\times n","position":{"start":{"line":388,"column":1},"end":{"line":388,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>×</mo><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n\\times n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"dqOvYrn0Qd"},{"type":"text","value":" ","position":{"start":{"line":388,"column":1},"end":{"line":388,"column":1}},"key":"LzywVkRYld"},{"type":"emphasis","position":{"start":{"line":388,"column":1},"end":{"line":388,"column":1}},"children":[{"type":"text","value":"permutation matrix","position":{"start":{"line":388,"column":1},"end":{"line":388,"column":1}},"key":"tBb5vReSUU"}],"key":"XBV6vffdGq"},{"type":"text","value":" ","position":{"start":{"line":388,"column":1},"end":{"line":388,"column":1}},"key":"MfLeeUr7Bb"},{"type":"inlineMath","value":"\\mathbf{P}","position":{"start":{"line":388,"column":1},"end":{"line":388,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">P</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{P}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">P</span></span></span></span>","key":"aVBfqEMoOR"},{"type":"text","value":" is a reordering of the rows of an identity matrix such that ","position":{"start":{"line":388,"column":1},"end":{"line":388,"column":1}},"key":"GlY9tDNa02"},{"type":"inlineMath","value":"\\mathbf{P} \\mathbf{A}","position":{"start":{"line":388,"column":1},"end":{"line":388,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">P</mi><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{P} \\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">PA</span></span></span></span>","key":"ru4cDseOqk"},{"type":"text","value":"  has the effect of moving rows ","position":{"start":{"line":388,"column":1},"end":{"line":388,"column":1}},"key":"uNg73p1oUv"},{"type":"inlineMath","value":"1,2,\\ldots,n","position":{"start":{"line":388,"column":1},"end":{"line":388,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mo separator=\"true\">,</mo><mn>2</mn><mo separator=\"true\">,</mo><mo>…</mo><mo separator=\"true\">,</mo><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">1,2,\\ldots,n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8389em;vertical-align:-0.1944em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">2</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"pJ4wFxciC4"},{"type":"text","value":" of ","position":{"start":{"line":388,"column":1},"end":{"line":388,"column":1}},"key":"exQLWQdWIp"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":388,"column":1},"end":{"line":388,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"AIRUhQCC32"},{"type":"text","value":" to new positions ","position":{"start":{"line":388,"column":1},"end":{"line":388,"column":1}},"key":"Xj04VmBngr"},{"type":"inlineMath","value":"i_1,i_2,\\ldots,i_n","position":{"start":{"line":388,"column":1},"end":{"line":388,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>i</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><msub><mi>i</mi><mn>2</mn></msub><mo separator=\"true\">,</mo><mo>…</mo><mo separator=\"true\">,</mo><msub><mi>i</mi><mi>n</mi></msub></mrow><annotation encoding=\"application/x-tex\">i_1,i_2,\\ldots,i_n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"ndp2FeG8Vl"},{"type":"text","value":". Then ","position":{"start":{"line":388,"column":1},"end":{"line":388,"column":1}},"key":"KO9ofGTBxr"},{"type":"inlineMath","value":"\\mathbf{P}","position":{"start":{"line":388,"column":1},"end":{"line":388,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">P</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{P}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">P</span></span></span></span>","key":"JJ41Lfrb4V"},{"type":"text","value":" can be expressed as","position":{"start":{"line":388,"column":1},"end":{"line":388,"column":1}},"key":"m98XUwI6Pj"}],"key":"AOiKYDRaU9"},{"type":"math","value":"\\mathbf{P} = \\mathbf{e}_{i_1}\\mathbf{e}_1^T + \\mathbf{e}_{i_2}\\mathbf{e}_2^T + \\cdots + \\mathbf{e}_{i_n}\\mathbf{e}_n^T.","enumerated":false,"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi mathvariant=\"bold\">P</mi><mo>=</mo><msub><mi mathvariant=\"bold\">e</mi><msub><mi>i</mi><mn>1</mn></msub></msub><msubsup><mi mathvariant=\"bold\">e</mi><mn>1</mn><mi>T</mi></msubsup><mo>+</mo><msub><mi mathvariant=\"bold\">e</mi><msub><mi>i</mi><mn>2</mn></msub></msub><msubsup><mi mathvariant=\"bold\">e</mi><mn>2</mn><mi>T</mi></msubsup><mo>+</mo><mo>⋯</mo><mo>+</mo><msub><mi mathvariant=\"bold\">e</mi><msub><mi>i</mi><mi>n</mi></msub></msub><msubsup><mi mathvariant=\"bold\">e</mi><mi>n</mi><mi>T</mi></msubsup><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{P} = \\mathbf{e}_{i_1}\\mathbf{e}_1^T + \\mathbf{e}_{i_2}\\mathbf{e}_2^T + \\cdots + \\mathbf{e}_{i_n}\\mathbf{e}_n^T.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">P</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1414em;vertical-align:-0.2501em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">e</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3173em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2501em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathbf\">e</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913em;\"><span style=\"top:-2.453em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1414em;vertical-align:-0.2501em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">e</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3173em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2501em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathbf\">e</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913em;\"><span style=\"top:-2.453em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"minner\">⋯</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1414em;vertical-align:-0.2501em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">e</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1645em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2501em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathbf\">e</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913em;\"><span style=\"top:-2.453em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span><span class=\"mord\">.</span></span></span></span></span>","key":"j3ZD771swb"},{"type":"paragraph","position":{"start":{"line":395,"column":1},"end":{"line":395,"column":1}},"children":[{"type":"strong","position":{"start":{"line":395,"column":1},"end":{"line":395,"column":1}},"children":[{"type":"text","value":"(a)","position":{"start":{"line":395,"column":1},"end":{"line":395,"column":1}},"key":"kvE8XdGUgU"}],"key":"g7v5seiMhl"},{"type":"text","value":" For the case ","position":{"start":{"line":395,"column":1},"end":{"line":395,"column":1}},"key":"K7WRUMbXFu"},{"type":"inlineMath","value":"n=4","position":{"start":{"line":395,"column":1},"end":{"line":395,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>=</mo><mn>4</mn></mrow><annotation encoding=\"application/x-tex\">n=4</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">4</span></span></span></span>","key":"XjxR8ecvxD"},{"type":"text","value":" and ","position":{"start":{"line":395,"column":1},"end":{"line":395,"column":1}},"key":"ZjQuRZeNzl"},{"type":"inlineMath","value":"i_1=3","position":{"start":{"line":395,"column":1},"end":{"line":395,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>i</mi><mn>1</mn></msub><mo>=</mo><mn>3</mn></mrow><annotation encoding=\"application/x-tex\">i_1=3</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8095em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">3</span></span></span></span>","key":"l8OBpTwib8"},{"type":"text","value":", ","position":{"start":{"line":395,"column":1},"end":{"line":395,"column":1}},"key":"b1XDvck5dh"},{"type":"inlineMath","value":"i_2=2","position":{"start":{"line":395,"column":1},"end":{"line":395,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>i</mi><mn>2</mn></msub><mo>=</mo><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">i_2=2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8095em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span></span></span></span>","key":"dapN94N8ha"},{"type":"text","value":", ","position":{"start":{"line":395,"column":1},"end":{"line":395,"column":1}},"key":"mzfmnwPmJU"},{"type":"inlineMath","value":"i_3=4","position":{"start":{"line":395,"column":1},"end":{"line":395,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>i</mi><mn>3</mn></msub><mo>=</mo><mn>4</mn></mrow><annotation encoding=\"application/x-tex\">i_3=4</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8095em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">4</span></span></span></span>","key":"l6J0mVTvtG"},{"type":"text","value":", ","position":{"start":{"line":395,"column":1},"end":{"line":395,"column":1}},"key":"yVtjJQQEwg"},{"type":"inlineMath","value":"i_4=1","position":{"start":{"line":395,"column":1},"end":{"line":395,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>i</mi><mn>4</mn></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">i_4=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8095em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">4</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"eYzpw2HMmU"},{"type":"text","value":", write out separately, as matrices, all four of the terms in the sum. Then add them together to find ","position":{"start":{"line":395,"column":1},"end":{"line":395,"column":1}},"key":"EnFjp5Aq8C"},{"type":"inlineMath","value":"\\mathbf{P}","position":{"start":{"line":395,"column":1},"end":{"line":395,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">P</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{P}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">P</span></span></span></span>","key":"JajoGFbQli"},{"type":"text","value":".","position":{"start":{"line":395,"column":1},"end":{"line":395,"column":1}},"key":"wtxCzvkH9D"}],"key":"g85GStbKzI"},{"type":"paragraph","position":{"start":{"line":397,"column":1},"end":{"line":397,"column":1}},"children":[{"type":"strong","position":{"start":{"line":397,"column":1},"end":{"line":397,"column":1}},"children":[{"type":"text","value":"(b)","position":{"start":{"line":397,"column":1},"end":{"line":397,"column":1}},"key":"jxCQhQQWKT"}],"key":"wWWdaepR08"},{"type":"text","value":" Use the formula in the general case to show that ","position":{"start":{"line":397,"column":1},"end":{"line":397,"column":1}},"key":"KZzQiX40Ik"},{"type":"inlineMath","value":"\\mathbf{P}^{-1}=\\mathbf{P}^T","position":{"start":{"line":397,"column":1},"end":{"line":397,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi mathvariant=\"bold\">P</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo>=</mo><msup><mi mathvariant=\"bold\">P</mi><mi>T</mi></msup></mrow><annotation encoding=\"application/x-tex\">\\mathbf{P}^{-1}=\\mathbf{P}^T</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">P</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8413em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">P</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span></span></span></span>","key":"HAqjLwKpQq"},{"type":"text","value":". (Hint: To show that ","position":{"start":{"line":397,"column":1},"end":{"line":397,"column":1}},"key":"tUUQcQFORW"},{"type":"inlineMath","value":"\\mathbf{Z}","position":{"start":{"line":397,"column":1},"end":{"line":397,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">Z</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{Z}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">Z</span></span></span></span>","key":"eEx3L5ict9"},{"type":"text","value":" is the inverse of ","position":{"start":{"line":397,"column":1},"end":{"line":397,"column":1}},"key":"ensh0wuYiU"},{"type":"inlineMath","value":"\\mathbf{P}","position":{"start":{"line":397,"column":1},"end":{"line":397,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">P</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{P}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">P</span></span></span></span>","key":"eRg7aEKvQv"},{"type":"text","value":", show that ","position":{"start":{"line":397,"column":1},"end":{"line":397,"column":1}},"key":"avSKSwVLsC"},{"type":"inlineMath","value":"\\mathbf{P}\\mathbf{Z}=\\mathbf{I}","position":{"start":{"line":397,"column":1},"end":{"line":397,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">P</mi><mi mathvariant=\"bold\">Z</mi><mo>=</mo><mi mathvariant=\"bold\">I</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{P}\\mathbf{Z}=\\mathbf{I}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">PZ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">I</span></span></span></span>","key":"pS075oNSHT"},{"type":"text","value":" or ","position":{"start":{"line":397,"column":1},"end":{"line":397,"column":1}},"key":"cH3hCQBonD"},{"type":"inlineMath","value":"\\mathbf{Z}\\mathbf{P}=\\mathbf{I}","position":{"start":{"line":397,"column":1},"end":{"line":397,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">Z</mi><mi mathvariant=\"bold\">P</mi><mo>=</mo><mi mathvariant=\"bold\">I</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{Z}\\mathbf{P}=\\mathbf{I}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">ZP</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">I</span></span></span></span>","key":"CP8lKgesiu"},{"type":"text","value":".)","position":{"start":{"line":397,"column":1},"end":{"line":397,"column":1}},"key":"EkFYGtMFMc"}],"key":"nMrf40VsbS"}],"label":"problem-pivoting-perminverse","identifier":"problem-pivoting-perminverse","enumerated":true,"enumerator":"2.6.4","html_id":"problem-pivoting-perminverse","key":"PI7xIqRUSP"},{"type":"footnoteDefinition","identifier":"plu","label":"PLU","position":{"start":{"line":397,"column":1},"end":{"line":397,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"children":[{"type":"text","value":"Because unpivoted LU factorization is not useful, in practice the term ","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"key":"O2fzI8W5fH"},{"type":"emphasis","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"children":[{"type":"text","value":"LU factorization","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"key":"d16LMJYnQ6"}],"key":"fMafAxsEVd"},{"type":"text","value":" mostly refers to pivoted LU.","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"key":"SiCgSnKIRe"}],"key":"ZzMD9BkuTY"}],"enumerator":"1","key":"VVM7ga1L5W"}],"key":"EfpDb0QHHY"}],"key":"UzkD82F7aQ"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Efficiency of matrix computations","url":"/efficiency","group":"Preface"},"next":{"title":"Vector and matrix norms","url":"/norms","group":"Preface"}}},"domain":"http://localhost:3000"}