{"kind":"Article","sha256":"5d24d8ef5760dbf8accada94ac225e7326f4c1cec2240227be25944164263e71","slug":"pivoting","location":"/chapter2/pivoting.md","dependencies":[{"url":"/chapter2","label":"demo-pivoting-fail-julia","kind":"Notebook","slug":"chapter2","location":"/julia/chapter2.md","title":"Chapter 2"},{"url":"/chapter2-1","label":"demo-pivoting-fail-matlab","kind":"Notebook","slug":"chapter2-1","location":"/matlab/chapter2.md","title":"Chapter 2"},{"url":"/chapter2-2","label":"demo-pivoting-fail-python","kind":"Notebook","slug":"chapter2-2","location":"/python/chapter2.md","title":"Chapter 2"}],"frontmatter":{"title":"Row pivoting","numbering":{"heading_1":{"enabled":true},"heading_2":{"enabled":true},"heading_3":{"enabled":false},"enumerator":{"template":"2.6.%s"}},"content_includes_title":false,"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"LU":"lower triangular times upper triangular","QR":"orthogonal times upper triangular"},"exports":[{"format":"md","filename":"pivoting.md","url":"/build/pivoting-be134bb07240db8638e192c50f0df779.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"As mentioned in ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"bnXNhRDYfP"},{"type":"link","kind":"numref","identifier":"section-linsys-lu","label":"section-linsys-lu","url":"/lu","internal":true,"dataUrl":"/lu.json","children":[{"type":"text","value":"LU factorization","key":"c4oUMEN8nY"}],"key":"vC7nZkWA5u"},{"type":"text","value":", the ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"IFmevzVKPJ"},{"type":"inlineMath","value":"\\mathbf{A}=\\mathbf{L}\\mathbf{U}","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi><mo>=</mo><mi mathvariant=\"bold\">L</mi><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}=\\mathbf{L}\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">LU</span></span></span></span>","key":"Uzut43LO26"},{"type":"text","value":" factorization is not stable for every nonsingular ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"UCUEpY4KJp"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"HRJswsA3sA"},{"type":"text","value":". Indeed, the factorization does not always even exist.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"B3BV8DeMX4"}],"indexEntries":[{"entry":"matrix factorization","subEntry":{"value":"LU","kind":"entry"},"emphasis":false}],"label":"index-T9v328qv9Z","identifier":"index-t9v328qv9z","html_id":"index-t9v328qv9z","key":"rCUkyYoyNg"},{"type":"proof","kind":"example","enumerated":true,"children":[{"type":"tabSet","children":[{"type":"tabItem","title":"Julia","sync":"julia","children":[{"type":"embed","source":{"url":"/chapter2","label":"demo-pivoting-fail-julia","kind":"Notebook","slug":"chapter2","location":"/julia/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Failure of naive ","key":"lbc2UVmvJZ"},{"type":"abbreviation","title":"lower triangular times upper triangular","children":[{"type":"text","value":"LU","key":"SzimVAI4gR"}],"key":"lzhpYJhx2o"},{"type":"text","value":" factorization","key":"dc12WC7u56"}],"key":"o9wEeTm52H"},{"type":"paragraph","position":{"start":{"line":834,"column":1},"end":{"line":834,"column":1}},"children":[{"type":"text","value":"Here is a previously encountered matrix that factors well.","position":{"start":{"line":834,"column":1},"end":{"line":834,"column":1}},"key":"YRt0bd1Ed2"}],"key":"L8LQcw2B5J"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"A = [2 0 4 3 ; -4 5 -7 -10 ; 1 15 2 -4.5 ; -2 0 2 -13];\nL, U = FNC.lufact(A)\nL","key":"e07NZ6B6j8"},{"type":"output","id":"WNNVYKPWaivR1mZhQO3Yx","data":[{"output_type":"execute_result","execution_count":78,"metadata":{},"data":{"text/plain":{"content":"4×4 LowerTriangular{Float64, Matrix{Float64}}:\n  1.0   ⋅     ⋅    ⋅ \n -2.0  1.0    ⋅    ⋅ \n  0.5  3.0   1.0   ⋅ \n -1.0  0.0  -2.0  1.0","content_type":"text/plain"}}}],"key":"ZZ6ffuOjvx"}],"data":{},"key":"DsFuf8kPrx"},{"type":"paragraph","position":{"start":{"line":842,"column":1},"end":{"line":842,"column":1}},"children":[{"type":"text","value":"If we swap the second and fourth rows of ","position":{"start":{"line":842,"column":1},"end":{"line":842,"column":1}},"key":"BnA2wUkekA"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":842,"column":1},"end":{"line":842,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"qjAZtowM3y"},{"type":"text","value":", the result is still nonsingular. However, the factorization now fails.","position":{"start":{"line":842,"column":1},"end":{"line":842,"column":1}},"key":"FAeKKWTbhY"}],"key":"Zr6aomZBLl"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"A[[2, 4], :] = A[[4, 2], :]  \nL, U = FNC.lufact(A)\nL","key":"pKjWkLTNTm"},{"type":"output","id":"ByS45OlsVuk_M69ImbrZ-","data":[{"output_type":"execute_result","execution_count":79,"metadata":{},"data":{"text/plain":{"content":"4×4 LowerTriangular{Float64, Matrix{Float64}}:\n  1.0     ⋅      ⋅    ⋅ \n -1.0  NaN       ⋅    ⋅ \n  0.5   Inf   NaN     ⋅ \n -2.0   Inf   NaN    1.0","content_type":"text/plain"}}}],"key":"HeMHbYqVZa"}],"data":{},"key":"kNb5YLsnSS"},{"type":"paragraph","position":{"start":{"line":853,"column":1},"end":{"line":853,"column":1}},"children":[{"type":"text","value":"The presence of ","position":{"start":{"line":853,"column":1},"end":{"line":853,"column":1}},"key":"FlSQA1CJ71"},{"type":"inlineCode","value":"NaN","position":{"start":{"line":853,"column":1},"end":{"line":853,"column":1}},"key":"okXsm2fNFl"},{"type":"text","value":" in the result indicates that some impossible operation was required. The source of the problem is easy to locate. We can find the first outer product in the factorization just fine:","position":{"start":{"line":853,"column":1},"end":{"line":853,"column":1}},"key":"VKmP3wU5LM"}],"indexEntries":[{"entry":"Julia","subEntry":{"value":"NaN","kind":"entry"},"emphasis":false}],"key":"ZZbQA23Nnz"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"U[1, :] = A[1, :]\nL[:, 1] = A[:, 1] / U[1, 1]\nA -= L[:, 1] * U[1, :]'","key":"w4Zw9AdMDl"},{"type":"output","id":"23C7ZUq4lS9Csqe0lApZ5","data":[{"output_type":"execute_result","execution_count":80,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n 0.0   0.0  0.0    0.0\n 0.0   0.0  6.0  -10.0\n 0.0  15.0  0.0   -6.0\n 0.0   5.0  1.0   -4.0","content_type":"text/plain"}}}],"key":"dbdrXs4IZ2"}],"data":{},"key":"KMMJCb2bYp"},{"type":"paragraph","position":{"start":{"line":861,"column":1},"end":{"line":861,"column":1}},"children":[{"type":"text","value":"The next step is ","position":{"start":{"line":861,"column":1},"end":{"line":861,"column":1}},"key":"eI7mD6ezi2"},{"type":"inlineCode","value":"U[2, :] = A[2, :]","position":{"start":{"line":861,"column":1},"end":{"line":861,"column":1}},"key":"XadslcapWV"},{"type":"text","value":", which is also OK. But then we are supposed to divide by ","position":{"start":{"line":861,"column":1},"end":{"line":861,"column":1}},"key":"qOGUZt9ItZ"},{"type":"inlineCode","value":"U[2, 2]","position":{"start":{"line":861,"column":1},"end":{"line":861,"column":1}},"key":"FSLe5ESCZv"},{"type":"text","value":", which is zero. The algorithm cannot continue.","position":{"start":{"line":861,"column":1},"end":{"line":861,"column":1}},"key":"kqcEJwXRXX"}],"key":"BKauDu8HWl"}],"key":"eVCNFpczFm"}],"key":"jdt4iviRM1"}],"key":"twyyrWOg0n"},{"type":"tabItem","title":"MATLAB","sync":"matlab","children":[{"type":"embed","source":{"url":"/chapter2-1","label":"demo-pivoting-fail-matlab","kind":"Notebook","slug":"chapter2-1","location":"/matlab/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Failure of naive ","key":"y3JNWio7qx"},{"type":"abbreviation","title":"lower triangular times upper triangular","children":[{"type":"text","value":"LU","key":"s5PI834vg6"}],"key":"W662AhTkeh"},{"type":"text","value":" factorization","key":"Jt5U57S8KO"}],"key":"CN127HvSnU"},{"type":"paragraph","position":{"start":{"line":773,"column":1},"end":{"line":773,"column":1}},"children":[{"type":"text","value":"Here is a previously encountered matrix that factors well.","position":{"start":{"line":773,"column":1},"end":{"line":773,"column":1}},"key":"HGmy7vLQvd"}],"key":"uYC6lWjfWz"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A = [\n    2 0 4 3\n    -4 5 -7 -10\n    1 15 2 -4.5\n    -2 0 2 -13\n    ];\n[L, U] = lufact(A);\nL","key":"pVPmPeXye4"},{"type":"output","id":"9Ax935Huccr2u52z5YPcB","data":[{"output_type":"execute_result","execution_count":76,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>L = 4×4 double\n    1.0000         0         0         0\n   -2.0000    1.0000         0         0\n    0.5000    3.0000    1.0000         0\n   -1.0000         0   -2.0000    1.0000\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"L = 4×4 double\n    1.0000         0         0         0\n   -2.0000    1.0000         0         0\n    0.5000    3.0000    1.0000         0\n   -1.0000         0   -2.0000    1.0000\n","content_type":"text/plain"}}}],"key":"VSuvfkh7O2"}],"data":{},"key":"AQVQdEs1gn"},{"type":"paragraph","position":{"start":{"line":786,"column":1},"end":{"line":786,"column":1}},"children":[{"type":"text","value":"If we swap the second and fourth rows of ","position":{"start":{"line":786,"column":1},"end":{"line":786,"column":1}},"key":"fa4rV8X0z4"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":786,"column":1},"end":{"line":786,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"y9a2v7NHiA"},{"type":"text","value":", the result is still nonsingular. However, the factorization now fails.","position":{"start":{"line":786,"column":1},"end":{"line":786,"column":1}},"key":"LHG5caGynb"}],"key":"eNIfLYp5Uu"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A([2, 4], :) = A([4, 2], :);    % swap rows 2 and 4\n[L, U] = lufact(A);\nL","key":"MXhUjPWO2f"},{"type":"output","id":"MyPa48_AeYYC6S16pIUyv","data":[{"output_type":"execute_result","execution_count":77,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>L = 4×4 double\n    1.0000         0         0         0\n   -1.0000       NaN         0         0\n    0.5000       Inf       NaN         0\n   -2.0000       Inf       NaN    1.0000\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"L = 4×4 double\n    1.0000         0         0         0\n   -1.0000       NaN         0         0\n    0.5000       Inf       NaN         0\n   -2.0000       Inf       NaN    1.0000\n","content_type":"text/plain"}}}],"key":"hijlDwzAiZ"}],"data":{},"key":"uWTrcWmSUD"},{"type":"paragraph","position":{"start":{"line":797,"column":1},"end":{"line":797,"column":1}},"children":[{"type":"text","value":"The presence of ","position":{"start":{"line":797,"column":1},"end":{"line":797,"column":1}},"key":"waA3Z9NFlw"},{"type":"inlineCode","value":"NaN","position":{"start":{"line":797,"column":1},"end":{"line":797,"column":1}},"key":"tBXPsP41pH"},{"type":"text","value":" in the result indicates that some impossible operation was required. The source of the problem is easy to locate. We can find the first outer product in the factorization just fine:","position":{"start":{"line":797,"column":1},"end":{"line":797,"column":1}},"key":"Yjj1vnQL4C"}],"indexEntries":[{"entry":"MATLAB","subEntry":{"value":"NaN","kind":"entry"},"emphasis":false}],"key":"TONDk9184w"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"U(1, :) = A(1, :);\nL(:, 1) = A(:, 1) / U(1, 1)\nA = A - L(:, 1) * U(1, :)","key":"VCymsTAvqG"},{"type":"output","id":"LOwR_xj-jXJxP9i65-W4c","data":[{"output_type":"execute_result","execution_count":78,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>L = 4×4 double\n    1.0000         0         0         0\n   -1.0000       NaN         0         0\n    0.5000       Inf       NaN         0\n   -2.0000       Inf       NaN    1.0000\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"L = 4×4 double\n    1.0000         0         0         0\n   -1.0000       NaN         0         0\n    0.5000       Inf       NaN         0\n   -2.0000       Inf       NaN    1.0000\n","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":78,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>A = 4×4 double\n     0     0     0     0\n     0     0     6   -10\n     0    15     0    -6\n     0     5     1    -4\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"A = 4×4 double\n     0     0     0     0\n     0     0     6   -10\n     0    15     0    -6\n     0     5     1    -4\n","content_type":"text/plain"}}}],"key":"lzGExnHjc4"}],"data":{},"key":"unSOzV06kp"},{"type":"paragraph","position":{"start":{"line":805,"column":1},"end":{"line":805,"column":1}},"children":[{"type":"text","value":"The next step is ","position":{"start":{"line":805,"column":1},"end":{"line":805,"column":1}},"key":"Bp1OHLrHR9"},{"type":"inlineCode","value":"U(2, :) = A(2, :)","position":{"start":{"line":805,"column":1},"end":{"line":805,"column":1}},"key":"amRRg0wygd"},{"type":"text","value":", which is also OK. But then we are supposed to divide by ","position":{"start":{"line":805,"column":1},"end":{"line":805,"column":1}},"key":"apjgaUQKtC"},{"type":"inlineCode","value":"U(2, 2)","position":{"start":{"line":805,"column":1},"end":{"line":805,"column":1}},"key":"HsbuuIRSpv"},{"type":"text","value":", which is zero. The algorithm cannot continue.","position":{"start":{"line":805,"column":1},"end":{"line":805,"column":1}},"key":"RB8u1fB0FK"}],"key":"LLppm6GOkV"}],"key":"NewSoGv3YZ"}],"key":"j1ZhinedYS"}],"key":"WtUkeC49RP"},{"type":"tabItem","title":"Python","sync":"python","children":[{"type":"embed","source":{"url":"/chapter2-2","label":"demo-pivoting-fail-python","kind":"Notebook","slug":"chapter2-2","location":"/python/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Failure of naive ","key":"S7aYS6ENDi"},{"type":"abbreviation","title":"lower triangular times upper triangular","children":[{"type":"text","value":"LU","key":"oskuqbfB45"}],"key":"ikQCrwzY5Y"},{"type":"text","value":" factorization","key":"qmamyuh363"}],"key":"AgUG8wt912"},{"type":"paragraph","position":{"start":{"line":751,"column":1},"end":{"line":751,"column":1}},"children":[{"type":"text","value":"Here is a previously encountered matrix that factors well.","position":{"start":{"line":751,"column":1},"end":{"line":751,"column":1}},"key":"X0MgkN4w3Z"}],"key":"AL0LMDDPYh"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"A = array([\n    [2, 0, 4, 3],\n    [-4, 5, -7, -10],\n    [1, 15, 2, -4.5],\n    [-2, 0, 2, -13]\n    ])\nL, U = FNC.lufact(A)\nprint(L)","key":"pNN0ufxjCA"},{"type":"output","id":"iQ5exWIwKhY7_J4nuZthY","data":[{"output_type":"stream","name":"stdout","text":"[[ 1.   0.  -0.   0. ]\n [-2.   1.  -0.   0. ]\n [ 0.5  3.   1.   0. ]\n [-1.   0.  -2.   1. ]]\n"}],"key":"s5yfDstnDZ"}],"data":{},"key":"w540SGY8Q8"},{"type":"paragraph","position":{"start":{"line":764,"column":1},"end":{"line":764,"column":1}},"children":[{"type":"text","value":"If we swap the second and fourth rows of ","position":{"start":{"line":764,"column":1},"end":{"line":764,"column":1}},"key":"MQUO87wArU"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":764,"column":1},"end":{"line":764,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"KnL65nIMLR"},{"type":"text","value":", the result is still nonsingular. However, the factorization now fails.","position":{"start":{"line":764,"column":1},"end":{"line":764,"column":1}},"key":"pkq7EuLaCK"}],"key":"XUj0f5q26X"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"A[[1, 3], :] = A[[3, 1], :]  \nL, U = FNC.lufact(A)\nprint(L)","key":"j1p5K52KNb"},{"type":"output","id":"duzsbtARQkGx5nyH1W5Hn","data":[{"output_type":"stream","name":"stdout","text":"[[ 1.   nan  nan  0. ]\n [-1.   nan  nan  0. ]\n [ 0.5  inf  nan  0. ]\n [-2.   inf  nan  1. ]]\n"},{"output_type":"stream","name":"stderr","text":"/Users/driscoll/Dropbox/Mac/Documents/GitHub/fnc/python/FNC/FNC02.py:47: RuntimeWarning: divide by zero encountered in divide\n  L[:, k] = A_k[:, k] / U[k,k]\n/Users/driscoll/Dropbox/Mac/Documents/GitHub/fnc/python/FNC/FNC02.py:47: RuntimeWarning: invalid value encountered in divide\n  L[:, k] = A_k[:, k] / U[k,k]\n/Users/driscoll/mambaforge/envs/myst/lib/python3.13/site-packages/numpy/_core/numeric.py:983: RuntimeWarning: invalid value encountered in multiply\n  return multiply(a.ravel()[:, newaxis], b.ravel()[newaxis, :], out)\n"}],"key":"IPxXq5aNY9"}],"data":{},"key":"h90zhqsGB1"},{"type":"paragraph","position":{"start":{"line":775,"column":1},"end":{"line":775,"column":1}},"children":[{"type":"text","value":"The presence of ","position":{"start":{"line":775,"column":1},"end":{"line":775,"column":1}},"key":"EOg5F1oZe1"},{"type":"inlineCode","value":"NaN","position":{"start":{"line":775,"column":1},"end":{"line":775,"column":1}},"key":"cW4pVVHAVS"},{"type":"text","value":" in the result indicates that some impossible operation was required. The source of the problem is easy to locate. We can find the first outer product in the factorization just fine:","position":{"start":{"line":775,"column":1},"end":{"line":775,"column":1}},"key":"o9YxEbt3OL"}],"indexEntries":[{"entry":"Python","subEntry":{"value":"NaN","kind":"entry"},"emphasis":false}],"key":"wb8OUNesgL"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"U[0, :] = A[0, :]\nL[:, 0] = A[:, 0] / U[0, 0]\nA -= outer(L[:, 0],  U[0, :])\nprint(A)","key":"CuTcJPmcBT"},{"type":"output","id":"4JLevHNgSBixjz_ctMAo0","data":[{"output_type":"stream","name":"stdout","text":"[[  0.   0.   0.   0.]\n [  0.   0.   6. -10.]\n [  0.  15.   0.  -6.]\n [  0.   5.   1.  -4.]]\n"}],"key":"PmmekAV1nA"}],"data":{},"key":"ReHOp00QxT"},{"type":"paragraph","position":{"start":{"line":784,"column":1},"end":{"line":784,"column":1}},"children":[{"type":"text","value":"The next step is ","position":{"start":{"line":784,"column":1},"end":{"line":784,"column":1}},"key":"v5aFdcjyPj"},{"type":"inlineCode","value":"U[1, :] = A[1, :]","position":{"start":{"line":784,"column":1},"end":{"line":784,"column":1}},"key":"IyWL4W6Uzj"},{"type":"text","value":", which is also OK. But then we are supposed to divide by ","position":{"start":{"line":784,"column":1},"end":{"line":784,"column":1}},"key":"zKf9SIjVEt"},{"type":"inlineCode","value":"U[1, 1]","position":{"start":{"line":784,"column":1},"end":{"line":784,"column":1}},"key":"xEjlQz9ALF"},{"type":"text","value":", which is zero. The algorithm cannot continue.","position":{"start":{"line":784,"column":1},"end":{"line":784,"column":1}},"key":"RHwj2mv5O3"}],"key":"U5vyJIvrCQ"}],"key":"HgF2uuTFmp"}],"key":"NIqVZsDKHc"}],"key":"QOixoKt0Rx"}],"key":"jfy2MYH6xr"}],"label":"demo-pivoting-fail","identifier":"demo-pivoting-fail","html_id":"demo-pivoting-fail","enumerator":"2.6.1","key":"WZi3UrKN0F"},{"type":"paragraph","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"children":[{"type":"text","value":"In ","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"BqCBp3q6fI"},{"type":"link","kind":"numref","identifier":"section-linsys-lu","label":"section-linsys-lu","url":"/lu","internal":true,"dataUrl":"/lu.json","children":[{"type":"text","value":"LU factorization","key":"fAoBJCPcZI"}],"key":"PEqeSyfFUo"},{"type":"text","value":" we remarked that ","key":"X3PxpwTsDh"},{"type":"abbreviation","title":"lower triangular times upper triangular","children":[{"type":"text","value":"LU","key":"Vpf7Op4HUH"}],"key":"uPeUlRPkvm"},{"type":"text","value":" factorization is equivalent to Gaussian elimination with no row swaps. However, those swaps are necessary in situations like those encountered in ","key":"e5PpCCI1MH"},{"type":"crossReference","kind":"proof:example","identifier":"demo-pivoting-fail","label":"demo-pivoting-fail","children":[{"type":"text","value":"Demo ","key":"XNk7PqA4ZS"},{"type":"text","value":"2.6.1","key":"FeshGmwTxo"}],"template":"Example %s","enumerator":"2.6.1","resolved":true,"html_id":"demo-pivoting-fail","key":"qKC73ZogSt"},{"type":"text","value":", in order to avoid division by zero. We will find a modification of the outer product procedure that allows us to do the same thing.","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"noWnUWiFgv"}],"key":"vXrKfR2d4b"},{"type":"heading","depth":2,"position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"children":[{"type":"text","value":"Choosing a pivot","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"key":"hdN0pWPYKi"}],"identifier":"choosing-a-pivot","label":"Choosing a pivot","html_id":"choosing-a-pivot","implicit":true,"enumerator":"2.6.1","key":"yhkGO5nydE"},{"type":"paragraph","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"children":[{"type":"text","value":"The diagonal element of ","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"vpak4O9OpO"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"ToB7qG4HUe"},{"type":"text","value":" that appears in the denominator of line 17 of ","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"SCpDYxgx6N"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-lufact","label":"function-lufact","children":[{"type":"text","value":"Function ","key":"pxFy3b9b4W"},{"type":"text","value":"2.4.1","key":"H7G8DNvPbW"}],"template":"Algorithm %s","enumerator":"2.4.1","resolved":true,"html_id":"function-lufact","remote":true,"url":"/lu","dataUrl":"/lu.json","key":"l7EvnPY1hl"},{"type":"text","value":" is called the ","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"yN0bMFb8Uv"},{"type":"strong","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"children":[{"type":"text","value":"pivot element","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"sxU4UzQF0H"}],"key":"qm6ZpuabJv"},{"type":"text","value":" of its column. In order to avoid a zero pivot, we will use the largest available element in the column we are working on as the pivot. This technique is known as ","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"z4cUdB5SY5"},{"type":"strong","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"children":[{"type":"text","value":"row pivoting","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"zOi36FpqDa"}],"key":"Fl3hufpuy4"},{"type":"text","value":".","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"CYL99o3xRS"}],"indexEntries":[{"entry":"pivoting","emphasis":true}],"label":"index-QSdaO4f97M","identifier":"index-qsdao4f97m","html_id":"index-qsdao4f97m","key":"BhRD1d4q2V"},{"type":"proof","kind":"algorithm","enumerated":true,"children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Row pivoting","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"key":"C5VzCW4YL8"}],"key":"O6IxF3oR3x"},{"type":"paragraph","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"children":[{"type":"text","value":"When performing elimination in column ","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"key":"vyTskk0ifd"},{"type":"inlineMath","value":"j","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>j</mi></mrow><annotation encoding=\"application/x-tex\">j</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span></span></span></span>","key":"C8EVzbA6UZ"},{"type":"text","value":", choose as the pivot the element in column ","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"key":"ihSIJkY6Ab"},{"type":"inlineMath","value":"j","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>j</mi></mrow><annotation encoding=\"application/x-tex\">j</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span></span></span></span>","key":"zG0c0zQQmI"},{"type":"text","value":" that is largest in absolute value. (In case of ties, choose the lowest row index.)","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"key":"cHAzWPKwEa"}],"key":"EW5r72jOZo"}],"label":"rule-pivoting","identifier":"rule-pivoting","html_id":"rule-pivoting","enumerator":"2.6.1","key":"PsliBf7yUl"},{"type":"proof","kind":"example","enumerated":true,"children":[{"type":"tabSet","children":[{"type":"tabItem","title":"Julia","sync":"julia","children":[{"type":"embed","source":{"url":"/chapter2","label":"demo-pivoting-fix-julia","kind":"Notebook","slug":"chapter2","location":"/julia/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Row pivoting in ","key":"qCmH72H7hZ"},{"type":"abbreviation","title":"lower triangular times upper triangular","children":[{"type":"text","value":"LU","key":"RAlxSPpfc3"}],"key":"MRXCWA0xyy"},{"type":"text","value":" factorization","key":"sKjguqDQQc"}],"key":"pHQzUpyCsP"},{"type":"paragraph","position":{"start":{"line":866,"column":1},"end":{"line":866,"column":1}},"children":[{"type":"text","value":"Here is the trouble-making matrix from ","position":{"start":{"line":866,"column":1},"end":{"line":866,"column":1}},"key":"ELb2EJurVe"},{"type":"crossReference","kind":"proof:example","identifier":"demo-pivoting-fail","label":"demo-pivoting-fail","children":[{"type":"text","value":"Demo ","key":"x0c2IvydtZ"},{"type":"text","value":"2.6.1","key":"tk2bcawYE7"}],"template":"Example %s","enumerator":"2.6.1","resolved":true,"html_id":"demo-pivoting-fail","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"HGtMlI3mZJ"},{"type":"text","value":".","position":{"start":{"line":866,"column":1},"end":{"line":866,"column":1}},"key":"Ldpwsrmzzj"}],"key":"ghNVAkppPT"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"A₁ = [2 0 4 3 ; -2 0 2 -13; 1 15 2 -4.5 ; -4 5 -7 -10]","key":"xPU3dRrboa"},{"type":"output","id":"o0v4KD8iXKe2SijYTrYFU","data":[{"output_type":"execute_result","execution_count":81,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n  2.0   0.0   4.0    3.0\n -2.0   0.0   2.0  -13.0\n  1.0  15.0   2.0   -4.5\n -4.0   5.0  -7.0  -10.0","content_type":"text/plain"}}}],"key":"zwcPCavXVK"}],"data":{},"key":"XYQDHQOGGV"},{"type":"grid","columns":[1,1,2,2],"children":[{"type":"paragraph","position":{"start":{"line":873,"column":1},"end":{"line":873,"column":1}},"children":[{"type":"text","value":"We now find the largest candidate pivot in the first column. We don’t care about sign, so we take absolute values before finding the max.","position":{"start":{"line":873,"column":1},"end":{"line":873,"column":1}},"key":"lYwjFgE04M"}],"key":"Yn9aGIfLUi"},{"type":"card","children":[{"type":"paragraph","position":{"start":{"line":875,"column":1},"end":{"line":875,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":875,"column":1},"end":{"line":875,"column":1}},"key":"EigXuDDsHd"},{"type":"inlineCode","value":"argmax","position":{"start":{"line":875,"column":1},"end":{"line":875,"column":1}},"key":"vpC9nUApOL"},{"type":"text","value":" function returns the location of the largest element of a vector or matrix.","position":{"start":{"line":875,"column":1},"end":{"line":875,"column":1}},"key":"cBNF8hAASV"}],"key":"K14h8DDh6C"}],"key":"J3Jn3xCCcs"}],"key":"YhG0Jvn9mc"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"i = argmax( abs.(A₁[:, 1]) )","key":"EvT0QROXMw"},{"type":"output","id":"8n7r9XluByHtovFtdcD5b","data":[{"output_type":"execute_result","execution_count":82,"metadata":{},"data":{"text/plain":{"content":"4","content_type":"text/plain"}}}],"key":"Wkr4s6pffM"}],"data":{},"key":"oUs6LbwNho"},{"type":"paragraph","position":{"start":{"line":884,"column":1},"end":{"line":884,"column":1}},"children":[{"type":"text","value":"This is the row of the matrix that we extract to put into ","position":{"start":{"line":884,"column":1},"end":{"line":884,"column":1}},"key":"JMDXCOJY6j"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":884,"column":1},"end":{"line":884,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"ltgw59NxxS"},{"type":"text","value":". That guarantees that the division used to find ","position":{"start":{"line":884,"column":1},"end":{"line":884,"column":1}},"key":"cCTz9xTKYU"},{"type":"inlineMath","value":"\\boldsymbol{\\ell}_1","position":{"start":{"line":884,"column":1},"end":{"line":884,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">ℓ</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\boldsymbol{\\ell}_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">ℓ</span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"tQKpEITjV5"},{"type":"text","value":" will be valid.","position":{"start":{"line":884,"column":1},"end":{"line":884,"column":1}},"key":"MaLpN6cOEt"}],"key":"dfjbbrNelD"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"L, U = zeros(4,4),zeros(4,4)\nU[1, :] = A₁[i, :]\nL[:, 1] = A₁[:, 1] / U[1, 1]\nA₂ = A₁ - L[:, 1] * U[1, :]'","key":"jBp9DiVYab"},{"type":"output","id":"w-xhqvJxCJrdmk9-4_WZy","data":[{"output_type":"execute_result","execution_count":83,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n 0.0   2.5   0.5   -2.0\n 0.0  -2.5   5.5   -8.0\n 0.0  16.25  0.25  -7.0\n 0.0   0.0   0.0    0.0","content_type":"text/plain"}}}],"key":"DEzJFYGBgQ"}],"data":{},"key":"CGibzFD2rh"},{"type":"paragraph","position":{"start":{"line":893,"column":1},"end":{"line":893,"column":1}},"children":[{"type":"text","value":"Observe that ","position":{"start":{"line":893,"column":1},"end":{"line":893,"column":1}},"key":"ueyzJ3Qh4n"},{"type":"inlineMath","value":"\\mathbf{A}_2","position":{"start":{"line":893,"column":1},"end":{"line":893,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">A</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8361em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"IBWlLl3H5n"},{"type":"text","value":" has a new zero row and zero column, but the zero row is the fourth rather than the first. However, we forge on by using the largest possible pivot in column 2 for the next outer product.","position":{"start":{"line":893,"column":1},"end":{"line":893,"column":1}},"key":"sgulrX7yU4"}],"key":"gPtZZNPpDS"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"@show i = argmax( abs.(A₂[:, 2]) ) \nU[2, :] = A₂[i, :]\nL[:, 2] = A₂[:, 2] / U[2, 2]\nA₃ = A₂ - L[:, 2] * U[2, :]'","key":"Fyg3C458DM"},{"type":"output","id":"osL4g7sGSNmoz7rtyEqjm","data":[{"output_type":"stream","name":"stdout","text":"i = argmax(abs.(A₂[:, 2])) = 3\n"},{"output_type":"execute_result","execution_count":84,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n 0.0  0.0  0.461538  -0.923077\n 0.0  0.0  5.53846   -9.07692\n 0.0  0.0  0.0        0.0\n 0.0  0.0  0.0        0.0","content_type":"text/plain"}}}],"key":"BCDfqvKPul"}],"data":{},"key":"MPL4mH9kGV"},{"type":"paragraph","position":{"start":{"line":902,"column":1},"end":{"line":902,"column":1}},"children":[{"type":"text","value":"Now we have zeroed out the third row as well as the second column. We can finish out the procedure.","position":{"start":{"line":902,"column":1},"end":{"line":902,"column":1}},"key":"CLQajVa6zz"}],"key":"RBuBatQvuj"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"@show i = argmax( abs.(A₃[:, 3]) ) \nU[3, :] = A₃[i, :]\nL[:, 3] = A₃[:, 3] / U[3, 3]\nA₄ = A₃ - L[:, 3] * U[3, :]'","key":"SSj7o1Tw5K"},{"type":"output","id":"abRyojmLMp082WsOgSn51","data":[{"output_type":"stream","name":"stdout","text":"i = argmax(abs.(A₃[:, 3])) = 2\n"},{"output_type":"execute_result","execution_count":85,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n 0.0  0.0  0.0  -0.166667\n 0.0  0.0  0.0   0.0\n 0.0  0.0  0.0   0.0\n 0.0  0.0  0.0   0.0","content_type":"text/plain"}}}],"key":"UT543HUBEU"}],"data":{},"key":"N822TWruHI"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"@show i = argmax( abs.(A₄[:, 4]) ) \nU[4, :] = A₄[i, :]\nL[:, 4] = A₄[:, 4] / U[4, 4];","key":"usxZCRlCUR"},{"type":"output","id":"r1PbycJT02-JmrHBiF2fT","data":[{"output_type":"stream","name":"stdout","text":"i = argmax(abs.(A₄[:, 4])) = 1\n"}],"key":"v7CX9kaTJt"}],"data":{},"key":"qcFB2tMepb"},{"type":"paragraph","position":{"start":{"line":917,"column":1},"end":{"line":917,"column":1}},"children":[{"type":"text","value":"We do have a factorization of the original matrix:","position":{"start":{"line":917,"column":1},"end":{"line":917,"column":1}},"key":"uIJnfbPUFg"}],"key":"AaE16VpIvv"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"A₁ - L * U","key":"AECtodiiSh"},{"type":"output","id":"cV5BvK4BhoNMHnpCGcW9e","data":[{"output_type":"execute_result","execution_count":87,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n 0.0  -1.38778e-16  0.0  0.0\n 0.0   1.38778e-16  0.0  0.0\n 0.0   0.0          0.0  0.0\n 0.0   0.0          0.0  0.0","content_type":"text/plain"}}}],"key":"DH8RX2fyaq"}],"data":{},"key":"qZjk061qVU"},{"type":"paragraph","position":{"start":{"line":923,"column":1},"end":{"line":923,"column":1}},"children":[{"type":"text","value":"And ","position":{"start":{"line":923,"column":1},"end":{"line":923,"column":1}},"key":"lCUaTnMzCM"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":923,"column":1},"end":{"line":923,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"kQjD1LCl9j"},{"type":"text","value":" has the required structure:","position":{"start":{"line":923,"column":1},"end":{"line":923,"column":1}},"key":"vRilzIW3HI"}],"key":"L6g3XHsFJs"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"U","key":"a9rkbznp6Q"},{"type":"output","id":"cOvdbG-ZLtUeGPeI9ZZyi","data":[{"output_type":"execute_result","execution_count":88,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n -4.0   5.0   -7.0      -10.0\n  0.0  16.25   0.25      -7.0\n  0.0   0.0    5.53846   -9.07692\n  0.0   0.0    0.0       -0.166667","content_type":"text/plain"}}}],"key":"q9F9U7vPzL"}],"data":{},"key":"OytJpccjil"},{"type":"paragraph","position":{"start":{"line":929,"column":1},"end":{"line":929,"column":1}},"children":[{"type":"text","value":"However, the triangularity of ","position":{"start":{"line":929,"column":1},"end":{"line":929,"column":1}},"key":"oTVFqkbWbP"},{"type":"inlineMath","value":"\\mathbf{L}","position":{"start":{"line":929,"column":1},"end":{"line":929,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">L</span></span></span></span>","key":"FCFokUmfya"},{"type":"text","value":" has been broken.","position":{"start":{"line":929,"column":1},"end":{"line":929,"column":1}},"key":"izyCfIHVz0"}],"key":"qiarnHRRoP"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"L","key":"O9r6WnN5Ar"},{"type":"output","id":"tgm3c0DklaZp9qyU1tzkr","data":[{"output_type":"execute_result","execution_count":89,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n -0.5    0.153846  0.0833333   1.0\n  0.5   -0.153846  1.0        -0.0\n -0.25   1.0       0.0        -0.0\n  1.0    0.0       0.0        -0.0","content_type":"text/plain"}}}],"key":"Qm2H2wKWZ3"}],"data":{},"key":"nPoQMwVk4N"}],"key":"VKPcYJjsWW"}],"key":"wHaiAF5qJa"}],"key":"yYpYqkmztw"},{"type":"tabItem","title":"MATLAB","sync":"matlab","children":[{"type":"embed","source":{"url":"/chapter2-1","label":"demo-pivoting-fix-matlab","kind":"Notebook","slug":"chapter2-1","location":"/matlab/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Row pivoting in ","key":"GYJlr8yoB6"},{"type":"abbreviation","title":"lower triangular times upper triangular","children":[{"type":"text","value":"LU","key":"UAa1oYzG2V"}],"key":"n5ummVAQ7P"},{"type":"text","value":" factorization","key":"aY6FsIk2oD"}],"key":"givq3aMdjh"},{"type":"paragraph","position":{"start":{"line":810,"column":1},"end":{"line":810,"column":1}},"children":[{"type":"text","value":"Here is the trouble-making matrix from ","position":{"start":{"line":810,"column":1},"end":{"line":810,"column":1}},"key":"cfEVQke4IY"},{"type":"crossReference","kind":"proof:example","identifier":"demo-pivoting-fail","label":"demo-pivoting-fail","children":[{"type":"text","value":"Demo ","key":"KrKLt8GT6O"},{"type":"text","value":"2.6.1","key":"SCCpTWAMRx"}],"template":"Example %s","enumerator":"2.6.1","resolved":true,"html_id":"demo-pivoting-fail","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"Bp9dsajKoM"},{"type":"text","value":".","position":{"start":{"line":810,"column":1},"end":{"line":810,"column":1}},"key":"rEY9Ihctcr"}],"key":"ZOTkQ8OPwK"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A_1 = [2 0 4 3; -2 0 2 -13; 1 15 2 -4.5; -4 5 -7 -10]","key":"ga9rohV6Y3"},{"type":"output","id":"D1ndGV9t4QI2eZHqI11xd","data":[{"output_type":"execute_result","execution_count":79,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>A_1 = 4×4 double\n    2.0000         0    4.0000    3.0000\n   -2.0000         0    2.0000  -13.0000\n    1.0000   15.0000    2.0000   -4.5000\n   -4.0000    5.0000   -7.0000  -10.0000\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"A_1 = 4×4 double\n    2.0000         0    4.0000    3.0000\n   -2.0000         0    2.0000  -13.0000\n    1.0000   15.0000    2.0000   -4.5000\n   -4.0000    5.0000   -7.0000  -10.0000\n","content_type":"text/plain"}}}],"key":"C8TArSgnNz"}],"data":{},"key":"b59IhxJ5y3"},{"type":"grid","columns":[1,1,2,2],"children":[{"type":"paragraph","position":{"start":{"line":820,"column":1},"end":{"line":820,"column":1}},"children":[{"type":"text","value":"We now find the largest candidate pivot in the first column. We don’t care about sign, so we take absolute values before finding the max.","position":{"start":{"line":820,"column":1},"end":{"line":820,"column":1}},"key":"lBf35h2qxi"}],"key":"A0hn7XJSy1"},{"type":"card","children":[{"type":"paragraph","position":{"start":{"line":822,"column":1},"end":{"line":822,"column":1}},"children":[{"type":"text","value":"The second output of ","position":{"start":{"line":822,"column":1},"end":{"line":822,"column":1}},"key":"AseR5747Ek"},{"type":"inlineCode","value":"max","position":{"start":{"line":822,"column":1},"end":{"line":822,"column":1}},"key":"hjFQsY9FuR"},{"type":"text","value":" returns the location of the largest element of a vector. The ","position":{"start":{"line":822,"column":1},"end":{"line":822,"column":1}},"key":"P8vnwteCEX"},{"type":"inlineCode","value":"~","position":{"start":{"line":822,"column":1},"end":{"line":822,"column":1}},"key":"Sadm2WMalE"},{"type":"text","value":" symbol is used to ignore the value of the first output.","position":{"start":{"line":822,"column":1},"end":{"line":822,"column":1}},"key":"jhpBpbhKWX"}],"key":"DazWa9OmYq"}],"key":"wtss3yg50N"}],"indexEntries":[{"entry":"MATLAB","subEntry":{"value":"max","kind":"entry"},"emphasis":true},{"entry":"MATLAB","subEntry":{"value":"\\~","kind":"entry"},"emphasis":true}],"key":"JPzJc7Jbzp"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[~, i] = max( abs(A_1(:, 1)) )","key":"QRV6s9a088"},{"type":"output","id":"Xh1G1da-N8hwC3hw7IEWp","data":[{"output_type":"execute_result","execution_count":80,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>i = 4</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"i = 4","content_type":"text/plain"}}}],"key":"Gwjk1tc8c4"}],"data":{},"key":"E7MuE4pZr6"},{"type":"paragraph","position":{"start":{"line":831,"column":1},"end":{"line":831,"column":1}},"children":[{"type":"text","value":"This is the row of the matrix that we extract to put into ","position":{"start":{"line":831,"column":1},"end":{"line":831,"column":1}},"key":"bGO6mnqH68"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":831,"column":1},"end":{"line":831,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"T80VjjlaeA"},{"type":"text","value":". That guarantees that the division used to find ","position":{"start":{"line":831,"column":1},"end":{"line":831,"column":1}},"key":"QG7MvhlUsN"},{"type":"inlineMath","value":"\\boldsymbol{\\ell}_1","position":{"start":{"line":831,"column":1},"end":{"line":831,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">ℓ</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\boldsymbol{\\ell}_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">ℓ</span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"yRJkaN0UUj"},{"type":"text","value":" will be valid.","position":{"start":{"line":831,"column":1},"end":{"line":831,"column":1}},"key":"geiaD2pM3s"}],"key":"T7d8uT3wur"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"L = zeros(4, 4);\nU = zeros(4, 4);\nU(1, :) = A_1(i, :);\nL(:, 1) = A_1(:, 1) / U(1, 1);\nA_2 = A_1 - L(:, 1) * U(1, :)","key":"lILG2la7Hh"},{"type":"output","id":"tYO5OBVn1GlHqlI6ntJOj","data":[{"output_type":"execute_result","execution_count":81,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>A_2 = 4×4 double\n         0    2.5000    0.5000   -2.0000\n         0   -2.5000    5.5000   -8.0000\n         0   16.2500    0.2500   -7.0000\n         0         0         0         0\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"A_2 = 4×4 double\n         0    2.5000    0.5000   -2.0000\n         0   -2.5000    5.5000   -8.0000\n         0   16.2500    0.2500   -7.0000\n         0         0         0         0\n","content_type":"text/plain"}}}],"key":"pFIiHdeN33"}],"data":{},"key":"d2sUuYSHjf"},{"type":"paragraph","position":{"start":{"line":841,"column":1},"end":{"line":841,"column":1}},"children":[{"type":"text","value":"Observe that ","position":{"start":{"line":841,"column":1},"end":{"line":841,"column":1}},"key":"I6h0fiDnfe"},{"type":"inlineMath","value":"\\mathbf{A}_2","position":{"start":{"line":841,"column":1},"end":{"line":841,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">A</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8361em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"ujgizIxiXm"},{"type":"text","value":" has a new zero row and zero column, but the zero row is the fourth rather than the first. However, we forge on by using the largest possible pivot in column 2 for the next outer product.","position":{"start":{"line":841,"column":1},"end":{"line":841,"column":1}},"key":"ZcKsNCN6Rb"}],"key":"YqjlnTvtrb"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[~, i] = max( abs(A_2(:, 2)) )\nU(2, :) = A_2(i, :);\nL(:, 2) = A_2(:, 2) / U(2, 2);\nA_3 = A_2 - L(:, 2) * U(2, :)","key":"Dv5u88oazJ"},{"type":"output","id":"nNGeFraIY2AE6SOVfvzZ_","data":[{"output_type":"execute_result","execution_count":82,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>i = 3</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"i = 3","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":82,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>A_3 = 4×4 double\n         0         0    0.4615   -0.9231\n         0         0    5.5385   -9.0769\n         0         0         0         0\n         0         0         0         0\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"A_3 = 4×4 double\n         0         0    0.4615   -0.9231\n         0         0    5.5385   -9.0769\n         0         0         0         0\n         0         0         0         0\n","content_type":"text/plain"}}}],"key":"q0REfuDE1n"}],"data":{},"key":"QNSu66W0rp"},{"type":"paragraph","position":{"start":{"line":850,"column":1},"end":{"line":850,"column":1}},"children":[{"type":"text","value":"Now we have zeroed out the third row as well as the second column. We can finish out the procedure.","position":{"start":{"line":850,"column":1},"end":{"line":850,"column":1}},"key":"XMbkLxNYqz"}],"key":"k2tL9Vx56V"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[~, i] = max( abs(A_3(:, 3)) ) \nU(3, :) = A_3(i, :);\nL(:, 3) = A_3(:, 3) / U(3, 3);\nA_4 = A_3 - L(:, 3) * U(3, :)","key":"LWs36Xk5ts"},{"type":"output","id":"W8ygCipQLy3lg2AIepmZR","data":[{"output_type":"execute_result","execution_count":83,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>i = 2</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"i = 2","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":83,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>A_4 = 4×4 double\n         0         0         0   -0.1667\n         0         0         0         0\n         0         0         0         0\n         0         0         0         0\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"A_4 = 4×4 double\n         0         0         0   -0.1667\n         0         0         0         0\n         0         0         0         0\n         0         0         0         0\n","content_type":"text/plain"}}}],"key":"JNrhUymlim"}],"data":{},"key":"VkY2HBwQ5a"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[~, i] = max( abs(A_4(:, 4)) ) \nU(4, :) = A_4(i, :);\nL(:, 4) = A_4(:, 4) / U(4, 4);","key":"SKhiyCPsmL"},{"type":"output","id":"-f1SSkgXE4dLqMISSR5Pk","data":[{"output_type":"execute_result","execution_count":84,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>i = 1</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"i = 1","content_type":"text/plain"}}}],"key":"WGQRiIhe23"}],"data":{},"key":"k7ZSLqB2ut"},{"type":"paragraph","position":{"start":{"line":865,"column":1},"end":{"line":865,"column":1}},"children":[{"type":"text","value":"We do have a factorization of the original matrix:","position":{"start":{"line":865,"column":1},"end":{"line":865,"column":1}},"key":"ThoZzq3uHT"}],"key":"eSSTY06w8k"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A_1 - L * U","key":"tGe30x2cBY"},{"type":"output","id":"v_u8JL67HhkaHlw3X-OaB","data":[{"output_type":"execute_result","execution_count":85,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = 4×4 double\n     0     0     0     0\n     0     0     0     0\n     0     0     0     0\n     0     0     0     0\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = 4×4 double\n     0     0     0     0\n     0     0     0     0\n     0     0     0     0\n     0     0     0     0\n","content_type":"text/plain"}}}],"key":"WC8klfj2Gt"}],"data":{},"key":"HoZTdRbeVa"},{"type":"paragraph","position":{"start":{"line":871,"column":1},"end":{"line":871,"column":1}},"children":[{"type":"text","value":"And ","position":{"start":{"line":871,"column":1},"end":{"line":871,"column":1}},"key":"HA4F4Ljit5"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":871,"column":1},"end":{"line":871,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"X6WOnOOGgF"},{"type":"text","value":" has the required structure:","position":{"start":{"line":871,"column":1},"end":{"line":871,"column":1}},"key":"El43b4YNzO"}],"key":"me4YJk1DYW"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"U","key":"yA6ww6rWXE"},{"type":"output","id":"hre4wL791gJrpkYfPk2d-","data":[{"output_type":"execute_result","execution_count":86,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>U = 4×4 double\n   -4.0000    5.0000   -7.0000  -10.0000\n         0   16.2500    0.2500   -7.0000\n         0         0    5.5385   -9.0769\n         0         0         0   -0.1667\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"U = 4×4 double\n   -4.0000    5.0000   -7.0000  -10.0000\n         0   16.2500    0.2500   -7.0000\n         0         0    5.5385   -9.0769\n         0         0         0   -0.1667\n","content_type":"text/plain"}}}],"key":"MOtWuvyxfA"}],"data":{},"key":"o8eNRDmQtK"},{"type":"paragraph","position":{"start":{"line":877,"column":1},"end":{"line":877,"column":1}},"children":[{"type":"text","value":"However, the triangularity of ","position":{"start":{"line":877,"column":1},"end":{"line":877,"column":1}},"key":"jjRe0zCYmO"},{"type":"inlineMath","value":"\\mathbf{L}","position":{"start":{"line":877,"column":1},"end":{"line":877,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">L</span></span></span></span>","key":"r8eXYT4sl3"},{"type":"text","value":" has been broken.","position":{"start":{"line":877,"column":1},"end":{"line":877,"column":1}},"key":"HxxANKN9jk"}],"key":"ocxw7TKwVx"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"L","key":"VDoT2QLCZ0"},{"type":"output","id":"8zNga-LdTcPAow29CXYAI","data":[{"output_type":"execute_result","execution_count":87,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>L = 4×4 double\n   -0.5000    0.1538    0.0833    1.0000\n    0.5000   -0.1538    1.0000         0\n   -0.2500    1.0000         0         0\n    1.0000         0         0         0\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"L = 4×4 double\n   -0.5000    0.1538    0.0833    1.0000\n    0.5000   -0.1538    1.0000         0\n   -0.2500    1.0000         0         0\n    1.0000         0         0         0\n","content_type":"text/plain"}}}],"key":"ifpMjRo2bG"}],"data":{},"key":"H9D8KrXncO"}],"key":"N3nyjUiTbq"}],"key":"e3txlkIw8l"}],"key":"Wj4ZbZJtnQ"},{"type":"tabItem","title":"Python","sync":"python","children":[{"type":"embed","source":{"url":"/chapter2-2","label":"demo-pivoting-fix-python","kind":"Notebook","slug":"chapter2-2","location":"/python/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Row pivoting in ","key":"NQABXOzrK9"},{"type":"abbreviation","title":"lower triangular times upper triangular","children":[{"type":"text","value":"LU","key":"cxFXq3likA"}],"key":"nXkev5DjM8"},{"type":"text","value":" factorization","key":"ECzxu1lsPk"}],"key":"OXQ09XLFlu"},{"type":"paragraph","position":{"start":{"line":789,"column":1},"end":{"line":789,"column":1}},"children":[{"type":"text","value":"Here is the trouble-making matrix from ","position":{"start":{"line":789,"column":1},"end":{"line":789,"column":1}},"key":"UVPEfu8Hp3"},{"type":"crossReference","kind":"proof:example","identifier":"demo-pivoting-fail","label":"demo-pivoting-fail","children":[{"type":"text","value":"Demo ","key":"qZitHKMsBz"},{"type":"text","value":"2.6.1","key":"gzG890zPrg"}],"template":"Example %s","enumerator":"2.6.1","resolved":true,"html_id":"demo-pivoting-fail","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"LaFDGebRa7"},{"type":"text","value":".","position":{"start":{"line":789,"column":1},"end":{"line":789,"column":1}},"key":"YxS9kWkkaJ"}],"key":"yd9eup6tei"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"A_1 = array([\n    [2, 0, 4, 3],\n    [-2, 0, 2, -13],\n    [1, 15, 2, -4.5],\n    [-4, 5, -7, -10]\n    ])","key":"fEBpTbtrQH"},{"type":"output","id":"eMEvzh5LvZ0grUeI5LiQK","data":[],"key":"TXa03X0C5A"}],"data":{},"key":"rzq8B7Zu7g"},{"type":"grid","columns":[1,1,2,2],"children":[{"type":"paragraph","position":{"start":{"line":801,"column":1},"end":{"line":801,"column":1}},"children":[{"type":"text","value":"We now find the largest candidate pivot in the first column. We don’t care about sign, so we take absolute values before finding the max.","position":{"start":{"line":801,"column":1},"end":{"line":801,"column":1}},"key":"aI1pS2AU3P"}],"key":"p3MPNIXhOR"},{"type":"card","children":[{"type":"paragraph","position":{"start":{"line":803,"column":1},"end":{"line":803,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":803,"column":1},"end":{"line":803,"column":1}},"key":"UnXow0PcCX"},{"type":"inlineCode","value":"argmax","position":{"start":{"line":803,"column":1},"end":{"line":803,"column":1}},"key":"v09G72jSGg"},{"type":"text","value":" function returns the location of the largest element of a vector or matrix.","position":{"start":{"line":803,"column":1},"end":{"line":803,"column":1}},"key":"D4PMHJQL46"}],"key":"AGVByhVpR3"}],"key":"u6fmvEBxrd"}],"key":"zw2DKXPh4X"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"i = argmax( abs(A_1[:, 0]) )\nprint(i)","key":"rVoNh6KbwU"},{"type":"output","id":"2o20IitugnXuJy7Gi-PxJ","data":[{"output_type":"stream","name":"stdout","text":"3\n"}],"key":"LzLbnUcLvk"}],"data":{},"key":"HYP5uAj82g"},{"type":"paragraph","position":{"start":{"line":813,"column":1},"end":{"line":813,"column":1}},"children":[{"type":"text","value":"This is the row of the matrix that we extract to put into ","position":{"start":{"line":813,"column":1},"end":{"line":813,"column":1}},"key":"RIPO1OFi6E"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":813,"column":1},"end":{"line":813,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"SMcqoF79Vw"},{"type":"text","value":". That guarantees that the division used to find ","position":{"start":{"line":813,"column":1},"end":{"line":813,"column":1}},"key":"QO8ZxCm1Mr"},{"type":"inlineMath","value":"\\boldsymbol{\\ell}_1","position":{"start":{"line":813,"column":1},"end":{"line":813,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">ℓ</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\boldsymbol{\\ell}_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">ℓ</span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"XJl1EQL9yI"},{"type":"text","value":" will be valid.","position":{"start":{"line":813,"column":1},"end":{"line":813,"column":1}},"key":"zgI5UmmmWL"}],"key":"kU6JHfRC6s"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"L, U = eye(4), zeros((4, 4))\nU[0, :] = A_1[i, :]\nL[:, 0] = A_1[:, 0] / U[0, 0]\nA_2 = A_1 - outer(L[:, 0], U[0, :])\nprint(A_2)","key":"Ew2P1SORus"},{"type":"output","id":"oAU2uO_tS2CP9mHIug0dK","data":[{"output_type":"stream","name":"stdout","text":"[[ 0.    2.5   0.5  -2.  ]\n [ 0.   -2.5   5.5  -8.  ]\n [ 0.   16.25  0.25 -7.  ]\n [ 0.    0.    0.    0.  ]]\n"}],"key":"pfb1iEC2iN"}],"data":{},"key":"VFqv7XxgF4"},{"type":"paragraph","position":{"start":{"line":823,"column":1},"end":{"line":823,"column":1}},"children":[{"type":"text","value":"Observe that ","position":{"start":{"line":823,"column":1},"end":{"line":823,"column":1}},"key":"dQ3k4ePUxO"},{"type":"inlineMath","value":"\\mathbf{A}_2","position":{"start":{"line":823,"column":1},"end":{"line":823,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">A</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8361em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"DDuyX7bG2y"},{"type":"text","value":" has a new zero row and zero column, but the zero row is the fourth rather than the first. However, we forge on by using the largest possible pivot in column 2 for the next outer product.","position":{"start":{"line":823,"column":1},"end":{"line":823,"column":1}},"key":"mQv6ALfwjK"}],"key":"oABpkGZhZu"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"i = argmax( abs(A_2[:, 1]) ) \nprint(f\"new pivot row is {i}\")\nU[1, :] = A_2[i, :]\nL[:, 1] = A_2[:, 1] / U[1, 1]\nA_3 = A_2 - outer(L[:, 1], U[1, :])\nprint(A_3)","key":"TIHADzyinf"},{"type":"output","id":"WGKtqkYKq2c_cXf9Rw6cA","data":[{"output_type":"stream","name":"stdout","text":"new pivot row is 2\n[[ 0.          0.          0.46153846 -0.92307692]\n [ 0.          0.          5.53846154 -9.07692308]\n [ 0.          0.          0.          0.        ]\n [ 0.          0.          0.          0.        ]]\n"}],"key":"gRK7fowo6D"}],"data":{},"key":"KGH5qU1CEP"},{"type":"paragraph","position":{"start":{"line":833,"column":1},"end":{"line":833,"column":1}},"children":[{"type":"text","value":"Now we have zeroed out the third row as well as the second column. We can finish out the procedure.","position":{"start":{"line":833,"column":1},"end":{"line":833,"column":1}},"key":"eTyRaS3c15"}],"key":"ahlNDLeofc"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"i = argmax( abs(A_3[:, 2]) ) \nprint(f\"new pivot row is {i}\")\nU[2, :] = A_3[i, :]\nL[:, 2] = A_3[:, 2] / U[2, 2]\nA_4 = A_3 - outer(L[:, 2], U[2, :])\nprint(A_4)","key":"Wcc9G2BFDl"},{"type":"output","id":"wLtFV_1C1oczG2HEZ4KJ_","data":[{"output_type":"stream","name":"stdout","text":"new pivot row is 1\n[[ 0.          0.          0.         -0.16666667]\n [ 0.          0.          0.          0.        ]\n [ 0.          0.          0.          0.        ]\n [ 0.          0.          0.          0.        ]]\n"}],"key":"gI7MpZuAQq"}],"data":{},"key":"IcRZ9Ldeo1"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"i = argmax( abs(A_4[:, 3]) ) \nprint(f\"new pivot row is {i}\")\nU[3, :] = A_4[i, :]\nL[:, 3] = A_4[:, 3] / U[3, 3];","key":"kGfWsqnqPR"},{"type":"output","id":"iWaqKk2wJkTBYGfbYsCzH","data":[{"output_type":"stream","name":"stdout","text":"new pivot row is 0\n"}],"key":"CZi12dBz00"}],"data":{},"key":"MWxqvY5G2A"},{"type":"paragraph","position":{"start":{"line":851,"column":1},"end":{"line":851,"column":1}},"children":[{"type":"text","value":"We do have a factorization of the original matrix:","position":{"start":{"line":851,"column":1},"end":{"line":851,"column":1}},"key":"LhSaS3axcN"}],"key":"uFodZsphWD"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"A_1 - L @ U","key":"UATbcNWr7Y"},{"type":"output","id":"RgMbUJ6vDHZWJ_3kRn8l3","data":[{"output_type":"execute_result","execution_count":85,"metadata":{},"data":{"text/plain":{"content":"array([[0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00],\n       [0.00000000e+00, 0.00000000e+00, 2.22044605e-16, 0.00000000e+00],\n       [0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00],\n       [0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00]])","content_type":"text/plain"}}}],"key":"WfGPeRZBMr"}],"data":{},"key":"MEDD0FjMSZ"},{"type":"paragraph","position":{"start":{"line":857,"column":1},"end":{"line":857,"column":1}},"children":[{"type":"text","value":"And ","position":{"start":{"line":857,"column":1},"end":{"line":857,"column":1}},"key":"ad1zHiKdWe"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":857,"column":1},"end":{"line":857,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"uO4l5m2Wsb"},{"type":"text","value":" has the required structure:","position":{"start":{"line":857,"column":1},"end":{"line":857,"column":1}},"key":"xHMac6sK50"}],"key":"tWO7NqeIyb"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(U)","key":"AL9evfzboQ"},{"type":"output","id":"QQv9vQ96gea9uXPj8zfom","data":[{"output_type":"stream","name":"stdout","text":"[[ -4.           5.          -7.         -10.        ]\n [  0.          16.25         0.25        -7.        ]\n [  0.           0.           5.53846154  -9.07692308]\n [  0.           0.           0.          -0.16666667]]\n"}],"key":"cZn0yc6C4j"}],"data":{},"key":"FiwY1TaGuU"},{"type":"paragraph","position":{"start":{"line":863,"column":1},"end":{"line":863,"column":1}},"children":[{"type":"text","value":"However, the triangularity of ","position":{"start":{"line":863,"column":1},"end":{"line":863,"column":1}},"key":"vVDr86KGIu"},{"type":"inlineMath","value":"\\mathbf{L}","position":{"start":{"line":863,"column":1},"end":{"line":863,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">L</span></span></span></span>","key":"quIY0Umw9N"},{"type":"text","value":" has been broken.","position":{"start":{"line":863,"column":1},"end":{"line":863,"column":1}},"key":"keiDouN4GO"}],"key":"agXFq5QipH"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(L)","key":"yhQ8YpW1O7"},{"type":"output","id":"d2eRwgOdBX76ZyrNDVUmC","data":[{"output_type":"stream","name":"stdout","text":"[[-0.5         0.15384615  0.08333333  1.        ]\n [ 0.5        -0.15384615  1.         -0.        ]\n [-0.25        1.          0.         -0.        ]\n [ 1.          0.          0.         -0.        ]]\n"}],"key":"Gt5a7akzyK"}],"data":{},"key":"cIRuqtckFg"}],"key":"r1LET9fiBi"}],"key":"t9FjlOKXx6"}],"key":"r4GR2k66k1"}],"key":"tpayVZ0mk8"}],"label":"demo-pivoting-fix","identifier":"demo-pivoting-fix","html_id":"demo-pivoting-fix","enumerator":"2.6.2","key":"TuWp8DVX46"},{"type":"paragraph","position":{"start":{"line":73,"column":1},"end":{"line":73,"column":1}},"children":[{"type":"text","value":"We will return to the loss of triangularity in ","position":{"start":{"line":73,"column":1},"end":{"line":73,"column":1}},"key":"RCk16IAgaB"},{"type":"inlineMath","value":"\\mathbf{L}","position":{"start":{"line":73,"column":1},"end":{"line":73,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">L</span></span></span></span>","key":"avyTwDO4Uk"},{"type":"text","value":" momentarily. First, though, there is a question left to answer: what if at some stage, all the elements of the targeted column are zero, i.e., there are no available pivots? Fortunately that loose end ties up nicely, although a proof is a bit beyond our scope here.","position":{"start":{"line":73,"column":1},"end":{"line":73,"column":1}},"key":"wf10oMPwFr"}],"key":"VQ96TXQuMv"},{"type":"proof","kind":"theorem","enumerated":true,"children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Row pivoting","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"key":"ksaC1hCx0x"}],"key":"i9W3xhohUG"},{"type":"paragraph","position":{"start":{"line":77,"column":1},"end":{"line":77,"column":1}},"children":[{"type":"text","value":"The row-pivoted ","key":"CTYObY1OWf"},{"type":"abbreviation","title":"lower triangular times upper triangular","children":[{"type":"text","value":"LU","key":"evq2e8ysHl"}],"key":"THlyqDh4n7"},{"type":"text","value":" factorization runs to completion if and only if the original matrix is invertible.","key":"EW4OHS2GP4"}],"key":"KcQLPVf2bf"}],"label":"theorem-pivot","identifier":"theorem-pivot","html_id":"theorem-pivot","enumerator":"2.6.1","key":"ng11supQ5Q"},{"type":"paragraph","position":{"start":{"line":80,"column":1},"end":{"line":80,"column":1}},"children":[{"type":"text","value":"A linear system with a singular matrix has either no solution or infinitely many solutions. Either way, a technique other than ","key":"A6u72vR5J8"},{"type":"abbreviation","title":"lower triangular times upper triangular","children":[{"type":"text","value":"LU","key":"B4mB0qPtWC"}],"key":"NVyod0lPkl"},{"type":"text","value":" factorization is needed to handle it.","key":"oqeyZLPEVK"}],"key":"mxAdRqUAgA"},{"type":"heading","depth":2,"position":{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},"children":[{"type":"text","value":"Permutations","position":{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},"key":"v6CGFoDP1o"}],"identifier":"permutations","label":"Permutations","html_id":"permutations","implicit":true,"enumerator":"2.6.2","key":"AYPC7gEkvL"},{"type":"paragraph","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"children":[{"type":"text","value":"Even though the resulting ","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"key":"AG3FePNqXR"},{"type":"inlineMath","value":"\\mathbf{L}","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">L</span></span></span></span>","key":"rYdaysw6y1"},{"type":"text","value":" in ","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"key":"plLqwnDeyU"},{"type":"crossReference","kind":"proof:example","identifier":"demo-pivoting-fix","label":"demo-pivoting-fix","children":[{"type":"text","value":"Demo ","key":"WETCQQEBfE"},{"type":"text","value":"2.6.2","key":"mPXVZIkdEP"}],"template":"Example %s","enumerator":"2.6.2","resolved":true,"html_id":"demo-pivoting-fix","key":"NyFXkStdWB"},{"type":"text","value":" is no longer of unit lower triangular form, it is close. In fact, all that is needed is to reverse the order of its rows.","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"key":"zAPiHQjjIO"}],"key":"yKniCfWzyB"},{"type":"paragraph","position":{"start":{"line":86,"column":1},"end":{"line":86,"column":1}},"children":[{"type":"text","value":"In principle, if the permutation of rows implied by the pivot locations is applied all at once to the original ","position":{"start":{"line":86,"column":1},"end":{"line":86,"column":1}},"key":"gw3DOqdykM"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":86,"column":1},"end":{"line":86,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"OTIuHJjvEH"},{"type":"text","value":", no further pivoting is needed. In practice, this permutation cannot be determined immediately from the original ","position":{"start":{"line":86,"column":1},"end":{"line":86,"column":1}},"key":"GHfPqIjCWt"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":86,"column":1},"end":{"line":86,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"KYlvxuWqUF"},{"type":"text","value":"; the only way to find it is to run the algorithm. Having obtained it at the end, though, we can use it to state a simple relationship.","position":{"start":{"line":86,"column":1},"end":{"line":86,"column":1}},"key":"CN0DyRR6Pf"}],"key":"HS9xA1rqdi"},{"type":"proof","kind":"definition","enumerated":true,"children":[{"type":"admonitionTitle","children":[{"type":"text","value":"P","key":"bRgozv7OTD"},{"type":"abbreviation","title":"lower triangular times upper triangular","children":[{"type":"text","value":"LU","key":"tqOETa8zmM"}],"key":"uzFyeSVqUy"},{"type":"text","value":" factorization","key":"LO9VqLt7VK"}],"key":"apo9po9x1f"},{"type":"paragraph","position":{"start":{"line":92,"column":1},"end":{"line":92,"column":1}},"children":[{"type":"text","value":"Given ","position":{"start":{"line":92,"column":1},"end":{"line":92,"column":1}},"key":"h4sdM8xKef"},{"type":"inlineMath","value":"n\\times n","position":{"start":{"line":92,"column":1},"end":{"line":92,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>×</mo><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n\\times n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"nvrT6y768I"},{"type":"text","value":" matrix ","position":{"start":{"line":92,"column":1},"end":{"line":92,"column":1}},"key":"ur5UkB1hF7"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":92,"column":1},"end":{"line":92,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"ezNlVXDsEW"},{"type":"text","value":", the ","position":{"start":{"line":92,"column":1},"end":{"line":92,"column":1}},"key":"DXC2siCHVm"},{"type":"strong","position":{"start":{"line":92,"column":1},"end":{"line":92,"column":1}},"children":[{"type":"text","value":"P","key":"GyNcSWNFiK"},{"type":"abbreviation","title":"lower triangular times upper triangular","children":[{"type":"text","value":"LU","key":"rIQaJZQWdm"}],"key":"qGbLWDOVWp"},{"type":"text","value":" factorization","key":"bhKnrUPVlf"}],"key":"i07AByfSkQ"},{"type":"text","value":" is a unit lower triangular ","position":{"start":{"line":92,"column":1},"end":{"line":92,"column":1}},"key":"Zzr3FVfiJa"},{"type":"inlineMath","value":"\\mathbf{L}","position":{"start":{"line":92,"column":1},"end":{"line":92,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">L</span></span></span></span>","key":"ZhQW4Ix7lS"},{"type":"text","value":", an upper triangular ","position":{"start":{"line":92,"column":1},"end":{"line":92,"column":1}},"key":"ylpEKne9iC"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":92,"column":1},"end":{"line":92,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"qqsox4Dul7"},{"type":"text","value":", and a permutation ","position":{"start":{"line":92,"column":1},"end":{"line":92,"column":1}},"key":"kehoQzyzdk"},{"type":"inlineMath","value":"i_1,\\ldots,i_n","position":{"start":{"line":92,"column":1},"end":{"line":92,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>i</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><mo>…</mo><mo separator=\"true\">,</mo><msub><mi>i</mi><mi>n</mi></msub></mrow><annotation encoding=\"application/x-tex\">i_1,\\ldots,i_n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"eTa7PWUOd4"},{"type":"text","value":" of the integers ","position":{"start":{"line":92,"column":1},"end":{"line":92,"column":1}},"key":"ncL0OJSLD4"},{"type":"inlineMath","value":"1,\\ldots,n","position":{"start":{"line":92,"column":1},"end":{"line":92,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mo separator=\"true\">,</mo><mo>…</mo><mo separator=\"true\">,</mo><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">1,\\ldots,n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8389em;vertical-align:-0.1944em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"KL2JKe4XEH"},{"type":"text","value":", such that","position":{"start":{"line":92,"column":1},"end":{"line":92,"column":1}},"key":"H4YQFXmjDZ"}],"key":"wo8oadvs1W"},{"type":"math","value":"\\tilde{\\mathbf{A}} = \\mathbf{L}\\mathbf{U},","position":{"start":{"line":94,"column":1},"end":{"line":94,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mover accent=\"true\"><mi mathvariant=\"bold\">A</mi><mo>~</mo></mover><mo>=</mo><mi mathvariant=\"bold\">L</mi><mi mathvariant=\"bold\">U</mi><mo separator=\"true\">,</mo></mrow><annotation encoding=\"application/x-tex\">\\tilde{\\mathbf{A}} = \\mathbf{L}\\mathbf{U},</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.923em;\"></span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.923em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathbf\">A</span></span><span style=\"top:-3.6051em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.1111em;\"><span class=\"mord\">~</span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8805em;vertical-align:-0.1944em;\"></span><span class=\"mord mathbf\">LU</span><span class=\"mpunct\">,</span></span></span></span></span>","enumerator":"2.6.1","key":"BrMaciQAZ3"},{"type":"paragraph","position":{"start":{"line":96,"column":1},"end":{"line":96,"column":1}},"children":[{"type":"text","value":"where rows ","position":{"start":{"line":96,"column":1},"end":{"line":96,"column":1}},"key":"fsEzBtoqYL"},{"type":"inlineMath","value":"1,\\ldots,n","position":{"start":{"line":96,"column":1},"end":{"line":96,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mo separator=\"true\">,</mo><mo>…</mo><mo separator=\"true\">,</mo><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">1,\\ldots,n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8389em;vertical-align:-0.1944em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"Sd0gZqiiK6"},{"type":"text","value":" of ","position":{"start":{"line":96,"column":1},"end":{"line":96,"column":1}},"key":"uf0bH0SLCa"},{"type":"inlineMath","value":"\\tilde{\\mathbf{A}}","position":{"start":{"line":96,"column":1},"end":{"line":96,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mover accent=\"true\"><mi mathvariant=\"bold\">A</mi><mo>~</mo></mover></mrow><annotation encoding=\"application/x-tex\">\\tilde{\\mathbf{A}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.923em;\"></span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.923em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathbf\">A</span></span><span style=\"top:-3.6051em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.1111em;\"><span class=\"mord\">~</span></span></span></span></span></span></span></span></span></span>","key":"LilluI2bfb"},{"type":"text","value":" are rows ","position":{"start":{"line":96,"column":1},"end":{"line":96,"column":1}},"key":"PpBsQHOpwm"},{"type":"inlineMath","value":"i_1,\\ldots,i_n","position":{"start":{"line":96,"column":1},"end":{"line":96,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>i</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><mo>…</mo><mo separator=\"true\">,</mo><msub><mi>i</mi><mi>n</mi></msub></mrow><annotation encoding=\"application/x-tex\">i_1,\\ldots,i_n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"ZxYXqtaC0p"},{"type":"text","value":" of ","position":{"start":{"line":96,"column":1},"end":{"line":96,"column":1}},"key":"M7WocWk4hU"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":96,"column":1},"end":{"line":96,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"VxKwNrd32e"},{"type":"text","value":".","position":{"start":{"line":96,"column":1},"end":{"line":96,"column":1}},"key":"yItORG8ZTx"}],"key":"gYWopA2xcV"}],"indexEntries":[{"entry":"matrix factorization","subEntry":{"value":"pivoted LU","kind":"entry"},"emphasis":true},{"entry":"PLU factorization","emphasis":true}],"label":"index-D8KZub6Fkw","identifier":"index-d8kzub6fkw","html_id":"index-d8kzub6fkw","enumerator":"2.6.1","key":"v25saZEkll"},{"type":"paragraph","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"children":[{"type":"crossReference","kind":"proof:algorithm","identifier":"function-plufact","label":"function-plufact","children":[{"type":"text","value":"Function ","key":"DxPhE3E820"},{"type":"text","value":"2.6.2","key":"sykqEmRAF4"}],"template":"Algorithm %s","enumerator":"2.6.2","resolved":true,"html_id":"function-plufact","key":"xqkcfhpSPe"},{"type":"text","value":" shows our implementation of P","key":"XrpWuKWw1H"},{"type":"abbreviation","title":"lower triangular times upper triangular","children":[{"type":"text","value":"LU","key":"nFUmAb9VQl"}],"key":"XpcXbQFJgc"},{"type":"text","value":" factorization.","key":"F4gfBCUduE"},{"type":"footnoteReference","identifier":"plu","label":"PLU","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"number":1,"enumerator":"1","key":"RB6r921DDy"}],"key":"YZehsaMuTn"},{"type":"proof","kind":"algorithm","enumerated":true,"children":[{"type":"admonitionTitle","children":[{"type":"text","value":"plufact","position":{"start":{"line":104,"column":1},"end":{"line":104,"column":1}},"key":"Bn9xqYdFya"}],"key":"WswyXEu1Cd"},{"type":"tabSet","children":[{"type":"tabItem","title":"Julia","sync":"julia","children":[{"type":"embed","source":{"url":"/chapter2","label":"function-plufact-julia","kind":"Notebook","slug":"chapter2","location":"/julia/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","children":[{"type":"summary","children":[{"type":"abbreviation","title":"lower triangular times upper triangular","children":[{"type":"text","value":"LU","key":"mqxMwSVRpF"}],"key":"ImxGtRiIb9"},{"type":"text","value":" factorization with partial pivoting","key":"fJAl8N1I6a"}],"key":"Suv9GXWcTq"},{"type":"include","file":"../julia/package/src/chapter02.jl","literal":true,"filter":{"lines":[[57,81]]},"children":[{"type":"code","value":"\"\"\"\n    plufact(A)\n\nCompute the PLU factorization of square matrix `A`, returning the\ntriangular factors and a row permutation vector.\n\"\"\"\nfunction plufact(A)\n    n = size(A,1)\n    L = zeros(n,n)\n    U = zeros(n,n)\n    p = fill(0,n)\n    Aₖ = float(copy(A))\n\n    # Reduction by outer products\n    for k in 1:n-1\n        p[k] = argmax(abs.(Aₖ[:,k]))\n        U[k,:] = Aₖ[p[k],:]\n        L[:,k] = Aₖ[:,k]/U[k,k]\n        Aₖ -= L[:,k]*U[k,:]'\n    end\n    p[n] = argmax(abs.(Aₖ[:,n]))\n    U[n,n] = Aₖ[p[n],n]\n    L[:,n] = Aₖ[:,n]/U[n,n]\n    return LowerTriangular(L[p,:]),U,p\nend","lang":"julia","showLineNumbers":true,"filename":"plufact.jl","key":"qvbUPhOhPr"}],"key":"ajb1gkOuU9"},{"type":"code","lang":"","value":"","position":{"start":{"line":81,"column":1},"end":{"line":81,"column":1}},"key":"CcowsuIpU1"}],"key":"XdBqe4wrtt"}],"key":"udpPFE5aEK"}],"key":"T7I5S7Yh29"},{"type":"tabItem","title":"MATLAB","sync":"matlab","children":[{"type":"embed","source":{"url":"/chapter2","label":"function-plufact-julia","kind":"Notebook","slug":"chapter2","location":"/julia/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","children":[{"type":"summary","children":[{"type":"abbreviation","title":"lower triangular times upper triangular","children":[{"type":"text","value":"LU","key":"anThuZCPKP"}],"key":"ag3NPR50eK"},{"type":"text","value":" factorization with partial pivoting","key":"Ovwe3p0u6q"}],"key":"TOXgLnDUlC"},{"type":"include","file":"../julia/package/src/chapter02.jl","literal":true,"filter":{"lines":[[57,81]]},"children":[{"type":"code","value":"\"\"\"\n    plufact(A)\n\nCompute the PLU factorization of square matrix `A`, returning the\ntriangular factors and a row permutation vector.\n\"\"\"\nfunction plufact(A)\n    n = size(A,1)\n    L = zeros(n,n)\n    U = zeros(n,n)\n    p = fill(0,n)\n    Aₖ = float(copy(A))\n\n    # Reduction by outer products\n    for k in 1:n-1\n        p[k] = argmax(abs.(Aₖ[:,k]))\n        U[k,:] = Aₖ[p[k],:]\n        L[:,k] = Aₖ[:,k]/U[k,k]\n        Aₖ -= L[:,k]*U[k,:]'\n    end\n    p[n] = argmax(abs.(Aₖ[:,n]))\n    U[n,n] = Aₖ[p[n],n]\n    L[:,n] = Aₖ[:,n]/U[n,n]\n    return LowerTriangular(L[p,:]),U,p\nend","lang":"julia","showLineNumbers":true,"filename":"plufact.jl","key":"XcW2p3vcdY"}],"key":"d1OUYeb0W1"},{"type":"code","lang":"","value":"","position":{"start":{"line":81,"column":1},"end":{"line":81,"column":1}},"key":"JnB2Do3zrs"}],"key":"iQl2JdWWpo"}],"key":"PX8OyRvXNN"}],"key":"Hxk8pYxcxX"},{"type":"tabItem","title":"Python","sync":"python","children":[{"type":"embed","source":{"url":"/chapter2-2","label":"function-plufact-python","kind":"Notebook","slug":"chapter2-2","location":"/python/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","children":[{"type":"summary","children":[{"type":"abbreviation","title":"lower triangular times upper triangular","children":[{"type":"text","value":"LU","key":"OG0XVUhFlh"}],"key":"CdlQ6ZumDq"},{"type":"text","value":" factorization with partial pivoting","key":"UgO7DFzTnX"}],"key":"RASbCK7hd8"},{"type":"include","file":"../python/pkg/FNC/FNC02.py","literal":true,"filter":{"lines":[[52,72]]},"children":[{"type":"code","value":"def plufact(A):\n    \"\"\"\n        plufact(A)\n\n    Compute the PLU factorization of square matrix `A`, returning the\n    triangular factors and a row permutation vector.\n    \"\"\"\n    n = A.shape[0]\n    L = np.zeros((n, n))\n    U = np.zeros((n, n))\n    p = np.zeros(n, dtype=int)\n    A_k = np.copy(A)\n\n    # Reduction by np.outer products\n    for k in range(n):\n        p[k] = np.argmax(abs(A_k[:, k]))\n        U[k, :] = A_k[p[k], :]\n        L[:, k] = A_k[:, k] / U[k, k]\n        if k < n-1:\n            A_k -= np.outer(L[:, k], U[k, :])\n    return L[p, :], U, p","lang":"python","showLineNumbers":true,"filename":"plufact.py","key":"qKiQ9QBoJg"}],"key":"VGbRNr1J8W"}],"key":"arXNThNFPS"}],"key":"wvABh5KYtp"}],"key":"iiiy5GmyQz"}],"key":"nad3i4jKxP"}],"label":"function-plufact","identifier":"function-plufact","html_id":"function-plufact","enumerator":"2.6.2","key":"kpgSz8gyQB"},{"type":"paragraph","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"children":[{"type":"text","value":"Ideally, the P","key":"DGKUGj1FSB"},{"type":"abbreviation","title":"lower triangular times upper triangular","children":[{"type":"text","value":"LU","key":"qOL4GkQ9Bs"}],"key":"yVutg6tjif"},{"type":"text","value":" factorization takes ","key":"tX1Yux8sIE"},{"type":"inlineMath","value":"\\sim \\frac{2}{3}n^3","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>∼</mo><mfrac><mn>2</mn><mn>3</mn></mfrac><msup><mi>n</mi><mn>3</mn></msup></mrow><annotation encoding=\"application/x-tex\">\\sim \\frac{2}{3}n^3</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.3669em;\"></span><span class=\"mrel\">∼</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1901em;vertical-align:-0.345em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8451em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">3</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mord\"><span class=\"mord mathnormal\">n</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span></span></span></span></span></span></span></span>","key":"ucI8uw9R2e"},{"type":"text","value":" flops asymptotically, just like ","key":"u3sAmFQPIi"},{"type":"abbreviation","title":"lower triangular times upper triangular","children":[{"type":"text","value":"LU","key":"rIxrNa6bKu"}],"key":"xQHyhQmT9Y"},{"type":"text","value":" without pivoting. The implementation in ","key":"ftTsbtR0WW"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-plufact","label":"function-plufact","children":[{"type":"text","value":"Function ","key":"RiBhYEbd00"},{"type":"text","value":"2.6.2","key":"yNa9hN100L"}],"template":"Algorithm %s","enumerator":"2.6.2","resolved":true,"html_id":"function-plufact","key":"FTSrqgxi5r"},{"type":"text","value":" does not achieve this optimal flop count, however. Like ","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"key":"NOJsJpMD13"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-lufact","label":"function-lufact","children":[{"type":"text","value":"Function ","key":"mGeBq2tucc"},{"type":"text","value":"2.4.1","key":"WXQrfiKNYQ"}],"template":"Algorithm %s","enumerator":"2.4.1","resolved":true,"html_id":"function-lufact","remote":true,"url":"/lu","dataUrl":"/lu.json","key":"R8810DdMKF"},{"type":"text","value":", it does unnecessary operations on structurally known zeros for the sake of being easier to understand.","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"key":"SqH7ZIXIR4"}],"key":"qX3s3izRpL"},{"type":"heading","depth":2,"position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"children":[{"type":"text","value":"Linear systems","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"key":"qfikJzOoxe"}],"identifier":"linear-systems","label":"Linear systems","html_id":"linear-systems","implicit":true,"enumerator":"2.6.3","key":"FSvhzuYJW7"},{"type":"paragraph","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"children":[{"type":"text","value":"The output of ","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"key":"QPJ9feVh9R"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-plufact","label":"function-plufact","children":[{"type":"text","value":"Function ","key":"d5sjxOtEHE"},{"type":"text","value":"2.6.2","key":"N80vD6aLHI"}],"template":"Algorithm %s","enumerator":"2.6.2","resolved":true,"html_id":"function-plufact","key":"PUERhykY61"},{"type":"text","value":" is a factorization of a row-permuted ","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"key":"f8foQ578uV"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"xJy82Bl5mr"},{"type":"text","value":". Therefore, given a linear system ","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"key":"WBh57Pqqs0"},{"type":"inlineMath","value":"\\mathbf{A}\\mathbf{x}=\\mathbf{b}","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi><mi mathvariant=\"bold\">x</mi><mo>=</mo><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}\\mathbf{x}=\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">Ax</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"Yn8XAdW6Ah"},{"type":"text","value":", we have to permute ","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"key":"OyLqKHBTI5"},{"type":"inlineMath","value":"\\mathbf{b}","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"yRCrcOtPHc"},{"type":"text","value":" the same way before applying forward and backward substitution. This is equivalent to changing the order of the equations in a linear system, which does not affect its solution.","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"key":"LOHUbUyJxl"}],"key":"FBFwU6VJam"},{"type":"proof","kind":"example","enumerated":true,"children":[{"type":"tabSet","children":[{"type":"tabItem","title":"Julia","sync":"julia","children":[{"type":"embed","source":{"url":"/chapter2","label":"demo-pivoting-usage-julia","kind":"Notebook","slug":"chapter2","location":"/julia/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"P","key":"IarCgCNS1V"},{"type":"abbreviation","title":"lower triangular times upper triangular","children":[{"type":"text","value":"LU","key":"u9da9We1pO"}],"key":"x3BSF3CIpC"},{"type":"text","value":" factorization for solving linear systems","key":"I181s50QC5"}],"key":"o7W4a52n2q"},{"type":"paragraph","position":{"start":{"line":966,"column":1},"end":{"line":966,"column":1}},"children":[{"type":"text","value":"The third output of ","position":{"start":{"line":966,"column":1},"end":{"line":966,"column":1}},"key":"Kc9quYX11W"},{"type":"inlineCode","value":"plufact","position":{"start":{"line":966,"column":1},"end":{"line":966,"column":1}},"key":"IaEsY7Idx1"},{"type":"text","value":" is the permutation vector we need to apply to ","position":{"start":{"line":966,"column":1},"end":{"line":966,"column":1}},"key":"mwjAnINanb"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":966,"column":1},"end":{"line":966,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"HQiyP7FpXr"},{"type":"text","value":".","position":{"start":{"line":966,"column":1},"end":{"line":966,"column":1}},"key":"srJ3AseIVw"}],"key":"sGRmHbXzvO"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"A = rand(1:20, 4, 4)\nL, U, p = FNC.plufact(A)\nA[p,:] - L * U   # should be ≈ 0","key":"o2YuZytZLH"},{"type":"output","id":"7YAvAZmYLl0HMKwdRFntn","data":[{"output_type":"execute_result","execution_count":94,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n 0.0  0.0          0.0   0.0\n 0.0  0.0          0.0   0.0\n 0.0  4.44089e-16  0.0  -4.44089e-16\n 0.0  0.0          0.0   0.0","content_type":"text/plain"}}}],"key":"nGZZcfbX1u"}],"data":{},"key":"P2w0NKoTHQ"},{"type":"paragraph","position":{"start":{"line":974,"column":1},"end":{"line":974,"column":1}},"children":[{"type":"text","value":"Given a vector ","position":{"start":{"line":974,"column":1},"end":{"line":974,"column":1}},"key":"LssdU7pNFx"},{"type":"inlineMath","value":"\\mathbf{b}","position":{"start":{"line":974,"column":1},"end":{"line":974,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"JuZvDLEsjB"},{"type":"text","value":", we solve ","position":{"start":{"line":974,"column":1},"end":{"line":974,"column":1}},"key":"K9e0bcS6kR"},{"type":"inlineMath","value":"\\mathbf{A}\\mathbf{x}=\\mathbf{b}","position":{"start":{"line":974,"column":1},"end":{"line":974,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi><mi mathvariant=\"bold\">x</mi><mo>=</mo><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}\\mathbf{x}=\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">Ax</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"loApriC3yZ"},{"type":"text","value":" by first permuting the entries of ","position":{"start":{"line":974,"column":1},"end":{"line":974,"column":1}},"key":"AUJ9al8s0K"},{"type":"inlineMath","value":"\\mathbf{b}","position":{"start":{"line":974,"column":1},"end":{"line":974,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"awrPUDt7KB"},{"type":"text","value":" and then proceeding as before.","position":{"start":{"line":974,"column":1},"end":{"line":974,"column":1}},"key":"l2U7NM5TQW"}],"key":"pZd56vJKzC"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"b = rand(4)\nz = FNC.forwardsub(L,b[p])\nx = FNC.backsub(U,z)","key":"asOk2GI5AU"},{"type":"output","id":"cUiU_tJKFxLi4svinT4Oy","data":[{"output_type":"execute_result","execution_count":95,"metadata":{},"data":{"text/plain":{"content":"4-element Vector{Float64}:\n -0.33168489684198815\n  0.27269046385891715\n -0.00886110429912814\n  0.14453178996224317","content_type":"text/plain"}}}],"key":"rbQj50ElXl"}],"data":{},"key":"IOXEsI5DdQ"},{"type":"paragraph","position":{"start":{"line":982,"column":1},"end":{"line":982,"column":1}},"children":[{"type":"text","value":"A residual check is successful:","position":{"start":{"line":982,"column":1},"end":{"line":982,"column":1}},"key":"TxKdH9OY1Y"}],"key":"Mm4pJNNgTA"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"b - A*x","key":"APy8EJieyu"},{"type":"output","id":"hLHKMORzuZ2Yy3pY46ObK","data":[{"output_type":"execute_result","execution_count":96,"metadata":{},"data":{"text/plain":{"content":"4-element Vector{Float64}:\n 3.3306690738754696e-16\n 4.996003610813204e-16\n 3.885780586188048e-16\n 0.0","content_type":"text/plain"}}}],"key":"GpBveDu5N9"}],"data":{},"key":"y4I8MGKT3G"}],"key":"hTDtwjLrtj"}],"key":"X48Fpqpbp9"}],"key":"B0dTbequGC"},{"type":"tabItem","title":"MATLAB","sync":"matlab","children":[{"type":"embed","source":{"url":"/chapter2-1","label":"demo-pivoting-usage-matlab","kind":"Notebook","slug":"chapter2-1","location":"/matlab/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"P","key":"yXhynIeel7"},{"type":"abbreviation","title":"lower triangular times upper triangular","children":[{"type":"text","value":"LU","key":"Lcef08OePa"}],"key":"zCVdWNrqVh"},{"type":"text","value":" factorization for solving linear systems","key":"WTNxkMqylC"}],"key":"x89eCTmI6b"},{"type":"paragraph","position":{"start":{"line":914,"column":1},"end":{"line":914,"column":1}},"children":[{"type":"text","value":"The third output of ","position":{"start":{"line":914,"column":1},"end":{"line":914,"column":1}},"key":"Gtxa6qMSGe"},{"type":"inlineCode","value":"plufact","position":{"start":{"line":914,"column":1},"end":{"line":914,"column":1}},"key":"cZSwsQKVNe"},{"type":"text","value":" is the permutation vector we need to apply to ","position":{"start":{"line":914,"column":1},"end":{"line":914,"column":1}},"key":"nY1vXZZwba"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":914,"column":1},"end":{"line":914,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"SiMBmKVUk2"},{"type":"text","value":".","position":{"start":{"line":914,"column":1},"end":{"line":914,"column":1}},"key":"ArH8Z0AAyb"}],"key":"Uwqwt2485Y"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A = randi(20, 4, 4);\n[L, U, p] = plufact(A);\nA(p, :) - L * U    % should be ≈ 0","key":"frhmUmvg9h"},{"type":"output","id":"0eInHltdCOyWUl1Z5qO1I","data":[{"output_type":"execute_result","execution_count":92,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = 4×4 double\n     0     0     0     0\n     0     0     0     0\n     0     0     0     0\n     0     0     0     0\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = 4×4 double\n     0     0     0     0\n     0     0     0     0\n     0     0     0     0\n     0     0     0     0\n","content_type":"text/plain"}}}],"key":"rwVB5jiick"}],"data":{},"key":"umFtvjAfjq"},{"type":"paragraph","position":{"start":{"line":922,"column":1},"end":{"line":922,"column":1}},"children":[{"type":"text","value":"Given a vector ","position":{"start":{"line":922,"column":1},"end":{"line":922,"column":1}},"key":"obi1ALzJk5"},{"type":"inlineMath","value":"\\mathbf{b}","position":{"start":{"line":922,"column":1},"end":{"line":922,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"XoKT2l0CS4"},{"type":"text","value":", we solve ","position":{"start":{"line":922,"column":1},"end":{"line":922,"column":1}},"key":"g2ypjKhsoT"},{"type":"inlineMath","value":"\\mathbf{A}\\mathbf{x}=\\mathbf{b}","position":{"start":{"line":922,"column":1},"end":{"line":922,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi><mi mathvariant=\"bold\">x</mi><mo>=</mo><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}\\mathbf{x}=\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">Ax</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"cbXJyKx6Y7"},{"type":"text","value":" by first permuting the entries of ","position":{"start":{"line":922,"column":1},"end":{"line":922,"column":1}},"key":"qygAklB15S"},{"type":"inlineMath","value":"\\mathbf{b}","position":{"start":{"line":922,"column":1},"end":{"line":922,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"eSE2VLuiAm"},{"type":"text","value":" and then proceeding as before.","position":{"start":{"line":922,"column":1},"end":{"line":922,"column":1}},"key":"ZCeL7BkevH"}],"key":"ynkkSnkbmH"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"b = rand(4, 1);\nz = forwardsub(L, b(p));\nx = backsub(U, z)","key":"VHv3jmmp4d"},{"type":"output","id":"SFCxHEhE7r6CQir-3KTrz","data":[{"output_type":"execute_result","execution_count":93,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>x = 4×1 double\n    0.0134\n    0.0086\n    0.0058\n    0.0199\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"x = 4×1 double\n    0.0134\n    0.0086\n    0.0058\n    0.0199\n","content_type":"text/plain"}}}],"key":"PruEgaGsZZ"}],"data":{},"key":"ldYCCRCuM9"},{"type":"paragraph","position":{"start":{"line":930,"column":1},"end":{"line":930,"column":1}},"children":[{"type":"text","value":"A residual check is successful:","position":{"start":{"line":930,"column":1},"end":{"line":930,"column":1}},"key":"O2XgxbpdOv"}],"key":"bygXalbPEy"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"b - A*x","key":"atJsFEyoCh"},{"type":"output","id":"oqzXQTgXSgTLzhFyr9GhD","data":[{"output_type":"execute_result","execution_count":94,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = 4×1 double\n1.0e-16 *\n\n         0\n    0.5551\n         0\n         0\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = 4×1 double\n1.0e-16 *\n\n         0\n    0.5551\n         0\n         0\n","content_type":"text/plain"}}}],"key":"aUvg2KMgqr"}],"data":{},"key":"nEo9ce2YKw"}],"key":"nvI5PEYXzN"}],"key":"tYTjT99G6Z"}],"key":"GoHv1bIwQu"},{"type":"tabItem","title":"Python","sync":"python","children":[{"type":"embed","source":{"url":"/chapter2-2","label":"demo-pivoting-usage-python","kind":"Notebook","slug":"chapter2-2","location":"/python/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"P","key":"Swi4w4jsAu"},{"type":"abbreviation","title":"lower triangular times upper triangular","children":[{"type":"text","value":"LU","key":"AVJM9TPUvr"}],"key":"dobEOA65eH"},{"type":"text","value":" factorization for solving linear systems","key":"VKZUWPihtn"}],"key":"PStiIErzB4"},{"type":"paragraph","position":{"start":{"line":906,"column":1},"end":{"line":906,"column":1}},"children":[{"type":"text","value":"The third output of ","position":{"start":{"line":906,"column":1},"end":{"line":906,"column":1}},"key":"iHXBb0k0Gr"},{"type":"inlineCode","value":"plufact","position":{"start":{"line":906,"column":1},"end":{"line":906,"column":1}},"key":"lGTTOh1oYI"},{"type":"text","value":" is the permutation vector we need to apply to ","position":{"start":{"line":906,"column":1},"end":{"line":906,"column":1}},"key":"uDEha8Tsoa"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":906,"column":1},"end":{"line":906,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"Iue1QADSVJ"},{"type":"text","value":".","position":{"start":{"line":906,"column":1},"end":{"line":906,"column":1}},"key":"on6NAavMWL"}],"key":"NSzSxq36n8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"A = random.randn(4, 4)\nL, U, p = FNC.plufact(A)\nA[p, :] - L @ U   # should be ≈ 0","key":"cqsCjr20CO"},{"type":"output","id":"253kBATS3S6oD7JOhH-jt","data":[{"output_type":"execute_result","execution_count":92,"metadata":{},"data":{"text/plain":{"content":"array([[ 0.00000000e+00,  0.00000000e+00,  0.00000000e+00,\n         0.00000000e+00],\n       [ 0.00000000e+00, -5.55111512e-17,  1.11022302e-16,\n         5.55111512e-17],\n       [ 0.00000000e+00,  0.00000000e+00, -1.11022302e-16,\n         1.11022302e-16],\n       [ 0.00000000e+00,  0.00000000e+00,  0.00000000e+00,\n         0.00000000e+00]])","content_type":"text/plain"}}}],"key":"eYzEtb1aH9"}],"data":{},"key":"r0BSzfccEo"},{"type":"paragraph","position":{"start":{"line":914,"column":1},"end":{"line":914,"column":1}},"children":[{"type":"text","value":"Given a vector ","position":{"start":{"line":914,"column":1},"end":{"line":914,"column":1}},"key":"DUSS82Lij2"},{"type":"inlineMath","value":"\\mathbf{b}","position":{"start":{"line":914,"column":1},"end":{"line":914,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"akQ2u6wBQc"},{"type":"text","value":", we solve ","position":{"start":{"line":914,"column":1},"end":{"line":914,"column":1}},"key":"C9dsmpew5n"},{"type":"inlineMath","value":"\\mathbf{A}\\mathbf{x}=\\mathbf{b}","position":{"start":{"line":914,"column":1},"end":{"line":914,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi><mi mathvariant=\"bold\">x</mi><mo>=</mo><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}\\mathbf{x}=\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">Ax</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"ppAwetQVtp"},{"type":"text","value":" by first permuting the entries of ","position":{"start":{"line":914,"column":1},"end":{"line":914,"column":1}},"key":"uB8Vz8fj3m"},{"type":"inlineMath","value":"\\mathbf{b}","position":{"start":{"line":914,"column":1},"end":{"line":914,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"PzBDH1QqnU"},{"type":"text","value":" and then proceeding as before.","position":{"start":{"line":914,"column":1},"end":{"line":914,"column":1}},"key":"EhxltVvNmo"}],"key":"z9k7QXEh0E"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"b = random.randn(4)\nz = FNC.forwardsub(L, b[p])\nx = FNC.backsub(U, z)","key":"uNs8zeLzju"},{"type":"output","id":"E5adzAe6bW3mRY8a4dSaL","data":[],"key":"jSZMUl7noJ"}],"data":{},"key":"fXorHwppq7"},{"type":"paragraph","position":{"start":{"line":922,"column":1},"end":{"line":922,"column":1}},"children":[{"type":"text","value":"A residual check is successful:","position":{"start":{"line":922,"column":1},"end":{"line":922,"column":1}},"key":"Ruaq6LLbFU"}],"key":"tY19BsCT9d"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"b - A @ x","key":"StB9Qp5pfG"},{"type":"output","id":"_Z4ALwSGXMAvwuFRp9l8I","data":[{"output_type":"execute_result","execution_count":94,"metadata":{},"data":{"text/plain":{"content":"array([-1.24900090e-15,  2.66453526e-15,  2.22044605e-15, -3.94129174e-15])","content_type":"text/plain"}}}],"key":"Jjfop2UAhg"}],"data":{},"key":"st8rxNQ0CG"}],"key":"hgMPnF1m0c"}],"key":"Iuk3eRJlhA"}],"key":"vieUMgf0wk"}],"key":"TpeBangH9K"}],"label":"demo-pivoting-usage","identifier":"demo-pivoting-usage","html_id":"demo-pivoting-usage","enumerator":"2.6.3","key":"esz27e4q4m"},{"type":"paragraph","position":{"start":{"line":156,"column":1},"end":{"line":156,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":156,"column":1},"end":{"line":156,"column":1}},"key":"uL4FOhg3aY"},{"type":"inlineCode","value":"lu","position":{"start":{"line":156,"column":1},"end":{"line":156,"column":1}},"key":"jrpaj8bijt"},{"type":"text","value":" function from the built-in package ","position":{"start":{"line":156,"column":1},"end":{"line":156,"column":1}},"key":"ywjLsKKhUa"},{"type":"inlineCode","value":"LinearAlgebra","position":{"start":{"line":156,"column":1},"end":{"line":156,"column":1}},"key":"T1Ab3pkqnz"},{"type":"text","value":" returns the same three outputs as ","position":{"start":{"line":156,"column":1},"end":{"line":156,"column":1}},"key":"Hmr8ZGSBE6"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-plufact","label":"function-plufact","children":[{"type":"text","value":"Function ","key":"gIbvu19KtB"},{"type":"text","value":"2.6.2","key":"QIUUcTIDWi"}],"template":"Algorithm %s","enumerator":"2.6.2","resolved":true,"html_id":"function-plufact","key":"gvMbE6H4Ly"},{"type":"text","value":". If you only request one output, it will be a factorization object that can be used with a backslash. This is useful when you want to solve with multiple versions of ","position":{"start":{"line":156,"column":1},"end":{"line":156,"column":1}},"key":"xNJQjmcMeK"},{"type":"inlineMath","value":"\\mathbf{b}","position":{"start":{"line":156,"column":1},"end":{"line":156,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"Z3VE1ExTRe"},{"type":"text","value":" but do the factorization only once.","position":{"start":{"line":156,"column":1},"end":{"line":156,"column":1}},"key":"sthtCvYfDB"}],"key":"tCU4t8ZYM3"},{"type":"proof","kind":"example","enumerated":true,"children":[{"type":"tabSet","children":[{"type":"tabItem","title":"Julia","sync":"julia","children":[{"type":"embed","source":{"url":"/chapter2","label":"demo-pivoting-builtin-julia","kind":"Notebook","slug":"chapter2","location":"/julia/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Built-in P","key":"qB9ORM0Sb7"},{"type":"abbreviation","title":"lower triangular times upper triangular","children":[{"type":"text","value":"LU","key":"MS9m2zRGxE"}],"key":"auRJtlHDix"},{"type":"text","value":" factorization","key":"kFvY6yXp9Y"}],"key":"QPnexDhUww"},{"type":"paragraph","position":{"start":{"line":991,"column":1},"end":{"line":991,"column":1}},"children":[{"type":"text","value":"With the syntax ","position":{"start":{"line":991,"column":1},"end":{"line":991,"column":1}},"key":"yt6prXOUPX"},{"type":"inlineCode","value":"A \\ b","position":{"start":{"line":991,"column":1},"end":{"line":991,"column":1}},"key":"v5xbvrE1vD"},{"type":"text","value":", the matrix ","position":{"start":{"line":991,"column":1},"end":{"line":991,"column":1}},"key":"ZlbN9tlBpx"},{"type":"inlineCode","value":"A","position":{"start":{"line":991,"column":1},"end":{"line":991,"column":1}},"key":"IpUzCtCMYf"},{"type":"text","value":" is P","key":"pPMuLKzhWc"},{"type":"abbreviation","title":"lower triangular times upper triangular","children":[{"type":"text","value":"LU","key":"QyC7tWQahd"}],"key":"oCP2keA5jJ"},{"type":"text","value":"-factored, followed by two triangular solves.","key":"GP1Bu5Hea6"}],"key":"TiwreLLvem"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"A = randn(500, 500)   # 500x500 with normal random entries\nA \\ rand(500)          # force compilation\n@elapsed for k=1:50; A \\ rand(500); end","key":"ad25e1opit"},{"type":"output","id":"_A6ZQzZ_zh55Yv-5xyJ0G","data":[{"output_type":"execute_result","execution_count":97,"metadata":{},"data":{"text/plain":{"content":"0.291864375","content_type":"text/plain"}}}],"key":"Y7tUIZhHFD"}],"data":{},"key":"PPuxkVvKhi"},{"type":"paragraph","position":{"start":{"line":999,"column":1},"end":{"line":999,"column":1}},"children":[{"type":"text","value":"In ","position":{"start":{"line":999,"column":1},"end":{"line":999,"column":1}},"key":"Ghs6N3HANn"},{"type":"link","kind":"numref","url":"/efficiency","internal":true,"dataUrl":"/efficiency.json","children":[{"type":"text","value":"Efficiency of matrix computations","key":"Siek99igtI"}],"key":"DX14s9hssV"},{"type":"text","value":" we showed that the factorization is by far the most costly part of the solution process. A factorization object allows us to do that costly step only once per unique matrix.","position":{"start":{"line":999,"column":1},"end":{"line":999,"column":1}},"key":"c7S1bGtTrj"}],"key":"wEgJeJza2Z"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"factored = lu(A)     # store factorization result\nfactored \\ rand(500)   # force compilation\n@elapsed for k=1:50; factored \\ rand(500); end","key":"H0dPI1LubL"},{"type":"output","id":"2H2HZ57AiI6YpEJIDJep8","data":[{"output_type":"execute_result","execution_count":98,"metadata":{},"data":{"text/plain":{"content":"0.007513958","content_type":"text/plain"}}}],"key":"d8eemCNZyS"}],"data":{},"key":"Fqs14WmUj6"}],"key":"RrMqa2z8VZ"}],"key":"QDuJNIIK24"}],"key":"Dnug8q4bmj"},{"type":"tabItem","title":"MATLAB","sync":"matlab","children":[{"type":"embed","source":{"url":"/chapter2-1","label":"demo-pivoting-builtin-matlab","kind":"Notebook","slug":"chapter2-1","location":"/matlab/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Built-in P","key":"aVbBP9fI19"},{"type":"abbreviation","title":"lower triangular times upper triangular","children":[{"type":"text","value":"LU","key":"EfZlwxtxia"}],"key":"HCSJf6FRhE"},{"type":"text","value":" factorization","key":"xpHa1sZi9d"}],"key":"dpf1Wybzhl"},{"type":"paragraph","position":{"start":{"line":939,"column":1},"end":{"line":939,"column":1}},"children":[{"type":"text","value":"With the syntax ","position":{"start":{"line":939,"column":1},"end":{"line":939,"column":1}},"key":"aJW7zgAxXR"},{"type":"inlineCode","value":"A \\ b","position":{"start":{"line":939,"column":1},"end":{"line":939,"column":1}},"key":"Wr856TpgqG"},{"type":"text","value":", the matrix ","position":{"start":{"line":939,"column":1},"end":{"line":939,"column":1}},"key":"JIySj7rtDZ"},{"type":"inlineCode","value":"A","position":{"start":{"line":939,"column":1},"end":{"line":939,"column":1}},"key":"fGCt03YPbw"},{"type":"text","value":" is P","key":"wiCfsi6eXl"},{"type":"abbreviation","title":"lower triangular times upper triangular","children":[{"type":"text","value":"LU","key":"eoGtNNwGCU"}],"key":"nbP6a4BScr"},{"type":"text","value":"-factored, followed by two triangular solves.","key":"NOtaUOuSTO"}],"key":"Iq9fJhTMPC"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A = randn(500, 500);    % 500x500 with normal random entries\ntic; for k=1:50; A \\ rand(500, 1); end; toc","key":"sEeb0ZhNMe"},{"type":"output","id":"I5KnQD-BtFlLDPYu61bqe","data":[{"output_type":"stream","name":"stdout","text":"Elapsed time is 0.526734 seconds.\n"}],"key":"o2RB1UBpZH"}],"data":{},"key":"jt9eJxGErv"},{"type":"paragraph","position":{"start":{"line":946,"column":1},"end":{"line":946,"column":1}},"children":[{"type":"text","value":"In ","position":{"start":{"line":946,"column":1},"end":{"line":946,"column":1}},"key":"GKZ4GgUyvG"},{"type":"link","kind":"numref","url":"/efficiency","internal":true,"dataUrl":"/efficiency.json","children":[{"type":"text","value":"Efficiency of matrix computations","key":"QpVAGZPDiW"}],"key":"z4iCFzX5Uf"},{"type":"text","value":" we showed that the factorization is by far the most costly part of the solution process. A factorization object allows us to do that costly step only once per unique matrix.","position":{"start":{"line":946,"column":1},"end":{"line":946,"column":1}},"key":"gZW1HjXND0"}],"key":"fUDurBAQi1"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[L, U, p] = lu(A, 'vector');    % keep factorization result\ntic\nfor k=1:50\n    b = rand(500, 1);\n    U \\ (L \\ b(p));\nend\ntoc","key":"bvMq3GRYmO"},{"type":"output","id":"h5SqjJih_MV7XJPw8wf1Z","data":[{"output_type":"stream","name":"stdout","text":"Elapsed time is 0.009369 seconds.\n"}],"key":"WLxxcaCPh0"}],"data":{},"key":"Ecgc9gnHAx"}],"key":"i2Vq24SWzh"}],"key":"hr5bSOgoDV"}],"key":"nNxNxvOPOP"},{"type":"tabItem","title":"Python","sync":"python","children":[{"type":"embed","source":{"url":"/chapter2-2","label":"demo-pivoting-builtin-python","kind":"Notebook","slug":"chapter2-2","location":"/python/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Built-in P","key":"aAQKxzgVI4"},{"type":"abbreviation","title":"lower triangular times upper triangular","children":[{"type":"text","value":"LU","key":"Ap1sYcZhN4"}],"key":"wqYetxWIPg"},{"type":"text","value":" factorization","key":"YL9Sh9xaQu"}],"key":"WiamfiPgSR"},{"type":"paragraph","position":{"start":{"line":931,"column":1},"end":{"line":931,"column":1}},"children":[{"type":"text","value":"In ","position":{"start":{"line":931,"column":1},"end":{"line":931,"column":1}},"key":"SVkZzkAw4t"},{"type":"inlineCode","value":"linalg.solve","position":{"start":{"line":931,"column":1},"end":{"line":931,"column":1}},"key":"VWBDnkGMb5"},{"type":"text","value":", the matrix ","position":{"start":{"line":931,"column":1},"end":{"line":931,"column":1}},"key":"LaAbXOIx6Z"},{"type":"inlineCode","value":"A","position":{"start":{"line":931,"column":1},"end":{"line":931,"column":1}},"key":"eQDxmVHdHw"},{"type":"text","value":" is P","key":"QDDW1STO86"},{"type":"abbreviation","title":"lower triangular times upper triangular","children":[{"type":"text","value":"LU","key":"QxuqobaO2h"}],"key":"lAnAZlZggK"},{"type":"text","value":"-factored, followed by two triangular solves. If we want to do those steps seamlessly, we can use the ","key":"UlKsmVHoO0"},{"type":"inlineCode","value":"lu_factor","position":{"start":{"line":931,"column":1},"end":{"line":931,"column":1}},"key":"Z2bKEECkxu"},{"type":"text","value":" and ","position":{"start":{"line":931,"column":1},"end":{"line":931,"column":1}},"key":"mXDTgMxMzR"},{"type":"inlineCode","value":"lu_solve","position":{"start":{"line":931,"column":1},"end":{"line":931,"column":1}},"key":"D8asb4TB64"},{"type":"text","value":" from ","position":{"start":{"line":931,"column":1},"end":{"line":931,"column":1}},"key":"euFLswp2V9"},{"type":"inlineCode","value":"scipy.linalg","position":{"start":{"line":931,"column":1},"end":{"line":931,"column":1}},"key":"Mm2jhetAD7"},{"type":"text","value":".","position":{"start":{"line":931,"column":1},"end":{"line":931,"column":1}},"key":"mlZBq5p5qu"}],"key":"DsWFwzXPdE"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from scipy.linalg import lu_factor, lu_solve\nA = random.randn(500, 500) \nb = ones(500)  \nLU, perm = lu_factor(A)\nx = lu_solve((LU, perm), b)","key":"qAiK2dPSEx"},{"type":"output","id":"wcRMTNIFa6xZRxjPGm1a4","data":[],"key":"fuaLjxJtOv"}],"data":{},"key":"V7QfWZriOU"},{"type":"paragraph","position":{"start":{"line":941,"column":1},"end":{"line":941,"column":1}},"children":[{"type":"text","value":"Why would we ever bother with this? In ","position":{"start":{"line":941,"column":1},"end":{"line":941,"column":1}},"key":"R95SqSHKmh"},{"type":"link","kind":"numref","url":"/efficiency","internal":true,"dataUrl":"/efficiency.json","children":[{"type":"text","value":"Efficiency of matrix computations","key":"NPPMVID9hc"}],"key":"ywYIzYYVCF"},{"type":"text","value":" we showed that the factorization is by far the most costly part of the solution process. A factorization object allows us to do that costly step only once per matrix, but solve with multiple right-hand sides.","position":{"start":{"line":941,"column":1},"end":{"line":941,"column":1}},"key":"LK6XVdeVp9"}],"key":"o9F6nHIqvV"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"start = timer()\nfor k in range(50): linalg.solve(A, random.rand(500))\nprint(f\"elapsed time for 50 full solves: {timer() - start}\")\n\nstart = timer()\nLU, perm = lu_factor(A)\nfor k in range(50): lu_solve((LU, perm), random.rand(500))\nprint(f\"elapsed time for 50 shortcut solves: {timer() - start}\")","key":"y7NzzpUkb9"},{"type":"output","id":"rc92o5kzDqt4HV8Gj11hp","data":[{"output_type":"stream","name":"stdout","text":"elapsed time for 50 full solves: 0.08334108398412354\nelapsed time for 50 shortcut solves: 0.00667974998941645\n"}],"key":"pRNv0HVYya"}],"data":{},"key":"WkngwDgA1I"}],"key":"FFQ1BzkrKi"}],"key":"TrH3sEpWsn"}],"key":"y4bOFqn6bM"}],"key":"sA5THPZtfp"}],"label":"demo-pivoting-builtin","identifier":"demo-pivoting-builtin","html_id":"demo-pivoting-builtin","enumerator":"2.6.4","key":"a0oQv2YcEG"},{"type":"heading","depth":2,"position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"children":[{"type":"text","value":"Stability","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"key":"wDor5LQQcz"}],"identifier":"stability","label":"Stability","html_id":"stability","implicit":true,"enumerator":"2.6.4","key":"d3K1YONocs"},{"type":"paragraph","position":{"start":{"line":186,"column":1},"end":{"line":186,"column":1}},"children":[{"type":"text","value":"There is one detail of the row pivoting algorithm that might seem arbitrary: why choose the pivot of largest magnitude in a column, rather than, say, the uppermost nonzero in the column? The answer is numerical stability.","position":{"start":{"line":186,"column":1},"end":{"line":186,"column":1}},"key":"JTfmlkl71r"}],"indexEntries":[{"entry":"stability","emphasis":false}],"label":"index-hpc3ls9uPM","identifier":"index-hpc3ls9upm","html_id":"index-hpc3ls9upm","key":"PKguv4dYfI"},{"type":"proof","kind":"example","enumerated":true,"children":[{"type":"paragraph","position":{"start":{"line":190,"column":1},"end":{"line":190,"column":1}},"children":[{"type":"text","value":"Let","position":{"start":{"line":190,"column":1},"end":{"line":190,"column":1}},"key":"iSFWWDGnYq"}],"key":"sjHqGkYYpX"},{"type":"math","value":"\\mathbf{A} =\n  \\begin{bmatrix}\n    -\\epsilon & 1 \\\\ 1 & -1\n  \\end{bmatrix}.","label":"plu-stab-A","identifier":"plu-stab-a","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi mathvariant=\"bold\">A</mi><mo>=</mo><mrow><mo fence=\"true\">[</mo><mtable rowspacing=\"0.16em\" columnalign=\"center center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mi>ϵ</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mn>1</mn></mrow></mstyle></mtd></mtr></mtable><mo fence=\"true\">]</mo></mrow><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A} =\n  \\begin{bmatrix}\n    -\\epsilon &amp; 1 \\\\ 1 &amp; -1\n  \\end{bmatrix}.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.4em;vertical-align:-0.95em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">[</span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord mathnormal\">ϵ</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.95em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.95em;\"><span></span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">]</span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">.</span></span></span></span></span>","enumerator":"2.6.2","html_id":"plu-stab-a","key":"E9lbGxKiml"},{"type":"paragraph","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"children":[{"type":"text","value":"If ","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"key":"pP7YUHd1pv"},{"type":"inlineMath","value":"\\epsilon=0","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ϵ</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">\\epsilon=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">ϵ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"CbB2WkS9Km"},{"type":"text","value":", ","key":"T3PaykYW3D"},{"type":"abbreviation","title":"lower triangular times upper triangular","children":[{"type":"text","value":"LU","key":"HFXQzHN0Xu"}],"key":"UAkCmMZsDT"},{"type":"text","value":" factorization without pivoting fails for ","key":"EgbL7Vh7SX"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"udQ9MmbWkN"},{"type":"text","value":". But if ","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"key":"ASowRj1rRd"},{"type":"inlineMath","value":"\\epsilon\\neq 0","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ϵ</mi><mo mathvariant=\"normal\">≠</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">\\epsilon\\neq 0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">ϵ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\"><span class=\"mrel\"><span class=\"mord vbox\"><span class=\"thinbox\"><span class=\"rlap\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"inner\"><span class=\"mord\"><span class=\"mrel\"></span></span></span><span class=\"fix\"></span></span></span></span></span><span class=\"mrel\">=</span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"qQl9nAa9gM"},{"type":"text","value":", we can go without pivoting, at least in principle.","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"key":"i1LRW9Q5kk"}],"key":"OLa9BgcaTS"},{"type":"tabSet","children":[{"type":"tabItem","title":"Julia","sync":"julia","children":[{"type":"embed","source":{"url":"/chapter2","label":"demo-pivoting-stable-julia","kind":"Notebook","slug":"chapter2","location":"/julia/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Stability of P","key":"PJbDM2p56f"},{"type":"abbreviation","title":"lower triangular times upper triangular","children":[{"type":"text","value":"LU","key":"NZas3NM06O"}],"key":"XPoDv89m6G"},{"type":"text","value":" factorization","key":"whdrxYAHsa"}],"key":"ObKEBIUTqG"},{"type":"paragraph","position":{"start":{"line":1010,"column":1},"end":{"line":1010,"column":1}},"children":[{"type":"text","value":"We construct a linear system for this matrix with ","position":{"start":{"line":1010,"column":1},"end":{"line":1010,"column":1}},"key":"hXQVIZxvob"},{"type":"inlineMath","value":"\\epsilon=10^{-12}","position":{"start":{"line":1010,"column":1},"end":{"line":1010,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ϵ</mi><mo>=</mo><mn>1</mn><msup><mn>0</mn><mrow><mo>−</mo><mn>12</mn></mrow></msup></mrow><annotation encoding=\"application/x-tex\">\\epsilon=10^{-12}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">ϵ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">12</span></span></span></span></span></span></span></span></span></span></span></span>","key":"EohYVhTig2"},{"type":"text","value":" and exact solution ","position":{"start":{"line":1010,"column":1},"end":{"line":1010,"column":1}},"key":"C9ItyhU0gD"},{"type":"inlineMath","value":"[1,1]","position":{"start":{"line":1010,"column":1},"end":{"line":1010,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[1,1]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]</span></span></span></span>","key":"LDVW9UHl3y"},{"type":"text","value":":","position":{"start":{"line":1010,"column":1},"end":{"line":1010,"column":1}},"key":"bA3QdDXjdx"}],"key":"CFTDqkKgSn"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"ϵ = 1e-12\nA = [-ϵ 1; 1 -1]\nb = A * [1, 1]","key":"smCrncZVzK"},{"type":"output","id":"VaCFUoM7QB0wAu8EdORLQ","data":[{"output_type":"execute_result","execution_count":99,"metadata":{},"data":{"text/plain":{"content":"2-element Vector{Float64}:\n 0.999999999999\n 0.0","content_type":"text/plain"}}}],"key":"oDluUYxoEB"}],"data":{},"key":"bcaH7CDPlx"},{"type":"paragraph","position":{"start":{"line":1018,"column":1},"end":{"line":1018,"column":1}},"children":[{"type":"text","value":"We can factor the matrix without pivoting and solve for ","position":{"start":{"line":1018,"column":1},"end":{"line":1018,"column":1}},"key":"wDeqZSOGuj"},{"type":"inlineMath","value":"\\mathbf{x}","position":{"start":{"line":1018,"column":1},"end":{"line":1018,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">x</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{x}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4444em;\"></span><span class=\"mord mathbf\">x</span></span></span></span>","key":"RBUAlwJvbc"},{"type":"text","value":".","position":{"start":{"line":1018,"column":1},"end":{"line":1018,"column":1}},"key":"uragpwsH24"}],"key":"MtRwRuru3s"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"L, U = FNC.lufact(A)\nx = FNC.backsub( U, FNC.forwardsub(L, b) )","key":"zXXX8Pqdv8"},{"type":"output","id":"na634M1y9mV1TP1vrZM9P","data":[{"output_type":"execute_result","execution_count":100,"metadata":{},"data":{"text/plain":{"content":"2-element Vector{Float64}:\n 0.9999778782798785\n 1.0","content_type":"text/plain"}}}],"key":"feJAJqxKB0"}],"data":{},"key":"BOnTnRTw6b"},{"type":"paragraph","position":{"start":{"line":1025,"column":1},"end":{"line":1025,"column":1}},"children":[{"type":"text","value":"Note that we have obtained only about 5 accurate digits for ","position":{"start":{"line":1025,"column":1},"end":{"line":1025,"column":1}},"key":"SxhsMRFDS9"},{"type":"inlineMath","value":"x_1","position":{"start":{"line":1025,"column":1},"end":{"line":1025,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">x_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"DHQQcbof1F"},{"type":"text","value":". We could make the result even more inaccurate by making ","position":{"start":{"line":1025,"column":1},"end":{"line":1025,"column":1}},"key":"FvWfZIaqxt"},{"type":"text","value":"ε","position":{"start":{"line":1025,"column":1},"end":{"line":1025,"column":1}},"key":"E8jZOw8f2I"},{"type":"text","value":" even smaller:","position":{"start":{"line":1025,"column":1},"end":{"line":1025,"column":1}},"key":"nyH5a3w3Py"}],"key":"hC27oGilF2"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"ϵ = 1e-20; A = [-ϵ 1; 1 -1]\nb = A * [1, 1]\nL, U = FNC.lufact(A)\nx = FNC.backsub( U, FNC.forwardsub(L, b) )","key":"yUulGDeZJ5"},{"type":"output","id":"SSBO_wWlKeR2SX4h5oYdu","data":[{"output_type":"execute_result","execution_count":101,"metadata":{},"data":{"text/plain":{"content":"2-element Vector{Float64}:\n -0.0\n  1.0","content_type":"text/plain"}}}],"key":"bI25yvd4JP"}],"data":{},"key":"Iq2HQarorT"},{"type":"paragraph","position":{"start":{"line":1034,"column":1},"end":{"line":1034,"column":1}},"children":[{"type":"text","value":"This effect is not due to ill conditioning of the problem—a solution with P","key":"jwZUtWDwiT"},{"type":"abbreviation","title":"lower triangular times upper triangular","children":[{"type":"text","value":"LU","key":"Yj22X3EnZU"}],"key":"btvNsJR3sh"},{"type":"text","value":" factorization works perfectly:","key":"sWzignhAsq"}],"key":"YtHARcPKUm"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"A \\ b","key":"MPb3c3wGmA"},{"type":"output","id":"mXahkhaBEnVzBh3TPpGXx","data":[{"output_type":"execute_result","execution_count":102,"metadata":{},"data":{"text/plain":{"content":"2-element Vector{Float64}:\n 1.0\n 1.0","content_type":"text/plain"}}}],"key":"IzkK3ZjcnE"}],"data":{},"key":"Ne7hKVyfAI"}],"key":"IMmJY6n6KC"}],"key":"d1BmAL4QnL"}],"key":"Xl3LLg9l7I"},{"type":"tabItem","title":"MATLAB","sync":"matlab","children":[{"type":"embed","source":{"url":"/chapter2-1","label":"demo-pivoting-stable-matlab","kind":"Notebook","slug":"chapter2-1","location":"/matlab/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Stability of P","key":"ptXg9XI3Vu"},{"type":"abbreviation","title":"lower triangular times upper triangular","children":[{"type":"text","value":"LU","key":"M2r4ibqu2o"}],"key":"T5A0CRSM2R"},{"type":"text","value":" factorization","key":"MJh1QqdKBw"}],"key":"ymUbKjzUP2"},{"type":"paragraph","position":{"start":{"line":961,"column":1},"end":{"line":961,"column":1}},"children":[{"type":"text","value":"We construct a linear system for this matrix with ","position":{"start":{"line":961,"column":1},"end":{"line":961,"column":1}},"key":"VayjTUEJIK"},{"type":"inlineMath","value":"\\epsilon=10^{-12}","position":{"start":{"line":961,"column":1},"end":{"line":961,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ϵ</mi><mo>=</mo><mn>1</mn><msup><mn>0</mn><mrow><mo>−</mo><mn>12</mn></mrow></msup></mrow><annotation encoding=\"application/x-tex\">\\epsilon=10^{-12}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">ϵ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">12</span></span></span></span></span></span></span></span></span></span></span></span>","key":"JVf3NemGGu"},{"type":"text","value":" and exact solution ","position":{"start":{"line":961,"column":1},"end":{"line":961,"column":1}},"key":"UGXCdcxxFl"},{"type":"inlineMath","value":"[1, 1]","position":{"start":{"line":961,"column":1},"end":{"line":961,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[1, 1]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]</span></span></span></span>","key":"Dqm3hCjrVm"},{"type":"text","value":":","position":{"start":{"line":961,"column":1},"end":{"line":961,"column":1}},"key":"Ix8hObt7aO"}],"key":"KXciqvzLaX"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"ep = 1e-12\nA = [-ep 1; 1 -1];\nb = A * [1; 1];","key":"X236g8l1Ij"},{"type":"output","id":"oF9CtYXaCCp9FLkFfplDO","data":[{"output_type":"execute_result","execution_count":97,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ep = 1.0000e-12</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ep = 1.0000e-12","content_type":"text/plain"}}}],"key":"Uq19aTqL2y"}],"data":{},"key":"wpVJ1Wwdyy"},{"type":"paragraph","position":{"start":{"line":969,"column":1},"end":{"line":969,"column":1}},"children":[{"type":"text","value":"We can factor the matrix without pivoting and solve for ","position":{"start":{"line":969,"column":1},"end":{"line":969,"column":1}},"key":"AYgYqxxytr"},{"type":"inlineMath","value":"\\mathbf{x}","position":{"start":{"line":969,"column":1},"end":{"line":969,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">x</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{x}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4444em;\"></span><span class=\"mord mathbf\">x</span></span></span></span>","key":"tTe0JCYv7x"},{"type":"text","value":".","position":{"start":{"line":969,"column":1},"end":{"line":969,"column":1}},"key":"LMtGhxSBPW"}],"key":"twhGBjARSR"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[L, U] = lufact(A);\nx = backsub( U, forwardsub(L, b) )","key":"DdyAouQ6Zz"},{"type":"output","id":"Ajtn1CCl0bq9kQ-75eF4W","data":[{"output_type":"execute_result","execution_count":98,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>x = 2×1 double\n    1.0000\n    1.0000\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"x = 2×1 double\n    1.0000\n    1.0000\n","content_type":"text/plain"}}}],"key":"EiH3p7OoER"}],"data":{},"key":"E5PeznqHnG"},{"type":"paragraph","position":{"start":{"line":976,"column":1},"end":{"line":976,"column":1}},"children":[{"type":"text","value":"Note that we have obtained only about 5 accurate digits for ","position":{"start":{"line":976,"column":1},"end":{"line":976,"column":1}},"key":"sovNljYcGo"},{"type":"inlineMath","value":"x_1","position":{"start":{"line":976,"column":1},"end":{"line":976,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">x_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"BCufSB9njL"},{"type":"text","value":". We could make the result even more inaccurate by making ","position":{"start":{"line":976,"column":1},"end":{"line":976,"column":1}},"key":"n84SmdATFA"},{"type":"text","value":"ε","position":{"start":{"line":976,"column":1},"end":{"line":976,"column":1}},"key":"OO5cSlOY5J"},{"type":"text","value":" even smaller:","position":{"start":{"line":976,"column":1},"end":{"line":976,"column":1}},"key":"TGOjAgiygz"}],"key":"WhwBKgZmzI"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"ep = 1e-20; A = [-ep 1; 1 -1];\nb = A * [1; 1];\n[L, U] = lufact(A);\nx = backsub( U, forwardsub(L, b) )","key":"wU5DhdEaIE"},{"type":"output","id":"YkQxhqOk5DdIsjVLf9zCN","data":[{"output_type":"execute_result","execution_count":99,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>x = 2×1 double\n     0\n     1\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"x = 2×1 double\n     0\n     1\n","content_type":"text/plain"}}}],"key":"JVoFotuChu"}],"data":{},"key":"anj6dQgoES"},{"type":"paragraph","position":{"start":{"line":985,"column":1},"end":{"line":985,"column":1}},"children":[{"type":"text","value":"This effect is not due to ill conditioning of the problem—a solution with P","key":"PECEHBeDL7"},{"type":"abbreviation","title":"lower triangular times upper triangular","children":[{"type":"text","value":"LU","key":"iPGujxr8tv"}],"key":"zhsv1RBVOM"},{"type":"text","value":" factorization works perfectly:","key":"eyj1yTEhJX"}],"key":"PIdnfHVtMc"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A \\ b","key":"p6by9Jrmrq"},{"type":"output","id":"jj8LcAS-ihIcXWePB7c55","data":[{"output_type":"execute_result","execution_count":100,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = 2×1 double\n     1\n     1\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = 2×1 double\n     1\n     1\n","content_type":"text/plain"}}}],"key":"bmAhdAM5tt"}],"data":{},"key":"RJn3VAIrqI"}],"key":"iJuJsnNmcB"}],"key":"I6d8ijg9G5"}],"key":"OLP1SbrNpE"},{"type":"tabItem","title":"Python","sync":"python","children":[{"type":"embed","source":{"url":"/chapter2-2","label":"demo-pivoting-stable-python","kind":"Notebook","slug":"chapter2-2","location":"/python/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Stability of P","key":"EAbrX7cD2G"},{"type":"abbreviation","title":"lower triangular times upper triangular","children":[{"type":"text","value":"LU","key":"vd5pcuQiLo"}],"key":"TpDTVE6gq4"},{"type":"text","value":" factorization","key":"sq5UEBwO2g"}],"key":"MrWSmk80G1"},{"type":"paragraph","position":{"start":{"line":957,"column":1},"end":{"line":957,"column":1}},"children":[{"type":"text","value":"We construct a linear system for this matrix with ","position":{"start":{"line":957,"column":1},"end":{"line":957,"column":1}},"key":"hh4dU0xWfw"},{"type":"inlineMath","value":"\\epsilon=10^{-12}","position":{"start":{"line":957,"column":1},"end":{"line":957,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ϵ</mi><mo>=</mo><mn>1</mn><msup><mn>0</mn><mrow><mo>−</mo><mn>12</mn></mrow></msup></mrow><annotation encoding=\"application/x-tex\">\\epsilon=10^{-12}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">ϵ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">12</span></span></span></span></span></span></span></span></span></span></span></span>","key":"ZVtzY1CgGc"},{"type":"text","value":" and exact solution ","position":{"start":{"line":957,"column":1},"end":{"line":957,"column":1}},"key":"IaxUfJRFdp"},{"type":"inlineMath","value":"[1,1]","position":{"start":{"line":957,"column":1},"end":{"line":957,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[1,1]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]</span></span></span></span>","key":"oguHdFtSPS"},{"type":"text","value":":","position":{"start":{"line":957,"column":1},"end":{"line":957,"column":1}},"key":"EkfW54uB0H"}],"key":"yhEsc0nAr2"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ep = 1e-12\nA = array([[-ep, 1], [1, -1]])\nb = A @ array([1, 1])","key":"YOSYTHtvUN"},{"type":"output","id":"DkUpR_a2xIViaz052vV_s","data":[],"key":"rZCRvEWIMb"}],"data":{},"key":"e2p8Qpyfd3"},{"type":"paragraph","position":{"start":{"line":965,"column":1},"end":{"line":965,"column":1}},"children":[{"type":"text","value":"We can factor the matrix without pivoting and solve for ","position":{"start":{"line":965,"column":1},"end":{"line":965,"column":1}},"key":"ZUZ1buByQ9"},{"type":"inlineMath","value":"\\mathbf{x}","position":{"start":{"line":965,"column":1},"end":{"line":965,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">x</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{x}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4444em;\"></span><span class=\"mord mathbf\">x</span></span></span></span>","key":"hTtZvgSsxH"},{"type":"text","value":".","position":{"start":{"line":965,"column":1},"end":{"line":965,"column":1}},"key":"UjR6sZ2Egb"}],"key":"n3ZAGVHCvK"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"L, U = FNC.lufact(A)\nprint(FNC.backsub( U, FNC.forwardsub(L, b) ))","key":"cxjYlrbVzg"},{"type":"output","id":"REeoPjeBPGyHKgnAgYmBk","data":[{"output_type":"stream","name":"stdout","text":"[0.99997788 1.        ]\n"}],"key":"ok2kjdovHQ"}],"data":{},"key":"UAISnvEfQ6"},{"type":"paragraph","position":{"start":{"line":972,"column":1},"end":{"line":972,"column":1}},"children":[{"type":"text","value":"Note that we have obtained only about 5 accurate digits for ","position":{"start":{"line":972,"column":1},"end":{"line":972,"column":1}},"key":"mc3L43hfMd"},{"type":"inlineMath","value":"x_1","position":{"start":{"line":972,"column":1},"end":{"line":972,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">x_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"tP2pomSd53"},{"type":"text","value":". We could make the result even more inaccurate by making ","position":{"start":{"line":972,"column":1},"end":{"line":972,"column":1}},"key":"pw9SWNHFD3"},{"type":"text","value":"ε","position":{"start":{"line":972,"column":1},"end":{"line":972,"column":1}},"key":"YwNZf235kM"},{"type":"text","value":" even smaller:","position":{"start":{"line":972,"column":1},"end":{"line":972,"column":1}},"key":"S8qzVw6McC"}],"key":"pXnedWaaY8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ep = 1e-20;\nA = array([[-ep, 1], [1, -1]])\nb = A @ array([1, 1])\nL, U = FNC.lufact(A)\nprint(FNC.backsub( U, FNC.forwardsub(L, b) ))","key":"nktmc14kLy"},{"type":"output","id":"mE3aHcnyFx2dpmtvsgsGZ","data":[{"output_type":"stream","name":"stdout","text":"[-0.  1.]\n"}],"key":"bLrDJauhGg"}],"data":{},"key":"FoyYlIfifW"},{"type":"paragraph","position":{"start":{"line":982,"column":1},"end":{"line":982,"column":1}},"children":[{"type":"text","value":"This effect is not due to ill conditioning of the problem—a solution with P","key":"cJgk5cfJ05"},{"type":"abbreviation","title":"lower triangular times upper triangular","children":[{"type":"text","value":"LU","key":"UP8OYfopI2"}],"key":"Kzvga9mJwm"},{"type":"text","value":" factorization works perfectly:","key":"Mrq44Qt4jN"}],"key":"dhsVf2q0bC"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(solve(A, b))","key":"io5pIMD5b6"},{"type":"output","id":"R0ry3966T-n2VAQtDYJPT","data":[{"output_type":"stream","name":"stdout","text":"[1. 1.]\n"}],"key":"fZrnavUnwz"}],"data":{},"key":"pfQAA7xSiT"}],"key":"xd6UbHLGtZ"}],"key":"LhMOiQGYl3"}],"key":"RGs8NAfVD3"}],"key":"Cz6ULt9d9Y"}],"label":"demo-pivoting-stable","identifier":"demo-pivoting-stable","html_id":"demo-pivoting-stable","enumerator":"2.6.5","key":"LqjnlJA0xC"},{"type":"paragraph","position":{"start":{"line":223,"column":1},"end":{"line":223,"column":1}},"children":[{"type":"text","value":"The factors of this ","position":{"start":{"line":223,"column":1},"end":{"line":223,"column":1}},"key":"D7hMliTt38"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":223,"column":1},"end":{"line":223,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"fP5KYAIBRy"},{"type":"text","value":" without pivoting are found to be","position":{"start":{"line":223,"column":1},"end":{"line":223,"column":1}},"key":"gGzaFHTRGg"}],"key":"xjkrO3diyY"},{"type":"math","value":"  \\mathbf{L} = \n  \\begin{bmatrix}\n    1 & 0 \\\\ -\\epsilon^{-1} & 1 \n  \\end{bmatrix}, \\qquad \n  \\mathbf{U} = \n  \\begin{bmatrix}\n    -\\epsilon & 1 \\\\ 0 & \\epsilon^{-1}-1 \n  \\end{bmatrix}.","label":"plu-stab-LU","identifier":"plu-stab-lu","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi mathvariant=\"bold\">L</mi><mo>=</mo><mrow><mo fence=\"true\">[</mo><mtable rowspacing=\"0.16em\" columnalign=\"center center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>0</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><msup><mi>ϵ</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd></mtr></mtable><mo fence=\"true\">]</mo></mrow><mo separator=\"true\">,</mo><mspace width=\"2em\"/><mi mathvariant=\"bold\">U</mi><mo>=</mo><mrow><mo fence=\"true\">[</mo><mtable rowspacing=\"0.16em\" columnalign=\"center center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mi>ϵ</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><msup><mi>ϵ</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo>−</mo><mn>1</mn></mrow></mstyle></mtd></mtr></mtable><mo fence=\"true\">]</mo></mrow><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">  \\mathbf{L} = \n  \\begin{bmatrix}\n    1 &amp; 0 \\\\ -\\epsilon^{-1} &amp; 1 \n  \\end{bmatrix}, \\qquad \n  \\mathbf{U} = \n  \\begin{bmatrix}\n    -\\epsilon &amp; 1 \\\\ 0 &amp; \\epsilon^{-1}-1 \n  \\end{bmatrix}.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">L</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.4em;vertical-align:-0.95em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">[</span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord\"><span class=\"mord mathnormal\">ϵ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.95em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">0</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.95em;\"><span></span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">]</span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:2em;\"></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathbf\">U</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.4em;vertical-align:-0.95em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">[</span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord mathnormal\">ϵ</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.95em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">ϵ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.95em;\"><span></span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">]</span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">.</span></span></span></span></span>","enumerator":"2.6.3","html_id":"plu-stab-lu","key":"pIiEledM4Z"},{"type":"paragraph","position":{"start":{"line":237,"column":1},"end":{"line":237,"column":1}},"children":[{"type":"text","value":"For reasons we will quantify in ","position":{"start":{"line":237,"column":1},"end":{"line":237,"column":1}},"key":"XXZPCp70TH"},{"type":"link","kind":"numref","identifier":"section-linsys-condition-number","label":"section-linsys-condition-number","url":"/condition-number","internal":true,"dataUrl":"/condition-number.json","children":[{"type":"text","value":"Conditioning of linear systems","key":"cJvTfTjQkF"}],"key":"QVvD1t0XBK"},{"type":"text","value":", the solution of ","position":{"start":{"line":237,"column":1},"end":{"line":237,"column":1}},"key":"ZX9121zbJg"},{"type":"inlineMath","value":"\\mathbf{A}\\mathbf{x}=\\mathbf{b}","position":{"start":{"line":237,"column":1},"end":{"line":237,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi><mi mathvariant=\"bold\">x</mi><mo>=</mo><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}\\mathbf{x}=\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">Ax</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"hrdYgbc34b"},{"type":"text","value":" is well-conditioned, but the problems of solving ","position":{"start":{"line":237,"column":1},"end":{"line":237,"column":1}},"key":"eWyDsS2WLv"},{"type":"inlineMath","value":"\\mathbf{L}\\mathbf{z}=\\mathbf{b}","position":{"start":{"line":237,"column":1},"end":{"line":237,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi><mi mathvariant=\"bold\">z</mi><mo>=</mo><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}\\mathbf{z}=\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">Lz</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"WrLKiCrXD5"},{"type":"text","value":" and ","position":{"start":{"line":237,"column":1},"end":{"line":237,"column":1}},"key":"BO9IFk4bBQ"},{"type":"inlineMath","value":"\\mathbf{U}\\mathbf{x}=\\mathbf{z}","position":{"start":{"line":237,"column":1},"end":{"line":237,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi><mi mathvariant=\"bold\">x</mi><mo>=</mo><mi mathvariant=\"bold\">z</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}\\mathbf{x}=\\mathbf{z}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">Ux</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4444em;\"></span><span class=\"mord mathbf\">z</span></span></span></span>","key":"xZN8EJpA0l"},{"type":"text","value":" have condition numbers essentially ","position":{"start":{"line":237,"column":1},"end":{"line":237,"column":1}},"key":"UDs9STRKTO"},{"type":"inlineMath","value":"1/\\epsilon^2","position":{"start":{"line":237,"column":1},"end":{"line":237,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mi mathvariant=\"normal\">/</mi><msup><mi>ϵ</mi><mn>2</mn></msup></mrow><annotation encoding=\"application/x-tex\">1/\\epsilon^2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord\">1/</span><span class=\"mord\"><span class=\"mord mathnormal\">ϵ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span>","key":"wBXHSP54QR"},{"type":"text","value":" each. Thus, for small ","position":{"start":{"line":237,"column":1},"end":{"line":237,"column":1}},"key":"eqWoV1lfuK"},{"type":"text","value":"ε","position":{"start":{"line":237,"column":1},"end":{"line":237,"column":1}},"key":"zOUUa3uP8L"},{"type":"text","value":", solution of the original linear system by unpivoted ","key":"qix4vnJ5EV"},{"type":"abbreviation","title":"lower triangular times upper triangular","children":[{"type":"text","value":"LU","key":"JtT7OXyZpl"}],"key":"BQvSLa1azJ"},{"type":"text","value":" factorization is highly unstable.","key":"SLjSTolLPu"}],"key":"C2Z0kZI4Gw"},{"type":"paragraph","position":{"start":{"line":239,"column":1},"end":{"line":239,"column":1}},"children":[{"type":"text","value":"Somewhat surprisingly, solving ","position":{"start":{"line":239,"column":1},"end":{"line":239,"column":1}},"key":"xRQAPjv4Z6"},{"type":"inlineMath","value":"\\mathbf{A}\\mathbf{x}=\\mathbf{b}","position":{"start":{"line":239,"column":1},"end":{"line":239,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi><mi mathvariant=\"bold\">x</mi><mo>=</mo><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}\\mathbf{x}=\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">Ax</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"GKX7QxeAeq"},{"type":"text","value":" via P","key":"wjCia1c1IV"},{"type":"abbreviation","title":"lower triangular times upper triangular","children":[{"type":"text","value":"LU","key":"haOEGbDKzI"}],"key":"J9wFapKEPV"},{"type":"text","value":" factorization is technically also unstable. In fact, examples of unstable solutions are well-known, but they have been nonexistent in practice. While there is a lot of evidence and some reasoning about why this is the case, the situation is not completely understood. Yet P","key":"rJlua5h1SE"},{"type":"abbreviation","title":"lower triangular times upper triangular","children":[{"type":"text","value":"LU","key":"PdPYqTI51n"}],"key":"tP9PLBnAsJ"},{"type":"text","value":" factorization remains the algorithm of choice for general linear systems.","key":"LE3YyJ7P25"}],"key":"ss4MoiWqqG"},{"type":"heading","depth":2,"position":{"start":{"line":241,"column":1},"end":{"line":241,"column":1}},"children":[{"type":"text","value":"Exercises","position":{"start":{"line":241,"column":1},"end":{"line":241,"column":1}},"key":"aD6ZbZgh61"}],"identifier":"exercises","label":"Exercises","html_id":"exercises","implicit":true,"enumerator":"2.6.5","key":"XJ7LlZJsrE"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":243,"column":1},"end":{"line":291,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":243,"column":1},"end":{"line":256,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":243,"column":1},"end":{"line":243,"column":1}},"children":[{"type":"text","value":"✍ Perform by hand the pivoted ","key":"G7GiZCAzUg"},{"type":"abbreviation","title":"lower triangular times upper triangular","children":[{"type":"text","value":"LU","key":"wtitF3obae"}],"key":"bYJa3hO3Jx"},{"type":"text","value":" factorization of each matrix.","key":"Euxp6qQmel"}],"key":"qsCwVtd4Ak"},{"type":"paragraph","position":{"start":{"line":245,"column":1},"end":{"line":255,"column":1}},"children":[{"type":"strong","position":{"start":{"line":245,"column":1},"end":{"line":245,"column":1}},"children":[{"type":"text","value":"(a)","position":{"start":{"line":245,"column":1},"end":{"line":245,"column":1}},"key":"hLLlyGJBZe"}],"key":"XUg1A3x4PG"},{"type":"text","value":" ","position":{"start":{"line":245,"column":1},"end":{"line":245,"column":1}},"key":"gSLSLtRfkf"},{"type":"inlineMath","value":"\\quad \\displaystyle \\begin{bmatrix}\n 2 & 3 & 4 \\\\\n 4 & 5 & 10 \\\\\n 4 & 8 & 2\n \\end{bmatrix},\\qquad","position":{"start":{"line":245,"column":1},"end":{"line":245,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mspace width=\"1em\"/><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mo fence=\"true\">[</mo><mtable rowspacing=\"0.16em\" columnalign=\"center center center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>2</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>3</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>4</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>4</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>5</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>10</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>4</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>8</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>2</mn></mstyle></mtd></mtr></mtable><mo fence=\"true\">]</mo></mrow><mo separator=\"true\">,</mo><mspace width=\"2em\"/></mstyle></mrow><annotation encoding=\"application/x-tex\">\\quad \\displaystyle \\begin{bmatrix}\n 2 &amp; 3 &amp; 4 \\\\\n 4 &amp; 5 &amp; 10 \\\\\n 4 &amp; 8 &amp; 2\n \\end{bmatrix},\\qquad</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:3.6em;vertical-align:-1.55em;\"></span><span class=\"mspace\" style=\"margin-right:1em;\"></span><span class=\"minner\"><span class=\"mopen\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.05em;\"><span style=\"top:-2.25em;\"><span class=\"pstrut\" style=\"height:3.155em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎣</span></span></span><span style=\"top:-3.397em;\"><span class=\"pstrut\" style=\"height:3.155em;\"></span><span style=\"height:0.016em;width:0.6667em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.6667em' height='0.016em' style='width:0.6667em' viewBox='0 0 666.67 16' preserveAspectRatio='xMinYMin'><path d='M319 0 H403 V16 H319z M319 0 H403 V16 H319z'/></svg></span></span><span style=\"top:-4.05em;\"><span class=\"pstrut\" style=\"height:3.155em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎡</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.55em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.05em;\"><span style=\"top:-4.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">2</span></span></span><span style=\"top:-3.01em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">4</span></span></span><span style=\"top:-1.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">4</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.55em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.05em;\"><span style=\"top:-4.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">3</span></span></span><span style=\"top:-3.01em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">5</span></span></span><span style=\"top:-1.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">8</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.55em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.05em;\"><span style=\"top:-4.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">4</span></span></span><span style=\"top:-3.01em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">10</span></span></span><span style=\"top:-1.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.55em;\"><span></span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.05em;\"><span style=\"top:-2.25em;\"><span class=\"pstrut\" style=\"height:3.155em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎦</span></span></span><span style=\"top:-3.397em;\"><span class=\"pstrut\" style=\"height:3.155em;\"></span><span style=\"height:0.016em;width:0.6667em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.6667em' height='0.016em' style='width:0.6667em' viewBox='0 0 666.67 16' preserveAspectRatio='xMinYMin'><path d='M263 0 H347 V16 H263z M263 0 H347 V16 H263z'/></svg></span></span><span style=\"top:-4.05em;\"><span class=\"pstrut\" style=\"height:3.155em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎤</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.55em;\"><span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:2em;\"></span></span></span></span>","key":"pkWJ2BahkK"},{"type":"text","value":"\n","position":{"start":{"line":245,"column":1},"end":{"line":245,"column":1}},"key":"ky5jgcbv3G"},{"type":"strong","position":{"start":{"line":245,"column":1},"end":{"line":245,"column":1}},"children":[{"type":"text","value":"(b)","position":{"start":{"line":245,"column":1},"end":{"line":245,"column":1}},"key":"ReOsjTMnLK"}],"key":"D3U605xroQ"},{"type":"text","value":" ","position":{"start":{"line":245,"column":1},"end":{"line":245,"column":1}},"key":"EIotJ8qlvJ"},{"type":"inlineMath","value":"\\quad \\displaystyle \\begin{bmatrix}\n 1 & 4 & 5 & -5 \\\\\n -1 & 0 & -1 & -5 \\\\\n 1 & 3 & -1 & 2 \\\\\n 1 & -1 & 5 & -1 \n \\end{bmatrix}","position":{"start":{"line":245,"column":1},"end":{"line":245,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mspace width=\"1em\"/><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mo fence=\"true\">[</mo><mtable rowspacing=\"0.16em\" columnalign=\"center center center center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>4</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>5</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mn>5</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mn>1</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mn>1</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mn>5</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>3</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mn>1</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>2</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mn>1</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>5</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mn>1</mn></mrow></mstyle></mtd></mtr></mtable><mo fence=\"true\">]</mo></mrow></mstyle></mrow><annotation encoding=\"application/x-tex\">\\quad \\displaystyle \\begin{bmatrix}\n 1 &amp; 4 &amp; 5 &amp; -5 \\\\\n -1 &amp; 0 &amp; -1 &amp; -5 \\\\\n 1 &amp; 3 &amp; -1 &amp; 2 \\\\\n 1 &amp; -1 &amp; 5 &amp; -1 \n \\end{bmatrix}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:4.8001em;vertical-align:-2.15em;\"></span><span class=\"mspace\" style=\"margin-right:1em;\"></span><span class=\"minner\"><span class=\"mopen\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.65em;\"><span style=\"top:-1.711em;\"><span class=\"pstrut\" style=\"height:3.216em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎣</span></span></span><span style=\"top:-2.858em;\"><span class=\"pstrut\" style=\"height:3.216em;\"></span><span style=\"height:1.216em;width:0.6667em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.6667em' height='1.216em' style='width:0.6667em' viewBox='0 0 666.67 1216' preserveAspectRatio='xMinYMin'><path d='M319 0 H403 V1216 H319z M319 0 H403 V1216 H319z'/></svg></span></span><span style=\"top:-4.7111em;\"><span class=\"pstrut\" style=\"height:3.216em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎡</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.65em;\"><span style=\"top:-4.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord\">1</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span><span style=\"top:-1.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.15em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.65em;\"><span style=\"top:-4.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">4</span></span></span><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">0</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">3</span></span></span><span style=\"top:-1.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.15em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.65em;\"><span style=\"top:-4.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">5</span></span></span><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord\">1</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord\">1</span></span></span><span style=\"top:-1.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">5</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.15em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.65em;\"><span style=\"top:-4.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord\">5</span></span></span><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord\">5</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">2</span></span></span><span style=\"top:-1.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.15em;\"><span></span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.65em;\"><span style=\"top:-1.711em;\"><span class=\"pstrut\" style=\"height:3.216em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎦</span></span></span><span style=\"top:-2.858em;\"><span class=\"pstrut\" style=\"height:3.216em;\"></span><span style=\"height:1.216em;width:0.6667em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.6667em' height='1.216em' style='width:0.6667em' viewBox='0 0 666.67 1216' preserveAspectRatio='xMinYMin'><path d='M263 0 H347 V1216 H263z M263 0 H347 V1216 H263z'/></svg></span></span><span style=\"top:-4.7111em;\"><span class=\"pstrut\" style=\"height:3.216em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎤</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.15em;\"><span></span></span></span></span></span></span></span></span></span></span>","key":"vUkyy8hNN7"},{"type":"text","value":".","position":{"start":{"line":245,"column":1},"end":{"line":245,"column":1}},"key":"IoRUilv8vS"}],"key":"WmJBB3JaPu"}],"key":"K73aXobNve"},{"type":"listItem","spread":true,"position":{"start":{"line":257,"column":1},"end":{"line":271,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":257,"column":1},"end":{"line":257,"column":1}},"children":[{"type":"text","value":"✍ Let ","position":{"start":{"line":257,"column":1},"end":{"line":257,"column":1}},"key":"OJVxIVAsjx"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":257,"column":1},"end":{"line":257,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"YTCI9sGCel"},{"type":"text","value":" be a square matrix and ","position":{"start":{"line":257,"column":1},"end":{"line":257,"column":1}},"key":"VZFsyVsVcA"},{"type":"inlineMath","value":"\\mathbf{b}","position":{"start":{"line":257,"column":1},"end":{"line":257,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"TczcPCQXjt"},{"type":"text","value":" be a column vector of compatible length. Here is correct Julia code to solve ","position":{"start":{"line":257,"column":1},"end":{"line":257,"column":1}},"key":"jhjj6xOcaJ"},{"type":"inlineMath","value":"\\mathbf{A}\\mathbf{x}=\\mathbf{b}","position":{"start":{"line":257,"column":1},"end":{"line":257,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi><mi mathvariant=\"bold\">x</mi><mo>=</mo><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}\\mathbf{x}=\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">Ax</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"zS2NAkhqRu"},{"type":"text","value":":","position":{"start":{"line":257,"column":1},"end":{"line":257,"column":1}},"key":"PGzbwb7DV0"}],"key":"qEk23jfIBY"},{"type":"code","lang":"julia","value":"L,U,p = lu(A)\nx = U \\ (L\\b[p])","position":{"start":{"line":259,"column":1},"end":{"line":262,"column":1}},"key":"QyQW6sgpXP"},{"type":"paragraph","position":{"start":{"line":264,"column":1},"end":{"line":264,"column":1}},"children":[{"type":"text","value":"Suppose instead you replace the last line above with","position":{"start":{"line":264,"column":1},"end":{"line":264,"column":1}},"key":"x8ZF4vCWlx"}],"key":"KxqECes1oI"},{"type":"code","lang":"julia","value":"x = U \\ L \\ b[p]","position":{"start":{"line":266,"column":1},"end":{"line":268,"column":1}},"key":"HPdp3tOooD"},{"type":"paragraph","position":{"start":{"line":270,"column":1},"end":{"line":270,"column":1}},"children":[{"type":"text","value":"Mathematically in terms of ","position":{"start":{"line":270,"column":1},"end":{"line":270,"column":1}},"key":"D49KOJFhCh"},{"type":"inlineMath","value":"\\mathbf{L}","position":{"start":{"line":270,"column":1},"end":{"line":270,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">L</span></span></span></span>","key":"TU53etY06j"},{"type":"text","value":", ","position":{"start":{"line":270,"column":1},"end":{"line":270,"column":1}},"key":"GzBqthQyMl"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":270,"column":1},"end":{"line":270,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"lf5MH8t4Y9"},{"type":"text","value":", ","position":{"start":{"line":270,"column":1},"end":{"line":270,"column":1}},"key":"Hj6fn0GXzF"},{"type":"inlineMath","value":"\\mathbf{p}","position":{"start":{"line":270,"column":1},"end":{"line":270,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">p</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{p}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6389em;vertical-align:-0.1944em;\"></span><span class=\"mord mathbf\">p</span></span></span></span>","key":"zOHHiTsvIV"},{"type":"text","value":", and ","position":{"start":{"line":270,"column":1},"end":{"line":270,"column":1}},"key":"Bguo1Fm8qM"},{"type":"inlineMath","value":"\\mathbf{b}","position":{"start":{"line":270,"column":1},"end":{"line":270,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"L6G0igI8z0"},{"type":"text","value":", what vector is found?","position":{"start":{"line":270,"column":1},"end":{"line":270,"column":1}},"key":"bOzkawymtw"}],"key":"iYvyEFxezd"}],"key":"IStmqTUCHS"},{"type":"listItem","spread":true,"position":{"start":{"line":272,"column":1},"end":{"line":280,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":272,"column":1},"end":{"line":272,"column":1}},"children":[{"type":"text","value":"✍ Suppose that ","position":{"start":{"line":272,"column":1},"end":{"line":272,"column":1}},"key":"pf0ma9yOpQ"},{"type":"inlineCode","value":"A","position":{"start":{"line":272,"column":1},"end":{"line":272,"column":1}},"key":"lFiYcTlFlX"},{"type":"text","value":" is a ","position":{"start":{"line":272,"column":1},"end":{"line":272,"column":1}},"key":"F4WBxtERC2"},{"type":"inlineMath","value":"4\\times 6","position":{"start":{"line":272,"column":1},"end":{"line":272,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>4</mn><mo>×</mo><mn>6</mn></mrow><annotation encoding=\"application/x-tex\">4\\times 6</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">4</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">6</span></span></span></span>","key":"AqyOTiYLbU"},{"type":"text","value":" matrix in Julia and you define","position":{"start":{"line":272,"column":1},"end":{"line":272,"column":1}},"key":"nxQbJxe825"}],"key":"rQ9Af3O3Be"},{"type":"code","lang":"julia","value":"B = A[end:-1:1,end:-1:1]","position":{"start":{"line":274,"column":1},"end":{"line":276,"column":1}},"key":"T9eGLJ7P51"},{"type":"paragraph","position":{"start":{"line":278,"column":1},"end":{"line":278,"column":1}},"children":[{"type":"text","value":"Show that ","position":{"start":{"line":278,"column":1},"end":{"line":278,"column":1}},"key":"BOF3iXr9yA"},{"type":"inlineMath","value":"\\mathbf{B} = \\mathbf{P} \\mathbf{A} \\mathbf{Q}","position":{"start":{"line":278,"column":1},"end":{"line":278,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">B</mi><mo>=</mo><mi mathvariant=\"bold\">P</mi><mi mathvariant=\"bold\">A</mi><mi mathvariant=\"bold\">Q</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{B} = \\mathbf{P} \\mathbf{A} \\mathbf{Q}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">B</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8805em;vertical-align:-0.1944em;\"></span><span class=\"mord mathbf\">PAQ</span></span></span></span>","key":"rUMGgOAmSx"},{"type":"text","value":" for certain matrices ","position":{"start":{"line":278,"column":1},"end":{"line":278,"column":1}},"key":"BczBnLpMAC"},{"type":"inlineMath","value":"\\mathbf{P}","position":{"start":{"line":278,"column":1},"end":{"line":278,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">P</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{P}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">P</span></span></span></span>","key":"kbqfr4GZcD"},{"type":"text","value":" and ","position":{"start":{"line":278,"column":1},"end":{"line":278,"column":1}},"key":"EMDxkV5WJh"},{"type":"inlineMath","value":"\\mathbf{Q}","position":{"start":{"line":278,"column":1},"end":{"line":278,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">Q</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{Q}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8805em;vertical-align:-0.1944em;\"></span><span class=\"mord mathbf\">Q</span></span></span></span>","key":"DDhzK3hg59"},{"type":"text","value":".","position":{"start":{"line":278,"column":1},"end":{"line":278,"column":1}},"key":"SLnfKTAGoo"}],"key":"MEsXwTf12G"}],"key":"WNG3kLbXmb"},{"type":"listItem","spread":true,"position":{"start":{"line":281,"column":1},"end":{"line":291,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":281,"column":1},"end":{"line":281,"column":1}},"children":[{"type":"text","value":"✍ An ","position":{"start":{"line":281,"column":1},"end":{"line":281,"column":1}},"key":"pbqzfhIChN"},{"type":"inlineMath","value":"n\\times n","position":{"start":{"line":281,"column":1},"end":{"line":281,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>×</mo><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n\\times n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"oJFMEdBDJD"},{"type":"text","value":" ","position":{"start":{"line":281,"column":1},"end":{"line":281,"column":1}},"key":"r1J05D0Dy4"},{"type":"emphasis","position":{"start":{"line":281,"column":1},"end":{"line":281,"column":1}},"children":[{"type":"text","value":"permutation matrix","position":{"start":{"line":281,"column":1},"end":{"line":281,"column":1}},"key":"IMWlbqC6AD"}],"key":"VQVKrZAaHN"},{"type":"text","value":" ","position":{"start":{"line":281,"column":1},"end":{"line":281,"column":1}},"key":"gfLSy4ma4M"},{"type":"inlineMath","value":"\\mathbf{P}","position":{"start":{"line":281,"column":1},"end":{"line":281,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">P</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{P}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">P</span></span></span></span>","key":"GrtnUvijG6"},{"type":"text","value":" is a reordering of the rows of an identity matrix such that ","position":{"start":{"line":281,"column":1},"end":{"line":281,"column":1}},"key":"E1qmxoVk4B"},{"type":"inlineMath","value":"\\mathbf{P} \\mathbf{A}","position":{"start":{"line":281,"column":1},"end":{"line":281,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">P</mi><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{P} \\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">PA</span></span></span></span>","key":"hYAZAolZcw"},{"type":"text","value":"  has the effect of moving rows ","position":{"start":{"line":281,"column":1},"end":{"line":281,"column":1}},"key":"ZmbcluYr2E"},{"type":"inlineMath","value":"1,2,\\ldots,n","position":{"start":{"line":281,"column":1},"end":{"line":281,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mo separator=\"true\">,</mo><mn>2</mn><mo separator=\"true\">,</mo><mo>…</mo><mo separator=\"true\">,</mo><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">1,2,\\ldots,n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8389em;vertical-align:-0.1944em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">2</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"ZjG2fsEdPN"},{"type":"text","value":" of ","position":{"start":{"line":281,"column":1},"end":{"line":281,"column":1}},"key":"XArLvmRbQx"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":281,"column":1},"end":{"line":281,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"NpChrihznU"},{"type":"text","value":" to new positions ","position":{"start":{"line":281,"column":1},"end":{"line":281,"column":1}},"key":"Npbw1uIR74"},{"type":"inlineMath","value":"i_1,i_2,\\ldots,i_n","position":{"start":{"line":281,"column":1},"end":{"line":281,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>i</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><msub><mi>i</mi><mn>2</mn></msub><mo separator=\"true\">,</mo><mo>…</mo><mo separator=\"true\">,</mo><msub><mi>i</mi><mi>n</mi></msub></mrow><annotation encoding=\"application/x-tex\">i_1,i_2,\\ldots,i_n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"q1O2qpSSb2"},{"type":"text","value":". Then ","position":{"start":{"line":281,"column":1},"end":{"line":281,"column":1}},"key":"ih0RoKdjWD"},{"type":"inlineMath","value":"\\mathbf{P}","position":{"start":{"line":281,"column":1},"end":{"line":281,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">P</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{P}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">P</span></span></span></span>","key":"Q9p1dYmaz3"},{"type":"text","value":" can be expressed as","position":{"start":{"line":281,"column":1},"end":{"line":281,"column":1}},"key":"FNNzgsQ5JA"}],"key":"pis1O9SGP0"},{"type":"math","value":"\\mathbf{P} = \\mathbf{e}_{i_1}\\mathbf{e}_1^T + \\mathbf{e}_{i_2}\\mathbf{e}_2^T + \\cdots + \\mathbf{e}_{i_n}\\mathbf{e}_n^T.","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi mathvariant=\"bold\">P</mi><mo>=</mo><msub><mi mathvariant=\"bold\">e</mi><msub><mi>i</mi><mn>1</mn></msub></msub><msubsup><mi mathvariant=\"bold\">e</mi><mn>1</mn><mi>T</mi></msubsup><mo>+</mo><msub><mi mathvariant=\"bold\">e</mi><msub><mi>i</mi><mn>2</mn></msub></msub><msubsup><mi mathvariant=\"bold\">e</mi><mn>2</mn><mi>T</mi></msubsup><mo>+</mo><mo>⋯</mo><mo>+</mo><msub><mi mathvariant=\"bold\">e</mi><msub><mi>i</mi><mi>n</mi></msub></msub><msubsup><mi mathvariant=\"bold\">e</mi><mi>n</mi><mi>T</mi></msubsup><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{P} = \\mathbf{e}_{i_1}\\mathbf{e}_1^T + \\mathbf{e}_{i_2}\\mathbf{e}_2^T + \\cdots + \\mathbf{e}_{i_n}\\mathbf{e}_n^T.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">P</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1414em;vertical-align:-0.2501em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">e</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3173em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2501em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathbf\">e</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913em;\"><span style=\"top:-2.453em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1414em;vertical-align:-0.2501em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">e</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3173em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2501em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathbf\">e</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913em;\"><span style=\"top:-2.453em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"minner\">⋯</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1414em;vertical-align:-0.2501em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">e</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1645em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2501em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathbf\">e</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913em;\"><span style=\"top:-2.453em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span><span class=\"mord\">.</span></span></span></span></span>","enumerator":"2.6.4","key":"jIGnFk0Bt7"},{"type":"paragraph","position":{"start":{"line":287,"column":1},"end":{"line":287,"column":1}},"children":[{"type":"strong","position":{"start":{"line":287,"column":1},"end":{"line":287,"column":1}},"children":[{"type":"text","value":"(a)","position":{"start":{"line":287,"column":1},"end":{"line":287,"column":1}},"key":"Q9ZGMhU8tX"}],"key":"U1Ma5SN1iP"},{"type":"text","value":" For the case ","position":{"start":{"line":287,"column":1},"end":{"line":287,"column":1}},"key":"p2ug0cUVlR"},{"type":"inlineMath","value":"n=4","position":{"start":{"line":287,"column":1},"end":{"line":287,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>=</mo><mn>4</mn></mrow><annotation encoding=\"application/x-tex\">n=4</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">4</span></span></span></span>","key":"Vr38H0gmg7"},{"type":"text","value":" and ","position":{"start":{"line":287,"column":1},"end":{"line":287,"column":1}},"key":"DSVEh6ilCe"},{"type":"inlineMath","value":"i_1=3","position":{"start":{"line":287,"column":1},"end":{"line":287,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>i</mi><mn>1</mn></msub><mo>=</mo><mn>3</mn></mrow><annotation encoding=\"application/x-tex\">i_1=3</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8095em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">3</span></span></span></span>","key":"UEG9QYXyQs"},{"type":"text","value":", ","position":{"start":{"line":287,"column":1},"end":{"line":287,"column":1}},"key":"b8nwcgkhiH"},{"type":"inlineMath","value":"i_2=2","position":{"start":{"line":287,"column":1},"end":{"line":287,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>i</mi><mn>2</mn></msub><mo>=</mo><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">i_2=2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8095em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span></span></span></span>","key":"YeQMC8PmuV"},{"type":"text","value":", ","position":{"start":{"line":287,"column":1},"end":{"line":287,"column":1}},"key":"dSoriKoTv0"},{"type":"inlineMath","value":"i_3=4","position":{"start":{"line":287,"column":1},"end":{"line":287,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>i</mi><mn>3</mn></msub><mo>=</mo><mn>4</mn></mrow><annotation encoding=\"application/x-tex\">i_3=4</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8095em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">4</span></span></span></span>","key":"XpDNOua1TQ"},{"type":"text","value":", ","position":{"start":{"line":287,"column":1},"end":{"line":287,"column":1}},"key":"qPHd4iQ8EB"},{"type":"inlineMath","value":"i_4=1","position":{"start":{"line":287,"column":1},"end":{"line":287,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>i</mi><mn>4</mn></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">i_4=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8095em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">4</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"GS4Ly4Lsop"},{"type":"text","value":", write out separately, as matrices, all four of the terms in the sum. Then add them together to find ","position":{"start":{"line":287,"column":1},"end":{"line":287,"column":1}},"key":"y3v3M7uaQR"},{"type":"inlineMath","value":"\\mathbf{P}","position":{"start":{"line":287,"column":1},"end":{"line":287,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">P</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{P}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">P</span></span></span></span>","key":"GhkUHSLVbO"},{"type":"text","value":".","position":{"start":{"line":287,"column":1},"end":{"line":287,"column":1}},"key":"SYKvj5G5h5"}],"key":"yLJ9M3VEJA"},{"type":"paragraph","position":{"start":{"line":289,"column":1},"end":{"line":289,"column":1}},"children":[{"type":"strong","position":{"start":{"line":289,"column":1},"end":{"line":289,"column":1}},"children":[{"type":"text","value":"(b)","position":{"start":{"line":289,"column":1},"end":{"line":289,"column":1}},"key":"kRcbJDEX1e"}],"key":"cnY2M0lv4a"},{"type":"text","value":" Use the formula in the general case to show that ","position":{"start":{"line":289,"column":1},"end":{"line":289,"column":1}},"key":"XYu6qhZ4lu"},{"type":"inlineMath","value":"\\mathbf{P}^{-1}=\\mathbf{P}^T","position":{"start":{"line":289,"column":1},"end":{"line":289,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi mathvariant=\"bold\">P</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo>=</mo><msup><mi mathvariant=\"bold\">P</mi><mi>T</mi></msup></mrow><annotation encoding=\"application/x-tex\">\\mathbf{P}^{-1}=\\mathbf{P}^T</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">P</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8413em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">P</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span></span></span></span>","key":"iDGHWeEjYQ"},{"type":"text","value":".","position":{"start":{"line":289,"column":1},"end":{"line":289,"column":1}},"key":"JSujiAELmR"}],"key":"szMH8ptQqk"}],"key":"QntKNsFBF4"}],"key":"UotU2esGZz"},{"type":"footnoteDefinition","identifier":"plu","label":"PLU","position":{"start":{"line":289,"column":1},"end":{"line":289,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"children":[{"type":"text","value":"Because unpivoted ","key":"XgGPhXsDWM"},{"type":"abbreviation","title":"lower triangular times upper triangular","children":[{"type":"text","value":"LU","key":"fQHKga3Vbk"}],"key":"AA8oyPKY2V"},{"type":"text","value":" factorization is not useful, in practice the term ","key":"Wa1lSkEB15"},{"type":"emphasis","position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"children":[{"type":"abbreviation","title":"lower triangular times upper triangular","children":[{"type":"text","value":"LU","key":"uAJkjU7N7r"}],"key":"w4HhljML43"},{"type":"text","value":" factorization","key":"oNSD3bRwwK"}],"key":"mNNYXGd5g1"},{"type":"text","value":" mostly refers to pivoted ","key":"A32ikthNWM"},{"type":"abbreviation","title":"lower triangular times upper triangular","children":[{"type":"text","value":"LU","key":"OL8YTREHZy"}],"key":"oVA2eaSi0i"},{"type":"text","value":".","key":"El6KPWvf7W"}],"key":"w3q9p5o6IU"}],"number":1,"enumerator":"1","key":"RDVH45Gqt8"}],"key":"Yt8s8QobaR"}],"key":"fgIYqBBLed"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Efficiency of matrix computations","url":"/efficiency","group":"Preface"},"next":{"title":"Vector and matrix norms","url":"/norms","group":"Preface"}}},"domain":"http://localhost:3000"}