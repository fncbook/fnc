{"kind":"Article","sha256":"9943caaa3608cc7dba7fb2247eaa267ef01b5d0c7680167d5fdcda3ea07873f8","slug":"pivoting","location":"/chapter2/pivoting.md","dependencies":[{"url":"/chapter2","label":"demo-pivoting-fail-julia","kind":"Notebook","slug":"chapter2","location":"/julia/chapter2.md","title":"Chapter 2"},{"url":"/chapter2-1","label":"demo-pivoting-fail-matlab","kind":"Notebook","slug":"chapter2-1","location":"/matlab/chapter2.md","title":"Chapter 2"},{"url":"/chapter2-2","label":"demo-pivoting-fail-python","kind":"Notebook","slug":"chapter2-2","location":"/python/chapter2.md","title":"Chapter 2"}],"frontmatter":{"title":"Row pivoting","numbering":{"heading_1":{"enabled":true},"heading_2":{"enabled":true},"heading_3":{"enabled":false},"enumerator":{"template":"2.6.%s"}},"content_includes_title":false,"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"exports":[{"format":"md","filename":"pivoting.md","url":"/fnc/build/pivoting-9b29b398c86a44460897d933e064aa96.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"As mentioned in ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"NpwlhHEEXV"},{"type":"link","kind":"numref","identifier":"section-linsys-lu","label":"section-linsys-lu","url":"/lu","internal":true,"dataUrl":"/lu.json","children":[{"type":"text","value":"LU factorization","key":"iCYiljhT6W"}],"key":"NlRQp2qDDl"},{"type":"text","value":", the ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"syCa1bVSm3"},{"type":"inlineMath","value":"\\mathbf{A}=\\mathbf{L}\\mathbf{U}","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi><mo>=</mo><mi mathvariant=\"bold\">L</mi><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}=\\mathbf{L}\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">LU</span></span></span></span>","key":"PtvlU2Sa5r"},{"type":"text","value":" factorization is not stable for every nonsingular ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"VtbjJzqT9Y"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"mYr2SSsZvt"},{"type":"text","value":". Indeed, the factorization does not always even exist.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"Pzy0aSZ5pl"}],"indexEntries":[{"entry":"matrix factorization","subEntry":{"value":"LU","kind":"entry"},"emphasis":false}],"label":"index-LIfq0glDwm","identifier":"index-lifq0gldwm","html_id":"index-lifq0gldwm","key":"mmPvQ6UtWH"},{"type":"proof","kind":"example","enumerated":true,"children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Failure of naive LU factorization","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"WBlPooKBBu"}],"key":"piK0ZsWqD6"},{"type":"tabSet","children":[{"type":"tabItem","title":"Julia","sync":"julia","children":[{"type":"embed","source":{"url":"/chapter2","label":"demo-pivoting-fail-julia","kind":"Notebook","slug":"chapter2","location":"/julia/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-pivoting-fail","label":"demo-pivoting-fail","kind":"proof:example","position":{"start":{"line":825,"column":1},"end":{"line":825,"column":20}},"children":[{"type":"text","value":"Example ","key":"QWGCsRIVo8"},{"type":"text","value":"2.6.1","key":"E8rGMXNXxD"}],"template":"Example %s","enumerator":"2.6.1","resolved":true,"html_id":"demo-pivoting-fail","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"yx2LlvRdv4"}],"key":"zaF6CvOc7M"},{"type":"paragraph","position":{"start":{"line":826,"column":1},"end":{"line":826,"column":1}},"children":[{"type":"text","value":"Here is a previously encountered matrix that factors well.","position":{"start":{"line":826,"column":1},"end":{"line":826,"column":1}},"key":"df1Qn3JMW6"}],"key":"KL2WNwRWFN"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"A = [2 0 4 3 ; -4 5 -7 -10 ; 1 15 2 -4.5 ; -2 0 2 -13];\nL, U = FNC.lufact(A)\nL","key":"xowEZjVhUJ"},{"type":"output","id":"VbTb2IFWU4i_NstYIsq6P","data":[{"output_type":"execute_result","execution_count":78,"metadata":{},"data":{"text/plain":{"content":"4×4 LowerTriangular{Float64, Matrix{Float64}}:\n  1.0   ⋅     ⋅    ⋅ \n -2.0  1.0    ⋅    ⋅ \n  0.5  3.0   1.0   ⋅ \n -1.0  0.0  -2.0  1.0","content_type":"text/plain"}}}],"key":"NGWMs2L0wV"}],"data":{},"key":"G83iGoE1mc"},{"type":"paragraph","position":{"start":{"line":834,"column":1},"end":{"line":834,"column":1}},"children":[{"type":"text","value":"If we swap the second and fourth rows of ","position":{"start":{"line":834,"column":1},"end":{"line":834,"column":1}},"key":"eTHlWaRiCT"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":834,"column":1},"end":{"line":834,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"eBAVd0ig3X"},{"type":"text","value":", the result is still nonsingular. However, the factorization now fails.","position":{"start":{"line":834,"column":1},"end":{"line":834,"column":1}},"key":"m7nqyC8vtj"}],"key":"H8ZjFp2wYs"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"A[[2, 4], :] = A[[4, 2], :]  \nL, U = FNC.lufact(A)\nL","key":"hOzYAMPKkW"},{"type":"output","id":"52Oi1zsRnXcHMpDNfcADy","data":[{"output_type":"execute_result","execution_count":79,"metadata":{},"data":{"text/plain":{"content":"4×4 LowerTriangular{Float64, Matrix{Float64}}:\n  1.0     ⋅      ⋅    ⋅ \n -1.0  NaN       ⋅    ⋅ \n  0.5   Inf   NaN     ⋅ \n -2.0   Inf   NaN    1.0","content_type":"text/plain"}}}],"key":"ie74h2pVko"}],"data":{},"key":"w4As3zzRr4"},{"type":"paragraph","position":{"start":{"line":845,"column":1},"end":{"line":845,"column":1}},"children":[{"type":"text","value":"The presence of ","position":{"start":{"line":845,"column":1},"end":{"line":845,"column":1}},"key":"cLQ8iNYoHP"},{"type":"inlineCode","value":"NaN","position":{"start":{"line":845,"column":1},"end":{"line":845,"column":1}},"key":"hzo4eXTqPy"},{"type":"text","value":" in the result indicates that some impossible operation was required. The source of the problem is easy to locate. We can find the first outer product in the factorization just fine:","position":{"start":{"line":845,"column":1},"end":{"line":845,"column":1}},"key":"LyXAjGVvp1"}],"indexEntries":[{"entry":"Julia","subEntry":{"value":"NaN","kind":"entry"},"emphasis":false}],"key":"VbdOflMEEi"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"U[1, :] = A[1, :]\nL[:, 1] = A[:, 1] / U[1, 1]\nA -= L[:, 1] * U[1, :]'","key":"hXQKzapJbp"},{"type":"output","id":"VeHHHc3-4ydoiURrOY2NX","data":[{"output_type":"execute_result","execution_count":80,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n 0.0   0.0  0.0    0.0\n 0.0   0.0  6.0  -10.0\n 0.0  15.0  0.0   -6.0\n 0.0   5.0  1.0   -4.0","content_type":"text/plain"}}}],"key":"P7LM7JXZPe"}],"data":{},"key":"GpL5kKaUio"},{"type":"paragraph","position":{"start":{"line":853,"column":1},"end":{"line":853,"column":1}},"children":[{"type":"text","value":"The next step is ","position":{"start":{"line":853,"column":1},"end":{"line":853,"column":1}},"key":"olvcCwjTRQ"},{"type":"inlineCode","value":"U[2, :] = A[2, :]","position":{"start":{"line":853,"column":1},"end":{"line":853,"column":1}},"key":"K9Db30TkYt"},{"type":"text","value":", which is also OK. But then we are supposed to divide by ","position":{"start":{"line":853,"column":1},"end":{"line":853,"column":1}},"key":"EMkelvcBmT"},{"type":"inlineCode","value":"U[2, 2]","position":{"start":{"line":853,"column":1},"end":{"line":853,"column":1}},"key":"Ng67cPTl2l"},{"type":"text","value":", which is zero. The algorithm cannot continue.","position":{"start":{"line":853,"column":1},"end":{"line":853,"column":1}},"key":"jEOEP8aDzq"}],"key":"x8ilrRNx1A"}],"key":"KksI2EtBjH"}],"key":"zGU3VGySHA"}],"key":"WpuyBD6Mkq"},{"type":"tabItem","title":"MATLAB","sync":"matlab","children":[{"type":"embed","source":{"url":"/chapter2-1","label":"demo-pivoting-fail-matlab","kind":"Notebook","slug":"chapter2-1","location":"/matlab/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-pivoting-fail","label":"demo-pivoting-fail","kind":"proof:example","position":{"start":{"line":765,"column":1},"end":{"line":765,"column":20}},"children":[{"type":"text","value":"Example ","key":"qGOpAb3mFI"},{"type":"text","value":"2.6.1","key":"Q19LOn4fEs"}],"template":"Example %s","enumerator":"2.6.1","resolved":true,"html_id":"demo-pivoting-fail","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"qmQb9A7rwt"}],"key":"wXCL27rGw1"},{"type":"paragraph","position":{"start":{"line":766,"column":1},"end":{"line":766,"column":1}},"children":[{"type":"text","value":"Here is a previously encountered matrix that factors well.","position":{"start":{"line":766,"column":1},"end":{"line":766,"column":1}},"key":"YFH7HwUfqO"}],"key":"gQcYCOdHra"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A = [\n    2 0 4 3\n    -4 5 -7 -10\n    1 15 2 -4.5\n    -2 0 2 -13\n    ];\n[L, U] = lufact(A);\nL","key":"aeVwXBeFxm"},{"type":"output","id":"9wyRyVhw7d3KBeuXQSgJu","data":[{"output_type":"execute_result","execution_count":76,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>L = 4×4 double\n   1.0000e+00            0            0            0\n  -2.0000e+00   1.0000e+00            0            0\n   5.0000e-01   3.0000e+00   1.0000e+00            0\n  -1.0000e+00            0  -2.0000e+00   1.0000e+00\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"L = 4×4 double\n   1.0000e+00            0            0            0\n  -2.0000e+00   1.0000e+00            0            0\n   5.0000e-01   3.0000e+00   1.0000e+00            0\n  -1.0000e+00            0  -2.0000e+00   1.0000e+00\n","content_type":"text/plain"}}}],"key":"sK6WiBxLOe"}],"data":{},"key":"jcKsquRCF2"},{"type":"paragraph","position":{"start":{"line":779,"column":1},"end":{"line":779,"column":1}},"children":[{"type":"text","value":"If we swap the second and fourth rows of ","position":{"start":{"line":779,"column":1},"end":{"line":779,"column":1}},"key":"tJA38jmbU0"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":779,"column":1},"end":{"line":779,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"cxbKc9lcYa"},{"type":"text","value":", the result is still nonsingular. However, the factorization now fails.","position":{"start":{"line":779,"column":1},"end":{"line":779,"column":1}},"key":"qtBMM9YIgR"}],"key":"V7K8ameOuj"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A([2, 4], :) = A([4, 2], :);    % swap rows 2 and 4\n[L, U] = lufact(A);\nL","key":"x5WiCIo0ae"},{"type":"output","id":"C1vZq5GrUb2CY2qIY_fWq","data":[{"output_type":"execute_result","execution_count":77,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>L = 4×4 double\n   1.0000e+00            0            0            0\n  -1.0000e+00          NaN            0            0\n   5.0000e-01          Inf          NaN            0\n  -2.0000e+00          Inf          NaN   1.0000e+00\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"L = 4×4 double\n   1.0000e+00            0            0            0\n  -1.0000e+00          NaN            0            0\n   5.0000e-01          Inf          NaN            0\n  -2.0000e+00          Inf          NaN   1.0000e+00\n","content_type":"text/plain"}}}],"key":"IJQuPGB9W1"}],"data":{},"key":"wwuqwCO8Kd"},{"type":"paragraph","position":{"start":{"line":790,"column":1},"end":{"line":790,"column":1}},"children":[{"type":"text","value":"The presence of ","position":{"start":{"line":790,"column":1},"end":{"line":790,"column":1}},"key":"grIiXrgl6u"},{"type":"inlineCode","value":"NaN","position":{"start":{"line":790,"column":1},"end":{"line":790,"column":1}},"key":"UwvGAGY5je"},{"type":"text","value":" in the result indicates that some impossible operation was required. The source of the problem is easy to locate. We can find the first outer product in the factorization just fine:","position":{"start":{"line":790,"column":1},"end":{"line":790,"column":1}},"key":"qf37BKQda0"}],"indexEntries":[{"entry":"MATLAB","subEntry":{"value":"NaN","kind":"entry"},"emphasis":false}],"key":"ZdQQ0HrcqT"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"U(1, :) = A(1, :);\nL(:, 1) = A(:, 1) / U(1, 1)\nA = A - L(:, 1) * U(1, :)","key":"LeaRRQtxFx"},{"type":"output","id":"LlSeJ_-NLWV1IrvCcPYpG","data":[{"output_type":"execute_result","execution_count":78,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>L = 4×4 double\n   1.0000e+00            0            0            0\n  -1.0000e+00          NaN            0            0\n   5.0000e-01          Inf          NaN            0\n  -2.0000e+00          Inf          NaN   1.0000e+00\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"L = 4×4 double\n   1.0000e+00            0            0            0\n  -1.0000e+00          NaN            0            0\n   5.0000e-01          Inf          NaN            0\n  -2.0000e+00          Inf          NaN   1.0000e+00\n","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":78,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>A = 4×4 double\n     0     0     0     0\n     0     0     6   -10\n     0    15     0    -6\n     0     5     1    -4\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"A = 4×4 double\n     0     0     0     0\n     0     0     6   -10\n     0    15     0    -6\n     0     5     1    -4\n","content_type":"text/plain"}}}],"key":"MqtWCeVXiJ"}],"data":{},"key":"Q0N0uqN05x"},{"type":"paragraph","position":{"start":{"line":798,"column":1},"end":{"line":798,"column":1}},"children":[{"type":"text","value":"The next step is ","position":{"start":{"line":798,"column":1},"end":{"line":798,"column":1}},"key":"Cr7AY3yaDe"},{"type":"inlineCode","value":"U(2, :) = A(2, :)","position":{"start":{"line":798,"column":1},"end":{"line":798,"column":1}},"key":"z1pbwtRNgw"},{"type":"text","value":", which is also OK. But then we are supposed to divide by ","position":{"start":{"line":798,"column":1},"end":{"line":798,"column":1}},"key":"KUNv2G8PZG"},{"type":"inlineCode","value":"U(2, 2)","position":{"start":{"line":798,"column":1},"end":{"line":798,"column":1}},"key":"MzGzaZKgoh"},{"type":"text","value":", which is zero. The algorithm cannot continue.","position":{"start":{"line":798,"column":1},"end":{"line":798,"column":1}},"key":"w8Ne5WOFMp"}],"key":"gU7Pn1oqZs"}],"key":"bxFEUbh65p"}],"key":"JTRNJ0a0Ff"}],"key":"qz6zfQd1pB"},{"type":"tabItem","title":"Python","sync":"python","children":[{"type":"embed","source":{"url":"/chapter2-2","label":"demo-pivoting-fail-python","kind":"Notebook","slug":"chapter2-2","location":"/python/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-pivoting-fail","label":"demo-pivoting-fail","kind":"proof:example","position":{"start":{"line":735,"column":1},"end":{"line":735,"column":20}},"children":[{"type":"text","value":"Example ","key":"IXecilchU2"},{"type":"text","value":"2.6.1","key":"E7YScDeg1K"}],"template":"Example %s","enumerator":"2.6.1","resolved":true,"html_id":"demo-pivoting-fail","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"FTpqUTOsDt"}],"key":"nxFjLqkygh"},{"type":"paragraph","position":{"start":{"line":736,"column":1},"end":{"line":736,"column":1}},"children":[{"type":"text","value":"Here is a previously encountered matrix that factors well.","position":{"start":{"line":736,"column":1},"end":{"line":736,"column":1}},"key":"hkTInwgEOz"}],"key":"P3NzqYPODw"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"A = array([\n    [2, 0, 4, 3],\n    [-4, 5, -7, -10],\n    [1, 15, 2, -4.5],\n    [-2, 0, 2, -13]\n    ])\nL, U = FNC.lufact(A)\nprint(L)","key":"L4wnn4ps6L"},{"type":"output","id":"cdn7dCqqlxyetRq-XqKnA","data":[{"output_type":"stream","name":"stdout","text":"[[ 1.   0.  -0.   0. ]\n [-2.   1.  -0.   0. ]\n [ 0.5  3.   1.   0. ]\n [-1.   0.  -2.   1. ]]\n"}],"key":"J0wHYxQlS4"}],"data":{},"key":"cE8i2kKTIb"},{"type":"paragraph","position":{"start":{"line":749,"column":1},"end":{"line":749,"column":1}},"children":[{"type":"text","value":"If we swap the second and fourth rows of ","position":{"start":{"line":749,"column":1},"end":{"line":749,"column":1}},"key":"nszeQdQ5JU"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":749,"column":1},"end":{"line":749,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"n6eKt0GrCb"},{"type":"text","value":", the result is still nonsingular. However, the factorization now fails.","position":{"start":{"line":749,"column":1},"end":{"line":749,"column":1}},"key":"nHOUq1Nhb1"}],"key":"bxV2jAbz0H"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"A[[1, 3], :] = A[[3, 1], :]  \nL, U = FNC.lufact(A)\nprint(L)","key":"Lwm91Dd5wP"},{"type":"output","id":"J_jmBQQ6QCg19BB17JksO","data":[{"output_type":"stream","name":"stdout","text":"[[ 1.   nan  nan  0. ]\n [-1.   nan  nan  0. ]\n [ 0.5  inf  nan  0. ]\n [-2.   inf  nan  1. ]]\n"},{"output_type":"stream","name":"stderr","text":"/Users/driscoll/Dropbox/Mac/Documents/GitHub/fnc/python/pkg/FNC/FNC02.py:47: RuntimeWarning: divide by zero encountered in divide\n  L[:, k] = A_k[:, k] / U[k,k]\n/Users/driscoll/Dropbox/Mac/Documents/GitHub/fnc/python/pkg/FNC/FNC02.py:47: RuntimeWarning: invalid value encountered in divide\n  L[:, k] = A_k[:, k] / U[k,k]\n/Users/driscoll/mambaforge/envs/myst/lib/python3.13/site-packages/numpy/_core/numeric.py:983: RuntimeWarning: invalid value encountered in multiply\n  return multiply(a.ravel()[:, newaxis], b.ravel()[newaxis, :], out)\n"}],"key":"eoF0tlHiXi"}],"data":{},"key":"wDfbS3e8aW"},{"type":"paragraph","position":{"start":{"line":760,"column":1},"end":{"line":760,"column":1}},"children":[{"type":"text","value":"The presence of ","position":{"start":{"line":760,"column":1},"end":{"line":760,"column":1}},"key":"WRDPjwmLOp"},{"type":"inlineCode","value":"NaN","position":{"start":{"line":760,"column":1},"end":{"line":760,"column":1}},"key":"dTlbBBQd1E"},{"type":"text","value":" in the result indicates that some impossible operation was required. The source of the problem is easy to locate. We can find the first outer product in the factorization just fine:","position":{"start":{"line":760,"column":1},"end":{"line":760,"column":1}},"key":"Ws72oZcVzi"}],"indexEntries":[{"entry":"Python","subEntry":{"value":"NaN","kind":"entry"},"emphasis":false}],"key":"FYL1BXGmvt"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"U[0, :] = A[0, :]\nL[:, 0] = A[:, 0] / U[0, 0]\nA -= outer(L[:, 0],  U[0, :])\nprint(A)","key":"z1rGZrfEPk"},{"type":"output","id":"CgFJ6T2slLjQzQV9HkNMo","data":[{"output_type":"stream","name":"stdout","text":"[[  0.   0.   0.   0.]\n [  0.   0.   6. -10.]\n [  0.  15.   0.  -6.]\n [  0.   5.   1.  -4.]]\n"}],"key":"ekiJwtwFtr"}],"data":{},"key":"OVhoCcdytl"},{"type":"paragraph","position":{"start":{"line":769,"column":1},"end":{"line":769,"column":1}},"children":[{"type":"text","value":"The next step is ","position":{"start":{"line":769,"column":1},"end":{"line":769,"column":1}},"key":"NgXHrQW9m1"},{"type":"inlineCode","value":"U[1, :] = A[1, :]","position":{"start":{"line":769,"column":1},"end":{"line":769,"column":1}},"key":"JVKiI6lqeV"},{"type":"text","value":", which is also OK. But then we are supposed to divide by ","position":{"start":{"line":769,"column":1},"end":{"line":769,"column":1}},"key":"QyhIrebi8D"},{"type":"inlineCode","value":"U[1, 1]","position":{"start":{"line":769,"column":1},"end":{"line":769,"column":1}},"key":"zc89cq037v"},{"type":"text","value":", which is zero. The algorithm cannot continue.","position":{"start":{"line":769,"column":1},"end":{"line":769,"column":1}},"key":"UDg6SuVLyO"}],"key":"na4ChECB97"}],"key":"k2zf3mX7A6"}],"key":"UTqLWAsFom"}],"key":"cTBS1DCYtC"}],"key":"BCbxRj8pF6"}],"label":"demo-pivoting-fail","identifier":"demo-pivoting-fail","html_id":"demo-pivoting-fail","enumerator":"2.6.1","key":"JiFgfQSeCa"},{"type":"paragraph","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"children":[{"type":"text","value":"In ","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"m2Xo5q4188"},{"type":"link","kind":"numref","identifier":"section-linsys-lu","label":"section-linsys-lu","url":"/lu","internal":true,"dataUrl":"/lu.json","children":[{"type":"text","value":"LU factorization","key":"eoNa9V4v9T"}],"key":"x9Qijhvn19"},{"type":"text","value":" we remarked that LU factorization is equivalent to Gaussian elimination with no row swaps. However, those swaps are necessary in situations like those encountered in ","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"JCMXhcwCwS"},{"type":"crossReference","kind":"proof:example","identifier":"demo-pivoting-fail","label":"demo-pivoting-fail","children":[{"type":"text","value":"Demo ","key":"pi6DlGpm5y"},{"type":"text","value":"2.6.1","key":"QRoieqrbUB"}],"template":"Example %s","enumerator":"2.6.1","resolved":true,"html_id":"demo-pivoting-fail","key":"MUf288L4oI"},{"type":"text","value":", in order to avoid division by zero. We will find a modification of the outer product procedure that allows us to do the same thing.","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"LcrQQUc2aA"}],"key":"VJt98rP4bU"},{"type":"heading","depth":2,"position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"children":[{"type":"text","value":"Choosing a pivot","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"key":"LgAeUXfKim"}],"identifier":"choosing-a-pivot","label":"Choosing a pivot","html_id":"choosing-a-pivot","implicit":true,"enumerator":"2.6.1","key":"j8mE6J9O7k"},{"type":"paragraph","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"children":[{"type":"text","value":"The diagonal element of ","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"DA2yvzMhBy"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"bk1hQKcUPz"},{"type":"text","value":" that appears in the denominator of line 17 of ","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"ch1VD35kDd"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-lufact","label":"function-lufact","children":[{"type":"text","value":"Function ","key":"NvMU7bUH1L"},{"type":"text","value":"2.4.1","key":"OAz2iAFxyQ"}],"template":"Algorithm %s","enumerator":"2.4.1","resolved":true,"html_id":"function-lufact","remote":true,"url":"/lu","dataUrl":"/lu.json","key":"NYjixPx2zx"},{"type":"text","value":" is called the ","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"DgbgCTdrP7"},{"type":"strong","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"children":[{"type":"text","value":"pivot element","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"xyznU4MVoD"}],"key":"fUPZoT8zMW"},{"type":"text","value":" of its column. In order to avoid a zero pivot, we will use the largest available element in the column we are working on as the pivot. This technique is known as ","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"eKUV08R89H"},{"type":"strong","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"children":[{"type":"text","value":"row pivoting","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"eEndXg9B4m"}],"key":"JctvmKDfl7"},{"type":"text","value":".","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"jiN5nWxwCf"}],"indexEntries":[{"entry":"pivoting","emphasis":true}],"label":"index-JKu9Jwnawj","identifier":"index-jku9jwnawj","html_id":"index-jku9jwnawj","key":"UA7mcgexHJ"},{"type":"proof","kind":"algorithm","enumerated":true,"children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Row pivoting","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"key":"PDc7r6cZ5X"}],"key":"iR3zaIsgSS"},{"type":"paragraph","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"children":[{"type":"text","value":"When performing elimination in column ","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"key":"ZtUnetPuvB"},{"type":"inlineMath","value":"j","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>j</mi></mrow><annotation encoding=\"application/x-tex\">j</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span></span></span></span>","key":"s5mYgL41wy"},{"type":"text","value":", choose as the pivot the element in column ","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"key":"HihQHzzoFq"},{"type":"inlineMath","value":"j","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>j</mi></mrow><annotation encoding=\"application/x-tex\">j</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span></span></span></span>","key":"RwTzSxtN2C"},{"type":"text","value":" that is largest in absolute value. (In case of ties, choose the lowest row index.)","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"key":"iAntDizIeD"}],"key":"rOrrYU2m4L"}],"label":"rule-pivoting","identifier":"rule-pivoting","html_id":"rule-pivoting","enumerator":"2.6.1","key":"RNurDyj7Pp"},{"type":"proof","kind":"example","enumerated":true,"children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Row pivoting in LU factorization","position":{"start":{"line":51,"column":1},"end":{"line":51,"column":1}},"key":"kUMDXt3m0C"}],"key":"Jj9AEisfCd"},{"type":"tabSet","children":[{"type":"tabItem","title":"Julia","sync":"julia","children":[{"type":"embed","source":{"url":"/chapter2","label":"demo-pivoting-fix-julia","kind":"Notebook","slug":"chapter2","location":"/julia/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-pivoting-fix","label":"demo-pivoting-fix","kind":"proof:example","position":{"start":{"line":857,"column":1},"end":{"line":857,"column":19}},"children":[{"type":"text","value":"Example ","key":"q5aOssuQHf"},{"type":"text","value":"2.6.2","key":"ixbsOMSoCw"}],"template":"Example %s","enumerator":"2.6.2","resolved":true,"html_id":"demo-pivoting-fix","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"iKwu1tXjMk"}],"key":"fT6BVhOGzG"},{"type":"paragraph","position":{"start":{"line":858,"column":1},"end":{"line":858,"column":1}},"children":[{"type":"text","value":"Here is the trouble-making matrix from ","position":{"start":{"line":858,"column":1},"end":{"line":858,"column":1}},"key":"FNh5pl2fkh"},{"type":"crossReference","kind":"proof:example","identifier":"demo-pivoting-fail","label":"demo-pivoting-fail","children":[{"type":"text","value":"Demo ","key":"ypMLJ8NfAq"},{"type":"text","value":"2.6.1","key":"cevMDpwlhw"}],"template":"Example %s","enumerator":"2.6.1","resolved":true,"html_id":"demo-pivoting-fail","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"G09fclAXAZ"},{"type":"text","value":".","position":{"start":{"line":858,"column":1},"end":{"line":858,"column":1}},"key":"tBZmrXG08x"}],"key":"LaJGoXnJBy"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"A₁ = [2 0 4 3 ; -2 0 2 -13; 1 15 2 -4.5 ; -4 5 -7 -10]","key":"g7L2I7mjSW"},{"type":"output","id":"9J_a0hE87GL6CNS-zO2ay","data":[{"output_type":"execute_result","execution_count":81,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n  2.0   0.0   4.0    3.0\n -2.0   0.0   2.0  -13.0\n  1.0  15.0   2.0   -4.5\n -4.0   5.0  -7.0  -10.0","content_type":"text/plain"}}}],"key":"IUqkkud6LK"}],"data":{},"key":"N7SmIQV4xo"},{"type":"paragraph","position":{"start":{"line":864,"column":1},"end":{"line":864,"column":1}},"children":[{"type":"text","value":"We now find the largest candidate pivot in the first column. We don’t care about sign, so we take absolute values before finding the max.","position":{"start":{"line":864,"column":1},"end":{"line":864,"column":1}},"key":"ydqy625vZr"}],"key":"svHWW6OAgU"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"gqQw6khnsG"}],"key":"K8BzLYjjsa"},{"type":"paragraph","position":{"start":{"line":867,"column":1},"end":{"line":867,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":867,"column":1},"end":{"line":867,"column":1}},"key":"hM8mqnVevO"},{"type":"inlineCode","value":"argmax","position":{"start":{"line":867,"column":1},"end":{"line":867,"column":1}},"key":"YY1hWfAlp7"},{"type":"text","value":" function returns the location of the largest element of a vector or matrix.","position":{"start":{"line":867,"column":1},"end":{"line":867,"column":1}},"key":"pmqBElqPam"}],"key":"Mukn1DEot5"}],"class":"dropdown","key":"uKeHyTKBmH"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"i = argmax( abs.(A₁[:, 1]) )","key":"l3S3n5OFOE"},{"type":"output","id":"wkc4brL2lvrAmPGQfP1z4","data":[{"output_type":"execute_result","execution_count":82,"metadata":{},"data":{"text/plain":{"content":"4","content_type":"text/plain"}}}],"key":"Itf1ocKQ5t"}],"data":{},"key":"YmAdal0o2R"},{"type":"paragraph","position":{"start":{"line":875,"column":1},"end":{"line":875,"column":1}},"children":[{"type":"text","value":"This is the row of the matrix that we extract to put into ","position":{"start":{"line":875,"column":1},"end":{"line":875,"column":1}},"key":"orcEI70pAF"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":875,"column":1},"end":{"line":875,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"TBzzE16lt8"},{"type":"text","value":". That guarantees that the division used to find ","position":{"start":{"line":875,"column":1},"end":{"line":875,"column":1}},"key":"uryfl0Mglj"},{"type":"inlineMath","value":"\\boldsymbol{\\ell}_1","position":{"start":{"line":875,"column":1},"end":{"line":875,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">ℓ</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\boldsymbol{\\ell}_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">ℓ</span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"D14u21bVFq"},{"type":"text","value":" will be valid.","position":{"start":{"line":875,"column":1},"end":{"line":875,"column":1}},"key":"AMSSaw9H6J"}],"key":"CZaWdCuZwL"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"L, U = zeros(4,4),zeros(4,4)\nU[1, :] = A₁[i, :]\nL[:, 1] = A₁[:, 1] / U[1, 1]\nA₂ = A₁ - L[:, 1] * U[1, :]'","key":"J0rO8QBwiE"},{"type":"output","id":"mwXlnKo-5vu22sXyxabsi","data":[{"output_type":"execute_result","execution_count":83,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n 0.0   2.5   0.5   -2.0\n 0.0  -2.5   5.5   -8.0\n 0.0  16.25  0.25  -7.0\n 0.0   0.0   0.0    0.0","content_type":"text/plain"}}}],"key":"qVBiKNb4kG"}],"data":{},"key":"tuBJn8Wyip"},{"type":"paragraph","position":{"start":{"line":884,"column":1},"end":{"line":884,"column":1}},"children":[{"type":"text","value":"Observe that ","position":{"start":{"line":884,"column":1},"end":{"line":884,"column":1}},"key":"tqdhQ3gRAy"},{"type":"inlineMath","value":"\\mathbf{A}_2","position":{"start":{"line":884,"column":1},"end":{"line":884,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">A</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8361em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"LnTcytRXuS"},{"type":"text","value":" has a new zero row and zero column, but the zero row is the fourth rather than the first. However, we forge on by using the largest possible pivot in column 2 for the next outer product.","position":{"start":{"line":884,"column":1},"end":{"line":884,"column":1}},"key":"K51T7KivAO"}],"key":"q6jKS5DIS4"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"@show i = argmax( abs.(A₂[:, 2]) ) \nU[2, :] = A₂[i, :]\nL[:, 2] = A₂[:, 2] / U[2, 2]\nA₃ = A₂ - L[:, 2] * U[2, :]'","key":"FxQK91PNon"},{"type":"output","id":"JzvExtjTga22oY2j_GO63","data":[{"output_type":"stream","name":"stdout","text":"i = argmax(abs.(A₂[:, 2])) = 3\n"},{"output_type":"execute_result","execution_count":84,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n 0.0  0.0  0.461538  -0.923077\n 0.0  0.0  5.53846   -9.07692\n 0.0  0.0  0.0        0.0\n 0.0  0.0  0.0        0.0","content_type":"text/plain"}}}],"key":"q1Tuo4XNPB"}],"data":{},"key":"c33j9zt8Vo"},{"type":"paragraph","position":{"start":{"line":893,"column":1},"end":{"line":893,"column":1}},"children":[{"type":"text","value":"Now we have zeroed out the third row as well as the second column. We can finish out the procedure.","position":{"start":{"line":893,"column":1},"end":{"line":893,"column":1}},"key":"TqCnxml1vi"}],"key":"dnkE0WJmXA"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"@show i = argmax( abs.(A₃[:, 3]) ) \nU[3, :] = A₃[i, :]\nL[:, 3] = A₃[:, 3] / U[3, 3]\nA₄ = A₃ - L[:, 3] * U[3, :]'","key":"z32eumrTJH"},{"type":"output","id":"lCGPoNtFxFmcVWNaNBgXr","data":[{"output_type":"stream","name":"stdout","text":"i = argmax(abs.(A₃[:, 3])) = 2\n"},{"output_type":"execute_result","execution_count":85,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n 0.0  0.0  0.0  -0.166667\n 0.0  0.0  0.0   0.0\n 0.0  0.0  0.0   0.0\n 0.0  0.0  0.0   0.0","content_type":"text/plain"}}}],"key":"xAz6Ep1RFm"}],"data":{},"key":"q0qHP6vX2P"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"@show i = argmax( abs.(A₄[:, 4]) ) \nU[4, :] = A₄[i, :]\nL[:, 4] = A₄[:, 4] / U[4, 4];","key":"MSGWZ0V4oj"},{"type":"output","id":"nDDtQG8V87I-2XbAZLeM2","data":[{"output_type":"stream","name":"stdout","text":"i = argmax(abs.(A₄[:, 4])) = 1\n"}],"key":"tfkiyvWnP0"}],"data":{},"key":"bwg5NKQWBz"},{"type":"paragraph","position":{"start":{"line":908,"column":1},"end":{"line":908,"column":1}},"children":[{"type":"text","value":"We do have a factorization of the original matrix:","position":{"start":{"line":908,"column":1},"end":{"line":908,"column":1}},"key":"sNmVxcIwOe"}],"key":"IYaPrl5tXg"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"A₁ - L * U","key":"lEBRxmFdoU"},{"type":"output","id":"zemYd7mKHKEq86r9HlxNh","data":[{"output_type":"execute_result","execution_count":87,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n 0.0  -1.38778e-16  0.0  0.0\n 0.0   1.38778e-16  0.0  0.0\n 0.0   0.0          0.0  0.0\n 0.0   0.0          0.0  0.0","content_type":"text/plain"}}}],"key":"F2RbD8VzQA"}],"data":{},"key":"ucaTIDoFeJ"},{"type":"paragraph","position":{"start":{"line":914,"column":1},"end":{"line":914,"column":1}},"children":[{"type":"text","value":"And ","position":{"start":{"line":914,"column":1},"end":{"line":914,"column":1}},"key":"qpI5N0d10T"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":914,"column":1},"end":{"line":914,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"oylPQDf5V9"},{"type":"text","value":" has the required structure:","position":{"start":{"line":914,"column":1},"end":{"line":914,"column":1}},"key":"FLLMbrCcS0"}],"key":"NKQYjUpML6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"U","key":"APSHezecuw"},{"type":"output","id":"6I2mMPorz_q1qNmylPBPc","data":[{"output_type":"execute_result","execution_count":88,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n -4.0   5.0   -7.0      -10.0\n  0.0  16.25   0.25      -7.0\n  0.0   0.0    5.53846   -9.07692\n  0.0   0.0    0.0       -0.166667","content_type":"text/plain"}}}],"key":"wswejCe7Lb"}],"data":{},"key":"ze0tR4rflg"},{"type":"paragraph","position":{"start":{"line":920,"column":1},"end":{"line":920,"column":1}},"children":[{"type":"text","value":"However, the triangularity of ","position":{"start":{"line":920,"column":1},"end":{"line":920,"column":1}},"key":"Kx25hmMBUj"},{"type":"inlineMath","value":"\\mathbf{L}","position":{"start":{"line":920,"column":1},"end":{"line":920,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">L</span></span></span></span>","key":"LYjFwIiMA3"},{"type":"text","value":" has been broken.","position":{"start":{"line":920,"column":1},"end":{"line":920,"column":1}},"key":"odymTFS0up"}],"key":"ZElS7iSC6H"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"L","key":"XGKm2jy5sH"},{"type":"output","id":"OAB0Z9nBeOrxaJjgQ4RRc","data":[{"output_type":"execute_result","execution_count":89,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n -0.5    0.153846  0.0833333   1.0\n  0.5   -0.153846  1.0        -0.0\n -0.25   1.0       0.0        -0.0\n  1.0    0.0       0.0        -0.0","content_type":"text/plain"}}}],"key":"mUtrhlhiPk"}],"data":{},"key":"rWKjiYc7hE"}],"key":"AFDpUw5eBH"}],"key":"WzlRTkv7HU"}],"key":"AO6U8xpY0S"},{"type":"tabItem","title":"MATLAB","sync":"matlab","children":[{"type":"embed","source":{"url":"/chapter2-1","label":"demo-pivoting-fix-matlab","kind":"Notebook","slug":"chapter2-1","location":"/matlab/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-pivoting-fix","label":"demo-pivoting-fix","kind":"proof:example","position":{"start":{"line":802,"column":1},"end":{"line":802,"column":19}},"children":[{"type":"text","value":"Example ","key":"wi6JHyMWhG"},{"type":"text","value":"2.6.2","key":"b9AUpheHDz"}],"template":"Example %s","enumerator":"2.6.2","resolved":true,"html_id":"demo-pivoting-fix","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"UPfBqqgJgc"}],"key":"GMuaT1TJIL"},{"type":"paragraph","position":{"start":{"line":803,"column":1},"end":{"line":803,"column":1}},"children":[{"type":"text","value":"Here is the trouble-making matrix from ","position":{"start":{"line":803,"column":1},"end":{"line":803,"column":1}},"key":"GykNZZn4dn"},{"type":"crossReference","kind":"proof:example","identifier":"demo-pivoting-fail","label":"demo-pivoting-fail","children":[{"type":"text","value":"Demo ","key":"CmDzBDS5jq"},{"type":"text","value":"2.6.1","key":"qECVD26ySB"}],"template":"Example %s","enumerator":"2.6.1","resolved":true,"html_id":"demo-pivoting-fail","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"ZnCzgjtciL"},{"type":"text","value":".","position":{"start":{"line":803,"column":1},"end":{"line":803,"column":1}},"key":"RPcDQYW2Sz"}],"key":"Wk3hAG80C0"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A_1 = [2 0 4 3; -2 0 2 -13; 1 15 2 -4.5; -4 5 -7 -10]","key":"rdvQPN1zG4"},{"type":"output","id":"4071V5Yo1lZ2bNhtG1Mf9","data":[{"output_type":"execute_result","execution_count":79,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>A_1 = 4×4 double\n   2.0000e+00            0   4.0000e+00   3.0000e+00\n  -2.0000e+00            0   2.0000e+00  -1.3000e+01\n   1.0000e+00   1.5000e+01   2.0000e+00  -4.5000e+00\n  -4.0000e+00   5.0000e+00  -7.0000e+00  -1.0000e+01\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"A_1 = 4×4 double\n   2.0000e+00            0   4.0000e+00   3.0000e+00\n  -2.0000e+00            0   2.0000e+00  -1.3000e+01\n   1.0000e+00   1.5000e+01   2.0000e+00  -4.5000e+00\n  -4.0000e+00   5.0000e+00  -7.0000e+00  -1.0000e+01\n","content_type":"text/plain"}}}],"key":"CTJL9oa5OC"}],"data":{},"key":"txeM9HWWKq"},{"type":"paragraph","position":{"start":{"line":812,"column":1},"end":{"line":812,"column":1}},"children":[{"type":"text","value":"We now find the largest candidate pivot in the first column. We don’t care about sign, so we take absolute values before finding the max.","position":{"start":{"line":812,"column":1},"end":{"line":812,"column":1}},"key":"xRyWzBtop5"}],"indexEntries":[{"entry":"MATLAB","subEntry":{"value":"max","kind":"entry"},"emphasis":true},{"entry":"MATLAB","subEntry":{"value":"\\~","kind":"entry"},"emphasis":true}],"key":"IXWxURJmQr"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"cTilCSUbSB"}],"key":"lctZOmtRZi"},{"type":"paragraph","position":{"start":{"line":815,"column":1},"end":{"line":815,"column":1}},"children":[{"type":"text","value":"The second output of ","position":{"start":{"line":815,"column":1},"end":{"line":815,"column":1}},"key":"FdQZgkV2k2"},{"type":"inlineCode","value":"max","position":{"start":{"line":815,"column":1},"end":{"line":815,"column":1}},"key":"ps59v0Dzog"},{"type":"text","value":" returns the location of the largest element of a vector. The ","position":{"start":{"line":815,"column":1},"end":{"line":815,"column":1}},"key":"TybHGLWvHd"},{"type":"inlineCode","value":"~","position":{"start":{"line":815,"column":1},"end":{"line":815,"column":1}},"key":"EUiCibJVKt"},{"type":"text","value":" symbol is used to ignore the value of the first output.","position":{"start":{"line":815,"column":1},"end":{"line":815,"column":1}},"key":"g9iCEeLyQ7"}],"key":"Y08msgBqN2"}],"class":"dropdown","key":"bRgA1sAjNq"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[~, i] = max( abs(A_1(:, 1)) )","key":"ZliPN3BkP1"},{"type":"output","id":"2vSoPJ-wjxJjswGdnj2UN","data":[{"output_type":"execute_result","execution_count":80,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>i = \n     4\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"i = \n     4\n","content_type":"text/plain"}}}],"key":"P5uSwrTN2X"}],"data":{},"key":"HygGzkFemX"},{"type":"paragraph","position":{"start":{"line":823,"column":1},"end":{"line":823,"column":1}},"children":[{"type":"text","value":"This is the row of the matrix that we extract to put into ","position":{"start":{"line":823,"column":1},"end":{"line":823,"column":1}},"key":"GNrMbaCHYd"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":823,"column":1},"end":{"line":823,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"cxaUDmsG7A"},{"type":"text","value":". That guarantees that the division used to find ","position":{"start":{"line":823,"column":1},"end":{"line":823,"column":1}},"key":"k8tksYs3v0"},{"type":"inlineMath","value":"\\boldsymbol{\\ell}_1","position":{"start":{"line":823,"column":1},"end":{"line":823,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">ℓ</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\boldsymbol{\\ell}_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">ℓ</span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"egTEvmKBS1"},{"type":"text","value":" will be valid.","position":{"start":{"line":823,"column":1},"end":{"line":823,"column":1}},"key":"edWpq8CtS0"}],"key":"pSGXmjtY9S"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"L = zeros(4, 4);\nU = zeros(4, 4);\nU(1, :) = A_1(i, :);\nL(:, 1) = A_1(:, 1) / U(1, 1);\nA_2 = A_1 - L(:, 1) * U(1, :)","key":"H1kWfUAUnG"},{"type":"output","id":"OKeAgEbgAAe9wHM_IyIlF","data":[{"output_type":"execute_result","execution_count":81,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>A_2 = 4×4 double\n            0   2.5000e+00   5.0000e-01  -2.0000e+00\n            0  -2.5000e+00   5.5000e+00  -8.0000e+00\n            0   1.6250e+01   2.5000e-01  -7.0000e+00\n            0            0            0            0\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"A_2 = 4×4 double\n            0   2.5000e+00   5.0000e-01  -2.0000e+00\n            0  -2.5000e+00   5.5000e+00  -8.0000e+00\n            0   1.6250e+01   2.5000e-01  -7.0000e+00\n            0            0            0            0\n","content_type":"text/plain"}}}],"key":"xlnlziM9MK"}],"data":{},"key":"lNasMY6VwU"},{"type":"paragraph","position":{"start":{"line":833,"column":1},"end":{"line":833,"column":1}},"children":[{"type":"text","value":"Observe that ","position":{"start":{"line":833,"column":1},"end":{"line":833,"column":1}},"key":"G23gtSb8A2"},{"type":"inlineMath","value":"\\mathbf{A}_2","position":{"start":{"line":833,"column":1},"end":{"line":833,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">A</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8361em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"eS3uZEm3b6"},{"type":"text","value":" has a new zero row and zero column, but the zero row is the fourth rather than the first. However, we forge on by using the largest possible pivot in column 2 for the next outer product.","position":{"start":{"line":833,"column":1},"end":{"line":833,"column":1}},"key":"kJVeNp43yE"}],"key":"yqSKU9YIpF"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[~, i] = max( abs(A_2(:, 2)) )\nU(2, :) = A_2(i, :);\nL(:, 2) = A_2(:, 2) / U(2, 2);\nA_3 = A_2 - L(:, 2) * U(2, :)","key":"JX9qtBm2EM"},{"type":"output","id":"VMQrVAo8XsmgCa4mZrdIk","data":[{"output_type":"execute_result","execution_count":82,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>i = \n     3\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"i = \n     3\n","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":82,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>A_3 = 4×4 double\n            0            0   4.6154e-01  -9.2308e-01\n            0            0   5.5385e+00  -9.0769e+00\n            0            0            0            0\n            0            0            0            0\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"A_3 = 4×4 double\n            0            0   4.6154e-01  -9.2308e-01\n            0            0   5.5385e+00  -9.0769e+00\n            0            0            0            0\n            0            0            0            0\n","content_type":"text/plain"}}}],"key":"rJbIV6xCg9"}],"data":{},"key":"GjwhsMmWot"},{"type":"paragraph","position":{"start":{"line":842,"column":1},"end":{"line":842,"column":1}},"children":[{"type":"text","value":"Now we have zeroed out the third row as well as the second column. We can finish out the procedure.","position":{"start":{"line":842,"column":1},"end":{"line":842,"column":1}},"key":"YHc0nKqaq5"}],"key":"GSSNYWsiS4"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[~, i] = max( abs(A_3(:, 3)) ) \nU(3, :) = A_3(i, :);\nL(:, 3) = A_3(:, 3) / U(3, 3);\nA_4 = A_3 - L(:, 3) * U(3, :)","key":"afwL9mpoFR"},{"type":"output","id":"KKNBsUbwxmNj-YczeeXAc","data":[{"output_type":"execute_result","execution_count":83,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>i = \n     2\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"i = \n     2\n","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":83,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>A_4 = 4×4 double\n            0            0            0  -1.6667e-01\n            0            0            0            0\n            0            0            0            0\n            0            0            0            0\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"A_4 = 4×4 double\n            0            0            0  -1.6667e-01\n            0            0            0            0\n            0            0            0            0\n            0            0            0            0\n","content_type":"text/plain"}}}],"key":"QB7BIDRbZ1"}],"data":{},"key":"k27q7j1oTs"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[~, i] = max( abs(A_4(:, 4)) ) \nU(4, :) = A_4(i, :);\nL(:, 4) = A_4(:, 4) / U(4, 4);","key":"l0Vtu4Xdcb"},{"type":"output","id":"LYLXSnRdysoEUhwo8OYLs","data":[{"output_type":"execute_result","execution_count":84,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>i = \n     1\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"i = \n     1\n","content_type":"text/plain"}}}],"key":"JojRQ0MAVK"}],"data":{},"key":"FZpYTGyYMm"},{"type":"paragraph","position":{"start":{"line":857,"column":1},"end":{"line":857,"column":1}},"children":[{"type":"text","value":"We do have a factorization of the original matrix:","position":{"start":{"line":857,"column":1},"end":{"line":857,"column":1}},"key":"y963vhb1XL"}],"key":"l8JJgnnAYl"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A_1 - L * U","key":"sbqu51scfA"},{"type":"output","id":"XvW6WYYnq96YUgHGd9pEz","data":[{"output_type":"execute_result","execution_count":85,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = 4×4 double\n     0     0     0     0\n     0     0     0     0\n     0     0     0     0\n     0     0     0     0\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = 4×4 double\n     0     0     0     0\n     0     0     0     0\n     0     0     0     0\n     0     0     0     0\n","content_type":"text/plain"}}}],"key":"scwFyRcC5T"}],"data":{},"key":"iTe8cYHpBp"},{"type":"paragraph","position":{"start":{"line":863,"column":1},"end":{"line":863,"column":1}},"children":[{"type":"text","value":"And ","position":{"start":{"line":863,"column":1},"end":{"line":863,"column":1}},"key":"kkxH0oeuWo"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":863,"column":1},"end":{"line":863,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"DdshgqRUmi"},{"type":"text","value":" has the required structure:","position":{"start":{"line":863,"column":1},"end":{"line":863,"column":1}},"key":"OV1SqnkO6t"}],"key":"qZ5CPrz0uc"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"U","key":"nHcDqsoIwo"},{"type":"output","id":"P057vcfI5jHHRrbGxvzCD","data":[{"output_type":"execute_result","execution_count":86,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>U = 4×4 double\n  -4.0000e+00   5.0000e+00  -7.0000e+00  -1.0000e+01\n            0   1.6250e+01   2.5000e-01  -7.0000e+00\n            0            0   5.5385e+00  -9.0769e+00\n            0            0            0  -1.6667e-01\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"U = 4×4 double\n  -4.0000e+00   5.0000e+00  -7.0000e+00  -1.0000e+01\n            0   1.6250e+01   2.5000e-01  -7.0000e+00\n            0            0   5.5385e+00  -9.0769e+00\n            0            0            0  -1.6667e-01\n","content_type":"text/plain"}}}],"key":"v7HwHFsJ9r"}],"data":{},"key":"NKqhK5rQSc"},{"type":"paragraph","position":{"start":{"line":869,"column":1},"end":{"line":869,"column":1}},"children":[{"type":"text","value":"However, the triangularity of ","position":{"start":{"line":869,"column":1},"end":{"line":869,"column":1}},"key":"evZpOjWhA2"},{"type":"inlineMath","value":"\\mathbf{L}","position":{"start":{"line":869,"column":1},"end":{"line":869,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">L</span></span></span></span>","key":"VQySIH3s4e"},{"type":"text","value":" has been broken.","position":{"start":{"line":869,"column":1},"end":{"line":869,"column":1}},"key":"t4BWoeHUhB"}],"key":"SC9Jxjqqtj"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"L","key":"gc1Nx0CQdm"},{"type":"output","id":"cuFdxv3Hh5YNrlm3TawS2","data":[{"output_type":"execute_result","execution_count":87,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>L = 4×4 double\n  -5.0000e-01   1.5385e-01   8.3333e-02   1.0000e+00\n   5.0000e-01  -1.5385e-01   1.0000e+00            0\n  -2.5000e-01   1.0000e+00            0            0\n   1.0000e+00            0            0            0\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"L = 4×4 double\n  -5.0000e-01   1.5385e-01   8.3333e-02   1.0000e+00\n   5.0000e-01  -1.5385e-01   1.0000e+00            0\n  -2.5000e-01   1.0000e+00            0            0\n   1.0000e+00            0            0            0\n","content_type":"text/plain"}}}],"key":"w0HYjCQIR4"}],"data":{},"key":"BIMJpkhh49"}],"key":"r8IjqheZK6"}],"key":"qJw2M3wN0o"}],"key":"vg1ySSX1PO"},{"type":"tabItem","title":"Python","sync":"python","children":[{"type":"embed","source":{"url":"/chapter2-2","label":"demo-pivoting-fix-python","kind":"Notebook","slug":"chapter2-2","location":"/python/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-pivoting-fix","label":"demo-pivoting-fix","kind":"proof:example","position":{"start":{"line":773,"column":1},"end":{"line":773,"column":19}},"children":[{"type":"text","value":"Example ","key":"Vuv5Wgtmwh"},{"type":"text","value":"2.6.2","key":"UfwJb5pc1d"}],"template":"Example %s","enumerator":"2.6.2","resolved":true,"html_id":"demo-pivoting-fix","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"jIBDBcf0Vv"}],"key":"cMBDjBYIg2"},{"type":"paragraph","position":{"start":{"line":774,"column":1},"end":{"line":774,"column":1}},"children":[{"type":"text","value":"Here is the trouble-making matrix from ","position":{"start":{"line":774,"column":1},"end":{"line":774,"column":1}},"key":"l6pptxPDZ4"},{"type":"crossReference","kind":"proof:example","identifier":"demo-pivoting-fail","label":"demo-pivoting-fail","children":[{"type":"text","value":"Demo ","key":"BzavqLSZAf"},{"type":"text","value":"2.6.1","key":"pOqmyuapJ6"}],"template":"Example %s","enumerator":"2.6.1","resolved":true,"html_id":"demo-pivoting-fail","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"iAmBczY3Jd"},{"type":"text","value":".","position":{"start":{"line":774,"column":1},"end":{"line":774,"column":1}},"key":"rC0IjgBx0b"}],"key":"fq7zb218QH"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"A_1 = array([\n    [2, 0, 4, 3],\n    [-2, 0, 2, -13],\n    [1, 15, 2, -4.5],\n    [-4, 5, -7, -10]\n    ])","key":"RtIejv8cDe"},{"type":"output","id":"6MPTqQem_5amODUHZBO2L","data":[],"key":"AyGyY4QOuI"}],"data":{},"key":"ZO1qBNKEw6"},{"type":"paragraph","position":{"start":{"line":785,"column":1},"end":{"line":785,"column":1}},"children":[{"type":"text","value":"We now find the largest candidate pivot in the first column. We don’t care about sign, so we take absolute values before finding the max.","position":{"start":{"line":785,"column":1},"end":{"line":785,"column":1}},"key":"TrBMoFEOtu"}],"key":"OSkej52fLq"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"r4ygxcdAiB"}],"key":"zqrUS5lyIJ"},{"type":"paragraph","position":{"start":{"line":788,"column":1},"end":{"line":788,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":788,"column":1},"end":{"line":788,"column":1}},"key":"UaLplG1cbh"},{"type":"inlineCode","value":"argmax","position":{"start":{"line":788,"column":1},"end":{"line":788,"column":1}},"key":"LEIUkVnVEY"},{"type":"text","value":" function returns the location of the largest element of a vector or matrix.","position":{"start":{"line":788,"column":1},"end":{"line":788,"column":1}},"key":"sYNbaWaCun"}],"key":"f8XJ3HvV3A"}],"class":"dropdown","key":"VnqbZROPNj"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"i = argmax( abs(A_1[:, 0]) )\nprint(i)","key":"ObOVbAMiog"},{"type":"output","id":"Fyt0NU_JwRRiuGZ-Qjkjz","data":[{"output_type":"stream","name":"stdout","text":"3\n"}],"key":"mDho5jVBMv"}],"data":{},"key":"VKIGVwZ8IA"},{"type":"paragraph","position":{"start":{"line":797,"column":1},"end":{"line":797,"column":1}},"children":[{"type":"text","value":"This is the row of the matrix that we extract to put into ","position":{"start":{"line":797,"column":1},"end":{"line":797,"column":1}},"key":"kA8pI8tdEp"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":797,"column":1},"end":{"line":797,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"eeO84omJrF"},{"type":"text","value":". That guarantees that the division used to find ","position":{"start":{"line":797,"column":1},"end":{"line":797,"column":1}},"key":"oTY9gYfBuD"},{"type":"inlineMath","value":"\\boldsymbol{\\ell}_1","position":{"start":{"line":797,"column":1},"end":{"line":797,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">ℓ</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\boldsymbol{\\ell}_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">ℓ</span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"vYOv065eaZ"},{"type":"text","value":" will be valid.","position":{"start":{"line":797,"column":1},"end":{"line":797,"column":1}},"key":"MWxcxu6iv4"}],"key":"lfNMtDV5c6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"L, U = eye(4), zeros((4, 4))\nU[0, :] = A_1[i, :]\nL[:, 0] = A_1[:, 0] / U[0, 0]\nA_2 = A_1 - outer(L[:, 0], U[0, :])\nprint(A_2)","key":"QDT7G3tobs"},{"type":"output","id":"9H0_j0PSqw1yQ0k9Re3zR","data":[{"output_type":"stream","name":"stdout","text":"[[ 0.    2.5   0.5  -2.  ]\n [ 0.   -2.5   5.5  -8.  ]\n [ 0.   16.25  0.25 -7.  ]\n [ 0.    0.    0.    0.  ]]\n"}],"key":"VK0hOcB57T"}],"data":{},"key":"B3OpSIESWO"},{"type":"paragraph","position":{"start":{"line":807,"column":1},"end":{"line":807,"column":1}},"children":[{"type":"text","value":"Observe that ","position":{"start":{"line":807,"column":1},"end":{"line":807,"column":1}},"key":"Rz1TAE7T0a"},{"type":"inlineMath","value":"\\mathbf{A}_2","position":{"start":{"line":807,"column":1},"end":{"line":807,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">A</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8361em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"qC0gdhCJU5"},{"type":"text","value":" has a new zero row and zero column, but the zero row is the fourth rather than the first. However, we forge on by using the largest possible pivot in column 2 for the next outer product.","position":{"start":{"line":807,"column":1},"end":{"line":807,"column":1}},"key":"ZBP5uNEMPv"}],"key":"ML4E7XXPRo"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"i = argmax( abs(A_2[:, 1]) ) \nprint(f\"new pivot row is {i}\")\nU[1, :] = A_2[i, :]\nL[:, 1] = A_2[:, 1] / U[1, 1]\nA_3 = A_2 - outer(L[:, 1], U[1, :])\nprint(A_3)","key":"bw3Al9UGXG"},{"type":"output","id":"I4zqUmb7JKsnFWfkiPCH2","data":[{"output_type":"stream","name":"stdout","text":"new pivot row is 2\n[[ 0.          0.          0.46153846 -0.92307692]\n [ 0.          0.          5.53846154 -9.07692308]\n [ 0.          0.          0.          0.        ]\n [ 0.          0.          0.          0.        ]]\n"}],"key":"i45bYFStrK"}],"data":{},"key":"n02CGdXUBh"},{"type":"paragraph","position":{"start":{"line":817,"column":1},"end":{"line":817,"column":1}},"children":[{"type":"text","value":"Now we have zeroed out the third row as well as the second column. We can finish out the procedure.","position":{"start":{"line":817,"column":1},"end":{"line":817,"column":1}},"key":"z6l60IArna"}],"key":"gbdcwidrlL"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"i = argmax( abs(A_3[:, 2]) ) \nprint(f\"new pivot row is {i}\")\nU[2, :] = A_3[i, :]\nL[:, 2] = A_3[:, 2] / U[2, 2]\nA_4 = A_3 - outer(L[:, 2], U[2, :])\nprint(A_4)","key":"EoR0j3Tgks"},{"type":"output","id":"Flq2IwVTNbtF3ZSSkREna","data":[{"output_type":"stream","name":"stdout","text":"new pivot row is 1\n[[ 0.          0.          0.         -0.16666667]\n [ 0.          0.          0.          0.        ]\n [ 0.          0.          0.          0.        ]\n [ 0.          0.          0.          0.        ]]\n"}],"key":"ToXSHlV7zJ"}],"data":{},"key":"E4FERvuIM1"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"i = argmax( abs(A_4[:, 3]) ) \nprint(f\"new pivot row is {i}\")\nU[3, :] = A_4[i, :]\nL[:, 3] = A_4[:, 3] / U[3, 3];","key":"M4Ar924Sns"},{"type":"output","id":"b9JXTpzD6vN-wnIpzKQHg","data":[{"output_type":"stream","name":"stdout","text":"new pivot row is 0\n"}],"key":"BN2DF5VIaP"}],"data":{},"key":"zp09owQtr9"},{"type":"paragraph","position":{"start":{"line":835,"column":1},"end":{"line":835,"column":1}},"children":[{"type":"text","value":"We do have a factorization of the original matrix:","position":{"start":{"line":835,"column":1},"end":{"line":835,"column":1}},"key":"yaVytEAGJa"}],"key":"ufWAM1Edm3"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"A_1 - L @ U","key":"xqqLhVkljD"},{"type":"output","id":"x2IZARH-slVvFCtA60LPf","data":[{"output_type":"execute_result","execution_count":222,"metadata":{},"data":{"text/plain":{"content":"array([[0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00],\n       [0.00000000e+00, 0.00000000e+00, 2.22044605e-16, 0.00000000e+00],\n       [0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00],\n       [0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00]])","content_type":"text/plain"}}}],"key":"z1xh0M2IqO"}],"data":{},"key":"mmrivkt6rR"},{"type":"paragraph","position":{"start":{"line":841,"column":1},"end":{"line":841,"column":1}},"children":[{"type":"text","value":"And ","position":{"start":{"line":841,"column":1},"end":{"line":841,"column":1}},"key":"AofNSTwN6L"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":841,"column":1},"end":{"line":841,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"mhA9iZW64c"},{"type":"text","value":" has the required structure:","position":{"start":{"line":841,"column":1},"end":{"line":841,"column":1}},"key":"Apj5R4JClV"}],"key":"QDxtrGOJTA"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(U)","key":"Smx7xeddXz"},{"type":"output","id":"1KXq9dvwUTQb3Xbkmy4Sy","data":[{"output_type":"stream","name":"stdout","text":"[[ -4.           5.          -7.         -10.        ]\n [  0.          16.25         0.25        -7.        ]\n [  0.           0.           5.53846154  -9.07692308]\n [  0.           0.           0.          -0.16666667]]\n"}],"key":"yfvo8YGJDZ"}],"data":{},"key":"Xsk6idKXM3"},{"type":"paragraph","position":{"start":{"line":847,"column":1},"end":{"line":847,"column":1}},"children":[{"type":"text","value":"However, the triangularity of ","position":{"start":{"line":847,"column":1},"end":{"line":847,"column":1}},"key":"zFiYoDPiat"},{"type":"inlineMath","value":"\\mathbf{L}","position":{"start":{"line":847,"column":1},"end":{"line":847,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">L</span></span></span></span>","key":"ElFsmVKN9a"},{"type":"text","value":" has been broken.","position":{"start":{"line":847,"column":1},"end":{"line":847,"column":1}},"key":"jurih68RG2"}],"key":"pNBDF2ToyU"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(L)","key":"FEeNjz0Q5L"},{"type":"output","id":"qZ9Erh3lvzu6pAPjCPO70","data":[{"output_type":"stream","name":"stdout","text":"[[-0.5         0.15384615  0.08333333  1.        ]\n [ 0.5        -0.15384615  1.         -0.        ]\n [-0.25        1.          0.         -0.        ]\n [ 1.          0.          0.         -0.        ]]\n"}],"key":"Z4pRo1MBIx"}],"data":{},"key":"bxqu78hv5p"}],"key":"CxMOhzh2bI"}],"key":"p5YWGHKbd2"}],"key":"HzxFhGJRHH"}],"key":"B0ccr7hBxw"}],"label":"demo-pivoting-fix","identifier":"demo-pivoting-fix","html_id":"demo-pivoting-fix","enumerator":"2.6.2","key":"fssyfYQTv2"},{"type":"paragraph","position":{"start":{"line":73,"column":1},"end":{"line":73,"column":1}},"children":[{"type":"text","value":"We will return to the loss of triangularity in ","position":{"start":{"line":73,"column":1},"end":{"line":73,"column":1}},"key":"YWKvDPOa5f"},{"type":"inlineMath","value":"\\mathbf{L}","position":{"start":{"line":73,"column":1},"end":{"line":73,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">L</span></span></span></span>","key":"VxTdjq9mnc"},{"type":"text","value":" momentarily. First, though, there is a question left to answer: what if at some stage, all the elements of the targeted column are zero, i.e., there are no available pivots? Fortunately that loose end ties up nicely, although a proof is a bit beyond our scope here.","position":{"start":{"line":73,"column":1},"end":{"line":73,"column":1}},"key":"gcV8O7Mnpo"}],"key":"ZGb0U4gxuX"},{"type":"proof","kind":"theorem","enumerated":true,"children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Row pivoting","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"key":"F6mBwxVbRw"}],"key":"y4TYu8mig6"},{"type":"paragraph","position":{"start":{"line":77,"column":1},"end":{"line":77,"column":1}},"children":[{"type":"text","value":"The row-pivoted LU factorization runs to completion if and only if the original matrix is invertible.","position":{"start":{"line":77,"column":1},"end":{"line":77,"column":1}},"key":"mqcvSVRA9D"}],"key":"bKMYf1cJPJ"}],"label":"theorem-pivot","identifier":"theorem-pivot","html_id":"theorem-pivot","enumerator":"2.6.1","key":"RNPAaxNQ6d"},{"type":"paragraph","position":{"start":{"line":80,"column":1},"end":{"line":80,"column":1}},"children":[{"type":"text","value":"A linear system with a singular matrix has either no solution or infinitely many solutions. Either way, a technique other than LU factorization is needed to handle it.","position":{"start":{"line":80,"column":1},"end":{"line":80,"column":1}},"key":"y1AjP4B2EB"}],"key":"nFARH4zHGt"},{"type":"heading","depth":2,"position":{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},"children":[{"type":"text","value":"Permutations","position":{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},"key":"ncKExyUqFp"}],"identifier":"permutations","label":"Permutations","html_id":"permutations","implicit":true,"enumerator":"2.6.2","key":"YKAtBbv3fN"},{"type":"paragraph","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"children":[{"type":"text","value":"Even though the resulting ","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"key":"JwbAKw7J8m"},{"type":"inlineMath","value":"\\mathbf{L}","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">L</span></span></span></span>","key":"X2Y4QJW8WY"},{"type":"text","value":" in ","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"key":"KXoTll0CdI"},{"type":"crossReference","kind":"proof:example","identifier":"demo-pivoting-fix","label":"demo-pivoting-fix","children":[{"type":"text","value":"Demo ","key":"k8Pt4w1MOs"},{"type":"text","value":"2.6.2","key":"FG3V83ECtR"}],"template":"Example %s","enumerator":"2.6.2","resolved":true,"html_id":"demo-pivoting-fix","key":"uzVW57OPEY"},{"type":"text","value":" is no longer of unit lower triangular form, it is close. In fact, all that is needed is to reverse the order of its rows.","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"key":"rpHpfuc6kx"}],"key":"GBf0ybyFTa"},{"type":"proof","kind":"example","enumerated":true,"children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Pivoting as row permutation","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"Gxhyic818s"}],"key":"iGhswoIfkK"},{"type":"tabSet","children":[{"type":"tabItem","title":"Julia","sync":"julia","children":[{"type":"embed","source":{"url":"/chapter2","label":"demo-pivoting-permute-julia","kind":"Notebook","slug":"chapter2","location":"/julia/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-pivoting-permute","label":"demo-pivoting-permute","kind":"proof:example","position":{"start":{"line":928,"column":1},"end":{"line":928,"column":23}},"children":[{"type":"text","value":"Example ","key":"nvkrAmttig"},{"type":"text","value":"2.6.3","key":"UaDHrroeXT"}],"template":"Example %s","enumerator":"2.6.3","resolved":true,"html_id":"demo-pivoting-permute","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"RbcgcCVzV5"}],"key":"AN7TqWOpfW"},{"type":"paragraph","position":{"start":{"line":929,"column":1},"end":{"line":929,"column":1}},"children":[{"type":"text","value":"Here again is the matrix from ","position":{"start":{"line":929,"column":1},"end":{"line":929,"column":1}},"key":"SqPyZ630Dd"},{"type":"crossReference","kind":"proof:example","identifier":"demo-pivoting-fix","label":"demo-pivoting-fix","children":[{"type":"text","value":"Demo ","key":"BZ8MaWTmvR"},{"type":"text","value":"2.6.2","key":"nylXBQGCWK"}],"template":"Example %s","enumerator":"2.6.2","resolved":true,"html_id":"demo-pivoting-fix","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"rLxsmBDq4q"},{"type":"text","value":".","position":{"start":{"line":929,"column":1},"end":{"line":929,"column":1}},"key":"znyt7wX4n4"}],"key":"FSRNHEmMfq"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"A = [2 0 4 3 ; -2 0 2 -13; 1 15 2 -4.5 ; -4 5 -7 -10]","key":"NWRBl3Vo3k"},{"type":"output","id":"lJIzWUqFf74TvmgbASWeh","data":[{"output_type":"execute_result","execution_count":90,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n  2.0   0.0   4.0    3.0\n -2.0   0.0   2.0  -13.0\n  1.0  15.0   2.0   -4.5\n -4.0   5.0  -7.0  -10.0","content_type":"text/plain"}}}],"key":"njkz2WoWe8"}],"data":{},"key":"luCVx1tMld"},{"type":"paragraph","position":{"start":{"line":935,"column":1},"end":{"line":935,"column":1}},"children":[{"type":"text","value":"As the factorization proceeded, the pivots were selected from rows 4, 3, 2, and finally 1. If we were to put the rows of ","position":{"start":{"line":935,"column":1},"end":{"line":935,"column":1}},"key":"RoJnVw5i8g"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":935,"column":1},"end":{"line":935,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"oQd2bpfKam"},{"type":"text","value":" into that order, then the algorithm would run exactly like the plain LU factorization from ","position":{"start":{"line":935,"column":1},"end":{"line":935,"column":1}},"key":"eGL2JQG49c"},{"type":"link","kind":"numref","url":"/lu","internal":true,"dataUrl":"/lu.json","children":[{"type":"text","value":"LU factorization","key":"URP9jHnTUN"}],"key":"BNiFFTyuF3"},{"type":"text","value":".","position":{"start":{"line":935,"column":1},"end":{"line":935,"column":1}},"key":"ADVwC79mfs"}],"key":"PATuecoSIg"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"B = A[[4, 3, 2, 1], :]\nL, U = FNC.lufact(B);","key":"LR6Nx0hrrK"},{"type":"output","id":"SWObUfTsjvX2w80wZpD3A","data":[],"key":"gcBUG7dVJ8"}],"data":{},"key":"Y1MGGDbt7U"},{"type":"paragraph","position":{"start":{"line":942,"column":1},"end":{"line":942,"column":1}},"children":[{"type":"text","value":"We obtain the same ","position":{"start":{"line":942,"column":1},"end":{"line":942,"column":1}},"key":"u7F4aunLd8"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":942,"column":1},"end":{"line":942,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"BV8OhTEWV7"},{"type":"text","value":" as before:","position":{"start":{"line":942,"column":1},"end":{"line":942,"column":1}},"key":"JiEHv2zZTR"}],"key":"m8dHqjW8vi"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"U","key":"NDCESrOE5t"},{"type":"output","id":"JMGJL7Mklgt1bq8uY_kW2","data":[{"output_type":"execute_result","execution_count":92,"metadata":{},"data":{"text/plain":{"content":"4×4 UpperTriangular{Float64, Matrix{Float64}}:\n -4.0   5.0   -7.0      -10.0\n   ⋅   16.25   0.25      -7.0\n   ⋅     ⋅     5.53846   -9.07692\n   ⋅     ⋅      ⋅        -0.166667","content_type":"text/plain"}}}],"key":"t56hQGexiU"}],"data":{},"key":"kX9r6KVqRZ"},{"type":"paragraph","position":{"start":{"line":948,"column":1},"end":{"line":948,"column":1}},"children":[{"type":"text","value":"And ","position":{"start":{"line":948,"column":1},"end":{"line":948,"column":1}},"key":"E3asDosLSK"},{"type":"inlineMath","value":"\\mathbf{L}","position":{"start":{"line":948,"column":1},"end":{"line":948,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">L</span></span></span></span>","key":"zzqghN4Zh5"},{"type":"text","value":" has the same rows as before, but arranged into triangular order:","position":{"start":{"line":948,"column":1},"end":{"line":948,"column":1}},"key":"LMvl7ymn4W"}],"key":"fRZCrE3k79"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"L","key":"CiF4OyBqrW"},{"type":"output","id":"e1ymwdOyAUcWnHJVlcPY4","data":[{"output_type":"execute_result","execution_count":93,"metadata":{},"data":{"text/plain":{"content":"4×4 LowerTriangular{Float64, Matrix{Float64}}:\n  1.0     ⋅         ⋅          ⋅ \n -0.25   1.0        ⋅          ⋅ \n  0.5   -0.153846  1.0         ⋅ \n -0.5    0.153846  0.0833333  1.0","content_type":"text/plain"}}}],"key":"TjVXU7hRXq"}],"data":{},"key":"K12D6kC9DT"}],"key":"MxuUVoolt3"}],"key":"sXGYEfDlIx"}],"key":"jJ6YQxXYkC"},{"type":"tabItem","title":"MATLAB","sync":"matlab","children":[{"type":"embed","source":{"url":"/chapter2-1","label":"demo-pivoting-permute-matlab","kind":"Notebook","slug":"chapter2-1","location":"/matlab/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-pivoting-permute","label":"demo-pivoting-permute","kind":"proof:example","position":{"start":{"line":877,"column":1},"end":{"line":877,"column":23}},"children":[{"type":"text","value":"Example ","key":"rSEZ3ShZsC"},{"type":"text","value":"2.6.3","key":"NtnWRmFp4v"}],"template":"Example %s","enumerator":"2.6.3","resolved":true,"html_id":"demo-pivoting-permute","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"fVSrAebxFH"}],"key":"NLWI6qf53J"},{"type":"paragraph","position":{"start":{"line":878,"column":1},"end":{"line":878,"column":1}},"children":[{"type":"text","value":"Here again is the matrix from ","position":{"start":{"line":878,"column":1},"end":{"line":878,"column":1}},"key":"Aqq9HN422n"},{"type":"crossReference","kind":"proof:example","identifier":"demo-pivoting-fix","label":"demo-pivoting-fix","children":[{"type":"text","value":"Demo ","key":"DoOiDF52Ta"},{"type":"text","value":"2.6.2","key":"MGZWZdpsRG"}],"template":"Example %s","enumerator":"2.6.2","resolved":true,"html_id":"demo-pivoting-fix","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"nPk2MbqN9w"},{"type":"text","value":".","position":{"start":{"line":878,"column":1},"end":{"line":878,"column":1}},"key":"JurbimGY31"}],"key":"pFD0z2M4du"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A = [2 0 4 3; -2 0 2 -13; 1 15 2 -4.5; -4 5 -7 -10]","key":"HiSRqNmWI9"},{"type":"output","id":"EScYWBTcZ5hBtwyQnmQ6U","data":[{"output_type":"execute_result","execution_count":88,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>A = 4×4 double\n   2.0000e+00            0   4.0000e+00   3.0000e+00\n  -2.0000e+00            0   2.0000e+00  -1.3000e+01\n   1.0000e+00   1.5000e+01   2.0000e+00  -4.5000e+00\n  -4.0000e+00   5.0000e+00  -7.0000e+00  -1.0000e+01\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"A = 4×4 double\n   2.0000e+00            0   4.0000e+00   3.0000e+00\n  -2.0000e+00            0   2.0000e+00  -1.3000e+01\n   1.0000e+00   1.5000e+01   2.0000e+00  -4.5000e+00\n  -4.0000e+00   5.0000e+00  -7.0000e+00  -1.0000e+01\n","content_type":"text/plain"}}}],"key":"TLagoYWgPL"}],"data":{},"key":"xh5u1ALRxL"},{"type":"paragraph","position":{"start":{"line":884,"column":1},"end":{"line":884,"column":1}},"children":[{"type":"text","value":"As the factorization proceeded, the pivots were selected from rows 4, 3, 2, and finally 1. If we were to put the rows of ","position":{"start":{"line":884,"column":1},"end":{"line":884,"column":1}},"key":"QSrvN4UgIT"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":884,"column":1},"end":{"line":884,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"pFMVNhAc6Q"},{"type":"text","value":" into that order, then the algorithm would run exactly like the plain LU factorization from ","position":{"start":{"line":884,"column":1},"end":{"line":884,"column":1}},"key":"QDaa5Ne3Ao"},{"type":"link","kind":"numref","url":"/lu","internal":true,"dataUrl":"/lu.json","children":[{"type":"text","value":"LU factorization","key":"Nmaym1PRIV"}],"key":"xZtolFJNFf"},{"type":"text","value":".","position":{"start":{"line":884,"column":1},"end":{"line":884,"column":1}},"key":"BDrMglQFqj"}],"key":"mNAI4dApCz"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"B = A([4, 3, 2, 1], :);\n[L, U] = lufact(B);","key":"Q5d7VmLeH5"},{"type":"output","id":"Xx_IE1rmHq-0isq99ihtu","data":[],"key":"YDmkK3pAZD"}],"data":{},"key":"ZPd2KO5462"},{"type":"paragraph","position":{"start":{"line":891,"column":1},"end":{"line":891,"column":1}},"children":[{"type":"text","value":"We obtain the same ","position":{"start":{"line":891,"column":1},"end":{"line":891,"column":1}},"key":"FDUKoRnSAA"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":891,"column":1},"end":{"line":891,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"dRxQBRDl9w"},{"type":"text","value":" as before:","position":{"start":{"line":891,"column":1},"end":{"line":891,"column":1}},"key":"lsZHpbDPts"}],"key":"U5PqTBB4JS"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"U","key":"JSDdwb0OsV"},{"type":"output","id":"CN-4H0pu8IqnoKT4xx4sQ","data":[{"output_type":"execute_result","execution_count":90,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>U = 4×4 double\n  -4.0000e+00   5.0000e+00  -7.0000e+00  -1.0000e+01\n            0   1.6250e+01   2.5000e-01  -7.0000e+00\n            0            0   5.5385e+00  -9.0769e+00\n            0            0            0  -1.6667e-01\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"U = 4×4 double\n  -4.0000e+00   5.0000e+00  -7.0000e+00  -1.0000e+01\n            0   1.6250e+01   2.5000e-01  -7.0000e+00\n            0            0   5.5385e+00  -9.0769e+00\n            0            0            0  -1.6667e-01\n","content_type":"text/plain"}}}],"key":"EMbzAyRiDg"}],"data":{},"key":"HF3g8v7m1F"},{"type":"paragraph","position":{"start":{"line":897,"column":1},"end":{"line":897,"column":1}},"children":[{"type":"text","value":"And ","position":{"start":{"line":897,"column":1},"end":{"line":897,"column":1}},"key":"ZXQkhDBDXj"},{"type":"inlineMath","value":"\\mathbf{L}","position":{"start":{"line":897,"column":1},"end":{"line":897,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">L</span></span></span></span>","key":"KsDOf3gjEd"},{"type":"text","value":" has the same rows as before, but arranged into triangular order:","position":{"start":{"line":897,"column":1},"end":{"line":897,"column":1}},"key":"aqZzgxBTv4"}],"key":"VwNejgLA0Z"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"L","key":"towf47vLWT"},{"type":"output","id":"vLRYGHLfyvfYBjJmgbt-q","data":[{"output_type":"execute_result","execution_count":91,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>L = 4×4 double\n   1.0000e+00            0            0            0\n  -2.5000e-01   1.0000e+00            0            0\n   5.0000e-01  -1.5385e-01   1.0000e+00            0\n  -5.0000e-01   1.5385e-01   8.3333e-02   1.0000e+00\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"L = 4×4 double\n   1.0000e+00            0            0            0\n  -2.5000e-01   1.0000e+00            0            0\n   5.0000e-01  -1.5385e-01   1.0000e+00            0\n  -5.0000e-01   1.5385e-01   8.3333e-02   1.0000e+00\n","content_type":"text/plain"}}}],"key":"nViN3Xf7UU"}],"data":{},"key":"W9o92CaRQR"}],"key":"qfOPOKS8bf"}],"key":"KOC2UoH3la"}],"key":"tr6uyv5eQ8"},{"type":"tabItem","title":"Python","sync":"python","children":[{"type":"embed","source":{"url":"/chapter2-2","label":"demo-pivoting-permute-python","kind":"Notebook","slug":"chapter2-2","location":"/python/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-pivoting-permute","label":"demo-pivoting-permute","kind":"proof:example","position":{"start":{"line":856,"column":1},"end":{"line":856,"column":23}},"children":[{"type":"text","value":"Example ","key":"WfueeaF27q"},{"type":"text","value":"2.6.3","key":"DJlEDuGjfF"}],"template":"Example %s","enumerator":"2.6.3","resolved":true,"html_id":"demo-pivoting-permute","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"eqifQDdQ6C"}],"key":"VvGu1zH67a"},{"type":"paragraph","position":{"start":{"line":857,"column":1},"end":{"line":857,"column":1}},"children":[{"type":"text","value":"Here again is the matrix from ","position":{"start":{"line":857,"column":1},"end":{"line":857,"column":1}},"key":"TWLuV7a0j3"},{"type":"crossReference","kind":"proof:example","identifier":"demo-pivoting-fix","label":"demo-pivoting-fix","children":[{"type":"text","value":"Demo ","key":"gyn1KaXMJb"},{"type":"text","value":"2.6.2","key":"s04cCrJwol"}],"template":"Example %s","enumerator":"2.6.2","resolved":true,"html_id":"demo-pivoting-fix","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"FxcxaWaknx"},{"type":"text","value":".","position":{"start":{"line":857,"column":1},"end":{"line":857,"column":1}},"key":"stm67Uq9y6"}],"key":"tmQex4AR8x"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"A = array([\n    [2, 0, 4, 3],\n    [-2, 0, 2, -13],\n    [1, 15, 2, -4.5],\n    [-4, 5, -7, -10]\n    ])","key":"FbC89Czxv0"},{"type":"output","id":"0wyTdRKSlnUuiGRrrjYpS","data":[],"key":"rPP9xC2S45"}],"data":{},"key":"QdZLTZC4Et"},{"type":"paragraph","position":{"start":{"line":868,"column":1},"end":{"line":868,"column":1}},"children":[{"type":"text","value":"As the factorization proceeded, the pivots were selected from rows 4, 3, 2, and finally 1 (with NumPy indices being one less). If we were to put the rows of ","position":{"start":{"line":868,"column":1},"end":{"line":868,"column":1}},"key":"ETFoqErcTE"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":868,"column":1},"end":{"line":868,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"kJ5vPcLpEx"},{"type":"text","value":" into that order, then the algorithm would run exactly like the plain LU factorization from ","position":{"start":{"line":868,"column":1},"end":{"line":868,"column":1}},"key":"xJppqKkvbw"},{"type":"link","kind":"numref","url":"/lu","internal":true,"dataUrl":"/lu.json","children":[{"type":"text","value":"LU factorization","key":"vjFYu9P0r2"}],"key":"Xxn9mz7s8A"},{"type":"text","value":".","position":{"start":{"line":868,"column":1},"end":{"line":868,"column":1}},"key":"MjognCrabg"}],"key":"upc6w9WJUv"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"B = A[[3, 2, 1, 0], :]\nL, U = FNC.lufact(B);","key":"qZzWp4R8Xv"},{"type":"output","id":"Kcz8WwytIBMJE_q90DZHA","data":[],"key":"Slr6qBobDV"}],"data":{},"key":"ZXyEUkY7t6"},{"type":"paragraph","position":{"start":{"line":875,"column":1},"end":{"line":875,"column":1}},"children":[{"type":"text","value":"We obtain the same ","position":{"start":{"line":875,"column":1},"end":{"line":875,"column":1}},"key":"Frr7syYDpa"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":875,"column":1},"end":{"line":875,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"kJuuUxZvoW"},{"type":"text","value":" as before:","position":{"start":{"line":875,"column":1},"end":{"line":875,"column":1}},"key":"VFrmYFNspO"}],"key":"GgsqcDCgq6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(U)","key":"K7am5ml8ia"},{"type":"output","id":"A0hVUF-yk1e4vn8BhibD3","data":[{"output_type":"stream","name":"stdout","text":"[[ -4.           5.          -7.         -10.        ]\n [  0.          16.25         0.25        -7.        ]\n [  0.           0.           5.53846154  -9.07692308]\n [  0.           0.           0.          -0.16666667]]\n"}],"key":"bFy8UOI94r"}],"data":{},"key":"ZhmdPrcFm0"},{"type":"paragraph","position":{"start":{"line":881,"column":1},"end":{"line":881,"column":1}},"children":[{"type":"text","value":"And ","position":{"start":{"line":881,"column":1},"end":{"line":881,"column":1}},"key":"Wz0RAflR66"},{"type":"inlineMath","value":"\\mathbf{L}","position":{"start":{"line":881,"column":1},"end":{"line":881,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">L</span></span></span></span>","key":"C6sNhDHKjf"},{"type":"text","value":" has the same rows as before, but arranged into triangular order:","position":{"start":{"line":881,"column":1},"end":{"line":881,"column":1}},"key":"iXMiI2OLZc"}],"key":"DHJYTevjKi"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(L)","key":"JmTqRT7FzE"},{"type":"output","id":"AoDTde-TXQUV3LQy11r-q","data":[{"output_type":"stream","name":"stdout","text":"[[ 1.          0.          0.          0.        ]\n [-0.25        1.          0.          0.        ]\n [ 0.5        -0.15384615  1.          0.        ]\n [-0.5         0.15384615  0.08333333  1.        ]]\n"}],"key":"nxADRmGFKg"}],"data":{},"key":"nSHxeP6a1Z"}],"key":"mMyWEVfAAy"}],"key":"kEM9z0Nglv"}],"key":"Tc0fHk6c2e"}],"key":"yWzdT8hx7l"}],"label":"demo-pivoting-permute","identifier":"demo-pivoting-permute","html_id":"demo-pivoting-permute","enumerator":"2.6.3","key":"iZQj4fKd6x"},{"type":"paragraph","position":{"start":{"line":110,"column":1},"end":{"line":110,"column":1}},"children":[{"type":"text","value":"In principle, if the permutation of rows implied by the pivot locations is applied all at once to the original ","position":{"start":{"line":110,"column":1},"end":{"line":110,"column":1}},"key":"VpL1O2T14H"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":110,"column":1},"end":{"line":110,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"myH2ZN3SkC"},{"type":"text","value":", no further pivoting is needed. In practice, this permutation cannot be determined immediately from the original ","position":{"start":{"line":110,"column":1},"end":{"line":110,"column":1}},"key":"TQVxsHQp55"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":110,"column":1},"end":{"line":110,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"dv99wOo3GW"},{"type":"text","value":"; the only way to find it is to run the algorithm. Having obtained it at the end, though, we can use it to state a simple relationship.","position":{"start":{"line":110,"column":1},"end":{"line":110,"column":1}},"key":"KhlNLfKMsX"}],"key":"LenPr02kyy"},{"type":"proof","kind":"definition","enumerated":true,"children":[{"type":"admonitionTitle","children":[{"type":"text","value":"PLU factorization","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"key":"Lq3vV6FhwU"}],"key":"EZ0hmYrVH5"},{"type":"paragraph","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"children":[{"type":"text","value":"Given ","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"key":"nySRfQ1cap"},{"type":"inlineMath","value":"n\\times n","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>×</mo><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n\\times n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"Imwr7WciYI"},{"type":"text","value":" matrix ","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"key":"DxsM5WSjcZ"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"HPpHNNUSkB"},{"type":"text","value":", the ","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"key":"LYhQvqCDxX"},{"type":"strong","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"children":[{"type":"text","value":"PLU factorization","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"key":"rBmRKQl05J"}],"key":"edemZIyEUA"},{"type":"text","value":" is a unit lower triangular ","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"key":"PFafZFfiSG"},{"type":"inlineMath","value":"\\mathbf{L}","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">L</span></span></span></span>","key":"BnxBZIhsaI"},{"type":"text","value":", an upper triangular ","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"key":"C2WBBT7SWu"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"kSiZnJFfWu"},{"type":"text","value":", and a permutation ","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"key":"MxPVBM0Flg"},{"type":"inlineMath","value":"i_1,\\ldots,i_n","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>i</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><mo>…</mo><mo separator=\"true\">,</mo><msub><mi>i</mi><mi>n</mi></msub></mrow><annotation encoding=\"application/x-tex\">i_1,\\ldots,i_n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"m3J8uzmOWb"},{"type":"text","value":" of the integers ","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"key":"rIKK4vTvEV"},{"type":"inlineMath","value":"1,\\ldots,n","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mo separator=\"true\">,</mo><mo>…</mo><mo separator=\"true\">,</mo><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">1,\\ldots,n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8389em;vertical-align:-0.1944em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"MmPoQ1RM4x"},{"type":"text","value":", such that","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"key":"Qj23QnuUr0"}],"key":"ODLX3yXBWm"},{"type":"math","value":"\\tilde{\\mathbf{A}} = \\mathbf{L}\\mathbf{U},","position":{"start":{"line":118,"column":1},"end":{"line":118,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mover accent=\"true\"><mi mathvariant=\"bold\">A</mi><mo>~</mo></mover><mo>=</mo><mi mathvariant=\"bold\">L</mi><mi mathvariant=\"bold\">U</mi><mo separator=\"true\">,</mo></mrow><annotation encoding=\"application/x-tex\">\\tilde{\\mathbf{A}} = \\mathbf{L}\\mathbf{U},</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.923em;\"></span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.923em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathbf\">A</span></span><span style=\"top:-3.6051em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.1111em;\"><span class=\"mord\">~</span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8805em;vertical-align:-0.1944em;\"></span><span class=\"mord mathbf\">LU</span><span class=\"mpunct\">,</span></span></span></span></span>","enumerator":"2.6.1","key":"DKubmSLUUW"},{"type":"paragraph","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"children":[{"type":"text","value":"where rows ","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"key":"Wr2B4YKtHn"},{"type":"inlineMath","value":"1,\\ldots,n","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mo separator=\"true\">,</mo><mo>…</mo><mo separator=\"true\">,</mo><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">1,\\ldots,n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8389em;vertical-align:-0.1944em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"rIw3p96M77"},{"type":"text","value":" of ","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"key":"veDzXE5wwY"},{"type":"inlineMath","value":"\\tilde{\\mathbf{A}}","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mover accent=\"true\"><mi mathvariant=\"bold\">A</mi><mo>~</mo></mover></mrow><annotation encoding=\"application/x-tex\">\\tilde{\\mathbf{A}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.923em;\"></span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.923em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathbf\">A</span></span><span style=\"top:-3.6051em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.1111em;\"><span class=\"mord\">~</span></span></span></span></span></span></span></span></span></span>","key":"uZ60gjLQVa"},{"type":"text","value":" are rows ","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"key":"vzhpvqtCLh"},{"type":"inlineMath","value":"i_1,\\ldots,i_n","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>i</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><mo>…</mo><mo separator=\"true\">,</mo><msub><mi>i</mi><mi>n</mi></msub></mrow><annotation encoding=\"application/x-tex\">i_1,\\ldots,i_n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"TfzJP7cyid"},{"type":"text","value":" of ","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"key":"MuaJAmZUTu"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"pmxru0Q5ZX"},{"type":"text","value":".","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"key":"pPdXE4X385"}],"key":"LIg1t98CFa"}],"indexEntries":[{"entry":"matrix factorization","subEntry":{"value":"pivoted LU","kind":"entry"},"emphasis":true},{"entry":"PLU factorization","emphasis":true}],"label":"index-AXysywvQr0","identifier":"index-axysywvqr0","html_id":"index-axysywvqr0","enumerator":"2.6.1","key":"mODu8UAi6k"},{"type":"paragraph","position":{"start":{"line":123,"column":1},"end":{"line":123,"column":1}},"children":[{"type":"crossReference","kind":"proof:algorithm","identifier":"function-plufact","label":"function-plufact","children":[{"type":"text","value":"Function ","key":"Q5XsfyjhP1"},{"type":"text","value":"2.6.2","key":"zmMAIzn5NJ"}],"template":"Algorithm %s","enumerator":"2.6.2","resolved":true,"html_id":"function-plufact","key":"nAgWBMopyI"},{"type":"text","value":" shows our implementation of PLU factorization.","position":{"start":{"line":123,"column":1},"end":{"line":123,"column":1}},"key":"Qsi6d9oKtF"},{"type":"footnoteReference","identifier":"plu","label":"PLU","position":{"start":{"line":123,"column":1},"end":{"line":123,"column":1}},"number":1,"enumerator":"1","key":"HUUlxHgieX"}],"key":"eJ0vDqi4xP"},{"type":"proof","kind":"algorithm","enumerated":true,"children":[{"type":"admonitionTitle","children":[{"type":"text","value":"plufact","position":{"start":{"line":128,"column":1},"end":{"line":128,"column":1}},"key":"SWDt8icwoO"}],"key":"lTG9hqzkJS"},{"type":"tabSet","children":[{"type":"tabItem","title":"Julia","sync":"julia","children":[{"type":"embed","source":{"url":"/chapter2","label":"function-plufact-julia","kind":"Notebook","slug":"chapter2","location":"/julia/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"LU factorization with partial pivoting","position":{"start":{"line":66,"column":1},"end":{"line":66,"column":1}},"key":"PYf2YXjGUb"}],"key":"liNVoSYten"},{"type":"include","file":"FNCFunctions/src/chapter02.jl","literal":true,"filter":{"startAfter":"# begin plufact","endBefore":"# end plufact"},"children":[{"type":"code","value":"\"\"\"\n    plufact(A)\n\nCompute the PLU factorization of square matrix `A`, returning the\ntriangular factors and a row permutation vector.\n\"\"\"\nfunction plufact(A)\n    n = size(A, 1)\n    L = zeros(n, n)\n    U = zeros(n, n)\n    p = fill(0, n)\n    Aₖ = float(copy(A))\n\n    # Reduction by outer products\n    for k in 1:n\n        p[k] = argmax(abs.(Aₖ[:, k]))    # best pivot in column k\n        U[k, :] = Aₖ[p[k], :]\n        L[:, k] = Aₖ[:, k] / U[k, k]\n        if k < n    # no update needed on last iteration\n            Aₖ -= L[:, k] * U[k, :]'\n        end\n    end\n    return LowerTriangular(L[p, :]), U, p\nend","lang":"julia","showLineNumbers":true,"filename":"plufact.jl","key":"kX10vvRj36"}],"key":"dn8qXbE6q4"},{"type":"code","lang":"","value":"","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"key":"WCXTdkEKOX"}],"key":"TGU8nOMI6m"}],"key":"ICmNzFBJqW"}],"key":"I5Pjruj0em"},{"type":"tabItem","title":"MATLAB","sync":"matlab","children":[{"type":"embed","source":{"url":"/chapter2","label":"function-plufact-julia","kind":"Notebook","slug":"chapter2","location":"/julia/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"LU factorization with partial pivoting","position":{"start":{"line":66,"column":1},"end":{"line":66,"column":1}},"key":"oXx8ICD79L"}],"key":"lnA0qTRi4m"},{"type":"include","file":"FNCFunctions/src/chapter02.jl","literal":true,"filter":{"startAfter":"# begin plufact","endBefore":"# end plufact"},"children":[{"type":"code","value":"\"\"\"\n    plufact(A)\n\nCompute the PLU factorization of square matrix `A`, returning the\ntriangular factors and a row permutation vector.\n\"\"\"\nfunction plufact(A)\n    n = size(A, 1)\n    L = zeros(n, n)\n    U = zeros(n, n)\n    p = fill(0, n)\n    Aₖ = float(copy(A))\n\n    # Reduction by outer products\n    for k in 1:n\n        p[k] = argmax(abs.(Aₖ[:, k]))    # best pivot in column k\n        U[k, :] = Aₖ[p[k], :]\n        L[:, k] = Aₖ[:, k] / U[k, k]\n        if k < n    # no update needed on last iteration\n            Aₖ -= L[:, k] * U[k, :]'\n        end\n    end\n    return LowerTriangular(L[p, :]), U, p\nend","lang":"julia","showLineNumbers":true,"filename":"plufact.jl","key":"iSre1kVnY6"}],"key":"I0Lum88VXu"},{"type":"code","lang":"","value":"","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"key":"BIpbJtIeAs"}],"key":"wkjvongEhM"}],"key":"ScMxbNpWHG"}],"key":"ybgwk1b2DH"},{"type":"tabItem","title":"Python","sync":"python","children":[{"type":"embed","source":{"url":"/chapter2-2","label":"function-plufact-python","kind":"Notebook","slug":"chapter2-2","location":"/python/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"LU factorization with partial pivoting","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"key":"gZFuLSLKtS"}],"key":"EEwKMU9eTc"},{"type":"include","file":"../python/pkg/FNC/FNC02.py","literal":true,"filter":{"lines":[[52,72]]},"children":[{"type":"code","value":"def plufact(A):\n    \"\"\"\n        plufact(A)\n\n    Compute the PLU factorization of square matrix A, returning the\n    triangular factors and a row permutation vector.\n    \"\"\"\n    n = A.shape[0]\n    L = np.zeros((n, n))\n    U = np.zeros((n, n))\n    p = np.zeros(n, dtype=int)\n    A_k = np.copy(A)\n\n    # Reduction by np.outer products\n    for k in range(n):\n        p[k] = np.argmax(abs(A_k[:, k]))\n        U[k, :] = A_k[p[k], :]\n        L[:, k] = A_k[:, k] / U[k, k]\n        if k < n-1:\n            A_k -= np.outer(L[:, k], U[k, :])\n    return L[p, :], U, p","lang":"python","showLineNumbers":true,"filename":"plufact.py","key":"SndL5s18Hc"}],"key":"Axbbz61kh5"}],"key":"S1ZvaTJDeC"}],"key":"Lxl0NX59Jw"}],"key":"jgHeUAgcjL"}],"key":"vxzxpnQdmq"}],"label":"function-plufact","identifier":"function-plufact","html_id":"function-plufact","enumerator":"2.6.2","key":"SSIZaSROja"},{"type":"paragraph","position":{"start":{"line":151,"column":1},"end":{"line":151,"column":1}},"children":[{"type":"text","value":"Ideally, the PLU factorization takes ","position":{"start":{"line":151,"column":1},"end":{"line":151,"column":1}},"key":"WYJNf8Eklq"},{"type":"inlineMath","value":"\\sim \\frac{2}{3}n^3","position":{"start":{"line":151,"column":1},"end":{"line":151,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>∼</mo><mfrac><mn>2</mn><mn>3</mn></mfrac><msup><mi>n</mi><mn>3</mn></msup></mrow><annotation encoding=\"application/x-tex\">\\sim \\frac{2}{3}n^3</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.3669em;\"></span><span class=\"mrel\">∼</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1901em;vertical-align:-0.345em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8451em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">3</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mord\"><span class=\"mord mathnormal\">n</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span></span></span></span></span></span></span></span>","key":"pWb4uq5FFG"},{"type":"text","value":" flops asymptotically, just like LU without pivoting. The implementation in ","position":{"start":{"line":151,"column":1},"end":{"line":151,"column":1}},"key":"H3Cq8p1eoH"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-plufact","label":"function-plufact","children":[{"type":"text","value":"Function ","key":"We1rGAI5S9"},{"type":"text","value":"2.6.2","key":"JdG86AgJlq"}],"template":"Algorithm %s","enumerator":"2.6.2","resolved":true,"html_id":"function-plufact","key":"znOfKf0mx4"},{"type":"text","value":" does not achieve this optimal flop count, however. Like ","position":{"start":{"line":151,"column":1},"end":{"line":151,"column":1}},"key":"eFDwQde7L9"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-lufact","label":"function-lufact","children":[{"type":"text","value":"Function ","key":"pcQLQpSIV8"},{"type":"text","value":"2.4.1","key":"CzP8wThe1I"}],"template":"Algorithm %s","enumerator":"2.4.1","resolved":true,"html_id":"function-lufact","remote":true,"url":"/lu","dataUrl":"/lu.json","key":"uqnYS7rttm"},{"type":"text","value":", it does unnecessary operations on structurally known zeros for the sake of being easier to understand.","position":{"start":{"line":151,"column":1},"end":{"line":151,"column":1}},"key":"bJA545erps"}],"key":"hVkxrZlZjj"},{"type":"heading","depth":2,"position":{"start":{"line":153,"column":1},"end":{"line":153,"column":1}},"children":[{"type":"text","value":"Linear systems","position":{"start":{"line":153,"column":1},"end":{"line":153,"column":1}},"key":"mrChEEVJsQ"}],"identifier":"linear-systems","label":"Linear systems","html_id":"linear-systems","implicit":true,"enumerator":"2.6.3","key":"uLFj68OE4Q"},{"type":"paragraph","position":{"start":{"line":155,"column":1},"end":{"line":155,"column":1}},"children":[{"type":"text","value":"The output of ","position":{"start":{"line":155,"column":1},"end":{"line":155,"column":1}},"key":"s68Bcyd8Os"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-plufact","label":"function-plufact","children":[{"type":"text","value":"Function ","key":"kb1KJ3cSHK"},{"type":"text","value":"2.6.2","key":"PwXmNkxCIo"}],"template":"Algorithm %s","enumerator":"2.6.2","resolved":true,"html_id":"function-plufact","key":"KqLj9N6SCe"},{"type":"text","value":" is a factorization of a row-permuted ","position":{"start":{"line":155,"column":1},"end":{"line":155,"column":1}},"key":"tnBzpzvoet"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":155,"column":1},"end":{"line":155,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"XSdliFalVH"},{"type":"text","value":". Therefore, given a linear system ","position":{"start":{"line":155,"column":1},"end":{"line":155,"column":1}},"key":"PL5tLpE4AA"},{"type":"inlineMath","value":"\\mathbf{A}\\mathbf{x}=\\mathbf{b}","position":{"start":{"line":155,"column":1},"end":{"line":155,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi><mi mathvariant=\"bold\">x</mi><mo>=</mo><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}\\mathbf{x}=\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">Ax</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"qs7BOZHWC6"},{"type":"text","value":", we have to permute ","position":{"start":{"line":155,"column":1},"end":{"line":155,"column":1}},"key":"NkNzDsqcDE"},{"type":"inlineMath","value":"\\mathbf{b}","position":{"start":{"line":155,"column":1},"end":{"line":155,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"lPt9tYFicy"},{"type":"text","value":" the same way before applying forward and backward substitution. This is equivalent to changing the order of the equations in a linear system, which does not affect its solution.","position":{"start":{"line":155,"column":1},"end":{"line":155,"column":1}},"key":"SpFuureSSv"}],"key":"OT3LlNZfpn"},{"type":"proof","kind":"example","enumerated":true,"children":[{"type":"admonitionTitle","children":[{"type":"text","value":"PLU factorization for solving linear systems","position":{"start":{"line":158,"column":1},"end":{"line":158,"column":1}},"key":"CvnmDvxJPm"}],"key":"xPXEiNjtgF"},{"type":"tabSet","children":[{"type":"tabItem","title":"Julia","sync":"julia","children":[{"type":"embed","source":{"url":"/chapter2","label":"demo-pivoting-usage-julia","kind":"Notebook","slug":"chapter2","location":"/julia/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-pivoting-usage","label":"demo-pivoting-usage","kind":"proof:example","position":{"start":{"line":956,"column":1},"end":{"line":956,"column":21}},"children":[{"type":"text","value":"Example ","key":"QaP2Ygvknk"},{"type":"text","value":"2.6.4","key":"q7U8K4pScu"}],"template":"Example %s","enumerator":"2.6.4","resolved":true,"html_id":"demo-pivoting-usage","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"TfYNqahQBS"}],"key":"KxZ7abCnQZ"},{"type":"paragraph","position":{"start":{"line":957,"column":1},"end":{"line":957,"column":1}},"children":[{"type":"text","value":"The third output of ","position":{"start":{"line":957,"column":1},"end":{"line":957,"column":1}},"key":"zz7plvAPhL"},{"type":"inlineCode","value":"plufact","position":{"start":{"line":957,"column":1},"end":{"line":957,"column":1}},"key":"WWEE7Y3icJ"},{"type":"text","value":" is the permutation vector we need to apply to ","position":{"start":{"line":957,"column":1},"end":{"line":957,"column":1}},"key":"OIlgyRQkmp"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":957,"column":1},"end":{"line":957,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"m7MdfguqpT"},{"type":"text","value":".","position":{"start":{"line":957,"column":1},"end":{"line":957,"column":1}},"key":"XULqoLAVIx"}],"key":"bouLbztfLV"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"A = rand(1:20, 4, 4)\nL, U, p = FNC.plufact(A)\nA[p,:] - L * U   # should be ≈ 0","key":"MzZH5AzZCJ"},{"type":"output","id":"FRUvCeE3nsqLZ6_ZJBoJu","data":[{"output_type":"execute_result","execution_count":94,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n 0.0   0.0           0.0          0.0\n 0.0   0.0           0.0          0.0\n 0.0   0.0           0.0          0.0\n 0.0  -2.22045e-16  -1.77636e-15  0.0","content_type":"text/plain"}}}],"key":"h08N1T4rWk"}],"data":{},"key":"VOpbiJRbfK"},{"type":"paragraph","position":{"start":{"line":965,"column":1},"end":{"line":965,"column":1}},"children":[{"type":"text","value":"Given a vector ","position":{"start":{"line":965,"column":1},"end":{"line":965,"column":1}},"key":"OHe67Q7jHW"},{"type":"inlineMath","value":"\\mathbf{b}","position":{"start":{"line":965,"column":1},"end":{"line":965,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"zTQ6R5hIkM"},{"type":"text","value":", we solve ","position":{"start":{"line":965,"column":1},"end":{"line":965,"column":1}},"key":"BL5nO7w6hB"},{"type":"inlineMath","value":"\\mathbf{A}\\mathbf{x}=\\mathbf{b}","position":{"start":{"line":965,"column":1},"end":{"line":965,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi><mi mathvariant=\"bold\">x</mi><mo>=</mo><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}\\mathbf{x}=\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">Ax</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"eRuaA3w5IZ"},{"type":"text","value":" by first permuting the entries of ","position":{"start":{"line":965,"column":1},"end":{"line":965,"column":1}},"key":"YQ0gubpTRD"},{"type":"inlineMath","value":"\\mathbf{b}","position":{"start":{"line":965,"column":1},"end":{"line":965,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"WOY8GiEXNb"},{"type":"text","value":" and then proceeding as before.","position":{"start":{"line":965,"column":1},"end":{"line":965,"column":1}},"key":"XPe4ScEi5Y"}],"key":"EBNXgbuclg"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"b = rand(4)\nz = FNC.forwardsub(L,b[p])\nx = FNC.backsub(U,z)","key":"fUGkCPzLn0"},{"type":"output","id":"1FIExvmykyri8hsQRGND8","data":[{"output_type":"execute_result","execution_count":95,"metadata":{},"data":{"text/plain":{"content":"4-element Vector{Float64}:\n  0.00027096381487924474\n  0.04368979772275833\n -0.007512653092787422\n  0.031510664744129696","content_type":"text/plain"}}}],"key":"uAjXb2rzs3"}],"data":{},"key":"amZQSPWnNj"},{"type":"paragraph","position":{"start":{"line":973,"column":1},"end":{"line":973,"column":1}},"children":[{"type":"text","value":"A residual check is successful:","position":{"start":{"line":973,"column":1},"end":{"line":973,"column":1}},"key":"yKAxGQQxFt"}],"key":"GNTR8xaSkJ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"b - A*x","key":"gJW3OAx4A3"},{"type":"output","id":"81LY59TWeUNKingfwCz00","data":[{"output_type":"execute_result","execution_count":96,"metadata":{},"data":{"text/plain":{"content":"4-element Vector{Float64}:\n  0.0\n -1.1102230246251565e-16\n  0.0\n -1.1102230246251565e-16","content_type":"text/plain"}}}],"key":"fCXINN7N0v"}],"data":{},"key":"B3154VJpWP"}],"key":"eWQzdIJHIC"}],"key":"AzQECrisaM"}],"key":"j95Y00QZ8G"},{"type":"tabItem","title":"MATLAB","sync":"matlab","children":[{"type":"embed","source":{"url":"/chapter2-1","label":"demo-pivoting-usage-matlab","kind":"Notebook","slug":"chapter2-1","location":"/matlab/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-pivoting-usage","label":"demo-pivoting-usage","kind":"proof:example","position":{"start":{"line":905,"column":1},"end":{"line":905,"column":21}},"children":[{"type":"text","value":"Example ","key":"JdIHBYKkc9"},{"type":"text","value":"2.6.4","key":"tZy0fnRrzw"}],"template":"Example %s","enumerator":"2.6.4","resolved":true,"html_id":"demo-pivoting-usage","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"kPFpGqk9Uu"}],"key":"XnYrJscjEl"},{"type":"paragraph","position":{"start":{"line":906,"column":1},"end":{"line":906,"column":1}},"children":[{"type":"text","value":"The third output of ","position":{"start":{"line":906,"column":1},"end":{"line":906,"column":1}},"key":"DZwSMkOBQG"},{"type":"inlineCode","value":"plufact","position":{"start":{"line":906,"column":1},"end":{"line":906,"column":1}},"key":"T6CSzhZ8LG"},{"type":"text","value":" is the permutation vector we need to apply to ","position":{"start":{"line":906,"column":1},"end":{"line":906,"column":1}},"key":"PYYYUIvEo3"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":906,"column":1},"end":{"line":906,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"mkKX1mjdhx"},{"type":"text","value":".","position":{"start":{"line":906,"column":1},"end":{"line":906,"column":1}},"key":"ooPCBC8pJ7"}],"key":"L5nYp2gatT"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A = randi(20, 4, 4);\n[L, U, p] = plufact(A);\nA(p, :) - L * U    % should be ≈ 0","key":"bZiYN47pKk"},{"type":"output","id":"aa-62f1QYFFBuWETJibz-","data":[{"output_type":"execute_result","execution_count":92,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = 4×4 double\n     0     0     0     0\n     0     0     0     0\n     0     0     0     0\n     0     0     0     0\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = 4×4 double\n     0     0     0     0\n     0     0     0     0\n     0     0     0     0\n     0     0     0     0\n","content_type":"text/plain"}}}],"key":"RT4K42TUJl"}],"data":{},"key":"EzCKhm5sG7"},{"type":"paragraph","position":{"start":{"line":914,"column":1},"end":{"line":914,"column":1}},"children":[{"type":"text","value":"Given a vector ","position":{"start":{"line":914,"column":1},"end":{"line":914,"column":1}},"key":"oaDk2omkRd"},{"type":"inlineMath","value":"\\mathbf{b}","position":{"start":{"line":914,"column":1},"end":{"line":914,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"FAeQvTRmc4"},{"type":"text","value":", we solve ","position":{"start":{"line":914,"column":1},"end":{"line":914,"column":1}},"key":"uc092eYbBG"},{"type":"inlineMath","value":"\\mathbf{A}\\mathbf{x}=\\mathbf{b}","position":{"start":{"line":914,"column":1},"end":{"line":914,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi><mi mathvariant=\"bold\">x</mi><mo>=</mo><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}\\mathbf{x}=\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">Ax</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"IPNfQzWTSg"},{"type":"text","value":" by first permuting the entries of ","position":{"start":{"line":914,"column":1},"end":{"line":914,"column":1}},"key":"XQwIbGDpHB"},{"type":"inlineMath","value":"\\mathbf{b}","position":{"start":{"line":914,"column":1},"end":{"line":914,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"PDUdzTtL3L"},{"type":"text","value":" and then proceeding as before.","position":{"start":{"line":914,"column":1},"end":{"line":914,"column":1}},"key":"UWkDwur0at"}],"key":"gEMsQpUNrz"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"b = rand(4, 1);\nz = forwardsub(L, b(p));\nx = backsub(U, z)","key":"MvfxFrVUFo"},{"type":"output","id":"w-ZrkcizQ-n6L3dtSUwW-","data":[{"output_type":"execute_result","execution_count":93,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>x = 4×1 double\n   1.3450e-02\n   8.6201e-03\n   5.8324e-03\n   1.9884e-02\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"x = 4×1 double\n   1.3450e-02\n   8.6201e-03\n   5.8324e-03\n   1.9884e-02\n","content_type":"text/plain"}}}],"key":"bv2anuDOsR"}],"data":{},"key":"VRu5gzhHlW"},{"type":"paragraph","position":{"start":{"line":922,"column":1},"end":{"line":922,"column":1}},"children":[{"type":"text","value":"A residual check is successful:","position":{"start":{"line":922,"column":1},"end":{"line":922,"column":1}},"key":"WTqki04hJa"}],"key":"TrtpsyGhLS"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"b - A*x","key":"YFBsv1Nbtt"},{"type":"output","id":"NoaIzFdsZqypACYtRdPcW","data":[{"output_type":"execute_result","execution_count":94,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = 4×1 double\n1.0e+00 *\n\n            0\n   5.5511e-17\n            0\n            0\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = 4×1 double\n1.0e+00 *\n\n            0\n   5.5511e-17\n            0\n            0\n","content_type":"text/plain"}}}],"key":"LE7dHnBXCg"}],"data":{},"key":"qfZhzoId1B"}],"key":"OFBU1UXC3B"}],"key":"tnizdhOqHN"}],"key":"TqpwCyK4yS"},{"type":"tabItem","title":"Python","sync":"python","children":[{"type":"embed","source":{"url":"/chapter2-2","label":"demo-pivoting-usage-python","kind":"Notebook","slug":"chapter2-2","location":"/python/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-pivoting-usage","label":"demo-pivoting-usage","kind":"proof:example","position":{"start":{"line":889,"column":1},"end":{"line":889,"column":21}},"children":[{"type":"text","value":"Example ","key":"FYumADA25g"},{"type":"text","value":"2.6.4","key":"YAHzauhNtA"}],"template":"Example %s","enumerator":"2.6.4","resolved":true,"html_id":"demo-pivoting-usage","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"xb8gObNwBJ"}],"key":"PLqLAk5DOJ"},{"type":"paragraph","position":{"start":{"line":890,"column":1},"end":{"line":890,"column":1}},"children":[{"type":"text","value":"The third output of ","position":{"start":{"line":890,"column":1},"end":{"line":890,"column":1}},"key":"uNRVV52nvK"},{"type":"inlineCode","value":"plufact","position":{"start":{"line":890,"column":1},"end":{"line":890,"column":1}},"key":"Ljiuq7bxKi"},{"type":"text","value":" is the permutation vector we need to apply to ","position":{"start":{"line":890,"column":1},"end":{"line":890,"column":1}},"key":"yDNcyJLlEV"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":890,"column":1},"end":{"line":890,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"nmkyUifCnd"},{"type":"text","value":".","position":{"start":{"line":890,"column":1},"end":{"line":890,"column":1}},"key":"iW8qCXztOF"}],"key":"g1Ye2dePDs"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"A = random.randn(4, 4)\nL, U, p = FNC.plufact(A)\nA[p, :] - L @ U   # should be ≈ 0","key":"wpSiGpCTJq"},{"type":"output","id":"NNzdaQO-SYkbZwJuwtviy","data":[{"output_type":"execute_result","execution_count":229,"metadata":{},"data":{"text/plain":{"content":"array([[0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00],\n       [0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00],\n       [0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00],\n       [0.00000000e+00, 0.00000000e+00, 1.38777878e-17, 0.00000000e+00]])","content_type":"text/plain"}}}],"key":"fjUq2FdkcP"}],"data":{},"key":"pwJhCoy336"},{"type":"paragraph","position":{"start":{"line":898,"column":1},"end":{"line":898,"column":1}},"children":[{"type":"text","value":"Given a vector ","position":{"start":{"line":898,"column":1},"end":{"line":898,"column":1}},"key":"XM61NaBDCj"},{"type":"inlineMath","value":"\\mathbf{b}","position":{"start":{"line":898,"column":1},"end":{"line":898,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"bWPyCM1pBK"},{"type":"text","value":", we solve ","position":{"start":{"line":898,"column":1},"end":{"line":898,"column":1}},"key":"VQLr3kSbYg"},{"type":"inlineMath","value":"\\mathbf{A}\\mathbf{x}=\\mathbf{b}","position":{"start":{"line":898,"column":1},"end":{"line":898,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi><mi mathvariant=\"bold\">x</mi><mo>=</mo><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}\\mathbf{x}=\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">Ax</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"SWj1G4mCrQ"},{"type":"text","value":" by first permuting the entries of ","position":{"start":{"line":898,"column":1},"end":{"line":898,"column":1}},"key":"sXQxwewzAG"},{"type":"inlineMath","value":"\\mathbf{b}","position":{"start":{"line":898,"column":1},"end":{"line":898,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"tEOEXl4LGO"},{"type":"text","value":" and then proceeding as before.","position":{"start":{"line":898,"column":1},"end":{"line":898,"column":1}},"key":"YFxCza1f08"}],"key":"WbXWho3YuO"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"b = random.randn(4)\nz = FNC.forwardsub(L, b[p])\nx = FNC.backsub(U, z)","key":"pWxWm8G4Al"},{"type":"output","id":"J03xU8sp7n3HcTdnErD6C","data":[],"key":"KTmi6Dl2ZM"}],"data":{},"key":"uw2S1jvgMb"},{"type":"paragraph","position":{"start":{"line":906,"column":1},"end":{"line":906,"column":1}},"children":[{"type":"text","value":"A residual check is successful:","position":{"start":{"line":906,"column":1},"end":{"line":906,"column":1}},"key":"zww6kEi85w"}],"key":"n8SnMcCflI"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"b - A @ x","key":"ScrR6tI48H"},{"type":"output","id":"dcb3LphqVu2FTLmDfw-w4","data":[{"output_type":"execute_result","execution_count":231,"metadata":{},"data":{"text/plain":{"content":"array([ 1.17961196e-16,  0.00000000e+00, -1.11022302e-16, -5.55111512e-17])","content_type":"text/plain"}}}],"key":"lBlNQaIS1Z"}],"data":{},"key":"vcHEldzY05"}],"key":"xtWmOLy0r0"}],"key":"V6pAD855oN"}],"key":"W9Ez20bv4u"}],"key":"zT4SxZHPty"}],"label":"demo-pivoting-usage","identifier":"demo-pivoting-usage","html_id":"demo-pivoting-usage","enumerator":"2.6.4","key":"H6AQOqcTf4"},{"type":"paragraph","position":{"start":{"line":180,"column":1},"end":{"line":180,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":180,"column":1},"end":{"line":180,"column":1}},"key":"R6dBSbeqRY"},{"type":"inlineCode","value":"lu","position":{"start":{"line":180,"column":1},"end":{"line":180,"column":1}},"key":"tAY5RQSZts"},{"type":"text","value":" function from the built-in package ","position":{"start":{"line":180,"column":1},"end":{"line":180,"column":1}},"key":"UhYcoEG8Hf"},{"type":"inlineCode","value":"LinearAlgebra","position":{"start":{"line":180,"column":1},"end":{"line":180,"column":1}},"key":"t1qWmAsKxx"},{"type":"text","value":" returns the same three outputs as ","position":{"start":{"line":180,"column":1},"end":{"line":180,"column":1}},"key":"B7WWisuFtP"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-plufact","label":"function-plufact","children":[{"type":"text","value":"Function ","key":"tAG4CBUYSl"},{"type":"text","value":"2.6.2","key":"mx9Tx5t3M1"}],"template":"Algorithm %s","enumerator":"2.6.2","resolved":true,"html_id":"function-plufact","key":"Jj0mu90P6B"},{"type":"text","value":". If you only request one output, it will be a factorization object that can be used with a backslash. This is useful when you want to solve with multiple versions of ","position":{"start":{"line":180,"column":1},"end":{"line":180,"column":1}},"key":"UdfRVLoGJM"},{"type":"inlineMath","value":"\\mathbf{b}","position":{"start":{"line":180,"column":1},"end":{"line":180,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"XclM7zmCTo"},{"type":"text","value":" but do the factorization only once.","position":{"start":{"line":180,"column":1},"end":{"line":180,"column":1}},"key":"aWOgkBNPvS"}],"key":"y1iDCpfIW0"},{"type":"proof","kind":"example","enumerated":true,"children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Built-in PLU factorization","position":{"start":{"line":183,"column":1},"end":{"line":183,"column":1}},"key":"VAMaua5Lx7"}],"key":"UbZ7JIEBCJ"},{"type":"tabSet","children":[{"type":"tabItem","title":"Julia","sync":"julia","children":[{"type":"embed","source":{"url":"/chapter2","label":"demo-pivoting-builtin-julia","kind":"Notebook","slug":"chapter2","location":"/julia/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-pivoting-builtin","label":"demo-pivoting-builtin","kind":"proof:example","position":{"start":{"line":981,"column":1},"end":{"line":981,"column":23}},"children":[{"type":"text","value":"Example ","key":"hp7Ds2Dluo"},{"type":"text","value":"2.6.5","key":"HkGb082LKz"}],"template":"Example %s","enumerator":"2.6.5","resolved":true,"html_id":"demo-pivoting-builtin","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"RFwdJL4S7V"}],"key":"A4qWYaDqQz"},{"type":"paragraph","position":{"start":{"line":982,"column":1},"end":{"line":982,"column":1}},"children":[{"type":"text","value":"With the syntax ","position":{"start":{"line":982,"column":1},"end":{"line":982,"column":1}},"key":"WmxO4YgLKt"},{"type":"inlineCode","value":"A \\ b","position":{"start":{"line":982,"column":1},"end":{"line":982,"column":1}},"key":"yQzRhR3suZ"},{"type":"text","value":", the matrix ","position":{"start":{"line":982,"column":1},"end":{"line":982,"column":1}},"key":"PbbuyzpUiM"},{"type":"inlineCode","value":"A","position":{"start":{"line":982,"column":1},"end":{"line":982,"column":1}},"key":"W2r2yGogZ8"},{"type":"text","value":" is PLU-factored, followed by two triangular solves.","position":{"start":{"line":982,"column":1},"end":{"line":982,"column":1}},"key":"TkzZkVRG1c"}],"key":"jScRN8rgP2"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"A = randn(500, 500)   # 500x500 with normal random entries\nA \\ rand(500)          # force compilation\n@elapsed for k=1:50; A \\ rand(500); end","key":"bTqXqIsC6x"},{"type":"output","id":"4oa7yWmWGopJiW_SSuN1y","data":[{"output_type":"execute_result","execution_count":97,"metadata":{},"data":{"text/plain":{"content":"0.122537208","content_type":"text/plain"}}}],"key":"p8dawrrAX0"}],"data":{},"key":"Cu7zBTvyj8"},{"type":"paragraph","position":{"start":{"line":990,"column":1},"end":{"line":990,"column":1}},"children":[{"type":"text","value":"In ","position":{"start":{"line":990,"column":1},"end":{"line":990,"column":1}},"key":"Fw5qwDGf3Z"},{"type":"link","kind":"numref","url":"/efficiency","internal":true,"dataUrl":"/efficiency.json","children":[{"type":"text","value":"Efficiency of matrix computations","key":"PNDY8PvNmU"}],"key":"hdL6o4XiH4"},{"type":"text","value":" we showed that the factorization is by far the most costly part of the solution process. A factorization object allows us to do that costly step only once per unique matrix.","position":{"start":{"line":990,"column":1},"end":{"line":990,"column":1}},"key":"XfmV6THZnf"}],"key":"j9ZDWvtPvs"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"factored = lu(A)     # store factorization result\nfactored \\ rand(500)   # force compilation\n@elapsed for k=1:50; factored \\ rand(500); end","key":"ytWQ1qgltL"},{"type":"output","id":"v87f2bUyKy_xws0q2UZfm","data":[{"output_type":"execute_result","execution_count":98,"metadata":{},"data":{"text/plain":{"content":"0.002817166","content_type":"text/plain"}}}],"key":"QkH1XEe7XZ"}],"data":{},"key":"XWkiBToRFM"}],"key":"jovz8tqR5o"}],"key":"WQ5j5wNaGu"}],"key":"nNEsAXugk7"},{"type":"tabItem","title":"MATLAB","sync":"matlab","children":[{"type":"embed","source":{"url":"/chapter2-1","label":"demo-pivoting-builtin-matlab","kind":"Notebook","slug":"chapter2-1","location":"/matlab/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-pivoting-builtin","label":"demo-pivoting-builtin","kind":"proof:example","position":{"start":{"line":930,"column":1},"end":{"line":930,"column":23}},"children":[{"type":"text","value":"Example ","key":"E6O7YHbEZI"},{"type":"text","value":"2.6.5","key":"aFo6Z9YGgJ"}],"template":"Example %s","enumerator":"2.6.5","resolved":true,"html_id":"demo-pivoting-builtin","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"KyxsZB4BBk"}],"key":"vetmlKtZRf"},{"type":"paragraph","position":{"start":{"line":931,"column":1},"end":{"line":931,"column":1}},"children":[{"type":"text","value":"With the syntax ","position":{"start":{"line":931,"column":1},"end":{"line":931,"column":1}},"key":"Wq7Y2XLnYW"},{"type":"inlineCode","value":"A \\ b","position":{"start":{"line":931,"column":1},"end":{"line":931,"column":1}},"key":"enQZfnWOoi"},{"type":"text","value":", the matrix ","position":{"start":{"line":931,"column":1},"end":{"line":931,"column":1}},"key":"TAiorlktv5"},{"type":"inlineCode","value":"A","position":{"start":{"line":931,"column":1},"end":{"line":931,"column":1}},"key":"KCTbK8KIDe"},{"type":"text","value":" is PLU-factored, followed by two triangular solves.","position":{"start":{"line":931,"column":1},"end":{"line":931,"column":1}},"key":"evD1RR7H6N"}],"key":"OtrzOlrNaX"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A = randn(500, 500);    % 500x500 with normal random entries\ntic; for k=1:50; A \\ rand(500, 1); end; toc","key":"zmZ9QVVxzg"},{"type":"output","id":"yfUbUU3x9vPosaSaE7IB5","data":[{"output_type":"stream","name":"stdout","text":"Elapsed time is 0.440674 seconds.\n"}],"key":"nYrJTfxCSY"}],"data":{},"key":"OBSiLAWneJ"},{"type":"paragraph","position":{"start":{"line":938,"column":1},"end":{"line":938,"column":1}},"children":[{"type":"text","value":"In ","position":{"start":{"line":938,"column":1},"end":{"line":938,"column":1}},"key":"vXTyO7Ch0U"},{"type":"link","kind":"numref","url":"/efficiency","internal":true,"dataUrl":"/efficiency.json","children":[{"type":"text","value":"Efficiency of matrix computations","key":"v6JMYwuwI5"}],"key":"vEdiATFL74"},{"type":"text","value":" we showed that the factorization is by far the most costly part of the solution process. A factorization object allows us to do that costly step only once per unique matrix.","position":{"start":{"line":938,"column":1},"end":{"line":938,"column":1}},"key":"lLLZK6G4Kk"}],"key":"dIMUOFb0JP"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[L, U, p] = lu(A, 'vector');    % keep factorization result\ntic\nfor k=1:50\n    b = rand(500, 1);\n    U \\ (L \\ b(p));\nend\ntoc","key":"Z8ouz8XBx5"},{"type":"output","id":"5WWCFOwDj3O6HskYPGnSe","data":[{"output_type":"stream","name":"stdout","text":"Elapsed time is 0.010893 seconds.\n"}],"key":"D14QAYaVaT"}],"data":{},"key":"q3YaCYflnG"}],"key":"YS5kbtVsHq"}],"key":"bTgS7hdbz7"}],"key":"djYGF1TgLF"},{"type":"tabItem","title":"Python","sync":"python","children":[{"type":"embed","source":{"url":"/chapter2-2","label":"demo-pivoting-builtin-python","kind":"Notebook","slug":"chapter2-2","location":"/python/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-pivoting-builtin","label":"demo-pivoting-builtin","kind":"proof:example","position":{"start":{"line":914,"column":1},"end":{"line":914,"column":23}},"children":[{"type":"text","value":"Example ","key":"kIqZ1fXAyd"},{"type":"text","value":"2.6.5","key":"Malh0dnjvO"}],"template":"Example %s","enumerator":"2.6.5","resolved":true,"html_id":"demo-pivoting-builtin","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"XBIETbDvs5"}],"key":"Xq9ObkCOB3"},{"type":"paragraph","position":{"start":{"line":915,"column":1},"end":{"line":915,"column":1}},"children":[{"type":"text","value":"In ","position":{"start":{"line":915,"column":1},"end":{"line":915,"column":1}},"key":"yMqVNLcpEk"},{"type":"inlineCode","value":"linalg.solve","position":{"start":{"line":915,"column":1},"end":{"line":915,"column":1}},"key":"osbcLnHV7F"},{"type":"text","value":", the matrix ","position":{"start":{"line":915,"column":1},"end":{"line":915,"column":1}},"key":"HCNoC9muuV"},{"type":"inlineCode","value":"A","position":{"start":{"line":915,"column":1},"end":{"line":915,"column":1}},"key":"PhWIciNNp8"},{"type":"text","value":" is PLU-factored, followed by two triangular solves. If we want to do those steps seamlessly, we can use the ","position":{"start":{"line":915,"column":1},"end":{"line":915,"column":1}},"key":"JQbB5E3N0q"},{"type":"inlineCode","value":"lu_factor","position":{"start":{"line":915,"column":1},"end":{"line":915,"column":1}},"key":"C3o5dE1oHH"},{"type":"text","value":" and ","position":{"start":{"line":915,"column":1},"end":{"line":915,"column":1}},"key":"QVZQ9IMIpY"},{"type":"inlineCode","value":"lu_solve","position":{"start":{"line":915,"column":1},"end":{"line":915,"column":1}},"key":"aApmI2xFyq"},{"type":"text","value":" from ","position":{"start":{"line":915,"column":1},"end":{"line":915,"column":1}},"key":"T2B9DexzTL"},{"type":"inlineCode","value":"scipy.linalg","position":{"start":{"line":915,"column":1},"end":{"line":915,"column":1}},"key":"KaWB58Ksqb"},{"type":"text","value":".","position":{"start":{"line":915,"column":1},"end":{"line":915,"column":1}},"key":"uib6fBdcx4"}],"key":"fvhvJ4JtUd"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from scipy.linalg import lu_factor, lu_solve\nA = random.randn(500, 500) \nb = ones(500)  \nLU, perm = lu_factor(A)\nx = lu_solve((LU, perm), b)","key":"il0Lnw9upR"},{"type":"output","id":"Uy4W4iYvjAo8HCT6EidT-","data":[],"key":"DnJg8lhxe9"}],"data":{},"key":"CchjmZmtzZ"},{"type":"paragraph","position":{"start":{"line":925,"column":1},"end":{"line":925,"column":1}},"children":[{"type":"text","value":"Why would we ever bother with this? In ","position":{"start":{"line":925,"column":1},"end":{"line":925,"column":1}},"key":"lEzrA1eE9G"},{"type":"link","kind":"numref","url":"/efficiency","internal":true,"dataUrl":"/efficiency.json","children":[{"type":"text","value":"Efficiency of matrix computations","key":"VworsbhdYu"}],"key":"hvyszSnnUl"},{"type":"text","value":" we showed that the factorization is by far the most costly part of the solution process. A factorization object allows us to do that costly step only once per matrix, but solve with multiple right-hand sides.","position":{"start":{"line":925,"column":1},"end":{"line":925,"column":1}},"key":"OogUMnwkNS"}],"key":"fNXdYqJhl7"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"start = timer()\nfor k in range(50): linalg.solve(A, random.rand(500))\nprint(f\"elapsed time for 50 full solves: {timer() - start}\")\n\nstart = timer()\nLU, perm = lu_factor(A)\nfor k in range(50): lu_solve((LU, perm), random.rand(500))\nprint(f\"elapsed time for 50 shortcut solves: {timer() - start}\")","key":"cajFnfdpEO"},{"type":"output","id":"Y0IDRFPF3gOVL55B310-D","data":[{"output_type":"stream","name":"stdout","text":"elapsed time for 50 full solves: 0.28991629101801664\nelapsed time for 50 shortcut solves: 0.02639662497676909\n"}],"key":"X6twH294LV"}],"data":{},"key":"KqD0zmBxy1"}],"key":"uxf348aphs"}],"key":"MU7jRaYSMa"}],"key":"kQbFdHFJuo"}],"key":"sgbYLB9nGA"}],"label":"demo-pivoting-builtin","identifier":"demo-pivoting-builtin","html_id":"demo-pivoting-builtin","enumerator":"2.6.5","key":"Wj4N8tFNBe"},{"type":"heading","depth":2,"position":{"start":{"line":205,"column":1},"end":{"line":205,"column":1}},"children":[{"type":"text","value":"Stability","position":{"start":{"line":205,"column":1},"end":{"line":205,"column":1}},"key":"G11ERQFZjg"}],"identifier":"stability","label":"Stability","html_id":"stability","implicit":true,"enumerator":"2.6.4","key":"GuKg12cjZn"},{"type":"paragraph","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"children":[{"type":"text","value":"There is one detail of the row pivoting algorithm that might seem arbitrary: why choose the pivot of largest magnitude in a column, rather than, say, the uppermost nonzero in the column? The answer is numerical stability.","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"key":"soJcnwKALf"}],"indexEntries":[{"entry":"stability","emphasis":false}],"label":"index-XRmYQw4kCI","identifier":"index-xrmyqw4kci","html_id":"index-xrmyqw4kci","key":"fZzuxGRPus"},{"type":"proof","kind":"example","enumerated":true,"children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Stability of PLU factorization","position":{"start":{"line":213,"column":1},"end":{"line":213,"column":1}},"key":"RrZmE3jZXI"}],"key":"H37HqsMuVR"},{"type":"paragraph","position":{"start":{"line":214,"column":1},"end":{"line":214,"column":1}},"children":[{"type":"text","value":"Let","position":{"start":{"line":214,"column":1},"end":{"line":214,"column":1}},"key":"mSyB1NJJQM"}],"key":"f2JkAfq4zl"},{"type":"math","value":"\\mathbf{A} =\n  \\begin{bmatrix}\n    -\\epsilon & 1 \\\\ 1 & -1\n  \\end{bmatrix}.","label":"plu-stab-A","identifier":"plu-stab-a","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi mathvariant=\"bold\">A</mi><mo>=</mo><mrow><mo fence=\"true\">[</mo><mtable rowspacing=\"0.16em\" columnalign=\"center center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mi>ϵ</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mn>1</mn></mrow></mstyle></mtd></mtr></mtable><mo fence=\"true\">]</mo></mrow><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A} =\n  \\begin{bmatrix}\n    -\\epsilon &amp; 1 \\\\ 1 &amp; -1\n  \\end{bmatrix}.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.4em;vertical-align:-0.95em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">[</span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord mathnormal\">ϵ</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.95em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.95em;\"><span></span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">]</span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">.</span></span></span></span></span>","enumerator":"2.6.2","html_id":"plu-stab-a","key":"Ysoylgvr2T"},{"type":"paragraph","position":{"start":{"line":224,"column":1},"end":{"line":224,"column":1}},"children":[{"type":"text","value":"If ","position":{"start":{"line":224,"column":1},"end":{"line":224,"column":1}},"key":"WV1hkCsXJU"},{"type":"inlineMath","value":"\\epsilon=0","position":{"start":{"line":224,"column":1},"end":{"line":224,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ϵ</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">\\epsilon=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">ϵ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"k3N84os5f2"},{"type":"text","value":", LU factorization without pivoting fails for ","position":{"start":{"line":224,"column":1},"end":{"line":224,"column":1}},"key":"OegQNCy3ZH"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":224,"column":1},"end":{"line":224,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"i0tgmGkP8f"},{"type":"text","value":". But if ","position":{"start":{"line":224,"column":1},"end":{"line":224,"column":1}},"key":"x27djyCmSE"},{"type":"inlineMath","value":"\\epsilon\\neq 0","position":{"start":{"line":224,"column":1},"end":{"line":224,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ϵ</mi><mo mathvariant=\"normal\">≠</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">\\epsilon\\neq 0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">ϵ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\"><span class=\"mrel\"><span class=\"mord vbox\"><span class=\"thinbox\"><span class=\"rlap\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"inner\"><span class=\"mord\"><span class=\"mrel\"></span></span></span><span class=\"fix\"></span></span></span></span></span><span class=\"mrel\">=</span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"qS3cxQardS"},{"type":"text","value":", we can go without pivoting, at least in principle.","position":{"start":{"line":224,"column":1},"end":{"line":224,"column":1}},"key":"phj1jMKvB1"}],"key":"pNjWIwaoC1"},{"type":"tabSet","children":[{"type":"tabItem","title":"Julia","sync":"julia","children":[{"type":"embed","source":{"url":"/chapter2","label":"demo-pivoting-stable-julia","kind":"Notebook","slug":"chapter2","location":"/julia/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-pivoting-stable","label":"demo-pivoting-stable","kind":"proof:example","position":{"start":{"line":1000,"column":1},"end":{"line":1000,"column":22}},"children":[{"type":"text","value":"Example ","key":"FuecPoEDiN"},{"type":"text","value":"2.6.6","key":"Lmel4Idnl3"}],"template":"Example %s","enumerator":"2.6.6","resolved":true,"html_id":"demo-pivoting-stable","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"XyWUnVMFMZ"}],"key":"DwqgIQdhjl"},{"type":"paragraph","position":{"start":{"line":1001,"column":1},"end":{"line":1001,"column":1}},"children":[{"type":"text","value":"We construct a linear system for this matrix with ","position":{"start":{"line":1001,"column":1},"end":{"line":1001,"column":1}},"key":"FfLWJeOwKI"},{"type":"inlineMath","value":"\\epsilon=10^{-12}","position":{"start":{"line":1001,"column":1},"end":{"line":1001,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ϵ</mi><mo>=</mo><mn>1</mn><msup><mn>0</mn><mrow><mo>−</mo><mn>12</mn></mrow></msup></mrow><annotation encoding=\"application/x-tex\">\\epsilon=10^{-12}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">ϵ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">12</span></span></span></span></span></span></span></span></span></span></span></span>","key":"QqTEdN9FpU"},{"type":"text","value":" and exact solution ","position":{"start":{"line":1001,"column":1},"end":{"line":1001,"column":1}},"key":"jpjk38Pzda"},{"type":"inlineMath","value":"[1,1]","position":{"start":{"line":1001,"column":1},"end":{"line":1001,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[1,1]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]</span></span></span></span>","key":"KzgZdUbIQ6"},{"type":"text","value":":","position":{"start":{"line":1001,"column":1},"end":{"line":1001,"column":1}},"key":"NCvwejiH3g"}],"key":"l1tRjwRpCa"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"ϵ = 1e-12\nA = [-ϵ 1; 1 -1]\nb = A * [1, 1]","key":"gho6ne6B60"},{"type":"output","id":"rcKdSLKbweT3mIbqgb72G","data":[{"output_type":"execute_result","execution_count":99,"metadata":{},"data":{"text/plain":{"content":"2-element Vector{Float64}:\n 0.999999999999\n 0.0","content_type":"text/plain"}}}],"key":"owYgUZpfST"}],"data":{},"key":"tFGbFL1vnd"},{"type":"paragraph","position":{"start":{"line":1009,"column":1},"end":{"line":1009,"column":1}},"children":[{"type":"text","value":"We can factor the matrix without pivoting and solve for ","position":{"start":{"line":1009,"column":1},"end":{"line":1009,"column":1}},"key":"ZEHe7lRhLU"},{"type":"inlineMath","value":"\\mathbf{x}","position":{"start":{"line":1009,"column":1},"end":{"line":1009,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">x</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{x}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4444em;\"></span><span class=\"mord mathbf\">x</span></span></span></span>","key":"IxOhxvxoLY"},{"type":"text","value":".","position":{"start":{"line":1009,"column":1},"end":{"line":1009,"column":1}},"key":"y9x8OBMGkz"}],"key":"gpKdwh4J1c"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"L, U = FNC.lufact(A)\nx = FNC.backsub( U, FNC.forwardsub(L, b) )","key":"J9RvimQ7Ke"},{"type":"output","id":"iXAE7zFiRCx1558fU4tA3","data":[{"output_type":"execute_result","execution_count":100,"metadata":{},"data":{"text/plain":{"content":"2-element Vector{Float64}:\n 0.9999778782798785\n 1.0","content_type":"text/plain"}}}],"key":"Sb7owb5K4v"}],"data":{},"key":"yXtLSOitbJ"},{"type":"paragraph","position":{"start":{"line":1016,"column":1},"end":{"line":1016,"column":1}},"children":[{"type":"text","value":"Note that we have obtained only about 5 accurate digits for ","position":{"start":{"line":1016,"column":1},"end":{"line":1016,"column":1}},"key":"Gv7rGBzyYd"},{"type":"inlineMath","value":"x_1","position":{"start":{"line":1016,"column":1},"end":{"line":1016,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">x_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"yOBgrqIPIv"},{"type":"text","value":". We could make the result even more inaccurate by making ","position":{"start":{"line":1016,"column":1},"end":{"line":1016,"column":1}},"key":"l2gkwTtQFp"},{"type":"text","value":"ε","position":{"start":{"line":1016,"column":1},"end":{"line":1016,"column":1}},"key":"N5iji3QSuB"},{"type":"text","value":" even smaller:","position":{"start":{"line":1016,"column":1},"end":{"line":1016,"column":1}},"key":"eFnnm0V2W8"}],"key":"XXV2B6fWzu"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"ϵ = 1e-20; A = [-ϵ 1; 1 -1]\nb = A * [1, 1]\nL, U = FNC.lufact(A)\nx = FNC.backsub( U, FNC.forwardsub(L, b) )","key":"C40Uxia27C"},{"type":"output","id":"vey1CaoXAfB6WcPQcXRKY","data":[{"output_type":"execute_result","execution_count":101,"metadata":{},"data":{"text/plain":{"content":"2-element Vector{Float64}:\n -0.0\n  1.0","content_type":"text/plain"}}}],"key":"m86P7HFzT4"}],"data":{},"key":"bHZ1NNqNAs"},{"type":"paragraph","position":{"start":{"line":1025,"column":1},"end":{"line":1025,"column":1}},"children":[{"type":"text","value":"This effect is not due to ill conditioning of the problem—a solution with PLU factorization works perfectly:","position":{"start":{"line":1025,"column":1},"end":{"line":1025,"column":1}},"key":"UOrq59Vr6c"}],"key":"yDZv3des6h"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"A \\ b","key":"Q7FOxtjsLd"},{"type":"output","id":"eL1uAPH3ilR07Do2kPeLF","data":[{"output_type":"execute_result","execution_count":102,"metadata":{},"data":{"text/plain":{"content":"2-element Vector{Float64}:\n 1.0\n 1.0","content_type":"text/plain"}}}],"key":"QTuoSzQzCM"}],"data":{},"key":"LZ0qDuyffm"}],"key":"TfVHrqciOb"}],"key":"pIG7cRoJbA"}],"key":"VzYfhiE8OF"},{"type":"tabItem","title":"MATLAB","sync":"matlab","children":[{"type":"embed","source":{"url":"/chapter2-1","label":"demo-pivoting-stable-matlab","kind":"Notebook","slug":"chapter2-1","location":"/matlab/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-pivoting-stable","label":"demo-pivoting-stable","kind":"proof:example","position":{"start":{"line":952,"column":1},"end":{"line":952,"column":22}},"children":[{"type":"text","value":"Example ","key":"iyLrolLGiQ"},{"type":"text","value":"2.6.6","key":"G7cIQFngza"}],"template":"Example %s","enumerator":"2.6.6","resolved":true,"html_id":"demo-pivoting-stable","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"I5g5ODzqWi"}],"key":"GeE5Y0NbrK"},{"type":"paragraph","position":{"start":{"line":953,"column":1},"end":{"line":953,"column":1}},"children":[{"type":"text","value":"We construct a linear system for this matrix with ","position":{"start":{"line":953,"column":1},"end":{"line":953,"column":1}},"key":"BakxgNuBpT"},{"type":"inlineMath","value":"\\epsilon=10^{-12}","position":{"start":{"line":953,"column":1},"end":{"line":953,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ϵ</mi><mo>=</mo><mn>1</mn><msup><mn>0</mn><mrow><mo>−</mo><mn>12</mn></mrow></msup></mrow><annotation encoding=\"application/x-tex\">\\epsilon=10^{-12}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">ϵ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">12</span></span></span></span></span></span></span></span></span></span></span></span>","key":"tXR1VF468e"},{"type":"text","value":" and exact solution ","position":{"start":{"line":953,"column":1},"end":{"line":953,"column":1}},"key":"DI41IGL1x2"},{"type":"inlineMath","value":"[1, 1]","position":{"start":{"line":953,"column":1},"end":{"line":953,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[1, 1]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]</span></span></span></span>","key":"q4rT0IuI1N"},{"type":"text","value":":","position":{"start":{"line":953,"column":1},"end":{"line":953,"column":1}},"key":"DWpIykhUWc"}],"key":"WfFo8uNto3"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"ep = 1e-12\nA = [-ep 1; 1 -1];\nb = A * [1; 1];","key":"K4NIoMmZd3"},{"type":"output","id":"yVTx6RiX48grEKNUdl3Qw","data":[{"output_type":"execute_result","execution_count":97,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ep = \n   1.0000e-12\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ep = \n   1.0000e-12\n","content_type":"text/plain"}}}],"key":"Z9ZGmtDgXx"}],"data":{},"key":"KNPfZx0YSy"},{"type":"paragraph","position":{"start":{"line":961,"column":1},"end":{"line":961,"column":1}},"children":[{"type":"text","value":"We can factor the matrix without pivoting and solve for ","position":{"start":{"line":961,"column":1},"end":{"line":961,"column":1}},"key":"xCnxD4ErjH"},{"type":"inlineMath","value":"\\mathbf{x}","position":{"start":{"line":961,"column":1},"end":{"line":961,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">x</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{x}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4444em;\"></span><span class=\"mord mathbf\">x</span></span></span></span>","key":"LazCB7BObr"},{"type":"text","value":".","position":{"start":{"line":961,"column":1},"end":{"line":961,"column":1}},"key":"XpLpS5eD5L"}],"key":"tgzl9488Wa"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[L, U] = lufact(A);\nx = backsub( U, forwardsub(L, b) )","key":"Cd1Ijsgs90"},{"type":"output","id":"iFE652NN4l_xPzONvzg0_","data":[{"output_type":"execute_result","execution_count":98,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>x = 2×1 double\n   9.9998e-01\n   1.0000e+00\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"x = 2×1 double\n   9.9998e-01\n   1.0000e+00\n","content_type":"text/plain"}}}],"key":"ftkERm05KU"}],"data":{},"key":"p64Z0Qtkee"},{"type":"paragraph","position":{"start":{"line":968,"column":1},"end":{"line":968,"column":1}},"children":[{"type":"text","value":"Note that we have obtained only about 5 accurate digits for ","position":{"start":{"line":968,"column":1},"end":{"line":968,"column":1}},"key":"DkuMYdjzP8"},{"type":"inlineMath","value":"x_1","position":{"start":{"line":968,"column":1},"end":{"line":968,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">x_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"ExD0MGNDWv"},{"type":"text","value":". We could make the result even more inaccurate by making ","position":{"start":{"line":968,"column":1},"end":{"line":968,"column":1}},"key":"zF1NUnEvpe"},{"type":"text","value":"ε","position":{"start":{"line":968,"column":1},"end":{"line":968,"column":1}},"key":"v2ZCeoP4Hz"},{"type":"text","value":" even smaller:","position":{"start":{"line":968,"column":1},"end":{"line":968,"column":1}},"key":"VZ4tHyNJBR"}],"key":"udWQyeP5gk"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"ep = 1e-20; A = [-ep 1; 1 -1];\nb = A * [1; 1];\n[L, U] = lufact(A);\nx = backsub( U, forwardsub(L, b) )","key":"h2ZMkgKZY8"},{"type":"output","id":"MA5Jpp-ezDvZr0kHRcWAL","data":[{"output_type":"execute_result","execution_count":99,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>x = 2×1 double\n     0\n     1\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"x = 2×1 double\n     0\n     1\n","content_type":"text/plain"}}}],"key":"AGTtjzMBAe"}],"data":{},"key":"aUTqao87Pn"},{"type":"paragraph","position":{"start":{"line":977,"column":1},"end":{"line":977,"column":1}},"children":[{"type":"text","value":"This effect is not due to ill conditioning of the problem—a solution with PLU factorization works perfectly:","position":{"start":{"line":977,"column":1},"end":{"line":977,"column":1}},"key":"wXRbF2ivh8"}],"key":"Vnd30bfm4L"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A \\ b","key":"FtSkD87gZP"},{"type":"output","id":"ecKlibVcX7ufd-Dsr35K2","data":[{"output_type":"execute_result","execution_count":100,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = 2×1 double\n     1\n     1\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = 2×1 double\n     1\n     1\n","content_type":"text/plain"}}}],"key":"Q1iR5Tjm7K"}],"data":{},"key":"nmCchDg9hj"}],"key":"mYVdpyi3Xx"}],"key":"FxZ4oyqVic"}],"key":"mdxAY6HN0T"},{"type":"tabItem","title":"Python","sync":"python","children":[{"type":"embed","source":{"url":"/chapter2-2","label":"demo-pivoting-stable-python","kind":"Notebook","slug":"chapter2-2","location":"/python/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-pivoting-stable","label":"demo-pivoting-stable","kind":"proof:example","position":{"start":{"line":940,"column":1},"end":{"line":940,"column":22}},"children":[{"type":"text","value":"Example ","key":"LyMw5rYvV7"},{"type":"text","value":"2.6.6","key":"BmTQ4BKnOj"}],"template":"Example %s","enumerator":"2.6.6","resolved":true,"html_id":"demo-pivoting-stable","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"QjKVvpGtqk"}],"key":"zib6rAoWiK"},{"type":"paragraph","position":{"start":{"line":941,"column":1},"end":{"line":941,"column":1}},"children":[{"type":"text","value":"We construct a linear system for this matrix with ","position":{"start":{"line":941,"column":1},"end":{"line":941,"column":1}},"key":"xy7j9Btc9C"},{"type":"inlineMath","value":"\\epsilon=10^{-12}","position":{"start":{"line":941,"column":1},"end":{"line":941,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ϵ</mi><mo>=</mo><mn>1</mn><msup><mn>0</mn><mrow><mo>−</mo><mn>12</mn></mrow></msup></mrow><annotation encoding=\"application/x-tex\">\\epsilon=10^{-12}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">ϵ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">12</span></span></span></span></span></span></span></span></span></span></span></span>","key":"KX7rzJEYYV"},{"type":"text","value":" and exact solution ","position":{"start":{"line":941,"column":1},"end":{"line":941,"column":1}},"key":"Z3Yoq0yKDh"},{"type":"inlineMath","value":"[1,1]","position":{"start":{"line":941,"column":1},"end":{"line":941,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[1,1]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]</span></span></span></span>","key":"AdxW7rxcg1"},{"type":"text","value":":","position":{"start":{"line":941,"column":1},"end":{"line":941,"column":1}},"key":"wzrXOsPdql"}],"key":"Q9fPoUWBod"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ep = 1e-12\nA = array([[-ep, 1], [1, -1]])\nb = A @ array([1, 1])","key":"kRP8usBfKC"},{"type":"output","id":"YQ_x1vKrQfaNJYUL9Jc1s","data":[],"key":"AGQ6CpttFI"}],"data":{},"key":"wAjEsIM7Nv"},{"type":"paragraph","position":{"start":{"line":949,"column":1},"end":{"line":949,"column":1}},"children":[{"type":"text","value":"We can factor the matrix without pivoting and solve for ","position":{"start":{"line":949,"column":1},"end":{"line":949,"column":1}},"key":"TAVTveJGKS"},{"type":"inlineMath","value":"\\mathbf{x}","position":{"start":{"line":949,"column":1},"end":{"line":949,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">x</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{x}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4444em;\"></span><span class=\"mord mathbf\">x</span></span></span></span>","key":"fLkT4LeuvE"},{"type":"text","value":".","position":{"start":{"line":949,"column":1},"end":{"line":949,"column":1}},"key":"h34DQDGxRI"}],"key":"Qt2OGGjptC"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"L, U = FNC.lufact(A)\nprint(FNC.backsub( U, FNC.forwardsub(L, b) ))","key":"HVaoEgSSXz"},{"type":"output","id":"95reSPIM4HSCEms-S9k3O","data":[{"output_type":"stream","name":"stdout","text":"[0.99997788 1.        ]\n"}],"key":"YlIYQonANM"}],"data":{},"key":"C4xeGAQsRw"},{"type":"paragraph","position":{"start":{"line":956,"column":1},"end":{"line":956,"column":1}},"children":[{"type":"text","value":"Note that we have obtained only about 5 accurate digits for ","position":{"start":{"line":956,"column":1},"end":{"line":956,"column":1}},"key":"RgRCEQnwlP"},{"type":"inlineMath","value":"x_1","position":{"start":{"line":956,"column":1},"end":{"line":956,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">x_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"xz46lgqadj"},{"type":"text","value":". We could make the result even more inaccurate by making ","position":{"start":{"line":956,"column":1},"end":{"line":956,"column":1}},"key":"A9bA5sPaHQ"},{"type":"text","value":"ε","position":{"start":{"line":956,"column":1},"end":{"line":956,"column":1}},"key":"delkOkMiub"},{"type":"text","value":" even smaller:","position":{"start":{"line":956,"column":1},"end":{"line":956,"column":1}},"key":"IAOkkOUglj"}],"key":"tUNYWbazRO"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ep = 1e-20;\nA = array([[-ep, 1], [1, -1]])\nb = A @ array([1, 1])\nL, U = FNC.lufact(A)\nprint(FNC.backsub( U, FNC.forwardsub(L, b) ))","key":"Ps9XbwZ31N"},{"type":"output","id":"sJmFyaff7aVs3n8lcxf_N","data":[{"output_type":"stream","name":"stdout","text":"[-0.  1.]\n"}],"key":"DAbEbi68RB"}],"data":{},"key":"YHlffZlXbD"},{"type":"paragraph","position":{"start":{"line":966,"column":1},"end":{"line":966,"column":1}},"children":[{"type":"text","value":"This effect is not due to ill conditioning of the problem—a solution with PLU factorization works perfectly:","position":{"start":{"line":966,"column":1},"end":{"line":966,"column":1}},"key":"xeSMuT7riH"}],"key":"ciSPaojD55"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(linalg.solve(A, b))","key":"UY7vbwlmMd"},{"type":"output","id":"epsFOsEDA4oN8OtkN2H3B","data":[{"output_type":"stream","name":"stdout","text":"[1. 1.]\n"}],"key":"lvPfEyVG0o"}],"data":{},"key":"EczUwq7k5d"}],"key":"oHZ0gii2WF"}],"key":"Ru3w4GbZlz"}],"key":"O86fbzIvxx"}],"key":"Qab9oLIOLL"}],"label":"demo-pivoting-stable","identifier":"demo-pivoting-stable","html_id":"demo-pivoting-stable","enumerator":"2.6.6","key":"K9nBUJ4akZ"},{"type":"paragraph","position":{"start":{"line":247,"column":1},"end":{"line":247,"column":1}},"children":[{"type":"text","value":"The factors of this ","position":{"start":{"line":247,"column":1},"end":{"line":247,"column":1}},"key":"uM8vSowiel"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":247,"column":1},"end":{"line":247,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"vdQAUOIexG"},{"type":"text","value":" without pivoting are found to be","position":{"start":{"line":247,"column":1},"end":{"line":247,"column":1}},"key":"CMC1T5ZnlJ"}],"key":"h2skAjclPe"},{"type":"math","value":"  \\mathbf{L} = \n  \\begin{bmatrix}\n    1 & 0 \\\\ -\\epsilon^{-1} & 1 \n  \\end{bmatrix}, \\qquad \n  \\mathbf{U} = \n  \\begin{bmatrix}\n    -\\epsilon & 1 \\\\ 0 & \\epsilon^{-1}-1 \n  \\end{bmatrix}.","label":"plu-stab-LU","identifier":"plu-stab-lu","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi mathvariant=\"bold\">L</mi><mo>=</mo><mrow><mo fence=\"true\">[</mo><mtable rowspacing=\"0.16em\" columnalign=\"center center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>0</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><msup><mi>ϵ</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd></mtr></mtable><mo fence=\"true\">]</mo></mrow><mo separator=\"true\">,</mo><mspace width=\"2em\"/><mi mathvariant=\"bold\">U</mi><mo>=</mo><mrow><mo fence=\"true\">[</mo><mtable rowspacing=\"0.16em\" columnalign=\"center center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mi>ϵ</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><msup><mi>ϵ</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo>−</mo><mn>1</mn></mrow></mstyle></mtd></mtr></mtable><mo fence=\"true\">]</mo></mrow><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">  \\mathbf{L} = \n  \\begin{bmatrix}\n    1 &amp; 0 \\\\ -\\epsilon^{-1} &amp; 1 \n  \\end{bmatrix}, \\qquad \n  \\mathbf{U} = \n  \\begin{bmatrix}\n    -\\epsilon &amp; 1 \\\\ 0 &amp; \\epsilon^{-1}-1 \n  \\end{bmatrix}.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">L</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.4em;vertical-align:-0.95em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">[</span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord\"><span class=\"mord mathnormal\">ϵ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.95em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">0</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.95em;\"><span></span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">]</span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:2em;\"></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathbf\">U</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.4em;vertical-align:-0.95em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">[</span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord mathnormal\">ϵ</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.95em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">ϵ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.95em;\"><span></span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">]</span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">.</span></span></span></span></span>","enumerator":"2.6.3","html_id":"plu-stab-lu","key":"gGmyY5JshV"},{"type":"paragraph","position":{"start":{"line":261,"column":1},"end":{"line":261,"column":1}},"children":[{"type":"text","value":"For reasons we will quantify in ","position":{"start":{"line":261,"column":1},"end":{"line":261,"column":1}},"key":"u28yGyt3rG"},{"type":"link","kind":"numref","identifier":"section-linsys-condition-number","label":"section-linsys-condition-number","url":"/condition-number","internal":true,"dataUrl":"/condition-number.json","children":[{"type":"text","value":"Conditioning of linear systems","key":"plGg0wv0zy"}],"key":"xTSJgQWCiN"},{"type":"text","value":", the solution of ","position":{"start":{"line":261,"column":1},"end":{"line":261,"column":1}},"key":"t86lJtbIgh"},{"type":"inlineMath","value":"\\mathbf{A}\\mathbf{x}=\\mathbf{b}","position":{"start":{"line":261,"column":1},"end":{"line":261,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi><mi mathvariant=\"bold\">x</mi><mo>=</mo><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}\\mathbf{x}=\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">Ax</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"A62wU7Sgab"},{"type":"text","value":" is well-conditioned, but the problems of solving ","position":{"start":{"line":261,"column":1},"end":{"line":261,"column":1}},"key":"NGeDIeI01B"},{"type":"inlineMath","value":"\\mathbf{L}\\mathbf{z}=\\mathbf{b}","position":{"start":{"line":261,"column":1},"end":{"line":261,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi><mi mathvariant=\"bold\">z</mi><mo>=</mo><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}\\mathbf{z}=\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">Lz</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"yN5kiYxwcT"},{"type":"text","value":" and ","position":{"start":{"line":261,"column":1},"end":{"line":261,"column":1}},"key":"ACbDvpAxVu"},{"type":"inlineMath","value":"\\mathbf{U}\\mathbf{x}=\\mathbf{z}","position":{"start":{"line":261,"column":1},"end":{"line":261,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi><mi mathvariant=\"bold\">x</mi><mo>=</mo><mi mathvariant=\"bold\">z</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}\\mathbf{x}=\\mathbf{z}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">Ux</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4444em;\"></span><span class=\"mord mathbf\">z</span></span></span></span>","key":"EbNfdoe5jA"},{"type":"text","value":" have condition numbers essentially ","position":{"start":{"line":261,"column":1},"end":{"line":261,"column":1}},"key":"fMbmkl5mej"},{"type":"inlineMath","value":"1/\\epsilon^2","position":{"start":{"line":261,"column":1},"end":{"line":261,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mi mathvariant=\"normal\">/</mi><msup><mi>ϵ</mi><mn>2</mn></msup></mrow><annotation encoding=\"application/x-tex\">1/\\epsilon^2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord\">1/</span><span class=\"mord\"><span class=\"mord mathnormal\">ϵ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span>","key":"pWm445p8Gt"},{"type":"text","value":" each. Thus, for small ","position":{"start":{"line":261,"column":1},"end":{"line":261,"column":1}},"key":"eOiCccG1RN"},{"type":"text","value":"ε","position":{"start":{"line":261,"column":1},"end":{"line":261,"column":1}},"key":"evpTv2HWdQ"},{"type":"text","value":", solution of the original linear system by unpivoted LU factorization is highly unstable.","position":{"start":{"line":261,"column":1},"end":{"line":261,"column":1}},"key":"W1rr6sD5k6"}],"key":"Xquw21ksZz"},{"type":"paragraph","position":{"start":{"line":263,"column":1},"end":{"line":263,"column":1}},"children":[{"type":"text","value":"Somewhat surprisingly, solving ","position":{"start":{"line":263,"column":1},"end":{"line":263,"column":1}},"key":"HlB2jCL2xK"},{"type":"inlineMath","value":"\\mathbf{A}\\mathbf{x}=\\mathbf{b}","position":{"start":{"line":263,"column":1},"end":{"line":263,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi><mi mathvariant=\"bold\">x</mi><mo>=</mo><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}\\mathbf{x}=\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">Ax</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"pq8AvVAOAU"},{"type":"text","value":" via PLU factorization is technically also unstable. In fact, examples of unstable solutions are well-known, but they have been nonexistent in practice. While there is a lot of evidence and some reasoning about why this is the case, the situation is not completely understood. Yet PLU factorization remains the algorithm of choice for general linear systems.","position":{"start":{"line":263,"column":1},"end":{"line":263,"column":1}},"key":"sjJ0ciUwB4"}],"key":"SZcu1D9FZe"},{"type":"heading","depth":2,"position":{"start":{"line":265,"column":1},"end":{"line":265,"column":1}},"children":[{"type":"text","value":"Exercises","position":{"start":{"line":265,"column":1},"end":{"line":265,"column":1}},"key":"zV5cBy8dym"}],"identifier":"exercises","label":"Exercises","html_id":"exercises","implicit":true,"enumerator":"2.6.5","key":"WKPpxyPRmX"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":267,"column":1},"end":{"line":303,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":267,"column":1},"end":{"line":280,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":267,"column":1},"end":{"line":267,"column":1}},"children":[{"type":"text","value":"✍ Perform by hand the pivoted LU factorization of each matrix.","position":{"start":{"line":267,"column":1},"end":{"line":267,"column":1}},"key":"EYyFbvst4M"}],"key":"k4BvKGKfAN"},{"type":"paragraph","position":{"start":{"line":269,"column":1},"end":{"line":279,"column":1}},"children":[{"type":"strong","position":{"start":{"line":269,"column":1},"end":{"line":269,"column":1}},"children":[{"type":"text","value":"(a)","position":{"start":{"line":269,"column":1},"end":{"line":269,"column":1}},"key":"vvkcKjJcLv"}],"key":"mLie53O8cy"},{"type":"text","value":" ","position":{"start":{"line":269,"column":1},"end":{"line":269,"column":1}},"key":"dd8YskmBCe"},{"type":"inlineMath","value":"\\quad \\displaystyle \\begin{bmatrix}\n 2 & 3 & 4 \\\\\n 4 & 5 & 10 \\\\\n 4 & 8 & 2\n \\end{bmatrix},\\qquad","position":{"start":{"line":269,"column":1},"end":{"line":269,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mspace width=\"1em\"/><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mo fence=\"true\">[</mo><mtable rowspacing=\"0.16em\" columnalign=\"center center center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>2</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>3</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>4</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>4</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>5</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>10</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>4</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>8</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>2</mn></mstyle></mtd></mtr></mtable><mo fence=\"true\">]</mo></mrow><mo separator=\"true\">,</mo><mspace width=\"2em\"/></mstyle></mrow><annotation encoding=\"application/x-tex\">\\quad \\displaystyle \\begin{bmatrix}\n 2 &amp; 3 &amp; 4 \\\\\n 4 &amp; 5 &amp; 10 \\\\\n 4 &amp; 8 &amp; 2\n \\end{bmatrix},\\qquad</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:3.6em;vertical-align:-1.55em;\"></span><span class=\"mspace\" style=\"margin-right:1em;\"></span><span class=\"minner\"><span class=\"mopen\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.05em;\"><span style=\"top:-2.25em;\"><span class=\"pstrut\" style=\"height:3.155em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎣</span></span></span><span style=\"top:-3.397em;\"><span class=\"pstrut\" style=\"height:3.155em;\"></span><span style=\"height:0.016em;width:0.6667em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.6667em' height='0.016em' style='width:0.6667em' viewBox='0 0 666.67 16' preserveAspectRatio='xMinYMin'><path d='M319 0 H403 V16 H319z M319 0 H403 V16 H319z'/></svg></span></span><span style=\"top:-4.05em;\"><span class=\"pstrut\" style=\"height:3.155em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎡</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.55em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.05em;\"><span style=\"top:-4.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">2</span></span></span><span style=\"top:-3.01em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">4</span></span></span><span style=\"top:-1.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">4</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.55em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.05em;\"><span style=\"top:-4.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">3</span></span></span><span style=\"top:-3.01em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">5</span></span></span><span style=\"top:-1.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">8</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.55em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.05em;\"><span style=\"top:-4.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">4</span></span></span><span style=\"top:-3.01em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">10</span></span></span><span style=\"top:-1.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.55em;\"><span></span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.05em;\"><span style=\"top:-2.25em;\"><span class=\"pstrut\" style=\"height:3.155em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎦</span></span></span><span style=\"top:-3.397em;\"><span class=\"pstrut\" style=\"height:3.155em;\"></span><span style=\"height:0.016em;width:0.6667em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.6667em' height='0.016em' style='width:0.6667em' viewBox='0 0 666.67 16' preserveAspectRatio='xMinYMin'><path d='M263 0 H347 V16 H263z M263 0 H347 V16 H263z'/></svg></span></span><span style=\"top:-4.05em;\"><span class=\"pstrut\" style=\"height:3.155em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎤</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.55em;\"><span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:2em;\"></span></span></span></span>","key":"sKsIjVzJze"},{"type":"text","value":"\n","position":{"start":{"line":269,"column":1},"end":{"line":269,"column":1}},"key":"Yr0gF7NAUe"},{"type":"strong","position":{"start":{"line":269,"column":1},"end":{"line":269,"column":1}},"children":[{"type":"text","value":"(b)","position":{"start":{"line":269,"column":1},"end":{"line":269,"column":1}},"key":"pnZajskzqr"}],"key":"CsO8u9MwUP"},{"type":"text","value":" ","position":{"start":{"line":269,"column":1},"end":{"line":269,"column":1}},"key":"AeRmo6I2td"},{"type":"inlineMath","value":"\\quad \\displaystyle \\begin{bmatrix}\n 1 & 4 & 5 & -5 \\\\\n -1 & 0 & -1 & -5 \\\\\n 1 & 3 & -1 & 2 \\\\\n 1 & -1 & 5 & -1 \n \\end{bmatrix}","position":{"start":{"line":269,"column":1},"end":{"line":269,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mspace width=\"1em\"/><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mo fence=\"true\">[</mo><mtable rowspacing=\"0.16em\" columnalign=\"center center center center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>4</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>5</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mn>5</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mn>1</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mn>1</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mn>5</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>3</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mn>1</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>2</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mn>1</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>5</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mn>1</mn></mrow></mstyle></mtd></mtr></mtable><mo fence=\"true\">]</mo></mrow></mstyle></mrow><annotation encoding=\"application/x-tex\">\\quad \\displaystyle \\begin{bmatrix}\n 1 &amp; 4 &amp; 5 &amp; -5 \\\\\n -1 &amp; 0 &amp; -1 &amp; -5 \\\\\n 1 &amp; 3 &amp; -1 &amp; 2 \\\\\n 1 &amp; -1 &amp; 5 &amp; -1 \n \\end{bmatrix}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:4.8001em;vertical-align:-2.15em;\"></span><span class=\"mspace\" style=\"margin-right:1em;\"></span><span class=\"minner\"><span class=\"mopen\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.65em;\"><span style=\"top:-1.711em;\"><span class=\"pstrut\" style=\"height:3.216em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎣</span></span></span><span style=\"top:-2.858em;\"><span class=\"pstrut\" style=\"height:3.216em;\"></span><span style=\"height:1.216em;width:0.6667em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.6667em' height='1.216em' style='width:0.6667em' viewBox='0 0 666.67 1216' preserveAspectRatio='xMinYMin'><path d='M319 0 H403 V1216 H319z M319 0 H403 V1216 H319z'/></svg></span></span><span style=\"top:-4.7111em;\"><span class=\"pstrut\" style=\"height:3.216em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎡</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.65em;\"><span style=\"top:-4.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord\">1</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span><span style=\"top:-1.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.15em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.65em;\"><span style=\"top:-4.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">4</span></span></span><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">0</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">3</span></span></span><span style=\"top:-1.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.15em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.65em;\"><span style=\"top:-4.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">5</span></span></span><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord\">1</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord\">1</span></span></span><span style=\"top:-1.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">5</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.15em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.65em;\"><span style=\"top:-4.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord\">5</span></span></span><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord\">5</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">2</span></span></span><span style=\"top:-1.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.15em;\"><span></span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.65em;\"><span style=\"top:-1.711em;\"><span class=\"pstrut\" style=\"height:3.216em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎦</span></span></span><span style=\"top:-2.858em;\"><span class=\"pstrut\" style=\"height:3.216em;\"></span><span style=\"height:1.216em;width:0.6667em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.6667em' height='1.216em' style='width:0.6667em' viewBox='0 0 666.67 1216' preserveAspectRatio='xMinYMin'><path d='M263 0 H347 V1216 H263z M263 0 H347 V1216 H263z'/></svg></span></span><span style=\"top:-4.7111em;\"><span class=\"pstrut\" style=\"height:3.216em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎤</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.15em;\"><span></span></span></span></span></span></span></span></span></span></span>","key":"BFUFGavVrd"},{"type":"text","value":".","position":{"start":{"line":269,"column":1},"end":{"line":269,"column":1}},"key":"Rqn7gmvVtd"}],"key":"dPfNb4Btdh"}],"key":"ccyY9Tvxhm"},{"type":"listItem","spread":true,"position":{"start":{"line":281,"column":1},"end":{"line":295,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":281,"column":1},"end":{"line":281,"column":1}},"children":[{"type":"text","value":"✍ Let ","position":{"start":{"line":281,"column":1},"end":{"line":281,"column":1}},"key":"tSMKU6PIAt"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":281,"column":1},"end":{"line":281,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"PMWJ23PCO3"},{"type":"text","value":" be a square matrix and ","position":{"start":{"line":281,"column":1},"end":{"line":281,"column":1}},"key":"wkDsneVXEW"},{"type":"inlineMath","value":"\\mathbf{b}","position":{"start":{"line":281,"column":1},"end":{"line":281,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"hHNvhvGROk"},{"type":"text","value":" be a column vector of compatible length. Here is correct Julia code to solve ","position":{"start":{"line":281,"column":1},"end":{"line":281,"column":1}},"key":"JQapJQ3UZK"},{"type":"inlineMath","value":"\\mathbf{A}\\mathbf{x}=\\mathbf{b}","position":{"start":{"line":281,"column":1},"end":{"line":281,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi><mi mathvariant=\"bold\">x</mi><mo>=</mo><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}\\mathbf{x}=\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">Ax</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"gPoYU1UHIg"},{"type":"text","value":":","position":{"start":{"line":281,"column":1},"end":{"line":281,"column":1}},"key":"O23QaIuVZE"}],"key":"HGKoPMPM7y"},{"type":"code","lang":"julia","value":"L,U,p = lu(A)\nx = U \\ (L\\b[p])","position":{"start":{"line":283,"column":1},"end":{"line":286,"column":1}},"key":"D969LMJmRo"},{"type":"paragraph","position":{"start":{"line":288,"column":1},"end":{"line":288,"column":1}},"children":[{"type":"text","value":"Suppose instead you replace the last line above with","position":{"start":{"line":288,"column":1},"end":{"line":288,"column":1}},"key":"lupiv6mjNr"}],"key":"x5j57Hoor7"},{"type":"code","lang":"julia","value":"x = U \\ L \\ b[p]","position":{"start":{"line":290,"column":1},"end":{"line":292,"column":1}},"key":"bsyeIWnIrj"},{"type":"paragraph","position":{"start":{"line":294,"column":1},"end":{"line":294,"column":1}},"children":[{"type":"text","value":"Mathematically in terms of ","position":{"start":{"line":294,"column":1},"end":{"line":294,"column":1}},"key":"hSZ9ZrXDvl"},{"type":"inlineMath","value":"\\mathbf{L}","position":{"start":{"line":294,"column":1},"end":{"line":294,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">L</span></span></span></span>","key":"WXn07ZLMGd"},{"type":"text","value":", ","position":{"start":{"line":294,"column":1},"end":{"line":294,"column":1}},"key":"muBpny9fAb"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":294,"column":1},"end":{"line":294,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"rsH91UNksk"},{"type":"text","value":", ","position":{"start":{"line":294,"column":1},"end":{"line":294,"column":1}},"key":"ATn9ZRDPSL"},{"type":"inlineMath","value":"\\mathbf{p}","position":{"start":{"line":294,"column":1},"end":{"line":294,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">p</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{p}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6389em;vertical-align:-0.1944em;\"></span><span class=\"mord mathbf\">p</span></span></span></span>","key":"itlWmFG7WZ"},{"type":"text","value":", and ","position":{"start":{"line":294,"column":1},"end":{"line":294,"column":1}},"key":"rPhQecyMJ5"},{"type":"inlineMath","value":"\\mathbf{b}","position":{"start":{"line":294,"column":1},"end":{"line":294,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"Epyqz45g09"},{"type":"text","value":", what vector is found?","position":{"start":{"line":294,"column":1},"end":{"line":294,"column":1}},"key":"iO4HpgpSPu"}],"key":"TbnWHDyJln"}],"key":"Bu9xtfzPzs"},{"type":"listItem","spread":true,"position":{"start":{"line":296,"column":1},"end":{"line":303,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":296,"column":1},"end":{"line":296,"column":1}},"children":[{"type":"text","value":"✍ Suppose that ","position":{"start":{"line":296,"column":1},"end":{"line":296,"column":1}},"key":"E3By3hTGdG"},{"type":"inlineCode","value":"A","position":{"start":{"line":296,"column":1},"end":{"line":296,"column":1}},"key":"RQneZRgX2C"},{"type":"text","value":" is a ","position":{"start":{"line":296,"column":1},"end":{"line":296,"column":1}},"key":"obNURZz1ef"},{"type":"inlineMath","value":"4\\times 6","position":{"start":{"line":296,"column":1},"end":{"line":296,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>4</mn><mo>×</mo><mn>6</mn></mrow><annotation encoding=\"application/x-tex\">4\\times 6</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">4</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">6</span></span></span></span>","key":"gj4pzAhATn"},{"type":"text","value":" matrix in Julia and you define","position":{"start":{"line":296,"column":1},"end":{"line":296,"column":1}},"key":"gVfNNMUbBO"}],"key":"WhIMpj2t59"},{"type":"code","lang":"julia","value":"B = A[end:-1:1,end:-1:1]","position":{"start":{"line":298,"column":1},"end":{"line":300,"column":1}},"key":"qg1fIlp2rB"},{"type":"paragraph","position":{"start":{"line":302,"column":1},"end":{"line":302,"column":1}},"children":[{"type":"text","value":"Show that ","position":{"start":{"line":302,"column":1},"end":{"line":302,"column":1}},"key":"uZMhJJv3O4"},{"type":"inlineMath","value":"\\mathbf{B} = \\mathbf{P} \\mathbf{A} \\mathbf{Q}","position":{"start":{"line":302,"column":1},"end":{"line":302,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">B</mi><mo>=</mo><mi mathvariant=\"bold\">P</mi><mi mathvariant=\"bold\">A</mi><mi mathvariant=\"bold\">Q</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{B} = \\mathbf{P} \\mathbf{A} \\mathbf{Q}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">B</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8805em;vertical-align:-0.1944em;\"></span><span class=\"mord mathbf\">PAQ</span></span></span></span>","key":"e3LCb2kj2g"},{"type":"text","value":" for certain matrices ","position":{"start":{"line":302,"column":1},"end":{"line":302,"column":1}},"key":"fdMeCvGLG7"},{"type":"inlineMath","value":"\\mathbf{P}","position":{"start":{"line":302,"column":1},"end":{"line":302,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">P</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{P}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">P</span></span></span></span>","key":"b2nlkLrd5t"},{"type":"text","value":" and ","position":{"start":{"line":302,"column":1},"end":{"line":302,"column":1}},"key":"Zb46WHOd0i"},{"type":"inlineMath","value":"\\mathbf{Q}","position":{"start":{"line":302,"column":1},"end":{"line":302,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">Q</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{Q}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8805em;vertical-align:-0.1944em;\"></span><span class=\"mord mathbf\">Q</span></span></span></span>","key":"o1mNJwt5uL"},{"type":"text","value":".","position":{"start":{"line":302,"column":1},"end":{"line":302,"column":1}},"key":"ga9kYkuI7Y"}],"key":"H5w6AuWuoa"}],"key":"kQvGIjjOwA"}],"key":"tI9W2QResd"},{"type":"list","ordered":true,"start":4,"spread":false,"position":{"start":{"line":305,"column":1},"end":{"line":315,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":305,"column":1},"end":{"line":315,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":1}},"children":[{"type":"text","value":"✍ An ","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":1}},"key":"XBQKSaPl7f"},{"type":"inlineMath","value":"n\\times n","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>×</mo><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n\\times n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"LSMeQBERHf"},{"type":"text","value":" ","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":1}},"key":"uNXlxfEln3"},{"type":"emphasis","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":1}},"children":[{"type":"text","value":"permutation matrix","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":1}},"key":"EWJX9uMbgU"}],"key":"ovizjEdmkk"},{"type":"text","value":" ","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":1}},"key":"kXIBtaoCPL"},{"type":"inlineMath","value":"\\mathbf{P}","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">P</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{P}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">P</span></span></span></span>","key":"cgWGf1bjvC"},{"type":"text","value":" is a reordering of the rows of an identity matrix such that ","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":1}},"key":"Bhn10VNVGt"},{"type":"inlineMath","value":"\\mathbf{P} \\mathbf{A}","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">P</mi><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{P} \\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">PA</span></span></span></span>","key":"aGQriZy8cq"},{"type":"text","value":"  has the effect of moving rows ","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":1}},"key":"DluTdVVxhh"},{"type":"inlineMath","value":"1,2,\\ldots,n","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mo separator=\"true\">,</mo><mn>2</mn><mo separator=\"true\">,</mo><mo>…</mo><mo separator=\"true\">,</mo><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">1,2,\\ldots,n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8389em;vertical-align:-0.1944em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">2</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"PBLxax7kab"},{"type":"text","value":" of ","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":1}},"key":"d94K10hK5A"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"CVgsCnxPxG"},{"type":"text","value":" to new positions ","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":1}},"key":"LGoaW6lHyM"},{"type":"inlineMath","value":"i_1,i_2,\\ldots,i_n","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>i</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><msub><mi>i</mi><mn>2</mn></msub><mo separator=\"true\">,</mo><mo>…</mo><mo separator=\"true\">,</mo><msub><mi>i</mi><mi>n</mi></msub></mrow><annotation encoding=\"application/x-tex\">i_1,i_2,\\ldots,i_n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"sV5tZqtEIf"},{"type":"text","value":". Then ","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":1}},"key":"vsUrTkGeXG"},{"type":"inlineMath","value":"\\mathbf{P}","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">P</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{P}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">P</span></span></span></span>","key":"xcQJu4Dsf6"},{"type":"text","value":" can be expressed as","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":1}},"key":"wn4ssUvqwB"}],"key":"wKmoiihxw4"},{"type":"math","value":"\\mathbf{P} = \\mathbf{e}_{i_1}\\mathbf{e}_1^T + \\mathbf{e}_{i_2}\\mathbf{e}_2^T + \\cdots + \\mathbf{e}_{i_n}\\mathbf{e}_n^T.","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi mathvariant=\"bold\">P</mi><mo>=</mo><msub><mi mathvariant=\"bold\">e</mi><msub><mi>i</mi><mn>1</mn></msub></msub><msubsup><mi mathvariant=\"bold\">e</mi><mn>1</mn><mi>T</mi></msubsup><mo>+</mo><msub><mi mathvariant=\"bold\">e</mi><msub><mi>i</mi><mn>2</mn></msub></msub><msubsup><mi mathvariant=\"bold\">e</mi><mn>2</mn><mi>T</mi></msubsup><mo>+</mo><mo>⋯</mo><mo>+</mo><msub><mi mathvariant=\"bold\">e</mi><msub><mi>i</mi><mi>n</mi></msub></msub><msubsup><mi mathvariant=\"bold\">e</mi><mi>n</mi><mi>T</mi></msubsup><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{P} = \\mathbf{e}_{i_1}\\mathbf{e}_1^T + \\mathbf{e}_{i_2}\\mathbf{e}_2^T + \\cdots + \\mathbf{e}_{i_n}\\mathbf{e}_n^T.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">P</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1414em;vertical-align:-0.2501em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">e</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3173em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2501em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathbf\">e</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913em;\"><span style=\"top:-2.453em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1414em;vertical-align:-0.2501em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">e</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3173em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2501em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathbf\">e</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913em;\"><span style=\"top:-2.453em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"minner\">⋯</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1414em;vertical-align:-0.2501em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">e</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1645em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2501em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathbf\">e</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913em;\"><span style=\"top:-2.453em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span><span class=\"mord\">.</span></span></span></span></span>","enumerator":"2.6.4","key":"ktrnpDGKvH"},{"type":"paragraph","position":{"start":{"line":311,"column":1},"end":{"line":311,"column":1}},"children":[{"type":"strong","position":{"start":{"line":311,"column":1},"end":{"line":311,"column":1}},"children":[{"type":"text","value":"(a)","position":{"start":{"line":311,"column":1},"end":{"line":311,"column":1}},"key":"n39lm5HZdf"}],"key":"uXls9zw7Ra"},{"type":"text","value":" For the case ","position":{"start":{"line":311,"column":1},"end":{"line":311,"column":1}},"key":"ixwchJQ9HD"},{"type":"inlineMath","value":"n=4","position":{"start":{"line":311,"column":1},"end":{"line":311,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>=</mo><mn>4</mn></mrow><annotation encoding=\"application/x-tex\">n=4</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">4</span></span></span></span>","key":"rdJHgxVjjl"},{"type":"text","value":" and ","position":{"start":{"line":311,"column":1},"end":{"line":311,"column":1}},"key":"cbBmYOvk3p"},{"type":"inlineMath","value":"i_1=3","position":{"start":{"line":311,"column":1},"end":{"line":311,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>i</mi><mn>1</mn></msub><mo>=</mo><mn>3</mn></mrow><annotation encoding=\"application/x-tex\">i_1=3</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8095em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">3</span></span></span></span>","key":"c8TJ2gZ1hT"},{"type":"text","value":", ","position":{"start":{"line":311,"column":1},"end":{"line":311,"column":1}},"key":"s61GrUFbQf"},{"type":"inlineMath","value":"i_2=2","position":{"start":{"line":311,"column":1},"end":{"line":311,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>i</mi><mn>2</mn></msub><mo>=</mo><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">i_2=2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8095em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span></span></span></span>","key":"RRQaRnc9CM"},{"type":"text","value":", ","position":{"start":{"line":311,"column":1},"end":{"line":311,"column":1}},"key":"uZwmHE0Fyt"},{"type":"inlineMath","value":"i_3=4","position":{"start":{"line":311,"column":1},"end":{"line":311,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>i</mi><mn>3</mn></msub><mo>=</mo><mn>4</mn></mrow><annotation encoding=\"application/x-tex\">i_3=4</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8095em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">4</span></span></span></span>","key":"FRRnInfOX6"},{"type":"text","value":", ","position":{"start":{"line":311,"column":1},"end":{"line":311,"column":1}},"key":"CUrWir9VZy"},{"type":"inlineMath","value":"i_4=1","position":{"start":{"line":311,"column":1},"end":{"line":311,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>i</mi><mn>4</mn></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">i_4=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8095em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">4</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"P9dIY2D4MW"},{"type":"text","value":", write out separately, as matrices, all four of the terms in the sum. Then add them together to find ","position":{"start":{"line":311,"column":1},"end":{"line":311,"column":1}},"key":"KqB4QE06wr"},{"type":"inlineMath","value":"\\mathbf{P}","position":{"start":{"line":311,"column":1},"end":{"line":311,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">P</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{P}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">P</span></span></span></span>","key":"TqYQeDkwBu"},{"type":"text","value":".","position":{"start":{"line":311,"column":1},"end":{"line":311,"column":1}},"key":"a2ua3f3qP5"}],"key":"HLYfgDgvCr"},{"type":"paragraph","position":{"start":{"line":313,"column":1},"end":{"line":313,"column":1}},"children":[{"type":"strong","position":{"start":{"line":313,"column":1},"end":{"line":313,"column":1}},"children":[{"type":"text","value":"(b)","position":{"start":{"line":313,"column":1},"end":{"line":313,"column":1}},"key":"yfrQjnU75k"}],"key":"md98H31bWA"},{"type":"text","value":" Use the formula in the general case to show that ","position":{"start":{"line":313,"column":1},"end":{"line":313,"column":1}},"key":"oqY2og4ky9"},{"type":"inlineMath","value":"\\mathbf{P}^{-1}=\\mathbf{P}^T","position":{"start":{"line":313,"column":1},"end":{"line":313,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi mathvariant=\"bold\">P</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo>=</mo><msup><mi mathvariant=\"bold\">P</mi><mi>T</mi></msup></mrow><annotation encoding=\"application/x-tex\">\\mathbf{P}^{-1}=\\mathbf{P}^T</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">P</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8413em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">P</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span></span></span></span>","key":"l3S0h0WJ1q"},{"type":"text","value":".","position":{"start":{"line":313,"column":1},"end":{"line":313,"column":1}},"key":"pfO2zdS1SC"}],"key":"Y3UUG1Vzuw"}],"key":"GqbJmscxDi"}],"label":"problem-perminverse","identifier":"problem-perminverse","html_id":"problem-perminverse","key":"Na0BdyAPBE"},{"type":"footnoteDefinition","identifier":"plu","label":"PLU","position":{"start":{"line":313,"column":1},"end":{"line":313,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"children":[{"type":"text","value":"Because unpivoted LU factorization is not useful, in practice the term ","position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"key":"PpyO8SzRcD"},{"type":"emphasis","position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"children":[{"type":"text","value":"LU factorization","position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"key":"uYa8Iz3Fkk"}],"key":"SsnjYZgUUq"},{"type":"text","value":" mostly refers to pivoted LU.","position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"key":"CCS2Hn1GSX"}],"key":"z6lIs9yOaV"}],"number":1,"enumerator":"1","key":"IIq9YejVsE"}],"key":"YQkQ6HULJv"}],"key":"RrOGHduVqU"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Efficiency of matrix computations","url":"/efficiency","group":"Preface"},"next":{"title":"Vector and matrix norms","url":"/norms","group":"Preface"}}},"domain":"http://localhost:3000"}