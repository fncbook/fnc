{"kind":"Article","sha256":"9943caaa3608cc7dba7fb2247eaa267ef01b5d0c7680167d5fdcda3ea07873f8","slug":"pivoting","location":"/chapter2/pivoting.md","dependencies":[{"url":"/chapter2","label":"demo-pivoting-fail-julia","kind":"Notebook","slug":"chapter2","location":"/julia/chapter2.md","title":"Chapter 2"},{"url":"/chapter2-1","label":"demo-pivoting-fail-matlab","kind":"Notebook","slug":"chapter2-1","location":"/matlab/chapter2.md","title":"Chapter 2"},{"url":"/chapter2-2","label":"demo-pivoting-fail-python","kind":"Notebook","slug":"chapter2-2","location":"/python/chapter2.md","title":"Chapter 2"}],"frontmatter":{"title":"Row pivoting","numbering":{"heading_1":{"enabled":true},"heading_2":{"enabled":true},"heading_3":{"enabled":false},"enumerator":{"template":"2.6.%s"}},"content_includes_title":false,"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"exports":[{"format":"md","filename":"pivoting.md","url":"/fnc/build/pivoting-9b29b398c86a44460897d933e064aa96.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"As mentioned in ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"QmCeV83mlz"},{"type":"link","kind":"numref","identifier":"section-linsys-lu","label":"section-linsys-lu","url":"/lu","internal":true,"dataUrl":"/lu.json","children":[{"type":"text","value":"LU factorization","key":"ItlsUxgGZR"}],"key":"rzkYF0VLmj"},{"type":"text","value":", the ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"CgCmL8iPDK"},{"type":"inlineMath","value":"\\mathbf{A}=\\mathbf{L}\\mathbf{U}","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi><mo>=</mo><mi mathvariant=\"bold\">L</mi><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}=\\mathbf{L}\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">LU</span></span></span></span>","key":"MFLGoNsJX7"},{"type":"text","value":" factorization is not stable for every nonsingular ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"vhtBDd8wKQ"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"EuOA9is5sn"},{"type":"text","value":". Indeed, the factorization does not always even exist.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"zCR6Ue79CM"}],"indexEntries":[{"entry":"matrix factorization","subEntry":{"value":"LU","kind":"entry"},"emphasis":false}],"label":"index-BxL6RwZx3L","identifier":"index-bxl6rwzx3l","html_id":"index-bxl6rwzx3l","key":"DU5WmBse87"},{"type":"proof","kind":"example","enumerated":true,"children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Failure of naive LU factorization","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"ChlLvUv16E"}],"key":"ccO9KJfIqN"},{"type":"tabSet","children":[{"type":"tabItem","title":"Julia","sync":"julia","children":[{"type":"embed","source":{"url":"/chapter2","label":"demo-pivoting-fail-julia","kind":"Notebook","slug":"chapter2","location":"/julia/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-pivoting-fail","label":"demo-pivoting-fail","kind":"proof:example","position":{"start":{"line":825,"column":1},"end":{"line":825,"column":20}},"children":[{"type":"text","value":"Example ","key":"oBwXGT08eI"},{"type":"text","value":"2.6.1","key":"HwvPEVtG39"}],"template":"Example %s","enumerator":"2.6.1","resolved":true,"html_id":"demo-pivoting-fail","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"ORH1mzC4zi"}],"key":"U1QYduVZvg"},{"type":"paragraph","position":{"start":{"line":826,"column":1},"end":{"line":826,"column":1}},"children":[{"type":"text","value":"Here is a previously encountered matrix that factors well.","position":{"start":{"line":826,"column":1},"end":{"line":826,"column":1}},"key":"r9ffZH9sn8"}],"key":"QE1oQifxNM"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"A = [2 0 4 3 ; -4 5 -7 -10 ; 1 15 2 -4.5 ; -2 0 2 -13];\nL, U = FNC.lufact(A)\nL","key":"sJzfd6lL55"},{"type":"output","id":"WXzwre2ufmlzvr78U5sTH","data":[{"output_type":"execute_result","execution_count":78,"metadata":{},"data":{"text/plain":{"content":"4×4 LowerTriangular{Float64, Matrix{Float64}}:\n  1.0   ⋅     ⋅    ⋅ \n -2.0  1.0    ⋅    ⋅ \n  0.5  3.0   1.0   ⋅ \n -1.0  0.0  -2.0  1.0","content_type":"text/plain"}}}],"key":"wzdzOq7W38"}],"data":{},"key":"to6LedA6Io"},{"type":"paragraph","position":{"start":{"line":834,"column":1},"end":{"line":834,"column":1}},"children":[{"type":"text","value":"If we swap the second and fourth rows of ","position":{"start":{"line":834,"column":1},"end":{"line":834,"column":1}},"key":"BlZBpsVrYW"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":834,"column":1},"end":{"line":834,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"bKLgvEJs5n"},{"type":"text","value":", the result is still nonsingular. However, the factorization now fails.","position":{"start":{"line":834,"column":1},"end":{"line":834,"column":1}},"key":"yJboOQAO89"}],"key":"xn3ara6EW3"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"A[[2, 4], :] = A[[4, 2], :]  \nL, U = FNC.lufact(A)\nL","key":"CcDRT5uMX5"},{"type":"output","id":"Gs4JY-gRB7m9KAyfkNnll","data":[{"output_type":"execute_result","execution_count":79,"metadata":{},"data":{"text/plain":{"content":"4×4 LowerTriangular{Float64, Matrix{Float64}}:\n  1.0     ⋅      ⋅    ⋅ \n -1.0  NaN       ⋅    ⋅ \n  0.5   Inf   NaN     ⋅ \n -2.0   Inf   NaN    1.0","content_type":"text/plain"}}}],"key":"ArRQplrjLe"}],"data":{},"key":"QUU7gTdrdn"},{"type":"paragraph","position":{"start":{"line":845,"column":1},"end":{"line":845,"column":1}},"children":[{"type":"text","value":"The presence of ","position":{"start":{"line":845,"column":1},"end":{"line":845,"column":1}},"key":"xKWNjUpOXs"},{"type":"inlineCode","value":"NaN","position":{"start":{"line":845,"column":1},"end":{"line":845,"column":1}},"key":"pGlD33RWct"},{"type":"text","value":" in the result indicates that some impossible operation was required. The source of the problem is easy to locate. We can find the first outer product in the factorization just fine:","position":{"start":{"line":845,"column":1},"end":{"line":845,"column":1}},"key":"IL3zpcAylu"}],"indexEntries":[{"entry":"Julia","subEntry":{"value":"NaN","kind":"entry"},"emphasis":false}],"key":"J6JLpI5MH9"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"U[1, :] = A[1, :]\nL[:, 1] = A[:, 1] / U[1, 1]\nA -= L[:, 1] * U[1, :]'","key":"FP0b6FQwSF"},{"type":"output","id":"T7a_KYwae9l2cp9BQWpb7","data":[{"output_type":"execute_result","execution_count":80,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n 0.0   0.0  0.0    0.0\n 0.0   0.0  6.0  -10.0\n 0.0  15.0  0.0   -6.0\n 0.0   5.0  1.0   -4.0","content_type":"text/plain"}}}],"key":"CzgDAnb9zs"}],"data":{},"key":"CMHxmDRKWe"},{"type":"paragraph","position":{"start":{"line":853,"column":1},"end":{"line":853,"column":1}},"children":[{"type":"text","value":"The next step is ","position":{"start":{"line":853,"column":1},"end":{"line":853,"column":1}},"key":"cxsgXEvTng"},{"type":"inlineCode","value":"U[2, :] = A[2, :]","position":{"start":{"line":853,"column":1},"end":{"line":853,"column":1}},"key":"SxIZgF2zWC"},{"type":"text","value":", which is also OK. But then we are supposed to divide by ","position":{"start":{"line":853,"column":1},"end":{"line":853,"column":1}},"key":"BDKP0gTNhK"},{"type":"inlineCode","value":"U[2, 2]","position":{"start":{"line":853,"column":1},"end":{"line":853,"column":1}},"key":"a5ljY8ump0"},{"type":"text","value":", which is zero. The algorithm cannot continue.","position":{"start":{"line":853,"column":1},"end":{"line":853,"column":1}},"key":"ahuBzkul9h"}],"key":"wBrgORPT5G"}],"key":"Ddsm9uiumO"}],"key":"Gtg1M7IbUM"}],"key":"wGVeE67ccB"},{"type":"tabItem","title":"MATLAB","sync":"matlab","children":[{"type":"embed","source":{"url":"/chapter2-1","label":"demo-pivoting-fail-matlab","kind":"Notebook","slug":"chapter2-1","location":"/matlab/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-pivoting-fail","label":"demo-pivoting-fail","kind":"proof:example","position":{"start":{"line":764,"column":1},"end":{"line":764,"column":20}},"children":[{"type":"text","value":"Example ","key":"BW4Gc2rUFm"},{"type":"text","value":"2.6.1","key":"s8IPhltPie"}],"template":"Example %s","enumerator":"2.6.1","resolved":true,"html_id":"demo-pivoting-fail","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"AIfoKqpxGP"}],"key":"z8YpEGMVix"},{"type":"paragraph","position":{"start":{"line":765,"column":1},"end":{"line":765,"column":1}},"children":[{"type":"text","value":"Here is a previously encountered matrix that factors well.","position":{"start":{"line":765,"column":1},"end":{"line":765,"column":1}},"key":"LK8HVkoHSH"}],"key":"KmI8X0mrly"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A = [\n    2 0 4 3\n    -4 5 -7 -10\n    1 15 2 -4.5\n    -2 0 2 -13\n    ];\n[L, U] = lufact(A);\nL","key":"QDZb1q5tNn"},{"type":"output","id":"PwO8UiZWu5aYZeYzsZwJn","data":[{"output_type":"execute_result","execution_count":76,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>L = 4×4 double\n    1.0000         0         0         0\n   -2.0000    1.0000         0         0\n    0.5000    3.0000    1.0000         0\n   -1.0000         0   -2.0000    1.0000\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"L = 4×4 double\n    1.0000         0         0         0\n   -2.0000    1.0000         0         0\n    0.5000    3.0000    1.0000         0\n   -1.0000         0   -2.0000    1.0000\n","content_type":"text/plain"}}}],"key":"zUMWKpQkza"}],"data":{},"key":"SkXqhIWOJM"},{"type":"paragraph","position":{"start":{"line":778,"column":1},"end":{"line":778,"column":1}},"children":[{"type":"text","value":"If we swap the second and fourth rows of ","position":{"start":{"line":778,"column":1},"end":{"line":778,"column":1}},"key":"aSJIWQOSvP"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":778,"column":1},"end":{"line":778,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"qeKTO41u1H"},{"type":"text","value":", the result is still nonsingular. However, the factorization now fails.","position":{"start":{"line":778,"column":1},"end":{"line":778,"column":1}},"key":"EHVh0hlwuw"}],"key":"CWYhE9jaIc"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A([2, 4], :) = A([4, 2], :);    % swap rows 2 and 4\n[L, U] = lufact(A);\nL","key":"SxTkVz1xZq"},{"type":"output","id":"ZwOJZrtTUBewRMnTh3aK9","data":[{"output_type":"execute_result","execution_count":77,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>L = 4×4 double\n    1.0000         0         0         0\n   -1.0000       NaN         0         0\n    0.5000       Inf       NaN         0\n   -2.0000       Inf       NaN    1.0000\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"L = 4×4 double\n    1.0000         0         0         0\n   -1.0000       NaN         0         0\n    0.5000       Inf       NaN         0\n   -2.0000       Inf       NaN    1.0000\n","content_type":"text/plain"}}}],"key":"V5tr73Bjr4"}],"data":{},"key":"orOcRZKKeC"},{"type":"paragraph","position":{"start":{"line":789,"column":1},"end":{"line":789,"column":1}},"children":[{"type":"text","value":"The presence of ","position":{"start":{"line":789,"column":1},"end":{"line":789,"column":1}},"key":"vuvcjaAcmM"},{"type":"inlineCode","value":"NaN","position":{"start":{"line":789,"column":1},"end":{"line":789,"column":1}},"key":"koG7QRoxw4"},{"type":"text","value":" in the result indicates that some impossible operation was required. The source of the problem is easy to locate. We can find the first outer product in the factorization just fine:","position":{"start":{"line":789,"column":1},"end":{"line":789,"column":1}},"key":"MDcCYJrmjF"}],"indexEntries":[{"entry":"MATLAB","subEntry":{"value":"NaN","kind":"entry"},"emphasis":false}],"key":"rTaXf4as6Y"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"U(1, :) = A(1, :);\nL(:, 1) = A(:, 1) / U(1, 1)\nA = A - L(:, 1) * U(1, :)","key":"nOoEt9fn58"},{"type":"output","id":"sYdqB6Uazzbw3QaYLGulH","data":[{"output_type":"execute_result","execution_count":78,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>L = 4×4 double\n    1.0000         0         0         0\n   -1.0000       NaN         0         0\n    0.5000       Inf       NaN         0\n   -2.0000       Inf       NaN    1.0000\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"L = 4×4 double\n    1.0000         0         0         0\n   -1.0000       NaN         0         0\n    0.5000       Inf       NaN         0\n   -2.0000       Inf       NaN    1.0000\n","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":78,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>A = 4×4 double\n     0     0     0     0\n     0     0     6   -10\n     0    15     0    -6\n     0     5     1    -4\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"A = 4×4 double\n     0     0     0     0\n     0     0     6   -10\n     0    15     0    -6\n     0     5     1    -4\n","content_type":"text/plain"}}}],"key":"h6hrvALpxh"}],"data":{},"key":"uUypJmtxsO"},{"type":"paragraph","position":{"start":{"line":797,"column":1},"end":{"line":797,"column":1}},"children":[{"type":"text","value":"The next step is ","position":{"start":{"line":797,"column":1},"end":{"line":797,"column":1}},"key":"ZkSJer6wp9"},{"type":"inlineCode","value":"U(2, :) = A(2, :)","position":{"start":{"line":797,"column":1},"end":{"line":797,"column":1}},"key":"JZ0khUBhcu"},{"type":"text","value":", which is also OK. But then we are supposed to divide by ","position":{"start":{"line":797,"column":1},"end":{"line":797,"column":1}},"key":"dgB4hBj1FG"},{"type":"inlineCode","value":"U(2, 2)","position":{"start":{"line":797,"column":1},"end":{"line":797,"column":1}},"key":"yBPbijSYpW"},{"type":"text","value":", which is zero. The algorithm cannot continue.","position":{"start":{"line":797,"column":1},"end":{"line":797,"column":1}},"key":"XJrpn9oaVT"}],"key":"yEe5HnM7bj"}],"key":"nLHbYLd5st"}],"key":"pKknYv2QYz"}],"key":"yuaCJfNODv"},{"type":"tabItem","title":"Python","sync":"python","children":[{"type":"embed","source":{"url":"/chapter2-2","label":"demo-pivoting-fail-python","kind":"Notebook","slug":"chapter2-2","location":"/python/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-pivoting-fail","label":"demo-pivoting-fail","kind":"proof:example","position":{"start":{"line":736,"column":1},"end":{"line":736,"column":20}},"children":[{"type":"text","value":"Example ","key":"kCM5dRP4re"},{"type":"text","value":"2.6.1","key":"VHJNCgF10d"}],"template":"Example %s","enumerator":"2.6.1","resolved":true,"html_id":"demo-pivoting-fail","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"CfRJavs2vT"}],"key":"pDbvQhN7Sw"},{"type":"paragraph","position":{"start":{"line":737,"column":1},"end":{"line":737,"column":1}},"children":[{"type":"text","value":"Here is a previously encountered matrix that factors well.","position":{"start":{"line":737,"column":1},"end":{"line":737,"column":1}},"key":"T0KxwrB97w"}],"key":"LYd7E1lZZG"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"A = array([\n    [2, 0, 4, 3],\n    [-4, 5, -7, -10],\n    [1, 15, 2, -4.5],\n    [-2, 0, 2, -13]\n    ])\nL, U = FNC.lufact(A)\nprint(L)","key":"M2q6JwDi1a"},{"type":"output","id":"H9_JUWF2oKy_rp23KHgZg","data":[{"output_type":"stream","name":"stdout","text":"[[ 1.   0.  -0.   0. ]\n [-2.   1.  -0.   0. ]\n [ 0.5  3.   1.   0. ]\n [-1.   0.  -2.   1. ]]\n"}],"key":"bxMgzS5IRL"}],"data":{},"key":"SbUHsE7ZG6"},{"type":"paragraph","position":{"start":{"line":750,"column":1},"end":{"line":750,"column":1}},"children":[{"type":"text","value":"If we swap the second and fourth rows of ","position":{"start":{"line":750,"column":1},"end":{"line":750,"column":1}},"key":"cMRpo7nPUi"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":750,"column":1},"end":{"line":750,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"geW3SWRPFC"},{"type":"text","value":", the result is still nonsingular. However, the factorization now fails.","position":{"start":{"line":750,"column":1},"end":{"line":750,"column":1}},"key":"bXka1LwLHJ"}],"key":"AVErua0mav"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"A[[1, 3], :] = A[[3, 1], :]  \nL, U = FNC.lufact(A)\nprint(L)","key":"tpZA5JOn7N"},{"type":"output","id":"rqPtZoW1vBEFdoc2MYudp","data":[{"output_type":"stream","name":"stdout","text":"[[ 1.   nan  nan  0. ]\n [-1.   nan  nan  0. ]\n [ 0.5  inf  nan  0. ]\n [-2.   inf  nan  1. ]]\n"},{"output_type":"stream","name":"stderr","text":"/Users/driscoll/Dropbox/Mac/Documents/GitHub/fnc/python/fncbook/fncbook/chapter02.py:47: RuntimeWarning: divide by zero encountered in divide\n  L[:, k] = A_k[:, k] / U[k,k]\n/Users/driscoll/Dropbox/Mac/Documents/GitHub/fnc/python/fncbook/fncbook/chapter02.py:47: RuntimeWarning: invalid value encountered in divide\n  L[:, k] = A_k[:, k] / U[k,k]\n/Users/driscoll/mambaforge/envs/myst/lib/python3.13/site-packages/numpy/_core/numeric.py:983: RuntimeWarning: invalid value encountered in multiply\n  return multiply(a.ravel()[:, newaxis], b.ravel()[newaxis, :], out)\n"}],"key":"LIP0tNp2uM"}],"data":{},"key":"Fieq0gFNTq"},{"type":"paragraph","position":{"start":{"line":761,"column":1},"end":{"line":761,"column":1}},"children":[{"type":"text","value":"The presence of ","position":{"start":{"line":761,"column":1},"end":{"line":761,"column":1}},"key":"PxTyjncNVv"},{"type":"inlineCode","value":"NaN","position":{"start":{"line":761,"column":1},"end":{"line":761,"column":1}},"key":"NhEMNji8F7"},{"type":"text","value":" in the result indicates that some impossible operation was required. The source of the problem is easy to locate. We can find the first outer product in the factorization just fine:","position":{"start":{"line":761,"column":1},"end":{"line":761,"column":1}},"key":"ZAN5i0KBLS"}],"indexEntries":[{"entry":"Python","subEntry":{"value":"NaN","kind":"entry"},"emphasis":false}],"key":"PLD0sOzJcR"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"U[0, :] = A[0, :]\nL[:, 0] = A[:, 0] / U[0, 0]\nA -= outer(L[:, 0],  U[0, :])\nprint(A)","key":"I2t4Sd2UYl"},{"type":"output","id":"n2xV6TSekYi9LJ1P32_ZS","data":[{"output_type":"stream","name":"stdout","text":"[[  0.   0.   0.   0.]\n [  0.   0.   6. -10.]\n [  0.  15.   0.  -6.]\n [  0.   5.   1.  -4.]]\n"}],"key":"zXQzwVoHI8"}],"data":{},"key":"WJKYTm4NT2"},{"type":"paragraph","position":{"start":{"line":770,"column":1},"end":{"line":770,"column":1}},"children":[{"type":"text","value":"The next step is ","position":{"start":{"line":770,"column":1},"end":{"line":770,"column":1}},"key":"ku4BxyJzZp"},{"type":"inlineCode","value":"U[1, :] = A[1, :]","position":{"start":{"line":770,"column":1},"end":{"line":770,"column":1}},"key":"T6lTTVVoI1"},{"type":"text","value":", which is also OK. But then we are supposed to divide by ","position":{"start":{"line":770,"column":1},"end":{"line":770,"column":1}},"key":"hgIxLPKt3Q"},{"type":"inlineCode","value":"U[1, 1]","position":{"start":{"line":770,"column":1},"end":{"line":770,"column":1}},"key":"hrfHlczLBq"},{"type":"text","value":", which is zero. The algorithm cannot continue.","position":{"start":{"line":770,"column":1},"end":{"line":770,"column":1}},"key":"luIOStplgZ"}],"key":"eeSN3muWfT"}],"key":"VwenhwrkTX"}],"key":"WR0lKnGkrI"}],"key":"wTUJTCjzQX"}],"key":"BDsI3oYUQq"}],"label":"demo-pivoting-fail","identifier":"demo-pivoting-fail","html_id":"demo-pivoting-fail","enumerator":"2.6.1","key":"HL7npJCw83"},{"type":"paragraph","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"children":[{"type":"text","value":"In ","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"KrLxute8BV"},{"type":"link","kind":"numref","identifier":"section-linsys-lu","label":"section-linsys-lu","url":"/lu","internal":true,"dataUrl":"/lu.json","children":[{"type":"text","value":"LU factorization","key":"ptxqmLfYSv"}],"key":"mmcV0MU2EC"},{"type":"text","value":" we remarked that LU factorization is equivalent to Gaussian elimination with no row swaps. However, those swaps are necessary in situations like those encountered in ","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"vEu2SQs1RP"},{"type":"crossReference","kind":"proof:example","identifier":"demo-pivoting-fail","label":"demo-pivoting-fail","children":[{"type":"text","value":"Demo ","key":"HTeXNsq4Hg"},{"type":"text","value":"2.6.1","key":"bA55zUKfmq"}],"template":"Example %s","enumerator":"2.6.1","resolved":true,"html_id":"demo-pivoting-fail","key":"J1nyNjyq4V"},{"type":"text","value":", in order to avoid division by zero. We will find a modification of the outer product procedure that allows us to do the same thing.","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"tgOED03UOh"}],"key":"CRYDl7KcEa"},{"type":"heading","depth":2,"position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"children":[{"type":"text","value":"Choosing a pivot","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"key":"JiZNYKMH0n"}],"identifier":"choosing-a-pivot","label":"Choosing a pivot","html_id":"choosing-a-pivot","implicit":true,"enumerator":"2.6.1","key":"HZspgNb6qo"},{"type":"paragraph","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"children":[{"type":"text","value":"The diagonal element of ","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"UZpcv5uEhh"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"Wx6sFaHVug"},{"type":"text","value":" that appears in the denominator of line 17 of ","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"tc9xSlwtLP"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-lufact","label":"function-lufact","children":[{"type":"text","value":"Function ","key":"XLUQc8FfET"},{"type":"text","value":"2.4.1","key":"fNS35c7sEr"}],"template":"Algorithm %s","enumerator":"2.4.1","resolved":true,"html_id":"function-lufact","remote":true,"url":"/lu","dataUrl":"/lu.json","key":"qNlBqCIfJ2"},{"type":"text","value":" is called the ","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"LpBWkPBmKI"},{"type":"strong","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"children":[{"type":"text","value":"pivot element","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"X2zTtxRk1E"}],"key":"KN51gcZ3mR"},{"type":"text","value":" of its column. In order to avoid a zero pivot, we will use the largest available element in the column we are working on as the pivot. This technique is known as ","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"WDxH8SqpAj"},{"type":"strong","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"children":[{"type":"text","value":"row pivoting","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"ZXPNkkgCMW"}],"key":"B4XnIvr4Ic"},{"type":"text","value":".","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"l0gJfI4b7E"}],"indexEntries":[{"entry":"pivoting","emphasis":true}],"label":"index-NKVAY5nI4z","identifier":"index-nkvay5ni4z","html_id":"index-nkvay5ni4z","key":"lJcR0mSQNW"},{"type":"proof","kind":"algorithm","enumerated":true,"children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Row pivoting","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"key":"BXWsqqt4UJ"}],"key":"CouAt2RMhr"},{"type":"paragraph","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"children":[{"type":"text","value":"When performing elimination in column ","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"key":"IxYuVuLFIT"},{"type":"inlineMath","value":"j","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>j</mi></mrow><annotation encoding=\"application/x-tex\">j</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span></span></span></span>","key":"LlV611rOdY"},{"type":"text","value":", choose as the pivot the element in column ","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"key":"eMaF50xkaX"},{"type":"inlineMath","value":"j","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>j</mi></mrow><annotation encoding=\"application/x-tex\">j</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span></span></span></span>","key":"BGz46AG9iT"},{"type":"text","value":" that is largest in absolute value. (In case of ties, choose the lowest row index.)","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"key":"ZfuR0sCgyc"}],"key":"juFMJNaVrF"}],"label":"rule-pivoting","identifier":"rule-pivoting","html_id":"rule-pivoting","enumerator":"2.6.1","key":"knnM1yuvzO"},{"type":"proof","kind":"example","enumerated":true,"children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Row pivoting in LU factorization","position":{"start":{"line":51,"column":1},"end":{"line":51,"column":1}},"key":"jrK590I6sC"}],"key":"qRv93TKZZ2"},{"type":"tabSet","children":[{"type":"tabItem","title":"Julia","sync":"julia","children":[{"type":"embed","source":{"url":"/chapter2","label":"demo-pivoting-fix-julia","kind":"Notebook","slug":"chapter2","location":"/julia/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-pivoting-fix","label":"demo-pivoting-fix","kind":"proof:example","position":{"start":{"line":857,"column":1},"end":{"line":857,"column":19}},"children":[{"type":"text","value":"Example ","key":"trsPZ3vf1I"},{"type":"text","value":"2.6.2","key":"vEsqsOR1xg"}],"template":"Example %s","enumerator":"2.6.2","resolved":true,"html_id":"demo-pivoting-fix","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"zt1PKTFmAM"}],"key":"RsbQmD4TB4"},{"type":"paragraph","position":{"start":{"line":858,"column":1},"end":{"line":858,"column":1}},"children":[{"type":"text","value":"Here is the trouble-making matrix from ","position":{"start":{"line":858,"column":1},"end":{"line":858,"column":1}},"key":"TQiKwC9uxI"},{"type":"crossReference","kind":"proof:example","identifier":"demo-pivoting-fail","label":"demo-pivoting-fail","children":[{"type":"text","value":"Demo ","key":"dtygXsI5Rv"},{"type":"text","value":"2.6.1","key":"sRQXy0mqv5"}],"template":"Example %s","enumerator":"2.6.1","resolved":true,"html_id":"demo-pivoting-fail","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"vxOSpWUSwc"},{"type":"text","value":".","position":{"start":{"line":858,"column":1},"end":{"line":858,"column":1}},"key":"muagLJqzAK"}],"key":"s5ZI06KM4O"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"A₁ = [2 0 4 3 ; -2 0 2 -13; 1 15 2 -4.5 ; -4 5 -7 -10]","key":"Q1f9xttUvi"},{"type":"output","id":"wR7KZemUs6W39aaOAFKdq","data":[{"output_type":"execute_result","execution_count":81,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n  2.0   0.0   4.0    3.0\n -2.0   0.0   2.0  -13.0\n  1.0  15.0   2.0   -4.5\n -4.0   5.0  -7.0  -10.0","content_type":"text/plain"}}}],"key":"qK2V2Auwim"}],"data":{},"key":"QwAQPv7kF6"},{"type":"paragraph","position":{"start":{"line":864,"column":1},"end":{"line":864,"column":1}},"children":[{"type":"text","value":"We now find the largest candidate pivot in the first column. We don’t care about sign, so we take absolute values before finding the max.","position":{"start":{"line":864,"column":1},"end":{"line":864,"column":1}},"key":"wnP5ykkZj5"}],"key":"hHXjbygPK2"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"IQFIMatFtB"}],"key":"VRl2UNHGJB"},{"type":"paragraph","position":{"start":{"line":867,"column":1},"end":{"line":867,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":867,"column":1},"end":{"line":867,"column":1}},"key":"YntD51Bmsy"},{"type":"inlineCode","value":"argmax","position":{"start":{"line":867,"column":1},"end":{"line":867,"column":1}},"key":"RWi5mLVaav"},{"type":"text","value":" function returns the location of the largest element of a vector or matrix.","position":{"start":{"line":867,"column":1},"end":{"line":867,"column":1}},"key":"BXs09snr3k"}],"key":"RVzZWupc0X"}],"class":"dropdown","key":"NLMRWJjnwk"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"i = argmax( abs.(A₁[:, 1]) )","key":"eBErIZQvSD"},{"type":"output","id":"gMYhHEDo1ijApWTa0XHtc","data":[{"output_type":"execute_result","execution_count":82,"metadata":{},"data":{"text/plain":{"content":"4","content_type":"text/plain"}}}],"key":"jEM0jjAE0O"}],"data":{},"key":"x0Sibs3rFO"},{"type":"paragraph","position":{"start":{"line":875,"column":1},"end":{"line":875,"column":1}},"children":[{"type":"text","value":"This is the row of the matrix that we extract to put into ","position":{"start":{"line":875,"column":1},"end":{"line":875,"column":1}},"key":"jISD9i7pLb"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":875,"column":1},"end":{"line":875,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"haet7vr9DN"},{"type":"text","value":". That guarantees that the division used to find ","position":{"start":{"line":875,"column":1},"end":{"line":875,"column":1}},"key":"EtapyrI4s4"},{"type":"inlineMath","value":"\\boldsymbol{\\ell}_1","position":{"start":{"line":875,"column":1},"end":{"line":875,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">ℓ</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\boldsymbol{\\ell}_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">ℓ</span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"i3HCwlfHhy"},{"type":"text","value":" will be valid.","position":{"start":{"line":875,"column":1},"end":{"line":875,"column":1}},"key":"SLWR64iECo"}],"key":"wLrjUWpkmk"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"L, U = zeros(4,4),zeros(4,4)\nU[1, :] = A₁[i, :]\nL[:, 1] = A₁[:, 1] / U[1, 1]\nA₂ = A₁ - L[:, 1] * U[1, :]'","key":"WG9g64S6Bn"},{"type":"output","id":"6v34DVkHXDlYgCmtvBQy1","data":[{"output_type":"execute_result","execution_count":83,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n 0.0   2.5   0.5   -2.0\n 0.0  -2.5   5.5   -8.0\n 0.0  16.25  0.25  -7.0\n 0.0   0.0   0.0    0.0","content_type":"text/plain"}}}],"key":"BtwZw0obAv"}],"data":{},"key":"Qa1Q7C8TbC"},{"type":"paragraph","position":{"start":{"line":884,"column":1},"end":{"line":884,"column":1}},"children":[{"type":"text","value":"Observe that ","position":{"start":{"line":884,"column":1},"end":{"line":884,"column":1}},"key":"Nutu7CB237"},{"type":"inlineMath","value":"\\mathbf{A}_2","position":{"start":{"line":884,"column":1},"end":{"line":884,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">A</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8361em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"C3uRI36j0j"},{"type":"text","value":" has a new zero row and zero column, but the zero row is the fourth rather than the first. However, we forge on by using the largest possible pivot in column 2 for the next outer product.","position":{"start":{"line":884,"column":1},"end":{"line":884,"column":1}},"key":"e7Cjw1KGCK"}],"key":"vT2HrorTaT"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"@show i = argmax( abs.(A₂[:, 2]) ) \nU[2, :] = A₂[i, :]\nL[:, 2] = A₂[:, 2] / U[2, 2]\nA₃ = A₂ - L[:, 2] * U[2, :]'","key":"dSrkGJMX8h"},{"type":"output","id":"WEu-4Fhc7eWNjZe8q4IXk","data":[{"output_type":"stream","name":"stdout","text":"i = argmax(abs.(A₂[:, 2])) = 3\n"},{"output_type":"execute_result","execution_count":84,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n 0.0  0.0  0.461538  -0.923077\n 0.0  0.0  5.53846   -9.07692\n 0.0  0.0  0.0        0.0\n 0.0  0.0  0.0        0.0","content_type":"text/plain"}}}],"key":"tnxNKbQXHA"}],"data":{},"key":"FwOg4QdDfH"},{"type":"paragraph","position":{"start":{"line":893,"column":1},"end":{"line":893,"column":1}},"children":[{"type":"text","value":"Now we have zeroed out the third row as well as the second column. We can finish out the procedure.","position":{"start":{"line":893,"column":1},"end":{"line":893,"column":1}},"key":"M1zeMSti3b"}],"key":"Lyr2WVKnh8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"@show i = argmax( abs.(A₃[:, 3]) ) \nU[3, :] = A₃[i, :]\nL[:, 3] = A₃[:, 3] / U[3, 3]\nA₄ = A₃ - L[:, 3] * U[3, :]'","key":"Gz9MXz9DFH"},{"type":"output","id":"SsKJrqgpHzLUqIyvU8Z9x","data":[{"output_type":"stream","name":"stdout","text":"i = argmax(abs.(A₃[:, 3])) = 2\n"},{"output_type":"execute_result","execution_count":85,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n 0.0  0.0  0.0  -0.166667\n 0.0  0.0  0.0   0.0\n 0.0  0.0  0.0   0.0\n 0.0  0.0  0.0   0.0","content_type":"text/plain"}}}],"key":"BlDQQlX8sc"}],"data":{},"key":"olaSGVws57"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"@show i = argmax( abs.(A₄[:, 4]) ) \nU[4, :] = A₄[i, :]\nL[:, 4] = A₄[:, 4] / U[4, 4];","key":"XS4XjqFSu4"},{"type":"output","id":"grexWQClSYKawlj28U1Xz","data":[{"output_type":"stream","name":"stdout","text":"i = argmax(abs.(A₄[:, 4])) = 1\n"}],"key":"u6joNinhti"}],"data":{},"key":"x8tL4RTuve"},{"type":"paragraph","position":{"start":{"line":908,"column":1},"end":{"line":908,"column":1}},"children":[{"type":"text","value":"We do have a factorization of the original matrix:","position":{"start":{"line":908,"column":1},"end":{"line":908,"column":1}},"key":"GxVbBXy4On"}],"key":"PHoTLo4vMI"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"A₁ - L * U","key":"ckTH9RrJrb"},{"type":"output","id":"jziDfkyRXtnuRmeL5pyf2","data":[{"output_type":"execute_result","execution_count":87,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n 0.0  -1.38778e-16  0.0  0.0\n 0.0   1.38778e-16  0.0  0.0\n 0.0   0.0          0.0  0.0\n 0.0   0.0          0.0  0.0","content_type":"text/plain"}}}],"key":"aWxk0s28ab"}],"data":{},"key":"Bmh1ASybNh"},{"type":"paragraph","position":{"start":{"line":914,"column":1},"end":{"line":914,"column":1}},"children":[{"type":"text","value":"And ","position":{"start":{"line":914,"column":1},"end":{"line":914,"column":1}},"key":"ZFAWHHMXQN"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":914,"column":1},"end":{"line":914,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"UAAoQuglqH"},{"type":"text","value":" has the required structure:","position":{"start":{"line":914,"column":1},"end":{"line":914,"column":1}},"key":"uhhBJ4cXkQ"}],"key":"LNsWnve1I7"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"U","key":"QN07JFliAJ"},{"type":"output","id":"TvKO5v454-NSIVKBQYRns","data":[{"output_type":"execute_result","execution_count":88,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n -4.0   5.0   -7.0      -10.0\n  0.0  16.25   0.25      -7.0\n  0.0   0.0    5.53846   -9.07692\n  0.0   0.0    0.0       -0.166667","content_type":"text/plain"}}}],"key":"dxOKfOqLSg"}],"data":{},"key":"BHFheeuS0g"},{"type":"paragraph","position":{"start":{"line":920,"column":1},"end":{"line":920,"column":1}},"children":[{"type":"text","value":"However, the triangularity of ","position":{"start":{"line":920,"column":1},"end":{"line":920,"column":1}},"key":"l7m5a8Tbdy"},{"type":"inlineMath","value":"\\mathbf{L}","position":{"start":{"line":920,"column":1},"end":{"line":920,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">L</span></span></span></span>","key":"w3VWZeqD3w"},{"type":"text","value":" has been broken.","position":{"start":{"line":920,"column":1},"end":{"line":920,"column":1}},"key":"KWETnuxX9C"}],"key":"NhQ9FIbPpR"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"L","key":"pj5sQKDghj"},{"type":"output","id":"zn01lPDfv_1EJgmLz0ltk","data":[{"output_type":"execute_result","execution_count":89,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n -0.5    0.153846  0.0833333   1.0\n  0.5   -0.153846  1.0        -0.0\n -0.25   1.0       0.0        -0.0\n  1.0    0.0       0.0        -0.0","content_type":"text/plain"}}}],"key":"i7FN4qL70w"}],"data":{},"key":"bfc7BGcy1O"}],"key":"Ws8BOS1PRy"}],"key":"suEaFdZZFd"}],"key":"gAPgGfQ4Kb"},{"type":"tabItem","title":"MATLAB","sync":"matlab","children":[{"type":"embed","source":{"url":"/chapter2-1","label":"demo-pivoting-fix-matlab","kind":"Notebook","slug":"chapter2-1","location":"/matlab/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-pivoting-fix","label":"demo-pivoting-fix","kind":"proof:example","position":{"start":{"line":801,"column":1},"end":{"line":801,"column":19}},"children":[{"type":"text","value":"Example ","key":"xAcx4FA4Rg"},{"type":"text","value":"2.6.2","key":"YoIOAnL6BH"}],"template":"Example %s","enumerator":"2.6.2","resolved":true,"html_id":"demo-pivoting-fix","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"IIrYVNANTk"}],"key":"yOIzlGVjcR"},{"type":"paragraph","position":{"start":{"line":802,"column":1},"end":{"line":802,"column":1}},"children":[{"type":"text","value":"Here is the trouble-making matrix from ","position":{"start":{"line":802,"column":1},"end":{"line":802,"column":1}},"key":"RQn3kITCbB"},{"type":"crossReference","kind":"proof:example","identifier":"demo-pivoting-fail","label":"demo-pivoting-fail","children":[{"type":"text","value":"Demo ","key":"Hsx79eu7fv"},{"type":"text","value":"2.6.1","key":"ujZROqSpwy"}],"template":"Example %s","enumerator":"2.6.1","resolved":true,"html_id":"demo-pivoting-fail","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"ScVivef7Mt"},{"type":"text","value":".","position":{"start":{"line":802,"column":1},"end":{"line":802,"column":1}},"key":"lapV8E4zke"}],"key":"QKW2FAgK1N"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A_1 = [2 0 4 3; -2 0 2 -13; 1 15 2 -4.5; -4 5 -7 -10]","key":"KIio12yYH2"},{"type":"output","id":"0yf9v2XCvGljQAO3PiMEv","data":[{"output_type":"execute_result","execution_count":79,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>A_1 = 4×4 double\n    2.0000         0    4.0000    3.0000\n   -2.0000         0    2.0000  -13.0000\n    1.0000   15.0000    2.0000   -4.5000\n   -4.0000    5.0000   -7.0000  -10.0000\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"A_1 = 4×4 double\n    2.0000         0    4.0000    3.0000\n   -2.0000         0    2.0000  -13.0000\n    1.0000   15.0000    2.0000   -4.5000\n   -4.0000    5.0000   -7.0000  -10.0000\n","content_type":"text/plain"}}}],"key":"PM9iX80QqE"}],"data":{},"key":"CxB1MNF3dI"},{"type":"paragraph","position":{"start":{"line":811,"column":1},"end":{"line":811,"column":1}},"children":[{"type":"text","value":"We now find the largest candidate pivot in the first column. We don’t care about sign, so we take absolute values before finding the max.","position":{"start":{"line":811,"column":1},"end":{"line":811,"column":1}},"key":"IgqlNCEXkU"}],"indexEntries":[{"entry":"MATLAB","subEntry":{"value":"max","kind":"entry"},"emphasis":true},{"entry":"MATLAB","subEntry":{"value":"\\~","kind":"entry"},"emphasis":true}],"key":"Ft28iwZPUH"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"ST4KmD95WQ"}],"key":"OqAUarh4QL"},{"type":"paragraph","position":{"start":{"line":814,"column":1},"end":{"line":814,"column":1}},"children":[{"type":"text","value":"The second output of ","position":{"start":{"line":814,"column":1},"end":{"line":814,"column":1}},"key":"uP9etYggsJ"},{"type":"inlineCode","value":"max","position":{"start":{"line":814,"column":1},"end":{"line":814,"column":1}},"key":"c21e4w1u7K"},{"type":"text","value":" returns the location of the largest element of a vector. The ","position":{"start":{"line":814,"column":1},"end":{"line":814,"column":1}},"key":"tMKbvJPfDy"},{"type":"inlineCode","value":"~","position":{"start":{"line":814,"column":1},"end":{"line":814,"column":1}},"key":"SaHr80SQBY"},{"type":"text","value":" symbol is used to ignore the value of the first output.","position":{"start":{"line":814,"column":1},"end":{"line":814,"column":1}},"key":"PE8NH4eFx3"}],"key":"Fqn6jQl5MA"}],"class":"dropdown","key":"wK0KJeCm8i"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[~, i] = max( abs(A_1(:, 1)) )","key":"n7PAT8NxSR"},{"type":"output","id":"ARHgAaA1-XoYckiUvfKud","data":[{"output_type":"execute_result","execution_count":80,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>i = 4</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"i = 4","content_type":"text/plain"}}}],"key":"vNGVYZ0Dmc"}],"data":{},"key":"gBF51n8mLX"},{"type":"paragraph","position":{"start":{"line":822,"column":1},"end":{"line":822,"column":1}},"children":[{"type":"text","value":"This is the row of the matrix that we extract to put into ","position":{"start":{"line":822,"column":1},"end":{"line":822,"column":1}},"key":"jhsfq9byC7"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":822,"column":1},"end":{"line":822,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"e8J7RnTSm4"},{"type":"text","value":". That guarantees that the division used to find ","position":{"start":{"line":822,"column":1},"end":{"line":822,"column":1}},"key":"gIt6DzSkib"},{"type":"inlineMath","value":"\\boldsymbol{\\ell}_1","position":{"start":{"line":822,"column":1},"end":{"line":822,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">ℓ</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\boldsymbol{\\ell}_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">ℓ</span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"ytoypD7QbI"},{"type":"text","value":" will be valid.","position":{"start":{"line":822,"column":1},"end":{"line":822,"column":1}},"key":"XOmqyLw955"}],"key":"OF5ziNodfF"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"L = zeros(4, 4);\nU = zeros(4, 4);\nU(1, :) = A_1(i, :);\nL(:, 1) = A_1(:, 1) / U(1, 1);\nA_2 = A_1 - L(:, 1) * U(1, :)","key":"LbzIRhsCWt"},{"type":"output","id":"8HRDYQzBFXDMJKCWxjWU_","data":[{"output_type":"execute_result","execution_count":81,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>A_2 = 4×4 double\n         0    2.5000    0.5000   -2.0000\n         0   -2.5000    5.5000   -8.0000\n         0   16.2500    0.2500   -7.0000\n         0         0         0         0\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"A_2 = 4×4 double\n         0    2.5000    0.5000   -2.0000\n         0   -2.5000    5.5000   -8.0000\n         0   16.2500    0.2500   -7.0000\n         0         0         0         0\n","content_type":"text/plain"}}}],"key":"fMJ7iWLtrO"}],"data":{},"key":"OLhXeLvnN0"},{"type":"paragraph","position":{"start":{"line":832,"column":1},"end":{"line":832,"column":1}},"children":[{"type":"text","value":"Observe that ","position":{"start":{"line":832,"column":1},"end":{"line":832,"column":1}},"key":"ZeHTzSzOYN"},{"type":"inlineMath","value":"\\mathbf{A}_2","position":{"start":{"line":832,"column":1},"end":{"line":832,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">A</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8361em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"eJW9CMDN1H"},{"type":"text","value":" has a new zero row and zero column, but the zero row is the fourth rather than the first. However, we forge on by using the largest possible pivot in column 2 for the next outer product.","position":{"start":{"line":832,"column":1},"end":{"line":832,"column":1}},"key":"WvHVCyzhId"}],"key":"RMPAPreNaX"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[~, i] = max( abs(A_2(:, 2)) )\nU(2, :) = A_2(i, :);\nL(:, 2) = A_2(:, 2) / U(2, 2);\nA_3 = A_2 - L(:, 2) * U(2, :)","key":"yKZv4cFUFd"},{"type":"output","id":"37MiXejQPRUH61nK1Moo3","data":[{"output_type":"execute_result","execution_count":82,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>i = 3</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"i = 3","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":82,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>A_3 = 4×4 double\n         0         0    0.4615   -0.9231\n         0         0    5.5385   -9.0769\n         0         0         0         0\n         0         0         0         0\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"A_3 = 4×4 double\n         0         0    0.4615   -0.9231\n         0         0    5.5385   -9.0769\n         0         0         0         0\n         0         0         0         0\n","content_type":"text/plain"}}}],"key":"t41vGLNvUU"}],"data":{},"key":"Rew92jDX2f"},{"type":"paragraph","position":{"start":{"line":841,"column":1},"end":{"line":841,"column":1}},"children":[{"type":"text","value":"Now we have zeroed out the third row as well as the second column. We can finish out the procedure.","position":{"start":{"line":841,"column":1},"end":{"line":841,"column":1}},"key":"U8japB2006"}],"key":"FVixp0EJBq"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[~, i] = max( abs(A_3(:, 3)) ) \nU(3, :) = A_3(i, :);\nL(:, 3) = A_3(:, 3) / U(3, 3);\nA_4 = A_3 - L(:, 3) * U(3, :)","key":"zl9HSHIvir"},{"type":"output","id":"nvPwtLB6L49g1kG2Y7Zf4","data":[{"output_type":"execute_result","execution_count":83,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>i = 2</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"i = 2","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":83,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>A_4 = 4×4 double\n         0         0         0   -0.1667\n         0         0         0         0\n         0         0         0         0\n         0         0         0         0\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"A_4 = 4×4 double\n         0         0         0   -0.1667\n         0         0         0         0\n         0         0         0         0\n         0         0         0         0\n","content_type":"text/plain"}}}],"key":"O8J6LeBL4M"}],"data":{},"key":"mBsc34LhVv"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[~, i] = max( abs(A_4(:, 4)) ) \nU(4, :) = A_4(i, :);\nL(:, 4) = A_4(:, 4) / U(4, 4);","key":"grKvm0kHcB"},{"type":"output","id":"Vw_nFwyaj5022CUGVDMw3","data":[{"output_type":"execute_result","execution_count":84,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>i = 1</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"i = 1","content_type":"text/plain"}}}],"key":"Dj6VSc4Aqs"}],"data":{},"key":"zlr3cg58wf"},{"type":"paragraph","position":{"start":{"line":856,"column":1},"end":{"line":856,"column":1}},"children":[{"type":"text","value":"We do have a factorization of the original matrix:","position":{"start":{"line":856,"column":1},"end":{"line":856,"column":1}},"key":"H5d8CctCtz"}],"key":"ljG2ZvY9JX"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A_1 - L * U","key":"JLHQ6fTKEC"},{"type":"output","id":"gRH-PTs3COyNu0c2ME688","data":[{"output_type":"execute_result","execution_count":85,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = 4×4 double\n     0     0     0     0\n     0     0     0     0\n     0     0     0     0\n     0     0     0     0\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = 4×4 double\n     0     0     0     0\n     0     0     0     0\n     0     0     0     0\n     0     0     0     0\n","content_type":"text/plain"}}}],"key":"SSRvtotOti"}],"data":{},"key":"RyFKNFFKf7"},{"type":"paragraph","position":{"start":{"line":862,"column":1},"end":{"line":862,"column":1}},"children":[{"type":"text","value":"And ","position":{"start":{"line":862,"column":1},"end":{"line":862,"column":1}},"key":"hv6u0Hjhbp"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":862,"column":1},"end":{"line":862,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"CbI4exY3yq"},{"type":"text","value":" has the required structure:","position":{"start":{"line":862,"column":1},"end":{"line":862,"column":1}},"key":"jQABH2bCsz"}],"key":"ILP9M9qxRf"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"U","key":"ijSSWMTa7j"},{"type":"output","id":"aZ6GxAmKZOrgtGnNoUX4f","data":[{"output_type":"execute_result","execution_count":86,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>U = 4×4 double\n   -4.0000    5.0000   -7.0000  -10.0000\n         0   16.2500    0.2500   -7.0000\n         0         0    5.5385   -9.0769\n         0         0         0   -0.1667\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"U = 4×4 double\n   -4.0000    5.0000   -7.0000  -10.0000\n         0   16.2500    0.2500   -7.0000\n         0         0    5.5385   -9.0769\n         0         0         0   -0.1667\n","content_type":"text/plain"}}}],"key":"Fu8Pt3Tq9X"}],"data":{},"key":"gApeKnR0xv"},{"type":"paragraph","position":{"start":{"line":868,"column":1},"end":{"line":868,"column":1}},"children":[{"type":"text","value":"However, the triangularity of ","position":{"start":{"line":868,"column":1},"end":{"line":868,"column":1}},"key":"IF9Qm5WBIA"},{"type":"inlineMath","value":"\\mathbf{L}","position":{"start":{"line":868,"column":1},"end":{"line":868,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">L</span></span></span></span>","key":"cUuqK8W0cv"},{"type":"text","value":" has been broken.","position":{"start":{"line":868,"column":1},"end":{"line":868,"column":1}},"key":"d4hOEu6s3v"}],"key":"FGmex6IMsE"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"L","key":"KkfaqqTM3L"},{"type":"output","id":"hn1g_3SBT9YdbA-W7Yu58","data":[{"output_type":"execute_result","execution_count":87,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>L = 4×4 double\n   -0.5000    0.1538    0.0833    1.0000\n    0.5000   -0.1538    1.0000         0\n   -0.2500    1.0000         0         0\n    1.0000         0         0         0\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"L = 4×4 double\n   -0.5000    0.1538    0.0833    1.0000\n    0.5000   -0.1538    1.0000         0\n   -0.2500    1.0000         0         0\n    1.0000         0         0         0\n","content_type":"text/plain"}}}],"key":"HVK2OrlOq8"}],"data":{},"key":"RHdXUPa1A3"}],"key":"Ue4pvwuYIG"}],"key":"K70hJFYVtt"}],"key":"S28DQuKB17"},{"type":"tabItem","title":"Python","sync":"python","children":[{"type":"embed","source":{"url":"/chapter2-2","label":"demo-pivoting-fix-python","kind":"Notebook","slug":"chapter2-2","location":"/python/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-pivoting-fix","label":"demo-pivoting-fix","kind":"proof:example","position":{"start":{"line":774,"column":1},"end":{"line":774,"column":19}},"children":[{"type":"text","value":"Example ","key":"XGJ9cgaOQP"},{"type":"text","value":"2.6.2","key":"IHH7M53PiZ"}],"template":"Example %s","enumerator":"2.6.2","resolved":true,"html_id":"demo-pivoting-fix","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"AAciDn8jB3"}],"key":"J641c9l2Yh"},{"type":"paragraph","position":{"start":{"line":775,"column":1},"end":{"line":775,"column":1}},"children":[{"type":"text","value":"Here is the trouble-making matrix from ","position":{"start":{"line":775,"column":1},"end":{"line":775,"column":1}},"key":"V3cNfcRwGW"},{"type":"crossReference","kind":"proof:example","identifier":"demo-pivoting-fail","label":"demo-pivoting-fail","children":[{"type":"text","value":"Demo ","key":"W77XiIVzu7"},{"type":"text","value":"2.6.1","key":"BTjTOKuEqL"}],"template":"Example %s","enumerator":"2.6.1","resolved":true,"html_id":"demo-pivoting-fail","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"LcMLlRXk5H"},{"type":"text","value":".","position":{"start":{"line":775,"column":1},"end":{"line":775,"column":1}},"key":"OTFC5KErDP"}],"key":"kPpNaNwqVX"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"A_1 = array([\n    [2, 0, 4, 3],\n    [-2, 0, 2, -13],\n    [1, 15, 2, -4.5],\n    [-4, 5, -7, -10]\n    ])","key":"sY1H5fvAFi"},{"type":"output","id":"njHy6C0j7WJ7Gcz8JPUv7","data":[],"key":"kmrk2TRXEH"}],"data":{},"key":"ZYt5fxTd5u"},{"type":"paragraph","position":{"start":{"line":786,"column":1},"end":{"line":786,"column":1}},"children":[{"type":"text","value":"We now find the largest candidate pivot in the first column. We don’t care about sign, so we take absolute values before finding the max.","position":{"start":{"line":786,"column":1},"end":{"line":786,"column":1}},"key":"PbSQBBWplr"}],"key":"XdqlRSRf9y"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"SR6Pzfxw1i"}],"key":"c6Uwch3iem"},{"type":"paragraph","position":{"start":{"line":789,"column":1},"end":{"line":789,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":789,"column":1},"end":{"line":789,"column":1}},"key":"qSeznqP65y"},{"type":"inlineCode","value":"argmax","position":{"start":{"line":789,"column":1},"end":{"line":789,"column":1}},"key":"WyneebgRwo"},{"type":"text","value":" function returns the location of the largest element of a vector or matrix.","position":{"start":{"line":789,"column":1},"end":{"line":789,"column":1}},"key":"Sc20L6bGRb"}],"key":"drf53tuCho"}],"class":"dropdown","key":"PkQ9Gu8ayR"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"i = argmax( abs(A_1[:, 0]) )\nprint(i)","key":"gU8cKnsaxT"},{"type":"output","id":"2lRElBVrWNHlqBJfFUB30","data":[{"output_type":"stream","name":"stdout","text":"3\n"}],"key":"XCKEWOrywJ"}],"data":{},"key":"PhcuSGinlL"},{"type":"paragraph","position":{"start":{"line":798,"column":1},"end":{"line":798,"column":1}},"children":[{"type":"text","value":"This is the row of the matrix that we extract to put into ","position":{"start":{"line":798,"column":1},"end":{"line":798,"column":1}},"key":"jCYCjBOdwX"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":798,"column":1},"end":{"line":798,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"yhLJrw2DZZ"},{"type":"text","value":". That guarantees that the division used to find ","position":{"start":{"line":798,"column":1},"end":{"line":798,"column":1}},"key":"brVcMq0Dbh"},{"type":"inlineMath","value":"\\boldsymbol{\\ell}_1","position":{"start":{"line":798,"column":1},"end":{"line":798,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">ℓ</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\boldsymbol{\\ell}_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">ℓ</span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"ObFY9fSw5m"},{"type":"text","value":" will be valid.","position":{"start":{"line":798,"column":1},"end":{"line":798,"column":1}},"key":"gGgIBzrRhI"}],"key":"RzUMfq0t23"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"L, U = eye(4), zeros((4, 4))\nU[0, :] = A_1[i, :]\nL[:, 0] = A_1[:, 0] / U[0, 0]\nA_2 = A_1 - outer(L[:, 0], U[0, :])\nprint(A_2)","key":"aaYcgGUXEM"},{"type":"output","id":"RWtqpK34btsXelWT2EuL7","data":[{"output_type":"stream","name":"stdout","text":"[[ 0.    2.5   0.5  -2.  ]\n [ 0.   -2.5   5.5  -8.  ]\n [ 0.   16.25  0.25 -7.  ]\n [ 0.    0.    0.    0.  ]]\n"}],"key":"NeIc5S9ORB"}],"data":{},"key":"AqBjNBAqtn"},{"type":"paragraph","position":{"start":{"line":808,"column":1},"end":{"line":808,"column":1}},"children":[{"type":"text","value":"Observe that ","position":{"start":{"line":808,"column":1},"end":{"line":808,"column":1}},"key":"IsOmJaQBBs"},{"type":"inlineMath","value":"\\mathbf{A}_2","position":{"start":{"line":808,"column":1},"end":{"line":808,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">A</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8361em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"UTOswLYisA"},{"type":"text","value":" has a new zero row and zero column, but the zero row is the fourth rather than the first. However, we forge on by using the largest possible pivot in column 2 for the next outer product.","position":{"start":{"line":808,"column":1},"end":{"line":808,"column":1}},"key":"j8ahzZX6fN"}],"key":"u8HY4BzXvR"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"i = argmax( abs(A_2[:, 1]) ) \nprint(f\"new pivot row is {i}\")\nU[1, :] = A_2[i, :]\nL[:, 1] = A_2[:, 1] / U[1, 1]\nA_3 = A_2 - outer(L[:, 1], U[1, :])\nprint(A_3)","key":"x6Gamzq9qS"},{"type":"output","id":"pm4Wi6Qd2GYq7bHLa5Khs","data":[{"output_type":"stream","name":"stdout","text":"new pivot row is 2\n[[ 0.          0.          0.46153846 -0.92307692]\n [ 0.          0.          5.53846154 -9.07692308]\n [ 0.          0.          0.          0.        ]\n [ 0.          0.          0.          0.        ]]\n"}],"key":"dq1nB6TtdS"}],"data":{},"key":"tmU1ULNFJ9"},{"type":"paragraph","position":{"start":{"line":818,"column":1},"end":{"line":818,"column":1}},"children":[{"type":"text","value":"Now we have zeroed out the third row as well as the second column. We can finish out the procedure.","position":{"start":{"line":818,"column":1},"end":{"line":818,"column":1}},"key":"GgqOGQmeWD"}],"key":"P2ks2hAgio"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"i = argmax( abs(A_3[:, 2]) ) \nprint(f\"new pivot row is {i}\")\nU[2, :] = A_3[i, :]\nL[:, 2] = A_3[:, 2] / U[2, 2]\nA_4 = A_3 - outer(L[:, 2], U[2, :])\nprint(A_4)","key":"BS6SVs1Slv"},{"type":"output","id":"0zsBPCvmzL6CyQD8WMPap","data":[{"output_type":"stream","name":"stdout","text":"new pivot row is 1\n[[ 0.          0.          0.         -0.16666667]\n [ 0.          0.          0.          0.        ]\n [ 0.          0.          0.          0.        ]\n [ 0.          0.          0.          0.        ]]\n"}],"key":"Zrl6bXCIDW"}],"data":{},"key":"TV8UYcYrp2"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"i = argmax( abs(A_4[:, 3]) ) \nprint(f\"new pivot row is {i}\")\nU[3, :] = A_4[i, :]\nL[:, 3] = A_4[:, 3] / U[3, 3];","key":"kwnYWX4sJV"},{"type":"output","id":"Ho_zruVSNxkZdn-bEb7yR","data":[{"output_type":"stream","name":"stdout","text":"new pivot row is 0\n"}],"key":"yxYEt3m0DE"}],"data":{},"key":"ZWaRQ0fXRp"},{"type":"paragraph","position":{"start":{"line":836,"column":1},"end":{"line":836,"column":1}},"children":[{"type":"text","value":"We do have a factorization of the original matrix:","position":{"start":{"line":836,"column":1},"end":{"line":836,"column":1}},"key":"koh6RrZVhz"}],"key":"Bvyc3O1awe"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"A_1 - L @ U","key":"vYEplYHGcU"},{"type":"output","id":"SWL4d-AaLQFpSax-kDP6l","data":[{"output_type":"execute_result","execution_count":84,"metadata":{},"data":{"text/plain":{"content":"array([[0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00],\n       [0.00000000e+00, 0.00000000e+00, 2.22044605e-16, 0.00000000e+00],\n       [0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00],\n       [0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00]])","content_type":"text/plain"}}}],"key":"oij7eQyqdm"}],"data":{},"key":"GuQ0ILCyC9"},{"type":"paragraph","position":{"start":{"line":842,"column":1},"end":{"line":842,"column":1}},"children":[{"type":"text","value":"And ","position":{"start":{"line":842,"column":1},"end":{"line":842,"column":1}},"key":"zUm018TqkK"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":842,"column":1},"end":{"line":842,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"mSELZl8VIE"},{"type":"text","value":" has the required structure:","position":{"start":{"line":842,"column":1},"end":{"line":842,"column":1}},"key":"LSf8lpnuYr"}],"key":"JzSwrIW8v3"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(U)","key":"X4X9mIMKOH"},{"type":"output","id":"eLKI5B7kgaPrHxofIZMlY","data":[{"output_type":"stream","name":"stdout","text":"[[ -4.           5.          -7.         -10.        ]\n [  0.          16.25         0.25        -7.        ]\n [  0.           0.           5.53846154  -9.07692308]\n [  0.           0.           0.          -0.16666667]]\n"}],"key":"IYwGHDlQKu"}],"data":{},"key":"jr9inhWu2z"},{"type":"paragraph","position":{"start":{"line":848,"column":1},"end":{"line":848,"column":1}},"children":[{"type":"text","value":"However, the triangularity of ","position":{"start":{"line":848,"column":1},"end":{"line":848,"column":1}},"key":"VP6E4zkq2N"},{"type":"inlineMath","value":"\\mathbf{L}","position":{"start":{"line":848,"column":1},"end":{"line":848,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">L</span></span></span></span>","key":"WF0vKMdDVd"},{"type":"text","value":" has been broken.","position":{"start":{"line":848,"column":1},"end":{"line":848,"column":1}},"key":"zd76C3dEfb"}],"key":"Y30xo9aEEs"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(L)","key":"qqjo0PYTBU"},{"type":"output","id":"bk4u1G9dXEBWLqrl9zD76","data":[{"output_type":"stream","name":"stdout","text":"[[-0.5         0.15384615  0.08333333  1.        ]\n [ 0.5        -0.15384615  1.         -0.        ]\n [-0.25        1.          0.         -0.        ]\n [ 1.          0.          0.         -0.        ]]\n"}],"key":"RfsVYGpvlu"}],"data":{},"key":"zbjeQrjOkB"}],"key":"EsVjiuwAow"}],"key":"zf7xzllxLN"}],"key":"gWdZzUfhQv"}],"key":"xMILNaT4ck"}],"label":"demo-pivoting-fix","identifier":"demo-pivoting-fix","html_id":"demo-pivoting-fix","enumerator":"2.6.2","key":"sEy96DLH0X"},{"type":"paragraph","position":{"start":{"line":73,"column":1},"end":{"line":73,"column":1}},"children":[{"type":"text","value":"We will return to the loss of triangularity in ","position":{"start":{"line":73,"column":1},"end":{"line":73,"column":1}},"key":"PejZ7auOqr"},{"type":"inlineMath","value":"\\mathbf{L}","position":{"start":{"line":73,"column":1},"end":{"line":73,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">L</span></span></span></span>","key":"wPVJZPLnmj"},{"type":"text","value":" momentarily. First, though, there is a question left to answer: what if at some stage, all the elements of the targeted column are zero, i.e., there are no available pivots? Fortunately that loose end ties up nicely, although a proof is a bit beyond our scope here.","position":{"start":{"line":73,"column":1},"end":{"line":73,"column":1}},"key":"yb3RXijM0n"}],"key":"mw9WWDJC1J"},{"type":"proof","kind":"theorem","enumerated":true,"children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Row pivoting","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"key":"WLDCffk0Rc"}],"key":"eLc7b9U6Xc"},{"type":"paragraph","position":{"start":{"line":77,"column":1},"end":{"line":77,"column":1}},"children":[{"type":"text","value":"The row-pivoted LU factorization runs to completion if and only if the original matrix is invertible.","position":{"start":{"line":77,"column":1},"end":{"line":77,"column":1}},"key":"zLQB85wvOU"}],"key":"gX6oxyyM2w"}],"label":"theorem-pivot","identifier":"theorem-pivot","html_id":"theorem-pivot","enumerator":"2.6.1","key":"Bya0hlNms3"},{"type":"paragraph","position":{"start":{"line":80,"column":1},"end":{"line":80,"column":1}},"children":[{"type":"text","value":"A linear system with a singular matrix has either no solution or infinitely many solutions. Either way, a technique other than LU factorization is needed to handle it.","position":{"start":{"line":80,"column":1},"end":{"line":80,"column":1}},"key":"GfcWcQlchv"}],"key":"cupxt1WzcW"},{"type":"heading","depth":2,"position":{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},"children":[{"type":"text","value":"Permutations","position":{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},"key":"DzRzNlbME9"}],"identifier":"permutations","label":"Permutations","html_id":"permutations","implicit":true,"enumerator":"2.6.2","key":"RbqvRix6Ik"},{"type":"paragraph","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"children":[{"type":"text","value":"Even though the resulting ","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"key":"pTB7Lj3pak"},{"type":"inlineMath","value":"\\mathbf{L}","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">L</span></span></span></span>","key":"FsQma3M0bL"},{"type":"text","value":" in ","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"key":"aPUhQxwLRX"},{"type":"crossReference","kind":"proof:example","identifier":"demo-pivoting-fix","label":"demo-pivoting-fix","children":[{"type":"text","value":"Demo ","key":"hIVZGdLaxq"},{"type":"text","value":"2.6.2","key":"Zfs2XMt1RZ"}],"template":"Example %s","enumerator":"2.6.2","resolved":true,"html_id":"demo-pivoting-fix","key":"PtUTlxuIMF"},{"type":"text","value":" is no longer of unit lower triangular form, it is close. In fact, all that is needed is to reverse the order of its rows.","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"key":"uqggqmM2TZ"}],"key":"MXPnc6duIV"},{"type":"proof","kind":"example","enumerated":true,"children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Pivoting as row permutation","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"oQlI1uQoTk"}],"key":"xWMIj5Qt8k"},{"type":"tabSet","children":[{"type":"tabItem","title":"Julia","sync":"julia","children":[{"type":"embed","source":{"url":"/chapter2","label":"demo-pivoting-permute-julia","kind":"Notebook","slug":"chapter2","location":"/julia/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-pivoting-permute","label":"demo-pivoting-permute","kind":"proof:example","position":{"start":{"line":928,"column":1},"end":{"line":928,"column":23}},"children":[{"type":"text","value":"Example ","key":"wN7gYxv2AX"},{"type":"text","value":"2.6.3","key":"AOrJ6y1sts"}],"template":"Example %s","enumerator":"2.6.3","resolved":true,"html_id":"demo-pivoting-permute","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"UD7Q7LCo5s"}],"key":"lxTA6cpazW"},{"type":"paragraph","position":{"start":{"line":929,"column":1},"end":{"line":929,"column":1}},"children":[{"type":"text","value":"Here again is the matrix from ","position":{"start":{"line":929,"column":1},"end":{"line":929,"column":1}},"key":"ZJjIyUvIed"},{"type":"crossReference","kind":"proof:example","identifier":"demo-pivoting-fix","label":"demo-pivoting-fix","children":[{"type":"text","value":"Demo ","key":"axDHqWfHVS"},{"type":"text","value":"2.6.2","key":"W504koaZPN"}],"template":"Example %s","enumerator":"2.6.2","resolved":true,"html_id":"demo-pivoting-fix","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"PEurDI1yMz"},{"type":"text","value":".","position":{"start":{"line":929,"column":1},"end":{"line":929,"column":1}},"key":"JgNBZSzwKb"}],"key":"zTQjMmgi6v"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"A = [2 0 4 3 ; -2 0 2 -13; 1 15 2 -4.5 ; -4 5 -7 -10]","key":"DxwkXHhUKM"},{"type":"output","id":"CzFJQ9WM9K3sKtgFVCm6o","data":[{"output_type":"execute_result","execution_count":90,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n  2.0   0.0   4.0    3.0\n -2.0   0.0   2.0  -13.0\n  1.0  15.0   2.0   -4.5\n -4.0   5.0  -7.0  -10.0","content_type":"text/plain"}}}],"key":"Q9VDGMa6sw"}],"data":{},"key":"bFigpehzEl"},{"type":"paragraph","position":{"start":{"line":935,"column":1},"end":{"line":935,"column":1}},"children":[{"type":"text","value":"As the factorization proceeded, the pivots were selected from rows 4, 3, 2, and finally 1. If we were to put the rows of ","position":{"start":{"line":935,"column":1},"end":{"line":935,"column":1}},"key":"RSPI16mlg3"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":935,"column":1},"end":{"line":935,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"zFya86MqRj"},{"type":"text","value":" into that order, then the algorithm would run exactly like the plain LU factorization from ","position":{"start":{"line":935,"column":1},"end":{"line":935,"column":1}},"key":"h62eep1gmh"},{"type":"link","kind":"numref","url":"/lu","internal":true,"dataUrl":"/lu.json","children":[{"type":"text","value":"LU factorization","key":"Te44NMZnmf"}],"key":"r8YZQ4qtrb"},{"type":"text","value":".","position":{"start":{"line":935,"column":1},"end":{"line":935,"column":1}},"key":"jpNRxG7RBn"}],"key":"bgQE3yDGKT"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"B = A[[4, 3, 2, 1], :]\nL, U = FNC.lufact(B);","key":"gpvoZ5wpOg"},{"type":"output","id":"AXzCoTR5kA1w0jS4silh4","data":[],"key":"dEwg1XE1A0"}],"data":{},"key":"CPnWhsbEAO"},{"type":"paragraph","position":{"start":{"line":942,"column":1},"end":{"line":942,"column":1}},"children":[{"type":"text","value":"We obtain the same ","position":{"start":{"line":942,"column":1},"end":{"line":942,"column":1}},"key":"h3XVXyW2eQ"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":942,"column":1},"end":{"line":942,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"xqr8U4FGmG"},{"type":"text","value":" as before:","position":{"start":{"line":942,"column":1},"end":{"line":942,"column":1}},"key":"JhzfRsWkgj"}],"key":"M2sx4qVquM"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"U","key":"rZVTuAJURJ"},{"type":"output","id":"ysMCLvMPTyC6HCe4xeuhV","data":[{"output_type":"execute_result","execution_count":92,"metadata":{},"data":{"text/plain":{"content":"4×4 UpperTriangular{Float64, Matrix{Float64}}:\n -4.0   5.0   -7.0      -10.0\n   ⋅   16.25   0.25      -7.0\n   ⋅     ⋅     5.53846   -9.07692\n   ⋅     ⋅      ⋅        -0.166667","content_type":"text/plain"}}}],"key":"nKca7zPSqq"}],"data":{},"key":"UuhVOyKD6O"},{"type":"paragraph","position":{"start":{"line":948,"column":1},"end":{"line":948,"column":1}},"children":[{"type":"text","value":"And ","position":{"start":{"line":948,"column":1},"end":{"line":948,"column":1}},"key":"tE4kiymCnm"},{"type":"inlineMath","value":"\\mathbf{L}","position":{"start":{"line":948,"column":1},"end":{"line":948,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">L</span></span></span></span>","key":"P1K2MYzWsA"},{"type":"text","value":" has the same rows as before, but arranged into triangular order:","position":{"start":{"line":948,"column":1},"end":{"line":948,"column":1}},"key":"gNfqyXAus5"}],"key":"wpatVDLJwg"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"L","key":"Ay7J868i4S"},{"type":"output","id":"YvjiExe0Q_y3so6xAMali","data":[{"output_type":"execute_result","execution_count":93,"metadata":{},"data":{"text/plain":{"content":"4×4 LowerTriangular{Float64, Matrix{Float64}}:\n  1.0     ⋅         ⋅          ⋅ \n -0.25   1.0        ⋅          ⋅ \n  0.5   -0.153846  1.0         ⋅ \n -0.5    0.153846  0.0833333  1.0","content_type":"text/plain"}}}],"key":"UvVEX3Ym7X"}],"data":{},"key":"llLZy08YJ6"}],"key":"dPQjTXfIvf"}],"key":"ya8DMTGJNJ"}],"key":"rbhjiyyWdp"},{"type":"tabItem","title":"MATLAB","sync":"matlab","children":[{"type":"embed","source":{"url":"/chapter2-1","label":"demo-pivoting-permute-matlab","kind":"Notebook","slug":"chapter2-1","location":"/matlab/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-pivoting-permute","label":"demo-pivoting-permute","kind":"proof:example","position":{"start":{"line":876,"column":1},"end":{"line":876,"column":23}},"children":[{"type":"text","value":"Example ","key":"NshZnwLBSx"},{"type":"text","value":"2.6.3","key":"mBrckQLguU"}],"template":"Example %s","enumerator":"2.6.3","resolved":true,"html_id":"demo-pivoting-permute","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"zZRYhADQm1"}],"key":"aYYEOpGB5n"},{"type":"paragraph","position":{"start":{"line":877,"column":1},"end":{"line":877,"column":1}},"children":[{"type":"text","value":"Here again is the matrix from ","position":{"start":{"line":877,"column":1},"end":{"line":877,"column":1}},"key":"es6oyIDQW3"},{"type":"crossReference","kind":"proof:example","identifier":"demo-pivoting-fix","label":"demo-pivoting-fix","children":[{"type":"text","value":"Demo ","key":"SQd5h8oEH3"},{"type":"text","value":"2.6.2","key":"W2B87oyjS9"}],"template":"Example %s","enumerator":"2.6.2","resolved":true,"html_id":"demo-pivoting-fix","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"CrwZMDB2Rz"},{"type":"text","value":".","position":{"start":{"line":877,"column":1},"end":{"line":877,"column":1}},"key":"KKfexXfOiu"}],"key":"dx17oHUezg"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A = [2 0 4 3; -2 0 2 -13; 1 15 2 -4.5; -4 5 -7 -10]","key":"w1KHmpXmzx"},{"type":"output","id":"r2vG13lCwf6Rv5c0vFEgl","data":[{"output_type":"execute_result","execution_count":88,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>A = 4×4 double\n    2.0000         0    4.0000    3.0000\n   -2.0000         0    2.0000  -13.0000\n    1.0000   15.0000    2.0000   -4.5000\n   -4.0000    5.0000   -7.0000  -10.0000\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"A = 4×4 double\n    2.0000         0    4.0000    3.0000\n   -2.0000         0    2.0000  -13.0000\n    1.0000   15.0000    2.0000   -4.5000\n   -4.0000    5.0000   -7.0000  -10.0000\n","content_type":"text/plain"}}}],"key":"v3JRL8kFSN"}],"data":{},"key":"knT9fQOPkO"},{"type":"paragraph","position":{"start":{"line":883,"column":1},"end":{"line":883,"column":1}},"children":[{"type":"text","value":"As the factorization proceeded, the pivots were selected from rows 4, 3, 2, and finally 1. If we were to put the rows of ","position":{"start":{"line":883,"column":1},"end":{"line":883,"column":1}},"key":"I34irQGSMS"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":883,"column":1},"end":{"line":883,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"H5zlc8oK0y"},{"type":"text","value":" into that order, then the algorithm would run exactly like the plain LU factorization from ","position":{"start":{"line":883,"column":1},"end":{"line":883,"column":1}},"key":"D1wNGHcBYJ"},{"type":"link","kind":"numref","url":"/lu","internal":true,"dataUrl":"/lu.json","children":[{"type":"text","value":"LU factorization","key":"GOJ2rdvlFF"}],"key":"TUQ7JSZyB1"},{"type":"text","value":".","position":{"start":{"line":883,"column":1},"end":{"line":883,"column":1}},"key":"uPcoZ2TDf2"}],"key":"DqpcOmvkvp"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"B = A([4, 3, 2, 1], :);\n[L, U] = lufact(B);","key":"nNjTFRf7LS"},{"type":"output","id":"A04AMEIZJp5gILXj-Q5hX","data":[],"key":"KUJqDGlREG"}],"data":{},"key":"k4GRwSaq4p"},{"type":"paragraph","position":{"start":{"line":890,"column":1},"end":{"line":890,"column":1}},"children":[{"type":"text","value":"We obtain the same ","position":{"start":{"line":890,"column":1},"end":{"line":890,"column":1}},"key":"JfJEQ0vt6T"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":890,"column":1},"end":{"line":890,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"So2eBZ3z4d"},{"type":"text","value":" as before:","position":{"start":{"line":890,"column":1},"end":{"line":890,"column":1}},"key":"wSGGmMRHp3"}],"key":"OfOeow1sm0"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"U","key":"wXuboZbiX5"},{"type":"output","id":"h3keyIit2XSItcT0-OyFo","data":[{"output_type":"execute_result","execution_count":90,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>U = 4×4 double\n   -4.0000    5.0000   -7.0000  -10.0000\n         0   16.2500    0.2500   -7.0000\n         0         0    5.5385   -9.0769\n         0         0         0   -0.1667\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"U = 4×4 double\n   -4.0000    5.0000   -7.0000  -10.0000\n         0   16.2500    0.2500   -7.0000\n         0         0    5.5385   -9.0769\n         0         0         0   -0.1667\n","content_type":"text/plain"}}}],"key":"jwBRkYsmiN"}],"data":{},"key":"BuQ149SwsU"},{"type":"paragraph","position":{"start":{"line":896,"column":1},"end":{"line":896,"column":1}},"children":[{"type":"text","value":"And ","position":{"start":{"line":896,"column":1},"end":{"line":896,"column":1}},"key":"goVBvjaKbi"},{"type":"inlineMath","value":"\\mathbf{L}","position":{"start":{"line":896,"column":1},"end":{"line":896,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">L</span></span></span></span>","key":"Oy974ufZgA"},{"type":"text","value":" has the same rows as before, but arranged into triangular order:","position":{"start":{"line":896,"column":1},"end":{"line":896,"column":1}},"key":"nJhTnmTJuD"}],"key":"d0zCvaWVfd"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"L","key":"bchBLHNzqU"},{"type":"output","id":"0SKt62tpkrOgFyww29HSG","data":[{"output_type":"execute_result","execution_count":91,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>L = 4×4 double\n    1.0000         0         0         0\n   -0.2500    1.0000         0         0\n    0.5000   -0.1538    1.0000         0\n   -0.5000    0.1538    0.0833    1.0000\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"L = 4×4 double\n    1.0000         0         0         0\n   -0.2500    1.0000         0         0\n    0.5000   -0.1538    1.0000         0\n   -0.5000    0.1538    0.0833    1.0000\n","content_type":"text/plain"}}}],"key":"kZkpJJ1o1c"}],"data":{},"key":"ceejtOlDQX"}],"key":"ZDzbv6ONC6"}],"key":"YvdYPv0zWJ"}],"key":"TTeW3sB71c"},{"type":"tabItem","title":"Python","sync":"python","children":[{"type":"embed","source":{"url":"/chapter2-2","label":"demo-pivoting-permute-python","kind":"Notebook","slug":"chapter2-2","location":"/python/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-pivoting-permute","label":"demo-pivoting-permute","kind":"proof:example","position":{"start":{"line":857,"column":1},"end":{"line":857,"column":23}},"children":[{"type":"text","value":"Example ","key":"DHYNQSzF4k"},{"type":"text","value":"2.6.3","key":"BznWrCWyZn"}],"template":"Example %s","enumerator":"2.6.3","resolved":true,"html_id":"demo-pivoting-permute","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"vREOUldMji"}],"key":"ihQgg4zsYj"},{"type":"paragraph","position":{"start":{"line":858,"column":1},"end":{"line":858,"column":1}},"children":[{"type":"text","value":"Here again is the matrix from ","position":{"start":{"line":858,"column":1},"end":{"line":858,"column":1}},"key":"QSLmDsD7Ud"},{"type":"crossReference","kind":"proof:example","identifier":"demo-pivoting-fix","label":"demo-pivoting-fix","children":[{"type":"text","value":"Demo ","key":"HDtVZvgvqp"},{"type":"text","value":"2.6.2","key":"h1MEC4HxQa"}],"template":"Example %s","enumerator":"2.6.2","resolved":true,"html_id":"demo-pivoting-fix","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"EUA5am6GKJ"},{"type":"text","value":".","position":{"start":{"line":858,"column":1},"end":{"line":858,"column":1}},"key":"o6VoTNXHsp"}],"key":"xgrtH1EGsm"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"A = array([\n    [2, 0, 4, 3],\n    [-2, 0, 2, -13],\n    [1, 15, 2, -4.5],\n    [-4, 5, -7, -10]\n    ])","key":"NFFqrRapug"},{"type":"output","id":"D1Ve-cwTAQWYd-oQYusRx","data":[],"key":"UDHumIT4mv"}],"data":{},"key":"dwzgl5YieK"},{"type":"paragraph","position":{"start":{"line":869,"column":1},"end":{"line":869,"column":1}},"children":[{"type":"text","value":"As the factorization proceeded, the pivots were selected from rows 4, 3, 2, and finally 1 (with NumPy indices being one less). If we were to put the rows of ","position":{"start":{"line":869,"column":1},"end":{"line":869,"column":1}},"key":"MYLwXvw1Yq"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":869,"column":1},"end":{"line":869,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"aLA1TEZjUD"},{"type":"text","value":" into that order, then the algorithm would run exactly like the plain LU factorization from ","position":{"start":{"line":869,"column":1},"end":{"line":869,"column":1}},"key":"gVekSHxgLd"},{"type":"link","kind":"numref","url":"/lu","internal":true,"dataUrl":"/lu.json","children":[{"type":"text","value":"LU factorization","key":"JF04qNxyLF"}],"key":"uGVOVLO1Ui"},{"type":"text","value":".","position":{"start":{"line":869,"column":1},"end":{"line":869,"column":1}},"key":"ihp5EOsoP2"}],"key":"fbkEHEGWXk"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"B = A[[3, 2, 1, 0], :]\nL, U = FNC.lufact(B);","key":"g1NBFAFBNe"},{"type":"output","id":"mOgw5-Zvi7j2YHRpg7Rdn","data":[],"key":"egciDA16FE"}],"data":{},"key":"Gzex0R4yAj"},{"type":"paragraph","position":{"start":{"line":876,"column":1},"end":{"line":876,"column":1}},"children":[{"type":"text","value":"We obtain the same ","position":{"start":{"line":876,"column":1},"end":{"line":876,"column":1}},"key":"zSCEw37E1S"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":876,"column":1},"end":{"line":876,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"wF8508JBDQ"},{"type":"text","value":" as before:","position":{"start":{"line":876,"column":1},"end":{"line":876,"column":1}},"key":"HeJzbc1oOz"}],"key":"HlTCwT5zzZ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(U)","key":"mKTYKW4e61"},{"type":"output","id":"VBlPV7KoTiC446yf6fq93","data":[{"output_type":"stream","name":"stdout","text":"[[ -4.           5.          -7.         -10.        ]\n [  0.          16.25         0.25        -7.        ]\n [  0.           0.           5.53846154  -9.07692308]\n [  0.           0.           0.          -0.16666667]]\n"}],"key":"ljMM7WdZM9"}],"data":{},"key":"BRu44nr7PA"},{"type":"paragraph","position":{"start":{"line":882,"column":1},"end":{"line":882,"column":1}},"children":[{"type":"text","value":"And ","position":{"start":{"line":882,"column":1},"end":{"line":882,"column":1}},"key":"LcJZdKf400"},{"type":"inlineMath","value":"\\mathbf{L}","position":{"start":{"line":882,"column":1},"end":{"line":882,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">L</span></span></span></span>","key":"lmKkopV8ym"},{"type":"text","value":" has the same rows as before, but arranged into triangular order:","position":{"start":{"line":882,"column":1},"end":{"line":882,"column":1}},"key":"sujra69u3m"}],"key":"pedrkJZRln"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(L)","key":"hyjhfpeJVn"},{"type":"output","id":"kMuTghD-S6TpOuofkTg14","data":[{"output_type":"stream","name":"stdout","text":"[[ 1.          0.          0.          0.        ]\n [-0.25        1.          0.          0.        ]\n [ 0.5        -0.15384615  1.          0.        ]\n [-0.5         0.15384615  0.08333333  1.        ]]\n"}],"key":"Ck252Lx6Az"}],"data":{},"key":"qh8DSOYNtC"}],"key":"YaKkEc7Y8r"}],"key":"srAis91RaF"}],"key":"RnIbSuwGUd"}],"key":"hUqrF2Nodx"}],"label":"demo-pivoting-permute","identifier":"demo-pivoting-permute","html_id":"demo-pivoting-permute","enumerator":"2.6.3","key":"wwlff71Iuj"},{"type":"paragraph","position":{"start":{"line":110,"column":1},"end":{"line":110,"column":1}},"children":[{"type":"text","value":"In principle, if the permutation of rows implied by the pivot locations is applied all at once to the original ","position":{"start":{"line":110,"column":1},"end":{"line":110,"column":1}},"key":"UqdgWJEc6W"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":110,"column":1},"end":{"line":110,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"Bg26vtohnt"},{"type":"text","value":", no further pivoting is needed. In practice, this permutation cannot be determined immediately from the original ","position":{"start":{"line":110,"column":1},"end":{"line":110,"column":1}},"key":"D55mpWBkIJ"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":110,"column":1},"end":{"line":110,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"cfIckDWstM"},{"type":"text","value":"; the only way to find it is to run the algorithm. Having obtained it at the end, though, we can use it to state a simple relationship.","position":{"start":{"line":110,"column":1},"end":{"line":110,"column":1}},"key":"hUaJ7OwtRS"}],"key":"aINylmmS5s"},{"type":"proof","kind":"definition","enumerated":true,"children":[{"type":"admonitionTitle","children":[{"type":"text","value":"PLU factorization","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"key":"lnAwhhA7kk"}],"key":"kUJMyMySRo"},{"type":"paragraph","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"children":[{"type":"text","value":"Given ","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"key":"VqOWunYzSk"},{"type":"inlineMath","value":"n\\times n","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>×</mo><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n\\times n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"h7hcjS3cLk"},{"type":"text","value":" matrix ","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"key":"qOJNxlfLOz"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"yAjOPgX7gq"},{"type":"text","value":", the ","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"key":"g9dBDbJrgG"},{"type":"strong","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"children":[{"type":"text","value":"PLU factorization","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"key":"jfTdb5hld4"}],"key":"z7V9RU4at6"},{"type":"text","value":" is a unit lower triangular ","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"key":"oIWAbmyrBK"},{"type":"inlineMath","value":"\\mathbf{L}","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">L</span></span></span></span>","key":"iu4eJkVGeH"},{"type":"text","value":", an upper triangular ","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"key":"zGrh1foiic"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"Ao7o1yPsmX"},{"type":"text","value":", and a permutation ","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"key":"S1uHK8YdIw"},{"type":"inlineMath","value":"i_1,\\ldots,i_n","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>i</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><mo>…</mo><mo separator=\"true\">,</mo><msub><mi>i</mi><mi>n</mi></msub></mrow><annotation encoding=\"application/x-tex\">i_1,\\ldots,i_n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"GrVMNsk8RZ"},{"type":"text","value":" of the integers ","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"key":"EaaLEaK2oz"},{"type":"inlineMath","value":"1,\\ldots,n","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mo separator=\"true\">,</mo><mo>…</mo><mo separator=\"true\">,</mo><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">1,\\ldots,n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8389em;vertical-align:-0.1944em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"HHqQadHzOy"},{"type":"text","value":", such that","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"key":"j113aIP6E5"}],"key":"kfWq0W2UZB"},{"type":"math","value":"\\tilde{\\mathbf{A}} = \\mathbf{L}\\mathbf{U},","position":{"start":{"line":118,"column":1},"end":{"line":118,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mover accent=\"true\"><mi mathvariant=\"bold\">A</mi><mo>~</mo></mover><mo>=</mo><mi mathvariant=\"bold\">L</mi><mi mathvariant=\"bold\">U</mi><mo separator=\"true\">,</mo></mrow><annotation encoding=\"application/x-tex\">\\tilde{\\mathbf{A}} = \\mathbf{L}\\mathbf{U},</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.923em;\"></span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.923em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathbf\">A</span></span><span style=\"top:-3.6051em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.1111em;\"><span class=\"mord\">~</span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8805em;vertical-align:-0.1944em;\"></span><span class=\"mord mathbf\">LU</span><span class=\"mpunct\">,</span></span></span></span></span>","enumerator":"2.6.1","key":"SyFRoz9apA"},{"type":"paragraph","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"children":[{"type":"text","value":"where rows ","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"key":"eQPFTBjabo"},{"type":"inlineMath","value":"1,\\ldots,n","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mo separator=\"true\">,</mo><mo>…</mo><mo separator=\"true\">,</mo><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">1,\\ldots,n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8389em;vertical-align:-0.1944em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"t9zXc2BVtN"},{"type":"text","value":" of ","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"key":"OPL6Za1csn"},{"type":"inlineMath","value":"\\tilde{\\mathbf{A}}","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mover accent=\"true\"><mi mathvariant=\"bold\">A</mi><mo>~</mo></mover></mrow><annotation encoding=\"application/x-tex\">\\tilde{\\mathbf{A}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.923em;\"></span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.923em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathbf\">A</span></span><span style=\"top:-3.6051em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.1111em;\"><span class=\"mord\">~</span></span></span></span></span></span></span></span></span></span>","key":"iUpxavRXcQ"},{"type":"text","value":" are rows ","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"key":"a6SGRLAHfV"},{"type":"inlineMath","value":"i_1,\\ldots,i_n","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>i</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><mo>…</mo><mo separator=\"true\">,</mo><msub><mi>i</mi><mi>n</mi></msub></mrow><annotation encoding=\"application/x-tex\">i_1,\\ldots,i_n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"nEyvkt2cPB"},{"type":"text","value":" of ","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"key":"dZlXobsGki"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"iA6aUn4Tuk"},{"type":"text","value":".","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"key":"p3CA8NlHaB"}],"key":"IVnnqfurJg"}],"indexEntries":[{"entry":"matrix factorization","subEntry":{"value":"pivoted LU","kind":"entry"},"emphasis":true},{"entry":"PLU factorization","emphasis":true}],"label":"index-ZRHUfDN1Y1","identifier":"index-zrhufdn1y1","html_id":"index-zrhufdn1y1","enumerator":"2.6.1","key":"GXAcGc3tmY"},{"type":"paragraph","position":{"start":{"line":123,"column":1},"end":{"line":123,"column":1}},"children":[{"type":"crossReference","kind":"proof:algorithm","identifier":"function-plufact","label":"function-plufact","children":[{"type":"text","value":"Function ","key":"I9VMjGqjKC"},{"type":"text","value":"2.6.2","key":"bOjtbicLul"}],"template":"Algorithm %s","enumerator":"2.6.2","resolved":true,"html_id":"function-plufact","key":"jeSBRx9vFw"},{"type":"text","value":" shows our implementation of PLU factorization.","position":{"start":{"line":123,"column":1},"end":{"line":123,"column":1}},"key":"JE1PslV90T"},{"type":"footnoteReference","identifier":"plu","label":"PLU","position":{"start":{"line":123,"column":1},"end":{"line":123,"column":1}},"number":1,"enumerator":"1","key":"TNUPTyVTgh"}],"key":"OdvKBiJCQS"},{"type":"proof","kind":"algorithm","enumerated":true,"children":[{"type":"admonitionTitle","children":[{"type":"text","value":"plufact","position":{"start":{"line":128,"column":1},"end":{"line":128,"column":1}},"key":"Q8JQzLZkFa"}],"key":"wWPUnLLPNv"},{"type":"tabSet","children":[{"type":"tabItem","title":"Julia","sync":"julia","children":[{"type":"embed","source":{"url":"/chapter2","label":"function-plufact-julia","kind":"Notebook","slug":"chapter2","location":"/julia/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"LU factorization with partial pivoting","position":{"start":{"line":66,"column":1},"end":{"line":66,"column":1}},"key":"buagQ2ZPD1"}],"key":"Q6jgrQBSIZ"},{"type":"include","file":"FNCFunctions/src/chapter02.jl","literal":true,"filter":{"startAfter":"# begin plufact","endBefore":"# end plufact"},"children":[{"type":"code","value":"\"\"\"\n    plufact(A)\n\nCompute the PLU factorization of square matrix `A`, returning the\ntriangular factors and a row permutation vector.\n\"\"\"\nfunction plufact(A)\n    n = size(A, 1)\n    L = zeros(n, n)\n    U = zeros(n, n)\n    p = fill(0, n)\n    Aₖ = float(copy(A))\n\n    # Reduction by outer products\n    for k in 1:n\n        p[k] = argmax(abs.(Aₖ[:, k]))    # best pivot in column k\n        U[k, :] = Aₖ[p[k], :]\n        L[:, k] = Aₖ[:, k] / U[k, k]\n        if k < n    # no update needed on last iteration\n            Aₖ -= L[:, k] * U[k, :]'\n        end\n    end\n    return LowerTriangular(L[p, :]), U, p\nend","lang":"julia","showLineNumbers":true,"filename":"plufact.jl","key":"EfLMRvVTyy"}],"key":"Y9CWrI9Qhs"},{"type":"code","lang":"","value":"","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"key":"rHMMnJUeXa"}],"key":"OMvPejNtAU"}],"key":"n02dIAPTN6"}],"key":"R9DNuGmTb2"},{"type":"tabItem","title":"MATLAB","sync":"matlab","children":[{"type":"embed","source":{"url":"/chapter2","label":"function-plufact-julia","kind":"Notebook","slug":"chapter2","location":"/julia/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"LU factorization with partial pivoting","position":{"start":{"line":66,"column":1},"end":{"line":66,"column":1}},"key":"uPi8IrbZaA"}],"key":"VzvQwggEUT"},{"type":"include","file":"FNCFunctions/src/chapter02.jl","literal":true,"filter":{"startAfter":"# begin plufact","endBefore":"# end plufact"},"children":[{"type":"code","value":"\"\"\"\n    plufact(A)\n\nCompute the PLU factorization of square matrix `A`, returning the\ntriangular factors and a row permutation vector.\n\"\"\"\nfunction plufact(A)\n    n = size(A, 1)\n    L = zeros(n, n)\n    U = zeros(n, n)\n    p = fill(0, n)\n    Aₖ = float(copy(A))\n\n    # Reduction by outer products\n    for k in 1:n\n        p[k] = argmax(abs.(Aₖ[:, k]))    # best pivot in column k\n        U[k, :] = Aₖ[p[k], :]\n        L[:, k] = Aₖ[:, k] / U[k, k]\n        if k < n    # no update needed on last iteration\n            Aₖ -= L[:, k] * U[k, :]'\n        end\n    end\n    return LowerTriangular(L[p, :]), U, p\nend","lang":"julia","showLineNumbers":true,"filename":"plufact.jl","key":"gdQfoyky8n"}],"key":"piGurQo5gH"},{"type":"code","lang":"","value":"","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"key":"Cf3DCEXkKT"}],"key":"tB1PsaM6U4"}],"key":"AhFUp5T4iZ"}],"key":"IKeVlOXIRA"},{"type":"tabItem","title":"Python","sync":"python","children":[{"type":"embed","source":{"url":"/chapter2-2","label":"function-plufact-python","kind":"Notebook","slug":"chapter2-2","location":"/python/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"LU factorization with partial pivoting","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"key":"J7pW2Oyz2G"}],"key":"njoTNpvufI"},{"type":"include","file":"fncbook/fncbook/chapter02.py","literal":true,"filter":{"lines":[[52,72]]},"children":[{"type":"code","value":"def plufact(A):\n    \"\"\"\n        plufact(A)\n\n    Compute the PLU factorization of square matrix A, returning the\n    triangular factors and a row permutation vector.\n    \"\"\"\n    n = A.shape[0]\n    L = np.zeros((n, n))\n    U = np.zeros((n, n))\n    p = np.zeros(n, dtype=int)\n    A_k = np.copy(A)\n\n    # Reduction by np.outer products\n    for k in range(n):\n        p[k] = np.argmax(abs(A_k[:, k]))\n        U[k, :] = A_k[p[k], :]\n        L[:, k] = A_k[:, k] / U[k, k]\n        if k < n-1:\n            A_k -= np.outer(L[:, k], U[k, :])\n    return L[p, :], U, p","lang":"python","showLineNumbers":true,"filename":"plufact.py","key":"z2AphEdpM7"}],"key":"yp0Fqosamy"}],"key":"r3BkFzYX4I"}],"key":"CkjsVKqsuK"}],"key":"OqT9hPfyLN"}],"key":"YRKz2FBtUN"}],"label":"function-plufact","identifier":"function-plufact","html_id":"function-plufact","enumerator":"2.6.2","key":"h7p4uFL6Th"},{"type":"paragraph","position":{"start":{"line":151,"column":1},"end":{"line":151,"column":1}},"children":[{"type":"text","value":"Ideally, the PLU factorization takes ","position":{"start":{"line":151,"column":1},"end":{"line":151,"column":1}},"key":"X5XMd68NHA"},{"type":"inlineMath","value":"\\sim \\frac{2}{3}n^3","position":{"start":{"line":151,"column":1},"end":{"line":151,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>∼</mo><mfrac><mn>2</mn><mn>3</mn></mfrac><msup><mi>n</mi><mn>3</mn></msup></mrow><annotation encoding=\"application/x-tex\">\\sim \\frac{2}{3}n^3</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.3669em;\"></span><span class=\"mrel\">∼</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1901em;vertical-align:-0.345em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8451em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">3</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mord\"><span class=\"mord mathnormal\">n</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span></span></span></span></span></span></span></span>","key":"r9bC8sJs6z"},{"type":"text","value":" flops asymptotically, just like LU without pivoting. The implementation in ","position":{"start":{"line":151,"column":1},"end":{"line":151,"column":1}},"key":"iCR3l1gmFD"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-plufact","label":"function-plufact","children":[{"type":"text","value":"Function ","key":"bfnpInxGul"},{"type":"text","value":"2.6.2","key":"J0qdYw2ia9"}],"template":"Algorithm %s","enumerator":"2.6.2","resolved":true,"html_id":"function-plufact","key":"WHKoE2Rh5M"},{"type":"text","value":" does not achieve this optimal flop count, however. Like ","position":{"start":{"line":151,"column":1},"end":{"line":151,"column":1}},"key":"g4djlgHXIu"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-lufact","label":"function-lufact","children":[{"type":"text","value":"Function ","key":"RbTTZOBf5R"},{"type":"text","value":"2.4.1","key":"YLCQaiAOI8"}],"template":"Algorithm %s","enumerator":"2.4.1","resolved":true,"html_id":"function-lufact","remote":true,"url":"/lu","dataUrl":"/lu.json","key":"j6zQKkgLPP"},{"type":"text","value":", it does unnecessary operations on structurally known zeros for the sake of being easier to understand.","position":{"start":{"line":151,"column":1},"end":{"line":151,"column":1}},"key":"x7Q4nbjnAS"}],"key":"Qzk0M93pXn"},{"type":"heading","depth":2,"position":{"start":{"line":153,"column":1},"end":{"line":153,"column":1}},"children":[{"type":"text","value":"Linear systems","position":{"start":{"line":153,"column":1},"end":{"line":153,"column":1}},"key":"AxZFLYZ6hF"}],"identifier":"linear-systems","label":"Linear systems","html_id":"linear-systems","implicit":true,"enumerator":"2.6.3","key":"PrtI0aRHak"},{"type":"paragraph","position":{"start":{"line":155,"column":1},"end":{"line":155,"column":1}},"children":[{"type":"text","value":"The output of ","position":{"start":{"line":155,"column":1},"end":{"line":155,"column":1}},"key":"s2NtbsfHjY"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-plufact","label":"function-plufact","children":[{"type":"text","value":"Function ","key":"UQ67c2GFkB"},{"type":"text","value":"2.6.2","key":"bVE8Q13Wf5"}],"template":"Algorithm %s","enumerator":"2.6.2","resolved":true,"html_id":"function-plufact","key":"hjg9HldFKH"},{"type":"text","value":" is a factorization of a row-permuted ","position":{"start":{"line":155,"column":1},"end":{"line":155,"column":1}},"key":"bwKn30l4rP"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":155,"column":1},"end":{"line":155,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"rcg4LhsDFr"},{"type":"text","value":". Therefore, given a linear system ","position":{"start":{"line":155,"column":1},"end":{"line":155,"column":1}},"key":"NH57x3wZmy"},{"type":"inlineMath","value":"\\mathbf{A}\\mathbf{x}=\\mathbf{b}","position":{"start":{"line":155,"column":1},"end":{"line":155,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi><mi mathvariant=\"bold\">x</mi><mo>=</mo><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}\\mathbf{x}=\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">Ax</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"ri3Z8yC4u9"},{"type":"text","value":", we have to permute ","position":{"start":{"line":155,"column":1},"end":{"line":155,"column":1}},"key":"EE9kzVtEi2"},{"type":"inlineMath","value":"\\mathbf{b}","position":{"start":{"line":155,"column":1},"end":{"line":155,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"vNE7OCTIBh"},{"type":"text","value":" the same way before applying forward and backward substitution. This is equivalent to changing the order of the equations in a linear system, which does not affect its solution.","position":{"start":{"line":155,"column":1},"end":{"line":155,"column":1}},"key":"WhRDRbznQ4"}],"key":"F5mIU6IFRk"},{"type":"proof","kind":"example","enumerated":true,"children":[{"type":"admonitionTitle","children":[{"type":"text","value":"PLU factorization for solving linear systems","position":{"start":{"line":158,"column":1},"end":{"line":158,"column":1}},"key":"SlEWOVAyHg"}],"key":"l5y6aCs9sh"},{"type":"tabSet","children":[{"type":"tabItem","title":"Julia","sync":"julia","children":[{"type":"embed","source":{"url":"/chapter2","label":"demo-pivoting-usage-julia","kind":"Notebook","slug":"chapter2","location":"/julia/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-pivoting-usage","label":"demo-pivoting-usage","kind":"proof:example","position":{"start":{"line":956,"column":1},"end":{"line":956,"column":21}},"children":[{"type":"text","value":"Example ","key":"RhvtVNTmO5"},{"type":"text","value":"2.6.4","key":"RkL24Y7WSv"}],"template":"Example %s","enumerator":"2.6.4","resolved":true,"html_id":"demo-pivoting-usage","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"OlqxALkNyt"}],"key":"o8K9l5RM4A"},{"type":"paragraph","position":{"start":{"line":957,"column":1},"end":{"line":957,"column":1}},"children":[{"type":"text","value":"The third output of ","position":{"start":{"line":957,"column":1},"end":{"line":957,"column":1}},"key":"WlU5VZk4Ge"},{"type":"inlineCode","value":"plufact","position":{"start":{"line":957,"column":1},"end":{"line":957,"column":1}},"key":"UmtiPXRMfr"},{"type":"text","value":" is the permutation vector we need to apply to ","position":{"start":{"line":957,"column":1},"end":{"line":957,"column":1}},"key":"fPqQDCigI6"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":957,"column":1},"end":{"line":957,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"Pzm2VBk6hK"},{"type":"text","value":".","position":{"start":{"line":957,"column":1},"end":{"line":957,"column":1}},"key":"d6q52e2swv"}],"key":"AXeDIesNWz"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"A = rand(1:20, 4, 4)\nL, U, p = FNC.plufact(A)\nA[p,:] - L * U   # should be ≈ 0","key":"hR8DSAgIVa"},{"type":"output","id":"98H6ZN7s81pJywToQdHtH","data":[{"output_type":"execute_result","execution_count":94,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n 0.0  0.0  0.0  0.0\n 0.0  0.0  0.0  0.0\n 0.0  0.0  0.0  0.0\n 0.0  0.0  0.0  0.0","content_type":"text/plain"}}}],"key":"MtjPW4hIbt"}],"data":{},"key":"WhZsGG7Wtz"},{"type":"paragraph","position":{"start":{"line":965,"column":1},"end":{"line":965,"column":1}},"children":[{"type":"text","value":"Given a vector ","position":{"start":{"line":965,"column":1},"end":{"line":965,"column":1}},"key":"TjHmc0ZGuu"},{"type":"inlineMath","value":"\\mathbf{b}","position":{"start":{"line":965,"column":1},"end":{"line":965,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"UEXrRQmWTP"},{"type":"text","value":", we solve ","position":{"start":{"line":965,"column":1},"end":{"line":965,"column":1}},"key":"gKMwLlgEO5"},{"type":"inlineMath","value":"\\mathbf{A}\\mathbf{x}=\\mathbf{b}","position":{"start":{"line":965,"column":1},"end":{"line":965,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi><mi mathvariant=\"bold\">x</mi><mo>=</mo><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}\\mathbf{x}=\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">Ax</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"WtFJagEZHX"},{"type":"text","value":" by first permuting the entries of ","position":{"start":{"line":965,"column":1},"end":{"line":965,"column":1}},"key":"VgAe2ofLBr"},{"type":"inlineMath","value":"\\mathbf{b}","position":{"start":{"line":965,"column":1},"end":{"line":965,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"Dp1I45dpdG"},{"type":"text","value":" and then proceeding as before.","position":{"start":{"line":965,"column":1},"end":{"line":965,"column":1}},"key":"ICgGiELXkX"}],"key":"UlrGnNFXMv"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"b = rand(4)\nz = FNC.forwardsub(L,b[p])\nx = FNC.backsub(U,z)","key":"oM7VSZwIfI"},{"type":"output","id":"kXWFZ2iL2ary9uA-RwLp8","data":[{"output_type":"execute_result","execution_count":95,"metadata":{},"data":{"text/plain":{"content":"4-element Vector{Float64}:\n -0.15587966150115953\n -0.0385894691241006\n -0.0959127730404181\n  0.32576670617232695","content_type":"text/plain"}}}],"key":"ygf87UVUR0"}],"data":{},"key":"HURXdyoPTu"},{"type":"paragraph","position":{"start":{"line":973,"column":1},"end":{"line":973,"column":1}},"children":[{"type":"text","value":"A residual check is successful:","position":{"start":{"line":973,"column":1},"end":{"line":973,"column":1}},"key":"xTqyPaKSRa"}],"key":"wWDZxDl96A"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"b - A*x","key":"bZS1S52Yqa"},{"type":"output","id":"GYfZp1iwtfVvsnbd0MO7z","data":[{"output_type":"execute_result","execution_count":96,"metadata":{},"data":{"text/plain":{"content":"4-element Vector{Float64}:\n 4.440892098500626e-16\n 6.661338147750939e-16\n 2.220446049250313e-16\n 3.3306690738754696e-16","content_type":"text/plain"}}}],"key":"oGURWRrXv6"}],"data":{},"key":"jMSVJcmxQq"}],"key":"WhBxoG4zB3"}],"key":"HkZjXEM8kO"}],"key":"iQk1EXxojK"},{"type":"tabItem","title":"MATLAB","sync":"matlab","children":[{"type":"embed","source":{"url":"/chapter2-1","label":"demo-pivoting-usage-matlab","kind":"Notebook","slug":"chapter2-1","location":"/matlab/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-pivoting-usage","label":"demo-pivoting-usage","kind":"proof:example","position":{"start":{"line":904,"column":1},"end":{"line":904,"column":21}},"children":[{"type":"text","value":"Example ","key":"ApDEluaw8p"},{"type":"text","value":"2.6.4","key":"hTWmxxeOTY"}],"template":"Example %s","enumerator":"2.6.4","resolved":true,"html_id":"demo-pivoting-usage","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"BspH7UyzJt"}],"key":"htcFXG5GuZ"},{"type":"paragraph","position":{"start":{"line":905,"column":1},"end":{"line":905,"column":1}},"children":[{"type":"text","value":"The third output of ","position":{"start":{"line":905,"column":1},"end":{"line":905,"column":1}},"key":"zxsQDhRi2K"},{"type":"inlineCode","value":"plufact","position":{"start":{"line":905,"column":1},"end":{"line":905,"column":1}},"key":"x8MB0fE9pB"},{"type":"text","value":" is the permutation vector we need to apply to ","position":{"start":{"line":905,"column":1},"end":{"line":905,"column":1}},"key":"W1NLcKWCdl"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":905,"column":1},"end":{"line":905,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"XZ7IFiW1td"},{"type":"text","value":".","position":{"start":{"line":905,"column":1},"end":{"line":905,"column":1}},"key":"HL7O96OlwJ"}],"key":"MTfRhbc9TD"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A = randi(20, 4, 4);\n[L, U, p] = plufact(A);\nA(p, :) - L * U    % should be ≈ 0","key":"TPxcTEXx7p"},{"type":"output","id":"MlmuGiu1Yv7m5erruO44i","data":[{"output_type":"execute_result","execution_count":92,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = 4×4 double\n     0     0     0     0\n     0     0     0     0\n     0     0     0     0\n     0     0     0     0\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = 4×4 double\n     0     0     0     0\n     0     0     0     0\n     0     0     0     0\n     0     0     0     0\n","content_type":"text/plain"}}}],"key":"JCuF7ITxMP"}],"data":{},"key":"LBIu2RvjZp"},{"type":"paragraph","position":{"start":{"line":913,"column":1},"end":{"line":913,"column":1}},"children":[{"type":"text","value":"Given a vector ","position":{"start":{"line":913,"column":1},"end":{"line":913,"column":1}},"key":"WzVYBY4OmD"},{"type":"inlineMath","value":"\\mathbf{b}","position":{"start":{"line":913,"column":1},"end":{"line":913,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"RwIFPfdxMO"},{"type":"text","value":", we solve ","position":{"start":{"line":913,"column":1},"end":{"line":913,"column":1}},"key":"Q0ZGYxFy2T"},{"type":"inlineMath","value":"\\mathbf{A}\\mathbf{x}=\\mathbf{b}","position":{"start":{"line":913,"column":1},"end":{"line":913,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi><mi mathvariant=\"bold\">x</mi><mo>=</mo><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}\\mathbf{x}=\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">Ax</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"xYesunBjZg"},{"type":"text","value":" by first permuting the entries of ","position":{"start":{"line":913,"column":1},"end":{"line":913,"column":1}},"key":"wCiM6N3rmL"},{"type":"inlineMath","value":"\\mathbf{b}","position":{"start":{"line":913,"column":1},"end":{"line":913,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"tqxXxyv2bL"},{"type":"text","value":" and then proceeding as before.","position":{"start":{"line":913,"column":1},"end":{"line":913,"column":1}},"key":"CHz4g4toaJ"}],"key":"ksvyCsDqyj"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"b = rand(4, 1);\nz = forwardsub(L, b(p));\nx = backsub(U, z)","key":"Xh1Mbkv4Ll"},{"type":"output","id":"HO5dziduOhZSL34HzxvqU","data":[{"output_type":"execute_result","execution_count":93,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>x = 4×1 double\n    0.0134\n    0.0086\n    0.0058\n    0.0199\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"x = 4×1 double\n    0.0134\n    0.0086\n    0.0058\n    0.0199\n","content_type":"text/plain"}}}],"key":"tYsESzlEZq"}],"data":{},"key":"uky1cSXYuh"},{"type":"paragraph","position":{"start":{"line":921,"column":1},"end":{"line":921,"column":1}},"children":[{"type":"text","value":"A residual check is successful:","position":{"start":{"line":921,"column":1},"end":{"line":921,"column":1}},"key":"Xo7seforzE"}],"key":"PHvTJh2m4e"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"b - A*x","key":"lSHe0DvYfk"},{"type":"output","id":"FaYKC502beu4zdNy5P0gW","data":[{"output_type":"execute_result","execution_count":94,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = 4×1 double\n1.0e-16 *\n\n         0\n    0.5551\n         0\n         0\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = 4×1 double\n1.0e-16 *\n\n         0\n    0.5551\n         0\n         0\n","content_type":"text/plain"}}}],"key":"mDzfo0IdjA"}],"data":{},"key":"pP3H0WJv6h"}],"key":"OwhDwLM1aZ"}],"key":"TTwBCvDPHT"}],"key":"CoCA183qzN"},{"type":"tabItem","title":"Python","sync":"python","children":[{"type":"embed","source":{"url":"/chapter2-2","label":"demo-pivoting-usage-python","kind":"Notebook","slug":"chapter2-2","location":"/python/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-pivoting-usage","label":"demo-pivoting-usage","kind":"proof:example","position":{"start":{"line":890,"column":1},"end":{"line":890,"column":21}},"children":[{"type":"text","value":"Example ","key":"dtxwXVwYSH"},{"type":"text","value":"2.6.4","key":"OybUllM7Xg"}],"template":"Example %s","enumerator":"2.6.4","resolved":true,"html_id":"demo-pivoting-usage","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"ZrgPJrqs7y"}],"key":"MrMVk7GlJT"},{"type":"paragraph","position":{"start":{"line":891,"column":1},"end":{"line":891,"column":1}},"children":[{"type":"text","value":"The third output of ","position":{"start":{"line":891,"column":1},"end":{"line":891,"column":1}},"key":"VUZ0loW9Se"},{"type":"inlineCode","value":"plufact","position":{"start":{"line":891,"column":1},"end":{"line":891,"column":1}},"key":"Sz91kDUs0V"},{"type":"text","value":" is the permutation vector we need to apply to ","position":{"start":{"line":891,"column":1},"end":{"line":891,"column":1}},"key":"YZ3oMXRf2X"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":891,"column":1},"end":{"line":891,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"ab6WX2e7rK"},{"type":"text","value":".","position":{"start":{"line":891,"column":1},"end":{"line":891,"column":1}},"key":"iqTfAAq0DH"}],"key":"A1RSgZlwX6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"A = random.randn(4, 4)\nL, U, p = FNC.plufact(A)\nA[p, :] - L @ U   # should be ≈ 0","key":"KM4kAVQUae"},{"type":"output","id":"fzf3wTyPq1nJ4SwuPcQLB","data":[{"output_type":"execute_result","execution_count":91,"metadata":{},"data":{"text/plain":{"content":"array([[ 0.00000000e+00,  0.00000000e+00,  0.00000000e+00,\n         0.00000000e+00],\n       [ 0.00000000e+00, -5.55111512e-17,  0.00000000e+00,\n         0.00000000e+00],\n       [ 0.00000000e+00,  3.46944695e-18,  0.00000000e+00,\n         0.00000000e+00],\n       [ 0.00000000e+00,  0.00000000e+00,  0.00000000e+00,\n         0.00000000e+00]])","content_type":"text/plain"}}}],"key":"CgwruInSW3"}],"data":{},"key":"nZZeXaiSpk"},{"type":"paragraph","position":{"start":{"line":899,"column":1},"end":{"line":899,"column":1}},"children":[{"type":"text","value":"Given a vector ","position":{"start":{"line":899,"column":1},"end":{"line":899,"column":1}},"key":"xAAVB6m75s"},{"type":"inlineMath","value":"\\mathbf{b}","position":{"start":{"line":899,"column":1},"end":{"line":899,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"i6ooGs0TEX"},{"type":"text","value":", we solve ","position":{"start":{"line":899,"column":1},"end":{"line":899,"column":1}},"key":"fYiTByd12O"},{"type":"inlineMath","value":"\\mathbf{A}\\mathbf{x}=\\mathbf{b}","position":{"start":{"line":899,"column":1},"end":{"line":899,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi><mi mathvariant=\"bold\">x</mi><mo>=</mo><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}\\mathbf{x}=\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">Ax</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"OhaJiX8Rh3"},{"type":"text","value":" by first permuting the entries of ","position":{"start":{"line":899,"column":1},"end":{"line":899,"column":1}},"key":"EmiQOZcu1q"},{"type":"inlineMath","value":"\\mathbf{b}","position":{"start":{"line":899,"column":1},"end":{"line":899,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"FwdFlvypb5"},{"type":"text","value":" and then proceeding as before.","position":{"start":{"line":899,"column":1},"end":{"line":899,"column":1}},"key":"mE4Uj7whEo"}],"key":"PRETBTQ3D1"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"b = random.randn(4)\nz = FNC.forwardsub(L, b[p])\nx = FNC.backsub(U, z)","key":"Y9tnTA2ux1"},{"type":"output","id":"xxskSZr3P5gKiD_BZIvjK","data":[],"key":"BpLFde0FDX"}],"data":{},"key":"a980xgjSQj"},{"type":"paragraph","position":{"start":{"line":907,"column":1},"end":{"line":907,"column":1}},"children":[{"type":"text","value":"A residual check is successful:","position":{"start":{"line":907,"column":1},"end":{"line":907,"column":1}},"key":"ggnhpC5YYF"}],"key":"gigwEqRrJc"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"b - A @ x","key":"KRgy92N7Cf"},{"type":"output","id":"O8-ReXSPH2A5pLxSu_zy_","data":[{"output_type":"execute_result","execution_count":93,"metadata":{},"data":{"text/plain":{"content":"array([0.00000000e+00, 1.66533454e-16, 0.00000000e+00, 2.22044605e-16])","content_type":"text/plain"}}}],"key":"XVQHqCCldX"}],"data":{},"key":"ooSlyejeaR"}],"key":"EjocaTFndL"}],"key":"K4fUBhEyLo"}],"key":"qmZx061NR8"}],"key":"RdKvrxSuZV"}],"label":"demo-pivoting-usage","identifier":"demo-pivoting-usage","html_id":"demo-pivoting-usage","enumerator":"2.6.4","key":"Uuj7iRRDgW"},{"type":"paragraph","position":{"start":{"line":180,"column":1},"end":{"line":180,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":180,"column":1},"end":{"line":180,"column":1}},"key":"EscHzAlDiT"},{"type":"inlineCode","value":"lu","position":{"start":{"line":180,"column":1},"end":{"line":180,"column":1}},"key":"U0rLk54mFQ"},{"type":"text","value":" function from the built-in package ","position":{"start":{"line":180,"column":1},"end":{"line":180,"column":1}},"key":"ToTjBShK0d"},{"type":"inlineCode","value":"LinearAlgebra","position":{"start":{"line":180,"column":1},"end":{"line":180,"column":1}},"key":"VSW9pjesIw"},{"type":"text","value":" returns the same three outputs as ","position":{"start":{"line":180,"column":1},"end":{"line":180,"column":1}},"key":"lTAMCUmFCn"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-plufact","label":"function-plufact","children":[{"type":"text","value":"Function ","key":"lKADZ4W165"},{"type":"text","value":"2.6.2","key":"V4wLcTOTPT"}],"template":"Algorithm %s","enumerator":"2.6.2","resolved":true,"html_id":"function-plufact","key":"dcwbkGsAeZ"},{"type":"text","value":". If you only request one output, it will be a factorization object that can be used with a backslash. This is useful when you want to solve with multiple versions of ","position":{"start":{"line":180,"column":1},"end":{"line":180,"column":1}},"key":"x5qU4y1cJi"},{"type":"inlineMath","value":"\\mathbf{b}","position":{"start":{"line":180,"column":1},"end":{"line":180,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"PZFXObamIs"},{"type":"text","value":" but do the factorization only once.","position":{"start":{"line":180,"column":1},"end":{"line":180,"column":1}},"key":"bvUMgIOXXA"}],"key":"zHyrFQTX0P"},{"type":"proof","kind":"example","enumerated":true,"children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Built-in PLU factorization","position":{"start":{"line":183,"column":1},"end":{"line":183,"column":1}},"key":"QZPNW2GALS"}],"key":"tFx3cqEqoK"},{"type":"tabSet","children":[{"type":"tabItem","title":"Julia","sync":"julia","children":[{"type":"embed","source":{"url":"/chapter2","label":"demo-pivoting-builtin-julia","kind":"Notebook","slug":"chapter2","location":"/julia/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-pivoting-builtin","label":"demo-pivoting-builtin","kind":"proof:example","position":{"start":{"line":981,"column":1},"end":{"line":981,"column":23}},"children":[{"type":"text","value":"Example ","key":"QhvW7TWmuT"},{"type":"text","value":"2.6.5","key":"RC7sBqdtln"}],"template":"Example %s","enumerator":"2.6.5","resolved":true,"html_id":"demo-pivoting-builtin","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"S7ZuIPzn0Q"}],"key":"Y7U4a5pNmj"},{"type":"paragraph","position":{"start":{"line":982,"column":1},"end":{"line":982,"column":1}},"children":[{"type":"text","value":"With the syntax ","position":{"start":{"line":982,"column":1},"end":{"line":982,"column":1}},"key":"vDG2WcRMiV"},{"type":"inlineCode","value":"A \\ b","position":{"start":{"line":982,"column":1},"end":{"line":982,"column":1}},"key":"iUof8g5uR2"},{"type":"text","value":", the matrix ","position":{"start":{"line":982,"column":1},"end":{"line":982,"column":1}},"key":"yn22gfhuZD"},{"type":"inlineCode","value":"A","position":{"start":{"line":982,"column":1},"end":{"line":982,"column":1}},"key":"P9U8bwhy6p"},{"type":"text","value":" is PLU-factored, followed by two triangular solves.","position":{"start":{"line":982,"column":1},"end":{"line":982,"column":1}},"key":"gIJDLmSedo"}],"key":"g34BFKhyuS"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"A = randn(500, 500)   # 500x500 with normal random entries\nA \\ rand(500)          # force compilation\n@elapsed for k=1:50; A \\ rand(500); end","key":"bVUoRLFoar"},{"type":"output","id":"YPIw_Pw0L5f6VGROVnjMz","data":[{"output_type":"execute_result","execution_count":97,"metadata":{},"data":{"text/plain":{"content":"4.388348708","content_type":"text/plain"}}}],"key":"Qoqk1zY3ss"}],"data":{},"key":"E14M9yTQsK"},{"type":"paragraph","position":{"start":{"line":990,"column":1},"end":{"line":990,"column":1}},"children":[{"type":"text","value":"In ","position":{"start":{"line":990,"column":1},"end":{"line":990,"column":1}},"key":"uVOiUA5VR0"},{"type":"link","kind":"numref","url":"/efficiency","internal":true,"dataUrl":"/efficiency.json","children":[{"type":"text","value":"Efficiency of matrix computations","key":"eTK3kfZm38"}],"key":"hl9XSI651E"},{"type":"text","value":" we showed that the factorization is by far the most costly part of the solution process. A factorization object allows us to do that costly step only once per unique matrix.","position":{"start":{"line":990,"column":1},"end":{"line":990,"column":1}},"key":"hvfmy5X1TZ"}],"key":"skd1iCKfkA"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"factored = lu(A)     # store factorization result\nfactored \\ rand(500)   # force compilation\n@elapsed for k=1:50; factored \\ rand(500); end","key":"DuS0drv6O7"},{"type":"output","id":"hIYQEmDOedAmw136shq3m","data":[{"output_type":"execute_result","execution_count":98,"metadata":{},"data":{"text/plain":{"content":"0.008497209","content_type":"text/plain"}}}],"key":"Sx1ydwOj60"}],"data":{},"key":"YuwwFvkbrd"}],"key":"uhLZFNcTLF"}],"key":"a22vFE8aBk"}],"key":"OWhkSV3cfl"},{"type":"tabItem","title":"MATLAB","sync":"matlab","children":[{"type":"embed","source":{"url":"/chapter2-1","label":"demo-pivoting-builtin-matlab","kind":"Notebook","slug":"chapter2-1","location":"/matlab/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-pivoting-builtin","label":"demo-pivoting-builtin","kind":"proof:example","position":{"start":{"line":929,"column":1},"end":{"line":929,"column":23}},"children":[{"type":"text","value":"Example ","key":"vJORZfuGJk"},{"type":"text","value":"2.6.5","key":"E0fjlnLJVV"}],"template":"Example %s","enumerator":"2.6.5","resolved":true,"html_id":"demo-pivoting-builtin","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"UpO87I46Bo"}],"key":"jTeH9oNz0M"},{"type":"paragraph","position":{"start":{"line":930,"column":1},"end":{"line":930,"column":1}},"children":[{"type":"text","value":"With the syntax ","position":{"start":{"line":930,"column":1},"end":{"line":930,"column":1}},"key":"PSJgHTeLKz"},{"type":"inlineCode","value":"A \\ b","position":{"start":{"line":930,"column":1},"end":{"line":930,"column":1}},"key":"tRynpX9Kyy"},{"type":"text","value":", the matrix ","position":{"start":{"line":930,"column":1},"end":{"line":930,"column":1}},"key":"JWiXKOFLaq"},{"type":"inlineCode","value":"A","position":{"start":{"line":930,"column":1},"end":{"line":930,"column":1}},"key":"AY17wbqrmS"},{"type":"text","value":" is PLU-factored, followed by two triangular solves.","position":{"start":{"line":930,"column":1},"end":{"line":930,"column":1}},"key":"RHuFCIMFsb"}],"key":"VYtObQXyeQ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A = randn(500, 500);    % 500x500 with normal random entries\ntic; for k=1:50; A \\ rand(500, 1); end; toc","key":"s7FEjdPiPB"},{"type":"output","id":"PpxcrmNx8sjJi6lYa9p9X","data":[{"output_type":"stream","name":"stdout","text":"Elapsed time is 0.273929 seconds.\n"}],"key":"KEyZUaReyP"}],"data":{},"key":"N5FCQ054hi"},{"type":"paragraph","position":{"start":{"line":937,"column":1},"end":{"line":937,"column":1}},"children":[{"type":"text","value":"In ","position":{"start":{"line":937,"column":1},"end":{"line":937,"column":1}},"key":"kscTV57ihB"},{"type":"link","kind":"numref","url":"/efficiency","internal":true,"dataUrl":"/efficiency.json","children":[{"type":"text","value":"Efficiency of matrix computations","key":"JKVARsrjyT"}],"key":"HuH7M0jhhp"},{"type":"text","value":" we showed that the factorization is by far the most costly part of the solution process. A factorization object allows us to do that costly step only once per unique matrix.","position":{"start":{"line":937,"column":1},"end":{"line":937,"column":1}},"key":"y83rpjUOwg"}],"key":"sGBcsCWkjd"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[L, U, p] = lu(A, 'vector');    % keep factorization result\ntic\nfor k=1:50\n    b = rand(500, 1);\n    U \\ (L \\ b(p));\nend\ntoc","key":"OKEWrHCQmc"},{"type":"output","id":"4DJC6jxT6CFgXv5AqCOwv","data":[{"output_type":"stream","name":"stdout","text":"Elapsed time is 0.009580 seconds.\n"}],"key":"Wrtlgj7a7E"}],"data":{},"key":"K5198o8O5o"}],"key":"TWHGBwJ8M0"}],"key":"JCxdNVFBte"}],"key":"nI1AH8CLgU"},{"type":"tabItem","title":"Python","sync":"python","children":[{"type":"embed","source":{"url":"/chapter2-2","label":"demo-pivoting-builtin-python","kind":"Notebook","slug":"chapter2-2","location":"/python/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-pivoting-builtin","label":"demo-pivoting-builtin","kind":"proof:example","position":{"start":{"line":915,"column":1},"end":{"line":915,"column":23}},"children":[{"type":"text","value":"Example ","key":"APyJgh8eLh"},{"type":"text","value":"2.6.5","key":"aXRPVPgVny"}],"template":"Example %s","enumerator":"2.6.5","resolved":true,"html_id":"demo-pivoting-builtin","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"hS3CiyuN9K"}],"key":"Mnsez9kwbH"},{"type":"paragraph","position":{"start":{"line":916,"column":1},"end":{"line":916,"column":1}},"children":[{"type":"text","value":"In ","position":{"start":{"line":916,"column":1},"end":{"line":916,"column":1}},"key":"aOcWA4jQJh"},{"type":"inlineCode","value":"linalg.solve","position":{"start":{"line":916,"column":1},"end":{"line":916,"column":1}},"key":"xc1mGyRmww"},{"type":"text","value":", the matrix ","position":{"start":{"line":916,"column":1},"end":{"line":916,"column":1}},"key":"KlbwXZrkBR"},{"type":"inlineCode","value":"A","position":{"start":{"line":916,"column":1},"end":{"line":916,"column":1}},"key":"EnGssqj9dg"},{"type":"text","value":" is PLU-factored, followed by two triangular solves. If we want to do those steps seamlessly, we can use the ","position":{"start":{"line":916,"column":1},"end":{"line":916,"column":1}},"key":"NVTP1fZJ4e"},{"type":"inlineCode","value":"lu_factor","position":{"start":{"line":916,"column":1},"end":{"line":916,"column":1}},"key":"WY3irdXcU9"},{"type":"text","value":" and ","position":{"start":{"line":916,"column":1},"end":{"line":916,"column":1}},"key":"UVjLTNz1Cg"},{"type":"inlineCode","value":"lu_solve","position":{"start":{"line":916,"column":1},"end":{"line":916,"column":1}},"key":"BtP0h8E4T9"},{"type":"text","value":" from ","position":{"start":{"line":916,"column":1},"end":{"line":916,"column":1}},"key":"EAFpRWkBVW"},{"type":"inlineCode","value":"scipy.linalg","position":{"start":{"line":916,"column":1},"end":{"line":916,"column":1}},"key":"BqoiEDf5aO"},{"type":"text","value":".","position":{"start":{"line":916,"column":1},"end":{"line":916,"column":1}},"key":"OQR4WCgMz1"}],"key":"aYB263TcWw"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from scipy.linalg import lu_factor, lu_solve\nA = random.randn(500, 500) \nb = ones(500)  \nLU, perm = lu_factor(A)\nx = lu_solve((LU, perm), b)","key":"MaNUefoHjt"},{"type":"output","id":"VIM9rOiRA11XZJljN50Hx","data":[],"key":"iqNfspmiOI"}],"data":{},"key":"JJ5HAZroLv"},{"type":"paragraph","position":{"start":{"line":926,"column":1},"end":{"line":926,"column":1}},"children":[{"type":"text","value":"Why would we ever bother with this? In ","position":{"start":{"line":926,"column":1},"end":{"line":926,"column":1}},"key":"pni3sTdTYp"},{"type":"link","kind":"numref","url":"/efficiency","internal":true,"dataUrl":"/efficiency.json","children":[{"type":"text","value":"Efficiency of matrix computations","key":"kipcysh1w9"}],"key":"KpVuoW5lZx"},{"type":"text","value":" we showed that the factorization is by far the most costly part of the solution process. A factorization object allows us to do that costly step only once per matrix, but solve with multiple right-hand sides.","position":{"start":{"line":926,"column":1},"end":{"line":926,"column":1}},"key":"g0IODlyCNc"}],"key":"wGsLMEcUKn"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"start = timer()\nfor k in range(50): linalg.solve(A, random.rand(500))\nprint(f\"elapsed time for 50 full solves: {timer() - start}\")\n\nstart = timer()\nLU, perm = lu_factor(A)\nfor k in range(50): lu_solve((LU, perm), random.rand(500))\nprint(f\"elapsed time for 50 shortcut solves: {timer() - start}\")","key":"DGlhIxkv9a"},{"type":"output","id":"xlrKhGJ_CyJONk_O0M2eO","data":[{"output_type":"stream","name":"stdout","text":"elapsed time for 50 full solves: 2.679206874992815\n"},{"output_type":"stream","name":"stdout","text":"elapsed time for 50 shortcut solves: 0.45774804199754726\n"}],"key":"rp4rFprmct"}],"data":{},"key":"eUgopqnHRK"}],"key":"gZsrOHS4R8"}],"key":"k3Rm5180kN"}],"key":"jqUEDAvQW7"}],"key":"Qae8E6Ngy3"}],"label":"demo-pivoting-builtin","identifier":"demo-pivoting-builtin","html_id":"demo-pivoting-builtin","enumerator":"2.6.5","key":"zQDhgXt6sD"},{"type":"heading","depth":2,"position":{"start":{"line":205,"column":1},"end":{"line":205,"column":1}},"children":[{"type":"text","value":"Stability","position":{"start":{"line":205,"column":1},"end":{"line":205,"column":1}},"key":"VIeVgdmyvv"}],"identifier":"stability","label":"Stability","html_id":"stability","implicit":true,"enumerator":"2.6.4","key":"qpsc3vRwQU"},{"type":"paragraph","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"children":[{"type":"text","value":"There is one detail of the row pivoting algorithm that might seem arbitrary: why choose the pivot of largest magnitude in a column, rather than, say, the uppermost nonzero in the column? The answer is numerical stability.","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"key":"Cfp5GUFqPu"}],"indexEntries":[{"entry":"stability","emphasis":false}],"label":"index-xsAWpVcn7Z","identifier":"index-xsawpvcn7z","html_id":"index-xsawpvcn7z","key":"lYgt0YE1qW"},{"type":"proof","kind":"example","enumerated":true,"children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Stability of PLU factorization","position":{"start":{"line":213,"column":1},"end":{"line":213,"column":1}},"key":"lGg4amA37K"}],"key":"tD8GztuOqa"},{"type":"paragraph","position":{"start":{"line":214,"column":1},"end":{"line":214,"column":1}},"children":[{"type":"text","value":"Let","position":{"start":{"line":214,"column":1},"end":{"line":214,"column":1}},"key":"BDxrJJdXEj"}],"key":"RL4THqMmzJ"},{"type":"math","value":"\\mathbf{A} =\n  \\begin{bmatrix}\n    -\\epsilon & 1 \\\\ 1 & -1\n  \\end{bmatrix}.","label":"plu-stab-A","identifier":"plu-stab-a","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi mathvariant=\"bold\">A</mi><mo>=</mo><mrow><mo fence=\"true\">[</mo><mtable rowspacing=\"0.16em\" columnalign=\"center center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mi>ϵ</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mn>1</mn></mrow></mstyle></mtd></mtr></mtable><mo fence=\"true\">]</mo></mrow><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A} =\n  \\begin{bmatrix}\n    -\\epsilon &amp; 1 \\\\ 1 &amp; -1\n  \\end{bmatrix}.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.4em;vertical-align:-0.95em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">[</span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord mathnormal\">ϵ</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.95em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.95em;\"><span></span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">]</span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">.</span></span></span></span></span>","enumerator":"2.6.2","html_id":"plu-stab-a","key":"pCijSGrCqc"},{"type":"paragraph","position":{"start":{"line":224,"column":1},"end":{"line":224,"column":1}},"children":[{"type":"text","value":"If ","position":{"start":{"line":224,"column":1},"end":{"line":224,"column":1}},"key":"DdrvP6ceKD"},{"type":"inlineMath","value":"\\epsilon=0","position":{"start":{"line":224,"column":1},"end":{"line":224,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ϵ</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">\\epsilon=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">ϵ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"ckPR92Oke6"},{"type":"text","value":", LU factorization without pivoting fails for ","position":{"start":{"line":224,"column":1},"end":{"line":224,"column":1}},"key":"loDPNOWK9r"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":224,"column":1},"end":{"line":224,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"lEX7G7465m"},{"type":"text","value":". But if ","position":{"start":{"line":224,"column":1},"end":{"line":224,"column":1}},"key":"vgsVWOtYXD"},{"type":"inlineMath","value":"\\epsilon\\neq 0","position":{"start":{"line":224,"column":1},"end":{"line":224,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ϵ</mi><mo mathvariant=\"normal\">≠</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">\\epsilon\\neq 0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">ϵ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\"><span class=\"mrel\"><span class=\"mord vbox\"><span class=\"thinbox\"><span class=\"rlap\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"inner\"><span class=\"mord\"><span class=\"mrel\"></span></span></span><span class=\"fix\"></span></span></span></span></span><span class=\"mrel\">=</span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"kTfa9oDFIJ"},{"type":"text","value":", we can go without pivoting, at least in principle.","position":{"start":{"line":224,"column":1},"end":{"line":224,"column":1}},"key":"gZm2T45EWJ"}],"key":"iByPCUVq1k"},{"type":"tabSet","children":[{"type":"tabItem","title":"Julia","sync":"julia","children":[{"type":"embed","source":{"url":"/chapter2","label":"demo-pivoting-stable-julia","kind":"Notebook","slug":"chapter2","location":"/julia/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-pivoting-stable","label":"demo-pivoting-stable","kind":"proof:example","position":{"start":{"line":1000,"column":1},"end":{"line":1000,"column":22}},"children":[{"type":"text","value":"Example ","key":"k6tCC0pgsi"},{"type":"text","value":"2.6.6","key":"QA6DMYSI2v"}],"template":"Example %s","enumerator":"2.6.6","resolved":true,"html_id":"demo-pivoting-stable","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"ULbTOzQNE1"}],"key":"iG20RrVSc8"},{"type":"paragraph","position":{"start":{"line":1001,"column":1},"end":{"line":1001,"column":1}},"children":[{"type":"text","value":"We construct a linear system for this matrix with ","position":{"start":{"line":1001,"column":1},"end":{"line":1001,"column":1}},"key":"sbPfJdlJYH"},{"type":"inlineMath","value":"\\epsilon=10^{-12}","position":{"start":{"line":1001,"column":1},"end":{"line":1001,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ϵ</mi><mo>=</mo><mn>1</mn><msup><mn>0</mn><mrow><mo>−</mo><mn>12</mn></mrow></msup></mrow><annotation encoding=\"application/x-tex\">\\epsilon=10^{-12}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">ϵ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">12</span></span></span></span></span></span></span></span></span></span></span></span>","key":"nPK9M8IIQf"},{"type":"text","value":" and exact solution ","position":{"start":{"line":1001,"column":1},"end":{"line":1001,"column":1}},"key":"qUqM6K9SYQ"},{"type":"inlineMath","value":"[1,1]","position":{"start":{"line":1001,"column":1},"end":{"line":1001,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[1,1]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]</span></span></span></span>","key":"sz78v7X4EH"},{"type":"text","value":":","position":{"start":{"line":1001,"column":1},"end":{"line":1001,"column":1}},"key":"fmYB6Xe50z"}],"key":"u76mnsCsJM"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"ϵ = 1e-12\nA = [-ϵ 1; 1 -1]\nb = A * [1, 1]","key":"R51EH2PGS7"},{"type":"output","id":"HjzCZ4Uv3EAcv5E5ex1Si","data":[{"output_type":"execute_result","execution_count":99,"metadata":{},"data":{"text/plain":{"content":"2-element Vector{Float64}:\n 0.999999999999\n 0.0","content_type":"text/plain"}}}],"key":"wQQ6v9Jeda"}],"data":{},"key":"iMLOHTozIZ"},{"type":"paragraph","position":{"start":{"line":1009,"column":1},"end":{"line":1009,"column":1}},"children":[{"type":"text","value":"We can factor the matrix without pivoting and solve for ","position":{"start":{"line":1009,"column":1},"end":{"line":1009,"column":1}},"key":"mcXuzKMpLD"},{"type":"inlineMath","value":"\\mathbf{x}","position":{"start":{"line":1009,"column":1},"end":{"line":1009,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">x</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{x}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4444em;\"></span><span class=\"mord mathbf\">x</span></span></span></span>","key":"WJraePrNKz"},{"type":"text","value":".","position":{"start":{"line":1009,"column":1},"end":{"line":1009,"column":1}},"key":"y6mjf3El37"}],"key":"p6kAQZ0VZ8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"L, U = FNC.lufact(A)\nx = FNC.backsub( U, FNC.forwardsub(L, b) )","key":"PT0NtzgmrX"},{"type":"output","id":"wm434jqlwoYuAeTwTidfD","data":[{"output_type":"execute_result","execution_count":100,"metadata":{},"data":{"text/plain":{"content":"2-element Vector{Float64}:\n 0.9999778782798785\n 1.0","content_type":"text/plain"}}}],"key":"LEyhZMt5VM"}],"data":{},"key":"Ou11o3kZAX"},{"type":"paragraph","position":{"start":{"line":1016,"column":1},"end":{"line":1016,"column":1}},"children":[{"type":"text","value":"Note that we have obtained only about 5 accurate digits for ","position":{"start":{"line":1016,"column":1},"end":{"line":1016,"column":1}},"key":"NK4v0CeYcy"},{"type":"inlineMath","value":"x_1","position":{"start":{"line":1016,"column":1},"end":{"line":1016,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">x_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"kCszkwOCuN"},{"type":"text","value":". We could make the result even more inaccurate by making ","position":{"start":{"line":1016,"column":1},"end":{"line":1016,"column":1}},"key":"ummVDAmwP3"},{"type":"text","value":"ε","position":{"start":{"line":1016,"column":1},"end":{"line":1016,"column":1}},"key":"EVDWCKdIUJ"},{"type":"text","value":" even smaller:","position":{"start":{"line":1016,"column":1},"end":{"line":1016,"column":1}},"key":"sxRRJhKPZz"}],"key":"DQ2hxH43E4"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"ϵ = 1e-20; A = [-ϵ 1; 1 -1]\nb = A * [1, 1]\nL, U = FNC.lufact(A)\nx = FNC.backsub( U, FNC.forwardsub(L, b) )","key":"I5FcAiEbju"},{"type":"output","id":"OwnA_PRNN9tomiI5NtiEC","data":[{"output_type":"execute_result","execution_count":101,"metadata":{},"data":{"text/plain":{"content":"2-element Vector{Float64}:\n -0.0\n  1.0","content_type":"text/plain"}}}],"key":"Rxgud8lNWg"}],"data":{},"key":"xTXkrPVbf0"},{"type":"paragraph","position":{"start":{"line":1025,"column":1},"end":{"line":1025,"column":1}},"children":[{"type":"text","value":"This effect is not due to ill conditioning of the problem—a solution with PLU factorization works perfectly:","position":{"start":{"line":1025,"column":1},"end":{"line":1025,"column":1}},"key":"grMKAUeDTA"}],"key":"MY3C9QzaIF"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"A \\ b","key":"QtkA3OZZnG"},{"type":"output","id":"YzuBqnSC3AWt2WAo79qce","data":[{"output_type":"execute_result","execution_count":102,"metadata":{},"data":{"text/plain":{"content":"2-element Vector{Float64}:\n 1.0\n 1.0","content_type":"text/plain"}}}],"key":"l3a7WXW2dT"}],"data":{},"key":"BEvkxUmLLO"}],"key":"kkY3QTiglI"}],"key":"gUnCQRtmsr"}],"key":"oXb3zailCp"},{"type":"tabItem","title":"MATLAB","sync":"matlab","children":[{"type":"embed","source":{"url":"/chapter2-1","label":"demo-pivoting-stable-matlab","kind":"Notebook","slug":"chapter2-1","location":"/matlab/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-pivoting-stable","label":"demo-pivoting-stable","kind":"proof:example","position":{"start":{"line":951,"column":1},"end":{"line":951,"column":22}},"children":[{"type":"text","value":"Example ","key":"m1KhHgraXi"},{"type":"text","value":"2.6.6","key":"GTfk8E75jU"}],"template":"Example %s","enumerator":"2.6.6","resolved":true,"html_id":"demo-pivoting-stable","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"rpaVV8iWYx"}],"key":"LbJsBFeSNE"},{"type":"paragraph","position":{"start":{"line":952,"column":1},"end":{"line":952,"column":1}},"children":[{"type":"text","value":"We construct a linear system for this matrix with ","position":{"start":{"line":952,"column":1},"end":{"line":952,"column":1}},"key":"zJlftAbMN9"},{"type":"inlineMath","value":"\\epsilon=10^{-12}","position":{"start":{"line":952,"column":1},"end":{"line":952,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ϵ</mi><mo>=</mo><mn>1</mn><msup><mn>0</mn><mrow><mo>−</mo><mn>12</mn></mrow></msup></mrow><annotation encoding=\"application/x-tex\">\\epsilon=10^{-12}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">ϵ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">12</span></span></span></span></span></span></span></span></span></span></span></span>","key":"K34rYOGBA2"},{"type":"text","value":" and exact solution ","position":{"start":{"line":952,"column":1},"end":{"line":952,"column":1}},"key":"zyQTp15zw7"},{"type":"inlineMath","value":"[1, 1]","position":{"start":{"line":952,"column":1},"end":{"line":952,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[1, 1]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]</span></span></span></span>","key":"zkOGCPafr9"},{"type":"text","value":":","position":{"start":{"line":952,"column":1},"end":{"line":952,"column":1}},"key":"eWE3PZndiV"}],"key":"zlmhyNIsXG"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"ep = 1e-12\nA = [-ep 1; 1 -1];\nb = A * [1; 1];","key":"IeGGmK9OiA"},{"type":"output","id":"G6iq-P0mC9gMjesMhy8pG","data":[{"output_type":"execute_result","execution_count":97,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ep = 1.0000e-12</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ep = 1.0000e-12","content_type":"text/plain"}}}],"key":"TCVZD05Ekm"}],"data":{},"key":"GHZNdQgVD6"},{"type":"paragraph","position":{"start":{"line":960,"column":1},"end":{"line":960,"column":1}},"children":[{"type":"text","value":"We can factor the matrix without pivoting and solve for ","position":{"start":{"line":960,"column":1},"end":{"line":960,"column":1}},"key":"lsy0otuyf2"},{"type":"inlineMath","value":"\\mathbf{x}","position":{"start":{"line":960,"column":1},"end":{"line":960,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">x</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{x}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4444em;\"></span><span class=\"mord mathbf\">x</span></span></span></span>","key":"mzRopQiytP"},{"type":"text","value":".","position":{"start":{"line":960,"column":1},"end":{"line":960,"column":1}},"key":"pRBiX3RV1X"}],"key":"om5MBawq31"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[L, U] = lufact(A);\nx = backsub( U, forwardsub(L, b) )","key":"tBmDlHV87K"},{"type":"output","id":"haxz9oO1cCa-MnXZlu7VJ","data":[{"output_type":"execute_result","execution_count":98,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>x = 2×1 double\n    1.0000\n    1.0000\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"x = 2×1 double\n    1.0000\n    1.0000\n","content_type":"text/plain"}}}],"key":"Ru8BMlkMru"}],"data":{},"key":"zQU6pKE5BJ"},{"type":"paragraph","position":{"start":{"line":967,"column":1},"end":{"line":967,"column":1}},"children":[{"type":"text","value":"Note that we have obtained only about 5 accurate digits for ","position":{"start":{"line":967,"column":1},"end":{"line":967,"column":1}},"key":"PjTY8i3O2K"},{"type":"inlineMath","value":"x_1","position":{"start":{"line":967,"column":1},"end":{"line":967,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">x_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"d9JNGGUoSe"},{"type":"text","value":". We could make the result even more inaccurate by making ","position":{"start":{"line":967,"column":1},"end":{"line":967,"column":1}},"key":"hacKIcjq8L"},{"type":"text","value":"ε","position":{"start":{"line":967,"column":1},"end":{"line":967,"column":1}},"key":"HGMia840XH"},{"type":"text","value":" even smaller:","position":{"start":{"line":967,"column":1},"end":{"line":967,"column":1}},"key":"FpI80lC2Hj"}],"key":"yx08j3JG9Y"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"ep = 1e-20; A = [-ep 1; 1 -1];\nb = A * [1; 1];\n[L, U] = lufact(A);\nx = backsub( U, forwardsub(L, b) )","key":"mGfKnrN0m4"},{"type":"output","id":"9OcynzahZGlDSyVZRxCF_","data":[{"output_type":"execute_result","execution_count":99,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>x = 2×1 double\n     0\n     1\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"x = 2×1 double\n     0\n     1\n","content_type":"text/plain"}}}],"key":"Vp8735OV8I"}],"data":{},"key":"l27qjvQI7p"},{"type":"paragraph","position":{"start":{"line":976,"column":1},"end":{"line":976,"column":1}},"children":[{"type":"text","value":"This effect is not due to ill conditioning of the problem—a solution with PLU factorization works perfectly:","position":{"start":{"line":976,"column":1},"end":{"line":976,"column":1}},"key":"IohWtROR18"}],"key":"NO0sfWDmts"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A \\ b","key":"nkxEOha7wn"},{"type":"output","id":"SwebzqS2ESbnjodNsICOU","data":[{"output_type":"execute_result","execution_count":100,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = 2×1 double\n     1\n     1\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = 2×1 double\n     1\n     1\n","content_type":"text/plain"}}}],"key":"weVtQIndix"}],"data":{},"key":"L5hPe4xBVL"}],"key":"LyRByvgxUF"}],"key":"wj7wnBOME9"}],"key":"LOPExEopqO"},{"type":"tabItem","title":"Python","sync":"python","children":[{"type":"embed","source":{"url":"/chapter2-2","label":"demo-pivoting-stable-python","kind":"Notebook","slug":"chapter2-2","location":"/python/chapter2.md","title":"Chapter 2"},"children":[{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-pivoting-stable","label":"demo-pivoting-stable","kind":"proof:example","position":{"start":{"line":941,"column":1},"end":{"line":941,"column":22}},"children":[{"type":"text","value":"Example ","key":"Q6ag6kPZCJ"},{"type":"text","value":"2.6.6","key":"duc2raU4QB"}],"template":"Example %s","enumerator":"2.6.6","resolved":true,"html_id":"demo-pivoting-stable","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"PBs8bZZlMG"}],"key":"HWPyUkqEIZ"},{"type":"paragraph","position":{"start":{"line":942,"column":1},"end":{"line":942,"column":1}},"children":[{"type":"text","value":"We construct a linear system for this matrix with ","position":{"start":{"line":942,"column":1},"end":{"line":942,"column":1}},"key":"zfBEyvS9Qd"},{"type":"inlineMath","value":"\\epsilon=10^{-12}","position":{"start":{"line":942,"column":1},"end":{"line":942,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ϵ</mi><mo>=</mo><mn>1</mn><msup><mn>0</mn><mrow><mo>−</mo><mn>12</mn></mrow></msup></mrow><annotation encoding=\"application/x-tex\">\\epsilon=10^{-12}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">ϵ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">12</span></span></span></span></span></span></span></span></span></span></span></span>","key":"qy51LYl4P6"},{"type":"text","value":" and exact solution ","position":{"start":{"line":942,"column":1},"end":{"line":942,"column":1}},"key":"ARzjTGXWB3"},{"type":"inlineMath","value":"[1,1]","position":{"start":{"line":942,"column":1},"end":{"line":942,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[1,1]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]</span></span></span></span>","key":"q4zV0Gt3MU"},{"type":"text","value":":","position":{"start":{"line":942,"column":1},"end":{"line":942,"column":1}},"key":"Gpc4EBgGnd"}],"key":"VwN7HxQHS4"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ep = 1e-12\nA = array([[-ep, 1], [1, -1]])\nb = A @ array([1, 1])","key":"ajRTkzGwCj"},{"type":"output","id":"daVrKg226VyCcmXzw8nnm","data":[],"key":"wXXJeHd2Rj"}],"data":{},"key":"K5f4R2vXIa"},{"type":"paragraph","position":{"start":{"line":950,"column":1},"end":{"line":950,"column":1}},"children":[{"type":"text","value":"We can factor the matrix without pivoting and solve for ","position":{"start":{"line":950,"column":1},"end":{"line":950,"column":1}},"key":"uI6uCmYSj6"},{"type":"inlineMath","value":"\\mathbf{x}","position":{"start":{"line":950,"column":1},"end":{"line":950,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">x</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{x}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4444em;\"></span><span class=\"mord mathbf\">x</span></span></span></span>","key":"i5wT1OrMwc"},{"type":"text","value":".","position":{"start":{"line":950,"column":1},"end":{"line":950,"column":1}},"key":"Y2errOgpv0"}],"key":"wIXAYofK7e"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"L, U = FNC.lufact(A)\nprint(FNC.backsub( U, FNC.forwardsub(L, b) ))","key":"NFHvyYeTPl"},{"type":"output","id":"6SwjW0phCMitmKq7a-WTV","data":[{"output_type":"stream","name":"stdout","text":"[0.99997788 1.        ]"},{"output_type":"stream","name":"stdout","text":"\n"}],"key":"fYCZyx2qQH"}],"data":{},"key":"FYlr4UIeyM"},{"type":"paragraph","position":{"start":{"line":957,"column":1},"end":{"line":957,"column":1}},"children":[{"type":"text","value":"Note that we have obtained only about 5 accurate digits for ","position":{"start":{"line":957,"column":1},"end":{"line":957,"column":1}},"key":"gBlQxUpHYv"},{"type":"inlineMath","value":"x_1","position":{"start":{"line":957,"column":1},"end":{"line":957,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">x_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"BPEuVygHfQ"},{"type":"text","value":". We could make the result even more inaccurate by making ","position":{"start":{"line":957,"column":1},"end":{"line":957,"column":1}},"key":"AWuAPr8Yol"},{"type":"text","value":"ε","position":{"start":{"line":957,"column":1},"end":{"line":957,"column":1}},"key":"eaQpP4p62V"},{"type":"text","value":" even smaller:","position":{"start":{"line":957,"column":1},"end":{"line":957,"column":1}},"key":"TD7LQi8IJf"}],"key":"H9NRqongW8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ep = 1e-20;\nA = array([[-ep, 1], [1, -1]])\nb = A @ array([1, 1])\nL, U = FNC.lufact(A)\nprint(FNC.backsub( U, FNC.forwardsub(L, b) ))","key":"UtKr4mlp7r"},{"type":"output","id":"Fie1ZDI1q2ju5f5UxUSxr","data":[{"output_type":"stream","name":"stdout","text":"[-0.  1.]\n"}],"key":"cRUAk868Cj"}],"data":{},"key":"JA06V4r1OZ"},{"type":"paragraph","position":{"start":{"line":967,"column":1},"end":{"line":967,"column":1}},"children":[{"type":"text","value":"This effect is not due to ill conditioning of the problem—a solution with PLU factorization works perfectly:","position":{"start":{"line":967,"column":1},"end":{"line":967,"column":1}},"key":"SvEuBA4Kiz"}],"key":"ivpQOxpQcz"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(linalg.solve(A, b))","key":"iFQKxtdtpX"},{"type":"output","id":"xCs9DtXyVBAjrmE9oRYHn","data":[{"output_type":"stream","name":"stdout","text":"[1. 1.]\n"}],"key":"obF7JcRVuv"}],"data":{},"key":"uI9h6VV1vt"}],"key":"h8QvzIROqX"}],"key":"ZlJRzJv47d"}],"key":"AD7VXCaZ4X"}],"key":"XEkxDeER2i"}],"label":"demo-pivoting-stable","identifier":"demo-pivoting-stable","html_id":"demo-pivoting-stable","enumerator":"2.6.6","key":"saZKnLEyPt"},{"type":"paragraph","position":{"start":{"line":247,"column":1},"end":{"line":247,"column":1}},"children":[{"type":"text","value":"The factors of this ","position":{"start":{"line":247,"column":1},"end":{"line":247,"column":1}},"key":"JSWBLhkYud"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":247,"column":1},"end":{"line":247,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"euq5ciVjhw"},{"type":"text","value":" without pivoting are found to be","position":{"start":{"line":247,"column":1},"end":{"line":247,"column":1}},"key":"c266qE55TT"}],"key":"CkYoyxjNxE"},{"type":"math","value":"  \\mathbf{L} = \n  \\begin{bmatrix}\n    1 & 0 \\\\ -\\epsilon^{-1} & 1 \n  \\end{bmatrix}, \\qquad \n  \\mathbf{U} = \n  \\begin{bmatrix}\n    -\\epsilon & 1 \\\\ 0 & \\epsilon^{-1}-1 \n  \\end{bmatrix}.","label":"plu-stab-LU","identifier":"plu-stab-lu","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi mathvariant=\"bold\">L</mi><mo>=</mo><mrow><mo fence=\"true\">[</mo><mtable rowspacing=\"0.16em\" columnalign=\"center center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>0</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><msup><mi>ϵ</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd></mtr></mtable><mo fence=\"true\">]</mo></mrow><mo separator=\"true\">,</mo><mspace width=\"2em\"/><mi mathvariant=\"bold\">U</mi><mo>=</mo><mrow><mo fence=\"true\">[</mo><mtable rowspacing=\"0.16em\" columnalign=\"center center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mi>ϵ</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><msup><mi>ϵ</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo>−</mo><mn>1</mn></mrow></mstyle></mtd></mtr></mtable><mo fence=\"true\">]</mo></mrow><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">  \\mathbf{L} = \n  \\begin{bmatrix}\n    1 &amp; 0 \\\\ -\\epsilon^{-1} &amp; 1 \n  \\end{bmatrix}, \\qquad \n  \\mathbf{U} = \n  \\begin{bmatrix}\n    -\\epsilon &amp; 1 \\\\ 0 &amp; \\epsilon^{-1}-1 \n  \\end{bmatrix}.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">L</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.4em;vertical-align:-0.95em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">[</span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord\"><span class=\"mord mathnormal\">ϵ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.95em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">0</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.95em;\"><span></span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">]</span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:2em;\"></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathbf\">U</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.4em;vertical-align:-0.95em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">[</span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord mathnormal\">ϵ</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.95em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">ϵ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.95em;\"><span></span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">]</span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">.</span></span></span></span></span>","enumerator":"2.6.3","html_id":"plu-stab-lu","key":"aQWFVjnOdz"},{"type":"paragraph","position":{"start":{"line":261,"column":1},"end":{"line":261,"column":1}},"children":[{"type":"text","value":"For reasons we will quantify in ","position":{"start":{"line":261,"column":1},"end":{"line":261,"column":1}},"key":"PF9QsZlCWQ"},{"type":"link","kind":"numref","identifier":"section-linsys-condition-number","label":"section-linsys-condition-number","url":"/condition-number","internal":true,"dataUrl":"/condition-number.json","children":[{"type":"text","value":"Conditioning of linear systems","key":"ih7g5BWrxD"}],"key":"PGrtMLTSzZ"},{"type":"text","value":", the solution of ","position":{"start":{"line":261,"column":1},"end":{"line":261,"column":1}},"key":"ic6DUADGX4"},{"type":"inlineMath","value":"\\mathbf{A}\\mathbf{x}=\\mathbf{b}","position":{"start":{"line":261,"column":1},"end":{"line":261,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi><mi mathvariant=\"bold\">x</mi><mo>=</mo><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}\\mathbf{x}=\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">Ax</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"hH5MGr2Uml"},{"type":"text","value":" is well-conditioned, but the problems of solving ","position":{"start":{"line":261,"column":1},"end":{"line":261,"column":1}},"key":"PrI1C9fUzW"},{"type":"inlineMath","value":"\\mathbf{L}\\mathbf{z}=\\mathbf{b}","position":{"start":{"line":261,"column":1},"end":{"line":261,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi><mi mathvariant=\"bold\">z</mi><mo>=</mo><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}\\mathbf{z}=\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">Lz</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"v1UcjOttWt"},{"type":"text","value":" and ","position":{"start":{"line":261,"column":1},"end":{"line":261,"column":1}},"key":"XWRXvvu1qR"},{"type":"inlineMath","value":"\\mathbf{U}\\mathbf{x}=\\mathbf{z}","position":{"start":{"line":261,"column":1},"end":{"line":261,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi><mi mathvariant=\"bold\">x</mi><mo>=</mo><mi mathvariant=\"bold\">z</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}\\mathbf{x}=\\mathbf{z}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">Ux</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4444em;\"></span><span class=\"mord mathbf\">z</span></span></span></span>","key":"ZRKDRp8XuH"},{"type":"text","value":" have condition numbers essentially ","position":{"start":{"line":261,"column":1},"end":{"line":261,"column":1}},"key":"SIHKrq3Msp"},{"type":"inlineMath","value":"1/\\epsilon^2","position":{"start":{"line":261,"column":1},"end":{"line":261,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mi mathvariant=\"normal\">/</mi><msup><mi>ϵ</mi><mn>2</mn></msup></mrow><annotation encoding=\"application/x-tex\">1/\\epsilon^2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord\">1/</span><span class=\"mord\"><span class=\"mord mathnormal\">ϵ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span>","key":"C6eqoJm3TZ"},{"type":"text","value":" each. Thus, for small ","position":{"start":{"line":261,"column":1},"end":{"line":261,"column":1}},"key":"TyG3HX9ddX"},{"type":"text","value":"ε","position":{"start":{"line":261,"column":1},"end":{"line":261,"column":1}},"key":"VdjMDEv9jt"},{"type":"text","value":", solution of the original linear system by unpivoted LU factorization is highly unstable.","position":{"start":{"line":261,"column":1},"end":{"line":261,"column":1}},"key":"ns0Z9qprab"}],"key":"e8ZXjlk3zG"},{"type":"paragraph","position":{"start":{"line":263,"column":1},"end":{"line":263,"column":1}},"children":[{"type":"text","value":"Somewhat surprisingly, solving ","position":{"start":{"line":263,"column":1},"end":{"line":263,"column":1}},"key":"fokYZ4Vz3Y"},{"type":"inlineMath","value":"\\mathbf{A}\\mathbf{x}=\\mathbf{b}","position":{"start":{"line":263,"column":1},"end":{"line":263,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi><mi mathvariant=\"bold\">x</mi><mo>=</mo><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}\\mathbf{x}=\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">Ax</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"NADUAUapRc"},{"type":"text","value":" via PLU factorization is technically also unstable. In fact, examples of unstable solutions are well-known, but they have been nonexistent in practice. While there is a lot of evidence and some reasoning about why this is the case, the situation is not completely understood. Yet PLU factorization remains the algorithm of choice for general linear systems.","position":{"start":{"line":263,"column":1},"end":{"line":263,"column":1}},"key":"OSY9xJl5Tu"}],"key":"WOII9a9px4"},{"type":"heading","depth":2,"position":{"start":{"line":265,"column":1},"end":{"line":265,"column":1}},"children":[{"type":"text","value":"Exercises","position":{"start":{"line":265,"column":1},"end":{"line":265,"column":1}},"key":"ZhGTRHBSRx"}],"identifier":"exercises","label":"Exercises","html_id":"exercises","implicit":true,"enumerator":"2.6.5","key":"O849eHA3s4"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":267,"column":1},"end":{"line":303,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":267,"column":1},"end":{"line":280,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":267,"column":1},"end":{"line":267,"column":1}},"children":[{"type":"text","value":"✍ Perform by hand the pivoted LU factorization of each matrix.","position":{"start":{"line":267,"column":1},"end":{"line":267,"column":1}},"key":"iF5sLQfQri"}],"key":"i69fwDs4up"},{"type":"paragraph","position":{"start":{"line":269,"column":1},"end":{"line":279,"column":1}},"children":[{"type":"strong","position":{"start":{"line":269,"column":1},"end":{"line":269,"column":1}},"children":[{"type":"text","value":"(a)","position":{"start":{"line":269,"column":1},"end":{"line":269,"column":1}},"key":"Zb5d2jRyvy"}],"key":"E4Hs4RVlmR"},{"type":"text","value":" ","position":{"start":{"line":269,"column":1},"end":{"line":269,"column":1}},"key":"cYIAh6NEhe"},{"type":"inlineMath","value":"\\quad \\displaystyle \\begin{bmatrix}\n 2 & 3 & 4 \\\\\n 4 & 5 & 10 \\\\\n 4 & 8 & 2\n \\end{bmatrix},\\qquad","position":{"start":{"line":269,"column":1},"end":{"line":269,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mspace width=\"1em\"/><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mo fence=\"true\">[</mo><mtable rowspacing=\"0.16em\" columnalign=\"center center center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>2</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>3</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>4</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>4</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>5</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>10</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>4</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>8</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>2</mn></mstyle></mtd></mtr></mtable><mo fence=\"true\">]</mo></mrow><mo separator=\"true\">,</mo><mspace width=\"2em\"/></mstyle></mrow><annotation encoding=\"application/x-tex\">\\quad \\displaystyle \\begin{bmatrix}\n 2 &amp; 3 &amp; 4 \\\\\n 4 &amp; 5 &amp; 10 \\\\\n 4 &amp; 8 &amp; 2\n \\end{bmatrix},\\qquad</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:3.6em;vertical-align:-1.55em;\"></span><span class=\"mspace\" style=\"margin-right:1em;\"></span><span class=\"minner\"><span class=\"mopen\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.05em;\"><span style=\"top:-2.25em;\"><span class=\"pstrut\" style=\"height:3.155em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎣</span></span></span><span style=\"top:-3.397em;\"><span class=\"pstrut\" style=\"height:3.155em;\"></span><span style=\"height:0.016em;width:0.6667em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.6667em' height='0.016em' style='width:0.6667em' viewBox='0 0 666.67 16' preserveAspectRatio='xMinYMin'><path d='M319 0 H403 V16 H319z M319 0 H403 V16 H319z'/></svg></span></span><span style=\"top:-4.05em;\"><span class=\"pstrut\" style=\"height:3.155em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎡</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.55em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.05em;\"><span style=\"top:-4.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">2</span></span></span><span style=\"top:-3.01em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">4</span></span></span><span style=\"top:-1.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">4</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.55em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.05em;\"><span style=\"top:-4.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">3</span></span></span><span style=\"top:-3.01em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">5</span></span></span><span style=\"top:-1.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">8</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.55em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.05em;\"><span style=\"top:-4.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">4</span></span></span><span style=\"top:-3.01em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">10</span></span></span><span style=\"top:-1.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.55em;\"><span></span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.05em;\"><span style=\"top:-2.25em;\"><span class=\"pstrut\" style=\"height:3.155em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎦</span></span></span><span style=\"top:-3.397em;\"><span class=\"pstrut\" style=\"height:3.155em;\"></span><span style=\"height:0.016em;width:0.6667em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.6667em' height='0.016em' style='width:0.6667em' viewBox='0 0 666.67 16' preserveAspectRatio='xMinYMin'><path d='M263 0 H347 V16 H263z M263 0 H347 V16 H263z'/></svg></span></span><span style=\"top:-4.05em;\"><span class=\"pstrut\" style=\"height:3.155em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎤</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.55em;\"><span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:2em;\"></span></span></span></span>","key":"PUpEPhrK66"},{"type":"text","value":"\n","position":{"start":{"line":269,"column":1},"end":{"line":269,"column":1}},"key":"s8L3ppwzQ3"},{"type":"strong","position":{"start":{"line":269,"column":1},"end":{"line":269,"column":1}},"children":[{"type":"text","value":"(b)","position":{"start":{"line":269,"column":1},"end":{"line":269,"column":1}},"key":"G1WnEBSU5f"}],"key":"EzkzRcdzuX"},{"type":"text","value":" ","position":{"start":{"line":269,"column":1},"end":{"line":269,"column":1}},"key":"U7GXkgWmLZ"},{"type":"inlineMath","value":"\\quad \\displaystyle \\begin{bmatrix}\n 1 & 4 & 5 & -5 \\\\\n -1 & 0 & -1 & -5 \\\\\n 1 & 3 & -1 & 2 \\\\\n 1 & -1 & 5 & -1 \n \\end{bmatrix}","position":{"start":{"line":269,"column":1},"end":{"line":269,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mspace width=\"1em\"/><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mo fence=\"true\">[</mo><mtable rowspacing=\"0.16em\" columnalign=\"center center center center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>4</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>5</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mn>5</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mn>1</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mn>1</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mn>5</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>3</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mn>1</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>2</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mn>1</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>5</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mn>1</mn></mrow></mstyle></mtd></mtr></mtable><mo fence=\"true\">]</mo></mrow></mstyle></mrow><annotation encoding=\"application/x-tex\">\\quad \\displaystyle \\begin{bmatrix}\n 1 &amp; 4 &amp; 5 &amp; -5 \\\\\n -1 &amp; 0 &amp; -1 &amp; -5 \\\\\n 1 &amp; 3 &amp; -1 &amp; 2 \\\\\n 1 &amp; -1 &amp; 5 &amp; -1 \n \\end{bmatrix}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:4.8001em;vertical-align:-2.15em;\"></span><span class=\"mspace\" style=\"margin-right:1em;\"></span><span class=\"minner\"><span class=\"mopen\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.65em;\"><span style=\"top:-1.711em;\"><span class=\"pstrut\" style=\"height:3.216em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎣</span></span></span><span style=\"top:-2.858em;\"><span class=\"pstrut\" style=\"height:3.216em;\"></span><span style=\"height:1.216em;width:0.6667em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.6667em' height='1.216em' style='width:0.6667em' viewBox='0 0 666.67 1216' preserveAspectRatio='xMinYMin'><path d='M319 0 H403 V1216 H319z M319 0 H403 V1216 H319z'/></svg></span></span><span style=\"top:-4.7111em;\"><span class=\"pstrut\" style=\"height:3.216em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎡</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.65em;\"><span style=\"top:-4.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord\">1</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span><span style=\"top:-1.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.15em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.65em;\"><span style=\"top:-4.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">4</span></span></span><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">0</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">3</span></span></span><span style=\"top:-1.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.15em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.65em;\"><span style=\"top:-4.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">5</span></span></span><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord\">1</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord\">1</span></span></span><span style=\"top:-1.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">5</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.15em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.65em;\"><span style=\"top:-4.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord\">5</span></span></span><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord\">5</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">2</span></span></span><span style=\"top:-1.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.15em;\"><span></span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.65em;\"><span style=\"top:-1.711em;\"><span class=\"pstrut\" style=\"height:3.216em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎦</span></span></span><span style=\"top:-2.858em;\"><span class=\"pstrut\" style=\"height:3.216em;\"></span><span style=\"height:1.216em;width:0.6667em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.6667em' height='1.216em' style='width:0.6667em' viewBox='0 0 666.67 1216' preserveAspectRatio='xMinYMin'><path d='M263 0 H347 V1216 H263z M263 0 H347 V1216 H263z'/></svg></span></span><span style=\"top:-4.7111em;\"><span class=\"pstrut\" style=\"height:3.216em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎤</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.15em;\"><span></span></span></span></span></span></span></span></span></span></span>","key":"FoEqg0JOaf"},{"type":"text","value":".","position":{"start":{"line":269,"column":1},"end":{"line":269,"column":1}},"key":"j1Ujw7HvAp"}],"key":"qXfNPghCos"}],"key":"esQzPqlY61"},{"type":"listItem","spread":true,"position":{"start":{"line":281,"column":1},"end":{"line":295,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":281,"column":1},"end":{"line":281,"column":1}},"children":[{"type":"text","value":"✍ Let ","position":{"start":{"line":281,"column":1},"end":{"line":281,"column":1}},"key":"BWbWzxz9aT"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":281,"column":1},"end":{"line":281,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"FB9zhFzezW"},{"type":"text","value":" be a square matrix and ","position":{"start":{"line":281,"column":1},"end":{"line":281,"column":1}},"key":"unx1H3Y1gs"},{"type":"inlineMath","value":"\\mathbf{b}","position":{"start":{"line":281,"column":1},"end":{"line":281,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"s1Ee3JOmkn"},{"type":"text","value":" be a column vector of compatible length. Here is correct Julia code to solve ","position":{"start":{"line":281,"column":1},"end":{"line":281,"column":1}},"key":"gTUMN4S7gV"},{"type":"inlineMath","value":"\\mathbf{A}\\mathbf{x}=\\mathbf{b}","position":{"start":{"line":281,"column":1},"end":{"line":281,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi><mi mathvariant=\"bold\">x</mi><mo>=</mo><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}\\mathbf{x}=\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">Ax</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"ei3t57G9JR"},{"type":"text","value":":","position":{"start":{"line":281,"column":1},"end":{"line":281,"column":1}},"key":"LcwEdYXjd4"}],"key":"NQw2jrIjvn"},{"type":"code","lang":"julia","value":"L,U,p = lu(A)\nx = U \\ (L\\b[p])","position":{"start":{"line":283,"column":1},"end":{"line":286,"column":1}},"key":"F3CifizVu7"},{"type":"paragraph","position":{"start":{"line":288,"column":1},"end":{"line":288,"column":1}},"children":[{"type":"text","value":"Suppose instead you replace the last line above with","position":{"start":{"line":288,"column":1},"end":{"line":288,"column":1}},"key":"NeIr7C8I2K"}],"key":"XknZW1KvCK"},{"type":"code","lang":"julia","value":"x = U \\ L \\ b[p]","position":{"start":{"line":290,"column":1},"end":{"line":292,"column":1}},"key":"CXK5XJXe3U"},{"type":"paragraph","position":{"start":{"line":294,"column":1},"end":{"line":294,"column":1}},"children":[{"type":"text","value":"Mathematically in terms of ","position":{"start":{"line":294,"column":1},"end":{"line":294,"column":1}},"key":"WXySTflrBZ"},{"type":"inlineMath","value":"\\mathbf{L}","position":{"start":{"line":294,"column":1},"end":{"line":294,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">L</span></span></span></span>","key":"mfvPMFUJDu"},{"type":"text","value":", ","position":{"start":{"line":294,"column":1},"end":{"line":294,"column":1}},"key":"t71SfEj2Io"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":294,"column":1},"end":{"line":294,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"dUKC0vV7C8"},{"type":"text","value":", ","position":{"start":{"line":294,"column":1},"end":{"line":294,"column":1}},"key":"iqiIj3xJce"},{"type":"inlineMath","value":"\\mathbf{p}","position":{"start":{"line":294,"column":1},"end":{"line":294,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">p</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{p}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6389em;vertical-align:-0.1944em;\"></span><span class=\"mord mathbf\">p</span></span></span></span>","key":"Gz4XW6TWV3"},{"type":"text","value":", and ","position":{"start":{"line":294,"column":1},"end":{"line":294,"column":1}},"key":"sTwBj22A0x"},{"type":"inlineMath","value":"\\mathbf{b}","position":{"start":{"line":294,"column":1},"end":{"line":294,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"rXvPUdZGiS"},{"type":"text","value":", what vector is found?","position":{"start":{"line":294,"column":1},"end":{"line":294,"column":1}},"key":"w7Brv9YVih"}],"key":"Uy3DxzcVTB"}],"key":"kq0ZTLWNMc"},{"type":"listItem","spread":true,"position":{"start":{"line":296,"column":1},"end":{"line":303,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":296,"column":1},"end":{"line":296,"column":1}},"children":[{"type":"text","value":"✍ Suppose that ","position":{"start":{"line":296,"column":1},"end":{"line":296,"column":1}},"key":"azUk5cjkEe"},{"type":"inlineCode","value":"A","position":{"start":{"line":296,"column":1},"end":{"line":296,"column":1}},"key":"EYpCS7haRT"},{"type":"text","value":" is a ","position":{"start":{"line":296,"column":1},"end":{"line":296,"column":1}},"key":"px8w1Y8PXD"},{"type":"inlineMath","value":"4\\times 6","position":{"start":{"line":296,"column":1},"end":{"line":296,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>4</mn><mo>×</mo><mn>6</mn></mrow><annotation encoding=\"application/x-tex\">4\\times 6</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">4</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">6</span></span></span></span>","key":"mMODZpGQSG"},{"type":"text","value":" matrix in Julia and you define","position":{"start":{"line":296,"column":1},"end":{"line":296,"column":1}},"key":"am8I7Kz9C4"}],"key":"RSb6fzVJP9"},{"type":"code","lang":"julia","value":"B = A[end:-1:1,end:-1:1]","position":{"start":{"line":298,"column":1},"end":{"line":300,"column":1}},"key":"vsAeuDYGjt"},{"type":"paragraph","position":{"start":{"line":302,"column":1},"end":{"line":302,"column":1}},"children":[{"type":"text","value":"Show that ","position":{"start":{"line":302,"column":1},"end":{"line":302,"column":1}},"key":"Xi5GYAXh9A"},{"type":"inlineMath","value":"\\mathbf{B} = \\mathbf{P} \\mathbf{A} \\mathbf{Q}","position":{"start":{"line":302,"column":1},"end":{"line":302,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">B</mi><mo>=</mo><mi mathvariant=\"bold\">P</mi><mi mathvariant=\"bold\">A</mi><mi mathvariant=\"bold\">Q</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{B} = \\mathbf{P} \\mathbf{A} \\mathbf{Q}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">B</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8805em;vertical-align:-0.1944em;\"></span><span class=\"mord mathbf\">PAQ</span></span></span></span>","key":"JsthSB8Pal"},{"type":"text","value":" for certain matrices ","position":{"start":{"line":302,"column":1},"end":{"line":302,"column":1}},"key":"Hxo6ns8V9K"},{"type":"inlineMath","value":"\\mathbf{P}","position":{"start":{"line":302,"column":1},"end":{"line":302,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">P</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{P}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">P</span></span></span></span>","key":"y9l1S4lkcc"},{"type":"text","value":" and ","position":{"start":{"line":302,"column":1},"end":{"line":302,"column":1}},"key":"d1nHLZmosp"},{"type":"inlineMath","value":"\\mathbf{Q}","position":{"start":{"line":302,"column":1},"end":{"line":302,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">Q</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{Q}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8805em;vertical-align:-0.1944em;\"></span><span class=\"mord mathbf\">Q</span></span></span></span>","key":"MNbS74gHVP"},{"type":"text","value":".","position":{"start":{"line":302,"column":1},"end":{"line":302,"column":1}},"key":"Ti1MhQoIiq"}],"key":"LfdfuLJjgD"}],"key":"HlGc5xZ0Lf"}],"key":"aorDgZ2QFA"},{"type":"list","ordered":true,"start":4,"spread":false,"position":{"start":{"line":305,"column":1},"end":{"line":315,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":305,"column":1},"end":{"line":315,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":1}},"children":[{"type":"text","value":"✍ An ","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":1}},"key":"wJQHVzgl4a"},{"type":"inlineMath","value":"n\\times n","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>×</mo><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n\\times n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"LuD4pm7CUK"},{"type":"text","value":" ","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":1}},"key":"wam4DMuQrY"},{"type":"emphasis","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":1}},"children":[{"type":"text","value":"permutation matrix","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":1}},"key":"HJVURY7vVR"}],"key":"Bgk8sF5tUQ"},{"type":"text","value":" ","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":1}},"key":"ZxxcIqlOxm"},{"type":"inlineMath","value":"\\mathbf{P}","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">P</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{P}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">P</span></span></span></span>","key":"JDEV2xLvpP"},{"type":"text","value":" is a reordering of the rows of an identity matrix such that ","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":1}},"key":"SEpdPglfF2"},{"type":"inlineMath","value":"\\mathbf{P} \\mathbf{A}","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">P</mi><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{P} \\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">PA</span></span></span></span>","key":"l88aH431TN"},{"type":"text","value":"  has the effect of moving rows ","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":1}},"key":"PKbDbvKFyC"},{"type":"inlineMath","value":"1,2,\\ldots,n","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mo separator=\"true\">,</mo><mn>2</mn><mo separator=\"true\">,</mo><mo>…</mo><mo separator=\"true\">,</mo><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">1,2,\\ldots,n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8389em;vertical-align:-0.1944em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">2</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"P4gscZBRKT"},{"type":"text","value":" of ","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":1}},"key":"iCACDwTdF6"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"OGGGBxhAJl"},{"type":"text","value":" to new positions ","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":1}},"key":"LPOR5glc2D"},{"type":"inlineMath","value":"i_1,i_2,\\ldots,i_n","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>i</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><msub><mi>i</mi><mn>2</mn></msub><mo separator=\"true\">,</mo><mo>…</mo><mo separator=\"true\">,</mo><msub><mi>i</mi><mi>n</mi></msub></mrow><annotation encoding=\"application/x-tex\">i_1,i_2,\\ldots,i_n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"YHQi0zzSqe"},{"type":"text","value":". Then ","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":1}},"key":"L4bageVjqT"},{"type":"inlineMath","value":"\\mathbf{P}","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">P</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{P}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">P</span></span></span></span>","key":"hTOlXUWEoP"},{"type":"text","value":" can be expressed as","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":1}},"key":"vNUYlWcgCc"}],"key":"Y6vMqTY2Mc"},{"type":"math","value":"\\mathbf{P} = \\mathbf{e}_{i_1}\\mathbf{e}_1^T + \\mathbf{e}_{i_2}\\mathbf{e}_2^T + \\cdots + \\mathbf{e}_{i_n}\\mathbf{e}_n^T.","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi mathvariant=\"bold\">P</mi><mo>=</mo><msub><mi mathvariant=\"bold\">e</mi><msub><mi>i</mi><mn>1</mn></msub></msub><msubsup><mi mathvariant=\"bold\">e</mi><mn>1</mn><mi>T</mi></msubsup><mo>+</mo><msub><mi mathvariant=\"bold\">e</mi><msub><mi>i</mi><mn>2</mn></msub></msub><msubsup><mi mathvariant=\"bold\">e</mi><mn>2</mn><mi>T</mi></msubsup><mo>+</mo><mo>⋯</mo><mo>+</mo><msub><mi mathvariant=\"bold\">e</mi><msub><mi>i</mi><mi>n</mi></msub></msub><msubsup><mi mathvariant=\"bold\">e</mi><mi>n</mi><mi>T</mi></msubsup><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{P} = \\mathbf{e}_{i_1}\\mathbf{e}_1^T + \\mathbf{e}_{i_2}\\mathbf{e}_2^T + \\cdots + \\mathbf{e}_{i_n}\\mathbf{e}_n^T.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">P</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1414em;vertical-align:-0.2501em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">e</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3173em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2501em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathbf\">e</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913em;\"><span style=\"top:-2.453em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1414em;vertical-align:-0.2501em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">e</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3173em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2501em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathbf\">e</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913em;\"><span style=\"top:-2.453em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"minner\">⋯</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1414em;vertical-align:-0.2501em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">e</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1645em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2501em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathbf\">e</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913em;\"><span style=\"top:-2.453em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span><span class=\"mord\">.</span></span></span></span></span>","enumerator":"2.6.4","key":"y6LYRFIQOo"},{"type":"paragraph","position":{"start":{"line":311,"column":1},"end":{"line":311,"column":1}},"children":[{"type":"strong","position":{"start":{"line":311,"column":1},"end":{"line":311,"column":1}},"children":[{"type":"text","value":"(a)","position":{"start":{"line":311,"column":1},"end":{"line":311,"column":1}},"key":"NOLKESWy7o"}],"key":"IIShYP6uka"},{"type":"text","value":" For the case ","position":{"start":{"line":311,"column":1},"end":{"line":311,"column":1}},"key":"a7kkjLbvsB"},{"type":"inlineMath","value":"n=4","position":{"start":{"line":311,"column":1},"end":{"line":311,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>=</mo><mn>4</mn></mrow><annotation encoding=\"application/x-tex\">n=4</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">4</span></span></span></span>","key":"DeXboIomtA"},{"type":"text","value":" and ","position":{"start":{"line":311,"column":1},"end":{"line":311,"column":1}},"key":"Y6si18hPlf"},{"type":"inlineMath","value":"i_1=3","position":{"start":{"line":311,"column":1},"end":{"line":311,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>i</mi><mn>1</mn></msub><mo>=</mo><mn>3</mn></mrow><annotation encoding=\"application/x-tex\">i_1=3</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8095em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">3</span></span></span></span>","key":"B6BuQr7GHp"},{"type":"text","value":", ","position":{"start":{"line":311,"column":1},"end":{"line":311,"column":1}},"key":"ZC4PJpKQD7"},{"type":"inlineMath","value":"i_2=2","position":{"start":{"line":311,"column":1},"end":{"line":311,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>i</mi><mn>2</mn></msub><mo>=</mo><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">i_2=2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8095em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span></span></span></span>","key":"H7Tb6PXSJf"},{"type":"text","value":", ","position":{"start":{"line":311,"column":1},"end":{"line":311,"column":1}},"key":"DGXlePIm4N"},{"type":"inlineMath","value":"i_3=4","position":{"start":{"line":311,"column":1},"end":{"line":311,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>i</mi><mn>3</mn></msub><mo>=</mo><mn>4</mn></mrow><annotation encoding=\"application/x-tex\">i_3=4</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8095em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">4</span></span></span></span>","key":"yGACeGEwcx"},{"type":"text","value":", ","position":{"start":{"line":311,"column":1},"end":{"line":311,"column":1}},"key":"IjIpbhQy6Q"},{"type":"inlineMath","value":"i_4=1","position":{"start":{"line":311,"column":1},"end":{"line":311,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>i</mi><mn>4</mn></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">i_4=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8095em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">4</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"N8XnsfJsPK"},{"type":"text","value":", write out separately, as matrices, all four of the terms in the sum. Then add them together to find ","position":{"start":{"line":311,"column":1},"end":{"line":311,"column":1}},"key":"K4Ui1zVTXM"},{"type":"inlineMath","value":"\\mathbf{P}","position":{"start":{"line":311,"column":1},"end":{"line":311,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">P</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{P}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">P</span></span></span></span>","key":"bDyfuF87UV"},{"type":"text","value":".","position":{"start":{"line":311,"column":1},"end":{"line":311,"column":1}},"key":"PAbh80IGPD"}],"key":"uvUi6Aayhs"},{"type":"paragraph","position":{"start":{"line":313,"column":1},"end":{"line":313,"column":1}},"children":[{"type":"strong","position":{"start":{"line":313,"column":1},"end":{"line":313,"column":1}},"children":[{"type":"text","value":"(b)","position":{"start":{"line":313,"column":1},"end":{"line":313,"column":1}},"key":"edEsUQiUtj"}],"key":"KGH8RNjGLD"},{"type":"text","value":" Use the formula in the general case to show that ","position":{"start":{"line":313,"column":1},"end":{"line":313,"column":1}},"key":"bvwxVO0bRC"},{"type":"inlineMath","value":"\\mathbf{P}^{-1}=\\mathbf{P}^T","position":{"start":{"line":313,"column":1},"end":{"line":313,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi mathvariant=\"bold\">P</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo>=</mo><msup><mi mathvariant=\"bold\">P</mi><mi>T</mi></msup></mrow><annotation encoding=\"application/x-tex\">\\mathbf{P}^{-1}=\\mathbf{P}^T</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">P</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8413em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">P</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span></span></span></span>","key":"NM2ZVnKjeY"},{"type":"text","value":".","position":{"start":{"line":313,"column":1},"end":{"line":313,"column":1}},"key":"qOVRjUtuJg"}],"key":"WowIg0oBSP"}],"key":"QHYGJ6Jnqs"}],"label":"problem-perminverse","identifier":"problem-perminverse","html_id":"problem-perminverse","key":"g2KvigyLzL"},{"type":"footnoteDefinition","identifier":"plu","label":"PLU","position":{"start":{"line":313,"column":1},"end":{"line":313,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"children":[{"type":"text","value":"Because unpivoted LU factorization is not useful, in practice the term ","position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"key":"cgLfx5EZrq"},{"type":"emphasis","position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"children":[{"type":"text","value":"LU factorization","position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"key":"s7EZLX9EbQ"}],"key":"MdxiH73aPw"},{"type":"text","value":" mostly refers to pivoted LU.","position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"key":"jxhaAY6ssT"}],"key":"Khd3XR5Cwb"}],"number":1,"enumerator":"1","key":"xFbrZ4jCER"}],"key":"VKSDnyP806"}],"key":"SOLFmaKBHp"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Efficiency of matrix computations","url":"/efficiency","group":"Preface"},"next":{"title":"Vector and matrix norms","url":"/norms","group":"Preface"}}},"domain":"http://localhost:3000"}