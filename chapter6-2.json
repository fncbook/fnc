{"version":2,"kind":"Notebook","sha256":"db546c5ea16139ba379a1a4fd323eba03c91574c1a000e32742f138abbbe78cd","slug":"chapter6-2","location":"/python/chapter6.md","dependencies":[],"frontmatter":{"title":"Chapter 6","numbering":{"heading_1":{"enabled":false},"heading_2":{"enabled":false},"heading_3":{"enabled":false},"heading_4":{"enabled":false},"heading_5":{"enabled":false},"heading_6":{"enabled":false},"title":{"offset":2}},"kernelspec":{"name":"python3","display_name":"Python 3","language":"python"},"content_includes_title":false,"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","TPBVP":"two-point boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"edit_url":"https://github.com/fncbook/fnc/blob/master/python/chapter6.md","exports":[{"format":"md","filename":"chapter6.md","url":"/build/chapter6-108802eb28dc347e05ed61f89ae75fa3.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Functions","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"C8cxZKnzvo"}],"identifier":"functions","label":"Functions","html_id":"functions","implicit":true,"key":"tpYHzPph4N"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Euler’s method for an initial-value problem","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"BrdqVKvLXy"}],"key":"rMcA53HOAD"},{"type":"include","file":"fncbook/fncbook/chapter06.py","literal":true,"filter":{"startAt":"def euler","endAt":"return t"},"children":[{"type":"code","value":"def euler(du_dt, tspan, u0, n):\n    \"\"\"\n    euler(du_dt, tspan, u0, n)\n\n    Apply Euler's method to solve the IVP u'=du_dt(u,t) over the interval tspan with\n    u(tspan[1])=u0, using n subintervals/steps. Return vectors of times and solution\n    values.\n    \"\"\"\n    a, b = tspan\n    h = (b - a) / n\n    t = np.linspace(a, b, n+1)\n    u = np.tile(np.array(u0), (n+1, 1))\n    for i in range(n):\n        u[i+1] = u[i] + h * du_dt(t[i], u[i])\n\n    return t, u.T","lang":"python","showLineNumbers":true,"filename":"euler.py","key":"SZm7uDOQaZ"}],"key":"EhGXLntvh4"}],"label":"function-euler-python","identifier":"function-euler-python","html_id":"function-euler-python","key":"JRj6bpRHPc"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Improved Euler method for an ","key":"mPhXMTbPL6"},{"type":"abbreviation","title":"initial-value problem","children":[{"type":"text","value":"IVP","key":"qETnu38nTr"}],"key":"KmwTY5FCaZ"}],"key":"y0DER7VDn1"},{"type":"include","file":"fncbook/fncbook/chapter06.py","literal":true,"filter":{"startAt":"def ie2","endAt":"return t"},"children":[{"type":"code","value":"def ie2(du_dt, tspan, u0, n):\n    \"\"\"\n    ie2(du_dt, tspan, u0, n)\n\n    Apply the Improved Euler method to solve the vector-valued IVP u'=du_dt(u,p,t) over the\n    interval tspan with u(tspan[1])=u0, using n subintervals/steps. Returns a vector\n    of times and a vector of solution values/vectors.\n    \"\"\"\n    # Time discretization.\n    a, b = tspan\n    h = (b - a) / n\n    t = np.linspace(a, b, n + 1)\n\n    # Initialize output.\n    u = np.tile(np.array(u0), (n+1, 1))\n\n    # Time stepping.\n    for i in range(n):\n        uhalf = u[i] + h / 2 * du_dt(t[i], u[i])\n        u[i+1] = u[i] + h * du_dt(t[i] + h / 2, uhalf)\n\n    return t, u.T","lang":"python","showLineNumbers":true,"filename":"ie2.py","key":"AX7L0i25gc"}],"key":"kH7JxmY68C"}],"label":"function-ie2-python","identifier":"function-ie2-python","html_id":"function-ie2-python","key":"mW4BmePuhC"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Fourth-order Runge-Kutta for an ","key":"JjQ45kzF6R"},{"type":"abbreviation","title":"initial-value problem","children":[{"type":"text","value":"IVP","key":"JFpOc5wDlq"}],"key":"MjxqYayJ3X"}],"key":"SJjBijtv11"},{"type":"include","file":"fncbook/fncbook/chapter06.py","literal":true,"filter":{"startAt":"def rk4","endAt":"return t"},"children":[{"type":"code","value":"def rk4(du_dt, tspan, u0, n):\n    \"\"\"\n    rk4(du_dt, tspan, u0, n)\n\n    Apply \"the\" Runge-Kutta 4th order method to solve the vector-valued IVP u'=du_dt(u,p,t)\n    over the interval tspan with u(tspan[1])=u0, using n subintervals/steps.\n    Return a vector of times and a vector of solution values/vectors.\n    \"\"\"\n    # Time discretization.\n    a, b = tspan\n    h = (b - a) / n\n    t = np.linspace(a, b, n + 1)\n\n    # Initialize output.\n    u = np.tile(np.array(u0), (n+1, 1))\n\n    # Time stepping.\n    for i in range(n):\n        k1 = h * du_dt(t[i], u[i])\n        k2 = h * du_dt(t[i] + h / 2, u[i] + k1 / 2)\n        k3 = h * du_dt(t[i] + h / 2, u[i] + k2 / 2)\n        k4 = h * du_dt(t[i] + h, u[i] + k3)\n        u[i+1] = u[i] + (k1 + 2 * (k2 + k3) + k4) / 6\n\n    return t, u.T","lang":"python","showLineNumbers":true,"filename":"rk4.py","key":"PijHxu4Bn0"}],"key":"zQV066qF8W"}],"label":"function-rk4-python","identifier":"function-rk4-python","html_id":"function-rk4-python","key":"A35SVNg9ro"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Adaptive ","key":"OnRAC9suBk"},{"type":"abbreviation","title":"initial-value problem","children":[{"type":"text","value":"IVP","key":"gWFcJ7QQ7z"}],"key":"IahoLN7wer"},{"type":"text","value":" solver based on embedded RK formulas","key":"DfSqWN7R7I"}],"key":"JwSmtyGG8I"},{"type":"include","file":"fncbook/fncbook/chapter06.py","literal":true,"filter":{"startAt":"def euler","endAt":"return"},"children":[{"type":"code","value":"def euler(du_dt, tspan, u0, n):\n    \"\"\"\n    euler(du_dt, tspan, u0, n)\n\n    Apply Euler's method to solve the IVP u'=du_dt(u,t) over the interval tspan with\n    u(tspan[1])=u0, using n subintervals/steps. Return vectors of times and solution\n    values.\n    \"\"\"\n    a, b = tspan\n    h = (b - a) / n\n    t = np.linspace(a, b, n+1)\n    u = np.tile(np.array(u0), (n+1, 1))\n    for i in range(n):\n        u[i+1] = u[i] + h * du_dt(t[i], u[i])\n\n    return t, u.T","lang":"python","showLineNumbers":true,"filename":"rk23.py","key":"JRKaqtCScS"}],"key":"NNChSMrGYG"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"About the code","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"gliwDptszA"}],"key":"nHSBAeMfHp"},{"type":"paragraph","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"children":[{"type":"text","value":"The check ","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"sfIuhFHeKP"},{"type":"inlineCode","value":"t[i]+h==t[i]","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"WRChgjfIXQ"},{"type":"text","value":"on line 19 is to detect when ","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"i7rDr0anAy"},{"type":"inlineMath","value":"h","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>h</mi></mrow><annotation encoding=\"application/x-tex\">h</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">h</span></span></span></span>","key":"ON5lDRxWZ7"},{"type":"text","value":" has become so small that it no longer changes the floating-point value of ","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"SlePN5wUu5"},{"type":"inlineMath","value":"t_i","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>t</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">t_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7651em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"m46m2sEr4O"},{"type":"text","value":". This may be a sign that the underlying exact solution has a singularity near ","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"wFt7IfDi0z"},{"type":"inlineMath","value":"t=t_i","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi><mo>=</mo><msub><mi>t</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">t=t_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7651em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"RZmG6r1TXw"},{"type":"text","value":", but in any case, the solver must halt by using a ","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"ripr8NMwWZ"},{"type":"inlineCode","value":"break","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"FT0LM1N1Ne"},{"type":"text","value":" statement to exit the loop.","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"MsLeJY1WVh"}],"key":"vy3uAnCf3y"},{"type":"paragraph","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"children":[{"type":"text","value":"On line 30, we use a combination of absolute and relative tolerances to judge the acceptability of a solution value, as in ","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"key":"RL4FHn1AMo"},{"type":"crossReference","kind":"equation","identifier":"absreltolerance","label":"absreltolerance","children":[{"type":"text","value":"(","key":"tEA8h3kk97"},{"type":"text","value":"5.7.6","key":"f6KsRxWRW7"},{"type":"text","value":")","key":"FEPqP2C0Jg"}],"template":"(%s)","enumerator":"5.7.6","resolved":true,"html_id":"absreltolerance","remote":true,"url":"/adaptive","dataUrl":"/adaptive.json","key":"Z694OmWeTi"},{"type":"text","value":". In lines 41--43 we underestimate the step factor ","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"key":"iEouk1jxyp"},{"type":"inlineMath","value":"q","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>q</mi></mrow><annotation encoding=\"application/x-tex\">q</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span></span></span></span>","key":"vILyJpIV4U"},{"type":"text","value":" a bit and prevent a huge increase in the step size, since a rejected step is expensive, and then we make sure that our final step doesn’t take us past the end of the domain.","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"key":"C1VdR6c0Jl"}],"key":"YWR0Yutnip"},{"type":"paragraph","position":{"start":{"line":65,"column":1},"end":{"line":66,"column":1}},"children":[{"type":"text","value":"Finally, line 37 exploits a subtle property of the BS23 formula called ","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"gD5gZT4kFH"},{"type":"emphasis","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"children":[{"type":"text","value":"first same as last","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"mshkThsCpX"}],"key":"o7B13gUnfS"},{"type":"text","value":" (FSAL).\nWhile ","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"hgQKQrRSxA"},{"type":"crossReference","kind":"equation","identifier":"bs23","label":"bs23","children":[{"type":"text","value":"(","key":"n6Qb8t170c"},{"type":"text","value":"6.5.5","key":"iabnFQsccV"},{"type":"text","value":")","key":"daTXKpd590"}],"template":"(%s)","enumerator":"6.5.5","resolved":true,"html_id":"bs23","remote":true,"url":"/adaptive-rk","dataUrl":"/adaptive-rk.json","key":"AFUSizC1x6"},{"type":"text","value":" calls for four stages to find the paired second- and third-order estimates, the final stage computed in stepping from ","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"vMJMyh97dA"},{"type":"inlineMath","value":"t_i","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>t</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">t_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7651em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"CnLfilkl1P"},{"type":"text","value":" to ","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"OGLwrFGcmM"},{"type":"inlineMath","value":"t_{i+1}","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>t</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding=\"application/x-tex\">t_{i+1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8234em;vertical-align:-0.2083em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span></span></span></span>","key":"k0mBVcITiw"},{"type":"text","value":" is identical to the first stage needed to step from ","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"fgy6CWOfg6"},{"type":"inlineMath","value":"t_{i+1}","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>t</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding=\"application/x-tex\">t_{i+1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8234em;vertical-align:-0.2083em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span></span></span></span>","key":"ocfkU9o7xh"},{"type":"text","value":" to ","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"ygZkIvmNtq"},{"type":"inlineMath","value":"t_{i+2}","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>t</mi><mrow><mi>i</mi><mo>+</mo><mn>2</mn></mrow></msub></mrow><annotation encoding=\"application/x-tex\">t_{i+2}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8234em;vertical-align:-0.2083em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">2</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span></span></span></span>","key":"es5gy8MOwW"},{"type":"text","value":". By repurposing ","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"pneLCgsVH6"},{"type":"inlineCode","value":"s₄","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"J65WQioqqX"},{"type":"text","value":" as ","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"iUAtcyHACS"},{"type":"inlineCode","value":"s₁","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"Vf7OM3ttti"},{"type":"text","value":" for the next pass, one of the stage evaluations comes for free, and only three evaluations of ","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"HRoA49t1GF"},{"type":"inlineMath","value":"f","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>","key":"rq3sEzweKs"},{"type":"text","value":" are needed per successful step.","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"FMisBupAU8"}],"key":"mDQIwNXV4O"}],"class":"dropdown","key":"ErQOrhJgFf"}],"label":"function-rk23-python","identifier":"function-rk23-python","html_id":"function-rk23-python","key":"S11DksibHr"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"4th-order Adams–Bashforth formula for an ","key":"oU942uBoQF"},{"type":"abbreviation","title":"initial-value problem","children":[{"type":"text","value":"IVP","key":"XC0KBlqg28"}],"key":"YpuHfbpJpM"}],"key":"KRf38Z4ekR"},{"type":"include","file":"fncbook/fncbook/chapter06.py","literal":true,"filter":{"startAt":"def ab4","endAt":"return t"},"children":[{"type":"code","value":"def ab4(du_dt, tspan, u0, n):\n    \"\"\"\n    ab4(du_dt, tspan, u0, n)\n\n    Apply the Adams-Bashforth 4th order method to solve the vector-valued IVP u'=du_dt(u,p,t)\n    over the interval tspan with u(tspan[1])=u0, using n subintervals/steps.\n    \"\"\"\n    # Time discretization.\n    a, b = tspan\n    h = (b - a) / n\n    t = np.linspace(a, b, n + 1)\n\n    # Constants in the AB4 method.\n    k = 4\n    sigma = np.array([55, -59, 37, -9]) / 24\n\n    # Find starting values by RK4.\n    ts, us = rk4(du_dt, [a, a + (k - 1) * h], u0, k - 1)\n    u = np.tile(np.array(u0), (n+1, 1))\n    u[:k] = us[:k].T\n\n    # Compute history of u' values, from newest to oldest.\n    f = np.array([du_dt(t[k-j-2], u[k-j-2]) for j in range(k)])\n\n    # Time stepping.\n    for i in range(k-1, n):\n        f = np.vstack([du_dt(t[i], u[i]), f[:-1]])  # new value of du/dt\n        u[i+1] = u[i] + h * np.dot(sigma, f)  # advance one step\n\n    return t, u.T","lang":"python","showLineNumbers":true,"filename":"ab4.py","key":"xfD2XBFNdz"}],"key":"Pn91d2D0zA"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"About the code","position":{"start":{"line":81,"column":1},"end":{"line":81,"column":1}},"key":"tsVyjfTYcl"}],"key":"x6LCCAOuS8"},{"type":"paragraph","position":{"start":{"line":83,"column":1},"end":{"line":83,"column":1}},"children":[{"type":"text","value":"Line 15 sets ","position":{"start":{"line":83,"column":1},"end":{"line":83,"column":1}},"key":"gbHAnx1w3o"},{"type":"inlineCode","value":"σ","position":{"start":{"line":83,"column":1},"end":{"line":83,"column":1}},"key":"YtxVGHYY3Z"},{"type":"text","value":" to be the coefficients of the generating polynomial ","position":{"start":{"line":83,"column":1},"end":{"line":83,"column":1}},"key":"m2gu2YORmp"},{"type":"inlineMath","value":"\\sigma(z)","position":{"start":{"line":83,"column":1},"end":{"line":83,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>σ</mi><mo stretchy=\"false\">(</mo><mi>z</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\sigma(z)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"mclose\">)</span></span></span></span>","key":"tPqFUqz07q"},{"type":"text","value":" of AB4. Lines 19--21 set up the ","key":"WNxrWMf2a2"},{"type":"abbreviation","title":"initial-value problem","children":[{"type":"text","value":"IVP","key":"JzzEAjsgzj"}],"key":"kQD5DICXOg"},{"type":"text","value":" over the time interval ","key":"na9tkd5LBG"},{"type":"inlineMath","value":"a \\le t \\le a+3 h","position":{"start":{"line":83,"column":1},"end":{"line":83,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi><mo>≤</mo><mi>t</mi><mo>≤</mo><mi>a</mi><mo>+</mo><mn>3</mn><mi>h</mi></mrow><annotation encoding=\"application/x-tex\">a \\le t \\le a+3 h</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7719em;vertical-align:-0.136em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7719em;vertical-align:-0.136em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord\">3</span><span class=\"mord mathnormal\">h</span></span></span></span>","key":"iLlUkyE3Ly"},{"type":"text","value":", call ","position":{"start":{"line":83,"column":1},"end":{"line":83,"column":1}},"key":"IkhXTYk7zK"},{"type":"inlineCode","value":"rk4","position":{"start":{"line":83,"column":1},"end":{"line":83,"column":1}},"key":"V2gDY0Uzmy"},{"type":"text","value":" to solve it using the step size ","position":{"start":{"line":83,"column":1},"end":{"line":83,"column":1}},"key":"Z6nX8Z06pt"},{"type":"inlineMath","value":"h","position":{"start":{"line":83,"column":1},"end":{"line":83,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>h</mi></mrow><annotation encoding=\"application/x-tex\">h</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">h</span></span></span></span>","key":"jAVmbdEF5W"},{"type":"text","value":", and use the result to fill the first four values of the solution. Then line 24 computes the vector ","position":{"start":{"line":83,"column":1},"end":{"line":83,"column":1}},"key":"PRUaBRVJBI"},{"type":"inlineMath","value":"[f_2,f_1,f_0]","position":{"start":{"line":83,"column":1},"end":{"line":83,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><msub><mi>f</mi><mn>2</mn></msub><mo separator=\"true\">,</mo><msub><mi>f</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><msub><mi>f</mi><mn>0</mn></msub><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[f_2,f_1,f_0]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">]</span></span></span></span>","key":"yjV6rjUGDO"},{"type":"text","value":".","position":{"start":{"line":83,"column":1},"end":{"line":83,"column":1}},"key":"pmn09ZxZP5"}],"key":"IgGlRuyJ8X"},{"type":"paragraph","position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"children":[{"type":"text","value":"Line 28 computes ","position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"key":"GnIWRb28E6"},{"type":"inlineMath","value":"f_i","position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>f</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">f_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"HsLB4xMSyo"},{"type":"text","value":", based on the most recent solution value and time. That goes into the first spot of ","position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"key":"wu0kpetA9S"},{"type":"inlineCode","value":"f","position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"key":"ZuZzKYJtcO"},{"type":"text","value":", followed by the three values that were previously most recent. These are the four values that appear in ","position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"key":"jvYv0lnT5N"},{"type":"crossReference","kind":"equation","identifier":"ab4","label":"ab4","children":[{"type":"text","value":"(","key":"YpsK0MBPCY"},{"type":"text","value":"6.7.1","key":"pZazn6m6Si"},{"type":"text","value":")","key":"pvexf1cc8y"}],"template":"(%s)","enumerator":"6.7.1","resolved":true,"html_id":"ab4","remote":true,"url":"/implicit","dataUrl":"/implicit.json","key":"IfSx8y890w"},{"type":"text","value":". Each particular ","position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"key":"pXmjUsNCBn"},{"type":"inlineMath","value":"f_i","position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>f</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">f_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"F8BbCRKfvV"},{"type":"text","value":" value starts at the front of ","position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"key":"KOuAZ1RkCz"},{"type":"inlineCode","value":"f","position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"key":"IBeqGl4dmf"},{"type":"text","value":", moves through each position in the vector over three iterations, and then is forgotten.","position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"key":"JIhWKQcop6"}],"key":"pNVzY4Xone"}],"class":"dropdown","key":"FBLstdA7j1"}],"label":"function-ab4-python","identifier":"function-ab4-python","html_id":"function-ab4-python","key":"r6gRjiFgxD"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"2nd-order Adams–Moulton (trapezoid) formula for an ","key":"QIuTZEjHb0"},{"type":"abbreviation","title":"initial-value problem","children":[{"type":"text","value":"IVP","key":"YZsNPgpmkD"}],"key":"cuD73qqNQo"}],"key":"ALsphRFEKW"},{"type":"include","file":"fncbook/fncbook/chapter06.py","literal":true,"filter":{"startAt":"def am2","endAt":"return t"},"children":[{"type":"code","value":"def am2(du_dt, tspan, u0, n):\n    \"\"\"\n    am2(du_dt, tspan, u0, n)\n\n    Apply the Adams-Moulton 2nd order method to solve the vector-valued IVP u'=du_dt(u,p,t)\n    over the interval tspan with u(tspan[1])=u0, using n subintervals/steps.\n    \"\"\"\n    # Time discretization.\n    a, b = tspan\n    h = (b - a) / n\n    t = np.linspace(a, b, n + 1)\n\n    # Initialize output.\n    u = np.tile(np.array(u0), (n+1, 1))\n\n    # Time stepping.\n    for i in range(n):\n        # Data that does not depend on the new value.\n        known = u[i] + h / 2 * du_dt(t[i], u[i])\n        # Find a root for the new value.\n        F = lambda z: z - h / 2 * du_dt(t[i+1], z) - known\n        unew = levenberg(F, known)\n        u[i+1] = unew[-1]\n\n    return t, u.T","lang":"python","showLineNumbers":true,"filename":"am2.py","key":"aYxxQML3wQ"}],"key":"qmIGI66PnM"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"About the code","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"key":"F7qrC0mpvV"}],"key":"zkGJSQkBWw"},{"type":"paragraph","position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"children":[{"type":"text","value":"Lines 22-23 define the function ","position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"key":"lD3pmjoCkG"},{"type":"inlineMath","value":"\\mathbf{g}","position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">g</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{g}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6389em;vertical-align:-0.1944em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">g</span></span></span></span>","key":"BGPdFKg3aT"},{"type":"text","value":" and call ","position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"key":"H0TRm8OLQf"},{"type":"inlineCode","value":"levenberg","position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"key":"eYcpui5O5J"},{"type":"text","value":" to find the new solution value, using an Euler half-step as its starting value. A robust code would have to intercept the case where ","position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"key":"hoDTPjJvLw"},{"type":"inlineCode","value":"levenberg","position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"key":"Uq9Q7n5SGR"},{"type":"text","value":" fails to converge, but we have ignored this issue for the sake of brevity.","position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"key":"YgQ5oopRhq"}],"key":"o0d2o5WsH0"}],"class":"dropdown","key":"hTiu0qpWeo"}],"label":"function-am2-python","identifier":"function-am2-python","html_id":"function-am2-python","key":"S0buJbqTej"},{"type":"heading","depth":2,"position":{"start":{"line":105,"column":1},"end":{"line":105,"column":1}},"children":[{"type":"text","value":"Examples","position":{"start":{"line":105,"column":1},"end":{"line":105,"column":1}},"key":"jU00W3EyQv"}],"identifier":"examples","label":"Examples","html_id":"examples","implicit":true,"key":"pvZXAw4Nzh"}],"key":"OFZB9Nt6kd"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"exec(open(\"FNC_init.py\").read())","visibility":"show","key":"C0Kw96cL6c"},{"type":"output","id":"Ahd4MPSqUIfJSauA-MqXf","data":[],"visibility":"show","key":"aqyECfVkYc"}],"data":{"tags":[]},"visibility":"remove","key":"dEZ0r9nQZf"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":112,"column":1},"end":{"line":112,"column":1}},"children":[{"type":"text","value":"6.1 ","position":{"start":{"line":112,"column":1},"end":{"line":112,"column":1}},"key":"mQTvrL5weo"},{"type":"link","identifier":"section-ivp-basics","label":"section-ivp-basics","kind":"narrative","position":{"start":{"line":112,"column":5},"end":{"line":112,"column":24}},"url":"/basics","internal":true,"dataUrl":"/basics.json","children":[{"type":"text","value":"Basics of IVPs","key":"p0mFNRL4t0"}],"key":"EIvpHJzuW6"}],"identifier":"id-6-1","label":"6.1 ","html_id":"id-6-1","implicit":true,"key":"nzK2WoUuI0"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-basics-first","label":"demo-basics-first","kind":"proof:example","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":19}},"children":[{"type":"text","value":"Example ","key":"Rh46lvxREv"},{"type":"text","value":"6.1.2","key":"XKn8uZlBKf"}],"template":"Example %s","enumerator":"6.1.2","resolved":true,"html_id":"demo-basics-first","remote":true,"url":"/basics","dataUrl":"/basics.json","key":"AnsXDojrAq"}],"key":"ZI3e0fnTLu"},{"type":"paragraph","position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"children":[{"type":"text","value":"Let’s use ","position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"key":"W9mh7mCDVX"},{"type":"inlineCode","value":"solve_ivp","position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"key":"KM7ltByTcS"},{"type":"text","value":" from ","position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"key":"gcGF8TWrUi"},{"type":"inlineCode","value":"scipy.integrate","position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"key":"BOldyqA9qd"},{"type":"text","value":" to define and solve the initial-value problem","position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"key":"cIl2opivks"}],"key":"LQMkPbzMap"},{"type":"math","value":"u'=\\sin[(u+t)^2], \\quad t \\in [0,4], \\quad u(0)=-1.","enumerated":false,"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msup><mi>u</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo>=</mo><mi>sin</mi><mo>⁡</mo><mo stretchy=\"false\">[</mo><mo stretchy=\"false\">(</mo><mi>u</mi><mo>+</mo><mi>t</mi><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup><mo stretchy=\"false\">]</mo><mo separator=\"true\">,</mo><mspace width=\"1em\"/><mi>t</mi><mo>∈</mo><mo stretchy=\"false\">[</mo><mn>0</mn><mo separator=\"true\">,</mo><mn>4</mn><mo stretchy=\"false\">]</mo><mo separator=\"true\">,</mo><mspace width=\"1em\"/><mi>u</mi><mo stretchy=\"false\">(</mo><mn>0</mn><mo stretchy=\"false\">)</mo><mo>=</mo><mo>−</mo><mn>1.</mn></mrow><annotation encoding=\"application/x-tex\">u&#x27;=\\sin[(u+t)^2], \\quad t \\in [0,4], \\quad u(0)=-1.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8019em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8019em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop\">sin</span><span class=\"mopen\">[(</span><span class=\"mord mathnormal\">u</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1141em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mclose\">]</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:1em;\"></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">4</span><span class=\"mclose\">]</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:1em;\"></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">−</span><span class=\"mord\">1.</span></span></span></span></span>","key":"GjnV19KOsp"},{"type":"paragraph","position":{"start":{"line":124,"column":1},"end":{"line":124,"column":1}},"children":[{"type":"text","value":"To create an initial-value problem for ","position":{"start":{"line":124,"column":1},"end":{"line":124,"column":1}},"key":"Jnj6QynI5A"},{"type":"inlineMath","value":"u(t)","position":{"start":{"line":124,"column":1},"end":{"line":124,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">u(t)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span></span></span></span>","key":"Occ1xDlqWL"},{"type":"text","value":", we must supply a function that computes ","position":{"start":{"line":124,"column":1},"end":{"line":124,"column":1}},"key":"yKAswNijeX"},{"type":"inlineMath","value":"u'","position":{"start":{"line":124,"column":1},"end":{"line":124,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>u</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup></mrow><annotation encoding=\"application/x-tex\">u&#x27;</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span></span></span></span>","key":"F1htxDQ0uP"},{"type":"text","value":", an initial value for ","position":{"start":{"line":124,"column":1},"end":{"line":124,"column":1}},"key":"PhlwcI8oQw"},{"type":"inlineMath","value":"u","position":{"start":{"line":124,"column":1},"end":{"line":124,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span>","key":"YktwGKAY8H"},{"type":"text","value":", and the endpoints of the interval for ","position":{"start":{"line":124,"column":1},"end":{"line":124,"column":1}},"key":"wpB93gs7IP"},{"type":"inlineMath","value":"t","position":{"start":{"line":124,"column":1},"end":{"line":124,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span></span></span></span>","key":"N8JOFsOZ1t"},{"type":"text","value":".","position":{"start":{"line":124,"column":1},"end":{"line":124,"column":1}},"key":"CaJzqCYmYm"}],"key":"cw75fxfUPw"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"f = lambda t, u: sin((t + u) ** 2)\ntspan = [0.0, 4.0]\nu0 = array([-1.0])","key":"L66DVkndSD"},{"type":"output","id":"5opYzq1GDHlAfCYzgfdrX","data":[],"key":"EyfWggl87J"}],"indexEntries":[{"entry":"Python","subEntry":{"value":"solve_ivp","kind":"entry"},"emphasis":true}],"label":"index-NVWktFZNwF","identifier":"index-nvwktfznwf","html_id":"index-nvwktfznwf","key":"HcUdgqMlkq"},{"type":"paragraph","position":{"start":{"line":135,"column":1},"end":{"line":135,"column":1}},"children":[{"type":"text","value":"Note above that even though this is a problem for a scalar function ","position":{"start":{"line":135,"column":1},"end":{"line":135,"column":1}},"key":"OZUkDjzhSb"},{"type":"inlineMath","value":"u(t)","position":{"start":{"line":135,"column":1},"end":{"line":135,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">u(t)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span></span></span></span>","key":"ZPNO78ZXpF"},{"type":"text","value":", we had to set the initial condition as a one-component vector.","position":{"start":{"line":135,"column":1},"end":{"line":135,"column":1}},"key":"x1iLttNhtK"}],"key":"MyuK5KCjV8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from scipy.integrate import solve_ivp\nsol = solve_ivp(f, tspan, u0)","key":"upDPlNfW7D"},{"type":"output","id":"3IDFHYBeaWmEtX8uQqbGC","data":[],"key":"w9qNcPz9Tb"}],"key":"GGGZBYGxD5"},{"type":"paragraph","position":{"start":{"line":142,"column":1},"end":{"line":142,"column":1}},"children":[{"type":"text","value":"The resulting solution object has fields ","position":{"start":{"line":142,"column":1},"end":{"line":142,"column":1}},"key":"utRf5EVD5N"},{"type":"inlineCode","value":"t","position":{"start":{"line":142,"column":1},"end":{"line":142,"column":1}},"key":"whUvaI3NHI"},{"type":"text","value":" and ","position":{"start":{"line":142,"column":1},"end":{"line":142,"column":1}},"key":"q3deMfWLFb"},{"type":"inlineCode","value":"y","position":{"start":{"line":142,"column":1},"end":{"line":142,"column":1}},"key":"sSnoPUd1Cq"},{"type":"text","value":" that contain the values of the independent and dependent variables, respectively; those field names are the same regardless of what we use in our own codes.","position":{"start":{"line":142,"column":1},"end":{"line":142,"column":1}},"key":"vJWxhKrFDc"}],"key":"q2o3Iey20f"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(\"t shape:\", sol.t.shape)\nprint(\"u shape:\", sol.y.shape)\nplot(sol.t, sol.y[0, :], \"-o\")\nxlabel(\"$t$\"), ylabel(\"$u(t)$\")\ntitle((\"Solution of $u' = sin((t+u)^2)$\"));","key":"CXC7JRGrPJ"},{"type":"output","id":"6BRvvMBaYmQ8kFMh_WMZn","data":[{"output_type":"stream","name":"stdout","text":"t shape: (10,)\nu shape: (1, 10)\n"},{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"1bee89de54a85c83e0773510ef51feba","path":"/build/1bee89de54a85c83e0773510ef51feba.png"}}}],"key":"ggZmozktaS"}],"key":"Pb1vq8u5xz"},{"type":"paragraph","position":{"start":{"line":152,"column":1},"end":{"line":152,"column":1}},"children":[{"type":"text","value":"You can see above that the solution was not computed at enough points to make a smooth graph. There is a way to request output at times of your choosing.","position":{"start":{"line":152,"column":1},"end":{"line":152,"column":1}},"key":"aqr0ej3wT5"}],"key":"eWk56Pkc34"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"sol = solve_ivp(f, tspan, u0, t_eval=linspace(0, 4, 200))\nplot(sol.t, sol.y[0, :], \"-\")\nxlabel(\"$t$\"), ylabel(\"$u(t)$\")\ntitle((\"Solution of $u' = sin((t+u)^2)$\"));","key":"o7EYKanaGS"},{"type":"output","id":"g31S3J_YpxCND6J5vgXRP","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"f10022292b26ec30f7e4d668501fa54d","path":"/build/f10022292b26ec30f7e4d668501fa54d.png"}}}],"key":"mQbl7xTq75"}],"key":"TysdkI5M6Q"},{"type":"paragraph","position":{"start":{"line":161,"column":1},"end":{"line":161,"column":1}},"children":[{"type":"text","value":"Another option is to enable interpolation to evaluate the solution anywhere after the fact:","position":{"start":{"line":161,"column":1},"end":{"line":161,"column":1}},"key":"VmXAcWBMhF"}],"key":"FlbrIXxbtd"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"sol = solve_ivp(f, tspan, u0, dense_output=True)\nfor t in linspace(0, 4, 6):\n    print(f\"u({t:.2f}) = {sol.sol(t)[0]:.4f}\")","key":"pwgDTPsEGH"},{"type":"output","id":"3K9V4pyVcBFyVRN7cStSc","data":[{"output_type":"stream","name":"stdout","text":"u(0.00) = -1.0000\nu(0.80) = -0.8122\nu(1.60) = -0.6204\nu(2.40) = -0.4320\nu(3.20) = -1.1139\nu(4.00) = -1.8822\n"}],"key":"zPPaywewNX"}],"key":"BVgfg9EeNc"}],"label":"demo-basics-first-python","identifier":"demo-basics-first-python","html_id":"demo-basics-first-python","key":"aGqGXxC413"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-basics-sing","label":"demo-basics-sing","kind":"proof:example","position":{"start":{"line":171,"column":1},"end":{"line":171,"column":18}},"children":[{"type":"text","value":"Example ","key":"olFKk2hNO8"},{"type":"text","value":"6.1.3","key":"xYqTP2ZmE6"}],"template":"Example %s","enumerator":"6.1.3","resolved":true,"html_id":"demo-basics-sing","remote":true,"url":"/basics","dataUrl":"/basics.json","key":"XWLyALldmM"}],"key":"gBx6HoXepK"},{"type":"paragraph","position":{"start":{"line":174,"column":1},"end":{"line":174,"column":1}},"children":[{"type":"text","value":"The equation ","position":{"start":{"line":174,"column":1},"end":{"line":174,"column":1}},"key":"elEAU7howF"},{"type":"inlineMath","value":"u'=(u+t)^2","position":{"start":{"line":174,"column":1},"end":{"line":174,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>u</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo>=</mo><mo stretchy=\"false\">(</mo><mi>u</mi><mo>+</mo><mi>t</mi><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup></mrow><annotation encoding=\"application/x-tex\">u&#x27;=(u+t)^2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">u</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span>","key":"faJ94e0iQT"},{"type":"text","value":" gives us some trouble.","position":{"start":{"line":174,"column":1},"end":{"line":174,"column":1}},"key":"WaSgqxX5G7"}],"key":"hQVa9Wtn7Y"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"tIwHJYmQ3P"}],"key":"ROu8etJjcH"},{"type":"paragraph","position":{"start":{"line":177,"column":1},"end":{"line":177,"column":1}},"children":[{"type":"text","value":"It’s a good idea to check ","position":{"start":{"line":177,"column":1},"end":{"line":177,"column":1}},"key":"WNsNoZHqfw"},{"type":"inlineCode","value":"sol.success","position":{"start":{"line":177,"column":1},"end":{"line":177,"column":1}},"key":"EOIxrPcumJ"},{"type":"text","value":" after calling ","position":{"start":{"line":177,"column":1},"end":{"line":177,"column":1}},"key":"f61NHORQxR"},{"type":"inlineCode","value":"solve_ivp","position":{"start":{"line":177,"column":1},"end":{"line":177,"column":1}},"key":"hwlt7zJZbu"},{"type":"text","value":". If it’s ","position":{"start":{"line":177,"column":1},"end":{"line":177,"column":1}},"key":"FMCq8rIUlE"},{"type":"inlineCode","value":"False","position":{"start":{"line":177,"column":1},"end":{"line":177,"column":1}},"key":"fWNgRDgKl4"},{"type":"text","value":", the solution may not be reliable.","position":{"start":{"line":177,"column":1},"end":{"line":177,"column":1}},"key":"ng09drZrKR"}],"key":"aS3Fx1TXSP"}],"class":"dropdown","key":"CtoOMFbQkP"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"f = lambda t, u: (t + u) ** 2\nsol = solve_ivp(f, [0.0, 1.0], [1.0])\nif not sol.success:\n    print(sol.message)","key":"h4VMPZwidh"},{"type":"output","id":"AqZDBjWG_H094SlbeqnG9","data":[{"output_type":"stream","name":"stdout","text":"Required step size is less than spacing between numbers.\n"}],"key":"Dq1wp4gDm8"}],"key":"MRxCG3t8Pd"},{"type":"paragraph","position":{"start":{"line":187,"column":1},"end":{"line":187,"column":1}},"children":[{"type":"text","value":"The warning message we received can mean that there is a bug in the formulation of the problem. But if everything has been done correctly, it suggests that the solution may not exist past the indicated time. This is a possibility in nonlinear ","key":"MDPBBe77Sd"},{"type":"abbreviation","title":"ordinary differential equation","children":[{"type":"text","value":"ODE","key":"L8xhUyXIYS"}],"key":"aatHOlfUIO"},{"type":"text","value":"s.","key":"Fl1yXxSR1g"}],"key":"QeXbCnm05c"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"semilogy(sol.t, sol.y[0, :])\nxlabel(\"$t$\")\nylabel(\"$u(t)$\")\ntitle((\"Blowup in finite time\"));","key":"pBlOm22Hgn"},{"type":"output","id":"Vkvo4IquAPge3FmIm79iw","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"27eed1f19405358083c9f424122c99a0","path":"/build/27eed1f19405358083c9f424122c99a0.png"}}}],"key":"DQPPvTF2ZG"}],"key":"UrYEV23dxq"}],"label":"demo-basics-sing-python","identifier":"demo-basics-sing-python","html_id":"demo-basics-sing-python","key":"rvYhY2RWAE"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-basics-cond","label":"demo-basics-cond","kind":"proof:example","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":18}},"children":[{"type":"text","value":"Example ","key":"sbDFYWv7Yl"},{"type":"text","value":"6.1.5","key":"yIjrbSdUt3"}],"template":"Example %s","enumerator":"6.1.5","resolved":true,"html_id":"demo-basics-cond","remote":true,"url":"/basics","dataUrl":"/basics.json","key":"XGsKtKoXOT"}],"key":"x720RTB3IB"},{"type":"paragraph","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"children":[{"type":"text","value":"Consider the ","key":"EFZujWoaJd"},{"type":"abbreviation","title":"ordinary differential equation","children":[{"type":"text","value":"ODE","key":"iYz044WevT"}],"key":"M0rMjD8Ld9"},{"type":"text","value":"s ","key":"Ub36BOhiuF"},{"type":"inlineMath","value":"u'=u","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>u</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo>=</mo><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u&#x27;=u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span>","key":"BkDy9ie2Rb"},{"type":"text","value":" and ","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"key":"kYfpEA2vQf"},{"type":"inlineMath","value":"u'=-u","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>u</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo>=</mo><mo>−</mo><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u&#x27;=-u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord\">−</span><span class=\"mord mathnormal\">u</span></span></span></span>","key":"Qu4p9sTjW7"},{"type":"text","value":". In each case we compute ","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"key":"VVC6P3EcjT"},{"type":"inlineMath","value":"\\partial f/\\partial u = \\pm 1","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">∂</mi><mi>f</mi><mi mathvariant=\"normal\">/</mi><mi mathvariant=\"normal\">∂</mi><mi>u</mi><mo>=</mo><mo>±</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">\\partial f/\\partial u = \\pm 1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mord\">/</span><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">u</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">±</span><span class=\"mord\">1</span></span></span></span>","key":"dGvlYZ4Pzt"},{"type":"text","value":", so the condition number bound from ","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"key":"MlUmXbSA1m"},{"type":"crossReference","identifier":"theorem-depic","label":"theorem-depIC","kind":"proof:theorem","position":{"start":{"line":200,"column":131},"end":{"line":200,"column":145}},"children":[{"type":"text","value":"Theorem ","key":"wSxlgAOnmo"},{"type":"text","value":"6.1.2","key":"sBqWrwArQp"}],"template":"Theorem %s","enumerator":"6.1.2","resolved":true,"html_id":"theorem-depic","remote":true,"url":"/basics","dataUrl":"/basics.json","key":"mMzqDBMmVc"},{"type":"text","value":" is ","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"key":"kJ5xPRilHq"},{"type":"inlineMath","value":"e^{b-a}","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>e</mi><mrow><mi>b</mi><mo>−</mo><mi>a</mi></mrow></msup></mrow><annotation encoding=\"application/x-tex\">e^{b-a}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8491em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">b</span><span class=\"mbin mtight\">−</span><span class=\"mord mathnormal mtight\">a</span></span></span></span></span></span></span></span></span></span></span></span>","key":"sm0qG4TEtL"},{"type":"text","value":" in both problems. However, they behave quite differently. In the case of exponential growth, ","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"key":"tUteWkU0bo"},{"type":"inlineMath","value":"u'=u","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>u</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo>=</mo><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u&#x27;=u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span>","key":"R70cDrcIPN"},{"type":"text","value":", the bound is the actual condition number.","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"key":"J5TqWG5SNq"}],"key":"Zk3jnsOC4H"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"t = linspace(0, 3, 200)\nu = array([exp(t) * u0 for u0 in [0.7, 1, 1.3]])\nplot(t, u.T)\nxlabel(\"$t$\")\nylabel(\"$u(t)$\")\ntitle((\"Exponential divergence of solutions\"));","key":"deQZJ6mEzD"},{"type":"output","id":"q92dOvxcSVsn7igo6LgP_","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"53413f1cc522bd74a613d5373a40a137","path":"/build/53413f1cc522bd74a613d5373a40a137.png"}}}],"key":"e5I38J6fNL"}],"key":"NCyL4pwbiL"},{"type":"paragraph","position":{"start":{"line":211,"column":1},"end":{"line":211,"column":1}},"children":[{"type":"text","value":"But with ","position":{"start":{"line":211,"column":1},"end":{"line":211,"column":1}},"key":"r8D8V3svyE"},{"type":"inlineMath","value":"u'=-u","position":{"start":{"line":211,"column":1},"end":{"line":211,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>u</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo>=</mo><mo>−</mo><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u&#x27;=-u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord\">−</span><span class=\"mord mathnormal\">u</span></span></span></span>","key":"Vw5MccJtwq"},{"type":"text","value":", solutions actually get closer together with time.","position":{"start":{"line":211,"column":1},"end":{"line":211,"column":1}},"key":"vVPeXfjDTH"}],"key":"PMDZZnVBDd"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"t = linspace(0, 3, 200)\nu = array([exp(-t) * u0 for u0 in [0.7, 1, 1.3]])\nplot(t, u.T)\nxlabel(\"$t$\")\nylabel(\"$u(t)$\")\ntitle((\"Exponential convergence of solutions\"));","key":"sorqzgPT0x"},{"type":"output","id":"bPa7MFvwiANX0hieOu-m6","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"c2bfca5b9b65150e63ab7a5bccb36cbe","path":"/build/c2bfca5b9b65150e63ab7a5bccb36cbe.png"}}}],"key":"ZqY2ABnPJc"}],"key":"OTowgJFkPG"},{"type":"paragraph","position":{"start":{"line":222,"column":1},"end":{"line":222,"column":1}},"children":[{"type":"text","value":"In this case the actual condition number is one, because the initial difference between solutions is the largest over all time. Hence, the exponentially growing upper bound ","position":{"start":{"line":222,"column":1},"end":{"line":222,"column":1}},"key":"XtwYDKEDgy"},{"type":"inlineMath","value":"e^{b-a}","position":{"start":{"line":222,"column":1},"end":{"line":222,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>e</mi><mrow><mi>b</mi><mo>−</mo><mi>a</mi></mrow></msup></mrow><annotation encoding=\"application/x-tex\">e^{b-a}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8491em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">b</span><span class=\"mbin mtight\">−</span><span class=\"mord mathnormal mtight\">a</span></span></span></span></span></span></span></span></span></span></span></span>","key":"xrVtalBElr"},{"type":"text","value":" is a gross overestimate.","position":{"start":{"line":222,"column":1},"end":{"line":222,"column":1}},"key":"lDahCUDruN"}],"key":"wqMAemwVTw"}],"label":"demo-basics-cond-python","identifier":"demo-basics-cond-python","html_id":"demo-basics-cond-python","key":"dT57giojyo"},{"type":"heading","depth":3,"position":{"start":{"line":225,"column":1},"end":{"line":225,"column":1}},"children":[{"type":"text","value":"6.2 ","position":{"start":{"line":225,"column":1},"end":{"line":225,"column":1}},"key":"GtAgRYTlAa"},{"type":"link","identifier":"section-ivp-euler","label":"section-ivp-euler","kind":"narrative","position":{"start":{"line":225,"column":5},"end":{"line":225,"column":23}},"url":"/euler","internal":true,"dataUrl":"/euler.json","children":[{"type":"text","value":"Euler’s method","key":"npfDlscTM2"}],"key":"Kmh4a2XBkE"}],"identifier":"id-6-2","label":"6.2 ","html_id":"id-6-2","implicit":true,"key":"rm1NiLm2Rw"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-euler-converge","label":"demo-euler-converge","kind":"proof:example","position":{"start":{"line":227,"column":1},"end":{"line":227,"column":21}},"children":[{"type":"text","value":"Example ","key":"sAFcdZaquy"},{"type":"text","value":"6.2.1","key":"qGFnqrZo08"}],"template":"Example %s","enumerator":"6.2.1","resolved":true,"html_id":"demo-euler-converge","remote":true,"url":"/euler","dataUrl":"/euler.json","key":"gIi4F3sTRN"}],"key":"qu1Jhmrlef"},{"type":"paragraph","position":{"start":{"line":229,"column":1},"end":{"line":229,"column":1}},"children":[{"type":"text","value":"We consider the ","key":"t1vKQv290c"},{"type":"abbreviation","title":"initial-value problem","children":[{"type":"text","value":"IVP","key":"hKm4dLKS0c"}],"key":"y9zxQ9Isb1"}],"key":"tv8vr3qWcE"},{"type":"math","value":"u'=\\sin[(u+t)^2], \\quad t \\in [0,4], \\quad u(0)=-1.","enumerated":false,"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msup><mi>u</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo>=</mo><mi>sin</mi><mo>⁡</mo><mo stretchy=\"false\">[</mo><mo stretchy=\"false\">(</mo><mi>u</mi><mo>+</mo><mi>t</mi><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup><mo stretchy=\"false\">]</mo><mo separator=\"true\">,</mo><mspace width=\"1em\"/><mi>t</mi><mo>∈</mo><mo stretchy=\"false\">[</mo><mn>0</mn><mo separator=\"true\">,</mo><mn>4</mn><mo stretchy=\"false\">]</mo><mo separator=\"true\">,</mo><mspace width=\"1em\"/><mi>u</mi><mo stretchy=\"false\">(</mo><mn>0</mn><mo stretchy=\"false\">)</mo><mo>=</mo><mo>−</mo><mn>1.</mn></mrow><annotation encoding=\"application/x-tex\">u&#x27;=\\sin[(u+t)^2], \\quad t \\in [0,4], \\quad u(0)=-1.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8019em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8019em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop\">sin</span><span class=\"mopen\">[(</span><span class=\"mord mathnormal\">u</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1141em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mclose\">]</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:1em;\"></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">4</span><span class=\"mclose\">]</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:1em;\"></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">−</span><span class=\"mord\">1.</span></span></span></span></span>","key":"Why2Cr1EMx"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"f = lambda t, u: sin((t + u) ** 2)\ntspan = [0.0, 4.0]\nu0 = -1.0\nt, u = FNC.euler(f, tspan, u0, 20)\n\nfig, ax = subplots()\nax.plot(t, u[0, :], \"-o\", label=\"$n=20$\")\nxlabel(\"$t$\"), ylabel(\"$u(t)$\")\ntitle(\"Solution by Euler's method\")\nlegend();","key":"jgLkJQ6b6U"},{"type":"output","id":"T5A97l4wPCDL2zDWsF7Eh","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"947eff721e990f45cc6c1f80e6995f97","path":"/build/947eff721e990f45cc6c1f80e6995f97.png"}}}],"key":"tlZe1GpPl6"}],"key":"O6i1Qg1Cbj"},{"type":"paragraph","position":{"start":{"line":249,"column":1},"end":{"line":249,"column":1}},"children":[{"type":"text","value":"We could define a different interpolant to get a smoother picture above, but the derivation of Euler’s method assumed a piecewise linear interpolant, and that sets the limit of its accuracy. We can instead request more steps to make the interpolant look smoother.","position":{"start":{"line":249,"column":1},"end":{"line":249,"column":1}},"key":"IVrZxlFNbQ"}],"key":"lJo6Yxizmv"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"t, u = FNC.euler(f, tspan, u0, 200)\nax.plot(t, u[0, :], label=\"$n=200$\")\nax.legend()\nfig","key":"MI0XOvRPre"},{"type":"output","id":"h_WkbLyajJ3uUIPNc8xMK","data":[{"output_type":"execute_result","execution_count":12,"metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"ce88d95b69fd0c294872bd812e820f54","path":"/build/ce88d95b69fd0c294872bd812e820f54.png"}}}],"key":"GJ04KiIEZ0"}],"key":"tU7vjaYDaR"},{"type":"paragraph","position":{"start":{"line":258,"column":1},"end":{"line":258,"column":1}},"children":[{"type":"text","value":"Increasing ","position":{"start":{"line":258,"column":1},"end":{"line":258,"column":1}},"key":"b2iuOEBmpb"},{"type":"inlineMath","value":"n","position":{"start":{"line":258,"column":1},"end":{"line":258,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"KlEllBFpAK"},{"type":"text","value":" changed the solution noticeably. Since we know that interpolants and finite differences become more accurate as ","position":{"start":{"line":258,"column":1},"end":{"line":258,"column":1}},"key":"epL0UOJNna"},{"type":"inlineMath","value":"h\\to 0","position":{"start":{"line":258,"column":1},"end":{"line":258,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>h</mi><mo>→</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">h\\to 0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">h</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"aGtjnlCKgR"},{"type":"text","value":", we should anticipate the same behavior from Euler’s method. We don’t have an exact solution to compare to, so we will use ","position":{"start":{"line":258,"column":1},"end":{"line":258,"column":1}},"key":"KczmREMcQn"},{"type":"inlineCode","value":"solve_ivp","position":{"start":{"line":258,"column":1},"end":{"line":258,"column":1}},"key":"qaiZ5rQxu2"},{"type":"text","value":" to construct an accurate reference solution.","position":{"start":{"line":258,"column":1},"end":{"line":258,"column":1}},"key":"yhTTobuFRu"}],"key":"mnnvJBz0Nd"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from scipy.integrate import solve_ivp\nsol = solve_ivp(f, tspan, [u0], dense_output=True, atol=1e-8, rtol=1e-8)\nax.plot(t, sol.sol(t)[0, :], \"--\", label=\"accurate\")\nax.legend()\nfig","key":"OfzOtKdTRf"},{"type":"output","id":"-3FgEfdj8XIQcXTwDd6o3","data":[{"output_type":"execute_result","execution_count":13,"metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"dc8ebf35cbc97d1c3d84147d78a421f0","path":"/build/dc8ebf35cbc97d1c3d84147d78a421f0.png"}}}],"key":"o0qLFMQ1vo"}],"key":"YatHdH28dW"},{"type":"paragraph","position":{"start":{"line":268,"column":1},"end":{"line":268,"column":1}},"children":[{"type":"text","value":"Now we can perform a convergence study.","position":{"start":{"line":268,"column":1},"end":{"line":268,"column":1}},"key":"YFS7ar3Ipu"}],"key":"URgMbHAWvW"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"n_ = array([int(5 * 10**k) for k in arange(0, 3, 0.5)])\nerr_ = zeros(6)\nresults = PrettyTable([\"n\", \"error\"])\nfor j, n in enumerate(n_):\n    t, u = FNC.euler(f, tspan, u0, n)\n    err_[j] = norm(sol.sol(t)[0, :] - u[0, :], inf)\n    results.add_row((n, err_[j]))\nprint(results)","key":"TAnmHoneGl"},{"type":"output","id":"oqdQoeAagRaW_J8ONmoR6","data":[{"output_type":"stream","name":"stdout","text":"+------+-----------------------+\n|  n   |         error         |\n+------+-----------------------+\n|  5   |   2.7342049884036537  |\n|  15  |  0.15019897709239743  |\n|  50  |  0.029996197020050186 |\n| 158  |  0.008850284724309654 |\n| 500  | 0.0027366205261378784 |\n| 1581 | 0.0008596857693511373 |\n+------+-----------------------+\n"}],"key":"igTAh6Gzya"}],"key":"sbWuS6eveS"},{"type":"paragraph","position":{"start":{"line":281,"column":1},"end":{"line":281,"column":1}},"children":[{"type":"text","value":"The error is approximately cut by a factor of 10 for each increase in ","position":{"start":{"line":281,"column":1},"end":{"line":281,"column":1}},"key":"O1QmaAbsIH"},{"type":"inlineMath","value":"n","position":{"start":{"line":281,"column":1},"end":{"line":281,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"gtfH2ElYWh"},{"type":"text","value":" by the same factor. A log-log plot also confirms first-order convergence. Keep in mind that since ","position":{"start":{"line":281,"column":1},"end":{"line":281,"column":1}},"key":"wXvYEXA7DC"},{"type":"inlineMath","value":"h=(b-a)/n","position":{"start":{"line":281,"column":1},"end":{"line":281,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>h</mi><mo>=</mo><mo stretchy=\"false\">(</mo><mi>b</mi><mo>−</mo><mi>a</mi><mo stretchy=\"false\">)</mo><mi mathvariant=\"normal\">/</mi><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">h=(b-a)/n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">h</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">b</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mclose\">)</span><span class=\"mord\">/</span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"R22s9j86Rw"},{"type":"text","value":", it follows that ","position":{"start":{"line":281,"column":1},"end":{"line":281,"column":1}},"key":"sheqqX8Lbv"},{"type":"inlineMath","value":"O(h)=O(n^{-1})","position":{"start":{"line":281,"column":1},"end":{"line":281,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>h</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>O</mi><mo stretchy=\"false\">(</mo><msup><mi>n</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(h)=O(n^{-1})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">h</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">n</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"C9Lsa3orB3"},{"type":"text","value":".","position":{"start":{"line":281,"column":1},"end":{"line":281,"column":1}},"key":"Op7A2o0oMR"}],"key":"T8wz0Pwzap"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"loglog(n_, err_, \"-o\", label=\"results\")\nplot(n_, 0.5 * (n_ / n_[0])**(-1), \"--\", label=\"1st order\")\nxlabel(\"$n$\"), ylabel(\"inf-norm error\")\ntitle(\"Convergence of Euler's method\")\nlegend();","key":"xs7k8JEIhK"},{"type":"output","id":"K-P36P5sN4L0vxDMjFCZC","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"eec6517115113db8100db62dda8b0b79","path":"/build/eec6517115113db8100db62dda8b0b79.png"}}}],"key":"VF41wqeZaf"}],"key":"aUnDkLSpUM"}],"label":"demo-euler-converge-python","identifier":"demo-euler-converge-python","html_id":"demo-euler-converge-python","key":"kDp326f9tD"},{"type":"heading","depth":3,"position":{"start":{"line":292,"column":1},"end":{"line":292,"column":1}},"children":[{"type":"text","value":"6.3 ","position":{"start":{"line":292,"column":1},"end":{"line":292,"column":1}},"key":"yUydu5ORFx"},{"type":"link","identifier":"section-ivp-systems","label":"section-ivp-systems","kind":"narrative","position":{"start":{"line":292,"column":5},"end":{"line":292,"column":25}},"url":"/systems","internal":true,"dataUrl":"/systems.json","children":[{"type":"text","value":"IVP systems","key":"PZJrmEb5rI"}],"key":"COt8tXyk8Q"}],"identifier":"id-6-3","label":"6.3 ","html_id":"id-6-3","implicit":true,"key":"ttuyQVoVZ0"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-systems-predator","label":"demo-systems-predator","kind":"proof:example","position":{"start":{"line":294,"column":1},"end":{"line":294,"column":23}},"children":[{"type":"text","value":"Example ","key":"ZOtkqj0Yge"},{"type":"text","value":"6.3.2","key":"SnCogEXuJi"}],"template":"Example %s","enumerator":"6.3.2","resolved":true,"html_id":"demo-systems-predator","remote":true,"url":"/systems","dataUrl":"/systems.json","key":"O7RvK6kckX"}],"key":"JwszIn75eS"},{"type":"paragraph","position":{"start":{"line":296,"column":1},"end":{"line":296,"column":1}},"children":[{"type":"text","value":"We encode the predator–prey equations via a function.","position":{"start":{"line":296,"column":1},"end":{"line":296,"column":1}},"key":"yLJJkHvCqO"}],"key":"Pq7itRx8I0"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def predprey(t, u):\n    y, z = u                        # rename for convenience\n    s = (y * z) / (1 + beta * y)    # appears in both equations\n    return array([y * (1 - alpha * y) - s, -z + s])","key":"RcW7DeQBdJ"},{"type":"output","id":"61GapjIM5e3KvL9ydHl5N","data":[],"key":"gWSWwW2D4Z"}],"key":"ieoB5AH4pk"},{"type":"paragraph","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":1}},"children":[{"type":"text","value":"As before, the ","key":"yYzBByWDNh"},{"type":"abbreviation","title":"ordinary differential equation","children":[{"type":"text","value":"ODE","key":"mbLMMWhI7c"}],"key":"sPCaRrZJ1M"},{"type":"text","value":" function must accept three inputs, ","key":"kANDo4YZFV"},{"type":"inlineCode","value":"u","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":1}},"key":"H4DZV5XgDE"},{"type":"text","value":", ","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":1}},"key":"dBh33b6glg"},{"type":"inlineCode","value":"p","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":1}},"key":"c0tDeK13xY"},{"type":"text","value":", and ","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":1}},"key":"tEBo6z0eE0"},{"type":"inlineCode","value":"t","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":1}},"key":"jEYGF5i7AJ"},{"type":"text","value":", even though in this case there is no explicit dependence on ","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":1}},"key":"AXuTzSYKpk"},{"type":"inlineCode","value":"t","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":1}},"key":"EOw2CuJByR"},{"type":"text","value":". The second input is used to pass parameters that don’t change throughout a single instance of the problem.","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":1}},"key":"aNoihB2Brt"}],"key":"ypficBPPnw"},{"type":"paragraph","position":{"start":{"line":307,"column":1},"end":{"line":307,"column":1}},"children":[{"type":"text","value":"To specify the ","key":"mZQmLdVIRJ"},{"type":"abbreviation","title":"initial-value problem","children":[{"type":"text","value":"IVP","key":"B5An5Cp3uq"}],"key":"jQ65wUPP7U"},{"type":"text","value":", we must also provide the initial condition, which is a 2-vector here, and the interval for the independent variable. These are given in the call to ","key":"FIXJ1uoxlx"},{"type":"inlineCode","value":"solve_ivp","position":{"start":{"line":307,"column":1},"end":{"line":307,"column":1}},"key":"UBbeZ1tKlJ"},{"type":"text","value":".","position":{"start":{"line":307,"column":1},"end":{"line":307,"column":1}},"key":"q5DPtbMENt"}],"key":"O6lOhVBH3D"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from scipy.integrate import solve_ivp\nu0 = array([1, 0.01])\ntspan = [0.0, 60.0]\nalpha, beta = 0.1, 0.25\nsol = solve_ivp(predprey, tspan, u0, dense_output=True)\nprint(f\"solved with {sol.y.shape[1]} time steps\")","key":"n33YeaLgdU"},{"type":"output","id":"Xl09f9B4Fn20tHmyrc1L7","data":[{"output_type":"stream","name":"stdout","text":"solved with 76 time steps\n"}],"key":"Mtl5rDUXI3"}],"key":"vPQSAURQoz"},{"type":"paragraph","position":{"start":{"line":318,"column":1},"end":{"line":318,"column":1}},"children":[{"type":"text","value":"As in scalar problems, the solution object has fields ","position":{"start":{"line":318,"column":1},"end":{"line":318,"column":1}},"key":"DaxDNpBmFX"},{"type":"inlineCode","value":"t","position":{"start":{"line":318,"column":1},"end":{"line":318,"column":1}},"key":"RFDUIRv84y"},{"type":"text","value":" and ","position":{"start":{"line":318,"column":1},"end":{"line":318,"column":1}},"key":"ERGXuHCTtf"},{"type":"inlineCode","value":"y","position":{"start":{"line":318,"column":1},"end":{"line":318,"column":1}},"key":"JGfcyRTyaa"},{"type":"text","value":" that contain the values of the independent and dependent variables, respectively. Each row of ","position":{"start":{"line":318,"column":1},"end":{"line":318,"column":1}},"key":"sO4KeSBPNI"},{"type":"inlineCode","value":"y","position":{"start":{"line":318,"column":1},"end":{"line":318,"column":1}},"key":"tYBAsxDmyo"},{"type":"text","value":" represents one component of the solution at every time step, and each column of ","position":{"start":{"line":318,"column":1},"end":{"line":318,"column":1}},"key":"y8SZavDZzk"},{"type":"inlineCode","value":"y","position":{"start":{"line":318,"column":1},"end":{"line":318,"column":1}},"key":"kIb6g6z47f"},{"type":"text","value":" is the entire solution vector at one time step. Since we used ","position":{"start":{"line":318,"column":1},"end":{"line":318,"column":1}},"key":"kLj8v7DDRu"},{"type":"inlineCode","value":"dense_output=True","position":{"start":{"line":318,"column":1},"end":{"line":318,"column":1}},"key":"Aduts0DfJM"},{"type":"text","value":", there is also a method ","position":{"start":{"line":318,"column":1},"end":{"line":318,"column":1}},"key":"QhJbimliNc"},{"type":"inlineCode","value":"sol","position":{"start":{"line":318,"column":1},"end":{"line":318,"column":1}},"key":"YPclPo5Fvo"},{"type":"text","value":" that can be used to evaluate the solution at any time.","position":{"start":{"line":318,"column":1},"end":{"line":318,"column":1}},"key":"Mo0zUu6jnH"}],"key":"C2xlInkJOi"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"t = linspace(0, 60, 1200)\nu = vstack([sol.sol(t[i]) for i in range(t.size)]).T    # same shape as sol.y\nfig, ax = subplots()\nax.plot(t, u[0, :], label=\"prey\")\nax.plot(t, u[1, :], label=\"predator\")\nxlabel(\"$t$\"), ylabel(\"population\")\ntitle((\"Predator-prey solution\"));","key":"wYrL3cALdp"},{"type":"output","id":"S-pLPIz8N2rkd6Pr5hjUu","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"abecaccad7d1a0d570f8dbfe13cc5793","path":"/build/abecaccad7d1a0d570f8dbfe13cc5793.png"}}}],"key":"TlmO8rwRRX"}],"key":"WbfRE7eFdB"},{"type":"paragraph","position":{"start":{"line":330,"column":1},"end":{"line":330,"column":1}},"children":[{"type":"text","value":"We can also use ","position":{"start":{"line":330,"column":1},"end":{"line":330,"column":1}},"key":"avtlTK2aHs"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-euler","label":"function-euler","children":[{"type":"text","value":"Function ","key":"DDl2S0Z9J3"},{"type":"text","value":"6.2.1","key":"eGXR6Xkyew"}],"template":"Algorithm %s","enumerator":"6.2.1","resolved":true,"html_id":"function-euler","remote":true,"url":"/euler","dataUrl":"/euler.json","key":"f484t9xdBP"},{"type":"text","value":" to find the solution.","position":{"start":{"line":330,"column":1},"end":{"line":330,"column":1}},"key":"UPf29r70KJ"}],"key":"dx8CISv2Xm"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"t_E, u_E = FNC.euler(predprey, tspan, u0, 1001)\nax.scatter(t_E, u_E[0, :], label=\"prey (Euler)\", s=1)\nax.scatter(t_E, u_E[1, :], label=\"predator (Euler)\", s=2)\nax.legend()\nfig","key":"XUUx4YwY1o"},{"type":"output","id":"NeF9xjin91KULHyKcI7Mk","data":[{"output_type":"execute_result","execution_count":19,"metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"98d581c62f1e164cfed1d10e0833f617","path":"/build/98d581c62f1e164cfed1d10e0833f617.png"}}}],"key":"dSiw9nRYqN"}],"key":"voURnBhJTj"},{"type":"paragraph","position":{"start":{"line":340,"column":1},"end":{"line":340,"column":1}},"children":[{"type":"text","value":"Yotice above that the accuracy of the Euler solution deteriorates rapidly.","position":{"start":{"line":340,"column":1},"end":{"line":340,"column":1}},"key":"Vb3F7IA88k"}],"key":"aOrQvkUM0j"},{"type":"paragraph","position":{"start":{"line":342,"column":1},"end":{"line":342,"column":1}},"children":[{"type":"text","value":"When the solution has two components, it’s common to plot the it in the ","position":{"start":{"line":342,"column":1},"end":{"line":342,"column":1}},"key":"nNo5m1Waji"},{"type":"emphasis","position":{"start":{"line":342,"column":1},"end":{"line":342,"column":1}},"children":[{"type":"text","value":"phase plane","position":{"start":{"line":342,"column":1},"end":{"line":342,"column":1}},"key":"JodEtRihEw"}],"key":"kFsrQLQHVd"},{"type":"text","value":", i.e., with ","position":{"start":{"line":342,"column":1},"end":{"line":342,"column":1}},"key":"It5VwquRiH"},{"type":"inlineMath","value":"u_1","position":{"start":{"line":342,"column":1},"end":{"line":342,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>u</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">u_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"wCFP4tzB1B"},{"type":"text","value":" and ","position":{"start":{"line":342,"column":1},"end":{"line":342,"column":1}},"key":"HYueEPog0B"},{"type":"inlineMath","value":"u_2","position":{"start":{"line":342,"column":1},"end":{"line":342,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>u</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">u_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"N9dJ2PrtuK"},{"type":"text","value":" along the axes and time as a parameterization of the curve.","position":{"start":{"line":342,"column":1},"end":{"line":342,"column":1}},"key":"CXAFZSqy6y"}],"key":"KKIXuvx6tr"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plot(u[0, :], u[1, :])\nxlabel(\"prey, $y(t)$\"), ylabel(\"predator, $z(xt)$\")\ntitle(\"Predator-prey solution in the phase plane\");","key":"efUJjg451y"},{"type":"output","id":"Djur3w2DDUnJi4oW2Dwya","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"e834e4e630bc00605a7cfeb32b5c9dd1","path":"/build/e834e4e630bc00605a7cfeb32b5c9dd1.png"}}}],"key":"RwnRXXP9uu"}],"key":"S5aDAwhiud"},{"type":"paragraph","position":{"start":{"line":350,"column":1},"end":{"line":350,"column":1}},"children":[{"type":"text","value":"As time progresses, the point in the phase plane spirals inward toward a limiting closed loop called a ","position":{"start":{"line":350,"column":1},"end":{"line":350,"column":1}},"key":"yxby96BbwG"},{"type":"emphasis","position":{"start":{"line":350,"column":1},"end":{"line":350,"column":1}},"children":[{"type":"text","value":"limit cycle","position":{"start":{"line":350,"column":1},"end":{"line":350,"column":1}},"key":"ztIHVleQxH"}],"key":"LUigVBVj5w"},{"type":"text","value":" representing a periodic solution:","position":{"start":{"line":350,"column":1},"end":{"line":350,"column":1}},"key":"j5Y2iuKwIN"}],"key":"NNBh2akrOa"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from matplotlib import animation\nfig, ax = subplots()\ncurve_ = ax.plot(u[0, 0], u[1, 0])[0]\nhead_ = ax.plot(u[0, 0], u[1, 0], 'ro', markersize=6)[0]\n\nax.set_xlabel(\"prey, $y(t)$\")\nax.set_ylabel(\"predator, $z(xt)$\")\nax.set_xlim(0, 9)\nax.set_ylim(0, 6)\nax.set_title(\"Predator-prey solution in the phase plane\")\n\npredator = []\nprey = []\ndef snapshot(t):\n    y, z = sol.sol(t)\n    prey.append(y)\n    predator.append(z)\n    head_.set_data([y], [z])\n    curve_.set_data(prey, predator)\n\nanim = animation.FuncAnimation(\n    fig, snapshot, frames=linspace(0, 60, 801)\n    )\nanim.save(\"figures/predator-prey.mp4\", fps=24)\nclose()","visibility":"hide","key":"G53Xf6K8lI"},{"type":"output","id":"GezZjCjev94yNPhC30TsP","data":[],"visibility":"remove","key":"KC0mntog9o"}],"data":{"tags":[]},"indexEntries":[{"entry":"Python","subEntry":{"value":"animation","kind":"entry"},"emphasis":false}],"label":"index-SzzDOnUiRb","identifier":"index-szzdonuirb","html_id":"index-szzdonuirb","visibility":"show","key":"ulhsiGdKh1"},{"type":"image","url":"/build/predator-prey-ac653b1816b00dfe491ff9bd50439f6b.mp4","alt":"Predator–prey solution","position":{"start":{"line":384,"column":1},"end":{"line":384,"column":1}},"key":"qBEWpcPhen","urlSource":"figures/predator-prey.mp4"}],"label":"demo-systems-predator-python","identifier":"demo-systems-predator-python","html_id":"demo-systems-predator-python","key":"P48wdy2XCO"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-systems-coupledpendula","label":"demo-systems-coupledpendula","kind":"proof:example","position":{"start":{"line":388,"column":1},"end":{"line":388,"column":29}},"children":[{"type":"text","value":"Example ","key":"nfbDCbny0L"},{"type":"text","value":"6.3.5","key":"PRoWHcTtdf"}],"template":"Example %s","enumerator":"6.3.5","resolved":true,"html_id":"demo-systems-coupledpendula","remote":true,"url":"/systems","dataUrl":"/systems.json","key":"ho4gExtTNH"}],"key":"aEBqJIBOVe"},{"type":"paragraph","position":{"start":{"line":390,"column":1},"end":{"line":390,"column":1}},"children":[{"type":"text","value":"Let’s implement the coupled pendulums from ","position":{"start":{"line":390,"column":1},"end":{"line":390,"column":1}},"key":"wF1jn9qxBc"},{"type":"crossReference","kind":"proof:example","identifier":"example-systems-coupledpendula","label":"example-systems-coupledpendula","children":[{"type":"text","value":"Example ","key":"tubEY4d0T5"},{"type":"text","value":"6.3.4","key":"ZgorzLjirk"}],"template":"Example %s","enumerator":"6.3.4","resolved":true,"html_id":"example-systems-coupledpendula","remote":true,"url":"/systems","dataUrl":"/systems.json","key":"H9EJrdJakI"},{"type":"text","value":". The pendulums will be pulled in opposite directions and then released together from rest.","position":{"start":{"line":390,"column":1},"end":{"line":390,"column":1}},"key":"YSikuaGHmV"}],"key":"vr7n9cea6p"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def couple(t, u, params):\n    gamma, L, k = params\n    g = 9.8\n    udot = copy(u)\n    udot[:2] = u[2:4]\n    udot[2] = -gamma * u[2] - (g / L) * sin(u[0]) + k * (u[1] - u[0])\n    udot[3] = -gamma * u[3] - (g / L) * sin(u[1]) + k * (u[0] - u[1])\n    return udot\n\nu0 = array([1.25, -0.5, 0, 0])\ntspan = [0.0, 50.0]","key":"yyjZfqnzAw"},{"type":"output","id":"7Uwu4M0ZZZg_vMyTtOC2j","data":[],"key":"D56oejSg8e"}],"key":"szYWGLPk7z"},{"type":"paragraph","position":{"start":{"line":406,"column":1},"end":{"line":406,"column":1}},"children":[{"type":"text","value":"First we check the behavior of the system when the pendulums are uncoupled, i.e., when ","position":{"start":{"line":406,"column":1},"end":{"line":406,"column":1}},"key":"FqqvfFr4pc"},{"type":"inlineMath","value":"k=0","position":{"start":{"line":406,"column":1},"end":{"line":406,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">k=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"HoSAy7QT0g"},{"type":"text","value":".","position":{"start":{"line":406,"column":1},"end":{"line":406,"column":1}},"key":"LwcgogN3nF"}],"key":"lLmgN4k71D"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"F1tUsRRVpa"}],"key":"dl89NxMMIT"},{"type":"paragraph","position":{"start":{"line":409,"column":1},"end":{"line":409,"column":1}},"children":[{"type":"text","value":"We use a closure here to pass the fixed parameter values into ","position":{"start":{"line":409,"column":1},"end":{"line":409,"column":1}},"key":"q5FV76UYfn"},{"type":"inlineCode","value":"couple","position":{"start":{"line":409,"column":1},"end":{"line":409,"column":1}},"key":"BVOTA0AHBM"},{"type":"text","value":".","position":{"start":{"line":409,"column":1},"end":{"line":409,"column":1}},"key":"WOneuPvnKR"}],"key":"YqHlGleiBf"}],"class":"dropdown","key":"tx3JHwovc4"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"gamma, L, k = 0.01, 0.5, 0.0\ndu_dt = lambda t, u: couple(t, u, (gamma, L, k))\nsol = solve_ivp(du_dt, tspan, u0, t_eval=linspace(0, 50, 1001))\nplot(sol.t, sol.y[:2, :].T)    # first two components of solution\nxlabel(\"t\"), ylabel(\"angle\")\ntitle(\"Uncoupled pendulums\");","key":"zkgbBdOvpW"},{"type":"output","id":"U08EMCvm5dYtkpNuiT3or","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"0d56bd8059188498775d5b59bcb6a551","path":"/build/0d56bd8059188498775d5b59bcb6a551.png"}}}],"key":"gHNuUWrg5z"}],"key":"Sz0nlDU2le"},{"type":"paragraph","position":{"start":{"line":421,"column":1},"end":{"line":421,"column":1}},"children":[{"type":"text","value":"You can see that the pendulums swing independently:","position":{"start":{"line":421,"column":1},"end":{"line":421,"column":1}},"key":"OZRoV2sCce"}],"key":"LlVh9astbg"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from matplotlib import animation\nfig, ax = subplots(1, 2)\nrod_ = [] \nbob_ = []\nfor k in [0, 1]:\n    rod_.append(ax[k].plot([], [], linewidth=3)[0])\n    bob_.append(ax[k].scatter([0], [0], color='black', s=50))\n    ax[k].set_aspect('equal')\n    ax[k].set_xlim([-1.1, 1.1])\n    ax[k].set_ylim([-1.1, 0.4])\n    ax[k].set_axis_off()\ntime_ = ax[0].text(-0.95, 0.25, \"\", fontsize=11)\n\ndef snapshot(i):\n    q = sol.y[:2, i]\n    for k in [0, 1]:\n        rod_[k].set_data([0, sin(q[k])], [0, -cos(q[k])])\n        bob_[k].set_offsets([sin(q[k]), -cos(q[k])])\n    time_.set_text(f\"t = {sol.t[i]:.1f} s\")\n\nanim = animation.FuncAnimation(fig, snapshot, frames=401)\nanim.save(\"figures/pendulums-weak.mp4\", fps=24)","visibility":"hide","key":"jCidQLyDgC"},{"type":"output","id":"pRri_vMXRlqNtAHuT6Zz8","data":[{"output_type":"display_data","data":{"text/plain":"<Figure size 700x400 with 2 Axes>","image/png":"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"},"metadata":{},"transient":{}}],"visibility":"remove","key":"LuKPQxbPUb"}],"data":{"tags":[]},"visibility":"show","key":"wedzyR6tOF"},{"type":"image","url":"/build/pendulums-weak-03ac24dca51f761c162794a1715b1606.mp4","alt":"Uncoupled pendulums","position":{"start":{"line":449,"column":1},"end":{"line":449,"column":1}},"key":"W91JLtmFzy","urlSource":"figures/pendulums-weak.mp4"},{"type":"paragraph","position":{"start":{"line":451,"column":1},"end":{"line":451,"column":1}},"children":[{"type":"text","value":"Because the model is nonlinear and the initial angles are not small, they have slightly different periods of oscillation, and they go in and out of phase.","position":{"start":{"line":451,"column":1},"end":{"line":451,"column":1}},"key":"S7V808CLpP"}],"key":"My85i3ApMg"},{"type":"paragraph","position":{"start":{"line":453,"column":1},"end":{"line":453,"column":1}},"children":[{"type":"text","value":"With coupling activated, a different behavior is seen.","position":{"start":{"line":453,"column":1},"end":{"line":453,"column":1}},"key":"tGHIkKHDY0"}],"key":"RMm0clfnW4"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"k = 0.75    # changes the value in the du_dt closure\nsol = solve_ivp(du_dt, tspan, u0, t_eval=linspace(0, 50, 1001))\nplot(sol.t, sol.y[:2, :].T)\nxlabel(\"t\"), ylabel(\"angle\")\ntitle(\"Coupled pendulums\");","key":"pNexTgj3M2"},{"type":"output","id":"iGQ71-P171qEeiln4l4iB","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"e8009253d6f3391d4afa6da1c93c46f2","path":"/build/e8009253d6f3391d4afa6da1c93c46f2.png"}}}],"key":"AJH3OWNDEX"}],"key":"ulpjNVrLCU"},{"type":"paragraph","position":{"start":{"line":463,"column":1},"end":{"line":463,"column":1}},"children":[{"type":"text","value":"The coupling makes the pendulums swap energy back and forth:","position":{"start":{"line":463,"column":1},"end":{"line":463,"column":1}},"key":"NNW8auqVHO"}],"key":"KocWxcMthG"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"anim = animation.FuncAnimation(fig, snapshot, frames=1001)\nanim.save(\"figures/pendulums-strong.mp4\", fps=24)","visibility":"hide","key":"vV7UVHAT4A"},{"type":"output","id":"DTOpUJt3X2NxJtb8U6pbv","data":[],"visibility":"remove","key":"ET48Zb6J41"}],"data":{"tags":[]},"visibility":"show","key":"LON0x5uckd"},{"type":"image","url":"/build/pendulums-strong-b55964ab69467aa63278914662771043.mp4","alt":"Coupled pendulums","position":{"start":{"line":471,"column":1},"end":{"line":471,"column":1}},"key":"aN8XNPzGr1","urlSource":"figures/pendulums-strong.mp4"}],"label":"demo-systems-coupledpendula-python","identifier":"demo-systems-coupledpendula-python","html_id":"demo-systems-coupledpendula-python","key":"gG9TAawnGx"},{"type":"heading","depth":3,"position":{"start":{"line":474,"column":1},"end":{"line":474,"column":1}},"children":[{"type":"text","value":"6.4 ","position":{"start":{"line":474,"column":1},"end":{"line":474,"column":1}},"key":"RUe7OdhNCT"},{"type":"link","identifier":"section-ivp-rk","label":"section-ivp-rk","kind":"narrative","position":{"start":{"line":474,"column":5},"end":{"line":474,"column":20}},"url":"/rk","internal":true,"dataUrl":"/rk.json","children":[{"type":"text","value":"Runge–Kutta methods","key":"V3cnj2M020"}],"key":"VchBml91o6"}],"identifier":"id-6-4","label":"6.4 ","html_id":"id-6-4","implicit":true,"key":"XhhlwUewcA"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-rk-converge","label":"demo-rk-converge","kind":"proof:example","position":{"start":{"line":476,"column":1},"end":{"line":476,"column":18}},"children":[{"type":"text","value":"Example ","key":"VpWxW4zAtn"},{"type":"text","value":"6.4.1","key":"cmYEjPeUrE"}],"template":"Example %s","enumerator":"6.4.1","resolved":true,"html_id":"demo-rk-converge","remote":true,"url":"/rk","dataUrl":"/rk.json","key":"UImTtBk0OU"}],"key":"TeV0H6K9pm"},{"type":"paragraph","position":{"start":{"line":478,"column":1},"end":{"line":478,"column":1}},"children":[{"type":"text","value":"We solve the ","key":"MUw7dWrP9J"},{"type":"abbreviation","title":"initial-value problem","children":[{"type":"text","value":"IVP","key":"z92W8PmAfu"}],"key":"EKdG94fzbr"}],"key":"JV243Q3o4P"},{"type":"math","value":"u'=\\sin[(u+t)^2], \\quad t \\in [0,4], \\quad u(0)=-1.","enumerated":false,"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msup><mi>u</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo>=</mo><mi>sin</mi><mo>⁡</mo><mo stretchy=\"false\">[</mo><mo stretchy=\"false\">(</mo><mi>u</mi><mo>+</mo><mi>t</mi><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup><mo stretchy=\"false\">]</mo><mo separator=\"true\">,</mo><mspace width=\"1em\"/><mi>t</mi><mo>∈</mo><mo stretchy=\"false\">[</mo><mn>0</mn><mo separator=\"true\">,</mo><mn>4</mn><mo stretchy=\"false\">]</mo><mo separator=\"true\">,</mo><mspace width=\"1em\"/><mi>u</mi><mo stretchy=\"false\">(</mo><mn>0</mn><mo stretchy=\"false\">)</mo><mo>=</mo><mo>−</mo><mn>1.</mn></mrow><annotation encoding=\"application/x-tex\">u&#x27;=\\sin[(u+t)^2], \\quad t \\in [0,4], \\quad u(0)=-1.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8019em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8019em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop\">sin</span><span class=\"mopen\">[(</span><span class=\"mord mathnormal\">u</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1141em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mclose\">]</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:1em;\"></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">4</span><span class=\"mclose\">]</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:1em;\"></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">−</span><span class=\"mord\">1.</span></span></span></span></span>","key":"rD9gztpxWC"},{"type":"paragraph","position":{"start":{"line":485,"column":1},"end":{"line":485,"column":1}},"children":[{"type":"text","value":"We use the ","position":{"start":{"line":485,"column":1},"end":{"line":485,"column":1}},"key":"nvNO1ARY2t"},{"type":"inlineCode","value":"solve_ivp","position":{"start":{"line":485,"column":1},"end":{"line":485,"column":1}},"key":"ljJwcu82OE"},{"type":"text","value":" function to create an accurate reference solution.","position":{"start":{"line":485,"column":1},"end":{"line":485,"column":1}},"key":"M75Wj3dqF2"}],"key":"Q7PsTIgft4"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from scipy.integrate import solve_ivp\ndu_dt = lambda t, u: sin((t + u)**2)\ntspan = (0.0, 4.0)\nu0 = -1.0\nsol = solve_ivp(du_dt, tspan, [u0], dense_output=True, atol=1e-13, rtol=1e-13)\nu_ref = sol.sol","key":"gyz8TPIKsO"},{"type":"output","id":"2kKAGOOZGkFp33sHSAisA","data":[],"key":"bSmZChOR0p"}],"key":"E2wGJfEx87"},{"type":"paragraph","position":{"start":{"line":496,"column":1},"end":{"line":496,"column":1}},"children":[{"type":"text","value":"Now we perform a convergence study of our two Runge–Kutta implementations.","position":{"start":{"line":496,"column":1},"end":{"line":496,"column":1}},"key":"eVPscN0Jb5"}],"key":"UZyVzawXf4"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"n = array([int(2 * 10**k) for k in linspace(0, 3, 7)])\nerr = {\"IE2\" : [], \"RK4\" : []}\nresults = PrettyTable([\"n\", \"IE2 error\", \"RK4 error\"])\nfor i in range(len(n)):\n    t, u = FNC.ie2(du_dt, tspan, u0, n[i])\n    err[\"IE2\"].append( abs(u_ref(4)[0] - u[0][-1]) )\n    t, u = FNC.rk4(du_dt, tspan, u0, n[i])\n    err[\"RK4\"].append( abs(u_ref(4)[0] - u[0][-1]) )\n    results.add_row([n[i], err[\"IE2\"][-1], err[\"RK4\"][-1]])\n\nprint(results)","key":"kNWis7rIkB"},{"type":"output","id":"41257M9dBYGyqaqqyBnlD","data":[{"output_type":"stream","name":"stdout","text":"+------+------------------------+------------------------+\n|  n   |       IE2 error        |       RK4 error        |\n+------+------------------------+------------------------+\n|  2   |   1.7690264118810441   |   0.8206513302232612   |\n|  6   |   0.5126838225133257   |   0.7919245473433536   |\n|  20  |  0.002966971266360252  | 4.0177650143746746e-05 |\n|  63  | 0.00021416270501584123 | 3.581705267929891e-07  |\n| 200  | 1.951309601522233e-05  | 3.326041442264227e-09  |\n| 632  | 1.9058382192405077e-06 | 3.2657876403163755e-11 |\n| 2000 | 1.8883901087285437e-07 | 2.6711965972481266e-13 |\n+------+------------------------+------------------------+\n"}],"key":"MK3i0I3VJI"}],"key":"KMWU2DmL1D"},{"type":"paragraph","position":{"start":{"line":512,"column":1},"end":{"line":512,"column":1}},"children":[{"type":"text","value":"The amount of computational work at each time step is assumed to be proportional to the number of stages. Let’s compare on an apples-to-apples basis by using the number of ","position":{"start":{"line":512,"column":1},"end":{"line":512,"column":1}},"key":"BC13mS4ivp"},{"type":"inlineMath","value":"f","position":{"start":{"line":512,"column":1},"end":{"line":512,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>","key":"UZjMt9Vxwi"},{"type":"text","value":"-evaluations on the horizontal axis.","position":{"start":{"line":512,"column":1},"end":{"line":512,"column":1}},"key":"UWsgSTLC3U"}],"key":"rFuG34VjHi"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"loglog(2 * n, err[\"IE2\"], \"-o\", label=\"IE2\")\nloglog(4 * n, err[\"RK4\"], \"-o\", label=\"RK4\")\nplot(2 * n, 0.5 * err[\"IE2\"][-1] * (n / n[-1])**(-2), \"--\", label=\"2nd order\")\nplot(4 * n, 0.5 * err[\"RK4\"][-1] * (n / n[-1])**(-4), \"--\", label=\"4th order\")\n\nxlabel(\"f-evaluations\"),  ylabel(\"inf-norm error\")\nlegend()\ntitle(\"Convergence of RK methods\");","key":"E1Wjki6wwd"},{"type":"output","id":"Pb5Az-PpwR6zyg96UcsKW","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"8e8567a389adf4c8c08b77d2ef357013","path":"/build/8e8567a389adf4c8c08b77d2ef357013.png"}}}],"key":"SEhy8hmaVp"}],"key":"DpAl92bgw9"},{"type":"paragraph","position":{"start":{"line":525,"column":1},"end":{"line":525,"column":1}},"children":[{"type":"text","value":"The fourth-order variant is more efficient in this problem over a wide range of accuracy.","position":{"start":{"line":525,"column":1},"end":{"line":525,"column":1}},"key":"mr6kqelUQP"}],"key":"Bx0UTBVlHL"}],"label":"demo-rk-converge-python","identifier":"demo-rk-converge-python","html_id":"demo-rk-converge-python","key":"ghXWSmMi6I"},{"type":"heading","depth":3,"position":{"start":{"line":528,"column":1},"end":{"line":528,"column":1}},"children":[{"type":"text","value":"6.5 ","position":{"start":{"line":528,"column":1},"end":{"line":528,"column":1}},"key":"Pl57QevYzn"},{"type":"link","identifier":"section-ivp-adaptive","label":"section-ivp-adaptive","kind":"narrative","position":{"start":{"line":528,"column":5},"end":{"line":528,"column":26}},"url":"/adaptive-rk","internal":true,"dataUrl":"/adaptive-rk.json","children":[{"type":"text","value":"Adaptive Runge–Kutta","key":"CKHHiySg0S"}],"key":"B5wXyupBOU"}],"identifier":"id-6-5","label":"6.5 ","html_id":"id-6-5","implicit":true,"key":"BslOY8SErL"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-adapt-basic","label":"demo-adapt-basic","kind":"proof:example","position":{"start":{"line":530,"column":1},"end":{"line":530,"column":18}},"children":[{"type":"text","value":"Example ","key":"XjGqrEqklU"},{"type":"text","value":"6.5.1","key":"qnFvTdSAYJ"}],"template":"Example %s","enumerator":"6.5.1","resolved":true,"html_id":"demo-adapt-basic","remote":true,"url":"/adaptive-rk","dataUrl":"/adaptive-rk.json","key":"OWp5m2X88T"}],"key":"m1BE0rIfkc"},{"type":"paragraph","position":{"start":{"line":532,"column":1},"end":{"line":532,"column":1}},"children":[{"type":"text","value":"Let’s run adaptive RK on  ","position":{"start":{"line":532,"column":1},"end":{"line":532,"column":1}},"key":"ZEjpc3NFfm"},{"type":"inlineMath","value":"u'=e^{t-u\\sin u}","position":{"start":{"line":532,"column":1},"end":{"line":532,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>u</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo>=</mo><msup><mi>e</mi><mrow><mi>t</mi><mo>−</mo><mi>u</mi><mi>sin</mi><mo>⁡</mo><mi>u</mi></mrow></msup></mrow><annotation encoding=\"application/x-tex\">u&#x27;=e^{t-u\\sin u}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8305em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8305em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mbin mtight\">−</span><span class=\"mord mathnormal mtight\">u</span><span class=\"mspace mtight\" style=\"margin-right:0.1952em;\"></span><span class=\"mop mtight\"><span class=\"mtight\">s</span><span class=\"mtight\">i</span><span class=\"mtight\">n</span></span><span class=\"mspace mtight\" style=\"margin-right:0.1952em;\"></span><span class=\"mord mathnormal mtight\">u</span></span></span></span></span></span></span></span></span></span></span></span>","key":"PKCJP2CRUS"},{"type":"text","value":".","position":{"start":{"line":532,"column":1},"end":{"line":532,"column":1}},"key":"uO8BsoD6FS"}],"key":"aE99HTiWUQ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"f = lambda t, u: exp(t - u * sin(u))\nt, u = FNC.rk23(f, [0.0, 5.0], [0.0], 1e-5)\nscatter(t, u[0, :])\nxlabel(\"$t$\"), ylabel(\"$u(t)$\")\ntitle((\"Adaptive IVP solution\"));","key":"SPTxDE3GUA"},{"type":"output","id":"9_esVOruRgTnrwwTInGFJ","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"b31881398ddc8299ec9fdba3cb528c2b","path":"/build/b31881398ddc8299ec9fdba3cb528c2b.png"}}}],"key":"QvDY1dTXoM"}],"key":"clepF1Q4bq"},{"type":"paragraph","position":{"start":{"line":542,"column":1},"end":{"line":542,"column":1}},"children":[{"type":"text","value":"The solution makes a very abrupt change near ","position":{"start":{"line":542,"column":1},"end":{"line":542,"column":1}},"key":"EVdaB8MxFY"},{"type":"inlineMath","value":"t=2.4","position":{"start":{"line":542,"column":1},"end":{"line":542,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi><mo>=</mo><mn>2.4</mn></mrow><annotation encoding=\"application/x-tex\">t=2.4</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2.4</span></span></span></span>","key":"aQgGNDJCdb"},{"type":"text","value":". The resulting time steps vary over three orders of magnitude.","position":{"start":{"line":542,"column":1},"end":{"line":542,"column":1}},"key":"NcIUKTlCgl"}],"key":"mbtmi3HY4k"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"dt = [t[i + 1] - t[i] for i in range(t.size - 1)]\nsemilogy(t[:-1], dt)\nxlabel(\"$t$\"), ylabel(\"time step\")\ntitle((\"Adaptive step sizes\"));","key":"dEC1pkRWko"},{"type":"output","id":"6tRjo_5GhylPhb7K01sG4","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"eba08ff1fba9be126bcf6692936a176b","path":"/build/eba08ff1fba9be126bcf6692936a176b.png"}}}],"key":"spZdtfrJ3X"}],"key":"coMFxDUcZB"},{"type":"paragraph","position":{"start":{"line":551,"column":1},"end":{"line":551,"column":1}},"children":[{"type":"text","value":"If we had to run with a uniform step size to get this accuracy, it would be","position":{"start":{"line":551,"column":1},"end":{"line":551,"column":1}},"key":"bmyzl22zBS"}],"key":"z03kJzcNDW"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(f\"min step size was {min(dt):.2e}\")","key":"HHY2WL2om9"},{"type":"output","id":"BinXasKyTyySb5eksHFUr","data":[{"output_type":"stream","name":"stdout","text":"min step size was 4.61e-05\n"}],"key":"aEA8iQ1U0k"}],"key":"rHY41DqFt8"},{"type":"paragraph","position":{"start":{"line":557,"column":1},"end":{"line":557,"column":1}},"children":[{"type":"text","value":"On the other hand, the average step size that was actually taken was","position":{"start":{"line":557,"column":1},"end":{"line":557,"column":1}},"key":"H5ZkmpxcDj"}],"key":"Y0FHJ0sMvO"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(f\"mean step size was {mean(dt):.2e}\")","key":"lwY4Cj4JWT"},{"type":"output","id":"ev5U3ABAfMqCYK-awZv9E","data":[{"output_type":"stream","name":"stdout","text":"mean step size was 3.21e-02\n"}],"key":"XaQ0QWQKCy"}],"key":"wvfx3SOMOG"},{"type":"paragraph","position":{"start":{"line":563,"column":1},"end":{"line":563,"column":1}},"children":[{"type":"text","value":"We took fewer steps by a factor of 1000! Even accounting for the extra stage per step and the occasional rejected step, the savings are clear.","position":{"start":{"line":563,"column":1},"end":{"line":563,"column":1}},"key":"XhtXdyuYVJ"}],"key":"HUgbFa8lXL"}],"label":"demo-adapt-basic-python","identifier":"demo-adapt-basic-python","html_id":"demo-adapt-basic-python","key":"F1plkHxe1R"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-adapt-sing","label":"demo-adapt-sing","kind":"proof:example","position":{"start":{"line":568,"column":1},"end":{"line":568,"column":17}},"children":[{"type":"text","value":"Example ","key":"q10PrT4GdU"},{"type":"text","value":"6.5.2","key":"nopJHJNaqn"}],"template":"Example %s","enumerator":"6.5.2","resolved":true,"html_id":"demo-adapt-sing","remote":true,"url":"/adaptive-rk","dataUrl":"/adaptive-rk.json","key":"doqIQhCi0D"}],"key":"O2JaCDMDV4"},{"type":"paragraph","position":{"start":{"line":570,"column":1},"end":{"line":570,"column":1}},"children":[{"type":"text","value":"In ","position":{"start":{"line":570,"column":1},"end":{"line":570,"column":1}},"key":"SbECbUan5i"},{"type":"crossReference","identifier":"demo-basics-sing","label":"demo-basics-sing","kind":"proof:example","position":{"start":{"line":570,"column":4},"end":{"line":570,"column":21}},"children":[{"type":"text","value":"Example ","key":"whDO0bAMlF"},{"type":"text","value":"6.1.3","key":"IVaQ5WMtNh"}],"template":"Example %s","enumerator":"6.1.3","resolved":true,"html_id":"demo-basics-sing","remote":true,"url":"/basics","dataUrl":"/basics.json","key":"c61Lt8rqoI"},{"type":"text","value":" we saw an ","key":"c5agKDOSFo"},{"type":"abbreviation","title":"initial-value problem","children":[{"type":"text","value":"IVP","key":"Dn2fzvBs2m"}],"key":"cwd1lziC3H"},{"type":"text","value":" that appears to blow up in a finite amount of time. Because the solution increases so rapidly as it approaches the blowup, adaptive stepping is required even to get close.","key":"EaRmIlvdX0"}],"key":"AO4nQXwBd9"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"du_dt = lambda t, u: (t + u)**2\ntspan = (0.0, 2.0)\nu0 = [1.0]\nt, u = FNC.rk23(du_dt, tspan, u0, 1e-5)","key":"IhKx0BECVK"},{"type":"output","id":"w2LuDSjjW7Q_ax23FHSEP","data":[{"output_type":"stream","name":"stderr","text":"/Users/driscoll/.local/share/mamba/envs/myst/lib/python3.13/site-packages/fncbook/chapter06.py:90: UserWarning: Stepsize too small near t=0.785408720407281\n  warnings.warn(f\"Stepsize too small near t={t[i]}\")\n"}],"key":"XydsbddfWL"}],"key":"ouu9NkqVo5"},{"type":"paragraph","position":{"start":{"line":579,"column":1},"end":{"line":579,"column":1}},"children":[{"type":"text","value":"In fact, the failure of the adaptivity gives a decent idea of when the singularity occurs.","position":{"start":{"line":579,"column":1},"end":{"line":579,"column":1}},"key":"IW4sHWEW48"}],"key":"JGnq8Zi15f"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"semilogy(t, u[0, :])\nxlabel(\"$t$\"),  ylabel(\"$u(t)$\")\ntitle(\"Finite-time blowup\")\n\ntf = t[-1]\naxvline(x=tf, color='k', linestyle='--', label=f\"t = {tf:.6f}\")\nlegend();","key":"oYv2IPJpHW"},{"type":"output","id":"RKwAeEhLcI_Hs3sS04ifQ","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"03e897d55ce9cc0c7d91a683d80d7b5d","path":"/build/03e897d55ce9cc0c7d91a683d80d7b5d.png"}}}],"key":"LNKXsu25pH"}],"key":"NP3sX77jCo"}],"label":"demo-adapt-sing-python","identifier":"demo-adapt-sing-python","html_id":"demo-adapt-sing-python","key":"u73is7S5hI"},{"type":"heading","depth":3,"position":{"start":{"line":592,"column":1},"end":{"line":592,"column":1}},"children":[{"type":"text","value":"6.6 ","position":{"start":{"line":592,"column":1},"end":{"line":592,"column":1}},"key":"qyYJPKQcQP"},{"type":"link","identifier":"section-ivp-multistep","label":"section-ivp-multistep","kind":"narrative","position":{"start":{"line":592,"column":5},"end":{"line":592,"column":27}},"url":"/multistep","internal":true,"dataUrl":"/multistep.json","children":[{"type":"text","value":"Multistep methods","key":"md3VmZwsfF"}],"key":"XcWELG6Not"}],"identifier":"id-6-6","label":"6.6 ","html_id":"id-6-6","implicit":true,"key":"wriQRJI0Sg"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-implicit-ab4","label":"demo-implicit-ab4","kind":"proof:example","position":{"start":{"line":594,"column":1},"end":{"line":594,"column":19}},"children":[{"type":"text","value":"Example ","key":"IfW41RyKKQ"},{"type":"text","value":"6.7.1","key":"gsS2HC5K6N"}],"template":"Example %s","enumerator":"6.7.1","resolved":true,"html_id":"demo-implicit-ab4","remote":true,"url":"/implicit","dataUrl":"/implicit.json","key":"xaE6OueCMv"}],"key":"JwXfy5uFeS"},{"type":"paragraph","position":{"start":{"line":596,"column":1},"end":{"line":596,"column":1}},"children":[{"type":"text","value":"We study the convergence of AB4 using the ","key":"jmTpUxJiqZ"},{"type":"abbreviation","title":"initial-value problem","children":[{"type":"text","value":"IVP","key":"s3yCIJyGYZ"}],"key":"OwKuskKXr5"},{"type":"text","value":" ","key":"Vx9hJTUIxh"},{"type":"inlineMath","value":"u'=\\sin[(u+t)^2]","position":{"start":{"line":596,"column":1},"end":{"line":596,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>u</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo>=</mo><mi>sin</mi><mo>⁡</mo><mo stretchy=\"false\">[</mo><mo stretchy=\"false\">(</mo><mi>u</mi><mo>+</mo><mi>t</mi><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">u&#x27;=\\sin[(u+t)^2]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop\">sin</span><span class=\"mopen\">[(</span><span class=\"mord mathnormal\">u</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mclose\">]</span></span></span></span>","key":"SGSV7sO2Fa"},{"type":"text","value":" over ","position":{"start":{"line":596,"column":1},"end":{"line":596,"column":1}},"key":"Jhz99loqQo"},{"type":"inlineMath","value":"0\\le t \\le 4","position":{"start":{"line":596,"column":1},"end":{"line":596,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0</mn><mo>≤</mo><mi>t</mi><mo>≤</mo><mn>4</mn></mrow><annotation encoding=\"application/x-tex\">0\\le t \\le 4</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7804em;vertical-align:-0.136em;\"></span><span class=\"mord\">0</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7719em;vertical-align:-0.136em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">4</span></span></span></span>","key":"bNfGKi2Fkh"},{"type":"text","value":", with ","position":{"start":{"line":596,"column":1},"end":{"line":596,"column":1}},"key":"s58XUV75CQ"},{"type":"inlineMath","value":"u(0)=-1","position":{"start":{"line":596,"column":1},"end":{"line":596,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo stretchy=\"false\">(</mo><mn>0</mn><mo stretchy=\"false\">)</mo><mo>=</mo><mo>−</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">u(0)=-1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">−</span><span class=\"mord\">1</span></span></span></span>","key":"EQJLnvfA5K"},{"type":"text","value":". As usual, ","position":{"start":{"line":596,"column":1},"end":{"line":596,"column":1}},"key":"QXFiI3qCVo"},{"type":"inlineCode","value":"solve_ivp","position":{"start":{"line":596,"column":1},"end":{"line":596,"column":1}},"key":"BDfvyqNcHB"},{"type":"text","value":" is called to give an accurate reference solution.","position":{"start":{"line":596,"column":1},"end":{"line":596,"column":1}},"key":"mdtrVXyCUK"}],"key":"wgAyd9om4J"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from scipy.integrate import solve_ivp\ndu_dt = lambda t, u: sin((t + u)**2)\ntspan = (0.0, 4.0)\nu0 = [-1.0]\nu_ref = solve_ivp(du_dt, tspan, u0, dense_output=True, rtol=1e-13, atol=1e-13).sol","key":"YVqeI2XjZ9"},{"type":"output","id":"5m7yiKDepyPqhj5u9zFi_","data":[],"key":"HVEPuCY0TZ"}],"key":"pW1p3A8Qi3"},{"type":"paragraph","position":{"start":{"line":606,"column":1},"end":{"line":606,"column":1}},"children":[{"type":"text","value":"Now we perform a convergence study of the AB4 code.","position":{"start":{"line":606,"column":1},"end":{"line":606,"column":1}},"key":"b8XAXvwZCy"}],"key":"DAmVM96RLM"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"n = array([int(4 * 10**k) for k in linspace(0, 3, 7)])\nerr = []\nresults = PrettyTable([\"n\", \"AB4 error\"])\nfor i in range(len(n)):\n    t, u = FNC.ab4(du_dt, tspan, u0, n[i])\n    err.append( abs(u_ref(4)[0] - u[0][-1]) )\n    results.add_row([n[i], err[-1]])\n\nprint(results)","key":"CqVpcwR1WP"},{"type":"output","id":"JJ21XthpXSYpvI_oPTRsQ","data":[{"output_type":"stream","name":"stdout","text":"+------+------------------------+\n|  n   |       AB4 error        |\n+------+------------------------+\n|  4   |   0.5004401704518087   |\n|  12  |   0.9739144270683615   |\n|  40  | 2.218067629233822e-05  |\n| 126  | 3.9306304588926366e-07 |\n| 400  | 4.561844235695389e-09  |\n| 1264 | 4.791389507374788e-11  |\n| 4000 | 5.426770144367765e-13  |\n+------+------------------------+\n"}],"key":"JzTPiQeBjp"}],"key":"Zf2hysyQXb"},{"type":"paragraph","position":{"start":{"line":620,"column":1},"end":{"line":620,"column":1}},"children":[{"type":"text","value":"The method should converge as ","position":{"start":{"line":620,"column":1},"end":{"line":620,"column":1}},"key":"LwLstLgb0t"},{"type":"inlineMath","value":"O(h^4)","position":{"start":{"line":620,"column":1},"end":{"line":620,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><msup><mi>h</mi><mn>4</mn></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(h^4)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">h</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">4</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"trJPHR2udI"},{"type":"text","value":", so a log-log scale is appropriate for the errors.","position":{"start":{"line":620,"column":1},"end":{"line":620,"column":1}},"key":"LLJHkHLP1b"}],"key":"qAbMovO6xw"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"loglog(n, err, \"-o\", label=\"AB4\")\nloglog(n, 0.5 * err[-1] * (n / n[-1])**(-4), \"--\", label=\"4th order\")\n\nxlabel(\"$n$\"),  ylabel(\"final error\")\nlegend(), title(\"Convergence of AB4\");","key":"X4PFYSsB37"},{"type":"output","id":"dF6tKR9gMIwf-oauaQs7P","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"8258e42152a2788eed5c2486e6a9d271","path":"/build/8258e42152a2788eed5c2486e6a9d271.png"}}}],"key":"y5xq28Fx3g"}],"key":"MapgKMVpQC"}],"label":"demo-implicit-ab4-python","identifier":"demo-implicit-ab4-python","html_id":"demo-implicit-ab4-python","key":"y4E24U4ce0"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-implicit-stiff","label":"demo-implicit-stiff","kind":"proof:example","position":{"start":{"line":632,"column":1},"end":{"line":632,"column":21}},"children":[{"type":"text","value":"Example ","key":"wH36AhnxLH"},{"type":"text","value":"6.7.2","key":"O6ek2TNZSb"}],"template":"Example %s","enumerator":"6.7.2","resolved":true,"html_id":"demo-implicit-stiff","remote":true,"url":"/implicit","dataUrl":"/implicit.json","key":"NCokie60zQ"}],"key":"t6FwD95wMH"},{"type":"paragraph","position":{"start":{"line":634,"column":1},"end":{"line":634,"column":1}},"children":[{"type":"text","value":"The following simple ","key":"NQN2WQgxtB"},{"type":"abbreviation","title":"ordinary differential equation","children":[{"type":"text","value":"ODE","key":"fXRbOT2iRD"}],"key":"Tnc9zjyzQ4"},{"type":"text","value":" uncovers a surprise.","key":"qUkULepfdI"}],"key":"GPqzzWGkPT"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"f = lambda t, u: u**2 - u**3\nu0 = array([0.005])\ntspan = [0, 400]","key":"oEnzM9u2zb"},{"type":"output","id":"dbcXrIyGCXll8ieMhpYzX","data":[],"key":"tzi2DVCrZa"}],"key":"CrzjpQf6aS"},{"type":"paragraph","position":{"start":{"line":642,"column":1},"end":{"line":642,"column":1}},"children":[{"type":"text","value":"We will solve the problem first with the implicit AM2 method using ","position":{"start":{"line":642,"column":1},"end":{"line":642,"column":1}},"key":"g7UBPebsZI"},{"type":"inlineMath","value":"n=200","position":{"start":{"line":642,"column":1},"end":{"line":642,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>=</mo><mn>200</mn></mrow><annotation encoding=\"application/x-tex\">n=200</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">200</span></span></span></span>","key":"A546S4z8P5"},{"type":"text","value":" steps.","position":{"start":{"line":642,"column":1},"end":{"line":642,"column":1}},"key":"l6CX3O3icX"}],"key":"BTrk3oshpO"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"tI, uI = FNC.am2(f, [0.0, 400.0], u0, 200)\nfig, ax = subplots()\nax.plot(tI, uI[0], label=\"AM2\")\nxlabel(\"$t$\"), ylabel(\"$y(t)$\");","key":"ncHsnnzqvg"},{"type":"output","id":"o9HICyBvw0TKFn_t8Hzu7","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"8d6200403f0c49976bff909ba13f16c5","path":"/build/8d6200403f0c49976bff909ba13f16c5.png"}}}],"key":"sr8JO9KnCM"}],"key":"J57VTugkeC"},{"type":"paragraph","position":{"start":{"line":651,"column":1},"end":{"line":651,"column":1}},"children":[{"type":"text","value":"So far, so good. Now we repeat the process using the explicit AB4 method.","position":{"start":{"line":651,"column":1},"end":{"line":651,"column":1}},"key":"q8Rngjrpcc"}],"key":"OFzYybCgDW"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"tE, uE = FNC.ab4(f, [0.0, 400.0], u0, 200)\nax.scatter(tE, uE[0], label=\"AB4\")\nax.set_ylim([-4, 2]), ax.legend()\nfig","key":"FOO0cDQjtg"},{"type":"output","id":"t03W6HNBu9H4F3iqz1PwP","data":[{"output_type":"stream","name":"stderr","text":"/var/folders/0m/fy_f4_rx5xv68sdkrpcm26r00000gq/T/ipykernel_76861/862619530.py:1: RuntimeWarning: overflow encountered in square\n  f = lambda t, u: u**2 - u**3\n/var/folders/0m/fy_f4_rx5xv68sdkrpcm26r00000gq/T/ipykernel_76861/862619530.py:1: RuntimeWarning: overflow encountered in power\n  f = lambda t, u: u**2 - u**3\n/var/folders/0m/fy_f4_rx5xv68sdkrpcm26r00000gq/T/ipykernel_76861/862619530.py:1: RuntimeWarning: invalid value encountered in subtract\n  f = lambda t, u: u**2 - u**3\n"},{"output_type":"execute_result","execution_count":41,"metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"5f0c053c53937cc67be1dc7b09fbafdc","path":"/build/5f0c053c53937cc67be1dc7b09fbafdc.png"}}}],"key":"NSUE2PLBoF"}],"key":"RLTNWHQsdT"},{"type":"paragraph","position":{"start":{"line":660,"column":1},"end":{"line":660,"column":1}},"children":[{"type":"text","value":"Once the solution starts to take off, the AB4 result goes catastrophically wrong.","position":{"start":{"line":660,"column":1},"end":{"line":660,"column":1}},"key":"jLKOH7h0cE"}],"key":"gSgeVJglSC"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"uE[0, 104:111]","key":"Hu7Nq2uGFK"},{"type":"output","id":"xQ2RiSyXPMLwSAPGIq8zc","data":[{"output_type":"execute_result","execution_count":42,"metadata":{},"data":{"text/plain":{"content":"array([ 7.55385780e-01,  1.43729703e+00, -3.28897685e+00,  2.14179113e+02,\n       -4.48208915e+07,  4.12689029e+23, -3.22144124e+71])","content_type":"text/plain"}}}],"key":"GkEWZHWcbe"}],"key":"QRaQ2wDL0X"},{"type":"paragraph","position":{"start":{"line":666,"column":1},"end":{"line":666,"column":1}},"children":[{"type":"text","value":"We hope that AB4 will converge in the limit ","position":{"start":{"line":666,"column":1},"end":{"line":666,"column":1}},"key":"CcitsWTAbh"},{"type":"inlineMath","value":"h\\to 0","position":{"start":{"line":666,"column":1},"end":{"line":666,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>h</mi><mo>→</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">h\\to 0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">h</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"ZrBaramMVB"},{"type":"text","value":", so let’s try using more steps.","position":{"start":{"line":666,"column":1},"end":{"line":666,"column":1}},"key":"oMflv93DgI"}],"key":"YGxaNQU6Al"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plot(tI, uI[0], color=\"k\", label=\"AM2\")\ntE, uE = FNC.ab4(f, [0, 400], u0, 1000)\nplot(tE, uE[0], \".-\", label=\"AM4, n=1000\")\ntE, uE = FNC.ab4(f, [0, 400], u0, 1600)\nplot(tE, uE[0], \".-\", label=\"AM4, n=1600\")\nxlabel(\"$t$\"),  ylabel(\"$u(t)$\")\nlegend();","key":"LBkKPHSvfX"},{"type":"output","id":"kP1Hn6ozChzL6cjZs7_-0","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"493f1c94f7df7f75e7bfe7ad1b85ce55","path":"/build/493f1c94f7df7f75e7bfe7ad1b85ce55.png"}}}],"key":"iP1Y5cXKDv"}],"key":"CBAgKhr9me"},{"type":"paragraph","position":{"start":{"line":678,"column":1},"end":{"line":678,"column":1}},"children":[{"type":"text","value":"So AB4, which is supposed to be ","position":{"start":{"line":678,"column":1},"end":{"line":678,"column":1}},"key":"v6d0D5sQzH"},{"type":"emphasis","position":{"start":{"line":678,"column":1},"end":{"line":678,"column":1}},"children":[{"type":"text","value":"more","position":{"start":{"line":678,"column":1},"end":{"line":678,"column":1}},"key":"KBGQsKpO9U"}],"key":"s5cQhvhuE4"},{"type":"text","value":" accurate than AM2, actually needs something like 8 times as many steps to get a reasonable-looking answer!","position":{"start":{"line":678,"column":1},"end":{"line":678,"column":1}},"key":"LETuEzF5Xe"}],"key":"kHafUiu40Q"}],"label":"demo-implicit-stiff-python","identifier":"demo-implicit-stiff-python","html_id":"demo-implicit-stiff-python","key":"ZaN0WbaxOP"},{"type":"heading","depth":3,"position":{"start":{"line":681,"column":1},"end":{"line":681,"column":1}},"children":[{"type":"text","value":"6.7 ","position":{"start":{"line":681,"column":1},"end":{"line":681,"column":1}},"key":"fqPeziWNup"},{"type":"link","identifier":"section-ivp-implicit","label":"section-ivp-implicit","kind":"narrative","position":{"start":{"line":681,"column":5},"end":{"line":681,"column":26}},"url":"/implicit","internal":true,"dataUrl":"/implicit.json","children":[{"type":"text","value":"Implementation of multistep methods","key":"f1uiI3Bk79"}],"key":"DiPDiauSFm"}],"identifier":"id-6-7","label":"6.7 ","html_id":"id-6-7","implicit":true,"key":"sTxLNMKTDL"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-zs-liaf","label":"demo-zs-LIAF","kind":"proof:example","position":{"start":{"line":683,"column":1},"end":{"line":683,"column":14}},"children":[{"type":"text","value":"Example ","key":"vKKF8b3HyF"},{"type":"text","value":"6.8.1","key":"ZAYdZ9ZhNt"}],"template":"Example %s","enumerator":"6.8.1","resolved":true,"html_id":"demo-zs-liaf","remote":true,"url":"/zerostability","dataUrl":"/zerostability.json","key":"U2IwtvYm0X"}],"key":"w1RvABfEOv"},{"type":"paragraph","position":{"start":{"line":685,"column":1},"end":{"line":685,"column":1}},"children":[{"type":"text","value":"We’ll measure the error at the time ","position":{"start":{"line":685,"column":1},"end":{"line":685,"column":1}},"key":"T96tPkPgZG"},{"type":"inlineMath","value":"t=1","position":{"start":{"line":685,"column":1},"end":{"line":685,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">t=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"HlYoet3Ota"},{"type":"text","value":".","position":{"start":{"line":685,"column":1},"end":{"line":685,"column":1}},"key":"w8xSL21x9s"}],"key":"wCR4XDVOHy"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"du_dt = lambda t, u: u\nu_exact = exp\na, b = (0.0, 1.0)\n\ndef LIAF(du_dt, tspan, u0, n):\n    a, b = tspan\n    h = (b - a) / n\n    t = linspace(a, b, n+1)\n    u = np.tile(np.array(u0), (n+1, 1))\n    u[1] = u_exact(t[1])    # use an exact starting value\n    f = copy(u)\n    f[0] = du_dt(t[0], u[0])\n    for i in range(n):\n        f[i] = du_dt(t[i], u[i])\n        u[i + 1] = -4 * u[i] + 5 * u[i-1] + h * (4 * f[i] + 2 * f[i-1])\n\n    return t, u.T\n\nn = [5, 10, 20, 40, 60]\nresults = PrettyTable([\"n\", \"error\"])\nfor j in range(5):\n    t, u = LIAF(du_dt, [a, b], [1.0], n[j])\n    err = abs(u_exact(b) - u[0, -1])\n    results.add_row([n[j], err])\nprint(results)","key":"p4phDiAaul"},{"type":"output","id":"5fAP8wVYt2pI-OKBm-PZ1","data":[{"output_type":"stream","name":"stdout","text":"+----+------------------------+\n| n  |         error          |\n+----+------------------------+\n| 5  |    293.502838171541    |\n| 10 |   452905.58324991807   |\n| 20 |   2196838145485.221    |\n| 40 | 1.0437865522698013e+26 |\n| 60 | 6.628042953187168e+39  |\n+----+------------------------+\n"}],"key":"dL6MTjZND7"}],"key":"g5Xu5kAevv"},{"type":"paragraph","position":{"start":{"line":715,"column":1},"end":{"line":715,"column":1}},"children":[{"type":"text","value":"There is no convergence in sight! A graph of the last numerical attempt yields a clue:","position":{"start":{"line":715,"column":1},"end":{"line":715,"column":1}},"key":"FJZg8NVzhM"}],"key":"yECeFlPULV"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"semilogy(t, abs(u[0]), \"-o\")\nxlabel(\"$t$\"), ylabel(\"$|u|$\")\ntitle((\"LIAF solution\"));","key":"DjRkoDSyg8"},{"type":"output","id":"DDKv7TUlC9MSfgZVsooQe","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"14bf17f4046b97769fe2ad2f60f12712","path":"/build/14bf17f4046b97769fe2ad2f60f12712.png"}}}],"key":"r2BC62pP54"}],"key":"OlLX5hPhlL"},{"type":"paragraph","position":{"start":{"line":723,"column":1},"end":{"line":723,"column":1}},"children":[{"type":"text","value":"It’s clear that the solution is growing exponentially in time.","position":{"start":{"line":723,"column":1},"end":{"line":723,"column":1}},"key":"mnGX0u1jXz"}],"key":"mnPeXo34Zo"}],"label":"demo-zs-LIAF-python","identifier":"demo-zs-liaf-python","html_id":"demo-zs-liaf-python","key":"r9TR4gTEUg"}],"key":"aJF25LjOem"}],"key":"aqXMccbwi4"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Chapter 5","url":"/chapter5-2","group":"Python codes"},"next":{"title":"Chapter 7","url":"/chapter7-2","group":"Python codes"}}},"domain":"http://localhost:3000"}