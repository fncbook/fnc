{"version":2,"kind":"Notebook","sha256":"71b816af3e3cc48f0eca41474b9a389693e0b4deedeb8adb5f08aa141208815f","slug":"chapter6-2","location":"/python/chapter6.md","dependencies":[],"frontmatter":{"title":"Chapter 6","numbering":{"heading_1":{"enabled":false},"heading_2":{"enabled":false},"heading_3":{"enabled":false},"heading_4":{"enabled":false},"heading_5":{"enabled":false},"heading_6":{"enabled":false},"title":{"offset":2}},"kernelspec":{"name":"python3","display_name":"Python 3","language":"python"},"content_includes_title":false,"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","TPBVP":"two-point boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"source_url":"https://github.com/fncbook/fnc/blob/master/python/chapter6.md","edit_url":"https://github.com/fncbook/fnc/edit/master/python/chapter6.md","exports":[{"format":"md","filename":"chapter6.md","url":"/build/chapter6-aeb038869fd694e81240ed72066d9701.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Functions","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"kjmoV6Nkar"}],"identifier":"functions","label":"Functions","html_id":"functions","implicit":true,"key":"W0bZD1Fe5Q"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Euler’s method for an initial-value problem","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"Q6fA9L2WLx"}],"key":"WdM6ItFIj1"},{"type":"include","file":"fncbook/fncbook/chapter06.py","literal":true,"filter":{"startAt":"def euler","endAt":"return t"},"children":[{"type":"code","value":"def euler(du_dt, tspan, u0, n):\n    \"\"\"\n    euler(du_dt, tspan, u0, n)\n\n    Apply Euler's method to solve the IVP u'=du_dt(u,t) over the interval tspan with\n    u(tspan[1])=u0, using n subintervals/steps. Return vectors of times and solution\n    values.\n    \"\"\"\n    a, b = tspan\n    h = (b - a) / n\n    t = np.linspace(a, b, n+1)\n    u = np.zeros((n+1, len(np.atleast_1d(u0))))\n    u[0] = u0\n    for i in range(n):\n        u[i+1] = u[i] + h * du_dt(t[i], u[i])\n\n    return t, u.T","lang":"python","showLineNumbers":true,"filename":"euler.py","key":"Ap03crTRLE"}],"key":"goKaUEA9tH"}],"label":"function-euler-python","identifier":"function-euler-python","html_id":"function-euler-python","key":"brCVB9v6wc"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Improved Euler method for an ","key":"ZiZ0Z5HOWV"},{"type":"abbreviation","title":"initial-value problem","children":[{"type":"text","value":"IVP","key":"sxObwxNfSd"}],"key":"PM3m9tAIE5"}],"key":"RdvgeSn5Ur"},{"type":"include","file":"fncbook/fncbook/chapter06.py","literal":true,"filter":{"startAt":"def ie2","endAt":"return t"},"children":[{"type":"code","value":"def ie2(du_dt, tspan, u0, n):\n    \"\"\"\n    ie2(du_dt, tspan, u0, n)\n\n    Apply the Improved Euler method to solve the vector-valued IVP u'=du_dt(u,p,t) over the\n    interval tspan with u(tspan[1])=u0, using n subintervals/steps. Returns a vector\n    of times and a vector of solution values/vectors.\n    \"\"\"\n    # Time discretization.\n    a, b = tspan\n    h = (b - a) / n\n    t = np.linspace(a, b, n + 1)\n\n    # Initialize output.\n    u = np.zeros((n+1, len(np.atleast_1d(u0))))\n    u[0] = u0\n\n    # Time stepping.\n    for i in range(n):\n        uhalf = u[i] + h / 2 * du_dt(t[i], u[i])\n        u[i+1] = u[i] + h * du_dt(t[i] + h / 2, uhalf)\n\n    return t, u.T","lang":"python","showLineNumbers":true,"filename":"ie2.py","key":"OWQJiVP7no"}],"key":"BCTCQG602N"}],"label":"function-ie2-python","identifier":"function-ie2-python","html_id":"function-ie2-python","key":"fhEY9aJR1c"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Fourth-order Runge-Kutta for an ","key":"W0jYlO4c0H"},{"type":"abbreviation","title":"initial-value problem","children":[{"type":"text","value":"IVP","key":"VdDWJ1O3rx"}],"key":"tBO9NoF9Ou"}],"key":"c24CAcxYrV"},{"type":"include","file":"fncbook/fncbook/chapter06.py","literal":true,"filter":{"startAt":"def rk4","endAt":"return t"},"children":[{"type":"code","value":"def rk4(du_dt, tspan, u0, n):\n    \"\"\"\n    rk4(du_dt, tspan, u0, n)\n\n    Apply \"the\" Runge-Kutta 4th order method to solve the vector-valued IVP u'=du_dt(u,p,t)\n    over the interval tspan with u(tspan[1])=u0, using n subintervals/steps.\n    Return a vector of times and a vector of solution values/vectors.\n    \"\"\"\n    # Time discretization.\n    a, b = tspan\n    h = (b - a) / n\n    t = np.linspace(a, b, n + 1)\n\n    # Initialize output.\n    u = np.zeros((n+1, len(np.atleast_1d(u0))))\n    u[0] = u0\n    \n    # Time stepping.\n    for i in range(n):\n        k1 = h * du_dt(t[i], u[i])\n        k2 = h * du_dt(t[i] + h / 2, u[i] + k1 / 2)\n        k3 = h * du_dt(t[i] + h / 2, u[i] + k2 / 2)\n        k4 = h * du_dt(t[i] + h, u[i] + k3)\n        u[i+1] = u[i] + (k1 + 2 * (k2 + k3) + k4) / 6\n\n    return t, u.T","lang":"python","showLineNumbers":true,"filename":"rk4.py","key":"ao1tMURbHf"}],"key":"Scnvrq9HnH"}],"label":"function-rk4-python","identifier":"function-rk4-python","html_id":"function-rk4-python","key":"hnQdnj0IGy"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Adaptive ","key":"kg96WpunBE"},{"type":"abbreviation","title":"initial-value problem","children":[{"type":"text","value":"IVP","key":"RzzqgIF2zG"}],"key":"K8t1y6YKNO"},{"type":"text","value":" solver based on embedded RK formulas","key":"qVwrfmNDeJ"}],"key":"bTmHGveTMa"},{"type":"include","file":"fncbook/fncbook/chapter06.py","literal":true,"filter":{"startAt":"def euler","endAt":"return"},"children":[{"type":"code","value":"def euler(du_dt, tspan, u0, n):\n    \"\"\"\n    euler(du_dt, tspan, u0, n)\n\n    Apply Euler's method to solve the IVP u'=du_dt(u,t) over the interval tspan with\n    u(tspan[1])=u0, using n subintervals/steps. Return vectors of times and solution\n    values.\n    \"\"\"\n    a, b = tspan\n    h = (b - a) / n\n    t = np.linspace(a, b, n+1)\n    u = np.zeros((n+1, len(np.atleast_1d(u0))))\n    u[0] = u0\n    for i in range(n):\n        u[i+1] = u[i] + h * du_dt(t[i], u[i])\n\n    return t, u.T","lang":"python","showLineNumbers":true,"filename":"rk23.py","key":"BNEAhaCXIq"}],"key":"bOyDcyZmSX"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"About the code","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"jLFp4ZvVKf"}],"key":"S2xSeDIpkg"},{"type":"paragraph","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"children":[{"type":"text","value":"The check ","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"jNOcBSacxT"},{"type":"inlineCode","value":"t[i]+h==t[i]","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"ASfGUi7xnD"},{"type":"text","value":"on line 19 is to detect when ","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"gmcaHMXdbj"},{"type":"inlineMath","value":"h","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>h</mi></mrow><annotation encoding=\"application/x-tex\">h</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">h</span></span></span></span>","key":"zCOTpN6IdX"},{"type":"text","value":" has become so small that it no longer changes the floating-point value of ","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"uqi7LZvxwr"},{"type":"inlineMath","value":"t_i","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>t</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">t_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7651em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"z1NRjcnz3u"},{"type":"text","value":". This may be a sign that the underlying exact solution has a singularity near ","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"nn6S4fUAEJ"},{"type":"inlineMath","value":"t=t_i","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi><mo>=</mo><msub><mi>t</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">t=t_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7651em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"jg4FuIprwi"},{"type":"text","value":", but in any case, the solver must halt by using a ","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"fkh4K0btPs"},{"type":"inlineCode","value":"break","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"dx80wIUKQG"},{"type":"text","value":" statement to exit the loop.","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"pkmW8nt9Ft"}],"key":"BTsMaUrLKx"},{"type":"paragraph","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"children":[{"type":"text","value":"On line 30, we use a combination of absolute and relative tolerances to judge the acceptability of a solution value, as in ","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"key":"ouatAR37gA"},{"type":"crossReference","kind":"equation","identifier":"absreltolerance","label":"absreltolerance","children":[{"type":"text","value":"(","key":"Ui5GxAjqIx"},{"type":"text","value":"5.7.6","key":"hUQdxhdqvu"},{"type":"text","value":")","key":"tNDjcTf7mm"}],"template":"(%s)","enumerator":"5.7.6","resolved":true,"html_id":"absreltolerance","remote":true,"url":"/adaptive","dataUrl":"/adaptive.json","key":"igjEwMZbbQ"},{"type":"text","value":". In lines 41--43 we underestimate the step factor ","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"key":"xI5ElzgRgw"},{"type":"inlineMath","value":"q","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>q</mi></mrow><annotation encoding=\"application/x-tex\">q</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span></span></span></span>","key":"mlIyNBrMbo"},{"type":"text","value":" a bit and prevent a huge increase in the step size, since a rejected step is expensive, and then we make sure that our final step doesn’t take us past the end of the domain.","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"key":"M0xnZfvjUa"}],"key":"RLnhKGm0gR"},{"type":"paragraph","position":{"start":{"line":65,"column":1},"end":{"line":66,"column":1}},"children":[{"type":"text","value":"Finally, line 37 exploits a subtle property of the BS23 formula called ","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"FmkyUXenzK"},{"type":"emphasis","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"children":[{"type":"text","value":"first same as last","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"T5CRWEEqU8"}],"key":"Q73Zq8dRfG"},{"type":"text","value":" (FSAL).\nWhile ","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"Ved8WY3opE"},{"type":"crossReference","kind":"equation","identifier":"bs23","label":"bs23","children":[{"type":"text","value":"(","key":"lk5BxytNAc"},{"type":"text","value":"6.5.5","key":"q9v0itXL8w"},{"type":"text","value":")","key":"ueqd94i196"}],"template":"(%s)","enumerator":"6.5.5","resolved":true,"html_id":"bs23","remote":true,"url":"/adaptive-rk","dataUrl":"/adaptive-rk.json","key":"TFth0YWeyu"},{"type":"text","value":" calls for four stages to find the paired second- and third-order estimates, the final stage computed in stepping from ","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"upRHPgu7Cr"},{"type":"inlineMath","value":"t_i","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>t</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">t_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7651em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"u892sS8NIu"},{"type":"text","value":" to ","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"hoiVcO1RPu"},{"type":"inlineMath","value":"t_{i+1}","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>t</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding=\"application/x-tex\">t_{i+1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8234em;vertical-align:-0.2083em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span></span></span></span>","key":"pEROh7g2xZ"},{"type":"text","value":" is identical to the first stage needed to step from ","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"DArwPlzaD9"},{"type":"inlineMath","value":"t_{i+1}","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>t</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding=\"application/x-tex\">t_{i+1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8234em;vertical-align:-0.2083em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span></span></span></span>","key":"fmKwDIH1NY"},{"type":"text","value":" to ","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"WXrDfk8jV2"},{"type":"inlineMath","value":"t_{i+2}","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>t</mi><mrow><mi>i</mi><mo>+</mo><mn>2</mn></mrow></msub></mrow><annotation encoding=\"application/x-tex\">t_{i+2}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8234em;vertical-align:-0.2083em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">2</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span></span></span></span>","key":"aFzo6uiwH8"},{"type":"text","value":". By repurposing ","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"YR9woHgKbk"},{"type":"inlineCode","value":"s₄","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"YNaKMDWfLD"},{"type":"text","value":" as ","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"txEcgAtubx"},{"type":"inlineCode","value":"s₁","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"jQ8OPLDDQO"},{"type":"text","value":" for the next pass, one of the stage evaluations comes for free, and only three evaluations of ","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"XPiaWnsGUd"},{"type":"inlineMath","value":"f","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>","key":"U1geY6giBV"},{"type":"text","value":" are needed per successful step.","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"rPpPGzd6KT"}],"key":"PI6jUfYVXF"}],"class":"dropdown","key":"TAJ0sfB6ll"}],"label":"function-rk23-python","identifier":"function-rk23-python","html_id":"function-rk23-python","key":"F2UjWkoHhR"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"4th-order Adams–Bashforth formula for an ","key":"UnxE4xu7gr"},{"type":"abbreviation","title":"initial-value problem","children":[{"type":"text","value":"IVP","key":"iMLf2AZySl"}],"key":"PllGYroO4s"}],"key":"H0zNCsxE0V"},{"type":"include","file":"fncbook/fncbook/chapter06.py","literal":true,"filter":{"startAt":"def ab4","endAt":"return t"},"children":[{"type":"code","value":"def ab4(du_dt, tspan, u0, n):\n    \"\"\"\n    ab4(du_dt, tspan, u0, n)\n\n    Apply the Adams-Bashforth 4th order method to solve the vector-valued IVP u'=du_dt(u,p,t)\n    over the interval tspan with u(tspan[1])=u0, using n subintervals/steps.\n    \"\"\"\n    # Time discretization.\n    a, b = tspan\n    h = (b - a) / n\n    t = np.linspace(a, b, n + 1)\n\n    # Constants in the AB4 method.\n    k = 4\n    sigma = np.array([55, -59, 37, -9]) / 24\n\n    # Find starting values by RK4.\n    ts, us = rk4(du_dt, [a, a + (k - 1) * h], u0, k - 1)\n    u = np.zeros((n+1, len(np.atleast_1d(u0))))\n    u[:k] = us[:k].T\n\n    # Compute history of u' values, from newest to oldest.\n    f = np.array([du_dt(t[k-j-2], u[k-j-2]) for j in range(k)])\n\n    # Time stepping.\n    for i in range(k-1, n):\n        f = np.vstack([du_dt(t[i], u[i]), f[:-1]])  # new value of du/dt\n        u[i+1] = u[i] + h * np.dot(sigma, f)  # advance one step\n\n    return t, u.T","lang":"python","showLineNumbers":true,"filename":"ab4.py","key":"GT7T9IsduP"}],"key":"Z7zIqcVOiL"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"About the code","position":{"start":{"line":81,"column":1},"end":{"line":81,"column":1}},"key":"RviqNKwrSe"}],"key":"ZzS4Rg2xA3"},{"type":"paragraph","position":{"start":{"line":83,"column":1},"end":{"line":83,"column":1}},"children":[{"type":"text","value":"Line 15 sets ","position":{"start":{"line":83,"column":1},"end":{"line":83,"column":1}},"key":"OywBYKigM1"},{"type":"inlineCode","value":"σ","position":{"start":{"line":83,"column":1},"end":{"line":83,"column":1}},"key":"nUCGHPE2ft"},{"type":"text","value":" to be the coefficients of the generating polynomial ","position":{"start":{"line":83,"column":1},"end":{"line":83,"column":1}},"key":"lI7ESncF3p"},{"type":"inlineMath","value":"\\sigma(z)","position":{"start":{"line":83,"column":1},"end":{"line":83,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>σ</mi><mo stretchy=\"false\">(</mo><mi>z</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\sigma(z)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"mclose\">)</span></span></span></span>","key":"ytZnXvGkiu"},{"type":"text","value":" of AB4. Lines 19--21 set up the ","key":"qg4xfpTN5X"},{"type":"abbreviation","title":"initial-value problem","children":[{"type":"text","value":"IVP","key":"jpfHnlz7Zz"}],"key":"MW3b6Mw0af"},{"type":"text","value":" over the time interval ","key":"t9NRxefVFv"},{"type":"inlineMath","value":"a \\le t \\le a+3 h","position":{"start":{"line":83,"column":1},"end":{"line":83,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi><mo>≤</mo><mi>t</mi><mo>≤</mo><mi>a</mi><mo>+</mo><mn>3</mn><mi>h</mi></mrow><annotation encoding=\"application/x-tex\">a \\le t \\le a+3 h</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7719em;vertical-align:-0.136em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7719em;vertical-align:-0.136em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord\">3</span><span class=\"mord mathnormal\">h</span></span></span></span>","key":"pGhBh43fSI"},{"type":"text","value":", call ","position":{"start":{"line":83,"column":1},"end":{"line":83,"column":1}},"key":"teFxWzrley"},{"type":"inlineCode","value":"rk4","position":{"start":{"line":83,"column":1},"end":{"line":83,"column":1}},"key":"soR8OkqXkm"},{"type":"text","value":" to solve it using the step size ","position":{"start":{"line":83,"column":1},"end":{"line":83,"column":1}},"key":"YNTFLtCwR3"},{"type":"inlineMath","value":"h","position":{"start":{"line":83,"column":1},"end":{"line":83,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>h</mi></mrow><annotation encoding=\"application/x-tex\">h</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">h</span></span></span></span>","key":"XOdyehwL27"},{"type":"text","value":", and use the result to fill the first four values of the solution. Then line 24 computes the vector ","position":{"start":{"line":83,"column":1},"end":{"line":83,"column":1}},"key":"rvzeX7W3D5"},{"type":"inlineMath","value":"[f_2,f_1,f_0]","position":{"start":{"line":83,"column":1},"end":{"line":83,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><msub><mi>f</mi><mn>2</mn></msub><mo separator=\"true\">,</mo><msub><mi>f</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><msub><mi>f</mi><mn>0</mn></msub><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[f_2,f_1,f_0]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">]</span></span></span></span>","key":"DW8gu75PCi"},{"type":"text","value":".","position":{"start":{"line":83,"column":1},"end":{"line":83,"column":1}},"key":"U8X8OfKVTc"}],"key":"R1dLXsIuWr"},{"type":"paragraph","position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"children":[{"type":"text","value":"Line 28 computes ","position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"key":"XUedjnmrxC"},{"type":"inlineMath","value":"f_i","position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>f</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">f_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"PTXjJK5ZIy"},{"type":"text","value":", based on the most recent solution value and time. That goes into the first spot of ","position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"key":"S7J4tBELjw"},{"type":"inlineCode","value":"f","position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"key":"V5j8lP03DR"},{"type":"text","value":", followed by the three values that were previously most recent. These are the four values that appear in ","position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"key":"uJo82ZEbX3"},{"type":"crossReference","kind":"equation","identifier":"ab4","label":"ab4","children":[{"type":"text","value":"(","key":"gFbF2Ce13y"},{"type":"text","value":"6.7.1","key":"jEbxr2zP94"},{"type":"text","value":")","key":"jvc7vmdUYI"}],"template":"(%s)","enumerator":"6.7.1","resolved":true,"html_id":"ab4","remote":true,"url":"/implicit","dataUrl":"/implicit.json","key":"Mq9eaDUsud"},{"type":"text","value":". Each particular ","position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"key":"MydfrVup9E"},{"type":"inlineMath","value":"f_i","position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>f</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">f_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"d6oZqcFU0h"},{"type":"text","value":" value starts at the front of ","position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"key":"B9w08yvl9v"},{"type":"inlineCode","value":"f","position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"key":"wOTJMR4BCi"},{"type":"text","value":", moves through each position in the vector over three iterations, and then is forgotten.","position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"key":"sKuKFbqkv8"}],"key":"tPYgM2iMAZ"}],"class":"dropdown","key":"PXCe3M94ZC"}],"label":"function-ab4-python","identifier":"function-ab4-python","html_id":"function-ab4-python","key":"QMatuenP8p"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"2nd-order Adams–Moulton (trapezoid) formula for an ","key":"WXZJzcpsBn"},{"type":"abbreviation","title":"initial-value problem","children":[{"type":"text","value":"IVP","key":"jgRbo3ofND"}],"key":"waR6Xl0JBr"}],"key":"RDwGx2FAiL"},{"type":"include","file":"fncbook/fncbook/chapter06.py","literal":true,"filter":{"startAt":"def am2","endAt":"return t"},"children":[{"type":"code","value":"def am2(du_dt, tspan, u0, n):\n    \"\"\"\n    am2(du_dt, tspan, u0, n)\n\n    Apply the Adams-Moulton 2nd order method to solve the vector-valued IVP u'=du_dt(u,p,t)\n    over the interval tspan with u(tspan[1])=u0, using n subintervals/steps.\n    \"\"\"\n    # Time discretization.\n    a, b = tspan\n    h = (b - a) / n\n    t = np.linspace(a, b, n + 1)\n\n    # Initialize output.\n    u = np.zeros((n+1, len(np.atleast_1d(u0))))\n    u[0] = u0\n\n    # Time stepping.\n    for i in range(n):\n        # Data that does not depend on the new value.\n        known = u[i] + h / 2 * du_dt(t[i], u[i])\n        # Find a root for the new value.\n        F = lambda z: z - h / 2 * du_dt(t[i+1], z) - known\n        unew = levenberg(F, known)\n        u[i+1] = unew[-1]\n\n    return t, u.T","lang":"python","showLineNumbers":true,"filename":"am2.py","key":"y8mLGK9UeY"}],"key":"jSJtUHWwIS"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"About the code","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"key":"PJJ8g4gJvi"}],"key":"d7sQKwKExH"},{"type":"paragraph","position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"children":[{"type":"text","value":"Lines 22-23 define the function ","position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"key":"lQMNb6fG54"},{"type":"inlineMath","value":"\\mathbf{g}","position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">g</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{g}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6389em;vertical-align:-0.1944em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">g</span></span></span></span>","key":"I9rcd6Ytb1"},{"type":"text","value":" and call ","position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"key":"hsjqQGcKS2"},{"type":"inlineCode","value":"levenberg","position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"key":"mNz6usmOj7"},{"type":"text","value":" to find the new solution value, using an Euler half-step as its starting value. A robust code would have to intercept the case where ","position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"key":"X238AchZeJ"},{"type":"inlineCode","value":"levenberg","position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"key":"ireP4Lwqlf"},{"type":"text","value":" fails to converge, but we have ignored this issue for the sake of brevity.","position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"key":"rNgLiyS4hk"}],"key":"mM5O9YaUB1"}],"class":"dropdown","key":"fypUYLN9Hg"}],"label":"function-am2-python","identifier":"function-am2-python","html_id":"function-am2-python","key":"bW1jMt6Yzd"},{"type":"heading","depth":2,"position":{"start":{"line":105,"column":1},"end":{"line":105,"column":1}},"children":[{"type":"text","value":"Examples","position":{"start":{"line":105,"column":1},"end":{"line":105,"column":1}},"key":"eYC3yLQzil"}],"identifier":"examples","label":"Examples","html_id":"examples","implicit":true,"key":"Ogh3iEkxNF"}],"key":"it4vP4cwLO"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(\"1\")\nexec(open(\"FNC_init.py\").read())","visibility":"show","key":"kQ5r0ito2S"},{"type":"output","id":"u5riSrb0t9aZwncdfnWtt","data":[{"output_type":"stream","name":"stdout","text":"1\n"}],"visibility":"show","key":"EcHfefaZp4"}],"data":{"tags":[]},"visibility":"remove","key":"wwE7Ms2vI2"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":113,"column":1},"end":{"line":113,"column":1}},"children":[{"type":"text","value":"6.1 ","position":{"start":{"line":113,"column":1},"end":{"line":113,"column":1}},"key":"E8RhiBH6AS"},{"type":"link","identifier":"section-ivp-basics","label":"section-ivp-basics","kind":"narrative","position":{"start":{"line":113,"column":5},"end":{"line":113,"column":24}},"url":"/basics","internal":true,"dataUrl":"/basics.json","children":[{"type":"text","value":"Basics of IVPs","key":"Rt1Vy7Vkkp"}],"key":"vghR66aCnt"}],"identifier":"id-6-1","label":"6.1 ","html_id":"id-6-1","implicit":true,"key":"gDhNmFRZFs"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-basics-first","label":"demo-basics-first","kind":"proof:example","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":19}},"children":[{"type":"text","value":"Example ","key":"Nx1NAMWTu0"},{"type":"text","value":"6.1.2","key":"dG6lIfIyWD"}],"template":"Example %s","enumerator":"6.1.2","resolved":true,"html_id":"demo-basics-first","remote":true,"url":"/basics","dataUrl":"/basics.json","key":"d8RtPt4iPk"}],"key":"OVqKahhA0p"},{"type":"paragraph","position":{"start":{"line":118,"column":1},"end":{"line":118,"column":1}},"children":[{"type":"text","value":"Let’s use ","position":{"start":{"line":118,"column":1},"end":{"line":118,"column":1}},"key":"DmW4A4fr87"},{"type":"inlineCode","value":"solve_ivp","position":{"start":{"line":118,"column":1},"end":{"line":118,"column":1}},"key":"P7ZbVfgsd2"},{"type":"text","value":" from ","position":{"start":{"line":118,"column":1},"end":{"line":118,"column":1}},"key":"zf0M3nE3GC"},{"type":"inlineCode","value":"scipy.integrate","position":{"start":{"line":118,"column":1},"end":{"line":118,"column":1}},"key":"uPCia89Zh5"},{"type":"text","value":" to define and solve the initial-value problem","position":{"start":{"line":118,"column":1},"end":{"line":118,"column":1}},"key":"JBSaRA6FjI"}],"key":"vqpPcQXB0Z"},{"type":"math","value":"u'=\\sin[(u+t)^2], \\quad t \\in [0,4], \\quad u(0)=-1.","enumerated":false,"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msup><mi>u</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo>=</mo><mi>sin</mi><mo>⁡</mo><mo stretchy=\"false\">[</mo><mo stretchy=\"false\">(</mo><mi>u</mi><mo>+</mo><mi>t</mi><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup><mo stretchy=\"false\">]</mo><mo separator=\"true\">,</mo><mspace width=\"1em\"/><mi>t</mi><mo>∈</mo><mo stretchy=\"false\">[</mo><mn>0</mn><mo separator=\"true\">,</mo><mn>4</mn><mo stretchy=\"false\">]</mo><mo separator=\"true\">,</mo><mspace width=\"1em\"/><mi>u</mi><mo stretchy=\"false\">(</mo><mn>0</mn><mo stretchy=\"false\">)</mo><mo>=</mo><mo>−</mo><mn>1.</mn></mrow><annotation encoding=\"application/x-tex\">u&#x27;=\\sin[(u+t)^2], \\quad t \\in [0,4], \\quad u(0)=-1.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8019em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8019em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop\">sin</span><span class=\"mopen\">[(</span><span class=\"mord mathnormal\">u</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1141em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mclose\">]</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:1em;\"></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">4</span><span class=\"mclose\">]</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:1em;\"></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">−</span><span class=\"mord\">1.</span></span></span></span></span>","key":"BZ8owWfuCk"},{"type":"paragraph","position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"children":[{"type":"text","value":"To create an initial-value problem for ","position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"key":"OwTPnlcV5T"},{"type":"inlineMath","value":"u(t)","position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">u(t)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span></span></span></span>","key":"OjbdO2YcXH"},{"type":"text","value":", we must supply a function that computes ","position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"key":"Ss69lwBRi6"},{"type":"inlineMath","value":"u'","position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>u</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup></mrow><annotation encoding=\"application/x-tex\">u&#x27;</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span></span></span></span>","key":"W3dnrujaCD"},{"type":"text","value":", an initial value for ","position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"key":"Tf7sxfmdE5"},{"type":"inlineMath","value":"u","position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span>","key":"w27eC37LMD"},{"type":"text","value":", and the endpoints of the interval for ","position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"key":"dSWq1v0tKv"},{"type":"inlineMath","value":"t","position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span></span></span></span>","key":"jcCn2ufrSu"},{"type":"text","value":".","position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"key":"JselbOSMuh"}],"key":"JkcIP6FDee"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"f = lambda t, u: sin((t + u) ** 2)\ntspan = [0.0, 4.0]\nu0 = array([-1.0])","key":"NzQtILmHA1"},{"type":"output","id":"m4g-sN7wD1LB7T-Sltzbn","data":[],"key":"pHc6adj0W2"}],"indexEntries":[{"entry":"Python","subEntry":{"value":"solve_ivp","kind":"entry"},"emphasis":true}],"label":"index-MCWylvDWEA","identifier":"index-mcwylvdwea","html_id":"index-mcwylvdwea","key":"nv6LMIlyEK"},{"type":"paragraph","position":{"start":{"line":136,"column":1},"end":{"line":136,"column":1}},"children":[{"type":"text","value":"Note above that even though this is a problem for a scalar function ","position":{"start":{"line":136,"column":1},"end":{"line":136,"column":1}},"key":"g0qZM8wBwE"},{"type":"inlineMath","value":"u(t)","position":{"start":{"line":136,"column":1},"end":{"line":136,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">u(t)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span></span></span></span>","key":"vz3wcrKPCm"},{"type":"text","value":", we had to set the initial condition as a one-component vector.","position":{"start":{"line":136,"column":1},"end":{"line":136,"column":1}},"key":"TV3MZ7AWZg"}],"key":"IRLOXHBs0T"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from scipy.integrate import solve_ivp\nsol = solve_ivp(f, tspan, u0)","key":"jXbSudKp3g"},{"type":"output","id":"kML-LEQHjXmyRuaGM6xO9","data":[],"key":"GhBFLSZOTI"}],"key":"J2UepJjfYL"},{"type":"paragraph","position":{"start":{"line":143,"column":1},"end":{"line":143,"column":1}},"children":[{"type":"text","value":"The resulting solution object has fields ","position":{"start":{"line":143,"column":1},"end":{"line":143,"column":1}},"key":"MuKOa3lZje"},{"type":"inlineCode","value":"t","position":{"start":{"line":143,"column":1},"end":{"line":143,"column":1}},"key":"zeZUuLKr9c"},{"type":"text","value":" and ","position":{"start":{"line":143,"column":1},"end":{"line":143,"column":1}},"key":"uf54rQNe6n"},{"type":"inlineCode","value":"y","position":{"start":{"line":143,"column":1},"end":{"line":143,"column":1}},"key":"GNuKtAqntC"},{"type":"text","value":" that contain the values of the independent and dependent variables, respectively; those field names are the same regardless of what we use in our own codes.","position":{"start":{"line":143,"column":1},"end":{"line":143,"column":1}},"key":"tGf6c64e2d"}],"key":"eKpoeEdV3E"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(\"t shape:\", sol.t.shape)\nprint(\"u shape:\", sol.y.shape)\nplot(sol.t, sol.y[0, :], \"-o\")\nxlabel(\"$t$\"), ylabel(\"$u(t)$\")\ntitle((\"Solution of $u' = sin((t+u)^2)$\"));","key":"mM6JAtqCBx"},{"type":"output","id":"UOKfSMNvs5l3uwgW-XVYr","data":[{"output_type":"stream","name":"stdout","text":"t shape: (10,)\nu shape: (1, 10)\n"},{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"1bee89de54a85c83e0773510ef51feba","path":"/build/1bee89de54a85c83e0773510ef51feba.png"}}}],"key":"xreM5OHmQz"}],"key":"ZXdyalXo2R"},{"type":"paragraph","position":{"start":{"line":153,"column":1},"end":{"line":153,"column":1}},"children":[{"type":"text","value":"You can see above that the solution was not computed at enough points to make a smooth graph. There is a way to request output at times of your choosing.","position":{"start":{"line":153,"column":1},"end":{"line":153,"column":1}},"key":"jzfVY9ypWa"}],"key":"bLtGoJTXx3"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"sol = solve_ivp(f, tspan, u0, t_eval=linspace(0, 4, 200))\nplot(sol.t, sol.y[0, :], \"-\")\nxlabel(\"$t$\"), ylabel(\"$u(t)$\")\ntitle((\"Solution of $u' = sin((t+u)^2)$\"));","key":"U8esY1q5Ct"},{"type":"output","id":"Bj3tKtkGpTInm-nqvAR26","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"f10022292b26ec30f7e4d668501fa54d","path":"/build/f10022292b26ec30f7e4d668501fa54d.png"}}}],"key":"yl7srJAojT"}],"key":"E0Kfh8Pmrt"},{"type":"paragraph","position":{"start":{"line":162,"column":1},"end":{"line":162,"column":1}},"children":[{"type":"text","value":"Another option is to enable interpolation to evaluate the solution anywhere after the fact:","position":{"start":{"line":162,"column":1},"end":{"line":162,"column":1}},"key":"IXRLa4jqEC"}],"key":"jbKyK8wBid"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"sol = solve_ivp(f, tspan, u0, dense_output=True)\nfor t in linspace(0, 4, 6):\n    print(f\"u({t:.2f}) = {sol.sol(t)[0]:.4f}\")","key":"R8RZCSg7qg"},{"type":"output","id":"EE2h3Hsyn_SEDTeRariGF","data":[{"output_type":"stream","name":"stdout","text":"u(0.00) = -1.0000\nu(0.80) = -0.8122\nu(1.60) = -0.6204\nu(2.40) = -0.4320\nu(3.20) = -1.1139\nu(4.00) = -1.8822\n"}],"key":"PJc2XsNhxD"}],"key":"riHmMDNTQZ"}],"label":"demo-basics-first-python","identifier":"demo-basics-first-python","html_id":"demo-basics-first-python","key":"oPjO2tb84k"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-basics-sing","label":"demo-basics-sing","kind":"proof:example","position":{"start":{"line":172,"column":1},"end":{"line":172,"column":18}},"children":[{"type":"text","value":"Example ","key":"rkvMmoZW1U"},{"type":"text","value":"6.1.3","key":"gUewFNbz2t"}],"template":"Example %s","enumerator":"6.1.3","resolved":true,"html_id":"demo-basics-sing","remote":true,"url":"/basics","dataUrl":"/basics.json","key":"wX5mqsOm5H"}],"key":"g3ErC6cPZ0"},{"type":"paragraph","position":{"start":{"line":175,"column":1},"end":{"line":175,"column":1}},"children":[{"type":"text","value":"The equation ","position":{"start":{"line":175,"column":1},"end":{"line":175,"column":1}},"key":"xbN2PvQwSW"},{"type":"inlineMath","value":"u'=(u+t)^2","position":{"start":{"line":175,"column":1},"end":{"line":175,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>u</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo>=</mo><mo stretchy=\"false\">(</mo><mi>u</mi><mo>+</mo><mi>t</mi><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup></mrow><annotation encoding=\"application/x-tex\">u&#x27;=(u+t)^2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">u</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span>","key":"fJUhUKckeb"},{"type":"text","value":" gives us some trouble.","position":{"start":{"line":175,"column":1},"end":{"line":175,"column":1}},"key":"vQ1eLv6q8z"}],"key":"RZ2NHiLbgq"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"MUaimvwSSO"}],"key":"f0F7grwLff"},{"type":"paragraph","position":{"start":{"line":178,"column":1},"end":{"line":178,"column":1}},"children":[{"type":"text","value":"It’s a good idea to check ","position":{"start":{"line":178,"column":1},"end":{"line":178,"column":1}},"key":"XbKsxWzcxF"},{"type":"inlineCode","value":"sol.success","position":{"start":{"line":178,"column":1},"end":{"line":178,"column":1}},"key":"FB5BB6U6gp"},{"type":"text","value":" after calling ","position":{"start":{"line":178,"column":1},"end":{"line":178,"column":1}},"key":"Uhv6POjNXR"},{"type":"inlineCode","value":"solve_ivp","position":{"start":{"line":178,"column":1},"end":{"line":178,"column":1}},"key":"fWRJsObrhZ"},{"type":"text","value":". If it’s ","position":{"start":{"line":178,"column":1},"end":{"line":178,"column":1}},"key":"GHdUO2RrGg"},{"type":"inlineCode","value":"False","position":{"start":{"line":178,"column":1},"end":{"line":178,"column":1}},"key":"QNbq2zYSaE"},{"type":"text","value":", the solution may not be reliable.","position":{"start":{"line":178,"column":1},"end":{"line":178,"column":1}},"key":"XfBq40coyO"}],"key":"qfYcFaGuUs"}],"class":"dropdown","key":"v1xu9EhkgL"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"f = lambda t, u: (t + u) ** 2\nsol = solve_ivp(f, [0.0, 1.0], [1.0])\nif not sol.success:\n    print(sol.message)","key":"ovRGnyFQdN"},{"type":"output","id":"vc7RuXp1CRjGALZJ9GMTM","data":[{"output_type":"stream","name":"stdout","text":"Required step size is less than spacing between numbers.\n"}],"key":"KWrrhvrgJI"}],"key":"fbSql9TRiG"},{"type":"paragraph","position":{"start":{"line":188,"column":1},"end":{"line":188,"column":1}},"children":[{"type":"text","value":"The warning message we received can mean that there is a bug in the formulation of the problem. But if everything has been done correctly, it suggests that the solution may not exist past the indicated time. This is a possibility in nonlinear ","key":"kIthPelFKW"},{"type":"abbreviation","title":"ordinary differential equation","children":[{"type":"text","value":"ODE","key":"lOfQ6iYRPM"}],"key":"PP9iSndP6r"},{"type":"text","value":"s.","key":"QoMnHbGSGT"}],"key":"QzKWx5YqlS"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"semilogy(sol.t, sol.y[0, :])\nxlabel(\"$t$\")\nylabel(\"$u(t)$\")\ntitle((\"Blowup in finite time\"));","key":"iPBAeQmFXQ"},{"type":"output","id":"8TTn42iErhNgV6oW0MMUC","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"27eed1f19405358083c9f424122c99a0","path":"/build/27eed1f19405358083c9f424122c99a0.png"}}}],"key":"vo8qgg8v7U"}],"key":"OoeAGD8vC8"}],"label":"demo-basics-sing-python","identifier":"demo-basics-sing-python","html_id":"demo-basics-sing-python","key":"AbDm1bvCJF"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-basics-cond","label":"demo-basics-cond","kind":"proof:example","position":{"start":{"line":199,"column":1},"end":{"line":199,"column":18}},"children":[{"type":"text","value":"Example ","key":"pRRn4FZFq2"},{"type":"text","value":"6.1.5","key":"gEPgdyRCwx"}],"template":"Example %s","enumerator":"6.1.5","resolved":true,"html_id":"demo-basics-cond","remote":true,"url":"/basics","dataUrl":"/basics.json","key":"zQN9d0VC1x"}],"key":"tsN79WZx53"},{"type":"paragraph","position":{"start":{"line":201,"column":1},"end":{"line":201,"column":1}},"children":[{"type":"text","value":"Consider the ","key":"if3IpZBqau"},{"type":"abbreviation","title":"ordinary differential equation","children":[{"type":"text","value":"ODE","key":"pSxncvDn2P"}],"key":"JwFl8Pg7Dw"},{"type":"text","value":"s ","key":"k1vkWkjlzt"},{"type":"inlineMath","value":"u'=u","position":{"start":{"line":201,"column":1},"end":{"line":201,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>u</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo>=</mo><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u&#x27;=u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span>","key":"wef6qeYCwy"},{"type":"text","value":" and ","position":{"start":{"line":201,"column":1},"end":{"line":201,"column":1}},"key":"NRp9bbqKV2"},{"type":"inlineMath","value":"u'=-u","position":{"start":{"line":201,"column":1},"end":{"line":201,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>u</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo>=</mo><mo>−</mo><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u&#x27;=-u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord\">−</span><span class=\"mord mathnormal\">u</span></span></span></span>","key":"mlrkaErZqm"},{"type":"text","value":". In each case we compute ","position":{"start":{"line":201,"column":1},"end":{"line":201,"column":1}},"key":"fZUUr2Gyww"},{"type":"inlineMath","value":"\\partial f/\\partial u = \\pm 1","position":{"start":{"line":201,"column":1},"end":{"line":201,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">∂</mi><mi>f</mi><mi mathvariant=\"normal\">/</mi><mi mathvariant=\"normal\">∂</mi><mi>u</mi><mo>=</mo><mo>±</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">\\partial f/\\partial u = \\pm 1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mord\">/</span><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">u</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">±</span><span class=\"mord\">1</span></span></span></span>","key":"Lc267dW5XD"},{"type":"text","value":", so the condition number bound from ","position":{"start":{"line":201,"column":1},"end":{"line":201,"column":1}},"key":"XLwUHJufV7"},{"type":"crossReference","identifier":"theorem-depic","label":"theorem-depIC","kind":"proof:theorem","position":{"start":{"line":201,"column":131},"end":{"line":201,"column":145}},"children":[{"type":"text","value":"Theorem ","key":"R02lYJCqxL"},{"type":"text","value":"6.1.2","key":"FjKxZ4yo5B"}],"template":"Theorem %s","enumerator":"6.1.2","resolved":true,"html_id":"theorem-depic","remote":true,"url":"/basics","dataUrl":"/basics.json","key":"tZ87yFQcAK"},{"type":"text","value":" is ","position":{"start":{"line":201,"column":1},"end":{"line":201,"column":1}},"key":"iLkE5t2CtE"},{"type":"inlineMath","value":"e^{b-a}","position":{"start":{"line":201,"column":1},"end":{"line":201,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>e</mi><mrow><mi>b</mi><mo>−</mo><mi>a</mi></mrow></msup></mrow><annotation encoding=\"application/x-tex\">e^{b-a}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8491em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">b</span><span class=\"mbin mtight\">−</span><span class=\"mord mathnormal mtight\">a</span></span></span></span></span></span></span></span></span></span></span></span>","key":"hvDEp7Vzqu"},{"type":"text","value":" in both problems. However, they behave quite differently. In the case of exponential growth, ","position":{"start":{"line":201,"column":1},"end":{"line":201,"column":1}},"key":"kj3q5ZzH9e"},{"type":"inlineMath","value":"u'=u","position":{"start":{"line":201,"column":1},"end":{"line":201,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>u</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo>=</mo><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u&#x27;=u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span>","key":"tmoU0BOrLC"},{"type":"text","value":", the bound is the actual condition number.","position":{"start":{"line":201,"column":1},"end":{"line":201,"column":1}},"key":"kaRpgH5an0"}],"key":"Ahz8RaSnuy"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"t = linspace(0, 3, 200)\nu = array([exp(t) * u0 for u0 in [0.7, 1, 1.3]])\nplot(t, u.T)\nxlabel(\"$t$\")\nylabel(\"$u(t)$\")\ntitle((\"Exponential divergence of solutions\"));","key":"AyTlGtjolA"},{"type":"output","id":"reRq--SZeLJSBuXdcYWv5","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"53413f1cc522bd74a613d5373a40a137","path":"/build/53413f1cc522bd74a613d5373a40a137.png"}}}],"key":"FgLOaiBrFa"}],"key":"CIkIDfPAdl"},{"type":"paragraph","position":{"start":{"line":212,"column":1},"end":{"line":212,"column":1}},"children":[{"type":"text","value":"But with ","position":{"start":{"line":212,"column":1},"end":{"line":212,"column":1}},"key":"tsxZRTn69k"},{"type":"inlineMath","value":"u'=-u","position":{"start":{"line":212,"column":1},"end":{"line":212,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>u</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo>=</mo><mo>−</mo><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u&#x27;=-u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord\">−</span><span class=\"mord mathnormal\">u</span></span></span></span>","key":"FLM0OzT1xg"},{"type":"text","value":", solutions actually get closer together with time.","position":{"start":{"line":212,"column":1},"end":{"line":212,"column":1}},"key":"VBlT2BGyvM"}],"key":"RXyakDxepx"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"t = linspace(0, 3, 200)\nu = array([exp(-t) * u0 for u0 in [0.7, 1, 1.3]])\nplot(t, u.T)\nxlabel(\"$t$\")\nylabel(\"$u(t)$\")\ntitle((\"Exponential convergence of solutions\"));","key":"m31YE15k5m"},{"type":"output","id":"eXP5wOG4BPRZ1SotyIuYe","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"c2bfca5b9b65150e63ab7a5bccb36cbe","path":"/build/c2bfca5b9b65150e63ab7a5bccb36cbe.png"}}}],"key":"vb9KB8dIcW"}],"key":"haeFXIYfSZ"},{"type":"paragraph","position":{"start":{"line":223,"column":1},"end":{"line":223,"column":1}},"children":[{"type":"text","value":"In this case the actual condition number is one, because the initial difference between solutions is the largest over all time. Hence, the exponentially growing upper bound ","position":{"start":{"line":223,"column":1},"end":{"line":223,"column":1}},"key":"XaTe8a2G9n"},{"type":"inlineMath","value":"e^{b-a}","position":{"start":{"line":223,"column":1},"end":{"line":223,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>e</mi><mrow><mi>b</mi><mo>−</mo><mi>a</mi></mrow></msup></mrow><annotation encoding=\"application/x-tex\">e^{b-a}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8491em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">b</span><span class=\"mbin mtight\">−</span><span class=\"mord mathnormal mtight\">a</span></span></span></span></span></span></span></span></span></span></span></span>","key":"dl8SEmqonK"},{"type":"text","value":" is a gross overestimate.","position":{"start":{"line":223,"column":1},"end":{"line":223,"column":1}},"key":"XAPWNx8xvt"}],"key":"VH3Xs0hQLP"}],"label":"demo-basics-cond-python","identifier":"demo-basics-cond-python","html_id":"demo-basics-cond-python","key":"sGC56ulyim"},{"type":"heading","depth":3,"position":{"start":{"line":226,"column":1},"end":{"line":226,"column":1}},"children":[{"type":"text","value":"6.2 ","position":{"start":{"line":226,"column":1},"end":{"line":226,"column":1}},"key":"yD5gOc7JFB"},{"type":"link","identifier":"section-ivp-euler","label":"section-ivp-euler","kind":"narrative","position":{"start":{"line":226,"column":5},"end":{"line":226,"column":23}},"url":"/euler","internal":true,"dataUrl":"/euler.json","children":[{"type":"text","value":"Euler’s method","key":"Fnpg3Rz8MJ"}],"key":"YYmKNnhoaa"}],"identifier":"id-6-2","label":"6.2 ","html_id":"id-6-2","implicit":true,"key":"G3wHXPpzZM"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-euler-converge","label":"demo-euler-converge","kind":"proof:example","position":{"start":{"line":228,"column":1},"end":{"line":228,"column":21}},"children":[{"type":"text","value":"Example ","key":"Vvy1QIFMHD"},{"type":"text","value":"6.2.1","key":"AEuLC0RJJg"}],"template":"Example %s","enumerator":"6.2.1","resolved":true,"html_id":"demo-euler-converge","remote":true,"url":"/euler","dataUrl":"/euler.json","key":"fEwTkEVeUj"}],"key":"oiuBQ2VOXZ"},{"type":"paragraph","position":{"start":{"line":230,"column":1},"end":{"line":230,"column":1}},"children":[{"type":"text","value":"We consider the ","key":"ZGn0QgQR7o"},{"type":"abbreviation","title":"initial-value problem","children":[{"type":"text","value":"IVP","key":"uv0QwFGfb3"}],"key":"m0zlHgMp2g"}],"key":"gp1R6dQjUD"},{"type":"math","value":"u'=\\sin[(u+t)^2], \\quad t \\in [0,4], \\quad u(0)=-1.","enumerated":false,"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msup><mi>u</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo>=</mo><mi>sin</mi><mo>⁡</mo><mo stretchy=\"false\">[</mo><mo stretchy=\"false\">(</mo><mi>u</mi><mo>+</mo><mi>t</mi><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup><mo stretchy=\"false\">]</mo><mo separator=\"true\">,</mo><mspace width=\"1em\"/><mi>t</mi><mo>∈</mo><mo stretchy=\"false\">[</mo><mn>0</mn><mo separator=\"true\">,</mo><mn>4</mn><mo stretchy=\"false\">]</mo><mo separator=\"true\">,</mo><mspace width=\"1em\"/><mi>u</mi><mo stretchy=\"false\">(</mo><mn>0</mn><mo stretchy=\"false\">)</mo><mo>=</mo><mo>−</mo><mn>1.</mn></mrow><annotation encoding=\"application/x-tex\">u&#x27;=\\sin[(u+t)^2], \\quad t \\in [0,4], \\quad u(0)=-1.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8019em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8019em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop\">sin</span><span class=\"mopen\">[(</span><span class=\"mord mathnormal\">u</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1141em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mclose\">]</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:1em;\"></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">4</span><span class=\"mclose\">]</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:1em;\"></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">−</span><span class=\"mord\">1.</span></span></span></span></span>","key":"WPaN1zPP0Y"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"f = lambda t, u: sin((t + u) ** 2)\ntspan = [0.0, 4.0]\nu0 = -1.0\nt, u = FNC.euler(f, tspan, u0, 20)\n\nfig, ax = subplots()\nax.plot(t, u[0, :], \"-o\", label=\"$n=20$\")\nxlabel(\"$t$\"), ylabel(\"$u(t)$\")\ntitle(\"Solution by Euler's method\")\nlegend();","key":"XF1n3FMfxs"},{"type":"output","id":"y2j6hlyhScXgp-hUz6c8n","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"947eff721e990f45cc6c1f80e6995f97","path":"/build/947eff721e990f45cc6c1f80e6995f97.png"}}}],"key":"mDiIhZcTwW"}],"key":"dbuk52Gzig"},{"type":"paragraph","position":{"start":{"line":250,"column":1},"end":{"line":250,"column":1}},"children":[{"type":"text","value":"We could define a different interpolant to get a smoother picture above, but the derivation of Euler’s method assumed a piecewise linear interpolant, and that sets the limit of its accuracy. We can instead request more steps to make the interpolant look smoother.","position":{"start":{"line":250,"column":1},"end":{"line":250,"column":1}},"key":"FIrphH3eSP"}],"key":"EhAAI87tg0"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"t, u = FNC.euler(f, tspan, u0, 200)\nax.plot(t, u[0, :], label=\"$n=200$\")\nax.legend()\nfig","key":"uoeS9ZnZEf"},{"type":"output","id":"FcbdJlpwCcAkjN0kDA9fm","data":[{"output_type":"execute_result","execution_count":12,"metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"ce88d95b69fd0c294872bd812e820f54","path":"/build/ce88d95b69fd0c294872bd812e820f54.png"}}}],"key":"sB3K5f9Xfa"}],"key":"vghejkF5TX"},{"type":"paragraph","position":{"start":{"line":259,"column":1},"end":{"line":259,"column":1}},"children":[{"type":"text","value":"Increasing ","position":{"start":{"line":259,"column":1},"end":{"line":259,"column":1}},"key":"WVy8QX8haB"},{"type":"inlineMath","value":"n","position":{"start":{"line":259,"column":1},"end":{"line":259,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"MzLCXtTeJ8"},{"type":"text","value":" changed the solution noticeably. Since we know that interpolants and finite differences become more accurate as ","position":{"start":{"line":259,"column":1},"end":{"line":259,"column":1}},"key":"ty0gLYuZMM"},{"type":"inlineMath","value":"h\\to 0","position":{"start":{"line":259,"column":1},"end":{"line":259,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>h</mi><mo>→</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">h\\to 0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">h</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"mJ9hZl7n3S"},{"type":"text","value":", we should anticipate the same behavior from Euler’s method. We don’t have an exact solution to compare to, so we will use ","position":{"start":{"line":259,"column":1},"end":{"line":259,"column":1}},"key":"XJeQQOzgeX"},{"type":"inlineCode","value":"solve_ivp","position":{"start":{"line":259,"column":1},"end":{"line":259,"column":1}},"key":"dy5x39yfLr"},{"type":"text","value":" to construct an accurate reference solution.","position":{"start":{"line":259,"column":1},"end":{"line":259,"column":1}},"key":"hUl9QNNk4J"}],"key":"iSL7NgX3A0"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from scipy.integrate import solve_ivp\nsol = solve_ivp(f, tspan, [u0], dense_output=True, atol=1e-8, rtol=1e-8)\nax.plot(t, sol.sol(t)[0, :], \"--\", label=\"accurate\")\nax.legend()\nfig","key":"us1nbIv3Fl"},{"type":"output","id":"PNuTom4N8L0OpX_Nsc-sS","data":[{"output_type":"execute_result","execution_count":13,"metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"dc8ebf35cbc97d1c3d84147d78a421f0","path":"/build/dc8ebf35cbc97d1c3d84147d78a421f0.png"}}}],"key":"g53aSpKwKf"}],"key":"aefaLgYPVA"},{"type":"paragraph","position":{"start":{"line":269,"column":1},"end":{"line":269,"column":1}},"children":[{"type":"text","value":"Now we can perform a convergence study.","position":{"start":{"line":269,"column":1},"end":{"line":269,"column":1}},"key":"luGKLoLFuM"}],"key":"fwK8MiBN6B"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"n_ = array([int(5 * 10**k) for k in arange(0, 3, 0.5)])\nerr_ = zeros(6)\nresults = PrettyTable([\"n\", \"error\"])\nfor j, n in enumerate(n_):\n    t, u = FNC.euler(f, tspan, u0, n)\n    err_[j] = norm(sol.sol(t)[0, :] - u[0, :], inf)\n    results.add_row((n, err_[j]))\nprint(results)","key":"lhrHYaRgIr"},{"type":"output","id":"D-rk9GuClCUy3nbpNlAeH","data":[{"output_type":"stream","name":"stdout","text":"+------+-----------------------+\n|  n   |         error         |\n+------+-----------------------+\n|  5   |   2.7342049884036537  |\n|  15  |  0.15019897709239743  |\n|  50  |  0.029996197020050186 |\n| 158  |  0.008850284724309654 |\n| 500  | 0.0027366205261378784 |\n| 1581 | 0.0008596857693511373 |\n+------+-----------------------+\n"}],"key":"kYv2WqhEX4"}],"key":"jOwH7uQpYR"},{"type":"paragraph","position":{"start":{"line":282,"column":1},"end":{"line":282,"column":1}},"children":[{"type":"text","value":"The error is approximately cut by a factor of 10 for each increase in ","position":{"start":{"line":282,"column":1},"end":{"line":282,"column":1}},"key":"QkxLohyXN3"},{"type":"inlineMath","value":"n","position":{"start":{"line":282,"column":1},"end":{"line":282,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"XuRL0YZefN"},{"type":"text","value":" by the same factor. A log-log plot also confirms first-order convergence. Keep in mind that since ","position":{"start":{"line":282,"column":1},"end":{"line":282,"column":1}},"key":"Ikblk5ZzJr"},{"type":"inlineMath","value":"h=(b-a)/n","position":{"start":{"line":282,"column":1},"end":{"line":282,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>h</mi><mo>=</mo><mo stretchy=\"false\">(</mo><mi>b</mi><mo>−</mo><mi>a</mi><mo stretchy=\"false\">)</mo><mi mathvariant=\"normal\">/</mi><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">h=(b-a)/n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">h</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">b</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mclose\">)</span><span class=\"mord\">/</span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"QMiUK19Q6t"},{"type":"text","value":", it follows that ","position":{"start":{"line":282,"column":1},"end":{"line":282,"column":1}},"key":"I9J0EZHOSM"},{"type":"inlineMath","value":"O(h)=O(n^{-1})","position":{"start":{"line":282,"column":1},"end":{"line":282,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>h</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>O</mi><mo stretchy=\"false\">(</mo><msup><mi>n</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(h)=O(n^{-1})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">h</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">n</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"IvObz1vDrS"},{"type":"text","value":".","position":{"start":{"line":282,"column":1},"end":{"line":282,"column":1}},"key":"X30ZaiicMk"}],"key":"Gt3S6yZu61"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"loglog(n_, err_, \"-o\", label=\"results\")\nplot(n_, 0.5 * (n_ / n_[0])**(-1), \"--\", label=\"1st order\")\nxlabel(\"$n$\"), ylabel(\"inf-norm error\")\ntitle(\"Convergence of Euler's method\")\nlegend();","key":"N4PUOth5mK"},{"type":"output","id":"7JvRW9-dzUvaRs868E9O8","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"eec6517115113db8100db62dda8b0b79","path":"/build/eec6517115113db8100db62dda8b0b79.png"}}}],"key":"GbD4QXtG8s"}],"key":"ma1l4azqqX"}],"label":"demo-euler-converge-python","identifier":"demo-euler-converge-python","html_id":"demo-euler-converge-python","key":"mYV9EtrggA"},{"type":"heading","depth":3,"position":{"start":{"line":293,"column":1},"end":{"line":293,"column":1}},"children":[{"type":"text","value":"6.3 ","position":{"start":{"line":293,"column":1},"end":{"line":293,"column":1}},"key":"gHzhTCOVrh"},{"type":"link","identifier":"section-ivp-systems","label":"section-ivp-systems","kind":"narrative","position":{"start":{"line":293,"column":5},"end":{"line":293,"column":25}},"url":"/systems","internal":true,"dataUrl":"/systems.json","children":[{"type":"text","value":"IVP systems","key":"FFIk6v9N7y"}],"key":"Zg9h7ZvBsD"}],"identifier":"id-6-3","label":"6.3 ","html_id":"id-6-3","implicit":true,"key":"RPzYqPM5E2"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-systems-predator","label":"demo-systems-predator","kind":"proof:example","position":{"start":{"line":295,"column":1},"end":{"line":295,"column":23}},"children":[{"type":"text","value":"Example ","key":"r5MQW2f9Hf"},{"type":"text","value":"6.3.2","key":"QI29UWVbTw"}],"template":"Example %s","enumerator":"6.3.2","resolved":true,"html_id":"demo-systems-predator","remote":true,"url":"/systems","dataUrl":"/systems.json","key":"q6bD2ySEWn"}],"key":"Iglq5D7zlv"},{"type":"paragraph","position":{"start":{"line":297,"column":1},"end":{"line":297,"column":1}},"children":[{"type":"text","value":"We encode the predator–prey equations via a function.","position":{"start":{"line":297,"column":1},"end":{"line":297,"column":1}},"key":"rRmx3L6bKe"}],"key":"YBDczWCsUg"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def predprey(t, u):\n    y, z = u                        # rename for convenience\n    s = (y * z) / (1 + beta * y)    # appears in both equations\n    return array([y * (1 - alpha * y) - s, -z + s])","key":"oZVdo7e1Mo"},{"type":"output","id":"E6OqM5bizuAbALUrdCD3a","data":[],"key":"aPolkYtEeW"}],"key":"SPinmAWO2a"},{"type":"paragraph","position":{"start":{"line":306,"column":1},"end":{"line":306,"column":1}},"children":[{"type":"text","value":"As before, the ","key":"WESBKJDeB0"},{"type":"abbreviation","title":"ordinary differential equation","children":[{"type":"text","value":"ODE","key":"e1yYDDAPcA"}],"key":"yBH7BMNuWs"},{"type":"text","value":" function must accept three inputs, ","key":"zhUnqZoPrh"},{"type":"inlineCode","value":"u","position":{"start":{"line":306,"column":1},"end":{"line":306,"column":1}},"key":"ku9YIb7O96"},{"type":"text","value":", ","position":{"start":{"line":306,"column":1},"end":{"line":306,"column":1}},"key":"FX3HOlPyOJ"},{"type":"inlineCode","value":"p","position":{"start":{"line":306,"column":1},"end":{"line":306,"column":1}},"key":"La1RgnLBJu"},{"type":"text","value":", and ","position":{"start":{"line":306,"column":1},"end":{"line":306,"column":1}},"key":"oaf85NqdbT"},{"type":"inlineCode","value":"t","position":{"start":{"line":306,"column":1},"end":{"line":306,"column":1}},"key":"xGYgf1dJ3f"},{"type":"text","value":", even though in this case there is no explicit dependence on ","position":{"start":{"line":306,"column":1},"end":{"line":306,"column":1}},"key":"Xx4SJOitN0"},{"type":"inlineCode","value":"t","position":{"start":{"line":306,"column":1},"end":{"line":306,"column":1}},"key":"bETsurx1un"},{"type":"text","value":". The second input is used to pass parameters that don’t change throughout a single instance of the problem.","position":{"start":{"line":306,"column":1},"end":{"line":306,"column":1}},"key":"pzbGCo3vAU"}],"key":"KKIGqkZWBo"},{"type":"paragraph","position":{"start":{"line":308,"column":1},"end":{"line":308,"column":1}},"children":[{"type":"text","value":"To specify the ","key":"QEDW2ltPYD"},{"type":"abbreviation","title":"initial-value problem","children":[{"type":"text","value":"IVP","key":"h5XghRg8uS"}],"key":"O4hwopBuj1"},{"type":"text","value":", we must also provide the initial condition, which is a 2-vector here, and the interval for the independent variable. These are given in the call to ","key":"wOSDAiODzK"},{"type":"inlineCode","value":"solve_ivp","position":{"start":{"line":308,"column":1},"end":{"line":308,"column":1}},"key":"pTGIkSA6Ty"},{"type":"text","value":".","position":{"start":{"line":308,"column":1},"end":{"line":308,"column":1}},"key":"tns1C7MvlR"}],"key":"guKAx2pbuR"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from scipy.integrate import solve_ivp\nu0 = array([1, 0.01])\ntspan = [0.0, 60.0]\nalpha, beta = 0.1, 0.25\nsol = solve_ivp(predprey, tspan, u0, dense_output=True)\nprint(f\"solved with {sol.y.shape[1]} time steps\")","key":"p8Oq6VhUHX"},{"type":"output","id":"j6H987J9PU7xmjr87j3G9","data":[{"output_type":"stream","name":"stdout","text":"solved with 76 time steps\n"}],"key":"xkUG0LP2AL"}],"key":"l9iM5zR9Un"},{"type":"paragraph","position":{"start":{"line":319,"column":1},"end":{"line":319,"column":1}},"children":[{"type":"text","value":"As in scalar problems, the solution object has fields ","position":{"start":{"line":319,"column":1},"end":{"line":319,"column":1}},"key":"u9ahORaUEJ"},{"type":"inlineCode","value":"t","position":{"start":{"line":319,"column":1},"end":{"line":319,"column":1}},"key":"nzChHXsBso"},{"type":"text","value":" and ","position":{"start":{"line":319,"column":1},"end":{"line":319,"column":1}},"key":"Of7z8oYd1R"},{"type":"inlineCode","value":"y","position":{"start":{"line":319,"column":1},"end":{"line":319,"column":1}},"key":"tWYVSulnnJ"},{"type":"text","value":" that contain the values of the independent and dependent variables, respectively. Each row of ","position":{"start":{"line":319,"column":1},"end":{"line":319,"column":1}},"key":"AXjR19iuDa"},{"type":"inlineCode","value":"y","position":{"start":{"line":319,"column":1},"end":{"line":319,"column":1}},"key":"iIsLuURHLB"},{"type":"text","value":" represents one component of the solution at every time step, and each column of ","position":{"start":{"line":319,"column":1},"end":{"line":319,"column":1}},"key":"Ak2LFRkdWl"},{"type":"inlineCode","value":"y","position":{"start":{"line":319,"column":1},"end":{"line":319,"column":1}},"key":"uCzZgxDQTK"},{"type":"text","value":" is the entire solution vector at one time step. Since we used ","position":{"start":{"line":319,"column":1},"end":{"line":319,"column":1}},"key":"piKEwjZ7Ih"},{"type":"inlineCode","value":"dense_output=True","position":{"start":{"line":319,"column":1},"end":{"line":319,"column":1}},"key":"PhZYY2xIo0"},{"type":"text","value":", there is also a method ","position":{"start":{"line":319,"column":1},"end":{"line":319,"column":1}},"key":"iyULY9mG9f"},{"type":"inlineCode","value":"sol","position":{"start":{"line":319,"column":1},"end":{"line":319,"column":1}},"key":"M8lDPJFDNH"},{"type":"text","value":" that can be used to evaluate the solution at any time.","position":{"start":{"line":319,"column":1},"end":{"line":319,"column":1}},"key":"KHSXHVryuk"}],"key":"JIb5O8cyyM"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"t = linspace(0, 60, 1200)\nu = vstack([sol.sol(t[i]) for i in range(t.size)]).T    # same shape as sol.y\nfig, ax = subplots()\nax.plot(t, u[0, :], label=\"prey\")\nax.plot(t, u[1, :], label=\"predator\")\nxlabel(\"$t$\"), ylabel(\"population\")\ntitle((\"Predator-prey solution\"));","key":"sl5PO22IUV"},{"type":"output","id":"HRJwtmAkDirFzLH_Lzzfo","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"abecaccad7d1a0d570f8dbfe13cc5793","path":"/build/abecaccad7d1a0d570f8dbfe13cc5793.png"}}}],"key":"XHrSWYtgV9"}],"key":"uIUggFs7lL"},{"type":"paragraph","position":{"start":{"line":331,"column":1},"end":{"line":331,"column":1}},"children":[{"type":"text","value":"We can also use ","position":{"start":{"line":331,"column":1},"end":{"line":331,"column":1}},"key":"sK7SVJzemr"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-euler","label":"function-euler","children":[{"type":"text","value":"Function ","key":"Vkmtvnhjn5"},{"type":"text","value":"6.2.1","key":"O4Os7rAi1J"}],"template":"Algorithm %s","enumerator":"6.2.1","resolved":true,"html_id":"function-euler","remote":true,"url":"/euler","dataUrl":"/euler.json","key":"e8QOi1hCEK"},{"type":"text","value":" to find the solution.","position":{"start":{"line":331,"column":1},"end":{"line":331,"column":1}},"key":"gG90wFvutA"}],"key":"nAX9I5cwli"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"t_E, u_E = FNC.euler(predprey, tspan, u0, 1001)\nax.scatter(t_E, u_E[0, :], label=\"prey (Euler)\", s=1)\nax.scatter(t_E, u_E[1, :], label=\"predator (Euler)\", s=2)\nax.legend()\nfig","key":"g1uDOg8WMT"},{"type":"output","id":"svtRnQzczWUbsc0XrOgXv","data":[{"output_type":"execute_result","execution_count":19,"metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"98d581c62f1e164cfed1d10e0833f617","path":"/build/98d581c62f1e164cfed1d10e0833f617.png"}}}],"key":"HA42uAGmgj"}],"key":"vm3tYqAzLx"},{"type":"paragraph","position":{"start":{"line":341,"column":1},"end":{"line":341,"column":1}},"children":[{"type":"text","value":"Yotice above that the accuracy of the Euler solution deteriorates rapidly.","position":{"start":{"line":341,"column":1},"end":{"line":341,"column":1}},"key":"HIrOW8W6cv"}],"key":"lW2lqg6xhc"},{"type":"paragraph","position":{"start":{"line":343,"column":1},"end":{"line":343,"column":1}},"children":[{"type":"text","value":"When the solution has two components, it’s common to plot the it in the ","position":{"start":{"line":343,"column":1},"end":{"line":343,"column":1}},"key":"qUFkBZy5oo"},{"type":"emphasis","position":{"start":{"line":343,"column":1},"end":{"line":343,"column":1}},"children":[{"type":"text","value":"phase plane","position":{"start":{"line":343,"column":1},"end":{"line":343,"column":1}},"key":"WpkDlgJJfL"}],"key":"RS9fk5zbMP"},{"type":"text","value":", i.e., with ","position":{"start":{"line":343,"column":1},"end":{"line":343,"column":1}},"key":"Wx9DGo8wr7"},{"type":"inlineMath","value":"u_1","position":{"start":{"line":343,"column":1},"end":{"line":343,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>u</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">u_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"GdU4FDpYM2"},{"type":"text","value":" and ","position":{"start":{"line":343,"column":1},"end":{"line":343,"column":1}},"key":"UIqzf322wQ"},{"type":"inlineMath","value":"u_2","position":{"start":{"line":343,"column":1},"end":{"line":343,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>u</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">u_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"wjfGaG0yG5"},{"type":"text","value":" along the axes and time as a parameterization of the curve.","position":{"start":{"line":343,"column":1},"end":{"line":343,"column":1}},"key":"Aj5FotY06n"}],"key":"JQtR6ugHD7"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plot(u[0, :], u[1, :])\nxlabel(\"prey, $y(t)$\"), ylabel(\"predator, $z(xt)$\")\ntitle(\"Predator-prey solution in the phase plane\");","key":"MCNkgZaT1C"},{"type":"output","id":"kdkQIbNPm4pieNNbQeeDi","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"e834e4e630bc00605a7cfeb32b5c9dd1","path":"/build/e834e4e630bc00605a7cfeb32b5c9dd1.png"}}}],"key":"wb1SJClJde"}],"key":"Ns6IEt2WRf"},{"type":"paragraph","position":{"start":{"line":351,"column":1},"end":{"line":351,"column":1}},"children":[{"type":"text","value":"As time progresses, the point in the phase plane spirals inward toward a limiting closed loop called a ","position":{"start":{"line":351,"column":1},"end":{"line":351,"column":1}},"key":"R4CkY8jr7d"},{"type":"emphasis","position":{"start":{"line":351,"column":1},"end":{"line":351,"column":1}},"children":[{"type":"text","value":"limit cycle","position":{"start":{"line":351,"column":1},"end":{"line":351,"column":1}},"key":"XhzCWbjTrZ"}],"key":"F7dIfRvBd0"},{"type":"text","value":" representing a periodic solution:","position":{"start":{"line":351,"column":1},"end":{"line":351,"column":1}},"key":"BUIfdrRcSu"}],"key":"qy0JYkEmFc"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from matplotlib import animation\nfig, ax = subplots()\ncurve_ = ax.plot(u[0, 0], u[1, 0])[0]\nhead_ = ax.plot(u[0, 0], u[1, 0], 'ro', markersize=6)[0]\n\nax.set_xlabel(\"prey, $y(t)$\")\nax.set_ylabel(\"predator, $z(xt)$\")\nax.set_xlim(0, 9)\nax.set_ylim(0, 6)\nax.set_title(\"Predator-prey solution in the phase plane\")\n\npredator = []\nprey = []\ndef snapshot(t):\n    y, z = sol.sol(t)\n    prey.append(y)\n    predator.append(z)\n    head_.set_data([y], [z])\n    curve_.set_data(prey, predator)\n\nanim = animation.FuncAnimation(\n    fig, snapshot, frames=linspace(0, 60, 801)\n    )\nanim.save(\"figures/predator-prey.mp4\", fps=24)\nclose()","visibility":"hide","key":"FVUPfEK1Dm"},{"type":"output","id":"fuLjUkSD1UQ1NMV4OYnsb","data":[],"visibility":"remove","key":"znFpSwIFIT"}],"data":{"tags":[]},"indexEntries":[{"entry":"Python","subEntry":{"value":"animation","kind":"entry"},"emphasis":false}],"label":"index-Vzo3lSMxUf","identifier":"index-vzo3lsmxuf","html_id":"index-vzo3lsmxuf","visibility":"show","key":"kr54s0pNEj"},{"type":"image","url":"/build/predator-prey-e1deb2791a2918a893e9b6cbcd72bc71.mp4","alt":"Predator–prey solution","position":{"start":{"line":385,"column":1},"end":{"line":385,"column":1}},"key":"lDnja8m5r7","urlSource":"figures/predator-prey.mp4"}],"label":"demo-systems-predator-python","identifier":"demo-systems-predator-python","html_id":"demo-systems-predator-python","key":"uWsEfMEe1I"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-systems-coupledpendula","label":"demo-systems-coupledpendula","kind":"proof:example","position":{"start":{"line":389,"column":1},"end":{"line":389,"column":29}},"children":[{"type":"text","value":"Example ","key":"XngFhV6Dh2"},{"type":"text","value":"6.3.5","key":"Vp25nHVlYr"}],"template":"Example %s","enumerator":"6.3.5","resolved":true,"html_id":"demo-systems-coupledpendula","remote":true,"url":"/systems","dataUrl":"/systems.json","key":"bK6N59CGAq"}],"key":"Qx72Ifw5BW"},{"type":"paragraph","position":{"start":{"line":391,"column":1},"end":{"line":391,"column":1}},"children":[{"type":"text","value":"Let’s implement the coupled pendulums from ","position":{"start":{"line":391,"column":1},"end":{"line":391,"column":1}},"key":"iCFh8HXmW9"},{"type":"crossReference","kind":"proof:example","identifier":"example-systems-coupledpendula","label":"example-systems-coupledpendula","children":[{"type":"text","value":"Example ","key":"JAXXnG64wW"},{"type":"text","value":"6.3.4","key":"B4CbZ8puGb"}],"template":"Example %s","enumerator":"6.3.4","resolved":true,"html_id":"example-systems-coupledpendula","remote":true,"url":"/systems","dataUrl":"/systems.json","key":"fbCdFoJiKS"},{"type":"text","value":". The pendulums will be pulled in opposite directions and then released together from rest.","position":{"start":{"line":391,"column":1},"end":{"line":391,"column":1}},"key":"FeveqTJD7c"}],"key":"gXGUKMqPr9"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def couple(t, u, params):\n    gamma, L, k = params\n    g = 9.8\n    udot = copy(u)\n    udot[:2] = u[2:4]\n    udot[2] = -gamma * u[2] - (g / L) * sin(u[0]) + k * (u[1] - u[0])\n    udot[3] = -gamma * u[3] - (g / L) * sin(u[1]) + k * (u[0] - u[1])\n    return udot\n\nu0 = array([1.25, -0.5, 0, 0])\ntspan = [0.0, 50.0]","key":"cRPQjDGNCG"},{"type":"output","id":"R_j0QsYG0zVOY0nHi88w9","data":[],"key":"sHH6vuxe8E"}],"key":"s0y2yxzxqr"},{"type":"paragraph","position":{"start":{"line":407,"column":1},"end":{"line":407,"column":1}},"children":[{"type":"text","value":"First we check the behavior of the system when the pendulums are uncoupled, i.e., when ","position":{"start":{"line":407,"column":1},"end":{"line":407,"column":1}},"key":"bz1GvUZAF3"},{"type":"inlineMath","value":"k=0","position":{"start":{"line":407,"column":1},"end":{"line":407,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">k=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"yRnq8Zlho1"},{"type":"text","value":".","position":{"start":{"line":407,"column":1},"end":{"line":407,"column":1}},"key":"MXL5CcKYzu"}],"key":"efpZDxUk3l"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"l644A3NfVV"}],"key":"cLVx9fRwGL"},{"type":"paragraph","position":{"start":{"line":410,"column":1},"end":{"line":410,"column":1}},"children":[{"type":"text","value":"We use a closure here to pass the fixed parameter values into ","position":{"start":{"line":410,"column":1},"end":{"line":410,"column":1}},"key":"Ikf1GZ4r41"},{"type":"inlineCode","value":"couple","position":{"start":{"line":410,"column":1},"end":{"line":410,"column":1}},"key":"Ez4xaj2DGg"},{"type":"text","value":".","position":{"start":{"line":410,"column":1},"end":{"line":410,"column":1}},"key":"RkG4ldG569"}],"key":"P74BSCyBsU"}],"class":"dropdown","key":"V0uf0tYYX9"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"gamma, L, k = 0.01, 0.5, 0.0\ndu_dt = lambda t, u: couple(t, u, (gamma, L, k))\nsol = solve_ivp(du_dt, tspan, u0, t_eval=linspace(0, 50, 1001))\nplot(sol.t, sol.y[:2, :].T)    # first two components of solution\nxlabel(\"t\"), ylabel(\"angle\")\ntitle(\"Uncoupled pendulums\");","key":"lEHoKJ2s0Y"},{"type":"output","id":"4ERRtOflYWcCHSifMLlfC","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"0d56bd8059188498775d5b59bcb6a551","path":"/build/0d56bd8059188498775d5b59bcb6a551.png"}}}],"key":"i3E1Ton4FR"}],"key":"beKgMqlkSH"},{"type":"paragraph","position":{"start":{"line":422,"column":1},"end":{"line":422,"column":1}},"children":[{"type":"text","value":"You can see that the pendulums swing independently:","position":{"start":{"line":422,"column":1},"end":{"line":422,"column":1}},"key":"E0RMADtBJz"}],"key":"t8zVkiC8k1"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from matplotlib import animation\nfig, ax = subplots(1, 2)\nrod_ = [] \nbob_ = []\nfor k in [0, 1]:\n    rod_.append(ax[k].plot([], [], linewidth=3)[0])\n    bob_.append(ax[k].scatter([0], [0], color='black', s=50))\n    ax[k].set_aspect('equal')\n    ax[k].set_xlim([-1.1, 1.1])\n    ax[k].set_ylim([-1.1, 0.4])\n    ax[k].set_axis_off()\ntime_ = ax[0].text(-0.95, 0.25, \"\", fontsize=11)\n\ndef snapshot(i):\n    q = sol.y[:2, i]\n    for k in [0, 1]:\n        rod_[k].set_data([0, sin(q[k])], [0, -cos(q[k])])\n        bob_[k].set_offsets([sin(q[k]), -cos(q[k])])\n    time_.set_text(f\"t = {sol.t[i]:.1f} s\")\n\nanim = animation.FuncAnimation(fig, snapshot, frames=401)\nanim.save(\"figures/pendulums-weak.mp4\", fps=24)","visibility":"hide","key":"k1JHQDDjGQ"},{"type":"output","id":"OXx4E-IqVS2Ao5TdhSDTx","data":[{"output_type":"display_data","data":{"text/plain":"<Figure size 700x400 with 2 Axes>","image/png":"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"},"metadata":{},"transient":{}}],"visibility":"remove","key":"HtugVwDKBC"}],"data":{"tags":[]},"visibility":"show","key":"mJjOPAex13"},{"type":"image","url":"/build/pendulums-weak-ae00d46e4aef694bac5ea82d2b0393e0.mp4","alt":"Uncoupled pendulums","position":{"start":{"line":450,"column":1},"end":{"line":450,"column":1}},"key":"PWG0Ug3qzE","urlSource":"figures/pendulums-weak.mp4"},{"type":"paragraph","position":{"start":{"line":452,"column":1},"end":{"line":452,"column":1}},"children":[{"type":"text","value":"Because the model is nonlinear and the initial angles are not small, they have slightly different periods of oscillation, and they go in and out of phase.","position":{"start":{"line":452,"column":1},"end":{"line":452,"column":1}},"key":"g7ahZfIZj7"}],"key":"UJyNvRFj1y"},{"type":"paragraph","position":{"start":{"line":454,"column":1},"end":{"line":454,"column":1}},"children":[{"type":"text","value":"With coupling activated, a different behavior is seen.","position":{"start":{"line":454,"column":1},"end":{"line":454,"column":1}},"key":"kEHkPEVJ2e"}],"key":"hokx03j0JG"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"k = 0.75    # changes the value in the du_dt closure\nsol = solve_ivp(du_dt, tspan, u0, t_eval=linspace(0, 50, 1001))\nplot(sol.t, sol.y[:2, :].T)\nxlabel(\"t\"), ylabel(\"angle\")\ntitle(\"Coupled pendulums\");","key":"tyN5jJ2u0I"},{"type":"output","id":"78DTKsuQd_pHu9vXwq3AU","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"e8009253d6f3391d4afa6da1c93c46f2","path":"/build/e8009253d6f3391d4afa6da1c93c46f2.png"}}}],"key":"RsQVdMmOUG"}],"key":"U0VAJ4A8QM"},{"type":"paragraph","position":{"start":{"line":464,"column":1},"end":{"line":464,"column":1}},"children":[{"type":"text","value":"The coupling makes the pendulums swap energy back and forth:","position":{"start":{"line":464,"column":1},"end":{"line":464,"column":1}},"key":"RtUYISU0jO"}],"key":"U1EpGCFGVb"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"anim = animation.FuncAnimation(fig, snapshot, frames=1001)\nanim.save(\"figures/pendulums-strong.mp4\", fps=24)","visibility":"hide","key":"aPzSs5Ye4S"},{"type":"output","id":"dntxvz3K-0RTmWJhMa9RA","data":[],"visibility":"remove","key":"jZCfOlPYW9"}],"data":{"tags":[]},"visibility":"show","key":"kltzeAqPik"},{"type":"image","url":"/build/pendulums-strong-7d3f81ba422d9fbcdabb8fbc1f27012f.mp4","alt":"Coupled pendulums","position":{"start":{"line":472,"column":1},"end":{"line":472,"column":1}},"key":"jMHzbAa0vo","urlSource":"figures/pendulums-strong.mp4"}],"label":"demo-systems-coupledpendula-python","identifier":"demo-systems-coupledpendula-python","html_id":"demo-systems-coupledpendula-python","key":"xbw6oUS06J"},{"type":"heading","depth":3,"position":{"start":{"line":475,"column":1},"end":{"line":475,"column":1}},"children":[{"type":"text","value":"6.4 ","position":{"start":{"line":475,"column":1},"end":{"line":475,"column":1}},"key":"xDqsCxmnKw"},{"type":"link","identifier":"section-ivp-rk","label":"section-ivp-rk","kind":"narrative","position":{"start":{"line":475,"column":5},"end":{"line":475,"column":20}},"url":"/rk","internal":true,"dataUrl":"/rk.json","children":[{"type":"text","value":"Runge–Kutta methods","key":"UdbfyDj7rh"}],"key":"xJV1z3IkCG"}],"identifier":"id-6-4","label":"6.4 ","html_id":"id-6-4","implicit":true,"key":"nG2e3ZQyvK"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-rk-converge","label":"demo-rk-converge","kind":"proof:example","position":{"start":{"line":477,"column":1},"end":{"line":477,"column":18}},"children":[{"type":"text","value":"Example ","key":"OHUklqMyDY"},{"type":"text","value":"6.4.1","key":"QR0liE5Msc"}],"template":"Example %s","enumerator":"6.4.1","resolved":true,"html_id":"demo-rk-converge","remote":true,"url":"/rk","dataUrl":"/rk.json","key":"UR1XpALefF"}],"key":"m7UDXNIyO0"},{"type":"paragraph","position":{"start":{"line":479,"column":1},"end":{"line":479,"column":1}},"children":[{"type":"text","value":"We solve the ","key":"iydmsMFy6M"},{"type":"abbreviation","title":"initial-value problem","children":[{"type":"text","value":"IVP","key":"IxgX56CDAH"}],"key":"qQfPHBlldf"}],"key":"ELEQ8HBf6h"},{"type":"math","value":"u'=\\sin[(u+t)^2], \\quad t \\in [0,4], \\quad u(0)=-1.","enumerated":false,"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msup><mi>u</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo>=</mo><mi>sin</mi><mo>⁡</mo><mo stretchy=\"false\">[</mo><mo stretchy=\"false\">(</mo><mi>u</mi><mo>+</mo><mi>t</mi><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup><mo stretchy=\"false\">]</mo><mo separator=\"true\">,</mo><mspace width=\"1em\"/><mi>t</mi><mo>∈</mo><mo stretchy=\"false\">[</mo><mn>0</mn><mo separator=\"true\">,</mo><mn>4</mn><mo stretchy=\"false\">]</mo><mo separator=\"true\">,</mo><mspace width=\"1em\"/><mi>u</mi><mo stretchy=\"false\">(</mo><mn>0</mn><mo stretchy=\"false\">)</mo><mo>=</mo><mo>−</mo><mn>1.</mn></mrow><annotation encoding=\"application/x-tex\">u&#x27;=\\sin[(u+t)^2], \\quad t \\in [0,4], \\quad u(0)=-1.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8019em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8019em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop\">sin</span><span class=\"mopen\">[(</span><span class=\"mord mathnormal\">u</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1141em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mclose\">]</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:1em;\"></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">4</span><span class=\"mclose\">]</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:1em;\"></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">−</span><span class=\"mord\">1.</span></span></span></span></span>","key":"WV9RZa9ehg"},{"type":"paragraph","position":{"start":{"line":486,"column":1},"end":{"line":486,"column":1}},"children":[{"type":"text","value":"We use the ","position":{"start":{"line":486,"column":1},"end":{"line":486,"column":1}},"key":"HQWBsqN2K3"},{"type":"inlineCode","value":"solve_ivp","position":{"start":{"line":486,"column":1},"end":{"line":486,"column":1}},"key":"tsUuL2Fpp7"},{"type":"text","value":" function to create an accurate reference solution.","position":{"start":{"line":486,"column":1},"end":{"line":486,"column":1}},"key":"F0NdcLZKfc"}],"key":"mM6u3txfrB"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from scipy.integrate import solve_ivp\ndu_dt = lambda t, u: sin((t + u)**2)\ntspan = (0.0, 4.0)\nu0 = -1.0\nsol = solve_ivp(du_dt, tspan, [u0], dense_output=True, atol=1e-13, rtol=1e-13)\nu_ref = sol.sol","key":"pr6LKZl6BA"},{"type":"output","id":"HxZ_dkNAgtdKKKWyeWih4","data":[],"key":"HmOVPPKRfj"}],"key":"gc54WSJ5F0"},{"type":"paragraph","position":{"start":{"line":497,"column":1},"end":{"line":497,"column":1}},"children":[{"type":"text","value":"Now we perform a convergence study of our two Runge–Kutta implementations.","position":{"start":{"line":497,"column":1},"end":{"line":497,"column":1}},"key":"pLH9a02EoQ"}],"key":"L0hPC2NkyQ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"n = array([int(2 * 10**k) for k in linspace(0, 3, 7)])\nerr = {\"IE2\" : [], \"RK4\" : []}\nresults = PrettyTable([\"n\", \"IE2 error\", \"RK4 error\"])\nfor i in range(len(n)):\n    t, u = FNC.ie2(du_dt, tspan, u0, n[i])\n    err[\"IE2\"].append( abs(u_ref(4)[0] - u[0][-1]) )\n    t, u = FNC.rk4(du_dt, tspan, u0, n[i])\n    err[\"RK4\"].append( abs(u_ref(4)[0] - u[0][-1]) )\n    results.add_row([n[i], err[\"IE2\"][-1], err[\"RK4\"][-1]])\n\nprint(results)","key":"NW2g8V2bTY"},{"type":"output","id":"61SVvh7IrBqQ4T9bu9xG0","data":[{"output_type":"stream","name":"stdout","text":"+------+------------------------+------------------------+\n|  n   |       IE2 error        |       RK4 error        |\n+------+------------------------+------------------------+\n|  2   |   1.7690264118810441   |   0.8206513302232612   |\n|  6   |   0.5126838225133257   |   0.7919245473433536   |\n|  20  |  0.002966971266360252  | 4.0177650143746746e-05 |\n|  63  | 0.00021416270501584123 | 3.581705267929891e-07  |\n| 200  | 1.951309601522233e-05  | 3.326041442264227e-09  |\n| 632  | 1.9058382192405077e-06 | 3.2657876403163755e-11 |\n| 2000 | 1.8883901087285437e-07 | 2.6711965972481266e-13 |\n+------+------------------------+------------------------+\n"}],"key":"q217w8UNrA"}],"key":"glhZs0KhtF"},{"type":"paragraph","position":{"start":{"line":513,"column":1},"end":{"line":513,"column":1}},"children":[{"type":"text","value":"The amount of computational work at each time step is assumed to be proportional to the number of stages. Let’s compare on an apples-to-apples basis by using the number of ","position":{"start":{"line":513,"column":1},"end":{"line":513,"column":1}},"key":"yRzCbnrar2"},{"type":"inlineMath","value":"f","position":{"start":{"line":513,"column":1},"end":{"line":513,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>","key":"EqAqIjdFy2"},{"type":"text","value":"-evaluations on the horizontal axis.","position":{"start":{"line":513,"column":1},"end":{"line":513,"column":1}},"key":"nyaa25kjOJ"}],"key":"DJv60JNiXl"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"loglog(2 * n, err[\"IE2\"], \"-o\", label=\"IE2\")\nloglog(4 * n, err[\"RK4\"], \"-o\", label=\"RK4\")\nplot(2 * n, 0.5 * err[\"IE2\"][-1] * (n / n[-1])**(-2), \"--\", label=\"2nd order\")\nplot(4 * n, 0.5 * err[\"RK4\"][-1] * (n / n[-1])**(-4), \"--\", label=\"4th order\")\n\nxlabel(\"f-evaluations\"),  ylabel(\"inf-norm error\")\nlegend()\ntitle(\"Convergence of RK methods\");","key":"xbNBLfn7zt"},{"type":"output","id":"AFsv7stxTHx1W4pQ9Ot1-","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"8e8567a389adf4c8c08b77d2ef357013","path":"/build/8e8567a389adf4c8c08b77d2ef357013.png"}}}],"key":"bY1JX2qjCX"}],"key":"NkU5Rqek2o"},{"type":"paragraph","position":{"start":{"line":526,"column":1},"end":{"line":526,"column":1}},"children":[{"type":"text","value":"The fourth-order variant is more efficient in this problem over a wide range of accuracy.","position":{"start":{"line":526,"column":1},"end":{"line":526,"column":1}},"key":"eXzBZnHkHh"}],"key":"P6f2hzMasU"}],"label":"demo-rk-converge-python","identifier":"demo-rk-converge-python","html_id":"demo-rk-converge-python","key":"kPT87FoU8S"},{"type":"heading","depth":3,"position":{"start":{"line":529,"column":1},"end":{"line":529,"column":1}},"children":[{"type":"text","value":"6.5 ","position":{"start":{"line":529,"column":1},"end":{"line":529,"column":1}},"key":"UlGZiZ0RVJ"},{"type":"link","identifier":"section-ivp-adaptive","label":"section-ivp-adaptive","kind":"narrative","position":{"start":{"line":529,"column":5},"end":{"line":529,"column":26}},"url":"/adaptive-rk","internal":true,"dataUrl":"/adaptive-rk.json","children":[{"type":"text","value":"Adaptive Runge–Kutta","key":"MhkxYTLjk2"}],"key":"BWVF9RODMY"}],"identifier":"id-6-5","label":"6.5 ","html_id":"id-6-5","implicit":true,"key":"dVYThWak4q"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-adapt-basic","label":"demo-adapt-basic","kind":"proof:example","position":{"start":{"line":531,"column":1},"end":{"line":531,"column":18}},"children":[{"type":"text","value":"Example ","key":"aTuAskZNda"},{"type":"text","value":"6.5.1","key":"l2Mw5166yY"}],"template":"Example %s","enumerator":"6.5.1","resolved":true,"html_id":"demo-adapt-basic","remote":true,"url":"/adaptive-rk","dataUrl":"/adaptive-rk.json","key":"pug2PtgUrl"}],"key":"xWIicj1GoH"},{"type":"paragraph","position":{"start":{"line":533,"column":1},"end":{"line":533,"column":1}},"children":[{"type":"text","value":"Let’s run adaptive RK on  ","position":{"start":{"line":533,"column":1},"end":{"line":533,"column":1}},"key":"XyLIb7D4jz"},{"type":"inlineMath","value":"u'=e^{t-u\\sin u}","position":{"start":{"line":533,"column":1},"end":{"line":533,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>u</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo>=</mo><msup><mi>e</mi><mrow><mi>t</mi><mo>−</mo><mi>u</mi><mi>sin</mi><mo>⁡</mo><mi>u</mi></mrow></msup></mrow><annotation encoding=\"application/x-tex\">u&#x27;=e^{t-u\\sin u}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8305em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8305em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mbin mtight\">−</span><span class=\"mord mathnormal mtight\">u</span><span class=\"mspace mtight\" style=\"margin-right:0.1952em;\"></span><span class=\"mop mtight\"><span class=\"mtight\">s</span><span class=\"mtight\">i</span><span class=\"mtight\">n</span></span><span class=\"mspace mtight\" style=\"margin-right:0.1952em;\"></span><span class=\"mord mathnormal mtight\">u</span></span></span></span></span></span></span></span></span></span></span></span>","key":"lS4Xjamn4e"},{"type":"text","value":".","position":{"start":{"line":533,"column":1},"end":{"line":533,"column":1}},"key":"mX0SCtkD1c"}],"key":"QWuIFwWLOK"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"f = lambda t, u: exp(t - u * sin(u))\nt, u = FNC.rk23(f, [0.0, 5.0], [0.0], 1e-5)\nscatter(t, u[0, :])\nxlabel(\"$t$\"), ylabel(\"$u(t)$\")\ntitle((\"Adaptive IVP solution\"));","key":"fvnydu7dlU"},{"type":"output","id":"FA_9Nf-x6gBXQXtPQrLun","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"b31881398ddc8299ec9fdba3cb528c2b","path":"/build/b31881398ddc8299ec9fdba3cb528c2b.png"}}}],"key":"Ed1b6BAINI"}],"key":"T0O9lzIefg"},{"type":"paragraph","position":{"start":{"line":543,"column":1},"end":{"line":543,"column":1}},"children":[{"type":"text","value":"The solution makes a very abrupt change near ","position":{"start":{"line":543,"column":1},"end":{"line":543,"column":1}},"key":"YC3Klz1ICO"},{"type":"inlineMath","value":"t=2.4","position":{"start":{"line":543,"column":1},"end":{"line":543,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi><mo>=</mo><mn>2.4</mn></mrow><annotation encoding=\"application/x-tex\">t=2.4</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2.4</span></span></span></span>","key":"RC152duaRr"},{"type":"text","value":". The resulting time steps vary over three orders of magnitude.","position":{"start":{"line":543,"column":1},"end":{"line":543,"column":1}},"key":"MN44FI1iY4"}],"key":"GfjuBHkHfL"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"dt = [t[i + 1] - t[i] for i in range(t.size - 1)]\nsemilogy(t[:-1], dt)\nxlabel(\"$t$\"), ylabel(\"time step\")\ntitle((\"Adaptive step sizes\"));","key":"pqFecXChAB"},{"type":"output","id":"7kXooFZL9lqK2cqH9Mhau","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"eba08ff1fba9be126bcf6692936a176b","path":"/build/eba08ff1fba9be126bcf6692936a176b.png"}}}],"key":"OYVJsU3F0E"}],"key":"aKPStIQ8P0"},{"type":"paragraph","position":{"start":{"line":552,"column":1},"end":{"line":552,"column":1}},"children":[{"type":"text","value":"If we had to run with a uniform step size to get this accuracy, it would be","position":{"start":{"line":552,"column":1},"end":{"line":552,"column":1}},"key":"Tu2ahCVQli"}],"key":"AgUGd2r9Vo"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(f\"min step size was {min(dt):.2e}\")","key":"aHn2hNVz2t"},{"type":"output","id":"tVhcEyumq7m4vAVN4-_s4","data":[{"output_type":"stream","name":"stdout","text":"min step size was 4.61e-05\n"}],"key":"XIpqEZpw4j"}],"key":"AZg6c5zxGN"},{"type":"paragraph","position":{"start":{"line":558,"column":1},"end":{"line":558,"column":1}},"children":[{"type":"text","value":"On the other hand, the average step size that was actually taken was","position":{"start":{"line":558,"column":1},"end":{"line":558,"column":1}},"key":"QVaijVVqvP"}],"key":"C9tItuyiG2"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(f\"mean step size was {mean(dt):.2e}\")","key":"YQn0KYaWE7"},{"type":"output","id":"4dhmWb7rZWbqE17f08d-T","data":[{"output_type":"stream","name":"stdout","text":"mean step size was 3.21e-02\n"}],"key":"sg9fOdtiLd"}],"key":"LcRuismWrJ"},{"type":"paragraph","position":{"start":{"line":564,"column":1},"end":{"line":564,"column":1}},"children":[{"type":"text","value":"We took fewer steps by a factor of 1000! Even accounting for the extra stage per step and the occasional rejected step, the savings are clear.","position":{"start":{"line":564,"column":1},"end":{"line":564,"column":1}},"key":"XOxUHaieF9"}],"key":"jwQrFgvG8l"}],"label":"demo-adapt-basic-python","identifier":"demo-adapt-basic-python","html_id":"demo-adapt-basic-python","key":"q7mQwQMEIQ"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-adapt-sing","label":"demo-adapt-sing","kind":"proof:example","position":{"start":{"line":569,"column":1},"end":{"line":569,"column":17}},"children":[{"type":"text","value":"Example ","key":"CUSph9CPNe"},{"type":"text","value":"6.5.2","key":"YFrb5IjLDh"}],"template":"Example %s","enumerator":"6.5.2","resolved":true,"html_id":"demo-adapt-sing","remote":true,"url":"/adaptive-rk","dataUrl":"/adaptive-rk.json","key":"pveoNLrlIi"}],"key":"VYlyKVIHI6"},{"type":"paragraph","position":{"start":{"line":571,"column":1},"end":{"line":571,"column":1}},"children":[{"type":"text","value":"In ","position":{"start":{"line":571,"column":1},"end":{"line":571,"column":1}},"key":"u26Sz1xInS"},{"type":"crossReference","identifier":"demo-basics-sing","label":"demo-basics-sing","kind":"proof:example","position":{"start":{"line":571,"column":4},"end":{"line":571,"column":21}},"children":[{"type":"text","value":"Example ","key":"Y2h7D6fuwU"},{"type":"text","value":"6.1.3","key":"f4gfdDPclf"}],"template":"Example %s","enumerator":"6.1.3","resolved":true,"html_id":"demo-basics-sing","remote":true,"url":"/basics","dataUrl":"/basics.json","key":"hfBhL1Ycp4"},{"type":"text","value":" we saw an ","key":"UKBQAH2Ok7"},{"type":"abbreviation","title":"initial-value problem","children":[{"type":"text","value":"IVP","key":"kXPArU8bv2"}],"key":"PQt6XIoWqI"},{"type":"text","value":" that appears to blow up in a finite amount of time. Because the solution increases so rapidly as it approaches the blowup, adaptive stepping is required even to get close.","key":"j37ADR1HYV"}],"key":"tjgpOmKMIn"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"du_dt = lambda t, u: (t + u)**2\ntspan = (0.0, 2.0)\nu0 = [1.0]\nt, u = FNC.rk23(du_dt, tspan, u0, 1e-5)","key":"qbShrNadC8"},{"type":"output","id":"QzdTq0vgzBPelVBPyKmki","data":[{"output_type":"stream","name":"stderr","text":"/Users/driscoll/miniforge3/envs/myst/lib/python3.13/site-packages/fncbook/chapter06.py:93: UserWarning: Stepsize too small near t=0.785408720407281\n  warnings.warn(f\"Stepsize too small near t={t[i]}\")\n"}],"key":"IMCPhMcDZx"}],"key":"P6qBuk9sXm"},{"type":"paragraph","position":{"start":{"line":580,"column":1},"end":{"line":580,"column":1}},"children":[{"type":"text","value":"In fact, the failure of the adaptivity gives a decent idea of when the singularity occurs.","position":{"start":{"line":580,"column":1},"end":{"line":580,"column":1}},"key":"BCTILpFuMy"}],"key":"tAusehrutY"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"semilogy(t, u[0, :])\nxlabel(\"$t$\"),  ylabel(\"$u(t)$\")\ntitle(\"Finite-time blowup\")\n\ntf = t[-1]\naxvline(x=tf, color='k', linestyle='--', label=f\"t = {tf:.6f}\")\nlegend();","key":"n1kxwm78Ym"},{"type":"output","id":"ebOKXaDaTMIm0CKnR2IgK","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"03e897d55ce9cc0c7d91a683d80d7b5d","path":"/build/03e897d55ce9cc0c7d91a683d80d7b5d.png"}}}],"key":"DQyue07HLg"}],"key":"g0d46M7mBM"}],"label":"demo-adapt-sing-python","identifier":"demo-adapt-sing-python","html_id":"demo-adapt-sing-python","key":"bVglyVN1ie"},{"type":"heading","depth":3,"position":{"start":{"line":593,"column":1},"end":{"line":593,"column":1}},"children":[{"type":"text","value":"6.6 ","position":{"start":{"line":593,"column":1},"end":{"line":593,"column":1}},"key":"gjGgCv9GuR"},{"type":"link","identifier":"section-ivp-multistep","label":"section-ivp-multistep","kind":"narrative","position":{"start":{"line":593,"column":5},"end":{"line":593,"column":27}},"url":"/multistep","internal":true,"dataUrl":"/multistep.json","children":[{"type":"text","value":"Multistep methods","key":"sCdZzyuTy8"}],"key":"w3BmNpegBm"}],"identifier":"id-6-6","label":"6.6 ","html_id":"id-6-6","implicit":true,"key":"N90GUID82D"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-implicit-ab4","label":"demo-implicit-ab4","kind":"proof:example","position":{"start":{"line":595,"column":1},"end":{"line":595,"column":19}},"children":[{"type":"text","value":"Example ","key":"zJ42tt82yY"},{"type":"text","value":"6.7.1","key":"hfVQFO7Nbr"}],"template":"Example %s","enumerator":"6.7.1","resolved":true,"html_id":"demo-implicit-ab4","remote":true,"url":"/implicit","dataUrl":"/implicit.json","key":"FkTBp0SsPY"}],"key":"rrlkvXBzH9"},{"type":"paragraph","position":{"start":{"line":597,"column":1},"end":{"line":597,"column":1}},"children":[{"type":"text","value":"We study the convergence of AB4 using the ","key":"CwzUD1XcRE"},{"type":"abbreviation","title":"initial-value problem","children":[{"type":"text","value":"IVP","key":"LrWQQGbIaI"}],"key":"LoF6Fyl08G"},{"type":"text","value":" ","key":"TyurZfnpi5"},{"type":"inlineMath","value":"u'=\\sin[(u+t)^2]","position":{"start":{"line":597,"column":1},"end":{"line":597,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>u</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo>=</mo><mi>sin</mi><mo>⁡</mo><mo stretchy=\"false\">[</mo><mo stretchy=\"false\">(</mo><mi>u</mi><mo>+</mo><mi>t</mi><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">u&#x27;=\\sin[(u+t)^2]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop\">sin</span><span class=\"mopen\">[(</span><span class=\"mord mathnormal\">u</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mclose\">]</span></span></span></span>","key":"wyy8XxCzhi"},{"type":"text","value":" over ","position":{"start":{"line":597,"column":1},"end":{"line":597,"column":1}},"key":"oUwX8RZq5s"},{"type":"inlineMath","value":"0\\le t \\le 4","position":{"start":{"line":597,"column":1},"end":{"line":597,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0</mn><mo>≤</mo><mi>t</mi><mo>≤</mo><mn>4</mn></mrow><annotation encoding=\"application/x-tex\">0\\le t \\le 4</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7804em;vertical-align:-0.136em;\"></span><span class=\"mord\">0</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7719em;vertical-align:-0.136em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">4</span></span></span></span>","key":"VHBPx5Dkrm"},{"type":"text","value":", with ","position":{"start":{"line":597,"column":1},"end":{"line":597,"column":1}},"key":"cDMu6piA9j"},{"type":"inlineMath","value":"u(0)=-1","position":{"start":{"line":597,"column":1},"end":{"line":597,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo stretchy=\"false\">(</mo><mn>0</mn><mo stretchy=\"false\">)</mo><mo>=</mo><mo>−</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">u(0)=-1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">−</span><span class=\"mord\">1</span></span></span></span>","key":"qWxwthXyz1"},{"type":"text","value":". As usual, ","position":{"start":{"line":597,"column":1},"end":{"line":597,"column":1}},"key":"bDXElapXMD"},{"type":"inlineCode","value":"solve_ivp","position":{"start":{"line":597,"column":1},"end":{"line":597,"column":1}},"key":"q3tRFsNBwk"},{"type":"text","value":" is called to give an accurate reference solution.","position":{"start":{"line":597,"column":1},"end":{"line":597,"column":1}},"key":"TuctDqMQGd"}],"key":"KlV7Ppfz6s"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from scipy.integrate import solve_ivp\ndu_dt = lambda t, u: sin((t + u)**2)\ntspan = (0.0, 4.0)\nu0 = [-1.0]\nu_ref = solve_ivp(du_dt, tspan, u0, dense_output=True, rtol=1e-13, atol=1e-13).sol","key":"f11IkMDPyR"},{"type":"output","id":"hYxITU6JAvq831jMj3LZh","data":[],"key":"BpfUs2wk74"}],"key":"AZ07DWkNxv"},{"type":"paragraph","position":{"start":{"line":607,"column":1},"end":{"line":607,"column":1}},"children":[{"type":"text","value":"Now we perform a convergence study of the AB4 code.","position":{"start":{"line":607,"column":1},"end":{"line":607,"column":1}},"key":"sQQuX5ZoPQ"}],"key":"C5DDRhkAdG"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"n = array([int(4 * 10**k) for k in linspace(0, 3, 7)])\nerr = []\nresults = PrettyTable([\"n\", \"AB4 error\"])\nfor i in range(len(n)):\n    t, u = FNC.ab4(du_dt, tspan, u0, n[i])\n    err.append( abs(u_ref(4)[0] - u[0][-1]) )\n    results.add_row([n[i], err[-1]])\n\nprint(results)","key":"pf78MFS6As"},{"type":"output","id":"8VEyuxxL5-86esab_hOrf","data":[{"output_type":"stream","name":"stdout","text":"+------+------------------------+\n|  n   |       AB4 error        |\n+------+------------------------+\n|  4   |   0.5004401704518087   |\n|  12  |   0.9739144270683615   |\n|  40  | 2.218067629233822e-05  |\n| 126  | 3.9306304588926366e-07 |\n| 400  | 4.561844235695389e-09  |\n| 1264 | 4.791389507374788e-11  |\n| 4000 | 5.426770144367765e-13  |\n+------+------------------------+\n"}],"key":"wAaRk1gieK"}],"key":"ne7RmeWC9P"},{"type":"paragraph","position":{"start":{"line":621,"column":1},"end":{"line":621,"column":1}},"children":[{"type":"text","value":"The method should converge as ","position":{"start":{"line":621,"column":1},"end":{"line":621,"column":1}},"key":"vIQhRCtvFF"},{"type":"inlineMath","value":"O(h^4)","position":{"start":{"line":621,"column":1},"end":{"line":621,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><msup><mi>h</mi><mn>4</mn></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(h^4)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">h</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">4</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"wK030hQ3qU"},{"type":"text","value":", so a log-log scale is appropriate for the errors.","position":{"start":{"line":621,"column":1},"end":{"line":621,"column":1}},"key":"opOkZkORpj"}],"key":"nCY3XM3odL"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"loglog(n, err, \"-o\", label=\"AB4\")\nloglog(n, 0.5 * err[-1] * (n / n[-1])**(-4), \"--\", label=\"4th order\")\n\nxlabel(\"$n$\"),  ylabel(\"final error\")\nlegend(), title(\"Convergence of AB4\");","key":"BJsyQQ9x88"},{"type":"output","id":"8W0_cBCd6EQOcDcddy7rG","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"8258e42152a2788eed5c2486e6a9d271","path":"/build/8258e42152a2788eed5c2486e6a9d271.png"}}}],"key":"K6znPiXg2E"}],"key":"g0cRf5cGyP"}],"label":"demo-implicit-ab4-python","identifier":"demo-implicit-ab4-python","html_id":"demo-implicit-ab4-python","key":"Tnu2w2alXd"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-implicit-stiff","label":"demo-implicit-stiff","kind":"proof:example","position":{"start":{"line":633,"column":1},"end":{"line":633,"column":21}},"children":[{"type":"text","value":"Example ","key":"Y8spD88yRw"},{"type":"text","value":"6.7.2","key":"YWe2IqdndH"}],"template":"Example %s","enumerator":"6.7.2","resolved":true,"html_id":"demo-implicit-stiff","remote":true,"url":"/implicit","dataUrl":"/implicit.json","key":"e7b5kilQ6i"}],"key":"Y5ugQlCAwJ"},{"type":"paragraph","position":{"start":{"line":635,"column":1},"end":{"line":635,"column":1}},"children":[{"type":"text","value":"The following simple ","key":"MagOw0vda2"},{"type":"abbreviation","title":"ordinary differential equation","children":[{"type":"text","value":"ODE","key":"DNMUC5jn7d"}],"key":"qxSvZJegZo"},{"type":"text","value":" uncovers a surprise.","key":"utYelkwGYZ"}],"key":"soJVBaBqGp"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"f = lambda t, u: u**2 - u**3\nu0 = array([0.005])\ntspan = [0, 400]","key":"tcAg7FO0v6"},{"type":"output","id":"L_rab-E7ALdcrX-5gG-Rp","data":[],"key":"EwoZjQUskd"}],"key":"syeHAxhf5c"},{"type":"paragraph","position":{"start":{"line":643,"column":1},"end":{"line":643,"column":1}},"children":[{"type":"text","value":"We will solve the problem first with the implicit AM2 method using ","position":{"start":{"line":643,"column":1},"end":{"line":643,"column":1}},"key":"LVvTqQLfjV"},{"type":"inlineMath","value":"n=200","position":{"start":{"line":643,"column":1},"end":{"line":643,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>=</mo><mn>200</mn></mrow><annotation encoding=\"application/x-tex\">n=200</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">200</span></span></span></span>","key":"sTfTofbvND"},{"type":"text","value":" steps.","position":{"start":{"line":643,"column":1},"end":{"line":643,"column":1}},"key":"R2ADIQGPgh"}],"key":"NXAeaxWUui"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"tI, uI = FNC.am2(f, [0.0, 400.0], u0, 200)\nfig, ax = subplots()\nax.plot(tI, uI[0], label=\"AM2\")\nxlabel(\"$t$\"), ylabel(\"$y(t)$\");","key":"E894LBUjpy"},{"type":"output","id":"C-x_lM0J3Mo42h_lR6tSQ","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"8d6200403f0c49976bff909ba13f16c5","path":"/build/8d6200403f0c49976bff909ba13f16c5.png"}}}],"key":"drzMBFV57G"}],"key":"oKSxeZcCpq"},{"type":"paragraph","position":{"start":{"line":652,"column":1},"end":{"line":652,"column":1}},"children":[{"type":"text","value":"So far, so good. Now we repeat the process using the explicit AB4 method.","position":{"start":{"line":652,"column":1},"end":{"line":652,"column":1}},"key":"AqALMZ1hmF"}],"key":"iIovksjfls"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"tE, uE = FNC.ab4(f, [0.0, 400.0], u0, 200)\nax.scatter(tE, uE[0], label=\"AB4\")\nax.set_ylim([-4, 2]), ax.legend()\nfig","key":"vaXsOv8GBk"},{"type":"output","id":"Np9PVckoFQelmMXGsbMo7","data":[{"output_type":"stream","name":"stderr","text":"/var/folders/0m/fy_f4_rx5xv68sdkrpcm26r00000gq/T/ipykernel_87230/862619530.py:1: RuntimeWarning: overflow encountered in square\n  f = lambda t, u: u**2 - u**3\n/var/folders/0m/fy_f4_rx5xv68sdkrpcm26r00000gq/T/ipykernel_87230/862619530.py:1: RuntimeWarning: overflow encountered in power\n  f = lambda t, u: u**2 - u**3\n/var/folders/0m/fy_f4_rx5xv68sdkrpcm26r00000gq/T/ipykernel_87230/862619530.py:1: RuntimeWarning: invalid value encountered in subtract\n  f = lambda t, u: u**2 - u**3\n"},{"output_type":"execute_result","execution_count":41,"metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"5f0c053c53937cc67be1dc7b09fbafdc","path":"/build/5f0c053c53937cc67be1dc7b09fbafdc.png"}}}],"key":"XiKNJfueZK"}],"key":"Fkkr0ZVO9f"},{"type":"paragraph","position":{"start":{"line":661,"column":1},"end":{"line":661,"column":1}},"children":[{"type":"text","value":"Once the solution starts to take off, the AB4 result goes catastrophically wrong.","position":{"start":{"line":661,"column":1},"end":{"line":661,"column":1}},"key":"Lm9IAVy7Lh"}],"key":"Rp6k2HnUv4"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"uE[0, 104:111]","key":"EUKZmkNFhS"},{"type":"output","id":"4SC06BdPcQTPPergq6ILg","data":[{"output_type":"execute_result","execution_count":42,"metadata":{},"data":{"text/plain":{"content":"array([ 7.55385780e-01,  1.43729703e+00, -3.28897685e+00,  2.14179113e+02,\n       -4.48208915e+07,  4.12689029e+23, -3.22144124e+71])","content_type":"text/plain"}}}],"key":"OhWDBSOHa3"}],"key":"OB3pwL2Vgk"},{"type":"paragraph","position":{"start":{"line":667,"column":1},"end":{"line":667,"column":1}},"children":[{"type":"text","value":"We hope that AB4 will converge in the limit ","position":{"start":{"line":667,"column":1},"end":{"line":667,"column":1}},"key":"nAUUP9jaW1"},{"type":"inlineMath","value":"h\\to 0","position":{"start":{"line":667,"column":1},"end":{"line":667,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>h</mi><mo>→</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">h\\to 0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">h</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"yLmvlauedO"},{"type":"text","value":", so let’s try using more steps.","position":{"start":{"line":667,"column":1},"end":{"line":667,"column":1}},"key":"DRFreKmkdg"}],"key":"RDvkkbHz0g"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plot(tI, uI[0], color=\"k\", label=\"AM2\")\ntE, uE = FNC.ab4(f, [0, 400], u0, 1000)\nplot(tE, uE[0], \".-\", label=\"AM4, n=1000\")\ntE, uE = FNC.ab4(f, [0, 400], u0, 1600)\nplot(tE, uE[0], \".-\", label=\"AM4, n=1600\")\nxlabel(\"$t$\"),  ylabel(\"$u(t)$\")\nlegend();","key":"J59KVDNlft"},{"type":"output","id":"OHLbZhm59sZwuB_xXEBl_","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"493f1c94f7df7f75e7bfe7ad1b85ce55","path":"/build/493f1c94f7df7f75e7bfe7ad1b85ce55.png"}}}],"key":"tH8VZJLQKY"}],"key":"GPMjd5VtBg"},{"type":"paragraph","position":{"start":{"line":679,"column":1},"end":{"line":679,"column":1}},"children":[{"type":"text","value":"So AB4, which is supposed to be ","position":{"start":{"line":679,"column":1},"end":{"line":679,"column":1}},"key":"d07oZ6TSPL"},{"type":"emphasis","position":{"start":{"line":679,"column":1},"end":{"line":679,"column":1}},"children":[{"type":"text","value":"more","position":{"start":{"line":679,"column":1},"end":{"line":679,"column":1}},"key":"Wa5rtRfoSX"}],"key":"IbM0X8xjkP"},{"type":"text","value":" accurate than AM2, actually needs something like 8 times as many steps to get a reasonable-looking answer!","position":{"start":{"line":679,"column":1},"end":{"line":679,"column":1}},"key":"jnn72xgmvw"}],"key":"o9UxYRMgKX"}],"label":"demo-implicit-stiff-python","identifier":"demo-implicit-stiff-python","html_id":"demo-implicit-stiff-python","key":"skK5yY9ofh"},{"type":"heading","depth":3,"position":{"start":{"line":682,"column":1},"end":{"line":682,"column":1}},"children":[{"type":"text","value":"6.7 ","position":{"start":{"line":682,"column":1},"end":{"line":682,"column":1}},"key":"IGQND5XwvF"},{"type":"link","identifier":"section-ivp-implicit","label":"section-ivp-implicit","kind":"narrative","position":{"start":{"line":682,"column":5},"end":{"line":682,"column":26}},"url":"/implicit","internal":true,"dataUrl":"/implicit.json","children":[{"type":"text","value":"Implementation of multistep methods","key":"fhi6PIVSYF"}],"key":"tRgb7kL2Au"}],"identifier":"id-6-7","label":"6.7 ","html_id":"id-6-7","implicit":true,"key":"MsYHC2orkL"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-zs-liaf","label":"demo-zs-LIAF","kind":"proof:example","position":{"start":{"line":684,"column":1},"end":{"line":684,"column":14}},"children":[{"type":"text","value":"Example ","key":"TiUHpOQPLq"},{"type":"text","value":"6.8.1","key":"Z1nA5EX6TK"}],"template":"Example %s","enumerator":"6.8.1","resolved":true,"html_id":"demo-zs-liaf","remote":true,"url":"/zerostability","dataUrl":"/zerostability.json","key":"glQS9kUOnZ"}],"key":"Upg0ns0q5x"},{"type":"paragraph","position":{"start":{"line":686,"column":1},"end":{"line":686,"column":1}},"children":[{"type":"text","value":"We’ll measure the error at the time ","position":{"start":{"line":686,"column":1},"end":{"line":686,"column":1}},"key":"LucRnjJiTj"},{"type":"inlineMath","value":"t=1","position":{"start":{"line":686,"column":1},"end":{"line":686,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">t=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"aIteRbAm4j"},{"type":"text","value":".","position":{"start":{"line":686,"column":1},"end":{"line":686,"column":1}},"key":"JfjDXGuagD"}],"key":"uyxzkd1O7n"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"du_dt = lambda t, u: u\nu_exact = exp\na, b = (0.0, 1.0)\n\ndef LIAF(du_dt, tspan, u0, n):\n    a, b = tspan\n    h = (b - a) / n\n    t = linspace(a, b, n+1)\n    u = np.tile(np.array(u0), (n+1, 1))\n    u[1] = u_exact(t[1])    # use an exact starting value\n    f = copy(u)\n    f[0] = du_dt(t[0], u[0])\n    for i in range(n):\n        f[i] = du_dt(t[i], u[i])\n        u[i + 1] = -4 * u[i] + 5 * u[i-1] + h * (4 * f[i] + 2 * f[i-1])\n\n    return t, u.T\n\nn = [5, 10, 20, 40, 60]\nresults = PrettyTable([\"n\", \"error\"])\nfor j in range(5):\n    t, u = LIAF(du_dt, [a, b], [1.0], n[j])\n    err = abs(u_exact(b) - u[0, -1])\n    results.add_row([n[j], err])\nprint(results)","key":"gKmSNcTRfl"},{"type":"output","id":"kB2OsbYGoHbAYZcYGIcTt","data":[{"output_type":"stream","name":"stdout","text":"+----+------------------------+\n| n  |         error          |\n+----+------------------------+\n| 5  |    293.502838171541    |\n| 10 |   452905.58324991807   |\n| 20 |   2196838145485.221    |\n| 40 | 1.0437865522698013e+26 |\n| 60 | 6.628042953187168e+39  |\n+----+------------------------+\n"}],"key":"KHPk6iBuWX"}],"key":"M6rsA9Gh1p"},{"type":"paragraph","position":{"start":{"line":716,"column":1},"end":{"line":716,"column":1}},"children":[{"type":"text","value":"There is no convergence in sight! A graph of the last numerical attempt yields a clue:","position":{"start":{"line":716,"column":1},"end":{"line":716,"column":1}},"key":"YJx6pGRUzi"}],"key":"HPf87ANZbz"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"semilogy(t, abs(u[0]), \"-o\")\nxlabel(\"$t$\"), ylabel(\"$|u|$\")\ntitle((\"LIAF solution\"));","key":"Jrtt9Jl7et"},{"type":"output","id":"hPcz1xjA6qrjiG6pHnn1v","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"14bf17f4046b97769fe2ad2f60f12712","path":"/build/14bf17f4046b97769fe2ad2f60f12712.png"}}}],"key":"K0HeIacO8D"}],"key":"LYXqh31WLQ"},{"type":"paragraph","position":{"start":{"line":724,"column":1},"end":{"line":724,"column":1}},"children":[{"type":"text","value":"It’s clear that the solution is growing exponentially in time.","position":{"start":{"line":724,"column":1},"end":{"line":724,"column":1}},"key":"gowbPXKIDV"}],"key":"Hh2GkBQCQ0"}],"label":"demo-zs-LIAF-python","identifier":"demo-zs-liaf-python","html_id":"demo-zs-liaf-python","key":"GCZfuVfzFL"}],"key":"b18dfA0ATd"}],"key":"kgAofhSmrH"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Chapter 5","url":"/chapter5-2","group":"Python codes"},"next":{"title":"Chapter 7","url":"/chapter7-2","group":"Python codes"}}},"domain":"http://localhost:3000"}