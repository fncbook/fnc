---
kernelspec:
  display_name: Python 3
  language: python
  name: python3
numbering:
  headings: false
---
# Chapter 8

## Functions

(function-poweriter-python)=
``````{dropdown} Power iteration
```{literalinclude} ../python/pkg/FNC/FNC08.py
:filename: poweriter.py
:start-at: def poweriter
:end-at: return gamma, x
:language: python
:linenos: true
```
``````

(function-inviter-python)=
``````{dropdown} Inverse iteration
```{literalinclude} ../python/pkg/FNC/FNC08.py
:filename: inviter.py
:start-at: def inviter
:end-at: return gamma, x
:language: python
:linenos: true
```
``````

(function-arnoldi-python)=
``````{dropdown} Arnoldi iteration
```{literalinclude} ../python/pkg/FNC/FNC08.py
:filename: arnoldi.py
:start-at: def arnoldi
:end-at: return Q, H
:language: python
:linenos: true
```

```{admonition} About the code
The loop starting at line 17 does not exactly implement {eq}`arnoldiip` and {eq}`arnoldigs`. The reason is numerical stability. Though the described and implemented versions are mathematically equivalent in exact arithmetic (see [Exercise 6](problem-subspace-modifiedgs)), the approach in {numref}`Function {number} <function-arnoldi>` is more stable.
```
``````

(function-gmres-python)=
``````{dropdown} GMRES
```{literalinclude} ../python/pkg/FNC/FNC08.py
:filename: gmres.py
:start-at: def arngmres
:end-at: return x, residual
:language: python
:linenos: true
```
``````

## Examples

```{code-cell} ipython3
from numpy import *
from numpy.linalg import norm
from matplotlib.pyplot import *
from prettytable import PrettyTable
import sys
sys.path.append('pkg/')
import FNC
import importlib
importlib.reload(FNC)
```

```{code-cell} ipython3
:tags: [remove-cell]
# This (optional) block is for improving the display of plots.
rcParams["figure.figsize"] = [7, 4]
rcParams["lines.linewidth"] = 2
rcParams["lines.markersize"] = 4
rcParams['animation.html'] = "jshtml"  # or try "html5"
``` 
