{"kind":"Notebook","sha256":"94e515425607727af504459936aef2a3f77f56d325996c11041435d27ff4fc17","slug":"lufact-2","location":"/chapter2/section5/python/lufact.ipynb","dependencies":[],"frontmatter":{"numbering":{"heading_1":{"enabled":false},"heading_2":{"enabled":false},"heading_3":{"enabled":false},"heading_4":{"enabled":false},"heading_5":{"enabled":false},"heading_6":{"enabled":false}},"kernelspec":{"name":"python3","display_name":"myst","language":"python"},"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"exports":[{"format":"ipynb","filename":"lufact.ipynb","url":"/build/lufact-4abcd50772de8e6d3f24ad091f05a845.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:43:30.791364Z","iopub.status.busy":"2025-01-11T17:43:30.791038Z","iopub.status.idle":"2025-01-11T17:43:31.590243Z","shell.execute_reply":"2025-01-11T17:43:31.589936Z"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"exec(open(\"../../../python/FNC_init.py\").read())","visibility":"show","key":"EO1uhNGKtV"},{"type":"output","id":"Ug1E1nA3BWzbp_QzMqBNd","data":[],"visibility":"show","key":"uCTMUaYTuu"}],"visibility":"remove","key":"uQe4w5Sf1m"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"fl30VL09Op"},{"type":"text","value":"2.5.6","key":"L4KXejTUCe"}],"key":"iCJxLoV80I"}],"identifier":"demo-flops-lufact","label":"demo-flops-lufact","kind":"proof:example","template":"Example %s","enumerator":"2.5.6","resolved":true,"html_id":"demo-flops-lufact","remote":true,"url":"/efficiency","dataUrl":"/efficiency.json","key":"THf1ekrtmv"}],"key":"VUxREo702J"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"We’ll test the conclusion of ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"BqsDkWIGxs"},{"type":"inlineMath","value":"O(n^3)","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><msup><mi>n</mi><mn>3</mn></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(n^3)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">n</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"cHfnolOik4"},{"type":"text","value":" flops experimentally using the ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"x23LnpBwq6"},{"type":"inlineCode","value":"lu","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"p4QszUPHfS"},{"type":"text","value":" function imported from ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"EfuQxG8DvV"},{"type":"inlineCode","value":"scipi.linalg","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"bLVe8dMLu7"},{"type":"text","value":".","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"Kq95ExzZKK"}],"key":"vXw9ItTOyO"}],"key":"DVj7Qn7i0p"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:43:31.591838Z","iopub.status.busy":"2025-01-11T17:43:31.591701Z","iopub.status.idle":"2025-01-11T17:43:34.186051Z","shell.execute_reply":"2025-01-11T17:43:34.185721Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"from scipy.linalg import lu\nN = arange(400, 3600, 400)\nt = zeros(len(N))\nfor i, n in enumerate(N):\n    A = random.randn(n,n)  \n    start = timer()\n    for j in range(5): lu(A)\n    t[i] = timer() - start","key":"BdfwjjGL6T"},{"type":"output","id":"hjeLr6pzsaUa0nW5XsdFI","data":[],"key":"DbOhGY9DmX"}],"key":"QF1xgIftm9"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We plot the timings on a log-log graph and compare it to ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OSBsYOKNTV"},{"type":"inlineMath","value":"O(n^3)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><msup><mi>n</mi><mn>3</mn></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(n^3)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">n</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"GghGufheOt"},{"type":"text","value":". The result could vary significantly from machine to machine, but in theory the data should start to parallel the line as ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"iUPXkPxY0A"},{"type":"inlineMath","value":"n\\to\\infty","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>→</mo><mi mathvariant=\"normal\">∞</mi></mrow><annotation encoding=\"application/x-tex\">n\\to\\infty</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord\">∞</span></span></span></span>","key":"cqIkbmZrdJ"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"iANQxvJgum"}],"key":"Hm8uQq3vGH"}],"key":"comrz2Qu2F"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:43:34.187659Z","iopub.status.busy":"2025-01-11T17:43:34.187554Z","iopub.status.idle":"2025-01-11T17:43:34.420988Z","shell.execute_reply":"2025-01-11T17:43:34.420664Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"loglog(N, t, \"-o\", label=\"obseved\")\nloglog(N, 2 * t[-1] * (N / N[-1])**3, \"k--\", label=\"$O(n^3)$\")\nlegend();\nxlabel(\"$n$\");\nylabel(\"elapsed time (sec)\");\ntitle(\"Timing of LU factorizations\");","key":"nZZncxMjUC"},{"type":"output","id":"MESsbV0WTSrW_kt3e_6ML","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"7b3d111140b2205eef4be1edae535fbc","path":"/build/7b3d111140b2205eef4be1edae535fbc.png"},"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"}}}],"key":"emxvwGXjsL"}],"key":"tVFQq0zUcS"}],"key":"MjSNnu5dOc"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Loglog","url":"/loglog-2","group":"Chapter 2"},"next":{"title":"Fail","url":"/fail-2","group":"Chapter 2"}}},"domain":"http://localhost:3000"}