{"kind":"Article","sha256":"f5e245ff8f42da497a35e562f82182761221e37dd9fc1c89329b6c8543cd2ce4","slug":"diffmats","location":"/chapter10/diffmats.md","dependencies":[{"url":"/chapter10","label":"demo-diffmats-2nd-julia","kind":"Notebook","slug":"chapter10","location":"/julia/chapter10.md","title":"Chapter 10"},{"url":"/chapter10-1","label":"demo-diffmats-2nd-matlab","kind":"Notebook","slug":"chapter10-1","location":"/matlab/chapter10.md","title":"Chapter 10"},{"url":"/chapter10-2","label":"demo-diffmats-2nd-python","kind":"Notebook","slug":"chapter10-2","location":"/python/chapter10.md","title":"Chapter 10"}],"frontmatter":{"title":"Differentiation matrices","numbering":{"heading_1":{"enabled":true},"heading_2":{"enabled":true},"heading_3":{"enabled":false},"enumerator":{"enumerator":"10.3.%s"},"title":{"offset":1}},"content_includes_title":false,"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"edit_url":"https://github.com/fncbook/fnc/blob/master/chapter10/diffmats.md","exports":[{"format":"md","filename":"diffmats.md","url":"/build/diffmats-e3f0c76000b77e5830c02e41f0cb4fe2.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"In ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"Lk5ybEyg4C"},{"type":"link","kind":"numref","identifier":"section-localapprox-finitediffs","label":"section-localapprox-finitediffs","url":"/finitediffs","internal":true,"dataUrl":"/finitediffs.json","children":[{"type":"text","value":"Finite differences","key":"Iyl1NWS53t"}],"key":"jaVQg2qP7k"},{"type":"text","value":" we used finite differences to turn a discrete collection of function values into an estimate of the derivative of the function at a point. Just as with differentiation in elementary calculus, we can generalize differences at a point into an operation that maps discretized functions to discretized derivatives.","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"fdhCFop7un"}],"indexEntries":[{"entry":"finite differences","subEntry":{"value":"matrix","kind":"entry"},"emphasis":false}],"label":"index-n4Ex3wRE2e","identifier":"index-n4ex3wre2e","html_id":"index-n4ex3wre2e","key":"a8t6Q8PmRC"},{"type":"heading","depth":2,"position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Matrices for finite differences","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"n0IMXYp0iP"}],"identifier":"matrices-for-finite-differences","label":"Matrices for finite differences","html_id":"matrices-for-finite-differences","implicit":true,"enumerator":"10.3.1","key":"GgdOtuvuc5"},{"type":"paragraph","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"We first discretize the interval ","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"nrAJWcwNAH"},{"type":"inlineMath","value":"x\\in[a,b]","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mo>∈</mo><mo stretchy=\"false\">[</mo><mi>a</mi><mo separator=\"true\">,</mo><mi>b</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">x\\in[a,b]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">a</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">b</span><span class=\"mclose\">]</span></span></span></span>","key":"PX9RjpeQdJ"},{"type":"text","value":" into equal pieces of length ","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"FfiRnDI74K"},{"type":"inlineMath","value":"h=(b-a)/n","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>h</mi><mo>=</mo><mo stretchy=\"false\">(</mo><mi>b</mi><mo>−</mo><mi>a</mi><mo stretchy=\"false\">)</mo><mi mathvariant=\"normal\">/</mi><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">h=(b-a)/n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">h</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">b</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mclose\">)</span><span class=\"mord\">/</span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"LGDQ2f8GDG"},{"type":"text","value":", leading to the nodes","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"d4fPsn1Rqr"}],"key":"lnAHZXPehi"},{"type":"math","value":"x_i=a+i h, \\qquad  i=0,\\ldots,n.","position":{"start":{"line":17,"column":1},"end":{"line":19,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>x</mi><mi>i</mi></msub><mo>=</mo><mi>a</mi><mo>+</mo><mi>i</mi><mi>h</mi><mo separator=\"true\">,</mo><mspace width=\"2em\"/><mi>i</mi><mo>=</mo><mn>0</mn><mo separator=\"true\">,</mo><mo>…</mo><mo separator=\"true\">,</mo><mi>n</mi><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">x_i=a+i h, \\qquad  i=0,\\ldots,n.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">ih</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:2em;\"></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">i</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8389em;vertical-align:-0.1944em;\"></span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mord\">.</span></span></span></span></span>","enumerator":"10.3.1","key":"KhfdVeDgSI"},{"type":"paragraph","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"Note again that our node indexing scheme starts at zero. Our goal is to find a vector ","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"vFxgTSkjAV"},{"type":"inlineMath","value":"\\mathbf{g}","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">g</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{g}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6389em;vertical-align:-0.1944em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">g</span></span></span></span>","key":"ppIzOgyfjt"},{"type":"text","value":" such that ","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"jcJHoGhEZG"},{"type":"inlineMath","value":"g_i \\approx f'(x_i)","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>g</mi><mi>i</mi></msub><mo>≈</mo><msup><mi>f</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">g_i \\approx f&#x27;(x_i)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6776em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0019em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"XNe2AQ0oIi"},{"type":"text","value":" for ","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"VAAF5OcNq8"},{"type":"inlineMath","value":"i=0,\\ldots,n","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi><mo>=</mo><mn>0</mn><mo separator=\"true\">,</mo><mo>…</mo><mo separator=\"true\">,</mo><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">i=0,\\ldots,n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8389em;vertical-align:-0.1944em;\"></span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"dyavrqfCj7"},{"type":"text","value":". Our first try is the forward difference formula ","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"Wn1qkPw9xL"},{"type":"crossReference","kind":"equation","identifier":"forwardfd11","label":"forwardFD11","children":[{"type":"text","value":"(","key":"vnIVYzgPAX"},{"type":"text","value":"5.4.2","key":"T0lTNbumwS"},{"type":"text","value":")","key":"MqpR3sQzWN"}],"template":"(%s)","enumerator":"5.4.2","resolved":true,"html_id":"forwardfd11","remote":true,"url":"/finitediffs","dataUrl":"/finitediffs.json","key":"qPFW1KtH6a"},{"type":"text","value":",","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"oOvYVixJ7v"}],"key":"O6x8KrSkZq"},{"type":"math","value":"g_i = \\frac{f_{i+1}-f_i}{h}, \\qquad t=0,\\ldots,n-1.","position":{"start":{"line":23,"column":1},"end":{"line":25,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>g</mi><mi>i</mi></msub><mo>=</mo><mfrac><mrow><msub><mi>f</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>−</mo><msub><mi>f</mi><mi>i</mi></msub></mrow><mi>h</mi></mfrac><mo separator=\"true\">,</mo><mspace width=\"2em\"/><mi>t</mi><mo>=</mo><mn>0</mn><mo separator=\"true\">,</mo><mo>…</mo><mo separator=\"true\">,</mo><mi>n</mi><mo>−</mo><mn>1.</mn></mrow><annotation encoding=\"application/x-tex\">g_i = \\frac{f_{i+1}-f_i}{h}, \\qquad t=0,\\ldots,n-1.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.0574em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">h</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:2em;\"></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8389em;vertical-align:-0.1944em;\"></span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1.</span></span></span></span></span>","enumerator":"10.3.2","key":"rERJSrrMBR"},{"type":"paragraph","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"text","value":"However, this leaves ","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"ii9dOpNb1S"},{"type":"inlineMath","value":"g_n","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>g</mi><mi>n</mi></msub></mrow><annotation encoding=\"application/x-tex\">g_n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"xtzdhNUSqF"},{"type":"text","value":" undefined, because the formula would refer to the unavailable value ","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"LJsaGrrcBt"},{"type":"inlineMath","value":"f_{n+1}","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>f</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding=\"application/x-tex\">f_{n+1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9028em;vertical-align:-0.2083em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span></span></span></span>","key":"EmqlfYPAa5"},{"type":"text","value":". For ","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"e1nGl8wcQk"},{"type":"inlineMath","value":"g_n","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>g</mi><mi>n</mi></msub></mrow><annotation encoding=\"application/x-tex\">g_n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"emzT8S9Grr"},{"type":"text","value":" we could resort to the backward difference","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"RvCG8lplMI"}],"key":"YG088ppejw"},{"type":"math","value":"g_n = \\frac{f_{n}-f_{n-1}}{h}.","position":{"start":{"line":29,"column":1},"end":{"line":31,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>g</mi><mi>n</mi></msub><mo>=</mo><mfrac><mrow><msub><mi>f</mi><mi>n</mi></msub><mo>−</mo><msub><mi>f</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><mi>h</mi></mfrac><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">g_n = \\frac{f_{n}-f_{n-1}}{h}.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.0574em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">h</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mord\">.</span></span></span></span></span>","enumerator":"10.3.3","key":"D4ZE8ZQ3BX"},{"type":"paragraph","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"children":[{"type":"text","value":"We can summarize the entire set of formulas by defining","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"RzcUdSGPO6"}],"key":"AOoNZqueE0"},{"type":"math","value":"\\mathbf{f} = \n\\begin{bmatrix}\nf(x_0) \\\\[1mm] f(x_1) \\\\[1mm] \\vdots \\\\[1mm] f(x_{n-1}) \\\\[1mm] f(x_n)\n\\end{bmatrix}, \\quad","position":{"start":{"line":35,"column":1},"end":{"line":40,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi mathvariant=\"bold\">f</mi><mo>=</mo><mrow><mo fence=\"true\">[</mo><mtable rowspacing=\"0.16em\" columnalign=\"center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mn>0</mn></msub><mo stretchy=\"false\">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy=\"false\">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mi><mi mathvariant=\"normal\">⋮</mi><mpadded height=\"0em\" voffset=\"0em\"><mspace mathbackground=\"black\" width=\"0em\" height=\"1.5em\"></mspace></mpadded></mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy=\"false\">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>n</mi></msub><mo stretchy=\"false\">)</mo></mrow></mstyle></mtd></mtr></mtable><mo fence=\"true\">]</mo></mrow><mo separator=\"true\">,</mo><mspace width=\"1em\"/></mrow><annotation encoding=\"application/x-tex\">\\mathbf{f} = \n\\begin{bmatrix}\nf(x_0) \\\\[1mm] f(x_1) \\\\[1mm] \\vdots \\\\[1mm] f(x_{n-1}) \\\\[1mm] f(x_n)\n\\end{bmatrix}, \\quad</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.10903em;\">f</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:7.8001em;vertical-align:-3.6501em;\"></span><span class=\"minner\"><span class=\"mopen\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:4.1501em;\"><span style=\"top:-3.211em;\"><span class=\"pstrut\" style=\"height:6.2161em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎣</span></span></span><span style=\"top:-4.358em;\"><span class=\"pstrut\" style=\"height:6.2161em;\"></span><span style=\"height:4.2161em;width:0.6667em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.6667em' height='4.2161em' style='width:0.6667em' viewBox='0 0 666.67 4216' preserveAspectRatio='xMinYMin'><path d='M319 0 H403 V4216 H319z M319 0 H403 V4216 H319z'/></svg></span></span><span style=\"top:-9.2111em;\"><span class=\"pstrut\" style=\"height:6.2161em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎡</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.6501em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:4.1491em;\"><span style=\"top:-6.9966em;\"><span class=\"pstrut\" style=\"height:3.6875em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span><span style=\"top:-5.512em;\"><span class=\"pstrut\" style=\"height:3.6875em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span><span style=\"top:-3.3675em;\"><span class=\"pstrut\" style=\"height:3.6875em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord\">⋮</span><span class=\"mord rule\" style=\"border-right-width:0em;border-top-width:1.5em;bottom:0em;\"></span></span></span></span><span style=\"top:-1.883em;\"><span class=\"pstrut\" style=\"height:3.6875em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span><span style=\"top:-0.3984em;\"><span class=\"pstrut\" style=\"height:3.6875em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.6491em;\"><span></span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:4.1501em;\"><span style=\"top:-3.211em;\"><span class=\"pstrut\" style=\"height:6.2161em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎦</span></span></span><span style=\"top:-4.358em;\"><span class=\"pstrut\" style=\"height:6.2161em;\"></span><span style=\"height:4.2161em;width:0.6667em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.6667em' height='4.2161em' style='width:0.6667em' viewBox='0 0 666.67 4216' preserveAspectRatio='xMinYMin'><path d='M263 0 H347 V4216 H263z M263 0 H347 V4216 H263z'/></svg></span></span><span style=\"top:-9.2111em;\"><span class=\"pstrut\" style=\"height:6.2161em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎤</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.6501em;\"><span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:1em;\"></span></span></span></span></span>","enumerator":"10.3.4","key":"tCzyiDMzuE"},{"type":"paragraph","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"children":[{"type":"text","value":"and then the vector equation","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"key":"S03f9e5yQj"}],"key":"dLEBs1JMXG"},{"type":"math","value":"\\begin{bmatrix}\nf'(x_0) \\\\[1mm] f'(x_1) \\\\[1mm] \\vdots \\\\[1mm] f'(x_{n-1}) \\\\[1mm] f'(x_n)\n\\end{bmatrix}\n\\approx\n\\mathbf{D}_x \\mathbf{f}, \\qquad\n\\mathbf{D}_x\n= \\frac{1}{h}\n\\begin{bmatrix}\n-1 & 1 & & & \\\\[1mm]\n& -1 & 1 & & \\\\[1mm]\n& & \\ddots & \\ddots & \\\\[1mm]\n& & & -1 & 1 \\\\[1mm]\n& & & -1 & 1\n\\end{bmatrix}.","label":"diffmat11","identifier":"diffmat11","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mrow><mo fence=\"true\">[</mo><mtable rowspacing=\"0.16em\" columnalign=\"center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><msup><mi>f</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mn>0</mn></msub><mo stretchy=\"false\">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><msup><mi>f</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy=\"false\">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mi><mi mathvariant=\"normal\">⋮</mi><mpadded height=\"0em\" voffset=\"0em\"><mspace mathbackground=\"black\" width=\"0em\" height=\"1.5em\"></mspace></mpadded></mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><msup><mi>f</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy=\"false\">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><msup><mi>f</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>n</mi></msub><mo stretchy=\"false\">)</mo></mrow></mstyle></mtd></mtr></mtable><mo fence=\"true\">]</mo></mrow><mo>≈</mo><msub><mi mathvariant=\"bold\">D</mi><mi>x</mi></msub><mi mathvariant=\"bold\">f</mi><mo separator=\"true\">,</mo><mspace width=\"2em\"/><msub><mi mathvariant=\"bold\">D</mi><mi>x</mi></msub><mo>=</mo><mfrac><mn>1</mn><mi>h</mi></mfrac><mrow><mo fence=\"true\">[</mo><mtable rowspacing=\"0.16em\" columnalign=\"center center center center center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mn>1</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mn>1</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mo lspace=\"0em\" rspace=\"0em\">⋱</mo></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mo lspace=\"0em\" rspace=\"0em\">⋱</mo></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mn>1</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mn>1</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd></mtr></mtable><mo fence=\"true\">]</mo></mrow><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">\\begin{bmatrix}\nf&#x27;(x_0) \\\\[1mm] f&#x27;(x_1) \\\\[1mm] \\vdots \\\\[1mm] f&#x27;(x_{n-1}) \\\\[1mm] f&#x27;(x_n)\n\\end{bmatrix}\n\\approx\n\\mathbf{D}_x \\mathbf{f}, \\qquad\n\\mathbf{D}_x\n= \\frac{1}{h}\n\\begin{bmatrix}\n-1 &amp; 1 &amp; &amp; &amp; \\\\[1mm]\n&amp; -1 &amp; 1 &amp; &amp; \\\\[1mm]\n&amp; &amp; \\ddots &amp; \\ddots &amp; \\\\[1mm]\n&amp; &amp; &amp; -1 &amp; 1 \\\\[1mm]\n&amp; &amp; &amp; -1 &amp; 1\n\\end{bmatrix}.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:7.8001em;vertical-align:-3.6501em;\"></span><span class=\"minner\"><span class=\"mopen\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:4.1501em;\"><span style=\"top:-3.211em;\"><span class=\"pstrut\" style=\"height:6.2161em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎣</span></span></span><span style=\"top:-4.358em;\"><span class=\"pstrut\" style=\"height:6.2161em;\"></span><span style=\"height:4.2161em;width:0.6667em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.6667em' height='4.2161em' style='width:0.6667em' viewBox='0 0 666.67 4216' preserveAspectRatio='xMinYMin'><path d='M319 0 H403 V4216 H319z M319 0 H403 V4216 H319z'/></svg></span></span><span style=\"top:-9.2111em;\"><span class=\"pstrut\" style=\"height:6.2161em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎡</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.6501em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:4.1491em;\"><span style=\"top:-6.9966em;\"><span class=\"pstrut\" style=\"height:3.6875em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span><span style=\"top:-5.512em;\"><span class=\"pstrut\" style=\"height:3.6875em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span><span style=\"top:-3.3675em;\"><span class=\"pstrut\" style=\"height:3.6875em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord\">⋮</span><span class=\"mord rule\" style=\"border-right-width:0em;border-top-width:1.5em;bottom:0em;\"></span></span></span></span><span style=\"top:-1.883em;\"><span class=\"pstrut\" style=\"height:3.6875em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span><span style=\"top:-0.3984em;\"><span class=\"pstrut\" style=\"height:3.6875em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.6491em;\"><span></span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:4.1501em;\"><span style=\"top:-3.211em;\"><span class=\"pstrut\" style=\"height:6.2161em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎦</span></span></span><span style=\"top:-4.358em;\"><span class=\"pstrut\" style=\"height:6.2161em;\"></span><span style=\"height:4.2161em;width:0.6667em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.6667em' height='4.2161em' style='width:0.6667em' viewBox='0 0 666.67 4216' preserveAspectRatio='xMinYMin'><path d='M263 0 H347 V4216 H263z M263 0 H347 V4216 H263z'/></svg></span></span><span style=\"top:-9.2111em;\"><span class=\"pstrut\" style=\"height:6.2161em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎤</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.6501em;\"><span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">D</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord mathbf\" style=\"margin-right:0.10903em;\">f</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:2em;\"></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">D</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:7.2001em;vertical-align:-3.35em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">h</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.85em;\"><span style=\"top:-2.911em;\"><span class=\"pstrut\" style=\"height:5.6161em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎣</span></span></span><span style=\"top:-4.058em;\"><span class=\"pstrut\" style=\"height:5.6161em;\"></span><span style=\"height:3.6161em;width:0.6667em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.6667em' height='3.6161em' style='width:0.6667em' viewBox='0 0 666.67 3616' preserveAspectRatio='xMinYMin'><path d='M319 0 H403 V3616 H319z M319 0 H403 V3616 H319z'/></svg></span></span><span style=\"top:-8.3111em;\"><span class=\"pstrut\" style=\"height:5.6161em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎡</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.35em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.8191em;\"><span style=\"top:-5.9791em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord\">1</span></span></span><span style=\"top:-4.4945em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span><span style=\"top:-3.01em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span><span style=\"top:-1.5255em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span><span style=\"top:-0.0409em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.3191em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.8191em;\"><span style=\"top:-5.9791em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span><span style=\"top:-4.4945em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord\">1</span></span></span><span style=\"top:-3.01em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span><span style=\"top:-1.5255em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span><span style=\"top:-0.0409em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.3191em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.8191em;\"><span style=\"top:-5.9791em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span><span style=\"top:-4.4945em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span><span style=\"top:-3.01em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"minner\">⋱</span></span></span><span style=\"top:-1.5255em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span><span style=\"top:-0.0409em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.3191em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.8191em;\"><span style=\"top:-5.9791em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span><span style=\"top:-4.4945em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span><span style=\"top:-3.01em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"minner\">⋱</span></span></span><span style=\"top:-1.5255em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord\">1</span></span></span><span style=\"top:-0.0409em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.3191em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.8191em;\"><span style=\"top:-5.9791em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span><span style=\"top:-4.4945em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span><span style=\"top:-3.01em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span><span style=\"top:-1.5255em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span><span style=\"top:-0.0409em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.3191em;\"><span></span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.85em;\"><span style=\"top:-2.911em;\"><span class=\"pstrut\" style=\"height:5.6161em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎦</span></span></span><span style=\"top:-4.058em;\"><span class=\"pstrut\" style=\"height:5.6161em;\"></span><span style=\"height:3.6161em;width:0.6667em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.6667em' height='3.6161em' style='width:0.6667em' viewBox='0 0 666.67 3616' preserveAspectRatio='xMinYMin'><path d='M263 0 H347 V3616 H263z M263 0 H347 V3616 H263z'/></svg></span></span><span style=\"top:-8.3111em;\"><span class=\"pstrut\" style=\"height:5.6161em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎤</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.35em;\"><span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">.</span></span></span></span></span>","enumerator":"10.3.5","html_id":"diffmat11","key":"oFEK8yvIQh"},{"type":"paragraph","position":{"start":{"line":64,"column":1},"end":{"line":64,"column":1}},"children":[{"type":"text","value":"Here as elsewhere, elements of ","position":{"start":{"line":64,"column":1},"end":{"line":64,"column":1}},"key":"Fd1QcgtVHp"},{"type":"inlineMath","value":"\\mathbf{D}_x","position":{"start":{"line":64,"column":1},"end":{"line":64,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">D</mi><mi>x</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbf{D}_x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8361em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">D</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"yiYax8aQud"},{"type":"text","value":" that are not shown are zero. We call ","position":{"start":{"line":64,"column":1},"end":{"line":64,"column":1}},"key":"t5y4WqjlnF"},{"type":"inlineMath","value":"\\mathbf{D}_x","position":{"start":{"line":64,"column":1},"end":{"line":64,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">D</mi><mi>x</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbf{D}_x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8361em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">D</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"uTkCD2HLrs"},{"type":"text","value":" a ","position":{"start":{"line":64,"column":1},"end":{"line":64,"column":1}},"key":"mZ8tp6ANrP"},{"type":"strong","position":{"start":{"line":64,"column":1},"end":{"line":64,"column":1}},"children":[{"type":"text","value":"differentiation matrix","position":{"start":{"line":64,"column":1},"end":{"line":64,"column":1}},"key":"iGGsPJM6Xh"}],"key":"TSW3s3YDSi"},{"type":"text","value":". Each row of ","position":{"start":{"line":64,"column":1},"end":{"line":64,"column":1}},"key":"Y28e2zUWdi"},{"type":"inlineMath","value":"\\mathbf{D}_x","position":{"start":{"line":64,"column":1},"end":{"line":64,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">D</mi><mi>x</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbf{D}_x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8361em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">D</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"SxKFSaXoMr"},{"type":"text","value":" gives the weights of the finite-difference formula being used at one of the nodes.","position":{"start":{"line":64,"column":1},"end":{"line":64,"column":1}},"key":"EyzkwamQcn"}],"indexEntries":[{"entry":"differentiation matrix","emphasis":true}],"label":"index-K4NWlUF11p","identifier":"index-k4nwluf11p","html_id":"index-k4nwluf11p","key":"xtzdgPGZ50"},{"type":"paragraph","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"children":[{"type":"text","value":"The differentiation matrix ","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"key":"nE7HaoMD2p"},{"type":"inlineMath","value":"\\mathbf{D}_x","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">D</mi><mi>x</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbf{D}_x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8361em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">D</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"uZpMWYcqlg"},{"type":"text","value":" in ","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"key":"hhC3Dg5YNf"},{"type":"crossReference","kind":"equation","identifier":"diffmat11","label":"diffmat11","children":[{"type":"text","value":"(","key":"anFUgJTQll"},{"type":"text","value":"10.3.5","key":"T9MTZM2EEj"},{"type":"text","value":")","key":"RrppYZ0b2q"}],"template":"(%s)","enumerator":"10.3.5","resolved":true,"html_id":"diffmat11","key":"OlsH4HOKok"},{"type":"text","value":" is not a unique choice. We are free to use whatever finite-difference formulas we like in each row. However, it makes sense to choose rows that are as similar as possible. Using second-order centered differences where possible and second-order one-sided formulas (see ","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"key":"FgaLA949FZ"},{"type":"crossReference","kind":"table","identifier":"table-fdforward","label":"table-FDforward","children":[{"type":"text","value":"Table ","key":"EJciWpOWPh"},{"type":"text","value":"5.4.2","key":"Mk40oJdc06"}],"template":"Table %s","enumerator":"5.4.2","resolved":true,"html_id":"table-fdforward","remote":true,"url":"/finitediffs","dataUrl":"/finitediffs.json","key":"pWY6shNSrg"},{"type":"text","value":") at the boundary points leads to","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"key":"C9cJINjv57"}],"indexEntries":[{"entry":"order of accuracy","subEntry":{"value":"of a finite-difference formula","kind":"entry"},"emphasis":false}],"label":"index-MrVA8nftMb","identifier":"index-mrva8nftmb","html_id":"index-mrva8nftmb","key":"ZSWuAGKdyd"},{"type":"math","value":"\\mathbf{D}_x = \\frac{1}{h}\n\\begin{bmatrix}\n-\\frac{3}{2} & 2    & -\\frac{1}{2}   &        &        &  \\\\[1mm]\n-\\frac{1}{2} & 0    & \\frac{1}{2}    &        &        &  \\\\[1mm]\n& -\\frac{1}{2} & 0      & \\frac{1}{2}    &        &  \\\\\n&      & \\ddots & \\ddots & \\ddots &  \\\\\n&      &        & -\\frac{1}{2}   & 0      & \\frac{1}{2} \\\\[1mm]\n&      &        & \\frac{1}{2}    & -2     & \\frac{3}{2}\n\\end{bmatrix}.","label":"diffmat12b","identifier":"diffmat12b","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi mathvariant=\"bold\">D</mi><mi>x</mi></msub><mo>=</mo><mfrac><mn>1</mn><mi>h</mi></mfrac><mrow><mo fence=\"true\">[</mo><mtable rowspacing=\"0.16em\" columnalign=\"center center center center center center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mfrac><mn>3</mn><mn>2</mn></mfrac></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>2</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mfrac><mn>1</mn><mn>2</mn></mfrac></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mfrac><mn>1</mn><mn>2</mn></mfrac></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mfrac><mn>1</mn><mn>2</mn></mfrac></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mfrac><mn>1</mn><mn>2</mn></mfrac></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mfrac><mn>1</mn><mn>2</mn></mfrac></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mo lspace=\"0em\" rspace=\"0em\">⋱</mo></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mo lspace=\"0em\" rspace=\"0em\">⋱</mo></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mo lspace=\"0em\" rspace=\"0em\">⋱</mo></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mfrac><mn>1</mn><mn>2</mn></mfrac></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mfrac><mn>1</mn><mn>2</mn></mfrac></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mfrac><mn>1</mn><mn>2</mn></mfrac></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mn>2</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mfrac><mn>3</mn><mn>2</mn></mfrac></mstyle></mtd></mtr></mtable><mo fence=\"true\">]</mo></mrow><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{D}_x = \\frac{1}{h}\n\\begin{bmatrix}\n-\\frac{3}{2} &amp; 2    &amp; -\\frac{1}{2}   &amp;        &amp;        &amp;  \\\\[1mm]\n-\\frac{1}{2} &amp; 0    &amp; \\frac{1}{2}    &amp;        &amp;        &amp;  \\\\[1mm]\n&amp; -\\frac{1}{2} &amp; 0      &amp; \\frac{1}{2}    &amp;        &amp;  \\\\\n&amp;      &amp; \\ddots &amp; \\ddots &amp; \\ddots &amp;  \\\\\n&amp;      &amp;        &amp; -\\frac{1}{2}   &amp; 0      &amp; \\frac{1}{2} \\\\[1mm]\n&amp;      &amp;        &amp; \\frac{1}{2}    &amp; -2     &amp; \\frac{3}{2}\n\\end{bmatrix}.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8361em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">D</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:8.0791em;vertical-align:-3.7896em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">h</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:4.1501em;\"><span style=\"top:-3.211em;\"><span class=\"pstrut\" style=\"height:6.2161em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎣</span></span></span><span style=\"top:-4.358em;\"><span class=\"pstrut\" style=\"height:6.2161em;\"></span><span style=\"height:4.2161em;width:0.6667em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.6667em' height='4.2161em' style='width:0.6667em' viewBox='0 0 666.67 4216' preserveAspectRatio='xMinYMin'><path d='M319 0 H403 V4216 H319z M319 0 H403 V4216 H319z'/></svg></span></span><span style=\"top:-9.2111em;\"><span class=\"pstrut\" style=\"height:6.2161em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎡</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.6501em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:4.2896em;\"><span style=\"top:-6.4445em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8451em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">3</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span><span style=\"top:-4.9548em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8451em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span><span style=\"top:-3.4652em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span><span style=\"top:-2.2652em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span><span style=\"top:-1.0601em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span><span style=\"top:0.4296em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.7896em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:4.2896em;\"><span style=\"top:-6.4445em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">2</span></span></span><span style=\"top:-4.9548em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">0</span></span></span><span style=\"top:-3.4652em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8451em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span><span style=\"top:-2.2652em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span><span style=\"top:-1.0601em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span><span style=\"top:0.4296em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.7896em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:4.2896em;\"><span style=\"top:-6.4445em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8451em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span><span style=\"top:-4.9548em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8451em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span><span style=\"top:-3.4652em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">0</span></span></span><span style=\"top:-2.2652em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"minner\">⋱</span></span></span><span style=\"top:-1.0601em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span><span style=\"top:0.4296em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.7896em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:4.2896em;\"><span style=\"top:-6.4445em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span><span style=\"top:-4.9548em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span><span style=\"top:-3.4652em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8451em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span><span style=\"top:-2.2652em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"minner\">⋱</span></span></span><span style=\"top:-1.0601em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8451em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span><span style=\"top:0.4296em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8451em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.7896em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:4.2896em;\"><span style=\"top:-6.4445em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span><span style=\"top:-4.9548em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span><span style=\"top:-3.4652em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span><span style=\"top:-2.2652em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"minner\">⋱</span></span></span><span style=\"top:-1.0601em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">0</span></span></span><span style=\"top:0.4296em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.7896em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:4.2896em;\"><span style=\"top:-6.4445em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span><span style=\"top:-4.9548em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span><span style=\"top:-3.4652em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span><span style=\"top:-2.2652em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span><span style=\"top:-1.0601em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8451em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span><span style=\"top:0.4296em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8451em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">3</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.7896em;\"><span></span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:4.1501em;\"><span style=\"top:-3.211em;\"><span class=\"pstrut\" style=\"height:6.2161em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎦</span></span></span><span style=\"top:-4.358em;\"><span class=\"pstrut\" style=\"height:6.2161em;\"></span><span style=\"height:4.2161em;width:0.6667em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.6667em' height='4.2161em' style='width:0.6667em' viewBox='0 0 666.67 4216' preserveAspectRatio='xMinYMin'><path d='M263 0 H347 V4216 H263z M263 0 H347 V4216 H263z'/></svg></span></span><span style=\"top:-9.2111em;\"><span class=\"pstrut\" style=\"height:6.2161em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎤</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.6501em;\"><span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">.</span></span></span></span></span>","enumerator":"10.3.6","html_id":"diffmat12b","key":"BFdnCPpw7Y"},{"type":"paragraph","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"children":[{"type":"text","value":"The differentiation matrices so far are banded matrices, i.e., all the nonzero values are along diagonals close to the main diagonal.","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"SX7EUziNBf"},{"type":"footnoteReference","identifier":"sparseconv","label":"sparseconv","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"number":1,"enumerator":"1","key":"jekTp9Zx7v"}],"indexEntries":[{"entry":"banded matrix","emphasis":false},{"entry":"sparse matrix","emphasis":false}],"label":"index-haVRTzeker","identifier":"index-havrtzeker","html_id":"index-havrtzeker","key":"VRlfIXtsZn"},{"type":"heading","depth":2,"position":{"start":{"line":91,"column":1},"end":{"line":91,"column":1}},"children":[{"type":"text","value":"Second derivative","position":{"start":{"line":91,"column":1},"end":{"line":91,"column":1}},"key":"BMOs2mBEg7"}],"identifier":"second-derivative","label":"Second derivative","html_id":"second-derivative","implicit":true,"enumerator":"10.3.2","key":"fF4Vl0wnkC"},{"type":"paragraph","position":{"start":{"line":93,"column":1},"end":{"line":93,"column":1}},"children":[{"type":"text","value":"Similarly, we can define differentiation matrices for second derivatives. For example,","position":{"start":{"line":93,"column":1},"end":{"line":93,"column":1}},"key":"zdd1DuICIo"}],"key":"emXOzq0uju"},{"type":"math","value":"\\begin{bmatrix}\nf''(x_0) \\\\[1mm] f''(x_1) \\\\[1mm] f''(x_2) \\\\[1mm] \\vdots \\\\[1mm] f''(x_{n-1}) \\\\[1mm] f''(x_n)\n\\end{bmatrix}\n\\approx\n\\frac{1}{h^2}\n\\begin{bmatrix}\n2 & -5 & 4      & -1     &        &     \\\\[1mm]\n1 & -2 & 1      &        &        &    \\\\[1mm]\n& 1  & -2     & 1      &        &    \\\\[1mm]\n&    & \\ddots & \\ddots & \\ddots &    \\\\[1mm]\n&        &        & 1      & -2 & 1 \\\\[1mm]\n&        &     -1  & 4      & -5 & 2\n\\end{bmatrix}\n\\begin{bmatrix}\nf(x_0) \\\\[1mm] f(x_1) \\\\[1mm] f(x_2) \\\\[1mm] \\vdots \\\\[1mm] f(x_{n-1}) \\\\[1mm] f(x_n)\n\\end{bmatrix} = \\mathbf{D}_{xx} \\mathbf{f}.","label":"diffmat22","identifier":"diffmat22","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mrow><mo fence=\"true\">[</mo><mtable rowspacing=\"0.16em\" columnalign=\"center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><msup><mi>f</mi><mrow><mo mathvariant=\"normal\">′</mo><mo mathvariant=\"normal\">′</mo></mrow></msup><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mn>0</mn></msub><mo stretchy=\"false\">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><msup><mi>f</mi><mrow><mo mathvariant=\"normal\">′</mo><mo mathvariant=\"normal\">′</mo></mrow></msup><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy=\"false\">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><msup><mi>f</mi><mrow><mo mathvariant=\"normal\">′</mo><mo mathvariant=\"normal\">′</mo></mrow></msup><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mn>2</mn></msub><mo stretchy=\"false\">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mi><mi mathvariant=\"normal\">⋮</mi><mpadded height=\"0em\" voffset=\"0em\"><mspace mathbackground=\"black\" width=\"0em\" height=\"1.5em\"></mspace></mpadded></mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><msup><mi>f</mi><mrow><mo mathvariant=\"normal\">′</mo><mo mathvariant=\"normal\">′</mo></mrow></msup><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy=\"false\">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><msup><mi>f</mi><mrow><mo mathvariant=\"normal\">′</mo><mo mathvariant=\"normal\">′</mo></mrow></msup><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>n</mi></msub><mo stretchy=\"false\">)</mo></mrow></mstyle></mtd></mtr></mtable><mo fence=\"true\">]</mo></mrow><mo>≈</mo><mfrac><mn>1</mn><msup><mi>h</mi><mn>2</mn></msup></mfrac><mrow><mo fence=\"true\">[</mo><mtable rowspacing=\"0.16em\" columnalign=\"center center center center center center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>2</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mn>5</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>4</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mn>1</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mn>2</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mn>2</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mo lspace=\"0em\" rspace=\"0em\">⋱</mo></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mo lspace=\"0em\" rspace=\"0em\">⋱</mo></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mo lspace=\"0em\" rspace=\"0em\">⋱</mo></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mn>2</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mn>1</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>4</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mn>5</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>2</mn></mstyle></mtd></mtr></mtable><mo fence=\"true\">]</mo></mrow><mrow><mo fence=\"true\">[</mo><mtable rowspacing=\"0.16em\" columnalign=\"center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mn>0</mn></msub><mo stretchy=\"false\">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy=\"false\">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mn>2</mn></msub><mo stretchy=\"false\">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mi><mi mathvariant=\"normal\">⋮</mi><mpadded height=\"0em\" voffset=\"0em\"><mspace mathbackground=\"black\" width=\"0em\" height=\"1.5em\"></mspace></mpadded></mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy=\"false\">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>n</mi></msub><mo stretchy=\"false\">)</mo></mrow></mstyle></mtd></mtr></mtable><mo fence=\"true\">]</mo></mrow><mo>=</mo><msub><mi mathvariant=\"bold\">D</mi><mrow><mi>x</mi><mi>x</mi></mrow></msub><mi mathvariant=\"bold\">f</mi><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">\\begin{bmatrix}\nf&#x27;&#x27;(x_0) \\\\[1mm] f&#x27;&#x27;(x_1) \\\\[1mm] f&#x27;&#x27;(x_2) \\\\[1mm] \\vdots \\\\[1mm] f&#x27;&#x27;(x_{n-1}) \\\\[1mm] f&#x27;&#x27;(x_n)\n\\end{bmatrix}\n\\approx\n\\frac{1}{h^2}\n\\begin{bmatrix}\n2 &amp; -5 &amp; 4      &amp; -1     &amp;        &amp;     \\\\[1mm]\n1 &amp; -2 &amp; 1      &amp;        &amp;        &amp;    \\\\[1mm]\n&amp; 1  &amp; -2     &amp; 1      &amp;        &amp;    \\\\[1mm]\n&amp;    &amp; \\ddots &amp; \\ddots &amp; \\ddots &amp;    \\\\[1mm]\n&amp;        &amp;        &amp; 1      &amp; -2 &amp; 1 \\\\[1mm]\n&amp;        &amp;     -1  &amp; 4      &amp; -5 &amp; 2\n\\end{bmatrix}\n\\begin{bmatrix}\nf(x_0) \\\\[1mm] f(x_1) \\\\[1mm] f(x_2) \\\\[1mm] \\vdots \\\\[1mm] f(x_{n-1}) \\\\[1mm] f(x_n)\n\\end{bmatrix} = \\mathbf{D}_{xx} \\mathbf{f}.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:9.2826em;vertical-align:-4.3913em;\"></span><span class=\"minner\"><span class=\"mopen\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:4.7501em;\"><span style=\"top:-3.811em;\"><span class=\"pstrut\" style=\"height:7.4161em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎣</span></span></span><span style=\"top:-4.958em;\"><span class=\"pstrut\" style=\"height:7.4161em;\"></span><span style=\"height:5.4161em;width:0.6667em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.6667em' height='5.4161em' style='width:0.6667em' viewBox='0 0 666.67 5416' preserveAspectRatio='xMinYMin'><path d='M319 0 H403 V5416 H319z M319 0 H403 V5416 H319z'/></svg></span></span><span style=\"top:-11.0112em;\"><span class=\"pstrut\" style=\"height:7.4161em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎡</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:4.2501em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:4.8913em;\"><span style=\"top:-7.7388em;\"><span class=\"pstrut\" style=\"height:3.6875em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′′</span></span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span><span style=\"top:-6.2543em;\"><span class=\"pstrut\" style=\"height:3.6875em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′′</span></span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span><span style=\"top:-4.7698em;\"><span class=\"pstrut\" style=\"height:3.6875em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′′</span></span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span><span style=\"top:-2.6252em;\"><span class=\"pstrut\" style=\"height:3.6875em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord\">⋮</span><span class=\"mord rule\" style=\"border-right-width:0em;border-top-width:1.5em;bottom:0em;\"></span></span></span></span><span style=\"top:-1.1407em;\"><span class=\"pstrut\" style=\"height:3.6875em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′′</span></span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span><span style=\"top:0.3438em;\"><span class=\"pstrut\" style=\"height:3.6875em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′′</span></span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:4.3913em;\"><span></span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:4.7501em;\"><span style=\"top:-3.811em;\"><span class=\"pstrut\" style=\"height:7.4161em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎦</span></span></span><span style=\"top:-4.958em;\"><span class=\"pstrut\" style=\"height:7.4161em;\"></span><span style=\"height:5.4161em;width:0.6667em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.6667em' height='5.4161em' style='width:0.6667em' viewBox='0 0 666.67 5416' preserveAspectRatio='xMinYMin'><path d='M263 0 H347 V5416 H263z M263 0 H347 V5416 H263z'/></svg></span></span><span style=\"top:-11.0112em;\"><span class=\"pstrut\" style=\"height:7.4161em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎤</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:4.2501em;\"><span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:9.2826em;vertical-align:-4.3913em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">h</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7401em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:4.4501em;\"><span style=\"top:-3.511em;\"><span class=\"pstrut\" style=\"height:6.8161em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎣</span></span></span><span style=\"top:-4.658em;\"><span class=\"pstrut\" style=\"height:6.8161em;\"></span><span style=\"height:4.8161em;width:0.6667em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.6667em' height='4.8161em' style='width:0.6667em' viewBox='0 0 666.67 4816' preserveAspectRatio='xMinYMin'><path d='M319 0 H403 V4816 H319z M319 0 H403 V4816 H319z'/></svg></span></span><span style=\"top:-10.1111em;\"><span class=\"pstrut\" style=\"height:6.8161em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎡</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.9501em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:4.5613em;\"><span style=\"top:-6.7213em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">2</span></span></span><span style=\"top:-5.2368em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span><span style=\"top:-3.7523em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span><span style=\"top:-2.2677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span><span style=\"top:-0.7832em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span><span style=\"top:0.7013em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:4.0613em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:4.5613em;\"><span style=\"top:-6.7213em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord\">5</span></span></span><span style=\"top:-5.2368em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord\">2</span></span></span><span style=\"top:-3.7523em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span><span style=\"top:-2.2677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span><span style=\"top:-0.7832em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span><span style=\"top:0.7013em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:4.0613em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:4.5613em;\"><span style=\"top:-6.7213em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">4</span></span></span><span style=\"top:-5.2368em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span><span style=\"top:-3.7523em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord\">2</span></span></span><span style=\"top:-2.2677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"minner\">⋱</span></span></span><span style=\"top:-0.7832em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span><span style=\"top:0.7013em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:4.0613em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:4.5613em;\"><span style=\"top:-6.7213em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord\">1</span></span></span><span style=\"top:-5.2368em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span><span style=\"top:-3.7523em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span><span style=\"top:-2.2677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"minner\">⋱</span></span></span><span style=\"top:-0.7832em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span><span style=\"top:0.7013em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">4</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:4.0613em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:4.5613em;\"><span style=\"top:-6.7213em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span><span style=\"top:-5.2368em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span><span style=\"top:-3.7523em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span><span style=\"top:-2.2677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"minner\">⋱</span></span></span><span style=\"top:-0.7832em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord\">2</span></span></span><span style=\"top:0.7013em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord\">5</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:4.0613em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:4.5613em;\"><span style=\"top:-6.7213em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span><span style=\"top:-5.2368em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span><span style=\"top:-3.7523em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span><span style=\"top:-2.2677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span><span style=\"top:-0.7832em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span><span style=\"top:0.7013em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:4.0613em;\"><span></span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:4.4501em;\"><span style=\"top:-3.511em;\"><span class=\"pstrut\" style=\"height:6.8161em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎦</span></span></span><span style=\"top:-4.658em;\"><span class=\"pstrut\" style=\"height:6.8161em;\"></span><span style=\"height:4.8161em;width:0.6667em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.6667em' height='4.8161em' style='width:0.6667em' viewBox='0 0 666.67 4816' preserveAspectRatio='xMinYMin'><path d='M263 0 H347 V4816 H263z M263 0 H347 V4816 H263z'/></svg></span></span><span style=\"top:-10.1111em;\"><span class=\"pstrut\" style=\"height:6.8161em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎤</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.9501em;\"><span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:4.7501em;\"><span style=\"top:-3.811em;\"><span class=\"pstrut\" style=\"height:7.4161em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎣</span></span></span><span style=\"top:-4.958em;\"><span class=\"pstrut\" style=\"height:7.4161em;\"></span><span style=\"height:5.4161em;width:0.6667em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.6667em' height='5.4161em' style='width:0.6667em' viewBox='0 0 666.67 5416' preserveAspectRatio='xMinYMin'><path d='M319 0 H403 V5416 H319z M319 0 H403 V5416 H319z'/></svg></span></span><span style=\"top:-11.0112em;\"><span class=\"pstrut\" style=\"height:7.4161em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎡</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:4.2501em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:4.8913em;\"><span style=\"top:-7.7388em;\"><span class=\"pstrut\" style=\"height:3.6875em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span><span style=\"top:-6.2543em;\"><span class=\"pstrut\" style=\"height:3.6875em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span><span style=\"top:-4.7698em;\"><span class=\"pstrut\" style=\"height:3.6875em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span><span style=\"top:-2.6252em;\"><span class=\"pstrut\" style=\"height:3.6875em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord\">⋮</span><span class=\"mord rule\" style=\"border-right-width:0em;border-top-width:1.5em;bottom:0em;\"></span></span></span></span><span style=\"top:-1.1407em;\"><span class=\"pstrut\" style=\"height:3.6875em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span><span style=\"top:0.3438em;\"><span class=\"pstrut\" style=\"height:3.6875em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:4.3913em;\"><span></span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:4.7501em;\"><span style=\"top:-3.811em;\"><span class=\"pstrut\" style=\"height:7.4161em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎦</span></span></span><span style=\"top:-4.958em;\"><span class=\"pstrut\" style=\"height:7.4161em;\"></span><span style=\"height:5.4161em;width:0.6667em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.6667em' height='5.4161em' style='width:0.6667em' viewBox='0 0 666.67 5416' preserveAspectRatio='xMinYMin'><path d='M263 0 H347 V5416 H263z M263 0 H347 V5416 H263z'/></svg></span></span><span style=\"top:-11.0112em;\"><span class=\"pstrut\" style=\"height:7.4161em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎤</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:4.2501em;\"><span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">D</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">xx</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord mathbf\" style=\"margin-right:0.10903em;\">f</span><span class=\"mord\">.</span></span></span></span></span>","enumerator":"10.3.7","html_id":"diffmat22","key":"byTQ1Pqqyy"},{"type":"paragraph","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"children":[{"type":"text","value":"We have multiple choices again for ","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"key":"Sn8Q0lhrd7"},{"type":"inlineMath","value":"\\mathbf{D}_{xx}","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">D</mi><mrow><mi>x</mi><mi>x</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbf{D}_{xx}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8361em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">D</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">xx</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"DipZ0Nbcsc"},{"type":"text","value":", and it need not be the square of any particular ","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"key":"jqb4LiWatT"},{"type":"inlineMath","value":"\\mathbf{D}_x","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">D</mi><mi>x</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbf{D}_x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8361em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">D</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"RQIIMaRg6U"},{"type":"text","value":". As pointed out in ","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"key":"ve2afWpRbQ"},{"type":"link","kind":"numref","identifier":"section-localapprox-finitediffs","label":"section-localapprox-finitediffs","url":"/finitediffs","internal":true,"dataUrl":"/finitediffs.json","children":[{"type":"text","value":"Finite differences","key":"HxawXU0SsO"}],"key":"JXZvmtNQ8l"},{"type":"text","value":", squaring the first derivative is a valid approach but would place entries in ","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"key":"FWHNH5fjXE"},{"type":"inlineMath","value":"\\mathbf{D}_{xx}","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">D</mi><mrow><mi>x</mi><mi>x</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbf{D}_{xx}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8361em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">D</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">xx</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"DVi6oKBsD5"},{"type":"text","value":" farther from the diagonal than is necessary.","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"key":"mCUzZYtHXs"}],"key":"pL6j97jFNq"},{"type":"proof","kind":"algorithm","enumerated":true,"children":[{"type":"admonitionTitle","children":[{"type":"text","value":"diffmat2","position":{"start":{"line":118,"column":1},"end":{"line":118,"column":1}},"key":"A2xfO1Ouqw"}],"key":"IdZKXFRc4z"},{"type":"tabSet","children":[{"type":"tabItem","title":"Julia","sync":"julia","children":[{"type":"embed","source":{"label":"function-diffmat2-julia"},"key":"Cybu08wpd4"}],"key":"NsHnjG6YA9"},{"type":"tabItem","title":"MATLAB","sync":"matlab","children":[{"type":"embed","source":{"label":"function-diffmat2-matlab"},"key":"GJ2DI6EVxV"}],"key":"TeqP6BH2h2"},{"type":"tabItem","title":"Python","sync":"python","children":[{"type":"embed","source":{"label":"function-diffmat2-python"},"key":"D9ZsPoHGRC"}],"key":"t9QXmT4Mcr"}],"key":"tkXcak0uGt"}],"label":"function-diffmat2","identifier":"function-diffmat2","html_id":"function-diffmat2","enumerator":"10.3.1","key":"rWrrs6l4vA"},{"type":"paragraph","position":{"start":{"line":140,"column":1},"end":{"line":140,"column":1}},"children":[{"type":"text","value":"Together the matrices ","position":{"start":{"line":140,"column":1},"end":{"line":140,"column":1}},"key":"ymq3H3HpPK"},{"type":"crossReference","kind":"equation","identifier":"diffmat12b","label":"diffmat12b","children":[{"type":"text","value":"(","key":"Y2pgxMEO6W"},{"type":"text","value":"10.3.6","key":"XrHMY64vUg"},{"type":"text","value":")","key":"gagyxOyYN4"}],"template":"(%s)","enumerator":"10.3.6","resolved":true,"html_id":"diffmat12b","key":"ND9nDgOZSF"},{"type":"text","value":" and ","position":{"start":{"line":140,"column":1},"end":{"line":140,"column":1}},"key":"n596S3gtUX"},{"type":"crossReference","kind":"equation","identifier":"diffmat22","label":"diffmat22","children":[{"type":"text","value":"(","key":"HHGtoYENAu"},{"type":"text","value":"10.3.7","key":"DJTnaewJtG"},{"type":"text","value":")","key":"mS7daDguLt"}],"template":"(%s)","enumerator":"10.3.7","resolved":true,"html_id":"diffmat22","key":"rRgrPJzn9I"},{"type":"text","value":" give second-order approximations of the first and second derivatives at all nodes. These matrices, as well as the nodes ","position":{"start":{"line":140,"column":1},"end":{"line":140,"column":1}},"key":"jKVfiTXFse"},{"type":"inlineMath","value":"x_0,\\ldots,x_n","position":{"start":{"line":140,"column":1},"end":{"line":140,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mn>0</mn></msub><mo separator=\"true\">,</mo><mo>…</mo><mo separator=\"true\">,</mo><msub><mi>x</mi><mi>n</mi></msub></mrow><annotation encoding=\"application/x-tex\">x_0,\\ldots,x_n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"AN3cyzNq5b"},{"type":"text","value":", are returned by ","position":{"start":{"line":140,"column":1},"end":{"line":140,"column":1}},"key":"bU0PCKldlt"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-diffmat2","label":"function-diffmat2","children":[{"type":"text","value":"Function ","key":"aH31fsScsi"},{"type":"text","value":"10.3.1","key":"SyHV4QA8Wu"}],"template":"Algorithm %s","enumerator":"10.3.1","resolved":true,"html_id":"function-diffmat2","key":"m1qijM3L7p"},{"type":"text","value":".","position":{"start":{"line":140,"column":1},"end":{"line":140,"column":1}},"key":"DHBEyZ9xoM"}],"key":"sQYqW4JNcy"},{"type":"proof","kind":"example","enumerated":true,"children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Differentiation matrices","position":{"start":{"line":143,"column":1},"end":{"line":143,"column":1}},"key":"oBdKo7cDsF"}],"key":"y8cn9Yr0Ln"},{"type":"tabSet","children":[{"type":"tabItem","title":"Julia","sync":"julia","children":[{"type":"embed","source":{"url":"/chapter10","label":"demo-diffmats-2nd-julia","kind":"Notebook","slug":"chapter10","location":"/julia/chapter10.md","title":"Chapter 10"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-diffmats-2nd","label":"demo-diffmats-2nd","kind":"proof:example","position":{"start":{"line":290,"column":1},"end":{"line":290,"column":19}},"children":[{"type":"text","value":"Example ","key":"fp0KqNmn50"},{"type":"text","value":"10.3.1","key":"H0BsxU5Atl"}],"template":"Example %s","enumerator":"10.3.1","resolved":true,"html_id":"demo-diffmats-2nd","remote":true,"url":"/diffmats","dataUrl":"/diffmats.json","key":"dUetCWuRXs"}],"key":"nHkjiYEKk8"},{"type":"paragraph","position":{"start":{"line":292,"column":1},"end":{"line":292,"column":1}},"children":[{"type":"text","value":"We test first-order and second-order differentiation matrices for the function ","position":{"start":{"line":292,"column":1},"end":{"line":292,"column":1}},"key":"JyPgHyLHUI"},{"type":"inlineMath","value":"x + \\exp(\\sin 4x)","position":{"start":{"line":292,"column":1},"end":{"line":292,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mo>+</mo><mi>exp</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mi>sin</mi><mo>⁡</mo><mn>4</mn><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">x + \\exp(\\sin 4x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop\">exp</span><span class=\"mopen\">(</span><span class=\"mop\">sin</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">4</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span>","key":"TsdK1mkXov"},{"type":"text","value":" over ","position":{"start":{"line":292,"column":1},"end":{"line":292,"column":1}},"key":"H14qWnOInv"},{"type":"inlineMath","value":"[-1,1]","position":{"start":{"line":292,"column":1},"end":{"line":292,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mo>−</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[-1,1]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">−</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]</span></span></span></span>","key":"WiFPZBcUBR"},{"type":"text","value":".","position":{"start":{"line":292,"column":1},"end":{"line":292,"column":1}},"key":"qUV9vNCHmn"}],"key":"kBVuC84NNH"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"f = x -> x + exp(sin(4 * x));","key":"jtiuJVlLjh"},{"type":"output","id":"s2sNREe9raUNfaN4RoOHP","data":[],"key":"QEKCbE5rY7"}],"data":{},"key":"elw8JZadYa"},{"type":"paragraph","position":{"start":{"line":298,"column":1},"end":{"line":298,"column":1}},"children":[{"type":"text","value":"For reference, here are the exact first and second derivatives.","position":{"start":{"line":298,"column":1},"end":{"line":298,"column":1}},"key":"LRZzj72PGX"}],"key":"y4I1tYuIR5"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"df_dx = x -> 1 + 4 * exp(sin(4x)) * cos(4x);\nd2f_dx2 = x -> 4 * exp(sin(4x)) * (4 * cos(4x)^2 - 4 * sin(4x));","key":"xs37Bz26CI"},{"type":"output","id":"l-Sc2VaxlNC1pG0ScSvD_","data":[],"key":"bNPkH1k1ez"}],"data":{},"key":"lpP2A4XZSR"},{"type":"paragraph","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":1}},"children":[{"type":"text","value":"We discretize on equally spaced nodes and evaluate ","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":1}},"key":"Ex48CXaq25"},{"type":"inlineMath","value":"f","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>","key":"aFFgODQ35X"},{"type":"text","value":" at the nodes.","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":1}},"key":"xhEqvZ4v2p"}],"key":"q5Dro3N7Cu"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"t, Dₓ, Dₓₓ = FNC.diffmat2(18, [-1, 1])\ny = f.(t);","key":"RbLhNyQ4rD"},{"type":"output","id":"f6gDx_hmBZxHYESbCJYiZ","data":[],"key":"E1mBalAVyC"}],"data":{},"key":"H85xbOqIH1"},{"type":"paragraph","position":{"start":{"line":312,"column":1},"end":{"line":312,"column":1}},"children":[{"type":"text","value":"Then the first two derivatives of ","position":{"start":{"line":312,"column":1},"end":{"line":312,"column":1}},"key":"cjReLbWls6"},{"type":"inlineMath","value":"f","position":{"start":{"line":312,"column":1},"end":{"line":312,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>","key":"mDVq2jUTns"},{"type":"text","value":" each require one matrix-vector multiplication.","position":{"start":{"line":312,"column":1},"end":{"line":312,"column":1}},"key":"vNE9uMYQgy"}],"key":"PqozCPX2B8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"yₓ = Dₓ * y\nyₓₓ = Dₓₓ * y;","key":"oZYPodj8hM"},{"type":"output","id":"43XnFd0jmjQa-LOHJJ6dI","data":[],"key":"UlCJ5TbyLs"}],"data":{},"key":"ob0ij8EYeN"},{"type":"paragraph","position":{"start":{"line":319,"column":1},"end":{"line":319,"column":1}},"children":[{"type":"text","value":"The results show poor accuracy for this small value of ","position":{"start":{"line":319,"column":1},"end":{"line":319,"column":1}},"key":"TQTt9Cd769"},{"type":"inlineMath","value":"n","position":{"start":{"line":319,"column":1},"end":{"line":319,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"yO41MxMroY"},{"type":"text","value":".","position":{"start":{"line":319,"column":1},"end":{"line":319,"column":1}},"key":"cQiKiCdNZ0"}],"key":"CI661RYjn8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"using Plots\nplot(df_dx, -1, 1, layout = 2, xaxis = (L\"x\"), yaxis = (L\"f'(x)\"))\nscatter!(t, yₓ, subplot = 1)\nplot!(d2f_dx2, -1, 1, subplot = 2, xaxis = (L\"x\"), yaxis = (L\"f''(x)\"))\nscatter!(t, yₓₓ, subplot = 2)","key":"krrmt5tz78"},{"type":"output","id":"u-90TeTS0nTdtzOM9Jq2t","data":[{"output_type":"execute_result","execution_count":20,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"775dd46354e93e07461d9c4a640f3880","path":"/build/775dd46354e93e07461d9c4a640f3880.png"},"text/html":{"content_type":"text/html","hash":"392ecebf8144c6a5c98fb29283b5c4c7","path":"/build/392ecebf8144c6a5c98fb29283b5c4c7.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"cc27002a47f93a4fc8268376d24d6905","path":"/build/cc27002a47f93a4fc8268376d24d6905.svg"}}}],"key":"Un3Usd7lY9"}],"data":{},"key":"NrHUEmtJX8"},{"type":"paragraph","position":{"start":{"line":329,"column":1},"end":{"line":329,"column":1}},"children":[{"type":"text","value":"A convergence experiment confirms the order of accuracy. Because we expect an algebraic convergence rate, we use a log-log plot of the errors.","position":{"start":{"line":329,"column":1},"end":{"line":329,"column":1}},"key":"R9kQkAUdTU"}],"key":"t6fAC1P9Zv"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"n = @. round(Int, 2^(4:0.5:11))\nerr = zeros(length(n), 2)\nfor (k, n) in enumerate(n)\n    t, Dₓ, Dₓₓ = FNC.diffmat2(n, [-1, 1])\n    y = f.(t)\n    err[k, 1] = norm(df_dx.(t) - Dₓ * y, Inf)\n    err[k, 2] = norm(d2f_dx2.(t) - Dₓₓ * y, Inf)\nend\nplot(n, err, m = :o, label = [L\"f'\" L\"f''\"])\nplot!(n, 10 * 10 * n .^ (-2);\n    l = (:dash, :black),\n    label = \"2nd order\",\n    xaxis = (:log10, \"n\"),\n    yaxis = (:log10, \"max error\"),\n    title = \"Convergence of finite differences\")","key":"gZ2DAJAqQC"},{"type":"output","id":"Wy8TLwGGqk_N7WEAlz214","data":[{"output_type":"execute_result","execution_count":21,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"cf04358e67277d7df5af5c4901499897","path":"/build/cf04358e67277d7df5af5c4901499897.png"},"text/html":{"content_type":"text/html","hash":"0ad52a0396465ceb2ed8df4aa9697e06","path":"/build/0ad52a0396465ceb2ed8df4aa9697e06.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"c5e94b92b31fe2f28621eca7c288cebe","path":"/build/c5e94b92b31fe2f28621eca7c288cebe.svg"}}}],"key":"dnNi2NqK20"}],"data":{},"key":"WZ9WMeHrPv"}],"key":"YhDEOYZPFC"}],"key":"GWDasZTqeT"}],"key":"Ex6XJxbls2"},{"type":"tabItem","title":"MATLAB","sync":"matlab","children":[{"type":"embed","source":{"url":"/chapter10-1","label":"demo-diffmats-2nd-matlab","kind":"Notebook","slug":"chapter10-1","location":"/matlab/chapter10.md","title":"Chapter 10"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-diffmats-2nd","label":"demo-diffmats-2nd","kind":"proof:example","position":{"start":{"line":221,"column":1},"end":{"line":221,"column":19}},"children":[{"type":"text","value":"Example ","key":"tWLVaohTgy"},{"type":"text","value":"10.3.1","key":"kXlH2xNGIE"}],"template":"Example %s","enumerator":"10.3.1","resolved":true,"html_id":"demo-diffmats-2nd","remote":true,"url":"/diffmats","dataUrl":"/diffmats.json","key":"EEWhMJRLe0"}],"key":"DsyMEYHOt6"},{"type":"paragraph","position":{"start":{"line":223,"column":1},"end":{"line":223,"column":1}},"children":[{"type":"text","value":"We test first-order and second-order differentiation matrices for the function ","position":{"start":{"line":223,"column":1},"end":{"line":223,"column":1}},"key":"ATftg81Ocz"},{"type":"inlineMath","value":"x + \\exp(\\sin 4x)","position":{"start":{"line":223,"column":1},"end":{"line":223,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mo>+</mo><mi>exp</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mi>sin</mi><mo>⁡</mo><mn>4</mn><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">x + \\exp(\\sin 4x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop\">exp</span><span class=\"mopen\">(</span><span class=\"mop\">sin</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">4</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span>","key":"vYm18Uv4Vr"},{"type":"text","value":" over ","position":{"start":{"line":223,"column":1},"end":{"line":223,"column":1}},"key":"EfzCeWa5wX"},{"type":"inlineMath","value":"[-1,1]","position":{"start":{"line":223,"column":1},"end":{"line":223,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mo>−</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[-1,1]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">−</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]</span></span></span></span>","key":"eLLQ6M2lRH"},{"type":"text","value":".","position":{"start":{"line":223,"column":1},"end":{"line":223,"column":1}},"key":"RU5TnjZxSP"}],"key":"DYyxTNjnUM"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"f = @(x) x + exp(sin(4*x));","key":"RMILuBlGlr"},{"type":"output","id":"qSk6pQ5Bl3nfg-idSiybf","data":[],"key":"ysh4O9PvGY"}],"data":{},"key":"dHPmnSiS9j"},{"type":"paragraph","position":{"start":{"line":229,"column":1},"end":{"line":229,"column":1}},"children":[{"type":"text","value":"For reference, here are the exact first and second derivatives.","position":{"start":{"line":229,"column":1},"end":{"line":229,"column":1}},"key":"qRh19lOCYI"}],"key":"SuYMVoq0vA"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"df_dx = @(x) 1 + 4 * exp(sin(4*x)) .* cos(4*x);\nd2f_dx2 = @(x) 4 * exp(sin(4*x)) .* (4*cos(4*x).^2 - 4*sin(4*x));","key":"KxjP1IXw2f"},{"type":"output","id":"yyu-MrXY321jr7-8gr3fO","data":[],"key":"YK41bjIIeN"}],"data":{},"key":"mCyW2wv1G8"},{"type":"paragraph","position":{"start":{"line":236,"column":1},"end":{"line":236,"column":1}},"children":[{"type":"text","value":"We discretize on equally spaced nodes and evaluate ","position":{"start":{"line":236,"column":1},"end":{"line":236,"column":1}},"key":"WKB5UZe3F4"},{"type":"inlineMath","value":"f","position":{"start":{"line":236,"column":1},"end":{"line":236,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>","key":"a8a0HkMh8W"},{"type":"text","value":" at the nodes.","position":{"start":{"line":236,"column":1},"end":{"line":236,"column":1}},"key":"ROBI3crjzO"}],"key":"zEQ9hrHDAQ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[t, Dx, Dxx] = diffmat2(12, [-1 1]);\ny = f(t);","key":"NoSpv0KX2p"},{"type":"output","id":"THJfzU-r-cAhaHI_LcWR-","data":[],"key":"CiQDowN45r"}],"data":{},"key":"TdP77fdx97"},{"type":"paragraph","position":{"start":{"line":243,"column":1},"end":{"line":243,"column":1}},"children":[{"type":"text","value":"Then the first two derivatives of ","position":{"start":{"line":243,"column":1},"end":{"line":243,"column":1}},"key":"iD7FQ85M59"},{"type":"inlineMath","value":"f","position":{"start":{"line":243,"column":1},"end":{"line":243,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>","key":"uPoTzUPf15"},{"type":"text","value":" each require one matrix-vector multiplication.","position":{"start":{"line":243,"column":1},"end":{"line":243,"column":1}},"key":"HY2JEutwQq"}],"key":"jXkuYTOUw3"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"yx = Dx * y;\nyxx = Dxx * y;","key":"lIvWKRkscM"},{"type":"output","id":"svy5AXrpyDgRldop10Rng","data":[],"key":"gTiRtQAG9k"}],"data":{},"key":"Ht0Tcbqfx7"},{"type":"paragraph","position":{"start":{"line":250,"column":1},"end":{"line":250,"column":1}},"children":[{"type":"text","value":"The results show poor accuracy for this small value of ","position":{"start":{"line":250,"column":1},"end":{"line":250,"column":1}},"key":"cRHi4ERwcK"},{"type":"inlineMath","value":"n","position":{"start":{"line":250,"column":1},"end":{"line":250,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"ul1sOu05TO"},{"type":"text","value":".","position":{"start":{"line":250,"column":1},"end":{"line":250,"column":1}},"key":"WzVax3kj35"}],"key":"RtAuJjgNFi"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf,  subplot(2, 1, 1)\nfplot(df_dx, [-1, 1]),  hold on\nplot(t, yx, 'ko')\nxlabel('x'),  ylabel('f''(x)')\nsubplot(2, 1, 2)\nfplot(d2f_dx2, [-1, 1]),  hold on\nplot(t, yxx, 'ko')\nxlabel('x'),  ylabel('f''''(x)')","key":"WwxctheiJT"},{"type":"output","id":"DiP9YRFcV7sz4Wzp4Z5Nj","data":[{"output_type":"execute_result","execution_count":19,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"7bc2065e8562af6ef5865b0837ab7b39","path":"/build/7bc2065e8562af6ef5865b0837ab7b39.png"}}}],"key":"VhKKOfbdOH"}],"data":{},"key":"nmDBFVokZd"},{"type":"paragraph","position":{"start":{"line":263,"column":1},"end":{"line":263,"column":1}},"children":[{"type":"text","value":"An convergence experiment confirms the order of accuracy. Because we expect an algebraic convergence rate, we use a log-log plot of the errors.","position":{"start":{"line":263,"column":1},"end":{"line":263,"column":1}},"key":"xEK7ioZz8f"}],"key":"ETw5hW5qdr"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"n = round( 2 .^ (4:.5:11)' );\nerr = zeros(length(n), 2);\nfor k = 1:length(n)\n    [t, Dx, Dxx] = diffmat2(n(k), [-1, 1]);\n    y = f(t);\n    err(k, 1) = norm(df_dx(t) - Dx * y, Inf);\n    err(k, 2) = norm(d2f_dx2(t) - Dxx * y, Inf);\nend\nclf\nloglog(n, err, 'o-'), hold on\nloglog(n, 100 * n.^(-2), 'k--')\nlegend(\"f'\", \"f''\", '2nd order')\nxlabel('n'),  ylabel('max error')\ntitle('Convergence of finite differences')","key":"kwsqNIQlNT"},{"type":"output","id":"GsY0GAsqVHex9dBSIG6VF","data":[{"output_type":"execute_result","execution_count":20,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"c8fb4f30d63c96c5670b85500df51ec7","path":"/build/c8fb4f30d63c96c5670b85500df51ec7.png"}}}],"key":"jf7acgTLTW"}],"data":{},"key":"NHCl7sn3Nr"}],"key":"qA20cGRq74"}],"key":"tlybixDS0Q"}],"key":"FOW0dnr37P"},{"type":"tabItem","title":"Python","sync":"python","children":[{"type":"embed","source":{"url":"/chapter10-2","label":"demo-diffmats-2nd-python","kind":"Notebook","slug":"chapter10-2","location":"/python/chapter10.md","title":"Chapter 10"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-diffmats-2nd","label":"demo-diffmats-2nd","kind":"proof:example","position":{"start":{"line":253,"column":1},"end":{"line":253,"column":19}},"children":[{"type":"text","value":"Example ","key":"rxBstMM2ak"},{"type":"text","value":"10.3.1","key":"MoTuwXp9sN"}],"template":"Example %s","enumerator":"10.3.1","resolved":true,"html_id":"demo-diffmats-2nd","remote":true,"url":"/diffmats","dataUrl":"/diffmats.json","key":"FGjorGB5Tn"}],"key":"MD8Q2438Mt"},{"type":"paragraph","position":{"start":{"line":255,"column":1},"end":{"line":255,"column":1}},"children":[{"type":"text","value":"We test first-order and second-order differentiation matrices for the function ","position":{"start":{"line":255,"column":1},"end":{"line":255,"column":1}},"key":"aytNzchE4u"},{"type":"inlineMath","value":"x + \\exp(\\sin 4x)","position":{"start":{"line":255,"column":1},"end":{"line":255,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mo>+</mo><mi>exp</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mi>sin</mi><mo>⁡</mo><mn>4</mn><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">x + \\exp(\\sin 4x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop\">exp</span><span class=\"mopen\">(</span><span class=\"mop\">sin</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">4</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span>","key":"fbpaVT7dbN"},{"type":"text","value":" over ","position":{"start":{"line":255,"column":1},"end":{"line":255,"column":1}},"key":"SYqiVqlT5T"},{"type":"inlineMath","value":"[-1,1]","position":{"start":{"line":255,"column":1},"end":{"line":255,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mo>−</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[-1,1]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">−</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]</span></span></span></span>","key":"s4P5AT7F0F"},{"type":"text","value":".","position":{"start":{"line":255,"column":1},"end":{"line":255,"column":1}},"key":"YxGjGFxHra"}],"key":"D34FwkPWth"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"f = lambda x: x + exp( sin(4 * x) )","key":"uPpcI78RmZ"},{"type":"output","id":"E9txV9uXqwCfFJOR74TSY","data":[],"key":"tlMr9gcZBY"}],"data":{},"key":"wB2MX2EOGQ"},{"type":"paragraph","position":{"start":{"line":261,"column":1},"end":{"line":261,"column":1}},"children":[{"type":"text","value":"For reference, here are the exact first and second derivatives.","position":{"start":{"line":261,"column":1},"end":{"line":261,"column":1}},"key":"MVWDz07lp4"}],"key":"CEZb3kMA44"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"df_dx = lambda x: 1 + 4 * exp(sin(4 * x)) * cos(4 * x)\nd2f_dx2 = lambda x: 4 * exp(sin(4 * x)) * (4 * cos(4 * x)**2 - 4 * sin(4 * x))","key":"aeZg1vp9Pk"},{"type":"output","id":"Zbd8Tjw95eVsTUTMqPcf7","data":[],"key":"Bi2KSmicGT"}],"data":{},"key":"ECVhaGYlIX"},{"type":"paragraph","position":{"start":{"line":268,"column":1},"end":{"line":268,"column":1}},"children":[{"type":"text","value":"We discretize on equally spaced nodes and evaluate ","position":{"start":{"line":268,"column":1},"end":{"line":268,"column":1}},"key":"QRlY7rKJud"},{"type":"inlineMath","value":"f","position":{"start":{"line":268,"column":1},"end":{"line":268,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>","key":"XT1ncLy7NH"},{"type":"text","value":" at the nodes.","position":{"start":{"line":268,"column":1},"end":{"line":268,"column":1}},"key":"NVLNAtWqKV"}],"key":"zPEZeiZLN1"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"t, Dx, Dxx = FNC.diffmat2(12, [-1, 1])\ny = f(t)","key":"Ypn6P3T4V1"},{"type":"output","id":"_aLoN_XnJbix3b4tjqONl","data":[],"key":"sthTItWyiM"}],"data":{},"key":"OKMpn5HGg3"},{"type":"paragraph","position":{"start":{"line":275,"column":1},"end":{"line":275,"column":1}},"children":[{"type":"text","value":"Then the first two derivatives of ","position":{"start":{"line":275,"column":1},"end":{"line":275,"column":1}},"key":"W83HOtfh6U"},{"type":"inlineMath","value":"f","position":{"start":{"line":275,"column":1},"end":{"line":275,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>","key":"GQaRzfY6HZ"},{"type":"text","value":" each require one matrix-vector multiplication.","position":{"start":{"line":275,"column":1},"end":{"line":275,"column":1}},"key":"MQntsc5XaS"}],"key":"BoTQW2lYsa"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"yx = Dx @ y\nyxx = Dxx @ y","key":"QCPrzq4ArS"},{"type":"output","id":"-RZQ6yQWgfL_TY2nuv1vD","data":[],"key":"OqlnLpWBFI"}],"data":{},"key":"LKxtVYbtmt"},{"type":"paragraph","position":{"start":{"line":282,"column":1},"end":{"line":282,"column":1}},"children":[{"type":"text","value":"The results show poor accuracy for this small value of ","position":{"start":{"line":282,"column":1},"end":{"line":282,"column":1}},"key":"qKpc06etiG"},{"type":"inlineMath","value":"n","position":{"start":{"line":282,"column":1},"end":{"line":282,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"L1XfspEiRK"},{"type":"text","value":".","position":{"start":{"line":282,"column":1},"end":{"line":282,"column":1}},"key":"AtMhQgu0fy"}],"key":"N3cgXQ6zDU"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"x = linspace(-1, 1, 500)\nsubplot(2, 1, 1)\nplot(x, df_dx(x))\nplot(t, yx, \"ko\")\nxlabel(\"$x$\"),  ylabel(\"$f'(x)$\")\n\nsubplot(2, 1, 2)\nplot(x, d2f_dx2(x))\nplot(t, yxx, \"ko\")\nxlabel(\"$x$\"),  ylabel(\"$f''(x)$\");","key":"hxTFORiVvu"},{"type":"output","id":"QZq2EK7dvU4frqXVXELSo","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 2 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"1b70df6b8023b535ffa7ea2bb6f30cc3","path":"/build/1b70df6b8023b535ffa7ea2bb6f30cc3.png"}}}],"key":"Yae3QmubzS"}],"data":{},"key":"gwP4xzApwI"},{"type":"paragraph","position":{"start":{"line":297,"column":1},"end":{"line":297,"column":1}},"children":[{"type":"text","value":"A convergence experiment confirms the order of accuracy. Because we expect an algebraic convergence rate, we use a log-log plot of the errors.","position":{"start":{"line":297,"column":1},"end":{"line":297,"column":1}},"key":"SRhvrQ1xrZ"}],"key":"NI9idP0fJi"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"N = array([int(2**k) for k in arange(4, 11.5, 0.5)])\nerr1 = zeros(len(N))\nerr2 = zeros(len(N))\nfor k, n in enumerate(N):\n    t, Dx, Dxx = FNC.diffmat2(n, [-1, 1])\n    y = f(t)\n    err1[k] = norm(df_dx(t) - Dx @ y, inf)\n    err2[k] = norm(d2f_dx2(t) - Dxx @ y, inf)\n\nloglog(N, err1, \"-o\", label=\"$f'$\")\nloglog(N, err2, \"-o\", label=\"$f''$\")\nplot(N, 10 * 10 / N**2, \"k--\", label=\"2nd order\")\nxlabel(\"$n$\"),  ylabel(\"max error\")\nlegend(loc=\"lower left\")\ntitle(\"Convergence of finite differences\");","key":"WWWNTmjR5s"},{"type":"output","id":"IlzcWDwFfjseRlypRnDoX","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"010d09be50d41c34e41f4eeee0aca78d","path":"/build/010d09be50d41c34e41f4eeee0aca78d.png"}}}],"key":"drh3VNXdxC"}],"data":{},"key":"Gpqokh0KAy"}],"key":"BslmrMCX53"}],"key":"RrJoesXynh"}],"key":"d8aauFMZv6"}],"key":"D0yt9ptcyC"}],"label":"demo-diffmats-2nd","identifier":"demo-diffmats-2nd","html_id":"demo-diffmats-2nd","enumerator":"10.3.1","key":"EQCe8NEbAg"},{"type":"heading","depth":2,"position":{"start":{"line":166,"column":1},"end":{"line":166,"column":1}},"children":[{"type":"text","value":"Spectral differentiation","position":{"start":{"line":166,"column":1},"end":{"line":166,"column":1}},"key":"TrBcQFdE8m"}],"identifier":"spectral-differentiation","label":"Spectral differentiation","html_id":"spectral-differentiation","implicit":true,"enumerator":"10.3.3","key":"KVRn79eAsz"},{"type":"paragraph","position":{"start":{"line":168,"column":1},"end":{"line":168,"column":1}},"children":[{"type":"text","value":"Recall that finite-difference formulas are derived in three steps:","position":{"start":{"line":168,"column":1},"end":{"line":168,"column":1}},"key":"j9FX7DzDGM"}],"key":"HkmT2zGXoz"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":170,"column":1},"end":{"line":173,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":170,"column":1},"end":{"line":170,"column":1}},"children":[{"type":"text","value":"Choose a node index set ","position":{"start":{"line":170,"column":1},"end":{"line":170,"column":1}},"key":"fDGir2Wogp"},{"type":"inlineMath","value":"S","position":{"start":{"line":170,"column":1},"end":{"line":170,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>S</mi></mrow><annotation encoding=\"application/x-tex\">S</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span></span></span></span>","key":"m6KeaEcG42"},{"type":"text","value":" near node ","position":{"start":{"line":170,"column":1},"end":{"line":170,"column":1}},"key":"SZOycU1rfy"},{"type":"inlineMath","value":"i","position":{"start":{"line":170,"column":1},"end":{"line":170,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span>","key":"moYQgKrjN6"},{"type":"text","value":".","position":{"start":{"line":170,"column":1},"end":{"line":170,"column":1}},"key":"uf6HGoMbEE"}],"key":"ccHk4Ktt6k"},{"type":"listItem","spread":true,"position":{"start":{"line":171,"column":1},"end":{"line":171,"column":1}},"children":[{"type":"text","value":"Interpolate with a polynomial using the nodes in ","position":{"start":{"line":171,"column":1},"end":{"line":171,"column":1}},"key":"YRqOH1aUf0"},{"type":"inlineMath","value":"S","position":{"start":{"line":171,"column":1},"end":{"line":171,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>S</mi></mrow><annotation encoding=\"application/x-tex\">S</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span></span></span></span>","key":"xPXyppoE0m"},{"type":"text","value":".","position":{"start":{"line":171,"column":1},"end":{"line":171,"column":1}},"key":"tMfzbgPkDD"}],"key":"woAdYTEVWw"},{"type":"listItem","spread":true,"position":{"start":{"line":172,"column":1},"end":{"line":173,"column":1}},"children":[{"type":"text","value":"Differentiate the interpolant and evaluate at node ","position":{"start":{"line":172,"column":1},"end":{"line":172,"column":1}},"key":"D0DGeTtD2i"},{"type":"inlineMath","value":"i","position":{"start":{"line":172,"column":1},"end":{"line":172,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span>","key":"o43w0qeM2W"},{"type":"text","value":".","position":{"start":{"line":172,"column":1},"end":{"line":172,"column":1}},"key":"ylYsuMCYtK"}],"key":"UYjOcTwXYp"}],"key":"IUMTCeEFTI"},{"type":"paragraph","position":{"start":{"line":176,"column":1},"end":{"line":176,"column":1}},"children":[{"type":"text","value":"We can modify this process by using a global interpolant, either polynomial or trigonometric, as in ","position":{"start":{"line":176,"column":1},"end":{"line":176,"column":1}},"key":"n5i9g6nmjm"},{"type":"link","url":"../globalapprox/overview","position":{"start":{"line":176,"column":1},"end":{"line":176,"column":1}},"children":[{"type":"text","value":"Chapter 9","position":{"start":{"line":176,"column":1},"end":{"line":176,"column":1}},"key":"PqdRBYbqBu"}],"urlSource":"../globalapprox/overview","key":"Ij6T7IDdji"},{"type":"text","value":". Rather than choosing a different index set for each node, we use all of the nodes each time.","position":{"start":{"line":176,"column":1},"end":{"line":176,"column":1}},"key":"bFPMy5tcjq"}],"indexEntries":[{"entry":"Chebyshev points","subEntry":{"value":"second kind","kind":"entry"},"emphasis":false}],"label":"index-SIISIw3UOP","identifier":"index-siisiw3uop","html_id":"index-siisiw3uop","key":"dHOsYwgRJ4"},{"type":"paragraph","position":{"start":{"line":178,"column":1},"end":{"line":178,"column":1}},"children":[{"type":"text","value":"In a nonperiodic setting we use Chebyshev second-kind points for stability:","position":{"start":{"line":178,"column":1},"end":{"line":178,"column":1}},"key":"b6blXDwAdS"}],"key":"RF3ZS3EBJ8"},{"type":"math","value":"x_k = -\\cos\\left(\\frac{k \\pi}{n}\\right), \\qquad k=0,\\ldots,n;","position":{"start":{"line":180,"column":1},"end":{"line":182,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>x</mi><mi>k</mi></msub><mo>=</mo><mo>−</mo><mi>cos</mi><mo>⁡</mo><mrow><mo fence=\"true\">(</mo><mfrac><mrow><mi>k</mi><mi>π</mi></mrow><mi>n</mi></mfrac><mo fence=\"true\">)</mo></mrow><mo separator=\"true\">,</mo><mspace width=\"2em\"/><mi>k</mi><mo>=</mo><mn>0</mn><mo separator=\"true\">,</mo><mo>…</mo><mo separator=\"true\">,</mo><mi>n</mi><mo separator=\"true\">;</mo></mrow><annotation encoding=\"application/x-tex\">x_k = -\\cos\\left(\\frac{k \\pi}{n}\\right), \\qquad k=0,\\ldots,n;</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.4em;vertical-align:-0.95em;\"></span><span class=\"mord\">−</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">cos</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">(</span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">n</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">kπ</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">)</span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:2em;\"></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8389em;vertical-align:-0.1944em;\"></span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mpunct\">;</span></span></span></span></span>","enumerator":"10.3.8","key":"f6jw1SoGfC"},{"type":"paragraph","position":{"start":{"line":186,"column":1},"end":{"line":186,"column":1}},"children":[{"type":"text","value":"then the resulting ","position":{"start":{"line":186,"column":1},"end":{"line":186,"column":1}},"key":"mO6tUvSwyd"},{"type":"strong","position":{"start":{"line":186,"column":1},"end":{"line":186,"column":1}},"children":[{"type":"text","value":"Chebyshev differentiation matrix","position":{"start":{"line":186,"column":1},"end":{"line":186,"column":1}},"key":"F7s36a13uX"}],"key":"cvr2Qq0TQB"},{"type":"text","value":" has entries","position":{"start":{"line":186,"column":1},"end":{"line":186,"column":1}},"key":"YvvBKs7sVw"}],"indexEntries":[{"entry":"differentiation matrix","emphasis":false}],"label":"index-AbfFSa8LMR","identifier":"index-abffsa8lmr","html_id":"index-abffsa8lmr","key":"hc9xS6GaPl"},{"type":"math","value":"  \\begin{gathered}\n    D_{00} = \\dfrac{2n^2+1}{6}, \\qquad D_{n n} = -\\dfrac{2n^2+1}{6}, \\\\\n    D_{ij} =\n    \\begin{cases}\n      -\\dfrac{x_i}{2(1-x_i^2)}, & i=j, \\\\[4mm]\n      \\dfrac{c_i}{c_j}\\, \\dfrac{(-1)^{i+j}}{x_i-x_j}, & i\\neq j,\n    \\end{cases}\n  \\end{gathered}","label":"chebdiffmat","identifier":"chebdiffmat","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mtable rowspacing=\"0.25em\" columnalign=\"center\" columnspacing=\"0em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><msub><mi>D</mi><mn>00</mn></msub><mo>=</mo><mfrac><mrow><mn>2</mn><msup><mi>n</mi><mn>2</mn></msup><mo>+</mo><mn>1</mn></mrow><mn>6</mn></mfrac><mo separator=\"true\">,</mo><mspace width=\"2em\"/><msub><mi>D</mi><mrow><mi>n</mi><mi>n</mi></mrow></msub><mo>=</mo><mo>−</mo><mfrac><mrow><mn>2</mn><msup><mi>n</mi><mn>2</mn></msup><mo>+</mo><mn>1</mn></mrow><mn>6</mn></mfrac><mo separator=\"true\">,</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><msub><mi>D</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mrow><mo fence=\"true\">{</mo><mtable rowspacing=\"0.36em\" columnalign=\"left left\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><msub><mi>x</mi><mi>i</mi></msub><mrow><mn>2</mn><mo stretchy=\"false\">(</mo><mn>1</mn><mo>−</mo><msubsup><mi>x</mi><mi>i</mi><mn>2</mn></msubsup><mo stretchy=\"false\">)</mo></mrow></mfrac></mstyle><mo separator=\"true\">,</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mi>i</mi><mo>=</mo><mi>j</mi><mo separator=\"true\">,</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><msub><mi>c</mi><mi>i</mi></msub><msub><mi>c</mi><mi>j</mi></msub></mfrac></mstyle><mtext> </mtext><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mo stretchy=\"false\">(</mo><mo>−</mo><mn>1</mn><msup><mo stretchy=\"false\">)</mo><mrow><mi>i</mi><mo>+</mo><mi>j</mi></mrow></msup></mrow><mrow><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><msub><mi>x</mi><mi>j</mi></msub></mrow></mfrac></mstyle><mo separator=\"true\">,</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mi>i</mi><mo mathvariant=\"normal\">≠</mo><mi>j</mi><mo separator=\"true\">,</mo></mrow></mstyle></mtd></mtr></mtable></mrow></mrow></mstyle></mtd></mtr></mtable><annotation encoding=\"application/x-tex\">  \\begin{gathered}\n    D_{00} = \\dfrac{2n^2+1}{6}, \\qquad D_{n n} = -\\dfrac{2n^2+1}{6}, \\\\\n    D_{ij} =\n    \\begin{cases}\n      -\\dfrac{x_i}{2(1-x_i^2)}, &amp; i=j, \\\\[4mm]\n      \\dfrac{c_i}{c_j}\\, \\dfrac{(-1)^{i+j}}{x_i-x_j}, &amp; i\\neq j,\n    \\end{cases}\n  \\end{gathered}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:7.9286em;vertical-align:-3.7143em;\"></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:4.2143em;\"><span style=\"top:-7.5489em;\"><span class=\"pstrut\" style=\"height:4.8257em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">00</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.4911em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">6</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"mord\"><span class=\"mord mathnormal\">n</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:2em;\"></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">nn</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\">−</span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.4911em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">6</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"mord\"><span class=\"mord mathnormal\">n</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mpunct\">,</span></span></span><span style=\"top:-3.7372em;\"><span class=\"pstrut\" style=\"height:4.8257em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">ij</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"minner\"><span class=\"mopen\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.65em;\"><span style=\"top:-1.9em;\"><span class=\"pstrut\" style=\"height:3.15em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎩</span></span></span><span style=\"top:-1.892em;\"><span class=\"pstrut\" style=\"height:3.15em;\"></span><span style=\"height:0.616em;width:0.8889em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.8889em' height='0.616em' style='width:0.8889em' viewBox='0 0 888.89 616' preserveAspectRatio='xMinYMin'><path d='M384 0 H504 V616 H384z M384 0 H504 V616 H384z'/></svg></span></span><span style=\"top:-3.15em;\"><span class=\"pstrut\" style=\"height:3.15em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎨</span></span></span><span style=\"top:-4.292em;\"><span class=\"pstrut\" style=\"height:3.15em;\"></span><span style=\"height:0.616em;width:0.8889em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.8889em' height='0.616em' style='width:0.8889em' viewBox='0 0 888.89 616' preserveAspectRatio='xMinYMin'><path d='M384 0 H504 V616 H384z M384 0 H504 V616 H384z'/></svg></span></span><span style=\"top:-4.9em;\"><span class=\"pstrut\" style=\"height:3.15em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎧</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-l\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.8257em;\"><span style=\"top:-5.2198em;\"><span class=\"pstrut\" style=\"height:3.5017em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.1076em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7959em;\"><span style=\"top:-2.4231em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span><span style=\"top:-3.0448em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2769em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9629em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mpunct\">,</span></span></span><span style=\"top:-2.1481em;\"><span class=\"pstrut\" style=\"height:3.5017em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.1076em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9721em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.5017em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mopen\">(</span><span class=\"mord\">−</span><span class=\"mord\">1</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8247em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mbin mtight\">+</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9721em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mpunct\">,</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.3257em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:1em;\"></span><span class=\"col-align-l\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.8257em;\"><span style=\"top:-5.2198em;\"><span class=\"pstrut\" style=\"height:3.5017em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span><span class=\"mpunct\">,</span></span></span><span style=\"top:-2.1481em;\"><span class=\"pstrut\" style=\"height:3.5017em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\"><span class=\"mrel\"><span class=\"mord vbox\"><span class=\"thinbox\"><span class=\"rlap\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"inner\"><span class=\"mord\"><span class=\"mrel\"></span></span></span><span class=\"fix\"></span></span></span></span></span><span class=\"mrel\">=</span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span><span class=\"mpunct\">,</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.3257em;\"><span></span></span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.7143em;\"><span></span></span></span></span></span></span></span></span></span></span></span>","enumerator":"10.3.9","html_id":"chebdiffmat","key":"TBqOltHrJk"},{"type":"paragraph","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"children":[{"type":"text","value":"where ","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"key":"BwT2HBzS1i"},{"type":"inlineMath","value":"c_0=c_n=2","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>c</mi><mn>0</mn></msub><mo>=</mo><msub><mi>c</mi><mi>n</mi></msub><mo>=</mo><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">c_0=c_n=2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span></span></span></span>","key":"x1EWlwz8AD"},{"type":"text","value":" and ","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"key":"op8KuJG6lz"},{"type":"inlineMath","value":"c_i=1","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>c</mi><mi>i</mi></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">c_i=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"z4qjgQ6Bwf"},{"type":"text","value":" for ","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"key":"PtwiGHOWiG"},{"type":"inlineMath","value":"i=1,\\ldots,n-1","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi><mo>=</mo><mn>1</mn><mo separator=\"true\">,</mo><mo>…</mo><mo separator=\"true\">,</mo><mi>n</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">i=1,\\ldots,n-1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8389em;vertical-align:-0.1944em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"zNjwKbZ8qC"},{"type":"text","value":". Note that this matrix is dense. The simplest way to compute a second derivative is by squaring ","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"key":"XIenCdPKLc"},{"type":"inlineMath","value":"\\mathbf{D}_x","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">D</mi><mi>x</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbf{D}_x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8361em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">D</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"ckjIPeHsh5"},{"type":"text","value":", as there is no longer any concern about the bandwidth of the result.","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"key":"DBWBpsxs62"}],"key":"xVAg5r01n0"},{"type":"paragraph","position":{"start":{"line":202,"column":1},"end":{"line":202,"column":1}},"children":[{"type":"crossReference","kind":"proof:algorithm","identifier":"function-diffcheb","label":"function-diffcheb","children":[{"type":"text","value":"Function ","key":"q5IzdNRBK2"},{"type":"text","value":"10.3.2","key":"KzWuVFQCSW"}],"template":"Algorithm %s","enumerator":"10.3.2","resolved":true,"html_id":"function-diffcheb","key":"mo3hb1g2d0"},{"type":"text","value":" returns these two matrices. The function uses a change of variable to transplant the standard ","position":{"start":{"line":202,"column":1},"end":{"line":202,"column":1}},"key":"SIdiiGvz0I"},{"type":"inlineMath","value":"[-1,1]","position":{"start":{"line":202,"column":1},"end":{"line":202,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mo>−</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[-1,1]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">−</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]</span></span></span></span>","key":"tFn3d3Kje1"},{"type":"text","value":" for Chebyshev nodes to any ","position":{"start":{"line":202,"column":1},"end":{"line":202,"column":1}},"key":"F7atqmb6VU"},{"type":"inlineMath","value":"[a,b]","position":{"start":{"line":202,"column":1},"end":{"line":202,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mi>a</mi><mo separator=\"true\">,</mo><mi>b</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[a,b]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">a</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">b</span><span class=\"mclose\">]</span></span></span></span>","key":"eWxMSSXGYD"},{"type":"text","value":". It also takes a different approach to computing the diagonal elements of ","position":{"start":{"line":202,"column":1},"end":{"line":202,"column":1}},"key":"rmhFIC8WaD"},{"type":"inlineMath","value":"\\mathbf{D}_x","position":{"start":{"line":202,"column":1},"end":{"line":202,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">D</mi><mi>x</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbf{D}_x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8361em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">D</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"uRbouc7xwe"},{"type":"text","value":" than the formulas in ","position":{"start":{"line":202,"column":1},"end":{"line":202,"column":1}},"key":"BJJaViyK9e"},{"type":"crossReference","kind":"equation","identifier":"chebdiffmat","label":"chebdiffmat","children":[{"type":"text","value":"(","key":"DN9lNa4GA4"},{"type":"text","value":"10.3.9","key":"j5BZyPGWvb"},{"type":"text","value":")","key":"D9akqbzJVw"}],"template":"(%s)","enumerator":"10.3.9","resolved":true,"html_id":"chebdiffmat","key":"E3Sgxn7PaJ"},{"type":"text","value":" (see ","position":{"start":{"line":202,"column":1},"end":{"line":202,"column":1}},"key":"hJ7FNezOtq"},{"type":"crossReference","kind":"list","identifier":"problem-diffmats-negsumtrick","label":"problem-diffmats-negsumtrick","children":[{"type":"text","value":"Exercise 5","key":"uNgFd6LSMQ"}],"template":"List","resolved":true,"html_id":"problem-diffmats-negsumtrick","key":"FAdqkIpQqp"},{"type":"text","value":").","position":{"start":{"line":202,"column":1},"end":{"line":202,"column":1}},"key":"jDqEnpysLP"}],"key":"Vu4jBK0Qeo"},{"type":"proof","kind":"algorithm","enumerated":true,"children":[{"type":"admonitionTitle","children":[{"type":"text","value":"diffcheb","position":{"start":{"line":205,"column":1},"end":{"line":205,"column":1}},"key":"A86VyzcB7O"}],"key":"wIFkqEYnTw"},{"type":"tabSet","children":[{"type":"tabItem","title":"Julia","sync":"julia","children":[{"type":"embed","source":{"url":"/chapter10","label":"function-diffcheb-julia","kind":"Notebook","slug":"chapter10","location":"/julia/chapter10.md","title":"Chapter 10"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Chebyshev differentiation matrices","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"key":"zoDWhx8kmt"}],"key":"FbWS0Z71MP"},{"type":"include","file":"FNCFunctions/src/chapter10.jl","literal":true,"filter":{"startAfter":"# begin diffcheb","endBefore":"# end diffcheb"},"children":[{"type":"code","value":"\"\"\"\n    diffcheb(n, xspan)\n\nCompute Chebyshev differentiation matrices on `n`+1 points in the\ninterval `xspan`. Returns a vector of nodes and the matrices for the\nfirst and second derivatives.\n\"\"\"\nfunction diffcheb(n, xspan)\n    x = [-cos(k * π / n) for k in 0:n]    # nodes in [-1,1]\n\n    # Off-diagonal entries.\n    c = [2; ones(n - 1); 2]    # endpoint factors\n    dij = (i, j) -> (-1)^(i + j) * c[i+1] / (c[j+1] * (x[i+1] - x[j+1]))\n    Dₓ = [dij(i, j) for i in 0:n, j in 0:n]\n\n    # Diagonal entries.\n    Dₓ[isinf.(Dₓ)] .= 0         # fix divisions by zero on diagonal\n    s = sum(Dₓ, dims = 2)\n    Dₓ -= diagm(s[:, 1])         # \"negative sum trick\"\n\n    # Transplant to [a,b].\n    a, b = xspan\n    x = @. a + (b - a) * (x + 1) / 2\n    Dₓ = 2 * Dₓ / (b - a)             # chain rule\n\n    # Second derivative.\n    Dₓₓ = Dₓ^2\n    return x, Dₓ, Dₓₓ\nend","lang":"julia","showLineNumbers":true,"filename":"diffcheb.jl","key":"lPSzhk999j"}],"key":"pusgzg4RGK"}],"key":"bXIn0wZfjD"}],"key":"DG0J83O8d0"}],"key":"kLakff6IHI"},{"type":"tabItem","title":"MATLAB","sync":"matlab","children":[{"type":"embed","source":{"url":"/chapter10-1","label":"function-diffcheb-matlab","kind":"Notebook","slug":"chapter10-1","location":"/matlab/chapter10.md","title":"Chapter 10"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Chebyshev differentiation matrices","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"ccJsGPUnVx"}],"key":"Xmxoy5Yb0m"},{"type":"include","file":"FNC-matlab/diffcheb.m","literal":true,"filter":{},"children":[{"type":"code","value":"function [x,Dx,Dxx] = diffcheb(n,xspan)\n%DIFFCHEB   Chebyshev differentiation matrices.\n% Input:\n%   n      number of subintervals (integer)\n%   xspan  interval endpoints (vector)\n% Output:\n%   x      Chebyshev nodes in domain (length n+1)\n%   Dx     matrix for first derivative (n+1 by n+1)\n%   Dxx    matrix for second derivative (n+1 by n+1)\n\nx = -cos( (0:n)'*pi/n );    % nodes in [-1,1]\nDx = zeros(n+1);\nc = [2; ones(n-1,1); 2];    % endpoint factors\ni = (0:n)';                 % row indices\n\n% Off-diagonal entries\nfor j = 0:n\n  num = c(i+1).*(-1).^(i+j);\n  den = c(j+1)*(x-x(j+1));\n  Dx(:,j+1) = num./den;\nend\n\n% Diagonal entries\nDx(isinf(Dx)) = 0;          % fix divisions by zero on diagonal\nDx = Dx - diag(sum(Dx,2));  % \"negative sum trick\" \n  \n% Transplant to [a,b]\na = xspan(1);  b = xspan(2);\nx = a + (b-a)*(x+1)/2;\nDx = 2*Dx/(b-a);\n\n% Second derivative\nDxx = Dx^2;","lang":"matlab","showLineNumbers":true,"filename":"diffcheb.m","key":"o88INwC450"}],"key":"bKnXG2Lp2L"}],"key":"a1yCpu4OYV"}],"key":"KNDCM9Lt0g"}],"key":"sa43Y6cUbX"},{"type":"tabItem","title":"Python","sync":"python","children":[{"type":"embed","source":{"url":"/chapter10-2","label":"function-diffcheb-python","kind":"Notebook","slug":"chapter10-2","location":"/python/chapter10.md","title":"Chapter 10"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Chebyshev differentiation matrices","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"key":"xgBjPlyg8F"}],"key":"cqCANAsr5D"},{"type":"include","file":"fncbook/fncbook/chapter10.py","literal":true,"filter":{"startAt":"def diffcheb","endAt":"return x, Dx, Dxx"},"children":[{"type":"code","value":"def diffcheb(n, xspan):\n    \"\"\"\n    diffcheb(n, xspan)\n\n    Compute Chebyshev differentiation matrices on n+1 points in the\n    interval xspan. Return a vector of nodes, and the matrices for the first\n    and second derivatives.\n    \"\"\"\n    x = -np.cos(np.arange(n + 1) * np.pi / n)  # nodes in [-1,1]\n    Dx = np.zeros([n + 1, n + 1])\n    c = np.hstack([2.0, np.ones(n - 1), 2.0])  # endpoint factors\n\n    # Off-diagonal entries\n    Dx = np.zeros([n + 1, n + 1])\n    for i in range(n + 1):\n        for j in range(n + 1):\n            if i != j:\n                Dx[i, j] = (-1) ** (i + j) * c[i] / (c[j] * (x[i] - x[j]))\n\n    # Diagonal entries by the \"negative sum trick\"\n    for i in range(n + 1):\n        Dx[i, i] = -np.sum([Dx[i, j] for j in range(n + 1) if j != i])\n\n    # Transplant to [a,b]\n    a, b = xspan\n    x = a + (b - a) * (x + 1) / 2\n    Dx = 2 * Dx / (b - a)\n\n    # Second derivative\n    Dxx = Dx @ Dx\n\n    return x, Dx, Dxx","lang":"python","showLineNumbers":true,"filename":"diffcheb.py","key":"O3GXj8MSqh"}],"key":"gi7PQbL0zs"}],"key":"vLfWB9abBw"}],"key":"LTWbhfth4Q"}],"key":"zYvq59Ck77"}],"key":"q7yQD6bUXh"}],"label":"function-diffcheb","identifier":"function-diffcheb","html_id":"function-diffcheb","enumerator":"10.3.2","key":"ERd4VHFcew"},{"type":"proof","kind":"example","enumerated":true,"children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Chebyshev differentiation matrices","position":{"start":{"line":228,"column":1},"end":{"line":228,"column":1}},"key":"Hg9yNPZu3W"}],"key":"pCIvOHbb2x"},{"type":"tabSet","children":[{"type":"tabItem","title":"Julia","children":[{"type":"tabSet","children":[{"type":"tabItem","title":"Julia","sync":"julia","children":[{"type":"embed","source":{"url":"/chapter10","label":"demo-diffmats-cheb-julia","kind":"Notebook","slug":"chapter10","location":"/julia/chapter10.md","title":"Chapter 10"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-diffmats-cheb","label":"demo-diffmats-cheb","kind":"proof:example","position":{"start":{"line":351,"column":1},"end":{"line":351,"column":20}},"children":[{"type":"text","value":"Example ","key":"SHxgG9QNh7"},{"type":"text","value":"10.3.2","key":"JgH6Cnc2n1"}],"template":"Example %s","enumerator":"10.3.2","resolved":true,"html_id":"demo-diffmats-cheb","remote":true,"url":"/diffmats","dataUrl":"/diffmats.json","key":"R1pQSjiDJb"}],"key":"vCwNdq6zm1"},{"type":"paragraph","position":{"start":{"line":353,"column":1},"end":{"line":353,"column":1}},"children":[{"type":"text","value":"Here is a ","position":{"start":{"line":353,"column":1},"end":{"line":353,"column":1}},"key":"xNsznBipk2"},{"type":"inlineMath","value":"4\\times 4","position":{"start":{"line":353,"column":1},"end":{"line":353,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>4</mn><mo>×</mo><mn>4</mn></mrow><annotation encoding=\"application/x-tex\">4\\times 4</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">4</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">4</span></span></span></span>","key":"GhMO8gazHo"},{"type":"text","value":" Chebyshev differentiation matrix.","position":{"start":{"line":353,"column":1},"end":{"line":353,"column":1}},"key":"lt6bfoinRc"}],"key":"j9QNGOC3He"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"t, Dₓ = FNC.diffcheb(3, [-1, 1])\nDₓ","key":"BjffLQgpMh"},{"type":"output","id":"xl4lGAaATzQUWG-ba6pUU","data":[{"output_type":"execute_result","execution_count":22,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n -3.16667    4.0       -1.33333    0.5\n -1.0        0.333333   1.0       -0.333333\n  0.333333  -1.0       -0.333333   1.0\n -0.5        1.33333   -4.0        3.16667","content_type":"text/plain"}}}],"key":"lpyrhKrfBv"}],"data":{},"key":"aimeQM8fA5"},{"type":"paragraph","position":{"start":{"line":360,"column":1},"end":{"line":360,"column":1}},"children":[{"type":"text","value":"We again test the convergence rate.","position":{"start":{"line":360,"column":1},"end":{"line":360,"column":1}},"key":"GomQSkVYy8"}],"key":"q6uWkNgsYQ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"f = x -> x + exp(sin(4 * x));\ndf_dx = x -> 1 + 4 * exp(sin(4 * x)) * cos(4 * x);\nd2f_dx2 = x -> 4 * exp(sin(4 * x)) * (4 * cos(4 * x)^2 - 4 * sin(4 * x));","key":"SzvCxYyvgA"},{"type":"output","id":"dOeBakcvh9nfXPWNLsssG","data":[],"key":"uciuFJAqer"}],"data":{},"key":"IORB5RkE3P"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"n = 5:5:70\nerr1 = zeros(size(n))\nerr2 = zeros(size(n))\nfor (k, n) in enumerate(n)\n    t, Dₓ, Dₓₓ = FNC.diffcheb(n, [-1, 1])\n    y = f.(t)\n    err1[k] = norm(df_dx.(t) - Dₓ * y, Inf)\n    err2[k] = norm(d2f_dx2.(t) - Dₓₓ * y, Inf)\nend","key":"T5FgRd4m4P"},{"type":"output","id":"LLwy1-WeumT8CyFDyEH4L","data":[],"key":"ICnPpXM2mJ"}],"data":{},"key":"EQLdNizUoW"},{"type":"paragraph","position":{"start":{"line":380,"column":1},"end":{"line":380,"column":1}},"children":[{"type":"text","value":"Since we expect a spectral convergence rate, we use a semi-log plot for the error.","position":{"start":{"line":380,"column":1},"end":{"line":380,"column":1}},"key":"fW94ZhBO2i"}],"key":"CcjluPhiDK"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"plot(n, [err1 err2]; m = :o,\n    label=[L\"f'\" L\"f''\"],\n    xaxis=(L\"n\"),  yaxis = (:log10, \"max error\"),\n    title=\"Convergence of Chebyshev derivatives\")","key":"hyJufXkSWi"},{"type":"output","id":"1ozDSVFNatPwFplY1ZjBF","data":[{"output_type":"execute_result","execution_count":25,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"67ce162df385ee6174464b28b27f9bee","path":"/build/67ce162df385ee6174464b28b27f9bee.png"},"text/html":{"content_type":"text/html","hash":"1e0e4d3a0a7d5c7bde2a002d14f566ae","path":"/build/1e0e4d3a0a7d5c7bde2a002d14f566ae.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"196a93732ab82864dfe6c2b133c02880","path":"/build/196a93732ab82864dfe6c2b133c02880.svg"}}}],"key":"bS4QI9mcbk"}],"data":{},"key":"V4nOurC3es"}],"key":"ZrpicFSQcu"}],"key":"WTVJoQkfRC"}],"key":"AyHm5EXZ7E"}],"key":"QxdopuHyom"}],"key":"gN1sgmYLJ1"},{"type":"tabItem","title":"MATLAB","sync":"matlab","children":[{"type":"embed","source":{"url":"/chapter10-1","label":"demo-diffmats-cheb-matlab","kind":"Notebook","slug":"chapter10-1","location":"/matlab/chapter10.md","title":"Chapter 10"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-diffmats-cheb","label":"demo-diffmats-cheb","kind":"proof:example","position":{"start":{"line":284,"column":1},"end":{"line":284,"column":20}},"children":[{"type":"text","value":"Example ","key":"a6KWSxb9Bi"},{"type":"text","value":"10.3.2","key":"MTcVT8f9B1"}],"template":"Example %s","enumerator":"10.3.2","resolved":true,"html_id":"demo-diffmats-cheb","remote":true,"url":"/diffmats","dataUrl":"/diffmats.json","key":"h86MJ0fOHh"}],"key":"HeOAKuerDk"},{"type":"paragraph","position":{"start":{"line":286,"column":1},"end":{"line":286,"column":1}},"children":[{"type":"text","value":"Here is a ","position":{"start":{"line":286,"column":1},"end":{"line":286,"column":1}},"key":"F6ga77sR62"},{"type":"inlineMath","value":"4\\times 4","position":{"start":{"line":286,"column":1},"end":{"line":286,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>4</mn><mo>×</mo><mn>4</mn></mrow><annotation encoding=\"application/x-tex\">4\\times 4</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">4</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">4</span></span></span></span>","key":"xKSRYnvuUe"},{"type":"text","value":" Chebyshev differentiation matrix.","position":{"start":{"line":286,"column":1},"end":{"line":286,"column":1}},"key":"XwUgy5d4Ns"}],"key":"kdcNSOBPRd"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[t, Dx] = diffcheb(3, [-1, 1]);\nformat rat\nDx","key":"A7jykgOo6c"},{"type":"output","id":"AQem9XAtCkv__YWVebZcH","data":[{"output_type":"execute_result","execution_count":21,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>Dx = \n     -19/6            4             -4/3            1/2     \n      -1              1/3            1             -1/3     \n       1/3           -1             -1/3            1       \n      -1/2            4/3           -4             19/6     \n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"Dx = \n     -19/6            4             -4/3            1/2     \n      -1              1/3            1             -1/3     \n       1/3           -1             -1/3            1       \n      -1/2            4/3           -4             19/6     \n","content_type":"text/plain"}}}],"key":"kfQXxlfnjD"}],"data":{},"key":"pmQDkQkgAH"},{"type":"paragraph","position":{"start":{"line":294,"column":1},"end":{"line":294,"column":1}},"children":[{"type":"text","value":"We again test the convergence rate.","position":{"start":{"line":294,"column":1},"end":{"line":294,"column":1}},"key":"xWh6wHrK6L"}],"key":"HHR7vBoTt4"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"f = @(x) x + exp(sin(4*x));\ndf_dx = @(x) 1 + 4 * exp(sin(4*x)) .* cos(4*x);\nd2f_dx2 = @(x) 4 * exp(sin(4*x)) .* (4*cos(4*x).^2 - 4*sin(4*x));","key":"RIpQ5mINHA"},{"type":"output","id":"XQDMLsekcn-ulsrP55SlN","data":[],"key":"EQ4O4OHq2f"}],"data":{},"key":"yzE2q7pTMb"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"n = 5:5:70;\nerr = zeros(length(n), 2);\nfor k = 1:length(n)\n    [t, Dx, Dxx] = diffcheb(n(k), [-1, 1]);\n    y = f(t);\n    err(k, 1) = norm(df_dx(t) - Dx * y, Inf);\n    err(k, 2) = norm(d2f_dx2(t) - Dxx * y, Inf);\nend","key":"qqUkF4JFYh"},{"type":"output","id":"v08yXp01K7ZXG9XRIStDW","data":[],"key":"FoqwYyysRH"}],"data":{},"key":"nkkHMSLrRa"},{"type":"paragraph","position":{"start":{"line":314,"column":1},"end":{"line":314,"column":1}},"children":[{"type":"text","value":"Since we expect a spectral convergence rate, we use a semi-log plot for the error.","position":{"start":{"line":314,"column":1},"end":{"line":314,"column":1}},"key":"EOAMLbaGH0"}],"key":"Tkm6pE2cnV"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf,  format\nsemilogy(n, err, 'o-'), hold on\nlegend(\"f'\", \"f''\")\nxlabel('n'),  ylabel('max error')\ntitle('Convergence of finite differences')","key":"DmNDynR3Lg"},{"type":"output","id":"2O0LtdhQhZRpFrgBlM7hW","data":[{"output_type":"execute_result","execution_count":24,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"fa8390d51812f9dbd1eb69fa62472f9e","path":"/build/fa8390d51812f9dbd1eb69fa62472f9e.png"}}}],"key":"OYOfHceAXn"}],"data":{},"key":"iTJiEiXwvq"}],"key":"pNHKBfWcHY"}],"key":"PTWsQckfGK"}],"key":"bOmROptREf"},{"type":"tabItem","title":"Python","sync":"python","children":[{"type":"embed","source":{"url":"/chapter10-2","label":"demo-diffmats-cheb-python","kind":"Notebook","slug":"chapter10-2","location":"/python/chapter10.md","title":"Chapter 10"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-diffmats-cheb","label":"demo-diffmats-cheb","kind":"proof:example","position":{"start":{"line":319,"column":1},"end":{"line":319,"column":20}},"children":[{"type":"text","value":"Example ","key":"WL2O0JzkxL"},{"type":"text","value":"10.3.2","key":"XVjKa2BFkF"}],"template":"Example %s","enumerator":"10.3.2","resolved":true,"html_id":"demo-diffmats-cheb","remote":true,"url":"/diffmats","dataUrl":"/diffmats.json","key":"wXI8NP2FbL"}],"key":"rsLy17ex8G"},{"type":"paragraph","position":{"start":{"line":321,"column":1},"end":{"line":321,"column":1}},"children":[{"type":"text","value":"Here is a ","position":{"start":{"line":321,"column":1},"end":{"line":321,"column":1}},"key":"zzaK1sTbWq"},{"type":"inlineMath","value":"4\\times 4","position":{"start":{"line":321,"column":1},"end":{"line":321,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>4</mn><mo>×</mo><mn>4</mn></mrow><annotation encoding=\"application/x-tex\">4\\times 4</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">4</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">4</span></span></span></span>","key":"RJnZh7GO3C"},{"type":"text","value":" Chebyshev differentiation matrix.","position":{"start":{"line":321,"column":1},"end":{"line":321,"column":1}},"key":"F7LG2tzD17"}],"key":"aO2FCBPTPV"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"t, Dx, Dxx = FNC.diffcheb(3, [-1, 1])\nprint(Dx)","key":"zGP3w42BBB"},{"type":"output","id":"zsDd88x1dcIYh91J5SBST","data":[{"output_type":"stream","name":"stdout","text":"[[-3.16666667  4.         -1.33333333  0.5       ]\n [-1.          0.33333333  1.         -0.33333333]\n [ 0.33333333 -1.         -0.33333333  1.        ]\n [-0.5         1.33333333 -4.          3.16666667]]\n"}],"key":"tPnmpLpGyY"}],"data":{},"key":"ZEjIgPLehb"},{"type":"paragraph","position":{"start":{"line":328,"column":1},"end":{"line":328,"column":1}},"children":[{"type":"text","value":"We again test the convergence rate.","position":{"start":{"line":328,"column":1},"end":{"line":328,"column":1}},"key":"d5KBKlIfKQ"}],"key":"ZKmanW7AEN"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"f = lambda x: x + exp(sin(4 * x))\ndf_dx = lambda x: 1 + 4 * exp(sin(4 * x)) * cos(4 * x)\nd2f_dx2 = lambda x: 4 * exp(sin(4 * x)) * (4 * cos(4 * x) ** 2 - 4 * sin(4 * x))\n\nN = range(5, 75, 5)\nerr1 = zeros(len(N))\nerr2 = zeros(len(N))\nerr = zeros((len(N), 2))\nfor k, n in enumerate(N):\n    t, Dx, Dxx = FNC.diffcheb(n, [-1, 1])\n    y = f(t)\n    err[k, 0] = norm(df_dx(t) - Dx @ y, inf)\n    err[k, 1] = norm(d2f_dx2(t) - Dxx @ y, inf)","key":"ffR6pCPI8V"},{"type":"output","id":"VVe7XJYX5ABxp-GK-xi1n","data":[],"key":"jFu1JTdPg9"}],"data":{},"key":"lWLr6zhIDR"},{"type":"paragraph","position":{"start":{"line":346,"column":1},"end":{"line":346,"column":1}},"children":[{"type":"text","value":"Since we expect a spectral convergence rate, we use a semi-log plot for the error.","position":{"start":{"line":346,"column":1},"end":{"line":346,"column":1}},"key":"nF0IpHbMPG"}],"key":"rrBJxzhmmR"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"semilogy(N, err, \"-o\")\nxlabel(\"$n$\"), ylabel(\"max error\")\nlegend([\"$f'$\", \"$f''$\"], loc=\"lower left\")\ntitle(\"Convergence of Chebyshev derivatives\");","key":"MGQtTLEwew"},{"type":"output","id":"wv6WD4cS1W6GEFVB-Ab6Y","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"02214a610319e078419fcf62e18f043d","path":"/build/02214a610319e078419fcf62e18f043d.png"}}}],"key":"ey7P5Vuo5D"}],"data":{},"key":"ujSxO0l1Xv"}],"key":"f7cOxkEyNG"}],"key":"k2fc8MrwGb"}],"key":"fqakcHpDda"}],"key":"EAmuue0taq"}],"label":"demo-diffmats-cheb","identifier":"demo-diffmats-cheb","html_id":"demo-diffmats-cheb","enumerator":"10.3.2","key":"yiKAtdTDjg"},{"type":"paragraph","position":{"start":{"line":252,"column":1},"end":{"line":252,"column":1}},"children":[{"type":"text","value":"According to ","position":{"start":{"line":252,"column":1},"end":{"line":252,"column":1}},"key":"gR9zXNGLaw"},{"type":"crossReference","kind":"proof:theorem","identifier":"theorem-spectral","label":"theorem-spectral","children":[{"type":"text","value":"Theorem ","key":"XPjNwxHB2O"},{"type":"text","value":"9.3.1","key":"p9j1uGVLqz"}],"template":"Theorem %s","enumerator":"9.3.1","resolved":true,"html_id":"theorem-spectral","remote":true,"url":"/stability-1","dataUrl":"/stability-1.json","key":"XNgnBBVt4N"},{"type":"text","value":", the convergence of polynomial interpolation to ","position":{"start":{"line":252,"column":1},"end":{"line":252,"column":1}},"key":"tacsVCBjkb"},{"type":"inlineMath","value":"f","position":{"start":{"line":252,"column":1},"end":{"line":252,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>","key":"crJRuzSKvq"},{"type":"text","value":" using Chebyshev nodes is spectral if ","position":{"start":{"line":252,"column":1},"end":{"line":252,"column":1}},"key":"NkqEDXAMHC"},{"type":"inlineMath","value":"f","position":{"start":{"line":252,"column":1},"end":{"line":252,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>","key":"xSR5yEztta"},{"type":"text","value":" is analytic (at least having infinitely many derivatives) on the interval. The derivatives of ","position":{"start":{"line":252,"column":1},"end":{"line":252,"column":1}},"key":"GggDEzBU1T"},{"type":"inlineMath","value":"f","position":{"start":{"line":252,"column":1},"end":{"line":252,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>","key":"EHGEoUnZhG"},{"type":"text","value":" are also approximated with spectral accuracy.","position":{"start":{"line":252,"column":1},"end":{"line":252,"column":1}},"key":"V6BsDPaLJS"}],"key":"BPb77fHwrU"},{"type":"heading","depth":2,"position":{"start":{"line":254,"column":1},"end":{"line":254,"column":1}},"children":[{"type":"text","value":"Exercises","position":{"start":{"line":254,"column":1},"end":{"line":254,"column":1}},"key":"yFzdhuM32b"}],"identifier":"exercises","label":"Exercises","html_id":"exercises","implicit":true,"enumerator":"10.3.4","key":"lXnbaSXnO7"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":256,"column":1},"end":{"line":275,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":256,"column":1},"end":{"line":260,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":257,"column":1},"end":{"line":257,"column":1}},"children":[{"type":"strong","position":{"start":{"line":257,"column":1},"end":{"line":257,"column":1}},"children":[{"type":"text","value":"(a)","position":{"start":{"line":257,"column":1},"end":{"line":257,"column":1}},"key":"DaO4lEm2Hl"}],"key":"j8MkNXpDbO"},{"type":"text","value":" ✍ Calculate ","position":{"start":{"line":257,"column":1},"end":{"line":257,"column":1}},"key":"WhQLQ0ENRZ"},{"type":"inlineMath","value":"\\mathbf{D}_x^2","position":{"start":{"line":257,"column":1},"end":{"line":257,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msubsup><mi mathvariant=\"bold\">D</mi><mi>x</mi><mn>2</mn></msubsup></mrow><annotation encoding=\"application/x-tex\">\\mathbf{D}_x^2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0611em;vertical-align:-0.247em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">D</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-2.453em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span></span></span></span>","key":"rClVX1hrpC"},{"type":"text","value":" using ","position":{"start":{"line":257,"column":1},"end":{"line":257,"column":1}},"key":"forBs9JEQY"},{"type":"crossReference","kind":"equation","identifier":"diffmat11","label":"diffmat11","children":[{"type":"text","value":"(","key":"sAjsVNl9IQ"},{"type":"text","value":"10.3.5","key":"FI9ooOWLpZ"},{"type":"text","value":")","key":"qTBWRqffJH"}],"template":"(%s)","enumerator":"10.3.5","resolved":true,"html_id":"diffmat11","key":"wJHwjvHotF"},{"type":"text","value":" to define ","position":{"start":{"line":257,"column":1},"end":{"line":257,"column":1}},"key":"NePLdvjHjk"},{"type":"inlineMath","value":"\\mathbf{D}_x","position":{"start":{"line":257,"column":1},"end":{"line":257,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">D</mi><mi>x</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbf{D}_x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8361em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">D</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"ZPHmQopBo3"},{"type":"text","value":".","position":{"start":{"line":257,"column":1},"end":{"line":257,"column":1}},"key":"vERozPnt5c"}],"key":"A8GEQ9mA3k"},{"type":"paragraph","position":{"start":{"line":259,"column":1},"end":{"line":259,"column":1}},"children":[{"type":"strong","position":{"start":{"line":259,"column":1},"end":{"line":259,"column":1}},"children":[{"type":"text","value":"(b)","position":{"start":{"line":259,"column":1},"end":{"line":259,"column":1}},"key":"TzD5taINrx"}],"key":"cvAmBJ5iWA"},{"type":"text","value":" ⌨ Repeat the experiment of ","position":{"start":{"line":259,"column":1},"end":{"line":259,"column":1}},"key":"RK04a5Wof9"},{"type":"crossReference","kind":"proof:example","identifier":"demo-diffmats-2nd","label":"demo-diffmats-2nd","children":[{"type":"text","value":"Demo ","key":"CzIamXPvwv"},{"type":"text","value":"10.3.1","key":"p9WUoWDLza"}],"template":"Example %s","enumerator":"10.3.1","resolved":true,"html_id":"demo-diffmats-2nd","key":"FJEqvJDe3e"},{"type":"text","value":", but using this version of ","position":{"start":{"line":259,"column":1},"end":{"line":259,"column":1}},"key":"bddXfOIy0b"},{"type":"inlineMath","value":"\\mathbf{D}_x^2","position":{"start":{"line":259,"column":1},"end":{"line":259,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msubsup><mi mathvariant=\"bold\">D</mi><mi>x</mi><mn>2</mn></msubsup></mrow><annotation encoding=\"application/x-tex\">\\mathbf{D}_x^2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0611em;vertical-align:-0.247em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">D</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-2.453em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span></span></span></span>","key":"GiSb0E51Sh"},{"type":"text","value":" to estimate ","position":{"start":{"line":259,"column":1},"end":{"line":259,"column":1}},"key":"h0uLua2k56"},{"type":"inlineMath","value":"f''","position":{"start":{"line":259,"column":1},"end":{"line":259,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>f</mi><mrow><mo mathvariant=\"normal\">′</mo><mo mathvariant=\"normal\">′</mo></mrow></msup></mrow><annotation encoding=\"application/x-tex\">f&#x27;&#x27;</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9463em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′′</span></span></span></span></span></span></span></span></span></span></span></span>","key":"Uh6CottR7V"},{"type":"text","value":". What is the apparent order of accuracy in ","position":{"start":{"line":259,"column":1},"end":{"line":259,"column":1}},"key":"gyV6SlNwhJ"},{"type":"inlineMath","value":"f''","position":{"start":{"line":259,"column":1},"end":{"line":259,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>f</mi><mrow><mo mathvariant=\"normal\">′</mo><mo mathvariant=\"normal\">′</mo></mrow></msup></mrow><annotation encoding=\"application/x-tex\">f&#x27;&#x27;</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9463em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′′</span></span></span></span></span></span></span></span></span></span></span></span>","key":"ygXf5m1Bj0"},{"type":"text","value":"?","position":{"start":{"line":259,"column":1},"end":{"line":259,"column":1}},"key":"beFxGJ0R6H"}],"key":"tgzdZIiUbT"}],"key":"lsMSa0poXP"},{"type":"listItem","spread":true,"position":{"start":{"line":261,"column":1},"end":{"line":267,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":262,"column":1},"end":{"line":262,"column":1}},"children":[{"type":"strong","position":{"start":{"line":262,"column":1},"end":{"line":262,"column":1}},"children":[{"type":"text","value":"(a)","position":{"start":{"line":262,"column":1},"end":{"line":262,"column":1}},"key":"eBq0Kr31QI"}],"key":"ixXoHOetSD"},{"type":"text","value":" ✍ Find the derivative of ","position":{"start":{"line":262,"column":1},"end":{"line":262,"column":1}},"key":"WAvh3tMh4Z"},{"type":"inlineMath","value":"f(x) =\\operatorname{sign}(x)x^2","position":{"start":{"line":262,"column":1},"end":{"line":262,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi mathvariant=\"normal\">sign</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><msup><mi>x</mi><mn>2</mn></msup></mrow><annotation encoding=\"application/x-tex\">f(x) =\\operatorname{sign}(x)x^2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mop\"><span class=\"mord mathrm\">sign</span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span>","key":"nlSUSwry5K"},{"type":"text","value":" on the interval ","position":{"start":{"line":262,"column":1},"end":{"line":262,"column":1}},"key":"JMuukZrmke"},{"type":"inlineMath","value":"[-1,1]","position":{"start":{"line":262,"column":1},"end":{"line":262,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mo>−</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[-1,1]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">−</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]</span></span></span></span>","key":"xARS5et1QV"},{"type":"text","value":". (If this gives you trouble, use an equivalent piecewise definition of ","position":{"start":{"line":262,"column":1},"end":{"line":262,"column":1}},"key":"LbAt9vxAl7"},{"type":"inlineMath","value":"f","position":{"start":{"line":262,"column":1},"end":{"line":262,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>","key":"NKd8OU9Fcb"},{"type":"text","value":".) What is special about this function at ","position":{"start":{"line":262,"column":1},"end":{"line":262,"column":1}},"key":"U8PQWK66DX"},{"type":"inlineMath","value":"x=0","position":{"start":{"line":262,"column":1},"end":{"line":262,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">x=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"bQ2c66PAFH"},{"type":"text","value":"?","position":{"start":{"line":262,"column":1},"end":{"line":262,"column":1}},"key":"yswD6zesx5"}],"key":"PCsqlrfNnr"},{"type":"paragraph","position":{"start":{"line":264,"column":1},"end":{"line":264,"column":1}},"children":[{"type":"strong","position":{"start":{"line":264,"column":1},"end":{"line":264,"column":1}},"children":[{"type":"text","value":"(b)","position":{"start":{"line":264,"column":1},"end":{"line":264,"column":1}},"key":"ga3eQq3KNn"}],"key":"P5GwYjwFOR"},{"type":"text","value":" ⌨ Adapt ","position":{"start":{"line":264,"column":1},"end":{"line":264,"column":1}},"key":"PAxKcWpWl2"},{"type":"crossReference","kind":"proof:example","identifier":"demo-diffmats-2nd","label":"demo-diffmats-2nd","children":[{"type":"text","value":"Demo ","key":"ewK0LISiZ1"},{"type":"text","value":"10.3.1","key":"SiN8ksgk67"}],"template":"Example %s","enumerator":"10.3.1","resolved":true,"html_id":"demo-diffmats-2nd","key":"f3QP4cqmWP"},{"type":"text","value":" to operate on the function from part (a), computing only the first derivative. What is the observed order of accuracy?","position":{"start":{"line":264,"column":1},"end":{"line":264,"column":1}},"key":"JckBN3VDCJ"}],"key":"Qa81CAk4dB"},{"type":"paragraph","position":{"start":{"line":266,"column":1},"end":{"line":266,"column":1}},"children":[{"type":"strong","position":{"start":{"line":266,"column":1},"end":{"line":266,"column":1}},"children":[{"type":"text","value":"(c)","position":{"start":{"line":266,"column":1},"end":{"line":266,"column":1}},"key":"mb4RwuspqX"}],"key":"IaV6XBEnvX"},{"type":"text","value":" ✍ Show that for even values of ","position":{"start":{"line":266,"column":1},"end":{"line":266,"column":1}},"key":"EblPPTGEBw"},{"type":"inlineMath","value":"n","position":{"start":{"line":266,"column":1},"end":{"line":266,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"VHegCt45Pm"},{"type":"text","value":", there is only one node at which the error for computing ","position":{"start":{"line":266,"column":1},"end":{"line":266,"column":1}},"key":"ai4wyQYE6x"},{"type":"inlineMath","value":"f'","position":{"start":{"line":266,"column":1},"end":{"line":266,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>f</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup></mrow><annotation encoding=\"application/x-tex\">f&#x27;</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9463em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span></span></span></span>","key":"MlVNE0qE6C"},{"type":"text","value":" in part (b) is nonzero.","position":{"start":{"line":266,"column":1},"end":{"line":266,"column":1}},"key":"tVSRbKshXh"}],"key":"a8ckCzIDwy"}],"key":"beAdw1kOcd"},{"type":"listItem","spread":true,"position":{"start":{"line":268,"column":1},"end":{"line":273,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":268,"column":1},"end":{"line":268,"column":1}},"children":[{"type":"text","value":"⌨ To get a fourth-order accurate version of ","position":{"start":{"line":268,"column":1},"end":{"line":268,"column":1}},"key":"BUWGtZ7Lqi"},{"type":"inlineMath","value":"\\mathbf{D}_x","position":{"start":{"line":268,"column":1},"end":{"line":268,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">D</mi><mi>x</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbf{D}_x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8361em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">D</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"FZCyQtOZ28"},{"type":"text","value":", five points per row are needed, including two special rows at each boundary. For a fourth-order ","position":{"start":{"line":268,"column":1},"end":{"line":268,"column":1}},"key":"FqLTvZJSSm"},{"type":"inlineMath","value":"\\mathbf{D}_{xx}","position":{"start":{"line":268,"column":1},"end":{"line":268,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">D</mi><mrow><mi>x</mi><mi>x</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbf{D}_{xx}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8361em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">D</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">xx</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"fVjm0RdVhH"},{"type":"text","value":", five symmetric points per row are needed for interior rows and six points are needed for the rows near a boundary.","position":{"start":{"line":268,"column":1},"end":{"line":268,"column":1}},"key":"xm4AK8Nvmd"}],"key":"ZvZWkLb5aE"},{"type":"paragraph","position":{"start":{"line":270,"column":1},"end":{"line":270,"column":1}},"children":[{"type":"strong","position":{"start":{"line":270,"column":1},"end":{"line":270,"column":1}},"children":[{"type":"text","value":"(a)","position":{"start":{"line":270,"column":1},"end":{"line":270,"column":1}},"key":"oK7kVqgALo"}],"key":"z6MvDGkw7a"},{"type":"text","value":" Modify ","position":{"start":{"line":270,"column":1},"end":{"line":270,"column":1}},"key":"Y4CqNuN3KG"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-diffmat2","label":"function-diffmat2","children":[{"type":"text","value":"Function ","key":"LjF7LFS37j"},{"type":"text","value":"10.3.1","key":"XWfsdDqYRP"}],"template":"Algorithm %s","enumerator":"10.3.1","resolved":true,"html_id":"function-diffmat2","key":"HImCc66170"},{"type":"text","value":" to a function ","position":{"start":{"line":270,"column":1},"end":{"line":270,"column":1}},"key":"L2nG6h0qtG"},{"type":"inlineCode","value":"diffmat4","position":{"start":{"line":270,"column":1},"end":{"line":270,"column":1}},"key":"LRGsC9LAVy"},{"type":"text","value":", which outputs fourth-order accurate differentiation matrices. You may want to use ","position":{"start":{"line":270,"column":1},"end":{"line":270,"column":1}},"key":"u3APZ8rvgE"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-fdweights","label":"function-fdweights","children":[{"type":"text","value":"Function ","key":"peaiCFKicR"},{"type":"text","value":"5.4.1","key":"LG8m6gUQTv"}],"template":"Algorithm %s","enumerator":"5.4.1","resolved":true,"html_id":"function-fdweights","remote":true,"url":"/finitediffs","dataUrl":"/finitediffs.json","key":"fC6H8bUNuB"},{"type":"text","value":".","position":{"start":{"line":270,"column":1},"end":{"line":270,"column":1}},"key":"l1qinBA5yL"}],"key":"xp8tYOcDvj"},{"type":"paragraph","position":{"start":{"line":272,"column":1},"end":{"line":272,"column":1}},"children":[{"type":"strong","position":{"start":{"line":272,"column":1},"end":{"line":272,"column":1}},"children":[{"type":"text","value":"(b)","position":{"start":{"line":272,"column":1},"end":{"line":272,"column":1}},"key":"SFqgPqZfdO"}],"key":"eG4dAyZOJx"},{"type":"text","value":" Repeat the experiment of ","position":{"start":{"line":272,"column":1},"end":{"line":272,"column":1}},"key":"tzcuZYBGGs"},{"type":"crossReference","kind":"proof:example","identifier":"demo-diffmats-2nd","label":"demo-diffmats-2nd","children":[{"type":"text","value":"Demo ","key":"rm8Zms0xmt"},{"type":"text","value":"10.3.1","key":"FML24rMsQf"}],"template":"Example %s","enumerator":"10.3.1","resolved":true,"html_id":"demo-diffmats-2nd","key":"oStgSoqdag"},{"type":"text","value":" using ","position":{"start":{"line":272,"column":1},"end":{"line":272,"column":1}},"key":"WRuaqN0GAx"},{"type":"inlineCode","value":"diffmat4","position":{"start":{"line":272,"column":1},"end":{"line":272,"column":1}},"key":"FgdLMmJZbo"},{"type":"text","value":" in place of ","position":{"start":{"line":272,"column":1},"end":{"line":272,"column":1}},"key":"jsvEhGwHg9"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-diffmat2","label":"function-diffmat2","children":[{"type":"text","value":"Function ","key":"X35mGhq9D6"},{"type":"text","value":"10.3.1","key":"XiSMz8CrKo"}],"template":"Algorithm %s","enumerator":"10.3.1","resolved":true,"html_id":"function-diffmat2","key":"tAqSScQMLP"},{"type":"text","value":", and compare observed errors to fourth-order accuracy.","position":{"start":{"line":272,"column":1},"end":{"line":272,"column":1}},"key":"kYjNvGTyem"}],"key":"Gjj5Vpss3g"}],"key":"l9SysHvHTQ"},{"type":"listItem","spread":true,"position":{"start":{"line":274,"column":1},"end":{"line":275,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":274,"column":1},"end":{"line":274,"column":1}},"children":[{"type":"text","value":"✍ Explain in detail how lines 23-24 in ","position":{"start":{"line":274,"column":1},"end":{"line":274,"column":1}},"key":"Zqfu3UIIzd"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-diffcheb","label":"function-diffcheb","children":[{"type":"text","value":"Function ","key":"B9ZHBvExTs"},{"type":"text","value":"10.3.2","key":"wCQ77T3VEt"}],"template":"Algorithm %s","enumerator":"10.3.2","resolved":true,"html_id":"function-diffcheb","key":"lO1yfF0uzJ"},{"type":"text","value":" correctly change the interval from ","position":{"start":{"line":274,"column":1},"end":{"line":274,"column":1}},"key":"KoGJqyAxC8"},{"type":"inlineMath","value":"[-1,1]","position":{"start":{"line":274,"column":1},"end":{"line":274,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mo>−</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[-1,1]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">−</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]</span></span></span></span>","key":"hS4euJTvuZ"},{"type":"text","value":" to ","position":{"start":{"line":274,"column":1},"end":{"line":274,"column":1}},"key":"vWLd1vwxzh"},{"type":"inlineMath","value":"[a,b]","position":{"start":{"line":274,"column":1},"end":{"line":274,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mi>a</mi><mo separator=\"true\">,</mo><mi>b</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[a,b]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">a</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">b</span><span class=\"mclose\">]</span></span></span></span>","key":"auwFOTuqua"},{"type":"text","value":".","position":{"start":{"line":274,"column":1},"end":{"line":274,"column":1}},"key":"raVDur62Yf"}],"key":"mxTpT8poI5"}],"key":"OrEaMa3BT2"}],"key":"kXUxlQt1ND"},{"type":"list","ordered":true,"start":5,"spread":false,"position":{"start":{"line":277,"column":1},"end":{"line":290,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":277,"column":1},"end":{"line":283,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":278,"column":1},"end":{"line":278,"column":1}},"children":[{"type":"strong","position":{"start":{"line":278,"column":1},"end":{"line":278,"column":1}},"children":[{"type":"text","value":"(a)","position":{"start":{"line":278,"column":1},"end":{"line":278,"column":1}},"key":"ZCgE5SzrtO"}],"key":"WrwYi42WPM"},{"type":"text","value":" ✍ What is the derivative of a constant function?","position":{"start":{"line":278,"column":1},"end":{"line":278,"column":1}},"key":"fMIN9j85yG"}],"key":"vcURo79k08"},{"type":"paragraph","position":{"start":{"line":280,"column":1},"end":{"line":280,"column":1}},"children":[{"type":"strong","position":{"start":{"line":280,"column":1},"end":{"line":280,"column":1}},"children":[{"type":"text","value":"(b)","position":{"start":{"line":280,"column":1},"end":{"line":280,"column":1}},"key":"kFydho0WeX"}],"key":"LRTjWi1jpy"},{"type":"text","value":" ✍ Explain why for any reasonable differentiation matrix ","position":{"start":{"line":280,"column":1},"end":{"line":280,"column":1}},"key":"SqHfy18w4o"},{"type":"inlineMath","value":"\\mathbf{D}","position":{"start":{"line":280,"column":1},"end":{"line":280,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">D</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{D}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">D</span></span></span></span>","key":"GACTTPrr3o"},{"type":"text","value":", we should find ","position":{"start":{"line":280,"column":1},"end":{"line":280,"column":1}},"key":"xz41GdGFkk"},{"type":"inlineMath","value":"\\displaystyle \\sum_{j=0}^nD_{ij}=0","position":{"start":{"line":280,"column":1},"end":{"line":280,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle scriptlevel=\"0\" displaystyle=\"true\"><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>0</mn></mrow><mi>n</mi></munderover><msub><mi>D</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mn>0</mn></mstyle></mrow><annotation encoding=\"application/x-tex\">\\displaystyle \\sum_{j=0}^nD_{ij}=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:3.0652em;vertical-align:-1.4138em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.6514em;\"><span style=\"top:-1.8723em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">0</span></span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span><span style=\"top:-4.3em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.4138em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">ij</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"yFyZI45IyL"},{"type":"text","value":" for all ","position":{"start":{"line":280,"column":1},"end":{"line":280,"column":1}},"key":"dzSpDId2wJ"},{"type":"inlineMath","value":"i","position":{"start":{"line":280,"column":1},"end":{"line":280,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span>","key":"iqpXhmeY5b"},{"type":"text","value":".","position":{"start":{"line":280,"column":1},"end":{"line":280,"column":1}},"key":"Ox0ejDJ3wU"}],"key":"ZOj1f23eCe"},{"type":"paragraph","position":{"start":{"line":282,"column":1},"end":{"line":282,"column":1}},"children":[{"type":"strong","position":{"start":{"line":282,"column":1},"end":{"line":282,"column":1}},"children":[{"type":"text","value":"(c)","position":{"start":{"line":282,"column":1},"end":{"line":282,"column":1}},"key":"jh845eQHlB"}],"key":"Cx27zklAId"},{"type":"text","value":" ✍ What does this have to do with ","position":{"start":{"line":282,"column":1},"end":{"line":282,"column":1}},"key":"MOtnxZXQwM"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-diffcheb","label":"function-diffcheb","children":[{"type":"text","value":"Function ","key":"nFFjZrO7U7"},{"type":"text","value":"10.3.2","key":"b9cZgn8SSQ"}],"template":"Algorithm %s","enumerator":"10.3.2","resolved":true,"html_id":"function-diffcheb","key":"T55nCDwfg5"},{"type":"text","value":"? Refer to specific line(s) in the function for your answer.","position":{"start":{"line":282,"column":1},"end":{"line":282,"column":1}},"key":"ZzpYHooDp4"}],"key":"SzZOVOxVPN"}],"key":"TnGgsmhI5M"},{"type":"listItem","spread":true,"position":{"start":{"line":284,"column":1},"end":{"line":290,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":284,"column":1},"end":{"line":286,"column":1}},"children":[{"type":"text","value":"Define the ","position":{"start":{"line":284,"column":1},"end":{"line":284,"column":1}},"key":"X7JTTmLo3x"},{"type":"inlineMath","value":"(n+1)\\times (n+1)","position":{"start":{"line":284,"column":1},"end":{"line":284,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>n</mi><mo>+</mo><mn>1</mn><mo stretchy=\"false\">)</mo><mo>×</mo><mo stretchy=\"false\">(</mo><mi>n</mi><mo>+</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(n+1)\\times (n+1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span></span></span>","key":"XjPpwCq4Y5"},{"type":"text","value":" matrix ","position":{"start":{"line":284,"column":1},"end":{"line":284,"column":1}},"key":"I67h9FYEIP"},{"type":"inlineMath","value":"\\mathbf{T} = \\displaystyle \\begin{bmatrix}\n 1 & & & \\\\ 1 & 1 & & \\\\ \\vdots & & \\ddots & \\\\ 1 & 1 & \\cdots & 1\n \\end{bmatrix}","position":{"start":{"line":284,"column":1},"end":{"line":284,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">T</mi><mo>=</mo><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mo fence=\"true\">[</mo><mtable rowspacing=\"0.16em\" columnalign=\"center center center center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mi><mi mathvariant=\"normal\">⋮</mi><mpadded height=\"0em\" voffset=\"0em\"><mspace mathbackground=\"black\" width=\"0em\" height=\"1.5em\"></mspace></mpadded></mi></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mo lspace=\"0em\" rspace=\"0em\">⋱</mo></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mo lspace=\"0em\" rspace=\"0em\">⋯</mo></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd></mtr></mtable><mo fence=\"true\">]</mo></mrow></mstyle></mrow><annotation encoding=\"application/x-tex\">\\mathbf{T} = \\displaystyle \\begin{bmatrix}\n 1 &amp; &amp; &amp; \\\\ 1 &amp; 1 &amp; &amp; \\\\ \\vdots &amp; &amp; \\ddots &amp; \\\\ 1 &amp; 1 &amp; \\cdots &amp; 1\n \\end{bmatrix}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">T</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:5.46em;vertical-align:-2.48em;\"></span><span class=\"minner\"><span class=\"mopen\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.95em;\"><span style=\"top:-2.011em;\"><span class=\"pstrut\" style=\"height:3.816em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎣</span></span></span><span style=\"top:-3.158em;\"><span class=\"pstrut\" style=\"height:3.816em;\"></span><span style=\"height:1.816em;width:0.6667em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.6667em' height='1.816em' style='width:0.6667em' viewBox='0 0 666.67 1816' preserveAspectRatio='xMinYMin'><path d='M319 0 H403 V1816 H319z M319 0 H403 V1816 H319z'/></svg></span></span><span style=\"top:-5.6111em;\"><span class=\"pstrut\" style=\"height:3.816em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎡</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.45em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.98em;\"><span style=\"top:-5.8275em;\"><span class=\"pstrut\" style=\"height:3.6875em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span><span style=\"top:-4.6275em;\"><span class=\"pstrut\" style=\"height:3.6875em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span><span style=\"top:-2.7675em;\"><span class=\"pstrut\" style=\"height:3.6875em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord\">⋮</span><span class=\"mord rule\" style=\"border-right-width:0em;border-top-width:1.5em;bottom:0em;\"></span></span></span></span><span style=\"top:-1.5675em;\"><span class=\"pstrut\" style=\"height:3.6875em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.48em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.98em;\"><span style=\"top:-5.64em;\"><span class=\"pstrut\" style=\"height:3.5em;\"></span><span class=\"mord\"></span></span><span style=\"top:-4.44em;\"><span class=\"pstrut\" style=\"height:3.5em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span><span style=\"top:-2.58em;\"><span class=\"pstrut\" style=\"height:3.5em;\"></span><span class=\"mord\"></span></span><span style=\"top:-1.38em;\"><span class=\"pstrut\" style=\"height:3.5em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.48em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.98em;\"><span style=\"top:-5.64em;\"><span class=\"pstrut\" style=\"height:3.5em;\"></span><span class=\"mord\"></span></span><span style=\"top:-4.44em;\"><span class=\"pstrut\" style=\"height:3.5em;\"></span><span class=\"mord\"></span></span><span style=\"top:-2.58em;\"><span class=\"pstrut\" style=\"height:3.5em;\"></span><span class=\"mord\"><span class=\"minner\">⋱</span></span></span><span style=\"top:-1.38em;\"><span class=\"pstrut\" style=\"height:3.5em;\"></span><span class=\"mord\"><span class=\"minner\">⋯</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.48em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.98em;\"><span style=\"top:-5.64em;\"><span class=\"pstrut\" style=\"height:3.5em;\"></span><span class=\"mord\"></span></span><span style=\"top:-4.44em;\"><span class=\"pstrut\" style=\"height:3.5em;\"></span><span class=\"mord\"></span></span><span style=\"top:-2.58em;\"><span class=\"pstrut\" style=\"height:3.5em;\"></span><span class=\"mord\"></span></span><span style=\"top:-1.38em;\"><span class=\"pstrut\" style=\"height:3.5em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.48em;\"><span></span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.95em;\"><span style=\"top:-2.011em;\"><span class=\"pstrut\" style=\"height:3.816em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎦</span></span></span><span style=\"top:-3.158em;\"><span class=\"pstrut\" style=\"height:3.816em;\"></span><span style=\"height:1.816em;width:0.6667em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.6667em' height='1.816em' style='width:0.6667em' viewBox='0 0 666.67 1816' preserveAspectRatio='xMinYMin'><path d='M263 0 H347 V1816 H263z M263 0 H347 V1816 H263z'/></svg></span></span><span style=\"top:-5.6111em;\"><span class=\"pstrut\" style=\"height:3.816em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎤</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.45em;\"><span></span></span></span></span></span></span></span></span></span></span>","key":"bNHnTGSEIG"},{"type":"text","value":".","position":{"start":{"line":284,"column":1},"end":{"line":284,"column":1}},"key":"LCxDEoy6wx"}],"key":"z9hbdtXoS3"},{"type":"paragraph","position":{"start":{"line":288,"column":1},"end":{"line":288,"column":1}},"children":[{"type":"strong","position":{"start":{"line":288,"column":1},"end":{"line":288,"column":1}},"children":[{"type":"text","value":"(a)","position":{"start":{"line":288,"column":1},"end":{"line":288,"column":1}},"key":"fyY7uIYkqr"}],"key":"laYOjnFBGA"},{"type":"text","value":" ✍ Write out ","position":{"start":{"line":288,"column":1},"end":{"line":288,"column":1}},"key":"pODVLcJgMP"},{"type":"inlineMath","value":"\\mathbf{T}\\mathbf{u}","position":{"start":{"line":288,"column":1},"end":{"line":288,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">T</mi><mi mathvariant=\"bold\">u</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{T}\\mathbf{u}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">Tu</span></span></span></span>","key":"r9ZltePmiP"},{"type":"text","value":" for a generic vector ","position":{"start":{"line":288,"column":1},"end":{"line":288,"column":1}},"key":"RjfpCfpxaL"},{"type":"inlineMath","value":"\\mathbf{u}","position":{"start":{"line":288,"column":1},"end":{"line":288,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">u</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{u}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4444em;\"></span><span class=\"mord mathbf\">u</span></span></span></span>","key":"pBCc8wb29F"},{"type":"text","value":" (start with a zero index). How is this like integration?","position":{"start":{"line":288,"column":1},"end":{"line":288,"column":1}},"key":"eD5GBPLc8E"}],"key":"Y1CeWlltbt"},{"type":"paragraph","position":{"start":{"line":290,"column":1},"end":{"line":290,"column":1}},"children":[{"type":"strong","position":{"start":{"line":290,"column":1},"end":{"line":290,"column":1}},"children":[{"type":"text","value":"(b)","position":{"start":{"line":290,"column":1},"end":{"line":290,"column":1}},"key":"y0kuKmOb5q"}],"key":"M4Sd3IgLRI"},{"type":"text","value":" ✍ Find the inverse of ","position":{"start":{"line":290,"column":1},"end":{"line":290,"column":1}},"key":"ktYkS7yvHu"},{"type":"inlineMath","value":"\\mathbf{T}","position":{"start":{"line":290,"column":1},"end":{"line":290,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">T</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{T}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">T</span></span></span></span>","key":"ZmU6NCXS2V"},{"type":"text","value":" for any ","position":{"start":{"line":290,"column":1},"end":{"line":290,"column":1}},"key":"DXkWH8lwfJ"},{"type":"inlineMath","value":"n","position":{"start":{"line":290,"column":1},"end":{"line":290,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"QYLLAZ1fVT"},{"type":"text","value":".  (You can use Julia to find the pattern, but show that the result is correct in general.) What does this have to do with the inverse of integration?","position":{"start":{"line":290,"column":1},"end":{"line":290,"column":1}},"key":"LzHy43QwOT"}],"key":"qwhcvscUpw"}],"key":"ax6EHD70ky"}],"label":"problem-diffmats-negsumtrick","identifier":"problem-diffmats-negsumtrick","html_id":"problem-diffmats-negsumtrick","key":"b0XvmBW8D4"},{"type":"footnoteDefinition","identifier":"sparseconv","label":"sparseconv","position":{"start":{"line":290,"column":1},"end":{"line":290,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"children":[{"type":"text","value":"In order to exploit this structure efficiently in Julia, these matrices first need to be constructed as or converted to sparse or tridiagonal form.","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"key":"gHb9CdIjei"}],"key":"roeCzn0r8c"}],"number":1,"enumerator":"1","key":"xB53VCVWL0"}],"key":"Ws5bk4TL9v"}],"key":"taKJKbCAyE"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Shooting","url":"/shooting","group":"Preface"},"next":{"title":"Collocation for linear problems","url":"/linear","group":"Preface"}}},"domain":"http://localhost:3000"}