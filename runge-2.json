{"kind":"Notebook","sha256":"b079bfd252d57bec9ae71add47b90d768b01c07a4fc98fabefe18398d31f9786","slug":"runge-2","location":"/chapter9/section3/python/runge.ipynb","dependencies":[],"frontmatter":{"numbering":{"heading_1":{"enabled":false},"heading_2":{"enabled":false},"heading_3":{"enabled":false},"heading_4":{"enabled":false},"heading_5":{"enabled":false},"heading_6":{"enabled":false}},"kernelspec":{"name":"python3","display_name":"Python 3","language":"python"},"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"exports":[{"format":"ipynb","filename":"runge.ipynb","url":"/fnc/build/runge-353550ec1de559606edb4c1edea4053f.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-10T16:02:43.411156Z","iopub.status.busy":"2025-01-10T16:02:43.411072Z","iopub.status.idle":"2025-01-10T16:02:43.745742Z","shell.execute_reply":"2025-01-10T16:02:43.745433Z"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"exec(open(\"../../../python/FNC_init.py\").read())","visibility":"show","key":"KbEEFAwwVv"},{"type":"output","id":"7rsYqygaPc3C5MHkz-gGN","data":[],"visibility":"show","key":"g77hdOLcPW"}],"visibility":"remove","key":"Jwvh2hpmnr"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"q0SMu5SS9F"},{"type":"text","value":"9.3.3","key":"L4ynG1uFSE"}],"key":"RpzG3WbHu6"}],"identifier":"demo-stability-runge","label":"demo-stability-runge","kind":"proof:example","template":"Example %s","enumerator":"9.3.3","resolved":true,"html_id":"demo-stability-runge","remote":true,"url":"/stability-1","dataUrl":"/stability-1.json","key":"QU1asBVZOc"}],"key":"epnNIpt9j8"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"This function has infinitely many continuous derivatives on the entire real line and looks easy to approximate over ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"T3OKQqMYEn"},{"type":"inlineMath","value":"[-1,1]","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mo>−</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[-1,1]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">−</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]</span></span></span></span>","key":"qVC7AOK7VF"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"WBD85EpQun"}],"key":"xIruyB6g7c"}],"key":"FcLSobuTiR"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-10T16:02:43.747309Z","iopub.status.busy":"2025-01-10T16:02:43.747177Z","iopub.status.idle":"2025-01-10T16:02:43.831229Z","shell.execute_reply":"2025-01-10T16:02:43.830956Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"f = lambda x: 1 / (x**2 + 16)\nx = linspace(-1, 1, 1601)\nplot(x, f(x))\ntitle(\"Test function\");","key":"zLY5Vhkpym"},{"type":"output","id":"z1xsTSq7aFmEPQJR3Wyu6","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"f76d077e96f8d14567c142712033ccfe","path":"/fnc/build/f76d077e96f8d14567c142712033ccfe.png"},"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"}}}],"key":"fUQ3Rs0Rcg"}],"key":"Fc6fgI15WO"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We start by doing equispaced polynomial interpolation for some small values of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"IbJZo5KSWt"},{"type":"inlineMath","value":"n","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"lFTzO8EWik"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"S4wI7mMOM9"}],"key":"aQzo2nwdiv"}],"key":"ESTxbdmWZ5"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-10T16:02:43.832521Z","iopub.status.busy":"2025-01-10T16:02:43.832426Z","iopub.status.idle":"2025-01-10T16:02:44.085327Z","shell.execute_reply":"2025-01-10T16:02:44.084970Z"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"N = arange(4, 16, 4)\nlabel = []\nfor k, n in enumerate(N):\n    t = linspace(-1, 1, n + 1)  # equally spaced nodes\n    y = f(t)  # interpolation data\n    p = FNC.polyinterp(t, y)\n    err = abs(f(x) - p(x))\n    semilogy(x, err, \".\", markersize=2)\n    label.append(f\"degree {n}\")\n\nxlabel(\"$x$\"),  ylabel(\"$|f(x)-p(x)|$\")\nylim([1e-20, 1])\nlegend(label),  title(\"Error for low degrees\");","visibility":"hide","key":"XhQkXqc2Nx"},{"type":"output","id":"8FArH4yuzBt2K66absJKo","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"74d3fec528c820c9c1f8cad34e6d213d","path":"/fnc/build/74d3fec528c820c9c1f8cad34e6d213d.png"},"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"}}}],"visibility":"show","key":"Plml60xoLe"}],"visibility":"show","key":"Fb2zd1Oqcw"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The convergence so far appears rather good, though not uniformly so. However, notice what happens as we continue to increase the degree.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"SovHPVuW27"}],"key":"uKg4iMK3Wn"}],"key":"dPch2P7mYu"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-10T16:02:44.086937Z","iopub.status.busy":"2025-01-10T16:02:44.086810Z","iopub.status.idle":"2025-01-10T16:02:44.417723Z","shell.execute_reply":"2025-01-10T16:02:44.417391Z"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"N = 12 + 15 * arange(1, 4)\nlabels = []\nfor k, n in enumerate(N):\n    t = linspace(-1, 1, n + 1)  # equally spaced nodes\n    y = f(t)  # interpolation data\n    p = FNC.polyinterp(t, y)\n    err = abs(f(x) - p(x))\n    semilogy(x, err, \".\", markersize=2)\n    labels.append(f\"degree {n}\")\nxlabel(\"$x$\"),  ylabel(\"$|f(x)-p(x)|$\"),  ylim([1e-20, 1])\nlegend(labels),  title(\"Error for higher degrees\");","visibility":"hide","key":"KQDZhtuTwJ"},{"type":"output","id":"wrPqNHWehawo3HmHV3NBE","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"d2b8037bd1ca21079cf49ccb8b6637cf","path":"/fnc/build/d2b8037bd1ca21079cf49ccb8b6637cf.png"},"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"}}}],"visibility":"show","key":"ekQWIK5zWA"}],"visibility":"show","key":"irvcxZpZ3n"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The convergence in the middle can’t get any better than machine precision relative to the function values. So maintaining the growing gap between the center and the ends pushes the error curves upward exponentially fast at the ends, wrecking the convergence.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"gzX70a4s0h"}],"key":"jJCcWpCUXP"}],"key":"NIOsIpkfiP"}],"key":"qwHtL8ydmK"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Errfun","url":"/errfun-2","group":"Chapter 9"},"next":{"title":"Errcheb","url":"/errcheb-2","group":"Chapter 9"}}},"domain":"http://localhost:3000"}