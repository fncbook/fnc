{"kind":"Notebook","sha256":"e1d16659da0b72b5f5e36516cf342f1ac51ac209f8a4a86fb4f8bb95e21014fd","slug":"heatbe-2","location":"/chapter11/section2/python/heatBE.ipynb","dependencies":[],"frontmatter":{"numbering":{"heading_1":{"enabled":false},"heading_2":{"enabled":false},"heading_3":{"enabled":false},"heading_4":{"enabled":false},"heading_5":{"enabled":false},"heading_6":{"enabled":false}},"kernelspec":{"name":"python3","display_name":"myst","language":"python"},"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"exports":[{"format":"ipynb","filename":"heatBE.ipynb","url":"/fnc/build/heatBE-519ed681be61dfa9a524d3e72fb3369d.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"exec(open(\"../../../python/FNC_init.py\").read())","visibility":"show","key":"JwSwjObpZQ"},{"type":"output","id":"RRJBKMbXkQiVH73qeBUV0","data":[],"visibility":"show","key":"beG1OQINiY"}],"visibility":"remove","key":"cn4we9bv5w"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"YUcLxwsamI"},{"type":"text","value":"11.2.4","key":"KtR4Gx8aSE"}],"key":"TzcjXD1ZXA"}],"identifier":"demo-methodlines-heatbe","label":"demo-methodlines-heatBE","kind":"proof:example","template":"Example %s","enumerator":"11.2.4","resolved":true,"html_id":"demo-methodlines-heatbe","remote":true,"url":"/methodlines","dataUrl":"/methodlines.json","key":"WZaH7gdU6q"}],"key":"uu16ew0k3x"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Now we apply backward Euler to the heat equation. Mathematically this means multiplying by the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"kiD5e0ru1b"},{"type":"emphasis","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"inverse","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Kmy7zQlq4V"}],"key":"VFOvSJMfKP"},{"type":"text","value":" of a matrix, but we interpret that numerically as a linear system solution. We will reuse the setup from ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"T6WQQIWtLL"},{"type":"crossReference","kind":"proof:example","identifier":"demo-methodlines-heatfe","label":"demo-methodlines-heatFE","children":[{"type":"text","value":"Demo ","key":"Djc0RWe0Mm"},{"type":"text","value":"11.2.2","key":"ecCqW2SLpa"}],"template":"Example %s","enumerator":"11.2.2","resolved":true,"html_id":"demo-methodlines-heatfe","remote":true,"url":"/methodlines","dataUrl":"/methodlines.json","key":"N9PUmtOTnZ"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"CbFh2PQp5z"}],"key":"tb6bJwxNAW"}],"key":"HDvA60lXtT"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"m = 100\nx, Dx, Dxx = FNC.diffper(m, [0, 1])\ntfinal = 0.15  \nn = 2400                 # number of time steps  \ntau = tfinal / n         # time step\nt = tau * arange(n+1)    # time values\nU = zeros([m, n+1])\nU[:, 0] = exp(-60 * (x - 0.5) ** 2)","visibility":"show","key":"BLzqlNEEJ8"},{"type":"output","id":"yw2fRruSY89kvjHncLIDi","data":[],"visibility":"show","key":"ot0UiOAuyR"}],"visibility":"remove","key":"pxNpHZYPXl"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"import scipy.sparse as sp\nfrom scipy.sparse.linalg import spsolve\nB = sp.csr_matrix(sp.eye(m) - tau * Dxx)\nfor j in range(n):\n    U[:, j + 1] = spsolve(B, U[:, j])\n\nplot(x, U[:, ::500])\nxlabel(\"$x$\")\nylabel(\"$u(x,t)$\")\nlegend([f\"$t={tj:.2g}$\" for tj in t[::500]])\ntitle(\"Heat equation by backward Euler\");","key":"DlbcbTmciL"},{"type":"output","id":"A0uTjQ7UBb7Xrtj6gY_o0","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"9567bbe0b5f8286b16a8bc35556b9c07","path":"/fnc/build/9567bbe0b5f8286b16a8bc35556b9c07.png"},"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"}}}],"key":"ngXh4MIqDd"}],"key":"P1LWf4npb6"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"from matplotlib.animation import FuncAnimation\nfig = figure()\nax = fig.add_subplot(autoscale_on=False, xlim=(0, 1), ylim=(-0.25, 1))\nax.grid()\n\nline, = ax.plot([], [], '-', lw=2)\nax.set_title(\"Backward Euler\")\ntime_text = ax.text(0.05, 0.9, '', transform=ax.transAxes)\n\ndef snapshot(j):\n    line.set_data(x, U[:, j])\n    time_text.set_text(f\"t = {t[j]:.2e}\")\n    return line, time_text\n\nanim = FuncAnimation(fig, snapshot, frames=range(0, n+1, 10), blit=True)\nanim.save(\"diffusionBE.mp4\", fps=30)\nclose()","visibility":"hide","key":"IhwvSPLEUI"},{"type":"output","id":"eWDrvyVdSE7YCmVaW2XuZ","data":[],"visibility":"show","key":"QGOiteFRAI"}],"visibility":"show","key":"ntWbC6Dihm"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"This solution looks physically plausible, as the large concentration in the center diffuses outward until the solution is essentially constant. Observe that the solution remains periodic in space for all time.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rxf5hdkAoH"}],"key":"XH9dfFIcIQ"}],"key":"LNoh40GhYF"}],"key":"AuSyagQ6pL"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"HeatFE","url":"/heatfe-2","group":"Chapter 11"},"next":{"title":"Auto","url":"/auto-2","group":"Chapter 11"}}},"domain":"http://localhost:3000"}