{"version":1,"kind":"Notebook","sha256":"01ec7cd8116fe3a5bd1cc92abae6e8d1c0719e42062a49002844a6c6f59ae1e3","slug":"chapter12-1","location":"/matlab/chapter12.md","dependencies":[],"frontmatter":{"title":"Chapter 12","numbering":{"heading_1":{"enabled":false},"heading_2":{"enabled":false},"heading_3":{"enabled":false},"heading_4":{"enabled":false},"heading_5":{"enabled":false},"heading_6":{"enabled":false},"title":{"offset":2}},"kernelspec":{"name":"jupyter_matlab_kernel","display_name":"MATLAB","language":"matlab"},"content_includes_title":false,"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","TPBVP":"two-point boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"edit_url":"https://github.com/fncbook/fnc/blob/master/matlab/chapter12.md","exports":[{"format":"md","filename":"chapter12.md","url":"/build/chapter12-1c0e0d11ed963b73530e3708f4d0b47c.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Examples","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"X8ZKqF1dbs"}],"identifier":"examples","label":"Examples","html_id":"examples","implicit":true,"key":"zrKS9yPBGF"}],"key":"RCWzjdyFCf"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"cd  /Users/driscoll/Documents/GitHub/fnc/matlab\nFNC_init\npwd","visibility":"show","key":"uYakLU23Tx"},{"type":"output","id":"Y567FA-9nMx-ocpj-foIR","data":[{"output_type":"stream","name":"stdout","text":"Starting MATLAB ...\n"},{"output_type":"stream","name":"stdout","text":"Executing ..."},{"output_type":"execute_result","execution_count":1,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = '/Users/driscoll/Documents/GitHub/fnc/matlab'</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = '/Users/driscoll/Documents/GitHub/fnc/matlab'","content_type":"text/plain"}}}],"visibility":"show","key":"zZgrzG8wOT"}],"data":{"tags":[]},"visibility":"remove","key":"OauS2j31Ya"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"12.1 ","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"jAm6ydWNHy"},{"type":"link","identifier":"section-advection-traffic","label":"section-advection-traffic","kind":"narrative","position":{"start":{"line":20,"column":6},"end":{"line":20,"column":32}},"url":"/traffic","internal":true,"dataUrl":"/traffic.json","children":[{"type":"text","value":"Traffic flow","key":"Nyz3IhkPLo"}],"key":"j61ENdV1Pz"}],"identifier":"id-12-1","label":"12.1 ","html_id":"id-12-1","implicit":true,"key":"PB8sDEnZUX"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-traffic-advection","label":"demo-traffic-advection","kind":"proof:example","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":24}},"children":[{"type":"text","value":"Example ","key":"nQATGfTTun"},{"type":"text","value":"12.1.1","key":"UcJHO074bD"}],"template":"Example %s","enumerator":"12.1.1","resolved":true,"html_id":"demo-traffic-advection","remote":true,"url":"/traffic","dataUrl":"/traffic.json","key":"Ar8XAVUuyR"}],"key":"ZmTqdOCQ5I"},{"type":"paragraph","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"text","value":"In the following definition we allow the velocity ","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"UHMoPzJDs8"},{"type":"inlineMath","value":"c","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>c</mi></mrow><annotation encoding=\"application/x-tex\">c</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">c</span></span></span></span>","key":"BtNN8ED31P"},{"type":"text","value":" to be specified as a parameter.","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"t7xSyjRbFv"}],"key":"akPQcUTTjz"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[x, Dx, Dxx] = diffper(300, [-4, 4]);\nf = @(t, u, c) -c * (Dx*u);\nivp = ode(ODEFcn=f);\nivp.Parameters = 2;\nivp.InitialTime = 0;\nivp.RelativeTolerance = 1e-5;","key":"XCCs2ttZMS"},{"type":"output","id":"vqZ1blxAxBx3W8I7-pYY_","data":[],"key":"SSKQ37msrv"}],"data":{},"key":"TQkVUEh3E3"},{"type":"paragraph","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"children":[{"type":"text","value":"The following initial condition isn’t mathematically periodic, but the deviation is less than machine precision. We specify RK4 as the solver.","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"key":"KSbcJfPSRz"}],"key":"fvI72Avev4"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"u_init = 1 + exp(-3*x.^2);\nivp.InitialValue = u_init;\nt = linspace(0, 3, 201);\nsol = solve(ivp, t);\nU = sol.Solution;","key":"bhWvEDPR4w"},{"type":"output","id":"3leYTLUxLHBLYsjIaUwiw","data":[{"output_type":"stream","name":"stderr","text":"Error using ^ (line 52)\nIncorrect dimensions for raising a matrix to a power. Check that the matrix is square and the power is a scalar. To operate on each element of the matrix individually, use POWER (.^) for elementwise power.\n\nError in LiveEditorEvaluationHelperEeb0c052e-5793-4a7e-a209-577a074df658>@(t,u,p)sin((t+u)^2) (line 2)\nivp.ODEFcn = @(t, u, p) sin((t + u)^2);\n\nError in odearguments (line 93)\nf0 = ode(t0,y0,args{:});\n\nError in ode45 (line 104)\n    odearguments(odeIsFuncHandle,odeTreatAsMFile, solver_name, ode, tspan, y0, options, varargin);\n\nError in matlab.ode.internal.LegacySolver/solveAt (line 455)\n                    [t,y,stats] = obj.SolverFcn(args{:});\n\nError in matlab.ode.internal.LegacySolver/solve (line 119)\n                    [t,y] = obj.solveAt(t1);\n\nError in ode/solveAt (line 666)\n                    [tR,yR] = solver.solve(tspanRight); %#ok<ASGLU>\n\nError in ode/solve (line 331)\n                sol = obj.solveAt(t1);"}],"key":"oey0PwYurz"}],"data":{},"key":"HzDy0HLsl4"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"waterfall(x, t(1:5:end), U(:, 1:5:end)')\nview(-13, 65)\nxlabel('x'), ylabel('t'), zlabel('u(x,t)')\ntitle('Advection equation')","visibility":"hide","key":"PmuoGQBRts"},{"type":"output","id":"FpHGmqeluokc_CHCxsBwe","data":[{"output_type":"stream","name":"stderr","text":"Unrecognized function or variable 'U'."}],"visibility":"show","key":"CMvw4Dhy5i"}],"data":{"tags":[]},"visibility":"show","key":"jgPFi9aVy0"},{"type":"paragraph","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"children":[{"type":"text","value":"An animation shows the solution nicely. The bump moves with speed 2 to the right, reentering on the left as it exits to the right because of the periodic conditions.","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"key":"FveldjJLJo"}],"key":"yFpIWWEKfb"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf\nplot(x, U(:, 1))\nhold on,  grid on\naxis([-4, 4, 0.9, 2.1])\ntitle('Advection equation with periodic boundary') \nxlabel('x'),  ylabel('u(x,t)')\nvid = VideoWriter(\"figures/advection-periodic.mp4\",\"MPEG-4\");\nvid.Quality = 85;\nopen(vid);\nfor frame = 1:length(t)\n    cla, plot(x, U(:, frame))\n    str = sprintf(\"t = %.2f\", t(frame));\n    text(-3.5, 1.9, str);\n    writeVideo(vid, frame2im(getframe(gcf)));\nend\nclose(vid)","visibility":"hide","key":"GzyY7qjVH8"},{"type":"output","id":"0sRthccaJPfHfQpXC4DiW","data":[{"output_type":"stream","name":"stderr","text":"Unrecognized function or variable 'U'."}],"visibility":"remove","key":"sRdzRX5zKX"}],"data":{"tags":[]},"visibility":"show","key":"OKbOU3kO0u"},{"type":"image","url":"/build/advection-periodic-31829cae909c692abeadd6511ba1e713.mp4","alt":"Advection equation with periodic boundary","position":{"start":{"line":77,"column":1},"end":{"line":77,"column":1}},"key":"T8Xa7BG4TH","urlSource":"figures/advection-periodic.mp4"}],"label":"demo-traffic-advection-matlab","identifier":"demo-traffic-advection-matlab","html_id":"demo-traffic-advection-matlab","key":"DOpsL0MJiv"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-traffic-solve","label":"demo-traffic-solve","kind":"proof:example","position":{"start":{"line":82,"column":1},"end":{"line":82,"column":20}},"children":[{"type":"text","value":"Example ","key":"xOg5cbW51Z"},{"type":"text","value":"12.1.2","key":"nm9FAFyJjt"}],"template":"Example %s","enumerator":"12.1.2","resolved":true,"html_id":"demo-traffic-solve","remote":true,"url":"/traffic","dataUrl":"/traffic.json","key":"tW6xI2qvqp"}],"key":"hY9ANc7kqd"},{"type":"paragraph","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"children":[{"type":"text","value":"The following are parameters and a function relevant to defining the problem.","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"key":"Mka4w7aOK6"}],"key":"SyJWvvUy9L"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"rho_c = 1080;  rho_m = 380;  q_m = 10000;\nQ0prime = @(rho) 4*q_m*rho_c^2 * (rho_c - rho_m) * rho_m ...\n    *(rho_m - rho) ./ ((rho_c - 2*rho_m) * rho + rho_c * rho_m).^3;\nep = 0.02;","key":"ibNqr14Zvc"},{"type":"output","id":"tko7qp07XqKokQXChLql9","data":[],"key":"Jnqif4jVO2"}],"data":{},"key":"hGE66kfAHV"},{"type":"paragraph","position":{"start":{"line":93,"column":1},"end":{"line":93,"column":1}},"children":[{"type":"text","value":"Here we create a discretization on ","position":{"start":{"line":93,"column":1},"end":{"line":93,"column":1}},"key":"Go45HMKlWa"},{"type":"inlineMath","value":"m=800","position":{"start":{"line":93,"column":1},"end":{"line":93,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi><mo>=</mo><mn>800</mn></mrow><annotation encoding=\"application/x-tex\">m=800</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">800</span></span></span></span>","key":"TFZJrMzhLv"},{"type":"text","value":" points.","position":{"start":{"line":93,"column":1},"end":{"line":93,"column":1}},"key":"t4IDbVTrG5"}],"key":"nrkdYvKb5Y"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[x, Dx, Dxx] = diffper(800, [0, 4]);","key":"qNjaLEZN3X"},{"type":"output","id":"-jjQv4_JnabHdCaH7KJWx","data":[],"key":"lJBwcg5SE6"}],"data":{},"key":"W7AZ5qj4Hm"},{"type":"paragraph","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"children":[{"type":"text","value":"Next we define the ","key":"P9AaK6B6U3"},{"type":"abbreviation","title":"ordinary differential equation","children":[{"type":"text","value":"ODE","key":"GagrgxkImb"}],"key":"pugjac0lzj"},{"type":"text","value":" resulting from the method of lines.","key":"qWNdHELeyb"}],"key":"j8mmGLJq5s"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"odefun = @(t, rho) -Q0prime(rho) .* (Dx*rho) + ep * (Dxx*rho);\nivp = ode(ODEFcn=odefun);\nivp.InitialTime = 0;\nivp.RelativeTolerance = 1e-5;","key":"iUxCaEJtYu"},{"type":"output","id":"pmSiM-7kYT9xqToe5Y3Z3","data":[],"key":"FlHQcKUZgI"}],"data":{},"key":"G5JYW14QBM"},{"type":"paragraph","position":{"start":{"line":108,"column":1},"end":{"line":108,"column":1}},"children":[{"type":"text","value":"Our first initial condition has moderate density with a small bump. Because of the diffusion present, we use a stiff solver for the ","key":"EJqaRgPuDd"},{"type":"abbreviation","title":"initial-value problem","children":[{"type":"text","value":"IVP","key":"LweZLgbnRY"}],"key":"dSihXbLN1Z"},{"type":"text","value":".","key":"KkaHxPk2Su"}],"key":"cPLvRuwMyi"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"rho_init = 400 + 10 * exp(-20*(x-3).^2);\nivp.InitialValue = rho_init;\n\nt = linspace(0, 1, 101);\nsol = solve(ivp, t);\nRHO = sol.Solution;","key":"QbZAgLSF51"},{"type":"output","id":"Xudz1t3mCd1HUbcVaBi9V","data":[{"output_type":"stream","name":"stderr","text":"Error using ode/assertODEDefined (line 1048)\nThe ODEFcn property must be defined and non-empty for this operation.\n\nError in ode/checkConsistency (line 1252)\n            obj.assertODEDefined;\n\nError in ode/solve (line 322)\n            checkConsistency(obj);"}],"key":"xcBqIEJyGP"}],"data":{},"key":"iRWchnYalu"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf\nfor plot_idx = 1:20:101\n    str = sprintf(\"t = %.2f\", t(plot_idx));\n    plot(x, RHO(:, plot_idx), displayname=str)\n    hold on\nend\nxlabel('x'),  ylabel('car density')\ntitle('Traffic flow') \nlegend(location=\"northwest\")","visibility":"hide","key":"B2mPfw1K4s"},{"type":"output","id":"KyJAUy4LSpLYiEeJM9GVu","data":[{"output_type":"stream","name":"stderr","text":"Unrecognized function or variable 'RHO'."}],"visibility":"show","key":"rr9poUg4zP"}],"data":{"tags":[]},"visibility":"show","key":"bXAQnfuIsB"},{"type":"paragraph","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"children":[{"type":"text","value":"The bump slowly moves backward on the roadway, spreading out and gradually fading away due to the presence of diffusion.","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"key":"zjv2ILF9Wi"}],"key":"uEKqTWglDW"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf\nplot(x, RHO(:, 1))\nhold on,  grid on\naxis([0, 4, 398, 410])\ntitle('Traffic flow') \nxlabel('x'),  ylabel('u(x,t)')\nvid = VideoWriter(\"figures/traffic-small.mp4\",\"MPEG-4\");\nvid.Quality = 85;\nopen(vid);\nfor frame = 1:length(t)\n    cla, plot(x, RHO(:, frame))\n    str = sprintf(\"t = %.2f\", t(frame));\n    text(0.2, 409, str);\n    writeVideo(vid, frame2im(getframe(gcf)));\nend\nclose(vid)","visibility":"hide","key":"XUgDXnCyM9"},{"type":"output","id":"4_seWJqRVhL2Mpps1k0Bw","data":[{"output_type":"stream","name":"stderr","text":"Unrecognized function or variable 'RHO'."}],"visibility":"remove","key":"XAPIuu7SIN"}],"data":{"tags":[]},"visibility":"show","key":"uiVfZzBiTG"},{"type":"image","url":"/build/traffic-small-5dc79142d8522581dfab36a379a9fab6.mp4","alt":"Traffic flow","position":{"start":{"line":154,"column":1},"end":{"line":154,"column":1}},"key":"sdSIPj4UQL","urlSource":"figures/traffic-small.mp4"},{"type":"paragraph","position":{"start":{"line":156,"column":1},"end":{"line":156,"column":1}},"children":[{"type":"text","value":"Now we use an initial condition with a larger bump. Note that the scale on the ","position":{"start":{"line":156,"column":1},"end":{"line":156,"column":1}},"key":"ujc3bpOL2O"},{"type":"inlineMath","value":"y","position":{"start":{"line":156,"column":1},"end":{"line":156,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>","key":"ohD2TLmt7U"},{"type":"text","value":"-axis is much different for this solution.","position":{"start":{"line":156,"column":1},"end":{"line":156,"column":1}},"key":"hCEfO1nRk7"}],"key":"NeqXPxhVO3"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"rho_init = 400 + 80 * exp( -16*(x - 3).^2 );\nivp.InitialValue = rho_init;\nt = linspace(0, 0.5, 81);\nsol = solve(ivp, t);\nRHO = sol.Solution;","key":"RpegQRSXTa"},{"type":"output","id":"jixAJd82u_5WCo1CkQgBT","data":[{"output_type":"stream","name":"stderr","text":"Error using ^ (line 52)\nIncorrect dimensions for raising a matrix to a power. Check that the matrix is square and the power is a scalar. To operate on each element of the matrix individually, use POWER (.^) for elementwise power.\n\nError in LiveEditorEvaluationHelperEeb0c052e-5793-4a7e-a209-577a074df658>@(t,u,p)sin((t+u)^2) (line 2)\nhold on, plot(t, u, '.-')\n\nError in odearguments (line 93)\nf0 = ode(t0,y0,args{:});\n\nError in ode45 (line 104)\n    odearguments(odeIsFuncHandle,odeTreatAsMFile, solver_name, ode, tspan, y0, options, varargin);\n\nError in matlab.ode.internal.LegacySolver/solveAt (line 455)\n                    [t,y,stats] = obj.SolverFcn(args{:});\n\nError in matlab.ode.internal.LegacySolver/solve (line 119)\n                    [t,y] = obj.solveAt(t1);\n\nError in ode/solveAt (line 666)\n                    [tR,yR] = solver.solve(tspanRight); %#ok<ASGLU>\n\nError in ode/solve (line 331)\n                sol = obj.solveAt(t1);"}],"key":"V8a3PtqSDg"}],"data":{},"key":"pTy47NyWOs"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf\nfor plot_idx = 1:16:81\n    str = sprintf(\"t = %.2f\", t(plot_idx));\n    plot(x, RHO(:, plot_idx), displayname=str)\n    hold on\nend\nxlabel('x'),  ylabel('car density')\ntitle('Traffic jam') \nlegend(location=\"northwest\")","visibility":"hide","key":"g95VZHHVqU"},{"type":"output","id":"AOCn1onwm0bUzJLb4CPu0","data":[{"output_type":"stream","name":"stderr","text":"Unrecognized function or variable 'RHO'."}],"visibility":"show","key":"Y4i753Schn"}],"data":{"tags":[]},"visibility":"show","key":"fIMrXmOf6S"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf\nplot(x, RHO(:, 1))\nhold on,  grid on\naxis([0, 4, 395, 480])\ntitle('Traffic jam') \nxlabel('x'),  ylabel('u(x,t)')\nvid = VideoWriter(\"figures/traffic-jam.mp4\", \"MPEG-4\");\nvid.Quality = 85;\nopen(vid);\nfor frame = 1:length(t)\n    cla, plot(x, RHO(:, frame))\n    str = sprintf(\"t = %.2f\", t(frame));\n    text(0.2, 470, str);\n    writeVideo(vid, frame2im(getframe(gcf)));\nend\nclose(vid)","visibility":"hide","key":"Yqr0aDBSjB"},{"type":"output","id":"-26L1UyN6j5vBcRwPt7Ex","data":[{"output_type":"stream","name":"stderr","text":"Unrecognized function or variable 'RHO'."}],"visibility":"remove","key":"YGKz0bphXf"}],"data":{"tags":[]},"visibility":"show","key":"nUrLqCXIWN"},{"type":"image","url":"/build/traffic-jam-10b0fe957b6556f8f93e8d596b6b9f1f.mp4","alt":"Traffic jam","position":{"start":{"line":199,"column":1},"end":{"line":199,"column":1}},"key":"MW2b3pAQXZ","urlSource":"figures/traffic-jam.mp4"},{"type":"paragraph","position":{"start":{"line":201,"column":1},"end":{"line":201,"column":1}},"children":[{"type":"text","value":"In this case the density bump travels backward along the road. It also steepens on the side facing the incoming traffic and decreases much more slowly on the other side. A motorist would experience this as an abrupt increase in density, followed by a much more gradual decrease in density and resulting gradual increase in speed. (You also see some transient, high-frequency oscillations. These are caused by instabilities, as we discuss in simpler situations later in this chapter.)","position":{"start":{"line":201,"column":1},"end":{"line":201,"column":1}},"key":"gvR5Xudfud"}],"key":"ZCWPY65CJv"}],"label":"demo-traffic-solve-matlab","identifier":"demo-traffic-solve-matlab","html_id":"demo-traffic-solve-matlab","key":"KBkoqg551e"},{"type":"heading","depth":3,"position":{"start":{"line":205,"column":1},"end":{"line":205,"column":1}},"children":[{"type":"text","value":"12.2 ","position":{"start":{"line":205,"column":1},"end":{"line":205,"column":1}},"key":"DDIkOC04cO"},{"type":"link","identifier":"section-advection-upwind","label":"section-advection-upwind","kind":"narrative","position":{"start":{"line":205,"column":6},"end":{"line":205,"column":31}},"url":"/upwind","internal":true,"dataUrl":"/upwind.json","children":[{"type":"text","value":"Upwinding and stability","key":"YX5ZImxlEC"}],"key":"GkqkYl5GyV"}],"identifier":"id-12-2","label":"12.2 ","html_id":"id-12-2","implicit":true,"key":"dK5CW6ReEx"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-upwind-cfl","label":"demo-upwind-cfl","kind":"proof:example","position":{"start":{"line":207,"column":1},"end":{"line":207,"column":17}},"children":[{"type":"text","value":"Example ","key":"u8yiQyXFw4"},{"type":"text","value":"12.2.3","key":"oNBjDSDUlF"}],"template":"Example %s","enumerator":"12.2.3","resolved":true,"html_id":"demo-upwind-cfl","remote":true,"url":"/upwind","dataUrl":"/upwind.json","key":"MEPjkJ4qNX"}],"key":"wtKQin8nWP"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[x, Dx] = diffper(400, [0, 1]);\nc = 2;  \nivp = ode(ODEFcn = @(t, u) -c * (Dx*u));\nivp.RelativeTolerance = 1e-5;\nivp.InitialTime = 0;\nu_init = exp( -80*(x - 0.5).^2 );\nivp.InitialValue = u_init;\n\n[u, sol] = solutionFcn(ivp, 0, 2);","key":"MWaCo51hx9"},{"type":"output","id":"lySJEBSq0-ataeH12H0p0","data":[],"key":"KlqPd4Ju1G"}],"data":{},"key":"dZB5nNTIgB"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf\nt = linspace(0, 2, 81);\ncontour(x, t, u(t)', 12)\nxlabel('x'),  ylabel('t')\ntitle('Linear advection')","visibility":"hide","key":"ySf2i7n0Qq"},{"type":"output","id":"OE826Gnn2xQmOdxpz70R2","data":[{"output_type":"stream","name":"stderr","text":"Error using contour (line 48)\nThe size of X must match the size of Z or the number of columns of Z."}],"visibility":"show","key":"AInfG8HoT3"}],"data":{"tags":[]},"visibility":"show","key":"NyIxuhVmTh"},{"type":"paragraph","position":{"start":{"line":231,"column":1},"end":{"line":231,"column":1}},"children":[{"type":"text","value":"In the space-time plot above, you can see the initial hump traveling rightward at constant speed. It fully traverses the domain once for each integer multiple of ","position":{"start":{"line":231,"column":1},"end":{"line":231,"column":1}},"key":"An7HD8i3tq"},{"type":"inlineMath","value":"t=1/2","position":{"start":{"line":231,"column":1},"end":{"line":231,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi><mo>=</mo><mn>1</mn><mi mathvariant=\"normal\">/</mi><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">t=1/2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1/2</span></span></span></span>","key":"TleiyZwZJL"},{"type":"text","value":".","position":{"start":{"line":231,"column":1},"end":{"line":231,"column":1}},"key":"qwUl6DKQ0U"}],"key":"I74EQHSBcS"},{"type":"paragraph","position":{"start":{"line":233,"column":1},"end":{"line":233,"column":1}},"children":[{"type":"text","value":"If we cut ","position":{"start":{"line":233,"column":1},"end":{"line":233,"column":1}},"key":"vp8tS5qXOL"},{"type":"inlineMath","value":"h","position":{"start":{"line":233,"column":1},"end":{"line":233,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>h</mi></mrow><annotation encoding=\"application/x-tex\">h</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">h</span></span></span></span>","key":"WPaNmJrSMi"},{"type":"text","value":" by a factor of 2 (i.e., double ","position":{"start":{"line":233,"column":1},"end":{"line":233,"column":1}},"key":"GdLBNsWVpI"},{"type":"inlineMath","value":"m","position":{"start":{"line":233,"column":1},"end":{"line":233,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi></mrow><annotation encoding=\"application/x-tex\">m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">m</span></span></span></span>","key":"vzmJK0uGBB"},{"type":"text","value":"), then the CFL condition suggests that the time step should be cut by a factor of 2 also.","position":{"start":{"line":233,"column":1},"end":{"line":233,"column":1}},"key":"KyGGJnwOSo"}],"key":"dSNI73qc2W"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"num_steps_400 = length(sol.Time) - 1\n\n[x, Dx] = diffper(800, [0, 1]);\nivp.ODEFcn = @(t, u) -c * (Dx*u);\nivp.InitialValue = exp( -80*(x - 0.5).^2 );\n[u, sol] = solutionFcn(ivp, 0, 2);\n\nnum_steps_800 = length(sol.Time) - 1\nratio = num_steps_800 / num_steps_400","key":"ius5KHoYfj"},{"type":"output","id":"qHkw9HSPoRZxQEwzpWVCy","data":[{"output_type":"execute_result","execution_count":17,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>num_steps_400 = \n   601\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"num_steps_400 = \n   601\n","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":17,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>num_steps_800 = \n        4472\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"num_steps_800 = \n        4472\n","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":17,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ratio = \n   7.4409e+00\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ratio = \n   7.4409e+00\n","content_type":"text/plain"}}}],"key":"tM29lZBIoB"}],"data":{},"key":"g8PuXLdk6t"}],"label":"demo-upwind-cfl-matlab","identifier":"demo-upwind-cfl-matlab","html_id":"demo-upwind-cfl-matlab","key":"srxHXuHQBM"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-upwind-direction","label":"demo-upwind-direction","kind":"proof:example","position":{"start":{"line":249,"column":1},"end":{"line":249,"column":23}},"children":[{"type":"text","value":"Example ","key":"B2MyERZIts"},{"type":"text","value":"12.2.6","key":"nIhxZ7c5Zh"}],"template":"Example %s","enumerator":"12.2.6","resolved":true,"html_id":"demo-upwind-direction","remote":true,"url":"/upwind","dataUrl":"/upwind.json","key":"disn7UlEg6"}],"key":"IeuVT2gTGk"},{"type":"paragraph","position":{"start":{"line":251,"column":1},"end":{"line":251,"column":1}},"children":[{"type":"text","value":"If we solve advection over ","position":{"start":{"line":251,"column":1},"end":{"line":251,"column":1}},"key":"Bfe6U3LgOu"},{"type":"inlineMath","value":"[0,1]","position":{"start":{"line":251,"column":1},"end":{"line":251,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mn>0</mn><mo separator=\"true\">,</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[0,1]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]</span></span></span></span>","key":"g5ipjZYPDv"},{"type":"text","value":" with velocity ","position":{"start":{"line":251,"column":1},"end":{"line":251,"column":1}},"key":"g8oX0fs4wt"},{"type":"inlineMath","value":"c=-1","position":{"start":{"line":251,"column":1},"end":{"line":251,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>c</mi><mo>=</mo><mo>−</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">c=-1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">c</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">−</span><span class=\"mord\">1</span></span></span></span>","key":"bBxK8BJxNO"},{"type":"text","value":", the right boundary is in the upwind/inflow direction. Thus a well-posed boundary condition is ","position":{"start":{"line":251,"column":1},"end":{"line":251,"column":1}},"key":"NlBTsIX0dN"},{"type":"inlineMath","value":"u(1,t)=0","position":{"start":{"line":251,"column":1},"end":{"line":251,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo stretchy=\"false\">(</mo><mn>1</mn><mo separator=\"true\">,</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">u(1,t)=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"TsaHHYlFVO"},{"type":"text","value":".","position":{"start":{"line":251,"column":1},"end":{"line":251,"column":1}},"key":"NJT3t8VFA2"}],"key":"hAr2XtNpaW"},{"type":"paragraph","position":{"start":{"line":253,"column":1},"end":{"line":253,"column":1}},"children":[{"type":"text","value":"We’ll pattern a solution after ","position":{"start":{"line":253,"column":1},"end":{"line":253,"column":1}},"key":"p0s0hB695H"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-parabolic","label":"function-parabolic","children":[{"type":"text","value":"Function ","key":"tFJH5qrn3x"},{"type":"text","value":"11.5.2","key":"A5j3iEHYTf"}],"template":"Algorithm %s","enumerator":"11.5.2","resolved":true,"html_id":"function-parabolic","remote":true,"url":"/boundaries","dataUrl":"/boundaries.json","key":"B400PqI5kV"},{"type":"text","value":". Since ","position":{"start":{"line":253,"column":1},"end":{"line":253,"column":1}},"key":"L1YK207KRY"},{"type":"inlineMath","value":"u(x_m,t)=0","position":{"start":{"line":253,"column":1},"end":{"line":253,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>m</mi></msub><mo separator=\"true\">,</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">u(x_m,t)=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"MHuBI8B4J0"},{"type":"text","value":", we define the ","key":"qw0ksvzxhg"},{"type":"abbreviation","title":"ordinary differential equation","children":[{"type":"text","value":"ODE","key":"eEsMTiAZ0j"}],"key":"WBdXYixBlW"},{"type":"text","value":" interior problem ","key":"TLsWHLURqt"},{"type":"crossReference","kind":"equation","identifier":"mol-interior","label":"mol-interior","children":[{"type":"text","value":"(","key":"fcw2b6QrLk"},{"type":"text","value":"11.5.4","key":"DPzJuml4ey"},{"type":"text","value":")","key":"WYmD0X8Hoj"}],"template":"(%s)","enumerator":"11.5.4","resolved":true,"html_id":"mol-interior","remote":true,"url":"/boundaries","dataUrl":"/boundaries.json","key":"KNAC7TK6rS"},{"type":"text","value":" for ","position":{"start":{"line":253,"column":1},"end":{"line":253,"column":1}},"key":"OMHSBLUAQG"},{"type":"inlineMath","value":"\\mathbf{v}","position":{"start":{"line":253,"column":1},"end":{"line":253,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">v</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{v}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4444em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">v</span></span></span></span>","key":"j9DWXEj9l8"},{"type":"text","value":" without ","position":{"start":{"line":253,"column":1},"end":{"line":253,"column":1}},"key":"vh6PouD1tl"},{"type":"inlineMath","value":"u_m","position":{"start":{"line":253,"column":1},"end":{"line":253,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>u</mi><mi>m</mi></msub></mrow><annotation encoding=\"application/x-tex\">u_m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"SUuNTZURc5"},{"type":"text","value":". For each evaluation of ","position":{"start":{"line":253,"column":1},"end":{"line":253,"column":1}},"key":"fmPqplm6mg"},{"type":"inlineMath","value":"\\mathbf{v}'","position":{"start":{"line":253,"column":1},"end":{"line":253,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi mathvariant=\"bold\">v</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup></mrow><annotation encoding=\"application/x-tex\">\\mathbf{v}&#x27;</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span></span></span></span>","key":"StENqH1rae"},{"type":"text","value":", we must extend the data back to ","position":{"start":{"line":253,"column":1},"end":{"line":253,"column":1}},"key":"h5LFoMxdLb"},{"type":"inlineMath","value":"x_m","position":{"start":{"line":253,"column":1},"end":{"line":253,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mi>m</mi></msub></mrow><annotation encoding=\"application/x-tex\">x_m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"YPkbU4Y8gn"},{"type":"text","value":" first.","position":{"start":{"line":253,"column":1},"end":{"line":253,"column":1}},"key":"iVWAtUModu"}],"key":"guj7TIE1x4"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"m = 100;  c = -1;\n[x, Dx] = diffmat2(m, [0, 1]);\nchop = @(u) u(1:m);  \nextend = @(v) [v; 0];\nodefun = @(t, v) -c * chop( Dx * extend(v) );\nivp = ode(ODEFcn = odefun);\nivp.RelativeTolerance = 1e-5;\nivp.InitialTime = 0;","key":"HiekEg0btR"},{"type":"output","id":"OnUR-FSwzc_8qwigvpGc-","data":[],"key":"ODBB1Fq7ji"}],"data":{},"key":"aDOKqnQjcx"},{"type":"paragraph","position":{"start":{"line":266,"column":1},"end":{"line":266,"column":1}},"children":[{"type":"text","value":"Now we solve for an initial condition that has a single hump.","position":{"start":{"line":266,"column":1},"end":{"line":266,"column":1}},"key":"LLPLe7SC9y"}],"key":"MU0daVlTJJ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"u_init = exp( -80*(x - 0.5).^2 );\nivp.InitialValue = chop(u_init);\nsol = solutionFcn(ivp, 0, 1);\nu = @(t) [sol(t); zeros(1, length(t))];    % extend to zero at right","key":"dOYRVl098k"},{"type":"output","id":"6MKvB_HeMzvfdVvCxruqN","data":[{"output_type":"stream","name":"stderr","text":"Index exceeds the number of array elements. Index must not exceed 5.\n\nError in Notebook>@(u)u(1:m) (line 3)\nsol = solutionFcn(ivp, 0, 1);"}],"key":"mt0616VdHf"}],"data":{},"key":"j5rfIDiiQo"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"t = linspace(0, 1, 81);\nclf,  contour(x, t, u(t)', 0.15:0.2:1)\nxlabel x,  ylabel t\ntitle('Advection with inflow BC')","key":"r5cAZiRu6x"},{"type":"output","id":"ib4kh0stLjrAoqs5EG8gC","data":[{"output_type":"stream","name":"stderr","text":"Error using contour (line 48)\nThe size of X must match the size of Z or the number of columns of Z."}],"key":"bdoojlJTfH"}],"data":{},"key":"GVbmpb2X1J"},{"type":"paragraph","position":{"start":{"line":282,"column":1},"end":{"line":282,"column":1}},"children":[{"type":"text","value":"We find that the hump gracefully exits out the downwind end.","position":{"start":{"line":282,"column":1},"end":{"line":282,"column":1}},"key":"Lc3YQAs5fN"}],"key":"URhiZ476xl"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf\nplot(x, u(0))\nhold on\naxis([0, 1, -0.05, 1.05])\ntitle('Advection with inflow BC') \nxlabel('x'),  ylabel('u(x,t)')\nvid = VideoWriter(\"figures/advection-inflow.mp4\", \"MPEG-4\");\nvid.Quality = 85;\nopen(vid);\nfor frame = 1:length(t)\n    cla, plot(x, u(t(frame)))\n    str = sprintf(\"t = %.2f\", t(frame));\n    text(0.08, 0.85, str);\n    writeVideo(vid, frame2im(getframe(gcf)));\nend\nclose(vid)","visibility":"hide","key":"qZ6uvkCH3w"},{"type":"output","id":"ce-St1JJRy-jk3zTgh1KR","data":[{"output_type":"stream","name":"stderr","text":"Error using plot\nSpecify the coordinates as vectors or matrices of the same size, or as a vector and a matrix that share the same length in at least one dimension."}],"visibility":"remove","key":"v5pkz8kizB"}],"data":{"tags":[]},"visibility":"show","key":"wSSCtRFU0m"},{"type":"image","url":"/build/advection-inflow-a4f44ee51a46e1584922f20db96f774b.mp4","alt":"Advection with inflow BC","position":{"start":{"line":304,"column":1},"end":{"line":304,"column":1}},"key":"a6GC0ujOww","urlSource":"figures/advection-inflow.mp4"},{"type":"paragraph","position":{"start":{"line":306,"column":1},"end":{"line":306,"column":1}},"children":[{"type":"text","value":"If instead of ","position":{"start":{"line":306,"column":1},"end":{"line":306,"column":1}},"key":"gM74TKiFrM"},{"type":"inlineMath","value":"u(1,t)=0","position":{"start":{"line":306,"column":1},"end":{"line":306,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo stretchy=\"false\">(</mo><mn>1</mn><mo separator=\"true\">,</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">u(1,t)=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"wgSrk0oVaA"},{"type":"text","value":" we were to try to impose the downwind condition ","position":{"start":{"line":306,"column":1},"end":{"line":306,"column":1}},"key":"ZVZ4WYODTU"},{"type":"inlineMath","value":"u(0,t)=0","position":{"start":{"line":306,"column":1},"end":{"line":306,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo stretchy=\"false\">(</mo><mn>0</mn><mo separator=\"true\">,</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">u(0,t)=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"TVjYVa1lMF"},{"type":"text","value":", we only need to change the index of the interior nodes and where to append the zero value.","position":{"start":{"line":306,"column":1},"end":{"line":306,"column":1}},"key":"UnS8oxpi2K"}],"key":"Br94HLdG9F"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"chop = @(u) u(2:m+1);  \nextend = @(v) [0; v];\nivp.ODEFcn = @(t, v) -c * chop( Dx * extend(v) );\nivp.InitialValue = chop(u_init);\nsol = solutionFcn(ivp, 0, 1);\nu = @(t) [zeros(1, length(t)); sol(t)];","key":"gNr0Pa1CCw"},{"type":"output","id":"BqKskIRvzlmFd2hoxeRgg","data":[{"output_type":"stream","name":"stderr","text":"Not enough input arguments.\n\nError in LiveEditorEvaluationHelperE8fd48343-16a7-41c1-a5d0-54338789305c>@(x,y)(1+y).*(1-x).^4.*(1+x).^2.*(1-y.^4) (line 5)\nivp.Solver = \"stiff\";\n\nError in Notebook>@(u)u(2:m+1) (line 1)\nchop = @(u) u(2:m+1);  "}],"key":"wmNt0VLh5r"}],"data":{},"key":"QBpPjEMBBQ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"contour(x, t, u(t)', 0.15:0.2:1)\nxlabel x,  ylabel t\ntitle('Advection with outflow BC')","visibility":"hide","key":"bkLgAWk0sz"},{"type":"output","id":"lZKbzr9ZcYu3MzMKZyuSi","data":[{"output_type":"stream","name":"stderr","text":"Error using contour (line 48)\nThe size of X must match the size of Z or the number of columns of Z."}],"visibility":"show","key":"wdLVjnddUl"}],"data":{"tags":[]},"visibility":"show","key":"x3JnAbb9yd"},{"type":"paragraph","position":{"start":{"line":324,"column":1},"end":{"line":324,"column":1}},"children":[{"type":"text","value":"This time, the solution blows up as soon as the hump runs into the boundary because there are conflicting demands there.","position":{"start":{"line":324,"column":1},"end":{"line":324,"column":1}},"key":"T1pOGe1Sk7"}],"key":"x7B2CRt4Of"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf\nplot(x, u(0))\nhold on\naxis([0, 1, -0.05, 1.05])\ntitle('Advection with outflow BC') \nxlabel('x'),  ylabel('u(x,t)')\nvid = VideoWriter(\"figures/advection-outflow.mp4\", \"MPEG-4\");\nvid.Quality = 85;\nopen(vid);\nfor frame = 1:45\n    cla, plot(x, u(t(frame)))\n    str = sprintf(\"t = %.2f\", t(frame));\n    text(0.08, 0.85, str);\n    writeVideo(vid, frame2im(getframe(gcf)));\nend\nclose(vid)","visibility":"hide","key":"uGCnwlKip5"},{"type":"output","id":"tFRwtOfZIwsvsQ-pteNw9","data":[{"output_type":"stream","name":"stderr","text":"Error using plot\nSpecify the coordinates as vectors or matrices of the same size, or as a vector and a matrix that share the same length in at least one dimension."}],"visibility":"remove","key":"AoQ9A3OMIC"}],"data":{"tags":[]},"visibility":"show","key":"oLVbVAv1sS"},{"type":"image","url":"/build/advection-outflow-e8492fa541656c264a15dfeb6988e671.mp4","alt":"Advection with outflow BC","position":{"start":{"line":346,"column":1},"end":{"line":346,"column":1}},"key":"ylSK7xBUUm","urlSource":"figures/advection-outflow.mp4"}],"label":"demo-upwind-direction-matlab","identifier":"demo-upwind-direction-matlab","html_id":"demo-upwind-direction-matlab","key":"ltAnKFUsJu"},{"type":"heading","depth":3,"position":{"start":{"line":349,"column":1},"end":{"line":349,"column":1}},"children":[{"type":"text","value":"12.3 ","position":{"start":{"line":349,"column":1},"end":{"line":349,"column":1}},"key":"MgESbVk09I"},{"type":"link","identifier":"section-advection-absstab","label":"section-advection-absstab","kind":"narrative","position":{"start":{"line":349,"column":6},"end":{"line":349,"column":32}},"url":"/absstab-advection","internal":true,"dataUrl":"/absstab-advection.json","children":[{"type":"text","value":"Absolute stability","key":"l1d3Myevk1"}],"key":"FNCuv6OqfN"}],"identifier":"id-12-3","label":"12.3 ","html_id":"id-12-3","implicit":true,"key":"ecZgXMsMSt"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-absstab-advection","label":"demo-absstab-advection","kind":"proof:example","position":{"start":{"line":352,"column":1},"end":{"line":352,"column":24}},"children":[{"type":"text","value":"Example ","key":"NjLpVxZ9IK"},{"type":"text","value":"12.3.1","key":"lQxmYVP1w4"}],"template":"Example %s","enumerator":"12.3.1","resolved":true,"html_id":"demo-absstab-advection","remote":true,"url":"/absstab-advection","dataUrl":"/absstab-advection.json","key":"p9KBeAI1CV"}],"key":"PoPKVTPl2n"},{"type":"paragraph","position":{"start":{"line":354,"column":1},"end":{"line":354,"column":1}},"children":[{"type":"text","value":"For ","position":{"start":{"line":354,"column":1},"end":{"line":354,"column":1}},"key":"lJO0ogzjvK"},{"type":"inlineMath","value":"c=1","position":{"start":{"line":354,"column":1},"end":{"line":354,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>c</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">c=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">c</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"Ub6wTrPaKl"},{"type":"text","value":" we get purely imaginary eigenvalues.","position":{"start":{"line":354,"column":1},"end":{"line":354,"column":1}},"key":"ExC3Ikf3Fy"}],"key":"CORcr6ZOnL"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[x, Dx] = diffper(40, [0, 1]);\nlambda = eig(Dx);\nclf\nscatter(real(lambda), imag(lambda))\naxis equal,  grid on\ntitle('Eigenvalues for pure advection')","visibility":"hide","key":"mX1y3PyIdY"},{"type":"output","id":"cJXzltbBXTio51D6CuSiO","data":[{"output_type":"execute_result","execution_count":25,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"86615a76d8fb7a0c6bdcac0c9014014c","path":"/build/86615a76d8fb7a0c6bdcac0c9014014c.png"}}}],"visibility":"show","key":"wQrcjQyWHF"}],"data":{"tags":[]},"visibility":"show","key":"Ub5enhiGuS"},{"type":"paragraph","position":{"start":{"line":366,"column":1},"end":{"line":366,"column":1}},"children":[{"type":"text","value":"Let’s choose a time step of ","position":{"start":{"line":366,"column":1},"end":{"line":366,"column":1}},"key":"WfdQA31K0l"},{"type":"inlineMath","value":"\\tau=0.1","position":{"start":{"line":366,"column":1},"end":{"line":366,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>τ</mi><mo>=</mo><mn>0.1</mn></mrow><annotation encoding=\"application/x-tex\">\\tau=0.1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.1132em;\">τ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0.1</span></span></span></span>","key":"TNDEiBv3Jq"},{"type":"text","value":" and compare to the stability regions of the Euler and backward Euler time steppers (shown as shaded regions):","position":{"start":{"line":366,"column":1},"end":{"line":366,"column":1}},"key":"rOOvy1nSy2"}],"key":"VjBHFLDupY"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"zc = exp( 1i * linspace(0,2*pi,361)' );    % points on |z|=1\nz = zc - 1;    % shift circle left by 1\nclf,  fill(real(z), imag(z), [.8, .8, 1])\nhold on,  scatter(real(0.1*lambda), imag(0.1*lambda))\naxis equal,  axis square\naxis([-5, 5, -5, 5]),  grid on\ntitle('Euler')","visibility":"hide","key":"nCyoIIAimo"},{"type":"output","id":"XA8V6pxdYGXu_fOYhymuh","data":[{"output_type":"execute_result","execution_count":26,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"b7e957dea4bf177b88cb30bfeca57b52","path":"/build/b7e957dea4bf177b88cb30bfeca57b52.png"}}}],"visibility":"show","key":"NKMJCK2F88"}],"data":{"tags":[]},"visibility":"show","key":"JMTyyOisUI"},{"type":"paragraph","position":{"start":{"line":379,"column":1},"end":{"line":379,"column":1}},"children":[{"type":"text","value":"In the Euler case it’s clear that ","position":{"start":{"line":379,"column":1},"end":{"line":379,"column":1}},"key":"KAZfOTfWr5"},{"type":"emphasis","position":{"start":{"line":379,"column":1},"end":{"line":379,"column":1}},"children":[{"type":"text","value":"no","position":{"start":{"line":379,"column":1},"end":{"line":379,"column":1}},"key":"k5afkVn0b2"}],"key":"bX4jwgMnFt"},{"type":"text","value":" real value of ","position":{"start":{"line":379,"column":1},"end":{"line":379,"column":1}},"key":"vl4VLuJysN"},{"type":"inlineMath","value":"\\tau>0","position":{"start":{"line":379,"column":1},"end":{"line":379,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>τ</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">\\tau&gt;0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.1132em;\">τ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&gt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"AYFMWFheHH"},{"type":"text","value":" is going to make ","position":{"start":{"line":379,"column":1},"end":{"line":379,"column":1}},"key":"A3hzuuovPI"},{"type":"text","value":"ζ","position":{"start":{"line":379,"column":1},"end":{"line":379,"column":1}},"key":"r6rpQPYCwu"},{"type":"text","value":" values fit within the stability region. Any method whose stability region includes none of the imaginary axis is an unsuitable choice for advection.","position":{"start":{"line":379,"column":1},"end":{"line":379,"column":1}},"key":"Oh1MvXVR7X"}],"key":"MnMx9c8YMt"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf,  fill([-6, 6, 6, -6],[-6, -6, 6, 6], [.8, .8, 1])\nz = zc + 1;   % shift circle right by 1\nhold on,  scatter(real(0.1*lambda), imag(0.1*lambda))\nfill(real(z), imag(z), 'w')\naxis equal,  axis square\naxis([-5 5 -5 5]),  grid on\ntitle('backward Euler')","visibility":"hide","key":"SJObentk73"},{"type":"output","id":"o5Ta2zOahUVYOtd3NO7Fx","data":[{"output_type":"execute_result","execution_count":27,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"fb3f5fd69a150186df583b2f50a11a57","path":"/build/fb3f5fd69a150186df583b2f50a11a57.png"}}}],"visibility":"show","key":"jnlFTXvs9H"}],"data":{"tags":[]},"visibility":"show","key":"d3Oys9pBqS"},{"type":"paragraph","position":{"start":{"line":392,"column":1},"end":{"line":392,"column":1}},"children":[{"type":"text","value":"The A-stable backward Euler time stepping tells the exact opposite story: it will be absolutely stable for any choice of the time step ","position":{"start":{"line":392,"column":1},"end":{"line":392,"column":1}},"key":"cGzfxUQbOr"},{"type":"text","value":"τ","position":{"start":{"line":392,"column":1},"end":{"line":392,"column":1}},"key":"Jw4RLD111R"},{"type":"text","value":".","position":{"start":{"line":392,"column":1},"end":{"line":392,"column":1}},"key":"zQeNVo1b4D"}],"key":"V7FhSU7LVX"}],"label":"demo-absstab-advection-matlab","identifier":"demo-absstab-advection-matlab","html_id":"demo-absstab-advection-matlab","key":"b2sqW8arki"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-absstab-advdiff","label":"demo-absstab-advdiff","kind":"proof:example","position":{"start":{"line":396,"column":1},"end":{"line":396,"column":22}},"children":[{"type":"text","value":"Example ","key":"HQGdrSkABb"},{"type":"text","value":"12.3.2","key":"sdw9wAshAq"}],"template":"Example %s","enumerator":"12.3.2","resolved":true,"html_id":"demo-absstab-advdiff","remote":true,"url":"/absstab-advection","dataUrl":"/absstab-advection.json","key":"ZMVEN6Lugc"}],"key":"QOoAevtd2p"},{"type":"paragraph","position":{"start":{"line":398,"column":1},"end":{"line":398,"column":1}},"children":[{"type":"text","value":"The eigenvalues of advection-diffusion are near-imaginary for ","position":{"start":{"line":398,"column":1},"end":{"line":398,"column":1}},"key":"MSKdVW2Pho"},{"type":"inlineMath","value":"\\epsilon\\approx 0","position":{"start":{"line":398,"column":1},"end":{"line":398,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ϵ</mi><mo>≈</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">\\epsilon\\approx 0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4831em;\"></span><span class=\"mord mathnormal\">ϵ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"cwnMr9wbcy"},{"type":"text","value":" and get closer to the negative real axis as ","position":{"start":{"line":398,"column":1},"end":{"line":398,"column":1}},"key":"CQDlavkQov"},{"type":"text","value":"ε","position":{"start":{"line":398,"column":1},"end":{"line":398,"column":1}},"key":"EXU0XVvmd9"},{"type":"text","value":" increases.","position":{"start":{"line":398,"column":1},"end":{"line":398,"column":1}},"key":"CVj0GonAer"}],"key":"WAGJaln1eP"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[x, Dx, Dxx] = diffper(40, [0, 1]);\ntau = 0.1;\nclf\nfor ep = [0.001 0.01 0.05]\n  lambda = eig(-Dx + ep*Dxx);\n  str = sprintf(\"\\\\epsilon = %.3f\", ep);\n  scatter(real(tau*lambda), imag(tau*lambda), displayname=str)\n  hold on\nend\naxis equal,  grid on\nlegend(location='northwest')\ntitle('Eigenvalues for advection-diffusion')","visibility":"hide","key":"mj8j8nbdnL"},{"type":"output","id":"rd2IWta4XyC9FTMVOPDkz","data":[{"output_type":"execute_result","execution_count":28,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"e15e6b2e87ec1b53f27d2630aee83a2e","path":"/build/e15e6b2e87ec1b53f27d2630aee83a2e.png"}}}],"visibility":"show","key":"HAtR5ITKTB"}],"data":{"tags":[]},"visibility":"show","key":"P0YCHqrh5y"}],"label":"demo-absstab-advdiff-matlab","identifier":"demo-absstab-advdiff-matlab","html_id":"demo-absstab-advdiff-matlab","key":"uvuW1ysjjq"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-absstab-inflow","label":"demo-absstab-inflow","kind":"proof:example","position":{"start":{"line":418,"column":1},"end":{"line":418,"column":21}},"children":[{"type":"text","value":"Example ","key":"S6y0dC9pUU"},{"type":"text","value":"12.3.3","key":"RPkQs6McN8"}],"template":"Example %s","enumerator":"12.3.3","resolved":true,"html_id":"demo-absstab-inflow","remote":true,"url":"/absstab-advection","dataUrl":"/absstab-advection.json","key":"A6nyhZzFpY"}],"key":"HpaRZttxYx"},{"type":"paragraph","position":{"start":{"line":420,"column":1},"end":{"line":420,"column":1}},"children":[{"type":"text","value":"Deleting the last row and column places all the eigenvalues of the discretization into the left half of the complex plane.","position":{"start":{"line":420,"column":1},"end":{"line":420,"column":1}},"key":"jDpnFJxQQ8"}],"key":"SLIpSWqNcO"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[x, Dx, Dxx] = diffcheb(40, [0, 1]);\nA = -Dx(2:end, 2:end);    % leave out first row and column\nlambda = eig(A);","key":"DXw3JIo32B"},{"type":"output","id":"cbtRDpN38wj_Ws7tqbUkY","data":[],"key":"o1gFZ83w8G"}],"data":{},"key":"Gs4Vfclqjl"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf\nscatter(real(lambda), imag(lambda))\naxis equal,  grid on \ntitle('Eigenvalues of advection with zero inflow')","visibility":"hide","key":"IsuDfIpTln"},{"type":"output","id":"g05D4NEMno-ZiEnmGmEHi","data":[{"output_type":"execute_result","execution_count":30,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"a9cb8045bbbe011fe9ec3918f7ea9e29","path":"/build/a9cb8045bbbe011fe9ec3918f7ea9e29.png"}}}],"visibility":"show","key":"N1XZ0n75jP"}],"data":{"tags":[]},"visibility":"show","key":"ZsaQEkv40Y"},{"type":"paragraph","position":{"start":{"line":436,"column":1},"end":{"line":436,"column":1}},"children":[{"type":"text","value":"Note that the rightmost eigenvalues have real part at most","position":{"start":{"line":436,"column":1},"end":{"line":436,"column":1}},"key":"xCh3y42ZRN"}],"key":"mHB0u4pF87"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"max(real(lambda))","key":"mU4LB6TVhB"},{"type":"output","id":"gMslgx3HYTYRWZI8F-3O0","data":[{"output_type":"execute_result","execution_count":31,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = 10</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = 10","content_type":"text/plain"}}}],"key":"E7FLDUtMvc"}],"data":{},"key":"JNs3XgFQdL"},{"type":"paragraph","position":{"start":{"line":442,"column":1},"end":{"line":442,"column":1}},"children":[{"type":"text","value":"Consequently all solutions decay exponentially to zero as ","position":{"start":{"line":442,"column":1},"end":{"line":442,"column":1}},"key":"CqDCLCcbfZ"},{"type":"inlineMath","value":"t\\to\\infty","position":{"start":{"line":442,"column":1},"end":{"line":442,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi><mo>→</mo><mi mathvariant=\"normal\">∞</mi></mrow><annotation encoding=\"application/x-tex\">t\\to\\infty</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord\">∞</span></span></span></span>","key":"nG2kMaLzdp"},{"type":"text","value":". This matches our observation of the solution: eventually, everything flows out of the domain.","position":{"start":{"line":442,"column":1},"end":{"line":442,"column":1}},"key":"GkuwC2vS6p"}],"key":"Rmbk71hr4c"}],"label":"demo-absstab-inflow-matlab","identifier":"demo-absstab-inflow-matlab","html_id":"demo-absstab-inflow-matlab","key":"QYfcX8IeEZ"},{"type":"heading","depth":3,"position":{"start":{"line":446,"column":1},"end":{"line":446,"column":1}},"children":[{"type":"text","value":"12.4 ","position":{"start":{"line":446,"column":1},"end":{"line":446,"column":1}},"key":"wHA2S6edEq"},{"type":"link","identifier":"section-advection-wave","label":"section-advection-wave","kind":"narrative","position":{"start":{"line":446,"column":6},"end":{"line":446,"column":29}},"url":"/wave","internal":true,"dataUrl":"/wave.json","children":[{"type":"text","value":"The wave equation","key":"tVTIfNNaim"}],"key":"GQ09conN7j"}],"identifier":"id-12-4","label":"12.4 ","html_id":"id-12-4","implicit":true,"key":"vXiJD7fIne"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-wave-boundaries","label":"demo-wave-boundaries","kind":"proof:example","position":{"start":{"line":449,"column":1},"end":{"line":449,"column":22}},"children":[{"type":"text","value":"Example ","key":"PNTfe0Txmw"},{"type":"text","value":"12.4.1","key":"lMzT7SpcRH"}],"template":"Example %s","enumerator":"12.4.1","resolved":true,"html_id":"demo-wave-boundaries","remote":true,"url":"/wave","dataUrl":"/wave.json","key":"roCHdZej7T"}],"key":"S4q0Si1NF9"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"c = 2;  m = 200;\n[x, Dx] = diffcheb(m, [-1, 1]);","key":"inHYF0ud8b"},{"type":"output","id":"n4b3WBK_6YlmkNrpjr0fg","data":[],"key":"aJoVL4F33J"}],"data":{},"key":"i6mXOKeBK8"},{"type":"paragraph","position":{"start":{"line":457,"column":1},"end":{"line":457,"column":1}},"children":[{"type":"text","value":"The boundary values of ","position":{"start":{"line":457,"column":1},"end":{"line":457,"column":1}},"key":"pk9eNIKLeQ"},{"type":"inlineMath","value":"u","position":{"start":{"line":457,"column":1},"end":{"line":457,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span>","key":"IyIsPxYUpL"},{"type":"text","value":" are given to be zero, so they are not unknowns in the ","key":"pQVCC7OaBj"},{"type":"abbreviation","title":"ordinary differential equation","children":[{"type":"text","value":"ODE","key":"Dln70HiLFT"}],"key":"PfX92yZWE7"},{"type":"text","value":"s. Instead they are added or removed as necessary.","key":"I7PyAvXABU"}],"key":"swoAertTPp"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"chop = @(u) u(2:m);\nextend = @(v) [0; v; 0];","key":"OMgR8461wC"},{"type":"output","id":"v0M17nhrdwAx6S4h1_f7A","data":[],"key":"C2oBzhwIJu"}],"data":{},"key":"DkZHNf7zpM"},{"type":"paragraph","position":{"start":{"line":464,"column":1},"end":{"line":464,"column":1}},"children":[{"type":"text","value":"The following function computes the time derivative of the system at interior points.","position":{"start":{"line":464,"column":1},"end":{"line":464,"column":1}},"key":"wxgivMzZeS"}],"key":"eW5gqzPh3y"},{"type":"include","file":"f124wave.m","literal":true,"children":[{"type":"code","value":"function dw_dt = wave(t, w, param)\n    [c, m, Dx, chop, extend] = param{:};\n    u = extend(w(1:m-1));\n    z = w(m:2*m);\n    du_dt = Dx * z;\n    dz_dt = c.^2 .* (Dx * u);\n    dw_dt = [ chop(du_dt); dz_dt ];\nend","lang":"m","filename":"f124wave.m","key":"yt9NevFq8H"}],"key":"zJ7dWpQ8R7"},{"type":"paragraph","position":{"start":{"line":469,"column":1},"end":{"line":469,"column":1}},"children":[{"type":"text","value":"Our initial condition is a single hump for ","position":{"start":{"line":469,"column":1},"end":{"line":469,"column":1}},"key":"NPFknDYYOL"},{"type":"inlineMath","value":"u","position":{"start":{"line":469,"column":1},"end":{"line":469,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span>","key":"Dv5FIveeHP"},{"type":"text","value":".","position":{"start":{"line":469,"column":1},"end":{"line":469,"column":1}},"key":"CoCyHVr2m3"}],"key":"cdTkCoN4t6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"u_init = exp( -100*x.^2 );\nz_init = -u_init;\nw_init = [ chop(u_init); z_init ];","key":"ABUmAYtFHx"},{"type":"output","id":"csng0YLbISStZjUQxoGKv","data":[],"key":"p8BrTMTOKA"}],"data":{},"key":"BfHCQTTIrY"},{"type":"paragraph","position":{"start":{"line":477,"column":1},"end":{"line":477,"column":1}},"children":[{"type":"text","value":"Because the wave equation is hyperbolic, we can use a nonstiff explicit solver.","position":{"start":{"line":477,"column":1},"end":{"line":477,"column":1}},"key":"SIXY61LvCZ"}],"key":"nKQO7J03nz"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"ivp = ode(ODEFcn=@f124wave);\nivp.InitialTime = 0;\nivp.InitialValue = w_init;\nivp.RelativeTolerance = 1e-4;\nivp.Parameters = {c, m, Dx, chop, extend};\nt = linspace(0, 2, 101);\nsol = solve(ivp, t);","key":"wreEzdYCYX"},{"type":"output","id":"QrVZ6ov-T7K95ERFQj4c3","data":[{"output_type":"stream","name":"stderr","text":"Error using odearguments (line 98)\nF124WAVE returns a vector of length 12, but the length of initial conditions vector is 66. The vector returned by F124WAVE and the initial conditions vector must have the same number of elements.\n\nError in ode45 (line 104)\n    odearguments(odeIsFuncHandle,odeTreatAsMFile, solver_name, ode, tspan, y0, options, varargin);\n\nError in matlab.ode.internal.LegacySolver/solveAt (line 455)\n                    [t,y,stats] = obj.SolverFcn(args{:});\n\nError in matlab.ode.internal.LegacySolver/solve (line 119)\n                    [t,y] = obj.solveAt(t1);\n\nError in ode/solveAt (line 666)\n                    [tR,yR] = solver.solve(tspanRight); %#ok<ASGLU>\n\nError in ode/solve (line 331)\n                sol = obj.solveAt(t1);"}],"key":"VzcgdtikHC"}],"data":{},"key":"OVg3zMcTPj"},{"type":"paragraph","position":{"start":{"line":489,"column":1},"end":{"line":489,"column":1}},"children":[{"type":"text","value":"We plot the results for the original ","position":{"start":{"line":489,"column":1},"end":{"line":489,"column":1}},"key":"ejrNUH8gDk"},{"type":"inlineMath","value":"u","position":{"start":{"line":489,"column":1},"end":{"line":489,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span>","key":"ROY0QP71MV"},{"type":"text","value":" variable only. Its interior values are at indices ","position":{"start":{"line":489,"column":1},"end":{"line":489,"column":1}},"key":"w4o9KW4Xhh"},{"type":"inlineCode","value":"1:m-1","position":{"start":{"line":489,"column":1},"end":{"line":489,"column":1}},"key":"p0eV3ciXdV"},{"type":"text","value":" of the composite ","position":{"start":{"line":489,"column":1},"end":{"line":489,"column":1}},"key":"nxx20VPXAG"},{"type":"inlineMath","value":"\\mathbf{w}","position":{"start":{"line":489,"column":1},"end":{"line":489,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">w</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{w}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4444em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">w</span></span></span></span>","key":"VZ188dAJZu"},{"type":"text","value":" variable.","position":{"start":{"line":489,"column":1},"end":{"line":489,"column":1}},"key":"jKBO91btaA"}],"key":"Od4fuEGG8I"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"W = sol.Solution;\nn = length(t)-1;\nU = [ zeros(1, n+1); W(1:m-1, :); zeros(1, n+1) ];\n\ncmap = zeros(256, 3);\ncmap(129:end, 1) = 2/3;\ncmap(1:128, 2) = linspace(1, 0, 128);\ncmap(129:256, 2) = linspace(0, 1, 128);\ncmap(1:128, 3) = linspace(1, 0.5, 128);\ncmap(129:256, 3) = linspace(0.5, 1, 128);\ncmap = hsv2rgb(cmap);\n\nclf,  contour(x, t, U', 24, linewidth=2)\ncolormap(cmap),  clim([-1, 1])\nxlabel x,  ylabel t\ntitle(\"Wave equation with boundaries\")","key":"QZd5r2nJhD"},{"type":"output","id":"aAxpOulBQgBfbJZHpy5Bu","data":[{"output_type":"stream","name":"stderr","text":"Index in position 1 exceeds array bounds. Index must not exceed 1."}],"key":"wxJudD5oU7"}],"data":{},"key":"okkHniT0H6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf\nplot(x, U(:, 1))\nhold on\naxis([-1, 1, -1.05, 1.05])\ntitle(\"Wave equation with boundaries\") \nxlabel('x'),  ylabel('u(x,t)')\nvid = VideoWriter(\"figures/wave-boundaries.mp4\", \"MPEG-4\");\nvid.Quality = 85;\nopen(vid);\nfor frame = 1:length(t)\n    cla, plot(x, U(:, frame))\n    str = sprintf(\"t = %.2f\", t(frame));\n    text(-0.92, 0.85, str, fontsize=16);\n    writeVideo(vid, frame2im(getframe(gcf)));\nend\nclose(vid)","visibility":"hide","key":"T3w0Uh0vxK"},{"type":"output","id":"ES4ov1Y3z1c24ec-zPafm","data":[{"output_type":"stream","name":"stderr","text":"Input arguments to function include colon operator. To input the colon character, use ':' instead."}],"visibility":"remove","key":"yrswB0GWsI"}],"data":{"tags":[]},"visibility":"show","key":"MoNSrh51Ne"},{"type":"image","url":"/build/wave-boundaries-7da08ce5687e8710b7967913fbe0f513.mp4","alt":"Wave equation with boundaries","position":{"start":{"line":530,"column":1},"end":{"line":530,"column":1}},"key":"x7fTunLQCB","urlSource":"figures/wave-boundaries.mp4"},{"type":"paragraph","position":{"start":{"line":532,"column":1},"end":{"line":532,"column":1}},"children":[{"type":"text","value":"The original hump breaks into two pieces of different amplitudes, each traveling with speed ","position":{"start":{"line":532,"column":1},"end":{"line":532,"column":1}},"key":"aKSaX6lFsc"},{"type":"inlineMath","value":"c=2","position":{"start":{"line":532,"column":1},"end":{"line":532,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>c</mi><mo>=</mo><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">c=2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">c</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span></span></span></span>","key":"F5G2Z8qa9m"},{"type":"text","value":". They pass through one another without interference. When a hump encounters a boundary, it is perfectly reflected, but with inverted shape. At time ","position":{"start":{"line":532,"column":1},"end":{"line":532,"column":1}},"key":"vmgqFyAl6V"},{"type":"inlineMath","value":"t=2","position":{"start":{"line":532,"column":1},"end":{"line":532,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi><mo>=</mo><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">t=2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span></span></span></span>","key":"Iw9wn3coQ8"},{"type":"text","value":", the solution looks just like the initial condition.","position":{"start":{"line":532,"column":1},"end":{"line":532,"column":1}},"key":"IOy5Sk7QnR"}],"key":"B7TGi6UdBC"}],"label":"demo-wave-boundaries-matlab","identifier":"demo-wave-boundaries-matlab","html_id":"demo-wave-boundaries-matlab","key":"kQyhmEyDgf"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-wave-speed","label":"demo-wave-speed","kind":"proof:example","position":{"start":{"line":537,"column":1},"end":{"line":537,"column":17}},"children":[{"type":"text","value":"Example ","key":"InEnJZFYUZ"},{"type":"text","value":"12.4.2","key":"KKvwgomjb0"}],"template":"Example %s","enumerator":"12.4.2","resolved":true,"html_id":"demo-wave-speed","remote":true,"url":"/wave","dataUrl":"/wave.json","key":"VCifW1ZakY"}],"key":"ysJBpczeJa"},{"type":"paragraph","position":{"start":{"line":540,"column":1},"end":{"line":540,"column":1}},"children":[{"type":"text","value":"We now use a wave speed that is discontinuous at ","position":{"start":{"line":540,"column":1},"end":{"line":540,"column":1}},"key":"FdYPYAZ7To"},{"type":"inlineMath","value":"x=0","position":{"start":{"line":540,"column":1},"end":{"line":540,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">x=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"q6ahiU7SBE"},{"type":"text","value":".","position":{"start":{"line":540,"column":1},"end":{"line":540,"column":1}},"key":"QCUTIEofTU"}],"key":"pdgnV1LHZW"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"m = 120;\n[x, Dx] = diffcheb(m, [-1, 1]);\nc = 1 + (sign(x) + 1) / 2;\nchop = @(u) u(2:m);\nextend = @(v) [0; v; 0];\n\nu_init = exp( -100*(x + 0.5).^2 );\nz_init = -u_init;\nivp.InitialValue = [ chop(u_init); z_init ]; \nivp.Parameters = {c, m, Dx, chop, extend};\nsol = solve(ivp, t);\nW = sol.Solution;\nU = [ zeros(1, n+1); W(1:m-1, :); zeros(1, n+1) ];","key":"N6RwGt8jbT"},{"type":"output","id":"S5GYJwt4ONXkVStD_wmeX","data":[{"output_type":"stream","name":"stderr","text":"Error using ^ (line 52)\nIncorrect dimensions for raising a matrix to a power. Check that the matrix is square and the power is a scalar. To operate on each element of the matrix individually, use POWER (.^) for elementwise power.\n\nError in LiveEditorEvaluationHelperEeb0c052e-5793-4a7e-a209-577a074df658>@(t,u,p)u^2-u^3 (line 2)\nclf\n\nError in odearguments (line 93)\nf0 = ode(t0,y0,args{:});\n\nError in ode45 (line 104)\n    odearguments(odeIsFuncHandle,odeTreatAsMFile, solver_name, ode, tspan, y0, options, varargin);\n\nError in matlab.ode.internal.LegacySolver/solveAt (line 455)\n                    [t,y,stats] = obj.SolverFcn(args{:});\n\nError in matlab.ode.internal.LegacySolver/solve (line 119)\n                    [t,y] = obj.solveAt(t1);\n\nError in ode/solveAt (line 666)\n                    [tR,yR] = solver.solve(tspanRight); %#ok<ASGLU>\n\nError in ode/solve (line 331)\n                sol = obj.solveAt(t1);"}],"key":"DHDcHJlSRl"}],"data":{},"key":"yXhlGMallY"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf,  contour(x, t, U', 24, linewidth=2)\ncolormap(cmap),  clim([-1, 1])\nxlabel x,  ylabel t\ntitle(\"Wave equation with variable speed\")","key":"hjnich8VoO"},{"type":"output","id":"v7rrL8_8G0zGsj-nIfeLi","data":[{"output_type":"stream","name":"stderr","text":"Failed to execute. Operation may have interrupted by user."}],"key":"jFN4RRtGbu"}],"data":{},"key":"kex5Qmfp4P"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf\nplot(x, U(:, 1))\nhold on\naxis([-1, 1, -1.05, 1.05])\ntitle(\"Wave equation with variable speed\") \nxlabel('x'),  ylabel('u(x,t)')\nvid = VideoWriter(\"figures/wave-speed.mp4\", \"MPEG-4\");\nvid.Quality = 85;\nopen(vid);\nfor frame = 1:length(t)\n    cla, plot(x, U(:, frame))\n    str = sprintf(\"t = %.2f\", t(frame));\n    text(-0.92, 0.85, str, fontsize=16);\n    writeVideo(vid, frame2im(getframe(gcf)));\nend\nclose(vid)","visibility":"hide","key":"D9yvrZ7iT6"},{"type":"output","id":"1XPnadGE2pY6RE20BaINu","data":[{"output_type":"stream","name":"stderr","text":"Error using plot\nSpecify the coordinates as vectors or matrices of the same size, or as a vector and a matrix that share the same length in at least one dimension."}],"visibility":"remove","key":"M4YIp1sKaK"}],"data":{"tags":[]},"visibility":"show","key":"s9jn3CVRwv"},{"type":"image","url":"/build/wave-speed-96500827c309e2cc5a02abcb67446e80.mp4","alt":"Wave equation with variable speed","position":{"start":{"line":585,"column":1},"end":{"line":585,"column":1}},"key":"ghCaFOzH2w","urlSource":"figures/wave-speed.mp4"},{"type":"paragraph","position":{"start":{"line":587,"column":1},"end":{"line":587,"column":1}},"children":[{"type":"text","value":"Each pass through the interface at ","position":{"start":{"line":587,"column":1},"end":{"line":587,"column":1}},"key":"hwLkC0XoMP"},{"type":"inlineMath","value":"x=0","position":{"start":{"line":587,"column":1},"end":{"line":587,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">x=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"SvaDg82Qmm"},{"type":"text","value":" generates a reflected and transmitted wave. By conservation of energy, these are both smaller in amplitude than the incoming bump.","position":{"start":{"line":587,"column":1},"end":{"line":587,"column":1}},"key":"CRAZLXj633"}],"key":"IFfQLRPwns"}],"label":"demo-wave-speed-matlab","identifier":"demo-wave-speed-matlab","html_id":"demo-wave-speed-matlab","key":"hRcfaaGKqx"}],"key":"ZpwCRbpr4p"}],"key":"Zhqbq8wDqo"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Chapter 11","url":"/chapter11-1","group":"MATLAB codes"},"next":{"title":"Chapter 13","url":"/chapter13-1","group":"MATLAB codes"}}},"domain":"http://localhost:3000"}