{"kind":"Notebook","sha256":"7c595708b41e4ca9e9f0ef0a3ce4fe680889efbf4e164e7685c91d9f839f6e96","slug":"chapter12-1","location":"/matlab/chapter12.md","dependencies":[],"frontmatter":{"title":"Chapter 12","numbering":{"heading_1":{"enabled":false},"heading_2":{"enabled":false},"heading_3":{"enabled":false},"heading_4":{"enabled":false},"heading_5":{"enabled":false},"heading_6":{"enabled":false}},"kernelspec":{"name":"jupyter_matlab_kernel","display_name":"MATLAB","language":"matlab"},"content_includes_title":false,"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"exports":[{"format":"md","filename":"chapter12.md","url":"/fnc/build/chapter12-487b7f646b60ca6c7bc0d7558d640b96.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Examples","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"ADfVMZ01yK"}],"identifier":"examples","label":"Examples","html_id":"examples","implicit":true,"key":"GeFs4oS4OS"}],"key":"Ikfk8xLR6m"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"cd  /Users/driscoll/Dropbox/Mac/Documents/GitHub/fnc/matlab\nFNC_init","visibility":"show","key":"zB50VcUGzr"},{"type":"output","id":"ftK-Zc5kTUcz8dQGN9J14","data":[{"output_type":"stream","name":"stdout","text":"Executing ..."},{"output_type":"execute_result","execution_count":1,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = \n  Figure (1) with properties:\n\n      Number: 1\n        Name: ''\n       Color: [1 1 1]\n    Position: [1224 1070 560 420]\n       Units: 'pixels'\n\n  Use GET to show all properties\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = \n  Figure (1) with properties:\n\n      Number: 1\n        Name: ''\n       Color: [1 1 1]\n    Position: [1224 1070 560 420]\n       Units: 'pixels'\n\n  Use GET to show all properties\n","content_type":"text/plain"}}}],"visibility":"show","key":"bAsbcYJvlK"}],"data":{"tags":[]},"visibility":"remove","key":"yAEX7TARr9"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"12.1 ","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"bXGxMlbI1W"},{"type":"link","identifier":"section-advection-traffic","label":"section-advection-traffic","kind":"narrative","position":{"start":{"line":19,"column":6},"end":{"line":19,"column":32}},"url":"/traffic","internal":true,"dataUrl":"/traffic.json","children":[{"type":"text","value":"Traffic flow","key":"rjdUhcCT2S"}],"key":"Cx0iEhjZUs"}],"identifier":"id-12-1","label":"12.1 ","html_id":"id-12-1","implicit":true,"key":"umKlRfInMI"},{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-traffic-advection","label":"demo-traffic-advection","kind":"proof:example","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":24}},"children":[{"type":"text","value":"Example ","key":"N6LCK2C5nD"},{"type":"text","value":"12.1.1","key":"saM2FwXcD4"}],"template":"Example %s","enumerator":"12.1.1","resolved":true,"html_id":"demo-traffic-advection","remote":true,"url":"/traffic","dataUrl":"/traffic.json","key":"DvcGZ61vxU"}],"key":"GyqR2T8lys"},{"type":"paragraph","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"In the following definition we allow the velocity ","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"a2iA9ZH7Mx"},{"type":"inlineMath","value":"c","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>c</mi></mrow><annotation encoding=\"application/x-tex\">c</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">c</span></span></span></span>","key":"BNNkGEMNRb"},{"type":"text","value":" to be specified as a parameter.","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"s1eGGRJHh2"}],"key":"BHAUSFhpwa"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[x, Dx, Dxx] = diffper(300, [-4, 4]);\nf = @(t, u, c) -c * (Dx*u);\nivp = ode(ODEFcn=f);\nivp.Parameters = 2;\nivp.InitialTime = 0;\nivp.RelativeTolerance = 1e-5;","key":"H9AKcA1HEz"},{"type":"output","id":"0e7FQ90j1qPAIFa56aeJk","data":[],"key":"yuPsTLnrfe"}],"data":{},"key":"gPzbcflxKT"},{"type":"paragraph","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"children":[{"type":"text","value":"The following initial condition isn’t mathematically periodic, but the deviation is less than machine precision. We specify RK4 as the solver.","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"tgxEGsJPLW"}],"key":"ZQpjVOurK8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"u_init = 1 + exp(-3*x.^2);\nivp.InitialValue = u_init;\nt = linspace(0, 3, 201);\nsol = solve(ivp, t);\nU = sol.Solution;","key":"tZs8bnZu4V"},{"type":"output","id":"KXyckIPIGu3oEXeXRf9V5","data":[],"key":"bw6f7tzijE"}],"data":{},"key":"efTrEqowuC"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"waterfall(x, t(1:5:end), U(:, 1:5:end)')\nview(-13, 65)\nxlabel('x'), ylabel('t'), zlabel('u(x,t)')\ntitle('Advection equation')","visibility":"hide","key":"Dc4mIwAgqR"},{"type":"output","id":"Tvd5fmDxqqA2tSUsfO6pM","data":[{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"51146abcf386ebabffc182286db13d81","path":"/fnc/build/51146abcf386ebabffc182286db13d81.png"}}}],"visibility":"show","key":"J6Eq3cMN8T"}],"data":{"tags":[]},"visibility":"show","key":"R1RVFtcer7"},{"type":"paragraph","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"children":[{"type":"text","value":"An animation shows the solution nicely. The bump moves with speed 2 to the right, reentering on the left as it exits to the right because of the periodic conditions.","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"PyhV6o1Sro"}],"key":"Epulqsd3dO"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf\nplot(x, U(:, 1))\nhold on,  grid on\naxis([-4, 4, 0.9, 2.1])\ntitle('Advection equation with periodic boundary') \nxlabel('x'),  ylabel('u(x,t)')\nvid = VideoWriter(\"figures/advection-periodic.mp4\",\"MPEG-4\");\nvid.Quality = 85;\nopen(vid);\nfor frame = 1:length(t)\n    cla, plot(x, U(:, frame))\n    str = sprintf(\"t = %.2f\", t(frame));\n    text(-3.5, 1.9, str);\n    writeVideo(vid, frame2im(getframe(gcf)));\nend\nclose(vid)\nclose(gcf)","visibility":"hide","key":"mZm8dHwzLq"},{"type":"output","id":"A2Bg6Z3Nn0gx_zFttIW_2","data":[{"output_type":"execute_result","execution_count":5,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"68d45f53129d880fa80cc0761d27b73a","path":"/fnc/build/68d45f53129d880fa80cc0761d27b73a.png"}}}],"visibility":"show","key":"Kg6eewdtsp"}],"data":{"tags":[]},"visibility":"show","key":"Jmi9udTtbs"},{"type":"image","url":"/fnc/build/advection-periodic-6c6c0ee2c43a26d40359face23b29904.mp4","alt":"Advection equation with periodic boundary","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"key":"UdlFIKCp27","urlSource":"figures/advection-periodic.mp4"}],"label":"demo-traffic-advection-matlab","identifier":"demo-traffic-advection-matlab","html_id":"demo-traffic-advection-matlab","key":"FLrMD0dZCp"}],"key":"XLsO4v6OWt"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"FNC_init","visibility":"show","key":"lGTjgQvf7f"},{"type":"output","id":"j9nbLZeAy9uSSEH6DAmM_","data":[{"output_type":"execute_result","execution_count":6,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = \n  Figure (1) with properties:\n\n      Number: 1\n        Name: ''\n       Color: [1 1 1]\n    Position: [1224 1070 560 420]\n       Units: 'pixels'\n\n  Use GET to show all properties\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = \n  Figure (1) with properties:\n\n      Number: 1\n        Name: ''\n       Color: [1 1 1]\n    Position: [1224 1070 560 420]\n       Units: 'pixels'\n\n  Use GET to show all properties\n","content_type":"text/plain"}}}],"visibility":"show","key":"Aluj1A5HvR"}],"data":{"tags":[]},"visibility":"remove","key":"eJQ0YYV0YS"},{"type":"block","children":[{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-traffic-solve","label":"demo-traffic-solve","kind":"proof:example","position":{"start":{"line":86,"column":1},"end":{"line":86,"column":20}},"children":[{"type":"text","value":"Example ","key":"XmHH8sWrOF"},{"type":"text","value":"12.1.2","key":"PS6LRzPEgK"}],"template":"Example %s","enumerator":"12.1.2","resolved":true,"html_id":"demo-traffic-solve","remote":true,"url":"/traffic","dataUrl":"/traffic.json","key":"gnxzcsPDzt"}],"key":"oNRNqB4MfR"},{"type":"paragraph","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"children":[{"type":"text","value":"The following are parameters and a function relevant to defining the problem.","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"dz0ssb2lqj"}],"key":"kJ2KpiyDN0"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"rho_c = 1080;  rho_m = 380;  q_m = 10000;\nQ0prime = @(rho) 4*q_m*rho_c^2 * (rho_c - rho_m) * rho_m ...\n    *(rho_m - rho) ./ ((rho_c - 2*rho_m) * rho + rho_c * rho_m).^3;\nep = 0.02;","key":"ZHOhE9Enbe"},{"type":"output","id":"MU6khYsTcBDOBGt701jt2","data":[],"key":"q3J0lvknTJ"}],"data":{},"key":"SrMznzEEOI"},{"type":"paragraph","position":{"start":{"line":96,"column":1},"end":{"line":96,"column":1}},"children":[{"type":"text","value":"Here we create a discretization on ","position":{"start":{"line":96,"column":1},"end":{"line":96,"column":1}},"key":"ccaW6TpL18"},{"type":"inlineMath","value":"m=800","position":{"start":{"line":96,"column":1},"end":{"line":96,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi><mo>=</mo><mn>800</mn></mrow><annotation encoding=\"application/x-tex\">m=800</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">800</span></span></span></span>","key":"ea5sxbPD4M"},{"type":"text","value":" points.","position":{"start":{"line":96,"column":1},"end":{"line":96,"column":1}},"key":"VFalbfeZ8u"}],"key":"nDpKMz6esx"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[x, Dx, Dxx] = diffper(800, [0, 4]);","key":"aO1zTIg1DE"},{"type":"output","id":"XNElSmhPc7iv0TfUKq-ay","data":[],"key":"tdkd4VqySp"}],"data":{},"key":"Cucq9QokLn"},{"type":"paragraph","position":{"start":{"line":102,"column":1},"end":{"line":102,"column":1}},"children":[{"type":"text","value":"Next we define the ","key":"yYqFjCY8s6"},{"type":"abbreviation","title":"ordinary differential equation","children":[{"type":"text","value":"ODE","key":"kqWpoFmtsT"}],"key":"no62I88eMl"},{"type":"text","value":" resulting from the method of lines.","key":"YGLKHhXrrx"}],"key":"X0F8wn5p63"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"odefun = @(t, rho) -Q0prime(rho) .* (Dx*rho) + ep * (Dxx*rho);\nivp = ode(ODEFcn=odefun);\nivp.InitialTime = 0;\nivp.RelativeTolerance = 1e-5;","key":"HAZWQ9S6un"},{"type":"output","id":"39wkgoC57nzVDWPE1wzH0","data":[],"key":"t1FCw6so7B"}],"data":{},"key":"EZfbCe449j"},{"type":"paragraph","position":{"start":{"line":111,"column":1},"end":{"line":111,"column":1}},"children":[{"type":"text","value":"Our first initial condition has moderate density with a small bump. Because of the diffusion present, we use a stiff solver for the ","key":"Xqs0e62JF6"},{"type":"abbreviation","title":"initial-value problem","children":[{"type":"text","value":"IVP","key":"sRQFCRv67f"}],"key":"CVJ3LnhdJ1"},{"type":"text","value":".","key":"tZUINMgHfi"}],"key":"WNntdAvhOy"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"rho_init = 400 + 10 * exp(-20*(x-3).^2);\nivp.InitialValue = rho_init;\n\nt = linspace(0, 1, 101);\nsol = solve(ivp, t);\nRHO = sol.Solution;","key":"y3jnGG0dS6"},{"type":"output","id":"mllXtkTxdKsdixuiBAVpf","data":[],"key":"D3wJphuSgO"}],"data":{},"key":"sFxmmtQw1z"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf\nfor plot_idx = 1:20:101\n    str = sprintf(\"t = %.2f\", t(plot_idx));\n    plot(x, RHO(:, plot_idx), displayname=str)\n    hold on\nend\nxlabel('x'),  ylabel('car density')\ntitle('Traffic flow') \nlegend(location=\"northwest\")","visibility":"hide","key":"LGzQO2o3EV"},{"type":"output","id":"piacv2GH-O7wuuitAPkSu","data":[{"output_type":"execute_result","execution_count":11,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"e56676f3f400f6a1cb9eb3d3cc84f8b2","path":"/fnc/build/e56676f3f400f6a1cb9eb3d3cc84f8b2.png"}}}],"visibility":"show","key":"UbDCLbSb3n"}],"data":{"tags":[]},"visibility":"show","key":"aCIMnTsX5P"},{"type":"paragraph","position":{"start":{"line":135,"column":1},"end":{"line":135,"column":1}},"children":[{"type":"text","value":"The bump slowly moves backward on the roadway, spreading out and gradually fading away due to the presence of diffusion.","position":{"start":{"line":135,"column":1},"end":{"line":135,"column":1}},"key":"jvCGYkFKYh"}],"key":"fn8zKBLPbi"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf\nplot(x, RHO(:, 1))\nhold on,  grid on\naxis([0, 4, 398, 410])\ntitle('Traffic flow') \nxlabel('x'),  ylabel('u(x,t)')\nvid = VideoWriter(\"figures/traffic-small.mp4\",\"MPEG-4\");\nvid.Quality = 85;\nopen(vid);\nfor frame = 1:length(t)\n    cla, plot(x, RHO(:, frame))\n    str = sprintf(\"t = %.2f\", t(frame));\n    text(0.2, 409, str);\n    writeVideo(vid, frame2im(getframe(gcf)));\nend\nclose(vid)\nclose(gcf)","visibility":"hide","key":"EOh86gAfK6"},{"type":"output","id":"jskXjcYp-QE1kFm9H9Qux","data":[{"output_type":"execute_result","execution_count":12,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"c742ab68fc545338f1b064f227d67fad","path":"/fnc/build/c742ab68fc545338f1b064f227d67fad.png"}}}],"visibility":"show","key":"DtB7dxKTS7"}],"data":{"tags":[]},"visibility":"show","key":"o1xuuzASIz"},{"type":"image","url":"/fnc/build/traffic-small-2521f35478e202997c5fc1a8efbdafe1.mp4","alt":"Traffic flow","position":{"start":{"line":158,"column":1},"end":{"line":158,"column":1}},"key":"yeGnFiQNOV","urlSource":"figures/traffic-small.mp4"},{"type":"paragraph","position":{"start":{"line":160,"column":1},"end":{"line":160,"column":1}},"children":[{"type":"text","value":"Now we use an initial condition with a larger bump. Note that the scale on the ","position":{"start":{"line":160,"column":1},"end":{"line":160,"column":1}},"key":"zKYOqUt2YD"},{"type":"inlineMath","value":"y","position":{"start":{"line":160,"column":1},"end":{"line":160,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>","key":"DraCIm9aX5"},{"type":"text","value":"-axis is much different for this solution.","position":{"start":{"line":160,"column":1},"end":{"line":160,"column":1}},"key":"hB4Uom98iP"}],"key":"qaXzcQPW8o"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"rho_init = 400 + 80 * exp( -16*(x - 3).^2 );\nivp.InitialValue = rho_init;\nt = linspace(0, 0.5, 81);\nsol = solve(ivp, t);\nRHO = sol.Solution;","key":"V8TNVDjBQe"},{"type":"output","id":"L5DflvODKg0DLw57gbuGO","data":[],"key":"Mfzt3K9lGA"}],"data":{},"key":"S1g0Pxi8Ef"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"FNC_init    % open new figure\nfor plot_idx = 1:16:81\n    str = sprintf(\"t = %.2f\", t(plot_idx));\n    plot(x, RHO(:, plot_idx), displayname=str)\n    hold on\nend\nxlabel('x'),  ylabel('car density')\ntitle('Traffic jam') \nlegend(location=\"northwest\")","visibility":"hide","key":"hDj18vI5pd"},{"type":"output","id":"kYppsCPuOEAwPJQbmssX3","data":[{"output_type":"execute_result","execution_count":14,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"85779bb467f65f6fd9eadd1114ab093a","path":"/fnc/build/85779bb467f65f6fd9eadd1114ab093a.png"}}},{"output_type":"execute_result","execution_count":14,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = \n  Figure (1) with properties:\n\n      Number: 1\n        Name: ''\n       Color: [1 1 1]\n    Position: [1224 1070 560 420]\n       Units: 'pixels'\n\n  Use GET to show all properties\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = \n  Figure (1) with properties:\n\n      Number: 1\n        Name: ''\n       Color: [1 1 1]\n    Position: [1224 1070 560 420]\n       Units: 'pixels'\n\n  Use GET to show all properties\n","content_type":"text/plain"}}}],"visibility":"show","key":"Xwuw9016xD"}],"data":{"tags":[]},"visibility":"show","key":"SR3Dtpqhof"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf\nplot(x, RHO(:, 1))\nhold on,  grid on\naxis([0, 4, 395, 480])\ntitle('Traffic jam') \nxlabel('x'),  ylabel('u(x,t)')\nvid = VideoWriter(\"figures/traffic-jam.mp4\", \"MPEG-4\");\nvid.Quality = 85;\nopen(vid);\nfor frame = 1:length(t)\n    cla, plot(x, RHO(:, frame))\n    str = sprintf(\"t = %.2f\", t(frame));\n    text(0.2, 470, str);\n    writeVideo(vid, frame2im(getframe(gcf)));\nend\nclose(vid)\nclose(gcf)","visibility":"hide","key":"QbDzl3IwPH"},{"type":"output","id":"L4_CQkJBUWkSRVYHKMice","data":[{"output_type":"execute_result","execution_count":15,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"9cda3caef4525541182fbdc7e98bf98e","path":"/fnc/build/9cda3caef4525541182fbdc7e98bf98e.png"}}}],"visibility":"show","key":"StULwn6kai"}],"data":{"tags":[]},"visibility":"show","key":"rq8ZhFzv28"},{"type":"image","url":"/fnc/build/traffic-jam-cbfed5c5fbe863e2909464de8851b271.mp4","alt":"Traffic jam","position":{"start":{"line":204,"column":1},"end":{"line":204,"column":1}},"key":"rhGvbG0C5e","urlSource":"figures/traffic-jam.mp4"},{"type":"paragraph","position":{"start":{"line":206,"column":1},"end":{"line":206,"column":1}},"children":[{"type":"text","value":"In this case the density bump travels backward along the road. It also steepens on the side facing the incoming traffic and decreases much more slowly on the other side. A motorist would experience this as an abrupt increase in density, followed by a much more gradual decrease in density and resulting gradual increase in speed. (You also see some transient, high-frequency oscillations. These are caused by instabilities, as we discuss in simpler situations later in this chapter.)","position":{"start":{"line":206,"column":1},"end":{"line":206,"column":1}},"key":"YfTovi3JA9"}],"key":"GpUU2UY28t"}],"label":"demo-traffic-solve-matlab","identifier":"demo-traffic-solve-matlab","html_id":"demo-traffic-solve-matlab","key":"iFrR5YPU6s"}],"key":"yOJUyym69Z"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"FNC_init","visibility":"show","key":"IdQTj22QXC"},{"type":"output","id":"fczyj6tGPjfcUGtMANIwp","data":[{"output_type":"execute_result","execution_count":16,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = \n  Figure (1) with properties:\n\n      Number: 1\n        Name: ''\n       Color: [1 1 1]\n    Position: [1224 1070 560 420]\n       Units: 'pixels'\n\n  Use GET to show all properties\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = \n  Figure (1) with properties:\n\n      Number: 1\n        Name: ''\n       Color: [1 1 1]\n    Position: [1224 1070 560 420]\n       Units: 'pixels'\n\n  Use GET to show all properties\n","content_type":"text/plain"}}}],"visibility":"show","key":"qUTecJYt3W"}],"data":{"tags":[]},"visibility":"remove","key":"lW48pEDnfH"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":215,"column":1},"end":{"line":215,"column":1}},"children":[{"type":"text","value":"12.2 ","position":{"start":{"line":215,"column":1},"end":{"line":215,"column":1}},"key":"si7PUeekav"},{"type":"link","identifier":"section-advection-upwind","label":"section-advection-upwind","kind":"narrative","position":{"start":{"line":215,"column":6},"end":{"line":215,"column":31}},"url":"/upwind","internal":true,"dataUrl":"/upwind.json","children":[{"type":"text","value":"Upwinding and stability","key":"diPVVWcJKZ"}],"key":"WhGTT4cJQ3"}],"identifier":"id-12-2","label":"12.2 ","html_id":"id-12-2","implicit":true,"key":"ALcSszbuV9"},{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-upwind-cfl","label":"demo-upwind-cfl","kind":"proof:example","position":{"start":{"line":217,"column":1},"end":{"line":217,"column":17}},"children":[{"type":"text","value":"Example ","key":"GRSjD4RJ2L"},{"type":"text","value":"12.2.3","key":"h0DTHIu1WL"}],"template":"Example %s","enumerator":"12.2.3","resolved":true,"html_id":"demo-upwind-cfl","remote":true,"url":"/upwind","dataUrl":"/upwind.json","key":"xN8dweR9Sv"}],"key":"Ue810iu4Dz"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[x, Dx] = diffper(400, [0, 1]);\nc = 2;  \nivp = ode(ODEFcn = @(t, u) -c * (Dx*u));\nivp.RelativeTolerance = 1e-5;\nivp.InitialTime = 0;\nu_init = exp( -80*(x - 0.5).^2 );\nivp.InitialValue = u_init;\n\n[u, sol] = solutionFcn(ivp, 0, 2);","key":"HTztdbgtYk"},{"type":"output","id":"i4J6HNOo2AJ2krUh66xl8","data":[],"key":"my1zEz7WoR"}],"data":{},"key":"rDCAzM7kJl"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf\nt = linspace(0, 2, 81);\ncontour(x, t, u(t)', 12)\nxlabel('x'),  ylabel('t')\ntitle('Linear advection')","visibility":"hide","key":"UMcKXjCDSf"},{"type":"output","id":"BFnXYox03c2iI-O0HREzK","data":[{"output_type":"execute_result","execution_count":18,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"26d8fc8462545605cb0e6661cdc61123","path":"/fnc/build/26d8fc8462545605cb0e6661cdc61123.png"}}}],"visibility":"show","key":"mUlJpiTzPA"}],"data":{"tags":[]},"visibility":"show","key":"d2P7UOabO0"},{"type":"paragraph","position":{"start":{"line":240,"column":1},"end":{"line":240,"column":1}},"children":[{"type":"text","value":"In the space-time plot above, you can see the initial hump traveling rightward at constant speed. It fully traverses the domain once for each integer multiple of ","position":{"start":{"line":240,"column":1},"end":{"line":240,"column":1}},"key":"Pd8E4e9JvM"},{"type":"inlineMath","value":"t=1/2","position":{"start":{"line":240,"column":1},"end":{"line":240,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi><mo>=</mo><mn>1</mn><mi mathvariant=\"normal\">/</mi><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">t=1/2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1/2</span></span></span></span>","key":"nbvdOMgab9"},{"type":"text","value":".","position":{"start":{"line":240,"column":1},"end":{"line":240,"column":1}},"key":"av5ulUrhZQ"}],"key":"aVSgBjgzLv"},{"type":"paragraph","position":{"start":{"line":242,"column":1},"end":{"line":242,"column":1}},"children":[{"type":"text","value":"If we cut ","position":{"start":{"line":242,"column":1},"end":{"line":242,"column":1}},"key":"HQcaIgv7j0"},{"type":"inlineMath","value":"h","position":{"start":{"line":242,"column":1},"end":{"line":242,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>h</mi></mrow><annotation encoding=\"application/x-tex\">h</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">h</span></span></span></span>","key":"VhgIPxSlGw"},{"type":"text","value":" by a factor of 2 (i.e., double ","position":{"start":{"line":242,"column":1},"end":{"line":242,"column":1}},"key":"eFugQu05Fw"},{"type":"inlineMath","value":"m","position":{"start":{"line":242,"column":1},"end":{"line":242,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi></mrow><annotation encoding=\"application/x-tex\">m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">m</span></span></span></span>","key":"zykt0xgVv3"},{"type":"text","value":"), then the CFL condition suggests that the time step should be cut by a factor of 2 also.","position":{"start":{"line":242,"column":1},"end":{"line":242,"column":1}},"key":"O0PPW4LTiB"}],"key":"PfxIaiQzXN"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"num_steps_400 = length(sol.Time) - 1\n\n[x, Dx] = diffper(800, [0, 1]);\nivp.ODEFcn = @(t, u) -c * (Dx*u);\nivp.InitialValue = exp( -80*(x - 0.5).^2 );\n[u, sol] = solutionFcn(ivp, 0, 2);\n\nnum_steps_800 = length(sol.Time) - 1\nratio = num_steps_800 / num_steps_400","key":"UcVlEFEbDm"},{"type":"output","id":"DhyAR7jjeQQvrLR_48Sna","data":[{"output_type":"execute_result","execution_count":19,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>num_steps_400 = 1139</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"num_steps_400 = 1139","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":19,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>num_steps_800 = 2489</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"num_steps_800 = 2489","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":19,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ratio = 2.1853</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ratio = 2.1853","content_type":"text/plain"}}}],"key":"bUANlNVvkE"}],"data":{},"key":"lZVVSwkwGc"}],"label":"demo-upwind-cfl-matlab","identifier":"demo-upwind-cfl-matlab","html_id":"demo-upwind-cfl-matlab","key":"k9UiLhcz2E"},{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-upwind-direction","label":"demo-upwind-direction","kind":"proof:example","position":{"start":{"line":258,"column":1},"end":{"line":258,"column":23}},"children":[{"type":"text","value":"Example ","key":"bj7lrge1Uw"},{"type":"text","value":"12.2.6","key":"T5S4hLLDvX"}],"template":"Example %s","enumerator":"12.2.6","resolved":true,"html_id":"demo-upwind-direction","remote":true,"url":"/upwind","dataUrl":"/upwind.json","key":"OWYQOF5ImR"}],"key":"OQA0RbkZal"},{"type":"paragraph","position":{"start":{"line":259,"column":1},"end":{"line":259,"column":1}},"children":[{"type":"text","value":"If we solve advection over ","position":{"start":{"line":259,"column":1},"end":{"line":259,"column":1}},"key":"bRtGTbh7gm"},{"type":"inlineMath","value":"[0,1]","position":{"start":{"line":259,"column":1},"end":{"line":259,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mn>0</mn><mo separator=\"true\">,</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[0,1]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]</span></span></span></span>","key":"eXRV2Im94n"},{"type":"text","value":" with velocity ","position":{"start":{"line":259,"column":1},"end":{"line":259,"column":1}},"key":"u4ClDycr6J"},{"type":"inlineMath","value":"c=-1","position":{"start":{"line":259,"column":1},"end":{"line":259,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>c</mi><mo>=</mo><mo>−</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">c=-1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">c</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">−</span><span class=\"mord\">1</span></span></span></span>","key":"i9cwiLgaDl"},{"type":"text","value":", the right boundary is in the upwind/inflow direction. Thus a well-posed boundary condition is ","position":{"start":{"line":259,"column":1},"end":{"line":259,"column":1}},"key":"kV5Z0pmCUV"},{"type":"inlineMath","value":"u(1,t)=0","position":{"start":{"line":259,"column":1},"end":{"line":259,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo stretchy=\"false\">(</mo><mn>1</mn><mo separator=\"true\">,</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">u(1,t)=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"QmH18w0VmE"},{"type":"text","value":".","position":{"start":{"line":259,"column":1},"end":{"line":259,"column":1}},"key":"rVtioa5PJb"}],"key":"eOGz0KmpzX"},{"type":"paragraph","position":{"start":{"line":261,"column":1},"end":{"line":261,"column":1}},"children":[{"type":"text","value":"We’ll pattern a solution after ","position":{"start":{"line":261,"column":1},"end":{"line":261,"column":1}},"key":"pxT6HLwqFA"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-parabolic","label":"function-parabolic","children":[{"type":"text","value":"Function ","key":"rZJlXjAtPZ"},{"type":"text","value":"11.5.2","key":"Tgr3CPbkxa"}],"template":"Algorithm %s","enumerator":"11.5.2","resolved":true,"html_id":"function-parabolic","remote":true,"url":"/boundaries","dataUrl":"/boundaries.json","key":"FyL6Vdti2A"},{"type":"text","value":". Since ","position":{"start":{"line":261,"column":1},"end":{"line":261,"column":1}},"key":"AFS9cexsgU"},{"type":"inlineMath","value":"u(x_m,t)=0","position":{"start":{"line":261,"column":1},"end":{"line":261,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>m</mi></msub><mo separator=\"true\">,</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">u(x_m,t)=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"FkKiQjd81j"},{"type":"text","value":", we define the ","key":"Bb6Ds3EmpR"},{"type":"abbreviation","title":"ordinary differential equation","children":[{"type":"text","value":"ODE","key":"uOA6SucXb3"}],"key":"nsqcSKCaK6"},{"type":"text","value":" interior problem ","key":"Ds8qkvuIgX"},{"type":"crossReference","kind":"equation","identifier":"mol-interior","label":"mol-interior","children":[{"type":"text","value":"(","key":"rYEJPXKAuf"},{"type":"text","value":"11.5.4","key":"cR1RNuWvSV"},{"type":"text","value":")","key":"uo2cygPluj"}],"template":"(%s)","enumerator":"11.5.4","resolved":true,"html_id":"mol-interior","remote":true,"url":"/boundaries","dataUrl":"/boundaries.json","key":"CJ5ZMFNFOA"},{"type":"text","value":" for ","position":{"start":{"line":261,"column":1},"end":{"line":261,"column":1}},"key":"XakQZRW1jV"},{"type":"inlineMath","value":"\\mathbf{v}","position":{"start":{"line":261,"column":1},"end":{"line":261,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">v</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{v}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4444em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">v</span></span></span></span>","key":"lG4cHfaRYd"},{"type":"text","value":" without ","position":{"start":{"line":261,"column":1},"end":{"line":261,"column":1}},"key":"RRTbBlOaUK"},{"type":"inlineMath","value":"u_m","position":{"start":{"line":261,"column":1},"end":{"line":261,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>u</mi><mi>m</mi></msub></mrow><annotation encoding=\"application/x-tex\">u_m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"X2atJJ13ko"},{"type":"text","value":". For each evaluation of ","position":{"start":{"line":261,"column":1},"end":{"line":261,"column":1}},"key":"qaIO8NcNXx"},{"type":"inlineMath","value":"\\mathbf{v}'","position":{"start":{"line":261,"column":1},"end":{"line":261,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi mathvariant=\"bold\">v</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup></mrow><annotation encoding=\"application/x-tex\">\\mathbf{v}&#x27;</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span></span></span></span>","key":"ye0cc3iUQf"},{"type":"text","value":", we must extend the data back to ","position":{"start":{"line":261,"column":1},"end":{"line":261,"column":1}},"key":"D8L3p2MhlL"},{"type":"inlineMath","value":"x_m","position":{"start":{"line":261,"column":1},"end":{"line":261,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mi>m</mi></msub></mrow><annotation encoding=\"application/x-tex\">x_m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"gEE2TqcUx6"},{"type":"text","value":" first.","position":{"start":{"line":261,"column":1},"end":{"line":261,"column":1}},"key":"e004UnMVbB"}],"key":"HiGn42Q64H"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"m = 100;  c = -1;\n[x, Dx] = diffmat2(m, [0, 1]);\nchop = @(u) u(1:m);  \nextend = @(v) [v; 0];\nodefun = @(t, v) -c * chop( Dx * extend(v) );\nivp = ode(ODEFcn = odefun);\nivp.RelativeTolerance = 1e-5;\nivp.InitialTime = 0;","key":"dAxaiXqZZb"},{"type":"output","id":"oR3MTej4TI3dA2-l3KvlZ","data":[],"key":"MVUHoIEq9v"}],"data":{},"key":"l0NcmBktqB"},{"type":"paragraph","position":{"start":{"line":274,"column":1},"end":{"line":274,"column":1}},"children":[{"type":"text","value":"Now we solve for an initial condition that has a single hump.","position":{"start":{"line":274,"column":1},"end":{"line":274,"column":1}},"key":"YKZGdksRAW"}],"key":"JuTt63ZL93"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"u_init = exp( -80*(x - 0.5).^2 );\nivp.InitialValue = chop(u_init);\nsol = solutionFcn(ivp, 0, 1);\nu = @(t) [sol(t); zeros(1, length(t))];    % extend to zero at right","key":"dopScQ7Aw7"},{"type":"output","id":"3OY9aQ41Xl-23nXve3ihf","data":[],"key":"GKH8le7ev4"}],"data":{},"key":"OhyPXDzgXW"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"t = linspace(0, 1, 81);\nclf,  contour(x, t, u(t)', 0.15:0.2:1)\nxlabel x,  ylabel t\ntitle('Advection with inflow BC')","key":"MaLgY0w1L0"},{"type":"output","id":"evo3bMus3Pje8wmE0FnpB","data":[{"output_type":"execute_result","execution_count":22,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"d0db02cfea9217a4c13d219f999a72ca","path":"/fnc/build/d0db02cfea9217a4c13d219f999a72ca.png"}}}],"key":"q2ydHqKBD2"}],"data":{},"key":"tyy6arZh6w"},{"type":"paragraph","position":{"start":{"line":290,"column":1},"end":{"line":290,"column":1}},"children":[{"type":"text","value":"We find that the hump gracefully exits out the downwind end.","position":{"start":{"line":290,"column":1},"end":{"line":290,"column":1}},"key":"XonM0mEKX3"}],"key":"AriFXbr0k6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf\nplot(x, u(0))\nhold on\naxis([0, 1, -0.05, 1.05])\ntitle('Advection with inflow BC') \nxlabel('x'),  ylabel('u(x,t)')\nvid = VideoWriter(\"figures/advection-inflow.mp4\", \"MPEG-4\");\nvid.Quality = 85;\nopen(vid);\nfor frame = 1:length(t)\n    cla, plot(x, u(t(frame)))\n    str = sprintf(\"t = %.2f\", t(frame));\n    text(0.08, 0.85, str);\n    writeVideo(vid, frame2im(getframe(gcf)));\nend\nclose(vid)\nclose(gcf)","visibility":"hide","key":"VoxuUQGtMc"},{"type":"output","id":"NluTzD07d0496dbMppc3i","data":[{"output_type":"execute_result","execution_count":23,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"27bc1b3c5771284cba083aad337be6a0","path":"/fnc/build/27bc1b3c5771284cba083aad337be6a0.png"}}}],"visibility":"show","key":"kHuRhGo4sS"}],"data":{"tags":[]},"visibility":"show","key":"yBCIQUXhCW"},{"type":"image","url":"/fnc/build/advection-inflow-15ba4e3b09f414c1a8b94c2c3e47ab8a.mp4","alt":"Advection with inflow BC","position":{"start":{"line":313,"column":1},"end":{"line":313,"column":1}},"key":"h8OtekJkhG","urlSource":"figures/advection-inflow.mp4"},{"type":"paragraph","position":{"start":{"line":315,"column":1},"end":{"line":315,"column":1}},"children":[{"type":"text","value":"If instead of ","position":{"start":{"line":315,"column":1},"end":{"line":315,"column":1}},"key":"rhPS9dxzNe"},{"type":"inlineMath","value":"u(1,t)=0","position":{"start":{"line":315,"column":1},"end":{"line":315,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo stretchy=\"false\">(</mo><mn>1</mn><mo separator=\"true\">,</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">u(1,t)=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"nsjXDMmSNa"},{"type":"text","value":" we were to try to impose the downwind condition ","position":{"start":{"line":315,"column":1},"end":{"line":315,"column":1}},"key":"CIWFj4VT9r"},{"type":"inlineMath","value":"u(0,t)=0","position":{"start":{"line":315,"column":1},"end":{"line":315,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo stretchy=\"false\">(</mo><mn>0</mn><mo separator=\"true\">,</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">u(0,t)=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"h93uEglJ2u"},{"type":"text","value":", we only need to change the index of the interior nodes and where to append the zero value.","position":{"start":{"line":315,"column":1},"end":{"line":315,"column":1}},"key":"XOjauxETGh"}],"key":"ugaoSUFIdD"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"chop = @(u) u(2:m+1);  \nextend = @(v) [0; v];\nivp.ODEFcn = @(t, v) -c * chop( Dx * extend(v) );\nivp.InitialValue = chop(u_init);\nsol = solutionFcn(ivp, 0, 1);\nu = @(t) [zeros(1, length(t)); sol(t)];","key":"mgUxoSwsYH"},{"type":"output","id":"Tf_mHVEhvyQYKD34YqMhk","data":[],"key":"mtW56yzLXI"}],"data":{},"key":"YEXeV6aDBp"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"FNC_init\ncontour(x, t, u(t)', 0.15:0.2:1)\nxlabel x,  ylabel t\ntitle('Advection with outflow BC')","visibility":"hide","key":"hBqdRpedp4"},{"type":"output","id":"SobpfmKlbmUtv80R4O06T","data":[{"output_type":"execute_result","execution_count":25,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"bb98e975ce775aa177ec6549b2044323","path":"/fnc/build/bb98e975ce775aa177ec6549b2044323.png"}}},{"output_type":"execute_result","execution_count":25,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = \n  Figure (1) with properties:\n\n      Number: 1\n        Name: ''\n       Color: [1 1 1]\n    Position: [1224 1070 560 420]\n       Units: 'pixels'\n\n  Use GET to show all properties\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = \n  Figure (1) with properties:\n\n      Number: 1\n        Name: ''\n       Color: [1 1 1]\n    Position: [1224 1070 560 420]\n       Units: 'pixels'\n\n  Use GET to show all properties\n","content_type":"text/plain"}}}],"visibility":"show","key":"McRAqEzXeY"}],"data":{"tags":[]},"visibility":"show","key":"G8XxJZEuds"},{"type":"paragraph","position":{"start":{"line":334,"column":1},"end":{"line":334,"column":1}},"children":[{"type":"text","value":"This time, the solution blows up as soon as the hump runs into the boundary because there are conflicting demands there.","position":{"start":{"line":334,"column":1},"end":{"line":334,"column":1}},"key":"jOP293BvbV"}],"key":"NkYXHxnMqi"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf\nplot(x, u(0))\nhold on\naxis([0, 1, -0.05, 1.05])\ntitle('Advection with outflow BC') \nxlabel('x'),  ylabel('u(x,t)')\nvid = VideoWriter(\"figures/advection-outflow.mp4\", \"MPEG-4\");\nvid.Quality = 85;\nopen(vid);\nfor frame = 1:45\n    cla, plot(x, u(t(frame)))\n    str = sprintf(\"t = %.2f\", t(frame));\n    text(0.08, 0.85, str);\n    writeVideo(vid, frame2im(getframe(gcf)));\nend\nclose(vid)\nclose(gcf)","visibility":"hide","key":"lQRP20V5Th"},{"type":"output","id":"3cafur9LAAr90lTUfKmZH","data":[{"output_type":"execute_result","execution_count":26,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"c173e6f5504da230aa1d7a82d89f834d","path":"/fnc/build/c173e6f5504da230aa1d7a82d89f834d.png"}}}],"visibility":"show","key":"u4gRSce8bL"}],"data":{"tags":[]},"visibility":"show","key":"rxGKq3xZ0K"},{"type":"image","url":"/fnc/build/advection-outflow-96d40c265747846b30d246a784488f9b.mp4","alt":"Advection with outflow BC","position":{"start":{"line":357,"column":1},"end":{"line":357,"column":1}},"key":"M4t17eNO85","urlSource":"figures/advection-outflow.mp4"}],"label":"demo-upwind-direction-matlab","identifier":"demo-upwind-direction-matlab","html_id":"demo-upwind-direction-matlab","key":"DDnYCptWQQ"}],"key":"IgOvkSwsVB"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"FNC_init","visibility":"show","key":"MhrIbDYq3F"},{"type":"output","id":"vz7SbFoDA89BN-ALiJEzG","data":[{"output_type":"execute_result","execution_count":27,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = \n  Figure (1) with properties:\n\n      Number: 1\n        Name: ''\n       Color: [1 1 1]\n    Position: [1224 1070 560 420]\n       Units: 'pixels'\n\n  Use GET to show all properties\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = \n  Figure (1) with properties:\n\n      Number: 1\n        Name: ''\n       Color: [1 1 1]\n    Position: [1224 1070 560 420]\n       Units: 'pixels'\n\n  Use GET to show all properties\n","content_type":"text/plain"}}}],"visibility":"show","key":"pXMBOVbqFu"}],"data":{"tags":[]},"visibility":"remove","key":"SruvCZEBz7"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":365,"column":1},"end":{"line":365,"column":1}},"children":[{"type":"text","value":"12.3 ","position":{"start":{"line":365,"column":1},"end":{"line":365,"column":1}},"key":"fdv8VkCtjP"},{"type":"link","identifier":"section-advection-absstab","label":"section-advection-absstab","kind":"narrative","position":{"start":{"line":365,"column":6},"end":{"line":365,"column":32}},"url":"/absstab-advection","internal":true,"dataUrl":"/absstab-advection.json","children":[{"type":"text","value":"Absolute stability","key":"hmiYNrGLqS"}],"key":"KUZzm0e8gW"}],"identifier":"id-12-3","label":"12.3 ","html_id":"id-12-3","implicit":true,"key":"hdTzS41Kbz"},{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-absstab-advection","label":"demo-absstab-advection","kind":"proof:example","position":{"start":{"line":368,"column":1},"end":{"line":368,"column":24}},"children":[{"type":"text","value":"Example ","key":"L2PWE37Lh8"},{"type":"text","value":"12.3.1","key":"OdLBYUHgts"}],"template":"Example %s","enumerator":"12.3.1","resolved":true,"html_id":"demo-absstab-advection","remote":true,"url":"/absstab-advection","dataUrl":"/absstab-advection.json","key":"COuH11sSk3"}],"key":"VXL7LP292J"},{"type":"paragraph","position":{"start":{"line":369,"column":1},"end":{"line":369,"column":1}},"children":[{"type":"text","value":"For ","position":{"start":{"line":369,"column":1},"end":{"line":369,"column":1}},"key":"ZovmUL21nt"},{"type":"inlineMath","value":"c=1","position":{"start":{"line":369,"column":1},"end":{"line":369,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>c</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">c=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">c</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"c5Z3dNfpAn"},{"type":"text","value":" we get purely imaginary eigenvalues.","position":{"start":{"line":369,"column":1},"end":{"line":369,"column":1}},"key":"Cd6yp5WHWP"}],"key":"gNG2RXzPUJ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[x, Dx] = diffper(40, [0, 1]);\nlambda = eig(Dx);\nclf\nscatter(real(lambda), imag(lambda))\naxis equal,  grid on\ntitle('Eigenvalues for pure advection')","visibility":"hide","key":"bjaHjOG5Ak"},{"type":"output","id":"mycNS4ysONovGq3LbCMPV","data":[{"output_type":"execute_result","execution_count":28,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"7d365bb04c8cf2d576183c561b62194a","path":"/fnc/build/7d365bb04c8cf2d576183c561b62194a.png"}}}],"visibility":"show","key":"Dul5DXTEwP"}],"data":{"tags":[]},"visibility":"show","key":"oMCblvE2mq"},{"type":"paragraph","position":{"start":{"line":381,"column":1},"end":{"line":381,"column":1}},"children":[{"type":"text","value":"Let’s choose a time step of ","position":{"start":{"line":381,"column":1},"end":{"line":381,"column":1}},"key":"b2cn0P5xta"},{"type":"inlineMath","value":"\\tau=0.1","position":{"start":{"line":381,"column":1},"end":{"line":381,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>τ</mi><mo>=</mo><mn>0.1</mn></mrow><annotation encoding=\"application/x-tex\">\\tau=0.1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.1132em;\">τ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0.1</span></span></span></span>","key":"DeXrP7D2DT"},{"type":"text","value":" and compare to the stability regions of the Euler and backward Euler time steppers (shown as shaded regions):","position":{"start":{"line":381,"column":1},"end":{"line":381,"column":1}},"key":"E1bDgqQGcE"}],"key":"NobHfclnaX"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"zc = exp( 1i * linspace(0,2*pi,361)' );    % points on |z|=1\nz = zc - 1;    % shift circle left by 1\nclf,  fill(real(z), imag(z), [.8, .8, 1])\nhold on,  scatter(real(0.1*lambda), imag(0.1*lambda))\naxis equal,  axis square\naxis([-5, 5, -5, 5]),  grid on\ntitle('Euler')","visibility":"hide","key":"qvHNpMZhuM"},{"type":"output","id":"KpxBjKRdrEd5ln67_Hmnw","data":[{"output_type":"execute_result","execution_count":29,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"b5862f4e01108a4524041ae4d3aea78d","path":"/fnc/build/b5862f4e01108a4524041ae4d3aea78d.png"}}}],"visibility":"show","key":"vt1WIAkn86"}],"data":{"tags":[]},"visibility":"show","key":"QlSGjHjSyO"},{"type":"paragraph","position":{"start":{"line":394,"column":1},"end":{"line":394,"column":1}},"children":[{"type":"text","value":"In the Euler case it’s clear that ","position":{"start":{"line":394,"column":1},"end":{"line":394,"column":1}},"key":"JBiTmsCVO1"},{"type":"emphasis","position":{"start":{"line":394,"column":1},"end":{"line":394,"column":1}},"children":[{"type":"text","value":"no","position":{"start":{"line":394,"column":1},"end":{"line":394,"column":1}},"key":"IYsX1hZhiz"}],"key":"n6URlGiTxo"},{"type":"text","value":" real value of ","position":{"start":{"line":394,"column":1},"end":{"line":394,"column":1}},"key":"imFMng02rQ"},{"type":"inlineMath","value":"\\tau>0","position":{"start":{"line":394,"column":1},"end":{"line":394,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>τ</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">\\tau&gt;0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.1132em;\">τ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&gt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"Co52QBUOik"},{"type":"text","value":" is going to make ","position":{"start":{"line":394,"column":1},"end":{"line":394,"column":1}},"key":"Gnv5ry4K6V"},{"type":"text","value":"ζ","position":{"start":{"line":394,"column":1},"end":{"line":394,"column":1}},"key":"LBA8QyCHIk"},{"type":"text","value":" values fit within the stability region. Any method whose stability region includes none of the imaginary axis is an unsuitable choice for advection.","position":{"start":{"line":394,"column":1},"end":{"line":394,"column":1}},"key":"MWlOKPa8Fj"}],"key":"JAhhuXFWuF"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf,  fill([-6, 6, 6, -6],[-6, -6, 6, 6], [.8, .8, 1])\nz = zc + 1;   % shift circle right by 1\nhold on,  scatter(real(0.1*lambda), imag(0.1*lambda))\nfill(real(z), imag(z), 'w')\naxis equal,  axis square\naxis([-5 5 -5 5]),  grid on\ntitle('backward Euler')","visibility":"hide","key":"kX1zwM17LZ"},{"type":"output","id":"QAp97w1_C7zptjKWDWeDW","data":[{"output_type":"execute_result","execution_count":30,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"59883cccb119648b3d35094f83ff934b","path":"/fnc/build/59883cccb119648b3d35094f83ff934b.png"}}}],"visibility":"show","key":"KT5lu18wvD"}],"data":{"tags":[]},"visibility":"show","key":"oNqMA9cp49"},{"type":"paragraph","position":{"start":{"line":407,"column":1},"end":{"line":407,"column":1}},"children":[{"type":"text","value":"The A-stable backward Euler time stepping tells the exact opposite story: it will be absolutely stable for any choice of the time step ","position":{"start":{"line":407,"column":1},"end":{"line":407,"column":1}},"key":"YwZXtNidsX"},{"type":"text","value":"τ","position":{"start":{"line":407,"column":1},"end":{"line":407,"column":1}},"key":"EyJaaUG06E"},{"type":"text","value":".","position":{"start":{"line":407,"column":1},"end":{"line":407,"column":1}},"key":"RvGsvwHdvG"}],"key":"uYxq4J3w0s"}],"label":"demo-absstab-advection-matlab","identifier":"demo-absstab-advection-matlab","html_id":"demo-absstab-advection-matlab","key":"JUD6PqBVuk"},{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-absstab-advdiff","label":"demo-absstab-advdiff","kind":"proof:example","position":{"start":{"line":411,"column":1},"end":{"line":411,"column":22}},"children":[{"type":"text","value":"Example ","key":"H5bd8WAked"},{"type":"text","value":"12.3.2","key":"AkMxLzNlkN"}],"template":"Example %s","enumerator":"12.3.2","resolved":true,"html_id":"demo-absstab-advdiff","remote":true,"url":"/absstab-advection","dataUrl":"/absstab-advection.json","key":"qDQrMVX5S6"}],"key":"mVS5SaIldi"},{"type":"paragraph","position":{"start":{"line":412,"column":1},"end":{"line":412,"column":1}},"children":[{"type":"text","value":"The eigenvalues of advection-diffusion are near-imaginary for ","position":{"start":{"line":412,"column":1},"end":{"line":412,"column":1}},"key":"Rzc4JwFuqr"},{"type":"inlineMath","value":"\\epsilon\\approx 0","position":{"start":{"line":412,"column":1},"end":{"line":412,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ϵ</mi><mo>≈</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">\\epsilon\\approx 0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4831em;\"></span><span class=\"mord mathnormal\">ϵ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"gGXr7i6uso"},{"type":"text","value":" and get closer to the negative real axis as ","position":{"start":{"line":412,"column":1},"end":{"line":412,"column":1}},"key":"oOXc6deukn"},{"type":"text","value":"ε","position":{"start":{"line":412,"column":1},"end":{"line":412,"column":1}},"key":"H4qqCF3ekY"},{"type":"text","value":" increases.","position":{"start":{"line":412,"column":1},"end":{"line":412,"column":1}},"key":"yir6WtWPRa"}],"key":"AyVMj8RL02"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[x, Dx, Dxx] = diffper(40, [0, 1]);\ntau = 0.1;\nclf\nfor ep = [0.001 0.01 0.05]\n  lambda = eig(-Dx + ep*Dxx);\n  str = sprintf(\"\\\\epsilon = %.3f\", ep);\n  scatter(real(tau*lambda), imag(tau*lambda), displayname=str)\n  hold on\nend\naxis equal,  grid on\nlegend(location='northwest')\ntitle('Eigenvalues for advection-diffusion')","visibility":"hide","key":"c3U7ECfPqS"},{"type":"output","id":"TlKwKhYuOVPGs2KpJ9CkN","data":[{"output_type":"execute_result","execution_count":31,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"12fd8865d299c264a6fd5ce7d04af703","path":"/fnc/build/12fd8865d299c264a6fd5ce7d04af703.png"}}}],"visibility":"show","key":"xz87kgHhQm"}],"data":{"tags":[]},"visibility":"show","key":"PjN9GRUUtC"}],"label":"demo-absstab-advdiff-matlab","identifier":"demo-absstab-advdiff-matlab","html_id":"demo-absstab-advdiff-matlab","key":"hhhKjpSlsY"},{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-absstab-inflow","label":"demo-absstab-inflow","kind":"proof:example","position":{"start":{"line":432,"column":1},"end":{"line":432,"column":21}},"children":[{"type":"text","value":"Example ","key":"DB2lygsKVf"},{"type":"text","value":"12.3.3","key":"hqGPCTKsE0"}],"template":"Example %s","enumerator":"12.3.3","resolved":true,"html_id":"demo-absstab-inflow","remote":true,"url":"/absstab-advection","dataUrl":"/absstab-advection.json","key":"OJ7Nl5P6Tf"}],"key":"EOdaf5bWMn"},{"type":"paragraph","position":{"start":{"line":433,"column":1},"end":{"line":433,"column":1}},"children":[{"type":"text","value":"Deleting the last row and column places all the eigenvalues of the discretization into the left half of the complex plane.","position":{"start":{"line":433,"column":1},"end":{"line":433,"column":1}},"key":"pY7pbNhhkK"}],"key":"tKSEl0y4G5"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[x, Dx, Dxx] = diffcheb(40, [0, 1]);\nA = -Dx(2:end, 2:end);    % leave out first row and column\nlambda = eig(A);","key":"XY15pV439a"},{"type":"output","id":"lT5pWwHYfwSKcAcT2auzL","data":[],"key":"XOEjN3YsLJ"}],"data":{},"key":"pBOJA05AZN"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf\nscatter(real(lambda), imag(lambda))\naxis equal,  grid on \ntitle('Eigenvalues of advection with zero inflow')","visibility":"hide","key":"cY6hzQvDCb"},{"type":"output","id":"d5jvnV4hG4t0B4be1gtjk","data":[{"output_type":"execute_result","execution_count":33,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"cb220aafdcfb125258035cee8e0cfa9b","path":"/fnc/build/cb220aafdcfb125258035cee8e0cfa9b.png"}}}],"visibility":"show","key":"E3DxgIwggv"}],"data":{"tags":[]},"visibility":"show","key":"FImyC0dnno"},{"type":"paragraph","position":{"start":{"line":449,"column":1},"end":{"line":449,"column":1}},"children":[{"type":"text","value":"Note that the rightmost eigenvalues have real part at most","position":{"start":{"line":449,"column":1},"end":{"line":449,"column":1}},"key":"opJSKeynvj"}],"key":"ZeLGGlncxq"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"max(real(lambda))","key":"hOlYUb8qXn"},{"type":"output","id":"nmxfv_SWi7BZqzoEcIhQp","data":[{"output_type":"execute_result","execution_count":34,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = -4.9320</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = -4.9320","content_type":"text/plain"}}}],"key":"jhtfcXQWuR"}],"data":{},"key":"mqJekPz7Pi"},{"type":"paragraph","position":{"start":{"line":455,"column":1},"end":{"line":455,"column":1}},"children":[{"type":"text","value":"Consequently all solutions decay exponentially to zero as ","position":{"start":{"line":455,"column":1},"end":{"line":455,"column":1}},"key":"ERmiDP4zRx"},{"type":"inlineMath","value":"t\\to\\infty","position":{"start":{"line":455,"column":1},"end":{"line":455,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi><mo>→</mo><mi mathvariant=\"normal\">∞</mi></mrow><annotation encoding=\"application/x-tex\">t\\to\\infty</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord\">∞</span></span></span></span>","key":"vrJ1xPDPzK"},{"type":"text","value":". This matches our observation of the solution: eventually, everything flows out of the domain.","position":{"start":{"line":455,"column":1},"end":{"line":455,"column":1}},"key":"kcBaiAkDEX"}],"key":"XinUGGdbMU"}],"label":"demo-absstab-inflow-matlab","identifier":"demo-absstab-inflow-matlab","html_id":"demo-absstab-inflow-matlab","key":"FdvPkJEXEQ"},{"type":"heading","depth":3,"position":{"start":{"line":459,"column":1},"end":{"line":459,"column":1}},"children":[{"type":"text","value":"12.4 ","position":{"start":{"line":459,"column":1},"end":{"line":459,"column":1}},"key":"dK6SlpEz4C"},{"type":"link","identifier":"section-advection-wave","label":"section-advection-wave","kind":"narrative","position":{"start":{"line":459,"column":6},"end":{"line":459,"column":29}},"url":"/wave","internal":true,"dataUrl":"/wave.json","children":[{"type":"text","value":"The wave equation","key":"sOTrTrjDEl"}],"key":"Zqvt2rnddQ"}],"identifier":"id-12-4","label":"12.4 ","html_id":"id-12-4","implicit":true,"key":"dnwTd04ufe"},{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-wave-boundaries","label":"demo-wave-boundaries","kind":"proof:example","position":{"start":{"line":462,"column":1},"end":{"line":462,"column":22}},"children":[{"type":"text","value":"Example ","key":"xE1ESeDiwC"},{"type":"text","value":"12.4.1","key":"GTdGzcogtc"}],"template":"Example %s","enumerator":"12.4.1","resolved":true,"html_id":"demo-wave-boundaries","remote":true,"url":"/wave","dataUrl":"/wave.json","key":"eDC57rryul"}],"key":"vV8gETnVnc"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"c = 2;  m = 200;\n[x, Dx] = diffcheb(m, [-1, 1]);","key":"adTSoe2KwU"},{"type":"output","id":"-lqWpv96wH7s4LTaqU4rU","data":[],"key":"ZMxvoVcLXm"}],"data":{},"key":"LwNWcRa0qF"},{"type":"paragraph","position":{"start":{"line":469,"column":1},"end":{"line":469,"column":1}},"children":[{"type":"text","value":"The boundary values of ","position":{"start":{"line":469,"column":1},"end":{"line":469,"column":1}},"key":"hd0etlWtnS"},{"type":"inlineMath","value":"u","position":{"start":{"line":469,"column":1},"end":{"line":469,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span>","key":"u0SHx8v0AP"},{"type":"text","value":" are given to be zero, so they are not unknowns in the ","key":"Y96cAiZMbd"},{"type":"abbreviation","title":"ordinary differential equation","children":[{"type":"text","value":"ODE","key":"zjEo1RPTfJ"}],"key":"eFthwJHGlU"},{"type":"text","value":"s. Instead they are added or removed as necessary.","key":"CmwaokLYYR"}],"key":"AkqFBfGadS"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"chop = @(u) u(2:m);\nextend = @(v) [0; v; 0];","key":"qAFKdpROIW"},{"type":"output","id":"8shnzmvcAXDeIoWw5iyWV","data":[],"key":"DzUIOebK38"}],"data":{},"key":"AeeBh4l8MC"},{"type":"paragraph","position":{"start":{"line":476,"column":1},"end":{"line":476,"column":1}},"children":[{"type":"text","value":"The following function computes the time derivative of the system at interior points.","position":{"start":{"line":476,"column":1},"end":{"line":476,"column":1}},"key":"X6w70RkoNr"}],"key":"TtddtZDXJc"},{"type":"include","file":"f124wave.m","literal":true,"filter":{},"children":[{"type":"code","value":"function dw_dt = wave(t, w, param)\n    [c, m, Dx, chop, extend] = param{:};\n    u = extend(w(1:m-1));\n    z = w(m:2*m);\n    du_dt = Dx * z;\n    dz_dt = c.^2 .* (Dx * u);\n    dw_dt = [ chop(du_dt); dz_dt ];\nend","lang":"m","filename":"f124wave.m","key":"aMiOw6DyaT"}],"key":"nh1Rdf1DXU"},{"type":"paragraph","position":{"start":{"line":481,"column":1},"end":{"line":481,"column":1}},"children":[{"type":"text","value":"Our initial condition is a single hump for ","position":{"start":{"line":481,"column":1},"end":{"line":481,"column":1}},"key":"qR5SBgLzyB"},{"type":"inlineMath","value":"u","position":{"start":{"line":481,"column":1},"end":{"line":481,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span>","key":"fFVz6erswI"},{"type":"text","value":".","position":{"start":{"line":481,"column":1},"end":{"line":481,"column":1}},"key":"WOr935y0sV"}],"key":"nWbx9ELa2O"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"u_init = exp( -100*x.^2 );\nz_init = -u_init;\nw_init = [ chop(u_init); z_init ];","key":"TG84fc2m0p"},{"type":"output","id":"0PM7cRSfB_znF5uU1O7DS","data":[],"key":"ESi19fo9SO"}],"data":{},"key":"uFSLgHhuzQ"},{"type":"paragraph","position":{"start":{"line":489,"column":1},"end":{"line":489,"column":1}},"children":[{"type":"text","value":"Because the wave equation is hyperbolic, we can use a nonstiff explicit solver.","position":{"start":{"line":489,"column":1},"end":{"line":489,"column":1}},"key":"KjzYhEzcUH"}],"key":"DNObiHSeuZ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"ivp = ode(ODEFcn=@f124wave);\nivp.InitialTime = 0;\nivp.InitialValue = w_init;\nivp.RelativeTolerance = 1e-4;\nivp.Parameters = {c, m, Dx, chop, extend};\nt = linspace(0, 2, 101);\nsol = solve(ivp, t);","key":"ZNfLEEZEzn"},{"type":"output","id":"liINdrQ6E9WA0E0GguJJv","data":[],"key":"DAxw6irUnw"}],"data":{},"key":"TMSCNP5iPs"},{"type":"paragraph","position":{"start":{"line":501,"column":1},"end":{"line":501,"column":1}},"children":[{"type":"text","value":"We plot the results for the original ","position":{"start":{"line":501,"column":1},"end":{"line":501,"column":1}},"key":"tA4CWBhlc4"},{"type":"inlineMath","value":"u","position":{"start":{"line":501,"column":1},"end":{"line":501,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span>","key":"ZmGbmW3kdC"},{"type":"text","value":" variable only. Its interior values are at indices ","position":{"start":{"line":501,"column":1},"end":{"line":501,"column":1}},"key":"cnD1XnQWIu"},{"type":"inlineCode","value":"1:m-1","position":{"start":{"line":501,"column":1},"end":{"line":501,"column":1}},"key":"N8xNKiRpVh"},{"type":"text","value":" of the composite ","position":{"start":{"line":501,"column":1},"end":{"line":501,"column":1}},"key":"DW9G4ETfR8"},{"type":"inlineMath","value":"\\mathbf{w}","position":{"start":{"line":501,"column":1},"end":{"line":501,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">w</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{w}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4444em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">w</span></span></span></span>","key":"oEztvo6eJg"},{"type":"text","value":" variable.","position":{"start":{"line":501,"column":1},"end":{"line":501,"column":1}},"key":"RMbRPrihrt"}],"key":"pGBbd9kL2Z"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"W = sol.Solution;\nn = length(t)-1;\nU = [ zeros(1, n+1); W(1:m-1, :); zeros(1, n+1) ];\n\ncmap = zeros(256, 3);\ncmap(129:end, 1) = 2/3;\ncmap(1:128, 2) = linspace(1, 0, 128);\ncmap(129:256, 2) = linspace(0, 1, 128);\ncmap(1:128, 3) = linspace(1, 0.5, 128);\ncmap(129:256, 3) = linspace(0.5, 1, 128);\ncmap = hsv2rgb(cmap);\n\nclf,  contour(x, t, U', 24, linewidth=2)\ncolormap(cmap),  clim([-1, 1])\nxlabel x,  ylabel t\ntitle(\"Wave equation with boundaries\")","key":"ndHi4iXf7o"},{"type":"output","id":"lNa0R2NvU26cSgTp367YH","data":[{"output_type":"execute_result","execution_count":39,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"a06e00066eeeccd1a077d8679a4b8f28","path":"/fnc/build/a06e00066eeeccd1a077d8679a4b8f28.png"}}}],"key":"lSIVmuPSX5"}],"data":{},"key":"Sr99893Kis"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf\nplot(x, U(:, 1))\nhold on\naxis([-1, 1, -1.05, 1.05])\ntitle(\"Wave equation with boundaries\") \nxlabel('x'),  ylabel('u(x,t)')\nvid = VideoWriter(\"figures/wave-boundaries.mp4\", \"MPEG-4\");\nvid.Quality = 85;\nopen(vid);\nfor frame = 1:length(t)\n    cla, plot(x, U(:, frame))\n    str = sprintf(\"t = %.2f\", t(frame));\n    text(-0.92, 0.85, str, fontsize=16);\n    writeVideo(vid, frame2im(getframe(gcf)));\nend\nclose(vid)\nclose(gcf)","visibility":"hide","key":"jRa0N1Y3Cu"},{"type":"output","id":"wpaO8yUSBBCYTAch6-J6w","data":[{"output_type":"execute_result","execution_count":40,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"5276694fe33a255072474479e2901e22","path":"/fnc/build/5276694fe33a255072474479e2901e22.png"}}}],"visibility":"show","key":"jSt1bUwQdJ"}],"data":{"tags":[]},"visibility":"show","key":"bejm1wKwE3"},{"type":"image","url":"/fnc/build/wave-boundaries-eacc3764be6ae7c68b6db577c8b28f9b.mp4","alt":"Wave equation with boundaries","position":{"start":{"line":543,"column":1},"end":{"line":543,"column":1}},"key":"hDQL4hWngN","urlSource":"figures/wave-boundaries.mp4"},{"type":"paragraph","position":{"start":{"line":545,"column":1},"end":{"line":545,"column":1}},"children":[{"type":"text","value":"The original hump breaks into two pieces of different amplitudes, each traveling with speed ","position":{"start":{"line":545,"column":1},"end":{"line":545,"column":1}},"key":"hkQhFpnlva"},{"type":"inlineMath","value":"c=2","position":{"start":{"line":545,"column":1},"end":{"line":545,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>c</mi><mo>=</mo><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">c=2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">c</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span></span></span></span>","key":"Hd4hTuX9ps"},{"type":"text","value":". They pass through one another without interference. When a hump encounters a boundary, it is perfectly reflected, but with inverted shape. At time ","position":{"start":{"line":545,"column":1},"end":{"line":545,"column":1}},"key":"KdekSRivka"},{"type":"inlineMath","value":"t=2","position":{"start":{"line":545,"column":1},"end":{"line":545,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi><mo>=</mo><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">t=2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span></span></span></span>","key":"UBgFRcG9rP"},{"type":"text","value":", the solution looks just like the initial condition.","position":{"start":{"line":545,"column":1},"end":{"line":545,"column":1}},"key":"xBqaJioKcp"}],"key":"DkGD9Nkp6a"}],"label":"demo-wave-boundaries-matlab","identifier":"demo-wave-boundaries-matlab","html_id":"demo-wave-boundaries-matlab","key":"rrzHm5yMl2"}],"key":"hONjTawKzA"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"FNC_init","visibility":"show","key":"Zr9qCl3XSD"},{"type":"output","id":"H9UOLVeUR-c6ZOGw2ftlZ","data":[{"output_type":"execute_result","execution_count":41,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = \n  Figure (1) with properties:\n\n      Number: 1\n        Name: ''\n       Color: [1 1 1]\n    Position: [1224 1070 560 420]\n       Units: 'pixels'\n\n  Use GET to show all properties\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = \n  Figure (1) with properties:\n\n      Number: 1\n        Name: ''\n       Color: [1 1 1]\n    Position: [1224 1070 560 420]\n       Units: 'pixels'\n\n  Use GET to show all properties\n","content_type":"text/plain"}}}],"visibility":"show","key":"E3uEzBSULK"}],"data":{"tags":[]},"visibility":"remove","key":"EjcnMn0hBU"},{"type":"block","children":[{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-wave-speed","label":"demo-wave-speed","kind":"proof:example","position":{"start":{"line":555,"column":1},"end":{"line":555,"column":17}},"children":[{"type":"text","value":"Example ","key":"ibXcdTtPNU"},{"type":"text","value":"12.4.2","key":"KkI1kQlAai"}],"template":"Example %s","enumerator":"12.4.2","resolved":true,"html_id":"demo-wave-speed","remote":true,"url":"/wave","dataUrl":"/wave.json","key":"p3KEsrjigO"}],"key":"piHkZCiE7C"},{"type":"paragraph","position":{"start":{"line":557,"column":1},"end":{"line":557,"column":1}},"children":[{"type":"text","value":"We now use a wave speed that is discontinuous at ","position":{"start":{"line":557,"column":1},"end":{"line":557,"column":1}},"key":"HQIFBddVSW"},{"type":"inlineMath","value":"x=0","position":{"start":{"line":557,"column":1},"end":{"line":557,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">x=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"rZOdxmofHQ"},{"type":"text","value":".","position":{"start":{"line":557,"column":1},"end":{"line":557,"column":1}},"key":"rLbZMoEUpn"}],"key":"EG4LMJkMsC"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"m = 120;\n[x, Dx] = diffcheb(m, [-1, 1]);\nc = 1 + (sign(x) + 1) / 2;\nchop = @(u) u(2:m);\nextend = @(v) [0; v; 0];\n\nu_init = exp( -100*(x + 0.5).^2 );\nz_init = -u_init;\nivp.InitialValue = [ chop(u_init); z_init ]; \nivp.Parameters = {c, m, Dx, chop, extend};\nsol = solve(ivp, t);\nW = sol.Solution;\nU = [ zeros(1, n+1); W(1:m-1, :); zeros(1, n+1) ];","key":"VMQ5UpkHSq"},{"type":"output","id":"4sksY8ujG6BZuCc7qaUHj","data":[],"key":"gzhzWfhL8H"}],"data":{},"key":"brXPIIVPQC"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf,  contour(x, t, U', 24, linewidth=2)\ncolormap(cmap),  clim([-1, 1])\nxlabel x,  ylabel t\ntitle(\"Wave equation with variable speed\")","key":"q66wkPrpUf"},{"type":"output","id":"l-HSx5UNawGjCOYClV0K_","data":[{"output_type":"execute_result","execution_count":43,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"a450270cbb2fa1b51c8a3d3242e7f169","path":"/fnc/build/a450270cbb2fa1b51c8a3d3242e7f169.png"}}}],"key":"O4PKYOkdIX"}],"data":{},"key":"jgYTseSwN8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf\nplot(x, U(:, 1))\nhold on\naxis([-1, 1, -1.05, 1.05])\ntitle(\"Wave equation with variable speed\") \nxlabel('x'),  ylabel('u(x,t)')\nvid = VideoWriter(\"figures/wave-speed.mp4\", \"MPEG-4\");\nvid.Quality = 85;\nopen(vid);\nfor frame = 1:length(t)\n    cla, plot(x, U(:, frame))\n    str = sprintf(\"t = %.2f\", t(frame));\n    text(-0.92, 0.85, str, fontsize=16);\n    writeVideo(vid, frame2im(getframe(gcf)));\nend\nclose(vid)\nclose(gcf)","visibility":"hide","key":"QAcgqphZvk"},{"type":"output","id":"0bwXfef8dmsBmL9V4xi7D","data":[{"output_type":"execute_result","execution_count":44,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"aa7e7b21fdf0414dbe8c1f11ac98468c","path":"/fnc/build/aa7e7b21fdf0414dbe8c1f11ac98468c.png"}}}],"visibility":"show","key":"QszpHkrFPo"}],"data":{"tags":[]},"visibility":"show","key":"t57k2lvTpM"},{"type":"image","url":"/fnc/build/wave-speed-e0b53f1447db461abf0f2c07e9f3ee72.mp4","alt":"Wave equation with variable speed","position":{"start":{"line":603,"column":1},"end":{"line":603,"column":1}},"key":"JZddkPTO9W","urlSource":"figures/wave-speed.mp4"},{"type":"paragraph","position":{"start":{"line":605,"column":1},"end":{"line":605,"column":1}},"children":[{"type":"text","value":"Each pass through the interface at ","position":{"start":{"line":605,"column":1},"end":{"line":605,"column":1}},"key":"AoGcuzfsjc"},{"type":"inlineMath","value":"x=0","position":{"start":{"line":605,"column":1},"end":{"line":605,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">x=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"YwqV8eCgRK"},{"type":"text","value":" generates a reflected and transmitted wave. By conservation of energy, these are both smaller in amplitude than the incoming bump.","position":{"start":{"line":605,"column":1},"end":{"line":605,"column":1}},"key":"gzl6KwDBTi"}],"key":"jFVeOwy2v6"}],"label":"demo-wave-speed-matlab","identifier":"demo-wave-speed-matlab","html_id":"demo-wave-speed-matlab","key":"avD3PWwnXe"}],"key":"eEIduBWm3c"}],"key":"PNLSZGFdng"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Chapter 11","url":"/chapter11-1","group":"MATLAB codes"},"next":{"title":"Chapter 13","url":"/chapter13-1","group":"MATLAB codes"}}},"domain":"http://localhost:3000"}