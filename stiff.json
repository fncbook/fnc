{"kind":"Notebook","sha256":"fc1bf8ce06f7a06d049601bc8ad68d208f3eb944f29ccd8bc921d793b92ad736","slug":"stiff","location":"/chapter6/section7/julia/stiff.ipynb","dependencies":[],"frontmatter":{"numbering":{"heading_1":{"enabled":false},"heading_2":{"enabled":false},"heading_3":{"enabled":false},"heading_4":{"enabled":false},"heading_5":{"enabled":false},"heading_6":{"enabled":false}},"kernelspec":{"name":"julia-1.11","display_name":"Julia 1.11.2","language":"julia"},"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"exports":[{"format":"ipynb","filename":"stiff.ipynb","url":"/fnc/build/stiff-f2c934a713bac08ae31c527787b2cc20.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"PDLxuJswS2"},{"type":"text","value":"6.7.2","key":"qUgraoZq79"}],"key":"uc1ngEVPIO"}],"identifier":"demo-implicit-stiff","label":"demo-implicit-stiff","kind":"proof:example","template":"Example %s","enumerator":"6.7.2","resolved":true,"html_id":"demo-implicit-stiff","remote":true,"url":"/implicit","dataUrl":"/implicit.json","key":"vYWeZ7eI7E"}],"key":"BLzdPx6Ieq"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The following simple ","key":"XRArSmG0U8"},{"type":"abbreviation","title":"ordinary differential equation","children":[{"type":"text","value":"ODE","key":"W12iTwiKng"}],"key":"V4rLnjHtjo"},{"type":"text","value":" uncovers a surprise.","key":"m7w1IPiAlN"}],"key":"fsVypjqW5i"}],"key":"FSRhOPKgRd"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T16:37:40.499000Z","iopub.status.busy":"2025-01-14T16:37:39.940000Z","iopub.execute_input":"2025-01-14T16:37:40.081000Z","shell.execute_reply":"2025-01-14T16:37:40.498000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"using OrdinaryDiffEq\nivp = ODEProblem((u, p, t) -> u^2 - u^3, 0.005, (0, 400.0))","key":"rVT11PGcFm"},{"type":"output","id":"CBi7ueqlerIutmKZyBxqd","data":[{"output_type":"execute_result","execution_count":2,"metadata":{},"data":{"text/plain":{"content":"\u001b[38;2;86;182;194mODEProblem\u001b[0m with uType \u001b[38;2;86;182;194mFloat64\u001b[0m and tType \u001b[38;2;86;182;194mFloat64\u001b[0m. In-place: \u001b[38;2;86;182;194mfalse\u001b[0m\ntimespan: (0.0, 400.0)\nu0: 0.005","content_type":"text/plain"}}}],"key":"Z8ELhGGh8B"}],"key":"YNa0P5YIRF"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We will solve the problem first with the implicit AM2 method using ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"NvWcDkzps7"},{"type":"inlineMath","value":"n=200","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>=</mo><mn>200</mn></mrow><annotation encoding=\"application/x-tex\">n=200</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">200</span></span></span></span>","key":"mUwtyXmtt1"},{"type":"text","value":" steps.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Ahy5SPp38L"}],"key":"seOSaIki7n"}],"key":"Wexjk1N0cx"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T16:37:44.116000Z","iopub.status.busy":"2025-01-14T16:37:40.500000Z","iopub.execute_input":"2025-01-14T16:37:40.500000Z","shell.execute_reply":"2025-01-14T16:37:44.116000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"tI, uI = FNC.am2(ivp, 200)\nplot(tI, uI;\n    label=\"AM2\", legend=:bottomright,\n    xlabel=L\"t\",  ylabel=L\"u(t)\")","key":"gTMN1x1V0E"},{"type":"output","id":"5cElHmLJISAKgP5NoTXzP","data":[{"output_type":"execute_result","execution_count":3,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"8f1115b44e1856a7b7aef897b549db0b","path":"/fnc/build/8f1115b44e1856a7b7aef897b549db0b.png"},"text/html":{"content_type":"text/html","hash":"361565d3a4fd9b32a58d749429b6d5d2","path":"/fnc/build/361565d3a4fd9b32a58d749429b6d5d2.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"6e999d57628dc03a9c7fc560eb5ba530","path":"/fnc/build/6e999d57628dc03a9c7fc560eb5ba530.svg"}}}],"key":"EDvqiKw2rl"}],"key":"EviT35jnpa"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now we repeat the process using the explicit AB4 method.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"tIGJvJJbzB"}],"key":"JUXcy0i3sy"}],"key":"JQpLnRed0K"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T16:37:44.518000Z","iopub.status.busy":"2025-01-14T16:37:44.117000Z","iopub.execute_input":"2025-01-14T16:37:44.118000Z","shell.execute_reply":"2025-01-14T16:37:44.518000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"tE, uE = FNC.ab4(ivp, 200)\nscatter!(tE, uE, m=3, label=\"AB4\", ylim=[-4, 2])","key":"Q4CwcKBKQM"},{"type":"output","id":"IXzkyr0SQiI6dtlvvTrs-","data":[{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"687a93fef86d3e878b424c77dd42c260","path":"/fnc/build/687a93fef86d3e878b424c77dd42c260.png"},"text/html":{"content_type":"text/html","hash":"06b6df7c6557c82713ec514cacac776e","path":"/fnc/build/06b6df7c6557c82713ec514cacac776e.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"cd82aedce8217e81513ed12fb05f54f9","path":"/fnc/build/cd82aedce8217e81513ed12fb05f54f9.svg"}}}],"key":"bJUzXPHqCt"}],"key":"SM5OqLOSVF"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Once the solution starts to take off, the AB4 result goes catastrophically wrong.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XJSfOLdKZX"}],"key":"pQTCPVM2io"}],"key":"mYtZRxZEE1"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T16:37:45.390000Z","iopub.status.busy":"2025-01-14T16:37:44.520000Z","iopub.execute_input":"2025-01-14T16:37:44.520000Z","shell.execute_reply":"2025-01-14T16:37:45.390000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"uE[105:111]","key":"g9ewmhiNoU"},{"type":"output","id":"YhA0fw9reiK-J4QeC-Cdt","data":[{"output_type":"execute_result","execution_count":5,"metadata":{},"data":{"text/plain":{"content":"7-element Vector{Float64}:\n   0.7553857798343923\n   1.4372970308402562\n  -3.2889768512289934\n 214.1791132643978\n  -4.482089146771584e7\n   4.1268902909420876e23\n  -3.221441244795439e71","content_type":"text/plain"}}}],"key":"idToyXsc7J"}],"key":"RRcFOMkR6c"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We hope that AB4 will converge in the limit ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"be7PbjTbKC"},{"type":"inlineMath","value":"h\\to 0","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>h</mi><mo>→</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">h\\to 0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">h</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"UqHrUs1kUO"},{"type":"text","value":", so let’s try using more steps.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dw11RGX0MX"}],"key":"IXaAbcLb0O"}],"key":"ohdAbIuX14"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T16:37:45.487000Z","iopub.status.busy":"2025-01-14T16:37:45.392000Z","iopub.execute_input":"2025-01-14T16:37:45.392000Z","shell.execute_reply":"2025-01-14T16:37:45.486000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"plt = scatter(tI, uI;\n    m=3,  label=\"AM2, n=200\",  legend=:bottomright,\n    xlabel=L\"t\",  ylabel=L\"u(t)\")\nfor n in [1000, 1600]\n    tE, uE = FNC.ab4(ivp, n)\n    plot!(tE, uE, label=\"AM4, n=$n\")\nend\nplt","key":"LKGxYaCV8U"},{"type":"output","id":"v2AsSl-kKdzUE02VElYsM","data":[{"output_type":"execute_result","execution_count":6,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"fc1d3c2ba788e2f71389087627aa0364","path":"/fnc/build/fc1d3c2ba788e2f71389087627aa0364.png"},"text/html":{"content_type":"text/html","hash":"901e7109038e5de24a64f667e3562169","path":"/fnc/build/901e7109038e5de24a64f667e3562169.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"2d34ccc53577840e78ef34f3e63ebb51","path":"/fnc/build/2d34ccc53577840e78ef34f3e63ebb51.svg"}}}],"key":"Jrthzhuh8y"}],"key":"v1nQHEWSUC"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"So AB4, which is supposed to be ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cFsjzGGwWJ"},{"type":"emphasis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"more","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jqj8VnxcLc"}],"key":"hOIPkOhrCs"},{"type":"text","value":" accurate than AM2, actually needs something like 8 times as many steps to get a reasonable-looking answer!","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xIY4AL4nlL"}],"key":"IvH9O4EGHA"}],"key":"b0DZEeQBCP"}],"key":"S9b0Pli12b"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Ab4","url":"/ab4","group":"Chapter 6"},"next":{"title":"LIAF","url":"/liaf","group":"Chapter 6"}}},"domain":"http://localhost:3000"}