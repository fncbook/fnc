{"kind":"Notebook","sha256":"31d76173d649eb570acc40032f84bd63e2542df82d6af7049dc106e5971c2583","slug":"chapter1-1","location":"/matlab/chapter1.md","dependencies":[],"frontmatter":{"title":"Chapter 1","numbering":{"heading_1":{"enabled":false},"heading_2":{"enabled":false},"heading_3":{"enabled":false},"heading_4":{"enabled":false},"heading_5":{"enabled":false},"heading_6":{"enabled":false}},"kernelspec":{"name":"jupyter_matlab_kernel","display_name":"MATLAB","language":"matlab"},"content_includes_title":false,"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"LU":"lower triangular times upper triangular","QR":"orthogonal times upper triangular"},"exports":[{"format":"md","filename":"chapter1.md","url":"/fnc/build/chapter1-d77a7a468f1dac7f443036d9c6542726.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"MATLAB implementations","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"Ni8kyTBsL4"}],"key":"KZ9Y6DOxMB"},{"type":"heading","depth":2,"position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"Functions","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"ZtejwzH9yS"}],"identifier":"functions","label":"Functions","html_id":"functions","implicit":true,"key":"B6bsJ8uo1o"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"strong","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"Horner’s algorithm for evaluating a polynomial","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"lxPztZbtIX"}],"key":"sWGKbFUM8f"}],"key":"Uzsb3WfXsi"},{"type":"include","file":"../matlab/fnc/horner.m","literal":true,"filter":{},"children":[{"type":"code","value":"function y = horner(c,x)\r\n% HORNER   Evaluate a polynomial using Horner's rule. \r\n% Input:\r\n%   c     Coefficients of polynomial, in descending order (vector)\r\n%   x     Evaluation point (scalar)\r\n% Output:\r\n%   y     Value of the polynomial at x (scalar)\r\n\r\nn = length(c);\r\ny = c(1);\r\nfor k = 2:n\r\n  y = x*y + c(k);\r\nend","lang":"matlab","showLineNumbers":true,"filename":"horner.m","key":"Q5luqJM1ZQ"}],"key":"yCTqTApknS"}],"label":"function-horner-matlab","identifier":"function-horner-matlab","html_id":"function-horner-matlab","key":"Opje8JDei9"},{"type":"heading","depth":2,"position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"text","value":"Examples","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"GVQZ2Bb7uE"}],"identifier":"examples","label":"Examples","html_id":"examples","implicit":true,"key":"loGyoIoI87"}],"key":"phE1dyOc8P"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"addpath /Users/driscoll/Documents/GitHub/fnc/matlab/fnc\naddpath /Users/driscoll/Documents/GitHub/fnc/matlab\nFNC_init","visibility":"show","key":"dalzGvCGOA"},{"type":"output","id":"wQ8wSI1T-XPIiIimq0Je_","data":[{"output_type":"stream","name":"stdout","text":"Executing ..."},{"output_type":"execute_result","execution_count":1,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = \n  Figure (1) with properties:\n\n      Number: 1\n        Name: ''\n       Color: [1 1 1]\n    Position: [1224 1070 560 420]\n       Units: 'pixels'\n\n  Use GET to show all properties\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = \n  Figure (1) with properties:\n\n      Number: 1\n        Name: ''\n       Color: [1 1 1]\n    Position: [1224 1070 560 420]\n       Units: 'pixels'\n\n  Use GET to show all properties\n","content_type":"text/plain"}}}],"visibility":"show","key":"J6ATWSO2OT"}],"data":{"tags":[]},"visibility":"remove","key":"h2qFS7fsI8"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"children":[{"type":"text","value":"Section 1.1","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"ieqWY5FvD7"}],"identifier":"section-1-1","label":"Section 1.1","html_id":"section-1-1","implicit":true,"key":"JKEoIUcpyp"},{"type":"details","open":false,"children":[{"type":"summary","children":[{"type":"text","value":"Absolute and relative accuracy","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"PTa0TiiuQD"}],"key":"qQ2VTBladw"},{"type":"grid","columns":[1,1,2,2],"children":[{"type":"paragraph","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"children":[{"type":"text","value":"Recall the grade-school approximation to the number ","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"key":"fJiYFmDEX5"},{"type":"text","value":"π","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"key":"YookzNSKPz"},{"type":"text","value":".","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"key":"En8YSJSHij"}],"key":"Hjrc82YMqM"},{"type":"paragraph","position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"children":[{"type":"text","value":"```{index} MATLAB; ","position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"key":"wzzDWXScqB"},{"type":"inlineCode","value":"format","position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"key":"syJulx7WBA"}],"key":"xJpPbp0hFU"},{"type":"code","lang":"","value":"\n```{card}\nThe number of digits displayed is controlled by `format`, but the underlying values are not affected by it.","position":{"start":{"line":42,"column":1},"end":{"line":46,"column":1}},"key":"VLApgQ3iXP"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"format long\np = 22/7","key":"T49CgJo9b3"},{"type":"output","id":"eIe-sUKizIw5jjhV5oHSW","data":[{"output_type":"execute_result","execution_count":2,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>p = \n   3.142857142857143\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"p = \n   3.142857142857143\n","content_type":"text/plain"}}}],"key":"RwMuH4hmO7"}],"data":{},"key":"QiOTCSvOCP"},{"type":"grid","columns":[1,1,2,2],"children":[{"type":"paragraph","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"children":[{"type":"text","value":"Not all the digits displayed for ","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"rxzarSJVHK"},{"type":"inlineCode","value":"p","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"yKwTgUuB2M"},{"type":"text","value":" are the same as those of ","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"PjTWV12dM1"},{"type":"text","value":"π","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"AsNG837LT6"},{"type":"text","value":".","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"hPWjmDS9OX"}],"key":"qlj1UzLVJQ"},{"type":"card","children":[{"type":"paragraph","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"children":[{"type":"text","value":"The value of ","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"key":"lPIkMEDOmJ"},{"type":"inlineCode","value":"pi","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"key":"fRRU6N16Kq"},{"type":"text","value":" is predefined.","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"key":"UqgfbKTrRS"}],"key":"vgMwdEyEY0"}],"key":"PMqC8DOI8w"}],"key":"kRlLxfmn7E"}],"key":"XuGyE1ABtj"},{"type":"paragraph","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"children":[{"type":"text","value":"The absolute and relative accuracies of the approximation are as follows.","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"efLJjcBYZh"}],"key":"BesXygYgxH"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"abs_accuracy = abs(p - pi)\nrel_accuracy = abs(p - pi) / pi","key":"tGHx7Usxmz"},{"type":"output","id":"Zgjtnc0J5bVWxUt1eXpbI","data":[{"output_type":"execute_result","execution_count":3,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>abs_accuracy = \n   0.001264489267350\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"abs_accuracy = \n   0.001264489267350\n","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":3,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>rel_accuracy = \n     4.024994347707008e-04\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"rel_accuracy = \n     4.024994347707008e-04\n","content_type":"text/plain"}}}],"key":"zs0F2mj0Zy"}],"data":{},"key":"rpFPO25JVX"},{"type":"grid","columns":[1,1,2,2],"children":[{"type":"paragraph","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"children":[{"type":"text","value":"Here we calculate the number of accurate digits in ","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"key":"wrt65vbPem"},{"type":"inlineCode","value":"p","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"key":"w9uzmzW1cK"},{"type":"text","value":".","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"key":"RTalKCwglu"}],"key":"et9C0F9nFK"},{"type":"card","children":[{"type":"paragraph","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"key":"hn9FC6kcyY"},{"type":"inlineCode","value":"log","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"key":"tOsHaitfCY"},{"type":"text","value":" function is for the natural log. For other common bases, use ","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"key":"r4wqMl2Xy7"},{"type":"inlineCode","value":"log10","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"key":"ytd8CpDkTQ"},{"type":"text","value":" or ","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"key":"uoT3NxKVzB"},{"type":"inlineCode","value":"log2","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"key":"sK2Tp7WHLk"},{"type":"text","value":".","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"key":"Q96iJzstVa"}],"key":"u9OtAUITFJ"}],"key":"QVSCNBnduV"}],"key":"PBnzRvyDy8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"format short\naccurate_digits = -log10(rel_accuracy)","key":"FSh97tcb54"},{"type":"output","id":"kygyLlkTrgFQMKXO8PTg1","data":[{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>accurate_digits = 3.3952</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"accurate_digits = 3.3952","content_type":"text/plain"}}}],"key":"TX5OCnRI33"}],"data":{},"key":"R6RHChsF1Y"}],"label":"demo-float-accuracy-matlab","identifier":"demo-float-accuracy-matlab","html_id":"demo-float-accuracy-matlab","key":"l3EGgvF5OR"},{"type":"details","open":false,"children":[{"type":"summary","children":[{"type":"text","value":"Floating-point representation","position":{"start":{"line":81,"column":1},"end":{"line":81,"column":1}},"key":"f5rOdu37tI"}],"key":"O9K215DRdZ"},{"type":"paragraph","position":{"start":{"line":83,"column":1},"end":{"line":83,"column":1}},"children":[{"type":"text","value":"In MATLAB, values are double-precision floats unless declared otherwise.","position":{"start":{"line":83,"column":1},"end":{"line":83,"column":1}},"key":"aHOMg0xPHb"}],"key":"o33sjBKBfA"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"fprintf('1 has type: %s', class(1))\nfprintf('1.0 has type: %s', class(1.0))","key":"LomUFXosE6"},{"type":"output","id":"McooJOggwTfxKUDs84GSa","data":[{"output_type":"stream","name":"stdout","text":"1 has type: "},{"output_type":"stream","name":"stdout","text":"double"},{"output_type":"stream","name":"stdout","text":"1.0 has type: "},{"output_type":"stream","name":"stdout","text":"double"}],"key":"cGgTpmBndD"}],"data":{},"key":"pyz0gIHfB3"},{"type":"grid","columns":[1,1,2,2],"children":[{"type":"paragraph","position":{"start":{"line":91,"column":1},"end":{"line":91,"column":1}},"children":[{"type":"text","value":"The spacing between floating-point values in ","position":{"start":{"line":91,"column":1},"end":{"line":91,"column":1}},"key":"B7b1C4I9xu"},{"type":"inlineMath","value":"[2^n,2^{n+1})","position":{"start":{"line":91,"column":1},"end":{"line":91,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><msup><mn>2</mn><mi>n</mi></msup><mo separator=\"true\">,</mo><msup><mn>2</mn><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">[2^n,2^{n+1})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"y7oMME30XE"},{"type":"text","value":" is ","position":{"start":{"line":91,"column":1},"end":{"line":91,"column":1}},"key":"WX8tFV4v9p"},{"type":"inlineMath","value":"2^n \\epsilon_\\text{mach}","position":{"start":{"line":91,"column":1},"end":{"line":91,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mn>2</mn><mi>n</mi></msup><msub><mi>ϵ</mi><mtext>mach</mtext></msub></mrow><annotation encoding=\"application/x-tex\">2^n \\epsilon_\\text{mach}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8144em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\">ϵ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">mach</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"M34K0r1tSk"},{"type":"text","value":", where ","position":{"start":{"line":91,"column":1},"end":{"line":91,"column":1}},"key":"mJY8UQvIFt"},{"type":"inlineMath","value":"\\epsilon_\\text{mach}","position":{"start":{"line":91,"column":1},"end":{"line":91,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>ϵ</mi><mtext>mach</mtext></msub></mrow><annotation encoding=\"application/x-tex\">\\epsilon_\\text{mach}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">ϵ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">mach</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"W8Fle52XW5"},{"type":"text","value":" is machine epsilon. Its value is predefined as ","position":{"start":{"line":91,"column":1},"end":{"line":91,"column":1}},"key":"ysN5qDIwKo"},{"type":"inlineCode","value":"eps","position":{"start":{"line":91,"column":1},"end":{"line":91,"column":1}},"key":"Kpx9yz3jBe"},{"type":"text","value":".","position":{"start":{"line":91,"column":1},"end":{"line":91,"column":1}},"key":"Q0naD0LrfZ"}],"key":"JeI5Fd5q2Z"},{"type":"card","children":[{"type":"paragraph","position":{"start":{"line":95,"column":1},"end":{"line":95,"column":1}},"children":[{"type":"text","value":"While you can assign a different value to ","position":{"start":{"line":95,"column":1},"end":{"line":95,"column":1}},"key":"UuyQ7E2sNq"},{"type":"inlineCode","value":"eps","position":{"start":{"line":95,"column":1},"end":{"line":95,"column":1}},"key":"l1rwPy7opo"},{"type":"text","value":", doing so does not change any arithmetic. It’s generally a bad idea.","position":{"start":{"line":95,"column":1},"end":{"line":95,"column":1}},"key":"F14AS3EnoO"}],"key":"kYj5ZLhNh0"}],"key":"TKa9xGq1kE"}],"key":"NzaYn3Z6NX"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"eps","key":"y9ICh26UMH"},{"type":"output","id":"CVQuLGyzH25mQlBz1v_OS","data":[{"output_type":"execute_result","execution_count":6,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = 2.2204e-16</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = 2.2204e-16","content_type":"text/plain"}}}],"key":"Bw7qpr2MqX"}],"data":{},"key":"hzf5Wb4Q9V"},{"type":"paragraph","position":{"start":{"line":103,"column":1},"end":{"line":103,"column":1}},"children":[{"type":"text","value":"Because double precision allocates 52 bits to the significand, the default value of machine epsilon is ","position":{"start":{"line":103,"column":1},"end":{"line":103,"column":1}},"key":"NYRKz1m9pD"},{"type":"span","position":{"start":{"line":103,"column":1},"end":{"line":103,"column":1}},"children":[{"type":"text","value":"2","key":"yBeG7S5aRv"},{"type":"superscript","children":[{"type":"text","value":"-52","key":"xoocYyYK5S"}],"key":"z7AzIweWNK"}],"key":"OaQfvZERc3"},{"type":"text","value":".","position":{"start":{"line":103,"column":1},"end":{"line":103,"column":1}},"key":"dGNDHUebCI"}],"key":"A5aNo3geFT"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"log2(eps)","key":"NCDQbpGHF3"},{"type":"output","id":"GxFcFUVQhUQR2eFxrAiuf","data":[{"output_type":"execute_result","execution_count":7,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = -52</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = -52","content_type":"text/plain"}}}],"key":"h4QCy7Uaig"}],"data":{},"key":"OEBeh54wRQ"},{"type":"paragraph","position":{"start":{"line":109,"column":1},"end":{"line":109,"column":1}},"children":[{"type":"text","value":"The spacing between adjacent floating-point values is proportional to the magnitude of the value itself. This is how relative precision is kept roughly constant throughout the range of values. You can get the adjusted spacing by calling ","position":{"start":{"line":109,"column":1},"end":{"line":109,"column":1}},"key":"kXtG44WiEM"},{"type":"inlineCode","value":"eps","position":{"start":{"line":109,"column":1},"end":{"line":109,"column":1}},"key":"ZU3YzvofKm"},{"type":"text","value":" with a value.","position":{"start":{"line":109,"column":1},"end":{"line":109,"column":1}},"key":"bhPqdtPbr1"}],"key":"HEHshqhINi"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"eps(1.618)","key":"BxpcSBNlEj"},{"type":"output","id":"0TjLCviL6H7JKneTtuoB2","data":[{"output_type":"execute_result","execution_count":8,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = 2.2204e-16</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = 2.2204e-16","content_type":"text/plain"}}}],"key":"HzGm36dFUw"}],"data":{},"key":"jwrEnt59UI"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"eps(161.8)","key":"rKGQu1i920"},{"type":"output","id":"F0GFY0KaBPYGCQ3yAtT9-","data":[{"output_type":"execute_result","execution_count":9,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = 2.8422e-14</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = 2.8422e-14","content_type":"text/plain"}}}],"key":"LVNOT0FtH1"}],"data":{},"key":"dvfbUJgda1"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"x = 161.8 + 0.1*eps(161.8);\nx - 161.8","key":"wx4tJgQqTQ"},{"type":"output","id":"6zof0Qdj0RNnkbH_go2ww","data":[{"output_type":"execute_result","execution_count":10,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = 0</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = 0","content_type":"text/plain"}}}],"key":"ot8oImY1En"}],"data":{},"key":"XkgMPIpSUT"},{"type":"paragraph","position":{"start":{"line":124,"column":1},"end":{"line":124,"column":1}},"children":[{"type":"text","value":"A common mistake is to think that ","position":{"start":{"line":124,"column":1},"end":{"line":124,"column":1}},"key":"eZpkPDM705"},{"type":"inlineMath","value":"\\epsilon_\\text{mach}","position":{"start":{"line":124,"column":1},"end":{"line":124,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>ϵ</mi><mtext>mach</mtext></msub></mrow><annotation encoding=\"application/x-tex\">\\epsilon_\\text{mach}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">ϵ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">mach</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"MqNHu2znez"},{"type":"text","value":" is the smallest floating-point number. It’s only the smallest ","position":{"start":{"line":124,"column":1},"end":{"line":124,"column":1}},"key":"liyp4ADB8B"},{"type":"emphasis","position":{"start":{"line":124,"column":1},"end":{"line":124,"column":1}},"children":[{"type":"text","value":"relative to 1","position":{"start":{"line":124,"column":1},"end":{"line":124,"column":1}},"key":"B6nPuvrGcp"}],"key":"bIayBU9w2v"},{"type":"text","value":". The correct perspective is that the scaling of values is limited by the exponent, not the mantissa. The actual range of positive values in double precision is","position":{"start":{"line":124,"column":1},"end":{"line":124,"column":1}},"key":"r0a3h0lqDw"}],"key":"GHioiEiGKm"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"format short e\n[realmin, realmax]","key":"jEbnTY3S19"},{"type":"output","id":"vahYwzeD3WnLYFlIXyV-v","data":[{"output_type":"execute_result","execution_count":11,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = 1×2 double\n1.0e+00 *\n\n  2.2251e-308  1.7977e+308\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = 1×2 double\n1.0e+00 *\n\n  2.2251e-308  1.7977e+308\n","content_type":"text/plain"}}}],"key":"ali5xKee2i"}],"data":{},"key":"Rz1rTHcmXk"}],"label":"demo-float-matlab","identifier":"demo-float-matlab","html_id":"demo-float-matlab","key":"mKdm8iaQDb"},{"type":"details","open":false,"children":[{"type":"summary","children":[{"type":"text","value":"Floating-point arithmetic oddity","position":{"start":{"line":134,"column":1},"end":{"line":134,"column":1}},"key":"UosvF4RkMe"}],"key":"zSZ4zq9MDD"},{"type":"paragraph","position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"children":[{"type":"text","value":"There is no double-precision number between ","position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"key":"obNejAzc5j"},{"type":"text","value":"1","position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"key":"Z6AvETYuqw"},{"type":"text","value":" and ","position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"key":"PUB78dnGxu"},{"type":"inlineMath","value":"1+\\epsilon_\\text{mach}","position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mo>+</mo><msub><mi>ϵ</mi><mtext>mach</mtext></msub></mrow><annotation encoding=\"application/x-tex\">1+\\epsilon_\\text{mach}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">ϵ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">mach</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"y4KVkFTQzb"},{"type":"text","value":". Thus the following difference is zero despite its appearance.","position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"key":"zSyV0wHtS3"}],"key":"rBQXoaEL3t"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"( 1 + eps / 2 ) - 1","key":"T6EgmoWxTf"},{"type":"output","id":"eOVdcLRa1HxRL0QJZqTWh","data":[{"output_type":"execute_result","execution_count":12,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = \n     0\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = \n     0\n","content_type":"text/plain"}}}],"key":"LpHkaJqUV7"}],"data":{},"key":"FNwSWmKaVt"},{"type":"paragraph","position":{"start":{"line":143,"column":1},"end":{"line":143,"column":1}},"children":[{"type":"text","value":"However, the spacing between floats in ","position":{"start":{"line":143,"column":1},"end":{"line":143,"column":1}},"key":"hVb7Asw6Lp"},{"type":"inlineMath","value":"[1/2,1)","position":{"start":{"line":143,"column":1},"end":{"line":143,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mn>1</mn><mi mathvariant=\"normal\">/</mi><mn>2</mn><mo separator=\"true\">,</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">[1/2,1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">1/2</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span></span></span>","key":"IR9qEbNYuC"},{"type":"text","value":" is ","position":{"start":{"line":143,"column":1},"end":{"line":143,"column":1}},"key":"MJooEuxr5W"},{"type":"inlineMath","value":"\\macheps/2","position":{"start":{"line":143,"column":1},"end":{"line":143,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>ϵ</mi><mtext>mach</mtext></msub><mi mathvariant=\"normal\">/</mi><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">\\macheps/2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">ϵ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">mach</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">/2</span></span></span></span>","key":"ln65t6a1UN"},{"type":"text","value":", so both ","position":{"start":{"line":143,"column":1},"end":{"line":143,"column":1}},"key":"pi5FmKTO0M"},{"type":"inlineMath","value":"1-\\macheps/2","position":{"start":{"line":143,"column":1},"end":{"line":143,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mo>−</mo><msub><mi>ϵ</mi><mtext>mach</mtext></msub><mi mathvariant=\"normal\">/</mi><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">1-\\macheps/2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">ϵ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">mach</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">/2</span></span></span></span>","key":"HTuCuAy04t"},{"type":"text","value":" and its negative are represented exactly:","position":{"start":{"line":143,"column":1},"end":{"line":143,"column":1}},"key":"XZr4Q6qd22"}],"key":"zFYcyA53it"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"1 - (1 - eps / 2)","key":"aDhNjqIKZC"},{"type":"output","id":"VwfVm7O10JVm_vvEi0JVy","data":[{"output_type":"execute_result","execution_count":13,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = \n   1.1102e-16\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = \n   1.1102e-16\n","content_type":"text/plain"}}}],"key":"GlvABD3sdN"}],"data":{},"key":"ObnKsIO6LN"},{"type":"paragraph","position":{"start":{"line":149,"column":1},"end":{"line":149,"column":1}},"children":[{"type":"text","value":"This is now the expected result. But we have found a rather shocking breakdown of the associative law of addition!","position":{"start":{"line":149,"column":1},"end":{"line":149,"column":1}},"key":"teJ3UoiXyN"}],"key":"fYXxeOVKhs"}],"label":"demo-float-arithmetic-matlab","identifier":"demo-float-arithmetic-matlab","html_id":"demo-float-arithmetic-matlab","key":"KzKyLiB7cB"},{"type":"heading","depth":3,"position":{"start":{"line":152,"column":1},"end":{"line":152,"column":1}},"children":[{"type":"text","value":"Section 1.2","position":{"start":{"line":152,"column":1},"end":{"line":152,"column":1}},"key":"wXxmXzWWvK"}],"identifier":"section-1-2","label":"Section 1.2","html_id":"section-1-2","implicit":true,"key":"qBg9IAFs6h"},{"type":"details","open":false,"children":[{"type":"summary","children":[{"type":"text","value":"Conditioning of polynomial roots","position":{"start":{"line":155,"column":1},"end":{"line":155,"column":1}},"key":"GyXhsQbqXN"}],"key":"tuypjcLYgw"},{"type":"paragraph","position":{"start":{"line":158,"column":1},"end":{"line":158,"column":1}},"children":[{"type":"text","value":"The polynomial ","position":{"start":{"line":158,"column":1},"end":{"line":158,"column":1}},"key":"upuzF9Zaj8"},{"type":"inlineMath","value":"p(x) = \\frac{1}{3}(x-1)(x-1-\\epsilon)","position":{"start":{"line":158,"column":1},"end":{"line":158,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>p</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mfrac><mn>1</mn><mn>3</mn></mfrac><mo stretchy=\"false\">(</mo><mi>x</mi><mo>−</mo><mn>1</mn><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">(</mo><mi>x</mi><mo>−</mo><mn>1</mn><mo>−</mo><mi>ϵ</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">p(x) = \\frac{1}{3}(x-1)(x-1-\\epsilon)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1901em;vertical-align:-0.345em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8451em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">3</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">ϵ</span><span class=\"mclose\">)</span></span></span></span>","key":"d31fn4wKqV"},{"type":"text","value":" has roots ","position":{"start":{"line":158,"column":1},"end":{"line":158,"column":1}},"key":"wYrCJ9KNCn"},{"type":"text","value":"1","position":{"start":{"line":158,"column":1},"end":{"line":158,"column":1}},"key":"OzqvlJ61qV"},{"type":"text","value":" and ","position":{"start":{"line":158,"column":1},"end":{"line":158,"column":1}},"key":"CCQyjqt6O7"},{"type":"inlineMath","value":"1+\\epsilon","position":{"start":{"line":158,"column":1},"end":{"line":158,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mo>+</mo><mi>ϵ</mi></mrow><annotation encoding=\"application/x-tex\">1+\\epsilon</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">ϵ</span></span></span></span>","key":"GSwisr4VRz"},{"type":"text","value":". For small values of ","position":{"start":{"line":158,"column":1},"end":{"line":158,"column":1}},"key":"HnTXbNBGA4"},{"type":"text","value":"ε","position":{"start":{"line":158,"column":1},"end":{"line":158,"column":1}},"key":"lz2RvD5DFP"},{"type":"text","value":", the roots are ill-conditioned.","position":{"start":{"line":158,"column":1},"end":{"line":158,"column":1}},"key":"J6PhD0hwlH"}],"key":"s1E6Boy2Ds"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"ep = 1e-6;\na = 1/3;             % coefficients of p...\nb = (-2 - ep) / 3;   % ...\nc = (1 + ep) / 3;    % ...in ascending order","key":"ejCMAiGOCd"},{"type":"output","id":"ftEPqJrXLodndl3_bixvt","data":[],"key":"AdlvpFQZtS"}],"data":{},"key":"IUdVAnMB5K"},{"type":"paragraph","position":{"start":{"line":168,"column":1},"end":{"line":168,"column":1}},"children":[{"type":"text","value":"Here are the roots as computed by the quadratic formula.","position":{"start":{"line":168,"column":1},"end":{"line":168,"column":1}},"key":"eQLXuHxdQl"}],"key":"xatsv6nMzu"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"d = sqrt(b^2 - 4*a*c);\nformat long   % show all digits\nr1 = (-b - d) / (2*a)\nr2 = (-b + d) / (2*a)","key":"OYBzDPQQ1w"},{"type":"output","id":"z1ftNLjpID_j0Y3T3EEeY","data":[{"output_type":"execute_result","execution_count":15,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>r1 = \n   0.999999999825150\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"r1 = \n   0.999999999825150\n","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":15,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>r2 = \n   1.000001000174850\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"r2 = \n   1.000001000174850\n","content_type":"text/plain"}}}],"key":"sip8YFhn5O"}],"data":{},"key":"CB6fDxWLMb"},{"type":"grid","columns":[1,1,2,2],"children":[{"type":"paragraph","position":{"start":{"line":178,"column":1},"end":{"line":178,"column":1}},"children":[{"type":"text","value":"The display of ","position":{"start":{"line":178,"column":1},"end":{"line":178,"column":1}},"key":"dB8arZl94g"},{"type":"inlineCode","value":"r2","position":{"start":{"line":178,"column":1},"end":{"line":178,"column":1}},"key":"QNjb2vXoyx"},{"type":"text","value":" suggests that the last five digits or so are inaccurate. The relative errors are","position":{"start":{"line":178,"column":1},"end":{"line":178,"column":1}},"key":"J7bkBUx0gY"}],"key":"CkNJ0FvxCL"},{"type":"card","children":[{"type":"paragraph","position":{"start":{"line":180,"column":1},"end":{"line":180,"column":1}},"children":[{"type":"text","value":"Putting values inside square brackets creates a vector.","position":{"start":{"line":180,"column":1},"end":{"line":180,"column":1}},"key":"KAX4kdbXXi"}],"key":"YzxcVHMWPc"}],"key":"ojZijcqgoX"}],"key":"BKlqe69SGB"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"format short e\nerr = abs(r1 - 1) ./ abs(1)\nerr = abs(r2 - (1 + ep)) ./ abs(1 + ep)","key":"e5pUaOovnU"},{"type":"output","id":"9toj-sqcFn6jmZyZSElMA","data":[{"output_type":"execute_result","execution_count":16,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>err = \n   1.7485e-10\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"err = \n   1.7485e-10\n","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":16,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>err = \n   1.7485e-10\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"err = \n   1.7485e-10\n","content_type":"text/plain"}}}],"key":"nbBByx2JQ6"}],"data":{},"key":"wDwVcZ4FxA"},{"type":"paragraph","position":{"start":{"line":190,"column":1},"end":{"line":194,"column":1}},"children":[{"type":"text","value":"The condition number of each root is","position":{"start":{"line":190,"column":1},"end":{"line":190,"column":1}},"key":"bvMkjJb4p7"}],"key":"BoIbZ4Qq24"},{"type":"math","value":"\n\\kappa(r_i) = \\frac{|r_i|}{|r_1-r_2|} \\approx \\frac{1}{\\epsilon}. ","position":{"start":{"line":190,"column":1},"end":{"line":190,"column":1}},"tight":true,"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>κ</mi><mo stretchy=\"false\">(</mo><msub><mi>r</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo><mo>=</mo><mfrac><mrow><mi mathvariant=\"normal\">∣</mi><msub><mi>r</mi><mi>i</mi></msub><mi mathvariant=\"normal\">∣</mi></mrow><mrow><mi mathvariant=\"normal\">∣</mi><msub><mi>r</mi><mn>1</mn></msub><mo>−</mo><msub><mi>r</mi><mn>2</mn></msub><mi mathvariant=\"normal\">∣</mi></mrow></mfrac><mo>≈</mo><mfrac><mn>1</mn><mi>ϵ</mi></mfrac><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">\n\\kappa(r_i) = \\frac{|r_i|}{|r_1-r_2|} \\approx \\frac{1}{\\epsilon}. </annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">κ</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.363em;vertical-align:-0.936em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.427em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">∣</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">∣</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">∣</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">∣</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.936em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.0074em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">ϵ</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mord\">.</span></span></span></span></span>","enumerator":"1","key":"hLMFf2oor5"},{"type":"paragraph","position":{"start":{"line":190,"column":1},"end":{"line":194,"column":1}},"children":[{"type":"text","value":"Thus, relative error in the data at the level of roundoff can grow in the result to be roughly","position":{"start":{"line":190,"column":1},"end":{"line":190,"column":1}},"key":"e82pj3CmDH"}],"key":"WqC9hRdagw"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"eps / ep","key":"HNioQpcghK"},{"type":"output","id":"xRIqdVqfiGm5Rioe_31g1","data":[{"output_type":"execute_result","execution_count":17,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = \n   2.2204e-10\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = \n   2.2204e-10\n","content_type":"text/plain"}}}],"key":"F6F5409ETK"}],"data":{},"key":"TAqA17Ry6f"},{"type":"paragraph","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"children":[{"type":"text","value":"This matches the observation pretty well.","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"key":"r0hRzebXBu"}],"key":"idtM6Xbj0l"}],"label":"demo-condition-roots-matlab","identifier":"demo-condition-roots-matlab","html_id":"demo-condition-roots-matlab","key":"hi2N62p9XO"},{"type":"heading","depth":3,"position":{"start":{"line":203,"column":1},"end":{"line":203,"column":1}},"children":[{"type":"text","value":"Section 1.3","position":{"start":{"line":203,"column":1},"end":{"line":203,"column":1}},"key":"HDp3dPYLen"}],"identifier":"section-1-3","label":"Section 1.3","html_id":"section-1-3","implicit":true,"key":"hEIdGwvKCW"},{"type":"details","open":false,"children":[{"type":"summary","children":[{"type":"text","value":"Using a function","position":{"start":{"line":206,"column":1},"end":{"line":206,"column":1}},"key":"ROssJ8NiPw"}],"key":"kQoR27GtHB"},{"type":"paragraph","position":{"start":{"line":208,"column":1},"end":{"line":208,"column":1}},"children":[{"type":"text","value":"Here we show how to use ","position":{"start":{"line":208,"column":1},"end":{"line":208,"column":1}},"key":"ScPcT6HYlf"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-horner","label":"function-horner","children":[{"type":"text","value":"Function ","key":"YZrKpfx38Q"},{"type":"text","value":"1.3.1","key":"S69RCeIIOW"}],"template":"Algorithm %s","enumerator":"1.3.1","resolved":true,"html_id":"function-horner","remote":true,"url":"/algorithms","dataUrl":"/algorithms.json","key":"GKMHYMXIyu"},{"type":"text","value":" to evaluate a polynomial. Let us define a vector of the coefficients of ","position":{"start":{"line":208,"column":1},"end":{"line":208,"column":1}},"key":"hAmFgYwaJe"},{"type":"inlineMath","value":"p(x)=(x-1)^3=x^3-3x^2+3x-1","position":{"start":{"line":208,"column":1},"end":{"line":208,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>p</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mo stretchy=\"false\">(</mo><mi>x</mi><mo>−</mo><mn>1</mn><msup><mo stretchy=\"false\">)</mo><mn>3</mn></msup><mo>=</mo><msup><mi>x</mi><mn>3</mn></msup><mo>−</mo><mn>3</mn><msup><mi>x</mi><mn>2</mn></msup><mo>+</mo><mn>3</mn><mi>x</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">p(x)=(x-1)^3=x^3-3x^2+3x-1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8974em;vertical-align:-0.0833em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8974em;vertical-align:-0.0833em;\"></span><span class=\"mord\">3</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">3</span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"QHxygmF2S6"},{"type":"text","value":", in ascending degree order.","position":{"start":{"line":208,"column":1},"end":{"line":208,"column":1}},"key":"HlombAXJeK"}],"key":"mVFoltzja9"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"c = [1, -3, 3, 1]","key":"QdF8CTByyD"},{"type":"output","id":"pavDFn77wNWKQiHz41gLC","data":[{"output_type":"execute_result","execution_count":18,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>c = 1×4 double\n     1    -3     3     1\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"c = 1×4 double\n     1    -3     3     1\n","content_type":"text/plain"}}}],"key":"ZhEWu71j7x"}],"data":{},"key":"y9wU6NOSPQ"},{"type":"paragraph","position":{"start":{"line":214,"column":1},"end":{"line":214,"column":1}},"children":[{"type":"text","value":"Now we evaluate ","position":{"start":{"line":214,"column":1},"end":{"line":214,"column":1}},"key":"sk2ahbYVFe"},{"type":"inlineMath","value":"p(1.6)","position":{"start":{"line":214,"column":1},"end":{"line":214,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>p</mi><mo stretchy=\"false\">(</mo><mn>1.6</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">p(1.6)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mopen\">(</span><span class=\"mord\">1.6</span><span class=\"mclose\">)</span></span></span></span>","key":"nOSpzViTQE"},{"type":"text","value":" using the function ","position":{"start":{"line":214,"column":1},"end":{"line":214,"column":1}},"key":"MMFEpAPOFA"},{"type":"inlineCode","value":"horner","position":{"start":{"line":214,"column":1},"end":{"line":214,"column":1}},"key":"P59kqtcj1M"},{"type":"text","value":".","position":{"start":{"line":214,"column":1},"end":{"line":214,"column":1}},"key":"o6mBVeozKf"}],"key":"eTHbE1S4ml"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"horner(c, 1.6)","key":"kVJPHknPfg"},{"type":"output","id":"rBeFLpHs_JwMR-eqDbrtu","data":[{"output_type":"execute_result","execution_count":19,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = \n   2.2160e+00\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = \n   2.2160e+00\n","content_type":"text/plain"}}}],"key":"riuMR0vZHf"}],"data":{},"key":"q8m68W03oq"},{"type":"paragraph","position":{"start":{"line":220,"column":1},"end":{"line":220,"column":1}},"children":[{"type":"text","value":"The result above is the value of ","position":{"start":{"line":220,"column":1},"end":{"line":220,"column":1}},"key":"QS6Uvd9jIv"},{"type":"inlineMath","value":"p(1.6)","position":{"start":{"line":220,"column":1},"end":{"line":220,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>p</mi><mo stretchy=\"false\">(</mo><mn>1.6</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">p(1.6)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mopen\">(</span><span class=\"mord\">1.6</span><span class=\"mclose\">)</span></span></span></span>","key":"vlCC5rfnfY"},{"type":"text","value":".","position":{"start":{"line":220,"column":1},"end":{"line":220,"column":1}},"key":"ED0RqWttJ1"}],"key":"m8uWQeMUjl"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"GPJ7LLelfk"}],"key":"ILtDRC2JkZ"},{"type":"paragraph","position":{"start":{"line":223,"column":1},"end":{"line":223,"column":1}},"children":[{"type":"text","value":"The comments at the start of ","position":{"start":{"line":223,"column":1},"end":{"line":223,"column":1}},"key":"XYnsFoXLIw"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-horner","label":"function-horner","children":[{"type":"text","value":"Function ","key":"PNdHFIY58u"},{"type":"text","value":"1.3.1","key":"DcUTKOzstw"}],"template":"Algorithm %s","enumerator":"1.3.1","resolved":true,"html_id":"function-horner","remote":true,"url":"/algorithms","dataUrl":"/algorithms.json","key":"m4G90Dx1Cx"},{"type":"text","value":" are documentation, which we can access using ","position":{"start":{"line":223,"column":1},"end":{"line":223,"column":1}},"key":"arjPgHKdMo"},{"type":"inlineCode","value":"help horner","position":{"start":{"line":223,"column":1},"end":{"line":223,"column":1}},"key":"WDXBfR1n6J"},{"type":"text","value":".","position":{"start":{"line":223,"column":1},"end":{"line":223,"column":1}},"key":"uXZgmEiDnr"}],"key":"yokdeu1QsR"}],"key":"gIutcclW8G"}],"label":"demo-algorithms-horner-matlab","identifier":"demo-algorithms-horner-matlab","html_id":"demo-algorithms-horner-matlab","key":"cetCoS6Xkh"},{"type":"heading","depth":3,"position":{"start":{"line":227,"column":1},"end":{"line":227,"column":1}},"children":[{"type":"text","value":"Section 1.4","position":{"start":{"line":227,"column":1},"end":{"line":227,"column":1}},"key":"QOIqHPcEtd"}],"identifier":"section-1-4","label":"Section 1.4","html_id":"section-1-4","implicit":true,"key":"bowAs8cI72"},{"type":"details","open":false,"children":[{"type":"summary","children":[{"type":"text","value":"Instability of the quadratic formula","position":{"start":{"line":230,"column":1},"end":{"line":230,"column":1}},"key":"tsz65Lbeyf"}],"key":"xZpbTJ8nTs"},{"type":"grid","columns":[1,1,2,2],"children":[{"type":"paragraph","position":{"start":{"line":237,"column":1},"end":{"line":237,"column":1}},"children":[{"type":"text","value":"We apply the quadratic formula to find the roots of a quadratic via ","position":{"start":{"line":237,"column":1},"end":{"line":237,"column":1}},"key":"UP9N1uz3kC"},{"type":"crossReference","kind":"equation","identifier":"quadunstable","label":"quadunstable","children":[{"type":"text","value":"(","key":"AVrKpweWwl"},{"type":"text","value":"1.4.1","key":"p4UV5DYpEn"},{"type":"text","value":")","key":"IQuiFTsh6g"}],"template":"(%s)","enumerator":"1.4.1","resolved":true,"html_id":"quadunstable","remote":true,"url":"/stability","dataUrl":"/stability.json","key":"kitT0Tzssh"},{"type":"text","value":".","position":{"start":{"line":237,"column":1},"end":{"line":237,"column":1}},"key":"vBDRVtj3bc"}],"key":"Aribqdzpyy"},{"type":"card","children":[{"type":"paragraph","position":{"start":{"line":240,"column":1},"end":{"line":240,"column":1}},"children":[{"type":"text","value":"A number in scientific notation is entered as ","position":{"start":{"line":240,"column":1},"end":{"line":240,"column":1}},"key":"oCxStpNBxn"},{"type":"inlineCode","value":"1.23e4","position":{"start":{"line":240,"column":1},"end":{"line":240,"column":1}},"key":"vMPm02JxBF"},{"type":"text","value":" rather than as ","position":{"start":{"line":240,"column":1},"end":{"line":240,"column":1}},"key":"mVHatYSljm"},{"type":"inlineCode","value":"1.23 * 10^4","position":{"start":{"line":240,"column":1},"end":{"line":240,"column":1}},"key":"gr8RXMvcTC"},{"type":"text","value":".","position":{"start":{"line":240,"column":1},"end":{"line":240,"column":1}},"key":"lDtMp9Ydpz"}],"key":"ckjykXjo0F"}],"key":"GHcxuKGRTC"}],"indexEntries":[{"entry":"MATLAB","subEntry":{"value":"scientific notation","kind":"entry"},"emphasis":true}],"label":"index-IPhZKMf9UV","identifier":"index-iphzkmf9uv","html_id":"index-iphzkmf9uv","key":"OXU0Ee72wH"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"a = 1;  b = -(1e6 + 1e-6);  c = 1;\nx1 = (-b + sqrt(b^2 - 4*a*c)) / (2*a)\nx2 = (-b - sqrt(b^2 - 4*a*c)) / (2*a)","key":"gXP6OmpYi7"},{"type":"output","id":"NRW-kvxmfJfhn71auXd_c","data":[{"output_type":"execute_result","execution_count":20,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>x1 = \n     1000000\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"x1 = \n     1000000\n","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":20,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>x2 = \n   1.0000e-06\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"x2 = \n   1.0000e-06\n","content_type":"text/plain"}}}],"key":"YFLZp0gei0"}],"data":{},"key":"FfWmzona2F"},{"type":"paragraph","position":{"start":{"line":250,"column":1},"end":{"line":250,"column":1}},"children":[{"type":"text","value":"The first value is correct to all stored digits, but the second has fewer than six accurate digits:","position":{"start":{"line":250,"column":1},"end":{"line":250,"column":1}},"key":"C8oZ6cxERL"}],"key":"aR1MJXwtnQ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"error = abs(x2 - 1e-6) / 1e-6 \naccurate_digits = -log10(error)","key":"Y8e6jBRXcu"},{"type":"output","id":"qDkhHP-NxGOnQEBQOQNYw","data":[{"output_type":"execute_result","execution_count":21,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>error = \n   7.6145e-06\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"error = \n   7.6145e-06\n","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":21,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>accurate_digits = \n   5.1184e+00\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"accurate_digits = \n   5.1184e+00\n","content_type":"text/plain"}}}],"key":"sK7dsdXSIu"}],"data":{},"key":"NZLUJmaFZR"},{"type":"paragraph","position":{"start":{"line":257,"column":1},"end":{"line":257,"column":1}},"children":[{"type":"text","value":"The instability is easily explained. Since ","position":{"start":{"line":257,"column":1},"end":{"line":257,"column":1}},"key":"pLCDlOD4qd"},{"type":"inlineMath","value":"a=c=1","position":{"start":{"line":257,"column":1},"end":{"line":257,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi><mo>=</mo><mi>c</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">a=c=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">c</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"R98ABr8q25"},{"type":"text","value":", we treat them as exact numbers. First, we compute the condition numbers with respect to ","position":{"start":{"line":257,"column":1},"end":{"line":257,"column":1}},"key":"MLs635Mq4k"},{"type":"inlineMath","value":"b","position":{"start":{"line":257,"column":1},"end":{"line":257,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>b</mi></mrow><annotation encoding=\"application/x-tex\">b</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">b</span></span></span></span>","key":"xBYFHeXZKK"},{"type":"text","value":" for each elementary step in finding the “good” root:","position":{"start":{"line":257,"column":1},"end":{"line":257,"column":1}},"key":"DLOG7T6QT1"}],"key":"Tfcu5TavNp"},{"type":"table","position":{"start":{"line":259,"column":1},"end":{"line":265,"column":1}},"children":[{"type":"tableRow","position":{"start":{"line":259,"column":1},"end":{"line":259,"column":1}},"children":[{"type":"tableCell","header":true,"align":"left","position":{"start":{"line":259,"column":1},"end":{"line":259,"column":1}},"children":[{"type":"text","value":"Calculation","position":{"start":{"line":259,"column":1},"end":{"line":259,"column":1}},"key":"s6HsUbSyds"}],"key":"O6ADjatdhh"},{"type":"tableCell","header":true,"align":"left","position":{"start":{"line":259,"column":1},"end":{"line":259,"column":1}},"children":[{"type":"text","value":"Result","position":{"start":{"line":259,"column":1},"end":{"line":259,"column":1}},"key":"hEdSP6dPF2"}],"key":"nEAWo6KsZW"},{"type":"tableCell","header":true,"align":"left","position":{"start":{"line":259,"column":1},"end":{"line":259,"column":1}},"children":[{"type":"text","value":"κ","position":{"start":{"line":259,"column":1},"end":{"line":259,"column":1}},"key":"gwFhz89Gbs"}],"key":"bJADOcZawy"}],"key":"mPX7oTRGdz"},{"type":"tableRow","position":{"start":{"line":261,"column":1},"end":{"line":261,"column":1}},"children":[{"type":"tableCell","align":"left","position":{"start":{"line":261,"column":1},"end":{"line":261,"column":1}},"children":[{"type":"inlineMath","value":"u_1 = b^2","position":{"start":{"line":261,"column":1},"end":{"line":261,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>u</mi><mn>1</mn></msub><mo>=</mo><msup><mi>b</mi><mn>2</mn></msup></mrow><annotation encoding=\"application/x-tex\">u_1 = b^2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span>","key":"ueKRjzUb6h"}],"key":"BfZrbAGzGX"},{"type":"tableCell","align":"left","position":{"start":{"line":261,"column":1},"end":{"line":261,"column":1}},"children":[{"type":"inlineMath","value":"1.000000000002000\\times 10^{12}","position":{"start":{"line":261,"column":1},"end":{"line":261,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1.000000000002000</mn><mo>×</mo><mn>1</mn><msup><mn>0</mn><mn>12</mn></msup></mrow><annotation encoding=\"application/x-tex\">1.000000000002000\\times 10^{12}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">1.000000000002000</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">12</span></span></span></span></span></span></span></span></span></span></span></span>","key":"xjkQ8puBkQ"}],"key":"CdoQdHFtYv"},{"type":"tableCell","align":"left","position":{"start":{"line":261,"column":1},"end":{"line":261,"column":1}},"children":[{"type":"text","value":"2","position":{"start":{"line":261,"column":1},"end":{"line":261,"column":1}},"key":"AKmSrH6eQe"}],"key":"RfP3uFmBxu"}],"key":"GPOT3e7aay"},{"type":"tableRow","position":{"start":{"line":262,"column":1},"end":{"line":262,"column":1}},"children":[{"type":"tableCell","align":"left","position":{"start":{"line":262,"column":1},"end":{"line":262,"column":1}},"children":[{"type":"inlineMath","value":"u_2 = u_1 - 4","position":{"start":{"line":262,"column":1},"end":{"line":262,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>u</mi><mn>2</mn></msub><mo>=</mo><msub><mi>u</mi><mn>1</mn></msub><mo>−</mo><mn>4</mn></mrow><annotation encoding=\"application/x-tex\">u_2 = u_1 - 4</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">4</span></span></span></span>","key":"iVFrCyWy8S"}],"key":"yq57oHpRke"},{"type":"tableCell","align":"left","position":{"start":{"line":262,"column":1},"end":{"line":262,"column":1}},"children":[{"type":"inlineMath","value":"9.999999999980000\\times 10^{11}","position":{"start":{"line":262,"column":1},"end":{"line":262,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>9.999999999980000</mn><mo>×</mo><mn>1</mn><msup><mn>0</mn><mn>11</mn></msup></mrow><annotation encoding=\"application/x-tex\">9.999999999980000\\times 10^{11}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">9.999999999980000</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">11</span></span></span></span></span></span></span></span></span></span></span></span>","key":"YvH7x9kMLu"}],"key":"CmJGPuMObO"},{"type":"tableCell","align":"left","position":{"start":{"line":262,"column":1},"end":{"line":262,"column":1}},"children":[{"type":"inlineMath","value":"\\approx 1.00","position":{"start":{"line":262,"column":1},"end":{"line":262,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>≈</mo><mn>1.00</mn></mrow><annotation encoding=\"application/x-tex\">\\approx 1.00</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4831em;\"></span><span class=\"mrel\">≈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1.00</span></span></span></span>","key":"YCixKHiq5U"}],"key":"kGS3mB7WaX"}],"key":"FBvBvaBQl1"},{"type":"tableRow","position":{"start":{"line":263,"column":1},"end":{"line":263,"column":1}},"children":[{"type":"tableCell","align":"left","position":{"start":{"line":263,"column":1},"end":{"line":263,"column":1}},"children":[{"type":"inlineMath","value":"u_3 = \\sqrt{u_2}","position":{"start":{"line":263,"column":1},"end":{"line":263,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>u</mi><mn>3</mn></msub><mo>=</mo><msqrt><msub><mi>u</mi><mn>2</mn></msub></msqrt></mrow><annotation encoding=\"application/x-tex\">u_3 = \\sqrt{u_2}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.04em;vertical-align:-0.3147em;\"></span><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7253em;\"><span class=\"svg-align\" style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\" style=\"padding-left:0.833em;\"><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-2.6853em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"hide-tail\" style=\"min-width:0.853em;height:1.08em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\nc69,-144,104.5,-217.7,106.5,-221\nl0 -0\nc5.3,-9.3,12,-14,20,-14\nH400000v40H845.2724\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\nM834 80h400000v40h-400000z'/></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3147em;\"><span></span></span></span></span></span></span></span></span>","key":"GlEAs2l4fh"}],"key":"BZxWKvPR44"},{"type":"tableCell","align":"left","position":{"start":{"line":263,"column":1},"end":{"line":263,"column":1}},"children":[{"type":"text","value":"999999.9999990000","position":{"start":{"line":263,"column":1},"end":{"line":263,"column":1}},"key":"NjlJvmmcO9"}],"key":"cIggsKBydR"},{"type":"tableCell","align":"left","position":{"start":{"line":263,"column":1},"end":{"line":263,"column":1}},"children":[{"type":"text","value":"1/2","position":{"start":{"line":263,"column":1},"end":{"line":263,"column":1}},"key":"hcAm3eWqxb"}],"key":"CcyYHe5fp9"}],"key":"VUWjbQbOQC"},{"type":"tableRow","position":{"start":{"line":264,"column":1},"end":{"line":264,"column":1}},"children":[{"type":"tableCell","align":"left","position":{"start":{"line":264,"column":1},"end":{"line":264,"column":1}},"children":[{"type":"inlineMath","value":"u_4 = u_3 - b","position":{"start":{"line":264,"column":1},"end":{"line":264,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>u</mi><mn>4</mn></msub><mo>=</mo><msub><mi>u</mi><mn>3</mn></msub><mo>−</mo><mi>b</mi></mrow><annotation encoding=\"application/x-tex\">u_4 = u_3 - b</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">4</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">b</span></span></span></span>","key":"R7f71eWxQY"}],"key":"P2aABTydS6"},{"type":"tableCell","align":"left","position":{"start":{"line":264,"column":1},"end":{"line":264,"column":1}},"children":[{"type":"text","value":"2000000","position":{"start":{"line":264,"column":1},"end":{"line":264,"column":1}},"key":"G7zUcjsRPe"}],"key":"ddO3TLx5TX"},{"type":"tableCell","align":"left","position":{"start":{"line":264,"column":1},"end":{"line":264,"column":1}},"children":[{"type":"inlineMath","value":"\\approx 0.500","position":{"start":{"line":264,"column":1},"end":{"line":264,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>≈</mo><mn>0.500</mn></mrow><annotation encoding=\"application/x-tex\">\\approx 0.500</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4831em;\"></span><span class=\"mrel\">≈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0.500</span></span></span></span>","key":"FEgvo3DLfx"}],"key":"NXlEoOG3Aa"}],"key":"YmyxY6vZN8"},{"type":"tableRow","position":{"start":{"line":265,"column":1},"end":{"line":265,"column":1}},"children":[{"type":"tableCell","align":"left","position":{"start":{"line":265,"column":1},"end":{"line":265,"column":1}},"children":[{"type":"inlineMath","value":"u_5 = u_4/2","position":{"start":{"line":265,"column":1},"end":{"line":265,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>u</mi><mn>5</mn></msub><mo>=</mo><msub><mi>u</mi><mn>4</mn></msub><mi mathvariant=\"normal\">/</mi><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">u_5 = u_4/2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">5</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">4</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">/2</span></span></span></span>","key":"qB6oIRmoY4"}],"key":"F6Fhfsq0YV"},{"type":"tableCell","align":"left","position":{"start":{"line":265,"column":1},"end":{"line":265,"column":1}},"children":[{"type":"text","value":"1000000","position":{"start":{"line":265,"column":1},"end":{"line":265,"column":1}},"key":"x6DmT5B7gf"}],"key":"KMZIdIB7tF"},{"type":"tableCell","align":"left","position":{"start":{"line":265,"column":1},"end":{"line":265,"column":1}},"children":[{"type":"text","value":"1","position":{"start":{"line":265,"column":1},"end":{"line":265,"column":1}},"key":"kz0cu8mfgc"}],"key":"a7Ut7JKand"}],"key":"Tx9F2dUxRE"}],"key":"t3M1iWYfor"},{"type":"paragraph","position":{"start":{"line":267,"column":1},"end":{"line":267,"column":1}},"children":[{"type":"text","value":"Using ","position":{"start":{"line":267,"column":1},"end":{"line":267,"column":1}},"key":"kYXUckAfa8"},{"type":"crossReference","kind":"equation","identifier":"condition-chain","label":"condition-chain","children":[{"type":"text","value":"(","key":"EHu6FJJfIw"},{"type":"text","value":"1.2.9","key":"QrfBl8VLKY"},{"type":"text","value":")","key":"G8nKtYixCm"}],"template":"(%s)","enumerator":"1.2.9","resolved":true,"html_id":"condition-chain","remote":true,"url":"/conditioning","dataUrl":"/conditioning.json","key":"nR8dE8flHX"},{"type":"text","value":", the chain rule for condition numbers, the conditioning of the entire chain is the product of the individual steps, so there is essentially no growth of relative error here. However, if we use the quadratic formula for the “bad” root, the next-to-last step becomes ","position":{"start":{"line":267,"column":1},"end":{"line":267,"column":1}},"key":"YS6nX6hCSg"},{"type":"inlineMath","value":"u_4=(-u_3) - b","position":{"start":{"line":267,"column":1},"end":{"line":267,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>u</mi><mn>4</mn></msub><mo>=</mo><mo stretchy=\"false\">(</mo><mo>−</mo><msub><mi>u</mi><mn>3</mn></msub><mo stretchy=\"false\">)</mo><mo>−</mo><mi>b</mi></mrow><annotation encoding=\"application/x-tex\">u_4=(-u_3) - b</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">4</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\">−</span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">b</span></span></span></span>","key":"Pq3F0teLCV"},{"type":"text","value":", and now  ","position":{"start":{"line":267,"column":1},"end":{"line":267,"column":1}},"key":"g6baKU8nH0"},{"type":"inlineMath","value":"\\kappa=|u_3|/|u_4|\\approx 5\\times 10^{11}","position":{"start":{"line":267,"column":1},"end":{"line":267,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>κ</mi><mo>=</mo><mi mathvariant=\"normal\">∣</mi><msub><mi>u</mi><mn>3</mn></msub><mi mathvariant=\"normal\">∣</mi><mi mathvariant=\"normal\">/</mi><mi mathvariant=\"normal\">∣</mi><msub><mi>u</mi><mn>4</mn></msub><mi mathvariant=\"normal\">∣</mi><mo>≈</mo><mn>5</mn><mo>×</mo><mn>1</mn><msup><mn>0</mn><mn>11</mn></msup></mrow><annotation encoding=\"application/x-tex\">\\kappa=|u_3|/|u_4|\\approx 5\\times 10^{11}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">κ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">∣</span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">∣/∣</span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">4</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">∣</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">5</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">11</span></span></span></span></span></span></span></span></span></span></span></span>","key":"CEZmcwLAF5"},{"type":"text","value":". So we can expect to lose 11 digits of accuracy, which is what we observed. The key issue is the subtractive cancellation in this one step.","position":{"start":{"line":267,"column":1},"end":{"line":267,"column":1}},"key":"eHcwPhLLrN"}],"key":"vJDZx3CbFU"}],"label":"demo-stability-quadbad-matlab","identifier":"demo-stability-quadbad-matlab","html_id":"demo-stability-quadbad-matlab","key":"o2h4UBKu5k"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Stable alternative to the quadratic formula","position":{"start":{"line":271,"column":1},"end":{"line":271,"column":1}},"key":"JIYhGaoxHJ"}],"key":"OBg8Mn4qaF"},{"type":"paragraph","position":{"start":{"line":272,"column":1},"end":{"line":272,"column":1}},"children":[{"type":"text","value":"We repeat the rootfinding experiment of ","position":{"start":{"line":272,"column":1},"end":{"line":272,"column":1}},"key":"edEEQu4DNQ"},{"type":"crossReference","kind":"proof:example","identifier":"demo-stability-quadbad","label":"demo-stability-quadbad","children":[{"type":"text","value":"Demo ","key":"ZFsoeKSaAI"},{"type":"text","value":"1.4.1","key":"SjWhMOP0qg"}],"template":"Example %s","enumerator":"1.4.1","resolved":true,"html_id":"demo-stability-quadbad","remote":true,"url":"/stability","dataUrl":"/stability.json","key":"WjCd2wYm0b"},{"type":"text","value":" with an alternative algorithm.","position":{"start":{"line":272,"column":1},"end":{"line":272,"column":1}},"key":"QyGg6h39Hx"}],"key":"sSOUAvhngg"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"a = 1;  b = -(1e6 + 1e-6);  c = 1;","key":"Diad7eId2a"},{"type":"output","id":"L0vjLRMI3VWj-8AUj2L-G","data":[],"key":"G5Mm9WokYb"}],"data":{},"key":"nZibQGPLpN"},{"type":"paragraph","position":{"start":{"line":278,"column":1},"end":{"line":278,"column":1}},"children":[{"type":"text","value":"First, we find the “good” root using the quadratic formula.","position":{"start":{"line":278,"column":1},"end":{"line":278,"column":1}},"key":"yJYWINCyjR"}],"key":"tqkImiQbIk"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"x1 = (-b + sqrt(b^2 - 4*a*c)) / (2*a);","key":"xgrMarVLrx"},{"type":"output","id":"gT1-7PGyBPgV9pw6PiROK","data":[],"key":"VCUFLOky88"}],"data":{},"key":"htooE4x7gB"},{"type":"paragraph","position":{"start":{"line":284,"column":1},"end":{"line":284,"column":1}},"children":[{"type":"text","value":"Then we use the identity ","position":{"start":{"line":284,"column":1},"end":{"line":284,"column":1}},"key":"mvGteTvwP0"},{"type":"inlineMath","value":"x_1x_2=\\frac{c}{a}","position":{"start":{"line":284,"column":1},"end":{"line":284,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub><msub><mi>x</mi><mn>2</mn></msub><mo>=</mo><mfrac><mi>c</mi><mi>a</mi></mfrac></mrow><annotation encoding=\"application/x-tex\">x_1x_2=\\frac{c}{a}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0404em;vertical-align:-0.345em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6954em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">a</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">c</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span>","key":"wNqUnZKwuD"},{"type":"text","value":" to compute the smaller root:","position":{"start":{"line":284,"column":1},"end":{"line":284,"column":1}},"key":"lKcjDcd2Li"}],"key":"A5FbwnhSAY"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"x2 = c / (a*x1)","key":"bDezFJDfyx"},{"type":"output","id":"Hsd6TvxXBWDLczk1j7H_3","data":[{"output_type":"execute_result","execution_count":24,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>x2 = \n   1.0000e-06\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"x2 = \n   1.0000e-06\n","content_type":"text/plain"}}}],"key":"TSXbzMzEmM"}],"data":{},"key":"p3pZGgFepB"},{"type":"paragraph","position":{"start":{"line":290,"column":1},"end":{"line":290,"column":1}},"children":[{"type":"text","value":"This matches the exact root to the displayed digits; to be sure we have an accurate result, we compute its relative error.","position":{"start":{"line":290,"column":1},"end":{"line":290,"column":1}},"key":"ksOT2HBasM"}],"key":"ulQQFgolEK"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"abs(x2 - 1e-6) / 1e-6","key":"QpWkaQoOvP"},{"type":"output","id":"AQsiTya-EW-0ktCg0q4Eb","data":[{"output_type":"execute_result","execution_count":25,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = \n     0\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = \n     0\n","content_type":"text/plain"}}}],"key":"mxTdqBca2x"}],"data":{},"key":"pB2dae002B"}],"label":"demo-stability-quadgood-matlab","identifier":"demo-stability-quadgood-matlab","html_id":"demo-stability-quadgood-matlab","key":"h9d5CwFrug"},{"type":"details","open":false,"children":[{"type":"summary","children":[{"type":"text","value":"Backward error","position":{"start":{"line":298,"column":1},"end":{"line":298,"column":1}},"key":"eyLX4IBgh4"}],"key":"wl8UGJkpUh"},{"type":"grid","columns":[1,1,2,2],"children":[{"type":"paragraph","position":{"start":{"line":303,"column":1},"end":{"line":303,"column":1}},"children":[{"type":"text","value":"Our first step is to construct a polynomial with six known roots.","position":{"start":{"line":303,"column":1},"end":{"line":303,"column":1}},"key":"KxGrKBFXIx"}],"key":"TYxC7gXP0k"},{"type":"card","children":[{"type":"paragraph","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":1}},"key":"fts2YdAHA0"},{"type":"inlineCode","value":"'","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":1}},"key":"s7DX2W0IGt"},{"type":"text","value":" operator is used for transposition. Here, we want to make ","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":1}},"key":"FKHM2o25DW"},{"type":"inlineCode","value":"r","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":1}},"key":"YdSbi3uKtF"},{"type":"text","value":" a column vector.","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":1}},"key":"qYMvDEHHB8"}],"key":"xiTAQmJVp2"}],"key":"m29S3STMYX"}],"key":"cWOKLi5t5n"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"r = [-2 ,-1, 1, 1, 3, 6]';\np = poly(r)","key":"dideERb8mO"},{"type":"output","id":"OXsb7QXGZXZq0fWRibm7k","data":[{"output_type":"execute_result","execution_count":26,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>p = 1×7 double\n     1    -8     6    44   -43   -36    36\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"p = 1×7 double\n     1    -8     6    44   -43   -36    36\n","content_type":"text/plain"}}}],"key":"Y1hBgdKarA"}],"data":{},"key":"P6wUPxyc5k"},{"type":"paragraph","position":{"start":{"line":314,"column":1},"end":{"line":314,"column":1}},"children":[{"type":"text","value":"Now we use a standard numerical method for finding those roots, pretending that we don’t know them already. This corresponds to ","position":{"start":{"line":314,"column":1},"end":{"line":314,"column":1}},"key":"aEMITyWC3L"},{"type":"inlineMath","value":"\\tilde{y}","position":{"start":{"line":314,"column":1},"end":{"line":314,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mover accent=\"true\"><mi>y</mi><mo>~</mo></mover></mrow><annotation encoding=\"application/x-tex\">\\tilde{y}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8623em;vertical-align:-0.1944em;\"></span><span class=\"mord accent\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6679em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span><span style=\"top:-3.35em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.1944em;\"><span class=\"mord\">~</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1944em;\"><span></span></span></span></span></span></span></span></span>","key":"KLJBuZEaPi"},{"type":"text","value":" in ","position":{"start":{"line":314,"column":1},"end":{"line":314,"column":1}},"key":"CmAdSci5wp"},{"type":"crossReference","kind":"proof:definition","identifier":"definition-stability-backward","label":"definition-stability-backward","children":[{"type":"text","value":"Definition ","key":"C5pUTL71ot"},{"type":"text","value":"1.4.1","key":"lWJSJvIz9K"}],"template":"Definition %s","enumerator":"1.4.1","resolved":true,"html_id":"definition-stability-backward","remote":true,"url":"/stability","dataUrl":"/stability.json","key":"iG4nhZKnO7"},{"type":"text","value":".","position":{"start":{"line":314,"column":1},"end":{"line":314,"column":1}},"key":"eGAzLiOBBH"}],"key":"ZIVoEULhWu"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"rr = sort(roots(p))","key":"rrhSes7Nq8"},{"type":"output","id":"fLWMHFoMkB8kE_KsBAzCT","data":[{"output_type":"execute_result","execution_count":27,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>rr = 6×1 double\n  -2.0000e+00\n  -1.0000e+00\n   1.0000e+00\n   1.0000e+00\n   3.0000e+00\n   6.0000e+00\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"rr = 6×1 double\n  -2.0000e+00\n  -1.0000e+00\n   1.0000e+00\n   1.0000e+00\n   3.0000e+00\n   6.0000e+00\n","content_type":"text/plain"}}}],"key":"R4Ynz6Q1zO"}],"data":{},"key":"a9lOVlVLcf"},{"type":"grid","columns":[1,1,2,2],"children":[{"type":"paragraph","position":{"start":{"line":321,"column":1},"end":{"line":321,"column":1}},"children":[{"type":"text","value":"Here are the relative errors in each of the computed roots.","position":{"start":{"line":321,"column":1},"end":{"line":321,"column":1}},"key":"GF1uAcaQny"}],"key":"bV53oVz1Jf"},{"type":"card","children":[{"type":"paragraph","position":{"start":{"line":323,"column":1},"end":{"line":323,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":323,"column":1},"end":{"line":323,"column":1}},"key":"pQUqfSkxK0"},{"type":"inlineCode","value":"./","position":{"start":{"line":323,"column":1},"end":{"line":323,"column":1}},"key":"XGAeIZin80"},{"type":"text","value":" operator is used for element-wise division.","position":{"start":{"line":323,"column":1},"end":{"line":323,"column":1}},"key":"sOFGiGImmz"}],"key":"OZ544DBx2B"}],"key":"PuSoDLnoBI"}],"key":"jKauMWKIZz"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"disp(\"Root errors:\") \nabs(r - rr) ./ r","key":"e79ed4cKs3"},{"type":"output","id":"DTq83PFANJRnNb8CGtTdL","data":[{"output_type":"stream","name":"stdout","text":"Root errors:"},{"output_type":"stream","name":"stdout","text":"\n"},{"output_type":"execute_result","execution_count":28,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = 6×1 double\n1.0e+00 *\n\n  -2.2204e-16\n  -9.9920e-16\n   8.5339e-09\n   8.5339e-09\n            0\n   1.0362e-15\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = 6×1 double\n1.0e+00 *\n\n  -2.2204e-16\n  -9.9920e-16\n   8.5339e-09\n   8.5339e-09\n            0\n   1.0362e-15\n","content_type":"text/plain"}}}],"key":"gQRCB0dKGk"}],"data":{},"key":"JagX8Ikeso"},{"type":"paragraph","position":{"start":{"line":332,"column":1},"end":{"line":332,"column":1}},"children":[{"type":"text","value":"It seems that the forward error is acceptably close to machine epsilon for double precision in all cases except the double root at ","position":{"start":{"line":332,"column":1},"end":{"line":332,"column":1}},"key":"KlluZXxrbS"},{"type":"inlineMath","value":"x=1","position":{"start":{"line":332,"column":1},"end":{"line":332,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">x=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"OU0FTF4S0r"},{"type":"text","value":". This is not a surprise, though, given the poor conditioning at such roots.","position":{"start":{"line":332,"column":1},"end":{"line":332,"column":1}},"key":"q87V8aGIL2"}],"key":"YLJWsAGGN4"},{"type":"paragraph","position":{"start":{"line":334,"column":1},"end":{"line":334,"column":1}},"children":[{"type":"text","value":"Let’s consider the backward error. The data in the rootfinding problem is the polynomial coefficients. We can apply ","position":{"start":{"line":334,"column":1},"end":{"line":334,"column":1}},"key":"v8Uwxf9q8K"},{"type":"inlineCode","value":"poly","position":{"start":{"line":334,"column":1},"end":{"line":334,"column":1}},"key":"tXbByuhCcj"},{"type":"text","value":" to find the coefficients of the polynomial (that is, the data) whose roots were actually computed by the numerical algorithm. This corresponds to ","position":{"start":{"line":334,"column":1},"end":{"line":334,"column":1}},"key":"S3PjGMz3f5"},{"type":"inlineMath","value":"\\tilde{x}","position":{"start":{"line":334,"column":1},"end":{"line":334,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mover accent=\"true\"><mi>x</mi><mo>~</mo></mover></mrow><annotation encoding=\"application/x-tex\">\\tilde{x}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6679em;\"></span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6679em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\">x</span></span><span style=\"top:-3.35em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.2222em;\"><span class=\"mord\">~</span></span></span></span></span></span></span></span></span></span>","key":"Od8XjDOuwB"},{"type":"text","value":" in ","position":{"start":{"line":334,"column":1},"end":{"line":334,"column":1}},"key":"TkUQ8WRcwZ"},{"type":"crossReference","kind":"proof:definition","identifier":"definition-stability-backward","label":"definition-stability-backward","children":[{"type":"text","value":"Definition ","key":"cABMw04LQb"},{"type":"text","value":"1.4.1","key":"PLOGOntBLi"}],"template":"Definition %s","enumerator":"1.4.1","resolved":true,"html_id":"definition-stability-backward","remote":true,"url":"/stability","dataUrl":"/stability.json","key":"uGTHbEiSLb"},{"type":"text","value":".","position":{"start":{"line":334,"column":1},"end":{"line":334,"column":1}},"key":"x6cy4XKslZ"}],"key":"D2V7k5XljG"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"pp = poly(rr)","key":"MRAiu5LuR7"},{"type":"output","id":"PQ8DGl_wBOqOQacvPPjub","data":[{"output_type":"execute_result","execution_count":29,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>pp = 1×7 double\n   1.0000e+00  -8.0000e+00   6.0000e+00   4.4000e+01  -4.3000e+01  -3.6000e+01   3.6000e+01\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"pp = 1×7 double\n   1.0000e+00  -8.0000e+00   6.0000e+00   4.4000e+01  -4.3000e+01  -3.6000e+01   3.6000e+01\n","content_type":"text/plain"}}}],"key":"rj7HwuNMbl"}],"data":{},"key":"Q2SLzXzpGl"},{"type":"paragraph","position":{"start":{"line":340,"column":1},"end":{"line":340,"column":1}},"children":[{"type":"text","value":"We find that in a relative sense, these coefficients are very close to those of the original, exact polynomial:","position":{"start":{"line":340,"column":1},"end":{"line":340,"column":1}},"key":"BEBkP9yy6c"}],"key":"EbR2mH91GU"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"disp(\"Coefficient errors:\") \nabs(p - pp) ./ abs(p)","key":"vK4op30ogh"},{"type":"output","id":"vFI2RRy7WdeMbIiNzyc63","data":[{"output_type":"stream","name":"stdout","text":"Coefficient errors:"},{"output_type":"stream","name":"stdout","text":"\n"},{"output_type":"execute_result","execution_count":30,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = 1×7 double\n1.0e+00 *\n\n            0   7.7716e-16   1.6283e-15   1.1304e-15   1.1567e-15   3.1580e-15   3.3553e-15\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = 1×7 double\n1.0e+00 *\n\n            0   7.7716e-16   1.6283e-15   1.1304e-15   1.1567e-15   3.1580e-15   3.3553e-15\n","content_type":"text/plain"}}}],"key":"dkFEsdaUlV"}],"data":{},"key":"i92blzYfo1"},{"type":"paragraph","position":{"start":{"line":347,"column":1},"end":{"line":347,"column":1}},"children":[{"type":"text","value":"In summary, even though there are some computed roots relatively far from their correct values, they are nevertheless the roots of a polynomial that is very close to the original.","position":{"start":{"line":347,"column":1},"end":{"line":347,"column":1}},"key":"mPS0hXcdrs"}],"key":"Sqs7gLXQhe"}],"label":"demo-stability-roots-matlab","identifier":"demo-stability-roots-matlab","html_id":"demo-stability-roots-matlab","key":"jT3QAyta3m"}],"key":"w1ppN025JM"}],"key":"KeCeAekrRm"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Chapter 6","url":"/chapter6","group":"Julia codes"},"next":{"title":"Chapter 2","url":"/chapter2-1","group":"MATLAB codes"}}},"domain":"http://localhost:3000"}