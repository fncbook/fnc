{"kind":"Notebook","sha256":"0695494899abc8b5f03aa726c4ffb81e8155bb5373154be7471922ece8578aea","slug":"roots-1","location":"/chapter1/section4/julia/roots.ipynb","dependencies":[],"frontmatter":{"numbering":{"heading_1":{"enabled":false},"heading_2":{"enabled":false},"heading_3":{"enabled":false},"heading_4":{"enabled":false},"heading_5":{"enabled":false},"heading_6":{"enabled":false}},"kernelspec":{"name":"julia-1.11","display_name":"Julia 1","language":"julia"},"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"exports":[{"format":"ipynb","filename":"roots.ipynb","url":"/build/roots-dd0ca3a733801fdae174ca75e4fed676.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"XFdwThwZXN"},{"type":"text","value":"1.4.3","key":"RBH0ht0nY6"}],"key":"FSMOJJsqo5"}],"identifier":"demo-stability-roots","label":"demo-stability-roots","kind":"proof:example","template":"Example %s","enumerator":"1.4.3","resolved":true,"html_id":"demo-stability-roots","remote":true,"url":"/stability","dataUrl":"/stability.json","key":"zsfJjpY5nl"}],"key":"W7Y8qxbiql"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"For this example we will use the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"yRz8FbKAoB"},{"type":"inlineCode","value":"Polynomials","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"g6XEUC0Wsi"},{"type":"text","value":" package, which you may need to install. You can do this by running the following command in the Julia REPL:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ZmikNUD5gp"}],"key":"JZsBgapcbK"},{"type":"code","lang":"julia","value":"using Pkg\nPkg.add(\"Polynomials\")","position":{"start":{"line":5,"column":1},"end":{"line":8,"column":1}},"key":"lNOvvCDcFI"},{"type":"admonition","kind":"warning","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Warning","key":"F8340mzSDS"}],"key":"OEsX8hFITZ"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"In the rest of the book, we do not show the ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"JM4Iv0dgy5"},{"type":"inlineCode","value":"using","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"ox9JypJEyZ"},{"type":"text","value":" statement needed to load the book’s package, but you will need to enter it if you want to run the codes yourself. We also won’t always point out a package that you need to install.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"eGSQtStx6R"}],"key":"QZjSMxyPpV"}],"key":"fdpzklPDdF"},{"type":"paragraph","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"Our first step is to construct a polynomial with six known roots.","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"s6MVNh0Bya"}],"key":"mtndxMa2ei"}],"key":"Yg6ObOsDQ6"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-14T16:52:46.064000Z","iopub.status.busy":"2025-01-14T16:52:45.887000Z","iopub.status.idle":"2025-01-14T16:52:46.731000Z","shell.execute_reply":"2025-01-14T16:52:46.731000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"using Polynomials\nr = [-2.0, -1, 1, 1, 3, 6]\np = fromroots(r)","key":"TlZNZaBbPo"},{"type":"output","id":"z1FOPNhuU9XG3_SSLuCgt","data":[{"output_type":"execute_result","execution_count":2,"metadata":{},"data":{"text/html":{"content":"36.0 &#45; 36.0&#8729;x &#45; 43.0&#8729;x<sup>2</sup> &#43; 44.0&#8729;x<sup>3</sup> &#43; 6.0&#8729;x<sup>4</sup> &#45; 8.0&#8729;x<sup>5</sup> &#43; 1.0&#8729;x<sup>6</sup>","content_type":"text/html"},"text/latex":{"content":"$36.0 - 36.0\\cdot x - 43.0\\cdot x^{2} + 44.0\\cdot x^{3} + 6.0\\cdot x^{4} - 8.0\\cdot x^{5} + 1.0\\cdot x^{6}$","content_type":"text/latex"},"text/plain":{"content":"Polynomial(36.0 - 36.0*x - 43.0*x^2 + 44.0*x^3 + 6.0*x^4 - 8.0*x^5 + 1.0*x^6)","content_type":"text/plain"}}}],"key":"I2hEWczUlL"}],"key":"CUMwZpS8Sg"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now we use a standard numerical method for finding those roots, pretending that we don’t know them already. This corresponds to ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GEVFkrD6VK"},{"type":"inlineMath","value":"\\tilde{y}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mover accent=\"true\"><mi>y</mi><mo>~</mo></mover></mrow><annotation encoding=\"application/x-tex\">\\tilde{y}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8623em;vertical-align:-0.1944em;\"></span><span class=\"mord accent\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6679em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span><span style=\"top:-3.35em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.1944em;\"><span class=\"mord\">~</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1944em;\"><span></span></span></span></span></span></span></span></span>","key":"lXLu4U9nKw"},{"type":"text","value":" in ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Lyxa5Sa6LV"},{"type":"crossReference","kind":"proof:definition","identifier":"definition-stability-backward","label":"definition-stability-backward","children":[{"type":"text","value":"Definition ","key":"Q7KcsRsAov"},{"type":"text","value":"1.4.1","key":"ywK3f8uFEf"}],"template":"Definition %s","enumerator":"1.4.1","resolved":true,"html_id":"definition-stability-backward","remote":true,"url":"/stability","dataUrl":"/stability.json","key":"EHfbUzUjNP"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KFT1URbu5a"}],"key":"cB7xbQRBOg"}],"key":"qcuptUHIVL"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-14T16:52:46.733000Z","iopub.status.busy":"2025-01-14T16:52:46.733000Z","iopub.status.idle":"2025-01-14T16:52:47.694000Z","shell.execute_reply":"2025-01-14T16:52:47.694000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"r̃ = sort(roots(p))   # type r\\tilde and then press Tab","key":"Ca9aQ9dTnJ"},{"type":"output","id":"Bw0rtTJFmIDPygKOVEb0J","data":[{"output_type":"execute_result","execution_count":3,"metadata":{},"data":{"text/plain":{"content":"6-element Vector{Float64}:\n -1.9999999999999993\n -1.0000000000000002\n  0.9999999876576552\n  1.0000000123423434\n  3.0000000000000036\n  5.999999999999993","content_type":"text/plain"}}}],"key":"sqLFj0vAJ2"}],"key":"C0HHJ7oN8w"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Here are the relative errors in each of the computed roots.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"JpDKIo7JUo"}],"indexEntries":[{"entry":"Julia","subEntry":{"value":"@.","kind":"entry"},"emphasis":true},{"entry":"Julia","subEntry":{"value":"broadcasting","kind":"entry"},"emphasis":false}],"label":"index-gn7P46yj95","identifier":"index-gn7p46yj95","html_id":"index-gn7p46yj95","key":"xXlj4pf79C"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"bYRUPH1ACr"}],"key":"cDNzSBcE6A"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"WsceAsn3EQ"},{"type":"inlineCode","value":"@.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"kV9jLHxLQg"},{"type":"text","value":" notation at the start means to do the given operations on each element of the given vectors.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"hTrS1xtpAC"}],"key":"obVhqxQpeW"}],"key":"YIqh1NYJSX"}],"key":"nIkzOC55jl"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-14T16:52:47.695000Z","iopub.status.busy":"2025-01-14T16:52:47.695000Z","iopub.status.idle":"2025-01-14T16:52:47.757000Z","shell.execute_reply":"2025-01-14T16:52:47.757000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"println(\"Root errors:\") \n@. abs(r - r̃) / r","key":"GGJU7CvSy9"},{"type":"output","id":"PXCDZhoD9WLk2VAg7UigW","data":[{"name":"stdout","output_type":"stream","text":"Root errors:\n"},{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"text/plain":{"content":"6-element Vector{Float64}:\n -3.3306690738754696e-16\n -2.220446049250313e-16\n  1.2342344812843464e-8\n  1.2342343369553532e-8\n  1.1842378929335002e-15\n  1.1842378929335002e-15","content_type":"text/plain"}}}],"key":"D0GJDAlXh9"}],"key":"DUUcjKrJKk"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"It seems that the forward error is acceptably close to machine epsilon for double precision in all cases except the double root at ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"oC3mAvUrZZ"},{"type":"inlineMath","value":"x=1","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">x=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"vCjFgG9iqf"},{"type":"text","value":". This is not a surprise, though, given the poor conditioning at such roots.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dOQPCr7f40"}],"key":"FDDk1q0qAH"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Let’s consider the backward error. The data in the rootfinding problem is the polynomial coefficients. We can apply ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"d1EHXbIQUQ"},{"type":"inlineCode","value":"fromroots","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"PJkJ0P0Gl5"},{"type":"text","value":" to find the coefficients of the polynomial (that is, the data) whose roots were actually computed by the numerical algorithm. This corresponds to ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"n5GloTbr0l"},{"type":"inlineMath","value":"\\tilde{x}","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mover accent=\"true\"><mi>x</mi><mo>~</mo></mover></mrow><annotation encoding=\"application/x-tex\">\\tilde{x}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6679em;\"></span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6679em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\">x</span></span><span style=\"top:-3.35em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.2222em;\"><span class=\"mord\">~</span></span></span></span></span></span></span></span></span></span>","key":"pkZebdjwSk"},{"type":"text","value":" in ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"dZUSESpExe"},{"type":"crossReference","kind":"proof:definition","identifier":"definition-stability-backward","label":"definition-stability-backward","children":[{"type":"text","value":"Definition ","key":"rW5kkF3o0B"},{"type":"text","value":"1.4.1","key":"ABSdgH5znZ"}],"template":"Definition %s","enumerator":"1.4.1","resolved":true,"html_id":"definition-stability-backward","remote":true,"url":"/stability","dataUrl":"/stability.json","key":"yfIUpBBGZW"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Y9hRuVsbH7"}],"key":"tvAmIekMIH"}],"key":"WMGK8N0oqP"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-14T16:52:47.758000Z","iopub.status.busy":"2025-01-14T16:52:47.758000Z","iopub.status.idle":"2025-01-14T16:52:47.759000Z","shell.execute_reply":"2025-01-14T16:52:47.759000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"p̃ = fromroots(r̃)","key":"rfjW9IUs0i"},{"type":"output","id":"cYTGkhHM_7iRybd21JGZ1","data":[{"output_type":"execute_result","execution_count":5,"metadata":{},"data":{"text/html":{"content":"35.999999999999936 &#45; 35.99999999999999&#8729;x &#45; 42.99999999999993&#8729;x<sup>2</sup> &#43; 43.99999999999997&#8729;x<sup>3</sup> &#43; 5.999999999999998&#8729;x<sup>4</sup> &#45; 7.999999999999996&#8729;x<sup>5</sup> &#43; 1.0&#8729;x<sup>6</sup>","content_type":"text/html"},"text/latex":{"content":"$35.999999999999936 - 35.99999999999999\\cdot x - 42.99999999999993\\cdot x^{2} + 43.99999999999997\\cdot x^{3} + 5.999999999999998\\cdot x^{4} - 7.999999999999996\\cdot x^{5} + 1.0\\cdot x^{6}$","content_type":"text/latex"},"text/plain":{"content":"Polynomial(35.999999999999936 - 35.99999999999999*x - 42.99999999999993*x^2 + 43.99999999999997*x^3 + 5.999999999999998*x^4 - 7.999999999999996*x^5 + 1.0*x^6)","content_type":"text/plain"}}}],"key":"jwjuGkTGJs"}],"key":"BneUHYIhdX"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We find that in a relative sense, these coefficients are very close to those of the original, exact polynomial:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"aw3s98Xc0r"}],"key":"MDqW4YwDWV"}],"key":"u4yHOt99I0"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-14T16:52:47.760000Z","iopub.status.busy":"2025-01-14T16:52:47.760000Z","iopub.status.idle":"2025-01-14T16:52:47.763000Z","shell.execute_reply":"2025-01-14T16:52:47.762000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"c,c̃ = coeffs(p), coeffs(p̃)\nprintln(\"Coefficient errors:\") \n@. abs(c - c̃) / c","key":"zabUakdstz"},{"type":"output","id":"zMEnZl9HvgoVvfnlSy4Yc","data":[{"name":"stdout","output_type":"stream","text":"Coefficient errors:\n"},{"output_type":"execute_result","execution_count":6,"metadata":{},"data":{"text/plain":{"content":"7-element Vector{Float64}:\n  1.7763568394002505e-15\n -1.9737298215558337e-16\n -1.6524249668839539e-15\n  6.459479416000911e-16\n  2.9605947323337506e-16\n -5.551115123125783e-16\n  0.0","content_type":"text/plain"}}}],"key":"dHQa2hDfbc"}],"key":"HQLLTnyclC"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"In summary, even though there are some computed roots relatively far from their correct values, they are nevertheless the roots of a polynomial that is very close to the original.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"lFyhUFiQSW"}],"key":"J2tlFPbeUF"}],"key":"mOsIwC7cAi"}],"key":"uXPGpntDnR"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Quadgood","url":"/quadgood","group":"Chapter 1"},"next":{"title":"Vander","url":"/vander","group":"Chapter 2"}}},"domain":"http://localhost:3000"}