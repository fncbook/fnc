{"kind":"Notebook","sha256":"5f79460b334b021183b1f4565de900d06dee7cb935c1990cd473daacc0a5c88b","slug":"chapter4","location":"/julia/chapter4.md","dependencies":[],"frontmatter":{"title":"Chapter 4","numbering":{"heading_1":{"enabled":false},"heading_2":{"enabled":false},"heading_3":{"enabled":false},"heading_4":{"enabled":false},"heading_5":{"enabled":false},"heading_6":{"enabled":false},"title":{"offset":2}},"kernelspec":{"name":"julia-1.11","display_name":"Julia 1","language":"julia"},"content_includes_title":false,"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"edit_url":"https://github.com/fncbook/fnc/blob/master/julia/chapter4.md","exports":[{"format":"md","filename":"chapter4.md","url":"/build/chapter4-9542d97475b85cdafcf1b0c8866205d7.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Functions","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"wXFDdduJ8x"}],"identifier":"functions","label":"Functions","html_id":"functions","implicit":true,"key":"aYe1ON3jr1"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Newton’s method","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"SJtw0Br3qn"}],"key":"s9zUWUz2PN"},{"type":"include","file":"FNCFunctions/src/chapter04.jl","literal":true,"filter":{"startAfter":"# begin newton","endBefore":"# end newton"},"children":[{"type":"code","value":"\"\"\"\n    newton(f, df_dx, x₁ [;maxiter,f tol, xtol])\n\nUse Newton's method to find a root of `f` starting from `x₁`, where\n`df_dx` is the derivative of `f`. Returns a vector of root estimates.\n\nThe optional keyword parameters set the maximum number of iterations\nand the stopping tolerance for values of `f` and changes in `x`.\n\"\"\"\nfunction newton(f, df_dx, x₁; maxiter = 40, ftol = 1e-13, xtol = 1e-13)\n    x = [float(x₁)]\n    y = f(x₁)\n    Δx = Inf   # for initial pass below\n    k = 1\n\n    while (abs(Δx) > xtol) && (abs(y) > ftol)\n        dy_dx = df_dx(x[k])\n        Δx = -y / dy_dx            # Newton step\n        push!(x, x[k] + Δx)        # append new estimate\n\n        k += 1\n        y = f(x[k])\n        if k == maxiter\n            @warn \"Maximum number of iterations reached.\"\n            break   # exit loop\n        end\n    end\n    return x\nend","lang":"julia","showLineNumbers":true,"filename":"newton.jl","key":"Oaplmfxvqv"}],"key":"JdwGjXgCse"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"About the code","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"EiMEvpVjRZ"}],"key":"Wyk9Jdbk4B"},{"type":"paragraph","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"crossReference","kind":"proof:algorithm","identifier":"function-newton","label":"function-newton","children":[{"type":"text","value":"Function ","key":"cFwCdonKIT"},{"type":"text","value":"4.3.2","key":"xTG41gWmrV"}],"template":"Algorithm %s","enumerator":"4.3.2","resolved":true,"html_id":"function-newton","remote":true,"url":"/newton","dataUrl":"/newton.json","key":"sQq9XLf2L7"},{"type":"text","value":" accepts ","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"mcbr8pmTGQ"},{"type":"emphasis","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"text","value":"keyword arguments","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"SxScU5A7Pv"}],"key":"iGV9X10sCt"},{"type":"text","value":". In the function declaration, these follow the semicolon, and when the function is called, they may be supplied as ","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"j7brBf5QWJ"},{"type":"inlineCode","value":"keyword=value","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"tOzV5gEZpj"},{"type":"text","value":" in the argument list. Here, these arguments are also given default values by the assignments within the declaration. This arrangement is useful when there are multiple optional arguments, because the ordering of them doesn’t matter.","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"JTq630eoJl"}],"key":"rmHoMLoDpe"},{"type":"paragraph","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"GtmB4dN9N9"},{"type":"inlineCode","value":"break","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"Kni0wzJlT1"},{"type":"text","value":" statement, seen here in line 25, causes an immediate exit from the innermost loop in which it is called. It is often used as a safety valve to escape an iteration that may not be able to terminate otherwise.","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"Ieq0eg4kpp"}],"key":"iYEwTRFJNB"}],"class":"dropdown","key":"NONVn7XRBe"}],"label":"function-newton-julia","identifier":"function-newton-julia","html_id":"function-newton-julia","key":"mQJnlu5EvC"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Secant method","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"Lg7RKgaB0l"}],"key":"zL70dF8bfH"},{"type":"include","file":"FNCFunctions/src/chapter04.jl","literal":true,"filter":{"startAfter":"# begin secant","endBefore":"# end secant"},"children":[{"type":"code","value":"\"\"\"\n    secant(f, x₁, x₂ [;maxiter, ftol, xtol])\n\nUse the secant method to find a root of `f` starting from `x₁` and\n`x₂`. Returns a vector of root estimates.\n\nThe optional keyword parameters set the maximum number of iterations\nand the stopping tolerance for values of `f` and changes in `x`.\n\"\"\"\nfunction secant(f, x₁, x₂; maxiter = 40, ftol = 1e-13, xtol = 1e-13)\n    x = [float(x₁), float(x₂)]\n    y₁ = f(x₁)\n    Δx, y₂ = Inf, Inf   # for initial pass in the loop below\n    k = 2\n\n    while (abs(Δx) > xtol) && (abs(y₂) > ftol)\n        y₂ = f(x[k])\n        Δx = -y₂ * (x[k] - x[k-1]) / (y₂ - y₁)   # secant step\n        push!(x, x[k] + Δx)        # append new estimate\n\n        k += 1\n        y₁ = y₂    # current f-value becomes the old one next time\n\n        if k == maxiter\n            @warn \"Maximum number of iterations reached.\"\n            break   # exit loop\n        end\n    end\n    return x\nend","lang":"julia","showLineNumbers":true,"filename":"secant.jl","key":"uUxMNYKoWo"}],"key":"gxmQHw70RU"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"About the code","position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"key":"cuS0noRZws"}],"key":"paCCSAtYpX"},{"type":"paragraph","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"children":[{"type":"text","value":"Because we want to observe the convergence of the method, ","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"L2WQKU5gD7"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-secant","label":"function-secant","children":[{"type":"text","value":"Function ","key":"LVPDhvioxd"},{"type":"text","value":"4.4.2","key":"UFcEZhygIv"}],"template":"Algorithm %s","enumerator":"4.4.2","resolved":true,"html_id":"function-secant","remote":true,"url":"/secant","dataUrl":"/secant.json","key":"v3WDO53qlO"},{"type":"text","value":" stores and returns the entire sequence of root estimates. However, only the most recent two are needed by the iterative formula. This is demonstrated by the use of ","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"ukrJMmBwnD"},{"type":"inlineCode","value":"y₁","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"O2czq3LS4D"},{"type":"text","value":" and ","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"olT5zyipAw"},{"type":"inlineCode","value":"y₂","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"psezgq7wkO"},{"type":"text","value":" for the two most recent values of ","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"IJ3kdn2jsa"},{"type":"inlineMath","value":"f","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>","key":"Y6MdWp1pIF"},{"type":"text","value":".","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"kwPZI7Crb9"}],"key":"ZtBlrA9v44"}],"class":"dropdown","key":"CRPcOfQ8B6"}],"label":"function-secant-julia","identifier":"function-secant-julia","html_id":"function-secant-julia","key":"samubD2bAq"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Newton’s method for systems","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"key":"yLkZBVvsqo"}],"key":"xypMo7AENd"},{"type":"include","file":"FNCFunctions/src/chapter04.jl","literal":true,"filter":{"startAfter":"# begin newtonsys","endBefore":"# end newtonsys"},"children":[{"type":"code","value":"\"\"\"\n    newtonsys(f, jac, x₁ [;maxiter, ftol, xtol])\n\nUse Newton's method to find a root of a system of equations,\nstarting from `x₁`. The functions `f` and `jac` should return the\nresidual vector and the Jacobian matrix, respectively. Returns the\nhistory of root estimates as a vector of vectors.\n\nThe optional keyword parameters set the maximum number of iterations\nand the stopping tolerance for values of `f` and changes in `x`.\n\n\"\"\"\nfunction newtonsys(f, jac, x₁; maxiter = 40, ftol = 1e-13, xtol = 1e-13)\n    x = [float(x₁)]\n    y, J = f(x₁), jac(x₁)\n    Δx = Inf   # for initial pass below\n    k = 1\n\n    while (norm(Δx) > xtol) && (norm(y) > ftol)\n        Δx = -(J \\ y)             # Newton step\n        push!(x, x[k] + Δx)    # append to history\n        k += 1\n        y, J = f(x[k]), jac(x[k])\n\n        if k == maxiter\n            @warn \"Maximum number of iterations reached.\"\n            break\n        end\n    end\n    return x\nend","lang":"julia","showLineNumbers":true,"filename":"newtonsys.jl","key":"b0i2lVI9V6"}],"key":"tV70VyUFkg"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"About the code","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"t0YcBmVH39"}],"key":"SyDDiHa0kw"},{"type":"paragraph","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"children":[{"type":"text","value":"The output of ","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"BZOg1Zt8SY"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-newtonsys","label":"function-newtonsys","children":[{"type":"text","value":"Function ","key":"FWJB2ODzSD"},{"type":"text","value":"4.5.2","key":"euIbQbeztb"}],"template":"Algorithm %s","enumerator":"4.5.2","resolved":true,"html_id":"function-newtonsys","remote":true,"url":"/newtonsys","dataUrl":"/newtonsys.json","key":"kQV24K684b"},{"type":"text","value":" is a vector of vectors representing the entire history of root estimates. Since these should be in floating point, the starting value is converted with ","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"Nr8lI4DkiS"},{"type":"inlineCode","value":"float","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"pkfzvKyfPw"},{"type":"text","value":" before the iteration starts.","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"IcPTXZKo2U"}],"key":"hmakLsuQSc"}],"class":"dropdown","key":"NLSdQ0hLvY"}],"label":"function-newtonsys-julia","identifier":"function-newtonsys-julia","html_id":"function-newtonsys-julia","key":"ZQBVaTpLkP"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Finite differences for Jacobian","position":{"start":{"line":64,"column":1},"end":{"line":64,"column":1}},"key":"X0mqTRgH72"}],"key":"q2sjtGSvMa"},{"type":"include","file":"FNCFunctions/src/chapter04.jl","literal":true,"filter":{"startAfter":"# begin fdjac","endBefore":"# end fdjac"},"children":[{"type":"code","value":"\"\"\"\n    fdjac(f, x₀ [,y₀])\n\nCompute a finite-difference approximation of the Jacobian matrix for\n`f` at `x₀`, where `y₀`=`f(x₀)` may be given.\n\"\"\"\nfunction fdjac(f, x₀, y₀ = f(x₀))\n    δ = sqrt(eps()) * max(norm(x₀), 1)    # near-optimum FD step size\n    m, n = length(y₀), length(x₀)\n    if n == 1\n        # Vector result for univariate functions.\n        J = (f(x₀ + δ) - y₀) / δ\n    else\n        J = zeros(m, n)\n        x = copy(x₀)\n        for j in 1:n\n            # Difference in the jth direction.\n            x[j] += δ\n            J[:, j] = (f(x) - y₀) / δ\n            x[j] -= δ\n        end\n    end\n    return J\nend","lang":"julia","showLineNumbers":true,"filename":"fdjac.jl","key":"hMmxT1WsJj"}],"key":"Y7tCReT8s0"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"About the code","position":{"start":{"line":73,"column":1},"end":{"line":73,"column":1}},"key":"JcUN8uWX7W"}],"key":"XFFF82Vn1K"},{"type":"paragraph","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"children":[{"type":"crossReference","kind":"proof:algorithm","identifier":"function-fdjac","label":"function-fdjac","children":[{"type":"text","value":"Function ","key":"FqZv0iEywm"},{"type":"text","value":"4.6.1","key":"Nl6yCC1vGx"}],"template":"Algorithm %s","enumerator":"4.6.1","resolved":true,"html_id":"function-fdjac","remote":true,"url":"/quasinewton","dataUrl":"/quasinewton.json","key":"YpoUAFTyFu"},{"type":"text","value":" is written to accept the case where ","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"key":"XB61583Dmo"},{"type":"inlineMath","value":"\\mathbf{f}","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">f</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{f}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.10903em;\">f</span></span></span></span>","key":"rNODarYyVF"},{"type":"text","value":" maps ","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"key":"MTOLlOmNnD"},{"type":"inlineMath","value":"n","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"Y3q6iFExA4"},{"type":"text","value":" variables to ","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"key":"TpL2sIf1E5"},{"type":"inlineMath","value":"m","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi></mrow><annotation encoding=\"application/x-tex\">m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">m</span></span></span></span>","key":"sfWDOAd2Gl"},{"type":"text","value":" values with ","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"key":"eByEV7XVD5"},{"type":"inlineMath","value":"m\\neq n","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi><mo mathvariant=\"normal\">≠</mo><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">m\\neq n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\"><span class=\"mrel\"><span class=\"mord vbox\"><span class=\"thinbox\"><span class=\"rlap\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"inner\"><span class=\"mord\"><span class=\"mrel\"></span></span></span><span class=\"fix\"></span></span></span></span></span><span class=\"mrel\">=</span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"o1tbzHN9AK"},{"type":"text","value":", in anticipation of ","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"key":"glTfm5GmZ3"},{"type":"link","kind":"numref","identifier":"section-nonlineqn-nlsq","label":"section-nonlineqn-nlsq","url":"/nlsq","internal":true,"dataUrl":"/nlsq.json","children":[{"type":"text","value":"Nonlinear least squares","key":"DwYFSeS7Lj"}],"key":"ZRIp59ma0W"},{"type":"text","value":".","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"key":"p22qReueRJ"}],"key":"RoB25uXXkM"},{"type":"paragraph","position":{"start":{"line":77,"column":1},"end":{"line":77,"column":1}},"children":[{"type":"text","value":"Note that a default value is given for the third argument ","position":{"start":{"line":77,"column":1},"end":{"line":77,"column":1}},"key":"oYzh5sp51g"},{"type":"inlineCode","value":"y₀","position":{"start":{"line":77,"column":1},"end":{"line":77,"column":1}},"key":"bn4zyK7C0X"},{"type":"text","value":", and it refers to earlier arguments in the list. The reason is that in some contexts, the caller of ","position":{"start":{"line":77,"column":1},"end":{"line":77,"column":1}},"key":"ywxABhnvcs"},{"type":"inlineCode","value":"fdjac","position":{"start":{"line":77,"column":1},"end":{"line":77,"column":1}},"key":"xmPqB1rOop"},{"type":"text","value":" may have already computed ","position":{"start":{"line":77,"column":1},"end":{"line":77,"column":1}},"key":"TDiGpBoOxt"},{"type":"inlineCode","value":"y₀","position":{"start":{"line":77,"column":1},"end":{"line":77,"column":1}},"key":"FxwXtsleJ2"},{"type":"text","value":" and can supply it without computational cost, while in other contexts, it must be computed fresh. The configuration here adapts to either situation.","position":{"start":{"line":77,"column":1},"end":{"line":77,"column":1}},"key":"YqbQZqAQ8l"}],"key":"K8T4a3hwnl"}],"class":"dropdown","key":"ITcDl9KxVv"}],"label":"function-fdjac-julia","identifier":"function-fdjac-julia","html_id":"function-fdjac-julia","key":"t7U2xu3PD7"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Levenberg’s method","position":{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},"key":"tWaQhCeG6Q"}],"key":"vnBhRTPg6w"},{"type":"include","file":"FNCFunctions/src/chapter04.jl","literal":true,"filter":{"startAfter":"# begin levenberg","endBefore":"# end levenberg"},"children":[{"type":"code","value":"\"\"\"\n    levenberg(f, x₁ [;maxiter, ftol, xtol])\n\nUse Levenberg's quasi-Newton iteration to find a root of the system\n`f` starting from `x₁` Returns the history of root estimates as a\nvector of vectors.\n\nThe optional keyword parameters set the maximum number of iterations\nand the stopping tolerance for values of `f` and changes in `x`.\n\n\"\"\"\nfunction levenberg(f, x₁; maxiter = 40, ftol = 1e-12, xtol = 1e-12)\n    x = [float(x₁)]\n    yₖ = f(x₁)\n    k = 1\n    s = Inf\n    A = fdjac(f, x[k], yₖ)   # start with FD Jacobian\n    jac_is_new = true\n\n    λ = 10\n    while (norm(s) > xtol) && (norm(yₖ) > ftol)\n        # Compute the proposed step.\n        B = A' * A + λ * I\n        z = A' * yₖ\n        s = -(B \\ z)\n\n        x̂ = x[k] + s\n        ŷ = f(x̂)\n\n        # Do we accept the result?\n        if norm(ŷ) < norm(yₖ)    # accept\n            λ = λ / 10   # get closer to Newton\n            # Broyden update of the Jacobian.\n            A += (ŷ - yₖ - A * s) * (s' / (s' * s))\n            jac_is_new = false\n\n            push!(x, x̂)\n            yₖ = ŷ\n            k += 1\n        else    # don't accept\n            # Get closer to gradient descent.\n            λ = 4λ\n            # Re-initialize the Jacobian if it's out of date.\n            if !jac_is_new\n                A = fdjac(f, x[k], yₖ)\n                jac_is_new = true\n            end\n        end\n\n        if k == maxiter\n            @warn \"Maximum number of iterations reached.\"\n            break\n        end\n    end\n    return x\nend","lang":"julia","showLineNumbers":true,"filename":"levenberg.jl","key":"gddVMibiky"}],"key":"C2exLozrMF"}],"label":"function-levenberg-julia","identifier":"function-levenberg-julia","html_id":"function-levenberg-julia","key":"rbgKJzRnFq"},{"type":"heading","depth":2,"position":{"start":{"line":93,"column":1},"end":{"line":93,"column":1}},"children":[{"type":"text","value":"Examples","position":{"start":{"line":93,"column":1},"end":{"line":93,"column":1}},"key":"K7bArrrTxH"}],"identifier":"examples","label":"Examples","html_id":"examples","implicit":true,"key":"qow7RI130k"}],"key":"LU6MCU9u2d"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"include(\"FNC_init.jl\")","visibility":"show","key":"hOvR6L6TEI"},{"type":"output","id":"XqLIrCkyxuzQ0mY6Quov5","data":[{"output_type":"stream","name":"stderr","text":"\u001b[32m\u001b[1m  Activating\u001b[22m\u001b[39m "},{"output_type":"stream","name":"stderr","text":"project at `~/Documents/GitHub/fnc`\n"},{"output_type":"error","traceback":"LoadError: failed to find source of parent package: \"Accessors\"\nin expression starting at /Users/driscoll/Dropbox/Mac/Documents/GitHub/fnc/julia/FNC_init.jl:3\n\nStacktrace:\n  [1] error(s::String)\n    @ Base ./error.jl:35\n  [2] explicit_manifest_uuid_path(project_file::String, pkg::Base.PkgId)\n    @ Base ./loading.jl:1029\n  [3] manifest_uuid_path(env::String, pkg::Base.PkgId)\n    @ Base ./loading.jl:730\n  [4] locate_package_env(pkg::Base.PkgId, stopenv::Nothing)\n    @ Base ./loading.jl:463\n  [5] locate_package(pkg::Base.PkgId, stopenv::Nothing)\n    @ Base ./loading.jl:510\n  [6] locate_package\n    @ ./loading.jl:510 [inlined]\n  [7] _precompilepkgs(pkgs::Vector{String}, internal_call::Bool, strict::Bool, warn_loaded::Bool, timing::Bool, _from_loading::Bool, configs::Vector{Pair{Cmd, Base.CacheFlags}}, io::IOContext{IO}, fancyprint::Bool, ignore_loaded::Bool)\n    @ Base.Precompilation ./precompilation.jl:877\n  [8] precompilepkgs(pkgs::Vector{String}; internal_call::Bool, strict::Bool, warn_loaded::Bool, timing::Bool, _from_loading::Bool, configs::Pair{Cmd, Base.CacheFlags}, io::IJulia.IJuliaStdio{Base.PipeEndpoint}, fancyprint::Bool, ignore_loaded::Bool)\n    @ Base.Precompilation ./precompilation.jl:410\n  [9] _require(pkg::Base.PkgId, env::String)\n    @ Base ./loading.jl:2558\n [10] __require_prelocked(uuidkey::Base.PkgId, env::String)\n    @ Base ./loading.jl:2388\n [11] #invoke_in_world#3\n    @ ./essentials.jl:1089 [inlined]\n [12] invoke_in_world\n    @ ./essentials.jl:1086 [inlined]\n [13] _require_prelocked(uuidkey::Base.PkgId, env::String)\n    @ Base ./loading.jl:2375\n [14] macro expansion\n    @ ./loading.jl:2314 [inlined]\n [15] macro expansion\n    @ ./lock.jl:273 [inlined]\n [16] __require(into::Module, mod::Symbol)\n    @ Base ./loading.jl:2271\n [17] #invoke_in_world#3\n    @ ./essentials.jl:1089 [inlined]\n [18] invoke_in_world\n    @ ./essentials.jl:1086 [inlined]\n [19] require(into::Module, mod::Symbol)\n    @ Base ./loading.jl:2260\n [20] include(fname::String)\n    @ Main ./sysimg.jl:38\n [21] top-level scope\n    @ In[1]:1","ename":"LoadError","evalue":"LoadError: failed to find source of parent package: \"Accessors\"\nin expression starting at /Users/driscoll/Dropbox/Mac/Documents/GitHub/fnc/julia/FNC_init.jl:3"}],"visibility":"show","key":"tn7mBkLNXn"}],"data":{"tags":[]},"visibility":"remove","key":"sFChh1SJbP"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"children":[{"type":"text","value":"4.1 ","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"key":"EdzUtQPY8D"},{"type":"link","identifier":"section-nonlineqn-rootproblem","label":"section-nonlineqn-rootproblem","kind":"narrative","position":{"start":{"line":99,"column":5},"end":{"line":99,"column":35}},"url":"/rootproblem","internal":true,"dataUrl":"/rootproblem.json","children":[{"type":"text","value":"The rootfinding problem","key":"oloUz2yZfi"}],"key":"ed1GOL7m55"}],"identifier":"id-4-1","label":"4.1 ","html_id":"id-4-1","implicit":true,"key":"k5vTunJ1qL"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-rootproblem-bessel","label":"demo-rootproblem-bessel","kind":"proof:example","position":{"start":{"line":101,"column":1},"end":{"line":101,"column":25}},"children":[{"type":"text","value":"Example ","key":"DOmYruQ0W7"},{"type":"text","value":"4.1.1","key":"YnRKTQy0qy"}],"template":"Example %s","enumerator":"4.1.1","resolved":true,"html_id":"demo-rootproblem-bessel","remote":true,"url":"/rootproblem","dataUrl":"/rootproblem.json","key":"QA9r7CfMzd"}],"key":"oIdeDq1Cqu"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"using Plots, SpecialFunctions\nJ₃(x) = besselj(3, x)\nplot(J₃, 0, 20;\n    title=\"Bessel function\",\n    xaxis=(L\"x\"),  yaxis=(L\"J_3(x)\"),  grid=:xy)","key":"YwZWGpnWzu"},{"type":"output","id":"XhaLmGBDyclwx5S_WuLOc","data":[],"key":"uJ3q2liEge"}],"data":{},"key":"tOxC5OhZBx"},{"type":"paragraph","position":{"start":{"line":111,"column":1},"end":{"line":111,"column":1}},"children":[{"type":"text","value":"From the graph we see roots near 6, 10, 13, 16, and 19. We use ","position":{"start":{"line":111,"column":1},"end":{"line":111,"column":1}},"key":"Ub49OjfS9n"},{"type":"inlineCode","value":"nlsolve","position":{"start":{"line":111,"column":1},"end":{"line":111,"column":1}},"key":"EgbpJyTFPl"},{"type":"text","value":" from the ","position":{"start":{"line":111,"column":1},"end":{"line":111,"column":1}},"key":"O84kYDlLML"},{"type":"inlineCode","value":"NLsolve","position":{"start":{"line":111,"column":1},"end":{"line":111,"column":1}},"key":"itHGBJmCZx"},{"type":"text","value":" package to find these roots accurately. It uses vector variables, so we have to code accordingly.","position":{"start":{"line":111,"column":1},"end":{"line":111,"column":1}},"key":"Rj3Ej8KyT7"}],"key":"qYOMasVwWU"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"tsolGBtPBg"}],"key":"Z7cxndFjUo"},{"type":"paragraph","position":{"start":{"line":114,"column":1},"end":{"line":115,"column":1}},"children":[{"type":"text","value":"Type ","position":{"start":{"line":114,"column":1},"end":{"line":114,"column":1}},"key":"HYTbuUVmDX"},{"type":"inlineCode","value":"\\omega","position":{"start":{"line":114,"column":1},"end":{"line":114,"column":1}},"key":"OiH1AWdvhf"},{"type":"text","value":" followed by ","position":{"start":{"line":114,"column":1},"end":{"line":114,"column":1}},"key":"b5GvsbmpPX"},{"type":"keyboard","children":[{"type":"text","value":"Tab","key":"BO7caw7nJf"}],"key":"eDR5pwdQdC"},{"type":"text","value":" to get the character ","position":{"start":{"line":114,"column":1},"end":{"line":114,"column":1}},"key":"u1yYDyBOxk"},{"type":"inlineCode","value":"ω","position":{"start":{"line":114,"column":1},"end":{"line":114,"column":1}},"key":"qmXsSLOcEp"},{"type":"text","value":".\nThe argument ","position":{"start":{"line":114,"column":1},"end":{"line":114,"column":1}},"key":"niiatN00x8"},{"type":"inlineCode","value":"ftol=1e-14","position":{"start":{"line":114,"column":1},"end":{"line":114,"column":1}},"key":"i4bHRE67W3"},{"type":"text","value":" below is called a ","position":{"start":{"line":114,"column":1},"end":{"line":114,"column":1}},"key":"gAuvqCUkf7"},{"type":"strong","position":{"start":{"line":114,"column":1},"end":{"line":114,"column":1}},"children":[{"type":"text","value":"keyword argument","position":{"start":{"line":114,"column":1},"end":{"line":114,"column":1}},"key":"Xl1pF26pIk"}],"key":"SPJ8G4LWMp"},{"type":"text","value":". Here it sets a goal for the maximum value of ","position":{"start":{"line":114,"column":1},"end":{"line":114,"column":1}},"key":"oD8urDZ5nL"},{"type":"inlineMath","value":"|f(x)|","position":{"start":{"line":114,"column":1},"end":{"line":114,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">∣</mi><mi>f</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mi mathvariant=\"normal\">∣</mi></mrow><annotation encoding=\"application/x-tex\">|f(x)|</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">∣</span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mord\">∣</span></span></span></span>","key":"ILSYjdMvN1"},{"type":"text","value":".","position":{"start":{"line":114,"column":1},"end":{"line":114,"column":1}},"key":"yfxM7Cg3cR"}],"key":"XAYAOYgXUh"}],"class":"dropdown","key":"ap51CBtpeP"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"using NLsolve\nω = []\nfor guess = [6., 10. ,13., 16., 19.]\n    s = nlsolve(x -> J₃(x[1]), [guess], ftol=1e-14)\n    append!(ω, s.zero)\nend","key":"KD5wanZLUB"},{"type":"output","id":"US6D_8x9wySq9sjha0Gnc","data":[],"key":"iZbpAkqAU8"}],"data":{},"key":"eDnb8SCzl6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"y = J₃.(ω)\n@pt :header=[\"root estimate\", \"function value\"] [ω y]","key":"cCFeafMP2O"},{"type":"output","id":"A1wc-YET6sdQcvDBSvht-","data":[],"key":"GzuN0X4b73"}],"data":{},"key":"BC8DsMvezD"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"scatter!(ω, y, title=\"Bessel function with roots\")","key":"cPVlrkvYxO"},{"type":"output","id":"67GrRsVx0cQfw_Gmwt7AZ","data":[],"key":"nXMAXVXJ6p"}],"data":{},"key":"Onjza4EG5T"},{"type":"paragraph","position":{"start":{"line":136,"column":1},"end":{"line":136,"column":1}},"children":[{"type":"text","value":"If instead we seek values at which ","position":{"start":{"line":136,"column":1},"end":{"line":136,"column":1}},"key":"OitPqRa5Sg"},{"type":"inlineMath","value":"J_3(x)=0.2","position":{"start":{"line":136,"column":1},"end":{"line":136,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>J</mi><mn>3</mn></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mn>0.2</mn></mrow><annotation encoding=\"application/x-tex\">J_3(x)=0.2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.09618em;\">J</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0962em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0.2</span></span></span></span>","key":"B9MdKvHxMZ"},{"type":"text","value":", then we must find roots of the function ","position":{"start":{"line":136,"column":1},"end":{"line":136,"column":1}},"key":"EgmfC1aTyl"},{"type":"inlineMath","value":"J_3(x)-0.2","position":{"start":{"line":136,"column":1},"end":{"line":136,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>J</mi><mn>3</mn></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>−</mo><mn>0.2</mn></mrow><annotation encoding=\"application/x-tex\">J_3(x)-0.2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.09618em;\">J</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0962em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0.2</span></span></span></span>","key":"RTovVCtte2"},{"type":"text","value":".","position":{"start":{"line":136,"column":1},"end":{"line":136,"column":1}},"key":"VrMsfhvSIn"}],"key":"lIV1jr2t5C"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"r = []\nfor guess = [3., 6., 10., 13.]\n    f(x) = J₃(x[1]) - 0.2\n    s = nlsolve(f, [guess], ftol=1e-14)\n    append!(r, s.zero)\nend\nscatter!(r, J₃.(r), title=\"Roots and other Bessel values\")","key":"VtrL1jSTBk"},{"type":"output","id":"ifQHoM8ihBWmQR1Cmrfem","data":[],"key":"lRHzf8Lvaz"}],"data":{},"key":"QoHz8LrzVf"}],"label":"demo-rootproblem-bessel-julia","identifier":"demo-rootproblem-bessel-julia","html_id":"demo-rootproblem-bessel-julia","key":"aOY4Zgmobi"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-roots-cond","label":"demo-roots-cond","kind":"proof:example","position":{"start":{"line":150,"column":1},"end":{"line":150,"column":17}},"children":[{"type":"text","value":"Example ","key":"nxhb4Ug3JZ"},{"type":"text","value":"4.1.2","key":"tPdq1hw86F"}],"template":"Example %s","enumerator":"4.1.2","resolved":true,"html_id":"demo-roots-cond","remote":true,"url":"/rootproblem","dataUrl":"/rootproblem.json","key":"Cpcf9ZxRSr"}],"key":"rgk2UFcp8x"},{"type":"paragraph","position":{"start":{"line":152,"column":1},"end":{"line":152,"column":1}},"children":[{"type":"text","value":"Consider first the function","position":{"start":{"line":152,"column":1},"end":{"line":152,"column":1}},"key":"FG9myT0s1g"}],"key":"F7NQ5cfFMs"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"f(x) = (x - 1) * (x - 2);","key":"U0ef2RcQJl"},{"type":"output","id":"cTHcrpF_JXWg94XSsPadt","data":[],"key":"cGCuJb1B3i"}],"data":{},"key":"tWR8wL328t"},{"type":"paragraph","position":{"start":{"line":162,"column":1},"end":{"line":162,"column":1}},"children":[{"type":"text","value":"At the root ","position":{"start":{"line":162,"column":1},"end":{"line":162,"column":1}},"key":"LXvKhEvvCK"},{"type":"inlineMath","value":"r=1","position":{"start":{"line":162,"column":1},"end":{"line":162,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>r</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">r=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"GW3PWNSawJ"},{"type":"text","value":", we have ","position":{"start":{"line":162,"column":1},"end":{"line":162,"column":1}},"key":"rPwwHRsQ1I"},{"type":"inlineMath","value":"f'(r)=-1","position":{"start":{"line":162,"column":1},"end":{"line":162,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>f</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo stretchy=\"false\">(</mo><mi>r</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mo>−</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">f&#x27;(r)=-1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0019em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">−</span><span class=\"mord\">1</span></span></span></span>","key":"IcM0bBD4Ju"},{"type":"text","value":". If the values of ","position":{"start":{"line":162,"column":1},"end":{"line":162,"column":1}},"key":"br6vW9OtWA"},{"type":"inlineMath","value":"f","position":{"start":{"line":162,"column":1},"end":{"line":162,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>","key":"lahxOCDx3T"},{"type":"text","value":" were perturbed at every point by a small amount of noise, we can imagine finding the root of the function drawn with a thick ribbon, giving a range of potential roots.","position":{"start":{"line":162,"column":1},"end":{"line":162,"column":1}},"key":"GA7y1bnRsS"}],"indexEntries":[{"entry":"Julia","subEntry":{"value":"splatting","kind":"entry"},"emphasis":true}],"label":"index-EmaSgX3Nge","identifier":"index-emasgx3nge","html_id":"index-emasgx3nge","key":"x2BhqZiCLO"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"her7VMLWwg"}],"key":"dSLZGApFkY"},{"type":"paragraph","position":{"start":{"line":165,"column":1},"end":{"line":165,"column":1}},"children":[{"type":"text","value":"The syntax ","position":{"start":{"line":165,"column":1},"end":{"line":165,"column":1}},"key":"qsM19kLhCe"},{"type":"inlineCode","value":"interval...","position":{"start":{"line":165,"column":1},"end":{"line":165,"column":1}},"key":"K7ZnVpq4Ac"},{"type":"text","value":" is called ","position":{"start":{"line":165,"column":1},"end":{"line":165,"column":1}},"key":"o6rVjP05LK"},{"type":"strong","position":{"start":{"line":165,"column":1},"end":{"line":165,"column":1}},"children":[{"type":"text","value":"splatting","position":{"start":{"line":165,"column":1},"end":{"line":165,"column":1}},"key":"y0EiIvLa5r"}],"key":"PDZttmpCW2"},{"type":"text","value":" and means to insert all the individual elements of ","position":{"start":{"line":165,"column":1},"end":{"line":165,"column":1}},"key":"f0kfiNxtr0"},{"type":"inlineCode","value":"interval","position":{"start":{"line":165,"column":1},"end":{"line":165,"column":1}},"key":"L2fKx0g8xL"},{"type":"text","value":" as a sequence.","position":{"start":{"line":165,"column":1},"end":{"line":165,"column":1}},"key":"AyYh8h2jeB"}],"key":"I8R4luw1Sh"}],"class":"dropdown","key":"osXs3YA0Bs"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"interval = [0.8, 1.2]\n\nplot(f, interval..., ribbon=0.03, aspect_ratio=1,\n    xlabel=L\"x\", yaxis=(L\"f(x)\", [-0.2, 0.2]))\n\nscatter!([1], [0], title=\"Well-conditioned root\")","key":"fyIkyyRuBX"},{"type":"output","id":"6axGzqPTK5RZlk3_5PlgV","data":[],"key":"jxqDmxdhGg"}],"data":{},"key":"cm6PDm6s6I"},{"type":"paragraph","position":{"start":{"line":178,"column":1},"end":{"line":178,"column":1}},"children":[{"type":"text","value":"The possible values for a perturbed root all lie within the interval where the ribbon intersects the ","position":{"start":{"line":178,"column":1},"end":{"line":178,"column":1}},"key":"jvIKfxAd0H"},{"type":"inlineMath","value":"x","position":{"start":{"line":178,"column":1},"end":{"line":178,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"tefvbNAgRB"},{"type":"text","value":"-axis. The width of that zone is about the same as the vertical thickness of the ribbon.","position":{"start":{"line":178,"column":1},"end":{"line":178,"column":1}},"key":"rgJmcbmDVF"}],"key":"i7SbesAsc2"},{"type":"paragraph","position":{"start":{"line":180,"column":1},"end":{"line":180,"column":1}},"children":[{"type":"text","value":"By contrast, consider the function","position":{"start":{"line":180,"column":1},"end":{"line":180,"column":1}},"key":"t5DEs0L38l"}],"key":"F2RaAFT4Ed"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"f(x) = (x - 1) * (x - 1.01);","key":"zlImSWcRkz"},{"type":"output","id":"lQQHkI21ELYhB-jFndxmf","data":[],"key":"gPPGq1euBI"}],"data":{},"key":"hfQ7lnKtgN"},{"type":"paragraph","position":{"start":{"line":186,"column":1},"end":{"line":186,"column":1}},"children":[{"type":"text","value":"Now ","position":{"start":{"line":186,"column":1},"end":{"line":186,"column":1}},"key":"u9abHIOm8z"},{"type":"inlineMath","value":"f'(1)=-0.01","position":{"start":{"line":186,"column":1},"end":{"line":186,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>f</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo><mo>=</mo><mo>−</mo><mn>0.01</mn></mrow><annotation encoding=\"application/x-tex\">f&#x27;(1)=-0.01</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0019em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">−</span><span class=\"mord\">0.01</span></span></span></span>","key":"nU9TtMouiP"},{"type":"text","value":", and the graph of ","position":{"start":{"line":186,"column":1},"end":{"line":186,"column":1}},"key":"AKxCpy5NuK"},{"type":"inlineMath","value":"f","position":{"start":{"line":186,"column":1},"end":{"line":186,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>","key":"vz3yvZoRSu"},{"type":"text","value":" will be much shallower near ","position":{"start":{"line":186,"column":1},"end":{"line":186,"column":1}},"key":"AgoEsSjlAv"},{"type":"inlineMath","value":"x=1","position":{"start":{"line":186,"column":1},"end":{"line":186,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">x=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"SPkm8j5ab8"},{"type":"text","value":". Look at the effect this has on our thick rendering:","position":{"start":{"line":186,"column":1},"end":{"line":186,"column":1}},"key":"eLtGWr1gjY"}],"key":"byfxaquasI"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"plot(f, interval..., ribbon=0.03, aspect_ratio=1,\n    xlabel=L\"x\", yaxis=(L\"f(x)\", [-0.2, 0.2]))\n\nscatter!([1], [0], title=\"Poorly-conditioned root\")","key":"fxQakKtkGK"},{"type":"output","id":"d_ja9fj-KLfS2Fhjmch1H","data":[],"key":"q0m2oc1sxO"}],"data":{},"key":"zfkuDHYU1M"},{"type":"paragraph","position":{"start":{"line":195,"column":1},"end":{"line":195,"column":1}},"children":[{"type":"text","value":"The vertical displacements in this picture are exactly the same as before. But the potential ","position":{"start":{"line":195,"column":1},"end":{"line":195,"column":1}},"key":"phQkrNhlxi"},{"type":"emphasis","position":{"start":{"line":195,"column":1},"end":{"line":195,"column":1}},"children":[{"type":"text","value":"horizontal","position":{"start":{"line":195,"column":1},"end":{"line":195,"column":1}},"key":"tHHa2fUiMk"}],"key":"WY7BBCRURS"},{"type":"text","value":" displacement of the root is much wider. In fact, if we perturb the function entirely upward by the amount drawn here, the root disappears!","position":{"start":{"line":195,"column":1},"end":{"line":195,"column":1}},"key":"XQe52adNOY"}],"key":"k9uyH7Mmnf"}],"label":"demo-roots-cond-julia","identifier":"demo-roots-cond-julia","html_id":"demo-roots-cond-julia","key":"nvorARd6Rq"},{"type":"heading","depth":3,"position":{"start":{"line":199,"column":1},"end":{"line":199,"column":1}},"children":[{"type":"text","value":"4.2 ","position":{"start":{"line":199,"column":1},"end":{"line":199,"column":1}},"key":"eYuHKjfEin"},{"type":"link","identifier":"section-nonlineqn-fixed-point","label":"section-nonlineqn-fixed-point","kind":"narrative","position":{"start":{"line":199,"column":5},"end":{"line":199,"column":35}},"url":"/fixed-point","internal":true,"dataUrl":"/fixed-point.json","children":[{"type":"text","value":"Fixed-point iteration","key":"G2s8KCeSKZ"}],"key":"qUdj1uNx5G"}],"identifier":"id-4-2","label":"4.2 ","html_id":"id-4-2","implicit":true,"key":"Vx5xWf9ptk"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-fp-spiral","label":"demo-fp-spiral","kind":"proof:example","position":{"start":{"line":202,"column":1},"end":{"line":202,"column":16}},"children":[{"type":"text","value":"Example ","key":"Yv4VMes1Qz"},{"type":"text","value":"4.2.1","key":"n3ZThOAJa1"}],"template":"Example %s","enumerator":"4.2.1","resolved":true,"html_id":"demo-fp-spiral","remote":true,"url":"/fixed-point","dataUrl":"/fixed-point.json","key":"WruBD1U4A7"}],"key":"JEnbXYKBZy"},{"type":"paragraph","position":{"start":{"line":204,"column":1},"end":{"line":204,"column":1}},"children":[{"type":"text","value":"Let’s convert the roots of a quadratic polynomial ","position":{"start":{"line":204,"column":1},"end":{"line":204,"column":1}},"key":"fl1LX4eM6l"},{"type":"inlineMath","value":"f(x)","position":{"start":{"line":204,"column":1},"end":{"line":204,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">f(x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span>","key":"NZMY4skLU2"},{"type":"text","value":" to a fixed point problem.","position":{"start":{"line":204,"column":1},"end":{"line":204,"column":1}},"key":"ezBWzSxjlc"}],"key":"JKFEtO6uc1"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"using Polynomials\np = Polynomial([3.5, -4,1])\nr = roots(p)\nrmin, rmax = extrema(r)\n@show rmin, rmax;","key":"kdfPOHNPLL"},{"type":"output","id":"JnZFs3MaU6O7_NhhGNOKB","data":[],"key":"sNBzQ8Qzck"}],"data":{},"key":"FCPHBvurb4"},{"type":"paragraph","position":{"start":{"line":214,"column":1},"end":{"line":214,"column":1}},"children":[{"type":"text","value":"We define ","position":{"start":{"line":214,"column":1},"end":{"line":214,"column":1}},"key":"q8bCe2ZeNf"},{"type":"inlineMath","value":"g(x)=x-p(x)","position":{"start":{"line":214,"column":1},"end":{"line":214,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>g</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>x</mi><mo>−</mo><mi>p</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">g(x)=x-p(x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span>","key":"SE63AssMEz"},{"type":"text","value":".","position":{"start":{"line":214,"column":1},"end":{"line":214,"column":1}},"key":"TSKnuug4mU"}],"key":"tD6ZbIfo3F"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"g(x) = x - p(x)","key":"HB3qTdphR5"},{"type":"output","id":"Vuc6TDJfz7-13MjBEd6Go","data":[],"key":"yXGcEUSIRB"}],"data":{},"key":"OMIJDtYhJW"},{"type":"paragraph","position":{"start":{"line":220,"column":1},"end":{"line":220,"column":1}},"children":[{"type":"text","value":"Intersections of ","position":{"start":{"line":220,"column":1},"end":{"line":220,"column":1}},"key":"YwcS3yQYEp"},{"type":"inlineMath","value":"y=g(x)","position":{"start":{"line":220,"column":1},"end":{"line":220,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi><mo>=</mo><mi>g</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">y=g(x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span>","key":"Kcjm6bilSI"},{"type":"text","value":" with the line ","position":{"start":{"line":220,"column":1},"end":{"line":220,"column":1}},"key":"bPiHuUPCGO"},{"type":"inlineMath","value":"y=x","position":{"start":{"line":220,"column":1},"end":{"line":220,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi><mo>=</mo><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">y=x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"Es8zf2PdDu"},{"type":"text","value":" are fixed points of ","position":{"start":{"line":220,"column":1},"end":{"line":220,"column":1}},"key":"MItqVAUL4O"},{"type":"inlineMath","value":"g","position":{"start":{"line":220,"column":1},"end":{"line":220,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>g</mi></mrow><annotation encoding=\"application/x-tex\">g</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span></span></span></span>","key":"jjtHgbWfr9"},{"type":"text","value":" and thus roots of ","position":{"start":{"line":220,"column":1},"end":{"line":220,"column":1}},"key":"jGVVUF0IQs"},{"type":"inlineMath","value":"f","position":{"start":{"line":220,"column":1},"end":{"line":220,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>","key":"MXT5XPlU5y"},{"type":"text","value":". (Only one is shown in the chosen plot range.)","position":{"start":{"line":220,"column":1},"end":{"line":220,"column":1}},"key":"NjZve0nAWE"}],"key":"DmYK5tsRMA"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"using Plots\nplt = plot([g x->x], 2, 3;\n    l=2, label=[L\"y=g(x)\" L\"y=x\"],\n    xlabel=L\"x\",  ylabel=L\"y\", \n    aspect_ratio=1,\n    title=\"Finding a fixed point\",  legend=:bottomright)","key":"qFnhobjz7j"},{"type":"output","id":"7ZkwdIHuQshHN6jtXqbQD","data":[],"key":"Z2advbI6qF"}],"data":{},"key":"kYHNKx7Hbo"},{"type":"paragraph","position":{"start":{"line":231,"column":1},"end":{"line":231,"column":1}},"children":[{"type":"text","value":"If we evaluate ","position":{"start":{"line":231,"column":1},"end":{"line":231,"column":1}},"key":"clFgvPuaaj"},{"type":"inlineMath","value":"g(2.1)","position":{"start":{"line":231,"column":1},"end":{"line":231,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>g</mi><mo stretchy=\"false\">(</mo><mn>2.1</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">g(2.1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mopen\">(</span><span class=\"mord\">2.1</span><span class=\"mclose\">)</span></span></span></span>","key":"yUCBYDhvQS"},{"type":"text","value":", we get a value of almost 2.6, so this is not a fixed point.","position":{"start":{"line":231,"column":1},"end":{"line":231,"column":1}},"key":"fhWMrHy7V5"}],"key":"D2SxX2V6S8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"x = 2.1;\ny = g(x)","key":"XWMvy6OzL3"},{"type":"output","id":"x6JyzgsN-wH-ztZ1ekAbD","data":[],"key":"IFOyVHTbz1"}],"data":{},"key":"Dqq9FUkkr3"},{"type":"paragraph","position":{"start":{"line":238,"column":1},"end":{"line":238,"column":1}},"children":[{"type":"text","value":"However, ","position":{"start":{"line":238,"column":1},"end":{"line":238,"column":1}},"key":"bnDe9u4Eq6"},{"type":"inlineMath","value":"y=g(x)","position":{"start":{"line":238,"column":1},"end":{"line":238,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi><mo>=</mo><mi>g</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">y=g(x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span>","key":"MygFi3Pddm"},{"type":"text","value":" is considerably closer to the fixed point at around 2.7 than ","position":{"start":{"line":238,"column":1},"end":{"line":238,"column":1}},"key":"syeClVRxD6"},{"type":"inlineMath","value":"x","position":{"start":{"line":238,"column":1},"end":{"line":238,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"DW2VI8B7W3"},{"type":"text","value":" is. Suppose then that we adopt ","position":{"start":{"line":238,"column":1},"end":{"line":238,"column":1}},"key":"OwfxOF49vF"},{"type":"inlineMath","value":"y","position":{"start":{"line":238,"column":1},"end":{"line":238,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>","key":"qesJ9gCEJw"},{"type":"text","value":" as our new ","position":{"start":{"line":238,"column":1},"end":{"line":238,"column":1}},"key":"NV65ndo1zK"},{"type":"inlineMath","value":"x","position":{"start":{"line":238,"column":1},"end":{"line":238,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"VOMIIYQhyn"},{"type":"text","value":" value. Changing the ","position":{"start":{"line":238,"column":1},"end":{"line":238,"column":1}},"key":"EWmHdULrmD"},{"type":"inlineMath","value":"x","position":{"start":{"line":238,"column":1},"end":{"line":238,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"QxdFVtykmD"},{"type":"text","value":" coordinate in this way is the same as following a horizontal line over to the graph of ","position":{"start":{"line":238,"column":1},"end":{"line":238,"column":1}},"key":"NNAsTpkzly"},{"type":"inlineMath","value":"y=x","position":{"start":{"line":238,"column":1},"end":{"line":238,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi><mo>=</mo><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">y=x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"QAEobUtDfe"},{"type":"text","value":".","position":{"start":{"line":238,"column":1},"end":{"line":238,"column":1}},"key":"rj4CrtJc0a"}],"key":"sDS9lofeWi"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"plot!([x, y], [y, y], arrow=true, color=3)","key":"eYoY1LwsfW"},{"type":"output","id":"5W6ZLfFgJpLvYkkQQ3NHA","data":[],"key":"mkXeelkBZk"}],"data":{},"key":"t4QqnbRoW1"},{"type":"paragraph","position":{"start":{"line":244,"column":1},"end":{"line":244,"column":1}},"children":[{"type":"text","value":"Now we can compute a new value for ","position":{"start":{"line":244,"column":1},"end":{"line":244,"column":1}},"key":"EVfd1LjF4n"},{"type":"inlineMath","value":"y","position":{"start":{"line":244,"column":1},"end":{"line":244,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>","key":"MpuiYkVHwI"},{"type":"text","value":". We leave ","position":{"start":{"line":244,"column":1},"end":{"line":244,"column":1}},"key":"y10XpIsYSA"},{"type":"inlineMath","value":"x","position":{"start":{"line":244,"column":1},"end":{"line":244,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"ytQ1aFT108"},{"type":"text","value":" alone here, so we travel along a vertical line to the graph of ","position":{"start":{"line":244,"column":1},"end":{"line":244,"column":1}},"key":"jHZz5eQhzS"},{"type":"inlineMath","value":"g","position":{"start":{"line":244,"column":1},"end":{"line":244,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>g</mi></mrow><annotation encoding=\"application/x-tex\">g</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span></span></span></span>","key":"zsY1OQmEPQ"},{"type":"text","value":".","position":{"start":{"line":244,"column":1},"end":{"line":244,"column":1}},"key":"MdSKfYsfxh"}],"key":"Ljabu2T1fd"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"x = y;  y = g(x)\nplot!([x, x], [x, y], arrow=true, color=4)","key":"RXUTuwRTCI"},{"type":"output","id":"6OBG58sQ-onxHPSAjChrn","data":[],"key":"PNhz8E49FW"}],"data":{},"key":"bpMTNppahC"},{"type":"paragraph","position":{"start":{"line":251,"column":1},"end":{"line":251,"column":1}},"children":[{"type":"text","value":"You see that we are in a position to repeat these steps as often as we like. Let’s apply them a few times and see the result.","position":{"start":{"line":251,"column":1},"end":{"line":251,"column":1}},"key":"fdgH0N2zN1"}],"key":"sFtaImnIOp"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"for k = 1:5\n    plot!([x, y], [y, y], color=3);  \n    x = y       # y becomes the new x\n    y = g(x)    # g(x) becomes the new y\n    plot!([x, x], [x, y], color=4)  \nend\nplt","key":"ubtKZDJPSo"},{"type":"output","id":"87BU7eHrrIKD4m79Hl1am","data":[],"key":"KaFSFlLh3K"}],"data":{},"key":"MmjpCxzJ3u"},{"type":"paragraph","position":{"start":{"line":263,"column":1},"end":{"line":263,"column":1}},"children":[{"type":"text","value":"The process spirals in beautifully toward the fixed point we seek. Our last estimate has almost 4 accurate digits.","position":{"start":{"line":263,"column":1},"end":{"line":263,"column":1}},"key":"JkGfou7i2e"}],"key":"yKDzr7VNBc"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"abs(y - rmax) / rmax","key":"FyAiaGlrvm"},{"type":"output","id":"jJgus_z6eXfuokeL5sYLE","data":[],"key":"AeyTAuPMnX"}],"data":{},"key":"fiqD7TTwxr"},{"type":"paragraph","position":{"start":{"line":269,"column":1},"end":{"line":269,"column":1}},"children":[{"type":"text","value":"Now let’s try to find the other fixed point ","position":{"start":{"line":269,"column":1},"end":{"line":269,"column":1}},"key":"rnsyJt9sc6"},{"type":"inlineMath","value":"\\approx 1.29","position":{"start":{"line":269,"column":1},"end":{"line":269,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>≈</mo><mn>1.29</mn></mrow><annotation encoding=\"application/x-tex\">\\approx 1.29</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4831em;\"></span><span class=\"mrel\">≈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1.29</span></span></span></span>","key":"vm7af1pS0S"},{"type":"text","value":" in the same way. We’ll use 1.3 as a starting approximation.","position":{"start":{"line":269,"column":1},"end":{"line":269,"column":1}},"key":"TlbodxZifq"}],"key":"eA9gj2LPuE"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"plt = plot([g x->x], 1, 2, l=2, label=[\"y=g(x)\" \"y=x\"], aspect_ratio=1, \n    xlabel=L\"x\", ylabel=L\"y\", title=\"Divergence\", legend=:bottomright)\n\nx = 1.3; y = g(x);\narrow = false\nfor k = 1:5\n    plot!([x, y], [y, y], arrow=arrow, color=3)  \n    x = y       # y --> new x\n    y = g(x)    # g(x) --> new y\n    plot!([x, x], [x, y], arrow=arrow, color=4)\n    if k > 2; arrow = true; end\nend\nplt","key":"jXLwv1zOoX"},{"type":"output","id":"_YED6VvrRNcTGwJa2CVMJ","data":[],"key":"bwQQPtr59F"}],"data":{},"key":"MzZ1cEbySQ"},{"type":"paragraph","position":{"start":{"line":287,"column":1},"end":{"line":287,"column":1}},"children":[{"type":"text","value":"This time, the iteration is pushing us ","position":{"start":{"line":287,"column":1},"end":{"line":287,"column":1}},"key":"rglasTfwan"},{"type":"emphasis","position":{"start":{"line":287,"column":1},"end":{"line":287,"column":1}},"children":[{"type":"text","value":"away from","position":{"start":{"line":287,"column":1},"end":{"line":287,"column":1}},"key":"FKJ3fqPbfY"}],"key":"jdkQJM0DF5"},{"type":"text","value":" the correct answer.","position":{"start":{"line":287,"column":1},"end":{"line":287,"column":1}},"key":"rE5X1V9wwt"}],"key":"gbQgPLV5ke"}],"label":"demo-fp-spiral-julia","identifier":"demo-fp-spiral-julia","html_id":"demo-fp-spiral-julia","key":"h3BHntlf1n"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-fp-converge","label":"demo-fp-converge","kind":"proof:example","position":{"start":{"line":291,"column":1},"end":{"line":291,"column":18}},"children":[{"type":"text","value":"Example ","key":"HzuoToyWA2"},{"type":"text","value":"4.2.3","key":"ceYLVzKuv2"}],"template":"Example %s","enumerator":"4.2.3","resolved":true,"html_id":"demo-fp-converge","remote":true,"url":"/fixed-point","dataUrl":"/fixed-point.json","key":"tuercXpWKd"}],"key":"n8Fami3Xjk"},{"type":"paragraph","position":{"start":{"line":293,"column":1},"end":{"line":293,"column":1}},"children":[{"type":"text","value":"We revisit ","position":{"start":{"line":293,"column":1},"end":{"line":293,"column":1}},"key":"Kq076bbudt"},{"type":"crossReference","kind":"proof:example","identifier":"demo-fp-spiral","label":"demo-fp-spiral","children":[{"type":"text","value":"Demo ","key":"ap3sUQ6ciB"},{"type":"text","value":"4.2.1","key":"AxZTRqhVsK"}],"template":"Example %s","enumerator":"4.2.1","resolved":true,"html_id":"demo-fp-spiral","remote":true,"url":"/fixed-point","dataUrl":"/fixed-point.json","key":"X2miEjPrDv"},{"type":"text","value":" and investigate the observed convergence more closely. Recall that above we calculated ","position":{"start":{"line":293,"column":1},"end":{"line":293,"column":1}},"key":"mz6xkpNv9d"},{"type":"inlineMath","value":"g'(p)\\approx-0.42","position":{"start":{"line":293,"column":1},"end":{"line":293,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>g</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo stretchy=\"false\">(</mo><mi>p</mi><mo stretchy=\"false\">)</mo><mo>≈</mo><mo>−</mo><mn>0.42</mn></mrow><annotation encoding=\"application/x-tex\">g&#x27;(p)\\approx-0.42</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0019em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">p</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">−</span><span class=\"mord\">0.42</span></span></span></span>","key":"gGFZ4CpTrc"},{"type":"text","value":" at the convergent fixed point.","position":{"start":{"line":293,"column":1},"end":{"line":293,"column":1}},"key":"CP48HUMXnL"}],"key":"MMMzogueSR"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"p = Polynomial([3.5, -4, 1])\nr = roots(p)\nrmin, rmax = extrema(r)\n@show rmin, rmax;","key":"A3p4PvB4KP"},{"type":"output","id":"Il3YNlKEtS_Cp7dfuiG9s","data":[],"key":"DHVWJBTv1o"}],"data":{},"key":"tVlW5Ypx1Z"},{"type":"paragraph","position":{"start":{"line":302,"column":1},"end":{"line":302,"column":1}},"children":[{"type":"text","value":"Here is the fixed-point iteration. This time we keep track of the whole sequence of approximations.","position":{"start":{"line":302,"column":1},"end":{"line":302,"column":1}},"key":"sZ0hLooYv0"}],"key":"xDDhxwadXr"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"g(x) = x - p(x)\nx = [2.1]\nfor k = 1:12\n    push!(x, g(x[k]))\nend\nx","key":"foqkCTk4AJ"},{"type":"output","id":"da6d9AyrB8308jcgaqTmE","data":[],"key":"ZxTmWMPswx"}],"data":{},"indexEntries":[{"entry":"Julia","subEntry":{"value":"push!","kind":"entry"},"emphasis":false}],"label":"index-iGtehEWaj6","identifier":"index-igtehewaj6","html_id":"index-igtehewaj6","key":"u7UthB4m2o"},{"type":"paragraph","position":{"start":{"line":316,"column":1},"end":{"line":316,"column":1}},"children":[{"type":"text","value":"It’s illuminating to construct and plot the sequence of errors.","position":{"start":{"line":316,"column":1},"end":{"line":316,"column":1}},"key":"C3jiRMmIqW"}],"key":"nwpstltMVV"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"err = @. abs(x - rmax)\nplot(0:12, err;\n    m=:o,\n    xaxis=(\"iteration number\"),  yaxis=(\"error\", :log10),\n    title=\"Convergence of fixed-point iteration\")","key":"DmUxgFjxcK"},{"type":"output","id":"pKWEwiRsHprlAg0n0Df8p","data":[],"key":"fnzv4D4z8J"}],"data":{},"key":"te4mN3xZKi"},{"type":"paragraph","position":{"start":{"line":326,"column":1},"end":{"line":326,"column":1}},"children":[{"type":"text","value":"It’s quite clear that the convergence quickly settles into a linear rate. We could estimate this rate by doing a least-squares fit to a straight line. Keep in mind that the values for small ","position":{"start":{"line":326,"column":1},"end":{"line":326,"column":1}},"key":"oSMK3JPOFY"},{"type":"inlineMath","value":"k","position":{"start":{"line":326,"column":1},"end":{"line":326,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span>","key":"pk0yzVqRUO"},{"type":"text","value":" should be left out of the computation, as they don’t represent the linear trend.","position":{"start":{"line":326,"column":1},"end":{"line":326,"column":1}},"key":"UI1WBB3A1B"}],"key":"T3UKtcnraF"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"y = log.(err[5:12])\np = Polynomials.fit(5:12, y, 1)","key":"BxneErHQGe"},{"type":"output","id":"C1DccbgHYVqwLHj7CI7rC","data":[],"key":"mAtoouCHMN"}],"data":{},"key":"dcap897Hq1"},{"type":"paragraph","position":{"start":{"line":333,"column":1},"end":{"line":333,"column":1}},"children":[{"type":"text","value":"We can exponentiate the slope to get the convergence constant ","position":{"start":{"line":333,"column":1},"end":{"line":333,"column":1}},"key":"dI6CusUL9i"},{"type":"text","value":"σ","position":{"start":{"line":333,"column":1},"end":{"line":333,"column":1}},"key":"lbUmZqEvZf"},{"type":"text","value":".","position":{"start":{"line":333,"column":1},"end":{"line":333,"column":1}},"key":"GA5Qc8V8Hm"}],"key":"hBWWd3r6h8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"σ = exp(p.coeffs[2])","key":"ouC3Qqlegu"},{"type":"output","id":"AUMMSjtc6MxKbkVccPvoa","data":[],"key":"VQc6mUdeT6"}],"data":{},"key":"BGZc87QwwD"},{"type":"paragraph","position":{"start":{"line":339,"column":1},"end":{"line":339,"column":1}},"children":[{"type":"text","value":"The error should therefore decrease by a factor of ","position":{"start":{"line":339,"column":1},"end":{"line":339,"column":1}},"key":"WLlIpfeCzO"},{"type":"text","value":"σ","position":{"start":{"line":339,"column":1},"end":{"line":339,"column":1}},"key":"uGIdyXXTn6"},{"type":"text","value":" at each iteration. We can check this easily from the observed data.","position":{"start":{"line":339,"column":1},"end":{"line":339,"column":1}},"key":"zeee2TNusr"}],"key":"DLcZZbcOWU"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"[err[i+1] / err[i] for i in 8:11]","key":"qokASUbaOT"},{"type":"output","id":"Tli1QkZZb_6PcZoBFDtn7","data":[],"key":"WSb758sg1T"}],"data":{},"key":"bHURxPEze5"},{"type":"paragraph","position":{"start":{"line":345,"column":1},"end":{"line":345,"column":1}},"children":[{"type":"text","value":"The methods for finding ","position":{"start":{"line":345,"column":1},"end":{"line":345,"column":1}},"key":"za8JsMwISy"},{"type":"text","value":"σ","position":{"start":{"line":345,"column":1},"end":{"line":345,"column":1}},"key":"gi1R5HERw0"},{"type":"text","value":" agree well.","position":{"start":{"line":345,"column":1},"end":{"line":345,"column":1}},"key":"Z4MdbbOqCF"}],"key":"HVTLB2Q623"}],"label":"demo-fp-converge-julia","identifier":"demo-fp-converge-julia","html_id":"demo-fp-converge-julia","key":"UnsKSMeKRP"},{"type":"heading","depth":3,"position":{"start":{"line":348,"column":1},"end":{"line":348,"column":1}},"children":[{"type":"text","value":"4.3 ","position":{"start":{"line":348,"column":1},"end":{"line":348,"column":1}},"key":"lzaR8NT4TT"},{"type":"link","identifier":"section-nonlineqn-newton","label":"section-nonlineqn-newton","kind":"narrative","position":{"start":{"line":348,"column":5},"end":{"line":348,"column":30}},"url":"/newton","internal":true,"dataUrl":"/newton.json","children":[{"type":"text","value":"Newton’s method","key":"avNVcC7Xdq"}],"key":"zX8OhfgUiX"}],"identifier":"id-4-3","label":"4.3 ","html_id":"id-4-3","implicit":true,"key":"U7wKgoz1wO"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-newton-line","label":"demo-newton-line","kind":"proof:example","position":{"start":{"line":351,"column":1},"end":{"line":351,"column":18}},"children":[{"type":"text","value":"Example ","key":"W7KgyytgXz"},{"type":"text","value":"4.3.1","key":"hWDdAR2xP2"}],"template":"Example %s","enumerator":"4.3.1","resolved":true,"html_id":"demo-newton-line","remote":true,"url":"/newton","dataUrl":"/newton.json","key":"jLposxnRPi"}],"key":"TsAVACoqH2"},{"type":"paragraph","position":{"start":{"line":354,"column":1},"end":{"line":354,"column":1}},"children":[{"type":"text","value":"Suppose we want to find a root of the function","position":{"start":{"line":354,"column":1},"end":{"line":354,"column":1}},"key":"wAXoyG4v7P"}],"key":"OteaOSuuxs"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"f(x) = x * exp(x) - 2\nusing Plots\nplot(f, 0, 1.5; \n    label=\"function\",  legend=:topleft,\n    grid=:y,  ylim=[-2, 4],  xlabel=L\"x\",  ylabel=L\"y\")","key":"t4cSrtg3N2"},{"type":"output","id":"gqgFqRRhpN4ZoHML_oCCH","data":[],"key":"hTjuZg4RNS"}],"data":{},"key":"H0pYmBgveI"},{"type":"paragraph","position":{"start":{"line":364,"column":1},"end":{"line":364,"column":1}},"children":[{"type":"text","value":"From the graph, it is clear that there is a root near ","position":{"start":{"line":364,"column":1},"end":{"line":364,"column":1}},"key":"AQkRVBuTQt"},{"type":"inlineMath","value":"x=1","position":{"start":{"line":364,"column":1},"end":{"line":364,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">x=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"OA5yWR3WrP"},{"type":"text","value":". So we call that our initial guess, ","position":{"start":{"line":364,"column":1},"end":{"line":364,"column":1}},"key":"ipSaYo22HT"},{"type":"inlineMath","value":"x_1","position":{"start":{"line":364,"column":1},"end":{"line":364,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">x_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"yS7a9xv2OI"},{"type":"text","value":".","position":{"start":{"line":364,"column":1},"end":{"line":364,"column":1}},"key":"iVTuukNhir"}],"key":"bdgGeCkkUQ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"x₁ = 1\ny₁ = f(x₁)\nscatter!([x₁], [y₁], label=\"initial point\")","key":"dd3RR6B1BQ"},{"type":"output","id":"wvENlUQhZNEEVa80NjngP","data":[],"key":"TEgRnCGw0g"}],"data":{},"key":"bYjbrExy46"},{"type":"paragraph","position":{"start":{"line":372,"column":1},"end":{"line":372,"column":1}},"children":[{"type":"text","value":"Next, we can compute the tangent line at the point ","position":{"start":{"line":372,"column":1},"end":{"line":372,"column":1}},"key":"kZCVBPNOGD"},{"type":"inlineMath","value":"\\bigl(x_1,f(x_1)\\bigr)","position":{"start":{"line":372,"column":1},"end":{"line":372,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo fence=\"true\" stretchy=\"true\" minsize=\"1.2em\" maxsize=\"1.2em\">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><mi>f</mi><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy=\"false\">)</mo><mo fence=\"true\" stretchy=\"true\" minsize=\"1.2em\" maxsize=\"1.2em\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\bigl(x_1,f(x_1)\\bigr)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.2em;vertical-align:-0.35em;\"></span><span class=\"mopen\"><span class=\"delimsizing size1\">(</span></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mclose\"><span class=\"delimsizing size1\">)</span></span></span></span></span>","key":"Y2fs0dse5R"},{"type":"text","value":", using the derivative.","position":{"start":{"line":372,"column":1},"end":{"line":372,"column":1}},"key":"jgfmbeh1rI"}],"key":"JJFKgTHObB"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"df_dx(x) = exp(x) * (x + 1)\nm₁ = df_dx(x₁)\ntangent = x -> y₁ + m₁ * (x - x₁)\n\nplot!(tangent, 0, 1.5, l=:dash, label=\"tangent line\",\n    title=\"Tangent line approximation\")","key":"Cnbr0xxELC"},{"type":"output","id":"PTVq3zZzsuRBMONaCAsmN","data":[],"key":"oNZ0CvvOiV"}],"data":{},"key":"AYaE7k2ug5"},{"type":"paragraph","position":{"start":{"line":383,"column":1},"end":{"line":383,"column":1}},"children":[{"type":"text","value":"In lieu of finding the root of ","position":{"start":{"line":383,"column":1},"end":{"line":383,"column":1}},"key":"iZfcV28411"},{"type":"inlineMath","value":"f","position":{"start":{"line":383,"column":1},"end":{"line":383,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>","key":"kkgdKCPeJ8"},{"type":"text","value":" itself, we settle for finding the root of the tangent line approximation, which is trivial. Call this ","position":{"start":{"line":383,"column":1},"end":{"line":383,"column":1}},"key":"euV5vpjbou"},{"type":"inlineMath","value":"x_2","position":{"start":{"line":383,"column":1},"end":{"line":383,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">x_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"Dt4wYKrfvZ"},{"type":"text","value":", our next approximation to the root.","position":{"start":{"line":383,"column":1},"end":{"line":383,"column":1}},"key":"BgYyYA8Hnp"}],"key":"cZ3FUF1JDi"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"@show x₂ = x₁ - y₁ / m₁\nscatter!([x₂], [0], label=\"tangent root\", title=\"First iteration\")","key":"XmAurniXoC"},{"type":"output","id":"OqTVNFzPjZpEKJQg66LNp","data":[],"key":"Sxva4Xcf3Y"}],"data":{},"key":"n4a7vwqX70"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"y₂ = f(x₂)","key":"h6lXIwVfvc"},{"type":"output","id":"LtUKdD2pMa1Q1Je45dPZr","data":[],"key":"YiiKhaWi8S"}],"data":{},"key":"tfiKT8oBOW"},{"type":"paragraph","position":{"start":{"line":394,"column":1},"end":{"line":394,"column":1}},"children":[{"type":"text","value":"The residual (i.e., value of ","position":{"start":{"line":394,"column":1},"end":{"line":394,"column":1}},"key":"kKijvYfw6o"},{"type":"inlineMath","value":"f","position":{"start":{"line":394,"column":1},"end":{"line":394,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>","key":"heCpyXv9Zi"},{"type":"text","value":") is smaller than before, but not zero. So we repeat the process with a new tangent line based on the latest point on the curve.","position":{"start":{"line":394,"column":1},"end":{"line":394,"column":1}},"key":"RiurTWGbrD"}],"key":"rwxl5t8oOO"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"plot(f, 0.82, 0.87;\n    label=\"function\",  legend=:topleft,\n    xlabel=L\"x\",  ylabel=L\"y\",\n    title=\"Second iteration\")\n\nscatter!([x₂], [y₂], label=\"starting point\")\n\nm₂ = df_dx(x₂)\ntangent = x -> y₂ + m₂ * (x - x₂)\nplot!(tangent, 0.82, 0.87; l=:dash, label=\"tangent line\")\n\n@show x₃ = x₂ - y₂ / m₂\nscatter!([x₃], [0], label=\"tangent root\")","key":"w9feWyyekx"},{"type":"output","id":"WXrcUDsHXuBSTFoT5NHnd","data":[],"key":"xIHMDB47vc"}],"data":{},"key":"s1WNvMOGWE"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"y₃ = f(x₃)","key":"vqw6aLqqLG"},{"type":"output","id":"VjizK0Xd25ORiJzNaivGM","data":[],"key":"K8LHewOTsN"}],"data":{},"key":"GfCryUs8xm"},{"type":"paragraph","position":{"start":{"line":416,"column":1},"end":{"line":416,"column":1}},"children":[{"type":"text","value":"Judging by the residual, we appear to be getting closer to the true root each time.","position":{"start":{"line":416,"column":1},"end":{"line":416,"column":1}},"key":"GGjztYkdrB"}],"key":"r68KQCGWYf"}],"label":"demo-newton-line-julia","identifier":"demo-newton-line-julia","html_id":"demo-newton-line-julia","key":"OCuO4KhUPb"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-newton-converge","label":"demo-newton-converge","kind":"proof:example","position":{"start":{"line":420,"column":1},"end":{"line":420,"column":22}},"children":[{"type":"text","value":"Example ","key":"s4K5PNFqJM"},{"type":"text","value":"4.3.2","key":"IL32CTkWQQ"}],"template":"Example %s","enumerator":"4.3.2","resolved":true,"html_id":"demo-newton-converge","remote":true,"url":"/newton","dataUrl":"/newton.json","key":"we3P4gPRML"}],"key":"r811c0Nt0F"},{"type":"paragraph","position":{"start":{"line":422,"column":1},"end":{"line":422,"column":1}},"children":[{"type":"text","value":"We again look at finding a solution of ","position":{"start":{"line":422,"column":1},"end":{"line":422,"column":1}},"key":"TYFyySbDlr"},{"type":"inlineMath","value":"x e^x=2","position":{"start":{"line":422,"column":1},"end":{"line":422,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><msup><mi>e</mi><mi>x</mi></msup><mo>=</mo><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">x e^x=2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6644em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span></span></span></span>","key":"VmNGDzYhIL"},{"type":"text","value":" near ","position":{"start":{"line":422,"column":1},"end":{"line":422,"column":1}},"key":"oHn5YFP0sn"},{"type":"inlineMath","value":"x=1","position":{"start":{"line":422,"column":1},"end":{"line":422,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">x=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"U1B1jHdNQz"},{"type":"text","value":". To apply Newton’s method, we need to calculate values of both the residual function ","position":{"start":{"line":422,"column":1},"end":{"line":422,"column":1}},"key":"N3LzAMk4FQ"},{"type":"inlineMath","value":"f","position":{"start":{"line":422,"column":1},"end":{"line":422,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>","key":"wucL6XLihf"},{"type":"text","value":" and its derivative.","position":{"start":{"line":422,"column":1},"end":{"line":422,"column":1}},"key":"eooak0Qs7M"}],"key":"f4DWBOoGBA"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"f(x) = x * exp(x) - 2;\ndf_dx(x) = exp(x) * (x + 1);","key":"v2NCyhUQ9p"},{"type":"output","id":"Xy6E-y3GaYr3E8GkstoEo","data":[],"key":"RRMBbtaTt6"}],"data":{},"key":"EdOgcjEszm"},{"type":"paragraph","position":{"start":{"line":429,"column":1},"end":{"line":429,"column":1}},"children":[{"type":"text","value":"We don’t know the exact root, so we use ","position":{"start":{"line":429,"column":1},"end":{"line":429,"column":1}},"key":"pYQVMPBeA2"},{"type":"inlineCode","value":"nlsolve","position":{"start":{"line":429,"column":1},"end":{"line":429,"column":1}},"key":"JfowvaZivn"},{"type":"text","value":" to determine a proxy for it.","position":{"start":{"line":429,"column":1},"end":{"line":429,"column":1}},"key":"jMKoVro3jq"}],"key":"V8ZKCDltMq"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"using NLsolve\nr = nlsolve(x -> f(x[1]), [1.0]).zero","key":"SMhIO7sNfQ"},{"type":"output","id":"mbWDFSG5UFp9I3_LN3oLa","data":[],"key":"aq5PCMCMMl"}],"data":{},"key":"Uk5WCKCS3E"},{"type":"paragraph","position":{"start":{"line":436,"column":1},"end":{"line":436,"column":1}},"children":[{"type":"text","value":"We use ","position":{"start":{"line":436,"column":1},"end":{"line":436,"column":1}},"key":"EzvlxOpEnn"},{"type":"inlineMath","value":"x_1=1","position":{"start":{"line":436,"column":1},"end":{"line":436,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">x_1=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"L00n60nhPn"},{"type":"text","value":" as a starting guess and apply the iteration in a loop, storing the sequence of iterates in a vector.","position":{"start":{"line":436,"column":1},"end":{"line":436,"column":1}},"key":"uaC75nT1Mz"}],"key":"eKmBZu6eCW"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"x = [1; zeros(4)]\nfor k = 1:4\n    x[k+1] = x[k] - f(x[k]) / df_dx(x[k])\nend\nx","key":"PxONhE2x6D"},{"type":"output","id":"b7QC9W1ISfN4Bbxb0CvPy","data":[],"key":"FNvV6sPpI0"}],"data":{},"key":"CYqKjRs68F"},{"type":"paragraph","position":{"start":{"line":446,"column":1},"end":{"line":446,"column":1}},"children":[{"type":"text","value":"Here is the sequence of errors.","position":{"start":{"line":446,"column":1},"end":{"line":446,"column":1}},"key":"e8zMFpEh1m"}],"key":"vQ49xFWVjO"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"ϵ = @. x - r","key":"lFWb9chHhV"},{"type":"output","id":"dd5taeNRbAUAAuVFegf5W","data":[],"key":"EqMYoId8Vv"}],"data":{},"key":"UyEaRGD7UM"},{"type":"paragraph","position":{"start":{"line":452,"column":1},"end":{"line":452,"column":1}},"children":[{"type":"text","value":"Because the error reaches machine epsilon so rapidly, we’re going to use extended precision to allow us to take a few more iterations. We’ll take the last iteration as the most accurate root estimate.","position":{"start":{"line":452,"column":1},"end":{"line":452,"column":1}},"key":"pPtwV3B9BE"}],"key":"UJy4FUy0j0"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"rXCffL8wt5"}],"key":"L9yVSC80Ee"},{"type":"paragraph","position":{"start":{"line":455,"column":1},"end":{"line":455,"column":1}},"children":[{"type":"text","value":"A ","position":{"start":{"line":455,"column":1},"end":{"line":455,"column":1}},"key":"CvdzewRTsT"},{"type":"inlineCode","value":"BigFloat","position":{"start":{"line":455,"column":1},"end":{"line":455,"column":1}},"key":"gQGl9TIyJq"},{"type":"text","value":" uses 256 bits of precision, rather than 53 in ","position":{"start":{"line":455,"column":1},"end":{"line":455,"column":1}},"key":"yS6bvpduJV"},{"type":"inlineCode","value":"Float64","position":{"start":{"line":455,"column":1},"end":{"line":455,"column":1}},"key":"dNO3JK6vkb"},{"type":"text","value":". But arithmetic is done by software emulation and is much slower.","position":{"start":{"line":455,"column":1},"end":{"line":455,"column":1}},"key":"pPaQ1dCdvU"}],"key":"sWgIrmYEKw"}],"class":"dropdown","key":"qHZBC6o1Ir"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"x = [BigFloat(1); zeros(7)]\nfor k = 1:7\n    x[k+1] = x[k] - f(x[k]) / df_dx(x[k])\nend\nr = x[end]","key":"PqLHVOAUdC"},{"type":"output","id":"3ndbbaVRmRDJH-JkHHZnp","data":[],"key":"CgFUjmI2p9"}],"data":{},"key":"M9zALvspCd"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"ϵ = @. Float64(x[1:end-1] - r)","key":"YFEo5H8SXB"},{"type":"output","id":"cf65CcHC8P7Pv4t9l7oYx","data":[],"key":"ETzHO9X0Kg"}],"data":{},"key":"GhRHZckOBQ"},{"type":"paragraph","position":{"start":{"line":470,"column":1},"end":{"line":470,"column":1}},"children":[{"type":"text","value":"The exponents in the scientific notation definitely suggest a squaring sequence. We can check the evolution of the ratio in ","position":{"start":{"line":470,"column":1},"end":{"line":470,"column":1}},"key":"jl22G5EG1z"},{"type":"crossReference","kind":"equation","identifier":"quadratictest","label":"quadratictest","children":[{"type":"text","value":"(","key":"CPzI8kpYV6"},{"type":"text","value":"4.3.9","key":"Yhr1YSOkI8"},{"type":"text","value":")","key":"eGg7yteIoI"}],"template":"(%s)","enumerator":"4.3.9","resolved":true,"html_id":"quadratictest","remote":true,"url":"/newton","dataUrl":"/newton.json","key":"k1vnDX7Iv4"},{"type":"text","value":".","position":{"start":{"line":470,"column":1},"end":{"line":470,"column":1}},"key":"IyObYArjed"}],"key":"TC4GReC9ez"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"logerr = @. log10(abs(ϵ))\nratios = [NaN; [logerr[i+1] / logerr[i] for i in 1:length(logerr)-1]]\n@pt :header=[\"iteration\", \"error\", \"log error\", \"ratio\"] [1:7 ϵ logerr ratios]","key":"RcsTrXtkX8"},{"type":"output","id":"7zvJE4Ee1Ayo87tJ5ZjLH","data":[],"key":"v7289UIBhm"}],"data":{},"key":"SBhPFTpSnm"},{"type":"paragraph","position":{"start":{"line":478,"column":1},"end":{"line":478,"column":1}},"children":[{"type":"text","value":"The clear convergence to 2 above constitutes good evidence of quadratic convergence.","position":{"start":{"line":478,"column":1},"end":{"line":478,"column":1}},"key":"Els24tycGW"}],"key":"H2F36Jeut6"}],"label":"demo-newton-converge-julia","identifier":"demo-newton-converge-julia","html_id":"demo-newton-converge-julia","key":"QQVGAWSCz3"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-newton-usage","label":"demo-newton-usage","kind":"proof:example","position":{"start":{"line":482,"column":1},"end":{"line":482,"column":19}},"children":[{"type":"text","value":"Example ","key":"S1havN8kV8"},{"type":"text","value":"4.3.3","key":"FDNnRZK0yg"}],"template":"Example %s","enumerator":"4.3.3","resolved":true,"html_id":"demo-newton-usage","remote":true,"url":"/newton","dataUrl":"/newton.json","key":"qpAzuySdOB"}],"key":"eUvHYBlPXw"},{"type":"paragraph","position":{"start":{"line":487,"column":1},"end":{"line":487,"column":1}},"children":[{"type":"text","value":"Suppose we want to evaluate the inverse of the function ","position":{"start":{"line":487,"column":1},"end":{"line":487,"column":1}},"key":"HwvTLU5NbU"},{"type":"inlineMath","value":"h(x)=e^x-x","position":{"start":{"line":487,"column":1},"end":{"line":487,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>h</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msup><mi>e</mi><mi>x</mi></msup><mo>−</mo><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">h(x)=e^x-x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">h</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7477em;vertical-align:-0.0833em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"F9gMDyVSTx"},{"type":"text","value":". This means solving ","position":{"start":{"line":487,"column":1},"end":{"line":487,"column":1}},"key":"XeN0zOgFUU"},{"type":"inlineMath","value":"y=e^x-x","position":{"start":{"line":487,"column":1},"end":{"line":487,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi><mo>=</mo><msup><mi>e</mi><mi>x</mi></msup><mo>−</mo><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">y=e^x-x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7477em;vertical-align:-0.0833em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"qy5nMTPLcP"},{"type":"text","value":" for ","position":{"start":{"line":487,"column":1},"end":{"line":487,"column":1}},"key":"Bau12tcY8I"},{"type":"inlineMath","value":"x","position":{"start":{"line":487,"column":1},"end":{"line":487,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"sFSg6oVfUZ"},{"type":"text","value":" when ","position":{"start":{"line":487,"column":1},"end":{"line":487,"column":1}},"key":"mUEnef4LyO"},{"type":"inlineMath","value":"y","position":{"start":{"line":487,"column":1},"end":{"line":487,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>","key":"F6WZWTIK8v"},{"type":"text","value":" is given, which has no elementary form. If a value of ","position":{"start":{"line":487,"column":1},"end":{"line":487,"column":1}},"key":"QQfsTtXmlU"},{"type":"inlineMath","value":"y","position":{"start":{"line":487,"column":1},"end":{"line":487,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>","key":"Fs31ANRom4"},{"type":"text","value":" is given numerically, though, we simply have a rootfinding problem for ","position":{"start":{"line":487,"column":1},"end":{"line":487,"column":1}},"key":"Lp3M39OMbp"},{"type":"inlineMath","value":"f(x)=e^x-x-y","position":{"start":{"line":487,"column":1},"end":{"line":487,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msup><mi>e</mi><mi>x</mi></msup><mo>−</mo><mi>x</mi><mo>−</mo><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">f(x)=e^x-x-y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7477em;vertical-align:-0.0833em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>","key":"v4ZHg41Ivt"},{"type":"text","value":".","position":{"start":{"line":487,"column":1},"end":{"line":487,"column":1}},"key":"F3q1YjIDpi"}],"indexEntries":[{"entry":"Julia","subEntry":{"value":"enumerate","kind":"entry"},"emphasis":true}],"label":"index-vzjaozTNZn","identifier":"index-vzjaoztnzn","html_id":"index-vzjaoztnzn","key":"x7tGhXyHBv"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"zSyjUGgzd2"}],"key":"pKqXZyE1I7"},{"type":"paragraph","position":{"start":{"line":490,"column":1},"end":{"line":490,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":490,"column":1},"end":{"line":490,"column":1}},"key":"y0obcwcPz1"},{"type":"inlineCode","value":"enumerate","position":{"start":{"line":490,"column":1},"end":{"line":490,"column":1}},"key":"SUFx4TxQYm"},{"type":"text","value":" function produces a pair of values for each iteration: a positional index and the corresponding contents.","position":{"start":{"line":490,"column":1},"end":{"line":490,"column":1}},"key":"BNb2BxB6dD"}],"key":"Gl7mCj3v0W"}],"class":"dropdown","key":"aLIMQrJubD"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"g(x) = exp(x) - x\ndg_dx(x) = exp(x) - 1\ny = range(g(0), g(2), 200)\nx = zeros(length(y))\nfor (i, y) in enumerate(y)\n    f(x) = g(x) - y\n    df_dx(x) = dg_dx(x)\n    r = FNC.newton(f, df_dx, y)\n    x[i] = r[end]\nend\n\nplot(g, 0, 2, aspect_ratio=1, label=L\"g(x)\")\nplot!(y, x, label=L\"g^{-1}(y)\", title=\"Function and its inverse\")\nplot!(x -> x, 0, maximum(y), label=\"\", l=(:dash, 1), color=:black)","key":"XEyClgFTJB"},{"type":"output","id":"fuXkWictTjzw6GAgGaaoT","data":[],"key":"rkbTd1t5D6"}],"data":{},"key":"WpxL3TrHw7"}],"label":"demo-newton-usage-julia","identifier":"demo-newton-usage-julia","html_id":"demo-newton-usage-julia","key":"ncP1OKJjVI"},{"type":"heading","depth":3,"position":{"start":{"line":511,"column":1},"end":{"line":511,"column":1}},"children":[{"type":"text","value":"4.4 ","position":{"start":{"line":511,"column":1},"end":{"line":511,"column":1}},"key":"a66ytMXWmO"},{"type":"link","identifier":"section-nonlineqn-secant","label":"section-nonlineqn-secant","kind":"narrative","position":{"start":{"line":511,"column":5},"end":{"line":511,"column":30}},"url":"/secant","internal":true,"dataUrl":"/secant.json","children":[{"type":"text","value":"Interpolation-based methods","key":"PMJervgoPs"}],"key":"b55VHy90gw"}],"identifier":"id-4-4","label":"4.4 ","html_id":"id-4-4","implicit":true,"key":"XdSyHZwJst"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-secant-line","label":"demo-secant-line","kind":"proof:example","position":{"start":{"line":513,"column":1},"end":{"line":513,"column":18}},"children":[{"type":"text","value":"Example ","key":"M1HGYw67kd"},{"type":"text","value":"4.4.1","key":"ionQH7q2Qq"}],"template":"Example %s","enumerator":"4.4.1","resolved":true,"html_id":"demo-secant-line","remote":true,"url":"/secant","dataUrl":"/secant.json","key":"Lz2qb9KqL7"}],"key":"eS5QbAYHzX"},{"type":"paragraph","position":{"start":{"line":517,"column":1},"end":{"line":517,"column":1}},"children":[{"type":"text","value":"We return to finding a root of the equation ","position":{"start":{"line":517,"column":1},"end":{"line":517,"column":1}},"key":"Bc5RF6J00P"},{"type":"inlineMath","value":"x e^x=2","position":{"start":{"line":517,"column":1},"end":{"line":517,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><msup><mi>e</mi><mi>x</mi></msup><mo>=</mo><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">x e^x=2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6644em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span></span></span></span>","key":"x8aBptsjqj"},{"type":"text","value":".","position":{"start":{"line":517,"column":1},"end":{"line":517,"column":1}},"key":"TRxXABDG9t"}],"key":"d33tiKOIC5"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"using Plots\nf(x) = x * exp(x) - 2;\nplot(f, 0.25, 1.25;\n    label=\"function\",  legend=:topleft,\n    xlabel=L\"x\",  ylabel=L\"y\")","key":"NbnmYnEFxL"},{"type":"output","id":"qa3oZQSBjJ1qCMilzkGuC","data":[],"key":"PMhnXuZZ5n"}],"data":{},"key":"busbbvMn3M"},{"type":"paragraph","position":{"start":{"line":527,"column":1},"end":{"line":527,"column":1}},"children":[{"type":"text","value":"From the graph, it’s clear that there is a root near ","position":{"start":{"line":527,"column":1},"end":{"line":527,"column":1}},"key":"s08H9tFu3E"},{"type":"inlineMath","value":"x=1","position":{"start":{"line":527,"column":1},"end":{"line":527,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">x=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"xhex3D04EX"},{"type":"text","value":". To be more precise, there is a root in the interval ","position":{"start":{"line":527,"column":1},"end":{"line":527,"column":1}},"key":"AD7VyBQylF"},{"type":"inlineMath","value":"[0.5,1]","position":{"start":{"line":527,"column":1},"end":{"line":527,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mn>0.5</mn><mo separator=\"true\">,</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[0.5,1]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">0.5</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]</span></span></span></span>","key":"pg4qQ5uKzw"},{"type":"text","value":". So let us take the endpoints of that interval as ","position":{"start":{"line":527,"column":1},"end":{"line":527,"column":1}},"key":"eh8OUc2qM0"},{"type":"emphasis","position":{"start":{"line":527,"column":1},"end":{"line":527,"column":1}},"children":[{"type":"text","value":"two","position":{"start":{"line":527,"column":1},"end":{"line":527,"column":1}},"key":"DP3fYz8d24"}],"key":"OtveCcMuXo"},{"type":"text","value":" initial approximations.","position":{"start":{"line":527,"column":1},"end":{"line":527,"column":1}},"key":"a2vxg9ygk5"}],"key":"cT4dSzVJfu"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"x₁ = 1;\ny₁ = f(x₁);\nx₂ = 0.5;\ny₂ = f(x₂);\nscatter!([x₁, x₂], [y₁, y₂];\n    label=\"initial points\",\n    title=\"Two initial values\")","key":"hEvDDYTHRa"},{"type":"output","id":"GsREuxls73houG2lGaouR","data":[],"key":"p5l6BPnJaY"}],"data":{},"key":"catOExAzrD"},{"type":"paragraph","position":{"start":{"line":539,"column":1},"end":{"line":539,"column":1}},"children":[{"type":"text","value":"Instead of constructing the tangent line by evaluating the derivative, we can construct a linear model function by drawing the line between the two points ","position":{"start":{"line":539,"column":1},"end":{"line":539,"column":1}},"key":"dwaUGCsPF1"},{"type":"inlineMath","value":"\\bigl(x_1,f(x_1)\\bigr)","position":{"start":{"line":539,"column":1},"end":{"line":539,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo fence=\"true\" stretchy=\"true\" minsize=\"1.2em\" maxsize=\"1.2em\">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><mi>f</mi><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy=\"false\">)</mo><mo fence=\"true\" stretchy=\"true\" minsize=\"1.2em\" maxsize=\"1.2em\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\bigl(x_1,f(x_1)\\bigr)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.2em;vertical-align:-0.35em;\"></span><span class=\"mopen\"><span class=\"delimsizing size1\">(</span></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mclose\"><span class=\"delimsizing size1\">)</span></span></span></span></span>","key":"TeyeQpXJp8"},{"type":"text","value":" and ","position":{"start":{"line":539,"column":1},"end":{"line":539,"column":1}},"key":"UFkyxo7oZC"},{"type":"inlineMath","value":"\\bigl(x_2,f(x_2)\\bigr)","position":{"start":{"line":539,"column":1},"end":{"line":539,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo fence=\"true\" stretchy=\"true\" minsize=\"1.2em\" maxsize=\"1.2em\">(</mo><msub><mi>x</mi><mn>2</mn></msub><mo separator=\"true\">,</mo><mi>f</mi><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mn>2</mn></msub><mo stretchy=\"false\">)</mo><mo fence=\"true\" stretchy=\"true\" minsize=\"1.2em\" maxsize=\"1.2em\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\bigl(x_2,f(x_2)\\bigr)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.2em;vertical-align:-0.35em;\"></span><span class=\"mopen\"><span class=\"delimsizing size1\">(</span></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mclose\"><span class=\"delimsizing size1\">)</span></span></span></span></span>","key":"bFXdzE6ugN"},{"type":"text","value":". This is called a ","position":{"start":{"line":539,"column":1},"end":{"line":539,"column":1}},"key":"es8pQmA2W7"},{"type":"emphasis","position":{"start":{"line":539,"column":1},"end":{"line":539,"column":1}},"children":[{"type":"text","value":"secant line","position":{"start":{"line":539,"column":1},"end":{"line":539,"column":1}},"key":"j94IwvHZ5G"}],"key":"rQZITHTdIn"},{"type":"text","value":".","position":{"start":{"line":539,"column":1},"end":{"line":539,"column":1}},"key":"QePIaclf7b"}],"key":"mziVmPFkEJ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"m₂ = (y₂ - y₁) / (x₂ - x₁)\nsecant = x -> y₂ + m₂ * (x - x₂)\nplot!(secant, 0.25, 1.25, label=\"secant line\", l=:dash, color=:black,\n    title=\"Secant line\")","key":"U87SRUdY2M"},{"type":"output","id":"P0uOT1y3ZCsK5_HJfplHc","data":[],"key":"Oj44egIAQv"}],"data":{},"key":"KTwwatY3wY"},{"type":"paragraph","position":{"start":{"line":548,"column":1},"end":{"line":548,"column":1}},"children":[{"type":"text","value":"As before, the next root estimate in the iteration is the root of this linear model.","position":{"start":{"line":548,"column":1},"end":{"line":548,"column":1}},"key":"zqiY81agZO"}],"key":"rDfzQ0a6Gx"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"x₃ = x₂ - y₂ / m₂\n@show y₃ = f(x₃)\nscatter!([x₃], [0], label=\"root of secant\", title=\"First iteration\")","key":"ytcvNXqGH1"},{"type":"output","id":"brWpscA3sitL-wNjSmfmk","data":[],"key":"mns5RxCMsR"}],"data":{},"key":"okorL8DEFY"},{"type":"paragraph","position":{"start":{"line":556,"column":1},"end":{"line":556,"column":1}},"children":[{"type":"text","value":"For the next linear model, we use the line through the two most recent points. The next iterate is the root of that secant line, and so on.","position":{"start":{"line":556,"column":1},"end":{"line":556,"column":1}},"key":"fwgSOYSYcQ"}],"key":"DIhhg8cQih"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"m₃ = (y₃ - y₂) / (x₃ - x₂)\nx₄ = x₃ - y₃ / m₃","key":"NPKeULPSF8"},{"type":"output","id":"q_ZleCp1E7mbv0kfb60YN","data":[],"key":"IbvunXXusO"}],"data":{},"key":"FpgdFNu6en"}],"label":"demo-secant-line-julia","identifier":"demo-secant-line-julia","html_id":"demo-secant-line-julia","key":"UuY6m1Glwg"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-secant-converge","label":"demo-secant-converge","kind":"proof:example","position":{"start":{"line":565,"column":1},"end":{"line":565,"column":22}},"children":[{"type":"text","value":"Example ","key":"eutyC81Rn4"},{"type":"text","value":"4.4.2","key":"yE4ckJPQrd"}],"template":"Example %s","enumerator":"4.4.2","resolved":true,"html_id":"demo-secant-converge","remote":true,"url":"/secant","dataUrl":"/secant.json","key":"TSAGxSF3GF"}],"key":"gq8DjvP64y"},{"type":"paragraph","position":{"start":{"line":567,"column":1},"end":{"line":567,"column":1}},"children":[{"type":"text","value":"We check the convergence of the secant method from ","position":{"start":{"line":567,"column":1},"end":{"line":567,"column":1}},"key":"KzHnnlYMWy"},{"type":"crossReference","kind":"proof:example","identifier":"demo-secant-line","label":"demo-secant-line","children":[{"type":"text","value":"Demo ","key":"TsKfRtCyxH"},{"type":"text","value":"4.4.1","key":"W0ZjGYAwzK"}],"template":"Example %s","enumerator":"4.4.1","resolved":true,"html_id":"demo-secant-line","remote":true,"url":"/secant","dataUrl":"/secant.json","key":"a4iHXd43bm"},{"type":"text","value":". Again we will use extended precision to get a longer sequence than double precision allows.","position":{"start":{"line":567,"column":1},"end":{"line":567,"column":1}},"key":"GKmJiVqK7J"}],"key":"TTycmUPjg0"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"f(x) = x * exp(x) - 2\nx = FNC.secant(f, BigFloat(1), BigFloat(0.5), xtol=1e-80, ftol=1e-80);","key":"AbT1Yu3bMR"},{"type":"output","id":"IAn3Lm3Twl4hdIe-pKXnQ","data":[],"key":"s4DRoZLwPO"}],"data":{},"key":"QEERdNK8fd"},{"type":"paragraph","position":{"start":{"line":574,"column":1},"end":{"line":574,"column":1}},"children":[{"type":"text","value":"We don’t know the exact root, so we use the last value as a proxy.","position":{"start":{"line":574,"column":1},"end":{"line":574,"column":1}},"key":"aWjdSEPU7k"}],"key":"eFSwFCsM5A"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"r = x[end]","key":"lxESUtztLy"},{"type":"output","id":"M6gW5VTkhRh71R4mZLfZU","data":[],"key":"LFAUT9YZfK"}],"data":{},"key":"AoQsK7LdDr"},{"type":"paragraph","position":{"start":{"line":580,"column":1},"end":{"line":580,"column":1}},"children":[{"type":"text","value":"Here is the sequence of errors.","position":{"start":{"line":580,"column":1},"end":{"line":580,"column":1}},"key":"sl5YwYw7K5"}],"key":"GORUNkpOh0"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"ϵ = @. Float64(r - x[1:end-2])","key":"EDiRarvOEy"},{"type":"output","id":"m1PQQ1uJetGaNw7i3tSUc","data":[],"key":"DECbHDhRBo"}],"data":{},"key":"FxDidUAVBL"},{"type":"paragraph","position":{"start":{"line":586,"column":1},"end":{"line":586,"column":1}},"children":[{"type":"text","value":"It’s not easy to see the convergence rate by staring at these numbers. We can use ","position":{"start":{"line":586,"column":1},"end":{"line":586,"column":1}},"key":"Y4QY9euBga"},{"type":"crossReference","kind":"equation","identifier":"superlinear-rate","label":"superlinear-rate","children":[{"type":"text","value":"(","key":"dLpLP2wFwG"},{"type":"text","value":"4.4.8","key":"ir3mTo3eWJ"},{"type":"text","value":")","key":"FJk8df7W75"}],"template":"(%s)","enumerator":"4.4.8","resolved":true,"html_id":"superlinear-rate","remote":true,"url":"/secant","dataUrl":"/secant.json","key":"tmGYm7VeRC"},{"type":"text","value":" to try to expose the superlinear convergence rate.","position":{"start":{"line":586,"column":1},"end":{"line":586,"column":1}},"key":"KbVbEbTM2A"}],"key":"LwPqbVzP7v"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"logerr = @. log10(abs(ϵ))\nratios = [NaN; [logerr[i+1] / logerr[i] for i in 1:length(logerr)-1]]\n@pt :header=[\"iteration\", \"error\", \"log error\", \"ratio\"] [eachindex(ϵ) ϵ logerr ratios]","key":"tcphxEHpbT"},{"type":"output","id":"dvOUuLtKhuwhc_pk77eNX","data":[],"key":"qylbbU6eo4"}],"data":{},"key":"NBB4a2bPOn"},{"type":"paragraph","position":{"start":{"line":594,"column":1},"end":{"line":594,"column":1}},"children":[{"type":"text","value":"As expected, this settles in at around 1.618.","position":{"start":{"line":594,"column":1},"end":{"line":594,"column":1}},"key":"Y1KDT5cV8B"}],"key":"NSxzUWXgix"}],"label":"demo-secant-converge-julia","identifier":"demo-secant-converge-julia","html_id":"demo-secant-converge-julia","key":"OtcXz5HHH3"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-secant-iqi","label":"demo-secant-iqi","kind":"proof:example","position":{"start":{"line":598,"column":1},"end":{"line":598,"column":17}},"children":[{"type":"text","value":"Example ","key":"VzBywvVhBR"},{"type":"text","value":"4.4.3","key":"ZZ1VojDQF5"}],"template":"Example %s","enumerator":"4.4.3","resolved":true,"html_id":"demo-secant-iqi","remote":true,"url":"/secant","dataUrl":"/secant.json","key":"cZJgx0U2uH"}],"key":"KABgxlbezb"},{"type":"paragraph","position":{"start":{"line":600,"column":1},"end":{"line":600,"column":1}},"children":[{"type":"text","value":"Here we look for a root of ","position":{"start":{"line":600,"column":1},"end":{"line":600,"column":1}},"key":"Okfbv67M5P"},{"type":"inlineMath","value":"x+\\cos(10x)","position":{"start":{"line":600,"column":1},"end":{"line":600,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mo>+</mo><mi>cos</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mn>10</mn><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">x+\\cos(10x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop\">cos</span><span class=\"mopen\">(</span><span class=\"mord\">10</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span>","key":"iKTQTQLX7m"},{"type":"text","value":" that is close to 1.","position":{"start":{"line":600,"column":1},"end":{"line":600,"column":1}},"key":"shHsggi4Jb"}],"key":"s3NVeUxNk2"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"f(x) = x + cos(10 * x)\ninterval = [0.5, 1.5]\n\nplot(f, interval..., label=\"Function\", legend=:bottomright,\n    grid=:y, ylim=[-0.1, 3], xlabel=L\"x\", ylabel=L\"y\")","key":"uS8RAulN4b"},{"type":"output","id":"1HV3886nS06dplQcvNtxw","data":[],"key":"kNYnoZIcOJ"}],"data":{},"key":"CnPMt0lNAl"},{"type":"paragraph","position":{"start":{"line":610,"column":1},"end":{"line":610,"column":1}},"children":[{"type":"text","value":"We choose three values to get the iteration started.","position":{"start":{"line":610,"column":1},"end":{"line":610,"column":1}},"key":"oa1bCjuU3l"}],"key":"DrVv7XnMSM"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"x = [0.8, 1.2, 1]\ny = @. f(x)\nscatter!(x, y, label=\"initial points\")","key":"UQkeHUAYQD"},{"type":"output","id":"iIzyuRc9kLdc4vF_24z-O","data":[],"key":"vAWCUjIM4x"}],"data":{},"key":"Qtf8gke9jx"},{"type":"paragraph","position":{"start":{"line":618,"column":1},"end":{"line":618,"column":1}},"children":[{"type":"text","value":"If we were using forward interpolation, we would ask for the polynomial interpolant of ","position":{"start":{"line":618,"column":1},"end":{"line":618,"column":1}},"key":"exmPY97vXk"},{"type":"inlineMath","value":"y","position":{"start":{"line":618,"column":1},"end":{"line":618,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>","key":"eAehBArk9l"},{"type":"text","value":" as a function of ","position":{"start":{"line":618,"column":1},"end":{"line":618,"column":1}},"key":"JXhXirauWm"},{"type":"inlineMath","value":"x","position":{"start":{"line":618,"column":1},"end":{"line":618,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"uwmTm70T6v"},{"type":"text","value":". But that parabola has no real roots.","position":{"start":{"line":618,"column":1},"end":{"line":618,"column":1}},"key":"U5Y8hsBb2c"}],"key":"A7VvM0eiWE"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"using Polynomials\nq = Polynomials.fit(x, y, 2)      # interpolating polynomial\nplot!(x -> q(x), interval..., l=:dash, label=\"interpolant\")","key":"ofkUE46VJD"},{"type":"output","id":"qT-OPb-k5Ty12x33lbm-3","data":[],"key":"O9xS51Nz9a"}],"data":{},"key":"CptB1pmVM1"},{"type":"paragraph","position":{"start":{"line":626,"column":1},"end":{"line":626,"column":1}},"children":[{"type":"text","value":"To do inverse interpolation, we swap the roles of ","position":{"start":{"line":626,"column":1},"end":{"line":626,"column":1}},"key":"l2tc3TK5SM"},{"type":"inlineMath","value":"x","position":{"start":{"line":626,"column":1},"end":{"line":626,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"Vo0pHMOkv1"},{"type":"text","value":" and ","position":{"start":{"line":626,"column":1},"end":{"line":626,"column":1}},"key":"t0uAJg5l6b"},{"type":"inlineMath","value":"y","position":{"start":{"line":626,"column":1},"end":{"line":626,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>","key":"STscBKk547"},{"type":"text","value":" in the interpolation.","position":{"start":{"line":626,"column":1},"end":{"line":626,"column":1}},"key":"SHJOimAfXB"}],"key":"znt1B6rfri"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"fTHZRH9ycm"}],"key":"ImeFRB0TIG"},{"type":"paragraph","position":{"start":{"line":630,"column":1},"end":{"line":630,"column":1}},"children":[{"type":"text","value":"By giving two functions in the plot call, we get the parametric plot ","position":{"start":{"line":630,"column":1},"end":{"line":630,"column":1}},"key":"NwgHClpmzL"},{"type":"inlineMath","value":"(q(y),y)","position":{"start":{"line":630,"column":1},"end":{"line":630,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>q</mi><mo stretchy=\"false\">(</mo><mi>y</mi><mo stretchy=\"false\">)</mo><mo separator=\"true\">,</mo><mi>y</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(q(y),y)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span></span></span></span>","key":"xyolAvtYZ7"},{"type":"text","value":" as a function of ","position":{"start":{"line":630,"column":1},"end":{"line":630,"column":1}},"key":"gaRX5QRqqU"},{"type":"inlineMath","value":"y","position":{"start":{"line":630,"column":1},"end":{"line":630,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>","key":"oSrYjzTjje"},{"type":"text","value":".","position":{"start":{"line":630,"column":1},"end":{"line":630,"column":1}},"key":"gyODzCJ4wR"}],"key":"bquph09oa4"}],"class":"dropdown","key":"e0rmxQYTKO"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"plot(f, interval..., label=\"Function\",\n    legend=:bottomright, grid=:y, xlabel=L\"x\", ylabel=L\"y\")\nscatter!(x, y, label=\"initial points\")\n\nq = Polynomials.fit(y, x, 2)       # interpolating polynomial\nplot!(y -> q(y), y -> y, -0.1, 2.6, l=:dash, label=\"inverse interpolant\")","key":"TmnMR7u2Pp"},{"type":"output","id":"z6TxCLJu6r8RgU62NO-tO","data":[],"key":"nMEiAPdzyM"}],"data":{},"key":"ciMfF1LAV2"},{"type":"paragraph","position":{"start":{"line":642,"column":1},"end":{"line":642,"column":1}},"children":[{"type":"text","value":"We seek the value of ","position":{"start":{"line":642,"column":1},"end":{"line":642,"column":1}},"key":"f3LJbIFN1M"},{"type":"inlineMath","value":"x","position":{"start":{"line":642,"column":1},"end":{"line":642,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"ejPQ43etS2"},{"type":"text","value":" that makes ","position":{"start":{"line":642,"column":1},"end":{"line":642,"column":1}},"key":"OSYU3jwoc0"},{"type":"inlineMath","value":"y","position":{"start":{"line":642,"column":1},"end":{"line":642,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>","key":"mnuTcsEo8q"},{"type":"text","value":" zero. This means evaluating ","position":{"start":{"line":642,"column":1},"end":{"line":642,"column":1}},"key":"lqoG8TfDTQ"},{"type":"inlineMath","value":"q","position":{"start":{"line":642,"column":1},"end":{"line":642,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>q</mi></mrow><annotation encoding=\"application/x-tex\">q</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span></span></span></span>","key":"cIBmfXJfin"},{"type":"text","value":" at zero.","position":{"start":{"line":642,"column":1},"end":{"line":642,"column":1}},"key":"U8DOs7CCUY"}],"key":"lwCa4Rvt7P"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"q(0)","key":"rYzhQhvMbX"},{"type":"output","id":"JZipLJyUpFpehOBfxe-7J","data":[],"key":"zGZ8793kCY"}],"data":{},"key":"Ca4P0mfbxh"},{"type":"paragraph","position":{"start":{"line":648,"column":1},"end":{"line":648,"column":1}},"children":[{"type":"text","value":"Let’s restart the process with ","position":{"start":{"line":648,"column":1},"end":{"line":648,"column":1}},"key":"PsgLpklSOw"},{"type":"inlineCode","value":"BigFloat","position":{"start":{"line":648,"column":1},"end":{"line":648,"column":1}},"key":"J1YmpyJAqP"},{"type":"text","value":" numbers to get a convergent sequence.","position":{"start":{"line":648,"column":1},"end":{"line":648,"column":1}},"key":"F2aNNKnfim"}],"key":"ZbftMVZEYI"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"x = BigFloat.([8, 12, 10]) / 10\ny = @. f(x)\n\nfor k = 3:12\n    q = Polynomials.fit(y[k-2:k], x[k-2:k], 2)\n    push!(x, q(0))\n    push!(y, f(x[k+1]))\nend\n\nprintln(\"residual = $(f(x[end]))\")","key":"BKF17RVg2g"},{"type":"output","id":"PHyQniVpZOqnpTPt6EUVp","data":[],"key":"C574J6YGQU"}],"data":{},"key":"ms4TsTpIFp"},{"type":"paragraph","position":{"start":{"line":663,"column":1},"end":{"line":663,"column":1}},"children":[{"type":"text","value":"As far as our current precision is concerned, we have an exact root.","position":{"start":{"line":663,"column":1},"end":{"line":663,"column":1}},"key":"ANxiQl5LzP"}],"key":"KtOJiK12kG"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"r = x[end]\nϵ = @. Float64(abs(r - x[1:end-1]))\nlogerr = @. log10(abs(ϵ))\nratios = [NaN; [logerr[i+1] / logerr[i] for i in 1:length(logerr)-1]]\n@pt :header=[\"iteration\", \"error\", \"log error\", \"ratio\"] [eachindex(ϵ) ϵ logerr ratios]","key":"SbjHyMx7hk"},{"type":"output","id":"Qp_aKqppdkgu5kHfSXQ3j","data":[],"key":"D2qhHqX31O"}],"data":{},"key":"KmvEyWM4JN"},{"type":"paragraph","position":{"start":{"line":673,"column":1},"end":{"line":673,"column":1}},"children":[{"type":"text","value":"The convergence is probably superlinear at a rate of ","position":{"start":{"line":673,"column":1},"end":{"line":673,"column":1}},"key":"umjLBEsFSN"},{"type":"inlineMath","value":"\\alpha=1.8","position":{"start":{"line":673,"column":1},"end":{"line":673,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>α</mi><mo>=</mo><mn>1.8</mn></mrow><annotation encoding=\"application/x-tex\">\\alpha=1.8</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1.8</span></span></span></span>","key":"Sj7s5hrr9z"},{"type":"text","value":" or so.","position":{"start":{"line":673,"column":1},"end":{"line":673,"column":1}},"key":"XM1vCCH31p"}],"key":"YoWHztox7Q"}],"label":"demo-secant-iqi-julia","identifier":"demo-secant-iqi-julia","html_id":"demo-secant-iqi-julia","key":"PkKIpVvmXE"},{"type":"heading","depth":3,"position":{"start":{"line":676,"column":1},"end":{"line":676,"column":1}},"children":[{"type":"text","value":"4.5 ","position":{"start":{"line":676,"column":1},"end":{"line":676,"column":1}},"key":"O6dnek4xYD"},{"type":"link","identifier":"section-nonlineqn-newtonsys","label":"section-nonlineqn-newtonsys","kind":"narrative","position":{"start":{"line":676,"column":5},"end":{"line":676,"column":33}},"url":"/newtonsys","internal":true,"dataUrl":"/newtonsys.json","children":[{"type":"text","value":"Newton for nonlinear systems","key":"WJZ4zi4PVI"}],"key":"znskrOFemD"}],"identifier":"id-4-5","label":"4.5 ","html_id":"id-4-5","implicit":true,"key":"sWh5jZcvwG"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-newtonsys-converge","label":"demo-newtonsys-converge","kind":"proof:example","position":{"start":{"line":679,"column":1},"end":{"line":679,"column":25}},"children":[{"type":"text","value":"Example ","key":"R58WwwGEuM"},{"type":"text","value":"4.5.3","key":"H4e1IUSbCb"}],"template":"Example %s","enumerator":"4.5.3","resolved":true,"html_id":"demo-newtonsys-converge","remote":true,"url":"/newtonsys","dataUrl":"/newtonsys.json","key":"yZeXGNMIhw"}],"key":"kCx70kpzyb"},{"type":"paragraph","position":{"start":{"line":681,"column":1},"end":{"line":681,"column":1}},"children":[{"type":"text","value":"A system of nonlinear equations is defined by its residual and Jacobian.","position":{"start":{"line":681,"column":1},"end":{"line":681,"column":1}},"key":"CcSeqxyHEo"}],"key":"hksjxQe7gF"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"n5GsV2vjF6"}],"key":"tL2FGn0vOf"},{"type":"paragraph","position":{"start":{"line":684,"column":1},"end":{"line":684,"column":1}},"children":[{"type":"text","value":"Be careful when coding a Jacobian all in one statement. Spaces separate columns, so ","position":{"start":{"line":684,"column":1},"end":{"line":684,"column":1}},"key":"aeZY7gThyy"},{"type":"inlineCode","value":"x[3]-1","position":{"start":{"line":684,"column":1},"end":{"line":684,"column":1}},"key":"Yx6eQ0Ifl4"},{"type":"text","value":" is not the same as ","position":{"start":{"line":684,"column":1},"end":{"line":684,"column":1}},"key":"N598IHQFoJ"},{"type":"inlineCode","value":"x[3] - 1","position":{"start":{"line":684,"column":1},"end":{"line":684,"column":1}},"key":"Qf8iiJ6Pil"},{"type":"text","value":".","position":{"start":{"line":684,"column":1},"end":{"line":684,"column":1}},"key":"Qp5tYTYjth"}],"key":"dg44Ypj84l"}],"class":"dropdown","key":"CmpdOA4KqA"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"function func(x)\n    [exp(x[2] - x[1]) - 2,\n        x[1] * x[2] + x[3],\n        x[2] * x[3] + x[1]^2 - x[2]\n    ]\nend;\n\nfunction jac(x)\n    [\n        -exp(x[2] - x[1]) exp(x[2] - x[1]) 0\n        x[2] x[1] 1\n        2*x[1] x[3]-1 x[2]\n    ]\nend;","key":"Nm3ZEX0pg1"},{"type":"output","id":"f9LbHvhNF4teR67jH0oel","data":[],"key":"QoYWtuL2S8"}],"data":{},"key":"n5FW3JN8sa"},{"type":"paragraph","position":{"start":{"line":704,"column":1},"end":{"line":704,"column":1}},"children":[{"type":"text","value":"We will use a ","position":{"start":{"line":704,"column":1},"end":{"line":704,"column":1}},"key":"a7EmcY9UaU"},{"type":"inlineCode","value":"BigFloat","position":{"start":{"line":704,"column":1},"end":{"line":704,"column":1}},"key":"v9etGLo2Fe"},{"type":"text","value":" starting value, and commensurately small stopping tolerances, in order to get a sequence long enough to measure convergence.","position":{"start":{"line":704,"column":1},"end":{"line":704,"column":1}},"key":"aYYHiItWRO"}],"key":"xhm7rxKZi7"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"x₁ = BigFloat.([0, 0, 0])\nϵ = eps(BigFloat)\nx = FNC.newtonsys(func, jac, x₁, xtol=ϵ, ftol=ϵ);","key":"P3l7lmtoTU"},{"type":"output","id":"9HY1CUMbRxgpwPAudJS05","data":[],"key":"wHzO0MaCiy"}],"data":{},"key":"Ly15GFokzR"},{"type":"paragraph","position":{"start":{"line":712,"column":1},"end":{"line":712,"column":1}},"children":[{"type":"text","value":"Let’s compute the residual of the last result in order to check the quality.","position":{"start":{"line":712,"column":1},"end":{"line":712,"column":1}},"key":"KMVyonYgpj"}],"key":"AiXtMy1dzV"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"r = x[end]\n@show residual = norm(func(r));","key":"e6hf8BESRB"},{"type":"output","id":"cSay5mdlkIbZKn7NAyUKs","data":[],"key":"oSOQ0EqbLG"}],"data":{},"key":"Ojt9teUbgC"},{"type":"paragraph","position":{"start":{"line":719,"column":1},"end":{"line":719,"column":1}},"children":[{"type":"text","value":"We take the sequence of norms of errors, applying the log so that we can look at the exponents.","position":{"start":{"line":719,"column":1},"end":{"line":719,"column":1}},"key":"t1yZim3Pxu"}],"key":"vmoouyAl0L"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"logerr = [Float64(log(norm(r - x[k]))) for k in 1:length(x)-1]\nratios = [NaN; [logerr[i+1] / logerr[i] for i in 1:length(logerr)-1]]\n@pt :header=[\"iteration\", \"log error\", \"ratio\"] [eachindex(logerr) logerr ratios]","key":"s2eiAKht39"},{"type":"output","id":"jy2Rubjz_We1RvlM55JXY","data":[],"key":"k32cVxJy0P"}],"data":{},"key":"RnNCqIsAIj"},{"type":"paragraph","position":{"start":{"line":727,"column":1},"end":{"line":727,"column":1}},"children":[{"type":"text","value":"The ratio is neatly converging toward 2, which is expected for quadratic convergence.","position":{"start":{"line":727,"column":1},"end":{"line":727,"column":1}},"key":"JW9KrkTmmp"}],"key":"LQlu1SfbdM"}],"label":"demo-newtonsys-converge-julia","identifier":"demo-newtonsys-converge-julia","html_id":"demo-newtonsys-converge-julia","key":"fDb9NvyBFk"},{"type":"heading","depth":3,"position":{"start":{"line":730,"column":1},"end":{"line":730,"column":1}},"children":[{"type":"text","value":"4.6 ","position":{"start":{"line":730,"column":1},"end":{"line":730,"column":1}},"key":"wuZiovAZMS"},{"type":"link","identifier":"section-nonlineqn-quasinewton","label":"section-nonlineqn-quasinewton","kind":"narrative","position":{"start":{"line":730,"column":5},"end":{"line":730,"column":35}},"url":"/quasinewton","internal":true,"dataUrl":"/quasinewton.json","children":[{"type":"text","value":"Quasi-Newton methods","key":"dLawOfUpPM"}],"key":"VIh4szybhB"}],"identifier":"id-4-6","label":"4.6 ","html_id":"id-4-6","implicit":true,"key":"ykpqqWHnbW"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-quasi-levenberg","label":"demo-quasi-levenberg","kind":"proof:example","position":{"start":{"line":733,"column":1},"end":{"line":733,"column":22}},"children":[{"type":"text","value":"Example ","key":"AfS9ND6cch"},{"type":"text","value":"4.6.1","key":"FKk2Tpgnk2"}],"template":"Example %s","enumerator":"4.6.1","resolved":true,"html_id":"demo-quasi-levenberg","remote":true,"url":"/quasinewton","dataUrl":"/quasinewton.json","key":"jRwnONhgAL"}],"key":"pOc58mGuwm"},{"type":"paragraph","position":{"start":{"line":735,"column":1},"end":{"line":735,"column":1}},"children":[{"type":"text","value":"To solve a nonlinear system, we need to code only the function defining the system, and not its Jacobian.","position":{"start":{"line":735,"column":1},"end":{"line":735,"column":1}},"key":"Ur2Shkghwp"}],"key":"TAwrZW2HZh"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"f(x) = \n    [\n        exp(x[2] - x[1]) - 2,\n        x[1] * x[2] + x[3],\n        x[2] * x[3] + x[1]^2 - x[2]\n    ]","key":"oYiK2mUtXY"},{"type":"output","id":"vlJcrGuYWK58mZWUuDLeD","data":[],"key":"c2i6fImqfH"}],"data":{},"key":"lpyUsfFRLs"},{"type":"paragraph","position":{"start":{"line":746,"column":1},"end":{"line":746,"column":1}},"children":[{"type":"text","value":"In all other respects usage is the same as for the ","position":{"start":{"line":746,"column":1},"end":{"line":746,"column":1}},"key":"PRCedG4dh2"},{"type":"inlineCode","value":"newtonsys","position":{"start":{"line":746,"column":1},"end":{"line":746,"column":1}},"key":"bYbAPn1tYX"},{"type":"text","value":" function.","position":{"start":{"line":746,"column":1},"end":{"line":746,"column":1}},"key":"iedrK6c4BW"}],"key":"vVNl9X3gKC"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"x₁ = [0.0, 0.0, 0.0]\nx = FNC.levenberg(f, x₁)","key":"M2jndZHKMB"},{"type":"output","id":"2j3GWoJ-xnZlmxiF03mJs","data":[],"key":"D5AByjfPk1"}],"data":{},"key":"rwi7hmA1HI"},{"type":"paragraph","position":{"start":{"line":753,"column":1},"end":{"line":753,"column":1}},"children":[{"type":"text","value":"It’s always a good idea to check the accuracy of the root, by measuring the residual (backward error).","position":{"start":{"line":753,"column":1},"end":{"line":753,"column":1}},"key":"XF4T4spwF2"}],"key":"hQhIvVjZmQ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"r = x[end]\nprintln(\"backward error = $(norm(f(r)))\")","key":"NoNaBu4Pb4"},{"type":"output","id":"kMhtOp4jN1kPNow0oM3KT","data":[],"key":"TuT1fJ9V08"}],"data":{},"key":"iUmV22MGD4"},{"type":"paragraph","position":{"start":{"line":760,"column":1},"end":{"line":760,"column":1}},"children":[{"type":"text","value":"Looking at the convergence in norm, we find a convergence rate between linear and quadratic, like with the secant method.","position":{"start":{"line":760,"column":1},"end":{"line":760,"column":1}},"key":"Yootsz9xUs"}],"key":"MrcHn1FuSB"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"logerr = [log(norm(r - x[k])) for k in 1:length(x)-1]\nratios = [NaN; [logerr[i+1] / logerr[i] for i in 1:length(logerr)-1]]\n@pt :header=[\"iteration\", \"log error\", \"ratio\"] [eachindex(logerr) logerr ratios]","key":"LvJGvOKzqg"},{"type":"output","id":"ujG2Yf6fnhCdk4Yyq8_qG","data":[],"key":"wb40rHq8WK"}],"data":{},"key":"JXlUj6l6HE"}],"label":"demo-quasi-levenberg-julia","identifier":"demo-quasi-levenberg-julia","html_id":"demo-quasi-levenberg-julia","key":"mPb62XAN1v"},{"type":"heading","depth":3,"position":{"start":{"line":769,"column":1},"end":{"line":769,"column":1}},"children":[{"type":"text","value":"4.7 ","position":{"start":{"line":769,"column":1},"end":{"line":769,"column":1}},"key":"Om7US2rkQT"},{"type":"link","identifier":"section-nonlineqn-nlsq","label":"section-nonlineqn-nlsq","kind":"narrative","position":{"start":{"line":769,"column":5},"end":{"line":769,"column":28}},"url":"/nlsq","internal":true,"dataUrl":"/nlsq.json","children":[{"type":"text","value":"Nonlinear least squares","key":"RJn4SsNZJb"}],"key":"Cy4t0XDtxy"}],"identifier":"id-4-7","label":"4.7 ","html_id":"id-4-7","implicit":true,"key":"yph7xnn5rT"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-nlsq-converge","label":"demo-nlsq-converge","kind":"proof:example","position":{"start":{"line":772,"column":1},"end":{"line":772,"column":20}},"children":[{"type":"text","value":"Example ","key":"Hqyt5CPaCV"},{"type":"text","value":"4.7.1","key":"HsMZe8rC4X"}],"template":"Example %s","enumerator":"4.7.1","resolved":true,"html_id":"demo-nlsq-converge","remote":true,"url":"/nlsq","dataUrl":"/nlsq.json","key":"dVcPE8VE8I"}],"key":"yltUWEsK35"},{"type":"paragraph","position":{"start":{"line":774,"column":1},"end":{"line":774,"column":1}},"children":[{"type":"text","value":"We will observe the convergence of ","position":{"start":{"line":774,"column":1},"end":{"line":774,"column":1}},"key":"SZZMggKbey"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-levenberg","label":"function-levenberg","children":[{"type":"text","value":"Function ","key":"qRva55l6P5"},{"type":"text","value":"4.6.3","key":"AmmspG0btu"}],"template":"Algorithm %s","enumerator":"4.6.3","resolved":true,"html_id":"function-levenberg","remote":true,"url":"/quasinewton","dataUrl":"/quasinewton.json","key":"c8vJda64ZE"},{"type":"text","value":" for different levels of the minimum least-squares residual. We start with a function mapping from ","position":{"start":{"line":774,"column":1},"end":{"line":774,"column":1}},"key":"jzKK98hvya"},{"type":"inlineMath","value":"\\real^2","position":{"start":{"line":774,"column":1},"end":{"line":774,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi mathvariant=\"double-struck\">R</mi><mn>2</mn></msup></mrow><annotation encoding=\"application/x-tex\">\\real^2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathbb\">R</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span>","key":"xURziuD6ia"},{"type":"text","value":" into ","position":{"start":{"line":774,"column":1},"end":{"line":774,"column":1}},"key":"JQHoEG4laE"},{"type":"inlineMath","value":"\\real^3","position":{"start":{"line":774,"column":1},"end":{"line":774,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi mathvariant=\"double-struck\">R</mi><mn>3</mn></msup></mrow><annotation encoding=\"application/x-tex\">\\real^3</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathbb\">R</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span></span></span></span></span></span></span></span>","key":"D92TfO81DB"},{"type":"text","value":", and a point that will be near the optimum.","position":{"start":{"line":774,"column":1},"end":{"line":774,"column":1}},"key":"yoL4dOLdh8"}],"key":"IywcLNqHjJ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"g(x) = [sin(x[1] + x[2]), cos(x[1] - x[2]), exp(x[1] - x[2])]\np = [1, 1];","key":"sWJVyrPAcZ"},{"type":"output","id":"5vVDHj-PxTc_iKKueIJ6P","data":[],"key":"rN91UxeB5Y"}],"data":{},"key":"y7baJOVeSC"},{"type":"paragraph","position":{"start":{"line":784,"column":1},"end":{"line":784,"column":1}},"children":[{"type":"text","value":"The function ","position":{"start":{"line":784,"column":1},"end":{"line":784,"column":1}},"key":"KAmix8nYRD"},{"type":"inlineMath","value":"\\mathbf{g}(\\mathbf{x}) - \\mathbf{g}(\\mathbf{p})","position":{"start":{"line":784,"column":1},"end":{"line":784,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">g</mi><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">x</mi><mo stretchy=\"false\">)</mo><mo>−</mo><mi mathvariant=\"bold\">g</mi><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">p</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\mathbf{g}(\\mathbf{x}) - \\mathbf{g}(\\mathbf{p})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">g</span><span class=\"mopen\">(</span><span class=\"mord mathbf\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">g</span><span class=\"mopen\">(</span><span class=\"mord mathbf\">p</span><span class=\"mclose\">)</span></span></span></span>","key":"qFsLEmOA7T"},{"type":"text","value":" obviously has a zero residual at ","position":{"start":{"line":784,"column":1},"end":{"line":784,"column":1}},"key":"sBKR9gefyc"},{"type":"inlineMath","value":"\\mathbf{p}","position":{"start":{"line":784,"column":1},"end":{"line":784,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">p</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{p}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6389em;vertical-align:-0.1944em;\"></span><span class=\"mord mathbf\">p</span></span></span></span>","key":"Go3iY2Z3R4"},{"type":"text","value":". We’ll make different perturbations of that function in order to create nonzero residuals.","position":{"start":{"line":784,"column":1},"end":{"line":784,"column":1}},"key":"S2wpXxRjxO"}],"indexEntries":[{"entry":"Julia","subEntry":{"value":"@sprintf","kind":"entry"},"emphasis":true}],"label":"index-Z6TkuEXYG1","identifier":"index-z6tkuexyg1","html_id":"index-z6tkuexyg1","key":"T7LGWhi4cp"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"LxAnO2PXuq"}],"key":"mDIws2wyTE"},{"type":"paragraph","position":{"start":{"line":787,"column":1},"end":{"line":787,"column":1}},"children":[{"type":"inlineCode","value":"@sprintf","position":{"start":{"line":787,"column":1},"end":{"line":787,"column":1}},"key":"KqhTliB5bU"},{"type":"text","value":" is a way to format numerical values as strings, patterned after the C function ","position":{"start":{"line":787,"column":1},"end":{"line":787,"column":1}},"key":"mXP5sbLjyI"},{"type":"inlineCode","value":"printf","position":{"start":{"line":787,"column":1},"end":{"line":787,"column":1}},"key":"cb1ftUYMJJ"},{"type":"text","value":".","position":{"start":{"line":787,"column":1},"end":{"line":787,"column":1}},"key":"LHGl7wQtOl"}],"key":"jvGFwJfI7j"}],"class":"dropdown","key":"a3Dnub25np"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"using Printf\nplt = plot(xlabel=\"iteration\", yaxis=(:log10, \"error\"),\n    title=\"Convergence of Gauss–Newton\")\nfor R in [1e-3, 1e-2, 1e-1]\n    # Define the perturbed function.\n    f(x) = g(x) - g(p) + R * normalize([-1, 1, -1])\n    x = FNC.levenberg(f, [0, 0])\n    r = x[end]\n    err = [norm(x - r) for x in x[1:end-1]]\n    normres = norm(f(r))\n    plot!(err, label=@sprintf(\"R=%.2g\", normres))\nend\nplt","key":"hiAH3bHTkm"},{"type":"output","id":"5_Nz0ApYkb6epn6qdmn0S","data":[],"key":"ETpEhVQtjL"}],"data":{},"key":"qi1WTJJn1r"},{"type":"paragraph","position":{"start":{"line":806,"column":1},"end":{"line":806,"column":1}},"children":[{"type":"text","value":"In the least perturbed case, where the minimized residual is less than ","position":{"start":{"line":806,"column":1},"end":{"line":806,"column":1}},"key":"DejHYL55UH"},{"type":"span","position":{"start":{"line":806,"column":1},"end":{"line":806,"column":1}},"children":[{"type":"text","value":"10","key":"pQIbyPW0Ow"},{"type":"superscript","children":[{"type":"text","value":"-3","key":"RmASqiweyj"}],"key":"dEJXOxWG43"}],"key":"EyBcdvDO8y"},{"type":"text","value":", the convergence is plausibly quadratic. At the next level up, the convergence starts similarly but suddenly stagnates for a long time. In the most perturbed case, the quadratic phase is nearly gone and the overall shape looks linear.","position":{"start":{"line":806,"column":1},"end":{"line":806,"column":1}},"key":"fl9z5UBwoB"}],"key":"RMPOrq5e7g"}],"label":"demo-nlsq-converge-julia","identifier":"demo-nlsq-converge-julia","html_id":"demo-nlsq-converge-julia","key":"gAGg6idauh"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-nlsq-mm","label":"demo-nlsq-MM","kind":"proof:example","position":{"start":{"line":810,"column":1},"end":{"line":810,"column":14}},"children":[{"type":"text","value":"Example ","key":"D17zpb8p52"},{"type":"text","value":"4.7.2","key":"JBenUPjHYP"}],"template":"Example %s","enumerator":"4.7.2","resolved":true,"html_id":"demo-nlsq-mm","remote":true,"url":"/nlsq","dataUrl":"/nlsq.json","key":"CS6bu58xOJ"}],"key":"Yts3toUpuV"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"m = 25;\ns = range(0.05, 6, length=m)\nŵ = @. 2 * s / (0.5 + s)                      # exactly on the curve\nw = @. ŵ + 0.15 * cos(2 * exp(s / 16) * s);     # smooth noise added","key":"QBAmvlVCt1"},{"type":"output","id":"NCvoO7q5qRPXUa4EztVNx","data":[],"key":"A8UYWy3x8D"}],"data":{},"key":"moQ9hX3SU7"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"scatter(s, w, label=\"noisy data\",\n    xlabel=\"s\", ylabel=\"v\", leg=:bottomright)\nplot!(s, ŵ, l=:dash, color=:black, label=\"perfect data\")","key":"FGhVI4MR1o"},{"type":"output","id":"TN1wr1FUih3UV5A1lkNbj","data":[],"key":"Bt77hdkJ4K"}],"data":{},"key":"RSoUjOlXi5"},{"type":"paragraph","position":{"start":{"line":828,"column":1},"end":{"line":828,"column":1}},"children":[{"type":"text","value":"The idea is to pretend that we know nothing of the origins of this data and use nonlinear least squares to find the parameters in the theoretical model function ","position":{"start":{"line":828,"column":1},"end":{"line":828,"column":1}},"key":"O4jJqXj4Y3"},{"type":"inlineMath","value":"v(s)","position":{"start":{"line":828,"column":1},"end":{"line":828,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>v</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">v(s)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">s</span><span class=\"mclose\">)</span></span></span></span>","key":"Q85cHQx8uW"},{"type":"text","value":". In ","position":{"start":{"line":828,"column":1},"end":{"line":828,"column":1}},"key":"iCufprBXQV"},{"type":"crossReference","kind":"equation","identifier":"nlsq-misfit","label":"nlsq-misfit","children":[{"type":"text","value":"(","key":"CK4WXPER6u"},{"type":"text","value":"4.7.2","key":"oHmivHY4Sm"},{"type":"text","value":")","key":"oZusolou6A"}],"template":"(%s)","enumerator":"4.7.2","resolved":true,"html_id":"nlsq-misfit","remote":true,"url":"/nlsq","dataUrl":"/nlsq.json","key":"YBbk1peAKx"},{"type":"text","value":", the ","position":{"start":{"line":828,"column":1},"end":{"line":828,"column":1}},"key":"COdXimpBj1"},{"type":"inlineMath","value":"s","position":{"start":{"line":828,"column":1},"end":{"line":828,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>s</mi></mrow><annotation encoding=\"application/x-tex\">s</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">s</span></span></span></span>","key":"yG9FJx876u"},{"type":"text","value":" variable plays the role of ","position":{"start":{"line":828,"column":1},"end":{"line":828,"column":1}},"key":"CPT7FVsSeC"},{"type":"inlineMath","value":"t","position":{"start":{"line":828,"column":1},"end":{"line":828,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span></span></span></span>","key":"pb21ukTklr"},{"type":"text","value":", and ","position":{"start":{"line":828,"column":1},"end":{"line":828,"column":1}},"key":"dbbblLj02r"},{"type":"inlineMath","value":"v","position":{"start":{"line":828,"column":1},"end":{"line":828,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>v</mi></mrow><annotation encoding=\"application/x-tex\">v</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span></span></span></span>","key":"Dc4LhEtsG2"},{"type":"text","value":" plays the role of ","position":{"start":{"line":828,"column":1},"end":{"line":828,"column":1}},"key":"fI5AHOZ038"},{"type":"inlineMath","value":"g","position":{"start":{"line":828,"column":1},"end":{"line":828,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>g</mi></mrow><annotation encoding=\"application/x-tex\">g</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span></span></span></span>","key":"TWQZVddWW9"},{"type":"text","value":".","position":{"start":{"line":828,"column":1},"end":{"line":828,"column":1}},"key":"rOsZdBdIps"}],"indexEntries":[{"entry":"Julia","subEntry":{"value":"destructuring","kind":"entry"},"emphasis":true}],"label":"index-c9OcuqK0je","identifier":"index-c9ocuqk0je","html_id":"index-c9ocuqk0je","key":"OCyo7sHdEd"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"QceVsgwtLQ"}],"key":"EXlnwhj4jQ"},{"type":"paragraph","position":{"start":{"line":831,"column":1},"end":{"line":831,"column":1}},"children":[{"type":"text","value":"Putting comma-separated values on the left of an assignment will ","position":{"start":{"line":831,"column":1},"end":{"line":831,"column":1}},"key":"snzVnV3qTU"},{"type":"strong","position":{"start":{"line":831,"column":1},"end":{"line":831,"column":1}},"children":[{"type":"text","value":"destructure","position":{"start":{"line":831,"column":1},"end":{"line":831,"column":1}},"key":"zRhV9ZaYxX"}],"key":"Oit1X6q76T"},{"type":"text","value":" the right-hand side, drawing individual assignments from entries of a vector, for example.","position":{"start":{"line":831,"column":1},"end":{"line":831,"column":1}},"key":"tjk0GSnny8"}],"key":"zcvf4fC7O6"}],"class":"dropdown","key":"gIlcHSWlcA"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"function misfit(x)\n    V, Km = x   # rename components for clarity\n    return @. V * s / (Km + s) - w\nend","key":"CJIXDSVzzZ"},{"type":"output","id":"0udFogij0Zd_ojIXmDY4V","data":[],"key":"Tfj7Uz5c2N"}],"data":{},"key":"HMOdDFqT39"},{"type":"paragraph","position":{"start":{"line":841,"column":1},"end":{"line":841,"column":1}},"children":[{"type":"text","value":"In the Jacobian the derivatives are with respect to the parameters in ","position":{"start":{"line":841,"column":1},"end":{"line":841,"column":1}},"key":"ZQdhaoyGsd"},{"type":"inlineMath","value":"\\mathbf{x}","position":{"start":{"line":841,"column":1},"end":{"line":841,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">x</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{x}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4444em;\"></span><span class=\"mord mathbf\">x</span></span></span></span>","key":"uY6MWnj3XC"},{"type":"text","value":".","position":{"start":{"line":841,"column":1},"end":{"line":841,"column":1}},"key":"WHKndvLcaN"}],"key":"hKE9MNphff"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"function misfitjac(x)\n    V, Km = x   # rename components for clarity\n    J = zeros(m, 2)\n    J[:, 1] = @. s / (Km + s)              # dw/dV\n    J[:, 2] = @. -V * s / (Km + s)^2         # dw/d_Km\n    return J\nend","key":"WbLk8pv5Sr"},{"type":"output","id":"m1g6_5vDOysRB4HMf6Q5I","data":[],"key":"mLdujoHH8Z"}],"data":{},"key":"zZwzGaRZhj"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"x₁ = [1, 0.75]\nx = FNC.newtonsys(misfit, misfitjac, x₁)\n\n@show V, Km = x[end]  # final values","key":"wLonZ9QiLL"},{"type":"output","id":"sJYzeXc9ha1Rt9x4Wlbkg","data":[],"key":"kHcqwc6t9A"}],"data":{},"key":"fMeuOTlnUw"},{"type":"paragraph","position":{"start":{"line":860,"column":1},"end":{"line":860,"column":1}},"children":[{"type":"text","value":"The final values are reasonably close to the values ","position":{"start":{"line":860,"column":1},"end":{"line":860,"column":1}},"key":"C7PKleiRrJ"},{"type":"inlineMath","value":"V=2","position":{"start":{"line":860,"column":1},"end":{"line":860,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>V</mi><mo>=</mo><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">V=2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span></span></span></span>","key":"VdMwv40cFq"},{"type":"text","value":", ","position":{"start":{"line":860,"column":1},"end":{"line":860,"column":1}},"key":"TWtbSpblow"},{"type":"inlineMath","value":"K_m=0.5","position":{"start":{"line":860,"column":1},"end":{"line":860,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>K</mi><mi>m</mi></msub><mo>=</mo><mn>0.5</mn></mrow><annotation encoding=\"application/x-tex\">K_m=0.5</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0.5</span></span></span></span>","key":"mDOMyAk2sr"},{"type":"text","value":" that we used to generate the noise-free data. Graphically, the model looks close to the original data.","position":{"start":{"line":860,"column":1},"end":{"line":860,"column":1}},"key":"BnByqVOxPn"}],"key":"nb35NyeeXy"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"model(s) = V * s / (Km + s)\nplot!(model, 0, 6, label=\"nonlinear fit\")","key":"L1cSAm5lya"},{"type":"output","id":"qopwAt7XqMy1ckbtGmKTz","data":[],"key":"jEZqI53N03"}],"data":{},"key":"duAl8a3LKC"},{"type":"paragraph","position":{"start":{"line":867,"column":1},"end":{"line":867,"column":1}},"children":[{"type":"text","value":"For this particular model, we also have the option of linearizing the fit process. Rewrite the model as","position":{"start":{"line":867,"column":1},"end":{"line":867,"column":1}},"key":"DU2TPEGHLi"}],"key":"XDvTIxOddN"},{"type":"math","value":"\\frac{1}{w} = \\frac{\\alpha}{s} + \\beta = \\alpha \\cdot s^{-1} + \\beta","enumerated":false,"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mfrac><mn>1</mn><mi>w</mi></mfrac><mo>=</mo><mfrac><mi>α</mi><mi>s</mi></mfrac><mo>+</mo><mi>β</mi><mo>=</mo><mi>α</mi><mo>⋅</mo><msup><mi>s</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo>+</mo><mi>β</mi></mrow><annotation encoding=\"application/x-tex\">\\frac{1}{w} = \\frac{\\alpha}{s} + \\beta = \\alpha \\cdot s^{-1} + \\beta</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.0074em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.7936em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.1076em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">s</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05278em;\">β</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4445em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.9474em;vertical-align:-0.0833em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05278em;\">β</span></span></span></span></span>","key":"czJ63giOsq"},{"type":"paragraph","position":{"start":{"line":874,"column":1},"end":{"line":874,"column":1}},"children":[{"type":"text","value":"for the new fitting parameters ","position":{"start":{"line":874,"column":1},"end":{"line":874,"column":1}},"key":"ITPZx7cZeg"},{"type":"inlineMath","value":"\\alpha=K_m/V","position":{"start":{"line":874,"column":1},"end":{"line":874,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>α</mi><mo>=</mo><msub><mi>K</mi><mi>m</mi></msub><mi mathvariant=\"normal\">/</mi><mi>V</mi></mrow><annotation encoding=\"application/x-tex\">\\alpha=K_m/V</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">/</span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span></span></span></span>","key":"JYHkS9vyti"},{"type":"text","value":" and ","position":{"start":{"line":874,"column":1},"end":{"line":874,"column":1}},"key":"JoKFYQ0259"},{"type":"inlineMath","value":"\\beta=1/V","position":{"start":{"line":874,"column":1},"end":{"line":874,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>β</mi><mo>=</mo><mn>1</mn><mi mathvariant=\"normal\">/</mi><mi>V</mi></mrow><annotation encoding=\"application/x-tex\">\\beta=1/V</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05278em;\">β</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1/</span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span></span></span></span>","key":"vnAI9v7wXE"},{"type":"text","value":". This corresponds to the misfit function whose entries are","position":{"start":{"line":874,"column":1},"end":{"line":874,"column":1}},"key":"nq67bFfjqx"}],"key":"nuRGNe277R"},{"type":"math","value":"f_i([\\alpha,\\beta]) = \\left(\\alpha \\cdot \\frac{1}{s_i} + \\beta\\right) - \\frac{1}{w_i}","position":{"start":{"line":876,"column":1},"end":{"line":876,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>f</mi><mi>i</mi></msub><mo stretchy=\"false\">(</mo><mo stretchy=\"false\">[</mo><mi>α</mi><mo separator=\"true\">,</mo><mi>β</mi><mo stretchy=\"false\">]</mo><mo stretchy=\"false\">)</mo><mo>=</mo><mrow><mo fence=\"true\">(</mo><mi>α</mi><mo>⋅</mo><mfrac><mn>1</mn><msub><mi>s</mi><mi>i</mi></msub></mfrac><mo>+</mo><mi>β</mi><mo fence=\"true\">)</mo></mrow><mo>−</mo><mfrac><mn>1</mn><msub><mi>w</mi><mi>i</mi></msub></mfrac></mrow><annotation encoding=\"application/x-tex\">f_i([\\alpha,\\beta]) = \\left(\\alpha \\cdot \\frac{1}{s_i} + \\beta\\right) - \\frac{1}{w_i}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">([</span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05278em;\">β</span><span class=\"mclose\">])</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.4em;vertical-align:-0.95em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">(</span></span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05278em;\">β</span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">)</span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.1574em;vertical-align:-0.836em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span>","enumerator":"1","key":"XUUI0Hy4Z5"},{"type":"paragraph","position":{"start":{"line":877,"column":1},"end":{"line":877,"column":1}},"children":[{"type":"text","value":"for ","position":{"start":{"line":877,"column":1},"end":{"line":877,"column":1}},"key":"gs9QCfLX8w"},{"type":"inlineMath","value":"i=1,\\ldots,m","position":{"start":{"line":877,"column":1},"end":{"line":877,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi><mo>=</mo><mn>1</mn><mo separator=\"true\">,</mo><mo>…</mo><mo separator=\"true\">,</mo><mi>m</mi></mrow><annotation encoding=\"application/x-tex\">i=1,\\ldots,m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8389em;vertical-align:-0.1944em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">m</span></span></span></span>","key":"OhPCNBK9x2"},{"type":"text","value":". Although this misfit is nonlinear in ","position":{"start":{"line":877,"column":1},"end":{"line":877,"column":1}},"key":"DYEHAhap6i"},{"type":"inlineMath","value":"s","position":{"start":{"line":877,"column":1},"end":{"line":877,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>s</mi></mrow><annotation encoding=\"application/x-tex\">s</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">s</span></span></span></span>","key":"F8EXNyT42z"},{"type":"text","value":" and ","position":{"start":{"line":877,"column":1},"end":{"line":877,"column":1}},"key":"kZk8onPFu6"},{"type":"inlineMath","value":"w","position":{"start":{"line":877,"column":1},"end":{"line":877,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>w</mi></mrow><annotation encoding=\"application/x-tex\">w</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span></span></span></span>","key":"yxWMAH8mLA"},{"type":"text","value":", it’s linear in the unknown parameters ","position":{"start":{"line":877,"column":1},"end":{"line":877,"column":1}},"key":"bm5FcqJfRO"},{"type":"text","value":"α","position":{"start":{"line":877,"column":1},"end":{"line":877,"column":1}},"key":"Un8B27p1yW"},{"type":"text","value":" and ","position":{"start":{"line":877,"column":1},"end":{"line":877,"column":1}},"key":"zNDW4TL0Pm"},{"type":"text","value":"β","position":{"start":{"line":877,"column":1},"end":{"line":877,"column":1}},"key":"XHErsEhuib"},{"type":"text","value":". This lets us pose and solve it as a linear least-squares problem.","position":{"start":{"line":877,"column":1},"end":{"line":877,"column":1}},"key":"ILeVty1Eht"}],"key":"ynjs7jazwo"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"A = [s .^ (-1) s .^ 0]\nu = 1 ./ w\nα, β = A \\ u","key":"LHHoRb07jU"},{"type":"output","id":"N-Z_tVk40QRThkA6jxiDy","data":[],"key":"l0uRkokt8I"}],"data":{},"key":"PpH3vOCavN"},{"type":"paragraph","position":{"start":{"line":885,"column":1},"end":{"line":885,"column":1}},"children":[{"type":"text","value":"The two fits are different because they do not optimize the same quantities.","position":{"start":{"line":885,"column":1},"end":{"line":885,"column":1}},"key":"iQtwzvgpCm"}],"key":"FxbFvF6CCB"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"linmodel(x) = 1 / (β + α / x)\nplot!(linmodel, 0, 6, label=\"linearized fit\")","key":"nDD8nP9iHP"},{"type":"output","id":"YFy4zYVjC_7TVbe0fZA3z","data":[],"key":"zmjaoyADYt"}],"data":{},"key":"oRABJgIMAB"},{"type":"paragraph","position":{"start":{"line":892,"column":1},"end":{"line":892,"column":1}},"children":[{"type":"text","value":"The truly nonlinear fit is clearly better in this case. It optimizes a residual for the original measured quantity rather than a transformed one we picked for algorithmic convenience.","position":{"start":{"line":892,"column":1},"end":{"line":892,"column":1}},"key":"yg2h8INKxT"}],"key":"ny4Mo5H54Q"}],"label":"demo-nlsq-MM-julia","identifier":"demo-nlsq-mm-julia","html_id":"demo-nlsq-mm-julia","key":"CqIoZRzaN0"}],"key":"g7V62B9XJE"}],"key":"y1QMrLmSB3"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Chapter 3","url":"/chapter3","group":"Julia codes"},"next":{"title":"Chapter 5","url":"/chapter5","group":"Julia codes"}}},"domain":"http://localhost:3000"}