{"kind":"Notebook","sha256":"91196a07ae99f71579de66fb3c9388c3a6ff5dab6a075f965711fb3f2e845241","slug":"order12-1","location":"/chapter5/section5/matlab/order12.ipynb","dependencies":[],"frontmatter":{"numbering":{"heading_1":{"enabled":false},"heading_2":{"enabled":false},"heading_3":{"enabled":false},"heading_4":{"enabled":false},"heading_5":{"enabled":false},"heading_6":{"enabled":false}},"kernelspec":{"name":"jupyter_matlab_kernel","display_name":"MATLAB Kernel","language":"matlab"},"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"exports":[{"format":"ipynb","filename":"order12.ipynb","url":"/fnc/build/order12-a1143842dcdc962307d52a6ed7b078d9.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"KJczjnpUwa"},{"type":"text","value":"5.5.3","key":"XA2q4t20D0"}],"key":"kjjnJS5n5e"}],"identifier":"demo-fdconverge-order12","label":"demo-fdconverge-order12","kind":"proof:example","template":"Example %s","enumerator":"5.5.3","resolved":true,"html_id":"demo-fdconverge-order12","remote":true,"url":"/fd-converge","dataUrl":"/fd-converge.json","key":"HBTiwUF3Pg"}],"key":"oexUtnBYAl"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Let’s observe the convergence of the formulas in ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"gYc67wASYo"},{"type":"crossReference","kind":"proof:example","identifier":"example-fd-converge-fd11","label":"example-fd-converge-FD11","children":[{"type":"text","value":"Example ","key":"LwhHfSwwPo"},{"type":"text","value":"5.5.1","key":"A7Ui0jcPIw"}],"template":"Example %s","enumerator":"5.5.1","resolved":true,"html_id":"example-fd-converge-fd11","remote":true,"url":"/fd-converge","dataUrl":"/fd-converge.json","key":"Ah4IuLh8nA"},{"type":"text","value":" and ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"XA51Uql6Q3"},{"type":"crossReference","kind":"proof:example","identifier":"example-fd-converge-fd12","label":"example-fd-converge-FD12","children":[{"type":"text","value":"Example ","key":"JLaUCBWkP4"},{"type":"text","value":"5.5.2","key":"sCx4qUG7XC"}],"template":"Example %s","enumerator":"5.5.2","resolved":true,"html_id":"example-fd-converge-fd12","remote":true,"url":"/fd-converge","dataUrl":"/fd-converge.json","key":"dVwOPHJJHS"},{"type":"text","value":", applied to the function ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"NtAtyXQQBi"},{"type":"inlineMath","value":"\\sin(e^{x+1})","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>sin</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><msup><mi>e</mi><mrow><mi>x</mi><mo>+</mo><mn>1</mn></mrow></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\sin(e^{x+1})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mop\">sin</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">x</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"bB5PZGIFB2"},{"type":"text","value":" at ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"xleHXjKNOx"},{"type":"inlineMath","value":"x=0","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">x=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"j70uynKZ3M"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"zUySB8xILA"}],"key":"rqVAeiaak0"}],"key":"giDtkcjf52"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"f = @(x) sin(exp(x + 1));\nexact_value = exp(1) * cos(exp(1))","key":"YIzUJ4H00b"},{"type":"output","id":"KiY0UCn5ju5LK5vZgo8Wx","data":[{"output_type":"execute_result","execution_count":2,"metadata":{},"data":{"text/plain":{"content":"exact_value = -2.4783","content_type":"text/plain"},"text/html":{"content":"<html><body><pre>exact_value = -2.4783</pre></body></html>","content_type":"text/html"}}}],"key":"bQUBZzLt4z"}],"key":"kvSIu94POe"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We’ll compute the formulas in parallel for a sequence of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wfXttiESzD"},{"type":"inlineMath","value":"h","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>h</mi></mrow><annotation encoding=\"application/x-tex\">h</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">h</span></span></span></span>","key":"MuL1MW4Vw1"},{"type":"text","value":" values.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mEixwbdGCS"}],"key":"fR2t1ScC3P"}],"key":"NP6EDeP6tj"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"h = 5 ./ 10.^(1:6)';\nFD1 = zeros(size(h));\nFD2 = zeros(size(h));\nfor i = 1:length(h)\n    h_i = h(i);\n    FD1(i) = (f(h_i) - f(0)    ) / h_i;\n    FD2(i) = (f(h_i) - f(-h_i)) / (2*h_i);\nend\ndisp(table(h, FD1, FD2))","key":"PRCb3abYjE"},{"type":"output","id":"3u8w23X8ESPB_3LyE0Aug","data":[{"name":"stdout","output_type":"stream","text":"      h         FD1        FD2  \n    ______    _______    _______\n\n       0.5    -2.7686    -1.9705\n      0.05    -2.6128    -2.4755\n     0.005    -2.4921    -2.4783\n    0.0005    -2.4797    -2.4783\n     5e-05    -2.4785    -2.4783\n     5e-06    -2.4784    -2.4783\n\n"}],"key":"wmWWbQqsgO"}],"key":"p8clMQzmku"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"All that’s easy to see from this table is that FD2 appears to converge to the same result as FD1, but more rapidly. A table of errors is more informative.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"W5MRP4zxCx"}],"key":"T3UATrIUex"}],"key":"HOhNJFau9V"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"err1 = abs(exact_value - FD1);\nerr2 = abs(exact_value - FD2);\ndisp(table(h, err1, err2, variableNames=[\"h\", \"error in FD1\", \"error in FD2\"]))","key":"k0Uoc3fhbz"},{"type":"output","id":"z_gTGtF9xa79HDpLXSgLH","data":[{"name":"stdout","output_type":"stream","text":"      h       error in FD1    error in FD2\n    ______    ____________    ____________\n\n       0.5        0.29023         0.50788 \n      0.05        0.13445       0.0028295 \n     0.005       0.013755      2.8038e-05 \n    0.0005      0.0013781      2.8035e-07 \n     5e-05     0.00013784       2.803e-09 \n     5e-06     1.3784e-05      2.3529e-11 \n\n"}],"key":"yKPYElQ5xH"}],"key":"IW1qfKkFx3"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"In each row, ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"aEcqMj282q"},{"type":"inlineMath","value":"h","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>h</mi></mrow><annotation encoding=\"application/x-tex\">h</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">h</span></span></span></span>","key":"F1G3BjHY9l"},{"type":"text","value":" is decreased by a factor of 10, so that the error is reduced by a factor of 10 in the first-order method and 100 in the second-order method.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"AOF0WdQs7Z"}],"key":"T2dUolF0un"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"A graphical comparison can be useful as well. On a log-log scale, the error should (as ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"HDgrvJk3P6"},{"type":"inlineMath","value":"h\\to 0","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>h</mi><mo>→</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">h\\to 0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">h</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"Ktc9yT7Q9J"},{"type":"text","value":") be a straight line whose slope is the order of accuracy. However, it’s conventional in convergence plots to show ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"GdftyZLJe7"},{"type":"inlineMath","value":"h","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>h</mi></mrow><annotation encoding=\"application/x-tex\">h</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">h</span></span></span></span>","key":"Dif5XbaWHA"},{"type":"text","value":" ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"fz6WjF3tUl"},{"type":"emphasis","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"decreasing","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"X05ykB54Cx"}],"key":"ArzXucpsYI"},{"type":"text","value":" from left to right, which negates the slopes.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"QNfok6jjay"}],"key":"bGJWJaBLW2"}],"key":"SgCpSp2bG0"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"clf\nloglog(h, abs([err1 err2]), \"o-\")\nset(gca, \"xdir\", \"reverse\")\norder1 = 0.1 * err1(end) * (h / h(end)) .^ 1;\norder2 = 0.1 * err2(end) * (h / h(end)) .^ 2;\nhold on\nloglog(h, order1, \"--\", h, order2, \"--\")\nxlabel(\"h\");  ylabel(\"error\")\ntitle(\"Convergence of finite differences\")\nlegend(\"FD1\", \"FD2\", \"O(h)\", \"O(h^2)\");","key":"yRK2juTZ06"},{"type":"output","id":"23xaly74h-rNm7FMMwY-E","data":[{"output_type":"execute_result","execution_count":5,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"79b8c07920d2efa4da0b2a74150ff25d","path":"/fnc/build/79b8c07920d2efa4da0b2a74150ff25d.png"}}}],"key":"AYwRUWjBqe"}],"key":"FfUZ2bKtSE"}],"key":"qWapU8EdTm"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Fd Weights","url":"/fd-weights-1","group":"Chapter 5"},"next":{"title":"Round","url":"/round-1","group":"Chapter 5"}}},"domain":"http://localhost:3000"}