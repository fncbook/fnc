{"version":2,"kind":"Notebook","sha256":"9e65e0685f4aa44aa259356df4357283d7e9b16968a09059aec553a7ba0bffb5","slug":"chapter10-1","location":"/matlab/chapter10.md","dependencies":[],"frontmatter":{"title":"Chapter 10","numbering":{"heading_1":{"enabled":false},"heading_2":{"enabled":false},"heading_3":{"enabled":false},"heading_4":{"enabled":false},"heading_5":{"enabled":false},"heading_6":{"enabled":false},"title":{"offset":2}},"kernelspec":{"name":"jupyter_matlab_kernel","display_name":"MATLAB","language":"matlab"},"content_includes_title":false,"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","TPBVP":"two-point boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"edit_url":"https://github.com/fncbook/fnc/blob/master/matlab/chapter10.md","exports":[{"format":"md","filename":"chapter10.md","url":"/build/chapter10-17a6302bf62d6a1084fdefc3e49a72c4.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Functions","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"ixw61L8S5F"}],"identifier":"functions","label":"Functions","html_id":"functions","implicit":true,"key":"b4cwsMUhj4"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Shooting method for a two-point boundary-value problem","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"KbmQ8mAFYJ"}],"key":"psCnCdxhQj"},{"type":"include","file":"FNC-matlab/shoot.m","literal":true,"children":[{"type":"code","value":"function [x, u, du_dx] = shoot(phi, a, b, ga, gb, init, tol)\r\n%SHOOT   Shooting method for a two-point boundary-value problem.\r\n% Input:\r\n%   phi      defines u'' = phi(x, u, u') (function)\r\n%   a, b     endpoints of the domain (scalars)\r\n%   ga       residual boundary function of u(a), u'(a) \r\n%   gb       residual boundary function of u(b), u'(b) \r\n%   init     initial guess for u(a) and u'(a) (column vector)\r\n%   tol      error tolerance (scalar)\r\n% Output:\r\n%   x        nodes in x (length n+1)\r\n%   u        values of u(x)  (length n+1)\r\n%   du_dx    values of u'(x) (length n+1)\r\n\r\n% To be solved by the IVP solver\r\nfunction f = shootivp(x, y)\r\n  f = [ y(2); phi(x, y(1), y(2)) ];\r\nend\r\n\r\nivp = ode(ODEFcn=@shootivp);\r\nivp.InitialTime = a;\r\nivp.AbsoluteTolerance = tol / 10;\r\nivp.RelativeTolerance = tol / 10;\r\n\r\n% To be solved by levenberg\r\nfunction residual = objective(s)\r\n  ivp.InitialValue = s;\r\n  sol = solve(ivp, a, b);\r\n  x = sol.Time;  y = sol.Solution;\r\n  residual = [ga(y(1, 1), y(2, 1)); gb(y(1, end), y(2, end))];\r\nend\r\n\r\ny = [];    % shared variable\r\ns = levenberg(@objective, init, tol);\r\n\r\n% Don't need to solve the IVP again. It was done within the\r\n% objective function already.\r\nu = y(1, :);            % solution     \r\ndu_dx = y(2, :);         % derivative\r\n\r\nend","lang":"matlab","showLineNumbers":true,"filename":"shoot.m","key":"EXVKIWQZi1"}],"key":"wFRflUROAh"}],"label":"function-shoot-matlab","identifier":"function-shoot-matlab","html_id":"function-shoot-matlab","key":"Awa5oZ92xt"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Second-order differentiation matrices","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"gXFFT4WVFW"}],"key":"ZjNXhfoTDV"},{"type":"include","file":"FNC-matlab/diffmat2.m","literal":true,"children":[{"type":"code","value":"function [x,Dx,Dxx] = diffmat2(n,xspan)\n%DIFFMAT2   Second-order accurate differentiation matrices.\n% Input:\n%   n       number of subintervals (one less than the number of nodes)\n%   xspan   interval endpoints\n% Output:\n%   x       equispaced nodes\n%   Dx      matrix for first derivative \n%   Dxx     matrix for second derivative \n\na = xspan(1);  b = xspan(2);\nh = (b-a)/n;\nx = a + h*(0:n)';   % nodes\n\n% Define most of Dx by its diagonals.\ndp = 0.5*ones(n,1)/h;       % superdiagonal\ndm = -0.5*ones(n,1)/h;      % subdiagonal\nDx = diag(dm,-1) + diag(dp,1);\n\n% Fix first and last rows.\nDx(1,1:3) = [-1.5,2,-0.5]/h;\nDx(n+1,n-1:n+1) = [0.5,-2,1.5]/h;\n\n% Define most of Dxx by its diagonals.\nd0 =  -2*ones(n+1,1)/h^2;   % main diagonal\ndp =  ones(n,1)/h^2;        % superdiagonal and subdiagonal\nDxx = diag(dp,-1) + diag(d0) + diag(dp,1);\n\n% Fix first and last rows.\nDxx(1,1:4) = [2,-5,4,-1]/h^2;\nDxx(n+1,n-2:n+1) = [-1,4,-5,2]/h^2;\n    ","lang":"matlab","showLineNumbers":true,"filename":"diffmat2.m","key":"IwnpBgphnq"}],"key":"CpBKz2zd23"}],"label":"function-diffmat2-matlab","identifier":"function-diffmat2-matlab","html_id":"function-diffmat2-matlab","key":"sX1oKqEtm4"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Chebyshev differentiation matrices","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"PsPd3MUVEd"}],"key":"of29p4flfq"},{"type":"include","file":"FNC-matlab/diffcheb.m","literal":true,"children":[{"type":"code","value":"function [x,Dx,Dxx] = diffcheb(n,xspan)\n%DIFFCHEB   Chebyshev differentiation matrices.\n% Input:\n%   n      number of subintervals (integer)\n%   xspan  interval endpoints (vector)\n% Output:\n%   x      Chebyshev nodes in domain (length n+1)\n%   Dx     matrix for first derivative (n+1 by n+1)\n%   Dxx    matrix for second derivative (n+1 by n+1)\n\nx = -cos( (0:n)'*pi/n );    % nodes in [-1,1]\nDx = zeros(n+1);\nc = [2; ones(n-1,1); 2];    % endpoint factors\ni = (0:n)';                 % row indices\n\n% Off-diagonal entries\nfor j = 0:n\n  num = c(i+1).*(-1).^(i+j);\n  den = c(j+1)*(x-x(j+1));\n  Dx(:,j+1) = num./den;\nend\n\n% Diagonal entries\nDx(isinf(Dx)) = 0;          % fix divisions by zero on diagonal\nDx = Dx - diag(sum(Dx,2));  % \"negative sum trick\" \n  \n% Transplant to [a,b]\na = xspan(1);  b = xspan(2);\nx = a + (b-a)*(x+1)/2;\nDx = 2*Dx/(b-a);\n\n% Second derivative\nDxx = Dx^2;","lang":"matlab","showLineNumbers":true,"filename":"diffcheb.m","key":"BIGrkwEWFj"}],"key":"Q2UbYOwkRr"}],"label":"function-diffcheb-matlab","identifier":"function-diffcheb-matlab","html_id":"function-diffcheb-matlab","key":"YXgUexWoDc"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Solution of a linear boundary-value problem","position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"key":"UHPGUbfc4U"}],"key":"zgIJ26DiUJ"},{"type":"include","file":"FNC-matlab/bvplin.m","literal":true,"children":[{"type":"code","value":"function [x, u] = bvplin(p, q, r, a, b, ua, ub,n)\r\n% BVPLIN   Solve a linear boundary-value problem.\r\n% Input:\r\n%   p, q, r  u'' + pu' + qu = r (functions)\r\n%   a, b     endpoints of the domain (scalars)\r\n%   ua       value of u(a)\r\n%   ub       value of u(b)\r\n%   n        number of subintervals (integer)\r\n% Output:\r\n%   x       collocation nodes (vector, length n+1)\r\n%   u       solution at nodes (vector, length n+1)\r\n\r\n[x, Dx, Dxx] = diffmat2(n, [a, b]);\r\n\r\nP = diag(p(x));\r\nQ = diag(q(x));\r\nL = Dxx + P * Dx + Q;    % ODE expressed at the nodes\r\nr = r(x);    \r\n\r\n% Replace first and last rows using boundary conditions. \r\nI = speye(n+1); \r\nA = [ I(:, 1)'; L(2:n, :); I(:, n+1)' ];\r\n\r\nf = [ ua; r(2:n); ub ];\r\n\r\n% Solve the system.\r\nu = A \\ f;","lang":"matlab","showLineNumbers":true,"filename":"bvplin.m","key":"kB0iKjArw5"}],"key":"ImQcAlS0Yj"}],"label":"function-bvplin-matlab","identifier":"function-bvplin-matlab","html_id":"function-bvplin-matlab","key":"QNLgHigNGF"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Solution of a nonlinear boundary-value problem","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"key":"B8s8Utrs0P"}],"key":"Fg3F7YHyCg"},{"type":"include","file":"FNC-matlab/bvp.m","literal":true,"children":[{"type":"code","value":"  function [x,u] = bvp(phi, a, b, ga, gb, init)\n%BVP      Solve a boundary-value problem by finite differences\n%         with either Dirichlet or Neumann BCs.\n% Input:\n%   phi      defines u'' = phi(x,u,u') (function)\n%   a, b     endpoints of the domain (scalars)\n%   ga       residual boundary function of u(a), u'(a) \n%   gb       residual boundary function of u(b), u'(b) \n%   init     initial guess for the solution (length n+1 vector)\n% Output:\n%   x        nodes in x (vector, length n+1)\n%   u        values of u(x)  (vector, length n+1)\n%   res      function for computing the residual\n\nn = length(init) - 1;\n[x, Dx, Dxx] = diffmat2(n, [a, b]);\nh = x(2) - x(1);\n\nu = levenberg(@residual, init);\nu = u(:, end);\n\n    function f = residual(u)\n        % Computes the difference between u'' and phi(x,u,u') at the\n        % interior nodes and appends the error at the boundaries. \n        du_dx = Dx*u;                   % discrete u'\n        d2u_dx2 = Dxx*u;                % discrete u''\n        f = d2u_dx2 - phi(x,u,du_dx);\n        \n        % Replace first and last values by boundary conditions.\n        f(1) =   ga(  u(1),   du_dx(1)) / h;\n        f(end) = gb(u(end), du_dx(end)) / h;\n    end\n\nend","lang":"matlab","showLineNumbers":true,"filename":"bvp.m","key":"JDgk2Vfeqz"}],"key":"EHjmcHAYs7"}],"label":"function-bvp-matlab","identifier":"function-bvp-matlab","html_id":"function-bvp-matlab","key":"ms26QofmvM"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Piecewise linear finite elements for a linear ","key":"CRaBdXpHO7"},{"type":"abbreviation","title":"boundary-value problem","children":[{"type":"text","value":"BVP","key":"ivLQbPpEdX"}],"key":"Zp3mg2OBn5"}],"key":"VbKvCqzDCT"},{"type":"include","file":"FNC-matlab/fem.m","literal":true,"children":[{"type":"code","value":"function [x,u] = fem(c,s,f,a,b,n)\r\n%FEM     Piecewise linear finite elements for a linear BVP.\r\n% Input:\r\n%   c,s,f    coefficient functions of x describing the ODE (functions) \r\n%   a,b      domain of the independent variable (scalars)\r\n%   n        number of grid subintervals (scalar) \r\n% Output:\r\n%   x        grid points (vector, length n+1)\r\n%   u        solution values at x (vector, length n+1)\r\n\r\n% Define the grid.\r\nh = (b-a)/n;\r\nx = a + h*(0:n)';  \r\n\r\n% Templates for the subinterval matrix and vector contributions.\r\nKe = [1 -1; -1 1];\r\nMe = (1/6)*[2 1; 1 2];\r\nfe = (1/2)*[1; 1];\r\n\r\n% Evaluate coefficent functions and find average values.\r\ncval = c(x);   cbar = (cval(1:n)+cval(2:n+1)) / 2;\r\nsval = s(x);   sbar = (sval(1:n)+sval(2:n+1)) / 2;\r\nfval = f(x);   fbar = (fval(1:n)+fval(2:n+1)) / 2;\r\n\r\n% Assemble global system, one interval at a time.\r\nK = zeros(n-1,n-1);  M = zeros(n-1,n-1);  f = zeros(n-1,1);\r\nK(1,1) = cbar(1)/h;  M(1,1) = sbar(1)*h/3;  f(1) = fbar(1)*h/2;\r\nK(n-1,n-1) = cbar(n)/h;  M(n-1,n-1) = sbar(n)*h/3;  f(n-1) = fbar(n)*h/2;\r\nfor k = 2:n-1\r\n  K(k-1:k,k-1:k) = K(k-1:k,k-1:k) + (cbar(k)/h) * Ke;\r\n  M(k-1:k,k-1:k) = M(k-1:k,k-1:k) + (sbar(k)*h) * Me;\r\n  f(k-1:k) = f(k-1:k) + (fbar(k)*h) * fe;\r\nend  \r\n\r\n% Solve system for the interior values.\r\nu = (K+M) \\ f;\r\nu = [0; u; 0];      % put the boundary values into the result","lang":"matlab","showLineNumbers":true,"filename":"fem.m","key":"ViV85R6UuR"}],"key":"FL1KF8RiY7"}],"label":"function-fem-matlab","identifier":"function-fem-matlab","html_id":"function-fem-matlab","key":"HmvFGHOzBC"},{"type":"heading","depth":2,"position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"children":[{"type":"text","value":"Examples","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"key":"IancEJEHBm"}],"identifier":"examples","label":"Examples","html_id":"examples","implicit":true,"key":"BjNCd8bYiw"}],"key":"Jrn76C7ybX"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"cd  /Users/driscoll/Documents/GitHub/fnc/matlab\nFNC_init;\npwd;;","visibility":"show","key":"SMqTZTFtka"},{"type":"output","id":"TCSPqOcH9aQ0fwrLgQ2iG","data":[{"output_type":"stream","name":"stdout","text":"Starting MATLAB ...\n"},{"output_type":"stream","name":"stdout","text":"Executing ..."}],"visibility":"show","key":"RLRfkwJH4W"}],"data":{"tags":[]},"visibility":"remove","key":"rb1DYrbVC0"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"children":[{"type":"text","value":"10.1 ","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"key":"M9MvrD9uut"},{"type":"link","identifier":"section-bvp-tpbvp","label":"section-bvp-tpbvp","kind":"narrative","position":{"start":{"line":76,"column":6},"end":{"line":76,"column":24}},"url":"/tpbvp","internal":true,"dataUrl":"/tpbvp.json","children":[{"type":"text","value":"Two-point BVP","key":"gQVPNWT0SS"}],"key":"Lc5sn6d4hf"}],"identifier":"id-10-1","label":"10.1 ","html_id":"id-10-1","implicit":true,"key":"SWkVPANDc3"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-tpbvp-mems","label":"demo-tpbvp-mems","kind":"proof:example","position":{"start":{"line":79,"column":1},"end":{"line":79,"column":17}},"children":[{"type":"text","value":"Example ","key":"QFPIZZuGQZ"},{"type":"text","value":"10.1.3","key":"qeHODeRDuA"}],"template":"Example %s","enumerator":"10.1.3","resolved":true,"html_id":"demo-tpbvp-mems","remote":true,"url":"/tpbvp","dataUrl":"/tpbvp.json","key":"H2bnqUzSvN"}],"key":"cUxRg8t4LY"},{"type":"paragraph","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"children":[{"type":"text","value":"To define the ","key":"saaKEeR8RC"},{"type":"abbreviation","title":"boundary-value problem","children":[{"type":"text","value":"BVP","key":"FS1R9VbZwe"}],"key":"k0CY67wYjg"},{"type":"text","value":", we need to define some functions for the ","key":"aZ5KJR8y8v"},{"type":"abbreviation","title":"ordinary differential equation","children":[{"type":"text","value":"ODE","key":"WfNFxeJHyj"}],"key":"Z0BD4yYPIC"},{"type":"text","value":" and boundary conditions. (For this simple problem, we will use anonymous functions, but for a more substantial one, it would be better to use named functions.) The first, which is similar to what we do for solving ","key":"tamdiuyI3x"},{"type":"abbreviation","title":"initial-value problem","children":[{"type":"text","value":"IVP","key":"jhshxmo5HL"}],"key":"UX8PXgHCoZ"},{"type":"text","value":"s, returns the computed values of ","key":"On6wnLPrid"},{"type":"inlineMath","value":"y_1'","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msubsup><mi>y</mi><mn>1</mn><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msubsup></mrow><annotation encoding=\"application/x-tex\">y_1&#x27;</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.2481em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-2.4519em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2481em;\"><span></span></span></span></span></span></span></span></span></span>","key":"NINoxO5oTM"},{"type":"text","value":" and ","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"key":"C2woXQMfgP"},{"type":"inlineMath","value":"y_2'","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msubsup><mi>y</mi><mn>2</mn><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msubsup></mrow><annotation encoding=\"application/x-tex\">y_2&#x27;</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.2481em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-2.4519em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2481em;\"><span></span></span></span></span></span></span></span></span></span>","key":"OdKVjC3Qae"},{"type":"text","value":" given values of the dependent and independent variable.","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"key":"eEPmsxfW6h"}],"indexEntries":[{"entry":"Julia","subEntry":{"value":"in-place function","kind":"entry"},"emphasis":true}],"label":"index-gvAjREaFAv","identifier":"index-gvajreafav","html_id":"index-gvajreafav","key":"FsvmMWyIgT"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"lambda = 0.6;\nbvpfcn = @(r, y) [ y(2); lambda / y(1)^2 - y(2) / r  ];    % column vector [y1'(r); y2'(r)]","key":"TzfhUnqNg0"},{"type":"output","id":"_UGOpZAgjZnuGVVU_x6Dw","data":[],"key":"e0yolq6YLO"}],"key":"Yt6V7mU0a7"},{"type":"paragraph","position":{"start":{"line":91,"column":1},"end":{"line":91,"column":1}},"children":[{"type":"text","value":"To encode the boundary conditions ","position":{"start":{"line":91,"column":1},"end":{"line":91,"column":1}},"key":"mqFQFudL7T"},{"type":"inlineMath","value":"y_2(0)=0","position":{"start":{"line":91,"column":1},"end":{"line":91,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>y</mi><mn>2</mn></msub><mo stretchy=\"false\">(</mo><mn>0</mn><mo stretchy=\"false\">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">y_2(0)=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"QZF5pGRe3F"},{"type":"text","value":", ","position":{"start":{"line":91,"column":1},"end":{"line":91,"column":1}},"key":"wCHWaEhaaU"},{"type":"inlineMath","value":"y_1(2)-1=0","position":{"start":{"line":91,"column":1},"end":{"line":91,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>y</mi><mn>1</mn></msub><mo stretchy=\"false\">(</mo><mn>2</mn><mo stretchy=\"false\">)</mo><mo>−</mo><mn>1</mn><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">y_1(2)-1=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\">2</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"LsIvEmqQpF"},{"type":"text","value":", we define a function for their residual values. In other words, these are quantities that the solver has to make zero in order to satisfy the boundary conditions.","position":{"start":{"line":91,"column":1},"end":{"line":91,"column":1}},"key":"umqUxBtapu"}],"key":"kPQVfIKqSX"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"bcfcn = @(ya, yb) [ ya(2); yb(1) - 1 ];    % y_2(a) = 0;  y_1(b) = 1","key":"G60ZzxdoMd"},{"type":"output","id":"r_yhZxuNg2099UmILhLhb","data":[],"key":"Ip4WgCqbsy"}],"key":"Al9AZcBBqp"},{"type":"paragraph","position":{"start":{"line":97,"column":1},"end":{"line":97,"column":1}},"children":[{"type":"text","value":"We will define the domain next. Since there is a division by ","position":{"start":{"line":97,"column":1},"end":{"line":97,"column":1}},"key":"mojuy2P9KO"},{"type":"inlineMath","value":"r","position":{"start":{"line":97,"column":1},"end":{"line":97,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>r</mi></mrow><annotation encoding=\"application/x-tex\">r</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span></span></span></span>","key":"NyR8A0LDbg"},{"type":"text","value":" in the ","key":"ujYEmPp0bY"},{"type":"abbreviation","title":"ordinary differential equation","children":[{"type":"text","value":"ODE","key":"sTahuDJ7oM"}],"key":"GFvzGUDqSE"},{"type":"text","value":", we want to avoid ","key":"KbPMKEHmAA"},{"type":"inlineMath","value":"r=0","position":{"start":{"line":97,"column":1},"end":{"line":97,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>r</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">r=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"mVF2YN5WtP"},{"type":"text","value":" by truncating the domain a tiny bit. We use equispaced nodes here.","position":{"start":{"line":97,"column":1},"end":{"line":97,"column":1}},"key":"NXaEOoVmxu"}],"key":"c1fUmHE1bB"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"nodes = linspace(eps, 1, 61);","key":"aBE9zP9vvo"},{"type":"output","id":"v8bEmzU9LH43lNiyIkS-R","data":[],"key":"Qqs7OIp6nI"}],"key":"tjCLoH3RBr"},{"type":"paragraph","position":{"start":{"line":103,"column":1},"end":{"line":103,"column":1}},"children":[{"type":"text","value":"We need to make one more defintion that isn’t part of the mathematical formulation. Rather, it provides an initial guess for the solution. As we will see, this plays the same role as initialization in Newton’s method for rootfinding. Here we choose both components to be constant.","position":{"start":{"line":103,"column":1},"end":{"line":103,"column":1}},"key":"AilUuPgVqL"}],"key":"aWsSX0tCy7"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"y_init = @(r) [ 1; 0 ];\nsol_init = bvpinit(nodes, y_init);    % create the initial guess","key":"CDbitpbPGl"},{"type":"output","id":"fnm_ySNWEfAi-BpA9gCRY","data":[],"key":"Xah5vtMLEN"}],"key":"ms5Y6D3xeg"},{"type":"paragraph","position":{"start":{"line":110,"column":1},"end":{"line":110,"column":1}},"children":[{"type":"text","value":"Now we can solve the ","key":"Zp5EWxaCG7"},{"type":"abbreviation","title":"boundary-value problem","children":[{"type":"text","value":"BVP","key":"NrCoKRiwie"}],"key":"bD9VHHvmYK"},{"type":"text","value":" using the ","key":"my5HbFJnFc"},{"type":"inlineCode","value":"bvp4c","position":{"start":{"line":110,"column":1},"end":{"line":110,"column":1}},"key":"oK17ZbFnkV"},{"type":"text","value":" function.","position":{"start":{"line":110,"column":1},"end":{"line":110,"column":1}},"key":"zRZX66KV4M"}],"key":"TsGFTdJCKf"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"sol = bvp4c(bvpfcn, bcfcn, sol_init);\n\nplot(sol.x, sol.y, '-o')\nxlabel('r'), ylabel('y(r)')\ntitle('Solution of the membrane problem')\nlegend(\"w(r)\", \"w'(r)\", location=\"east\");","key":"h70nQHSCdf"},{"type":"output","id":"7SZsEryM1auF9KQQMA-rv","data":[{"output_type":"execute_result","execution_count":6,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"c9c4229a5ad39a4615baeaeca4f3ffa0","path":"/build/c9c4229a5ad39a4615baeaeca4f3ffa0.png"}}}],"key":"fj8jRWMuBV"}],"key":"WBFAsovVkj"},{"type":"paragraph","position":{"start":{"line":121,"column":1},"end":{"line":121,"column":1}},"children":[{"type":"text","value":"It’s smart to check visually that the boundary conditions are satisfied. The left BC implies a horizontal tangent at ","position":{"start":{"line":121,"column":1},"end":{"line":121,"column":1}},"key":"jv7PmhvP4V"},{"type":"inlineMath","value":"r=0","position":{"start":{"line":121,"column":1},"end":{"line":121,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>r</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">r=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"bEPj3kyxdF"},{"type":"text","value":", and the right BC implies that ","position":{"start":{"line":121,"column":1},"end":{"line":121,"column":1}},"key":"DjcTBKpFhk"},{"type":"inlineMath","value":"w(1)=1","position":{"start":{"line":121,"column":1},"end":{"line":121,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>w</mi><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">w(1)=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"m5X8jYCMdi"},{"type":"text","value":". If the solver failed to satisfy these conditions, we would have to try a different initial guess.","position":{"start":{"line":121,"column":1},"end":{"line":121,"column":1}},"key":"gXSirPt0kT"}],"key":"Bj8XsN5HnE"}],"label":"demo-tpbvp-mems-matlab","identifier":"demo-tpbvp-mems-matlab","html_id":"demo-tpbvp-mems-matlab","key":"Hgb0LpiPdd"},{"type":"heading","depth":3,"position":{"start":{"line":124,"column":1},"end":{"line":124,"column":1}},"children":[{"type":"text","value":"10.2 ","position":{"start":{"line":124,"column":1},"end":{"line":124,"column":1}},"key":"LXew6lQIvW"},{"type":"link","identifier":"section-bvp-shooting","label":"section-bvp-shooting","kind":"narrative","position":{"start":{"line":124,"column":6},"end":{"line":124,"column":27}},"url":"/shooting","internal":true,"dataUrl":"/shooting.json","children":[{"type":"text","value":"Shooting","key":"FaXwljn7tM"}],"key":"vRMJz08uNd"}],"identifier":"id-10-2","label":"10.2 ","html_id":"id-10-2","implicit":true,"key":"QHWcS2qmAW"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-shooting-naive","label":"demo-shooting-naive","kind":"proof:example","position":{"start":{"line":126,"column":1},"end":{"line":126,"column":21}},"children":[{"type":"text","value":"Example ","key":"hFjw2baaJo"},{"type":"text","value":"10.2.1","key":"KnstUeXkkj"}],"template":"Example %s","enumerator":"10.2.1","resolved":true,"html_id":"demo-shooting-naive","remote":true,"url":"/shooting","dataUrl":"/shooting.json","key":"cIWTEGvXs2"}],"key":"RjBPxDPe6e"},{"type":"paragraph","position":{"start":{"line":128,"column":1},"end":{"line":128,"column":1}},"children":[{"type":"text","value":"Let’s first examine the shooting approach for the ","key":"s2evMHaoua"},{"type":"abbreviation","title":"two-point boundary-value problem","children":[{"type":"text","value":"TPBVP","key":"YbE5qCRIeE"}],"key":"gOz2awLPDV"},{"type":"text","value":" from ","key":"qj9JDRVcUG"},{"type":"crossReference","kind":"proof:example","identifier":"example-tpbvp-mems","label":"example-tpbvp-mems","children":[{"type":"text","value":"Example ","key":"Io58uETvVS"},{"type":"text","value":"10.1.2","key":"OWgFFMjvaC"}],"template":"Example %s","enumerator":"10.1.2","resolved":true,"html_id":"example-tpbvp-mems","remote":true,"url":"/tpbvp","dataUrl":"/tpbvp.json","key":"t2YxFAajh2"},{"type":"text","value":" with ","position":{"start":{"line":128,"column":1},"end":{"line":128,"column":1}},"key":"GJ4ZA35360"},{"type":"inlineMath","value":"\\lambda=0.6","position":{"start":{"line":128,"column":1},"end":{"line":128,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>λ</mi><mo>=</mo><mn>0.6</mn></mrow><annotation encoding=\"application/x-tex\">\\lambda=0.6</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">λ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0.6</span></span></span></span>","key":"MFrMVYxtwQ"},{"type":"text","value":".","position":{"start":{"line":128,"column":1},"end":{"line":128,"column":1}},"key":"nlpL3uaSWN"}],"key":"ceBxWcNFgM"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"lambda = 0.6;\nphi = @(r, w, dwdr) lambda ./ w.^2 - dwdr ./ r;","key":"hAst9KceCV"},{"type":"output","id":"XsbUyx1zXwbc4DhsVsonT","data":[],"key":"pmRzaPGMo6"}],"key":"XSdBGshCnS"},{"type":"paragraph","position":{"start":{"line":135,"column":1},"end":{"line":135,"column":1}},"children":[{"type":"text","value":"We convert the ","key":"sI6sZgAeMW"},{"type":"abbreviation","title":"ordinary differential equation","children":[{"type":"text","value":"ODE","key":"QAKHJIyB7x"}],"key":"yIHLxkjP1Y"},{"type":"text","value":" to a first-order system in order to apply a numerical method. We also have to truncate the domain to avoid division by zero.","key":"YJ0whBe89r"}],"key":"KRLXWEnumh"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"f = @(r, w) [ w(2); phi(r, w(1), w(2)) ];\na = eps;  b = 1;","key":"TPjC18LUk6"},{"type":"output","id":"Zfjc1rLDxPwz1YL-Um-lw","data":[],"key":"nr6f8qOgys"}],"key":"DDDRO0uzdg"},{"type":"paragraph","position":{"start":{"line":142,"column":1},"end":{"line":142,"column":1}},"children":[{"type":"text","value":"The ","key":"zi8vNv9bqf"},{"type":"abbreviation","title":"boundary-value problem","children":[{"type":"text","value":"BVP","key":"fUV7mQSEtR"}],"key":"QUSoI9rSt7"},{"type":"text","value":" specifies ","key":"WE7hx8k9uT"},{"type":"inlineMath","value":"w'(0)=y_2(0)=0","position":{"start":{"line":142,"column":1},"end":{"line":142,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>w</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo stretchy=\"false\">(</mo><mn>0</mn><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mi>y</mi><mn>2</mn></msub><mo stretchy=\"false\">(</mo><mn>0</mn><mo stretchy=\"false\">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">w&#x27;(0)=y_2(0)=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0019em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"ghVRjCJUrC"},{"type":"text","value":". We can try multiple values for the unknown ","position":{"start":{"line":142,"column":1},"end":{"line":142,"column":1}},"key":"UKo6SmESBQ"},{"type":"inlineMath","value":"w(0)=y_1(0)","position":{"start":{"line":142,"column":1},"end":{"line":142,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>w</mi><mo stretchy=\"false\">(</mo><mn>0</mn><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mi>y</mi><mn>1</mn></msub><mo stretchy=\"false\">(</mo><mn>0</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">w(0)=y_1(0)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mclose\">)</span></span></span></span>","key":"xeHZhaS7pa"},{"type":"text","value":" and plot the solutions.","position":{"start":{"line":142,"column":1},"end":{"line":142,"column":1}},"key":"GQhH9tED32"}],"key":"TJRfUcMccW"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf\nivp = ode;\nivp.ODEFcn = f;\nivp.InitialTime = a;\nfor w0 = 0.4:0.1:0.9\n    ivp.InitialValue = [w0; 0];\n    sol = solve(ivp, a, b);\n    plot(sol.Time, sol.Solution(1, :))\n    hold on\nend\nxlabel('r'),  ylabel('w(r)')\ntitle('Solutions for multiple choices of w(0)')","key":"hZRXuHpOrY"},{"type":"output","id":"WMbK4LVE4hSXkRXWatQag","data":[{"output_type":"execute_result","execution_count":9,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"2a724c8686b081224720336c0e31833b","path":"/build/2a724c8686b081224720336c0e31833b.png"}}}],"key":"KbtFY36ZH4"}],"key":"zljIcERrlW"},{"type":"paragraph","position":{"start":{"line":159,"column":1},"end":{"line":159,"column":1}},"children":[{"type":"text","value":"On the graph, it’s the curve starting at ","position":{"start":{"line":159,"column":1},"end":{"line":159,"column":1}},"key":"vKmq4ceXsB"},{"type":"inlineMath","value":"w(0)=0.8","position":{"start":{"line":159,"column":1},"end":{"line":159,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>w</mi><mo stretchy=\"false\">(</mo><mn>0</mn><mo stretchy=\"false\">)</mo><mo>=</mo><mn>0.8</mn></mrow><annotation encoding=\"application/x-tex\">w(0)=0.8</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0.8</span></span></span></span>","key":"JbYupwnWBe"},{"type":"text","value":" that comes closest to the required condition ","position":{"start":{"line":159,"column":1},"end":{"line":159,"column":1}},"key":"xJ8fXKC1ky"},{"type":"inlineMath","value":"w(1)=1","position":{"start":{"line":159,"column":1},"end":{"line":159,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>w</mi><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">w(1)=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"Huc7q0rHVl"},{"type":"text","value":", but it’s a bit too large.","position":{"start":{"line":159,"column":1},"end":{"line":159,"column":1}},"key":"rWPavof0rc"}],"key":"IQOOkDsl8p"}],"label":"demo-shooting-naive-matlab","identifier":"demo-shooting-naive-matlab","html_id":"demo-shooting-naive-matlab","key":"nT4TxfGT0K"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-shooting-mems","label":"demo-shooting-mems","kind":"proof:example","position":{"start":{"line":163,"column":1},"end":{"line":163,"column":20}},"children":[{"type":"text","value":"Example ","key":"yNYkflqwVt"},{"type":"text","value":"10.2.2","key":"ceRH4P3IiC"}],"template":"Example %s","enumerator":"10.2.2","resolved":true,"html_id":"demo-shooting-mems","remote":true,"url":"/shooting","dataUrl":"/shooting.json","key":"Hbv6Ipaoqe"}],"key":"hmEhfvnuxo"},{"type":"paragraph","position":{"start":{"line":165,"column":1},"end":{"line":165,"column":1}},"children":[{"type":"text","value":"We revisit ","position":{"start":{"line":165,"column":1},"end":{"line":165,"column":1}},"key":"FVnFxtzRGy"},{"type":"crossReference","kind":"proof:example","identifier":"demo-shooting-naive","label":"demo-shooting-naive","children":[{"type":"text","value":"Demo ","key":"JgWEjMP4bW"},{"type":"text","value":"10.2.1","key":"JvxMT0WjCm"}],"template":"Example %s","enumerator":"10.2.1","resolved":true,"html_id":"demo-shooting-naive","remote":true,"url":"/shooting","dataUrl":"/shooting.json","key":"fDl3JPNj9J"},{"type":"text","value":" but let ","position":{"start":{"line":165,"column":1},"end":{"line":165,"column":1}},"key":"FBF7BoMLTi"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-shoot","label":"function-shoot","children":[{"type":"text","value":"Function ","key":"BYBHPVtLDk"},{"type":"text","value":"10.2.1","key":"sB5F6Vglxj"}],"template":"Algorithm %s","enumerator":"10.2.1","resolved":true,"html_id":"function-shoot","remote":true,"url":"/shooting","dataUrl":"/shooting.json","key":"dQCMuVYM6p"},{"type":"text","value":" do the heavy lifting.","position":{"start":{"line":165,"column":1},"end":{"line":165,"column":1}},"key":"EdqHLPbdAE"}],"key":"QTaOIH76AA"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"lambda = 0.6;\nphi = @(r, w, dwdr) lambda ./ w.^2 - dwdr ./ r;   \na = eps;  b = 1;    % avoid r=0 in denominator","key":"goRMwP2Nuj"},{"type":"output","id":"KH7z71mrvz61d88gpLx0A","data":[],"key":"s4LdEVgYO5"}],"key":"ubEagZbPr7"},{"type":"paragraph","position":{"start":{"line":173,"column":1},"end":{"line":173,"column":1}},"children":[{"type":"text","value":"We specify the given and unknown endpoint values.","position":{"start":{"line":173,"column":1},"end":{"line":173,"column":1}},"key":"Puvx43fc0e"}],"key":"e6OWxUoOlc"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"ga = @(u, du) du;\ngb = @(u, du) u - 1;","key":"nEZvbu5gh5"},{"type":"output","id":"pg8ks8R8YhAjh-TgH_rAj","data":[],"key":"J2nzA3doLY"}],"key":"jq91OQKSut"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"init = [0.8; 0];    % initial guess for u(a) and u'(a)\n[r, w, dwdx] = shoot(phi, a, b, ga, gb, init, 1e-5);\nclf,  plot(r, w)\ntitle('Correct solution')\nxlabel('r'),  ylabel('w(r)')","key":"fjYyPmy8V9"},{"type":"output","id":"l-z6vS-M4veca888N49Kw","data":[{"output_type":"execute_result","execution_count":12,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"0f70804a95c4163740560fa9f125a96d","path":"/build/0f70804a95c4163740560fa9f125a96d.png"}}}],"key":"dh4ftdLsbi"}],"key":"fQ0qrqycNW"},{"type":"paragraph","position":{"start":{"line":188,"column":1},"end":{"line":188,"column":1}},"children":[{"type":"text","value":"The value of ","position":{"start":{"line":188,"column":1},"end":{"line":188,"column":1}},"key":"Pica3pNUAq"},{"type":"inlineMath","value":"w","position":{"start":{"line":188,"column":1},"end":{"line":188,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>w</mi></mrow><annotation encoding=\"application/x-tex\">w</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span></span></span></span>","key":"aJWO5LDG1w"},{"type":"text","value":" at ","position":{"start":{"line":188,"column":1},"end":{"line":188,"column":1}},"key":"KGZ9OqTebX"},{"type":"inlineMath","value":"r=1","position":{"start":{"line":188,"column":1},"end":{"line":188,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>r</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">r=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"JZwVy1cUq2"},{"type":"text","value":", meant to be exactly one, was computed to be","position":{"start":{"line":188,"column":1},"end":{"line":188,"column":1}},"key":"NxMMQMlU91"}],"key":"VEEU2ZR0f1"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"format long\nw(end)","key":"YWvY0fDNUp"},{"type":"output","id":"lAQUhU0_7bCH37tJzOZxM","data":[{"output_type":"execute_result","execution_count":13,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = \n   1.000000260413213\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = \n   1.000000260413213\n","content_type":"text/plain"}}}],"key":"bA3ysVrc4k"}],"key":"x2CbZAfhKI"},{"type":"paragraph","position":{"start":{"line":195,"column":1},"end":{"line":195,"column":1}},"children":[{"type":"text","value":"The accuracy is consistent with the error tolerance used for the ","key":"lFQXcjxG9x"},{"type":"abbreviation","title":"initial-value problem","children":[{"type":"text","value":"IVP","key":"YtKmvKWz6W"}],"key":"fegxtfnZc9"},{"type":"text","value":" solution. The initial value ","key":"aGk7P1Xmu6"},{"type":"inlineMath","value":"w(0)","position":{"start":{"line":195,"column":1},"end":{"line":195,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>w</mi><mo stretchy=\"false\">(</mo><mn>0</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">w(0)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mclose\">)</span></span></span></span>","key":"UN7JHCXMOA"},{"type":"text","value":" that gave this solution is","position":{"start":{"line":195,"column":1},"end":{"line":195,"column":1}},"key":"KBAF8nhOqW"}],"key":"is7lQDyLee"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"w(1)","key":"eEr8nGJIU5"},{"type":"output","id":"dR6kWG6wjaJn4nGRcVnVG","data":[{"output_type":"execute_result","execution_count":14,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = \n   0.787758137853413\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = \n   0.787758137853413\n","content_type":"text/plain"}}}],"key":"IMxlK9PPak"}],"key":"i2sQv61FoS"}],"label":"demo-shooting-mems-matlab","identifier":"demo-shooting-mems-matlab","html_id":"demo-shooting-mems-matlab","key":"tEUsrvyGQy"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-shooting-unstable","label":"demo-shooting-unstable","kind":"proof:example","position":{"start":{"line":203,"column":1},"end":{"line":203,"column":24}},"children":[{"type":"text","value":"Example ","key":"SeAJi5tOuM"},{"type":"text","value":"10.2.3","key":"vTF7j3nZ5j"}],"template":"Example %s","enumerator":"10.2.3","resolved":true,"html_id":"demo-shooting-unstable","remote":true,"url":"/shooting","dataUrl":"/shooting.json","key":"fSKpVQC4DF"}],"key":"Cs9qLut4E8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"ga = @(u, du) u + 1;\ngb = @(u, du) u;\nclf\nwarning off\nfor lambda = 16:4:28\n    phi = @(x, u, du_dx) lambda^2 * (u + 1);\n    [x, u, du_dx] = shoot(phi, 0.0, 1.0, ga, gb, [-1; 0], 1e-8);\n    plot(x, u, displayname=sprintf(\"lambda=%d\", lambda))\n    hold on\n    xlabel('x'),  ylabel('u(x)')\n    title('Shooting instability')\n    legend(location=\"northwest\");\nend","visibility":"show","key":"yzABl0jGrC"},{"type":"output","id":"-_ZzIECayUhhQawnmCk8r","data":[{"output_type":"execute_result","execution_count":15,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"da0d41384db91658d8fa3e1a12f9d630","path":"/build/da0d41384db91658d8fa3e1a12f9d630.png"}}},{"output_type":"stream","name":"stderr","text":"Error using shoot/objective (line 27)\nError setting property 'InitialValue' of class 'ode'. Value must be finite.\n\nError in levenberg (line 27)\n    xnew = x(:,k) + s;   fnew = f(xnew);\n\nError in shoot (line 34)\ns = levenberg(@objective, init, tol);"}],"visibility":"show","key":"vEoatcHVQK"}],"data":{"tags":["raises-exception"]},"visibility":"show","key":"pvpb858p4A"},{"type":"paragraph","position":{"start":{"line":223,"column":1},"end":{"line":223,"column":1}},"children":[{"type":"text","value":"The numerical solution fails at the largest value of ","position":{"start":{"line":223,"column":1},"end":{"line":223,"column":1}},"key":"gy3nHxLxz5"},{"type":"text","value":"λ","position":{"start":{"line":223,"column":1},"end":{"line":223,"column":1}},"key":"zHuq5Exsah"},{"type":"text","value":" because the initial condition became infinite.","position":{"start":{"line":223,"column":1},"end":{"line":223,"column":1}},"key":"ERfS5JTrIQ"}],"key":"KLfByEIfkz"}],"label":"demo-shooting-unstable-matlab","identifier":"demo-shooting-unstable-matlab","html_id":"demo-shooting-unstable-matlab","key":"VH8kp0nYAf"},{"type":"heading","depth":3,"position":{"start":{"line":226,"column":1},"end":{"line":226,"column":1}},"children":[{"type":"text","value":"10.3 ","position":{"start":{"line":226,"column":1},"end":{"line":226,"column":1}},"key":"qtCCnAk4oc"},{"type":"link","identifier":"section-bvp-diffmats","label":"section-bvp-diffmats","kind":"narrative","position":{"start":{"line":226,"column":6},"end":{"line":226,"column":27}},"url":"/diffmats","internal":true,"dataUrl":"/diffmats.json","children":[{"type":"text","value":"Differentiation matrices","key":"tCpxda9UDU"}],"key":"WtGcUTtup0"}],"identifier":"id-10-3","label":"10.3 ","html_id":"id-10-3","implicit":true,"key":"C3pfMU1X9o"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-diffmats-2nd","label":"demo-diffmats-2nd","kind":"proof:example","position":{"start":{"line":228,"column":1},"end":{"line":228,"column":19}},"children":[{"type":"text","value":"Example ","key":"tIio9WW4qO"},{"type":"text","value":"10.3.2","key":"o9bvr97tHm"}],"template":"Example %s","enumerator":"10.3.2","resolved":true,"html_id":"demo-diffmats-2nd","remote":true,"url":"/diffmats","dataUrl":"/diffmats.json","key":"QhJNxS9Z3O"}],"key":"wcRPUtIIFG"},{"type":"paragraph","position":{"start":{"line":230,"column":1},"end":{"line":230,"column":1}},"children":[{"type":"text","value":"We test first-order and second-order differentiation matrices for the function ","position":{"start":{"line":230,"column":1},"end":{"line":230,"column":1}},"key":"onMSmDXVr8"},{"type":"inlineMath","value":"x + \\exp(\\sin 4x)","position":{"start":{"line":230,"column":1},"end":{"line":230,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mo>+</mo><mi>exp</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mi>sin</mi><mo>⁡</mo><mn>4</mn><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">x + \\exp(\\sin 4x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop\">exp</span><span class=\"mopen\">(</span><span class=\"mop\">sin</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">4</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span>","key":"ZVizPpWWVD"},{"type":"text","value":" over ","position":{"start":{"line":230,"column":1},"end":{"line":230,"column":1}},"key":"sVE04zBt5e"},{"type":"inlineMath","value":"[-1,1]","position":{"start":{"line":230,"column":1},"end":{"line":230,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mo>−</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[-1,1]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">−</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]</span></span></span></span>","key":"vmKbs5N2C0"},{"type":"text","value":".","position":{"start":{"line":230,"column":1},"end":{"line":230,"column":1}},"key":"wbK0G7uNBG"}],"key":"a8HNr6yOtB"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"f = @(x) x + exp(sin(4*x));","key":"EuaCQwWHbC"},{"type":"output","id":"1mLiD2xomWGlo7RKqH0Tb","data":[],"key":"oc4AasFCxo"}],"key":"gM3QqeN5HX"},{"type":"paragraph","position":{"start":{"line":236,"column":1},"end":{"line":236,"column":1}},"children":[{"type":"text","value":"For reference, here are the exact first and second derivatives.","position":{"start":{"line":236,"column":1},"end":{"line":236,"column":1}},"key":"y1qLRQyPfr"}],"key":"bHgjj1BfJ0"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"df_dx = @(x) 1 + 4 * exp(sin(4*x)) .* cos(4*x);\nd2f_dx2 = @(x) 4 * exp(sin(4*x)) .* (4*cos(4*x).^2 - 4*sin(4*x));","key":"hRu2gYmWhU"},{"type":"output","id":"43YAFHpK9E0PTCWX_C4aI","data":[],"key":"j33dEXzATh"}],"key":"aLIXHOTmnr"},{"type":"paragraph","position":{"start":{"line":243,"column":1},"end":{"line":243,"column":1}},"children":[{"type":"text","value":"We discretize on equally spaced nodes and evaluate ","position":{"start":{"line":243,"column":1},"end":{"line":243,"column":1}},"key":"KueYzErQ9j"},{"type":"inlineMath","value":"f","position":{"start":{"line":243,"column":1},"end":{"line":243,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>","key":"gN3ncFDxWn"},{"type":"text","value":" at the nodes.","position":{"start":{"line":243,"column":1},"end":{"line":243,"column":1}},"key":"lsigfQ2jsj"}],"key":"ytOIDe9ZdH"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[t, Dx, Dxx] = diffmat2(12, [-1 1]);\ny = f(t);","key":"EO744ciVfx"},{"type":"output","id":"njrccZNh6H2eA45Df7gOn","data":[],"key":"ZKzd3s6w1K"}],"key":"qvKlxkfUEd"},{"type":"paragraph","position":{"start":{"line":250,"column":1},"end":{"line":250,"column":1}},"children":[{"type":"text","value":"Then the first two derivatives of ","position":{"start":{"line":250,"column":1},"end":{"line":250,"column":1}},"key":"K0F18TJtl0"},{"type":"inlineMath","value":"f","position":{"start":{"line":250,"column":1},"end":{"line":250,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>","key":"R3VrixjTNd"},{"type":"text","value":" each require one matrix-vector multiplication.","position":{"start":{"line":250,"column":1},"end":{"line":250,"column":1}},"key":"GNKwUwBfzp"}],"key":"y1y9S1V0kV"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"yx = Dx * y;\nyxx = Dxx * y;","key":"b6BHmLAaZu"},{"type":"output","id":"mKhSzHh5INUPJIsmNApOR","data":[],"key":"cy69HSHNaM"}],"key":"asE93O5WCk"},{"type":"paragraph","position":{"start":{"line":257,"column":1},"end":{"line":257,"column":1}},"children":[{"type":"text","value":"The results show poor accuracy for this small value of ","position":{"start":{"line":257,"column":1},"end":{"line":257,"column":1}},"key":"CFwR8InvyB"},{"type":"inlineMath","value":"n","position":{"start":{"line":257,"column":1},"end":{"line":257,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"cb1RKJJvAs"},{"type":"text","value":".","position":{"start":{"line":257,"column":1},"end":{"line":257,"column":1}},"key":"QGDTNa7WCt"}],"key":"BPuqqp3Zwv"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf,  subplot(2, 1, 1)\nfplot(df_dx, [-1, 1]),  hold on\nplot(t, yx, 'ko')\nxlabel('x'),  ylabel('f''(x)')\nsubplot(2, 1, 2)\nfplot(d2f_dx2, [-1, 1]),  hold on\nplot(t, yxx, 'ko')\nxlabel('x'),  ylabel('f''''(x)')","key":"sFgngCrpHs"},{"type":"output","id":"-gzjg-KDuwUxRz-zQ0PN0","data":[{"output_type":"execute_result","execution_count":20,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"9a180deab0a31e5c5e99eb296731beb7","path":"/build/9a180deab0a31e5c5e99eb296731beb7.png"}}}],"key":"nFKXspBXBM"}],"key":"qV6Yq0IY0Y"},{"type":"paragraph","position":{"start":{"line":270,"column":1},"end":{"line":270,"column":1}},"children":[{"type":"text","value":"An convergence experiment confirms the order of accuracy. Because we expect an algebraic convergence rate, we use a log-log plot of the errors.","position":{"start":{"line":270,"column":1},"end":{"line":270,"column":1}},"key":"D3Lz8mZPIM"}],"key":"E9RZdbCbfq"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"n = round( 2 .^ (4:.5:11)' );\nerr = zeros(length(n), 2);\nfor k = 1:length(n)\n    [t, Dx, Dxx] = diffmat2(n(k), [-1, 1]);\n    y = f(t);\n    err(k, 1) = norm(df_dx(t) - Dx * y, Inf);\n    err(k, 2) = norm(d2f_dx2(t) - Dxx * y, Inf);\nend\nclf\nloglog(n, err, 'o-'), hold on\nloglog(n, 100 * n.^(-2), 'k--')\nlegend(\"f'\", \"f''\", '2nd order')\nxlabel('n'),  ylabel('max error')\ntitle('Convergence of finite differences')","key":"jSYPgFFkFa"},{"type":"output","id":"ogYksxAMdoEQJVcm-ZUcF","data":[{"output_type":"execute_result","execution_count":21,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"c2ecadc59041e143d1c64ba05dbae4c3","path":"/build/c2ecadc59041e143d1c64ba05dbae4c3.png"}}}],"key":"jPyhIxFUoN"}],"key":"y7EXm5FK87"}],"label":"demo-diffmats-2nd-matlab","identifier":"demo-diffmats-2nd-matlab","html_id":"demo-diffmats-2nd-matlab","key":"eOJGO6MEVU"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-diffmats-cheb","label":"demo-diffmats-cheb","kind":"proof:example","position":{"start":{"line":291,"column":1},"end":{"line":291,"column":20}},"children":[{"type":"text","value":"Example ","key":"nWrCuBTzxE"},{"type":"text","value":"10.3.3","key":"OAn6A1qu8C"}],"template":"Example %s","enumerator":"10.3.3","resolved":true,"html_id":"demo-diffmats-cheb","remote":true,"url":"/diffmats","dataUrl":"/diffmats.json","key":"uECAd8HzNd"}],"key":"R2jlVnKTV7"},{"type":"paragraph","position":{"start":{"line":293,"column":1},"end":{"line":293,"column":1}},"children":[{"type":"text","value":"Here is a ","position":{"start":{"line":293,"column":1},"end":{"line":293,"column":1}},"key":"trJDn79FNd"},{"type":"inlineMath","value":"4\\times 4","position":{"start":{"line":293,"column":1},"end":{"line":293,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>4</mn><mo>×</mo><mn>4</mn></mrow><annotation encoding=\"application/x-tex\">4\\times 4</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">4</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">4</span></span></span></span>","key":"biVq00jzNH"},{"type":"text","value":" Chebyshev differentiation matrix.","position":{"start":{"line":293,"column":1},"end":{"line":293,"column":1}},"key":"W7tvOStpWx"}],"key":"piojaMgHyD"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[t, Dx] = diffcheb(3, [-1, 1]);\nformat rat\nDx","key":"xV5Rgwypfi"},{"type":"output","id":"k-TkVSUa-71PY5tf9owPk","data":[{"output_type":"execute_result","execution_count":22,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>Dx = \n     -19/6            4             -4/3            1/2     \n      -1              1/3            1             -1/3     \n       1/3           -1             -1/3            1       \n      -1/2            4/3           -4             19/6     \n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"Dx = \n     -19/6            4             -4/3            1/2     \n      -1              1/3            1             -1/3     \n       1/3           -1             -1/3            1       \n      -1/2            4/3           -4             19/6     \n","content_type":"text/plain"}}}],"key":"EYvaJiSDDE"}],"key":"EH9dziacFB"},{"type":"paragraph","position":{"start":{"line":301,"column":1},"end":{"line":301,"column":1}},"children":[{"type":"text","value":"We again test the convergence rate.","position":{"start":{"line":301,"column":1},"end":{"line":301,"column":1}},"key":"LoVFVKJhyy"}],"key":"wM7lOEGQYL"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"f = @(x) x + exp(sin(4*x));\ndf_dx = @(x) 1 + 4 * exp(sin(4*x)) .* cos(4*x);\nd2f_dx2 = @(x) 4 * exp(sin(4*x)) .* (4*cos(4*x).^2 - 4*sin(4*x));","key":"fpN2r9bkPr"},{"type":"output","id":"IzIuz3Vtw8pnBa7DVxJTr","data":[],"key":"tA4E0lTSFh"}],"key":"uR6BGvgArn"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"n = 5:5:70;\nerr = zeros(length(n), 2);\nfor k = 1:length(n)\n    [t, Dx, Dxx] = diffcheb(n(k), [-1, 1]);\n    y = f(t);\n    err(k, 1) = norm(df_dx(t) - Dx * y, Inf);\n    err(k, 2) = norm(d2f_dx2(t) - Dxx * y, Inf);\nend","key":"yc0mNJtN0j"},{"type":"output","id":"m715CXgxKjjOaZXGPvLgo","data":[],"key":"xazyveMr0M"}],"key":"UMI4uM4Imf"},{"type":"paragraph","position":{"start":{"line":321,"column":1},"end":{"line":321,"column":1}},"children":[{"type":"text","value":"Since we expect a spectral convergence rate, we use a semi-log plot for the error.","position":{"start":{"line":321,"column":1},"end":{"line":321,"column":1}},"key":"Qt3Q12ZaDC"}],"key":"wVxUBiBn4t"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf,  format\nsemilogy(n, err, 'o-'), hold on\nlegend(\"f'\", \"f''\")\nxlabel('n'),  ylabel('max error')\ntitle('Convergence of finite differences')","key":"VCyalEkAjj"},{"type":"output","id":"aRubqqvwR72qEh2TmrdB-","data":[{"output_type":"execute_result","execution_count":25,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"e934ed8ebb5708eed8a23906727f63c7","path":"/build/e934ed8ebb5708eed8a23906727f63c7.png"}}}],"key":"sNudsl0CjA"}],"key":"WLe159hfwf"}],"label":"demo-diffmats-cheb-matlab","identifier":"demo-diffmats-cheb-matlab","html_id":"demo-diffmats-cheb-matlab","key":"Irhj7c3YCW"},{"type":"heading","depth":3,"position":{"start":{"line":332,"column":1},"end":{"line":332,"column":1}},"children":[{"type":"text","value":"10.4 ","position":{"start":{"line":332,"column":1},"end":{"line":332,"column":1}},"key":"JR0IIBlcpB"},{"type":"link","identifier":"section-bvp-linear","label":"section-bvp-linear","kind":"narrative","position":{"start":{"line":332,"column":6},"end":{"line":332,"column":25}},"url":"/linear","internal":true,"dataUrl":"/linear.json","children":[{"type":"text","value":"Collocation for linear problems","key":"iIKDfNy5lk"}],"key":"EFYwxya4zF"}],"identifier":"id-10-4","label":"10.4 ","html_id":"id-10-4","implicit":true,"key":"ytQ2Jz2mL0"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-linear-solve","label":"demo-linear-solve","kind":"proof:example","position":{"start":{"line":334,"column":1},"end":{"line":334,"column":19}},"children":[{"type":"text","value":"Example ","key":"dBZtM7lL4I"},{"type":"text","value":"10.4.2","key":"y8T4FzMPCf"}],"template":"Example %s","enumerator":"10.4.2","resolved":true,"html_id":"demo-linear-solve","remote":true,"url":"/linear","dataUrl":"/linear.json","key":"cCBkBTZEZh"}],"key":"xw2FXKjtH4"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"exact = @(x) exp(sin(x));","key":"iNaeuXx6Jr"},{"type":"output","id":"FNYY40Rmho-m1rY2TSYmq","data":[],"key":"TdE1bmDJAk"}],"key":"YdBIuNxUNM"},{"type":"paragraph","position":{"start":{"line":341,"column":1},"end":{"line":341,"column":1}},"children":[{"type":"text","value":"The problem is presented above in our standard form, so we can identify the coefficient functions in the ","key":"EjKBmcYJNi"},{"type":"abbreviation","title":"ordinary differential equation","children":[{"type":"text","value":"ODE","key":"LyWHa5rlfM"}],"key":"Itpay55l0e"},{"type":"text","value":". Each should be coded as a function.","key":"S7Y2QouLYv"}],"key":"kc8WcIq3ez"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"p = @(x) -cos(x);\nq = @(x) sin(x);\nr = @(x) 0*x;      % not a scalar","key":"u5Cky03eWW"},{"type":"output","id":"AA4LmEhLOKigXj5M7U03h","data":[],"key":"WdTRordWre"}],"key":"thV5r6vPkp"},{"type":"paragraph","position":{"start":{"line":349,"column":1},"end":{"line":349,"column":1}},"children":[{"type":"text","value":"We solve the ","key":"HW0gm3HsI5"},{"type":"abbreviation","title":"boundary-value problem","children":[{"type":"text","value":"BVP","key":"KIpxaNCDkZ"}],"key":"dEcGwGixnL"},{"type":"text","value":" and compare the result to the exact solution.","key":"D3adUIvoTO"}],"key":"nEto8s4jQz"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[x, u] = bvplin(p, q, r, 0, 3*pi/2, 1, exp(-1), 30);","key":"IMnON2rPrd"},{"type":"output","id":"NFYKlxtH2VUHZ8wh3xX_k","data":[],"key":"LDdxVk5Gvy"}],"key":"OhkPWvO3Fm"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf,  subplot(2, 1, 1)\nplot(x, u)\nylabel('solution')\ntitle('Solution of a linear BVP')\nsubplot(2, 1, 2)\nplot(x, exact(x) - u, 'o-')\nylabel('error')","key":"rtYY6lyDQc"},{"type":"output","id":"-ooOVCSvuiOM03J5bzmAf","data":[{"output_type":"execute_result","execution_count":29,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"6e80e6b89c82ff5b51779178e0901bae","path":"/build/6e80e6b89c82ff5b51779178e0901bae.png"}}}],"key":"jgkpIDFhdW"}],"key":"hPqIooX7R2"}],"label":"demo-linear-solve-matlab","identifier":"demo-linear-solve-matlab","html_id":"demo-linear-solve-matlab","key":"LaZxmya7W5"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-linear-converge","label":"demo-linear-converge","kind":"proof:example","position":{"start":{"line":367,"column":1},"end":{"line":367,"column":22}},"children":[{"type":"text","value":"Example ","key":"ZUn9tZgvZL"},{"type":"text","value":"10.4.3","key":"FU65MYlpPT"}],"template":"Example %s","enumerator":"10.4.3","resolved":true,"html_id":"demo-linear-converge","remote":true,"url":"/linear","dataUrl":"/linear.json","key":"Eu43lEaPE1"}],"key":"ZzGITS79LA"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"lambda = 10;\nexact = @(x) sinh(lambda * x) / sinh(lambda) - 1;","key":"qDWaiKtX7S"},{"type":"output","id":"HPPUugw3sNzOyHX_gUEVb","data":[],"key":"WGxzxYkiDw"}],"key":"bgyAMXdDVB"},{"type":"paragraph","position":{"start":{"line":376,"column":1},"end":{"line":376,"column":1}},"children":[{"type":"text","value":"The following functions define the ","key":"e0CzrgJ78G"},{"type":"abbreviation","title":"ordinary differential equation","children":[{"type":"text","value":"ODE","key":"t2sfxi7sqd"}],"key":"yoPDIsSMii"},{"type":"text","value":".","key":"hVVM1ILCRz"}],"key":"uO68T4moMv"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"p = @(x) zeros(size(x));            \nq = @(x) -lambda^2 * ones(size(x));\nr = @(x) lambda^2 * ones(size(x));","key":"D7EWrim15j"},{"type":"output","id":"qSd8DLKY8gXjvY3aeyrtT","data":[],"key":"DrEw6ZyzZi"}],"key":"RRz62iAZna"},{"type":"paragraph","position":{"start":{"line":384,"column":1},"end":{"line":384,"column":1}},"children":[{"type":"text","value":"We compare the computed solution to the exact one for increasing ","position":{"start":{"line":384,"column":1},"end":{"line":384,"column":1}},"key":"DFtLbnLT1g"},{"type":"inlineMath","value":"n","position":{"start":{"line":384,"column":1},"end":{"line":384,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"nJWdz0tKwU"},{"type":"text","value":".","position":{"start":{"line":384,"column":1},"end":{"line":384,"column":1}},"key":"eaQfeImVLS"}],"key":"mWqmYBm0eU"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"p = @(x) zeros(size(x));            \nq = @(x) -lambda^2 * ones(size(x));\nr = @(x) lambda^2 * ones(size(x));\nn = 2 * round(10.^(1:0.25:3)');\nerr = zeros(size(n));\nfor k = 1:length(n)\n    [x, u] = bvplin(p, q, r, 0, 1, -1, 0, n(k));\n    err(k) = norm(exact(x) - u, Inf);\nend\ntable(n, err, variableNames = [\"n\", \"inf-norm error\"])","key":"yeZrwfjdpD"},{"type":"output","id":"GpSUvIZ_6mLKHui_b2ChM","data":[{"output_type":"execute_result","execution_count":32,"metadata":{},"data":{"text/html":{"content":"<html><head><style>.mwBasicVariableOutputWrapper .mwBasicVariableOutputHeader {font-style: italic;}</style></head><body><div class='mwBasicVariableOutputWrapper'><div>ans = <span class='mwBasicVariableOutputHeader'>9x2 table</span></div><table><thead><tr><th>n</th><th>inf-norm error</th></tr></thead><tbody><tr><td>20</td><td>0.0037</td></tr><tr><td>36</td><td>0.0012</td></tr><tr><td>64</td><td>3.7262e-04</td></tr><tr><td>112</td><td>1.2209e-04</td></tr><tr><td>200</td><td>3.8312e-05</td></tr><tr><td>356</td><td>1.2093e-05</td></tr><tr><td>632</td><td>3.8375e-06</td></tr><tr><td>1124</td><td>1.2133e-06</td></tr><tr><td>2000</td><td>3.8321e-07</td></tr></tbody></table></div></body></html>","content_type":"text/html"},"text/plain":{"content":"<html><head><style>.mwBasicVariableOutputWrapper .mwBasicVariableOutputHeader {font-style: italic;}</style></head><body><div class='mwBasicVariableOutputWrapper'><div>ans = <span class='mwBasicVariableOutputHeader'>9x2 table</span></div><table><thead><tr><th>n</th><th>inf-norm error</th></tr></thead><tbody><tr><td>20</td><td>0.0037</td></tr><tr><td>36</td><td>0.0012</td></tr><tr><td>64</td><td>3.7262e-04</td></tr><tr><td>112</td><td>1.2209e-04</td></tr><tr><td>200</td><td>3.8312e-05</td></tr><tr><td>356</td><td>1.2093e-05</td></tr><tr><td>632</td><td>3.8375e-06</td></tr><tr><td>1124</td><td>1.2133e-06</td></tr><tr><td>2000</td><td>3.8321e-07</td></tr></tbody></table></div></body></html>","content_type":"text/plain"}}}],"key":"N1wxNhTB1M"}],"key":"XVbak9dv4r"},{"type":"paragraph","position":{"start":{"line":399,"column":1},"end":{"line":399,"column":1}},"children":[{"type":"text","value":"Each factor of 10 in ","position":{"start":{"line":399,"column":1},"end":{"line":399,"column":1}},"key":"fzT8FvypHz"},{"type":"inlineMath","value":"n","position":{"start":{"line":399,"column":1},"end":{"line":399,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"SEz0y1F88m"},{"type":"text","value":" reduces error by a factor of 100, which is indicative of second-order convergence.","position":{"start":{"line":399,"column":1},"end":{"line":399,"column":1}},"key":"YSlmm3kjcp"}],"key":"FVqqbWNYem"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf,  loglog(n, err, 'o-')\nhold on, loglog(n, n.^(-2), 'k--')\nxlabel('n'),  ylabel('max error')\ntitle('Convergence for a linear BVP') \nlegend('obs. error', '2nd order')","key":"QppCYwCqLM"},{"type":"output","id":"ek-YwLeihfhOJmR-glRM5","data":[{"output_type":"execute_result","execution_count":33,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"e8c68997a59043e35b92bd89a62110b3","path":"/build/e8c68997a59043e35b92bd89a62110b3.png"}}}],"key":"NQeshDiS4k"}],"key":"dVHVSsMGfN"}],"label":"demo-linear-converge-matlab","identifier":"demo-linear-converge-matlab","html_id":"demo-linear-converge-matlab","key":"d3bvK9jwsn"},{"type":"heading","depth":3,"position":{"start":{"line":410,"column":1},"end":{"line":410,"column":1}},"children":[{"type":"text","value":"10.5 ","position":{"start":{"line":410,"column":1},"end":{"line":410,"column":1}},"key":"UNcsxnwx48"},{"type":"link","identifier":"section-bvp-nonlinear","label":"section-bvp-nonlinear","kind":"narrative","position":{"start":{"line":410,"column":6},"end":{"line":410,"column":28}},"url":"/nonlinear","internal":true,"dataUrl":"/nonlinear.json","children":[{"type":"text","value":"Nonlinearity and boundary conditions","key":"qeOUPdca7p"}],"key":"yexJJw3zNB"}],"identifier":"id-10-5","label":"10.5 ","html_id":"id-10-5","implicit":true,"key":"Wf6wqRSeAE"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-nonlinear-pendulum","label":"demo-nonlinear-pendulum","kind":"proof:example","position":{"start":{"line":412,"column":1},"end":{"line":412,"column":25}},"children":[{"type":"text","value":"Example ","key":"HLtf83inum"},{"type":"text","value":"10.5.2","key":"wG6Zm1bCh1"}],"template":"Example %s","enumerator":"10.5.2","resolved":true,"html_id":"demo-nonlinear-pendulum","remote":true,"url":"/nonlinear","dataUrl":"/nonlinear.json","key":"PB1kZIpweb"}],"key":"FveIddmNhw"},{"type":"paragraph","position":{"start":{"line":414,"column":1},"end":{"line":414,"column":1}},"children":[{"type":"text","value":"Suppose a damped pendulum satisfies the nonlinear equation ","position":{"start":{"line":414,"column":1},"end":{"line":414,"column":1}},"key":"rqJEPwS7fU"},{"type":"inlineMath","value":"\\theta'' + 0.05\\theta'+\\sin \\theta =0","position":{"start":{"line":414,"column":1},"end":{"line":414,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>θ</mi><mrow><mo mathvariant=\"normal\">′</mo><mo mathvariant=\"normal\">′</mo></mrow></msup><mo>+</mo><mn>0.05</mn><msup><mi>θ</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo>+</mo><mi>sin</mi><mo>⁡</mo><mi>θ</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">\\theta&#x27;&#x27; + 0.05\\theta&#x27;+\\sin \\theta =0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8352em;vertical-align:-0.0833em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′′</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8352em;vertical-align:-0.0833em;\"></span><span class=\"mord\">0.05</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mop\">sin</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"D5saI3JhAC"},{"type":"text","value":". We want to start the pendulum at ","position":{"start":{"line":414,"column":1},"end":{"line":414,"column":1}},"key":"PW9c4nv9YL"},{"type":"inlineMath","value":"\\theta=2.5","position":{"start":{"line":414,"column":1},"end":{"line":414,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>θ</mi><mo>=</mo><mn>2.5</mn></mrow><annotation encoding=\"application/x-tex\">\\theta=2.5</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2.5</span></span></span></span>","key":"RJ6sVBfoNI"},{"type":"text","value":" and give it the right initial velocity so that it reaches ","position":{"start":{"line":414,"column":1},"end":{"line":414,"column":1}},"key":"Bm8fF0amlz"},{"type":"inlineMath","value":"\\theta=-2","position":{"start":{"line":414,"column":1},"end":{"line":414,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>θ</mi><mo>=</mo><mo>−</mo><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">\\theta=-2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">−</span><span class=\"mord\">2</span></span></span></span>","key":"qXF4Mm6VnT"},{"type":"text","value":" at exactly ","position":{"start":{"line":414,"column":1},"end":{"line":414,"column":1}},"key":"ZzpnfR3ck3"},{"type":"inlineMath","value":"t=5","position":{"start":{"line":414,"column":1},"end":{"line":414,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi><mo>=</mo><mn>5</mn></mrow><annotation encoding=\"application/x-tex\">t=5</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">5</span></span></span></span>","key":"adC1PWg08I"},{"type":"text","value":". This is a boundary-value problem with Dirichlet conditions ","position":{"start":{"line":414,"column":1},"end":{"line":414,"column":1}},"key":"WIJu6fHYs0"},{"type":"inlineMath","value":"\\theta(0)=2.5","position":{"start":{"line":414,"column":1},"end":{"line":414,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>θ</mi><mo stretchy=\"false\">(</mo><mn>0</mn><mo stretchy=\"false\">)</mo><mo>=</mo><mn>2.5</mn></mrow><annotation encoding=\"application/x-tex\">\\theta(0)=2.5</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2.5</span></span></span></span>","key":"Xql5wioxBk"},{"type":"text","value":" and ","position":{"start":{"line":414,"column":1},"end":{"line":414,"column":1}},"key":"JFsXsUq9ra"},{"type":"inlineMath","value":"\\theta(5)=-2","position":{"start":{"line":414,"column":1},"end":{"line":414,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>θ</mi><mo stretchy=\"false\">(</mo><mn>5</mn><mo stretchy=\"false\">)</mo><mo>=</mo><mo>−</mo><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">\\theta(5)=-2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"mopen\">(</span><span class=\"mord\">5</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">−</span><span class=\"mord\">2</span></span></span></span>","key":"i4P7xxH32h"},{"type":"text","value":".","position":{"start":{"line":414,"column":1},"end":{"line":414,"column":1}},"key":"NKsXEbfODk"}],"key":"haIL6mgFsU"},{"type":"paragraph","position":{"start":{"line":416,"column":1},"end":{"line":416,"column":1}},"children":[{"type":"text","value":"The first step is to define the function ","position":{"start":{"line":416,"column":1},"end":{"line":416,"column":1}},"key":"J1xZsX3yIV"},{"type":"text","value":"ϕ","position":{"start":{"line":416,"column":1},"end":{"line":416,"column":1}},"key":"yNyufvaDE2"},{"type":"text","value":" that equals ","position":{"start":{"line":416,"column":1},"end":{"line":416,"column":1}},"key":"z46rMXJGoK"},{"type":"inlineMath","value":"\\theta''","position":{"start":{"line":416,"column":1},"end":{"line":416,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>θ</mi><mrow><mo mathvariant=\"normal\">′</mo><mo mathvariant=\"normal\">′</mo></mrow></msup></mrow><annotation encoding=\"application/x-tex\">\\theta&#x27;&#x27;</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′′</span></span></span></span></span></span></span></span></span></span></span></span>","key":"LvUHUWlZai"},{"type":"text","value":".","position":{"start":{"line":416,"column":1},"end":{"line":416,"column":1}},"key":"GiRKDhUixG"}],"key":"FXSBOwVKGn"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"phi = @(t,theta,omega) -0.05 * omega - sin(theta);","key":"AitzFzHdlz"},{"type":"output","id":"tWHxxzTxx1tU90v5w9so3","data":[],"key":"FyjRoz6cjT"}],"key":"OxgfS7QKNT"},{"type":"paragraph","position":{"start":{"line":422,"column":1},"end":{"line":422,"column":1}},"children":[{"type":"text","value":"Next, we define the boundary conditions.","position":{"start":{"line":422,"column":1},"end":{"line":422,"column":1}},"key":"PKu7q3CwWM"}],"key":"ZuXZhmY40K"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"ga = @(u, du) u - 2.5;\ngb = @(u, du) u + 2;","key":"mPhoUVCeGL"},{"type":"output","id":"0rd-EVlVbxamXZemflBN1","data":[],"key":"WqwbAVu0Z3"}],"key":"MMnkMKBdGK"},{"type":"paragraph","position":{"start":{"line":429,"column":1},"end":{"line":429,"column":1}},"children":[{"type":"text","value":"The last ingredient is an initial estimate of the solution. Here we choose ","position":{"start":{"line":429,"column":1},"end":{"line":429,"column":1}},"key":"ubPsQc1b3K"},{"type":"inlineMath","value":"n=100","position":{"start":{"line":429,"column":1},"end":{"line":429,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>=</mo><mn>100</mn></mrow><annotation encoding=\"application/x-tex\">n=100</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">100</span></span></span></span>","key":"jDTpvUkMTO"},{"type":"text","value":" and a linear function between the endpoint values.","position":{"start":{"line":429,"column":1},"end":{"line":429,"column":1}},"key":"we4EZRSrZO"}],"key":"TBOPDoMBBc"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"init = linspace(2.5, -2, 101)';","key":"ByyurPKli1"},{"type":"output","id":"t1bGC7pkDhaQ5-qwMMhyj","data":[],"key":"LKsKkpYBa0"}],"key":"EqXAvVadaW"},{"type":"paragraph","position":{"start":{"line":435,"column":1},"end":{"line":435,"column":1}},"children":[{"type":"text","value":"We find a solution with negative initial slope, i.e., the pendulum is initially pushed back toward equilibrium.","position":{"start":{"line":435,"column":1},"end":{"line":435,"column":1}},"key":"Vr27GRrbQh"}],"key":"taswQG0DkJ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[t, theta] = bvp(phi, 0, 5, ga, gb, init);\nclf,  plot(t, theta)\nxlabel('t'),  ylabel('\\theta(t)')\ntitle('Pendulum over [0,5]')","key":"fpdhgnfVZJ"},{"type":"output","id":"BgcrYXsMpddmKk2z-vEHl","data":[{"output_type":"execute_result","execution_count":37,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"0c80b2eac5fe076c8cb3d54892ea0297","path":"/build/0c80b2eac5fe076c8cb3d54892ea0297.png"}}}],"key":"rmBSxVCJ5C"}],"key":"Vrr20aBfuY"},{"type":"paragraph","position":{"start":{"line":444,"column":1},"end":{"line":444,"column":1}},"children":[{"type":"text","value":"If we extend the time interval longer for the same boundary values, then the initial slope must adjust.","position":{"start":{"line":444,"column":1},"end":{"line":444,"column":1}},"key":"hUt7rLZ5MH"}],"key":"vn80I1j5RQ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[t, theta] = bvp(phi, 0, 8, ga, gb, init);\nplot(t,theta)\nxlabel('t'),  ylabel('\\theta(t)')\ntitle('Pendulum over [0,8]')","key":"inoLF92oN2"},{"type":"output","id":"Y_7MFtkp_2O7SG_fvq_iZ","data":[{"output_type":"execute_result","execution_count":38,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"2b2c0e2f7e2ad970792499d18e379bc3","path":"/build/2b2c0e2f7e2ad970792499d18e379bc3.png"}}}],"key":"tkjhKvEVcx"}],"key":"I772rA34r6"},{"type":"paragraph","position":{"start":{"line":453,"column":1},"end":{"line":453,"column":1}},"children":[{"type":"text","value":"This time, the pendulum is initially pushed toward the unstable equilibrium in the upright vertical position before gravity pulls it back down.","position":{"start":{"line":453,"column":1},"end":{"line":453,"column":1}},"key":"uBcT4KsYOV"}],"key":"ADcE6IEgD8"}],"label":"demo-nonlinear-pendulum-matlab","identifier":"demo-nonlinear-pendulum-matlab","html_id":"demo-nonlinear-pendulum-matlab","key":"CFc8hhskn3"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-nonlinear-mems","label":"demo-nonlinear-mems","kind":"proof:example","position":{"start":{"line":457,"column":1},"end":{"line":457,"column":21}},"children":[{"type":"text","value":"Example ","key":"dKI0QMsLK1"},{"type":"text","value":"10.5.3","key":"fzH67N4omz"}],"template":"Example %s","enumerator":"10.5.3","resolved":true,"html_id":"demo-nonlinear-mems","remote":true,"url":"/nonlinear","dataUrl":"/nonlinear.json","key":"U0AvFArPAw"}],"key":"DtuxYnxfRL"},{"type":"paragraph","position":{"start":{"line":460,"column":1},"end":{"line":460,"column":1}},"children":[{"type":"text","value":"Here is the problem definition. We use a truncated domain to avoid division by zero at ","position":{"start":{"line":460,"column":1},"end":{"line":460,"column":1}},"key":"N15JkkviIq"},{"type":"inlineMath","value":"r=0","position":{"start":{"line":460,"column":1},"end":{"line":460,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>r</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">r=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"tXixDjN21t"},{"type":"text","value":".","position":{"start":{"line":460,"column":1},"end":{"line":460,"column":1}},"key":"Ht90gbNSqU"}],"key":"nUIbn05FkI"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"lambda = 0.5;\nphi = @(r,w,dwdr) lambda./w.^2 - dwdr./r;\nga = @(w, dw) dw;\ngb = @(w, dw) w - 1;\na = eps;  b = 1;","key":"aE1fzVBOgJ"},{"type":"output","id":"Gm2YuE4EkiJMgjxFpEdCJ","data":[],"key":"WH4PUDbLaC"}],"key":"DYmmSfxGxN"},{"type":"paragraph","position":{"start":{"line":470,"column":1},"end":{"line":470,"column":1}},"children":[{"type":"text","value":"First we try a constant function as the initialization.","position":{"start":{"line":470,"column":1},"end":{"line":470,"column":1}},"key":"dhCsvL05UP"}],"key":"Ysa50wXT72"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"init = ones(301, 1);\n[r, w1] = bvp(phi, a, b, ga, gb, init);\n\nclf,  plot(r, w1)\nxlabel('r'),  ylabel('w(r)')\ntitle('Solution of the MEMS BVP')","key":"mHVddx9ytw"},{"type":"output","id":"vRVmT-fPrL4D7jMKi65BH","data":[{"output_type":"execute_result","execution_count":40,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"05def3902d56488ce9a4d7476d937973","path":"/build/05def3902d56488ce9a4d7476d937973.png"}}}],"key":"I4fiRURKat"}],"key":"XxEhHd9lsF"},{"type":"paragraph","position":{"start":{"line":481,"column":1},"end":{"line":481,"column":1}},"children":[{"type":"text","value":"It’s not necessary that the initialization satisfy the boundary conditions. In fact, by choosing a different constant function as the initial guess, we arrive at another valid solution.","position":{"start":{"line":481,"column":1},"end":{"line":481,"column":1}},"key":"PmX4MRdzlf"}],"key":"N1A12Omioz"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"init = 0.5 * ones(301, 1);\n[r, w2] = bvp(phi, a, b, ga, gb, init);\nhold on,  plot(r, w2)\ntitle(\"Two solutions of the MEMS BVP\")","key":"fDrjyI0x9g"},{"type":"output","id":"B8bfzHoE6YWr2X54gX4sO","data":[{"output_type":"execute_result","execution_count":41,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"31656a90e6f4b0895e4807635529b4a8","path":"/build/31656a90e6f4b0895e4807635529b4a8.png"}}}],"key":"Tf0ZcifY07"}],"key":"pR0blEpS3m"}],"label":"demo-nonlinear-mems-matlab","identifier":"demo-nonlinear-mems-matlab","html_id":"demo-nonlinear-mems-matlab","key":"wF0tCgow6m"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-nonlinear-allencahn","label":"demo-nonlinear-allencahn","kind":"proof:example","position":{"start":{"line":492,"column":1},"end":{"line":492,"column":26}},"children":[{"type":"text","value":"Example ","key":"BjpAStjBih"},{"type":"text","value":"10.5.4","key":"cQVYumGHli"}],"template":"Example %s","enumerator":"10.5.4","resolved":true,"html_id":"demo-nonlinear-allencahn","remote":true,"url":"/nonlinear","dataUrl":"/nonlinear.json","key":"jn79MM7bY8"}],"key":"tQwkypORGL"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"epsilon = 0.05;\nphi = @(x, u, du_dx) (u.^3 - u) / epsilon;\nga = @(u, du) du;\ngb = @(u, du) u - 1;","key":"aflk4dxlle"},{"type":"output","id":"IHEyFKhLgJDHvaEQaVAex","data":[],"key":"tuWSG5G9G0"}],"key":"QwO83gFeTT"},{"type":"paragraph","position":{"start":{"line":502,"column":1},"end":{"line":502,"column":1}},"children":[{"type":"text","value":"Finding a solution is easy at larger values of ","position":{"start":{"line":502,"column":1},"end":{"line":502,"column":1}},"key":"gHbazGWNV4"},{"type":"text","value":"ε","position":{"start":{"line":502,"column":1},"end":{"line":502,"column":1}},"key":"rtkbLmbOUw"},{"type":"text","value":".","position":{"start":{"line":502,"column":1},"end":{"line":502,"column":1}},"key":"dcPVe7sqm1"}],"key":"f9fQ9I2ifW"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"init = linspace(-1, 1, 141)';\n[x, u1] = bvp(phi, 0, 1, ga, gb, init);\nclf,  plot(x, u1, displayname=\"\\epsilon = 0.05\")\nxlabel('x'),  ylabel('u(x)')\ntitle('Allen-Cahn solution') \nlegend(location=\"northwest\")","key":"cffxDiE88E"},{"type":"output","id":"PZ-5_FE3NIwZ9JrNlyF4t","data":[{"output_type":"execute_result","execution_count":43,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"6e074915d3cfa0ebac8843acf689cfcd","path":"/build/6e074915d3cfa0ebac8843acf689cfcd.png"}}}],"key":"knmwKpxNw0"}],"key":"DIoDZRag0N"},{"type":"paragraph","position":{"start":{"line":513,"column":1},"end":{"line":513,"column":1}},"children":[{"type":"text","value":"However, finding a good initialization is not trivial for smaller values of ","position":{"start":{"line":513,"column":1},"end":{"line":513,"column":1}},"key":"q2ESnMPIEV"},{"type":"text","value":"ε","position":{"start":{"line":513,"column":1},"end":{"line":513,"column":1}},"key":"d9PugbXoSt"},{"type":"text","value":". Note below that the iteration stops without converging to a solution.","position":{"start":{"line":513,"column":1},"end":{"line":513,"column":1}},"key":"me0euPrr8c"}],"key":"iLr6gIUhFI"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"epsilon = 0.002;\nphi = @(x, u, du_dx) (u.^3 - u) / epsilon;\n[x, z] = bvp(phi, 0, 1, ga, gb, init);","key":"BThtVojAvF"},{"type":"output","id":"P7m6LEN6KqTBQRqRjCzXZ","data":[],"key":"fotrefb5YR"}],"key":"zzbzxinBCH"},{"type":"paragraph","position":{"start":{"line":521,"column":1},"end":{"line":521,"column":1}},"children":[{"type":"text","value":"The iteration succeeds if we use the first solution instead as the initialization here.","position":{"start":{"line":521,"column":1},"end":{"line":521,"column":1}},"key":"FXGo8yGr2S"}],"key":"bUYB79pSWL"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[x, u2] = bvp(phi, 0, 1, ga, gb, u1);\nhold on,  plot(x, u2, displayname=\"\\epsilon = 0.002\")","key":"vLnKPXOsf2"},{"type":"output","id":"nnenLkNvAJAfF4l04yAfm","data":[{"output_type":"execute_result","execution_count":45,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"24e6476723cadd19ced8ea5551d00350","path":"/build/24e6476723cadd19ced8ea5551d00350.png"}}}],"key":"FYUQ3Sj4Ue"}],"key":"cru02JudmG"},{"type":"paragraph","position":{"start":{"line":528,"column":1},"end":{"line":528,"column":1}},"children":[{"type":"text","value":"In this case we can continue further.","position":{"start":{"line":528,"column":1},"end":{"line":528,"column":1}},"key":"BmNJmNyYip"}],"key":"Da6NJoCucw"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"epsilon = 0.0005;\nphi = @(x, u, du_dx) (u.^3 - u) / epsilon;\n[x, u3] = bvp(phi, 0, 1, ga, gb, u2);\nplot(x, u3, displayname=\"\\epsilon = 0.0005\")","key":"DXOLKPRNQj"},{"type":"output","id":"Isp7_YlXotvjmjew_9fPY","data":[{"output_type":"execute_result","execution_count":46,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"ede93e62c7e9b9f20cfee061347aa810","path":"/build/ede93e62c7e9b9f20cfee061347aa810.png"}}}],"key":"PZNfEYs5oB"}],"key":"d7MkdpkLPc"}],"label":"demo-nonlinear-allencahn-matlab","identifier":"demo-nonlinear-allencahn-matlab","html_id":"demo-nonlinear-allencahn-matlab","key":"Dsd1QADWF2"},{"type":"heading","depth":3,"position":{"start":{"line":539,"column":1},"end":{"line":539,"column":1}},"children":[{"type":"text","value":"10.6 ","position":{"start":{"line":539,"column":1},"end":{"line":539,"column":1}},"key":"JbVaJM9cTJ"},{"type":"link","identifier":"section-bvp-galerkin","label":"section-bvp-galerkin","kind":"narrative","position":{"start":{"line":539,"column":6},"end":{"line":539,"column":27}},"url":"/galerkin","internal":true,"dataUrl":"/galerkin.json","children":[{"type":"text","value":"The Galerkin method","key":"XuJ90ZpU1t"}],"key":"nholxOY6MB"}],"identifier":"id-10-6","label":"10.6 ","html_id":"id-10-6","implicit":true,"key":"tS2e90Yi0s"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-galerkin-fem","label":"demo-galerkin-fem","kind":"proof:example","position":{"start":{"line":541,"column":1},"end":{"line":541,"column":19}},"children":[{"type":"text","value":"Example ","key":"IOenQhBaIo"},{"type":"text","value":"10.6.2","key":"qlvjJfM33F"}],"template":"Example %s","enumerator":"10.6.2","resolved":true,"html_id":"demo-galerkin-fem","remote":true,"url":"/galerkin","dataUrl":"/galerkin.json","key":"D6xOP1ZcNh"}],"key":"bAkAjqIUCn"},{"type":"paragraph","position":{"start":{"line":544,"column":1},"end":{"line":544,"column":1}},"children":[{"type":"text","value":"Here are the coefficient function definitions. Even though ","position":{"start":{"line":544,"column":1},"end":{"line":544,"column":1}},"key":"fvO0dUVp5m"},{"type":"inlineMath","value":"s","position":{"start":{"line":544,"column":1},"end":{"line":544,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>s</mi></mrow><annotation encoding=\"application/x-tex\">s</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">s</span></span></span></span>","key":"EfCHFtXdkn"},{"type":"text","value":" is a constant, it has to be defined as a function for ","position":{"start":{"line":544,"column":1},"end":{"line":544,"column":1}},"key":"uEn7yrbLXK"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-fem","label":"function-fem","children":[{"type":"text","value":"Function ","key":"J0B5bIB65w"},{"type":"text","value":"10.6.1","key":"NEkJOBOaPD"}],"template":"Algorithm %s","enumerator":"10.6.1","resolved":true,"html_id":"function-fem","remote":true,"url":"/galerkin","dataUrl":"/galerkin.json","key":"hUC3EWUGDV"},{"type":"text","value":" to use it.","position":{"start":{"line":544,"column":1},"end":{"line":544,"column":1}},"key":"qrvRmm6fwj"}],"key":"fX62Blc7hg"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"c = @(x) x.^2;\nq = @(x) 4 * ones(size(x));\nf = @(x) sin(pi * x);","key":"yD29TnNlkM"},{"type":"output","id":"E0pI2rZP5PcDHSUKh4Cac","data":[],"key":"gXopS8aDdW"}],"key":"umdGMKonkF"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[x,u] = fem(c, q, f, 0, 1, 50);\nclf,  plot(x, u)\nxlabel('x'),  ylabel('u')\ntitle('Solution by finite elements')","key":"YHoWq4PrqB"},{"type":"output","id":"ntPjhBA9JPQRgRyLCy3CO","data":[{"output_type":"execute_result","execution_count":48,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"7891c4d9f6d9c46d453a4ae60e48750a","path":"/build/7891c4d9f6d9c46d453a4ae60e48750a.png"}}}],"key":"zw1QLgUEXm"}],"key":"PugObXNw4O"}],"label":"demo-galerkin-fem-matlab","identifier":"demo-galerkin-fem-matlab","html_id":"demo-galerkin-fem-matlab","key":"ZBrJTxk3Er"}],"key":"sCSgJGcT3M"}],"key":"kPTHpBs2zn"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Chapter 9","url":"/chapter9-1","group":"MATLAB codes"},"next":{"title":"Chapter 11","url":"/chapter11-1","group":"MATLAB codes"}}},"domain":"http://localhost:3000"}