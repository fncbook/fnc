{"version":1,"kind":"Notebook","sha256":"a6a9d8b2aeef6db29078d86a4c516af15e8ca4aa97685c75d16ebd174a938780","slug":"chapter1-2","location":"/python/chapter1.md","dependencies":[],"frontmatter":{"title":"Chapter 1","numbering":{"heading_1":{"enabled":false},"heading_2":{"enabled":false},"heading_3":{"enabled":false},"heading_4":{"enabled":false},"heading_5":{"enabled":false},"heading_6":{"enabled":false},"title":{"offset":2}},"kernelspec":{"name":"python3","display_name":"Python 3","language":"python"},"content_includes_title":false,"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"edit_url":"https://github.com/fncbook/fnc/blob/master/python/chapter1.md","exports":[{"format":"md","filename":"chapter1.md","url":"/build/chapter1-d71bb819b8a5c3712ae735f7336b1363.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"Functions","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"uHcF5yif2v"}],"identifier":"functions","label":"Functions","html_id":"functions","implicit":true,"key":"Z3EavpGw3C"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"strong","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"Horner’s algorithm for evaluating a polynomial","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"mwaYhcs05K"}],"key":"OY011cJuH2"}],"key":"hXcdp20AWw"},{"type":"include","file":"fncbook/fncbook/chapter01.py","literal":true,"filter":{"startAt":"def horner","endAt":"return"},"children":[{"type":"code","value":"def horner(c,x):\n    \"\"\"\n    horner(c,x)\n\n    Evaluate a polynomial whose coefficients are given in descending order \n    in c, at the point x, using Horner's rule.\n    \"\"\"\n    n = len(c)\n    y = c[0]\n    for k in range(1, n):\n        y = x * y + c[k]   \n    return y","lang":"python","showLineNumbers":true,"filename":"horner.py","key":"Er74nhyd3o"}],"key":"CcJm7GdkcP"}],"label":"function-horner-python","identifier":"function-horner-python","html_id":"function-horner-python","key":"MfD1dDcs1e"},{"type":"heading","depth":2,"position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"text","value":"Examples","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"alvYuLxwtQ"}],"identifier":"examples","label":"Examples","html_id":"examples","implicit":true,"key":"qW6EcUnVQI"}],"key":"RhowQbmiVZ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"exec(open(\"FNC_init.py\").read())","visibility":"show","key":"faL7I6dUYV"},{"type":"output","id":"JaZRnDRWH3nDWkcJcFj8T","data":[],"visibility":"show","key":"wfjoDeNuMu"}],"data":{"tags":[]},"visibility":"remove","key":"ACgRHbWTXo"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"children":[{"type":"text","value":"1.1 ","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"QyrDTscwdW"},{"type":"link","identifier":"section-intro-floating-point","label":"section-intro-floating-point","kind":"narrative","position":{"start":{"line":33,"column":5},"end":{"line":33,"column":34}},"url":"/floating-point","internal":true,"dataUrl":"/floating-point.json","children":[{"type":"text","value":"Floating-point numbers","key":"HSYy9BZVzD"}],"key":"GxMy9MZYF0"}],"identifier":"id-1-1","label":"1.1 ","html_id":"id-1-1","implicit":true,"key":"fovFmz1tRQ"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-float-accuracy","label":"demo-float-accuracy","kind":"proof:example","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":21}},"children":[{"type":"text","value":"Example ","key":"BWwlCbNAQw"},{"type":"text","value":"1.1.2","key":"OxmTD08rUf"}],"template":"Example %s","enumerator":"1.1.2","resolved":true,"html_id":"demo-float-accuracy","remote":true,"url":"/floating-point","dataUrl":"/floating-point.json","key":"pQVRXtgdBJ"}],"key":"gtqfNVOO45"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Getting started with Python","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"key":"PB7uejZCPM"}],"key":"j7WwFCRtTz"},{"type":"paragraph","position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"children":[{"type":"text","value":"See ","position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"key":"kMVGFFr0BU"},{"type":"crossReference","identifier":"section-setup-python","label":"section-setup-python","kind":"heading","position":{"start":{"line":41,"column":5},"end":{"line":41,"column":26}},"children":[{"type":"text","value":"Setting up Python for this book","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"cnsaNtWTDP"}],"template":"{name}","resolved":true,"html_id":"section-setup-python","remote":true,"url":"/setup-2","dataUrl":"/setup-2.json","key":"DuuG4ELK93"},{"type":"text","value":" for guidance on how to set up Python for the demos in this book.","position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"key":"t5XR0YBrZM"}],"key":"EMMRobREhI"}],"class":"dropdown","open":true,"key":"fihyF1v3Xu"},{"type":"paragraph","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"children":[{"type":"text","value":"Recall the grade-school approximation to the number ","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"key":"NHeOEVuoDx"},{"type":"text","value":"π","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"key":"S4pOhL1xgd"},{"type":"text","value":".","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"key":"hvxgmncKTJ"}],"key":"lnrcGD2wLw"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"p = 22/7\nprint(p)","key":"NZnjL0eDxg"},{"type":"output","id":"96q4dbKdqUftVu8CzSp1q","data":[{"output_type":"stream","name":"stdout","text":"3.142857142857143\n"}],"key":"tXxIjj21hs"}],"data":{},"key":"V7N6JCy2I5"},{"type":"paragraph","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"children":[{"type":"text","value":"Not all the digits displayed for ","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"key":"p29dbVSzGn"},{"type":"inlineCode","value":"p","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"key":"pYrvqp3780"},{"type":"text","value":" are the same as those of ","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"key":"wuDSmm5FJm"},{"type":"text","value":"π","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"key":"ju47bc3Vx1"},{"type":"text","value":".","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"key":"W5FGQojlH8"}],"key":"HE0RW6MqmA"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"KKqhnjRe7a"}],"key":"bBu8VEJb8F"},{"type":"paragraph","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"children":[{"type":"text","value":"The value of ","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"bvbtZoWEvQ"},{"type":"inlineCode","value":"pi","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"mIwJNgrVze"},{"type":"text","value":" is predefined in the ","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"P9B4OyPijl"},{"type":"inlineCode","value":"numpy","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"FZttyXl6oy"},{"type":"text","value":" package.","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"fyJuhvj04k"}],"key":"n5G4DuNtww"}],"class":"dropdown","key":"kYApS16s7o"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(pi)","key":"nuijM0hOxX"},{"type":"output","id":"CWU61aacQd8sktMZBPor2","data":[{"output_type":"stream","name":"stdout","text":"3.141592653589793\n"}],"key":"KbpzkdRnll"}],"data":{},"key":"FnNFvlaCkL"},{"type":"paragraph","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"children":[{"type":"text","value":"The absolute and relative accuracies of the approximation are as follows:","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"key":"bJV2X7VruD"}],"key":"C8Qsn89jST"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"DLoj8lC8rU"}],"key":"c4eGHXLfvO"},{"type":"paragraph","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"children":[{"type":"text","value":"We often use ","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"key":"BYYyhqzMai"},{"type":"link","url":"https://docs.python.org/3/tutorial/inputoutput.html#tut-f-strings","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"children":[{"type":"text","value":"Python f-strings","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"key":"fAVtJ7Y1AI"}],"urlSource":"https://docs.python.org/3/tutorial/inputoutput.html#tut-f-strings","key":"bvihwX3SRC"},{"type":"text","value":" to format numerical output.","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"key":"H0hxrHq6e8"}],"key":"YNhF4obtY1"}],"class":"dropdown","key":"jxk3ghQNao"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(f\"absolute accuracy: {abs(p - pi)}\")","key":"t98932Mia5"},{"type":"output","id":"ylu_x9Pscih1w4bvDsZoA","data":[{"output_type":"stream","name":"stdout","text":"absolute accuracy: 0.0012644892673496777\n"}],"key":"qvPFGffos3"}],"data":{},"key":"Fwvn7cbQjq"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"rel_acc = abs(p - pi) / pi\nprint(\"relative accuracy: {rel_acc:.4e}\")","key":"Vn9U0kDBYd"},{"type":"output","id":"jCv_g1mvBFAiVry0WFYk5","data":[{"output_type":"stream","name":"stdout","text":"relative accuracy: {rel_acc:.4e}\n"}],"key":"Jf2ChCZesV"}],"data":{},"key":"pLGfDX792H"},{"type":"paragraph","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"children":[{"type":"text","value":"Here we calculate the number of accurate digits in ","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"key":"Upj3p0PgaY"},{"type":"inlineCode","value":"p","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"key":"NoEydaUABn"},{"type":"text","value":":","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"key":"dEqA0aktua"}],"key":"kgozZt4I9J"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"Awu4LxC3FX"}],"key":"xjvAsfZBjR"},{"type":"paragraph","position":{"start":{"line":79,"column":1},"end":{"line":79,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":79,"column":1},"end":{"line":79,"column":1}},"key":"DgCgZmjYmt"},{"type":"inlineCode","value":"log","position":{"start":{"line":79,"column":1},"end":{"line":79,"column":1}},"key":"G0u07kLUvO"},{"type":"text","value":" function is for the natural log. For other common bases, use ","position":{"start":{"line":79,"column":1},"end":{"line":79,"column":1}},"key":"OfQ1NE1NMs"},{"type":"inlineCode","value":"log10","position":{"start":{"line":79,"column":1},"end":{"line":79,"column":1}},"key":"vhtzKVnp0u"},{"type":"text","value":" or ","position":{"start":{"line":79,"column":1},"end":{"line":79,"column":1}},"key":"JYm9uFcsaU"},{"type":"inlineCode","value":"log2","position":{"start":{"line":79,"column":1},"end":{"line":79,"column":1}},"key":"bQcrsymRz4"},{"type":"text","value":".","position":{"start":{"line":79,"column":1},"end":{"line":79,"column":1}},"key":"Oxe4cvBfWf"}],"key":"FcpB8NTjF2"}],"class":"dropdown","key":"fEC1nENTY6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(f\"accurate digits: {-log10(rel_acc):.1f}\")","key":"lTQf5fo2HN"},{"type":"output","id":"fjF62IQooI7NqaXhEg7dL","data":[{"output_type":"stream","name":"stdout","text":"accurate digits: 3.4\n"}],"key":"wc0qjzpFT4"}],"data":{},"key":"JZiEvQkqxN"}],"label":"demo-float-accuracy-python","identifier":"demo-float-accuracy-python","html_id":"demo-float-accuracy-python","key":"IKX9axBlkx"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-float-double","label":"demo-float-double","kind":"proof:example","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":19}},"children":[{"type":"text","value":"Example ","key":"sfF9aW8gaF"},{"type":"text","value":"1.1.3","key":"SJljeDyZyA"}],"template":"Example %s","enumerator":"1.1.3","resolved":true,"html_id":"demo-float-double","remote":true,"url":"/floating-point","dataUrl":"/floating-point.json","key":"SB3QuAVVgv"}],"key":"t7W7jHeKxt"},{"type":"paragraph","position":{"start":{"line":92,"column":1},"end":{"line":92,"column":1}},"children":[{"type":"text","value":"Python has native ","position":{"start":{"line":92,"column":1},"end":{"line":92,"column":1}},"key":"MdVcaZEow0"},{"type":"inlineCode","value":"int","position":{"start":{"line":92,"column":1},"end":{"line":92,"column":1}},"key":"XitJmZAeta"},{"type":"text","value":" and ","position":{"start":{"line":92,"column":1},"end":{"line":92,"column":1}},"key":"u5O8A1qQjS"},{"type":"inlineCode","value":"float","position":{"start":{"line":92,"column":1},"end":{"line":92,"column":1}},"key":"ONfcu0loDg"},{"type":"text","value":" types.","position":{"start":{"line":92,"column":1},"end":{"line":92,"column":1}},"key":"eP4Ov6Brn0"}],"key":"ppJGMATZtw"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(f\"The type of {1} is {type(1)}\")\nprint(f\"The type of {float(1)} is {type(1.0)}\")","key":"c8F8d4ruPJ"},{"type":"output","id":"vbuEgsCT1sT_LioLf8NRN","data":[{"output_type":"stream","name":"stdout","text":"The type of 1 is <class 'int'>\nThe type of 1.0 is <class 'float'>\n"}],"key":"XgB8TJ0I0A"}],"data":{},"key":"Nve2MHSiG0"},{"type":"paragraph","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"key":"MKkc85lS2j"},{"type":"inlineCode","value":"numpy","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"key":"z9fuUnmUeo"},{"type":"text","value":" package has its own ","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"key":"D6m9lCgz9J"},{"type":"inlineCode","value":"float","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"key":"fSueWLpUZl"},{"type":"text","value":" types:","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"key":"SvpR9eoeBg"}],"key":"fv1LUKmk4P"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"one = float64(1)\nprint(f\"The type of {one} is {type(one)}\")","key":"biMUF86ZWa"},{"type":"output","id":"aXs0jlx0THsLzJNzOObSE","data":[{"output_type":"stream","name":"stdout","text":"The type of 1.0 is <class 'numpy.float64'>\n"}],"key":"FVeenvBchN"}],"data":{},"key":"jQKTs8JRyW"},{"type":"paragraph","position":{"start":{"line":106,"column":1},"end":{"line":106,"column":1}},"children":[{"type":"text","value":"Both ","position":{"start":{"line":106,"column":1},"end":{"line":106,"column":1}},"key":"srke6TDvxo"},{"type":"inlineCode","value":"float","position":{"start":{"line":106,"column":1},"end":{"line":106,"column":1}},"key":"wUOsPYjU6T"},{"type":"text","value":" and ","position":{"start":{"line":106,"column":1},"end":{"line":106,"column":1}},"key":"NcUi9QMF6n"},{"type":"inlineCode","value":"float64","position":{"start":{"line":106,"column":1},"end":{"line":106,"column":1}},"key":"RHF422YIR9"},{"type":"text","value":" are double precision, using 64 binary bits per value. Although it is not normally necessary to do so, we can deconstruct a float into its significand and exponent:","position":{"start":{"line":106,"column":1},"end":{"line":106,"column":1}},"key":"hIj5Yzxjx0"}],"key":"tZj5x4z9uO"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"x = 3.14\nmantissa, exponent = frexp(x)\nprint(f\"significand: {mantissa * 2}, exponent: {exponent - 1}\")","key":"Q5hAaSyOVr"},{"type":"output","id":"fzQeWFx-PcbkTV9MGMOGs","data":[{"output_type":"stream","name":"stdout","text":"significand: 1.57, exponent: 1\n"}],"key":"pscG75U9rG"}],"data":{},"key":"imVMaFt1g0"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"mantissa, exponent = frexp(x / 8)\nprint(f\"significand: {mantissa * 2}, exponent: {exponent - 1}\")","key":"dG7Tdj2W2y"},{"type":"output","id":"h_ENnoIwPEIj01Pq33ciO","data":[{"output_type":"stream","name":"stdout","text":"significand: 1.57, exponent: -2\n"}],"key":"tNruFUmfmj"}],"data":{},"key":"PgOg1IzIxt"},{"type":"paragraph","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"children":[{"type":"text","value":"The spacing between floating-point values in ","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"key":"p85wYYAjhN"},{"type":"inlineMath","value":"[2^n,2^{n+1})","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><msup><mn>2</mn><mi>n</mi></msup><mo separator=\"true\">,</mo><msup><mn>2</mn><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">[2^n,2^{n+1})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"QtZQCTBRMB"},{"type":"text","value":" is ","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"key":"ZwTC3s3oF2"},{"type":"inlineMath","value":"2^n \\epsilon_\\text{mach}","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mn>2</mn><mi>n</mi></msup><msub><mi>ϵ</mi><mtext>mach</mtext></msub></mrow><annotation encoding=\"application/x-tex\">2^n \\epsilon_\\text{mach}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8144em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\">ϵ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">mach</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"bA2f9DeIkk"},{"type":"text","value":", where ","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"key":"u8r7VSxPAX"},{"type":"inlineMath","value":"\\epsilon_\\text{mach}","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>ϵ</mi><mtext>mach</mtext></msub></mrow><annotation encoding=\"application/x-tex\">\\epsilon_\\text{mach}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">ϵ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">mach</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"c15JsGg6zk"},{"type":"text","value":" is machine epsilon, given here for double precision:","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"key":"IPfSmibu9D"}],"key":"SMDTsxJOEz"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"mach_eps = finfo(float).eps\nprint(f\"machine epsilon is {mach_eps:.4e}\")","key":"e199z27RAe"},{"type":"output","id":"-QEljeNKoAtwrlMvMexrC","data":[{"output_type":"stream","name":"stdout","text":"machine epsilon is 2.2204e-16\n"}],"key":"QBrWksjkv3"}],"data":{},"key":"ZOV3ooIZYc"},{"type":"paragraph","position":{"start":{"line":126,"column":1},"end":{"line":126,"column":1}},"children":[{"type":"text","value":"Because double precision allocates 52 bits to the significand, the default value of machine epsilon is ","position":{"start":{"line":126,"column":1},"end":{"line":126,"column":1}},"key":"IfXWEXURff"},{"type":"span","position":{"start":{"line":126,"column":1},"end":{"line":126,"column":1}},"children":[{"type":"text","value":"2","key":"Ux7qITA6ar"},{"type":"superscript","children":[{"type":"text","value":"-52","key":"pm7bqS9UoG"}],"key":"xV8oTzUBP0"}],"key":"WEOCBCRRDj"},{"type":"text","value":".","position":{"start":{"line":126,"column":1},"end":{"line":126,"column":1}},"key":"Uamda5iQ4x"}],"key":"lzdcAENRsz"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(f\"machine epsilon is 2 to the power {log2(mach_eps)}\")","key":"uIFYqiMwRT"},{"type":"output","id":"3vQNA7MqeV2V9jjJi6y10","data":[{"output_type":"stream","name":"stdout","text":"machine epsilon is 2 to the power -52.0\n"}],"key":"n7G2FFCGdD"}],"data":{},"key":"cYG1vWLHl8"},{"type":"paragraph","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"children":[{"type":"text","value":"A common mistake is to think that ","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"key":"KEhg9mNRWl"},{"type":"inlineMath","value":"\\epsilon_\\text{mach}","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>ϵ</mi><mtext>mach</mtext></msub></mrow><annotation encoding=\"application/x-tex\">\\epsilon_\\text{mach}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">ϵ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">mach</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"Ti5nFd1mLE"},{"type":"text","value":" is the smallest floating-point number. It’s only the smallest ","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"key":"Va8GfojRLO"},{"type":"emphasis","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"children":[{"type":"text","value":"relative to 1","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"key":"KCmuRgfamk"}],"key":"Ihq7yvzgJy"},{"type":"text","value":". The correct perspective is that the scaling of values is limited by the exponent, not the significand. The actual range of positive values in double precision is","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"key":"Ffrgtaut99"}],"key":"cqRMQTHVz8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"finf = finfo(float)\nprint(f\"range of positive values: [{finf.tiny}, {finf.max}]\")","key":"QwMkSfYFCN"},{"type":"output","id":"PGW9lAW3H8Uk69LCgIMEY","data":[{"output_type":"stream","name":"stdout","text":"range of positive values: [2.2250738585072014e-308, 1.7976931348623157e+308]\n"}],"key":"tzDyPp90mC"}],"data":{},"key":"tNWyDWhhGP"},{"type":"paragraph","position":{"start":{"line":139,"column":1},"end":{"line":139,"column":1}},"children":[{"type":"text","value":"For the most part you can mix integers and floating-point values and get what you expect.","position":{"start":{"line":139,"column":1},"end":{"line":139,"column":1}},"key":"byEBhVdGFG"}],"key":"WQLBNj8FfK"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"1/7","key":"D9KRoJsiDQ"},{"type":"output","id":"hq14e1U2a-nSE1A5ujavi","data":[{"output_type":"execute_result","execution_count":14,"metadata":{},"data":{"text/plain":{"content":"0.14285714285714285","content_type":"text/plain"}}}],"key":"ECoRXx83Db"}],"data":{},"key":"Rgs4jaWRhi"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"37.3 + 1","key":"eTqBmJZSsf"},{"type":"output","id":"atjb8g8jcxOeeOktvVN-j","data":[{"output_type":"execute_result","execution_count":15,"metadata":{},"data":{"text/plain":{"content":"38.3","content_type":"text/plain"}}}],"key":"ATHpFtIHQy"}],"data":{},"key":"HSaoJpyMcm"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"2**(-4)","key":"oyPHJysSbm"},{"type":"output","id":"qsd1CwQh-LHC1x2BUrGIO","data":[{"output_type":"execute_result","execution_count":16,"metadata":{},"data":{"text/plain":{"content":"0.0625","content_type":"text/plain"}}}],"key":"OphLf6Y2Kg"}],"data":{},"key":"rFFX7sf0Zq"},{"type":"paragraph","position":{"start":{"line":153,"column":1},"end":{"line":153,"column":1}},"children":[{"type":"text","value":"You can convert a floating value to an integer by wrapping it in ","position":{"start":{"line":153,"column":1},"end":{"line":153,"column":1}},"key":"IoFQt8o0fK"},{"type":"inlineCode","value":"int","position":{"start":{"line":153,"column":1},"end":{"line":153,"column":1}},"key":"xzmr7vawXD"},{"type":"text","value":".","position":{"start":{"line":153,"column":1},"end":{"line":153,"column":1}},"key":"QiA0tmMLKU"}],"key":"NpgnTq1xVb"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"int(3.14)","key":"aRhoC2hBYj"},{"type":"output","id":"YRNjG_b6G28OOAWkZB6Lh","data":[{"output_type":"execute_result","execution_count":17,"metadata":{},"data":{"text/plain":{"content":"3","content_type":"text/plain"}}}],"key":"SvZ8RQFfDE"}],"data":{},"key":"Z57yENIUWZ"}],"label":"demo-float-double-python","identifier":"demo-float-double-python","html_id":"demo-float-double-python","key":"DXgjTsveBd"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-float-arithmetic","label":"demo-float-arithmetic","kind":"proof:example","position":{"start":{"line":161,"column":1},"end":{"line":161,"column":23}},"children":[{"type":"text","value":"Example ","key":"gV2xUkcd62"},{"type":"text","value":"1.1.4","key":"QpqXyP1aPQ"}],"template":"Example %s","enumerator":"1.1.4","resolved":true,"html_id":"demo-float-arithmetic","remote":true,"url":"/floating-point","dataUrl":"/floating-point.json","key":"fGLVgvjLZS"}],"key":"OUD3XhWYx8"},{"type":"paragraph","position":{"start":{"line":164,"column":1},"end":{"line":164,"column":1}},"children":[{"type":"text","value":"There is no double precision number between ","position":{"start":{"line":164,"column":1},"end":{"line":164,"column":1}},"key":"n3L7UJoapF"},{"type":"text","value":"1","position":{"start":{"line":164,"column":1},"end":{"line":164,"column":1}},"key":"iGrOCrrBfY"},{"type":"text","value":" and ","position":{"start":{"line":164,"column":1},"end":{"line":164,"column":1}},"key":"yyVcZR5AzD"},{"type":"inlineMath","value":"1+\\varepsilon_\\text{mach}","position":{"start":{"line":164,"column":1},"end":{"line":164,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mo>+</mo><msub><mi>ε</mi><mtext>mach</mtext></msub></mrow><annotation encoding=\"application/x-tex\">1+\\varepsilon_\\text{mach}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">ε</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">mach</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"HAZLdt309c"},{"type":"text","value":". Thus, the following difference is zero despite its appearance.","position":{"start":{"line":164,"column":1},"end":{"line":164,"column":1}},"key":"cC81aZ6GsH"}],"key":"uLQAR4Do9b"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"eps = finfo(float).eps\ne = eps/2\nprint((1.0 + e) - 1.0)","key":"QqVjPsHR68"},{"type":"output","id":"kDH8pYF1cWTeS31IMRN3b","data":[{"output_type":"stream","name":"stdout","text":"0.0\n"}],"key":"ikRlrNpF5f"}],"data":{},"key":"A18i6g9CHf"},{"type":"paragraph","position":{"start":{"line":172,"column":1},"end":{"line":172,"column":1}},"children":[{"type":"text","value":"However, ","position":{"start":{"line":172,"column":1},"end":{"line":172,"column":1}},"key":"ovviM41T43"},{"type":"inlineMath","value":"1-\\varepsilon_\\text{mach}/2","position":{"start":{"line":172,"column":1},"end":{"line":172,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mo>−</mo><msub><mi>ε</mi><mtext>mach</mtext></msub><mi mathvariant=\"normal\">/</mi><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">1-\\varepsilon_\\text{mach}/2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">ε</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">mach</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">/2</span></span></span></span>","key":"jaU7V3hbvM"},{"type":"text","value":" is a double precision number, so it and its negative are represented exactly:","position":{"start":{"line":172,"column":1},"end":{"line":172,"column":1}},"key":"kLKK2KWhOD"}],"key":"QWTG8Onw17"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(1.0 + (e - 1.0))","key":"NTvw4MVDEo"},{"type":"output","id":"oIQSCmUgaEPe91rGQUdfm","data":[{"output_type":"stream","name":"stdout","text":"1.1102230246251565e-16\n"}],"key":"aIPzh2Un88"}],"data":{},"key":"FgT3HiemSo"},{"type":"paragraph","position":{"start":{"line":178,"column":1},"end":{"line":178,"column":1}},"children":[{"type":"text","value":"This is now the “correct” result. But we have found a rather shocking breakdown of the associative law of addition!","position":{"start":{"line":178,"column":1},"end":{"line":178,"column":1}},"key":"OBCiQGzIJV"}],"key":"MgDrtB3RId"}],"label":"demo-float-arithmetic-python","identifier":"demo-float-arithmetic-python","html_id":"demo-float-arithmetic-python","key":"b0OliQAlRt"},{"type":"heading","depth":3,"position":{"start":{"line":182,"column":1},"end":{"line":182,"column":1}},"children":[{"type":"text","value":"1.2 ","position":{"start":{"line":182,"column":1},"end":{"line":182,"column":1}},"key":"VVUip7v9fR"},{"type":"link","identifier":"section-intro-conditioning","label":"section-intro-conditioning","kind":"narrative","position":{"start":{"line":182,"column":5},"end":{"line":182,"column":32}},"url":"/conditioning","internal":true,"dataUrl":"/conditioning.json","children":[{"type":"text","value":"Problems and conditioning","key":"i8IQtzH99i"}],"key":"x5SzP748Br"}],"identifier":"id-1-2","label":"1.2 ","html_id":"id-1-2","implicit":true,"key":"EFjq2PiDxc"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-condition-roots","label":"demo-condition-roots","kind":"proof:example","position":{"start":{"line":185,"column":1},"end":{"line":185,"column":22}},"children":[{"type":"text","value":"Example ","key":"eUhbJOkocv"},{"type":"text","value":"1.2.5","key":"AUwkhXKgyg"}],"template":"Example %s","enumerator":"1.2.5","resolved":true,"html_id":"demo-condition-roots","remote":true,"url":"/conditioning","dataUrl":"/conditioning.json","key":"mfdzzpX1w7"}],"key":"G7Q0E78IuT"},{"type":"paragraph","position":{"start":{"line":188,"column":1},"end":{"line":188,"column":1}},"children":[{"type":"text","value":"The polynomial ","position":{"start":{"line":188,"column":1},"end":{"line":188,"column":1}},"key":"IRQ1W6VrL4"},{"type":"inlineMath","value":"p(x) = \\frac{1}{3}(x-1)(x-1-\\epsilon)","position":{"start":{"line":188,"column":1},"end":{"line":188,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>p</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mfrac><mn>1</mn><mn>3</mn></mfrac><mo stretchy=\"false\">(</mo><mi>x</mi><mo>−</mo><mn>1</mn><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">(</mo><mi>x</mi><mo>−</mo><mn>1</mn><mo>−</mo><mi>ϵ</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">p(x) = \\frac{1}{3}(x-1)(x-1-\\epsilon)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1901em;vertical-align:-0.345em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8451em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">3</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">ϵ</span><span class=\"mclose\">)</span></span></span></span>","key":"aSgIsaKYBu"},{"type":"text","value":" has roots ","position":{"start":{"line":188,"column":1},"end":{"line":188,"column":1}},"key":"VTC26heTNX"},{"type":"text","value":"1","position":{"start":{"line":188,"column":1},"end":{"line":188,"column":1}},"key":"Jbkmp3BYXB"},{"type":"text","value":" and ","position":{"start":{"line":188,"column":1},"end":{"line":188,"column":1}},"key":"mO9ydnpfzO"},{"type":"inlineMath","value":"1+\\epsilon","position":{"start":{"line":188,"column":1},"end":{"line":188,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mo>+</mo><mi>ϵ</mi></mrow><annotation encoding=\"application/x-tex\">1+\\epsilon</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">ϵ</span></span></span></span>","key":"No8qZUavkN"},{"type":"text","value":". For small values of ","position":{"start":{"line":188,"column":1},"end":{"line":188,"column":1}},"key":"ml5t6xiT66"},{"type":"text","value":"ε","position":{"start":{"line":188,"column":1},"end":{"line":188,"column":1}},"key":"VndcOPsYPl"},{"type":"text","value":", the roots are ill-conditioned.","position":{"start":{"line":188,"column":1},"end":{"line":188,"column":1}},"key":"nvQ4wVgEwO"}],"key":"MG8wqtX8wi"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"fweKxXWSBm"}],"key":"sh0uOZ6gl2"},{"type":"paragraph","position":{"start":{"line":192,"column":1},"end":{"line":192,"column":1}},"children":[{"type":"text","value":"The statement ","position":{"start":{"line":192,"column":1},"end":{"line":192,"column":1}},"key":"Cn3PbGpO0v"},{"type":"inlineCode","value":"x, y = 10, 20","position":{"start":{"line":192,"column":1},"end":{"line":192,"column":1}},"key":"kzuBnRFhzv"},{"type":"text","value":" makes individual assignments to both ","position":{"start":{"line":192,"column":1},"end":{"line":192,"column":1}},"key":"N5nlfhY8U6"},{"type":"inlineCode","value":"x","position":{"start":{"line":192,"column":1},"end":{"line":192,"column":1}},"key":"EWxdkplg5v"},{"type":"text","value":" and ","position":{"start":{"line":192,"column":1},"end":{"line":192,"column":1}},"key":"kbhh6zMFv9"},{"type":"inlineCode","value":"y","position":{"start":{"line":192,"column":1},"end":{"line":192,"column":1}},"key":"INGhetRmcE"},{"type":"text","value":".","position":{"start":{"line":192,"column":1},"end":{"line":192,"column":1}},"key":"Jqh4ws4Reh"}],"key":"TkXtP0YN6H"}],"class":"dropdown","key":"gCBLsByshZ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ep = 1e-6   \na, b, c = 1/3, (-2 - ep) / 3, (1 + ep) / 3   # coefficients of p","key":"dzRTAFXzqq"},{"type":"output","id":"N556ma0tZPuGOZKhcW13W","data":[],"key":"vdwuJEHAAQ"}],"data":{},"key":"NbSM9oU2zL"},{"type":"paragraph","position":{"start":{"line":201,"column":1},"end":{"line":201,"column":1}},"children":[{"type":"text","value":"Here are the roots as computed by the quadratic formula.","position":{"start":{"line":201,"column":1},"end":{"line":201,"column":1}},"key":"UfsPqK9lr1"}],"key":"dBH5M5TnPd"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"d = sqrt(b**2 - 4*a*c)\nr1 = (-b - d) / (2*a)\nr2 = (-b + d) / (2*a)\nprint(r1, r2)","key":"TFZtEgPMzJ"},{"type":"output","id":"Ly0EvIRPlDmRMnK_qRDEx","data":[{"output_type":"stream","name":"stdout","text":"0.9999999998251499 1.0000010001748503\n"}],"key":"uok5AjJCFU"}],"data":{},"key":"MyzEVS1Kjo"},{"type":"paragraph","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"children":[{"type":"text","value":"The display of ","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"key":"RH1KmjU0Qa"},{"type":"inlineCode","value":"r2","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"key":"LK5JEFXGcx"},{"type":"text","value":" suggests that the last five digits or so are inaccurate. The relative error in the value is","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"key":"T3O1bCKnUE"}],"key":"Z11PVFFc33"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(abs(r1 - 1) / abs(1))\nprint(abs(r2 - (1 + ep)) / abs(1 + ep))","key":"GqLommVcPD"},{"type":"output","id":"oPy8FixSlj-mkhwoZ2_68","data":[{"output_type":"stream","name":"stdout","text":"1.7485013437124053e-10\n1.748501815656639e-10\n"}],"key":"Kl0pBhv7rS"}],"data":{},"key":"RRHuZ6mHS8"},{"type":"paragraph","position":{"start":{"line":217,"column":1},"end":{"line":221,"column":1}},"children":[{"type":"text","value":"The condition number of each root is","position":{"start":{"line":217,"column":1},"end":{"line":217,"column":1}},"key":"jWC9ROIfc6"}],"key":"y3fpGOM1vt"},{"type":"math","value":"\\kappa(r_i) = \\frac{|r_i|}{|r_1-r_2|} \\approx \\frac{1}{\\epsilon}.","position":{"start":{"line":217,"column":1},"end":{"line":217,"column":1}},"tight":true,"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>κ</mi><mo stretchy=\"false\">(</mo><msub><mi>r</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo><mo>=</mo><mfrac><mrow><mi mathvariant=\"normal\">∣</mi><msub><mi>r</mi><mi>i</mi></msub><mi mathvariant=\"normal\">∣</mi></mrow><mrow><mi mathvariant=\"normal\">∣</mi><msub><mi>r</mi><mn>1</mn></msub><mo>−</mo><msub><mi>r</mi><mn>2</mn></msub><mi mathvariant=\"normal\">∣</mi></mrow></mfrac><mo>≈</mo><mfrac><mn>1</mn><mi>ϵ</mi></mfrac><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">\\kappa(r_i) = \\frac{|r_i|}{|r_1-r_2|} \\approx \\frac{1}{\\epsilon}.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">κ</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.363em;vertical-align:-0.936em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.427em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">∣</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">∣</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">∣</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">∣</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.936em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.0074em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">ϵ</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mord\">.</span></span></span></span></span>","enumerator":"1","key":"s5ZF2lzLiE"},{"type":"paragraph","position":{"start":{"line":217,"column":1},"end":{"line":221,"column":1}},"children":[{"type":"text","value":"Thus, relative error in the data at the level of roundoff can grow in the result to be roughly","position":{"start":{"line":217,"column":1},"end":{"line":217,"column":1}},"key":"GnPxt2dWDY"}],"key":"yTdmRDCWiP"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(finfo(float).eps / ep)","key":"qIiv4F0VYS"},{"type":"output","id":"DBT79-yPvyLixOI4Vi8Qq","data":[{"output_type":"stream","name":"stdout","text":"2.220446049250313e-10\n"}],"key":"QonznNVHo6"}],"data":{},"key":"tJeeB5vujI"},{"type":"paragraph","position":{"start":{"line":226,"column":1},"end":{"line":226,"column":1}},"children":[{"type":"text","value":"This matches the observation pretty well.","position":{"start":{"line":226,"column":1},"end":{"line":226,"column":1}},"key":"NUaLAFxcAk"}],"key":"o3u0PDb2PJ"}],"label":"demo-condition-roots-python","identifier":"demo-condition-roots-python","html_id":"demo-condition-roots-python","key":"MUyP4MKf4l"},{"type":"heading","depth":3,"position":{"start":{"line":229,"column":1},"end":{"line":229,"column":1}},"children":[{"type":"text","value":"1.3 ","position":{"start":{"line":229,"column":1},"end":{"line":229,"column":1}},"key":"I5MehfZLtT"},{"type":"link","identifier":"section-intro-algorithms","label":"section-intro-algorithms","kind":"narrative","position":{"start":{"line":229,"column":5},"end":{"line":229,"column":30}},"url":"/algorithms","internal":true,"dataUrl":"/algorithms.json","children":[{"type":"text","value":"Algorithms","key":"P9RViGWbSZ"}],"key":"cDRyeSkyg9"}],"identifier":"id-1-3","label":"1.3 ","html_id":"id-1-3","implicit":true,"key":"HJLJhgL7Nm"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-algorithms-horner","label":"demo-algorithms-horner","kind":"proof:example","position":{"start":{"line":232,"column":1},"end":{"line":232,"column":24}},"children":[{"type":"text","value":"Example ","key":"ClJZi48Ixg"},{"type":"text","value":"1.3.2","key":"tmmMjeqajE"}],"template":"Example %s","enumerator":"1.3.2","resolved":true,"html_id":"demo-algorithms-horner","remote":true,"url":"/algorithms","dataUrl":"/algorithms.json","key":"i0IKuQr6wQ"}],"key":"skJB5qDfmA"},{"type":"paragraph","position":{"start":{"line":235,"column":1},"end":{"line":235,"column":1}},"children":[{"type":"text","value":"Here we show how to use ","position":{"start":{"line":235,"column":1},"end":{"line":235,"column":1}},"key":"R5DBNX0pdV"},{"type":"inlineCode","value":"horner","position":{"start":{"line":235,"column":1},"end":{"line":235,"column":1}},"key":"Oj4ERoZAz0"},{"type":"text","value":" to evaluate a polynomial. First, we have to ensure that the book’s package is imported.","position":{"start":{"line":235,"column":1},"end":{"line":235,"column":1}},"key":"KlLexD6atU"}],"key":"pfoeW5nCaR"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import fncbook as FNC","key":"OwL3yXBlUe"},{"type":"output","id":"koihLE3vqk0lKwaFY0VvW","data":[],"key":"fZDpbv4Spo"}],"data":{},"key":"Rv8EeranL7"},{"type":"paragraph","position":{"start":{"line":241,"column":1},"end":{"line":241,"column":1}},"children":[{"type":"text","value":"Here is the help string for the function:","position":{"start":{"line":241,"column":1},"end":{"line":241,"column":1}},"key":"ekAFCXy31b"}],"key":"ZvRgltkEdS"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"help(FNC.horner)","key":"C5HGhY6GLl"},{"type":"output","id":"IeSJxqygIhsXSo7iWm_ys","data":[{"output_type":"stream","name":"stdout","text":"Help on function horner in module fncbook.chapter01:\n\nhorner(c, x)\n    horner(c,x)\n\n    Evaluate a polynomial whose coefficients are given in descending order\n    in c, at the point x, using Horner's rule.\n\n"}],"key":"BZMDktXKl8"}],"data":{},"key":"R9xAB4zp7X"},{"type":"paragraph","position":{"start":{"line":247,"column":1},"end":{"line":247,"column":1}},"children":[{"type":"text","value":"We now define a vector of the coefficients of ","position":{"start":{"line":247,"column":1},"end":{"line":247,"column":1}},"key":"RvTGHpltnI"},{"type":"inlineMath","value":"p(x)=(x−1)^3=x^3−3x^2+3x−1","position":{"start":{"line":247,"column":1},"end":{"line":247,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>p</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mo stretchy=\"false\">(</mo><mi>x</mi><mo>−</mo><mn>1</mn><msup><mo stretchy=\"false\">)</mo><mn>3</mn></msup><mo>=</mo><msup><mi>x</mi><mn>3</mn></msup><mo>−</mo><mn>3</mn><msup><mi>x</mi><mn>2</mn></msup><mo>+</mo><mn>3</mn><mi>x</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">p(x)=(x−1)^3=x^3−3x^2+3x−1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8974em;vertical-align:-0.0833em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8974em;vertical-align:-0.0833em;\"></span><span class=\"mord\">3</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">3</span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"JtVDnEojPC"},{"type":"text","value":", in descending degree order. Note that the textbook’s functions are all in a namespace called ","position":{"start":{"line":247,"column":1},"end":{"line":247,"column":1}},"key":"PckF02YQJc"},{"type":"inlineCode","value":"FNC","position":{"start":{"line":247,"column":1},"end":{"line":247,"column":1}},"key":"LJ3POQ3BZZ"},{"type":"text","value":", to help distinguish them from other Python commands and modules.","position":{"start":{"line":247,"column":1},"end":{"line":247,"column":1}},"key":"huMmvq8DXu"}],"key":"b7N9IeU3Vg"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"c = array([1, -3, 3, -1])\nprint(FNC.horner(c, 1.6))","key":"AqmC5ButCp"},{"type":"output","id":"YWZ8x2mSg_uCTUgHxcTE5","data":[{"output_type":"stream","name":"stdout","text":"0.21600000000000041\n"}],"key":"uUXtBbu91X"}],"data":{},"key":"oZSsmHULoG"},{"type":"paragraph","position":{"start":{"line":254,"column":1},"end":{"line":254,"column":1}},"children":[{"type":"text","value":"The above is the value of ","position":{"start":{"line":254,"column":1},"end":{"line":254,"column":1}},"key":"YBalcmg4v9"},{"type":"inlineMath","value":"p(1.6)","position":{"start":{"line":254,"column":1},"end":{"line":254,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>p</mi><mo stretchy=\"false\">(</mo><mn>1.6</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">p(1.6)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mopen\">(</span><span class=\"mord\">1.6</span><span class=\"mclose\">)</span></span></span></span>","key":"rWujzehUUT"},{"type":"text","value":", up to a rounding error.","position":{"start":{"line":254,"column":1},"end":{"line":254,"column":1}},"key":"jYEUddtX0S"}],"key":"KPj5VPN9yG"}],"label":"demo-algorithms-horner-python","identifier":"demo-algorithms-horner-python","html_id":"demo-algorithms-horner-python","key":"uAPYlJDqUE"},{"type":"heading","depth":3,"position":{"start":{"line":258,"column":1},"end":{"line":258,"column":1}},"children":[{"type":"text","value":"1.4 ","position":{"start":{"line":258,"column":1},"end":{"line":258,"column":1}},"key":"RrCkAxM39h"},{"type":"link","identifier":"section-intro-stability","label":"section-intro-stability","kind":"narrative","position":{"start":{"line":258,"column":5},"end":{"line":258,"column":29}},"url":"/stability","internal":true,"dataUrl":"/stability.json","children":[{"type":"text","value":"Stability","key":"ISpcLWvucP"}],"key":"BE3LxZAkEi"}],"identifier":"id-1-4","label":"1.4 ","html_id":"id-1-4","implicit":true,"key":"qyiup3ggz6"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-stability-quadbad","label":"demo-stability-quadbad","kind":"proof:example","position":{"start":{"line":261,"column":1},"end":{"line":261,"column":24}},"children":[{"type":"text","value":"Example ","key":"Rrp9E8PGXJ"},{"type":"text","value":"1.4.1","key":"wMZDqD1cSk"}],"template":"Example %s","enumerator":"1.4.1","resolved":true,"html_id":"demo-stability-quadbad","remote":true,"url":"/stability","dataUrl":"/stability.json","key":"e2VKNWNPZj"}],"key":"HzHmR5ww7s"},{"type":"paragraph","position":{"start":{"line":266,"column":1},"end":{"line":266,"column":1}},"children":[{"type":"text","value":"We apply the quadratic formula to find the roots of a quadratic via ","position":{"start":{"line":266,"column":1},"end":{"line":266,"column":1}},"key":"WJAPQ3gI0A"},{"type":"crossReference","kind":"equation","identifier":"quadunstable","label":"quadunstable","children":[{"type":"text","value":"(","key":"H0BJ2raeqS"},{"type":"text","value":"1.4.1","key":"Zm4fM2BfBF"},{"type":"text","value":")","key":"k0AdpovGAJ"}],"template":"(%s)","enumerator":"1.4.1","resolved":true,"html_id":"quadunstable","remote":true,"url":"/stability","dataUrl":"/stability.json","key":"VdDOE6Ar9j"},{"type":"text","value":".","position":{"start":{"line":266,"column":1},"end":{"line":266,"column":1}},"key":"OXlE284yqo"}],"indexEntries":[{"entry":"Python","subEntry":{"value":"scientific notation","kind":"entry"},"emphasis":true}],"label":"index-dRA8paG9Ep","identifier":"index-dra8pag9ep","html_id":"index-dra8pag9ep","key":"UOQJKT3i9a"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"yjM3VIz9zB"}],"key":"jSTIHMi3ww"},{"type":"paragraph","position":{"start":{"line":269,"column":1},"end":{"line":269,"column":1}},"children":[{"type":"text","value":"A number in scientific notation is entered as ","position":{"start":{"line":269,"column":1},"end":{"line":269,"column":1}},"key":"jycA2HeVNk"},{"type":"inlineCode","value":"1.23e4","position":{"start":{"line":269,"column":1},"end":{"line":269,"column":1}},"key":"rU9fDFbf0x"},{"type":"text","value":" rather than as ","position":{"start":{"line":269,"column":1},"end":{"line":269,"column":1}},"key":"PamOxAzE8h"},{"type":"inlineCode","value":"1.23*10^{4}","position":{"start":{"line":269,"column":1},"end":{"line":269,"column":1}},"key":"flcYzSuApJ"},{"type":"text","value":".","position":{"start":{"line":269,"column":1},"end":{"line":269,"column":1}},"key":"ZSlsWK11jx"}],"key":"D0BJxC2dFO"}],"class":"dropdown","key":"PHXu9uoxNw"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"a = 1;  b = -(1e6 + 1e-6);  c = 1;\nx1 = (-b + sqrt(b**2 - 4*a*c)) / 2*a\nx2 = (-b - sqrt(b**2 - 4*a*c)) / 2*a\nprint(x1, x2)","key":"PuUEaD4L8c"},{"type":"output","id":"C1hVGl6TJCVpgGX95KEOv","data":[{"output_type":"stream","name":"stdout","text":"1000000.0 1.00000761449337e-06\n"}],"key":"dBiBFnPnKQ"}],"data":{},"key":"q97SkFoaa0"},{"type":"paragraph","position":{"start":{"line":279,"column":1},"end":{"line":279,"column":1}},"children":[{"type":"text","value":"The first value is correct to all stored digits, but the second has fewer than six accurate digits:","position":{"start":{"line":279,"column":1},"end":{"line":279,"column":1}},"key":"I2GmqyRF62"}],"key":"vVz9tRTzvN"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"error = abs(1e-6 - x2) / 1e-6 \nprint(f\"There are {-log10(error):.2f} accurate digits.\")","key":"ioN2zQDDD2"},{"type":"output","id":"Nf6DB7vseEbtyv0ggUejk","data":[{"output_type":"stream","name":"stdout","text":"There are 5.12 accurate digits.\n"}],"key":"t4VBpuCtdQ"}],"data":{},"key":"KHgjraV2BJ"},{"type":"paragraph","position":{"start":{"line":286,"column":1},"end":{"line":286,"column":1}},"children":[{"type":"text","value":"The instability is easily explained. Since ","position":{"start":{"line":286,"column":1},"end":{"line":286,"column":1}},"key":"WtLMTgDLmD"},{"type":"inlineMath","value":"a=c=1","position":{"start":{"line":286,"column":1},"end":{"line":286,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi><mo>=</mo><mi>c</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">a=c=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">c</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"w7cPz9wlJj"},{"type":"text","value":", we treat them as exact numbers. First, we compute the condition numbers with respect to ","position":{"start":{"line":286,"column":1},"end":{"line":286,"column":1}},"key":"CPaX6saklG"},{"type":"inlineMath","value":"b","position":{"start":{"line":286,"column":1},"end":{"line":286,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>b</mi></mrow><annotation encoding=\"application/x-tex\">b</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">b</span></span></span></span>","key":"Kh9reL9UzI"},{"type":"text","value":" for each elementary step in finding the “good” root:","position":{"start":{"line":286,"column":1},"end":{"line":286,"column":1}},"key":"BRW1Xgn836"}],"key":"RdgpVT7V8m"},{"type":"table","position":{"start":{"line":288,"column":1},"end":{"line":294,"column":1}},"children":[{"type":"tableRow","position":{"start":{"line":288,"column":1},"end":{"line":288,"column":1}},"children":[{"type":"tableCell","header":true,"align":"left","position":{"start":{"line":288,"column":1},"end":{"line":288,"column":1}},"children":[{"type":"text","value":"Calculation","position":{"start":{"line":288,"column":1},"end":{"line":288,"column":1}},"key":"myuhin3Y4Z"}],"key":"SpHU9LPAdM"},{"type":"tableCell","header":true,"align":"left","position":{"start":{"line":288,"column":1},"end":{"line":288,"column":1}},"children":[{"type":"text","value":"Result","position":{"start":{"line":288,"column":1},"end":{"line":288,"column":1}},"key":"TEDCeVUhdg"}],"key":"UL3cDWVoXD"},{"type":"tableCell","header":true,"align":"left","position":{"start":{"line":288,"column":1},"end":{"line":288,"column":1}},"children":[{"type":"text","value":"κ","position":{"start":{"line":288,"column":1},"end":{"line":288,"column":1}},"key":"cEXIoMBacs"}],"key":"vff0EjvuB3"}],"key":"yVrZqXouxd"},{"type":"tableRow","position":{"start":{"line":290,"column":1},"end":{"line":290,"column":1}},"children":[{"type":"tableCell","align":"left","position":{"start":{"line":290,"column":1},"end":{"line":290,"column":1}},"children":[{"type":"inlineMath","value":"u_1 = b^2","position":{"start":{"line":290,"column":1},"end":{"line":290,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>u</mi><mn>1</mn></msub><mo>=</mo><msup><mi>b</mi><mn>2</mn></msup></mrow><annotation encoding=\"application/x-tex\">u_1 = b^2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span>","key":"N2z0G7vgSX"}],"key":"DcUvL9c0s3"},{"type":"tableCell","align":"left","position":{"start":{"line":290,"column":1},"end":{"line":290,"column":1}},"children":[{"type":"inlineMath","value":"1.000000000002000\\times 10^{12}","position":{"start":{"line":290,"column":1},"end":{"line":290,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1.000000000002000</mn><mo>×</mo><mn>1</mn><msup><mn>0</mn><mn>12</mn></msup></mrow><annotation encoding=\"application/x-tex\">1.000000000002000\\times 10^{12}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">1.000000000002000</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">12</span></span></span></span></span></span></span></span></span></span></span></span>","key":"brXe2MErVL"}],"key":"AbiXbBI0j2"},{"type":"tableCell","align":"left","position":{"start":{"line":290,"column":1},"end":{"line":290,"column":1}},"children":[{"type":"text","value":"2","position":{"start":{"line":290,"column":1},"end":{"line":290,"column":1}},"key":"JtSXJzFwtn"}],"key":"FYfLsPnvqY"}],"key":"FHq0VGQsYy"},{"type":"tableRow","position":{"start":{"line":291,"column":1},"end":{"line":291,"column":1}},"children":[{"type":"tableCell","align":"left","position":{"start":{"line":291,"column":1},"end":{"line":291,"column":1}},"children":[{"type":"inlineMath","value":"u_2 = u_1 - 4","position":{"start":{"line":291,"column":1},"end":{"line":291,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>u</mi><mn>2</mn></msub><mo>=</mo><msub><mi>u</mi><mn>1</mn></msub><mo>−</mo><mn>4</mn></mrow><annotation encoding=\"application/x-tex\">u_2 = u_1 - 4</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">4</span></span></span></span>","key":"lPnCOG213D"}],"key":"m2DK1vO75I"},{"type":"tableCell","align":"left","position":{"start":{"line":291,"column":1},"end":{"line":291,"column":1}},"children":[{"type":"inlineMath","value":"9.999999999980000\\times 10^{11}","position":{"start":{"line":291,"column":1},"end":{"line":291,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>9.999999999980000</mn><mo>×</mo><mn>1</mn><msup><mn>0</mn><mn>11</mn></msup></mrow><annotation encoding=\"application/x-tex\">9.999999999980000\\times 10^{11}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">9.999999999980000</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">11</span></span></span></span></span></span></span></span></span></span></span></span>","key":"Wwb6KWk1oj"}],"key":"XF6wS6LjmE"},{"type":"tableCell","align":"left","position":{"start":{"line":291,"column":1},"end":{"line":291,"column":1}},"children":[{"type":"inlineMath","value":"\\approx 1.00","position":{"start":{"line":291,"column":1},"end":{"line":291,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>≈</mo><mn>1.00</mn></mrow><annotation encoding=\"application/x-tex\">\\approx 1.00</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4831em;\"></span><span class=\"mrel\">≈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1.00</span></span></span></span>","key":"LmEZrNOz7c"}],"key":"gjeBc83aEa"}],"key":"R6Ij0urq7a"},{"type":"tableRow","position":{"start":{"line":292,"column":1},"end":{"line":292,"column":1}},"children":[{"type":"tableCell","align":"left","position":{"start":{"line":292,"column":1},"end":{"line":292,"column":1}},"children":[{"type":"inlineMath","value":"u_3 = \\sqrt{u_2}","position":{"start":{"line":292,"column":1},"end":{"line":292,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>u</mi><mn>3</mn></msub><mo>=</mo><msqrt><msub><mi>u</mi><mn>2</mn></msub></msqrt></mrow><annotation encoding=\"application/x-tex\">u_3 = \\sqrt{u_2}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.04em;vertical-align:-0.3147em;\"></span><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7253em;\"><span class=\"svg-align\" style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\" style=\"padding-left:0.833em;\"><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-2.6853em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"hide-tail\" style=\"min-width:0.853em;height:1.08em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\nc69,-144,104.5,-217.7,106.5,-221\nl0 -0\nc5.3,-9.3,12,-14,20,-14\nH400000v40H845.2724\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\nM834 80h400000v40h-400000z'/></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3147em;\"><span></span></span></span></span></span></span></span></span>","key":"IWO7HJ7Gyr"}],"key":"YooC6lqsU3"},{"type":"tableCell","align":"left","position":{"start":{"line":292,"column":1},"end":{"line":292,"column":1}},"children":[{"type":"text","value":"999999.9999990000","position":{"start":{"line":292,"column":1},"end":{"line":292,"column":1}},"key":"ujM25dpE5v"}],"key":"NGy2xwt6bY"},{"type":"tableCell","align":"left","position":{"start":{"line":292,"column":1},"end":{"line":292,"column":1}},"children":[{"type":"text","value":"1/2","position":{"start":{"line":292,"column":1},"end":{"line":292,"column":1}},"key":"bdGamQplgv"}],"key":"kIYv0LL2AU"}],"key":"CnfnfCRcrO"},{"type":"tableRow","position":{"start":{"line":293,"column":1},"end":{"line":293,"column":1}},"children":[{"type":"tableCell","align":"left","position":{"start":{"line":293,"column":1},"end":{"line":293,"column":1}},"children":[{"type":"inlineMath","value":"u_4 = u_3 - b","position":{"start":{"line":293,"column":1},"end":{"line":293,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>u</mi><mn>4</mn></msub><mo>=</mo><msub><mi>u</mi><mn>3</mn></msub><mo>−</mo><mi>b</mi></mrow><annotation encoding=\"application/x-tex\">u_4 = u_3 - b</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">4</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">b</span></span></span></span>","key":"nRkBLdMtKQ"}],"key":"Hci7RlVVIR"},{"type":"tableCell","align":"left","position":{"start":{"line":293,"column":1},"end":{"line":293,"column":1}},"children":[{"type":"text","value":"2000000","position":{"start":{"line":293,"column":1},"end":{"line":293,"column":1}},"key":"PBUmzAAQ8a"}],"key":"FST4K3AWJ5"},{"type":"tableCell","align":"left","position":{"start":{"line":293,"column":1},"end":{"line":293,"column":1}},"children":[{"type":"inlineMath","value":"\\approx 0.500","position":{"start":{"line":293,"column":1},"end":{"line":293,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>≈</mo><mn>0.500</mn></mrow><annotation encoding=\"application/x-tex\">\\approx 0.500</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4831em;\"></span><span class=\"mrel\">≈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0.500</span></span></span></span>","key":"OqJJn8B7r8"}],"key":"pUnrGvlXwY"}],"key":"bb0OoJZqlg"},{"type":"tableRow","position":{"start":{"line":294,"column":1},"end":{"line":294,"column":1}},"children":[{"type":"tableCell","align":"left","position":{"start":{"line":294,"column":1},"end":{"line":294,"column":1}},"children":[{"type":"inlineMath","value":"u_5 = u_4/2","position":{"start":{"line":294,"column":1},"end":{"line":294,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>u</mi><mn>5</mn></msub><mo>=</mo><msub><mi>u</mi><mn>4</mn></msub><mi mathvariant=\"normal\">/</mi><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">u_5 = u_4/2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">5</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">4</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">/2</span></span></span></span>","key":"ZjloaOdErX"}],"key":"D3YKo6p5wV"},{"type":"tableCell","align":"left","position":{"start":{"line":294,"column":1},"end":{"line":294,"column":1}},"children":[{"type":"text","value":"1000000","position":{"start":{"line":294,"column":1},"end":{"line":294,"column":1}},"key":"SxAok7Peqj"}],"key":"HY7dPwXhhi"},{"type":"tableCell","align":"left","position":{"start":{"line":294,"column":1},"end":{"line":294,"column":1}},"children":[{"type":"text","value":"1","position":{"start":{"line":294,"column":1},"end":{"line":294,"column":1}},"key":"y60rK08Xcg"}],"key":"N6tKBnr1Xy"}],"key":"JVOECCignM"}],"key":"l8PjhDmARC"},{"type":"paragraph","position":{"start":{"line":296,"column":1},"end":{"line":296,"column":1}},"children":[{"type":"text","value":"Using ","position":{"start":{"line":296,"column":1},"end":{"line":296,"column":1}},"key":"dZN3QXOBzS"},{"type":"crossReference","kind":"equation","identifier":"condition-chain","label":"condition-chain","children":[{"type":"text","value":"(","key":"Vu1adWzrIz"},{"type":"text","value":"1.2.9","key":"uJFU5vi8lF"},{"type":"text","value":")","key":"XODWTWPlf8"}],"template":"(%s)","enumerator":"1.2.9","resolved":true,"html_id":"condition-chain","remote":true,"url":"/conditioning","dataUrl":"/conditioning.json","key":"NL3pGZZs80"},{"type":"text","value":", the chain rule for condition numbers, the conditioning of the entire chain is the product of the individual steps, so there is essentially no growth of relative error here. However, if we use the quadratic formula for the “bad” root, the next-to-last step becomes ","position":{"start":{"line":296,"column":1},"end":{"line":296,"column":1}},"key":"jAYMh8hzzb"},{"type":"inlineMath","value":"u_4=(-u_3) - b","position":{"start":{"line":296,"column":1},"end":{"line":296,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>u</mi><mn>4</mn></msub><mo>=</mo><mo stretchy=\"false\">(</mo><mo>−</mo><msub><mi>u</mi><mn>3</mn></msub><mo stretchy=\"false\">)</mo><mo>−</mo><mi>b</mi></mrow><annotation encoding=\"application/x-tex\">u_4=(-u_3) - b</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">4</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\">−</span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">b</span></span></span></span>","key":"zZ3hbvWy8p"},{"type":"text","value":", and now  ","position":{"start":{"line":296,"column":1},"end":{"line":296,"column":1}},"key":"Az7cEIWeYx"},{"type":"inlineMath","value":"\\kappa=|u_3|/|u_4|\\approx 5\\times 10^{11}","position":{"start":{"line":296,"column":1},"end":{"line":296,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>κ</mi><mo>=</mo><mi mathvariant=\"normal\">∣</mi><msub><mi>u</mi><mn>3</mn></msub><mi mathvariant=\"normal\">∣</mi><mi mathvariant=\"normal\">/</mi><mi mathvariant=\"normal\">∣</mi><msub><mi>u</mi><mn>4</mn></msub><mi mathvariant=\"normal\">∣</mi><mo>≈</mo><mn>5</mn><mo>×</mo><mn>1</mn><msup><mn>0</mn><mn>11</mn></msup></mrow><annotation encoding=\"application/x-tex\">\\kappa=|u_3|/|u_4|\\approx 5\\times 10^{11}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">κ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">∣</span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">∣/∣</span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">4</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">∣</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">5</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">11</span></span></span></span></span></span></span></span></span></span></span></span>","key":"ha81qBNQSx"},{"type":"text","value":". So we can expect to lose 11 digits of accuracy, which is what we observed. The key issue is the subtractive cancellation in this one step.","position":{"start":{"line":296,"column":1},"end":{"line":296,"column":1}},"key":"X9nUA4Eggz"}],"key":"z9L5Yvm3yG"}],"label":"demo-stability-quadbad-python","identifier":"demo-stability-quadbad-python","html_id":"demo-stability-quadbad-python","key":"ZVNm5agVCa"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-stability-quadgood","label":"demo-stability-quadgood","kind":"proof:example","position":{"start":{"line":300,"column":1},"end":{"line":300,"column":25}},"children":[{"type":"text","value":"Example ","key":"e0PnPJvq6o"},{"type":"text","value":"1.4.2","key":"q4yVnsBNIC"}],"template":"Example %s","enumerator":"1.4.2","resolved":true,"html_id":"demo-stability-quadgood","remote":true,"url":"/stability","dataUrl":"/stability.json","key":"zFJKjpijZd"}],"key":"zhMGIiVZSv"},{"type":"paragraph","position":{"start":{"line":302,"column":1},"end":{"line":302,"column":1}},"children":[{"type":"text","value":"We repeat the rootfinding experiment of ","position":{"start":{"line":302,"column":1},"end":{"line":302,"column":1}},"key":"KgHuZMjfmJ"},{"type":"crossReference","kind":"proof:example","identifier":"demo-stability-quadbad","label":"demo-stability-quadbad","children":[{"type":"text","value":"Demo ","key":"UcUFR0TfhP"},{"type":"text","value":"1.4.1","key":"TNDWbcTaOI"}],"template":"Example %s","enumerator":"1.4.1","resolved":true,"html_id":"demo-stability-quadbad","remote":true,"url":"/stability","dataUrl":"/stability.json","key":"PjsPn8iDjF"},{"type":"text","value":" with an alternative algorithm.","position":{"start":{"line":302,"column":1},"end":{"line":302,"column":1}},"key":"xslOu9sFIx"}],"key":"UiBMVkX2g9"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"a = 1;  b = -(1e6 + 1e-6);  c = 1;","key":"wh0ehX06P5"},{"type":"output","id":"4T4rY_h35RQHjN6r_VBlt","data":[],"key":"PtnUcMmgbY"}],"data":{},"key":"WrjCYKsrTr"},{"type":"paragraph","position":{"start":{"line":308,"column":1},"end":{"line":308,"column":1}},"children":[{"type":"text","value":"First, we find the “good” root using the quadratic formula.","position":{"start":{"line":308,"column":1},"end":{"line":308,"column":1}},"key":"kQv32Oa2MA"}],"key":"DXp6fdwCad"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"x1 = (-b + sqrt(b**2 - 4*a*c)) / 2*a","key":"tubhuFSCvJ"},{"type":"output","id":"YsDlJByTF82YpSiEC8QuR","data":[],"key":"fsqdIhYxR7"}],"data":{},"key":"ix14YeXlGf"},{"type":"paragraph","position":{"start":{"line":314,"column":1},"end":{"line":314,"column":1}},"children":[{"type":"text","value":"Then we use the identity ","position":{"start":{"line":314,"column":1},"end":{"line":314,"column":1}},"key":"EtNI3F5U7I"},{"type":"inlineMath","value":"x_1x_2=\\frac{c}{a}","position":{"start":{"line":314,"column":1},"end":{"line":314,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub><msub><mi>x</mi><mn>2</mn></msub><mo>=</mo><mfrac><mi>c</mi><mi>a</mi></mfrac></mrow><annotation encoding=\"application/x-tex\">x_1x_2=\\frac{c}{a}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0404em;vertical-align:-0.345em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6954em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">a</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">c</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span>","key":"ZXXFsQh3Ne"},{"type":"text","value":" to compute the smaller root:","position":{"start":{"line":314,"column":1},"end":{"line":314,"column":1}},"key":"KtrUauPAjl"}],"key":"lKKFHWQT2l"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"x2 = c / (a * x1)\nprint(x1, x2)","key":"xF5K0vx6or"},{"type":"output","id":"TBHS8pTIdwoaT9smkFLWM","data":[{"output_type":"stream","name":"stdout","text":"1000000.0 1e-06\n"}],"key":"MGxlrNA0V6"}],"data":{},"key":"ClkTaTjVXe"},{"type":"paragraph","position":{"start":{"line":321,"column":1},"end":{"line":321,"column":1}},"children":[{"type":"text","value":"To be sure we have an accurate result, we compute its relative error.","position":{"start":{"line":321,"column":1},"end":{"line":321,"column":1}},"key":"uR1OQU1lXU"}],"key":"t7GSJZSEhn"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(abs(x2 - 1e-6) / 1e-6)","key":"ZuQRpheqA1"},{"type":"output","id":"LQOI7O_wZYkEIvmuymUVt","data":[{"output_type":"stream","name":"stdout","text":"0.0\n"}],"key":"SRbYs8aSfO"}],"data":{},"key":"vZc3qUrUbE"}],"label":"demo-stability-quadgood-python","identifier":"demo-stability-quadgood-python","html_id":"demo-stability-quadgood-python","key":"bzzXHXsCyW"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-stability-roots","label":"demo-stability-roots","kind":"proof:example","position":{"start":{"line":329,"column":1},"end":{"line":329,"column":22}},"children":[{"type":"text","value":"Example ","key":"PAcQ1UfYih"},{"type":"text","value":"1.4.3","key":"vW3z8Oytf0"}],"template":"Example %s","enumerator":"1.4.3","resolved":true,"html_id":"demo-stability-roots","remote":true,"url":"/stability","dataUrl":"/stability.json","key":"mUeneZsAOZ"}],"key":"wQK9wsCe0w"},{"type":"paragraph","position":{"start":{"line":332,"column":1},"end":{"line":332,"column":1}},"children":[{"type":"text","value":"Our first step is to construct a polynomial with six known roots.","position":{"start":{"line":332,"column":1},"end":{"line":332,"column":1}},"key":"kBMscRkXSj"}],"key":"Zpm8bR5E1N"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"r = [-2, -1, 1, 1, 3, 6]\np = poly(r)\nprint(p)","key":"LVi5wUqrUt"},{"type":"output","id":"kiuZaBMnbiq6INiNxvTRt","data":[{"output_type":"stream","name":"stdout","text":"[  1.  -8.   6.  44. -43. -36.  36.]\n"}],"key":"ciXDehbTeP"}],"data":{},"key":"tn2EsxVHeo"},{"type":"paragraph","position":{"start":{"line":340,"column":1},"end":{"line":340,"column":1}},"children":[{"type":"text","value":"Now we use a standard numerical method for finding those roots, pretending that we don’t know them already. This corresponds to ","position":{"start":{"line":340,"column":1},"end":{"line":340,"column":1}},"key":"KYqoVPJ1u1"},{"type":"inlineMath","value":"\\tilde{y}","position":{"start":{"line":340,"column":1},"end":{"line":340,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mover accent=\"true\"><mi>y</mi><mo>~</mo></mover></mrow><annotation encoding=\"application/x-tex\">\\tilde{y}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8623em;vertical-align:-0.1944em;\"></span><span class=\"mord accent\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6679em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span><span style=\"top:-3.35em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.1944em;\"><span class=\"mord\">~</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1944em;\"><span></span></span></span></span></span></span></span></span>","key":"JKM8y2gaFQ"},{"type":"text","value":" in ","position":{"start":{"line":340,"column":1},"end":{"line":340,"column":1}},"key":"NOjIkgkuOO"},{"type":"crossReference","kind":"proof:definition","identifier":"definition-stability-backward","label":"definition-stability-backward","children":[{"type":"text","value":"Definition ","key":"wJTkkn1MAm"},{"type":"text","value":"1.4.1","key":"jvOzSadKja"}],"template":"Definition %s","enumerator":"1.4.1","resolved":true,"html_id":"definition-stability-backward","remote":true,"url":"/stability","dataUrl":"/stability.json","key":"obZJqJyfr8"},{"type":"text","value":".","position":{"start":{"line":340,"column":1},"end":{"line":340,"column":1}},"key":"fsctFou2fs"}],"key":"Sy0afBxaWK"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"r_computed = sort(roots(p))\nprint(r_computed)","key":"tRK79h0hj6"},{"type":"output","id":"wj9BnMj8dHUTQpykhBWB_","data":[{"output_type":"stream","name":"stdout","text":"[-2.+0.00000000e+00j -1.+0.00000000e+00j  1.-1.31638218e-08j\n  1.+1.31638218e-08j  3.+0.00000000e+00j  6.+0.00000000e+00j]\n"}],"key":"s9x10ZCeft"}],"data":{},"key":"hBkScaaLZx"},{"type":"paragraph","position":{"start":{"line":347,"column":1},"end":{"line":347,"column":1}},"children":[{"type":"text","value":"Here are the relative errors in each of the computed roots.","position":{"start":{"line":347,"column":1},"end":{"line":347,"column":1}},"key":"l3xAdwkT13"}],"key":"IKkPiNgVBC"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(abs(r - r_computed) / r)","key":"yCQx4rGsfF"},{"type":"output","id":"5pBysJPl0RBlBwIVWvoyH","data":[{"output_type":"stream","name":"stdout","text":"[-5.55111512e-16 -2.22044605e-16  1.31638218e-08  1.31638218e-08\n  4.44089210e-16  1.33226763e-15]\n"}],"key":"I7bFUvxufs"}],"data":{},"key":"SS2AF7L7Wo"},{"type":"paragraph","position":{"start":{"line":353,"column":1},"end":{"line":353,"column":1}},"children":[{"type":"text","value":"It seems that the forward error is acceptably close to machine epsilon for double precision in all cases except the double root at ","position":{"start":{"line":353,"column":1},"end":{"line":353,"column":1}},"key":"PrucvZDHIm"},{"type":"inlineMath","value":"x=1","position":{"start":{"line":353,"column":1},"end":{"line":353,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">x=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"DgmwSaviK6"},{"type":"text","value":". This is not a surprise, though, given the poor conditioning at such roots.","position":{"start":{"line":353,"column":1},"end":{"line":353,"column":1}},"key":"RltiwRk1rl"}],"key":"VyuRJkQcbr"},{"type":"paragraph","position":{"start":{"line":355,"column":1},"end":{"line":355,"column":1}},"children":[{"type":"text","value":"Let’s consider the backward error. The data in the rootfinding problem is the polynomial coefficients. We can apply poly to find the coefficients of the polynomial (that is, the data) whose roots were actually computed by the numerical algorithm. This corresponds to ","position":{"start":{"line":355,"column":1},"end":{"line":355,"column":1}},"key":"EZXISS75F3"},{"type":"inlineMath","value":"\\tilde{x}","position":{"start":{"line":355,"column":1},"end":{"line":355,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mover accent=\"true\"><mi>x</mi><mo>~</mo></mover></mrow><annotation encoding=\"application/x-tex\">\\tilde{x}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6679em;\"></span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6679em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\">x</span></span><span style=\"top:-3.35em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.2222em;\"><span class=\"mord\">~</span></span></span></span></span></span></span></span></span></span>","key":"nuPmCsgB9m"},{"type":"text","value":" in ","position":{"start":{"line":355,"column":1},"end":{"line":355,"column":1}},"key":"fjNsqeE1sY"},{"type":"crossReference","kind":"proof:definition","identifier":"definition-stability-backward","label":"definition-stability-backward","children":[{"type":"text","value":"Definition ","key":"iqnVZrhjL7"},{"type":"text","value":"1.4.1","key":"C33RzetyCp"}],"template":"Definition %s","enumerator":"1.4.1","resolved":true,"html_id":"definition-stability-backward","remote":true,"url":"/stability","dataUrl":"/stability.json","key":"TtguX9Y435"},{"type":"text","value":".","position":{"start":{"line":355,"column":1},"end":{"line":355,"column":1}},"key":"olw5hMZVjy"}],"key":"CPbokJTvTd"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"p_computed = poly(r_computed)\nprint(p_computed)","key":"BiMmsc07EA"},{"type":"output","id":"u185UomfoYWLyxo8q83AU","data":[{"output_type":"stream","name":"stdout","text":"[  1.  -8.   6.  44. -43. -36.  36.]\n"}],"key":"PWTzgx7kXC"}],"data":{},"key":"BV468pxgzK"},{"type":"paragraph","position":{"start":{"line":362,"column":1},"end":{"line":362,"column":1}},"children":[{"type":"text","value":"We find that in a relative sense, these coefficients are very close to those of the original, exact polynomial:","position":{"start":{"line":362,"column":1},"end":{"line":362,"column":1}},"key":"vGR1Is5E40"}],"key":"xpAB5rR4xv"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(abs(p - p_computed) / p)","key":"yXJjuW1U34"},{"type":"output","id":"DoMt56_M72OnZMUBPUx90","data":[{"output_type":"stream","name":"stdout","text":"[ 0.00000000e+00 -1.11022302e-15  2.96059473e-15  1.45338287e-15\n -3.63533493e-15 -1.38161088e-15  3.75008666e-15]\n"}],"key":"KtHvne6hIm"}],"data":{},"key":"SHpAvCGnHx"},{"type":"paragraph","position":{"start":{"line":368,"column":1},"end":{"line":368,"column":1}},"children":[{"type":"text","value":"In summary, even though there are some computed roots relatively far from their correct values, they are nevertheless the roots of a polynomial that is very close to the original.","position":{"start":{"line":368,"column":1},"end":{"line":368,"column":1}},"key":"g5WvbfKR4t"}],"key":"m8Ts8G9OyN"}],"label":"demo-stability-roots-python","identifier":"demo-stability-roots-python","html_id":"demo-stability-roots-python","key":"P3G5jpYpjA"}],"key":"Voiz4jbUIs"}],"key":"XjwJglcitD"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Python setup","url":"/setup-2","group":"Python codes"},"next":{"title":"Chapter 2","url":"/chapter2-2","group":"Python codes"}}},"domain":"http://localhost:3000"}