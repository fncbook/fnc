{"kind":"Notebook","sha256":"4a74e2f31d0d1266b5d4bfbbeeee9e81d17462e9f8bba29fbb3aac2e706540f3","slug":"derive-2","location":"/chapter2/section4/python/derive.ipynb","dependencies":[],"frontmatter":{"numbering":{"heading_1":{"enabled":false},"heading_2":{"enabled":false},"heading_3":{"enabled":false},"heading_4":{"enabled":false},"heading_5":{"enabled":false},"heading_6":{"enabled":false}},"kernelspec":{"name":"python3","display_name":"Python 3","language":"python"},"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"exports":[{"format":"ipynb","filename":"derive.ipynb","url":"/fnc/build/derive-8c410d08b9f9b91a6732c1e25676426d.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:43:18.453296Z","iopub.status.busy":"2025-01-11T17:43:18.453094Z","iopub.status.idle":"2025-01-11T17:43:18.796806Z","shell.execute_reply":"2025-01-11T17:43:18.796412Z"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"exec(open(\"../../../python/FNC_init.py\").read())","visibility":"show","key":"rTeBM7kybs"},{"type":"output","id":"9gGAxeFLGWrC70_VWYZ8G","data":[],"visibility":"show","key":"rUYaibVAx1"}],"visibility":"remove","key":"Dw2JnihSF6"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"vm3UuN4fJS"},{"type":"text","value":"2.4.3","key":"EE2HJxvmw2"}],"key":"xNQLFwHZOC"}],"identifier":"demo-lu-derive","label":"demo-lu-derive","kind":"proof:example","template":"Example %s","enumerator":"2.4.3","resolved":true,"html_id":"demo-lu-derive","remote":true,"url":"/lu","dataUrl":"/lu.json","key":"tqt5gNpg4k"}],"key":"WQgTrig2rp"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"For illustration, we work on a ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"AqFJVgidtP"},{"type":"inlineMath","value":"4 \\times 4","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>4</mn><mo>×</mo><mn>4</mn></mrow><annotation encoding=\"application/x-tex\">4 \\times 4</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">4</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">4</span></span></span></span>","key":"FG8Connptc"},{"type":"text","value":" matrix. We name it with a subscript in preparation for what comes.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"dSD6UyAk7x"}],"key":"VGd6NuWt7A"}],"key":"CUP4sLlvZk"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:43:18.798439Z","iopub.status.busy":"2025-01-11T17:43:18.798317Z","iopub.status.idle":"2025-01-11T17:43:18.800232Z","shell.execute_reply":"2025-01-11T17:43:18.800013Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"A_1 = array([\n     [2,    0,    4,    3], \n     [-4,    5,   -7,  -10], \n     [1,   15,    2,   -4.5],\n     [-2,    0,    2,  -13]\n        ])\nL = eye(4)\nU = zeros((4, 4));","key":"ZjvkKuV4gr"},{"type":"output","id":"aHOjipvPq6gmDERl-bT1q","data":[],"key":"oelDgP23aj"}],"key":"KXvb0t9O96"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now we appeal to ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GnEyhm1xa1"},{"type":"crossReference","kind":"equation","identifier":"outer-row1","label":"outer-row1","children":[{"type":"text","value":"(","key":"YtcQpR0iqs"},{"type":"text","value":"2.4.5","key":"rkf55QuECh"},{"type":"text","value":")","key":"gHTi9L18MK"}],"template":"(%s)","enumerator":"2.4.5","resolved":true,"html_id":"outer-row1","remote":true,"url":"/lu","dataUrl":"/lu.json","key":"QUD1mCdYTW"},{"type":"text","value":". Since ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"P47kWyL8dN"},{"type":"inlineMath","value":"L_{11}=1","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>L</mi><mn>11</mn></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">L_{11}=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">L</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">11</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"fuMqiLtTHq"},{"type":"text","value":", we see that the first row of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"X2AXbpirte"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"DT6WWB2EPS"},{"type":"text","value":" is just the first row of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LZpqdygCIm"},{"type":"inlineMath","value":"\\mathbf{A}_1","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">A</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8361em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"TsSAAgccN1"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dbGs4WFZbA"}],"key":"XPUoCO74py"}],"key":"sBiPaIokwB"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:43:18.801375Z","iopub.status.busy":"2025-01-11T17:43:18.801294Z","iopub.status.idle":"2025-01-11T17:43:18.803236Z","shell.execute_reply":"2025-01-11T17:43:18.802960Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"U[0, :] = A_1[0, :]\nprint(U)","key":"gjDy6YoKvy"},{"type":"output","id":"rHbALNjgT1e-mLOf0naM9","data":[{"name":"stdout","output_type":"stream","text":"[[2. 0. 4. 3.]\n [0. 0. 0. 0.]\n [0. 0. 0. 0.]\n [0. 0. 0. 0.]]\n"}],"key":"Ko8Gc93fKS"}],"key":"CbEzD8mXBm"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"From ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pDYOOZaU2x"},{"type":"crossReference","kind":"equation","identifier":"outer-col1","label":"outer-col1","children":[{"type":"text","value":"(","key":"PbGFliD94B"},{"type":"text","value":"2.4.6","key":"I22x3DVlCw"},{"type":"text","value":")","key":"ul3B9ZbRvB"}],"template":"(%s)","enumerator":"2.4.6","resolved":true,"html_id":"outer-col1","remote":true,"url":"/lu","dataUrl":"/lu.json","key":"s8fG1vG4Lt"},{"type":"text","value":", we see that we can find the first column of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"VuOa3wy4nI"},{"type":"inlineMath","value":"\\mathbf{L}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">L</span></span></span></span>","key":"LHQrX4a78a"},{"type":"text","value":" from the first column of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dcxsBzAbZ7"},{"type":"inlineMath","value":"\\mathbf{A}_1","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">A</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8361em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"SV0vR15iYI"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"goDuVeap6e"}],"key":"ZA9aIzgntb"}],"key":"SD3a2AM6Sw"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:43:18.804431Z","iopub.status.busy":"2025-01-11T17:43:18.804351Z","iopub.status.idle":"2025-01-11T17:43:18.806491Z","shell.execute_reply":"2025-01-11T17:43:18.806247Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"L[:, 0] = A_1[:, 0] / U[0, 0]\nprint(L)","key":"xitxXSVg20"},{"type":"output","id":"mCVq3iWZTulPhyP84y7i2","data":[{"name":"stdout","output_type":"stream","text":"[[ 1.   0.   0.   0. ]\n [-2.   1.   0.   0. ]\n [ 0.5  0.   1.   0. ]\n [-1.   0.   0.   1. ]]\n"}],"key":"X7Zay2l3UE"}],"key":"fmUaof1Xld"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We have obtained the first term in the sum ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"or8hWNiNQW"},{"type":"crossReference","kind":"equation","identifier":"matrixouter","label":"matrixouter","children":[{"type":"text","value":"(","key":"FZBmQ1bzEN"},{"type":"text","value":"2.4.4","key":"H0JIt8p9cn"},{"type":"text","value":")","key":"MvR9RJcmLG"}],"template":"(%s)","enumerator":"2.4.4","resolved":true,"html_id":"matrixouter","remote":true,"url":"/lu","dataUrl":"/lu.json","key":"ydjERnxRc8"},{"type":"text","value":" for ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wtBCkl22uL"},{"type":"inlineMath","value":"\\mathbf{L}\\mathbf{U}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">LU</span></span></span></span>","key":"GzjTgKldDv"},{"type":"text","value":", and we subtract it away from ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Fts1JRp0jO"},{"type":"inlineMath","value":"\\mathbf{A}_1","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">A</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8361em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"fYZyE2BDGc"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KC3OjObFv3"}],"key":"QzycpGdGAK"}],"key":"nITufMn6j1"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:43:18.807729Z","iopub.status.busy":"2025-01-11T17:43:18.807639Z","iopub.status.idle":"2025-01-11T17:43:18.809945Z","shell.execute_reply":"2025-01-11T17:43:18.809689Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"A_2 = A_1 - outer(L[:, 0],  U[0, :])","key":"mBzrVVrvBR"},{"type":"output","id":"xCXv0DUYej1MP0pVkl-ki","data":[],"key":"LhNwl1Bcyi"}],"key":"bsYnTpMl9k"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"R8vzUHCYee"},{"type":"inlineMath","value":"\\mathbf{A}_2 = \\boldsymbol{\\ell}_2\\mathbf{u}_2^T + \\boldsymbol{\\ell}_3\\mathbf{u}_3^T + \\boldsymbol{\\ell}_4\\mathbf{u}_4^T.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">A</mi><mn>2</mn></msub><mo>=</mo><msub><mi mathvariant=\"bold\">ℓ</mi><mn>2</mn></msub><msubsup><mi mathvariant=\"bold\">u</mi><mn>2</mn><mi>T</mi></msubsup><mo>+</mo><msub><mi mathvariant=\"bold\">ℓ</mi><mn>3</mn></msub><msubsup><mi mathvariant=\"bold\">u</mi><mn>3</mn><mi>T</mi></msubsup><mo>+</mo><msub><mi mathvariant=\"bold\">ℓ</mi><mn>4</mn></msub><msubsup><mi mathvariant=\"bold\">u</mi><mn>4</mn><mi>T</mi></msubsup><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}_2 = \\boldsymbol{\\ell}_2\\mathbf{u}_2^T + \\boldsymbol{\\ell}_3\\mathbf{u}_3^T + \\boldsymbol{\\ell}_4\\mathbf{u}_4^T.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8361em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0894em;vertical-align:-0.2481em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">ℓ</span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathbf\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-2.4519em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2481em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0894em;vertical-align:-0.2481em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">ℓ</span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathbf\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-2.4519em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2481em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0894em;vertical-align:-0.2481em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">ℓ</span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">4</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathbf\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-2.4519em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">4</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2481em;\"><span></span></span></span></span></span></span><span class=\"mord\">.</span></span></span></span>","key":"mwljnYdUwM"},{"type":"text","value":" If we ignore the first row and first column of the matrices in this equation, then in what remains we are in the same situation as at the start. Specifically, only ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"FVjcvhJ2NC"},{"type":"inlineMath","value":"\\boldsymbol{\\ell}_2\\mathbf{u}_2^T","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">ℓ</mi><mn>2</mn></msub><msubsup><mi mathvariant=\"bold\">u</mi><mn>2</mn><mi>T</mi></msubsup></mrow><annotation encoding=\"application/x-tex\">\\boldsymbol{\\ell}_2\\mathbf{u}_2^T</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0894em;vertical-align:-0.2481em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">ℓ</span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathbf\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-2.4519em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2481em;\"><span></span></span></span></span></span></span></span></span></span>","key":"d0lprCaZlk"},{"type":"text","value":" has any effect on the second row and column, so we can deduce them now.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"l0HcK5Mzfn"}],"key":"m6JNrwIRTL"}],"key":"HY75w2AfFU"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:43:18.811170Z","iopub.status.busy":"2025-01-11T17:43:18.811085Z","iopub.status.idle":"2025-01-11T17:43:18.813063Z","shell.execute_reply":"2025-01-11T17:43:18.812821Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"U[1, :] = A_2[1, :]\nL[:, 1] = A_2[:, 1] / U[1, 1]\nprint(L)","key":"wh5kQfrxTr"},{"type":"output","id":"1QLuGOQtcd8N_MUiz9m7E","data":[{"name":"stdout","output_type":"stream","text":"[[ 1.   0.   0.   0. ]\n [-2.   1.   0.   0. ]\n [ 0.5  3.   1.   0. ]\n [-1.   0.   0.   1. ]]\n"}],"key":"jtm6Bs4I24"}],"key":"Jj9yxo4n98"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"If we subtract off the latest outer product, we have a matrix that is zero in the first ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"s4CN4DFyp8"},{"type":"emphasis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"two","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Y8NwTL0FnY"}],"key":"qNR8aGEB8t"},{"type":"text","value":" rows and columns.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"HBXxC9e2No"}],"key":"YUjOAOFWiR"}],"key":"Eb3RuCu72K"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:43:18.814134Z","iopub.status.busy":"2025-01-11T17:43:18.814059Z","iopub.status.idle":"2025-01-11T17:43:18.815694Z","shell.execute_reply":"2025-01-11T17:43:18.815464Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"A_3 = A_2 - outer(L[:, 1], U[1, :])","key":"VxLHIQI1hy"},{"type":"output","id":"tRv-BWESiQsVTqPYzsLnX","data":[],"key":"KxwN6um3Ld"}],"key":"PYoxfCaIfd"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now we can deal with the lower right ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qtnfrztdLR"},{"type":"inlineMath","value":"2\\times 2","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>2</mn><mo>×</mo><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">2\\times 2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">2</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span></span></span></span>","key":"TrCfozX1RI"},{"type":"text","value":" submatrix of the remainder in a similar fashion.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hdKGJLz5P4"}],"key":"JeQ4BSnKhJ"}],"key":"Xwkayez9Jv"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:43:18.816805Z","iopub.status.busy":"2025-01-11T17:43:18.816731Z","iopub.status.idle":"2025-01-11T17:43:18.818496Z","shell.execute_reply":"2025-01-11T17:43:18.818277Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"U[2, :] = A_3[2, :]\nL[:, 2] = A_3[:, 2] / U[2, 2]\nA_4 = A_3 - outer(L[:, 2], U[2, :])","key":"eynkwPIh2d"},{"type":"output","id":"3K_KL3METxMxF21Xw0PJd","data":[],"key":"ZNQaHV3WhQ"}],"key":"i6a0PdYitg"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Finally, we pick up the last unknown in the factors.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"EaUdTPc10f"}],"key":"RqQ3FbzmyN"}],"key":"RLAgIZe1qn"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:43:18.819657Z","iopub.status.busy":"2025-01-11T17:43:18.819587Z","iopub.status.idle":"2025-01-11T17:43:18.821149Z","shell.execute_reply":"2025-01-11T17:43:18.820935Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"U[3, 3] = A_4[3, 3]","key":"ePxznvrOfM"},{"type":"output","id":"K97soz02S7P1gKorjL_gJ","data":[],"key":"f36Sgh3m4X"}],"key":"DUaysxDh7H"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We now have all of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"n3ay9MwZsn"},{"type":"inlineMath","value":"\\mathbf{L}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">L</span></span></span></span>","key":"yn3y68eczZ"},{"type":"text","value":",","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Pj9uh8yhaA"}],"key":"EdYKDMvglr"}],"key":"AyuRKVkHow"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:43:18.822514Z","iopub.status.busy":"2025-01-11T17:43:18.822415Z","iopub.status.idle":"2025-01-11T17:43:18.824110Z","shell.execute_reply":"2025-01-11T17:43:18.823879Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"print(L)","key":"aml4r5Aond"},{"type":"output","id":"V0iEJa5SNcn2Udwk1Dat2","data":[{"name":"stdout","output_type":"stream","text":"[[ 1.   0.  -0.   0. ]\n [-2.   1.  -0.   0. ]\n [ 0.5  3.   1.   0. ]\n [-1.   0.  -2.   1. ]]\n"}],"key":"fHlv5FSEJH"}],"key":"btNBqfPHN0"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"and all of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"tlEL86nGHA"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"tpt2bOMctD"},{"type":"text","value":",","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"iZv3IQH084"}],"key":"LWvSJ3rw5u"}],"key":"wD4fkJmpbx"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:43:18.825520Z","iopub.status.busy":"2025-01-11T17:43:18.825419Z","iopub.status.idle":"2025-01-11T17:43:18.827242Z","shell.execute_reply":"2025-01-11T17:43:18.826978Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"print(U)","key":"Ek1uuR1qpy"},{"type":"output","id":"UW9qEHcitqbt6K4PwJNoT","data":[{"name":"stdout","output_type":"stream","text":"[[ 2.  0.  4.  3.]\n [ 0.  5.  1. -4.]\n [ 0.  0. -3.  6.]\n [ 0.  0.  0.  2.]]\n"}],"key":"SxjesuYLWc"}],"key":"qi2hQJKFDq"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We can verify that we have a correct factorization of the original matrix by computing the backward error:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TM05KJ6S0O"}],"key":"SOTHQrX7Lo"}],"key":"jWGxfUuMIp"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:43:18.828431Z","iopub.status.busy":"2025-01-11T17:43:18.828349Z","iopub.status.idle":"2025-01-11T17:43:18.831242Z","shell.execute_reply":"2025-01-11T17:43:18.831034Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"A_1 - L @ U","key":"L0pErvbs5M"},{"type":"output","id":"EFxLYKYvR6VrGNeTEvClk","data":[{"output_type":"execute_result","execution_count":12,"metadata":{},"data":{"text/plain":{"content":"array([[0., 0., 0., 0.],\n       [0., 0., 0., 0.],\n       [0., 0., 0., 0.],\n       [0., 0., 0., 0.]])","content_type":"text/plain"}}}],"key":"KakSjpcVSZ"}],"key":"BOsSjuddby"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"In floating point, we cannot expect the difference to be exactly zero as we found in this toy example. Instead, we would be satisfied to see that each element of the difference above is comparable in size to machine precision.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OJBGw5wdK2"}],"key":"hRSplupnSr"}],"key":"F0pleyM6S9"}],"key":"PGXXorQNA3"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Outertri","url":"/outertri-2","group":"Chapter 2"},"next":{"title":"Solve","url":"/solve-7","group":"Chapter 2"}}},"domain":"http://localhost:3000"}