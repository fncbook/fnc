{"kind":"Notebook","sha256":"5c74cb7b5d720c7b473ac0c30e29d93ae8a06b8caac1688f991415e8eac82a4e","slug":"linalg","location":"/chapter8/section1/julia/linalg.ipynb","dependencies":[],"frontmatter":{"numbering":{"heading_1":{"enabled":false},"heading_2":{"enabled":false},"heading_3":{"enabled":false},"heading_4":{"enabled":false},"heading_5":{"enabled":false},"heading_6":{"enabled":false}},"kernelspec":{"name":"julia-1.11","display_name":"Julia 1","language":"julia"},"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"exports":[{"format":"ipynb","filename":"linalg.ipynb","url":"/fnc/build/linalg-6aceab89b475bd3ef88fc1ba70386fc2.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"Pc3FM7i2xR"},{"type":"text","value":"8.1.4","key":"LQQkqEITrM"}],"key":"d8ltxKDrIS"}],"identifier":"demo-structure-linalg","label":"demo-structure-linalg","kind":"proof:example","template":"Example %s","enumerator":"8.1.4","resolved":true,"html_id":"demo-structure-linalg","remote":true,"url":"/structure-1","dataUrl":"/structure-1.json","key":"puZrbypYjN"}],"key":"grqApmUp26"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The following generates a random sparse matrix with prescribed eigenvalues.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"JmkcvRpw4T"}],"key":"eT6M4TGy37"}],"key":"jq6biqG4vt"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T16:40:03.702000Z","iopub.status.busy":"2025-01-14T16:40:01.420000Z","iopub.execute_input":"2025-01-14T16:40:01.804000Z","shell.execute_reply":"2025-01-14T16:40:03.701000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"using SparseArrays\nn = 4000\ndensity = 4e-4\nλ = @. 1 + 1 / (1:n)   # exact eigenvalues\nA = FNC.sprandsym(n, density, λ);","key":"NKB9BvTRMe"},{"type":"output","id":"J5LPeAgR37p8gWmc3fwKU","data":[],"key":"qQlyokKMWI"}],"key":"jDdI3ekUKU"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"ujVIwnMZkx"},{"type":"inlineCode","value":"eigs","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"UdO8DsQncy"},{"type":"text","value":" function from ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"lKhKobqO3K"},{"type":"inlineCode","value":"Arpack","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"hHcOWLdI8H"},{"type":"text","value":" finds a small number eigenvalues meeting some criterion. First, we ask for the 5 of largest (complex) magnitude using ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"kkDkgtoWge"},{"type":"inlineCode","value":"which=:LM","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"hFu0txCsaI"},{"type":"text","value":".","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"dz6gP8XGT2"}],"indexEntries":[{"entry":"Julia","subEntry":{"value":"eigs","kind":"entry"},"emphasis":true}],"label":"index-Q6xNSoMbds","identifier":"index-q6xnsombds","html_id":"index-q6xnsombds","key":"InRtUjlKF6"}],"key":"zSc9fxO4QF"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T16:40:06.737000Z","iopub.status.busy":"2025-01-14T16:40:03.707000Z","iopub.execute_input":"2025-01-14T16:40:03.707000Z","shell.execute_reply":"2025-01-14T16:40:06.737000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"using Arpack\nλmax, V = eigs(A, nev=5, which=:LM)    # Largest Magnitude\nfmt = ft_printf(\"%20.15f\")\npretty_table([λmax λ[1:5]], header=[\"found\", \"exact\"], formatters=fmt)","key":"kLhr9GIgL3"},{"type":"output","id":"ROtWK_NgIjHI4XntuwaG1","data":[{"name":"stdout","output_type":"stream","text":"┌──────────────────────┬──────────────────────┐\n│\u001b[1m                found \u001b[0m│\u001b[1m                exact \u001b[0m│\n├──────────────────────┼──────────────────────┤\n│    2.000000000000001 │    2.000000000000000 │\n│    1.500000000000000 │    1.500000000000000 │\n│    1.333333333333331 │    1.333333333333333 │\n│    1.250000000000003 │    1.250000000000000 │\n│    1.200000000000000 │    1.200000000000000 │\n└──────────────────────┴──────────────────────┘\n"}],"key":"FbAXUK8Lk7"}],"key":"GD0ZZzKJsD"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now we find the 5 closest to the value 1 in the complex plane, via ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"av26vZ5R3h"},{"type":"inlineCode","value":"sigma=1","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dSxPoTipNS"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"VicR6UVnIC"}],"key":"NeheVSqCAd"}],"key":"AEd6qHThyx"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T16:40:08.059000Z","iopub.status.busy":"2025-01-14T16:40:06.746000Z","iopub.execute_input":"2025-01-14T16:40:06.746000Z","shell.execute_reply":"2025-01-14T16:40:08.059000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"λ1, V = eigs(A, nev=5, sigma=1)    # closest to sigma\ndata = [λ1 λ[end:-1:end-4]]\npretty_table(data, header=[\"found\", \"exact\"], formatters=fmt)","key":"E1IDvO95mu"},{"type":"output","id":"n_DEYWZD9Jldblr_tbtE0","data":[{"name":"stdout","output_type":"stream","text":"┌──────────────────────┬──────────────────────┐\n│\u001b[1m                found \u001b[0m│\u001b[1m                exact \u001b[0m│\n├──────────────────────┼──────────────────────┤\n│    1.000250000000000 │    1.000250000000000 │\n│    1.000250062515629 │    1.000250062515629 │\n│    1.000250125062531 │    1.000250125062531 │\n│    1.000250187640731 │    1.000250187640731 │\n│    1.000250250250250 │    1.000250250250250 │\n└──────────────────────┴──────────────────────┘\n"}],"key":"qHSRrNoXr6"}],"key":"TJRtJVdXap"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"The time needed to solve a sparse linear system is not easy to predict unless you have some more information about the matrix. But it will typically be orders of magnitude faster than the dense version of the same problem.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"zzMwRakDRw"}],"indexEntries":[{"entry":"Julia","subEntry":{"value":"\\\\","kind":"entry"},"emphasis":false}],"label":"index-yf8FfUl0kp","identifier":"index-yf8fful0kp","html_id":"index-yf8fful0kp","key":"lfxk48Dj16"}],"key":"HNmmiBLUtu"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T16:40:08.110000Z","iopub.status.busy":"2025-01-14T16:40:08.062000Z","iopub.execute_input":"2025-01-14T16:40:08.063000Z","shell.execute_reply":"2025-01-14T16:40:08.109000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"x = @. 1 / (1:n);\nb = A * x;","key":"AuTkdqJ2i3"},{"type":"output","id":"q25EzHRiNHDPcBJPxR00C","data":[],"key":"C00IAjHOz5"}],"key":"qrdOWvB1o5"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T16:40:08.539000Z","iopub.status.busy":"2025-01-14T16:40:08.113000Z","iopub.execute_input":"2025-01-14T16:40:08.114000Z","shell.execute_reply":"2025-01-14T16:40:08.538000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"norm(x - A \\ b);  # force compilation\nt = @elapsed sparse_err = norm(x - A \\ b)\nprintln(\"Time for sparse solve: $t\")","key":"AsGehZitwH"},{"type":"output","id":"1QdRSUpK7xrTq_M-_8cPz","data":[{"name":"stdout","output_type":"stream","text":"Time for sparse solve: 0.001945709\n"}],"key":"Se7mRnkxUe"}],"key":"MvudwOJykj"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T16:40:10.172000Z","iopub.status.busy":"2025-01-14T16:40:08.542000Z","iopub.execute_input":"2025-01-14T16:40:08.542000Z","shell.execute_reply":"2025-01-14T16:40:10.172000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"D = Matrix(A)  # convert to regular matrix\nnorm(x - D \\ b);\nt = @elapsed dense_err = norm(x - D \\ b)\nprintln(\"Time for dense solve: $t\")","key":"E1Drp5SjO3"},{"type":"output","id":"2iZsqw2S0SbIzGbWOIqmi","data":[{"name":"stdout","output_type":"stream","text":"Time for dense solve: 0.750346583\n"}],"key":"Pl2T530sFK"}],"key":"jJDp4QfjTo"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T16:40:10.269000Z","iopub.status.busy":"2025-01-14T16:40:10.175000Z","iopub.execute_input":"2025-01-14T16:40:10.175000Z","shell.execute_reply":"2025-01-14T16:40:10.269000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"@show sparse_err;\n@show dense_err;","key":"XaduUYpoQx"},{"type":"output","id":"JN4Z4F6yRzFAdcOa353-w","data":[{"name":"stdout","output_type":"stream","text":"sparse_err = 1.1767106711290517e-16\ndense_err = 2.8523997176441884e-17\n"}],"key":"aViWg0KEed"}],"key":"NvbFf5YKKO"}],"key":"bM3viiaPHD"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Sparseband","url":"/sparseband","group":"Chapter 8"},"next":{"title":"One","url":"/one","group":"Chapter 8"}}},"domain":"http://localhost:3000"}