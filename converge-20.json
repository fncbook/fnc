{"kind":"Notebook","sha256":"2019714e471354c9f02229c9ffa0eb1259d8853ffdf4b012ecbacf323bb1e59c","slug":"converge-20","location":"/chapter4/section2/python/converge.ipynb","dependencies":[],"frontmatter":{"numbering":{"heading_1":{"enabled":false},"heading_2":{"enabled":false},"heading_3":{"enabled":false},"heading_4":{"enabled":false},"heading_5":{"enabled":false},"heading_6":{"enabled":false}},"kernelspec":{"name":"python3","display_name":"Python 3","language":"python"},"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"exports":[{"format":"ipynb","filename":"converge.ipynb","url":"/build/converge-14c69307a537a50325326e50479876c9.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:18:30.932779Z","iopub.status.busy":"2025-01-11T17:18:30.932413Z","iopub.status.idle":"2025-01-11T17:18:31.236306Z","shell.execute_reply":"2025-01-11T17:18:31.236012Z"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"exec(open(\"../../../python/FNC_init.py\").read())","visibility":"show","key":"WLOpJ9g2D1"},{"type":"output","id":"v2Qfdu6U0rj7GphO48F0I","data":[],"visibility":"show","key":"EN5xNNpepw"}],"visibility":"remove","key":"RJj3MIB7NS"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"XeuxH0ARiU"},{"type":"text","value":"4.2.3","key":"ADXt2Bi9qE"}],"key":"KhQ6gaE49F"}],"identifier":"demo-fp-converge","label":"demo-fp-converge","kind":"proof:example","template":"Example %s","enumerator":"4.2.3","resolved":true,"html_id":"demo-fp-converge","remote":true,"url":"/fixed-point","dataUrl":"/fixed-point.json","key":"MSYodtdCRG"}],"key":"STzUwT9kO4"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We revisit ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"StStMzGFj5"},{"type":"crossReference","kind":"proof:example","identifier":"demo-fp-spiral","label":"demo-fp-spiral","children":[{"type":"text","value":"Demo ","key":"yRjXIr8xOW"},{"type":"text","value":"4.2.1","key":"moIwZuh9CJ"}],"template":"Example %s","enumerator":"4.2.1","resolved":true,"html_id":"demo-fp-spiral","remote":true,"url":"/fixed-point","dataUrl":"/fixed-point.json","key":"NRxRd9vf2o"},{"type":"text","value":" and investigate the observed convergence more closely. Recall that above we calculated ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"vmaAhcYECr"},{"type":"inlineMath","value":"g'(p)\\approx-0.42","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>g</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo stretchy=\"false\">(</mo><mi>p</mi><mo stretchy=\"false\">)</mo><mo>≈</mo><mo>−</mo><mn>0.42</mn></mrow><annotation encoding=\"application/x-tex\">g&#x27;(p)\\approx-0.42</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0019em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">p</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">−</span><span class=\"mord\">0.42</span></span></span></span>","key":"DT6vBHBKaG"},{"type":"text","value":" at the convergent fixed point.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"DK6gs6LWiO"}],"key":"ZJO6ZAbj3X"}],"key":"HJ3JrP7vKU"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:18:31.237937Z","iopub.status.busy":"2025-01-11T17:18:31.237814Z","iopub.status.idle":"2025-01-11T17:18:31.240097Z","shell.execute_reply":"2025-01-11T17:18:31.239802Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"f = poly1d([1, -4, 3.5])\nr = f.roots\nprint(r)","key":"pVkmNB06H5"},{"type":"output","id":"zjjIHewp-qS_VZhtgtLeC","data":[{"name":"stdout","output_type":"stream","text":"[2.70710678 1.29289322]\n"}],"key":"h7qWmlr4db"}],"key":"mU3IzBAGew"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Here is the fixed-point iteration. This time we keep track of the whole sequence of approximations.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"CZvJOQy6oB"}],"key":"nURehaGVWp"}],"key":"gUIshdZcoh"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:18:31.241330Z","iopub.status.busy":"2025-01-11T17:18:31.241247Z","iopub.status.idle":"2025-01-11T17:18:31.243340Z","shell.execute_reply":"2025-01-11T17:18:31.243108Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"g = lambda x: x - f(x)\nx = zeros(12)\nx[0] = 2.1\nfor k in range(11):\n    x[k + 1] = g(x[k])\n\nprint(x)","key":"l2uka1y3Jw"},{"type":"output","id":"tY5lZFhVLfR11k4LPQslu","data":[{"name":"stdout","output_type":"stream","text":"[2.1        2.59       2.7419     2.69148439 2.71333373 2.70448872\n 2.70818436 2.70665927 2.70729195 2.70703005 2.70713856 2.70709362]\n"}],"key":"pzyjKG8STS"}],"key":"ql5xgXbnMb"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"It’s illuminating to construct and plot the sequence of errors.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"a6d1xyTcve"}],"key":"LkvmZSXLqw"}],"key":"SgTw3Lifzo"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:18:31.244598Z","iopub.status.busy":"2025-01-11T17:18:31.244520Z","iopub.status.idle":"2025-01-11T17:18:31.462924Z","shell.execute_reply":"2025-01-11T17:18:31.462649Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"err = abs(x - max(r))\nsemilogy(err, \"-o\")\nxlabel(\"iteration number\"), ylabel(\"error\")\ntitle(\"Convergence of fixed-point iteration\");","key":"PDKHn2qF3q"},{"type":"output","id":"qItNwaLfI3BhJ3bMT4reS","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"51da9c6102cd97aff2ff3cf2d458ec5b","path":"/build/51da9c6102cd97aff2ff3cf2d458ec5b.png"},"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"}}}],"key":"baDTKYVlkN"}],"key":"dzpsXghbGt"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"It’s quite clear that the convergence quickly settles into a linear rate. We could estimate this rate by doing a least-squares fit to a straight line. Keep in mind that the values for small ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"C2aDJqhWth"},{"type":"inlineMath","value":"k","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span>","key":"dGBSvWyOzn"},{"type":"text","value":" should be left out of the computation, as they don’t represent the linear trend.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YWrmajHgSM"}],"key":"VkBS7CIgg0"}],"key":"BS0HuAu437"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:18:31.464379Z","iopub.status.busy":"2025-01-11T17:18:31.464244Z","iopub.status.idle":"2025-01-11T17:18:31.466204Z","shell.execute_reply":"2025-01-11T17:18:31.465940Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"p = polyfit(arange(5, 13), log(err[4:]), 1)\nprint(p)","key":"teYOZ4qgzB"},{"type":"output","id":"fNklLPfyBTgCJIbznDDNP","data":[{"name":"stdout","output_type":"stream","text":"[-0.88071816 -0.66805739]\n"}],"key":"tVnVolNsqs"}],"key":"NWVqgx77xL"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We can exponentiate the slope to get the convergence constant ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"C58aAMVmLw"},{"type":"text","value":"σ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MlMmbfTkn0"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wsDltYoxj9"}],"key":"UURm4ellZc"}],"key":"Tx7pF11eMS"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:18:31.467362Z","iopub.status.busy":"2025-01-11T17:18:31.467274Z","iopub.status.idle":"2025-01-11T17:18:31.468935Z","shell.execute_reply":"2025-01-11T17:18:31.468704Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"print(\"sigma:\", exp(p[0]))","key":"GBvZHCQ6Gs"},{"type":"output","id":"OMajf9L-28oBvL3ZRRgTB","data":[{"name":"stdout","output_type":"stream","text":"sigma: 0.4144851385485472\n"}],"key":"g4ltW7G6kA"}],"key":"dIIicB3L3c"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The error should therefore decrease by a factor of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"u2V6lwI3cE"},{"type":"text","value":"σ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"IimVVV1I6I"},{"type":"text","value":" at each iteration. We can check this easily from the observed data.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rzaa2ilmVi"}],"key":"X6jdDdfWtH"}],"key":"w7x6HH5aHR"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:18:31.470121Z","iopub.status.busy":"2025-01-11T17:18:31.470032Z","iopub.status.idle":"2025-01-11T17:18:31.472240Z","shell.execute_reply":"2025-01-11T17:18:31.471965Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"err[8:] / err[7:-1]","key":"xBLCQY7gC6"},{"type":"output","id":"g7ZDbr2QFJOCSsCa3Pj-X","data":[{"output_type":"execute_result","execution_count":7,"metadata":{},"data":{"text/plain":{"content":"array([0.41376605, 0.41439873, 0.41413683, 0.41424534])","content_type":"text/plain"}}}],"key":"xFa647VwUu"}],"key":"DBuAjaMqTw"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The methods for finding ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"oQxgKhH1gi"},{"type":"text","value":"σ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"fclZaN73zL"},{"type":"text","value":" agree well.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"M7X3bjfDMF"}],"key":"W6SDw1wahX"}],"key":"PSAIHNGpFd"}],"key":"mdNcH2LbAd"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Spiral","url":"/spiral-2","group":"Chapter 4"},"next":{"title":"Line","url":"/line-4","group":"Chapter 4"}}},"domain":"http://localhost:3000"}