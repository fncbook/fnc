{"kind":"Notebook","sha256":"7be79a8d653050441a61452af41c724a095773c6226ff81c11a0d11ccf7687e3","slug":"advection-1","location":"/chapter12/section3/julia/advection.ipynb","dependencies":[],"frontmatter":{"numbering":{"heading_1":{"enabled":false},"heading_2":{"enabled":false},"heading_3":{"enabled":false},"heading_4":{"enabled":false},"heading_5":{"enabled":false},"heading_6":{"enabled":false}},"kernelspec":{"name":"julia-1.11","display_name":"Julia 1","language":"julia"},"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"exports":[{"format":"ipynb","filename":"advection.ipynb","url":"/fnc/build/advection-911e7b444784b12af12e5439edd02047.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"mzwUbQMctm"},{"type":"text","value":"12.3.1","key":"GWLnwDYUIj"}],"key":"hvCJaHH4Qe"}],"identifier":"demo-absstab-advection","label":"demo-absstab-advection","kind":"proof:example","template":"Example %s","enumerator":"12.3.1","resolved":true,"html_id":"demo-absstab-advection","remote":true,"url":"/absstab-advection","dataUrl":"/absstab-advection.json","key":"fFq5F8oZwT"}],"key":"zxibl3gGNK"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"For ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Au4ZuR1GOm"},{"type":"inlineMath","value":"c=1","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>c</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">c=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">c</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"UDqH1Z7jRj"},{"type":"text","value":" we get purely imaginary eigenvalues.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"YQ8iHTfBIY"}],"key":"JfskJP55CO"}],"key":"XJf2wk2QhG"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:27:22.243000Z","iopub.status.busy":"2025-01-14T15:26:54.293000Z","iopub.execute_input":"2025-01-14T15:26:55.933000Z","shell.execute_reply":"2025-01-14T15:27:22.228000Z"},"tags":[]},"children":[{"type":"code","lang":"julia","executable":true,"value":"x, Dₓ = FNC.diffper(40, [0, 1])\nλ = eigvals(Dₓ);\nscatter(real(λ), imag(λ);\n    aspect_ratio = 1,  frame=:zerolines,\n    xlabel=\"Re λ\",  ylabel=\"Im λ\", \n    title=\"Eigenvalues for pure advection\",  legend=:none)","visibility":"hide","key":"BYr9vNz5IT"},{"type":"output","id":"GY8yrI0f8WDM5lBYRTcpO","data":[{"output_type":"execute_result","execution_count":2,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"c357fdfd2deaf43c59f0ccf2bf43bae2","path":"/fnc/build/c357fdfd2deaf43c59f0ccf2bf43bae2.png"},"text/html":{"content_type":"text/html","hash":"12ebfaae3b713828b631339b49ac70d3","path":"/fnc/build/12ebfaae3b713828b631339b49ac70d3.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"943415b4b5eeb9e21b3c529f41ea1b5c","path":"/fnc/build/943415b4b5eeb9e21b3c529f41ea1b5c.svg"}}}],"visibility":"show","key":"HQ4bW4JnD8"}],"visibility":"show","key":"BEEes4talB"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Let’s choose a time step of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pp7duQoWcw"},{"type":"inlineMath","value":"\\tau=0.1","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>τ</mi><mo>=</mo><mn>0.1</mn></mrow><annotation encoding=\"application/x-tex\">\\tau=0.1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.1132em;\">τ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0.1</span></span></span></span>","key":"Lcjsg8tJFT"},{"type":"text","value":" and compare to the stability regions of the Euler and backward Euler time steppers (shown as shaded regions):","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hdI77ksqnT"}],"key":"pAVUDb6u0m"}],"key":"u9bGdZeUtr"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:27:28.054000Z","iopub.status.busy":"2025-01-14T15:27:22.297000Z","iopub.execute_input":"2025-01-14T15:27:22.345000Z","shell.execute_reply":"2025-01-14T15:27:28.041000Z"},"tags":[]},"children":[{"type":"code","lang":"julia","executable":true,"value":"zc = @. cispi(2 * (0:360) / 360);     # points on |z|=1\nz = zc .- 1;                          # shift left by 1\nplot(Shape(real(z), imag(z)), color=RGB(.8, .8, 1))\nζ = 0.1 * λ\nscatter!(real(ζ), imag(ζ);\n    aspect_ratio=1,  frame=:zerolines,\n    xaxis=(\"Re ζ\", [-5, 5]),  yaxis=(\"Im ζ\", [-5, 5]),\n    title=\"Euler for advection\")","visibility":"hide","key":"gZJBZSM5UC"},{"type":"output","id":"uRF_551f8_AsNLjdCSUCS","data":[{"output_type":"execute_result","execution_count":3,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"5b551d1f5d425ba03cfd6cc22bc6f2fb","path":"/fnc/build/5b551d1f5d425ba03cfd6cc22bc6f2fb.png"},"text/html":{"content_type":"text/html","hash":"534bb54f0a13c22a25206c38353687a8","path":"/fnc/build/534bb54f0a13c22a25206c38353687a8.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"381a81f34dc2a8803581edcd6649b1ff","path":"/fnc/build/381a81f34dc2a8803581edcd6649b1ff.svg"}}}],"visibility":"show","key":"mY8gUOtEVJ"}],"visibility":"show","key":"LepceP7VKS"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"In the Euler case it’s clear that ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"klU1oWoOK2"},{"type":"emphasis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"no","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DXmMV1Yhdz"}],"key":"i1blO6ZLb5"},{"type":"text","value":" real value of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"SvdCjsYNo0"},{"type":"inlineMath","value":"\\tau>0","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>τ</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">\\tau&gt;0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.1132em;\">τ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&gt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"adFLaEQPdm"},{"type":"text","value":" is going to make ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rQyWzlygeT"},{"type":"text","value":"ζ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"L1iUH3bg1A"},{"type":"text","value":" values fit within the stability region. Any method whose stability region includes none of the imaginary axis is an unsuitable choice for advection.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Er6VkPxxlY"}],"key":"gS4dgOr4dH"}],"key":"v6GuVW4DDS"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:27:28.888000Z","iopub.status.busy":"2025-01-14T15:27:28.079000Z","iopub.execute_input":"2025-01-14T15:27:28.080000Z","shell.execute_reply":"2025-01-14T15:27:28.887000Z"},"tags":[]},"children":[{"type":"code","lang":"julia","executable":true,"value":"z = zc .+ 1;                        # shift circle right by 1\nplot(Shape([-6, 6, 6, -6], [-6, -6, 6, 6]), color=RGB(.8, .8, 1))\nplot!(Shape(real(z), imag(z)), color=:white)\nscatter!(real(ζ), imag(ζ);\n    aspect_ratio=1,  frame=:zerolines,\n    xaxis=(\"Re ζ\", [-5, 5]),  yaxis=(\"Im ζ\", [-5, 5]),\n    title=\"Backward Euler for advection\")","visibility":"hide","key":"tsP3bp6Pqt"},{"type":"output","id":"5iEhmwUhuj9ptAnTjmcdl","data":[{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"83e4bb088ef7e7a300e319c20012e5e7","path":"/fnc/build/83e4bb088ef7e7a300e319c20012e5e7.png"},"text/html":{"content_type":"text/html","hash":"1a92a1d6f61b31764dadb973e8157e3b","path":"/fnc/build/1a92a1d6f61b31764dadb973e8157e3b.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"6ef32868c7a7b94c17f2959baa17890d","path":"/fnc/build/6ef32868c7a7b94c17f2959baa17890d.svg"}}}],"visibility":"show","key":"LlZIK4WCJL"}],"visibility":"show","key":"HjVS2h7nGv"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The A-stable backward Euler time stepping tells the exact opposite story: it will be absolutely stable for any choice of the time step ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Y1RfMXIoV6"},{"type":"text","value":"τ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"swMCDMxOGw"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"W3565iUD5B"}],"key":"jqo2zwQfrX"}],"key":"q2N1ErUImd"}],"key":"xplcogjGNW"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Direction","url":"/direction","group":"Chapter 12"},"next":{"title":"Advdiff","url":"/advdiff","group":"Chapter 12"}}},"domain":"http://localhost:3000"}