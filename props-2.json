{"kind":"Notebook","sha256":"1b30d487947e97cd1b7b437993dcc896d03eb7a5d5af27955b0473ffb473d498","slug":"props-2","location":"/chapter7/section3/python/props.ipynb","dependencies":[],"frontmatter":{"numbering":{"heading_1":{"enabled":false},"heading_2":{"enabled":false},"heading_3":{"enabled":false},"heading_4":{"enabled":false},"heading_5":{"enabled":false},"heading_6":{"enabled":false}},"kernelspec":{"name":"python3","display_name":"Python 3","language":"python"},"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"exports":[{"format":"ipynb","filename":"props.ipynb","url":"/build/props-a6e1e01f349b7cec5169a924911e3715.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T16:31:38.098909Z","iopub.status.busy":"2025-01-11T16:31:38.098805Z","iopub.status.idle":"2025-01-11T16:31:38.401880Z","shell.execute_reply":"2025-01-11T16:31:38.401478Z"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"exec(open(\"../../../python/FNC_init.py\").read())","visibility":"show","key":"RVtadOgHor"},{"type":"output","id":"03gUk0xKxCqL9AbwEO8If","data":[],"visibility":"show","key":"axgzqpkslw"}],"visibility":"remove","key":"TV05Tp9aCn"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"MHcxbn6gfX"},{"type":"text","value":"7.3.4","key":"XlWRVRD4Yt"}],"key":"k5Fdmowhjn"}],"identifier":"demo-svd-props","label":"demo-svd-props","kind":"proof:example","template":"Example %s","enumerator":"7.3.4","resolved":true,"html_id":"demo-svd-props","remote":true,"url":"/svd","dataUrl":"/svd.json","key":"FF9tTzp1D9"}],"key":"SXxIVbAdML"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We verify some of the fundamental ","key":"bQaozvOVjv"},{"type":"abbreviation","title":"singular value decomposition","children":[{"type":"text","value":"SVD","key":"ZA6VeTkFWr"}],"key":"x0iiEIBLkz"},{"type":"text","value":" properties using standard Julia functions from ","key":"d118ZM80y6"},{"type":"inlineCode","value":"LinearAlgebra","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"UOrLdbayvI"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"nKSIAuH5nf"}],"key":"WZIwbFtwaI"}],"key":"uYEV8IGrGv"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T16:31:38.403750Z","iopub.status.busy":"2025-01-11T16:31:38.403583Z","iopub.status.idle":"2025-01-11T16:31:38.405813Z","shell.execute_reply":"2025-01-11T16:31:38.405539Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"A = array([[(i + 1.0) ** j for j in range(4)] for i in range(5)])\nset_printoptions(precision=4)\nprint(A)","key":"BY347Vajfd"},{"type":"output","id":"F5ZWmz3k6JPcygMbi2pOG","data":[{"name":"stdout","output_type":"stream","text":"[[  1.   1.   1.   1.]\n [  1.   2.   4.   8.]\n [  1.   3.   9.  27.]\n [  1.   4.  16.  64.]\n [  1.   5.  25. 125.]]\n"}],"key":"TEvjOuHQcN"}],"key":"mfF66JoMht"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"The factorization is obtained using ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"uYVMJwz208"},{"type":"inlineCode","value":"svd","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"vpLuukj7B1"},{"type":"text","value":" from ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"AM6wmklHzv"},{"type":"inlineCode","value":"numpy.linalg","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"CkJISPAmia"},{"type":"text","value":".","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"fHyIgDnT2y"}],"indexEntries":[{"entry":"Python","subEntry":{"value":"svd","kind":"entry"},"emphasis":true}],"label":"index-Efgnf1n3R1","identifier":"index-efgnf1n3r1","html_id":"index-efgnf1n3r1","key":"VXv84FEN0c"}],"key":"nbSjLEkdFR"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T16:31:38.407281Z","iopub.status.busy":"2025-01-11T16:31:38.407157Z","iopub.status.idle":"2025-01-11T16:31:38.409490Z","shell.execute_reply":"2025-01-11T16:31:38.409213Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"from numpy.linalg import svd\nU, sigma, Vh = svd(A)\nprint(\"singular values:\")\nprint(sigma)","key":"vO50tMLqxz"},{"type":"output","id":"82epN4x4un_ZNLoAsRaaw","data":[{"name":"stdout","output_type":"stream","text":"singular values:\n[1.4670e+02 5.7386e+00 9.9985e-01 1.1928e-01]\n"}],"key":"Mn4P1FrBI6"}],"key":"VQQU6pvDn4"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"By default, the full factorization type is returned. This can be a memory hog if one of the dimensions of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"HHDXeh54Z8"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"xGR3yYBsVi"},{"type":"text","value":" is very large.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"vEyQdV0LVq"}],"key":"j5uArz0OyL"}],"key":"TyS4OOZMYx"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T16:31:38.410664Z","iopub.status.busy":"2025-01-11T16:31:38.410575Z","iopub.status.idle":"2025-01-11T16:31:38.412241Z","shell.execute_reply":"2025-01-11T16:31:38.412015Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"print(\"size of U:\", U.shape)\nprint(\"size of V:\", Vh.T.shape)","key":"x3F9hBmLDY"},{"type":"output","id":"CQnIQooSt4yBVc4xNqr7y","data":[{"name":"stdout","output_type":"stream","text":"size of U: (5, 5)\nsize of V: (4, 4)\n"}],"key":"eV5rfGZL7F"}],"key":"KwBxdSirvj"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Both ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"aF6c7ozZgY"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"ggQj3y7G54"},{"type":"text","value":" and ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"lHDJZHhHQC"},{"type":"inlineMath","value":"\\mathbf{V}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">V</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{V}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">V</span></span></span></span>","key":"CQpSCrRyYl"},{"type":"text","value":" are orthogonal (in the complex case, unitary). Note that it’s ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Tjr7ZyrdnP"},{"type":"inlineMath","value":"\\mathbf{V}^*","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi mathvariant=\"bold\">V</mi><mo>∗</mo></msup></mrow><annotation encoding=\"application/x-tex\">\\mathbf{V}^*</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6887em;\"></span><span class=\"mord\"><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">V</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6887em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mbin mtight\">∗</span></span></span></span></span></span></span></span></span></span></span>","key":"dPAXGys0sX"},{"type":"text","value":" that is returned, not ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"lMwzDBiKTt"},{"type":"inlineMath","value":"\\mathbf{V}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">V</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{V}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">V</span></span></span></span>","key":"NkYIu3EOJy"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"VrKoHRIUmg"}],"key":"XpyOR0C6wR"}],"key":"uXiU2TDDJs"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T16:31:38.413374Z","iopub.status.busy":"2025-01-11T16:31:38.413289Z","iopub.status.idle":"2025-01-11T16:31:38.416315Z","shell.execute_reply":"2025-01-11T16:31:38.416094Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"print(f\"should be near zero: {norm(U.T @ U - eye(5), 2):.2e}\")\nprint(f\"should be near zero: {norm(Vh @ Vh.T - eye(4), 2):.2e}\")","key":"mSBiNCIyOD"},{"type":"output","id":"wjYiXOgiMY0hh3ZNCosLi","data":[{"name":"stdout","output_type":"stream","text":"should be near zero: 5.61e-16\nshould be near zero: 1.07e-15\n"}],"key":"DVhjqIgQsF"}],"key":"RGizDAXXtr"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Next we test that we have the factorization promised by the ","key":"YZAO9vbzcE"},{"type":"abbreviation","title":"singular value decomposition","children":[{"type":"text","value":"SVD","key":"rX7OTjxu2F"}],"key":"WcTzwTkSGG"},{"type":"text","value":", using ","key":"xqCFEsVaud"},{"type":"inlineCode","value":"diagsvd","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"am3jxTV2Gf"},{"type":"text","value":" to construct a rectangular diagonal matrix.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bXaffFSbU2"}],"key":"FU5BdANNP2"}],"key":"dR3jHg3r4U"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T16:31:38.417657Z","iopub.status.busy":"2025-01-11T16:31:38.417571Z","iopub.status.idle":"2025-01-11T16:31:38.419578Z","shell.execute_reply":"2025-01-11T16:31:38.419333Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"from scipy.linalg import diagsvd\nS = diagsvd(sigma, 5, 4)\nprint(f\"should be near zero: {norm(A - U @ S @ Vh, 2):.2e}\")","key":"W4O7Hfmt3u"},{"type":"output","id":"-WELJoaGJI1XNbJ8VvKFM","data":[{"name":"stdout","output_type":"stream","text":"should be near zero: 8.56e-14\n"}],"key":"CxNMOmaC5V"}],"key":"SYKk5NQD9D"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Here is verification of the connections between the singular values, norm, and condition number.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"AfD8LxJzoV"}],"key":"RB2zztxKK5"}],"key":"T0jx1WvEL9"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T16:31:38.420816Z","iopub.status.busy":"2025-01-11T16:31:38.420730Z","iopub.status.idle":"2025-01-11T16:31:38.422754Z","shell.execute_reply":"2025-01-11T16:31:38.422545Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"from numpy.linalg import cond\nprint(\"largest singular value:\", sigma[0])\nprint(\"2-norm of the matrix:  \", norm(A, 2))\nprint(\"singular value ratio:\", sigma[0] / sigma[-1])\nprint(\"2-norm condition no.:\", cond(A, 2))","key":"BGVbEDr4IR"},{"type":"output","id":"IpcTrHvO78m2YeGRFe_q8","data":[{"name":"stdout","output_type":"stream","text":"largest singular value: 146.69715365883005\n2-norm of the matrix:   146.69715365883005\nsingular value ratio: 1229.8468876337527\n2-norm condition no.: 1229.8468876337529\n"}],"key":"U53bCfWxug"}],"key":"NSUrQHs6YV"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"For matrices that are much taller than they are wide, the thin ","key":"SVlHqJCkIA"},{"type":"abbreviation","title":"singular value decomposition","children":[{"type":"text","value":"SVD","key":"VCtFP7SKjx"}],"key":"TwqamYcnDe"},{"type":"text","value":" form is more memory-efficient, because ","key":"o1TeKpF2fB"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"R2KtvbguIK"},{"type":"text","value":" takes the same shape.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"AVvSopp0TI"}],"key":"KHEBu1rtMu"}],"key":"H7LH4WXC9g"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T16:31:38.423925Z","iopub.status.busy":"2025-01-11T16:31:38.423833Z","iopub.status.idle":"2025-01-11T16:31:38.428171Z","shell.execute_reply":"2025-01-11T16:31:38.427933Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"A = random.randn(1000, 10)\nU, sigma, Vh = svd(A, full_matrices=False)\nprint(\"size of U:\", U.shape)\nprint(\"size of V:\", Vh.shape)","key":"xFK5wqXLHc"},{"type":"output","id":"ehv5V7GZWR68szQ6QIl7S","data":[{"name":"stdout","output_type":"stream","text":"size of U: (1000, 10)\nsize of V: (10, 10)\n"}],"key":"A5TBLeW5vk"}],"key":"a33PM5TMG4"}],"key":"plaubpxCFZ"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Francisqr","url":"/francisqr-2","group":"Chapter 7"},"next":{"title":"Rayleigh","url":"/rayleigh-2","group":"Chapter 7"}}},"domain":"http://localhost:3000"}