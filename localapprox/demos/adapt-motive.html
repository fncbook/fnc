

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>An oscillatory integrand &#8212; Fundamentals of Numerical Computation</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
    <link href="../../_static/css/index.css" rel="stylesheet">
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/jupyter-sphinx.css" />
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/sphinx-book-theme.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/mystnb.js"></script>
    <script src="../../_static/proof.js"></script>
    <script src="../../_static/sphinx-book-theme.js"></script>
    <script >var togglebuttonSelector = '.toggle, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.18.0/dist/embed-amd.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"TeX": {"Macros": {"float": ["\\mathbb{F}"], "real": ["\\mathbb{R}"], "complex": ["\\mathbb{C}"], "nat": ["\\mathbb{N}"], "integer": ["\\mathbb{Z}"], "rmn{([^}]*)}{([^}]*)}": ["\\mathbb{R}^{#1 \\times #2}", 2], "dd{([^}]*)}{([^}]*)}": ["\\frac{d #1}{d #2}", 2], "ddd{([^}]*)}{([^}]*)}": ["\\frac{d^2 #1}{d #2^2}", 2], "pp{([^}]*)}{([^}]*)}": ["\\frac{\\partial #1}{\\partial #2}", 2], "ppp{([^}]*)}{([^}]*)}": ["\\frac{\\partial^2 #1}{\\partial #2^2}", 2], "ppdd{([^}]*)}{([^}]*)}{([^}]*)}": ["\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}", 3], "norm{([^}]*)}": ["\\| #1 \\|", 1], "twonorm{([^}]*)}": ["\\| #1 \\|_2", 1], "onenorm{([^}]*)}": ["\\| #1 \\|_1", 1], "infnorm{([^}]*)}": ["\\| #1 \\|_\\infty", 1], "anynorm{([^}]*)}{([^}]*)}": ["\\| #1 \\|_#2", 2], "innerprod{([^}]*)}{([^}]*)}": ["\\langle #1,#2 \\rangle", 2], "pr{([^}]*)}": ["^{(#1)}", 1], "kron{([^}]*)}{([^}]*)}": ["#1 \\otimes #2", 2], "eye{([^}]*)}": ["\\mathbf{e}_#1", 1], "meye": ["\\mathbf{I}"], "Qhat": ["\\hat{\\mathbf{Q}}"], "Rhat": ["\\hat{\\mathbf{R}}"], "bfalpha": ["\\mathbf{alpha}"], "bfdelta": ["\\mathbf{delta}"], "bfzero": ["\\boldsymbol{0}"], "macheps": ["\\epsilon_\\text{mach}"], "fl": ["\\operatorname{fl}"], "diag": ["\\operatorname{diag}"], "ign": ["\\operatorname{sign}"], "Re": ["\\operatorname{Re}"], "Im": ["\\operatorname{Im}"], "ee": ["\\times 10^"], "lnorm": ["\\|"], "rnorm": ["\\|"], "floor": ["\\lfloor#1\\rfloor", 1]}}})</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Adaptive integration" href="adapt-usage.html" />
    <link rel="prev" title="Extrapolation for numerical integration" href="int-extrap.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="docsearch:language" content="en">



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../../index.html">
  
  <img src="../../_static/logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Fundamentals of Numerical Computation</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  
  <ul class="nav sidenav_l1">
  <li class="">
    <a href="../../frontmatter.html">Home</a>
  </li>
  <li class="">
    <a href="../../intro/overview.html">Introduction</a>
  </li>
  <li class="">
    <a href="../../linsys/overview.html">Square linear systems</a>
  </li>
  <li class="">
    <a href="../../leastsq/overview.html">Overdetermined linear systems</a>
  </li>
  <li class="">
    <a href="../../nonlineqn/overview.html">Roots of nonlinear equations</a>
  </li>
  <li class="">
    <a href="../overview.html">Piecewise interpolation</a>
  </li>
  <li class="">
    <a href="../../ivp/overview.html">Initial-value problems for ODEs</a>
  </li>
  <li class="">
    <a href="../../appendix/linear-algebra.html">Review: Linear algebra</a>
  </li>
  <li class="active">
    <a href="../../appendix/demos.html">All demo notebooks</a>
  <ul class="nav sidenav_l2">
    <li class="">
      <a href="../../appendix/demos-01.html">Chapter 1 (Introduction)</a>
    </li>
    <li class="">
      <a href="../../appendix/demos-02.html">Chapter 2 (Linear systems)</a>
    </li>
    <li class="">
      <a href="../../appendix/demos-03.html">Chapter 3 (Least squares)</a>
    </li>
    <li class="">
      <a href="../../appendix/demos-04.html">Chapter 4 (Rootfinding)</a>
    </li>
    <li class="active">
      <a href="../../appendix/demos-05.html">Chapter 5 (Piecewise)</a>
      <ul class="nav sidenav_l3">
      <li class="">
        <a href="interp-global.html">Poor conditioning in polynomial interpolation</a>
      </li>
      <li class="">
        <a href="interp-pwise.html">Piecewise polynomial interpolation</a>
      </li>
      <li class="">
        <a href="interp-cond.html">Polynomial cardinal functions</a>
      </li>
      <li class="">
        <a href="pwlin-hat.html">Hat functions</a>
      </li>
      <li class="">
        <a href="pwlin-usage.html">Piecewise linear interpolation</a>
      </li>
      <li class="">
        <a href="pwlin-converge.html">Convergence of PL interpolation</a>
      </li>
      <li class="">
        <a href="splines.html">Cubic splines</a>
      </li>
      <li class="">
        <a href="fd-weights.html">FD at arbitrary nodes</a>
      </li>
      <li class="">
        <a href="fdconverge-1.html">Convergence of finite differences</a>
      </li>
      <li class="">
        <a href="fdconverge-2.html">Comparison of 1st and 2nd order</a>
      </li>
      <li class="">
        <a href="fdconverge-round.html">Roundoff in finite differences</a>
      </li>
      <li class="">
        <a href="int-antideriv.html">Numerical integration</a>
      </li>
      <li class="">
        <a href="int-trap.html">Convergence of trapezoidal integration</a>
      </li>
      <li class="">
        <a href="int-extrap.html">Extrapolation for numerical integration</a>
      </li>
      <li class="active">
        <a href="">An oscillatory integrand</a>
      </li>
      <li class="">
        <a href="adapt-usage.html">Adaptive integration</a>
      </li>
    </ul>
    </li>
    <li class="">
      <a href="../../appendix/demos-06.html">Chapter 6 (IVPs)</a>
    </li>
  </ul>
  </li>
  <li class="">
    <a href="../../refs.html">References</a>
  </li>
  <li class="">
    <a href="../../genindex.html">Index</a>
  </li>
</ul>
</nav>

 <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse" data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu" aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation" title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
            <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i class="fas fa-download"></i></button>

            
            <div class="dropdown-buttons">
                <!-- ipynb file if we had a myst markdown file -->
                
                <!-- Download raw file -->
                <a class="dropdown-buttons" href="../../_sources/localapprox/demos/adapt-motive.ipynb"><button type="button" class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip" data-placement="left">.ipynb</button></a>
                <!-- Download PDF via print -->
                <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF" onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
            </div>
            
        </div>

        <!-- Edit this page -->
        

        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="bottom" onclick="toggleFullScreen()" title="Fullscreen mode"><i class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->
        
    </div>
    <div class="d-none d-md-block col-md-2 bd-toc show">

<nav id="bd-toc-nav">
    <ul class="nav section-nav flex-column">
    
    </ul>
</nav>


    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="an-oscillatory-integrand">
<h1>An oscillatory integrand<a class="headerlink" href="#an-oscillatory-integrand" title="Permalink to this headline">¶</a></h1>
<p>This function gets increasingly oscillatory near the right endpoint.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-&gt;</span> <span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">((</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mf">4.3</span><span class="p">))</span>

<span class="n">using</span> <span class="n">Plots</span>
<span class="n">plot</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span><span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;f(x)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip820">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip820)" d="
M0 1600 L2400 1600 L2400 0 L0 0  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip821">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip820)" d="
M215.538 1423.18 L2352.76 1423.18 L2352.76 47.2441 L215.538 47.2441  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip822">
    <rect x="215" y="47" width="2138" height="1377"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip822)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  276.025,1423.18 276.025,47.2441 
  "/>
<polyline clip-path="url(#clip822)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  780.086,1423.18 780.086,47.2441 
  "/>
<polyline clip-path="url(#clip822)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1284.15,1423.18 1284.15,47.2441 
  "/>
<polyline clip-path="url(#clip822)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1788.21,1423.18 1788.21,47.2441 
  "/>
<polyline clip-path="url(#clip822)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  2292.27,1423.18 2292.27,47.2441 
  "/>
<polyline clip-path="url(#clip822)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  215.538,1257.52 2352.76,1257.52 
  "/>
<polyline clip-path="url(#clip822)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  215.538,994.042 2352.76,994.042 
  "/>
<polyline clip-path="url(#clip822)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  215.538,730.568 2352.76,730.568 
  "/>
<polyline clip-path="url(#clip822)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  215.538,467.095 2352.76,467.095 
  "/>
<polyline clip-path="url(#clip822)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  215.538,203.621 2352.76,203.621 
  "/>
<polyline clip-path="url(#clip820)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  215.538,1423.18 2352.76,1423.18 
  "/>
<polyline clip-path="url(#clip820)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  215.538,1423.18 215.538,47.2441 
  "/>
<polyline clip-path="url(#clip820)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  276.025,1423.18 276.025,1406.67 
  "/>
<polyline clip-path="url(#clip820)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  780.086,1423.18 780.086,1406.67 
  "/>
<polyline clip-path="url(#clip820)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1284.15,1423.18 1284.15,1406.67 
  "/>
<polyline clip-path="url(#clip820)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1788.21,1423.18 1788.21,1406.67 
  "/>
<polyline clip-path="url(#clip820)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  2292.27,1423.18 2292.27,1406.67 
  "/>
<polyline clip-path="url(#clip820)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  215.538,1257.52 241.184,1257.52 
  "/>
<polyline clip-path="url(#clip820)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  215.538,994.042 241.184,994.042 
  "/>
<polyline clip-path="url(#clip820)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  215.538,730.568 241.184,730.568 
  "/>
<polyline clip-path="url(#clip820)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  215.538,467.095 241.184,467.095 
  "/>
<polyline clip-path="url(#clip820)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  215.538,203.621 241.184,203.621 
  "/>
<path clip-path="url(#clip820)" d="M 0 0 M276.025 1445.17 Q272.414 1445.17 270.585 1448.74 Q268.78 1452.28 268.78 1459.41 Q268.78 1466.51 270.585 1470.08 Q272.414 1473.62 276.025 1473.62 Q279.659 1473.62 281.465 1470.08 Q283.293 1466.51 283.293 1459.41 Q283.293 1452.28 281.465 1448.74 Q279.659 1445.17 276.025 1445.17 M276.025 1441.47 Q281.835 1441.47 284.891 1446.07 Q287.969 1450.66 287.969 1459.41 Q287.969 1468.13 284.891 1472.74 Q281.835 1477.32 276.025 1477.32 Q270.215 1477.32 267.136 1472.74 Q264.081 1468.13 264.081 1459.41 Q264.081 1450.66 267.136 1446.07 Q270.215 1441.47 276.025 1441.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip820)" d="M 0 0 M770.468 1472.72 L778.107 1472.72 L778.107 1446.35 L769.797 1448.02 L769.797 1443.76 L778.06 1442.09 L782.736 1442.09 L782.736 1472.72 L790.375 1472.72 L790.375 1476.65 L770.468 1476.65 L770.468 1472.72 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip820)" d="M 0 0 M1278.8 1472.72 L1295.12 1472.72 L1295.12 1476.65 L1273.17 1476.65 L1273.17 1472.72 Q1275.84 1469.96 1280.42 1465.33 Q1285.03 1460.68 1286.21 1459.34 Q1288.45 1456.81 1289.33 1455.08 Q1290.23 1453.32 1290.23 1451.63 Q1290.23 1448.87 1288.29 1447.14 Q1286.37 1445.4 1283.27 1445.4 Q1281.07 1445.4 1278.61 1446.17 Q1276.18 1446.93 1273.41 1448.48 L1273.41 1443.76 Q1276.23 1442.62 1278.68 1442.05 Q1281.14 1441.47 1283.17 1441.47 Q1288.54 1441.47 1291.74 1444.15 Q1294.93 1446.84 1294.93 1451.33 Q1294.93 1453.46 1294.12 1455.38 Q1293.34 1457.28 1291.23 1459.87 Q1290.65 1460.54 1287.55 1463.76 Q1284.45 1466.95 1278.8 1472.72 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip820)" d="M 0 0 M1792.46 1458.02 Q1795.81 1458.74 1797.69 1461 Q1799.58 1463.27 1799.58 1466.61 Q1799.58 1471.72 1796.07 1474.52 Q1792.55 1477.32 1786.07 1477.32 Q1783.89 1477.32 1781.58 1476.88 Q1779.28 1476.47 1776.83 1475.61 L1776.83 1471.1 Q1778.77 1472.23 1781.09 1472.81 Q1783.4 1473.39 1785.93 1473.39 Q1790.33 1473.39 1792.62 1471.65 Q1794.93 1469.92 1794.93 1466.61 Q1794.93 1463.55 1792.78 1461.84 Q1790.65 1460.1 1786.83 1460.1 L1782.8 1460.1 L1782.8 1456.26 L1787.02 1456.26 Q1790.46 1456.26 1792.29 1454.89 Q1794.12 1453.5 1794.12 1450.91 Q1794.12 1448.25 1792.22 1446.84 Q1790.35 1445.4 1786.83 1445.4 Q1784.91 1445.4 1782.71 1445.82 Q1780.51 1446.24 1777.87 1447.11 L1777.87 1442.95 Q1780.53 1442.21 1782.85 1441.84 Q1785.19 1441.47 1787.25 1441.47 Q1792.57 1441.47 1795.67 1443.9 Q1798.77 1446.3 1798.77 1450.43 Q1798.77 1453.3 1797.13 1455.29 Q1795.49 1457.25 1792.46 1458.02 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip820)" d="M 0 0 M2295.28 1446.17 L2283.47 1464.61 L2295.28 1464.61 L2295.28 1446.17 M2294.05 1442.09 L2299.93 1442.09 L2299.93 1464.61 L2304.86 1464.61 L2304.86 1468.5 L2299.93 1468.5 L2299.93 1476.65 L2295.28 1476.65 L2295.28 1468.5 L2279.68 1468.5 L2279.68 1463.99 L2294.05 1442.09 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip820)" d="M 0 0 M126.631 1259.91 L139.107 1259.91 L139.107 1263.71 L126.631 1263.71 L126.631 1259.91 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip820)" d="M 0 0 M148.204 1270.86 L164.524 1270.86 L164.524 1274.8 L142.58 1274.8 L142.58 1270.86 Q145.242 1268.11 149.825 1263.48 Q154.431 1258.82 155.612 1257.48 Q157.857 1254.96 158.737 1253.22 Q159.64 1251.46 159.64 1249.77 Q159.64 1247.02 157.695 1245.28 Q155.774 1243.55 152.672 1243.55 Q150.473 1243.55 148.019 1244.31 Q145.589 1245.07 142.811 1246.62 L142.811 1241.9 Q145.635 1240.77 148.089 1240.19 Q150.542 1239.61 152.579 1239.61 Q157.95 1239.61 161.144 1242.3 Q164.339 1244.98 164.339 1249.47 Q164.339 1251.6 163.528 1253.52 Q162.741 1255.42 160.635 1258.01 Q160.056 1258.68 156.954 1261.9 Q153.853 1265.1 148.204 1270.86 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip820)" d="M 0 0 M179.593 1243.31 Q175.982 1243.31 174.153 1246.88 Q172.348 1250.42 172.348 1257.55 Q172.348 1264.66 174.153 1268.22 Q175.982 1271.76 179.593 1271.76 Q183.227 1271.76 185.033 1268.22 Q186.862 1264.66 186.862 1257.55 Q186.862 1250.42 185.033 1246.88 Q183.227 1243.31 179.593 1243.31 M179.593 1239.61 Q185.403 1239.61 188.459 1244.22 Q191.538 1248.8 191.538 1257.55 Q191.538 1266.28 188.459 1270.88 Q185.403 1275.47 179.593 1275.47 Q173.783 1275.47 170.704 1270.88 Q167.649 1266.28 167.649 1257.55 Q167.649 1248.8 170.704 1244.22 Q173.783 1239.61 179.593 1239.61 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip820)" d="M 0 0 M126.26 996.438 L138.737 996.438 L138.737 1000.23 L126.26 1000.23 L126.26 996.438 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip820)" d="M 0 0 M144.617 1007.39 L152.255 1007.39 L152.255 981.021 L143.945 982.688 L143.945 978.429 L152.209 976.762 L156.885 976.762 L156.885 1007.39 L164.524 1007.39 L164.524 1011.32 L144.617 1011.32 L144.617 1007.39 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip820)" d="M 0 0 M179.593 979.841 Q175.982 979.841 174.153 983.405 Q172.348 986.947 172.348 994.077 Q172.348 1001.18 174.153 1004.75 Q175.982 1008.29 179.593 1008.29 Q183.227 1008.29 185.033 1004.75 Q186.862 1001.18 186.862 994.077 Q186.862 986.947 185.033 983.405 Q183.227 979.841 179.593 979.841 M179.593 976.137 Q185.403 976.137 188.459 980.743 Q191.538 985.327 191.538 994.077 Q191.538 1002.8 188.459 1007.41 Q185.403 1011.99 179.593 1011.99 Q173.783 1011.99 170.704 1007.41 Q167.649 1002.8 167.649 994.077 Q167.649 985.327 170.704 980.743 Q173.783 976.137 179.593 976.137 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip820)" d="M 0 0 M179.593 716.367 Q175.982 716.367 174.153 719.932 Q172.348 723.474 172.348 730.603 Q172.348 737.71 174.153 741.274 Q175.982 744.816 179.593 744.816 Q183.227 744.816 185.033 741.274 Q186.862 737.71 186.862 730.603 Q186.862 723.474 185.033 719.932 Q183.227 716.367 179.593 716.367 M179.593 712.663 Q185.403 712.663 188.459 717.27 Q191.538 721.853 191.538 730.603 Q191.538 739.33 188.459 743.936 Q185.403 748.52 179.593 748.52 Q173.783 748.52 170.704 743.936 Q167.649 739.33 167.649 730.603 Q167.649 721.853 170.704 717.27 Q173.783 712.663 179.593 712.663 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip820)" d="M 0 0 M144.617 480.44 L152.255 480.44 L152.255 454.074 L143.945 455.741 L143.945 451.482 L152.209 449.815 L156.885 449.815 L156.885 480.44 L164.524 480.44 L164.524 484.375 L144.617 484.375 L144.617 480.44 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip820)" d="M 0 0 M179.593 452.894 Q175.982 452.894 174.153 456.458 Q172.348 460 172.348 467.13 Q172.348 474.236 174.153 477.801 Q175.982 481.342 179.593 481.342 Q183.227 481.342 185.033 477.801 Q186.862 474.236 186.862 467.13 Q186.862 460 185.033 456.458 Q183.227 452.894 179.593 452.894 M179.593 449.19 Q185.403 449.19 188.459 453.796 Q191.538 458.38 191.538 467.13 Q191.538 475.856 188.459 480.463 Q185.403 485.046 179.593 485.046 Q173.783 485.046 170.704 480.463 Q167.649 475.856 167.649 467.13 Q167.649 458.38 170.704 453.796 Q173.783 449.19 179.593 449.19 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip820)" d="M 0 0 M148.204 216.966 L164.524 216.966 L164.524 220.901 L142.58 220.901 L142.58 216.966 Q145.242 214.212 149.825 209.582 Q154.431 204.929 155.612 203.587 Q157.857 201.064 158.737 199.327 Q159.64 197.568 159.64 195.878 Q159.64 193.124 157.695 191.388 Q155.774 189.652 152.672 189.652 Q150.473 189.652 148.019 190.415 Q145.589 191.179 142.811 192.73 L142.811 188.008 Q145.635 186.874 148.089 186.295 Q150.542 185.716 152.579 185.716 Q157.95 185.716 161.144 188.402 Q164.339 191.087 164.339 195.577 Q164.339 197.707 163.528 199.628 Q162.741 201.527 160.635 204.119 Q160.056 204.79 156.954 208.008 Q153.853 211.202 148.204 216.966 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip820)" d="M 0 0 M179.593 189.42 Q175.982 189.42 174.153 192.985 Q172.348 196.527 172.348 203.656 Q172.348 210.763 174.153 214.327 Q175.982 217.869 179.593 217.869 Q183.227 217.869 185.033 214.327 Q186.862 210.763 186.862 203.656 Q186.862 196.527 185.033 192.985 Q183.227 189.42 179.593 189.42 M179.593 185.716 Q185.403 185.716 188.459 190.323 Q191.538 194.906 191.538 203.656 Q191.538 212.383 188.459 216.989 Q185.403 221.573 179.593 221.573 Q173.783 221.573 170.704 216.989 Q167.649 212.383 167.649 203.656 Q167.649 194.906 170.704 190.323 Q173.783 185.716 179.593 185.716 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip820)" d="M 0 0 M1300.76 1520.4 L1287.87 1537.74 L1301.43 1556.04 L1294.52 1556.04 L1284.15 1542.04 L1273.77 1556.04 L1266.86 1556.04 L1280.71 1537.39 L1268.04 1520.4 L1274.95 1520.4 L1284.4 1533.1 L1293.85 1520.4 L1300.76 1520.4 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip820)" d="M 0 0 M38.479 762.107 L43.3487 762.107 L43.3487 767.709 Q43.3487 770.86 44.6219 772.101 Q45.895 773.311 49.2052 773.311 L52.3562 773.311 L52.3562 763.667 L56.9077 763.667 L56.9077 773.311 L88.0042 773.311 L88.0042 779.199 L56.9077 779.199 L56.9077 784.801 L52.3562 784.801 L52.3562 779.199 L49.8736 779.199 Q43.9216 779.199 41.2162 776.43 Q38.479 773.661 38.479 767.645 L38.479 762.107 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip820)" d="M 0 0 M38.5426 741.896 Q45.8632 746.161 53.0246 748.23 Q60.186 750.299 67.5384 750.299 Q74.8908 750.299 82.1159 748.23 Q89.3091 746.129 96.5979 741.896 L96.5979 746.989 Q89.1182 751.763 81.8931 754.15 Q74.668 756.505 67.5384 756.505 Q60.4406 756.505 53.2474 754.15 Q46.0542 751.795 38.5426 746.989 L38.5426 741.896 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip820)" d="M 0 0 M52.3562 706.121 L69.7028 719.011 L88.0042 705.452 L88.0042 712.359 L73.9996 722.735 L88.0042 733.111 L88.0042 740.018 L69.3526 726.173 L52.3562 738.84 L52.3562 731.934 L65.0558 722.481 L52.3562 713.027 L52.3562 706.121 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip820)" d="M 0 0 M38.5426 700.232 L38.5426 695.14 Q46.0542 690.366 53.2474 688.01 Q60.4406 685.623 67.5384 685.623 Q74.668 685.623 81.8931 688.01 Q89.1182 690.366 96.5979 695.14 L96.5979 700.232 Q89.3091 695.999 82.1159 693.93 Q74.8908 691.83 67.5384 691.83 Q60.186 691.83 53.0246 693.93 Q45.8632 695.999 38.5426 700.232 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip822)" style="stroke:#009af9; stroke-width:4; stroke-opacity:1; fill:none" points="
  276.025,704.93 295.715,703.028 477.78,684.317 587.194,673.954 679.701,667.673 780.191,665.812 872.833,671.432 922.494,678.466 972.155,689.009 1029.69,706.363 
  1087.23,730.048 1189.49,789.766 1279.17,860.704 1328.06,904.902 1376.94,950.35 1426.12,993.517 1475.3,1028.33 1502.48,1041.11 1529.67,1047.17 1556.85,1044.56 
  1584.04,1031.21 1609.9,1006.56 1635.77,968.485 1661.64,915.6 1687.5,847.178 1714.4,760.025 1741.29,659.024 1768.19,549.6 1795.08,441.091 1806.4,398.912 
  1817.72,360.641 1829.04,327.746 1840.36,301.829 1851.68,284.593 1863,277.789 1874.32,283.152 1885.64,302.291 1892.55,321.344 1899.46,346.288 1906.37,377.291 
  1913.28,414.429 1920.19,457.669 1927.1,506.846 1934.01,561.638 1940.92,621.55 1954.74,753.729 1968.56,895.072 1975.47,965.505 1982.38,1033.31 1989.29,1096.33 
  1996.2,1152.2 2002.7,1195.95 2009.2,1229.02 2015.69,1249.27 2022.19,1254.67 2025.44,1251.22 2028.68,1243.42 2031.93,1231.1 2035.18,1214.13 2038.43,1192.42 
  2041.67,1165.93 2044.92,1134.66 2048.17,1098.67 2051.42,1058.09 2054.67,1013.13 2057.91,964.044 2061.16,911.194 2067.66,796.033 2074.15,672.214 2080.65,545.758 
  2087.15,424.082 2090.39,367.685 2093.64,315.775 2096.89,269.541 2100.14,230.18 2102.74,204.404 2105.34,184.378 2107.94,170.656 2110.54,163.746 2113.15,164.098 
  2115.75,172.089 2118.35,188.009 2120.95,212.044 2123.55,244.264 2126.15,284.599 2128.76,332.834 2131.36,388.586 2133.96,451.3 2136.56,520.231 2139.16,594.445 
  2141.76,672.807 2146.97,836.486 2152.17,998.503 2154.77,1074.22 2157.37,1143.72 2159.98,1204.91 2162.58,1255.73 2165.18,1294.19 2167.78,1318.49 2169.08,1324.82 
  2170.38,1327.05 2171.68,1325.02 2172.98,1318.63 2174.28,1307.77 2175.59,1292.4 2176.89,1272.5 2178.19,1248.08 2179.49,1219.2 2180.79,1185.95 2182.09,1148.49 
  2183.39,1107 2185.99,1012.95 2188.59,906.295 2191.2,790.331 2193.8,669.109 2196.4,547.37 2199,430.413 2200.3,375.494 2201.6,323.917 2202.9,276.412 
  2204.2,233.696 2205.5,196.467 2206.81,165.393 2208.11,141.092 2209.41,124.13 2210.71,114.999 2212.01,114.108 2213.31,121.768 2214.61,138.182 2215.91,163.427 
  2217.21,197.449 2218.51,240.045 2219.81,290.863 2221.11,349.388 2222.42,414.941 2223.72,486.676 2225.02,563.583 2227.62,728.094 2230.22,897.416 2231.52,979.904 
  2232.82,1058.65 2234.12,1131.9 2235.42,1197.89 2236.72,1254.9 2238.03,1301.31 2239.33,1335.64 2240.63,1356.59 2241.93,1363.11 2243.23,1354.46 2244.53,1330.21 
  2245.83,1290.33 2247.13,1235.23 2248.43,1165.74 2249.73,1083.2 2251.03,989.405 2252.33,886.624 2253.64,777.571 2254.94,665.355 2256.24,553.414 2257.54,445.428 
  2258.84,345.214 2260.14,256.591 2261.44,183.243 2262.74,128.553 2264.04,95.4403 2265.34,86.1857 2266.64,102.268 2267.04,112.427 2267.44,125.039 2267.85,140.09 
  2268.25,157.554 2269.05,199.571 2269.85,250.674 2270.65,310.276 2271.45,377.607 2272.25,451.728 2273.05,531.527 2274.65,702.938 2276.25,880.049 2277.05,966.585 
  2277.85,1049.43 2278.66,1126.79 2279.46,1196.9 2280.26,1258.08 2281.06,1308.73 2281.86,1347.43 2282.66,1372.93 2283.46,1384.24 2284.26,1380.65 2285.06,1361.77 
  2285.86,1327.58 2286.66,1278.41 2287.46,1215.02 2288.26,1138.59 2289.07,1050.67 2289.87,953.246 2290.67,848.659 2291.47,739.582 2292.27,628.965 
  "/>
</svg>
</div></div>
</div>
<p>Accordingly, the trapezoid rule is more accurate on the left half of the interval than on the right half.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">using</span> <span class="n">FundamentalsNumericalComputation</span>

<span class="n">n</span> <span class="o">=</span> <span class="o">@.</span> <span class="mi">50</span><span class="o">*</span><span class="mi">2</span><span class="o">^</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">)</span>
<span class="n">Tleft</span> <span class="o">=</span> <span class="p">[];</span> <span class="n">Tright</span> <span class="o">=</span> <span class="p">[];</span>
<span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">n</span><span class="p">)</span> <span class="o">=</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="n">Tleft</span> <span class="o">=</span> <span class="p">[</span> <span class="n">Tleft</span><span class="p">;</span> <span class="n">FNC</span><span class="o">.</span><span class="n">trapezoid</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">n</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="p">]</span> 
    <span class="n">Tright</span> <span class="o">=</span> <span class="p">[</span> <span class="n">Tright</span><span class="p">;</span> <span class="n">FNC</span><span class="o">.</span><span class="n">trapezoid</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="n">n</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="p">]</span> 
<span class="n">end</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">using</span> <span class="n">QuadGK</span>
<span class="n">left_val</span><span class="p">,</span><span class="n">err</span> <span class="o">=</span> <span class="n">quadgk</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">atol</span><span class="o">=</span><span class="mf">1e-14</span><span class="p">,</span><span class="n">rtol</span><span class="o">=</span><span class="mf">1e-14</span><span class="p">)</span>
<span class="n">right_val</span><span class="p">,</span><span class="n">err</span> <span class="o">=</span> <span class="n">quadgk</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="n">atol</span><span class="o">=</span><span class="mf">1e-14</span><span class="p">,</span><span class="n">rtol</span><span class="o">=</span><span class="mf">1e-14</span><span class="p">)</span>

<span class="n">using</span> <span class="n">DataFrames</span>
<span class="n">DataFrame</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span><span class="n">left_error</span><span class="o">=</span><span class="n">Tleft</span><span class="o">.-</span><span class="n">left_val</span><span class="p">,</span><span class="n">right_error</span><span class="o">=</span><span class="n">Tright</span><span class="o">.-</span><span class="n">right_val</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="data-frame"><thead><tr><th></th><th>n</th><th>left_error</th><th>right_error</th></tr><tr><th></th><th>Int64</th><th>Float64</th><th>Float64</th></tr></thead><tbody><p>4 rows × 3 columns</p><tr><th>1</th><td>50</td><td>-0.00249106</td><td>0.504229</td></tr><tr><th>2</th><td>100</td><td>-0.000622715</td><td>0.0960044</td></tr><tr><th>3</th><td>200</td><td>-0.000155675</td><td>0.0225473</td></tr><tr><th>4</th><td>400</td><td>-3.89187e-5</td><td>0.00555422</td></tr></tbody></table></div></div>
</div>
<p>Both the picture and the numbers suggest that more nodes should be used on the right half of the interval than on the left half.</p>
</div>


              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="int-extrap.html" title="previous page">Extrapolation for numerical integration</a>
    <a class='right-next' id="next-link" href="adapt-usage.html" title="next page">Adaptive integration</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Tobin A. Driscoll and Richard J. Braun<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    <script src="../../_static/js/index.js"></script>
    
  </body>
</html>