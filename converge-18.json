{"kind":"Notebook","sha256":"58096f2a4ebb868e7f725fca0066acc3d892cdebb4f1065c1b94934d7d2d9d59","slug":"converge-18","location":"/chapter8/section6/matlab/converge.ipynb","dependencies":[],"frontmatter":{"numbering":{"heading_1":{"enabled":false},"heading_2":{"enabled":false},"heading_3":{"enabled":false},"heading_4":{"enabled":false},"heading_5":{"enabled":false},"heading_6":{"enabled":false}},"kernelspec":{"name":"jupyter_matlab_kernel","display_name":"MATLAB Kernel","language":"matlab"},"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"exports":[{"format":"ipynb","filename":"converge.ipynb","url":"/fnc/build/converge-aebfb27c5a33bff4a8d4d7000757b699.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"nhMA7tEeK5"},{"type":"text","value":"8.6.3","key":"u8Xhhy2AoL"}],"key":"dwSAO820rE"}],"identifier":"demo-minrescg-converge","label":"demo-minrescg-converge","kind":"proof:example","template":"Example %s","enumerator":"8.6.3","resolved":true,"html_id":"demo-minrescg-converge","remote":true,"url":"/minrescg","dataUrl":"/minrescg.json","key":"ZUhiZTsqsw"}],"key":"ewb8oexFxw"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We will compare MINRES and CG on some quasi-random ","key":"Wj6pJPVp1s"},{"type":"abbreviation","title":"symmetric positive definite","children":[{"type":"text","value":"SPD","key":"L8kgKsI3nO"}],"key":"T3HC4McMhi"},{"type":"text","value":" problems.  The first matrix has a condition number of 100.","key":"h7wnF0AJPz"}],"key":"g2BG2Rowg2"}],"key":"rY0kg7GMz3"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"n = 5000;\ndensity = 0.001;\nA = sprandsym(n, density, 1e-2, 2);","key":"XoM22sZ46K"},{"type":"output","id":"hycC4gUah4rMibyfQv5h8","data":[],"key":"sUSaMbk44x"}],"key":"HIE0yBpBIm"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We generate a system with a known solution.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TAE5JYh5DC"}],"key":"kt6O4yyr2M"}],"key":"YWzv0g4V1Y"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"x = (1:n)' / n;\nb = A * x;","key":"hQ2kYuqw3f"},{"type":"output","id":"xjtNu8vxi5yrPYv8rhxXq","data":[],"key":"YKGkLXpUrJ"}],"key":"eNZn4vSJNB"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Now we apply both methods and compare the convergence of the system residuals.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"obBEfFhkoe"}],"indexEntries":[{"entry":"MATLAB","subEntry":{"value":"pcg","kind":"entry"},"emphasis":true}],"label":"index-BdNTqk7zMW","identifier":"index-bdntqk7zmw","html_id":"index-bdntqk7zmw","key":"OlmiccMVsw"}],"key":"UL34ryiMh2"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"[xMR, ~, ~, ~, residMR] = minres(A, b, 1e-7, 100);\n[xCG, ~, ~, ~, residCG] = pcg(A, b, 1e-7, 100);\nM = length(residMR) - 1;\nclf,  semilogy(0:M, residMR / norm(b), '.-')\nM = length(residCG) - 1;\nhold on,  semilogy(0:M, residCG / norm(b), '.-')\ntitle('Convergence of MINRES and CG')\nxlabel('Krylov dimension m')\nylabel('||r_m|| / ||b||')\nlegend('MINRES', 'CG');","key":"YN6c6jPhHZ"},{"type":"output","id":"xBQx3NoTwNqkS7jbQui3q","data":[{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"ae5276334dfea6b1e00b45dad0255bd2","path":"/fnc/build/ae5276334dfea6b1e00b45dad0255bd2.png"}}}],"key":"ocwttXvFFA"}],"key":"MCO0lIjAhk"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"There is little difference between the two methods here. Next, we increase the condition number of the matrix by a factor of 25. The rule of thumb predicts that the number of iterations required should increase by a factor of about 5.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nqNN0Ul2LM"}],"key":"IjRcNKUOmq"}],"key":"ucF48x6Ec9"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"A = sprandsym(n, density, 1e-2 / 25, 2);\nb = A * x;","key":"h5YXwt9yAI"},{"type":"output","id":"LkkxPpDJw1IMosWIJRlty","data":[],"key":"M3RePXEbJc"}],"key":"HwL6ESqoCI"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"matlab","executable":true,"value":"[xMR, ~, ~, ~, residMR] = minres(A, b, 1e-7, 400);\n[xCG, ~, ~, ~, residCG] = pcg(A, b, 1e-7, 400);\nM = length(residMR) - 1;\nclf,  semilogy(0:M, residMR / norm(b), '.-')\nM = length(residCG) - 1;\nhold on,  semilogy(0:M, residCG / norm(b), '.-')\ntitle('Convergence of MINRES and CG')\nxlabel('Krylov dimension m')\nylabel('||r_m|| / ||b||')\nlegend('MINRES', 'CG');","visibility":"hide","key":"WpCYKqe2bC"},{"type":"output","id":"kc7lAyxNFNdrjCjxPrebc","data":[{"output_type":"execute_result","execution_count":6,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"8ee95cc4431b82f406b7530726b4a4a2","path":"/fnc/build/8ee95cc4431b82f406b7530726b4a4a2.png"}}}],"visibility":"show","key":"EJVSaKdqlP"}],"visibility":"show","key":"XUei4mCo6j"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Both methods have an early superlinear phase that allow them to finish slightly sooner than the factor of 5 predicted: ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bb6iofFPG9"},{"type":"crossReference","kind":"proof:theorem","identifier":"theorem-minrescg-converge","label":"theorem-minrescg-converge","children":[{"type":"text","value":"Theorem ","key":"nTZmLHmiNY"},{"type":"text","value":"8.6.2","key":"iUpi2IMlAO"}],"template":"Theorem %s","enumerator":"8.6.2","resolved":true,"html_id":"theorem-minrescg-converge","remote":true,"url":"/minrescg","dataUrl":"/minrescg.json","key":"bRUNjpNW0b"},{"type":"text","value":" is an upper bound, not necessarily an approximation. Both methods ultimately achieve the same reduction in the residual; MINRES stops earlier, but with a slightly larger error.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OPrk4zsJDc"}],"key":"Ydfv1hZr00"}],"key":"ttzO07tmEc"}],"key":"YsrCnBQ3Mx"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Indefinite","url":"/indefinite-1","group":"Chapter 8"},"next":{"title":"Blur","url":"/blur-1","group":"Chapter 8"}}},"domain":"http://localhost:3000"}