<!DOCTYPE html><html lang="en" class="" style="scroll-padding:60px"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>Chapter 2 - Fundamentals of Numerical Computation</title><meta property="og:title" content="Chapter 2 - Fundamentals of Numerical Computation"/><meta name="generator" content="mystmd"/><meta name="description" content="Online textbook for computational mathematics"/><meta property="og:description" content="Online textbook for computational mathematics"/><meta name="keywords" content=""/><meta name="image" content="/fnc/build/front_cover_small-3b81a246c798b3ded1375244c3419355.webp"/><meta property="og:image" content="/fnc/build/front_cover_small-3b81a246c798b3ded1375244c3419355.webp"/><link rel="icon" href="/fnc/favicon.ico"/><link rel="stylesheet" href="/fnc/build/_assets/app-H3NBUYVS.css"/><link rel="stylesheet" href="/fnc/build/_assets/thebe-core-VKVHG5VY.css"/><link rel="stylesheet" href="/myst-theme.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jupyter-matplotlib@0.11.3/css/mpl_widget.css"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css" integrity="sha384-MlJdn/WNKDGXveldHDdyRP1R4CTHr3FeuDNfhsLPYrq2t0UBkUdK2jyTnXPEK1NQ" crossorigin="anonymous"/><script>
  const savedTheme = localStorage.getItem("myst:theme");
  const theme = window.matchMedia("(prefers-color-scheme: light)").matches ? 'light' : 'dark';
  const classes = document.documentElement.classList;
  const hasAnyTheme = classes.contains('light') || classes.contains('dark');
  if (!hasAnyTheme) classes.add(savedTheme ?? theme);
</script></head><body class="m-0 transition-colors duration-500 bg-white dark:bg-stone-900"><div class="fixed top-1 left-1 h-[0px] w-[0px] focus-within:z-40 focus-within:h-auto focus-within:w-auto bg-white overflow-hidden focus-within:p-2 focus-within:ring-1" aria-label="skip to content options"><a href="#skip-to-frontmatter" class="block px-2 py-1 text-black underline">Skip to article frontmatter</a><a href="#skip-to-article" class="block px-2 py-1 text-black underline">Skip to article content</a></div><div class="bg-white/80 backdrop-blur dark:bg-stone-900/80 shadow dark:shadow-stone-700 p-3 md:px-8 sticky w-screen top-0 z-30 h-[60px]"><nav class="flex items-center justify-between flex-nowrap max-w-[1440px] mx-auto"><div class="flex flex-row xl:min-w-[19.5rem] mr-2 sm:mr-7 justify-start items-center shrink-0"><div class="block xl:hidden"><button class="flex items-center border-stone-400 text-stone-800 hover:text-stone-900 dark:text-stone-200 hover:dark:text-stone-100"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="m-1"><path fill-rule="evenodd" d="M3 6.75A.75.75 0 0 1 3.75 6h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 6.75ZM3 12a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 12Zm0 5.25a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75a.75.75 0 0 1-.75-.75Z" clip-rule="evenodd"></path></svg><span class="sr-only">Open Menu</span></button></div><a class="flex items-center ml-3 dark:text-white w-fit md:ml-5 xl:ml-7" href="/fnc/"><div class="p-1 mr-3 dark:bg-white dark:rounded"><img src="/fnc/build/FNClogo-8857b73cc9f6c65c9fea3e10797ba18a.png" class="h-9" alt="Fundamentals of Numerical Computation" height="2.25rem"/></div><span class="text-md sm:text-xl tracking-tight sm:mr-5 sr-only">Made with MyST</span></a></div><div class="flex items-center flex-grow w-auto"><div class="flex-grow hidden text-md lg:block"></div><div class="flex-grow block"></div><button type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:R3iop:" data-state="closed" class="flex items-center h-10 aspect-square sm:w-64 text-left text-gray-400 border border-gray-300 dark:border-gray-600 rounded-lg bg-gray-50 dark:bg-gray-700 hover:ring-blue-500 dark:hover:ring-blue-500 hover:border-blue-500 dark:hover:border-blue-500"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="p-2.5 h-10 w-10 aspect-square"><path fill-rule="evenodd" d="M10.5 3.75a6.75 6.75 0 1 0 0 13.5 6.75 6.75 0 0 0 0-13.5ZM2.25 10.5a8.25 8.25 0 1 1 14.59 5.28l4.69 4.69a.75.75 0 1 1-1.06 1.06l-4.69-4.69A8.25 8.25 0 0 1 2.25 10.5Z" clip-rule="evenodd"></path></svg><span class="hidden sm:block grow">Search</span><div aria-hidden="true" class="items-center hidden mx-1 font-mono text-sm text-gray-400 sm:flex gap-x-1"><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none hide-mac">CTRL</kbd><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none show-mac">⌘</kbd><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none ">K</kbd><script>
;(() => {
const script = document.currentScript;
const root = script.parentElement;

const isMac = /mac/i.test(
      window.navigator.userAgentData?.platform ?? window.navigator.userAgent,
    );
root.querySelectorAll(".hide-mac").forEach(node => {node.classList.add(isMac ? "hidden" : "block")});
root.querySelectorAll(".show-mac").forEach(node => {node.classList.add(!isMac ? "hidden" : "block")});
})()</script></div></button><button class="theme rounded-full aspect-square border border-stone-700 dark:border-white hover:bg-neutral-100 border-solid overflow-hidden text-stone-700 dark:text-white hover:text-stone-500 dark:hover:text-neutral-800 w-8 h-8 mx-3" title="Toggle theme between light and dark mode." aria-label="Toggle theme between light and dark mode."><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="h-full w-full p-0.5 hidden dark:block"><path fill-rule="evenodd" d="M9.528 1.718a.75.75 0 0 1 .162.819A8.97 8.97 0 0 0 9 6a9 9 0 0 0 9 9 8.97 8.97 0 0 0 3.463-.69.75.75 0 0 1 .981.98 10.503 10.503 0 0 1-9.694 6.46c-5.799 0-10.5-4.7-10.5-10.5 0-4.368 2.667-8.112 6.46-9.694a.75.75 0 0 1 .818.162Z" clip-rule="evenodd"></path></svg><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-full w-full p-0.5 dark:hidden"><path stroke-linecap="round" stroke-linejoin="round" d="M12 3v2.25m6.364.386-1.591 1.591M21 12h-2.25m-.386 6.364-1.591-1.591M12 18.75V21m-4.773-4.227-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0Z"></path></svg></button><div class="block sm:hidden"></div><div class="hidden sm:block"></div></div></nav></div><div class="fixed xl:article-grid grid-gap xl:w-screen xl:pointer-events-none overflow-auto max-xl:min-w-[300px] hidden z-10" style="top:60px"><div class="pointer-events-auto xl:col-margin-left flex-col overflow-hidden hidden xl:flex"><div class="flex-grow py-6 overflow-y-auto"><nav aria-label="Navigation" class="overflow-y-hidden transition-opacity ml-3 xl:ml-0 mr-3 max-w-[350px] lg:hidden"><div class="w-full px-1 dark:text-white"></div></nav><div class="my-3 border-b-2 lg:hidden"></div><nav aria-label="Table of Contents" class="flex-grow overflow-y-hidden transition-opacity ml-3 xl:ml-0 mr-3 max-w-[350px]"><div class="w-full px-1 dark:text-white"><a title="Fundamentals of Numerical Computation" class="block break-words focus:outline outline-blue-200 outline-2 rounded p-2 my-1 rounded-lg hover:bg-slate-300/30 font-bold" href="/fnc/">FNC</a><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Preface" class="block break-words rounded py-2 grow cursor-pointer">Preface</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:Rbd8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:Rbd8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><a title="Introduction" class="block break-words focus:outline outline-blue-200 outline-2 rounded py-2 grow" href="/fnc/overview">Introduction</a><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:Rfd8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:Rfd8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><a title="Linear systems of equations" class="block break-words focus:outline outline-blue-200 outline-2 rounded py-2 grow" href="/fnc/overview-1">Linear systems of equations</a><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:Rjd8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:Rjd8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><a title="Overdetermined linear systems" class="block break-words focus:outline outline-blue-200 outline-2 rounded py-2 grow" href="/fnc/overview-2">Overdetermined linear systems</a><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:Rnd8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:Rnd8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><a title="Roots of nonlinear equations" class="block break-words focus:outline outline-blue-200 outline-2 rounded py-2 grow" href="/fnc/overview-3">Roots of nonlinear equations</a><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:Rrd8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:Rrd8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><a title="Piecewise interpolation" class="block break-words focus:outline outline-blue-200 outline-2 rounded py-2 grow" href="/fnc/overview-4">Piecewise interpolation</a><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:Rvd8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:Rvd8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><a title="Initial-value problems for ODEs" class="block break-words focus:outline outline-blue-200 outline-2 rounded py-2 grow" href="/fnc/overview-5">Initial-value problems for ODEs</a><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R13d8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R13d8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Appendices" class="block break-words rounded py-2 grow cursor-pointer">Appendices</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R17d8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R17d8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><a title="Index" class="block break-words focus:outline outline-blue-200 outline-2 rounded p-2 my-1 rounded-lg hover:bg-slate-300/30" href="/fnc/genindex">Index</a></div></nav></div><div class="flex-none py-6 transition-all duration-700 translate-y-6 opacity-0"><a class="flex mx-auto text-gray-700 w-fit hover:text-blue-700 dark:text-gray-200 dark:hover:text-blue-400" href="https://mystmd.org/made-with-myst" target="_blank" rel="noreferrer"><svg style="width:24px;height:24px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" stroke="none"><g id="icon"><path fill="currentColor" d="M23.8,54.8v-3.6l4.7-0.8V17.5l-4.7-0.8V13H36l13.4,31.7h0.2l13-31.7h12.6v3.6l-4.7,0.8v32.9l4.7,0.8v3.6h-15
          v-3.6l4.9-0.8V20.8H65L51.4,53.3h-3.8l-14-32.5h-0.1l0.2,17.4v12.1l5,0.8v3.6H23.8z"></path><path fill="#F37726" d="M47,86.9c0-5.9-3.4-8.8-10.1-8.8h-8.4c-5.2,0-9.4-1.3-12.5-3.8c-3.1-2.5-5.4-6.2-6.8-11l4.8-1.6
          c1.8,5.6,6.4,8.6,13.8,8.8h9.2c6.4,0,10.8,2.5,13.1,7.5c2.3-5,6.7-7.5,13.1-7.5h8.4c7.8,0,12.7-2.9,14.6-8.7l4.8,1.6
          c-1.4,4.9-3.6,8.6-6.8,11.1c-3.1,2.5-7.3,3.7-12.4,3.8H63c-6.7,0-10,2.9-10,8.8"></path></g></svg><span class="self-center ml-2 text-sm">Made with MyST</span></a></div></div></div><article class="article content article-grid grid-gap"><main class="article-grid subgrid-gap col-screen"><div class="hidden"></div><div id="skip-to-frontmatter" aria-label="article frontmatter" class="mb-8 pt-9"><div class="flex items-center h-6 mb-5 text-sm font-light"><div class="flex-grow"></div><a href="https://github.com/fncbook/fnc" title="GitHub Repository: fncbook/fnc" target="_blank" rel="noopener noreferrer" class="text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="inline-block mr-1 opacity-60 hover:opacity-100"><path d="M12 2.5c-5.4 0-9.8 4.4-9.8 9.7 0 4.3 2.8 8 6.7 9.2.5.1.7-.2.7-.5v-1.8c-2.4.5-3.1-.6-3.3-1.1-.1-.3-.6-1.1-1-1.4-.3-.2-.8-.6 0-.6s1.3.7 1.5 1c.9 1.5 2.3 1.1 2.8.8.1-.6.3-1.1.6-1.3-2.2-.2-4.4-1.1-4.4-4.8 0-1.1.4-1.9 1-2.6-.1-.2-.4-1.2.1-2.6 0 0 .8-.3 2.7 1 .8-.2 1.6-.3 2.4-.3.8 0 1.7.1 2.4.3 1.9-1.3 2.7-1 2.7-1 .5 1.3.2 2.3.1 2.6.6.7 1 1.5 1 2.6 0 3.7-2.3 4.6-4.4 4.8.4.3.7.9.7 1.8V21c0 .3.2.6.7.5 3.9-1.3 6.6-4.9 6.6-9.2 0-5.4-4.4-9.8-9.8-9.8z"></path></svg></a><div class="inline-block mr-1"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="inline-block"><title>Jupyter Notebook</title><path d="M20.2 1.7c0 .8-.5 1.4-1.3 1.5-.8 0-1.4-.5-1.5-1.3 0-.8.5-1.4 1.3-1.5.8-.1 1.5.5 1.5 1.3zM12 17.9c-3.7 0-7-1.3-8.7-3.3 1.8 4.8 7.1 7.3 11.9 5.5 2.5-.9 4.5-2.9 5.5-5.5-1.7 2-4.9 3.3-8.7 3.3zM12 5.1c3.7 0 7 1.3 8.7 3.3-1.8-4.8-7.1-7.3-11.9-5.5-2.5.9-4.5 2.9-5.5 5.5 1.7-2 5-3.3 8.7-3.3zM6.9 21.8c.1 1-.7 1.8-1.7 1.9-1 .1-1.8-.7-1.9-1.7 0-1 .7-1.8 1.7-1.9 1-.1 1.8.7 1.9 1.7zM3.7 4.6c-.6 0-1-.4-1-1s.4-1 1-1 1 .4 1 1c0 .5-.4 1-1 1z"></path></svg></div><div class="relative flex inline-block mx-1 grow-0" data-headlessui-state=""><button class="relative ml-2 -mr-1" id="headlessui-menu-button-:Rd4fop:" type="button" aria-haspopup="menu" aria-expanded="false" data-headlessui-state=""><span class="sr-only">Downloads</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem"><path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"></path></svg></button></div></div><h1 class="mb-0">Chapter 2</h1><header class="mt-4 not-prose"><div><span class="font-semibold text-sm inline-block text-comma"><button class="focus:shadow-[0_0_0_2px] focus:shadow-black outline-none hover:underline" aria-label="Author Details" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:R5kfop:" data-state="closed">Tobin A. Driscoll</button><a class="ml-1" href="mailto:driscoll@udel.edu" title="Tobin A. Driscoll &lt;driscoll@udel.edu&gt;" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1rem" height="1rem" class="inline-block text-gray-400 hover:text-blue-400 -translate-y-[0.1em]"><path d="M21.8 18c0 1.1-.9 2-1.9 2H4.2c-1.1 0-1.9-.9-1.9-2V9.9c0-.5.3-.7.8-.4l7.8 4.7c.7.4 1.7.4 2.4 0L21 9.5c.4-.2.8-.1.8.4V18z"></path><path d="M21.8 6c0-1.1-.9-2-1.9-2H4.2c-1.1 0-2 .9-2 2v.4c0 .5.3 1.1.8 1.3l8.5 5.1c.2.1.7.1.9 0l8.6-5c.4-.3.8-.9.8-1.3-.1-.1-.1-.5 0-.5z"></path></svg></a></span><span class="font-semibold text-sm inline-block"><button class="focus:shadow-[0_0_0_2px] focus:shadow-black outline-none hover:underline" aria-label="Author Details" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:R6kfop:" data-state="closed">Richard J. Braun</button></span></div></header></div><div class="block my-10 lg:sticky lg:z-10 lg:h-0 lg:pt-0 lg:my-0 lg:ml-10 lg:col-margin-right" style="top:60px"><nav></nav></div><div id="skip-to-article"></div><div id="a04JoWeMqK" class="relative group/block article-grid subgrid-gap col-screen"><p>MATLAB implementations</p><h2 id="functions" class="relative group"><span class="heading-text">Functions</span><a class="no-underline text-inherit hover:text-inherit px-2 font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#functions" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><details class="rounded-md my-5 shadow dark:shadow-2xl dark:shadow-neutral-900 overflow-hidden bg-gray-50 dark:bg-stone-800"><summary class="m-0 text-lg font-medium py-1 min-h-[2em] pl-3 cursor-pointer hover:shadow-[inset_0_0_0px_30px_#00000003] dark:hover:shadow-[inset_0_0_0px_30px_#FFFFFF03] bg-gray-100 dark:bg-slate-900"><span class="text-neutral-900 dark:text-white"><span class="block float-right text-sm font-thin text-neutral-700 dark:text-neutral-200"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="inline-block pl-2 mr-2 -translate-y-[1px] details-toggle transition-transform"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></span>Forward substitution</span></summary><div class="px-4 py-1 details-body"><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm bg-stone-200/10"><div class="flex flex-row pl-2 bg-white border-b dark:bg-slate-600 dark:border-slate-300"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="16px" height="16px" class="self-center flex-none inline-block text-gray-500 dark:text-gray-100"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m2.25 0H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"></path></svg><div class="self-center p-2 text-sm leading-3 prose text-slate-600 dark:text-white">forwardsub.m</div></div><pre class="block p-3 hljs" style="background-color:unset"><code style="display:inline-block;float:left;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;border-left:4px solid transparent"><span class="react-syntax-highlighter-line-number">1
</span><span class="react-syntax-highlighter-line-number">2
</span><span class="react-syntax-highlighter-line-number">3
</span><span class="react-syntax-highlighter-line-number">4
</span><span class="react-syntax-highlighter-line-number">5
</span><span class="react-syntax-highlighter-line-number">6
</span><span class="react-syntax-highlighter-line-number">7
</span><span class="react-syntax-highlighter-line-number">8
</span><span class="react-syntax-highlighter-line-number">9
</span><span class="react-syntax-highlighter-line-number">10
</span><span class="react-syntax-highlighter-line-number">11
</span><span class="react-syntax-highlighter-line-number">12
</span><span class="react-syntax-highlighter-line-number">13
</span></code><code class="language-matlab" style="white-space:pre">function x = forwardsub(L,b)
% FORWARDSUB   Solve a lower triangular linear system.
% Input:
%   L    lower triangular square matrix (n by n)
%   b    right-hand side vector (n by 1)   
% Output:
%   x    solution of Lx=b (n by 1 vector)

n = length(L);
x = zeros(n,1);
for i = 1:n
  x(i) = ( b(i) - L(i,1:i-1) * x(1:i-1) ) / L(i,i);
end</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-[32px]" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><details class="my-5 shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-gray-50/10 dark:bg-stone-800 overflow-hidden rounded border-l-4 border-blue-500 dropdown"><summary class="m-0 font-medium py-1 flex min-w-0 text-lg text-blue-600 bg-blue-50 dark:bg-slate-900 cursor-pointer hover:shadow-[inset_0_0_0px_30px_#00000003] dark:hover:shadow-[inset_0_0_0px_30px_#FFFFFF03]"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="inline-block pl-2 mr-2 self-center flex-none text-blue-600"><path stroke-linecap="round" stroke-linejoin="round" d="m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"></path></svg><div class="text-neutral-900 dark:text-white grow self-center overflow-hidden break-words">About the code</div><div class="self-center flex-none text-sm font-thin text-neutral-700 dark:text-neutral-200"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="inline-block pl-2 mr-2 self-center flex-none transition-transform details-toggle"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></div></summary><div class="px-4 py-1 details-body"><p>Line 12 implements <span data-state="closed"><a class="hover-link" href="/fnc/linear-systems#forwardsub">(<!-- -->2.3.7<!-- -->)</a></span>. It contains an inner product between row <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span></span> of <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">L</mi></mrow><annotation encoding="application/x-tex">\mathbf{L}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6861em;"></span><span class="mord mathbf">L</span></span></span></span></span> and the solution vector <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">x</mi></mrow><annotation encoding="application/x-tex">\mathbf{x}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4444em;"></span><span class="mord mathbf">x</span></span></span></span></span>, using only the entries of <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">x</mi></mrow><annotation encoding="application/x-tex">\mathbf{x}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4444em;"></span><span class="mord mathbf">x</span></span></span></span></span> that have already been computed.</p></div></details></div></details><details class="rounded-md my-5 shadow dark:shadow-2xl dark:shadow-neutral-900 overflow-hidden bg-gray-50 dark:bg-stone-800"><summary class="m-0 text-lg font-medium py-1 min-h-[2em] pl-3 cursor-pointer hover:shadow-[inset_0_0_0px_30px_#00000003] dark:hover:shadow-[inset_0_0_0px_30px_#FFFFFF03] bg-gray-100 dark:bg-slate-900"><span class="text-neutral-900 dark:text-white"><span class="block float-right text-sm font-thin text-neutral-700 dark:text-neutral-200"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="inline-block pl-2 mr-2 -translate-y-[1px] details-toggle transition-transform"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></span>Backward substitution</span></summary><div class="px-4 py-1 details-body"><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm bg-stone-200/10"><div class="flex flex-row pl-2 bg-white border-b dark:bg-slate-600 dark:border-slate-300"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="16px" height="16px" class="self-center flex-none inline-block text-gray-500 dark:text-gray-100"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m2.25 0H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"></path></svg><div class="self-center p-2 text-sm leading-3 prose text-slate-600 dark:text-white">backsub.m</div></div><pre class="block p-3 hljs" style="background-color:unset"><code style="display:inline-block;float:left;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;border-left:4px solid transparent"><span class="react-syntax-highlighter-line-number">1
</span><span class="react-syntax-highlighter-line-number">2
</span><span class="react-syntax-highlighter-line-number">3
</span><span class="react-syntax-highlighter-line-number">4
</span><span class="react-syntax-highlighter-line-number">5
</span><span class="react-syntax-highlighter-line-number">6
</span><span class="react-syntax-highlighter-line-number">7
</span><span class="react-syntax-highlighter-line-number">8
</span><span class="react-syntax-highlighter-line-number">9
</span><span class="react-syntax-highlighter-line-number">10
</span><span class="react-syntax-highlighter-line-number">11
</span><span class="react-syntax-highlighter-line-number">12
</span><span class="react-syntax-highlighter-line-number">13
</span></code><code class="language-matlab" style="white-space:pre">function x = backsub(U,b)
% BACKSUB   Solve an upper triangular linear system.
% Input:
%   U    upper triangular square matrix (n by n)
%   b    right-hand side vector (n by 1)   
% Output:
%   x    solution of Ux=b (n by 1 vector)

n = length(U);
x = zeros(n,1);
for i = n:-1:1
  x(i) = ( b(i) - U(i,i+1:n)*x(i+1:n) ) / U(i,i);
end</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-[32px]" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div></div></details><details class="rounded-md my-5 shadow dark:shadow-2xl dark:shadow-neutral-900 overflow-hidden bg-gray-50 dark:bg-stone-800"><summary class="m-0 text-lg font-medium py-1 min-h-[2em] pl-3 cursor-pointer hover:shadow-[inset_0_0_0px_30px_#00000003] dark:hover:shadow-[inset_0_0_0px_30px_#FFFFFF03] bg-gray-100 dark:bg-slate-900"><span class="text-neutral-900 dark:text-white"><span class="block float-right text-sm font-thin text-neutral-700 dark:text-neutral-200"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="inline-block pl-2 mr-2 -translate-y-[1px] details-toggle transition-transform"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></span><abbr aria-label="lower triangular times upper triangular" class="border-b border-dotted cursor-help" data-state="closed">LU</abbr> factorization (not stable)</span></summary><div class="px-4 py-1 details-body"><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm bg-stone-200/10"><div class="flex flex-row pl-2 bg-white border-b dark:bg-slate-600 dark:border-slate-300"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="16px" height="16px" class="self-center flex-none inline-block text-gray-500 dark:text-gray-100"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m2.25 0H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"></path></svg><div class="self-center p-2 text-sm leading-3 prose text-slate-600 dark:text-white">lufact.m</div></div><pre class="block p-3 hljs" style="background-color:unset"><code style="display:inline-block;float:left;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;border-left:4px solid transparent"><span class="react-syntax-highlighter-line-number">1
</span><span class="react-syntax-highlighter-line-number">2
</span><span class="react-syntax-highlighter-line-number">3
</span><span class="react-syntax-highlighter-line-number">4
</span><span class="react-syntax-highlighter-line-number">5
</span><span class="react-syntax-highlighter-line-number">6
</span><span class="react-syntax-highlighter-line-number">7
</span><span class="react-syntax-highlighter-line-number">8
</span><span class="react-syntax-highlighter-line-number">9
</span><span class="react-syntax-highlighter-line-number">10
</span><span class="react-syntax-highlighter-line-number">11
</span><span class="react-syntax-highlighter-line-number">12
</span><span class="react-syntax-highlighter-line-number">13
</span><span class="react-syntax-highlighter-line-number">14
</span><span class="react-syntax-highlighter-line-number">15
</span><span class="react-syntax-highlighter-line-number">16
</span><span class="react-syntax-highlighter-line-number">17
</span><span class="react-syntax-highlighter-line-number">18
</span><span class="react-syntax-highlighter-line-number">19
</span><span class="react-syntax-highlighter-line-number">20
</span></code><code class="language-matlab" style="white-space:pre">function [L, U] = lufact(A)
% LUFACT   LU factorization (demo only--not stable!).
% Input:
%   A    square matrix
% Output:
%   L,U  unit lower triangular and upper triangular such that LU=A

n = size(A, 1);     % detect the dimensions from the input
L = eye(n);         % ones on main diagonal, zeros elsewhere
U = zeros(n, n);
A_k = A;            % make a working copy 

% Reduction by outer products
for k = 1:n-1
    U(k, :) = A_k(k, :);
    L(:, k) = A_k(:,k) / U(k, k);
    A_k = A_k -  L(:, k) * U(k, :);
end
U(n, n) = A_k(n, n);
L = tril(L); U = triu(U);    % force exact triangularity</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-[32px]" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div></div></details><details class="rounded-md my-5 shadow dark:shadow-2xl dark:shadow-neutral-900 overflow-hidden bg-gray-50 dark:bg-stone-800"><summary class="m-0 text-lg font-medium py-1 min-h-[2em] pl-3 cursor-pointer hover:shadow-[inset_0_0_0px_30px_#00000003] dark:hover:shadow-[inset_0_0_0px_30px_#FFFFFF03] bg-gray-100 dark:bg-slate-900"><span class="text-neutral-900 dark:text-white"><span class="block float-right text-sm font-thin text-neutral-700 dark:text-neutral-200"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="inline-block pl-2 mr-2 -translate-y-[1px] details-toggle transition-transform"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></span><abbr aria-label="lower triangular times upper triangular" class="border-b border-dotted cursor-help" data-state="closed">LU</abbr> factorization with partial pivoting</span></summary><div class="px-4 py-1 details-body"><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm bg-stone-200/10"><div class="flex flex-row pl-2 bg-white border-b dark:bg-slate-600 dark:border-slate-300"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="16px" height="16px" class="self-center flex-none inline-block text-gray-500 dark:text-gray-100"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m2.25 0H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"></path></svg><div class="self-center p-2 text-sm leading-3 prose text-slate-600 dark:text-white">plufact.m</div></div><pre class="block p-3 hljs" style="background-color:unset"><code style="display:inline-block;float:left;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;border-left:4px solid transparent"><span class="react-syntax-highlighter-line-number">1
</span><span class="react-syntax-highlighter-line-number">2
</span><span class="react-syntax-highlighter-line-number">3
</span><span class="react-syntax-highlighter-line-number">4
</span><span class="react-syntax-highlighter-line-number">5
</span><span class="react-syntax-highlighter-line-number">6
</span><span class="react-syntax-highlighter-line-number">7
</span><span class="react-syntax-highlighter-line-number">8
</span><span class="react-syntax-highlighter-line-number">9
</span><span class="react-syntax-highlighter-line-number">10
</span><span class="react-syntax-highlighter-line-number">11
</span><span class="react-syntax-highlighter-line-number">12
</span><span class="react-syntax-highlighter-line-number">13
</span><span class="react-syntax-highlighter-line-number">14
</span><span class="react-syntax-highlighter-line-number">15
</span><span class="react-syntax-highlighter-line-number">16
</span><span class="react-syntax-highlighter-line-number">17
</span><span class="react-syntax-highlighter-line-number">18
</span><span class="react-syntax-highlighter-line-number">19
</span><span class="react-syntax-highlighter-line-number">20
</span><span class="react-syntax-highlighter-line-number">21
</span><span class="react-syntax-highlighter-line-number">22
</span><span class="react-syntax-highlighter-line-number">23
</span><span class="react-syntax-highlighter-line-number">24
</span><span class="react-syntax-highlighter-line-number">25
</span></code><code class="language-matlab" style="white-space:pre">function [L, U, p] = plufact(A)
% PLUFACT   Pivoted LU factorization 
% Input:
%   A    square matrix
% Output:
%   L    unit lower triangular 
%   U    upper triangular
%   p    row permutation vector such that A(p,:) = L*U
n = size(A, 1);
L = zeros(n, n);
U = zeros(n, n);
p = zeros(1, n);
A_k = A;

% Reduction by outer products
for k = 1:n
    [~, p(k)] = max(abs(A_k(:, k)));
    U(k, :) = A_k(p(k), :);
    L(:, k) = A_k(:, k) / U(k, k);
    if k &lt; n
        A_k = A_k - L(:, k) * U(k, :);
    end
end
L = tril(L(p, :));
U = triu(U);</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-[32px]" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm bg-stone-200/10"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-text" style="white-space:pre"></code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div></div></details><h2 id="examples" class="relative group"><span class="heading-text">Examples</span><a class="no-underline text-inherit hover:text-inherit px-2 font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#examples" title="Link to this Section" aria-label="Link to this Section">¶</a></h2></div><div id="glpHPbZkX5" class="relative group/block article-grid subgrid-gap col-screen"><h3 id="section-2-1" class="relative group"><span class="heading-text">Section 2.1</span><a class="no-underline text-inherit hover:text-inherit px-2 font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#section-2-1" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><details class="rounded-md my-5 shadow dark:shadow-2xl dark:shadow-neutral-900 overflow-hidden bg-gray-50 dark:bg-stone-800"><summary class="m-0 text-lg font-medium py-1 min-h-[2em] pl-3 cursor-pointer hover:shadow-[inset_0_0_0px_30px_#00000003] dark:hover:shadow-[inset_0_0_0px_30px_#FFFFFF03] bg-gray-100 dark:bg-slate-900"><span class="text-neutral-900 dark:text-white"><span class="block float-right text-sm font-thin text-neutral-700 dark:text-neutral-200"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="inline-block pl-2 mr-2 -translate-y-[1px] details-toggle transition-transform"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></span>Linear system for polynomial interpolation</span></summary><div class="px-4 py-1 details-body"><p>We create two column vectors for data about the population of China. The first has the years of census data and the other has the population, in millions of people.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">year = [1982; 2000; 2010; 2015]; 
pop = [1008.18; 1262.64; 1337.82; 1374.62];</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="A5O3hsu1d3Uq-T5O6F4vh" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><p>It’s convenient to measure time in years since 1980.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">t = year - 1980;
y = pop;</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="JASV8ko7O6sejDubjBnl0" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><p id="index-fh9cveyfeo">Now we have four data points <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>t</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>y</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><mo stretchy="false">(</mo><msub><mi>t</mi><mn>4</mn></msub><mo separator="true">,</mo><msub><mi>y</mi><mn>4</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(t_1,y_1),\dots,(t_4,y_4)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span>, so <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mn>4</mn></mrow><annotation encoding="application/x-tex">n=4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">4</span></span></span></span></span> and we seek an interpolating cubic polynomial. We construct the associated Vandermonde matrix:</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">V = vander(t)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="ga1UySoGvnZoCarNrwSFD" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div class="myst-grid grid my-5 sm:grid-cols-1 md:grid-cols-1 lg:grid-cols-2 xl:grid-cols-2 gap-4"><p>To solve for the vector of polynomial coefficients, we use a backslash to solve the linear system:</p><div class="my-5 rounded shadow dark:shadow-neutral-800 overflow-hidden border border-gray-100 dark:border-gray-800 flex flex-col"><div class="flex-grow px-4 py-2"><p>A <strong>backslash</strong> <code>\</code> is used to solve a linear system of equations.</p></div></div></div><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">c = V \ y</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="715iPOX0AL1M_al-ynbcT" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><p>The algorithms used by the backslash operator are the main topic of this chapter. As a check on the solution, we can compute the <em>residual</em>.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">y - V * c</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="T-rGkGuutM9Z8K9Q3r_jj" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><p>Using floating-point arithmetic, it is not realistic to expect exact equality of quantities; a relative difference comparable to <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ϵ</mi><mtext>mach</mtext></msub></mrow><annotation encoding="application/x-tex">\macheps</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">ϵ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord mtight">mach</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> is all we can look for.</p><p>By our definitions, the elements of <code>c</code> are coefficients in descending-degree order for the interpolating polynomial. We can use the polynomial to estimate the population of China in 2005:</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">p = @(t) polyval(c, t - 1980);  % include the 1980 time shift
p(2005)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="SC5huZ2c6WjSxu6dgbFeC" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><p>The official population value for 2005 was 1303.72, so our result is rather good.</p><div class="myst-grid grid my-5 sm:grid-cols-1 md:grid-cols-1 lg:grid-cols-2 xl:grid-cols-2 gap-4"><p>We can visualize the interpolation process. First, we plot the data as points.</p><div class="my-5 rounded shadow dark:shadow-neutral-800 overflow-hidden border border-gray-100 dark:border-gray-800 flex flex-col"><div class="flex-grow px-4 py-2"><p>The <code>scatter</code> function creates a scatter plot of points; you can specify a line connecting the points as well.</p></div></div></div><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">scatter(year, y)
xlabel(&quot;years since 1980&quot;)
ylabel(&quot;population (millions)&quot;)
title(&quot;Population of China&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="fIYudZazf52OQ1CDdfZEU" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/fnc/build/ccbed32476f1ab2e08ce69c26e0e5ad8.png" alt="Image produced in Jupyter"/></div></div><div class="myst-grid grid my-5 sm:grid-cols-1 md:grid-cols-1 lg:grid-cols-2 xl:grid-cols-2 gap-4"><p>We want to superimpose a plot of the polynomial. We do that by evaluating it at a vector of points in the interval.</p><div class="my-5 rounded shadow dark:shadow-neutral-800 overflow-hidden border border-gray-100 dark:border-gray-800 flex flex-col"><div class="flex-grow px-4 py-2"><p>The <code>linspace</code> function constructs evenly spaced values given the endpoints and the number of values.</p></div></div></div><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">tt = linspace(1980, 2015, 500);    % 500 times in the interval [1980, 2015]
yy = p(tt);                        % evaluate p at all the vector elements
yy(1:4)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="NEDRVnXg9T--DgwanQMIx" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div class="myst-grid grid my-5 sm:grid-cols-1 md:grid-cols-1 lg:grid-cols-2 xl:grid-cols-2 gap-4"><p>Now we use <code>plot!</code> to add to the current plot, rather than replacing it.</p><div class="my-5 rounded shadow dark:shadow-neutral-800 overflow-hidden border border-gray-100 dark:border-gray-800 flex flex-col"><div class="flex-grow px-4 py-2"><p>Use <code>hold on</code> to add to an existing plot rather than replacing it.</p><p>The <code>plot</code> function plots lines connecting the given <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span></span> and <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span></span> values; you can also specify markers at the points.</p></div></div></div><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">hold on 
plot(tt, yy)
legend(&quot;data&quot;, &quot;interpolant&quot;, &quot;location&quot;, &quot;northwest&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="gM5Uktn1QFPSHcCMY0h01" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/fnc/build/1cb336d9a9119a228cf92a2089ea593c.png" alt="Image produced in Jupyter"/></div></div></div></details><h3 id="section-2-2" class="relative group"><span class="heading-text">Section 2.2</span><a class="no-underline text-inherit hover:text-inherit px-2 font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#section-2-2" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><details class="rounded-md my-5 shadow dark:shadow-2xl dark:shadow-neutral-900 overflow-hidden bg-gray-50 dark:bg-stone-800"><summary class="m-0 text-lg font-medium py-1 min-h-[2em] pl-3 cursor-pointer hover:shadow-[inset_0_0_0px_30px_#00000003] dark:hover:shadow-[inset_0_0_0px_30px_#FFFFFF03] bg-gray-100 dark:bg-slate-900"><span class="text-neutral-900 dark:text-white"><span class="block float-right text-sm font-thin text-neutral-700 dark:text-neutral-200"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="inline-block pl-2 mr-2 -translate-y-[1px] details-toggle transition-transform"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></span>Matrix operations</span></summary><div class="px-4 py-1 details-body"><div class="myst-grid grid my-5 sm:grid-cols-1 md:grid-cols-1 lg:grid-cols-2 xl:grid-cols-2 gap-4"><p>In MATLAB, every numerical value is treated like a matrix. A matrix with one row or one column is interpreted as a vector, and a <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>×</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">1\times 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></span> matrix is interpreted as a scalar.</p><p>Square brackets are used to enclose elements of a matrix or vector. Use spaces for horizontal concatenation, and semicolons or new lines to indicate vertical concatenation.</p><div class="my-5 rounded shadow dark:shadow-neutral-800 overflow-hidden border border-gray-100 dark:border-gray-800 flex flex-col"><div class="flex-grow px-4 py-2"><p>The <code>size</code> function returns the number of rows and columns in a matrix. Use <code>length</code> to get the number of elements in a vector or matrix.</p></div></div></div><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">A = [ 
    1       2      3             4      5; 
    50     40     30            20     10
    pi sqrt(2) exp(1) (1+sqrt(5))/2 log(3) 
    ]</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="ESKPCuH40A5GdUZtpcB8J" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">m, n = size(A)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="cFXSdDHTDacU3Ag5dhhKF" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>Unrecognized function or variable &#x27;m&#x27;.</span></code></pre></div></div></div><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">x = [ 3, 3, 0, 1, 0 ];   % row vector
size(x)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="-0wl5U7Sjnie9OnzWFUoz" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><p>Concatenated elements within brackets may be matrices or vectors for a block representation, as long as all the block sizes are compatible.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">[ x  x ]</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="ZGKm9F02m_n9bYzYFzj7U" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">[ x; x ]</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="ldpS8IHpym4KtQp4r2cn7" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><p id="index-seenfriut8">The <code>zeros</code> and <code>ones</code> functions construct matrices with entries all zero or one, respectively.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">B = [ zeros(3, 2) ones(3, 1) ]</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="efoan_5928swMls4gImIj" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><p id="index-sfie2x7oow">A single quote <code>&#x27;</code> after a matrix returns its adjoint. For real matrices, this is the transpose; for complex-valued matrices, the elements are also conjugated.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">A&#x27;</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="PrYyF5JP8l0Mfv7K4aD_S" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><p id="index-uhmtu1vudd">There are many convenient shorthand ways of building vectors and matrices other than entering all of their entries directly or in a loop. To get a range with evenly spaced entries between two endpoints, you have two options. One is to use a colon <code>:</code>.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">y = 1:4              % start:stop</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="oIgYQqMSKO3f-lJZW83mP" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">z = 0:3:12           % start:step:stop</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="hSiK9hANM_uO-0CjLFrf-" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><p>Instead of specifying the step size, you can give the number of points in the range if you use <code>linspace</code>.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">s = linspace(-1, 1, 5)    % row result</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="gjB8myPNmcr2yu9rxm0oS" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div class="myst-grid grid my-5 sm:grid-cols-1 md:grid-cols-1 lg:grid-cols-2 xl:grid-cols-2 gap-4"><p>Accessing an element is done by giving one (for a vector) or two (for a matrix) index values within parentheses.</p><div class="my-5 rounded shadow dark:shadow-neutral-800 overflow-hidden border border-gray-100 dark:border-gray-800 flex flex-col"><div class="flex-grow px-4 py-2"><p>The <code>end</code> keyword refers to the last element in a dimension. It saves you from having to compute and store the size of the matrix first.</p></div></div></div><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">a = A(2, end-1)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="0rDt0d2Uf6xJfat8NACa3" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">x(2)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="p08sY5KW-OT_882R-k084" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><p>The indices can be vectors or ranges, in which case a block of the matrix is accessed.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">A(1:2, end-2:end)    % first two rows, last three columns</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="hxVdiyTHbdhn0Bgalg5v0" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><p id="index-sccjkqooii">If a dimension has only the index <code>:</code> (a colon), then it refers to all the entries in that dimension of the matrix.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">A(:, 1:2:end)        % all of the odd columns</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="0UTYWJ0Ljo72GlD-CV3pH" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div class="myst-grid grid my-5 sm:grid-cols-1 md:grid-cols-1 lg:grid-cols-2 xl:grid-cols-2 gap-4"><p>The matrix and vector senses of addition, subtraction, scalar multiplication, multiplication, and power are all handled by the usual symbols.</p><div class="my-5 rounded shadow dark:shadow-neutral-800 overflow-hidden border border-gray-100 dark:border-gray-800 flex flex-col"><div class="flex-grow px-4 py-2"><p>Use <code>diag</code> to construct a matrix by its diagonals. A more general syntax puts elements on super- or subdiagonals.</p></div></div></div><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">B = diag([-1, 0, -5])   % create a diagonal matrix</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="pyISoqLNLR8aU73S-qp-s" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">size(A)
size(B)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="4KsJ9xejsqsTFdd22vrQV" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">BA = B * A     % matrix product</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="iFD4RSEm6MYE9VFUt6Af5" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div class="myst-grid grid my-5 sm:grid-cols-1 md:grid-cols-1 lg:grid-cols-2 xl:grid-cols-2 gap-4"><p><code>A * B</code> causes an error here, because the dimensions aren’t compatible.</p><div class="my-5 rounded shadow dark:shadow-neutral-800 overflow-hidden border border-gray-100 dark:border-gray-800 flex flex-col"><div class="flex-grow px-4 py-2"><p>Errors are formally called <em>exceptions</em> in Julia.</p></div></div></div><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-julia" style="white-space:pre">A * B    % throws an error</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="MmftinqIpcxgJVeDGE3ql" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>Error using *
Incorrect dimensions for matrix multiplication. Check that the number of columns in the first matrix matches the number of rows in the second matrix. To operate on each element of the matrix individually, use TIMES (.*) for elementwise multiplication.</span></code></pre></div></div></div><p>A square matrix raised to an integer power is the same as repeated matrix multiplication.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">B^3    % same as B*B*B</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="MqVJLR0oDRpm71S-5PdNe" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><p>Sometimes one instead wants to treat a matrix or vector as a mere array and simply apply a single operation to each element of it. For multiplication, division, and power, the corresponding operators start with a dot.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">C = -A;</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="6_M5Tgm4ONb3TjaYL1yj1" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><p>Because both matrices are <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>3</mn><mo>×</mo><mn>5</mn></mrow><annotation encoding="application/x-tex">3\times 5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">3</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">5</span></span></span></span></span>, <code>A * C</code> would be an error here, but elementwise operations are fine.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">elementwise = A .* C</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="LQhSvKWQC5WbZI2rpFPri" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><p id="index-xmeibenomg">The two operands of a dot operator have to have the same size—unless one is a scalar, in which case it is expanded or <em>broadcast</em> to be the same size as the other operand.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">x_to_two = x .^ 2</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="zffvLUHOBq4QfzuvMPd6B" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">two_to_x = 2 .^ x</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="5-ggr0G5aVflFQ0J5mQ-s" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div class="myst-grid grid my-5 sm:grid-cols-1 md:grid-cols-1 lg:grid-cols-2 xl:grid-cols-2 gap-4"><p>Most of the mathematical functions, such as cos, sin, log, exp, and sqrt, can operate elementwise on vectors and matrices.</p></div><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">cos(pi * x)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="Cpo2eEkg5uhXviiu974pJ" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div></div></details><h3 id="section-2-3" class="relative group"><span class="heading-text">Section 2.3</span><a class="no-underline text-inherit hover:text-inherit px-2 font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#section-2-3" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><details class="rounded-md my-5 shadow dark:shadow-2xl dark:shadow-neutral-900 overflow-hidden bg-gray-50 dark:bg-stone-800"><summary class="m-0 text-lg font-medium py-1 min-h-[2em] pl-3 cursor-pointer hover:shadow-[inset_0_0_0px_30px_#00000003] dark:hover:shadow-[inset_0_0_0px_30px_#FFFFFF03] bg-gray-100 dark:bg-slate-900"><span class="text-neutral-900 dark:text-white"><span class="block float-right text-sm font-thin text-neutral-700 dark:text-neutral-200"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="inline-block pl-2 mr-2 -translate-y-[1px] details-toggle transition-transform"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></span>Solving linear systems</span></summary><div class="px-4 py-1 details-body"><p>For a square matrix <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">A</mi></mrow><annotation encoding="application/x-tex">\mathbf{A}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6861em;"></span><span class="mord mathbf">A</span></span></span></span></span>, the syntax <code>A \ b</code> is mathematically equivalent to <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant="bold">A</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi mathvariant="bold">b</mi></mrow><annotation encoding="application/x-tex">\mathbf{A}^{-1} \mathbf{b}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathbf">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord mathbf">b</span></span></span></span></span>.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">A = [1 0 -1; 2 2 1; -1 -3 0]</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="NkWGV1sQvHs8xpdcBvrQM" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">b = [1; 2; 3]</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="9k_NM6jrWJ5SNr_dZK2MZ" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">x = A \ b</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="fGpJTWJnM1yXfv79BJH4T" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><p id="index-vhdqesr0oa">One way to check the answer is to compute a quantity known as the <strong>residual</strong>. It is (ideally) close to machine precision (relative to the elements in the data).</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">residual = b - A*x</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="60ZHtaozXW6HXZItEIRTe" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><p>If the matrix <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">A</mi></mrow><annotation encoding="application/x-tex">\mathbf{A}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6861em;"></span><span class="mord mathbf">A</span></span></span></span></span> is singular, you may get a warning and nonsense result.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-julia" style="white-space:pre">A = [0 1; 0 0]
b = [1; -1]
x = A \ b</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="DsrOAkptud3vRhL7JUYEm" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div class="myst-grid grid my-5 sm:grid-cols-1 md:grid-cols-1 lg:grid-cols-2 xl:grid-cols-2 gap-4"><p>In this case, we can check that the rank of <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">A</mi></mrow><annotation encoding="application/x-tex">\mathbf{A}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6861em;"></span><span class="mord mathbf">A</span></span></span></span></span> is less than its number of columns, indicating singularity.</p><div class="my-5 rounded shadow dark:shadow-neutral-800 overflow-hidden border border-gray-100 dark:border-gray-800 flex flex-col"><div class="flex-grow px-4 py-2"><p>The function <code>rank</code> computes the rank of a matrix. However, it is numerically unstable for matrices that are nearly singular, in a sense to be defined in a later section.</p></div></div></div><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">rank(A)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="blHLCTR9ukDdU5T-TEO7s" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><p>A linear system with a singular matrix might have no solution or infinitely many solutions, but in either case, backslash will fail. Moreover, detecting singularity is a lot like checking whether two floating-point numbers are <em>exactly</em> equal: because of roundoff, it could be missed. In <a href="/fnc/condition-number">Conditioning of linear systems</a> we’ll find a robust way to fully describe this situation.</p></div></details><details class="rounded-md my-5 shadow dark:shadow-2xl dark:shadow-neutral-900 overflow-hidden bg-gray-50 dark:bg-stone-800"><summary class="m-0 text-lg font-medium py-1 min-h-[2em] pl-3 cursor-pointer hover:shadow-[inset_0_0_0px_30px_#00000003] dark:hover:shadow-[inset_0_0_0px_30px_#FFFFFF03] bg-gray-100 dark:bg-slate-900"><span class="text-neutral-900 dark:text-white"><span class="block float-right text-sm font-thin text-neutral-700 dark:text-neutral-200"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="inline-block pl-2 mr-2 -translate-y-[1px] details-toggle transition-transform"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></span>Triangular systems of equations</span></summary><div class="px-4 py-1 details-body"><div class="myst-grid grid my-5 sm:grid-cols-1 md:grid-cols-1 lg:grid-cols-2 xl:grid-cols-2 gap-4"><p>It’s easy to get just the lower triangular part of any matrix using the <code>tril</code> function.</p><div class="my-5 rounded shadow dark:shadow-neutral-800 overflow-hidden border border-gray-100 dark:border-gray-800 flex flex-col"><div class="flex-grow px-4 py-2"><p>Use <code>tril</code> to return a matrix that zeros out everything above the main diagonal. The <code>triu</code> function zeros out below the diagonal.</p></div></div></div><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">A = randi(9, 5, 5);
L = tril(A)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="avYIUZk00IXVi0W2VprGV" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><p>We’ll set up and solve a linear system with this matrix.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">b = ones(5);
x = forwardsub(L, b)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="HOyPSxaZxHMoKAYFEtuKC" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><p id="index-bf38dthua4">It’s not clear how accurate this answer is. However, the residual should be zero or comparable to <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ϵ</mi><mtext>mach</mtext></msub></mrow><annotation encoding="application/x-tex">\macheps</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">ϵ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord mtight">mach</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span>.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">b - L * x</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="Yvofd0naly-wT5E0x-9Ho" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div class="myst-grid grid my-5 sm:grid-cols-1 md:grid-cols-1 lg:grid-cols-2 xl:grid-cols-2 gap-4"><p>Next, we’ll engineer a problem to which we know the exact answer.</p><div class="my-5 rounded shadow dark:shadow-neutral-800 overflow-hidden border border-gray-100 dark:border-gray-800 flex flex-col"><div class="flex-grow px-4 py-2"><p>The <code>eye</code> function creates an identity matrix. The <code>diag</code> function uses 0 as the main diagonal, positive integers as superdiagonals, and negative integers as subdiagonals.</p></div></div></div><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">alpha = 0.3;
beta = 2.2;
U = eye(5) + diag([-1 -1 -1 -1], 1);
U(1, [4, 5]) = [alpha - beta, beta]</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="E2AgbvY04kizINqmzFJT2" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">x_exact = ones(5);
b = [alpha; 0; 0; 0; 1];</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="mFqA5kua-MQ_FRi7ACNFn" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><p>Now we use backward substitution to solve for <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">x</mi></mrow><annotation encoding="application/x-tex">\mathbf{x}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4444em;"></span><span class="mord mathbf">x</span></span></span></span></span>, and compare to the exact solution we know already.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">x = backsub(U, b);
err = x - x_exact</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="FBo0gDawWkiolb3-PuPzq" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><p>Everything seems OK here. But another example, with a different value for <!-- -->β<!-- -->, is more troubling.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">alpha = 0.3;
beta = 1e12;
U = eye(5) + diag([-1 -1 -1 -1], 1);
U(1, [4, 5]) = [alpha - beta, beta];
b = [alpha; 0; 0; 0; 1];

x = backsub(U, b);
err = x - x_exact</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="f2uFfo_Nj42rhRIjoIuRl" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><p>It’s not so good to get 4 digits of accuracy after starting with sixteen! The source of the error is not hard to track down. Solving for <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">x_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> performs <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>α</mi><mo>−</mo><mi>β</mi><mo stretchy="false">)</mo><mo>+</mo><mi>β</mi></mrow><annotation encoding="application/x-tex">(\alpha-\beta)+\beta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span></span></span></span></span> in the first row. Since <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∣</mi><mi>α</mi><mi mathvariant="normal">∣</mi></mrow><annotation encoding="application/x-tex">|\alpha|</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mord">∣</span></span></span></span></span> is so much smaller than <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∣</mi><mi>β</mi><mi mathvariant="normal">∣</mi></mrow><annotation encoding="application/x-tex">|\beta|</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="mord">∣</span></span></span></span></span>, this a recipe for losing digits to subtractive cancellation.</p></div></details><h3 id="section-2-4" class="relative group"><span class="heading-text">Section 2.4</span><a class="no-underline text-inherit hover:text-inherit px-2 font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#section-2-4" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><details class="rounded-md my-5 shadow dark:shadow-2xl dark:shadow-neutral-900 overflow-hidden bg-gray-50 dark:bg-stone-800"><summary class="m-0 text-lg font-medium py-1 min-h-[2em] pl-3 cursor-pointer hover:shadow-[inset_0_0_0px_30px_#00000003] dark:hover:shadow-[inset_0_0_0px_30px_#FFFFFF03] bg-gray-100 dark:bg-slate-900"><span class="text-neutral-900 dark:text-white"><span class="block float-right text-sm font-thin text-neutral-700 dark:text-neutral-200"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="inline-block pl-2 mr-2 -translate-y-[1px] details-toggle transition-transform"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></span>Triangular outer products</span></summary><div class="px-4 py-1 details-body"><p id="index-whsvnicjjd">We explore the outer product formula for two random triangular matrices.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">L = tril( randi(9, 3, 3) )</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="qji9J4mFRz_BvegS0zxH1" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">U = triu( randi(9, 3, 3) )</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="FAv9KwuaizVUHsltP2gZT" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><p>Here are the three outer products in the sum in <span data-state="closed"><a class="hover-link" href="/fnc/lu#matrixouter">(<!-- -->2.4.4<!-- -->)</a></span>:</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">L(:, 1) * U(1, :)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="NeKI3fb97v0CCrv_2V939" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">L(:, 2) * U(2, :)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="u1jjesiKxTDAw0u_3cNoy" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">L(:, 3) * U(3, :)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="0t48mOC9bv9-pyI0Bgc7Y" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><p>Simply because of the triangular zero structures, only the first outer product contributes to the first row and first column of the entire product.</p></div></details><details class="rounded-md my-5 shadow dark:shadow-2xl dark:shadow-neutral-900 overflow-hidden bg-gray-50 dark:bg-stone-800"><summary class="m-0 text-lg font-medium py-1 min-h-[2em] pl-3 cursor-pointer hover:shadow-[inset_0_0_0px_30px_#00000003] dark:hover:shadow-[inset_0_0_0px_30px_#FFFFFF03] bg-gray-100 dark:bg-slate-900"><span class="text-neutral-900 dark:text-white"><span class="block float-right text-sm font-thin text-neutral-700 dark:text-neutral-200"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="inline-block pl-2 mr-2 -translate-y-[1px] details-toggle transition-transform"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></span><abbr aria-label="lower triangular times upper triangular" class="border-b border-dotted cursor-help" data-state="closed">LU</abbr> factorization</span></summary><div class="px-4 py-1 details-body"><p>For illustration, we work on a <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>4</mn><mo>×</mo><mn>4</mn></mrow><annotation encoding="application/x-tex">4 \times 4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">4</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">4</span></span></span></span></span> matrix. We name it with a subscript in preparation for what comes.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">A_1 = [
     2    0    4     3 
    -4    5   -7   -10 
     1   15    2   -4.5
    -2    0    2   -13
    ];
L = eye(4);
U = zeros(4, 4);</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="WTr2qFtennDqp2-sv7cej" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><p>Now we appeal to <span data-state="closed"><a class="hover-link" href="/fnc/lu#outer-row1">(<!-- -->2.4.5<!-- -->)</a></span>. Since <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mn>11</mn></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">L_{11}=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">11</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></span>, we see that the first row of <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">U</mi></mrow><annotation encoding="application/x-tex">\mathbf{U}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6861em;"></span><span class="mord mathbf">U</span></span></span></span></span> is just the first row of <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold">A</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">\mathbf{A}_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8361em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathbf">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span>.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">U(1, :) = A_1(1, :)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="bEvfsYIl_NOh7tiYM7VnF" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><p>From <span data-state="closed"><a class="hover-link" href="/fnc/lu#outer-col1">(<!-- -->2.4.6<!-- -->)</a></span>, we see that we can find the first column of <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">L</mi></mrow><annotation encoding="application/x-tex">\mathbf{L}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6861em;"></span><span class="mord mathbf">L</span></span></span></span></span> from the first column of <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold">A</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">\mathbf{A}_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8361em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathbf">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span>.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">L(:, 1) = A_1(:, 1) / U(1, 1)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="AWr_b4uYwDNAgclZ7coK8" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><p>We have obtained the first term in the sum <span data-state="closed"><a class="hover-link" href="/fnc/lu#matrixouter">(<!-- -->2.4.4<!-- -->)</a></span> for <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">L</mi><mi mathvariant="bold">U</mi></mrow><annotation encoding="application/x-tex">\mathbf{L}\mathbf{U}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6861em;"></span><span class="mord mathbf">LU</span></span></span></span></span>, and we subtract it away from <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold">A</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">\mathbf{A}_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8361em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathbf">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span>.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">A_2 = A_1 - L(:, 1) * U(1, :)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="eNj6gHhCPSrOV_NMZQvFN" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><p>Now <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold">A</mi><mn>2</mn></msub><mo>=</mo><msub><mi mathvariant="bold">ℓ</mi><mn>2</mn></msub><msubsup><mi mathvariant="bold">u</mi><mn>2</mn><mi>T</mi></msubsup><mo>+</mo><msub><mi mathvariant="bold">ℓ</mi><mn>3</mn></msub><msubsup><mi mathvariant="bold">u</mi><mn>3</mn><mi>T</mi></msubsup><mo>+</mo><msub><mi mathvariant="bold">ℓ</mi><mn>4</mn></msub><msubsup><mi mathvariant="bold">u</mi><mn>4</mn><mi>T</mi></msubsup><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">\mathbf{A}_2 = \boldsymbol{\ell}_2\mathbf{u}_2^T + \boldsymbol{\ell}_3\mathbf{u}_3^T + \boldsymbol{\ell}_4\mathbf{u}_4^T.</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8361em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathbf">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0894em;vertical-align:-0.2481em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbf">ℓ</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathbf">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.4519em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0894em;vertical-align:-0.2481em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbf">ℓ</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathbf">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.4519em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0894em;vertical-align:-0.2481em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbf">ℓ</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathbf">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.4519em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mord">.</span></span></span></span></span> If we ignore the first row and first column of the matrices in this equation, then in what remains we are in the same situation as at the start. Specifically, only <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold">ℓ</mi><mn>2</mn></msub><msubsup><mi mathvariant="bold">u</mi><mn>2</mn><mi>T</mi></msubsup></mrow><annotation encoding="application/x-tex">\boldsymbol{\ell}_2\mathbf{u}_2^T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0894em;vertical-align:-0.2481em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbf">ℓ</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathbf">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.4519em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span></span></span></span></span> has any effect on the second row and column, so we can deduce them now.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">U(2, :) = A_2(2, :)
L(:, 2) = A_2(:, 2) / U(2, 2)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="tS5HMBW12vpvL1YAmV8y6" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><p>If we subtract off the latest outer product, we have a matrix that is zero in the first <em>two</em> rows and columns.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">A_3 = A_2 - L(:, 2) * U(2, :)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="6Rb1kl8kvt0xyHCo-7ow0" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><p>Now we can deal with the lower right <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mo>×</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">2\times 2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span></span></span></span></span> submatrix of the remainder in a similar fashion.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">U(3, :) = A_3(3, :);
L(:, 3) = A_3(:, 3) / U(3, 3);
A_4 = A_3 - L(:, 3) * U(3, :)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="Ju6QMq_N32BM4J4UiYJZX" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><p>Finally, we pick up the last unknown in the factors.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">U(4, 4) = A_4(4, 4);</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="vENiisD6ragooF1Fo5iiu" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><p>We now have all of <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">L</mi></mrow><annotation encoding="application/x-tex">\mathbf{L}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6861em;"></span><span class="mord mathbf">L</span></span></span></span></span>,</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">L</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="BMu46SjMbfC_oOOBlG7Jh" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><p>and all of <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">U</mi></mrow><annotation encoding="application/x-tex">\mathbf{U}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6861em;"></span><span class="mord mathbf">U</span></span></span></span></span>,</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">U</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="Xls8mknISIqusFuTKLy0L" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><p>We can verify that we have a correct factorization of the original matrix by computing the backward error:</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">A_1 - L * U</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="klO6XJSw4SaOdCyVpFHVa" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><p>In floating point, we cannot expect the difference to be exactly zero as we found in this toy example. Instead, we would be satisfied to see that each element of the difference above is comparable in size to machine precision.</p></div></details><details class="rounded-md my-5 shadow dark:shadow-2xl dark:shadow-neutral-900 overflow-hidden bg-gray-50 dark:bg-stone-800"><summary class="m-0 text-lg font-medium py-1 min-h-[2em] pl-3 cursor-pointer hover:shadow-[inset_0_0_0px_30px_#00000003] dark:hover:shadow-[inset_0_0_0px_30px_#FFFFFF03] bg-gray-100 dark:bg-slate-900"><span class="text-neutral-900 dark:text-white"><span class="block float-right text-sm font-thin text-neutral-700 dark:text-neutral-200"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="inline-block pl-2 mr-2 -translate-y-[1px] details-toggle transition-transform"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></span>Solving a linear system by <abbr aria-label="lower triangular times upper triangular" class="border-b border-dotted cursor-help" data-state="closed">LU</abbr> factors</span></summary><div class="px-4 py-1 details-body"><p>Here are the data for a linear system <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">A</mi><mi mathvariant="bold">x</mi><mo>=</mo><mi mathvariant="bold">b</mi></mrow><annotation encoding="application/x-tex">\mathbf{A}\mathbf{x}=\mathbf{b}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6861em;"></span><span class="mord mathbf">Ax</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathbf">b</span></span></span></span></span>.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">A = [2 0 4 3; -4 5 -7 -10; 1 15 2 -4.5; -2 0 2 -13];
b = [4; 9; 9; 4];</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="9YUu6wQmc1FI1K64hieom" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><p>We apply <span data-state="closed"><a class="hover-link" href="/fnc/lu#function-lufact">Function <!-- -->2.4.1</a></span> and then do two triangular solves.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">[L, U] = lufact(A)
z = forwardsub(L, b);
x = backsub(U, z);</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="_nJhG7IeSnaUGk8rYJl3R" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><p>A check on the residual assures us that we found the solution.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">b - A * x</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="oKBb3nluftmCWvmBsIM8Q" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div></div></details><h3 id="section-2-5" class="relative group"><span class="heading-text">Section 2.5</span><a class="no-underline text-inherit hover:text-inherit px-2 font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#section-2-5" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><details class="rounded-md my-5 shadow dark:shadow-2xl dark:shadow-neutral-900 overflow-hidden bg-gray-50 dark:bg-stone-800"><summary class="m-0 text-lg font-medium py-1 min-h-[2em] pl-3 cursor-pointer hover:shadow-[inset_0_0_0px_30px_#00000003] dark:hover:shadow-[inset_0_0_0px_30px_#FFFFFF03] bg-gray-100 dark:bg-slate-900"><span class="text-neutral-900 dark:text-white"><span class="block float-right text-sm font-thin text-neutral-700 dark:text-neutral-200"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="inline-block pl-2 mr-2 -translate-y-[1px] details-toggle transition-transform"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></span>Floating-point operations in matrix-vector multiplication</span></summary><div class="px-4 py-1 details-body"><p>Here is a straightforward implementation of matrix-vector multiplication.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">n = 6;
A = magic(n);
x = ones(n,1);
y = zeros(n,1);
for i = 1:n
    for j = 1:n
        y(i) = y(i) + A(i,j)*x(j);   % 2 flops
    end
end</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="QZeDaI_I397QlX48MQngt" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><p>Each of the loops implies a summation of flops. The total flop count for this algorithm is</p><div id="FHf1A3hK6i" class="flex my-5 group"><div class="flex-grow overflow-x-auto overflow-y-hidden"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mn>2</mn><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mn>2</mn><mi>n</mi><mo>=</mo><mn>2</mn><msup><mi>n</mi><mn>2</mn></msup><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">\sum_{i=1}^n \sum_{j=1}^n 2 = \sum_{i=1}^n 2n = 2n^2.</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.0652em;vertical-align:-1.4138em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4138em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.9291em;vertical-align:-1.2777em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">2</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8641em;"></span><span class="mord">2</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord">.</span></span></span></span></span></div><div class="relative self-center flex-none pl-2 m-0 text-right select-none"><a class="no-underline text-inherit hover:text-inherit text-inherit hover:text-inherit select-none hover:underline" href="#FHf1A3hK6i" title="Link to this Equation" aria-label="Link to this Equation">(<!-- -->1<!-- -->)</a></div></div><p>Since the matrix <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">A</mi></mrow><annotation encoding="application/x-tex">\mathbf{A}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6861em;"></span><span class="mord mathbf">A</span></span></span></span></span> has <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>n</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">n^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span> elements, all of which have to be involved in the product, it seems unlikely that we could get a flop count that is smaller than <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span> in general.</p><p id="index-kzripea8dl">Let’s run an experiment with the built-in matrix-vector multiplication, using <code>tic</code> and <code>toc</code> to time the operation.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">n_ = (400:400:4000)&#x27;;
t_ = zeros(size(n_));
for i = 1:length(n_)
    n = n_(i);
    A = randn(n, n);  x = randn(n, 1);
    tic    % start a timer
    for j = 1:100      % repeat 100 times
        A*x;
    end
    t = toc;           % read the timer
    t_(i) = t / 100;   % seconds per instance
end</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="n61YS3nGDx6PLIBzNir5F" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><p>The reason for doing multiple repetitions at each value of <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></span> in the loop above is to avoid having times so short that the resolution of the timer is significant.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">table(n_, t_, &#x27;variablenames&#x27;, {&#x27;size&#x27;, &#x27;time&#x27;})</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="1yZb5Hi_nS5FzAOMXjsJc" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div class="myst-grid grid my-5 sm:grid-cols-1 md:grid-cols-1 lg:grid-cols-2 xl:grid-cols-2 gap-4"><p>Looking at the timings just for <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mn>2000</mn></mrow><annotation encoding="application/x-tex">n=2000</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2000</span></span></span></span></span> and <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mn>4000</mn></mrow><annotation encoding="application/x-tex">n=4000</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">4000</span></span></span></span></span>, they have ratio</p><div class="my-5 rounded shadow dark:shadow-neutral-800 overflow-hidden border border-gray-100 dark:border-gray-800 flex flex-col"><div class="flex-grow px-4 py-2"><p>The expression <code>n_==4000</code> here produces a vector of Boolean (true/false) values the same size as <code>n_</code>. This result is used to index within <code>t_</code>, accessing only the value for which the comparison is true.</p></div></div></div><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">t_(n_==4000) / t_(n_==2000)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="Oo4Syqv1hVxfVL3POJk0n" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><p>If the run time is dominated by flops, then we expect this ratio to be</p><div id="yHI7WJKp9r" class="flex my-5 group"><div class="flex-grow overflow-x-auto overflow-y-hidden"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mfrac><mrow><mn>2</mn><mo stretchy="false">(</mo><mn>4000</mn><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow><mrow><mn>2</mn><mo stretchy="false">(</mo><mn>2000</mn><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow></mfrac><mo>=</mo><mn>4.</mn></mrow><annotation encoding="application/x-tex">\frac{2(4000)^2}{2(2000)^2}=4.</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.4271em;vertical-align:-0.936em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4911em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span><span class="mopen">(</span><span class="mord">2000</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7401em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span><span class="mopen">(</span><span class="mord">4000</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">4.</span></span></span></span></span></div><div class="relative self-center flex-none pl-2 m-0 text-right select-none"><a class="no-underline text-inherit hover:text-inherit text-inherit hover:text-inherit select-none hover:underline" href="#yHI7WJKp9r" title="Link to this Equation" aria-label="Link to this Equation">(<!-- -->2<!-- -->)</a></div></div></div></details><details class="rounded-md my-5 shadow dark:shadow-2xl dark:shadow-neutral-900 overflow-hidden bg-gray-50 dark:bg-stone-800"><summary class="m-0 text-lg font-medium py-1 min-h-[2em] pl-3 cursor-pointer hover:shadow-[inset_0_0_0px_30px_#00000003] dark:hover:shadow-[inset_0_0_0px_30px_#FFFFFF03] bg-gray-100 dark:bg-slate-900"><span class="text-neutral-900 dark:text-white"><span class="block float-right text-sm font-thin text-neutral-700 dark:text-neutral-200"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="inline-block pl-2 mr-2 -translate-y-[1px] details-toggle transition-transform"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></span>Asymptotics in log-log plots</span></summary><div class="px-4 py-1 details-body"><p>Let’s repeat the previous experiment for more, and larger, values of <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></span>.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">n_ = (400:400:6000)&#x27;;
t_ = zeros(size(n_));
for i = 1:length(n_)
    n = n_(i);
    A = randn(n, n);  x = randn(n, 1);
    tic    % start a timer
    for j = 1:100      % repeat ten times
        A*x;
    end
    t = toc;          % read the timer
    t_(i) = t / 100;   % seconds per instance
end</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="WYDFj6GuyM13amNyCzc24" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><p>Plotting the time as a function of <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></span> on log-log scales is equivalent to plotting the logs of the variables.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">clf    % clear any existing figure
loglog(n_, t_, &#x27;.-&#x27;)
xlabel(&#x27;size of matrix&#x27;)
ylabel(&#x27;time (sec)&#x27;)
title(&#x27;Timing of matrix-vector multiplications&#x27;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="G0FrDjrZ9N-TDcOEN7t5o" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/fnc/build/e011defcb3ed35de04e565e71d2bb816.png" alt="Image produced in Jupyter"/></div></div><p>You can see that while the full story is complicated, the graph is trending to a straight line of positive slope. For comparison, we can plot a line that represents <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span> growth exactly. (All such lines have slope equal to 2.)</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">hold on
loglog(n_, t_(1) * (n_ / n_(1)).^2, &#x27;--&#x27;)
axis tight
legend(&#x27;data&#x27;, &#x27;O(n^2)&#x27;, &#x27;location&#x27;, &#x27;southeast&#x27;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="ZIQyAO5BPmYJ9oJEeeL9T" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/fnc/build/6a200c11bab8c5e26e874d714951bd64.png" alt="Image produced in Jupyter"/></div></div></div></details><details class="rounded-md my-5 shadow dark:shadow-2xl dark:shadow-neutral-900 overflow-hidden bg-gray-50 dark:bg-stone-800"><summary class="m-0 text-lg font-medium py-1 min-h-[2em] pl-3 cursor-pointer hover:shadow-[inset_0_0_0px_30px_#00000003] dark:hover:shadow-[inset_0_0_0px_30px_#FFFFFF03] bg-gray-100 dark:bg-slate-900"><span class="text-neutral-900 dark:text-white"><span class="block float-right text-sm font-thin text-neutral-700 dark:text-neutral-200"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="inline-block pl-2 mr-2 -translate-y-[1px] details-toggle transition-transform"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></span>Floating-point operations in <abbr aria-label="lower triangular times upper triangular" class="border-b border-dotted cursor-help" data-state="closed">LU</abbr> factorization</span></summary><div class="px-4 py-1 details-body"><div class="myst-grid grid my-5 sm:grid-cols-1 md:grid-cols-1 lg:grid-cols-2 xl:grid-cols-2 gap-4"><p>We’ll test the conclusion of <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>3</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n^3)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span> flops experimentally, using the built-in <code>lu</code> function instead of the purely instructive <code>lufact</code>.</p><div class="my-5 rounded shadow dark:shadow-neutral-800 overflow-hidden border border-gray-100 dark:border-gray-800 flex flex-col"><div class="flex-grow px-4 py-2"><p>The first time a function is invoked, there may be significant time needed to compile it in memory. Thus, when timing a function, run it at least once before beginning the timing.</p></div></div></div><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">n_ = (200:100:2400)&#x27;;
t_ = zeros(size(n_));
for i = 1:length(n_)
    n = n_(i);
    A = randn(n, n);  
    tic    % start a timer
    for j = 1:6,  [L, U] = lu(A);  end
    t = toc;
    t_(i) = t / 6;  
end</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="OeGbvy0199uAneH_-yN_P" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><p>We plot the timings on a log-log graph and compare it to <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>3</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n^3)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span>. The result could vary significantly from machine to machine, but in theory the data should start to parallel the line as <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>→</mo><mi mathvariant="normal">∞</mi></mrow><annotation encoding="application/x-tex">n\to\infty</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord">∞</span></span></span></span></span>.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">clf
loglog(n_,t_,&#x27;.-&#x27;)
hold on, loglog(n_,t_(end)*(n_/n_(end)).^3,&#x27;--&#x27;)
axis tight
xlabel(&#x27;size of matrix&#x27;), ylabel(&#x27;time (sec)&#x27;)
title(&#x27;Timing of LU factorization&#x27;)
legend(&#x27;lu&#x27;,&#x27;O(n^3)&#x27;,&#x27;location&#x27;,&#x27;southeast&#x27;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="q7RjcWyy7C7NIuD2uYB0Y" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/fnc/build/00837df4f01ea4da92a224d0af7b4c11.png" alt="Image produced in Jupyter"/></div></div></div></details><h3 id="section-2-6" class="relative group"><span class="heading-text">Section 2.6</span><a class="no-underline text-inherit hover:text-inherit px-2 font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#section-2-6" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><details class="rounded-md my-5 shadow dark:shadow-2xl dark:shadow-neutral-900 overflow-hidden bg-gray-50 dark:bg-stone-800"><summary class="m-0 text-lg font-medium py-1 min-h-[2em] pl-3 cursor-pointer hover:shadow-[inset_0_0_0px_30px_#00000003] dark:hover:shadow-[inset_0_0_0px_30px_#FFFFFF03] bg-gray-100 dark:bg-slate-900"><span class="text-neutral-900 dark:text-white"><span class="block float-right text-sm font-thin text-neutral-700 dark:text-neutral-200"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="inline-block pl-2 mr-2 -translate-y-[1px] details-toggle transition-transform"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></span>Failure of naive <abbr aria-label="lower triangular times upper triangular" class="border-b border-dotted cursor-help" data-state="closed">LU</abbr> factorization</span></summary><div class="px-4 py-1 details-body"><p>Here is a previously encountered matrix that factors well.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">A = [
    2 0 4 3
    -4 5 -7 -10
    1 15 2 -4.5
    -2 0 2 -13
    ];
[L, U] = lufact(A);
L</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="Ji-41m5HdZAkBnZUZsDPl" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><p>If we swap the second and fourth rows of <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">A</mi></mrow><annotation encoding="application/x-tex">\mathbf{A}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6861em;"></span><span class="mord mathbf">A</span></span></span></span></span>, the result is still nonsingular. However, the factorization now fails.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">A([2, 4], :) = A([4, 2], :);    % swap rows 2 and 4
[L, U] = lufact(A);
L</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="lIoAc7tM6jN9XKrlYE03E" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><p id="index-oswijsbwee">The presence of <code>NaN</code> in the result indicates that some impossible operation was required. The source of the problem is easy to locate. We can find the first outer product in the factorization just fine:</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">U(1, :) = A(1, :);
L(:, 1) = A(:, 1) / U(1, 1)
A = A - L(:, 1) * U(1, :)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="JKMlhoGegopDTT8AYj3EA" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><p>The next step is <code>U(2, :) = A(2, :)</code>, which is also OK. But then we are supposed to divide by <code>U(2, 2)</code>, which is zero. The algorithm cannot continue.</p></div></details><details class="rounded-md my-5 shadow dark:shadow-2xl dark:shadow-neutral-900 overflow-hidden bg-gray-50 dark:bg-stone-800"><summary class="m-0 text-lg font-medium py-1 min-h-[2em] pl-3 cursor-pointer hover:shadow-[inset_0_0_0px_30px_#00000003] dark:hover:shadow-[inset_0_0_0px_30px_#FFFFFF03] bg-gray-100 dark:bg-slate-900"><span class="text-neutral-900 dark:text-white"><span class="block float-right text-sm font-thin text-neutral-700 dark:text-neutral-200"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="inline-block pl-2 mr-2 -translate-y-[1px] details-toggle transition-transform"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></span>Row pivoting in <abbr aria-label="lower triangular times upper triangular" class="border-b border-dotted cursor-help" data-state="closed">LU</abbr> factorization</span></summary><div class="px-4 py-1 details-body"><p>Here is the trouble-making matrix from <span data-state="closed"><a class="hover-link" href="/fnc/pivoting#demo-pivoting-fail">Demo <!-- -->2.6.1</a></span>.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">A_1 = [2 0 4 3; -2 0 2 -13; 1 15 2 -4.5; -4 5 -7 -10]</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="2E3Y7zJ10_6xPsz2lRs6e" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div class="myst-grid grid my-5 sm:grid-cols-1 md:grid-cols-1 lg:grid-cols-2 xl:grid-cols-2 gap-4"><p>We now find the largest candidate pivot in the first column. We don’t care about sign, so we take absolute values before finding the max.</p><div class="my-5 rounded shadow dark:shadow-neutral-800 overflow-hidden border border-gray-100 dark:border-gray-800 flex flex-col"><div class="flex-grow px-4 py-2"><p>The second output of <code>max</code> returns the location of the largest element of a vector. The <code>~</code> symbol is used to ignore the value of the first output.</p></div></div></div><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">[~, i] = max( abs(A_1(:, 1)) )</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="9eEvnHe2FAgEqrhci5rJM" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><p>This is the row of the matrix that we extract to put into <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">U</mi></mrow><annotation encoding="application/x-tex">\mathbf{U}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6861em;"></span><span class="mord mathbf">U</span></span></span></span></span>. That guarantees that the division used to find <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold">ℓ</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">\boldsymbol{\ell}_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbf">ℓ</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> will be valid.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">L = zeros(4, 4);
U = zeros(4, 4);
U(1, :) = A_1(i, :);
L(:, 1) = A_1(:, 1) / U(1, 1);
A_2 = A_1 - L(:, 1) * U(1, :)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="DHUagyPxrpa2uVEubsVvp" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><p>Observe that <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold">A</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">\mathbf{A}_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8361em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathbf">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> has a new zero row and zero column, but the zero row is the fourth rather than the first. However, we forge on by using the largest possible pivot in column 2 for the next outer product.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">[~, i] = max( abs(A_2(:, 2)) )
U(2, :) = A_2(i, :);
L(:, 2) = A_2(:, 2) / U(2, 2);
A_3 = A_2 - L(:, 2) * U(2, :)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="Mj6Cb1mXkUfMHAsdtGCtl" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><p>Now we have zeroed out the third row as well as the second column. We can finish out the procedure.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">[~, i] = max( abs(A_3(:, 3)) ) 
U(3, :) = A_3(i, :);
L(:, 3) = A_3(:, 3) / U(3, 3);
A_4 = A_3 - L(:, 3) * U(3, :)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="poKXu_CwZ3slABaiB9gk6" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">[~, i] = max( abs(A_4(:, 4)) ) 
U(4, :) = A_4(i, :);
L(:, 4) = A_4(:, 4) / U(4, 4);</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="5KfHz7etHxmF1VUTjlsB4" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><p>We do have a factorization of the original matrix:</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">A_1 - L * U</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="9e6tw2dlvVMFCCnTWoq5v" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><p>And <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">U</mi></mrow><annotation encoding="application/x-tex">\mathbf{U}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6861em;"></span><span class="mord mathbf">U</span></span></span></span></span> has the required structure:</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">U</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="_VvS6_tsP-hHwA0knF_XA" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><p>However, the triangularity of <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">L</mi></mrow><annotation encoding="application/x-tex">\mathbf{L}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6861em;"></span><span class="mord mathbf">L</span></span></span></span></span> has been broken.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">L</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="8QbmSN5mFl0P-ZRi0B7yN" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div></div></details><details class="rounded-md my-5 shadow dark:shadow-2xl dark:shadow-neutral-900 overflow-hidden bg-gray-50 dark:bg-stone-800"><summary class="m-0 text-lg font-medium py-1 min-h-[2em] pl-3 cursor-pointer hover:shadow-[inset_0_0_0px_30px_#00000003] dark:hover:shadow-[inset_0_0_0px_30px_#FFFFFF03] bg-gray-100 dark:bg-slate-900"><span class="text-neutral-900 dark:text-white"><span class="block float-right text-sm font-thin text-neutral-700 dark:text-neutral-200"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="inline-block pl-2 mr-2 -translate-y-[1px] details-toggle transition-transform"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></span>Row permutation in <abbr aria-label="lower triangular times upper triangular" class="border-b border-dotted cursor-help" data-state="closed">LU</abbr> factorization</span></summary><div class="px-4 py-1 details-body"><p>Here again is the matrix from <span data-state="closed"><a class="hover-link" href="/fnc/pivoting#demo-pivoting-fix">Demo <!-- -->2.6.2</a></span>.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">A = [2 0 4 3; -2 0 2 -13; 1 15 2 -4.5; -4 5 -7 -10]</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="KpwqNnWbZftccaqm78U9o" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><p>As the factorization proceeded, the pivots were selected from rows 4, 3, 2, and finally 1. If we were to put the rows of <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">A</mi></mrow><annotation encoding="application/x-tex">\mathbf{A}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6861em;"></span><span class="mord mathbf">A</span></span></span></span></span> into that order, then the algorithm would run exactly like the plain <abbr aria-label="lower triangular times upper triangular" class="border-b border-dotted cursor-help" data-state="closed">LU</abbr> factorization from <a href="/fnc/lu">LU factorization</a>.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">B = A([4, 3, 2, 1], :);
[L, U] = lufact(B);</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="s6QoaIWKKftKQr-ZNb33O" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><p>We obtain the same <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">U</mi></mrow><annotation encoding="application/x-tex">\mathbf{U}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6861em;"></span><span class="mord mathbf">U</span></span></span></span></span> as before:</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">U</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="4gDwsXrneKMqZNpAbdExg" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><p>And <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">L</mi></mrow><annotation encoding="application/x-tex">\mathbf{L}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6861em;"></span><span class="mord mathbf">L</span></span></span></span></span> has the same rows as before, but arranged into triangular order:</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">L</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="cnrqPTb8Ap3Ea1mYllfQT" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div></div></details><details class="rounded-md my-5 shadow dark:shadow-2xl dark:shadow-neutral-900 overflow-hidden bg-gray-50 dark:bg-stone-800"><summary class="m-0 text-lg font-medium py-1 min-h-[2em] pl-3 cursor-pointer hover:shadow-[inset_0_0_0px_30px_#00000003] dark:hover:shadow-[inset_0_0_0px_30px_#FFFFFF03] bg-gray-100 dark:bg-slate-900"><span class="text-neutral-900 dark:text-white"><span class="block float-right text-sm font-thin text-neutral-700 dark:text-neutral-200"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="inline-block pl-2 mr-2 -translate-y-[1px] details-toggle transition-transform"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></span>P<abbr aria-label="lower triangular times upper triangular" class="border-b border-dotted cursor-help" data-state="closed">LU</abbr> factorization for solving linear systems</span></summary><div class="px-4 py-1 details-body"><p>The third output of <code>plufact</code> is the permutation vector we need to apply to <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">A</mi></mrow><annotation encoding="application/x-tex">\mathbf{A}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6861em;"></span><span class="mord mathbf">A</span></span></span></span></span>.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">A = randi(20, 4, 4);
[L, U, p] = plufact(A);
A(p, :) - L * U    % should be ≈ 0</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="5BCgIzKcfA5cKkV3x4OMd" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><p>Given a vector <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">b</mi></mrow><annotation encoding="application/x-tex">\mathbf{b}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathbf">b</span></span></span></span></span>, we solve <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">A</mi><mi mathvariant="bold">x</mi><mo>=</mo><mi mathvariant="bold">b</mi></mrow><annotation encoding="application/x-tex">\mathbf{A}\mathbf{x}=\mathbf{b}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6861em;"></span><span class="mord mathbf">Ax</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathbf">b</span></span></span></span></span> by first permuting the entries of <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">b</mi></mrow><annotation encoding="application/x-tex">\mathbf{b}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathbf">b</span></span></span></span></span> and then proceeding as before.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">b = rand(4, 1);
z = forwardsub(L, b(p));
x = backsub(U, z)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="3i8iVtW05KOVVXL21Y8n3" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><p>A residual check is successful:</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">b - A*x</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="O3DK9gcfpw0nS5QpWK2uz" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div></div></details><details class="rounded-md my-5 shadow dark:shadow-2xl dark:shadow-neutral-900 overflow-hidden bg-gray-50 dark:bg-stone-800"><summary class="m-0 text-lg font-medium py-1 min-h-[2em] pl-3 cursor-pointer hover:shadow-[inset_0_0_0px_30px_#00000003] dark:hover:shadow-[inset_0_0_0px_30px_#FFFFFF03] bg-gray-100 dark:bg-slate-900"><span class="text-neutral-900 dark:text-white"><span class="block float-right text-sm font-thin text-neutral-700 dark:text-neutral-200"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="inline-block pl-2 mr-2 -translate-y-[1px] details-toggle transition-transform"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></span>Built-in P<abbr aria-label="lower triangular times upper triangular" class="border-b border-dotted cursor-help" data-state="closed">LU</abbr> factorization</span></summary><div class="px-4 py-1 details-body"><p>With the syntax <code>A \ b</code>, the matrix <code>A</code> is P<abbr aria-label="lower triangular times upper triangular" class="border-b border-dotted cursor-help" data-state="closed">LU</abbr>-factored, followed by two triangular solves.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">A = randn(500, 500);    % 500x500 with normal random entries
tic; for k=1:50; A \ rand(500, 1); end; toc</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="2m3C9lodNeC_QjKjNHL4J" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>Elapsed time is 0.526734 seconds.
</span></code></pre></div></div></div><p>In <a href="/fnc/efficiency">Efficiency of matrix computations</a> we showed that the factorization is by far the most costly part of the solution process. A factorization object allows us to do that costly step only once per unique matrix.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">[L, U, p] = lu(A, &#x27;vector&#x27;);    % keep factorization result
tic
for k=1:50
    b = rand(500, 1);
    U \ (L \ b(p));
end
toc</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="7SumElGnHeagEf4-6wM_r" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>Elapsed time is 0.009369 seconds.
</span></code></pre></div></div></div></div></details><details class="rounded-md my-5 shadow dark:shadow-2xl dark:shadow-neutral-900 overflow-hidden bg-gray-50 dark:bg-stone-800"><summary class="m-0 text-lg font-medium py-1 min-h-[2em] pl-3 cursor-pointer hover:shadow-[inset_0_0_0px_30px_#00000003] dark:hover:shadow-[inset_0_0_0px_30px_#FFFFFF03] bg-gray-100 dark:bg-slate-900"><span class="text-neutral-900 dark:text-white"><span class="block float-right text-sm font-thin text-neutral-700 dark:text-neutral-200"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="inline-block pl-2 mr-2 -translate-y-[1px] details-toggle transition-transform"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></span>Stability of P<abbr aria-label="lower triangular times upper triangular" class="border-b border-dotted cursor-help" data-state="closed">LU</abbr> factorization</span></summary><div class="px-4 py-1 details-body"><p>We construct a linear system for this matrix with <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϵ</mi><mo>=</mo><mn>1</mn><msup><mn>0</mn><mrow><mo>−</mo><mn>12</mn></mrow></msup></mrow><annotation encoding="application/x-tex">\epsilon=10^{-12}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">ϵ</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">12</span></span></span></span></span></span></span></span></span></span></span></span></span> and exact solution <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>1</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[1, 1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span></span>:</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">ep = 1e-12
A = [-ep 1; 1 -1];
b = A * [1; 1];</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="Bf0IRE4fuFwzqRcOtqX2x" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><p>We can factor the matrix without pivoting and solve for <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">x</mi></mrow><annotation encoding="application/x-tex">\mathbf{x}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4444em;"></span><span class="mord mathbf">x</span></span></span></span></span>.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">[L, U] = lufact(A);
x = backsub( U, forwardsub(L, b) )</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="bgXZDvP-5S36HB3zOYDaR" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><p>Note that we have obtained only about 5 accurate digits for <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">x_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span>. We could make the result even more inaccurate by making <!-- -->ε<!-- --> even smaller:</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">ep = 1e-20; A = [-ep 1; 1 -1];
b = A * [1; 1];
[L, U] = lufact(A);
x = backsub( U, forwardsub(L, b) )</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="BEQgAjQgDVKoezuuAbyB7" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><p>This effect is not due to ill conditioning of the problem—a solution with P<abbr aria-label="lower triangular times upper triangular" class="border-b border-dotted cursor-help" data-state="closed">LU</abbr> factorization works perfectly:</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">A \ b</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="kIEjb47hrxK_5jQiz60J5" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div></div></details><h3 id="section-2-7" class="relative group"><span class="heading-text">Section 2.7</span><a class="no-underline text-inherit hover:text-inherit px-2 font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#section-2-7" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><details class="rounded-md my-5 shadow dark:shadow-2xl dark:shadow-neutral-900 overflow-hidden bg-gray-50 dark:bg-stone-800"><summary class="m-0 text-lg font-medium py-1 min-h-[2em] pl-3 cursor-pointer hover:shadow-[inset_0_0_0px_30px_#00000003] dark:hover:shadow-[inset_0_0_0px_30px_#FFFFFF03] bg-gray-100 dark:bg-slate-900"><span class="text-neutral-900 dark:text-white"><span class="block float-right text-sm font-thin text-neutral-700 dark:text-neutral-200"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="inline-block pl-2 mr-2 -translate-y-[1px] details-toggle transition-transform"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></span>Vector norms</span></summary><div class="px-4 py-1 details-body"><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">x = [2; -3; 1; -1];
twonorm = norm(x)    % or norm(x, 2)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="1vC4fSSFrWcoO8q6SKM0t" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">infnorm = norm(x, Inf)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="xmoXRdZ8GxOO1_W0H9bc_" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">onenorm = norm(x, 1)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="qRjrFnXewukNrL2RhzwWJ" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div></div></details><details class="rounded-md my-5 shadow dark:shadow-2xl dark:shadow-neutral-900 overflow-hidden bg-gray-50 dark:bg-stone-800"><summary class="m-0 text-lg font-medium py-1 min-h-[2em] pl-3 cursor-pointer hover:shadow-[inset_0_0_0px_30px_#00000003] dark:hover:shadow-[inset_0_0_0px_30px_#FFFFFF03] bg-gray-100 dark:bg-slate-900"><span class="text-neutral-900 dark:text-white"><span class="block float-right text-sm font-thin text-neutral-700 dark:text-neutral-200"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="inline-block pl-2 mr-2 -translate-y-[1px] details-toggle transition-transform"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></span>Matrix norms</span></summary><div class="px-4 py-1 details-body"><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">A = [ 2 0; 1 -1 ]</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="rRUnEbHOq5OH6xrs_QfhS" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><p id="index-cvasa6mzpf">The default matrix norm is the 2-norm.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">twonorm = norm(A)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="aSGufsX6Ud1huhM1yxr71" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><p>You can get the 1-norm as well.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">onenorm = norm(A, 1)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="HKKRuf64UhBu1Xm_WNnFp" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div class="myst-grid grid my-5 sm:grid-cols-1 md:grid-cols-1 lg:grid-cols-2 xl:grid-cols-2 gap-4"><p>According to <span data-state="closed"><a class="hover-link" href="/fnc/norms#mxonenorm">(<!-- -->2.7.15<!-- -->)</a></span>, the matrix 1-norm is equivalent to the maximum of the sums down the columns (in absolute value).</p><div class="my-5 rounded shadow dark:shadow-neutral-800 overflow-hidden border border-gray-100 dark:border-gray-800 flex flex-col"><div class="flex-grow px-4 py-2"><p>Use <code>sum</code> to sum along a dimension of a matrix. The <code>max</code> and <code>min</code> functions also work along one dimension.</p></div></div></div><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">% Sum down the rows (1st matrix dimension):
max( sum(abs(A), 1) )</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="JpnrOpxA_Y3LS1gR4RsIK" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><p>Similarly, we can get the <!-- -->∞<!-- -->-norm and check our formula for it.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">infnorm = norm(A, Inf)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="M9CUO8UiSb62AXKE8fq_4" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">% Sum across columns (2nd matrix dimension):
max( sum(abs(A), 2) )</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="DcW7R546q5PXrk6UVQm4V" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div class="myst-grid grid my-5 sm:grid-cols-1 md:grid-cols-1 lg:grid-cols-2 xl:grid-cols-2 gap-4"><p>Next we illustrate a geometric interpretation of the 2-norm. First, we will sample a lot of vectors on the unit circle in <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant="double-struck">R</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">\mathbb{R}^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span>.</p><div class="my-5 rounded shadow dark:shadow-neutral-800 overflow-hidden border border-gray-100 dark:border-gray-800 flex flex-col"><div class="flex-grow px-4 py-2"><p>You can use functions as values, e.g., as elements of a vector.</p></div></div></div><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">theta = linspace(0, 2*pi, 601);
x = [ cos(theta); sin(theta) ];    % 601 unit column vectors
clf
subplot(1, 2, 1)
plot(x(1, :), x(2, :)), axis equal
title(&#x27;Unit circle in 2-norm&#x27;)
xlabel(&#x27;x_1&#x27;)
ylabel(&#x27;x_2&#x27;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="738UTgnHVvhhPDPEtHFPa" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/fnc/build/5cb8ba72876a14f69a63012abc660f08.png" alt="Image produced in Jupyter"/></div></div><p>The linear function <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">f</mi><mo stretchy="false">(</mo><mi mathvariant="bold">x</mi><mo stretchy="false">)</mo><mo>=</mo><mi mathvariant="bold">A</mi><mi mathvariant="bold">x</mi></mrow><annotation encoding="application/x-tex">\mathbf{f}(\mathbf{x}) = \mathbf{A}\mathbf{x}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathbf" style="margin-right:0.10903em;">f</span><span class="mopen">(</span><span class="mord mathbf">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6861em;"></span><span class="mord mathbf">Ax</span></span></span></span></span> defines a mapping from <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant="double-struck">R</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">\mathbb{R}^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span> to <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant="double-struck">R</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">\mathbb{R}^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span>. We can apply <code>A</code> to every column of <code>x</code> by using a single matrix multiplication.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">Ax = A * x;</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="tCctfSTcClgxWJRuofARs" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><p>The image of the transformed vectors is an ellipse that just touches the circle of radius <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∥</mi><mi mathvariant="bold">A</mi><msub><mi mathvariant="normal">∥</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">\|\mathbf{A}\|_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">∥</span><span class="mord mathbf">A</span><span class="mord"><span class="mord">∥</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span>:</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">subplot(1,2,2), plot(Ax(1,:), Ax(2,:)), axis equal
hold on, plot(twonorm * x(1,:), twonorm * x(2,:), &#x27;--&#x27;)
title(&#x27;Image of Ax, with ||A||&#x27;)
xlabel(&#x27;x_1&#x27;)
ylabel(&#x27;x_2&#x27;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="YMPS1e_b5lwHNJRhrL4Ll" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/fnc/build/404e7f1e8102695520c72dfbc36871ce.png" alt="Image produced in Jupyter"/></div></div></div></details><h3 id="section-2-8" class="relative group"><span class="heading-text">Section 2.8</span><a class="no-underline text-inherit hover:text-inherit px-2 font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#section-2-8" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><details class="rounded-md my-5 shadow dark:shadow-2xl dark:shadow-neutral-900 overflow-hidden bg-gray-50 dark:bg-stone-800"><summary class="m-0 text-lg font-medium py-1 min-h-[2em] pl-3 cursor-pointer hover:shadow-[inset_0_0_0px_30px_#00000003] dark:hover:shadow-[inset_0_0_0px_30px_#FFFFFF03] bg-gray-100 dark:bg-slate-900"><span class="text-neutral-900 dark:text-white"><span class="block float-right text-sm font-thin text-neutral-700 dark:text-neutral-200"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="inline-block pl-2 mr-2 -translate-y-[1px] details-toggle transition-transform"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></span>Matrix condition number</span></summary><div class="px-4 py-1 details-body"><p id="index-mdrnrlgmsx">MATLAB has a function <code>cond</code> to compute matrix condition numbers. By default, the 2-norm is used. As an example, the family of <em>Hilbert matrices</em> is famously badly conditioned. Here is the <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>6</mn><mo>×</mo><mn>6</mn></mrow><annotation encoding="application/x-tex">6\times 6</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">6</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">6</span></span></span></span></span> case.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">A = hilb(6)
kappa = cond(A)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="eokQOlLxz3LVXFlvtB9ON" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><p>Because <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>κ</mi><mo>≈</mo><mn>1</mn><msup><mn>0</mn><mn>8</mn></msup></mrow><annotation encoding="application/x-tex">\kappa\approx 10^8</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4831em;"></span><span class="mord mathnormal">κ</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">8</span></span></span></span></span></span></span></span></span></span></span></span>, it’s possible to lose nearly 8 digits of accuracy in the process of passing from <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">A</mi></mrow><annotation encoding="application/x-tex">\mathbf{A}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6861em;"></span><span class="mord mathbf">A</span></span></span></span></span> and <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">b</mi></mrow><annotation encoding="application/x-tex">\mathbf{b}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathbf">b</span></span></span></span></span> to <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">x</mi></mrow><annotation encoding="application/x-tex">\mathbf{x}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4444em;"></span><span class="mord mathbf">x</span></span></span></span></span>. That fact is independent of the algorithm; it’s inevitable once the data are expressed in finite precision.</p><p>Let’s engineer a linear system problem to observe the effect of a perturbation. We will make sure we know the exact answer.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">x = (1:6)&#x27;;
b = A * x;</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="Z4ZtxRJ4_Asi_5wO0Q-gk" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><p>Now we perturb the system matrix and vector randomly by <span>10<sup>-10</sup></span> in norm.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">dA = randn(size(A));  dA = 1e-10 * (dA / norm(dA));
db = randn(size(b));  db = 1e-10 * (db / norm(db));</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="rlw90SrGihTE7OV2MD7OS" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><p>We solve the perturbed problem using pivoted <abbr aria-label="lower triangular times upper triangular" class="border-b border-dotted cursor-help" data-state="closed">LU</abbr> and see how the solution was changed.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">new_x = ((A + dA) \ (b + db));
dx = new_x - x;</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="AXFpCC2e39ij01XDYrRf7" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><p>Here is the relative error in the solution.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">relative_error = norm(dx) / norm(x)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="ayypgtCCofWL9cfojv4XP" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><p>And here are upper bounds predicted using the condition number of the original matrix.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">upper_bound_b = (kappa * norm(db) / norm(b))
upper_bound_A = (kappa * norm(dA) / norm(A))</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="3KJ6ZU1ng7jJp-CnqsQBg" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><p>Even if we didn’t make any manual perturbations to the data, machine roundoff does so at the relative level of <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ϵ</mi><mtext>mach</mtext></msub></mrow><annotation encoding="application/x-tex">\macheps</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">ϵ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord mtight">mach</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span>.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">dx = A\b - x;
relative_error = norm(dx) / norm(x)
rounding_bound = kappa * eps</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="EKmjnr5POyFbLVZf1uzbn" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><p>Larger Hilbert matrices are even more poorly conditioned:</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">A = hilb(14);
kappa = cond(A)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="evb62doP3cU2Gu8LeBU7-" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><p>Note that <!-- -->κ<!-- --> exceeds <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mi mathvariant="normal">/</mi><msub><mi>ϵ</mi><mtext>mach</mtext></msub></mrow><annotation encoding="application/x-tex">1/\macheps</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1/</span><span class="mord"><span class="mord mathnormal">ϵ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord mtight">mach</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span>. In principle we therefore may end up with an answer that has relative error greater than 100%.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">rounding_bound = kappa * eps</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="p2EuxBu-W-I5EEyiVPCZP" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><p>Let’s put that prediction to the test.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">x = (1:14)&#x27;;  b = A * x;
dx = A\b - x;
relative_error = norm(dx) / norm(x)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="NzD-X2urh3AuGE3Hy8iMl" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><p>As anticipated, the solution has zero accurate digits in the 2-norm.</p></div></details><h3 id="section-2-9" class="relative group"><span class="heading-text">Section 2.9</span><a class="no-underline text-inherit hover:text-inherit px-2 font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#section-2-9" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><details class="rounded-md my-5 shadow dark:shadow-2xl dark:shadow-neutral-900 overflow-hidden bg-gray-50 dark:bg-stone-800"><summary class="m-0 text-lg font-medium py-1 min-h-[2em] pl-3 cursor-pointer hover:shadow-[inset_0_0_0px_30px_#00000003] dark:hover:shadow-[inset_0_0_0px_30px_#FFFFFF03] bg-gray-100 dark:bg-slate-900"><span class="text-neutral-900 dark:text-white"><span class="block float-right text-sm font-thin text-neutral-700 dark:text-neutral-200"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="inline-block pl-2 mr-2 -translate-y-[1px] details-toggle transition-transform"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></span>Banded matrices</span></summary><div class="px-4 py-1 details-body"><p id="index-uj40pgzcmb">Here is a small tridiagonal matrix. Note that there is one fewer element on the super- and subdiagonals than on the main diagonal.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">A = [ 2 -1  0  0  0  0
      4  2 -1  0  0  0
      0  3  0 -1  0  0
      0  0  2  2 -1  0
      0  0  0  1  1 -1
      0  0  0  0  0  2 ];</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="KjYzJnCl5_wYNvx4YSy2w" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div class="myst-grid grid my-5 sm:grid-cols-1 md:grid-cols-1 lg:grid-cols-2 xl:grid-cols-2 gap-4"><p>We can extract the elements on any diagonal using the <code>diag</code> function. The main or central diagonal is numbered zero, above and to the right of that is positive, and below and to the left is negative.</p><div class="my-5 rounded shadow dark:shadow-neutral-800 overflow-hidden border border-gray-100 dark:border-gray-800 flex flex-col"><div class="flex-grow px-4 py-2"><p>The <code>diag</code> function extracts the elements from a specified diagonal of a matrix.</p></div></div></div><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">diag_main = diag(A, 0)&#x27;
diag_plusone = diag(A, 1)&#x27;
diag_minusone = diag(A,-1)&#x27;</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="OQprwVktUWwzaclhxRPls" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">A = A + diag([5 8 6 7], 2)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="YF7eyeUvAt4x364pGBj_l" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><p>The lower and upper bandwidths of <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">A</mi></mrow><annotation encoding="application/x-tex">\mathbf{A}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6861em;"></span><span class="mord mathbf">A</span></span></span></span></span> are repeated in the factors from the unpivoted <abbr aria-label="lower triangular times upper triangular" class="border-b border-dotted cursor-help" data-state="closed">LU</abbr> factorization.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">[L, U] = lufact(A)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="JgAQRLLVt454hJaaGRT5H" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div></div></details><details class="rounded-md my-5 shadow dark:shadow-2xl dark:shadow-neutral-900 overflow-hidden bg-gray-50 dark:bg-stone-800"><summary class="m-0 text-lg font-medium py-1 min-h-[2em] pl-3 cursor-pointer hover:shadow-[inset_0_0_0px_30px_#00000003] dark:hover:shadow-[inset_0_0_0px_30px_#FFFFFF03] bg-gray-100 dark:bg-slate-900"><span class="text-neutral-900 dark:text-white"><span class="block float-right text-sm font-thin text-neutral-700 dark:text-neutral-200"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="inline-block pl-2 mr-2 -translate-y-[1px] details-toggle transition-transform"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></span>Timing banded <abbr aria-label="lower triangular times upper triangular" class="border-b border-dotted cursor-help" data-state="closed">LU</abbr></span></summary><div class="px-4 py-1 details-body"><p>If we use an ordinary or dense matrix, then there’s no way to exploit a banded structure such as tridiagonality.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">n = 10000;
A = diag(1:n) + diag(n-1:-1:1, 1) + diag(ones(n-1, 1), -1);
tic, [L,U] = lu(A); toc</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="3eh6ruB4aoV8Y2hs9CEKc" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>Elapsed time is 4.969522 seconds.
</span></code></pre></div></div></div><p>If instead we convert the matrix to <code>sparse</code> form, though, the speedup can be dramatic.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">tic, [L,U] = lu(sparse(A)); toc</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="cqOiydPB9AEYhnHYWB_8g" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>Elapsed time is 0.244077 seconds.
</span></code></pre></div></div></div></div></details><details class="rounded-md my-5 shadow dark:shadow-2xl dark:shadow-neutral-900 overflow-hidden bg-gray-50 dark:bg-stone-800"><summary class="m-0 text-lg font-medium py-1 min-h-[2em] pl-3 cursor-pointer hover:shadow-[inset_0_0_0px_30px_#00000003] dark:hover:shadow-[inset_0_0_0px_30px_#FFFFFF03] bg-gray-100 dark:bg-slate-900"><span class="text-neutral-900 dark:text-white"><span class="block float-right text-sm font-thin text-neutral-700 dark:text-neutral-200"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="inline-block pl-2 mr-2 -translate-y-[1px] details-toggle transition-transform"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></span>Symmetric LDL<sup>T</sup> factorization</span></summary><div class="px-4 py-1 details-body"><p>We begin with a symmetric <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">A</mi></mrow><annotation encoding="application/x-tex">\mathbf{A}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6861em;"></span><span class="mord mathbf">A</span></span></span></span></span>.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">A_1 = [ 2     4     4     2
        4     5     8    -5
        4     8     6     2
        2    -5     2   -26 ];</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="XhDcucupgXxh-x2NYOGyS" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><p>We won’t use pivoting, so the pivot element is at position (1,1). This will become the first element on the diagonal of <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">D</mi></mrow><annotation encoding="application/x-tex">\mathbf{D}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6861em;"></span><span class="mord mathbf">D</span></span></span></span></span>. Then we divide by that pivot to get the first column of <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">L</mi></mrow><annotation encoding="application/x-tex">\mathbf{L}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6861em;"></span><span class="mord mathbf">L</span></span></span></span></span>.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">L = eye(4);
d = zeros(4, 1);
d(1) = A_1(1, 1);
L(:, 1) = A_1(:, 1) / d(1);
A_2 = A_1 - d(1) * L(:, 1) * L(:, 1)&#x27;</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="5SAx81bgAdF3G8Azd4T4_" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><p>We are now set up the same way for the submatrix in rows and columns 2–4.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">d(2) = A_2(2, 2);
L(:, 2) = A_2(:, 2) / d(2);
A_3 = A_2 - d(2) * L(:, 2) * L(:, 2)&#x27;</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="X-5FIrx5akXlnx-KMpvV2" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><p>We continue working our way down the diagonal.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">d(3) = A_3(3, 3);
L(:, 3) = A_3(:, 3) / d(3);
A_4 = A_3 - d(3) * L(:, 3) * L(:, 3)&#x27;
d(4) = A_4(4, 4);
d
L</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="v2A-JTZvcnePOp0LNrHFN" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><p>We have arrived at the desired factorization, which we can validate:</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">norm(A_1 - (L * diag(d) * L&#x27;))</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="J-I5TAdeXSRrKfNrxY6gk" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div></div></details><details class="rounded-md my-5 shadow dark:shadow-2xl dark:shadow-neutral-900 overflow-hidden bg-gray-50 dark:bg-stone-800"><summary class="m-0 text-lg font-medium py-1 min-h-[2em] pl-3 cursor-pointer hover:shadow-[inset_0_0_0px_30px_#00000003] dark:hover:shadow-[inset_0_0_0px_30px_#FFFFFF03] bg-gray-100 dark:bg-slate-900"><span class="text-neutral-900 dark:text-white"><span class="block float-right text-sm font-thin text-neutral-700 dark:text-neutral-200"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="inline-block pl-2 mr-2 -translate-y-[1px] details-toggle transition-transform"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></span>Cholesky factorization</span></summary><div class="px-4 py-1 details-body"><p>A randomly chosen matrix is extremely unlikely to be symmetric. However, there is a simple way to symmetrize one.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">A = magic(4) + eye(4);
B = A + A&#x27;</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="bcxxpheKWHE7T0msm69ui" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div class="myst-grid grid my-5 sm:grid-cols-1 md:grid-cols-1 lg:grid-cols-2 xl:grid-cols-2 gap-4"><p>Similarly, a random symmetric matrix is unlikely to be positive definite. The Cholesky algorithm always detects a non-PD matrix by quitting with an error.</p><div class="my-5 rounded shadow dark:shadow-neutral-800 overflow-hidden border border-gray-100 dark:border-gray-800 flex flex-col"><div class="flex-grow px-4 py-2"><p>The <code>chol</code> function computes a Cholesky factorization if possible, or throws an error for a non-positive-definite matrix.</p></div></div></div><aside class="my-5 shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-gray-50/10 dark:bg-stone-800 overflow-hidden rounded border-l-4 border-amber-600"><div class="m-0 font-medium py-1 flex min-w-0 text-lg text-amber-600 bg-amber-50 dark:bg-slate-900"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="inline-block pl-2 mr-2 self-center flex-none text-amber-600"><path fill-rule="evenodd" d="M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003ZM12 8.25a.75.75 0 0 1 .75.75v3.75a.75.75 0 0 1-1.5 0V9a.75.75 0 0 1 .75-.75Zm0 8.25a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5Z" clip-rule="evenodd"></path></svg><div class="text-neutral-900 dark:text-white grow self-center overflow-hidden break-words">Warning</div></div><div class="px-4 py-1"><p>The <code>chol</code> function does <em>not</em> check for symmetry. It may give a nonsensical result if the input is not symmetric.</p></div></aside><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">chol(B)    % throws an error</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="ecAkmmmXnvoUQJzElN5im" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>Error using chol
Matrix must be positive definite.</span></code></pre></div></div></div><p>It’s not hard to manufacture an SPD matrix to try out the Cholesky factorization.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">B = A&#x27; * A;
R = chol(B)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="zcWTIHFWRwhVv9aFEVRta" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><p>Here we validate the factorization:</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-matlab" style="white-space:pre">norm(R&#x27; * R - B) / norm(B)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="63g-KeWnXfTXxFASPgzO_" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div></div></details></div><div></div><div class="flex pt-10 mb-10 space-x-4"><a class="flex-1 block p-4 font-normal text-gray-600 no-underline border border-gray-200 rounded shadow-sm group hover:border-blue-600 dark:hover:border-blue-400 hover:text-blue-600 dark:hover:text-blue-400 dark:text-gray-100 dark:border-gray-500 hover:shadow-lg dark:shadow-neutral-700" href="/fnc/chapter1-1"><div class="flex h-full align-middle"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="self-center transition-transform group-hover:-translate-x-1 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18"></path></svg><div class="flex-grow text-right"><div class="text-xs text-gray-500 dark:text-gray-400">MATLAB codes</div>Chapter 1</div></div></a><a class="flex-1 block p-4 font-normal text-gray-600 no-underline border border-gray-200 rounded shadow-sm group hover:border-blue-600 dark:hover:border-blue-400 hover:text-blue-600 dark:hover:text-blue-400 dark:text-gray-100 dark:border-gray-500 hover:shadow-lg dark:shadow-neutral-700" href="/fnc/chapter3-1"><div class="flex h-full align-middle"><div class="flex-grow"><div class="text-xs text-gray-500 dark:text-gray-400">MATLAB codes</div>Chapter 3</div><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="self-center transition-transform group-hover:translate-x-1 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 4.5 21 12m0 0-7.5 7.5M21 12H3"></path></svg></div></a></div></main></article><script>((a,d)=>{if(!window.history.state||!window.history.state.key){let h=Math.random().toString(32).slice(2);window.history.replaceState({key:h},"")}try{let f=JSON.parse(sessionStorage.getItem(a)||"{}")[d||window.history.state.key];typeof f=="number"&&window.scrollTo(0,f)}catch(h){console.error(h),sessionStorage.removeItem(a)}})("positions", null)</script><link rel="modulepreload" href="/fnc/build/entry.client-UNPC4GT3.js"/><link rel="modulepreload" href="/fnc/build/_shared/chunk-OCTKKCIL.js"/><link rel="modulepreload" href="/fnc/build/_shared/chunk-UAI5KRM7.js"/><link rel="modulepreload" href="/fnc/build/_shared/chunk-2NH4LW52.js"/><link rel="modulepreload" href="/fnc/build/_shared/chunk-JLDGA2DL.js"/><link rel="modulepreload" href="/fnc/build/_shared/chunk-YAIQ7LUU.js"/><link rel="modulepreload" href="/fnc/build/_shared/chunk-OCWQY3HK.js"/><link rel="modulepreload" href="/fnc/build/_shared/chunk-ZQWAZXET.js"/><link rel="modulepreload" href="/fnc/build/_shared/chunk-HYMQ7M2K.js"/><link rel="modulepreload" href="/fnc/build/_shared/chunk-3CVK3PYF.js"/><link rel="modulepreload" href="/fnc/build/_shared/chunk-J6FHCSRC.js"/><link rel="modulepreload" href="/fnc/build/_shared/chunk-IQBJE7PC.js"/><link rel="modulepreload" href="/fnc/build/_shared/chunk-5CFTM6YW.js"/><link rel="modulepreload" href="/fnc/build/_shared/chunk-GUCIBHGO.js"/><link rel="modulepreload" href="/fnc/build/root-HROFNPGU.js"/><link rel="modulepreload" href="/fnc/build/_shared/chunk-N544LW6X.js"/><link rel="modulepreload" href="/fnc/build/routes/$-WNZNXUO2.js"/><script>window.__remixContext = {"url":"/chapter2-1","state":{"loaderData":{"root":{"config":{"title":"Fundamentals of Numerical Computation","options":{"favicon":"/fnc/build/favicon-eb5519d0a12992c68aa24a8a04531b7e.png","logo":"/fnc/build/FNClogo-8857b73cc9f6c65c9fea3e10797ba18a.png"},"myst":"1.3.19","nav":[],"actions":[],"projects":[{"numbering":{"heading_1":{"enabled":true},"heading_2":{"enabled":true},"heading_3":{"enabled":false}},"math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"LU":"lower triangular times upper triangular","QR":"orthogonal times upper triangular"},"exports":[{"format":"pdf","filename":"myst.pdf","url":"/fnc/build/myst-17d85fc44120abd982ec3b44467ee78e.pdf"}],"title":"Fundamentals of Numerical Computation","short_title":"FNC","description":"Online textbook for computational mathematics","authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","id":"a36af5d8-56ed-4bf2-92e6-5f7fdb82e8e1","toc":[{"file":"home.md"},{"children":[{"file":"preface.md"},{"file":"preface-original.md"}],"title":"Preface"},{"children":[{"file":"chapter1/floating-point.md"},{"file":"chapter1/conditioning.md"},{"file":"chapter1/algorithms.md"},{"file":"chapter1/stability.md"},{"file":"chapter1/next.md"}],"file":"chapter1/overview.md"},{"children":[{"file":"chapter2/polyinterp.md"},{"file":"chapter2/matrices.md"},{"file":"chapter2/linear-systems.md"},{"file":"chapter2/lu.md"},{"file":"chapter2/efficiency.md"},{"file":"chapter2/pivoting.md"},{"file":"chapter2/norms.md"},{"file":"chapter2/condition-number.md"},{"file":"chapter2/structure.md"},{"file":"chapter2/next.md"}],"file":"chapter2/overview.md"},{"children":[{"file":"chapter3/fitting.md"},{"file":"chapter3/normaleqns.md"},{"file":"chapter3/qr.md"},{"file":"chapter3/house.md"},{"file":"chapter3/next.md"}],"file":"chapter3/overview.md"},{"children":[{"file":"chapter4/rootproblem.md"},{"file":"chapter4/fixed-point.md"},{"file":"chapter4/newton.md"},{"file":"chapter4/secant.md"},{"file":"chapter4/newtonsys.md"},{"file":"chapter4/quasinewton.md"},{"file":"chapter4/nlsq.md"},{"file":"chapter4/next.md"}],"file":"chapter4/overview.md"},{"children":[{"file":"chapter5/interpolation.md"},{"file":"chapter5/pwlin.md"},{"file":"chapter5/splines.md"},{"file":"chapter5/finitediffs.md"},{"file":"chapter5/fd-converge.md"},{"file":"chapter5/integration.md"},{"file":"chapter5/adaptive.md"},{"file":"chapter5/next.md"}],"file":"chapter5/overview.md"},{"children":[{"file":"chapter6/basics.md"},{"file":"chapter6/euler.md"},{"file":"chapter6/systems.md"},{"file":"chapter6/rk.md"},{"file":"chapter6/adaptive-rk.md"},{"file":"chapter6/multistep.md"},{"file":"chapter6/implicit.md"},{"file":"chapter6/zerostability.md"},{"file":"chapter6/next.md"}],"file":"chapter6/overview.md"},{"children":[{"file":"appendix/linear-algebra.md"},{"children":[{"file":"julia/chapter1.md"},{"file":"julia/chapter2.md"},{"file":"julia/chapter3.md"},{"file":"julia/chapter4.md"},{"file":"julia/chapter5.md"},{"file":"julia/chapter6.md"}],"title":"Julia codes"},{"children":[{"file":"matlab/chapter1.md"},{"file":"matlab/chapter2.md"},{"file":"matlab/chapter3.md"},{"file":"matlab/chapter4.md"},{"file":"matlab/chapter5.md"},{"file":"matlab/chapter6.md"}],"title":"MATLAB codes"},{"children":[{"file":"python/chapter1.md"},{"file":"python/chapter2.md"},{"file":"python/chapter3.md"},{"file":"python/chapter4.md"},{"file":"python/chapter5.md"},{"file":"python/chapter6.md"}],"title":"Python codes"}],"title":"Appendices"},{"file":"genindex.md"}],"thumbnail":"/fnc/build/front_cover_small-3b81a246c798b3ded1375244c3419355.png","thumbnailOptimized":"/fnc/build/front_cover_small-3b81a246c798b3ded1375244c3419355.webp","bibliography":[],"index":"home","pages":[{"level":1,"title":"Preface"},{"slug":"preface","title":"Preface to the Julia edition","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"preface-original","title":"Preface to the original edition","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"overview","title":"Introduction","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"floating-point","title":"Floating-point numbers","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"conditioning","title":"Problems and conditioning","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"algorithms","title":"Algorithms","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"stability","title":"Stability","description":"","date":"","thumbnail":"/fnc/build/backwarderror-bdcf58e0d5f4193c2230d0af9181d25c.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"next","title":"Next steps","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"overview-1","title":"Linear systems of equations","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"polyinterp","title":"Polynomial interpolation","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"matrices","title":"Computing with matrices","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"linear-systems","title":"Linear systems","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"lu","title":"LU factorization","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"efficiency","title":"Efficiency of matrix computations","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"pivoting","title":"Row pivoting","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"norms","title":"Vector and matrix norms","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"condition-number","title":"Conditioning of linear systems","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"structure","title":"Exploiting matrix structure","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"next-1","title":"Next steps","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"overview-2","title":"Overdetermined linear systems","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"fitting","title":"Fitting functions to data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"normaleqns","title":"The normal equations","description":"","date":"","thumbnail":"/fnc/build/normaleqns2d-3a9bdadad6b0273ad3bb332f316bfd7c.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"qr","title":"The QR factorization","description":"","date":"","thumbnail":"/fnc/build/nonorthogonal-b17ed1afa4e72fd15dc1d03a95b2c3d7.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"house","title":"Computing QR factorizations","description":"","date":"","thumbnail":"/fnc/build/hhreflect-4c7ca3f245617111b6fd9e68dcaee10e.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"next-2","title":"Next steps","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"overview-3","title":"Roots of nonlinear equations","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"rootproblem","title":"The rootfinding problem","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fixed-point","title":"Fixed-point iteration","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"newton","title":"Newton’s method","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"secant","title":"Interpolation-based methods","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"newtonsys","title":"Newton for nonlinear systems","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"quasinewton","title":"Quasi-Newton methods","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"nlsq","title":"Nonlinear least squares","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"next-3","title":"Next steps","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"overview-4","title":"Piecewise interpolation","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"interpolation","title":"The interpolation problem","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"pwlin","title":"Piecewise linear interpolation","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"splines","title":"Cubic splines","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"finitediffs","title":"Finite differences","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fd-converge","title":"Convergence of finite differences","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"integration","title":"Numerical integration","description":"","date":"","thumbnail":"/fnc/build/trapezoid-a279167525570df0e1ac47b0fceef54c.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"adaptive","title":"Adaptive integration","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"next-4","title":"Next steps","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"overview-5","title":"Initial-value problems for ODEs","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"basics","title":"Basics of IVPs","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"euler","title":"Euler’s method","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"systems","title":"IVP systems","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"rk","title":"Runge–Kutta methods","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"adaptive-rk","title":"Adaptive Runge–Kutta","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"multistep","title":"Multistep methods","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"implicit","title":"Implementation of multistep methods","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"zerostability","title":"Zero-stability of multistep methods","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"next-5","title":"Next steps","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Appendices"},{"slug":"linear-algebra","title":"Review of linear algebra","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":2,"title":"Julia codes"},{"slug":"chapter1","title":"Chapter 1","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter2","title":"Chapter 2","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter3","title":"Chapter 3","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter4","title":"Chapter 4","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter5","title":"Chapter 5","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter6","title":"Chapter 6","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":2,"title":"MATLAB codes"},{"slug":"chapter1-1","title":"Chapter 1","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter2-1","title":"Chapter 2","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter3-1","title":"Chapter 3","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter4-1","title":"Chapter 4","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter5-1","title":"Chapter 5","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter6-1","title":"Chapter 6","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":2,"title":"Python codes"},{"slug":"chapter1-2","title":"Chapter 1","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter2-2","title":"Chapter 2","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter3-2","title":"Chapter 3","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter4-2","title":"Chapter 4","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter5-2","title":"Chapter 5","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter6-2","title":"Chapter 6","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"genindex","title":"Index","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1}]}]},"CONTENT_CDN_PORT":"3100","MODE":"static","BASE_URL":"/fnc"},"routes/$":{"config":{"title":"Fundamentals of Numerical Computation","options":{"favicon":"/fnc/build/favicon-eb5519d0a12992c68aa24a8a04531b7e.png","logo":"/fnc/build/FNClogo-8857b73cc9f6c65c9fea3e10797ba18a.png"},"myst":"1.3.19","nav":[],"actions":[],"projects":[{"numbering":{"heading_1":{"enabled":true},"heading_2":{"enabled":true},"heading_3":{"enabled":false}},"math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"LU":"lower triangular times upper triangular","QR":"orthogonal times upper triangular"},"exports":[{"format":"pdf","filename":"myst.pdf","url":"/fnc/build/myst-17d85fc44120abd982ec3b44467ee78e.pdf"}],"title":"Fundamentals of Numerical Computation","short_title":"FNC","description":"Online textbook for computational mathematics","authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","id":"a36af5d8-56ed-4bf2-92e6-5f7fdb82e8e1","toc":[{"file":"home.md"},{"children":[{"file":"preface.md"},{"file":"preface-original.md"}],"title":"Preface"},{"children":[{"file":"chapter1/floating-point.md"},{"file":"chapter1/conditioning.md"},{"file":"chapter1/algorithms.md"},{"file":"chapter1/stability.md"},{"file":"chapter1/next.md"}],"file":"chapter1/overview.md"},{"children":[{"file":"chapter2/polyinterp.md"},{"file":"chapter2/matrices.md"},{"file":"chapter2/linear-systems.md"},{"file":"chapter2/lu.md"},{"file":"chapter2/efficiency.md"},{"file":"chapter2/pivoting.md"},{"file":"chapter2/norms.md"},{"file":"chapter2/condition-number.md"},{"file":"chapter2/structure.md"},{"file":"chapter2/next.md"}],"file":"chapter2/overview.md"},{"children":[{"file":"chapter3/fitting.md"},{"file":"chapter3/normaleqns.md"},{"file":"chapter3/qr.md"},{"file":"chapter3/house.md"},{"file":"chapter3/next.md"}],"file":"chapter3/overview.md"},{"children":[{"file":"chapter4/rootproblem.md"},{"file":"chapter4/fixed-point.md"},{"file":"chapter4/newton.md"},{"file":"chapter4/secant.md"},{"file":"chapter4/newtonsys.md"},{"file":"chapter4/quasinewton.md"},{"file":"chapter4/nlsq.md"},{"file":"chapter4/next.md"}],"file":"chapter4/overview.md"},{"children":[{"file":"chapter5/interpolation.md"},{"file":"chapter5/pwlin.md"},{"file":"chapter5/splines.md"},{"file":"chapter5/finitediffs.md"},{"file":"chapter5/fd-converge.md"},{"file":"chapter5/integration.md"},{"file":"chapter5/adaptive.md"},{"file":"chapter5/next.md"}],"file":"chapter5/overview.md"},{"children":[{"file":"chapter6/basics.md"},{"file":"chapter6/euler.md"},{"file":"chapter6/systems.md"},{"file":"chapter6/rk.md"},{"file":"chapter6/adaptive-rk.md"},{"file":"chapter6/multistep.md"},{"file":"chapter6/implicit.md"},{"file":"chapter6/zerostability.md"},{"file":"chapter6/next.md"}],"file":"chapter6/overview.md"},{"children":[{"file":"appendix/linear-algebra.md"},{"children":[{"file":"julia/chapter1.md"},{"file":"julia/chapter2.md"},{"file":"julia/chapter3.md"},{"file":"julia/chapter4.md"},{"file":"julia/chapter5.md"},{"file":"julia/chapter6.md"}],"title":"Julia codes"},{"children":[{"file":"matlab/chapter1.md"},{"file":"matlab/chapter2.md"},{"file":"matlab/chapter3.md"},{"file":"matlab/chapter4.md"},{"file":"matlab/chapter5.md"},{"file":"matlab/chapter6.md"}],"title":"MATLAB codes"},{"children":[{"file":"python/chapter1.md"},{"file":"python/chapter2.md"},{"file":"python/chapter3.md"},{"file":"python/chapter4.md"},{"file":"python/chapter5.md"},{"file":"python/chapter6.md"}],"title":"Python codes"}],"title":"Appendices"},{"file":"genindex.md"}],"thumbnail":"/fnc/build/front_cover_small-3b81a246c798b3ded1375244c3419355.png","thumbnailOptimized":"/fnc/build/front_cover_small-3b81a246c798b3ded1375244c3419355.webp","bibliography":[],"index":"home","pages":[{"level":1,"title":"Preface"},{"slug":"preface","title":"Preface to the Julia edition","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"preface-original","title":"Preface to the original edition","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"overview","title":"Introduction","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"floating-point","title":"Floating-point numbers","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"conditioning","title":"Problems and conditioning","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"algorithms","title":"Algorithms","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"stability","title":"Stability","description":"","date":"","thumbnail":"/fnc/build/backwarderror-bdcf58e0d5f4193c2230d0af9181d25c.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"next","title":"Next steps","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"overview-1","title":"Linear systems of equations","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"polyinterp","title":"Polynomial interpolation","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"matrices","title":"Computing with matrices","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"linear-systems","title":"Linear systems","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"lu","title":"LU factorization","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"efficiency","title":"Efficiency of matrix computations","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"pivoting","title":"Row pivoting","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"norms","title":"Vector and matrix norms","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"condition-number","title":"Conditioning of linear systems","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"structure","title":"Exploiting matrix structure","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"next-1","title":"Next steps","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"overview-2","title":"Overdetermined linear systems","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"fitting","title":"Fitting functions to data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"normaleqns","title":"The normal equations","description":"","date":"","thumbnail":"/fnc/build/normaleqns2d-3a9bdadad6b0273ad3bb332f316bfd7c.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"qr","title":"The QR factorization","description":"","date":"","thumbnail":"/fnc/build/nonorthogonal-b17ed1afa4e72fd15dc1d03a95b2c3d7.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"house","title":"Computing QR factorizations","description":"","date":"","thumbnail":"/fnc/build/hhreflect-4c7ca3f245617111b6fd9e68dcaee10e.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"next-2","title":"Next steps","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"overview-3","title":"Roots of nonlinear equations","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"rootproblem","title":"The rootfinding problem","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fixed-point","title":"Fixed-point iteration","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"newton","title":"Newton’s method","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"secant","title":"Interpolation-based methods","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"newtonsys","title":"Newton for nonlinear systems","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"quasinewton","title":"Quasi-Newton methods","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"nlsq","title":"Nonlinear least squares","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"next-3","title":"Next steps","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"overview-4","title":"Piecewise interpolation","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"interpolation","title":"The interpolation problem","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"pwlin","title":"Piecewise linear interpolation","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"splines","title":"Cubic splines","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"finitediffs","title":"Finite differences","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fd-converge","title":"Convergence of finite differences","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"integration","title":"Numerical integration","description":"","date":"","thumbnail":"/fnc/build/trapezoid-a279167525570df0e1ac47b0fceef54c.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"adaptive","title":"Adaptive integration","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"next-4","title":"Next steps","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"overview-5","title":"Initial-value problems for ODEs","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"basics","title":"Basics of IVPs","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"euler","title":"Euler’s method","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"systems","title":"IVP systems","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"rk","title":"Runge–Kutta methods","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"adaptive-rk","title":"Adaptive Runge–Kutta","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"multistep","title":"Multistep methods","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"implicit","title":"Implementation of multistep methods","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"zerostability","title":"Zero-stability of multistep methods","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"next-5","title":"Next steps","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Appendices"},{"slug":"linear-algebra","title":"Review of linear algebra","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":2,"title":"Julia codes"},{"slug":"chapter1","title":"Chapter 1","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter2","title":"Chapter 2","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter3","title":"Chapter 3","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter4","title":"Chapter 4","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter5","title":"Chapter 5","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter6","title":"Chapter 6","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":2,"title":"MATLAB codes"},{"slug":"chapter1-1","title":"Chapter 1","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter2-1","title":"Chapter 2","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter3-1","title":"Chapter 3","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter4-1","title":"Chapter 4","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter5-1","title":"Chapter 5","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter6-1","title":"Chapter 6","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":2,"title":"Python codes"},{"slug":"chapter1-2","title":"Chapter 1","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter2-2","title":"Chapter 2","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter3-2","title":"Chapter 3","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter4-2","title":"Chapter 4","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter5-2","title":"Chapter 5","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter6-2","title":"Chapter 6","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"genindex","title":"Index","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1}]}]},"page":{"kind":"Notebook","sha256":"d5df22ad9602b4cbe9bd9fda5d5c6131b837a4964ff061a0f5f3a74239dea910","slug":"chapter2-1","location":"/matlab/chapter2.md","dependencies":[],"frontmatter":{"title":"Chapter 2","numbering":{"heading_1":{"enabled":false},"heading_2":{"enabled":false},"heading_3":{"enabled":false},"heading_4":{"enabled":false},"heading_5":{"enabled":false},"heading_6":{"enabled":false}},"kernelspec":{"name":"jupyter_matlab_kernel","display_name":"MATLAB","language":"matlab"},"content_includes_title":false,"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"LU":"lower triangular times upper triangular","QR":"orthogonal times upper triangular"},"exports":[{"format":"md","filename":"chapter2.md","url":"/fnc/build/chapter2-d8040a4adadc7d7298d52371b68eb91e.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"MATLAB implementations","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"pTmrDMrBzj"}],"key":"aSathvb1rH"},{"type":"heading","depth":2,"position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"Functions","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"WNbGWYhT3q"}],"identifier":"functions","label":"Functions","html_id":"functions","implicit":true,"key":"H2afeGLT9O"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Forward substitution","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"O5tzM4hUYw"}],"key":"naBk6tz8GT"},{"type":"include","file":"../matlab/fnc/forwardsub.m","literal":true,"filter":{},"children":[{"type":"code","value":"function x = forwardsub(L,b)\r\n% FORWARDSUB   Solve a lower triangular linear system.\r\n% Input:\r\n%   L    lower triangular square matrix (n by n)\r\n%   b    right-hand side vector (n by 1)   \r\n% Output:\r\n%   x    solution of Lx=b (n by 1 vector)\r\n\r\nn = length(L);\r\nx = zeros(n,1);\r\nfor i = 1:n\r\n  x(i) = ( b(i) - L(i,1:i-1) * x(1:i-1) ) / L(i,i);\r\nend","lang":"matlab","showLineNumbers":true,"filename":"forwardsub.m","key":"ZxNXiloEOs"}],"key":"FUFyloaW6u"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"About the code","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"Rl1eBSOu7q"}],"key":"Pdy7YIYjDz"},{"type":"paragraph","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"text","value":"Line 12 implements ","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"vUuWIhXHmA"},{"type":"crossReference","identifier":"forwardsub","label":"forwardsub","kind":"equation","position":{"start":{"line":25,"column":20},"end":{"line":25,"column":31}},"children":[{"type":"text","value":"(","key":"GW6ZJnBbbi"},{"type":"text","value":"2.3.7","key":"shG6oi8poe"},{"type":"text","value":")","key":"lEfSf3cZD4"}],"template":"(%s)","enumerator":"2.3.7","resolved":true,"html_id":"forwardsub","remote":true,"url":"/linear-systems","dataUrl":"/linear-systems.json","key":"CM3N0oNYIJ"},{"type":"text","value":". It contains an inner product between row ","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"IzwrXDtmnF"},{"type":"inlineMath","value":"i","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003ei\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003ei\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6595em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003ei\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"pt6meSUpPG"},{"type":"text","value":" of ","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"KchOPmzzoD"},{"type":"inlineMath","value":"\\mathbf{L}","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi mathvariant=\"bold\"\u003eL\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\mathbf{L}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6861em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathbf\"\u003eL\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"ztrjiWmJEx"},{"type":"text","value":" and the solution vector ","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"s9leFqOOA4"},{"type":"inlineMath","value":"\\mathbf{x}","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi mathvariant=\"bold\"\u003ex\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\mathbf{x}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.4444em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathbf\"\u003ex\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"uahPa66i6e"},{"type":"text","value":", using only the entries of ","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"QHjqZGib1X"},{"type":"inlineMath","value":"\\mathbf{x}","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi mathvariant=\"bold\"\u003ex\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\mathbf{x}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.4444em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathbf\"\u003ex\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"CqC47nXRhJ"},{"type":"text","value":" that have already been computed.","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"inWQosfXCS"}],"key":"SFAhNkehVJ"}],"class":"dropdown","key":"IyexRtntsC"}],"label":"function-forwardsub-matlab","identifier":"function-forwardsub-matlab","html_id":"function-forwardsub-matlab","key":"GBpOoiensf"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Backward substitution","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"COBerIZ1SH"}],"key":"ZBi73zbrTW"},{"type":"include","file":"../matlab/fnc/backsub.m","literal":true,"filter":{},"children":[{"type":"code","value":"function x = backsub(U,b)\r\n% BACKSUB   Solve an upper triangular linear system.\r\n% Input:\r\n%   U    upper triangular square matrix (n by n)\r\n%   b    right-hand side vector (n by 1)   \r\n% Output:\r\n%   x    solution of Ux=b (n by 1 vector)\r\n\r\nn = length(U);\r\nx = zeros(n,1);\r\nfor i = n:-1:1\r\n  x(i) = ( b(i) - U(i,i+1:n)*x(i+1:n) ) / U(i,i);\r\nend","lang":"matlab","showLineNumbers":true,"filename":"backsub.m","key":"y6aS19qjNM"}],"key":"oT0CxvH5PV"}],"label":"function-backsub-matlab","identifier":"function-backsub-matlab","html_id":"function-backsub-matlab","key":"KYXPiQQHIG"},{"type":"details","children":[{"type":"summary","children":[{"type":"abbreviation","title":"lower triangular times upper triangular","children":[{"type":"text","value":"LU","key":"niwWm4dzVz"}],"key":"Bm4arEypTm"},{"type":"text","value":" factorization (not stable)","key":"KnM8T1nDPz"}],"key":"dd5Qj2sOEk"},{"type":"include","file":"../matlab/fnc/lufact.m","literal":true,"filter":{},"children":[{"type":"code","value":"function [L, U] = lufact(A)\r\n% LUFACT   LU factorization (demo only--not stable!).\r\n% Input:\r\n%   A    square matrix\r\n% Output:\r\n%   L,U  unit lower triangular and upper triangular such that LU=A\r\n\r\nn = size(A, 1);     % detect the dimensions from the input\r\nL = eye(n);         % ones on main diagonal, zeros elsewhere\r\nU = zeros(n, n);\r\nA_k = A;            % make a working copy \r\n\r\n% Reduction by outer products\r\nfor k = 1:n-1\r\n    U(k, :) = A_k(k, :);\r\n    L(:, k) = A_k(:,k) / U(k, k);\r\n    A_k = A_k -  L(:, k) * U(k, :);\r\nend\r\nU(n, n) = A_k(n, n);\r\nL = tril(L); U = triu(U);    % force exact triangularity","lang":"matlab","showLineNumbers":true,"filename":"lufact.m","key":"Ec6mS9Qnim"}],"key":"RuVkIW2UTL"}],"label":"function-lufact-matlab","identifier":"function-lufact-matlab","html_id":"function-lufact-matlab","key":"tXoxcTIDi5"},{"type":"details","children":[{"type":"summary","children":[{"type":"abbreviation","title":"lower triangular times upper triangular","children":[{"type":"text","value":"LU","key":"qQg0PfcuuY"}],"key":"GLcNxYwGVW"},{"type":"text","value":" factorization with partial pivoting","key":"vVFGVMWxQp"}],"key":"clTDank45X"},{"type":"include","file":"../matlab/fnc/plufact.m","literal":true,"filter":{},"children":[{"type":"code","value":"function [L, U, p] = plufact(A)\n% PLUFACT   Pivoted LU factorization \n% Input:\n%   A    square matrix\n% Output:\n%   L    unit lower triangular \n%   U    upper triangular\n%   p    row permutation vector such that A(p,:) = L*U\nn = size(A, 1);\nL = zeros(n, n);\nU = zeros(n, n);\np = zeros(1, n);\nA_k = A;\n\n% Reduction by outer products\nfor k = 1:n\n    [~, p(k)] = max(abs(A_k(:, k)));\n    U(k, :) = A_k(p(k), :);\n    L(:, k) = A_k(:, k) / U(k, k);\n    if k \u003c n\n        A_k = A_k - L(:, k) * U(k, :);\n    end\nend\nL = tril(L(p, :));\nU = triu(U);","lang":"matlab","showLineNumbers":true,"filename":"plufact.m","key":"Ad5VxQ2KCC"}],"key":"fUo0SO0xzI"},{"type":"code","lang":"","value":"","position":{"start":{"line":51,"column":1},"end":{"line":51,"column":1}},"key":"LeAKanM9Oh"}],"label":"function-plufact-matlab","identifier":"function-plufact-matlab","html_id":"function-plufact-matlab","key":"HdvbyIRZVe"},{"type":"heading","depth":2,"position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"children":[{"type":"text","value":"Examples","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"key":"OOCxrdssuA"}],"identifier":"examples","label":"Examples","html_id":"examples","implicit":true,"key":"OG9bQkXeah"}],"key":"a04JoWeMqK"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"addpath /Users/driscoll/Documents/GitHub/fnc/matlab/fnc\naddpath /Users/driscoll/Documents/GitHub/fnc/matlab\nFNC_init","visibility":"show","key":"IZBunqHPjT"},{"type":"output","id":"gHa5JV8KHqB1CS82FTIt_","data":[{"output_type":"stream","name":"stdout","text":"Executing ..."},{"output_type":"execute_result","execution_count":1,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003eans = \n  Figure (1) with properties:\n\n      Number: 1\n        Name: ''\n       Color: [1 1 1]\n    Position: [1224 1070 560 420]\n       Units: 'pixels'\n\n  Use GET to show all properties\n\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"ans = \n  Figure (1) with properties:\n\n      Number: 1\n        Name: ''\n       Color: [1 1 1]\n    Position: [1224 1070 560 420]\n       Units: 'pixels'\n\n  Use GET to show all properties\n","content_type":"text/plain"}}}],"visibility":"show","key":"oT76z1XHWq"}],"data":{"tags":[]},"visibility":"remove","key":"j33M90bO1X"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":64,"column":1},"end":{"line":64,"column":1}},"children":[{"type":"text","value":"Section 2.1","position":{"start":{"line":64,"column":1},"end":{"line":64,"column":1}},"key":"M5qBhy8goQ"}],"identifier":"section-2-1","label":"Section 2.1","html_id":"section-2-1","implicit":true,"key":"GmuVsy3OcN"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Linear system for polynomial interpolation","position":{"start":{"line":66,"column":1},"end":{"line":66,"column":1}},"key":"mFB3lhCS4P"}],"key":"wxOHabTtSH"},{"type":"paragraph","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"children":[{"type":"text","value":"We create two column vectors for data about the population of China. The first has the years of census data and the other has the population, in millions of people.","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"key":"xjdYxOczeU"}],"key":"p5pJVL0BP5"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"year = [1982; 2000; 2010; 2015]; \npop = [1008.18; 1262.64; 1337.82; 1374.62];","key":"CjxQFNAR7y"},{"type":"output","id":"A5O3hsu1d3Uq-T5O6F4vh","data":[],"key":"kjdnkC3XHG"}],"data":{},"key":"tbU4NGFJB0"},{"type":"paragraph","position":{"start":{"line":74,"column":1},"end":{"line":74,"column":1}},"children":[{"type":"text","value":"It’s convenient to measure time in years since 1980.","position":{"start":{"line":74,"column":1},"end":{"line":74,"column":1}},"key":"KditqavlCB"}],"key":"ZAQ3EdgIHI"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"t = year - 1980;\ny = pop;","key":"c3xoWmO7qd"},{"type":"output","id":"JASV8ko7O6sejDubjBnl0","data":[],"key":"m6zNAqFsW3"}],"data":{},"key":"Nbaw2cLOTZ"},{"type":"paragraph","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"children":[{"type":"text","value":"Now we have four data points ","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"key":"qH4t9MaRWY"},{"type":"inlineMath","value":"(t_1,y_1),\\dots,(t_4,y_4)","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmsub\u003e\u003cmi\u003et\u003c/mi\u003e\u003cmn\u003e1\u003c/mn\u003e\u003c/msub\u003e\u003cmo separator=\"true\"\u003e,\u003c/mo\u003e\u003cmsub\u003e\u003cmi\u003ey\u003c/mi\u003e\u003cmn\u003e1\u003c/mn\u003e\u003c/msub\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003cmo separator=\"true\"\u003e,\u003c/mo\u003e\u003cmo\u003e…\u003c/mo\u003e\u003cmo separator=\"true\"\u003e,\u003c/mo\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmsub\u003e\u003cmi\u003et\u003c/mi\u003e\u003cmn\u003e4\u003c/mn\u003e\u003c/msub\u003e\u003cmo separator=\"true\"\u003e,\u003c/mo\u003e\u003cmsub\u003e\u003cmi\u003ey\u003c/mi\u003e\u003cmn\u003e4\u003c/mn\u003e\u003c/msub\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e(t_1,y_1),\\dots,(t_4,y_4)\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003et\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3011em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e1\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mpunct\"\u003e,\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.1667em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003ey\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3011em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e1\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003cspan class=\"mpunct\"\u003e,\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.1667em;\"\u003e\u003c/span\u003e\u003cspan class=\"minner\"\u003e…\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.1667em;\"\u003e\u003c/span\u003e\u003cspan class=\"mpunct\"\u003e,\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.1667em;\"\u003e\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003et\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3011em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e4\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mpunct\"\u003e,\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.1667em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003ey\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3011em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e4\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"VsN1u8pbAa"},{"type":"text","value":", so ","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"key":"sJuI2rEuyh"},{"type":"inlineMath","value":"n=4","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003en\u003c/mi\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmn\u003e4\u003c/mn\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003en=4\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.4306em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003en\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6444em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e4\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"WLdx7jHu9g"},{"type":"text","value":" and we seek an interpolating cubic polynomial. We construct the associated Vandermonde matrix:","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"key":"HCFhW5Z8nB"}],"indexEntries":[{"entry":"MATLAB","subEntry":{"value":"vander","kind":"entry"},"emphasis":true}],"label":"index-FH9CvEyFEO","identifier":"index-fh9cveyfeo","html_id":"index-fh9cveyfeo","key":"G556YZqQLr"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"V = vander(t)","key":"eJR4QoKDor"},{"type":"output","id":"ga1UySoGvnZoCarNrwSFD","data":[{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003eV = 4×4 double\n           8           4           2           1\n        8000         400          20           1\n       27000         900          30           1\n       42875        1225          35           1\n\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"V = 4×4 double\n           8           4           2           1\n        8000         400          20           1\n       27000         900          30           1\n       42875        1225          35           1\n","content_type":"text/plain"}}}],"key":"wEbjVJd7EV"}],"data":{},"key":"R80P6NKtIW"},{"type":"grid","columns":[1,1,2,2],"children":[{"type":"paragraph","position":{"start":{"line":94,"column":1},"end":{"line":94,"column":1}},"children":[{"type":"text","value":"To solve for the vector of polynomial coefficients, we use a backslash to solve the linear system:","position":{"start":{"line":94,"column":1},"end":{"line":94,"column":1}},"key":"wmDTKuj5ie"}],"key":"fuY92GJ9Bt"},{"type":"card","children":[{"type":"paragraph","position":{"start":{"line":96,"column":1},"end":{"line":96,"column":1}},"children":[{"type":"text","value":"A ","position":{"start":{"line":96,"column":1},"end":{"line":96,"column":1}},"key":"FuOWqLlDyJ"},{"type":"strong","position":{"start":{"line":96,"column":1},"end":{"line":96,"column":1}},"children":[{"type":"text","value":"backslash","position":{"start":{"line":96,"column":1},"end":{"line":96,"column":1}},"key":"MKDcrashc8"}],"key":"YvfmV4oCRH"},{"type":"text","value":" ","position":{"start":{"line":96,"column":1},"end":{"line":96,"column":1}},"key":"Qq7DuMsbpw"},{"type":"inlineCode","value":"\\","position":{"start":{"line":96,"column":1},"end":{"line":96,"column":1}},"key":"WpN1t01XCO"},{"type":"text","value":" is used to solve a linear system of equations.","position":{"start":{"line":96,"column":1},"end":{"line":96,"column":1}},"key":"pqqG5LQP4P"}],"key":"bFvtkv8sJy"}],"key":"vuACJIzEv3"}],"indexEntries":[{"entry":"MATLAB","subEntry":{"value":"\\\\","kind":"entry"},"emphasis":true}],"label":"index-dHUK7kC7Y0","identifier":"index-dhuk7kc7y0","html_id":"index-dhuk7kc7y0","key":"JztwkVSFN8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"c = V \\ y","key":"ZxSh28iDu3"},{"type":"output","id":"715iPOX0AL1M_al-ynbcT","data":[{"output_type":"execute_result","execution_count":5,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003ec = 4×1 double\n    0.0068\n   -0.5923\n   24.1278\n  962.2388\n\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"c = 4×1 double\n    0.0068\n   -0.5923\n   24.1278\n  962.2388\n","content_type":"text/plain"}}}],"key":"e0gHUtOcVW"}],"data":{},"key":"o0cEP2ozdL"},{"type":"paragraph","position":{"start":{"line":104,"column":1},"end":{"line":104,"column":1}},"children":[{"type":"text","value":"The algorithms used by the backslash operator are the main topic of this chapter. As a check on the solution, we can compute the ","position":{"start":{"line":104,"column":1},"end":{"line":104,"column":1}},"key":"Og0TLjdNuz"},{"type":"emphasis","position":{"start":{"line":104,"column":1},"end":{"line":104,"column":1}},"children":[{"type":"text","value":"residual","position":{"start":{"line":104,"column":1},"end":{"line":104,"column":1}},"key":"RBblGGdGzH"}],"key":"nJCsZ3NH2M"},{"type":"text","value":".","position":{"start":{"line":104,"column":1},"end":{"line":104,"column":1}},"key":"TCZvO3RaQl"}],"key":"HLURrlDwR6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"y - V * c","key":"dg4po7XoMl"},{"type":"output","id":"T-rGkGuutM9Z8K9Q3r_jj","data":[{"output_type":"execute_result","execution_count":6,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003eans = 4×1 double\n1.0e-12 *\n\n    0.1137\n         0\n         0\n         0\n\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"ans = 4×1 double\n1.0e-12 *\n\n    0.1137\n         0\n         0\n         0\n","content_type":"text/plain"}}}],"key":"cPB4hnahOI"}],"data":{},"key":"qZRmkUsHMw"},{"type":"paragraph","position":{"start":{"line":110,"column":1},"end":{"line":110,"column":1}},"children":[{"type":"text","value":"Using floating-point arithmetic, it is not realistic to expect exact equality of quantities; a relative difference comparable to ","position":{"start":{"line":110,"column":1},"end":{"line":110,"column":1}},"key":"AuLM8R6uAa"},{"type":"inlineMath","value":"\\macheps","position":{"start":{"line":110,"column":1},"end":{"line":110,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsub\u003e\u003cmi\u003eϵ\u003c/mi\u003e\u003cmtext\u003emach\u003c/mtext\u003e\u003c/msub\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\macheps\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003eϵ\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3361em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord text mtight\"\u003e\u003cspan class=\"mord mtight\"\u003emach\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"lQshiINhAI"},{"type":"text","value":" is all we can look for.","position":{"start":{"line":110,"column":1},"end":{"line":110,"column":1}},"key":"Yi1iulJp21"}],"key":"J6DGpTnzSD"},{"type":"paragraph","position":{"start":{"line":112,"column":1},"end":{"line":112,"column":1}},"children":[{"type":"text","value":"By our definitions, the elements of ","position":{"start":{"line":112,"column":1},"end":{"line":112,"column":1}},"key":"bfvcGVN1Ob"},{"type":"inlineCode","value":"c","position":{"start":{"line":112,"column":1},"end":{"line":112,"column":1}},"key":"coBuaG8DDT"},{"type":"text","value":" are coefficients in descending-degree order for the interpolating polynomial. We can use the polynomial to estimate the population of China in 2005:","position":{"start":{"line":112,"column":1},"end":{"line":112,"column":1}},"key":"qoijQZVGhV"}],"key":"IkSi9Po5x8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"p = @(t) polyval(c, t - 1980);  % include the 1980 time shift\np(2005)","key":"iU83mptLJg"},{"type":"output","id":"SC5huZ2c6WjSxu6dgbFeC","data":[{"output_type":"execute_result","execution_count":7,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003eans = 1.3022e+03\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"ans = 1.3022e+03","content_type":"text/plain"}}}],"key":"KDK4VnSIL4"}],"data":{},"key":"gWeqxhBiui"},{"type":"paragraph","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"children":[{"type":"text","value":"The official population value for 2005 was 1303.72, so our result is rather good.","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"key":"PRf42LrVA4"}],"key":"F3PeN649Ax"},{"type":"grid","columns":[1,1,2,2],"children":[{"type":"paragraph","position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"children":[{"type":"text","value":"We can visualize the interpolation process. First, we plot the data as points.","position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"key":"K1GRdoOEAS"}],"key":"Y7izvIpImL"},{"type":"card","children":[{"type":"paragraph","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"key":"SFWP6PbBBC"},{"type":"inlineCode","value":"scatter","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"key":"kUxV0DGxvJ"},{"type":"text","value":" function creates a scatter plot of points; you can specify a line connecting the points as well.","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"key":"YULpCxmrNE"}],"key":"GC2paDmYu8"}],"key":"VNWO6PZ6fk"}],"indexEntries":[{"entry":"MATLAB","subEntry":{"value":"scatter","kind":"entry"},"emphasis":true}],"label":"index-qlMz21pG74","identifier":"index-qlmz21pg74","html_id":"index-qlmz21pg74","key":"cO4lnUqLc4"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"scatter(year, y)\nxlabel(\"years since 1980\")\nylabel(\"population (millions)\")\ntitle(\"Population of China\")","key":"cs3BZdbc0T"},{"type":"output","id":"fIYudZazf52OQ1CDdfZEU","data":[{"output_type":"execute_result","execution_count":8,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"ccbed32476f1ab2e08ce69c26e0e5ad8","path":"/fnc/build/ccbed32476f1ab2e08ce69c26e0e5ad8.png"}}}],"key":"R6S7VjRdEA"}],"data":{},"key":"Ni0AYKQ5pT"},{"type":"grid","columns":[1,1,2,2],"children":[{"type":"paragraph","position":{"start":{"line":141,"column":1},"end":{"line":141,"column":1}},"children":[{"type":"text","value":"We want to superimpose a plot of the polynomial. We do that by evaluating it at a vector of points in the interval.","position":{"start":{"line":141,"column":1},"end":{"line":141,"column":1}},"key":"ydD0Zk3sdK"}],"key":"Ix5HD57rfP"},{"type":"card","children":[{"type":"paragraph","position":{"start":{"line":143,"column":1},"end":{"line":143,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":143,"column":1},"end":{"line":143,"column":1}},"key":"p5TrmcXUSI"},{"type":"inlineCode","value":"linspace","position":{"start":{"line":143,"column":1},"end":{"line":143,"column":1}},"key":"pZJHZ8AVlP"},{"type":"text","value":" function constructs evenly spaced values given the endpoints and the number of values.","position":{"start":{"line":143,"column":1},"end":{"line":143,"column":1}},"key":"mDZwnq4714"}],"key":"bw39QF0FRt"}],"key":"zKpRWRTA9f"}],"indexEntries":[{"entry":"MATLAB","subEntry":{"value":"linspace","kind":"entry"},"emphasis":true}],"label":"index-ldkdhZUmiJ","identifier":"index-ldkdhzumij","html_id":"index-ldkdhzumij","key":"weoZKI2Xgc"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"tt = linspace(1980, 2015, 500);    % 500 times in the interval [1980, 2015]\nyy = p(tt);                        % evaluate p at all the vector elements\nyy(1:4)","key":"QhrpamToUL"},{"type":"output","id":"NEDRVnXg9T--DgwanQMIx","data":[{"output_type":"execute_result","execution_count":9,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003eans = 1×4 double\n  962.2388  963.9282  965.6118  967.2896\n\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"ans = 1×4 double\n  962.2388  963.9282  965.6118  967.2896\n","content_type":"text/plain"}}}],"key":"ERda7m0On2"}],"data":{},"key":"pnIY9tmo58"},{"type":"grid","columns":[1,1,2,2],"children":[{"type":"paragraph","position":{"start":{"line":157,"column":1},"end":{"line":157,"column":1}},"children":[{"type":"text","value":"Now we use ","position":{"start":{"line":157,"column":1},"end":{"line":157,"column":1}},"key":"lDCKVdPFpD"},{"type":"inlineCode","value":"plot!","position":{"start":{"line":157,"column":1},"end":{"line":157,"column":1}},"key":"toUStuAbfr"},{"type":"text","value":" to add to the current plot, rather than replacing it.","position":{"start":{"line":157,"column":1},"end":{"line":157,"column":1}},"key":"bvoJPsrxvO"}],"key":"Ene8iHH6wD"},{"type":"card","children":[{"type":"paragraph","position":{"start":{"line":159,"column":1},"end":{"line":159,"column":1}},"children":[{"type":"text","value":"Use ","position":{"start":{"line":159,"column":1},"end":{"line":159,"column":1}},"key":"nOTwh5aRL5"},{"type":"inlineCode","value":"hold on","position":{"start":{"line":159,"column":1},"end":{"line":159,"column":1}},"key":"yqqbXWj3Ax"},{"type":"text","value":" to add to an existing plot rather than replacing it.","position":{"start":{"line":159,"column":1},"end":{"line":159,"column":1}},"key":"B34yRfuWQW"}],"key":"nFA1lR0uqZ"},{"type":"paragraph","position":{"start":{"line":161,"column":1},"end":{"line":161,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":161,"column":1},"end":{"line":161,"column":1}},"key":"iX4sq4o6dr"},{"type":"inlineCode","value":"plot","position":{"start":{"line":161,"column":1},"end":{"line":161,"column":1}},"key":"y4cA3rwy7f"},{"type":"text","value":" function plots lines connecting the given ","position":{"start":{"line":161,"column":1},"end":{"line":161,"column":1}},"key":"jFoJVnvsFL"},{"type":"inlineMath","value":"x","position":{"start":{"line":161,"column":1},"end":{"line":161,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003ex\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003ex\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.4306em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003ex\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"sUxNbtw3fg"},{"type":"text","value":" and ","position":{"start":{"line":161,"column":1},"end":{"line":161,"column":1}},"key":"tB7AxpWiMd"},{"type":"inlineMath","value":"y","position":{"start":{"line":161,"column":1},"end":{"line":161,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003ey\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003ey\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003ey\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"zyUnlJLSsK"},{"type":"text","value":" values; you can also specify markers at the points.","position":{"start":{"line":161,"column":1},"end":{"line":161,"column":1}},"key":"WdXnG9lhsB"}],"key":"hJ6GMN4bti"}],"key":"xyK32iOl6R"}],"indexEntries":[{"entry":"MATLAB","subEntry":{"value":"hold on","kind":"entry"},"emphasis":true},{"entry":"MATLAB","subEntry":{"value":"plot","kind":"entry"},"emphasis":true}],"label":"index-AkVa5yiq2Q","identifier":"index-akva5yiq2q","html_id":"index-akva5yiq2q","key":"SXQf1AInKY"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"hold on \nplot(tt, yy)\nlegend(\"data\", \"interpolant\", \"location\", \"northwest\")","key":"WaHsk2nODN"},{"type":"output","id":"gM5Uktn1QFPSHcCMY0h01","data":[{"output_type":"execute_result","execution_count":10,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"1cb336d9a9119a228cf92a2089ea593c","path":"/fnc/build/1cb336d9a9119a228cf92a2089ea593c.png"}}}],"key":"lnh2INLPIp"}],"data":{},"key":"QixWcErHK0"}],"label":"demo-interp-vander-matlab","identifier":"demo-interp-vander-matlab","html_id":"demo-interp-vander-matlab","key":"iAaYrth1Dz"},{"type":"heading","depth":3,"position":{"start":{"line":172,"column":1},"end":{"line":172,"column":1}},"children":[{"type":"text","value":"Section 2.2","position":{"start":{"line":172,"column":1},"end":{"line":172,"column":1}},"key":"GriMsxnRxw"}],"identifier":"section-2-2","label":"Section 2.2","html_id":"section-2-2","implicit":true,"key":"HtvCWNyZAB"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Matrix operations","position":{"start":{"line":174,"column":1},"end":{"line":174,"column":1}},"key":"vyTQxr0FDj"}],"key":"MXlVdPcRGJ"},{"type":"grid","columns":[1,1,2,2],"children":[{"type":"paragraph","position":{"start":{"line":179,"column":1},"end":{"line":179,"column":1}},"children":[{"type":"text","value":"In MATLAB, every numerical value is treated like a matrix. A matrix with one row or one column is interpreted as a vector, and a ","position":{"start":{"line":179,"column":1},"end":{"line":179,"column":1}},"key":"GVWCSirCwq"},{"type":"inlineMath","value":"1\\times 1","position":{"start":{"line":179,"column":1},"end":{"line":179,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmn\u003e1\u003c/mn\u003e\u003cmo\u003e×\u003c/mo\u003e\u003cmn\u003e1\u003c/mn\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e1\\times 1\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e1\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e×\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6444em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e1\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"f1ml0teF1E"},{"type":"text","value":" matrix is interpreted as a scalar.","position":{"start":{"line":179,"column":1},"end":{"line":179,"column":1}},"key":"uS6DKayYp8"}],"key":"cdyv6b2j1k"},{"type":"paragraph","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"children":[{"type":"text","value":"Square brackets are used to enclose elements of a matrix or vector. Use spaces for horizontal concatenation, and semicolons or new lines to indicate vertical concatenation.","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"key":"j5rwE88tfG"}],"key":"EIv32uIiuN"},{"type":"card","children":[{"type":"paragraph","position":{"start":{"line":183,"column":1},"end":{"line":183,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":183,"column":1},"end":{"line":183,"column":1}},"key":"bjQyQmiuPF"},{"type":"inlineCode","value":"size","position":{"start":{"line":183,"column":1},"end":{"line":183,"column":1}},"key":"UqvORoO1ux"},{"type":"text","value":" function returns the number of rows and columns in a matrix. Use ","position":{"start":{"line":183,"column":1},"end":{"line":183,"column":1}},"key":"bgENhVo5Xz"},{"type":"inlineCode","value":"length","position":{"start":{"line":183,"column":1},"end":{"line":183,"column":1}},"key":"RGx7yo8n9l"},{"type":"text","value":" to get the number of elements in a vector or matrix.","position":{"start":{"line":183,"column":1},"end":{"line":183,"column":1}},"key":"abvYmtu0Kt"}],"key":"jyZYnOcs0R"}],"key":"YUhngTFmlz"}],"indexEntries":[{"entry":"MATLAB","subEntry":{"value":"size","kind":"entry"},"emphasis":true},{"entry":"MATLAB","subEntry":{"value":"length","kind":"entry"},"emphasis":true}],"label":"index-euiqAhC9Dd","identifier":"index-euiqahc9dd","html_id":"index-euiqahc9dd","key":"Q8d5L36Y1F"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A = [ \n    1       2      3             4      5; \n    50     40     30            20     10\n    pi sqrt(2) exp(1) (1+sqrt(5))/2 log(3) \n    ]","key":"pQd3KFCSbd"},{"type":"output","id":"ESKPCuH40A5GdUZtpcB8J","data":[{"output_type":"execute_result","execution_count":11,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003eA = 3×5 double\n    1.0000    2.0000    3.0000    4.0000    5.0000\n   50.0000   40.0000   30.0000   20.0000   10.0000\n    3.1416    1.4142    2.7183    1.6180    1.0986\n\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"A = 3×5 double\n    1.0000    2.0000    3.0000    4.0000    5.0000\n   50.0000   40.0000   30.0000   20.0000   10.0000\n    3.1416    1.4142    2.7183    1.6180    1.0986\n","content_type":"text/plain"}}}],"key":"ShJbjFlY8T"}],"data":{},"key":"UCftGG6wJR"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"m, n = size(A)","key":"WYnVD2wUIJ"},{"type":"output","id":"cFXSdDHTDacU3Ag5dhhKF","data":[{"output_type":"stream","name":"stderr","text":"Unrecognized function or variable 'm'."}],"key":"h2HFc1r4Gt"}],"data":{},"key":"e9QewfWfOr"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"x = [ 3, 3, 0, 1, 0 ];   % row vector\nsize(x)","key":"zhYZaUqj8r"},{"type":"output","id":"-0wl5U7Sjnie9OnzWFUoz","data":[{"output_type":"execute_result","execution_count":13,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003eans = 1×2 double\n     1     5\n\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"ans = 1×2 double\n     1     5\n","content_type":"text/plain"}}}],"key":"QTxDvpFqLh"}],"data":{},"key":"p2pRNXnVZ8"},{"type":"paragraph","position":{"start":{"line":205,"column":1},"end":{"line":205,"column":1}},"children":[{"type":"text","value":"Concatenated elements within brackets may be matrices or vectors for a block representation, as long as all the block sizes are compatible.","position":{"start":{"line":205,"column":1},"end":{"line":205,"column":1}},"key":"C76CyMGRjM"}],"key":"uOAY8ccPOR"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[ x  x ]","key":"LX06a1rdgh"},{"type":"output","id":"ZGKm9F02m_n9bYzYFzj7U","data":[{"output_type":"execute_result","execution_count":14,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003eans = 1×10 double\n     3     3     0     1     0     3     3     0     1     0\n\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"ans = 1×10 double\n     3     3     0     1     0     3     3     0     1     0\n","content_type":"text/plain"}}}],"key":"qbeb5qXsRp"}],"data":{},"key":"CPLVv9xPls"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[ x; x ]","key":"uoN2mOmSbf"},{"type":"output","id":"ldpS8IHpym4KtQp4r2cn7","data":[{"output_type":"execute_result","execution_count":15,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003eans = 2×5 double\n     3     3     0     1     0\n     3     3     0     1     0\n\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"ans = 2×5 double\n     3     3     0     1     0\n     3     3     0     1     0\n","content_type":"text/plain"}}}],"key":"A5JAVD8Fo0"}],"data":{},"key":"JQqRy6GSMU"},{"type":"paragraph","position":{"start":{"line":218,"column":1},"end":{"line":218,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":218,"column":1},"end":{"line":218,"column":1}},"key":"rykNm5K4RE"},{"type":"inlineCode","value":"zeros","position":{"start":{"line":218,"column":1},"end":{"line":218,"column":1}},"key":"POw31LldKV"},{"type":"text","value":" and ","position":{"start":{"line":218,"column":1},"end":{"line":218,"column":1}},"key":"Y8LGMu0giW"},{"type":"inlineCode","value":"ones","position":{"start":{"line":218,"column":1},"end":{"line":218,"column":1}},"key":"Vw5alxHh8J"},{"type":"text","value":" functions construct matrices with entries all zero or one, respectively.","position":{"start":{"line":218,"column":1},"end":{"line":218,"column":1}},"key":"wDzmjS1hny"}],"indexEntries":[{"entry":"MATLAB","subEntry":{"value":"zeros","kind":"entry"},"emphasis":true},{"entry":"MATLAB","subEntry":{"value":"ones","kind":"entry"},"emphasis":true}],"label":"index-sEeNFriUt8","identifier":"index-seenfriut8","html_id":"index-seenfriut8","key":"T4xWHb6U8c"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"B = [ zeros(3, 2) ones(3, 1) ]","key":"eFof5JheFX"},{"type":"output","id":"efoan_5928swMls4gImIj","data":[{"output_type":"execute_result","execution_count":16,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003eB = 3×3 double\n     0     0     1\n     0     0     1\n     0     0     1\n\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"B = 3×3 double\n     0     0     1\n     0     0     1\n     0     0     1\n","content_type":"text/plain"}}}],"key":"XUPDoLEilT"}],"data":{},"key":"PIDsMt8uRr"},{"type":"paragraph","position":{"start":{"line":227,"column":1},"end":{"line":227,"column":1}},"children":[{"type":"text","value":"A single quote ","position":{"start":{"line":227,"column":1},"end":{"line":227,"column":1}},"key":"P5CJnV2Xi8"},{"type":"inlineCode","value":"'","position":{"start":{"line":227,"column":1},"end":{"line":227,"column":1}},"key":"dcxNMMJ1nK"},{"type":"text","value":" after a matrix returns its adjoint. For real matrices, this is the transpose; for complex-valued matrices, the elements are also conjugated.","position":{"start":{"line":227,"column":1},"end":{"line":227,"column":1}},"key":"vlxDBoEUn4"}],"indexEntries":[{"entry":"MATLAB","subEntry":{"value":"transpose","kind":"entry"},"emphasis":true},{"entry":"MATLAB","subEntry":{"value":"adjoint","kind":"entry"},"emphasis":true},{"entry":"MATLAB","subEntry":{"value":"\\'","kind":"entry"},"emphasis":true}],"label":"index-sfie2X7OOW","identifier":"index-sfie2x7oow","html_id":"index-sfie2x7oow","key":"VF0C52g2L2"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A'","key":"s1wkdDojYC"},{"type":"output","id":"PrYyF5JP8l0Mfv7K4aD_S","data":[{"output_type":"execute_result","execution_count":17,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003eans = 5×3 double\n    1.0000   50.0000    3.1416\n    2.0000   40.0000    1.4142\n    3.0000   30.0000    2.7183\n    4.0000   20.0000    1.6180\n    5.0000   10.0000    1.0986\n\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"ans = 5×3 double\n    1.0000   50.0000    3.1416\n    2.0000   40.0000    1.4142\n    3.0000   30.0000    2.7183\n    4.0000   20.0000    1.6180\n    5.0000   10.0000    1.0986\n","content_type":"text/plain"}}}],"key":"UsXOJ6WdUp"}],"data":{},"key":"ujbQwEN588"},{"type":"paragraph","position":{"start":{"line":236,"column":1},"end":{"line":236,"column":1}},"children":[{"type":"text","value":"There are many convenient shorthand ways of building vectors and matrices other than entering all of their entries directly or in a loop. To get a range with evenly spaced entries between two endpoints, you have two options. One is to use a colon ","position":{"start":{"line":236,"column":1},"end":{"line":236,"column":1}},"key":"XkM0lCo7BL"},{"type":"inlineCode","value":":","position":{"start":{"line":236,"column":1},"end":{"line":236,"column":1}},"key":"J8lNPvod3G"},{"type":"text","value":".","position":{"start":{"line":236,"column":1},"end":{"line":236,"column":1}},"key":"SilSqv3mxK"}],"indexEntries":[{"entry":"MATLAB","subEntry":{"value":"linspace","kind":"entry"},"emphasis":true},{"entry":"MATLAB","subEntry":{"value":":","kind":"entry"},"emphasis":true}],"label":"index-uhmTU1vUdd","identifier":"index-uhmtu1vudd","html_id":"index-uhmtu1vudd","key":"P2M1iSrhv7"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"y = 1:4              % start:stop","key":"A7xUzATztu"},{"type":"output","id":"oIgYQqMSKO3f-lJZW83mP","data":[{"output_type":"execute_result","execution_count":18,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003ey = 1×4 double\n     1     2     3     4\n\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"y = 1×4 double\n     1     2     3     4\n","content_type":"text/plain"}}}],"key":"JrdCU1fDTg"}],"data":{},"key":"UnLSHVYjVW"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"z = 0:3:12           % start:step:stop","key":"qupRSn5Bfx"},{"type":"output","id":"hSiK9hANM_uO-0CjLFrf-","data":[{"output_type":"execute_result","execution_count":19,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003ez = 1×5 double\n     0     3     6     9    12\n\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"z = 1×5 double\n     0     3     6     9    12\n","content_type":"text/plain"}}}],"key":"ac70V8nuYw"}],"data":{},"key":"ZTNxnGr6yb"},{"type":"paragraph","position":{"start":{"line":246,"column":1},"end":{"line":246,"column":1}},"children":[{"type":"text","value":"Instead of specifying the step size, you can give the number of points in the range if you use ","position":{"start":{"line":246,"column":1},"end":{"line":246,"column":1}},"key":"kfVrZkLOwC"},{"type":"inlineCode","value":"linspace","position":{"start":{"line":246,"column":1},"end":{"line":246,"column":1}},"key":"nB724DttTp"},{"type":"text","value":".","position":{"start":{"line":246,"column":1},"end":{"line":246,"column":1}},"key":"rMkcqyCxoS"}],"key":"li350XCeOZ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"s = linspace(-1, 1, 5)    % row result","key":"SPyr6IXyI8"},{"type":"output","id":"gjB8myPNmcr2yu9rxm0oS","data":[{"output_type":"execute_result","execution_count":20,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003es = 1×5 double\n   -1.0000   -0.5000         0    0.5000    1.0000\n\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"s = 1×5 double\n   -1.0000   -0.5000         0    0.5000    1.0000\n","content_type":"text/plain"}}}],"key":"Mdl5TsMG7N"}],"data":{},"key":"SYwyPdWhbv"},{"type":"grid","columns":[1,1,2,2],"children":[{"type":"paragraph","position":{"start":{"line":256,"column":1},"end":{"line":256,"column":1}},"children":[{"type":"text","value":"Accessing an element is done by giving one (for a vector) or two (for a matrix) index values within parentheses.","position":{"start":{"line":256,"column":1},"end":{"line":256,"column":1}},"key":"obWZQ6ztFG"}],"key":"KiciO2x6jm"},{"type":"card","children":[{"type":"paragraph","position":{"start":{"line":258,"column":1},"end":{"line":258,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":258,"column":1},"end":{"line":258,"column":1}},"key":"JM9jzW4TAC"},{"type":"inlineCode","value":"end","position":{"start":{"line":258,"column":1},"end":{"line":258,"column":1}},"key":"I3E7qZgqjC"},{"type":"text","value":" keyword refers to the last element in a dimension. It saves you from having to compute and store the size of the matrix first.","position":{"start":{"line":258,"column":1},"end":{"line":258,"column":1}},"key":"QdEKzoS3NT"}],"key":"i0ZYFYdecy"}],"key":"mx8gpiIrdK"}],"indexEntries":[{"entry":"MATLAB","subEntry":{"value":"end","kind":"entry"},"emphasis":true},{"entry":"MATLAB","subEntry":{"value":"indexing arrays","kind":"entry"},"emphasis":true}],"label":"index-H5MXZevRrY","identifier":"index-h5mxzevrry","html_id":"index-h5mxzevrry","key":"UqTAcGksg4"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"a = A(2, end-1)","key":"XEGQ6GZJzX"},{"type":"output","id":"0rDt0d2Uf6xJfat8NACa3","data":[{"output_type":"execute_result","execution_count":21,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003ea = 20\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"a = 20","content_type":"text/plain"}}}],"key":"PPLtBMo9nK"}],"data":{},"key":"JzgrqbhjL6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"x(2)","key":"usgIW9hkFp"},{"type":"output","id":"p08sY5KW-OT_882R-k084","data":[{"output_type":"execute_result","execution_count":22,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003eans = 3\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"ans = 3","content_type":"text/plain"}}}],"key":"qy3CM8HNjm"}],"data":{},"key":"jeUP445si3"},{"type":"paragraph","position":{"start":{"line":269,"column":1},"end":{"line":269,"column":1}},"children":[{"type":"text","value":"The indices can be vectors or ranges, in which case a block of the matrix is accessed.","position":{"start":{"line":269,"column":1},"end":{"line":269,"column":1}},"key":"AZgYhbRqme"}],"key":"iuyCv0tr3M"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A(1:2, end-2:end)    % first two rows, last three columns","key":"WIcSZ462wf"},{"type":"output","id":"hxVdiyTHbdhn0Bgalg5v0","data":[{"output_type":"execute_result","execution_count":23,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003eans = 2×3 double\n     3     4     5\n    30    20    10\n\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"ans = 2×3 double\n     3     4     5\n    30    20    10\n","content_type":"text/plain"}}}],"key":"piXKOIkdNF"}],"data":{},"key":"Fg6mkorrlt"},{"type":"paragraph","position":{"start":{"line":278,"column":1},"end":{"line":278,"column":1}},"children":[{"type":"text","value":"If a dimension has only the index ","position":{"start":{"line":278,"column":1},"end":{"line":278,"column":1}},"key":"DPGFVNKo0m"},{"type":"inlineCode","value":":","position":{"start":{"line":278,"column":1},"end":{"line":278,"column":1}},"key":"XloNEBOMBa"},{"type":"text","value":" (a colon), then it refers to all the entries in that dimension of the matrix.","position":{"start":{"line":278,"column":1},"end":{"line":278,"column":1}},"key":"h1DGRP0zN2"}],"indexEntries":[{"entry":"MATLAB","subEntry":{"value":":","kind":"entry"},"emphasis":false}],"label":"index-scCJKqOoii","identifier":"index-sccjkqooii","html_id":"index-sccjkqooii","key":"D09zG1yQLF"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A(:, 1:2:end)        % all of the odd columns","key":"A3V9vMBTL1"},{"type":"output","id":"0UTYWJ0Ljo72GlD-CV3pH","data":[{"output_type":"execute_result","execution_count":24,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003eans = 3×3 double\n    1.0000    3.0000    5.0000\n   50.0000   30.0000   10.0000\n    3.1416    2.7183    1.0986\n\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"ans = 3×3 double\n    1.0000    3.0000    5.0000\n   50.0000   30.0000   10.0000\n    3.1416    2.7183    1.0986\n","content_type":"text/plain"}}}],"key":"DKpWVzpmhM"}],"data":{},"key":"EUkX0JJl43"},{"type":"grid","columns":[1,1,2,2],"children":[{"type":"paragraph","position":{"start":{"line":288,"column":1},"end":{"line":288,"column":1}},"children":[{"type":"text","value":"The matrix and vector senses of addition, subtraction, scalar multiplication, multiplication, and power are all handled by the usual symbols.","position":{"start":{"line":288,"column":1},"end":{"line":288,"column":1}},"key":"bcr3pEoLPh"}],"key":"UiDwtwvfDx"},{"type":"card","children":[{"type":"paragraph","position":{"start":{"line":290,"column":1},"end":{"line":290,"column":1}},"children":[{"type":"text","value":"Use ","position":{"start":{"line":290,"column":1},"end":{"line":290,"column":1}},"key":"q3NpMWFGWB"},{"type":"inlineCode","value":"diag","position":{"start":{"line":290,"column":1},"end":{"line":290,"column":1}},"key":"jeVugFrUzt"},{"type":"text","value":" to construct a matrix by its diagonals. A more general syntax puts elements on super- or subdiagonals.","position":{"start":{"line":290,"column":1},"end":{"line":290,"column":1}},"key":"fZc0Xj0IHS"}],"key":"O20bGqzojD"}],"key":"RRMo0ZoeCO"}],"indexEntries":[{"entry":"MATLAB","subEntry":{"value":"diag","kind":"entry"},"emphasis":true}],"label":"index-MYtuebptCY","identifier":"index-mytuebptcy","html_id":"index-mytuebptcy","key":"YV5gBvXe1Z"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"B = diag([-1, 0, -5])   % create a diagonal matrix","key":"pBkCfVpMsC"},{"type":"output","id":"pyISoqLNLR8aU73S-qp-s","data":[{"output_type":"execute_result","execution_count":25,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003eB = 3×3 double\n    -1     0     0\n     0     0     0\n     0     0    -5\n\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"B = 3×3 double\n    -1     0     0\n     0     0     0\n     0     0    -5\n","content_type":"text/plain"}}}],"key":"dqKLYaVPuX"}],"data":{},"key":"RR5ADhsM1N"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"size(A)\nsize(B)","key":"ZW7sWBa2p4"},{"type":"output","id":"4KsJ9xejsqsTFdd22vrQV","data":[{"output_type":"execute_result","execution_count":26,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003eans = 1×2 double\n     3     5\n\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"ans = 1×2 double\n     3     5\n","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":26,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003eans = 1×2 double\n     3     3\n\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"ans = 1×2 double\n     3     3\n","content_type":"text/plain"}}}],"key":"suTpaDym53"}],"data":{},"key":"TuecILwgee"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"BA = B * A     % matrix product","key":"W4wDfK9F9H"},{"type":"output","id":"iFD4RSEm6MYE9VFUt6Af5","data":[{"output_type":"execute_result","execution_count":27,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003eBA = 3×5 double\n   -1.0000   -2.0000   -3.0000   -4.0000   -5.0000\n         0         0         0         0         0\n  -15.7080   -7.0711  -13.5914   -8.0902   -5.4931\n\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"BA = 3×5 double\n   -1.0000   -2.0000   -3.0000   -4.0000   -5.0000\n         0         0         0         0         0\n  -15.7080   -7.0711  -13.5914   -8.0902   -5.4931\n","content_type":"text/plain"}}}],"key":"UwhFuRK2As"}],"data":{},"key":"G7OcuKsu9X"},{"type":"grid","columns":[1,1,2,2],"children":[{"type":"paragraph","position":{"start":{"line":308,"column":1},"end":{"line":308,"column":1}},"children":[{"type":"inlineCode","value":"A * B","position":{"start":{"line":308,"column":1},"end":{"line":308,"column":1}},"key":"NZy8Q4VF9u"},{"type":"text","value":" causes an error here, because the dimensions aren’t compatible.","position":{"start":{"line":308,"column":1},"end":{"line":308,"column":1}},"key":"cUn98y4LT6"}],"key":"nHhsBCqBxs"},{"type":"card","children":[{"type":"paragraph","position":{"start":{"line":310,"column":1},"end":{"line":310,"column":1}},"children":[{"type":"text","value":"Errors are formally called ","position":{"start":{"line":310,"column":1},"end":{"line":310,"column":1}},"key":"ocUxKApuah"},{"type":"emphasis","position":{"start":{"line":310,"column":1},"end":{"line":310,"column":1}},"children":[{"type":"text","value":"exceptions","position":{"start":{"line":310,"column":1},"end":{"line":310,"column":1}},"key":"hwdnomD8GJ"}],"key":"mP2k9z7jk4"},{"type":"text","value":" in Julia.","position":{"start":{"line":310,"column":1},"end":{"line":310,"column":1}},"key":"odIGl4762F"}],"key":"jaztyNpQpf"}],"key":"JhLFLNa8BO"}],"key":"JMJw8vPskC"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"A * B    % throws an error","visibility":"show","key":"pajhYRnny2"},{"type":"output","id":"MmftinqIpcxgJVeDGE3ql","data":[{"output_type":"stream","name":"stderr","text":"Error using *\nIncorrect dimensions for matrix multiplication. Check that the number of columns in the first matrix matches the number of rows in the second matrix. To operate on each element of the matrix individually, use TIMES (.*) for elementwise multiplication."}],"visibility":"show","key":"tfkeDapvmp"}],"data":{"tags":["raises-exception"]},"visibility":"show","key":"hREa0koSGG"},{"type":"paragraph","position":{"start":{"line":319,"column":1},"end":{"line":319,"column":1}},"children":[{"type":"text","value":"A square matrix raised to an integer power is the same as repeated matrix multiplication.","position":{"start":{"line":319,"column":1},"end":{"line":319,"column":1}},"key":"MRo17VQgg0"}],"key":"WNkea7VCSV"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"B^3    % same as B*B*B","key":"QQgt1cA5Bb"},{"type":"output","id":"MqVJLR0oDRpm71S-5PdNe","data":[{"output_type":"execute_result","execution_count":29,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003eans = 3×3 double\n    -1     0     0\n     0     0     0\n     0     0  -125\n\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"ans = 3×3 double\n    -1     0     0\n     0     0     0\n     0     0  -125\n","content_type":"text/plain"}}}],"key":"BaIbmSfEMK"}],"data":{},"key":"SLzVcw5JhG"},{"type":"paragraph","position":{"start":{"line":325,"column":1},"end":{"line":325,"column":1}},"children":[{"type":"text","value":"Sometimes one instead wants to treat a matrix or vector as a mere array and simply apply a single operation to each element of it. For multiplication, division, and power, the corresponding operators start with a dot.","position":{"start":{"line":325,"column":1},"end":{"line":325,"column":1}},"key":"TJavPeau1l"}],"key":"ZsLtMq0t26"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"C = -A;","key":"qT6tgRyGVq"},{"type":"output","id":"6_M5Tgm4ONb3TjaYL1yj1","data":[],"key":"JCpNGboNK3"}],"data":{},"key":"W1hjEf86wn"},{"type":"paragraph","position":{"start":{"line":331,"column":1},"end":{"line":331,"column":1}},"children":[{"type":"text","value":"Because both matrices are ","position":{"start":{"line":331,"column":1},"end":{"line":331,"column":1}},"key":"k6QP1n1j3M"},{"type":"inlineMath","value":"3\\times 5","position":{"start":{"line":331,"column":1},"end":{"line":331,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmn\u003e3\u003c/mn\u003e\u003cmo\u003e×\u003c/mo\u003e\u003cmn\u003e5\u003c/mn\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e3\\times 5\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e3\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e×\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6444em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e5\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"pfPixIM52S"},{"type":"text","value":", ","position":{"start":{"line":331,"column":1},"end":{"line":331,"column":1}},"key":"v6jIG79naa"},{"type":"inlineCode","value":"A * C","position":{"start":{"line":331,"column":1},"end":{"line":331,"column":1}},"key":"baIXxqf6a7"},{"type":"text","value":" would be an error here, but elementwise operations are fine.","position":{"start":{"line":331,"column":1},"end":{"line":331,"column":1}},"key":"SgqYAfgXPo"}],"key":"rwWTmtw5cz"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"elementwise = A .* C","key":"oNxXWlm1Z9"},{"type":"output","id":"LQhSvKWQC5WbZI2rpFPri","data":[{"output_type":"execute_result","execution_count":31,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003eelementwise = 3×5 double\n1.0e+03 *\n\n   -0.0010   -0.0040   -0.0090   -0.0160   -0.0250\n   -2.5000   -1.6000   -0.9000   -0.4000   -0.1000\n   -0.0099   -0.0020   -0.0074   -0.0026   -0.0012\n\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"elementwise = 3×5 double\n1.0e+03 *\n\n   -0.0010   -0.0040   -0.0090   -0.0160   -0.0250\n   -2.5000   -1.6000   -0.9000   -0.4000   -0.1000\n   -0.0099   -0.0020   -0.0074   -0.0026   -0.0012\n","content_type":"text/plain"}}}],"key":"XDQCkWvLJG"}],"data":{},"key":"QUFLXYP3QX"},{"type":"paragraph","position":{"start":{"line":340,"column":1},"end":{"line":340,"column":1}},"children":[{"type":"text","value":"The two operands of a dot operator have to have the same size—unless one is a scalar, in which case it is expanded or ","position":{"start":{"line":340,"column":1},"end":{"line":340,"column":1}},"key":"hn6IlpNCuA"},{"type":"emphasis","position":{"start":{"line":340,"column":1},"end":{"line":340,"column":1}},"children":[{"type":"text","value":"broadcast","position":{"start":{"line":340,"column":1},"end":{"line":340,"column":1}},"key":"rJHnQeAeR0"}],"key":"JPd9QO6cN6"},{"type":"text","value":" to be the same size as the other operand.","position":{"start":{"line":340,"column":1},"end":{"line":340,"column":1}},"key":"C4iydfyiTt"}],"indexEntries":[{"entry":"MATLAB","subEntry":{"value":"broadcasting","kind":"entry"},"emphasis":false}],"label":"index-XMeibenoMg","identifier":"index-xmeibenomg","html_id":"index-xmeibenomg","key":"QSvOY8B5GJ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"x_to_two = x .^ 2","key":"wrMlWM2YGj"},{"type":"output","id":"zffvLUHOBq4QfzuvMPd6B","data":[{"output_type":"execute_result","execution_count":32,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003ex_to_two = 1×5 double\n     9     9     0     1     0\n\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"x_to_two = 1×5 double\n     9     9     0     1     0\n","content_type":"text/plain"}}}],"key":"J7QiL2D9oC"}],"data":{},"key":"Lb7Y3eql4N"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"two_to_x = 2 .^ x","key":"XYaURJfs5q"},{"type":"output","id":"5-ggr0G5aVflFQ0J5mQ-s","data":[{"output_type":"execute_result","execution_count":33,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003etwo_to_x = 1×5 double\n     8     8     1     2     1\n\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"two_to_x = 1×5 double\n     8     8     1     2     1\n","content_type":"text/plain"}}}],"key":"dsY4o3Xyik"}],"data":{},"key":"fUK8JmOpzl"},{"type":"grid","columns":[1,1,2,2],"children":[{"type":"paragraph","position":{"start":{"line":351,"column":1},"end":{"line":351,"column":1}},"children":[{"type":"text","value":"Most of the mathematical functions, such as cos, sin, log, exp, and sqrt, can operate elementwise on vectors and matrices.","position":{"start":{"line":351,"column":1},"end":{"line":351,"column":1}},"key":"CUTYTl98HZ"}],"key":"xID4HOJTaD"}],"key":"FqfBvjQH8g"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"cos(pi * x)","key":"ZoIWc7btYK"},{"type":"output","id":"Cpo2eEkg5uhXviiu974pJ","data":[{"output_type":"execute_result","execution_count":34,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003eans = 1×5 double\n    -1    -1     1    -1     1\n\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"ans = 1×5 double\n    -1    -1     1    -1     1\n","content_type":"text/plain"}}}],"key":"O54djicE5o"}],"data":{},"key":"ZQZev9f88Z"}],"label":"demo-matrices-matlab","identifier":"demo-matrices-matlab","html_id":"demo-matrices-matlab","key":"XpgFvr6ONy"},{"type":"heading","depth":3,"position":{"start":{"line":359,"column":1},"end":{"line":359,"column":1}},"children":[{"type":"text","value":"Section 2.3","position":{"start":{"line":359,"column":1},"end":{"line":359,"column":1}},"key":"DchxRh3ExT"}],"identifier":"section-2-3","label":"Section 2.3","html_id":"section-2-3","implicit":true,"key":"TNMdtWkJVJ"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Solving linear systems","position":{"start":{"line":361,"column":1},"end":{"line":361,"column":1}},"key":"Hj9Bd5Pvqd"}],"key":"niP4oEsKkj"},{"type":"paragraph","position":{"start":{"line":362,"column":1},"end":{"line":362,"column":1}},"children":[{"type":"text","value":"For a square matrix ","position":{"start":{"line":362,"column":1},"end":{"line":362,"column":1}},"key":"Sv1vrNFf32"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":362,"column":1},"end":{"line":362,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi mathvariant=\"bold\"\u003eA\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\mathbf{A}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6861em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathbf\"\u003eA\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"b42Ob3UWug"},{"type":"text","value":", the syntax ","position":{"start":{"line":362,"column":1},"end":{"line":362,"column":1}},"key":"OQOfXL5eLR"},{"type":"inlineCode","value":"A \\ b","position":{"start":{"line":362,"column":1},"end":{"line":362,"column":1}},"key":"xiuthIWc6w"},{"type":"text","value":" is mathematically equivalent to ","position":{"start":{"line":362,"column":1},"end":{"line":362,"column":1}},"key":"kB5wfXpsbl"},{"type":"inlineMath","value":"\\mathbf{A}^{-1} \\mathbf{b}","position":{"start":{"line":362,"column":1},"end":{"line":362,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsup\u003e\u003cmi mathvariant=\"bold\"\u003eA\u003c/mi\u003e\u003cmrow\u003e\u003cmo\u003e−\u003c/mo\u003e\u003cmn\u003e1\u003c/mn\u003e\u003c/mrow\u003e\u003c/msup\u003e\u003cmi mathvariant=\"bold\"\u003eb\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\mathbf{A}^{-1} \\mathbf{b}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8141em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathbf\"\u003eA\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.8141em;\"\u003e\u003cspan style=\"top:-3.063em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e−\u003c/span\u003e\u003cspan class=\"mord mtight\"\u003e1\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mord mathbf\"\u003eb\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"waotNIJrL3"},{"type":"text","value":".","position":{"start":{"line":362,"column":1},"end":{"line":362,"column":1}},"key":"YwCoZ4QXOh"}],"key":"AhhOrXiOo4"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A = [1 0 -1; 2 2 1; -1 -3 0]","key":"wqjdOYA1Jp"},{"type":"output","id":"NkWGV1sQvHs8xpdcBvrQM","data":[{"output_type":"execute_result","execution_count":35,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003eA = 3×3 double\n     1     0    -1\n     2     2     1\n    -1    -3     0\n\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"A = 3×3 double\n     1     0    -1\n     2     2     1\n    -1    -3     0\n","content_type":"text/plain"}}}],"key":"razLmDnpGu"}],"data":{},"key":"vFzxYJu2jr"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"b = [1; 2; 3]","key":"p0QjAmrWrm"},{"type":"output","id":"9k_NM6jrWJ5SNr_dZK2MZ","data":[{"output_type":"execute_result","execution_count":36,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003eb = 3×1 double\n     1\n     2\n     3\n\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"b = 3×1 double\n     1\n     2\n     3\n","content_type":"text/plain"}}}],"key":"nmRZLZW95c"}],"data":{},"key":"azOgIhLh7w"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"x = A \\ b","key":"APEiKVEYYz"},{"type":"output","id":"fGpJTWJnM1yXfv79BJH4T","data":[{"output_type":"execute_result","execution_count":37,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003ex = 3×1 double\n    2.1429\n   -1.7143\n    1.1429\n\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"x = 3×1 double\n    2.1429\n   -1.7143\n    1.1429\n","content_type":"text/plain"}}}],"key":"QlWMM9stsG"}],"data":{},"key":"iFLjpLD39S"},{"type":"paragraph","position":{"start":{"line":379,"column":1},"end":{"line":379,"column":1}},"children":[{"type":"text","value":"One way to check the answer is to compute a quantity known as the ","position":{"start":{"line":379,"column":1},"end":{"line":379,"column":1}},"key":"pGU1RVAJZK"},{"type":"strong","position":{"start":{"line":379,"column":1},"end":{"line":379,"column":1}},"children":[{"type":"text","value":"residual","position":{"start":{"line":379,"column":1},"end":{"line":379,"column":1}},"key":"aMIIPEzOS6"}],"key":"Z1Zk7UMuNk"},{"type":"text","value":". It is (ideally) close to machine precision (relative to the elements in the data).","position":{"start":{"line":379,"column":1},"end":{"line":379,"column":1}},"key":"N7SamldJyC"}],"indexEntries":[{"entry":"residual","emphasis":false}],"label":"index-VhdQESR0OA","identifier":"index-vhdqesr0oa","html_id":"index-vhdqesr0oa","key":"jups7eGEK0"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"residual = b - A*x","key":"BjgjJELumJ"},{"type":"output","id":"60ZHtaozXW6HXZItEIRTe","data":[{"output_type":"execute_result","execution_count":38,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003eresidual = 3×1 double\n1.0e-15 *\n\n   -0.4441\n   -0.4441\n         0\n\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"residual = 3×1 double\n1.0e-15 *\n\n   -0.4441\n   -0.4441\n         0\n","content_type":"text/plain"}}}],"key":"DPHX3srRgA"}],"data":{},"key":"N7glqmggrr"},{"type":"paragraph","position":{"start":{"line":385,"column":1},"end":{"line":385,"column":1}},"children":[{"type":"text","value":"If the matrix ","position":{"start":{"line":385,"column":1},"end":{"line":385,"column":1}},"key":"ZCg36DWCZV"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":385,"column":1},"end":{"line":385,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi mathvariant=\"bold\"\u003eA\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\mathbf{A}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6861em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathbf\"\u003eA\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"PcgRq6WBJE"},{"type":"text","value":" is singular, you may get a warning and nonsense result.","position":{"start":{"line":385,"column":1},"end":{"line":385,"column":1}},"key":"RWhauZgxSO"}],"key":"zAR32GFXBO"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"A = [0 1; 0 0]\nb = [1; -1]\nx = A \\ b","visibility":"show","key":"ZktVeVCAoj"},{"type":"output","id":"DsrOAkptud3vRhL7JUYEm","data":[{"output_type":"execute_result","execution_count":39,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003eA = 2×2 double\n     0     1\n     0     0\n\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"A = 2×2 double\n     0     1\n     0     0\n","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":39,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003eb = 2×1 double\n     1\n    -1\n\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"b = 2×1 double\n     1\n    -1\n","content_type":"text/plain"}}},{"output_type":"stream","name":"stderr","text":"Warning: Matrix is singular to working precision."},{"output_type":"execute_result","execution_count":39,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003ex = 2×1 double\n   Inf\n  -Inf\n\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"x = 2×1 double\n   Inf\n  -Inf\n","content_type":"text/plain"}}}],"visibility":"show","key":"eUrgB3QpGF"}],"data":{"tags":["raises-exception"]},"visibility":"show","key":"xM7kwPVQAV"},{"type":"grid","columns":[1,1,2,2],"children":[{"type":"paragraph","position":{"start":{"line":395,"column":1},"end":{"line":395,"column":1}},"children":[{"type":"text","value":"In this case, we can check that the rank of ","position":{"start":{"line":395,"column":1},"end":{"line":395,"column":1}},"key":"O59YD8Z4oW"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":395,"column":1},"end":{"line":395,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi mathvariant=\"bold\"\u003eA\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\mathbf{A}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6861em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathbf\"\u003eA\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"Z5lz45VMhf"},{"type":"text","value":" is less than its number of columns, indicating singularity.","position":{"start":{"line":395,"column":1},"end":{"line":395,"column":1}},"key":"L4c25BYal3"}],"key":"i56QzJVO93"},{"type":"card","children":[{"type":"paragraph","position":{"start":{"line":397,"column":1},"end":{"line":397,"column":1}},"children":[{"type":"text","value":"The function ","position":{"start":{"line":397,"column":1},"end":{"line":397,"column":1}},"key":"wcL836cdN0"},{"type":"inlineCode","value":"rank","position":{"start":{"line":397,"column":1},"end":{"line":397,"column":1}},"key":"uJ8dWakuDT"},{"type":"text","value":" computes the rank of a matrix. However, it is numerically unstable for matrices that are nearly singular, in a sense to be defined in a later section.","position":{"start":{"line":397,"column":1},"end":{"line":397,"column":1}},"key":"tPEAeyj37E"}],"key":"WhGTnt7Iq1"}],"key":"G5g6by8Y6G"}],"key":"JrzyUPy9Ru"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"rank(A)","key":"GMFnGvGQG3"},{"type":"output","id":"blHLCTR9ukDdU5T-TEO7s","data":[{"output_type":"execute_result","execution_count":40,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003eans = 1\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"ans = 1","content_type":"text/plain"}}}],"key":"gNK7zQLF9f"}],"data":{},"key":"C6iEHP4JjD"},{"type":"paragraph","position":{"start":{"line":405,"column":1},"end":{"line":405,"column":1}},"children":[{"type":"text","value":"A linear system with a singular matrix might have no solution or infinitely many solutions, but in either case, backslash will fail. Moreover, detecting singularity is a lot like checking whether two floating-point numbers are ","position":{"start":{"line":405,"column":1},"end":{"line":405,"column":1}},"key":"fPzsCszXfQ"},{"type":"emphasis","position":{"start":{"line":405,"column":1},"end":{"line":405,"column":1}},"children":[{"type":"text","value":"exactly","position":{"start":{"line":405,"column":1},"end":{"line":405,"column":1}},"key":"kmLw47Xtv2"}],"key":"flWTGKlCPV"},{"type":"text","value":" equal: because of roundoff, it could be missed. In ","position":{"start":{"line":405,"column":1},"end":{"line":405,"column":1}},"key":"Y2B11Aueto"},{"type":"link","kind":"numref","identifier":"section-linsys-condition-number","label":"section-linsys-condition-number","url":"/condition-number","internal":true,"dataUrl":"/condition-number.json","children":[{"type":"text","value":"Conditioning of linear systems","key":"qazhWKeZEs"}],"key":"UTJyQFHFKh"},{"type":"text","value":" we’ll find a robust way to fully describe this situation.","position":{"start":{"line":405,"column":1},"end":{"line":405,"column":1}},"key":"E9uKX6lKT2"}],"key":"SZOgBMtWOX"}],"label":"demo-systems-backslash-matlab","identifier":"demo-systems-backslash-matlab","html_id":"demo-systems-backslash-matlab","key":"AzHtUvk2te"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Triangular systems of equations","position":{"start":{"line":409,"column":1},"end":{"line":409,"column":1}},"key":"ax498mjNMM"}],"key":"ss9044KW5q"},{"type":"grid","columns":[1,1,2,2],"children":[{"type":"paragraph","position":{"start":{"line":414,"column":1},"end":{"line":414,"column":1}},"children":[{"type":"text","value":"It’s easy to get just the lower triangular part of any matrix using the ","position":{"start":{"line":414,"column":1},"end":{"line":414,"column":1}},"key":"BQKaEhYUAJ"},{"type":"inlineCode","value":"tril","position":{"start":{"line":414,"column":1},"end":{"line":414,"column":1}},"key":"PXRzeIFfGf"},{"type":"text","value":" function.","position":{"start":{"line":414,"column":1},"end":{"line":414,"column":1}},"key":"lPLppXz3LN"}],"key":"HD6pBIoMHO"},{"type":"card","children":[{"type":"paragraph","position":{"start":{"line":416,"column":1},"end":{"line":416,"column":1}},"children":[{"type":"text","value":"Use ","position":{"start":{"line":416,"column":1},"end":{"line":416,"column":1}},"key":"JgJiXINjcM"},{"type":"inlineCode","value":"tril","position":{"start":{"line":416,"column":1},"end":{"line":416,"column":1}},"key":"TmnWkiwjD5"},{"type":"text","value":" to return a matrix that zeros out everything above the main diagonal. The ","position":{"start":{"line":416,"column":1},"end":{"line":416,"column":1}},"key":"yAMKzPGEym"},{"type":"inlineCode","value":"triu","position":{"start":{"line":416,"column":1},"end":{"line":416,"column":1}},"key":"NH7rsdXXAU"},{"type":"text","value":" function zeros out below the diagonal.","position":{"start":{"line":416,"column":1},"end":{"line":416,"column":1}},"key":"dQdclzsbDP"}],"key":"RdJHjoFfiM"}],"key":"b2jWH9m8I6"}],"indexEntries":[{"entry":"MATLAB","subEntry":{"value":"tril","kind":"entry"},"emphasis":true},{"entry":"MATLAB","subEntry":{"value":"triu","kind":"entry"},"emphasis":true}],"label":"index-AISFTDi11d","identifier":"index-aisftdi11d","html_id":"index-aisftdi11d","key":"ezMrPme35g"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A = randi(9, 5, 5);\nL = tril(A)","key":"qg4z6qixEI"},{"type":"output","id":"avYIUZk00IXVi0W2VprGV","data":[{"output_type":"execute_result","execution_count":41,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003eL = 5×5 double\n     9     0     0     0     0\n     9     8     0     0     0\n     8     7     7     0     0\n     3     3     4     2     0\n     9     6     1     4     2\n\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"L = 5×5 double\n     9     0     0     0     0\n     9     8     0     0     0\n     8     7     7     0     0\n     3     3     4     2     0\n     9     6     1     4     2\n","content_type":"text/plain"}}}],"key":"KtMMinId0T"}],"data":{},"key":"AECJ6s3WlG"},{"type":"paragraph","position":{"start":{"line":425,"column":1},"end":{"line":425,"column":1}},"children":[{"type":"text","value":"We’ll set up and solve a linear system with this matrix.","position":{"start":{"line":425,"column":1},"end":{"line":425,"column":1}},"key":"NW0qNoOsSN"}],"key":"rkTurezbqU"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"b = ones(5);\nx = forwardsub(L, b)","key":"UK83mfwHDi"},{"type":"output","id":"HOyPSxaZxHMoKAYFEtuKC","data":[{"output_type":"execute_result","execution_count":42,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003ex = 5×1 double\n    0.1111\n         0\n    0.0159\n    0.3016\n   -0.6111\n\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"x = 5×1 double\n    0.1111\n         0\n    0.0159\n    0.3016\n   -0.6111\n","content_type":"text/plain"}}}],"key":"mWDP5R4pGg"}],"data":{},"key":"m8v0GYKdIk"},{"type":"paragraph","position":{"start":{"line":435,"column":1},"end":{"line":435,"column":1}},"children":[{"type":"text","value":"It’s not clear how accurate this answer is. However, the residual should be zero or comparable to ","position":{"start":{"line":435,"column":1},"end":{"line":435,"column":1}},"key":"nX9wiMeHVu"},{"type":"inlineMath","value":"\\macheps","position":{"start":{"line":435,"column":1},"end":{"line":435,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsub\u003e\u003cmi\u003eϵ\u003c/mi\u003e\u003cmtext\u003emach\u003c/mtext\u003e\u003c/msub\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\macheps\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003eϵ\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3361em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord text mtight\"\u003e\u003cspan class=\"mord mtight\"\u003emach\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"Va8why6ACX"},{"type":"text","value":".","position":{"start":{"line":435,"column":1},"end":{"line":435,"column":1}},"key":"mck3ecVCx8"}],"indexEntries":[{"entry":"residual","emphasis":false}],"label":"index-BF38DthUA4","identifier":"index-bf38dthua4","html_id":"index-bf38dthua4","key":"o8UKij7kJA"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"b - L * x","key":"xzBv37pykf"},{"type":"output","id":"Yvofd0naly-wT5E0x-9Ho","data":[{"output_type":"execute_result","execution_count":43,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003eans = 5×5 double\n     0     0     0     0     0\n     0     0     0     0     0\n     0     0     0     0     0\n     0     0     0     0     0\n     0     0     0     0     0\n\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"ans = 5×5 double\n     0     0     0     0     0\n     0     0     0     0     0\n     0     0     0     0     0\n     0     0     0     0     0\n     0     0     0     0     0\n","content_type":"text/plain"}}}],"key":"Z6paTIL8QH"}],"data":{},"key":"CyUqbcAtqY"},{"type":"grid","columns":[1,1,2,2],"children":[{"type":"paragraph","position":{"start":{"line":445,"column":1},"end":{"line":445,"column":1}},"children":[{"type":"text","value":"Next, we’ll engineer a problem to which we know the exact answer.","position":{"start":{"line":445,"column":1},"end":{"line":445,"column":1}},"key":"jYeCwUcha7"}],"key":"hIUo8ulRzS"},{"type":"card","children":[{"type":"paragraph","position":{"start":{"line":447,"column":1},"end":{"line":447,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":447,"column":1},"end":{"line":447,"column":1}},"key":"s8LAPzZzDQ"},{"type":"inlineCode","value":"eye","position":{"start":{"line":447,"column":1},"end":{"line":447,"column":1}},"key":"MFUguf8z6m"},{"type":"text","value":" function creates an identity matrix. The ","position":{"start":{"line":447,"column":1},"end":{"line":447,"column":1}},"key":"kfzji2PyF5"},{"type":"inlineCode","value":"diag","position":{"start":{"line":447,"column":1},"end":{"line":447,"column":1}},"key":"cZ8sFw2LL3"},{"type":"text","value":" function uses 0 as the main diagonal, positive integers as superdiagonals, and negative integers as subdiagonals.","position":{"start":{"line":447,"column":1},"end":{"line":447,"column":1}},"key":"dOmijAlAZC"}],"key":"bsJlG9WBbr"}],"key":"ZoXjo9Hl40"}],"indexEntries":[{"entry":"MATLAB","subEntry":{"value":"diag","kind":"entry"},"emphasis":true},{"entry":"MATLAB","subEntry":{"value":"eye","kind":"entry"},"emphasis":true}],"label":"index-Dn7u66lk7r","identifier":"index-dn7u66lk7r","html_id":"index-dn7u66lk7r","key":"a6f5ozC3Mm"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"alpha = 0.3;\nbeta = 2.2;\nU = eye(5) + diag([-1 -1 -1 -1], 1);\nU(1, [4, 5]) = [alpha - beta, beta]","key":"wthNIVrATk"},{"type":"output","id":"E2AgbvY04kizINqmzFJT2","data":[{"output_type":"execute_result","execution_count":44,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003eU = 5×5 double\n    1.0000   -1.0000         0   -1.9000    2.2000\n         0    1.0000   -1.0000         0         0\n         0         0    1.0000   -1.0000         0\n         0         0         0    1.0000   -1.0000\n         0         0         0         0    1.0000\n\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"U = 5×5 double\n    1.0000   -1.0000         0   -1.9000    2.2000\n         0    1.0000   -1.0000         0         0\n         0         0    1.0000   -1.0000         0\n         0         0         0    1.0000   -1.0000\n         0         0         0         0    1.0000\n","content_type":"text/plain"}}}],"key":"IlOn1a9Oyn"}],"data":{},"key":"A6eZtoPJwp"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"x_exact = ones(5);\nb = [alpha; 0; 0; 0; 1];","key":"lMIyhwOqCa"},{"type":"output","id":"mFqA5kua-MQ_FRi7ACNFn","data":[],"key":"YDeCbt4WCN"}],"data":{},"key":"j0JRt0HLBq"},{"type":"paragraph","position":{"start":{"line":463,"column":1},"end":{"line":463,"column":1}},"children":[{"type":"text","value":"Now we use backward substitution to solve for ","position":{"start":{"line":463,"column":1},"end":{"line":463,"column":1}},"key":"rMkXRlPEc2"},{"type":"inlineMath","value":"\\mathbf{x}","position":{"start":{"line":463,"column":1},"end":{"line":463,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi mathvariant=\"bold\"\u003ex\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\mathbf{x}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.4444em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathbf\"\u003ex\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"uoQxlKI56e"},{"type":"text","value":", and compare to the exact solution we know already.","position":{"start":{"line":463,"column":1},"end":{"line":463,"column":1}},"key":"ftl4BEjMpr"}],"key":"FbHpRaW5rn"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"x = backsub(U, b);\nerr = x - x_exact","key":"cE8oNgDIJi"},{"type":"output","id":"FBo0gDawWkiolb3-PuPzq","data":[{"output_type":"execute_result","execution_count":46,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003eerr = 5×5 double\n     0     0     0     0     0\n     0     0     0     0     0\n     0     0     0     0     0\n     0     0     0     0     0\n     0     0     0     0     0\n\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"err = 5×5 double\n     0     0     0     0     0\n     0     0     0     0     0\n     0     0     0     0     0\n     0     0     0     0     0\n     0     0     0     0     0\n","content_type":"text/plain"}}}],"key":"JHafnLC4FA"}],"data":{},"key":"dM0wRqaiLH"},{"type":"paragraph","position":{"start":{"line":470,"column":1},"end":{"line":470,"column":1}},"children":[{"type":"text","value":"Everything seems OK here. But another example, with a different value for ","position":{"start":{"line":470,"column":1},"end":{"line":470,"column":1}},"key":"ILcWM9gVbD"},{"type":"text","value":"β","position":{"start":{"line":470,"column":1},"end":{"line":470,"column":1}},"key":"s2ZiaPzgTK"},{"type":"text","value":", is more troubling.","position":{"start":{"line":470,"column":1},"end":{"line":470,"column":1}},"key":"SBUABVZhNe"}],"key":"pTcbklXkZz"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"alpha = 0.3;\nbeta = 1e12;\nU = eye(5) + diag([-1 -1 -1 -1], 1);\nU(1, [4, 5]) = [alpha - beta, beta];\nb = [alpha; 0; 0; 0; 1];\n\nx = backsub(U, b);\nerr = x - x_exact","key":"rw4gTXXwor"},{"type":"output","id":"f2uFfo_Nj42rhRIjoIuRl","data":[{"output_type":"execute_result","execution_count":47,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003eerr = 5×5 double\n1.0e-04 *\n\n   -0.4883   -0.4883   -0.4883   -0.4883   -0.4883\n         0         0         0         0         0\n         0         0         0         0         0\n         0         0         0         0         0\n         0         0         0         0         0\n\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"err = 5×5 double\n1.0e-04 *\n\n   -0.4883   -0.4883   -0.4883   -0.4883   -0.4883\n         0         0         0         0         0\n         0         0         0         0         0\n         0         0         0         0         0\n         0         0         0         0         0\n","content_type":"text/plain"}}}],"key":"tXwgmqRwEB"}],"data":{},"key":"zBbiu61idW"},{"type":"paragraph","position":{"start":{"line":483,"column":1},"end":{"line":483,"column":1}},"children":[{"type":"text","value":"It’s not so good to get 4 digits of accuracy after starting with sixteen! The source of the error is not hard to track down. Solving for ","position":{"start":{"line":483,"column":1},"end":{"line":483,"column":1}},"key":"AMkzDtrBWG"},{"type":"inlineMath","value":"x_1","position":{"start":{"line":483,"column":1},"end":{"line":483,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsub\u003e\u003cmi\u003ex\u003c/mi\u003e\u003cmn\u003e1\u003c/mn\u003e\u003c/msub\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003ex_1\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003ex\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3011em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e1\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"BjIpfy58D0"},{"type":"text","value":" performs ","position":{"start":{"line":483,"column":1},"end":{"line":483,"column":1}},"key":"BuD3t4Cqg4"},{"type":"inlineMath","value":"(\\alpha-\\beta)+\\beta","position":{"start":{"line":483,"column":1},"end":{"line":483,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmi\u003eα\u003c/mi\u003e\u003cmo\u003e−\u003c/mo\u003e\u003cmi\u003eβ\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003cmo\u003e+\u003c/mo\u003e\u003cmi\u003eβ\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e(\\alpha-\\beta)+\\beta\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.0037em;\"\u003eα\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e−\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.05278em;\"\u003eβ\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e+\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.05278em;\"\u003eβ\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"v2gd5kCKak"},{"type":"text","value":" in the first row. Since ","position":{"start":{"line":483,"column":1},"end":{"line":483,"column":1}},"key":"Ih99uRqvIB"},{"type":"inlineMath","value":"|\\alpha|","position":{"start":{"line":483,"column":1},"end":{"line":483,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi mathvariant=\"normal\"\u003e∣\u003c/mi\u003e\u003cmi\u003eα\u003c/mi\u003e\u003cmi mathvariant=\"normal\"\u003e∣\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e|\\alpha|\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e∣\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.0037em;\"\u003eα\u003c/span\u003e\u003cspan class=\"mord\"\u003e∣\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"hdYxBwz6Jy"},{"type":"text","value":" is so much smaller than ","position":{"start":{"line":483,"column":1},"end":{"line":483,"column":1}},"key":"BiL8SGpqII"},{"type":"inlineMath","value":"|\\beta|","position":{"start":{"line":483,"column":1},"end":{"line":483,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi mathvariant=\"normal\"\u003e∣\u003c/mi\u003e\u003cmi\u003eβ\u003c/mi\u003e\u003cmi mathvariant=\"normal\"\u003e∣\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e|\\beta|\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e∣\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.05278em;\"\u003eβ\u003c/span\u003e\u003cspan class=\"mord\"\u003e∣\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"gbPKNWeoQW"},{"type":"text","value":", this a recipe for losing digits to subtractive cancellation.","position":{"start":{"line":483,"column":1},"end":{"line":483,"column":1}},"key":"jFGjxMYTk7"}],"key":"fJirvPUCQV"}],"label":"demo-systems-triangular-matlab","identifier":"demo-systems-triangular-matlab","html_id":"demo-systems-triangular-matlab","key":"slolVx7DEr"},{"type":"heading","depth":3,"position":{"start":{"line":485,"column":1},"end":{"line":485,"column":1}},"children":[{"type":"text","value":"Section 2.4","position":{"start":{"line":485,"column":1},"end":{"line":485,"column":1}},"key":"QsqnP7VwdG"}],"identifier":"section-2-4","label":"Section 2.4","html_id":"section-2-4","implicit":true,"key":"j5nmlBxOu7"},{"type":"details","open":false,"children":[{"type":"summary","children":[{"type":"text","value":"Triangular outer products","position":{"start":{"line":487,"column":1},"end":{"line":487,"column":1}},"key":"zxT5OL1LV7"}],"key":"yg0J4sNmVI"},{"type":"paragraph","position":{"start":{"line":492,"column":1},"end":{"line":492,"column":1}},"children":[{"type":"text","value":"We explore the outer product formula for two random triangular matrices.","position":{"start":{"line":492,"column":1},"end":{"line":492,"column":1}},"key":"YQ9q1Ir23i"}],"indexEntries":[{"entry":"MATLAB","subEntry":{"value":"tril","kind":"entry"},"emphasis":false},{"entry":"MATLAB","subEntry":{"value":"triu","kind":"entry"},"emphasis":false}],"label":"index-wHsvNiCjJd","identifier":"index-whsvnicjjd","html_id":"index-whsvnicjjd","key":"nNLRKoBlZG"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"L = tril( randi(9, 3, 3) )","key":"fyNd4uGVWl"},{"type":"output","id":"qji9J4mFRz_BvegS0zxH1","data":[{"output_type":"execute_result","execution_count":48,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003eL = 3×3 double\n     5     0     0\n     4     9     0\n     8     4     2\n\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"L = 3×3 double\n     5     0     0\n     4     9     0\n     8     4     2\n","content_type":"text/plain"}}}],"key":"GahztX2tWO"}],"data":{},"key":"OqQDOTrV6m"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"U = triu( randi(9, 3, 3) )","key":"QRXkJZz1In"},{"type":"output","id":"FAv9KwuaizVUHsltP2gZT","data":[{"output_type":"execute_result","execution_count":49,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003eU = 3×3 double\n     5     4     1\n     0     8     4\n     0     0     1\n\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"U = 3×3 double\n     5     4     1\n     0     8     4\n     0     0     1\n","content_type":"text/plain"}}}],"key":"OVw1SnD8ph"}],"data":{},"key":"UXD36Ar7pU"},{"type":"paragraph","position":{"start":{"line":502,"column":1},"end":{"line":502,"column":1}},"children":[{"type":"text","value":"Here are the three outer products in the sum in ","position":{"start":{"line":502,"column":1},"end":{"line":502,"column":1}},"key":"guhwfO2q5q"},{"type":"crossReference","kind":"equation","identifier":"matrixouter","label":"matrixouter","children":[{"type":"text","value":"(","key":"YXAjlUkFc0"},{"type":"text","value":"2.4.4","key":"fp8QzUQMNy"},{"type":"text","value":")","key":"cmj9mUYQBj"}],"template":"(%s)","enumerator":"2.4.4","resolved":true,"html_id":"matrixouter","remote":true,"url":"/lu","dataUrl":"/lu.json","key":"QybGZA7Eh2"},{"type":"text","value":":","position":{"start":{"line":502,"column":1},"end":{"line":502,"column":1}},"key":"HQy1psYivL"}],"key":"Dh2YSCX1tc"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"L(:, 1) * U(1, :)","key":"DPpTmhbMpS"},{"type":"output","id":"NeKI3fb97v0CCrv_2V939","data":[{"output_type":"execute_result","execution_count":50,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003eans = 3×3 double\n    25    20     5\n    20    16     4\n    40    32     8\n\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"ans = 3×3 double\n    25    20     5\n    20    16     4\n    40    32     8\n","content_type":"text/plain"}}}],"key":"pvKeONFnpa"}],"data":{},"key":"yxVLGaPMsq"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"L(:, 2) * U(2, :)","key":"Gv2f19iyDr"},{"type":"output","id":"u1jjesiKxTDAw0u_3cNoy","data":[{"output_type":"execute_result","execution_count":51,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003eans = 3×3 double\n     0     0     0\n     0    72    36\n     0    32    16\n\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"ans = 3×3 double\n     0     0     0\n     0    72    36\n     0    32    16\n","content_type":"text/plain"}}}],"key":"agnMrK776m"}],"data":{},"key":"MscjM8TjBQ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"L(:, 3) * U(3, :)","key":"xR7bosOM1m"},{"type":"output","id":"0t48mOC9bv9-pyI0Bgc7Y","data":[{"output_type":"execute_result","execution_count":52,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003eans = 3×3 double\n     0     0     0\n     0     0     0\n     0     0     2\n\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"ans = 3×3 double\n     0     0     0\n     0     0     0\n     0     0     2\n","content_type":"text/plain"}}}],"key":"tZC1xedE2Q"}],"data":{},"key":"LP2WdA43Vn"},{"type":"paragraph","position":{"start":{"line":516,"column":1},"end":{"line":516,"column":1}},"children":[{"type":"text","value":"Simply because of the triangular zero structures, only the first outer product contributes to the first row and first column of the entire product.","position":{"start":{"line":516,"column":1},"end":{"line":516,"column":1}},"key":"Z3bleJRFMQ"}],"key":"HCdb9N1v5D"}],"label":"demo-lu-outertri-matlab","identifier":"demo-lu-outertri-matlab","html_id":"demo-lu-outertri-matlab","key":"LJorRGK6Tf"},{"type":"details","children":[{"type":"summary","children":[{"type":"abbreviation","title":"lower triangular times upper triangular","children":[{"type":"text","value":"LU","key":"BbNauRn7f2"}],"key":"zOB0Xgc1mO"},{"type":"text","value":" factorization","key":"aAJCh2qAhg"}],"key":"NKlOPvLF0B"},{"type":"paragraph","position":{"start":{"line":521,"column":1},"end":{"line":521,"column":1}},"children":[{"type":"text","value":"For illustration, we work on a ","position":{"start":{"line":521,"column":1},"end":{"line":521,"column":1}},"key":"LfQp84B9ZS"},{"type":"inlineMath","value":"4 \\times 4","position":{"start":{"line":521,"column":1},"end":{"line":521,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmn\u003e4\u003c/mn\u003e\u003cmo\u003e×\u003c/mo\u003e\u003cmn\u003e4\u003c/mn\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e4 \\times 4\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e4\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e×\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6444em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e4\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"BVl6pMAYUt"},{"type":"text","value":" matrix. We name it with a subscript in preparation for what comes.","position":{"start":{"line":521,"column":1},"end":{"line":521,"column":1}},"key":"OOCasSQKm6"}],"key":"wL0Wb5QiC3"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A_1 = [\n     2    0    4     3 \n    -4    5   -7   -10 \n     1   15    2   -4.5\n    -2    0    2   -13\n    ];\nL = eye(4);\nU = zeros(4, 4);","key":"JhDMWoCQdw"},{"type":"output","id":"WTr2qFtennDqp2-sv7cej","data":[],"key":"t62tHPD4BL"}],"data":{},"key":"NXagi0sKGj"},{"type":"paragraph","position":{"start":{"line":534,"column":1},"end":{"line":534,"column":1}},"children":[{"type":"text","value":"Now we appeal to ","position":{"start":{"line":534,"column":1},"end":{"line":534,"column":1}},"key":"XscXbnmV1G"},{"type":"crossReference","kind":"equation","identifier":"outer-row1","label":"outer-row1","children":[{"type":"text","value":"(","key":"y853JJOXsJ"},{"type":"text","value":"2.4.5","key":"m4A2KwCwRU"},{"type":"text","value":")","key":"IOEmAw2xl1"}],"template":"(%s)","enumerator":"2.4.5","resolved":true,"html_id":"outer-row1","remote":true,"url":"/lu","dataUrl":"/lu.json","key":"BsAStGV6eX"},{"type":"text","value":". Since ","position":{"start":{"line":534,"column":1},"end":{"line":534,"column":1}},"key":"nscKF2SYw2"},{"type":"inlineMath","value":"L_{11}=1","position":{"start":{"line":534,"column":1},"end":{"line":534,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsub\u003e\u003cmi\u003eL\u003c/mi\u003e\u003cmn\u003e11\u003c/mn\u003e\u003c/msub\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmn\u003e1\u003c/mn\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003eL_{11}=1\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003eL\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3011em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e11\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6444em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e1\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"QfZpWzZsO7"},{"type":"text","value":", we see that the first row of ","position":{"start":{"line":534,"column":1},"end":{"line":534,"column":1}},"key":"zjflln2VzQ"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":534,"column":1},"end":{"line":534,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi mathvariant=\"bold\"\u003eU\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\mathbf{U}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6861em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathbf\"\u003eU\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"BmJC5ARsKd"},{"type":"text","value":" is just the first row of ","position":{"start":{"line":534,"column":1},"end":{"line":534,"column":1}},"key":"IKVmkCMShe"},{"type":"inlineMath","value":"\\mathbf{A}_1","position":{"start":{"line":534,"column":1},"end":{"line":534,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsub\u003e\u003cmi mathvariant=\"bold\"\u003eA\u003c/mi\u003e\u003cmn\u003e1\u003c/mn\u003e\u003c/msub\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\mathbf{A}_1\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8361em;vertical-align:-0.15em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathbf\"\u003eA\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3011em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e1\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"HBGroIAo51"},{"type":"text","value":".","position":{"start":{"line":534,"column":1},"end":{"line":534,"column":1}},"key":"Cf8Xtyoztg"}],"key":"wD2qC0C4sJ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"U(1, :) = A_1(1, :)","key":"GVEAlOyd1g"},{"type":"output","id":"bEvfsYIl_NOh7tiYM7VnF","data":[{"output_type":"execute_result","execution_count":54,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003eU = 4×4 double\n     2     0     4     3\n     0     0     0     0\n     0     0     0     0\n     0     0     0     0\n\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"U = 4×4 double\n     2     0     4     3\n     0     0     0     0\n     0     0     0     0\n     0     0     0     0\n","content_type":"text/plain"}}}],"key":"Dk7AdVhK0H"}],"data":{},"key":"RChF0fT5ob"},{"type":"paragraph","position":{"start":{"line":540,"column":1},"end":{"line":540,"column":1}},"children":[{"type":"text","value":"From ","position":{"start":{"line":540,"column":1},"end":{"line":540,"column":1}},"key":"FGi4e7X6Jn"},{"type":"crossReference","kind":"equation","identifier":"outer-col1","label":"outer-col1","children":[{"type":"text","value":"(","key":"D222JYl7nD"},{"type":"text","value":"2.4.6","key":"IXATWs05y2"},{"type":"text","value":")","key":"P47VTIePxn"}],"template":"(%s)","enumerator":"2.4.6","resolved":true,"html_id":"outer-col1","remote":true,"url":"/lu","dataUrl":"/lu.json","key":"DFgxnD8K5y"},{"type":"text","value":", we see that we can find the first column of ","position":{"start":{"line":540,"column":1},"end":{"line":540,"column":1}},"key":"Dn0j2NNVXI"},{"type":"inlineMath","value":"\\mathbf{L}","position":{"start":{"line":540,"column":1},"end":{"line":540,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi mathvariant=\"bold\"\u003eL\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\mathbf{L}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6861em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathbf\"\u003eL\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"egMG1YBnx3"},{"type":"text","value":" from the first column of ","position":{"start":{"line":540,"column":1},"end":{"line":540,"column":1}},"key":"Dw4XVlzzmh"},{"type":"inlineMath","value":"\\mathbf{A}_1","position":{"start":{"line":540,"column":1},"end":{"line":540,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsub\u003e\u003cmi mathvariant=\"bold\"\u003eA\u003c/mi\u003e\u003cmn\u003e1\u003c/mn\u003e\u003c/msub\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\mathbf{A}_1\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8361em;vertical-align:-0.15em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathbf\"\u003eA\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3011em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e1\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"WB4JaqmXQp"},{"type":"text","value":".","position":{"start":{"line":540,"column":1},"end":{"line":540,"column":1}},"key":"qyp3omaaP7"}],"key":"S6NiJI6mu7"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"L(:, 1) = A_1(:, 1) / U(1, 1)","key":"S3sS6CckdP"},{"type":"output","id":"AWr_b4uYwDNAgclZ7coK8","data":[{"output_type":"execute_result","execution_count":55,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003eL = 4×4 double\n    1.0000         0         0         0\n   -2.0000    1.0000         0         0\n    0.5000         0    1.0000         0\n   -1.0000         0         0    1.0000\n\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"L = 4×4 double\n    1.0000         0         0         0\n   -2.0000    1.0000         0         0\n    0.5000         0    1.0000         0\n   -1.0000         0         0    1.0000\n","content_type":"text/plain"}}}],"key":"kwqseyfieW"}],"data":{},"key":"OaJQ8LyNUh"},{"type":"paragraph","position":{"start":{"line":546,"column":1},"end":{"line":546,"column":1}},"children":[{"type":"text","value":"We have obtained the first term in the sum ","position":{"start":{"line":546,"column":1},"end":{"line":546,"column":1}},"key":"ty5hFdRruL"},{"type":"crossReference","kind":"equation","identifier":"matrixouter","label":"matrixouter","children":[{"type":"text","value":"(","key":"eeuXuuCEHi"},{"type":"text","value":"2.4.4","key":"kHZVWbhNPN"},{"type":"text","value":")","key":"Xq45QmFv6i"}],"template":"(%s)","enumerator":"2.4.4","resolved":true,"html_id":"matrixouter","remote":true,"url":"/lu","dataUrl":"/lu.json","key":"VrOTIncfKA"},{"type":"text","value":" for ","position":{"start":{"line":546,"column":1},"end":{"line":546,"column":1}},"key":"mj0PETdRkY"},{"type":"inlineMath","value":"\\mathbf{L}\\mathbf{U}","position":{"start":{"line":546,"column":1},"end":{"line":546,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi mathvariant=\"bold\"\u003eL\u003c/mi\u003e\u003cmi mathvariant=\"bold\"\u003eU\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\mathbf{L}\\mathbf{U}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6861em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathbf\"\u003eLU\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"RDSqVnt31o"},{"type":"text","value":", and we subtract it away from ","position":{"start":{"line":546,"column":1},"end":{"line":546,"column":1}},"key":"au5pwUsHwU"},{"type":"inlineMath","value":"\\mathbf{A}_1","position":{"start":{"line":546,"column":1},"end":{"line":546,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsub\u003e\u003cmi mathvariant=\"bold\"\u003eA\u003c/mi\u003e\u003cmn\u003e1\u003c/mn\u003e\u003c/msub\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\mathbf{A}_1\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8361em;vertical-align:-0.15em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathbf\"\u003eA\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3011em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e1\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"fn3cTN5HZW"},{"type":"text","value":".","position":{"start":{"line":546,"column":1},"end":{"line":546,"column":1}},"key":"HKA14bg9tp"}],"key":"HCZbiZAoEj"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A_2 = A_1 - L(:, 1) * U(1, :)","key":"MV1ypXkzbe"},{"type":"output","id":"eNj6gHhCPSrOV_NMZQvFN","data":[{"output_type":"execute_result","execution_count":56,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003eA_2 = 4×4 double\n     0     0     0     0\n     0     5     1    -4\n     0    15     0    -6\n     0     0     6   -10\n\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"A_2 = 4×4 double\n     0     0     0     0\n     0     5     1    -4\n     0    15     0    -6\n     0     0     6   -10\n","content_type":"text/plain"}}}],"key":"uGdUJ1U5vk"}],"data":{},"key":"VAEHafPeGE"},{"type":"paragraph","position":{"start":{"line":552,"column":1},"end":{"line":552,"column":1}},"children":[{"type":"text","value":"Now ","position":{"start":{"line":552,"column":1},"end":{"line":552,"column":1}},"key":"P9jMO1JZHE"},{"type":"inlineMath","value":"\\mathbf{A}_2 = \\boldsymbol{\\ell}_2\\mathbf{u}_2^T + \\boldsymbol{\\ell}_3\\mathbf{u}_3^T + \\boldsymbol{\\ell}_4\\mathbf{u}_4^T.","position":{"start":{"line":552,"column":1},"end":{"line":552,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsub\u003e\u003cmi mathvariant=\"bold\"\u003eA\u003c/mi\u003e\u003cmn\u003e2\u003c/mn\u003e\u003c/msub\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmsub\u003e\u003cmi mathvariant=\"bold\"\u003eℓ\u003c/mi\u003e\u003cmn\u003e2\u003c/mn\u003e\u003c/msub\u003e\u003cmsubsup\u003e\u003cmi mathvariant=\"bold\"\u003eu\u003c/mi\u003e\u003cmn\u003e2\u003c/mn\u003e\u003cmi\u003eT\u003c/mi\u003e\u003c/msubsup\u003e\u003cmo\u003e+\u003c/mo\u003e\u003cmsub\u003e\u003cmi mathvariant=\"bold\"\u003eℓ\u003c/mi\u003e\u003cmn\u003e3\u003c/mn\u003e\u003c/msub\u003e\u003cmsubsup\u003e\u003cmi mathvariant=\"bold\"\u003eu\u003c/mi\u003e\u003cmn\u003e3\u003c/mn\u003e\u003cmi\u003eT\u003c/mi\u003e\u003c/msubsup\u003e\u003cmo\u003e+\u003c/mo\u003e\u003cmsub\u003e\u003cmi mathvariant=\"bold\"\u003eℓ\u003c/mi\u003e\u003cmn\u003e4\u003c/mn\u003e\u003c/msub\u003e\u003cmsubsup\u003e\u003cmi mathvariant=\"bold\"\u003eu\u003c/mi\u003e\u003cmn\u003e4\u003c/mn\u003e\u003cmi\u003eT\u003c/mi\u003e\u003c/msubsup\u003e\u003cmi mathvariant=\"normal\"\u003e.\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\mathbf{A}_2 = \\boldsymbol{\\ell}_2\\mathbf{u}_2^T + \\boldsymbol{\\ell}_3\\mathbf{u}_3^T + \\boldsymbol{\\ell}_4\\mathbf{u}_4^T.\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8361em;vertical-align:-0.15em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathbf\"\u003eA\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3011em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e2\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1.0894em;vertical-align:-0.2481em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathbf\"\u003eℓ\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3011em;\"\u003e\u003cspan style=\"top:-2.55em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e2\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathbf\"\u003eu\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.8413em;\"\u003e\u003cspan style=\"top:-2.4519em;margin-left:0em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e2\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.063em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\"\u003eT\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.2481em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e+\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1.0894em;vertical-align:-0.2481em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathbf\"\u003eℓ\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3011em;\"\u003e\u003cspan style=\"top:-2.55em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e3\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathbf\"\u003eu\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.8413em;\"\u003e\u003cspan style=\"top:-2.4519em;margin-left:0em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e3\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.063em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\"\u003eT\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.2481em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e+\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1.0894em;vertical-align:-0.2481em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathbf\"\u003eℓ\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3011em;\"\u003e\u003cspan style=\"top:-2.55em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e4\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathbf\"\u003eu\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.8413em;\"\u003e\u003cspan style=\"top:-2.4519em;margin-left:0em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e4\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.063em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\"\u003eT\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.2481em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e.\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"nxyEgiRAji"},{"type":"text","value":" If we ignore the first row and first column of the matrices in this equation, then in what remains we are in the same situation as at the start. Specifically, only ","position":{"start":{"line":552,"column":1},"end":{"line":552,"column":1}},"key":"DUNrZLQJac"},{"type":"inlineMath","value":"\\boldsymbol{\\ell}_2\\mathbf{u}_2^T","position":{"start":{"line":552,"column":1},"end":{"line":552,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsub\u003e\u003cmi mathvariant=\"bold\"\u003eℓ\u003c/mi\u003e\u003cmn\u003e2\u003c/mn\u003e\u003c/msub\u003e\u003cmsubsup\u003e\u003cmi mathvariant=\"bold\"\u003eu\u003c/mi\u003e\u003cmn\u003e2\u003c/mn\u003e\u003cmi\u003eT\u003c/mi\u003e\u003c/msubsup\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\boldsymbol{\\ell}_2\\mathbf{u}_2^T\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1.0894em;vertical-align:-0.2481em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathbf\"\u003eℓ\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3011em;\"\u003e\u003cspan style=\"top:-2.55em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e2\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathbf\"\u003eu\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.8413em;\"\u003e\u003cspan style=\"top:-2.4519em;margin-left:0em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e2\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.063em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\"\u003eT\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.2481em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"GcuXraZN4u"},{"type":"text","value":" has any effect on the second row and column, so we can deduce them now.","position":{"start":{"line":552,"column":1},"end":{"line":552,"column":1}},"key":"xrNTRA8vK9"}],"key":"G4QISlzTw7"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"U(2, :) = A_2(2, :)\nL(:, 2) = A_2(:, 2) / U(2, 2)","key":"aQDEqtZIUR"},{"type":"output","id":"tS5HMBW12vpvL1YAmV8y6","data":[{"output_type":"execute_result","execution_count":57,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003eU = 4×4 double\n     2     0     4     3\n     0     5     1    -4\n     0     0     0     0\n     0     0     0     0\n\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"U = 4×4 double\n     2     0     4     3\n     0     5     1    -4\n     0     0     0     0\n     0     0     0     0\n","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":57,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003eL = 4×4 double\n    1.0000         0         0         0\n   -2.0000    1.0000         0         0\n    0.5000    3.0000    1.0000         0\n   -1.0000         0         0    1.0000\n\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"L = 4×4 double\n    1.0000         0         0         0\n   -2.0000    1.0000         0         0\n    0.5000    3.0000    1.0000         0\n   -1.0000         0         0    1.0000\n","content_type":"text/plain"}}}],"key":"xd647TXXBz"}],"data":{},"key":"GgZzObniEf"},{"type":"paragraph","position":{"start":{"line":559,"column":1},"end":{"line":559,"column":1}},"children":[{"type":"text","value":"If we subtract off the latest outer product, we have a matrix that is zero in the first ","position":{"start":{"line":559,"column":1},"end":{"line":559,"column":1}},"key":"IDfxTy10YO"},{"type":"emphasis","position":{"start":{"line":559,"column":1},"end":{"line":559,"column":1}},"children":[{"type":"text","value":"two","position":{"start":{"line":559,"column":1},"end":{"line":559,"column":1}},"key":"BVDCKNhfKv"}],"key":"vV1L9QStP2"},{"type":"text","value":" rows and columns.","position":{"start":{"line":559,"column":1},"end":{"line":559,"column":1}},"key":"cHmON4z8nV"}],"key":"Uf4nJHoIbs"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A_3 = A_2 - L(:, 2) * U(2, :)","key":"RDBegDb05K"},{"type":"output","id":"6Rb1kl8kvt0xyHCo-7ow0","data":[{"output_type":"execute_result","execution_count":58,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003eA_3 = 4×4 double\n     0     0     0     0\n     0     0     0     0\n     0     0    -3     6\n     0     0     6   -10\n\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"A_3 = 4×4 double\n     0     0     0     0\n     0     0     0     0\n     0     0    -3     6\n     0     0     6   -10\n","content_type":"text/plain"}}}],"key":"NemZDa8jiI"}],"data":{},"key":"MYM7MfHfBr"},{"type":"paragraph","position":{"start":{"line":565,"column":1},"end":{"line":565,"column":1}},"children":[{"type":"text","value":"Now we can deal with the lower right ","position":{"start":{"line":565,"column":1},"end":{"line":565,"column":1}},"key":"wXUqTG95GY"},{"type":"inlineMath","value":"2\\times 2","position":{"start":{"line":565,"column":1},"end":{"line":565,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmn\u003e2\u003c/mn\u003e\u003cmo\u003e×\u003c/mo\u003e\u003cmn\u003e2\u003c/mn\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e2\\times 2\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e2\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e×\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6444em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e2\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"IABkd6bT21"},{"type":"text","value":" submatrix of the remainder in a similar fashion.","position":{"start":{"line":565,"column":1},"end":{"line":565,"column":1}},"key":"Sx7z1qOnKe"}],"key":"WXGJgUBlJO"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"U(3, :) = A_3(3, :);\nL(:, 3) = A_3(:, 3) / U(3, 3);\nA_4 = A_3 - L(:, 3) * U(3, :)","key":"xFh6OXLtAu"},{"type":"output","id":"Ju6QMq_N32BM4J4UiYJZX","data":[{"output_type":"execute_result","execution_count":59,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003eA_4 = 4×4 double\n     0     0     0     0\n     0     0     0     0\n     0     0     0     0\n     0     0     0     2\n\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"A_4 = 4×4 double\n     0     0     0     0\n     0     0     0     0\n     0     0     0     0\n     0     0     0     2\n","content_type":"text/plain"}}}],"key":"IsMZKna0LP"}],"data":{},"key":"klSNbgrvWt"},{"type":"paragraph","position":{"start":{"line":573,"column":1},"end":{"line":573,"column":1}},"children":[{"type":"text","value":"Finally, we pick up the last unknown in the factors.","position":{"start":{"line":573,"column":1},"end":{"line":573,"column":1}},"key":"Tr38Dgza7J"}],"key":"TddK1vQHAF"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"U(4, 4) = A_4(4, 4);","key":"eGYvWsaEqU"},{"type":"output","id":"vENiisD6ragooF1Fo5iiu","data":[],"key":"VQTGdm0Rfa"}],"data":{},"key":"zNILCZPaK8"},{"type":"paragraph","position":{"start":{"line":579,"column":1},"end":{"line":579,"column":1}},"children":[{"type":"text","value":"We now have all of ","position":{"start":{"line":579,"column":1},"end":{"line":579,"column":1}},"key":"Yt6UUpKO8l"},{"type":"inlineMath","value":"\\mathbf{L}","position":{"start":{"line":579,"column":1},"end":{"line":579,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi mathvariant=\"bold\"\u003eL\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\mathbf{L}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6861em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathbf\"\u003eL\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"sx9oaFddVd"},{"type":"text","value":",","position":{"start":{"line":579,"column":1},"end":{"line":579,"column":1}},"key":"ud7rbq6MbU"}],"key":"rV3ItsTs1u"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"L","key":"bTTF8UmCPA"},{"type":"output","id":"BMu46SjMbfC_oOOBlG7Jh","data":[{"output_type":"execute_result","execution_count":61,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003eL = 4×4 double\n    1.0000         0         0         0\n   -2.0000    1.0000         0         0\n    0.5000    3.0000    1.0000         0\n   -1.0000         0   -2.0000    1.0000\n\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"L = 4×4 double\n    1.0000         0         0         0\n   -2.0000    1.0000         0         0\n    0.5000    3.0000    1.0000         0\n   -1.0000         0   -2.0000    1.0000\n","content_type":"text/plain"}}}],"key":"ihDOOSMd5b"}],"data":{},"key":"N8NDqTSFZv"},{"type":"paragraph","position":{"start":{"line":585,"column":1},"end":{"line":585,"column":1}},"children":[{"type":"text","value":"and all of ","position":{"start":{"line":585,"column":1},"end":{"line":585,"column":1}},"key":"VKXsqaMQ3k"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":585,"column":1},"end":{"line":585,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi mathvariant=\"bold\"\u003eU\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\mathbf{U}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6861em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathbf\"\u003eU\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"TBKmxeglEh"},{"type":"text","value":",","position":{"start":{"line":585,"column":1},"end":{"line":585,"column":1}},"key":"ZOcERku4C4"}],"key":"KqXDB7mIXH"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"U","key":"Iyfivpnc7i"},{"type":"output","id":"Xls8mknISIqusFuTKLy0L","data":[{"output_type":"execute_result","execution_count":62,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003eU = 4×4 double\n     2     0     4     3\n     0     5     1    -4\n     0     0    -3     6\n     0     0     0     2\n\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"U = 4×4 double\n     2     0     4     3\n     0     5     1    -4\n     0     0    -3     6\n     0     0     0     2\n","content_type":"text/plain"}}}],"key":"bXYbtVDjtb"}],"data":{},"key":"H5ko1PajEw"},{"type":"paragraph","position":{"start":{"line":591,"column":1},"end":{"line":591,"column":1}},"children":[{"type":"text","value":"We can verify that we have a correct factorization of the original matrix by computing the backward error:","position":{"start":{"line":591,"column":1},"end":{"line":591,"column":1}},"key":"c2A5itLwaC"}],"key":"GoDkilJoT2"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A_1 - L * U","key":"CfSdbua9eo"},{"type":"output","id":"klO6XJSw4SaOdCyVpFHVa","data":[{"output_type":"execute_result","execution_count":63,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003eans = 4×4 double\n     0     0     0     0\n     0     0     0     0\n     0     0     0     0\n     0     0     0     0\n\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"ans = 4×4 double\n     0     0     0     0\n     0     0     0     0\n     0     0     0     0\n     0     0     0     0\n","content_type":"text/plain"}}}],"key":"FIzHY4MgmB"}],"data":{},"key":"ttF34wmEod"},{"type":"paragraph","position":{"start":{"line":597,"column":1},"end":{"line":597,"column":1}},"children":[{"type":"text","value":"In floating point, we cannot expect the difference to be exactly zero as we found in this toy example. Instead, we would be satisfied to see that each element of the difference above is comparable in size to machine precision.","position":{"start":{"line":597,"column":1},"end":{"line":597,"column":1}},"key":"Af1NJJ9Y1m"}],"key":"EL9wJHbZ6S"}],"label":"demo-lu-derive-matlab","identifier":"demo-lu-derive-matlab","html_id":"demo-lu-derive-matlab","key":"FNNHGwphLA"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Solving a linear system by ","key":"qakullIC4s"},{"type":"abbreviation","title":"lower triangular times upper triangular","children":[{"type":"text","value":"LU","key":"CXSYGWeDOa"}],"key":"LRLvBWanw8"},{"type":"text","value":" factors","key":"OU7cpRB400"}],"key":"p6bNM54sn1"},{"type":"paragraph","position":{"start":{"line":603,"column":1},"end":{"line":603,"column":1}},"children":[{"type":"text","value":"Here are the data for a linear system ","position":{"start":{"line":603,"column":1},"end":{"line":603,"column":1}},"key":"Qgm4DJ7YKD"},{"type":"inlineMath","value":"\\mathbf{A}\\mathbf{x}=\\mathbf{b}","position":{"start":{"line":603,"column":1},"end":{"line":603,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi mathvariant=\"bold\"\u003eA\u003c/mi\u003e\u003cmi mathvariant=\"bold\"\u003ex\u003c/mi\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmi mathvariant=\"bold\"\u003eb\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\mathbf{A}\\mathbf{x}=\\mathbf{b}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6861em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathbf\"\u003eAx\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathbf\"\u003eb\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"eiOqF9pjY6"},{"type":"text","value":".","position":{"start":{"line":603,"column":1},"end":{"line":603,"column":1}},"key":"fkqafXjRdE"}],"key":"dIkxDk8ahJ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A = [2 0 4 3; -4 5 -7 -10; 1 15 2 -4.5; -2 0 2 -13];\nb = [4; 9; 9; 4];","key":"PvVpwkpFj3"},{"type":"output","id":"9YUu6wQmc1FI1K64hieom","data":[],"key":"U0hu85JZoE"}],"data":{},"key":"Y0B44GvsaH"},{"type":"paragraph","position":{"start":{"line":610,"column":1},"end":{"line":610,"column":1}},"children":[{"type":"text","value":"We apply ","position":{"start":{"line":610,"column":1},"end":{"line":610,"column":1}},"key":"J0FTY4ppUN"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-lufact","label":"function-lufact","children":[{"type":"text","value":"Function ","key":"Z3k47oeXCH"},{"type":"text","value":"2.4.1","key":"hlxZYdW7CC"}],"template":"Algorithm %s","enumerator":"2.4.1","resolved":true,"html_id":"function-lufact","remote":true,"url":"/lu","dataUrl":"/lu.json","key":"AFQObCr2wr"},{"type":"text","value":" and then do two triangular solves.","position":{"start":{"line":610,"column":1},"end":{"line":610,"column":1}},"key":"oRyduAQ6Ug"}],"key":"ExDY1zktdp"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[L, U] = lufact(A)\nz = forwardsub(L, b);\nx = backsub(U, z);","key":"rpdNZhnaXh"},{"type":"output","id":"_nJhG7IeSnaUGk8rYJl3R","data":[{"output_type":"execute_result","execution_count":65,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003eL = 4×4 double\n    1.0000         0         0         0\n   -2.0000    1.0000         0         0\n    0.5000    3.0000    1.0000         0\n   -1.0000         0   -2.0000    1.0000\n\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"L = 4×4 double\n    1.0000         0         0         0\n   -2.0000    1.0000         0         0\n    0.5000    3.0000    1.0000         0\n   -1.0000         0   -2.0000    1.0000\n","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":65,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003eU = 4×4 double\n     2     0     4     3\n     0     5     1    -4\n     0     0    -3     6\n     0     0     0     2\n\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"U = 4×4 double\n     2     0     4     3\n     0     5     1    -4\n     0     0    -3     6\n     0     0     0     2\n","content_type":"text/plain"}}}],"key":"rPllhsop0K"}],"data":{},"key":"AbVQXCR7Mp"},{"type":"paragraph","position":{"start":{"line":618,"column":1},"end":{"line":618,"column":1}},"children":[{"type":"text","value":"A check on the residual assures us that we found the solution.","position":{"start":{"line":618,"column":1},"end":{"line":618,"column":1}},"key":"zkpikfoUQi"}],"key":"dHeeExKNpp"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"b - A * x","key":"cH5Hr30Rx6"},{"type":"output","id":"oKBb3nluftmCWvmBsIM8Q","data":[{"output_type":"execute_result","execution_count":66,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003eans = 4×1 double\n1.0e-13 *\n\n         0\n   -0.5684\n    0.2842\n         0\n\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"ans = 4×1 double\n1.0e-13 *\n\n         0\n   -0.5684\n    0.2842\n         0\n","content_type":"text/plain"}}}],"key":"AcIveJQAx3"}],"data":{},"key":"hlRs2LNZoK"}],"label":"demo-lu-solve-matlab","identifier":"demo-lu-solve-matlab","html_id":"demo-lu-solve-matlab","key":"kQzWyOOmrh"},{"type":"heading","depth":3,"position":{"start":{"line":625,"column":1},"end":{"line":625,"column":1}},"children":[{"type":"text","value":"Section 2.5","position":{"start":{"line":625,"column":1},"end":{"line":625,"column":1}},"key":"roupyWMgIz"}],"identifier":"section-2-5","label":"Section 2.5","html_id":"section-2-5","implicit":true,"key":"NAoHbdedYh"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Floating-point operations in matrix-vector multiplication","position":{"start":{"line":627,"column":1},"end":{"line":627,"column":1}},"key":"IHIQuGy7I2"}],"key":"UBejqcNINi"},{"type":"paragraph","position":{"start":{"line":628,"column":1},"end":{"line":628,"column":1}},"children":[{"type":"text","value":"Here is a straightforward implementation of matrix-vector multiplication.","position":{"start":{"line":628,"column":1},"end":{"line":628,"column":1}},"key":"lIoF4ZLX5B"}],"key":"gVs6coiBAo"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"n = 6;\nA = magic(n);\nx = ones(n,1);\ny = zeros(n,1);\nfor i = 1:n\n    for j = 1:n\n        y(i) = y(i) + A(i,j)*x(j);   % 2 flops\n    end\nend","key":"LrplKzp0rv"},{"type":"output","id":"QZeDaI_I397QlX48MQngt","data":[],"key":"CCnlOghqjQ"}],"data":{},"key":"oNYe1fEtCY"},{"type":"paragraph","position":{"start":{"line":642,"column":1},"end":{"line":642,"column":1}},"children":[{"type":"text","value":"Each of the loops implies a summation of flops. The total flop count for this algorithm is","position":{"start":{"line":642,"column":1},"end":{"line":642,"column":1}},"key":"rBTC6Friw5"}],"key":"JJeV57LdwE"},{"type":"math","value":"\\sum_{i=1}^n \\sum_{j=1}^n 2 = \\sum_{i=1}^n 2n = 2n^2.","position":{"start":{"line":644,"column":1},"end":{"line":644,"column":1}},"html":"\u003cspan class=\"katex-display\"\u003e\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmunderover\u003e\u003cmo\u003e∑\u003c/mo\u003e\u003cmrow\u003e\u003cmi\u003ei\u003c/mi\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmn\u003e1\u003c/mn\u003e\u003c/mrow\u003e\u003cmi\u003en\u003c/mi\u003e\u003c/munderover\u003e\u003cmunderover\u003e\u003cmo\u003e∑\u003c/mo\u003e\u003cmrow\u003e\u003cmi\u003ej\u003c/mi\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmn\u003e1\u003c/mn\u003e\u003c/mrow\u003e\u003cmi\u003en\u003c/mi\u003e\u003c/munderover\u003e\u003cmn\u003e2\u003c/mn\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmunderover\u003e\u003cmo\u003e∑\u003c/mo\u003e\u003cmrow\u003e\u003cmi\u003ei\u003c/mi\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmn\u003e1\u003c/mn\u003e\u003c/mrow\u003e\u003cmi\u003en\u003c/mi\u003e\u003c/munderover\u003e\u003cmn\u003e2\u003c/mn\u003e\u003cmi\u003en\u003c/mi\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmn\u003e2\u003c/mn\u003e\u003cmsup\u003e\u003cmi\u003en\u003c/mi\u003e\u003cmn\u003e2\u003c/mn\u003e\u003c/msup\u003e\u003cmi mathvariant=\"normal\"\u003e.\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\sum_{i=1}^n \\sum_{j=1}^n 2 = \\sum_{i=1}^n 2n = 2n^2.\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:3.0652em;vertical-align:-1.4138em;\"\u003e\u003c/span\u003e\u003cspan class=\"mop op-limits\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:1.6514em;\"\u003e\u003cspan style=\"top:-1.8723em;margin-left:0em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3.05em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003ei\u003c/span\u003e\u003cspan class=\"mrel mtight\"\u003e=\u003c/span\u003e\u003cspan class=\"mord mtight\"\u003e1\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3.05em;\"\u003e\u003c/span\u003e\u003cspan\u003e\u003cspan class=\"mop op-symbol large-op\"\u003e∑\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-4.3em;margin-left:0em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3.05em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003en\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:1.2777em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.1667em;\"\u003e\u003c/span\u003e\u003cspan class=\"mop op-limits\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:1.6514em;\"\u003e\u003cspan style=\"top:-1.8723em;margin-left:0em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3.05em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\"\u003ej\u003c/span\u003e\u003cspan class=\"mrel mtight\"\u003e=\u003c/span\u003e\u003cspan class=\"mord mtight\"\u003e1\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3.05em;\"\u003e\u003c/span\u003e\u003cspan\u003e\u003cspan class=\"mop op-symbol large-op\"\u003e∑\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-4.3em;margin-left:0em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3.05em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003en\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:1.4138em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.1667em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e2\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:2.9291em;vertical-align:-1.2777em;\"\u003e\u003c/span\u003e\u003cspan class=\"mop op-limits\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:1.6514em;\"\u003e\u003cspan style=\"top:-1.8723em;margin-left:0em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3.05em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003ei\u003c/span\u003e\u003cspan class=\"mrel mtight\"\u003e=\u003c/span\u003e\u003cspan class=\"mord mtight\"\u003e1\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3.05em;\"\u003e\u003c/span\u003e\u003cspan\u003e\u003cspan class=\"mop op-symbol large-op\"\u003e∑\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-4.3em;margin-left:0em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3.05em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003en\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:1.2777em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.1667em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e2\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003en\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8641em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e2\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003en\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.8641em;\"\u003e\u003cspan style=\"top:-3.113em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e2\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e.\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","enumerator":"1","key":"FHf1A3hK6i"},{"type":"paragraph","position":{"start":{"line":646,"column":1},"end":{"line":646,"column":1}},"children":[{"type":"text","value":"Since the matrix ","position":{"start":{"line":646,"column":1},"end":{"line":646,"column":1}},"key":"p3jwTu1xtG"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":646,"column":1},"end":{"line":646,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi mathvariant=\"bold\"\u003eA\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\mathbf{A}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6861em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathbf\"\u003eA\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"V8VfnsXvCr"},{"type":"text","value":" has ","position":{"start":{"line":646,"column":1},"end":{"line":646,"column":1}},"key":"O645beBHz0"},{"type":"inlineMath","value":"n^2","position":{"start":{"line":646,"column":1},"end":{"line":646,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsup\u003e\u003cmi\u003en\u003c/mi\u003e\u003cmn\u003e2\u003c/mn\u003e\u003c/msup\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003en^2\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8141em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003en\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.8141em;\"\u003e\u003cspan style=\"top:-3.063em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e2\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"eftex4n0uJ"},{"type":"text","value":" elements, all of which have to be involved in the product, it seems unlikely that we could get a flop count that is smaller than ","position":{"start":{"line":646,"column":1},"end":{"line":646,"column":1}},"key":"l8Yg0qmTlW"},{"type":"inlineMath","value":"O(n^2)","position":{"start":{"line":646,"column":1},"end":{"line":646,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003eO\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmsup\u003e\u003cmi\u003en\u003c/mi\u003e\u003cmn\u003e2\u003c/mn\u003e\u003c/msup\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003eO(n^2)\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\"\u003eO\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003en\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.8141em;\"\u003e\u003cspan style=\"top:-3.063em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e2\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"xtyxT1L6lB"},{"type":"text","value":" in general.","position":{"start":{"line":646,"column":1},"end":{"line":646,"column":1}},"key":"NuOZnFTGcQ"}],"key":"PsBAVuoeR6"},{"type":"paragraph","position":{"start":{"line":651,"column":1},"end":{"line":651,"column":1}},"children":[{"type":"text","value":"Let’s run an experiment with the built-in matrix-vector multiplication, using ","position":{"start":{"line":651,"column":1},"end":{"line":651,"column":1}},"key":"HE5ogG7RSd"},{"type":"inlineCode","value":"tic","position":{"start":{"line":651,"column":1},"end":{"line":651,"column":1}},"key":"yGvSfHPQqX"},{"type":"text","value":" and ","position":{"start":{"line":651,"column":1},"end":{"line":651,"column":1}},"key":"fGzzFJbXFp"},{"type":"inlineCode","value":"toc","position":{"start":{"line":651,"column":1},"end":{"line":651,"column":1}},"key":"O1R6KzgIpt"},{"type":"text","value":" to time the operation.","position":{"start":{"line":651,"column":1},"end":{"line":651,"column":1}},"key":"qcHMP0Pfbz"}],"indexEntries":[{"entry":"MATLAB","subEntry":{"value":"tic and toc","kind":"entry"},"emphasis":true}],"label":"index-kzRIPEa8dL","identifier":"index-kzripea8dl","html_id":"index-kzripea8dl","key":"JYOQMvOdjL"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"n_ = (400:400:4000)';\nt_ = zeros(size(n_));\nfor i = 1:length(n_)\n    n = n_(i);\n    A = randn(n, n);  x = randn(n, 1);\n    tic    % start a timer\n    for j = 1:100      % repeat 100 times\n        A*x;\n    end\n    t = toc;           % read the timer\n    t_(i) = t / 100;   % seconds per instance\nend","key":"lrPqe5AOW4"},{"type":"output","id":"n61YS3nGDx6PLIBzNir5F","data":[],"key":"mW8qh9lAc3"}],"data":{},"key":"qKa29VGUBm"},{"type":"paragraph","position":{"start":{"line":668,"column":1},"end":{"line":668,"column":1}},"children":[{"type":"text","value":"The reason for doing multiple repetitions at each value of ","position":{"start":{"line":668,"column":1},"end":{"line":668,"column":1}},"key":"BwfIk1CUmY"},{"type":"inlineMath","value":"n","position":{"start":{"line":668,"column":1},"end":{"line":668,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003en\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003en\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.4306em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003en\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"iXzwcp5HGF"},{"type":"text","value":" in the loop above is to avoid having times so short that the resolution of the timer is significant.","position":{"start":{"line":668,"column":1},"end":{"line":668,"column":1}},"key":"xm8kByD3kl"}],"key":"UGkkQXAcGp"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"table(n_, t_, 'variablenames', {'size', 'time'})","key":"EidgZbZXFZ"},{"type":"output","id":"1yZb5Hi_nS5FzAOMXjsJc","data":[{"output_type":"execute_result","execution_count":69,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003chead\u003e\u003cstyle\u003e.mwBasicVariableOutputWrapper .mwBasicVariableOutputHeader {font-style: italic;}\u003c/style\u003e\u003c/head\u003e\u003cbody\u003e\u003cdiv class='mwBasicVariableOutputWrapper'\u003e\u003cdiv\u003eans = \u003cspan class='mwBasicVariableOutputHeader'\u003e10x2 table\u003c/span\u003e\u003c/div\u003e\u003ctable\u003e\u003cthead\u003e\u003ctr\u003e\u003cth\u003esize\u003c/th\u003e\u003cth\u003etime\u003c/th\u003e\u003c/tr\u003e\u003c/thead\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd\u003e400\u003c/td\u003e\u003ctd\u003e1.4351e-04\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd\u003e800\u003c/td\u003e\u003ctd\u003e6.2317e-04\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd\u003e1200\u003c/td\u003e\u003ctd\u003e8.6801e-04\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd\u003e1600\u003c/td\u003e\u003ctd\u003e8.7934e-04\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd\u003e2000\u003c/td\u003e\u003ctd\u003e0.0018\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd\u003e2400\u003c/td\u003e\u003ctd\u003e0.0031\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd\u003e2800\u003c/td\u003e\u003ctd\u003e0.0031\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd\u003e3200\u003c/td\u003e\u003ctd\u003e0.0032\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd\u003e3600\u003c/td\u003e\u003ctd\u003e0.0042\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd\u003e4000\u003c/td\u003e\u003ctd\u003e0.0053\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/div\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"\u003chtml\u003e\u003chead\u003e\u003cstyle\u003e.mwBasicVariableOutputWrapper .mwBasicVariableOutputHeader {font-style: italic;}\u003c/style\u003e\u003c/head\u003e\u003cbody\u003e\u003cdiv class='mwBasicVariableOutputWrapper'\u003e\u003cdiv\u003eans = \u003cspan class='mwBasicVariableOutputHeader'\u003e10x2 table\u003c/span\u003e\u003c/div\u003e\u003ctable\u003e\u003cthead\u003e\u003ctr\u003e\u003cth\u003esize\u003c/th\u003e\u003cth\u003etime\u003c/th\u003e\u003c/tr\u003e\u003c/thead\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd\u003e400\u003c/td\u003e\u003ctd\u003e1.4351e-04\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd\u003e800\u003c/td\u003e\u003ctd\u003e6.2317e-04\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd\u003e1200\u003c/td\u003e\u003ctd\u003e8.6801e-04\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd\u003e1600\u003c/td\u003e\u003ctd\u003e8.7934e-04\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd\u003e2000\u003c/td\u003e\u003ctd\u003e0.0018\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd\u003e2400\u003c/td\u003e\u003ctd\u003e0.0031\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd\u003e2800\u003c/td\u003e\u003ctd\u003e0.0031\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd\u003e3200\u003c/td\u003e\u003ctd\u003e0.0032\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd\u003e3600\u003c/td\u003e\u003ctd\u003e0.0042\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd\u003e4000\u003c/td\u003e\u003ctd\u003e0.0053\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/div\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/plain"}}}],"key":"PbsSqBCYpc"}],"data":{},"key":"CfkcQAYW2W"},{"type":"grid","columns":[1,1,2,2],"children":[{"type":"paragraph","position":{"start":{"line":678,"column":1},"end":{"line":678,"column":1}},"children":[{"type":"text","value":"Looking at the timings just for ","position":{"start":{"line":678,"column":1},"end":{"line":678,"column":1}},"key":"RmHWuxzOPJ"},{"type":"inlineMath","value":"n=2000","position":{"start":{"line":678,"column":1},"end":{"line":678,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003en\u003c/mi\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmn\u003e2000\u003c/mn\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003en=2000\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.4306em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003en\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6444em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e2000\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"wISVbAbbuC"},{"type":"text","value":" and ","position":{"start":{"line":678,"column":1},"end":{"line":678,"column":1}},"key":"WxY50GqxAE"},{"type":"inlineMath","value":"n=4000","position":{"start":{"line":678,"column":1},"end":{"line":678,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003en\u003c/mi\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmn\u003e4000\u003c/mn\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003en=4000\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.4306em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003en\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6444em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e4000\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"jt8awOFJ7D"},{"type":"text","value":", they have ratio","position":{"start":{"line":678,"column":1},"end":{"line":678,"column":1}},"key":"FqmKuI2ueC"}],"key":"OYbRIMu2uB"},{"type":"card","children":[{"type":"paragraph","position":{"start":{"line":680,"column":1},"end":{"line":680,"column":1}},"children":[{"type":"text","value":"The expression ","position":{"start":{"line":680,"column":1},"end":{"line":680,"column":1}},"key":"IwOSy81PaX"},{"type":"inlineCode","value":"n_==4000","position":{"start":{"line":680,"column":1},"end":{"line":680,"column":1}},"key":"jJVw9IAAN1"},{"type":"text","value":" here produces a vector of Boolean (true/false) values the same size as ","position":{"start":{"line":680,"column":1},"end":{"line":680,"column":1}},"key":"doNcODjuQK"},{"type":"inlineCode","value":"n_","position":{"start":{"line":680,"column":1},"end":{"line":680,"column":1}},"key":"ctkUuY9fOS"},{"type":"text","value":". This result is used to index within ","position":{"start":{"line":680,"column":1},"end":{"line":680,"column":1}},"key":"ToZZmLowML"},{"type":"inlineCode","value":"t_","position":{"start":{"line":680,"column":1},"end":{"line":680,"column":1}},"key":"BvQ4NQWPmu"},{"type":"text","value":", accessing only the value for which the comparison is true.","position":{"start":{"line":680,"column":1},"end":{"line":680,"column":1}},"key":"gKupdgqvlN"}],"key":"EHZV7QDqFx"}],"key":"mKtH043zuM"}],"indexEntries":[{"entry":"MATLAB","subEntry":{"value":"Boolean indexing","kind":"entry"},"emphasis":false}],"label":"index-xFrvQRSsd5","identifier":"index-xfrvqrssd5","html_id":"index-xfrvqrssd5","key":"V2FLidLaLZ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"t_(n_==4000) / t_(n_==2000)","key":"ajNVEonVtp"},{"type":"output","id":"Oo4Syqv1hVxfVL3POJk0n","data":[{"output_type":"execute_result","execution_count":70,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003eans = 2.9262\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"ans = 2.9262","content_type":"text/plain"}}}],"key":"vD6T0brZEz"}],"data":{},"key":"nha2ohZ2Kl"},{"type":"paragraph","position":{"start":{"line":688,"column":1},"end":{"line":688,"column":1}},"children":[{"type":"text","value":"If the run time is dominated by flops, then we expect this ratio to be","position":{"start":{"line":688,"column":1},"end":{"line":688,"column":1}},"key":"BauMr5GoNl"}],"key":"OIoznOZe5U"},{"type":"math","value":"\\frac{2(4000)^2}{2(2000)^2}=4.","position":{"start":{"line":690,"column":1},"end":{"line":692,"column":1}},"html":"\u003cspan class=\"katex-display\"\u003e\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmfrac\u003e\u003cmrow\u003e\u003cmn\u003e2\u003c/mn\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmn\u003e4000\u003c/mn\u003e\u003cmsup\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003cmn\u003e2\u003c/mn\u003e\u003c/msup\u003e\u003c/mrow\u003e\u003cmrow\u003e\u003cmn\u003e2\u003c/mn\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmn\u003e2000\u003c/mn\u003e\u003cmsup\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003cmn\u003e2\u003c/mn\u003e\u003c/msup\u003e\u003c/mrow\u003e\u003c/mfrac\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmn\u003e4.\u003c/mn\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\frac{2(4000)^2}{2(2000)^2}=4.\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:2.4271em;vertical-align:-0.936em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mopen nulldelimiter\"\u003e\u003c/span\u003e\u003cspan class=\"mfrac\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:1.4911em;\"\u003e\u003cspan style=\"top:-2.314em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003e2\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord\"\u003e2000\u003c/span\u003e\u003cspan class=\"mclose\"\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.7401em;\"\u003e\u003cspan style=\"top:-2.989em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e2\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.23em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"frac-line\" style=\"border-bottom-width:0.04em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.677em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003e2\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord\"\u003e4000\u003c/span\u003e\u003cspan class=\"mclose\"\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.8141em;\"\u003e\u003cspan style=\"top:-3.063em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e2\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.936em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose nulldelimiter\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6444em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e4.\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","enumerator":"2","key":"yHI7WJKp9r"}],"label":"demo-flops-mvmult-matlab","identifier":"demo-flops-mvmult-matlab","html_id":"demo-flops-mvmult-matlab","key":"NcnRWIQr8T"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Asymptotics in log-log plots","position":{"start":{"line":696,"column":1},"end":{"line":696,"column":1}},"key":"waWn8WMvJm"}],"key":"DffrtOCqZR"},{"type":"paragraph","position":{"start":{"line":698,"column":1},"end":{"line":698,"column":1}},"children":[{"type":"text","value":"Let’s repeat the previous experiment for more, and larger, values of ","position":{"start":{"line":698,"column":1},"end":{"line":698,"column":1}},"key":"pjPIsLxpOr"},{"type":"inlineMath","value":"n","position":{"start":{"line":698,"column":1},"end":{"line":698,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003en\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003en\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.4306em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003en\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"tjBap87XTW"},{"type":"text","value":".","position":{"start":{"line":698,"column":1},"end":{"line":698,"column":1}},"key":"kqfzjlboaT"}],"key":"amQOIajPEa"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"n_ = (400:400:6000)';\nt_ = zeros(size(n_));\nfor i = 1:length(n_)\n    n = n_(i);\n    A = randn(n, n);  x = randn(n, 1);\n    tic    % start a timer\n    for j = 1:100      % repeat ten times\n        A*x;\n    end\n    t = toc;          % read the timer\n    t_(i) = t / 100;   % seconds per instance\nend","key":"tRN66zkxQf"},{"type":"output","id":"WYDFj6GuyM13amNyCzc24","data":[],"key":"KrUpDcljTX"}],"data":{},"key":"quzzAuVEAF"},{"type":"paragraph","position":{"start":{"line":715,"column":1},"end":{"line":715,"column":1}},"children":[{"type":"text","value":"Plotting the time as a function of ","position":{"start":{"line":715,"column":1},"end":{"line":715,"column":1}},"key":"MAQnseFq18"},{"type":"inlineMath","value":"n","position":{"start":{"line":715,"column":1},"end":{"line":715,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003en\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003en\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.4306em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003en\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"DGeDnZv80g"},{"type":"text","value":" on log-log scales is equivalent to plotting the logs of the variables.","position":{"start":{"line":715,"column":1},"end":{"line":715,"column":1}},"key":"LL739m919Z"}],"key":"jhorxT6I48"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf    % clear any existing figure\nloglog(n_, t_, '.-')\nxlabel('size of matrix')\nylabel('time (sec)')\ntitle('Timing of matrix-vector multiplications')","key":"chbUJhNbxQ"},{"type":"output","id":"G0FrDjrZ9N-TDcOEN7t5o","data":[{"output_type":"execute_result","execution_count":72,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"e011defcb3ed35de04e565e71d2bb816","path":"/fnc/build/e011defcb3ed35de04e565e71d2bb816.png"}}}],"key":"vwiX2fTRuF"}],"data":{},"key":"jKMvA9qDMe"},{"type":"paragraph","position":{"start":{"line":725,"column":1},"end":{"line":725,"column":1}},"children":[{"type":"text","value":"You can see that while the full story is complicated, the graph is trending to a straight line of positive slope. For comparison, we can plot a line that represents ","position":{"start":{"line":725,"column":1},"end":{"line":725,"column":1}},"key":"s3Rc2vCLl0"},{"type":"inlineMath","value":"O(n^2)","position":{"start":{"line":725,"column":1},"end":{"line":725,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003eO\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmsup\u003e\u003cmi\u003en\u003c/mi\u003e\u003cmn\u003e2\u003c/mn\u003e\u003c/msup\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003eO(n^2)\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\"\u003eO\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003en\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.8141em;\"\u003e\u003cspan style=\"top:-3.063em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e2\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"jCi309tWzA"},{"type":"text","value":" growth exactly. (All such lines have slope equal to 2.)","position":{"start":{"line":725,"column":1},"end":{"line":725,"column":1}},"key":"vxKJj65LjN"}],"key":"mjxqLdHgBw"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"hold on\nloglog(n_, t_(1) * (n_ / n_(1)).^2, '--')\naxis tight\nlegend('data', 'O(n^2)', 'location', 'southeast')","key":"QhFtjQLrju"},{"type":"output","id":"ZIQyAO5BPmYJ9oJEeeL9T","data":[{"output_type":"execute_result","execution_count":73,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"6a200c11bab8c5e26e874d714951bd64","path":"/fnc/build/6a200c11bab8c5e26e874d714951bd64.png"}}}],"key":"WW3q9DCUcC"}],"data":{},"key":"tTEc16twD5"}],"label":"demo-flops-loglog-matlab","identifier":"demo-flops-loglog-matlab","html_id":"demo-flops-loglog-matlab","key":"FfbzAWGWXv"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Floating-point operations in ","key":"EVriysVGYz"},{"type":"abbreviation","title":"lower triangular times upper triangular","children":[{"type":"text","value":"LU","key":"DmN2M1yfhI"}],"key":"p3jQ6Spnwu"},{"type":"text","value":" factorization","key":"B9Vrc0Ty6t"}],"key":"wviaF2Tg07"},{"type":"grid","columns":[1,1,2,2],"children":[{"type":"paragraph","position":{"start":{"line":738,"column":1},"end":{"line":738,"column":1}},"children":[{"type":"text","value":"We’ll test the conclusion of ","position":{"start":{"line":738,"column":1},"end":{"line":738,"column":1}},"key":"VvtzP2A4zC"},{"type":"inlineMath","value":"O(n^3)","position":{"start":{"line":738,"column":1},"end":{"line":738,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003eO\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmsup\u003e\u003cmi\u003en\u003c/mi\u003e\u003cmn\u003e3\u003c/mn\u003e\u003c/msup\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003eO(n^3)\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\"\u003eO\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003en\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.8141em;\"\u003e\u003cspan style=\"top:-3.063em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e3\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"enYf4Qx3ty"},{"type":"text","value":" flops experimentally, using the built-in ","position":{"start":{"line":738,"column":1},"end":{"line":738,"column":1}},"key":"jYX2RsleZT"},{"type":"inlineCode","value":"lu","position":{"start":{"line":738,"column":1},"end":{"line":738,"column":1}},"key":"D1q4sEvfwE"},{"type":"text","value":" function instead of the purely instructive ","position":{"start":{"line":738,"column":1},"end":{"line":738,"column":1}},"key":"pJ9CSEUQ38"},{"type":"inlineCode","value":"lufact","position":{"start":{"line":738,"column":1},"end":{"line":738,"column":1}},"key":"xCt6q92h37"},{"type":"text","value":".","position":{"start":{"line":738,"column":1},"end":{"line":738,"column":1}},"key":"kDfyUrOnYR"}],"key":"kZKuRu5OHz"},{"type":"card","children":[{"type":"paragraph","position":{"start":{"line":740,"column":1},"end":{"line":740,"column":1}},"children":[{"type":"text","value":"The first time a function is invoked, there may be significant time needed to compile it in memory. Thus, when timing a function, run it at least once before beginning the timing.","position":{"start":{"line":740,"column":1},"end":{"line":740,"column":1}},"key":"xPPpYAvPEn"}],"key":"oJD1xpm7XM"}],"key":"AJmodABmeS"}],"key":"Vp0JoeLMYB"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"n_ = (200:100:2400)';\nt_ = zeros(size(n_));\nfor i = 1:length(n_)\n    n = n_(i);\n    A = randn(n, n);  \n    tic    % start a timer\n    for j = 1:6,  [L, U] = lu(A);  end\n    t = toc;\n    t_(i) = t / 6;  \nend","key":"VjTGaruYzT"},{"type":"output","id":"OeGbvy0199uAneH_-yN_P","data":[],"key":"Is4aoP9NZ2"}],"data":{},"key":"ZeJjPY4K5J"},{"type":"paragraph","position":{"start":{"line":757,"column":1},"end":{"line":757,"column":1}},"children":[{"type":"text","value":"We plot the timings on a log-log graph and compare it to ","position":{"start":{"line":757,"column":1},"end":{"line":757,"column":1}},"key":"cwztHF2Vqw"},{"type":"inlineMath","value":"O(n^3)","position":{"start":{"line":757,"column":1},"end":{"line":757,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003eO\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmsup\u003e\u003cmi\u003en\u003c/mi\u003e\u003cmn\u003e3\u003c/mn\u003e\u003c/msup\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003eO(n^3)\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\"\u003eO\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003en\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.8141em;\"\u003e\u003cspan style=\"top:-3.063em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e3\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"b44alJyAN8"},{"type":"text","value":". The result could vary significantly from machine to machine, but in theory the data should start to parallel the line as ","position":{"start":{"line":757,"column":1},"end":{"line":757,"column":1}},"key":"NhC0vnfHxE"},{"type":"inlineMath","value":"n\\to\\infty","position":{"start":{"line":757,"column":1},"end":{"line":757,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003en\u003c/mi\u003e\u003cmo\u003e→\u003c/mo\u003e\u003cmi mathvariant=\"normal\"\u003e∞\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003en\\to\\infty\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.4306em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003en\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e→\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.4306em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e∞\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"XVxEtJhRKY"},{"type":"text","value":".","position":{"start":{"line":757,"column":1},"end":{"line":757,"column":1}},"key":"a6ApMDMyRk"}],"key":"nqOxUA94IK"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf\nloglog(n_,t_,'.-')\nhold on, loglog(n_,t_(end)*(n_/n_(end)).^3,'--')\naxis tight\nxlabel('size of matrix'), ylabel('time (sec)')\ntitle('Timing of LU factorization')\nlegend('lu','O(n^3)','location','southeast')","key":"Bvgvtpfld9"},{"type":"output","id":"q7RjcWyy7C7NIuD2uYB0Y","data":[{"output_type":"execute_result","execution_count":75,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"00837df4f01ea4da92a224d0af7b4c11","path":"/fnc/build/00837df4f01ea4da92a224d0af7b4c11.png"}}}],"key":"ljSyKxsOEl"}],"data":{},"key":"O3sNrUFiE2"}],"label":"demo-flops-lufact-matlab","identifier":"demo-flops-lufact-matlab","html_id":"demo-flops-lufact-matlab","key":"UIPIiguIky"},{"type":"heading","depth":3,"position":{"start":{"line":770,"column":1},"end":{"line":770,"column":1}},"children":[{"type":"text","value":"Section 2.6","position":{"start":{"line":770,"column":1},"end":{"line":770,"column":1}},"key":"Cnlgn5W2DJ"}],"identifier":"section-2-6","label":"Section 2.6","html_id":"section-2-6","implicit":true,"key":"MMBqBySQiR"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Failure of naive ","key":"CUWLktodwX"},{"type":"abbreviation","title":"lower triangular times upper triangular","children":[{"type":"text","value":"LU","key":"NKBDF7KAF8"}],"key":"yxkKUdpbQD"},{"type":"text","value":" factorization","key":"iIxyeUhHZ4"}],"key":"Hh3Igol5Dh"},{"type":"paragraph","position":{"start":{"line":773,"column":1},"end":{"line":773,"column":1}},"children":[{"type":"text","value":"Here is a previously encountered matrix that factors well.","position":{"start":{"line":773,"column":1},"end":{"line":773,"column":1}},"key":"gN9CzTMD4f"}],"key":"B6gnCw197m"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A = [\n    2 0 4 3\n    -4 5 -7 -10\n    1 15 2 -4.5\n    -2 0 2 -13\n    ];\n[L, U] = lufact(A);\nL","key":"U17C6KnH33"},{"type":"output","id":"Ji-41m5HdZAkBnZUZsDPl","data":[{"output_type":"execute_result","execution_count":76,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003eL = 4×4 double\n    1.0000         0         0         0\n   -2.0000    1.0000         0         0\n    0.5000    3.0000    1.0000         0\n   -1.0000         0   -2.0000    1.0000\n\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"L = 4×4 double\n    1.0000         0         0         0\n   -2.0000    1.0000         0         0\n    0.5000    3.0000    1.0000         0\n   -1.0000         0   -2.0000    1.0000\n","content_type":"text/plain"}}}],"key":"R3bWa0Vakf"}],"data":{},"key":"G8A5TcCrBw"},{"type":"paragraph","position":{"start":{"line":786,"column":1},"end":{"line":786,"column":1}},"children":[{"type":"text","value":"If we swap the second and fourth rows of ","position":{"start":{"line":786,"column":1},"end":{"line":786,"column":1}},"key":"FhzWvWU9Mx"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":786,"column":1},"end":{"line":786,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi mathvariant=\"bold\"\u003eA\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\mathbf{A}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6861em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathbf\"\u003eA\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"M0iFVPQw9k"},{"type":"text","value":", the result is still nonsingular. However, the factorization now fails.","position":{"start":{"line":786,"column":1},"end":{"line":786,"column":1}},"key":"XosiNW5CYQ"}],"key":"wlAHmzJQAP"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A([2, 4], :) = A([4, 2], :);    % swap rows 2 and 4\n[L, U] = lufact(A);\nL","key":"hE7k8vZRS3"},{"type":"output","id":"lIoAc7tM6jN9XKrlYE03E","data":[{"output_type":"execute_result","execution_count":77,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003eL = 4×4 double\n    1.0000         0         0         0\n   -1.0000       NaN         0         0\n    0.5000       Inf       NaN         0\n   -2.0000       Inf       NaN    1.0000\n\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"L = 4×4 double\n    1.0000         0         0         0\n   -1.0000       NaN         0         0\n    0.5000       Inf       NaN         0\n   -2.0000       Inf       NaN    1.0000\n","content_type":"text/plain"}}}],"key":"rdIMcdWZzM"}],"data":{},"key":"VPtEdRrcP9"},{"type":"paragraph","position":{"start":{"line":797,"column":1},"end":{"line":797,"column":1}},"children":[{"type":"text","value":"The presence of ","position":{"start":{"line":797,"column":1},"end":{"line":797,"column":1}},"key":"g2TMeDrgAy"},{"type":"inlineCode","value":"NaN","position":{"start":{"line":797,"column":1},"end":{"line":797,"column":1}},"key":"BdFwBc9hax"},{"type":"text","value":" in the result indicates that some impossible operation was required. The source of the problem is easy to locate. We can find the first outer product in the factorization just fine:","position":{"start":{"line":797,"column":1},"end":{"line":797,"column":1}},"key":"EdkVP6Rc7z"}],"indexEntries":[{"entry":"MATLAB","subEntry":{"value":"NaN","kind":"entry"},"emphasis":false}],"label":"index-OSwIJsbwEe","identifier":"index-oswijsbwee","html_id":"index-oswijsbwee","key":"dyMSvRSEXv"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"U(1, :) = A(1, :);\nL(:, 1) = A(:, 1) / U(1, 1)\nA = A - L(:, 1) * U(1, :)","key":"qT5aZKuT2G"},{"type":"output","id":"JKMlhoGegopDTT8AYj3EA","data":[{"output_type":"execute_result","execution_count":78,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003eL = 4×4 double\n    1.0000         0         0         0\n   -1.0000       NaN         0         0\n    0.5000       Inf       NaN         0\n   -2.0000       Inf       NaN    1.0000\n\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"L = 4×4 double\n    1.0000         0         0         0\n   -1.0000       NaN         0         0\n    0.5000       Inf       NaN         0\n   -2.0000       Inf       NaN    1.0000\n","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":78,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003eA = 4×4 double\n     0     0     0     0\n     0     0     6   -10\n     0    15     0    -6\n     0     5     1    -4\n\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"A = 4×4 double\n     0     0     0     0\n     0     0     6   -10\n     0    15     0    -6\n     0     5     1    -4\n","content_type":"text/plain"}}}],"key":"n2tomWGJOx"}],"data":{},"key":"mudz8gCslk"},{"type":"paragraph","position":{"start":{"line":805,"column":1},"end":{"line":805,"column":1}},"children":[{"type":"text","value":"The next step is ","position":{"start":{"line":805,"column":1},"end":{"line":805,"column":1}},"key":"qtG6xvmtMP"},{"type":"inlineCode","value":"U(2, :) = A(2, :)","position":{"start":{"line":805,"column":1},"end":{"line":805,"column":1}},"key":"tN2JwomtRC"},{"type":"text","value":", which is also OK. But then we are supposed to divide by ","position":{"start":{"line":805,"column":1},"end":{"line":805,"column":1}},"key":"uhunKxXAon"},{"type":"inlineCode","value":"U(2, 2)","position":{"start":{"line":805,"column":1},"end":{"line":805,"column":1}},"key":"MPJqiVAFmc"},{"type":"text","value":", which is zero. The algorithm cannot continue.","position":{"start":{"line":805,"column":1},"end":{"line":805,"column":1}},"key":"CGSAIHLWkz"}],"key":"peKyEFkpBa"}],"label":"demo-pivoting-fail-matlab","identifier":"demo-pivoting-fail-matlab","html_id":"demo-pivoting-fail-matlab","key":"aUavDjVSEy"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Row pivoting in ","key":"Yd7c0IzSM9"},{"type":"abbreviation","title":"lower triangular times upper triangular","children":[{"type":"text","value":"LU","key":"Dy2H4jyEF1"}],"key":"F6dDY20Y5Y"},{"type":"text","value":" factorization","key":"wIPKjdtz67"}],"key":"rLQiapsU7o"},{"type":"paragraph","position":{"start":{"line":810,"column":1},"end":{"line":810,"column":1}},"children":[{"type":"text","value":"Here is the trouble-making matrix from ","position":{"start":{"line":810,"column":1},"end":{"line":810,"column":1}},"key":"z7SRelnrrn"},{"type":"crossReference","kind":"proof:example","identifier":"demo-pivoting-fail","label":"demo-pivoting-fail","children":[{"type":"text","value":"Demo ","key":"RRHZIaYraP"},{"type":"text","value":"2.6.1","key":"a4WRLguVBz"}],"template":"Example %s","enumerator":"2.6.1","resolved":true,"html_id":"demo-pivoting-fail","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"uDEtN5698H"},{"type":"text","value":".","position":{"start":{"line":810,"column":1},"end":{"line":810,"column":1}},"key":"M3sQ9pvyAW"}],"key":"yO4Kq6krjf"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A_1 = [2 0 4 3; -2 0 2 -13; 1 15 2 -4.5; -4 5 -7 -10]","key":"vAtqEoSqvr"},{"type":"output","id":"2E3Y7zJ10_6xPsz2lRs6e","data":[{"output_type":"execute_result","execution_count":79,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003eA_1 = 4×4 double\n    2.0000         0    4.0000    3.0000\n   -2.0000         0    2.0000  -13.0000\n    1.0000   15.0000    2.0000   -4.5000\n   -4.0000    5.0000   -7.0000  -10.0000\n\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"A_1 = 4×4 double\n    2.0000         0    4.0000    3.0000\n   -2.0000         0    2.0000  -13.0000\n    1.0000   15.0000    2.0000   -4.5000\n   -4.0000    5.0000   -7.0000  -10.0000\n","content_type":"text/plain"}}}],"key":"PFeksFZe6E"}],"data":{},"key":"Badi61UupN"},{"type":"grid","columns":[1,1,2,2],"children":[{"type":"paragraph","position":{"start":{"line":820,"column":1},"end":{"line":820,"column":1}},"children":[{"type":"text","value":"We now find the largest candidate pivot in the first column. We don’t care about sign, so we take absolute values before finding the max.","position":{"start":{"line":820,"column":1},"end":{"line":820,"column":1}},"key":"Z5hQnGozWI"}],"key":"nz0HOHbRke"},{"type":"card","children":[{"type":"paragraph","position":{"start":{"line":822,"column":1},"end":{"line":822,"column":1}},"children":[{"type":"text","value":"The second output of ","position":{"start":{"line":822,"column":1},"end":{"line":822,"column":1}},"key":"JFJSOVENue"},{"type":"inlineCode","value":"max","position":{"start":{"line":822,"column":1},"end":{"line":822,"column":1}},"key":"Qr13TxcGVt"},{"type":"text","value":" returns the location of the largest element of a vector. The ","position":{"start":{"line":822,"column":1},"end":{"line":822,"column":1}},"key":"jgZtltrMpp"},{"type":"inlineCode","value":"~","position":{"start":{"line":822,"column":1},"end":{"line":822,"column":1}},"key":"vVS3XDwIxW"},{"type":"text","value":" symbol is used to ignore the value of the first output.","position":{"start":{"line":822,"column":1},"end":{"line":822,"column":1}},"key":"O3R8UXmS25"}],"key":"hwWby3vTXV"}],"key":"kycYl82OL8"}],"indexEntries":[{"entry":"MATLAB","subEntry":{"value":"max","kind":"entry"},"emphasis":true},{"entry":"MATLAB","subEntry":{"value":"\\~","kind":"entry"},"emphasis":true}],"label":"index-qzrLZMkGI2","identifier":"index-qzrlzmkgi2","html_id":"index-qzrlzmkgi2","key":"ZYRTqM9X7u"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[~, i] = max( abs(A_1(:, 1)) )","key":"wqrEQ2RK3m"},{"type":"output","id":"9eEvnHe2FAgEqrhci5rJM","data":[{"output_type":"execute_result","execution_count":80,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003ei = 4\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"i = 4","content_type":"text/plain"}}}],"key":"adaxfSrUQj"}],"data":{},"key":"vS5JFG4zXr"},{"type":"paragraph","position":{"start":{"line":831,"column":1},"end":{"line":831,"column":1}},"children":[{"type":"text","value":"This is the row of the matrix that we extract to put into ","position":{"start":{"line":831,"column":1},"end":{"line":831,"column":1}},"key":"d0J3XI3ll8"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":831,"column":1},"end":{"line":831,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi mathvariant=\"bold\"\u003eU\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\mathbf{U}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6861em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathbf\"\u003eU\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"HlklkirAuY"},{"type":"text","value":". That guarantees that the division used to find ","position":{"start":{"line":831,"column":1},"end":{"line":831,"column":1}},"key":"suVScxpk60"},{"type":"inlineMath","value":"\\boldsymbol{\\ell}_1","position":{"start":{"line":831,"column":1},"end":{"line":831,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsub\u003e\u003cmi mathvariant=\"bold\"\u003eℓ\u003c/mi\u003e\u003cmn\u003e1\u003c/mn\u003e\u003c/msub\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\boldsymbol{\\ell}_1\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathbf\"\u003eℓ\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3011em;\"\u003e\u003cspan style=\"top:-2.55em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e1\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"J2tfygq9Vy"},{"type":"text","value":" will be valid.","position":{"start":{"line":831,"column":1},"end":{"line":831,"column":1}},"key":"e4DLQAX6ys"}],"key":"hvoxpB3vwF"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"L = zeros(4, 4);\nU = zeros(4, 4);\nU(1, :) = A_1(i, :);\nL(:, 1) = A_1(:, 1) / U(1, 1);\nA_2 = A_1 - L(:, 1) * U(1, :)","key":"Yln7U1IABS"},{"type":"output","id":"DHUagyPxrpa2uVEubsVvp","data":[{"output_type":"execute_result","execution_count":81,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003eA_2 = 4×4 double\n         0    2.5000    0.5000   -2.0000\n         0   -2.5000    5.5000   -8.0000\n         0   16.2500    0.2500   -7.0000\n         0         0         0         0\n\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"A_2 = 4×4 double\n         0    2.5000    0.5000   -2.0000\n         0   -2.5000    5.5000   -8.0000\n         0   16.2500    0.2500   -7.0000\n         0         0         0         0\n","content_type":"text/plain"}}}],"key":"trfSq8EJhC"}],"data":{},"key":"jkIU8QgtQ7"},{"type":"paragraph","position":{"start":{"line":841,"column":1},"end":{"line":841,"column":1}},"children":[{"type":"text","value":"Observe that ","position":{"start":{"line":841,"column":1},"end":{"line":841,"column":1}},"key":"RsWjicwpPq"},{"type":"inlineMath","value":"\\mathbf{A}_2","position":{"start":{"line":841,"column":1},"end":{"line":841,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsub\u003e\u003cmi mathvariant=\"bold\"\u003eA\u003c/mi\u003e\u003cmn\u003e2\u003c/mn\u003e\u003c/msub\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\mathbf{A}_2\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8361em;vertical-align:-0.15em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathbf\"\u003eA\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3011em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e2\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"sWjwvQmIad"},{"type":"text","value":" has a new zero row and zero column, but the zero row is the fourth rather than the first. However, we forge on by using the largest possible pivot in column 2 for the next outer product.","position":{"start":{"line":841,"column":1},"end":{"line":841,"column":1}},"key":"pfTCW2Wlhm"}],"key":"rgBQtiDZ9V"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[~, i] = max( abs(A_2(:, 2)) )\nU(2, :) = A_2(i, :);\nL(:, 2) = A_2(:, 2) / U(2, 2);\nA_3 = A_2 - L(:, 2) * U(2, :)","key":"IqTNhRj0Ch"},{"type":"output","id":"Mj6Cb1mXkUfMHAsdtGCtl","data":[{"output_type":"execute_result","execution_count":82,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003ei = 3\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"i = 3","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":82,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003eA_3 = 4×4 double\n         0         0    0.4615   -0.9231\n         0         0    5.5385   -9.0769\n         0         0         0         0\n         0         0         0         0\n\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"A_3 = 4×4 double\n         0         0    0.4615   -0.9231\n         0         0    5.5385   -9.0769\n         0         0         0         0\n         0         0         0         0\n","content_type":"text/plain"}}}],"key":"OAVcEsIxQT"}],"data":{},"key":"EXAOVEZL4C"},{"type":"paragraph","position":{"start":{"line":850,"column":1},"end":{"line":850,"column":1}},"children":[{"type":"text","value":"Now we have zeroed out the third row as well as the second column. We can finish out the procedure.","position":{"start":{"line":850,"column":1},"end":{"line":850,"column":1}},"key":"IAjp3kqrzL"}],"key":"NxXu29gFOH"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[~, i] = max( abs(A_3(:, 3)) ) \nU(3, :) = A_3(i, :);\nL(:, 3) = A_3(:, 3) / U(3, 3);\nA_4 = A_3 - L(:, 3) * U(3, :)","key":"bo6HiHDEZh"},{"type":"output","id":"poKXu_CwZ3slABaiB9gk6","data":[{"output_type":"execute_result","execution_count":83,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003ei = 2\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"i = 2","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":83,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003eA_4 = 4×4 double\n         0         0         0   -0.1667\n         0         0         0         0\n         0         0         0         0\n         0         0         0         0\n\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"A_4 = 4×4 double\n         0         0         0   -0.1667\n         0         0         0         0\n         0         0         0         0\n         0         0         0         0\n","content_type":"text/plain"}}}],"key":"csoinG8das"}],"data":{},"key":"YFD4JIyYIx"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[~, i] = max( abs(A_4(:, 4)) ) \nU(4, :) = A_4(i, :);\nL(:, 4) = A_4(:, 4) / U(4, 4);","key":"ABRpWUvIjp"},{"type":"output","id":"5KfHz7etHxmF1VUTjlsB4","data":[{"output_type":"execute_result","execution_count":84,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003ei = 1\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"i = 1","content_type":"text/plain"}}}],"key":"WP5p3oLXZG"}],"data":{},"key":"XIb76ql38D"},{"type":"paragraph","position":{"start":{"line":865,"column":1},"end":{"line":865,"column":1}},"children":[{"type":"text","value":"We do have a factorization of the original matrix:","position":{"start":{"line":865,"column":1},"end":{"line":865,"column":1}},"key":"N59o613eL7"}],"key":"zkAnbOBnSG"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A_1 - L * U","key":"aet7RLFRKn"},{"type":"output","id":"9e6tw2dlvVMFCCnTWoq5v","data":[{"output_type":"execute_result","execution_count":85,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003eans = 4×4 double\n     0     0     0     0\n     0     0     0     0\n     0     0     0     0\n     0     0     0     0\n\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"ans = 4×4 double\n     0     0     0     0\n     0     0     0     0\n     0     0     0     0\n     0     0     0     0\n","content_type":"text/plain"}}}],"key":"oNx7CaVnWs"}],"data":{},"key":"RDQlrKXyO5"},{"type":"paragraph","position":{"start":{"line":871,"column":1},"end":{"line":871,"column":1}},"children":[{"type":"text","value":"And ","position":{"start":{"line":871,"column":1},"end":{"line":871,"column":1}},"key":"fjwfrvHj1h"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":871,"column":1},"end":{"line":871,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi mathvariant=\"bold\"\u003eU\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\mathbf{U}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6861em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathbf\"\u003eU\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"Mz8hlijlEK"},{"type":"text","value":" has the required structure:","position":{"start":{"line":871,"column":1},"end":{"line":871,"column":1}},"key":"DjZkbDjMBO"}],"key":"cMJmP6GXlr"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"U","key":"B25kbKeiZo"},{"type":"output","id":"_VvS6_tsP-hHwA0knF_XA","data":[{"output_type":"execute_result","execution_count":86,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003eU = 4×4 double\n   -4.0000    5.0000   -7.0000  -10.0000\n         0   16.2500    0.2500   -7.0000\n         0         0    5.5385   -9.0769\n         0         0         0   -0.1667\n\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"U = 4×4 double\n   -4.0000    5.0000   -7.0000  -10.0000\n         0   16.2500    0.2500   -7.0000\n         0         0    5.5385   -9.0769\n         0         0         0   -0.1667\n","content_type":"text/plain"}}}],"key":"OFpRb69KIw"}],"data":{},"key":"b6hCFva4qS"},{"type":"paragraph","position":{"start":{"line":877,"column":1},"end":{"line":877,"column":1}},"children":[{"type":"text","value":"However, the triangularity of ","position":{"start":{"line":877,"column":1},"end":{"line":877,"column":1}},"key":"eu2WJburcU"},{"type":"inlineMath","value":"\\mathbf{L}","position":{"start":{"line":877,"column":1},"end":{"line":877,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi mathvariant=\"bold\"\u003eL\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\mathbf{L}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6861em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathbf\"\u003eL\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"lSbpFbo6l9"},{"type":"text","value":" has been broken.","position":{"start":{"line":877,"column":1},"end":{"line":877,"column":1}},"key":"QijjZWxKv9"}],"key":"Wbp0ju9Vnj"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"L","key":"gdQbRZ1CpK"},{"type":"output","id":"8QbmSN5mFl0P-ZRi0B7yN","data":[{"output_type":"execute_result","execution_count":87,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003eL = 4×4 double\n   -0.5000    0.1538    0.0833    1.0000\n    0.5000   -0.1538    1.0000         0\n   -0.2500    1.0000         0         0\n    1.0000         0         0         0\n\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"L = 4×4 double\n   -0.5000    0.1538    0.0833    1.0000\n    0.5000   -0.1538    1.0000         0\n   -0.2500    1.0000         0         0\n    1.0000         0         0         0\n","content_type":"text/plain"}}}],"key":"q8ecj96Umb"}],"data":{},"key":"gXjvwavqge"}],"label":"demo-pivoting-fix-matlab","identifier":"demo-pivoting-fix-matlab","html_id":"demo-pivoting-fix-matlab","key":"vtMkho5CUQ"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Row permutation in ","key":"aKWCN9h9tE"},{"type":"abbreviation","title":"lower triangular times upper triangular","children":[{"type":"text","value":"LU","key":"J9I77ST8Yh"}],"key":"mIjeuIxWZY"},{"type":"text","value":" factorization","key":"kJu8x5huBx"}],"key":"CQz9N764Jt"},{"type":"paragraph","position":{"start":{"line":886,"column":1},"end":{"line":886,"column":1}},"children":[{"type":"text","value":"Here again is the matrix from ","position":{"start":{"line":886,"column":1},"end":{"line":886,"column":1}},"key":"cVNRstAwyh"},{"type":"crossReference","kind":"proof:example","identifier":"demo-pivoting-fix","label":"demo-pivoting-fix","children":[{"type":"text","value":"Demo ","key":"hIYoRA8VTc"},{"type":"text","value":"2.6.2","key":"Poa8XKMLMj"}],"template":"Example %s","enumerator":"2.6.2","resolved":true,"html_id":"demo-pivoting-fix","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"gu8go5oevv"},{"type":"text","value":".","position":{"start":{"line":886,"column":1},"end":{"line":886,"column":1}},"key":"gWw5H2HGLK"}],"key":"m5baBciPrA"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A = [2 0 4 3; -2 0 2 -13; 1 15 2 -4.5; -4 5 -7 -10]","key":"kanyyh0QJJ"},{"type":"output","id":"KpwqNnWbZftccaqm78U9o","data":[{"output_type":"execute_result","execution_count":88,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003eA = 4×4 double\n    2.0000         0    4.0000    3.0000\n   -2.0000         0    2.0000  -13.0000\n    1.0000   15.0000    2.0000   -4.5000\n   -4.0000    5.0000   -7.0000  -10.0000\n\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"A = 4×4 double\n    2.0000         0    4.0000    3.0000\n   -2.0000         0    2.0000  -13.0000\n    1.0000   15.0000    2.0000   -4.5000\n   -4.0000    5.0000   -7.0000  -10.0000\n","content_type":"text/plain"}}}],"key":"N87Y4aVDcp"}],"data":{},"key":"ro4iVDE6dq"},{"type":"paragraph","position":{"start":{"line":892,"column":1},"end":{"line":892,"column":1}},"children":[{"type":"text","value":"As the factorization proceeded, the pivots were selected from rows 4, 3, 2, and finally 1. If we were to put the rows of ","position":{"start":{"line":892,"column":1},"end":{"line":892,"column":1}},"key":"aKmpzO2XMD"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":892,"column":1},"end":{"line":892,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi mathvariant=\"bold\"\u003eA\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\mathbf{A}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6861em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathbf\"\u003eA\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"V8Bh5RSefL"},{"type":"text","value":" into that order, then the algorithm would run exactly like the plain ","key":"YPL6oV8Co5"},{"type":"abbreviation","title":"lower triangular times upper triangular","children":[{"type":"text","value":"LU","key":"nr3FFuxjcR"}],"key":"OcR1TAhKV0"},{"type":"text","value":" factorization from ","key":"hSRfsENsu9"},{"type":"link","kind":"numref","identifier":"section-linsys-lu","label":"section-linsys-lu","url":"/lu","internal":true,"dataUrl":"/lu.json","children":[{"type":"text","value":"LU factorization","key":"QDEbsCu5J7"}],"key":"UBHCgBzCM0"},{"type":"text","value":".","position":{"start":{"line":892,"column":1},"end":{"line":892,"column":1}},"key":"BOHLm1akez"}],"key":"W4ymDCfv1X"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"B = A([4, 3, 2, 1], :);\n[L, U] = lufact(B);","key":"Pw5duqQIgz"},{"type":"output","id":"s6QoaIWKKftKQr-ZNb33O","data":[],"key":"vCl6SiP98S"}],"data":{},"key":"TsxJeXjUzX"},{"type":"paragraph","position":{"start":{"line":899,"column":1},"end":{"line":899,"column":1}},"children":[{"type":"text","value":"We obtain the same ","position":{"start":{"line":899,"column":1},"end":{"line":899,"column":1}},"key":"OllImuLKqu"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":899,"column":1},"end":{"line":899,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi mathvariant=\"bold\"\u003eU\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\mathbf{U}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6861em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathbf\"\u003eU\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"G5HMhRP80u"},{"type":"text","value":" as before:","position":{"start":{"line":899,"column":1},"end":{"line":899,"column":1}},"key":"HdqKO8lrgm"}],"key":"dQiySD82qu"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"U","key":"DRId9PRXco"},{"type":"output","id":"4gDwsXrneKMqZNpAbdExg","data":[{"output_type":"execute_result","execution_count":90,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003eU = 4×4 double\n   -4.0000    5.0000   -7.0000  -10.0000\n         0   16.2500    0.2500   -7.0000\n         0         0    5.5385   -9.0769\n         0         0         0   -0.1667\n\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"U = 4×4 double\n   -4.0000    5.0000   -7.0000  -10.0000\n         0   16.2500    0.2500   -7.0000\n         0         0    5.5385   -9.0769\n         0         0         0   -0.1667\n","content_type":"text/plain"}}}],"key":"a5iIvlBWzx"}],"data":{},"key":"sAPAzYc70a"},{"type":"paragraph","position":{"start":{"line":905,"column":1},"end":{"line":905,"column":1}},"children":[{"type":"text","value":"And ","position":{"start":{"line":905,"column":1},"end":{"line":905,"column":1}},"key":"Onm5jV17C6"},{"type":"inlineMath","value":"\\mathbf{L}","position":{"start":{"line":905,"column":1},"end":{"line":905,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi mathvariant=\"bold\"\u003eL\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\mathbf{L}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6861em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathbf\"\u003eL\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"ASb6gr6cCX"},{"type":"text","value":" has the same rows as before, but arranged into triangular order:","position":{"start":{"line":905,"column":1},"end":{"line":905,"column":1}},"key":"kg5IzhwdWO"}],"key":"qOd72t8c5S"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"L","key":"oXjyC8dXIt"},{"type":"output","id":"cnrqPTb8Ap3Ea1mYllfQT","data":[{"output_type":"execute_result","execution_count":91,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003eL = 4×4 double\n    1.0000         0         0         0\n   -0.2500    1.0000         0         0\n    0.5000   -0.1538    1.0000         0\n   -0.5000    0.1538    0.0833    1.0000\n\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"L = 4×4 double\n    1.0000         0         0         0\n   -0.2500    1.0000         0         0\n    0.5000   -0.1538    1.0000         0\n   -0.5000    0.1538    0.0833    1.0000\n","content_type":"text/plain"}}}],"key":"cJQenqQtnu"}],"data":{},"key":"OBHyOHjfNo"}],"label":"demo-pivoting-permute-matlab","identifier":"demo-pivoting-permute-matlab","html_id":"demo-pivoting-permute-matlab","key":"eVBazG2QXg"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"P","key":"wO0SImhuJi"},{"type":"abbreviation","title":"lower triangular times upper triangular","children":[{"type":"text","value":"LU","key":"CDyXpjRfA7"}],"key":"BCnxpBJ8Hi"},{"type":"text","value":" factorization for solving linear systems","key":"xc92JHEwkn"}],"key":"k8j2IWRYlN"},{"type":"paragraph","position":{"start":{"line":914,"column":1},"end":{"line":914,"column":1}},"children":[{"type":"text","value":"The third output of ","position":{"start":{"line":914,"column":1},"end":{"line":914,"column":1}},"key":"CLqiBPrke5"},{"type":"inlineCode","value":"plufact","position":{"start":{"line":914,"column":1},"end":{"line":914,"column":1}},"key":"OzfEUNnOsq"},{"type":"text","value":" is the permutation vector we need to apply to ","position":{"start":{"line":914,"column":1},"end":{"line":914,"column":1}},"key":"VxgK48zu79"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":914,"column":1},"end":{"line":914,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi mathvariant=\"bold\"\u003eA\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\mathbf{A}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6861em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathbf\"\u003eA\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"Je3mPXRCje"},{"type":"text","value":".","position":{"start":{"line":914,"column":1},"end":{"line":914,"column":1}},"key":"IHckr8OjM1"}],"key":"dv6CFOynkW"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A = randi(20, 4, 4);\n[L, U, p] = plufact(A);\nA(p, :) - L * U    % should be ≈ 0","key":"ktOmTJjh6G"},{"type":"output","id":"5BCgIzKcfA5cKkV3x4OMd","data":[{"output_type":"execute_result","execution_count":92,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003eans = 4×4 double\n     0     0     0     0\n     0     0     0     0\n     0     0     0     0\n     0     0     0     0\n\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"ans = 4×4 double\n     0     0     0     0\n     0     0     0     0\n     0     0     0     0\n     0     0     0     0\n","content_type":"text/plain"}}}],"key":"i9uaNGAVRk"}],"data":{},"key":"sPYrbrRcM0"},{"type":"paragraph","position":{"start":{"line":922,"column":1},"end":{"line":922,"column":1}},"children":[{"type":"text","value":"Given a vector ","position":{"start":{"line":922,"column":1},"end":{"line":922,"column":1}},"key":"mAEv2AXsO0"},{"type":"inlineMath","value":"\\mathbf{b}","position":{"start":{"line":922,"column":1},"end":{"line":922,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi mathvariant=\"bold\"\u003eb\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\mathbf{b}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathbf\"\u003eb\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"DfixC999AY"},{"type":"text","value":", we solve ","position":{"start":{"line":922,"column":1},"end":{"line":922,"column":1}},"key":"fc4KuSlUI9"},{"type":"inlineMath","value":"\\mathbf{A}\\mathbf{x}=\\mathbf{b}","position":{"start":{"line":922,"column":1},"end":{"line":922,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi mathvariant=\"bold\"\u003eA\u003c/mi\u003e\u003cmi mathvariant=\"bold\"\u003ex\u003c/mi\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmi mathvariant=\"bold\"\u003eb\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\mathbf{A}\\mathbf{x}=\\mathbf{b}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6861em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathbf\"\u003eAx\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathbf\"\u003eb\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"QpvxGQ2oJ3"},{"type":"text","value":" by first permuting the entries of ","position":{"start":{"line":922,"column":1},"end":{"line":922,"column":1}},"key":"RW78zKCMGJ"},{"type":"inlineMath","value":"\\mathbf{b}","position":{"start":{"line":922,"column":1},"end":{"line":922,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi mathvariant=\"bold\"\u003eb\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\mathbf{b}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathbf\"\u003eb\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"QBwEL3MZyZ"},{"type":"text","value":" and then proceeding as before.","position":{"start":{"line":922,"column":1},"end":{"line":922,"column":1}},"key":"l6fqfokUz1"}],"key":"KdCui6gHel"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"b = rand(4, 1);\nz = forwardsub(L, b(p));\nx = backsub(U, z)","key":"waeva3C1IF"},{"type":"output","id":"3i8iVtW05KOVVXL21Y8n3","data":[{"output_type":"execute_result","execution_count":93,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003ex = 4×1 double\n    0.0134\n    0.0086\n    0.0058\n    0.0199\n\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"x = 4×1 double\n    0.0134\n    0.0086\n    0.0058\n    0.0199\n","content_type":"text/plain"}}}],"key":"hY0BPXZ5zN"}],"data":{},"key":"ga9Cu8rdXU"},{"type":"paragraph","position":{"start":{"line":930,"column":1},"end":{"line":930,"column":1}},"children":[{"type":"text","value":"A residual check is successful:","position":{"start":{"line":930,"column":1},"end":{"line":930,"column":1}},"key":"zqRzpypgtf"}],"key":"WM19tyZHe1"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"b - A*x","key":"GMG1zNaDLD"},{"type":"output","id":"O3DK9gcfpw0nS5QpWK2uz","data":[{"output_type":"execute_result","execution_count":94,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003eans = 4×1 double\n1.0e-16 *\n\n         0\n    0.5551\n         0\n         0\n\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"ans = 4×1 double\n1.0e-16 *\n\n         0\n    0.5551\n         0\n         0\n","content_type":"text/plain"}}}],"key":"r4kPL0FNss"}],"data":{},"key":"ZEOb7PdXzD"}],"label":"demo-pivoting-usage-matlab","identifier":"demo-pivoting-usage-matlab","html_id":"demo-pivoting-usage-matlab","key":"uxZPzm0Req"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Built-in P","key":"Wib0vO8641"},{"type":"abbreviation","title":"lower triangular times upper triangular","children":[{"type":"text","value":"LU","key":"YCtCBnU99Y"}],"key":"d5OdhMBV0v"},{"type":"text","value":" factorization","key":"YSup8M9Hru"}],"key":"TM91VwUdF7"},{"type":"paragraph","position":{"start":{"line":939,"column":1},"end":{"line":939,"column":1}},"children":[{"type":"text","value":"With the syntax ","position":{"start":{"line":939,"column":1},"end":{"line":939,"column":1}},"key":"HDXkhajFbQ"},{"type":"inlineCode","value":"A \\ b","position":{"start":{"line":939,"column":1},"end":{"line":939,"column":1}},"key":"C2nyaqE5g6"},{"type":"text","value":", the matrix ","position":{"start":{"line":939,"column":1},"end":{"line":939,"column":1}},"key":"FAziKZZHxI"},{"type":"inlineCode","value":"A","position":{"start":{"line":939,"column":1},"end":{"line":939,"column":1}},"key":"vXZW6IPg3a"},{"type":"text","value":" is P","key":"mJOBZebDee"},{"type":"abbreviation","title":"lower triangular times upper triangular","children":[{"type":"text","value":"LU","key":"krhce7IVMo"}],"key":"xbtFwvx2Ye"},{"type":"text","value":"-factored, followed by two triangular solves.","key":"Z4XIk3m6c0"}],"key":"phjEFIsAxV"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A = randn(500, 500);    % 500x500 with normal random entries\ntic; for k=1:50; A \\ rand(500, 1); end; toc","key":"hife2IV6uq"},{"type":"output","id":"2m3C9lodNeC_QjKjNHL4J","data":[{"output_type":"stream","name":"stdout","text":"Elapsed time is 0.526734 seconds.\n"}],"key":"TlSRCEIRAM"}],"data":{},"key":"X5jnYLOXYG"},{"type":"paragraph","position":{"start":{"line":946,"column":1},"end":{"line":946,"column":1}},"children":[{"type":"text","value":"In ","position":{"start":{"line":946,"column":1},"end":{"line":946,"column":1}},"key":"D3DYP0UMeO"},{"type":"link","kind":"numref","identifier":"section-linsys-efficiency","label":"section-linsys-efficiency","url":"/efficiency","internal":true,"dataUrl":"/efficiency.json","children":[{"type":"text","value":"Efficiency of matrix computations","key":"YpBhHQkbNH"}],"key":"A3SUN47BvY"},{"type":"text","value":" we showed that the factorization is by far the most costly part of the solution process. A factorization object allows us to do that costly step only once per unique matrix.","position":{"start":{"line":946,"column":1},"end":{"line":946,"column":1}},"key":"PT1PNtkqVD"}],"key":"yTOpDpp4uA"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[L, U, p] = lu(A, 'vector');    % keep factorization result\ntic\nfor k=1:50\n    b = rand(500, 1);\n    U \\ (L \\ b(p));\nend\ntoc","key":"Qjf5LKHjX2"},{"type":"output","id":"7SumElGnHeagEf4-6wM_r","data":[{"output_type":"stream","name":"stdout","text":"Elapsed time is 0.009369 seconds.\n"}],"key":"d9V199GyDd"}],"data":{},"key":"VjRd3LJBbx"}],"label":"demo-pivoting-builtin-matlab","identifier":"demo-pivoting-builtin-matlab","html_id":"demo-pivoting-builtin-matlab","key":"kCC5paJ4Ml"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Stability of P","key":"NT0fDbx0av"},{"type":"abbreviation","title":"lower triangular times upper triangular","children":[{"type":"text","value":"LU","key":"K3f4gUlhcx"}],"key":"tdwXOLiPXV"},{"type":"text","value":" factorization","key":"BggA7W4a55"}],"key":"VKwhMJKZHc"},{"type":"paragraph","position":{"start":{"line":961,"column":1},"end":{"line":961,"column":1}},"children":[{"type":"text","value":"We construct a linear system for this matrix with ","position":{"start":{"line":961,"column":1},"end":{"line":961,"column":1}},"key":"OtsDA2RD5I"},{"type":"inlineMath","value":"\\epsilon=10^{-12}","position":{"start":{"line":961,"column":1},"end":{"line":961,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003eϵ\u003c/mi\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmn\u003e1\u003c/mn\u003e\u003cmsup\u003e\u003cmn\u003e0\u003c/mn\u003e\u003cmrow\u003e\u003cmo\u003e−\u003c/mo\u003e\u003cmn\u003e12\u003c/mn\u003e\u003c/mrow\u003e\u003c/msup\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\epsilon=10^{-12}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.4306em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003eϵ\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8141em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e1\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003e0\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.8141em;\"\u003e\u003cspan style=\"top:-3.063em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e−\u003c/span\u003e\u003cspan class=\"mord mtight\"\u003e12\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"xBE7u9ahPO"},{"type":"text","value":" and exact solution ","position":{"start":{"line":961,"column":1},"end":{"line":961,"column":1}},"key":"VDhcjXnGZ8"},{"type":"inlineMath","value":"[1, 1]","position":{"start":{"line":961,"column":1},"end":{"line":961,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmo stretchy=\"false\"\u003e[\u003c/mo\u003e\u003cmn\u003e1\u003c/mn\u003e\u003cmo separator=\"true\"\u003e,\u003c/mo\u003e\u003cmn\u003e1\u003c/mn\u003e\u003cmo stretchy=\"false\"\u003e]\u003c/mo\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e[1, 1]\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mopen\"\u003e[\u003c/span\u003e\u003cspan class=\"mord\"\u003e1\u003c/span\u003e\u003cspan class=\"mpunct\"\u003e,\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.1667em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e1\u003c/span\u003e\u003cspan class=\"mclose\"\u003e]\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"vZmcPRNHhc"},{"type":"text","value":":","position":{"start":{"line":961,"column":1},"end":{"line":961,"column":1}},"key":"LK0b9mM1En"}],"key":"HD23RU9ARg"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"ep = 1e-12\nA = [-ep 1; 1 -1];\nb = A * [1; 1];","key":"YeIZdg0wZg"},{"type":"output","id":"Bf0IRE4fuFwzqRcOtqX2x","data":[{"output_type":"execute_result","execution_count":97,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003eep = 1.0000e-12\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"ep = 1.0000e-12","content_type":"text/plain"}}}],"key":"NASuI3O1Ay"}],"data":{},"key":"pXzWWmBjGV"},{"type":"paragraph","position":{"start":{"line":969,"column":1},"end":{"line":969,"column":1}},"children":[{"type":"text","value":"We can factor the matrix without pivoting and solve for ","position":{"start":{"line":969,"column":1},"end":{"line":969,"column":1}},"key":"e497DxqWdN"},{"type":"inlineMath","value":"\\mathbf{x}","position":{"start":{"line":969,"column":1},"end":{"line":969,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi mathvariant=\"bold\"\u003ex\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\mathbf{x}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.4444em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathbf\"\u003ex\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"s27pUdznc1"},{"type":"text","value":".","position":{"start":{"line":969,"column":1},"end":{"line":969,"column":1}},"key":"RIWlg2MuCv"}],"key":"cOl6gjKMZf"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[L, U] = lufact(A);\nx = backsub( U, forwardsub(L, b) )","key":"tOo1bbpvha"},{"type":"output","id":"bgXZDvP-5S36HB3zOYDaR","data":[{"output_type":"execute_result","execution_count":98,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003ex = 2×1 double\n    1.0000\n    1.0000\n\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"x = 2×1 double\n    1.0000\n    1.0000\n","content_type":"text/plain"}}}],"key":"couFebtAJc"}],"data":{},"key":"I7sesBv7KV"},{"type":"paragraph","position":{"start":{"line":976,"column":1},"end":{"line":976,"column":1}},"children":[{"type":"text","value":"Note that we have obtained only about 5 accurate digits for ","position":{"start":{"line":976,"column":1},"end":{"line":976,"column":1}},"key":"SfAtBRk7dh"},{"type":"inlineMath","value":"x_1","position":{"start":{"line":976,"column":1},"end":{"line":976,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsub\u003e\u003cmi\u003ex\u003c/mi\u003e\u003cmn\u003e1\u003c/mn\u003e\u003c/msub\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003ex_1\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003ex\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3011em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e1\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"CPLbeMCyov"},{"type":"text","value":". We could make the result even more inaccurate by making ","position":{"start":{"line":976,"column":1},"end":{"line":976,"column":1}},"key":"ZgjB5NqEZO"},{"type":"text","value":"ε","position":{"start":{"line":976,"column":1},"end":{"line":976,"column":1}},"key":"UCIMUcT0jZ"},{"type":"text","value":" even smaller:","position":{"start":{"line":976,"column":1},"end":{"line":976,"column":1}},"key":"CTrupxw7D0"}],"key":"GpoOVmJEIW"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"ep = 1e-20; A = [-ep 1; 1 -1];\nb = A * [1; 1];\n[L, U] = lufact(A);\nx = backsub( U, forwardsub(L, b) )","key":"HeJ2fP5M0T"},{"type":"output","id":"BEQgAjQgDVKoezuuAbyB7","data":[{"output_type":"execute_result","execution_count":99,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003ex = 2×1 double\n     0\n     1\n\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"x = 2×1 double\n     0\n     1\n","content_type":"text/plain"}}}],"key":"DiQVAPJPlD"}],"data":{},"key":"xMkEgNgzel"},{"type":"paragraph","position":{"start":{"line":985,"column":1},"end":{"line":985,"column":1}},"children":[{"type":"text","value":"This effect is not due to ill conditioning of the problem—a solution with P","key":"hlE60H23ZN"},{"type":"abbreviation","title":"lower triangular times upper triangular","children":[{"type":"text","value":"LU","key":"oth4TLqp5R"}],"key":"D6hU4VR4R1"},{"type":"text","value":" factorization works perfectly:","key":"eEqkYwp1yN"}],"key":"InKlpBd0aR"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A \\ b","key":"DwCv9gnVLF"},{"type":"output","id":"kIEjb47hrxK_5jQiz60J5","data":[{"output_type":"execute_result","execution_count":100,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003eans = 2×1 double\n     1\n     1\n\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"ans = 2×1 double\n     1\n     1\n","content_type":"text/plain"}}}],"key":"kVkRqu3gOl"}],"data":{},"key":"UTBx277qFK"}],"label":"demo-pivoting-stable-matlab","identifier":"demo-pivoting-stable-matlab","html_id":"demo-pivoting-stable-matlab","key":"ZPsjVjgawz"},{"type":"heading","depth":3,"position":{"start":{"line":992,"column":1},"end":{"line":992,"column":1}},"children":[{"type":"text","value":"Section 2.7","position":{"start":{"line":992,"column":1},"end":{"line":992,"column":1}},"key":"tLVvJoTF1g"}],"identifier":"section-2-7","label":"Section 2.7","html_id":"section-2-7","implicit":true,"key":"DruIoszXtm"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Vector norms","position":{"start":{"line":994,"column":1},"end":{"line":994,"column":1}},"key":"jUmtH0mMb2"}],"key":"M2ntQJLkhm"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"x = [2; -3; 1; -1];\ntwonorm = norm(x)    % or norm(x, 2)","key":"OGlWLjAFYk"},{"type":"output","id":"1vC4fSSFrWcoO8q6SKM0t","data":[{"output_type":"execute_result","execution_count":101,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003etwonorm = 3.8730\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"twonorm = 3.8730","content_type":"text/plain"}}}],"key":"N3p229WviW"}],"data":{},"indexEntries":[{"entry":"MATLAB","subEntry":{"value":"norm","kind":"entry"},"emphasis":true}],"label":"index-AVSqwPfkzw","identifier":"index-avsqwpfkzw","html_id":"index-avsqwpfkzw","key":"usM4U1n8xc"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"infnorm = norm(x, Inf)","key":"qBiPHIMJfq"},{"type":"output","id":"xmoXRdZ8GxOO1_W0H9bc_","data":[{"output_type":"execute_result","execution_count":102,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003einfnorm = 3\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"infnorm = 3","content_type":"text/plain"}}}],"key":"KIbl5jWeqM"}],"data":{},"key":"hFl3SLBPOO"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"onenorm = norm(x, 1)","key":"ylZdiRnNSC"},{"type":"output","id":"qRjrFnXewukNrL2RhzwWJ","data":[{"output_type":"execute_result","execution_count":103,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003eonenorm = 7\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"onenorm = 7","content_type":"text/plain"}}}],"key":"VOXEOAa3SR"}],"data":{},"key":"wvZd5n6Sai"}],"label":"demo-norms-vector-matlab","identifier":"demo-norms-vector-matlab","html_id":"demo-norms-vector-matlab","key":"lbpwlEtdTk"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Matrix norms","position":{"start":{"line":1013,"column":1},"end":{"line":1013,"column":1}},"key":"FODL2vXYoh"}],"key":"F4PetToP8s"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A = [ 2 0; 1 -1 ]","key":"CSp7CXy0f8"},{"type":"output","id":"rRUnEbHOq5OH6xrs_QfhS","data":[{"output_type":"execute_result","execution_count":104,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003eA = 2×2 double\n     2     0\n     1    -1\n\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"A = 2×2 double\n     2     0\n     1    -1\n","content_type":"text/plain"}}}],"key":"nlM7aqe8vs"}],"data":{},"key":"a8UWTmHGzE"},{"type":"paragraph","position":{"start":{"line":1022,"column":1},"end":{"line":1022,"column":1}},"children":[{"type":"text","value":"The default matrix norm is the 2-norm.","position":{"start":{"line":1022,"column":1},"end":{"line":1022,"column":1}},"key":"YuE7GwCsss"}],"indexEntries":[{"entry":"MATLAB","subEntry":{"value":"norm","kind":"entry"},"emphasis":true}],"label":"index-CvasA6MZPf","identifier":"index-cvasa6mzpf","html_id":"index-cvasa6mzpf","key":"O16UoeGhXc"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"twonorm = norm(A)","key":"OUwud5tGE1"},{"type":"output","id":"aSGufsX6Ud1huhM1yxr71","data":[{"output_type":"execute_result","execution_count":105,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003etwonorm = 2.2882\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"twonorm = 2.2882","content_type":"text/plain"}}}],"key":"Kow4CfxTUl"}],"data":{},"key":"VyGjC2ALf7"},{"type":"paragraph","position":{"start":{"line":1028,"column":1},"end":{"line":1028,"column":1}},"children":[{"type":"text","value":"You can get the 1-norm as well.","position":{"start":{"line":1028,"column":1},"end":{"line":1028,"column":1}},"key":"LAKCduyZai"}],"key":"UoZloQcNDY"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"onenorm = norm(A, 1)","key":"x8HTQSTjkW"},{"type":"output","id":"HKKRuf64UhBu1Xm_WNnFp","data":[{"output_type":"execute_result","execution_count":106,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003eonenorm = 3\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"onenorm = 3","content_type":"text/plain"}}}],"key":"y8FbpYGt7P"}],"data":{},"key":"kJJra0x71m"},{"type":"grid","columns":[1,1,2,2],"children":[{"type":"paragraph","position":{"start":{"line":1038,"column":1},"end":{"line":1038,"column":1}},"children":[{"type":"text","value":"According to ","position":{"start":{"line":1038,"column":1},"end":{"line":1038,"column":1}},"key":"Y7RmIAlhWd"},{"type":"crossReference","kind":"equation","identifier":"mxonenorm","label":"mxonenorm","children":[{"type":"text","value":"(","key":"YVcU85Z1nS"},{"type":"text","value":"2.7.15","key":"k5AE9w99GJ"},{"type":"text","value":")","key":"wIhXEMTeYC"}],"template":"(%s)","enumerator":"2.7.15","resolved":true,"html_id":"mxonenorm","remote":true,"url":"/norms","dataUrl":"/norms.json","key":"WbHMOyw1K9"},{"type":"text","value":", the matrix 1-norm is equivalent to the maximum of the sums down the columns (in absolute value).","position":{"start":{"line":1038,"column":1},"end":{"line":1038,"column":1}},"key":"XJMJoypJzL"}],"key":"UKEdsgaELJ"},{"type":"card","children":[{"type":"paragraph","position":{"start":{"line":1040,"column":1},"end":{"line":1040,"column":1}},"children":[{"type":"text","value":"Use ","position":{"start":{"line":1040,"column":1},"end":{"line":1040,"column":1}},"key":"Ey9l1f2jS8"},{"type":"inlineCode","value":"sum","position":{"start":{"line":1040,"column":1},"end":{"line":1040,"column":1}},"key":"U0nfbf2Ry5"},{"type":"text","value":" to sum along a dimension of a matrix. The ","position":{"start":{"line":1040,"column":1},"end":{"line":1040,"column":1}},"key":"cqO001S3Sr"},{"type":"inlineCode","value":"max","position":{"start":{"line":1040,"column":1},"end":{"line":1040,"column":1}},"key":"Ed4j5bG2XH"},{"type":"text","value":" and ","position":{"start":{"line":1040,"column":1},"end":{"line":1040,"column":1}},"key":"IIAH52FITT"},{"type":"inlineCode","value":"min","position":{"start":{"line":1040,"column":1},"end":{"line":1040,"column":1}},"key":"gpJ3gXZ5i0"},{"type":"text","value":" functions also work along one dimension.","position":{"start":{"line":1040,"column":1},"end":{"line":1040,"column":1}},"key":"Rw7RGpa26S"}],"key":"g8FodX0HEY"}],"key":"Z2QYHp6I0F"}],"indexEntries":[{"entry":"MATLAB","subEntry":{"value":"max","kind":"entry"},"emphasis":true},{"entry":"MATLAB","subEntry":{"value":"sum","kind":"entry"},"emphasis":true}],"label":"index-v60n5NSAp1","identifier":"index-v60n5nsap1","html_id":"index-v60n5nsap1","key":"oJnDEgQaFa"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"% Sum down the rows (1st matrix dimension):\nmax( sum(abs(A), 1) )","key":"OzNrtd9RT8"},{"type":"output","id":"JpnrOpxA_Y3LS1gR4RsIK","data":[{"output_type":"execute_result","execution_count":107,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003eans = 3\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"ans = 3","content_type":"text/plain"}}}],"key":"zLHdAwviuk"}],"data":{},"key":"s27UUi6emp"},{"type":"paragraph","position":{"start":{"line":1049,"column":1},"end":{"line":1049,"column":1}},"children":[{"type":"text","value":"Similarly, we can get the ","position":{"start":{"line":1049,"column":1},"end":{"line":1049,"column":1}},"key":"NJDloqwfEp"},{"type":"text","value":"∞","position":{"start":{"line":1049,"column":1},"end":{"line":1049,"column":1}},"key":"lZSoF8w508"},{"type":"text","value":"-norm and check our formula for it.","position":{"start":{"line":1049,"column":1},"end":{"line":1049,"column":1}},"key":"L2GYdJzyMm"}],"key":"X5MXfy67RM"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"infnorm = norm(A, Inf)","key":"hepzxheDsW"},{"type":"output","id":"M9CUO8UiSb62AXKE8fq_4","data":[{"output_type":"execute_result","execution_count":108,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003einfnorm = 2\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"infnorm = 2","content_type":"text/plain"}}}],"key":"nUCbVnEeQ9"}],"data":{},"key":"j2cDdqnoki"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"% Sum across columns (2nd matrix dimension):\nmax( sum(abs(A), 2) )","key":"NBwWYpKFCn"},{"type":"output","id":"DcW7R546q5PXrk6UVQm4V","data":[{"output_type":"execute_result","execution_count":109,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003eans = 2\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"ans = 2","content_type":"text/plain"}}}],"key":"JuvV7mGPDv"}],"data":{},"key":"SAJCEDS9OI"},{"type":"grid","columns":[1,1,2,2],"children":[{"type":"paragraph","position":{"start":{"line":1060,"column":1},"end":{"line":1060,"column":1}},"children":[{"type":"text","value":"Next we illustrate a geometric interpretation of the 2-norm. First, we will sample a lot of vectors on the unit circle in ","position":{"start":{"line":1060,"column":1},"end":{"line":1060,"column":1}},"key":"tr7wINRhLo"},{"type":"inlineMath","value":"\\mathbb{R}^2","position":{"start":{"line":1060,"column":1},"end":{"line":1060,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsup\u003e\u003cmi mathvariant=\"double-struck\"\u003eR\u003c/mi\u003e\u003cmn\u003e2\u003c/mn\u003e\u003c/msup\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\mathbb{R}^2\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8141em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathbb\"\u003eR\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.8141em;\"\u003e\u003cspan style=\"top:-3.063em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e2\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"W6KvyrweiF"},{"type":"text","value":".","position":{"start":{"line":1060,"column":1},"end":{"line":1060,"column":1}},"key":"QhDe6G2ZC2"}],"key":"y1HU5stiW9"},{"type":"card","children":[{"type":"paragraph","position":{"start":{"line":1062,"column":1},"end":{"line":1062,"column":1}},"children":[{"type":"text","value":"You can use functions as values, e.g., as elements of a vector.","position":{"start":{"line":1062,"column":1},"end":{"line":1062,"column":1}},"key":"SE2Z4HGYXl"}],"key":"RbQDJPFZxb"}],"key":"UyEFsG9x2M"}],"key":"gttN13PIt6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"theta = linspace(0, 2*pi, 601);\nx = [ cos(theta); sin(theta) ];    % 601 unit column vectors\nclf\nsubplot(1, 2, 1)\nplot(x(1, :), x(2, :)), axis equal\ntitle('Unit circle in 2-norm')\nxlabel('x_1')\nylabel('x_2')","key":"ZXV63Gdzos"},{"type":"output","id":"738UTgnHVvhhPDPEtHFPa","data":[{"output_type":"execute_result","execution_count":110,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"5cb8ba72876a14f69a63012abc660f08","path":"/fnc/build/5cb8ba72876a14f69a63012abc660f08.png"}}}],"key":"JBvqWfj8qt"}],"data":{},"indexEntries":[{"entry":"MATLAB","subEntry":{"value":"subplot","kind":"entry"},"emphasis":true}],"label":"index-PsHFAuSRNB","identifier":"index-pshfausrnb","html_id":"index-pshfausrnb","key":"ZU9On2UZbG"},{"type":"paragraph","position":{"start":{"line":1080,"column":1},"end":{"line":1080,"column":1}},"children":[{"type":"text","value":"The linear function ","position":{"start":{"line":1080,"column":1},"end":{"line":1080,"column":1}},"key":"IMcchLKtUO"},{"type":"inlineMath","value":"\\mathbf{f}(\\mathbf{x}) = \\mathbf{A}\\mathbf{x}","position":{"start":{"line":1080,"column":1},"end":{"line":1080,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi mathvariant=\"bold\"\u003ef\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmi mathvariant=\"bold\"\u003ex\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmi mathvariant=\"bold\"\u003eA\u003c/mi\u003e\u003cmi mathvariant=\"bold\"\u003ex\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\mathbf{f}(\\mathbf{x}) = \\mathbf{A}\\mathbf{x}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathbf\" style=\"margin-right:0.10903em;\"\u003ef\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord mathbf\"\u003ex\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6861em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathbf\"\u003eAx\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"kaUDFGOnnP"},{"type":"text","value":" defines a mapping from ","position":{"start":{"line":1080,"column":1},"end":{"line":1080,"column":1}},"key":"paZp48ao5Y"},{"type":"inlineMath","value":"\\mathbb{R}^2","position":{"start":{"line":1080,"column":1},"end":{"line":1080,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsup\u003e\u003cmi mathvariant=\"double-struck\"\u003eR\u003c/mi\u003e\u003cmn\u003e2\u003c/mn\u003e\u003c/msup\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\mathbb{R}^2\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8141em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathbb\"\u003eR\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.8141em;\"\u003e\u003cspan style=\"top:-3.063em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e2\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"H3nQsMidBF"},{"type":"text","value":" to ","position":{"start":{"line":1080,"column":1},"end":{"line":1080,"column":1}},"key":"I9HfzKBmdb"},{"type":"inlineMath","value":"\\mathbb{R}^2","position":{"start":{"line":1080,"column":1},"end":{"line":1080,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsup\u003e\u003cmi mathvariant=\"double-struck\"\u003eR\u003c/mi\u003e\u003cmn\u003e2\u003c/mn\u003e\u003c/msup\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\mathbb{R}^2\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8141em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathbb\"\u003eR\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.8141em;\"\u003e\u003cspan style=\"top:-3.063em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e2\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"XWhuO7TYCd"},{"type":"text","value":". We can apply ","position":{"start":{"line":1080,"column":1},"end":{"line":1080,"column":1}},"key":"mBYeCCrnZt"},{"type":"inlineCode","value":"A","position":{"start":{"line":1080,"column":1},"end":{"line":1080,"column":1}},"key":"wHDVfPriTB"},{"type":"text","value":" to every column of ","position":{"start":{"line":1080,"column":1},"end":{"line":1080,"column":1}},"key":"ENfaFzNz7J"},{"type":"inlineCode","value":"x","position":{"start":{"line":1080,"column":1},"end":{"line":1080,"column":1}},"key":"jVkwn3WPGR"},{"type":"text","value":" by using a single matrix multiplication.","position":{"start":{"line":1080,"column":1},"end":{"line":1080,"column":1}},"key":"f6ew71p1YA"}],"key":"xTI9NODlrT"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"Ax = A * x;","key":"AEQKrjo2R0"},{"type":"output","id":"tCctfSTcClgxWJRuofARs","data":[],"key":"xpsWbsZAix"}],"data":{},"key":"BvQjEm2JaB"},{"type":"paragraph","position":{"start":{"line":1086,"column":1},"end":{"line":1086,"column":1}},"children":[{"type":"text","value":"The image of the transformed vectors is an ellipse that just touches the circle of radius ","position":{"start":{"line":1086,"column":1},"end":{"line":1086,"column":1}},"key":"yz9aNx7r3J"},{"type":"inlineMath","value":"\\|\\mathbf{A}\\|_2","position":{"start":{"line":1086,"column":1},"end":{"line":1086,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi mathvariant=\"normal\"\u003e∥\u003c/mi\u003e\u003cmi mathvariant=\"bold\"\u003eA\u003c/mi\u003e\u003cmsub\u003e\u003cmi mathvariant=\"normal\"\u003e∥\u003c/mi\u003e\u003cmn\u003e2\u003c/mn\u003e\u003c/msub\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\|\\mathbf{A}\\|_2\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e∥\u003c/span\u003e\u003cspan class=\"mord mathbf\"\u003eA\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003e∥\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3011em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e2\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"wWcyhgykDW"},{"type":"text","value":":","position":{"start":{"line":1086,"column":1},"end":{"line":1086,"column":1}},"key":"FTtr5yB7sO"}],"key":"n9eWnj4zhz"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"subplot(1,2,2), plot(Ax(1,:), Ax(2,:)), axis equal\nhold on, plot(twonorm * x(1,:), twonorm * x(2,:), '--')\ntitle('Image of Ax, with ||A||')\nxlabel('x_1')\nylabel('x_2')","key":"JK7M7vH6As"},{"type":"output","id":"YMPS1e_b5lwHNJRhrL4Ll","data":[{"output_type":"execute_result","execution_count":112,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"404e7f1e8102695520c72dfbc36871ce","path":"/fnc/build/404e7f1e8102695520c72dfbc36871ce.png"}}}],"key":"gKzJPArsS4"}],"data":{},"key":"aHGMqeFy0F"}],"label":"demo-norms-matrix-matlab","identifier":"demo-norms-matrix-matlab","html_id":"demo-norms-matrix-matlab","key":"YOQ3Cq8eKk"},{"type":"heading","depth":3,"position":{"start":{"line":1098,"column":1},"end":{"line":1098,"column":1}},"children":[{"type":"text","value":"Section 2.8","position":{"start":{"line":1098,"column":1},"end":{"line":1098,"column":1}},"key":"G2NR908XOw"}],"identifier":"section-2-8","label":"Section 2.8","html_id":"section-2-8","implicit":true,"key":"oh0TGVGgXy"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Matrix condition number","position":{"start":{"line":1100,"column":1},"end":{"line":1100,"column":1}},"key":"Ic9Ox8zTzT"}],"key":"f3jHCMnnE4"},{"type":"paragraph","position":{"start":{"line":1104,"column":1},"end":{"line":1104,"column":1}},"children":[{"type":"text","value":"MATLAB has a function ","position":{"start":{"line":1104,"column":1},"end":{"line":1104,"column":1}},"key":"fubcU37kW3"},{"type":"inlineCode","value":"cond","position":{"start":{"line":1104,"column":1},"end":{"line":1104,"column":1}},"key":"RxxQ81Me6q"},{"type":"text","value":" to compute matrix condition numbers. By default, the 2-norm is used. As an example, the family of ","position":{"start":{"line":1104,"column":1},"end":{"line":1104,"column":1}},"key":"BNIV2YUFTK"},{"type":"emphasis","position":{"start":{"line":1104,"column":1},"end":{"line":1104,"column":1}},"children":[{"type":"text","value":"Hilbert matrices","position":{"start":{"line":1104,"column":1},"end":{"line":1104,"column":1}},"key":"z9kwPxOjo7"}],"key":"QaQUiWINqn"},{"type":"text","value":" is famously badly conditioned. Here is the ","position":{"start":{"line":1104,"column":1},"end":{"line":1104,"column":1}},"key":"krfHHSH3a9"},{"type":"inlineMath","value":"6\\times 6","position":{"start":{"line":1104,"column":1},"end":{"line":1104,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmn\u003e6\u003c/mn\u003e\u003cmo\u003e×\u003c/mo\u003e\u003cmn\u003e6\u003c/mn\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e6\\times 6\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e6\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e×\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6444em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e6\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"RMO5covGpC"},{"type":"text","value":" case.","position":{"start":{"line":1104,"column":1},"end":{"line":1104,"column":1}},"key":"frWqL0mdfA"}],"indexEntries":[{"entry":"MATLAB","subEntry":{"value":"cond","kind":"entry"},"emphasis":true}],"label":"index-mdrNRlgMSx","identifier":"index-mdrnrlgmsx","html_id":"index-mdrnrlgmsx","key":"kI8cTboWMe"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A = hilb(6)\nkappa = cond(A)","key":"QbaZbulZyV"},{"type":"output","id":"eokQOlLxz3LVXFlvtB9ON","data":[{"output_type":"execute_result","execution_count":113,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003eA = 6×6 double\n    1.0000    0.5000    0.3333    0.2500    0.2000    0.1667\n    0.5000    0.3333    0.2500    0.2000    0.1667    0.1429\n    0.3333    0.2500    0.2000    0.1667    0.1429    0.1250\n    0.2500    0.2000    0.1667    0.1429    0.1250    0.1111\n    0.2000    0.1667    0.1429    0.1250    0.1111    0.1000\n    0.1667    0.1429    0.1250    0.1111    0.1000    0.0909\n\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"A = 6×6 double\n    1.0000    0.5000    0.3333    0.2500    0.2000    0.1667\n    0.5000    0.3333    0.2500    0.2000    0.1667    0.1429\n    0.3333    0.2500    0.2000    0.1667    0.1429    0.1250\n    0.2500    0.2000    0.1667    0.1429    0.1250    0.1111\n    0.2000    0.1667    0.1429    0.1250    0.1111    0.1000\n    0.1667    0.1429    0.1250    0.1111    0.1000    0.0909\n","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":113,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003ekappa = 1.4951e+07\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"kappa = 1.4951e+07","content_type":"text/plain"}}}],"key":"HIsnmCYQnP"}],"data":{},"key":"hqyrM64rhS"},{"type":"paragraph","position":{"start":{"line":1111,"column":1},"end":{"line":1111,"column":1}},"children":[{"type":"text","value":"Because ","position":{"start":{"line":1111,"column":1},"end":{"line":1111,"column":1}},"key":"pr2QdykxoQ"},{"type":"inlineMath","value":"\\kappa\\approx 10^8","position":{"start":{"line":1111,"column":1},"end":{"line":1111,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003eκ\u003c/mi\u003e\u003cmo\u003e≈\u003c/mo\u003e\u003cmn\u003e1\u003c/mn\u003e\u003cmsup\u003e\u003cmn\u003e0\u003c/mn\u003e\u003cmn\u003e8\u003c/mn\u003e\u003c/msup\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\kappa\\approx 10^8\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.4831em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003eκ\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e≈\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8141em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e1\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003e0\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.8141em;\"\u003e\u003cspan style=\"top:-3.063em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e8\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"zxoWSo4iAR"},{"type":"text","value":", it’s possible to lose nearly 8 digits of accuracy in the process of passing from ","position":{"start":{"line":1111,"column":1},"end":{"line":1111,"column":1}},"key":"Q2lG2vkSw9"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":1111,"column":1},"end":{"line":1111,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi mathvariant=\"bold\"\u003eA\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\mathbf{A}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6861em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathbf\"\u003eA\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"i07EF7NSmr"},{"type":"text","value":" and ","position":{"start":{"line":1111,"column":1},"end":{"line":1111,"column":1}},"key":"v03XXpsNIi"},{"type":"inlineMath","value":"\\mathbf{b}","position":{"start":{"line":1111,"column":1},"end":{"line":1111,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi mathvariant=\"bold\"\u003eb\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\mathbf{b}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathbf\"\u003eb\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"Z6zFbFxsHQ"},{"type":"text","value":" to ","position":{"start":{"line":1111,"column":1},"end":{"line":1111,"column":1}},"key":"v4YoWfodce"},{"type":"inlineMath","value":"\\mathbf{x}","position":{"start":{"line":1111,"column":1},"end":{"line":1111,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi mathvariant=\"bold\"\u003ex\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\mathbf{x}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.4444em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathbf\"\u003ex\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"QmwH4nWZsS"},{"type":"text","value":". That fact is independent of the algorithm; it’s inevitable once the data are expressed in finite precision.","position":{"start":{"line":1111,"column":1},"end":{"line":1111,"column":1}},"key":"LsAF9gIrXE"}],"key":"Ycm9tjcSqK"},{"type":"paragraph","position":{"start":{"line":1113,"column":1},"end":{"line":1113,"column":1}},"children":[{"type":"text","value":"Let’s engineer a linear system problem to observe the effect of a perturbation. We will make sure we know the exact answer.","position":{"start":{"line":1113,"column":1},"end":{"line":1113,"column":1}},"key":"dClJewBlBY"}],"key":"rFaqecKiOb"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"x = (1:6)';\nb = A * x;","key":"P3lkxoJaKs"},{"type":"output","id":"Z4ZtxRJ4_Asi_5wO0Q-gk","data":[],"key":"S67XspQZ5x"}],"data":{},"key":"bdB5zvp4dT"},{"type":"paragraph","position":{"start":{"line":1120,"column":1},"end":{"line":1120,"column":1}},"children":[{"type":"text","value":"Now we perturb the system matrix and vector randomly by ","position":{"start":{"line":1120,"column":1},"end":{"line":1120,"column":1}},"key":"OUxc37LrWf"},{"type":"span","position":{"start":{"line":1120,"column":1},"end":{"line":1120,"column":1}},"children":[{"type":"text","value":"10","key":"mXeYfKUot1"},{"type":"superscript","children":[{"type":"text","value":"-10","key":"BjEBrMDonq"}],"key":"okeukuZ17v"}],"key":"AFUJjPREyM"},{"type":"text","value":" in norm.","position":{"start":{"line":1120,"column":1},"end":{"line":1120,"column":1}},"key":"aPKIrAE2RQ"}],"key":"K3DXIZpt2F"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"dA = randn(size(A));  dA = 1e-10 * (dA / norm(dA));\ndb = randn(size(b));  db = 1e-10 * (db / norm(db));","key":"QDvfT2t535"},{"type":"output","id":"rlw90SrGihTE7OV2MD7OS","data":[],"key":"Eywkh8L6cl"}],"data":{},"key":"sMWLHVNJ7v"},{"type":"paragraph","position":{"start":{"line":1127,"column":1},"end":{"line":1127,"column":1}},"children":[{"type":"text","value":"We solve the perturbed problem using pivoted ","key":"MkWaDRMsID"},{"type":"abbreviation","title":"lower triangular times upper triangular","children":[{"type":"text","value":"LU","key":"jOr9gFp0Ii"}],"key":"zFLepHy9np"},{"type":"text","value":" and see how the solution was changed.","key":"bX3FGP4gMC"}],"key":"g3URZpiiaM"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"new_x = ((A + dA) \\ (b + db));\ndx = new_x - x;","key":"Wu5EydsL5P"},{"type":"output","id":"AXFpCC2e39ij01XDYrRf7","data":[],"key":"uuImCpQq6g"}],"data":{},"key":"Gx1Af0Lx0r"},{"type":"paragraph","position":{"start":{"line":1134,"column":1},"end":{"line":1134,"column":1}},"children":[{"type":"text","value":"Here is the relative error in the solution.","position":{"start":{"line":1134,"column":1},"end":{"line":1134,"column":1}},"key":"SgIvyQyaM0"}],"key":"Z23g5ImLzj"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"relative_error = norm(dx) / norm(x)","key":"x9sYFrmCOA"},{"type":"output","id":"ayypgtCCofWL9cfojv4XP","data":[{"output_type":"execute_result","execution_count":117,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003erelative_error = 2.0762e-04\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"relative_error = 2.0762e-04","content_type":"text/plain"}}}],"key":"hx3MrIFrq4"}],"data":{},"key":"VlzgAq57n3"},{"type":"paragraph","position":{"start":{"line":1140,"column":1},"end":{"line":1140,"column":1}},"children":[{"type":"text","value":"And here are upper bounds predicted using the condition number of the original matrix.","position":{"start":{"line":1140,"column":1},"end":{"line":1140,"column":1}},"key":"xv9jwXXm46"}],"key":"nbvnmbcmhh"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"upper_bound_b = (kappa * norm(db) / norm(b))\nupper_bound_A = (kappa * norm(dA) / norm(A))","key":"UE0sk0gMXT"},{"type":"output","id":"3KJ6ZU1ng7jJp-CnqsQBg","data":[{"output_type":"execute_result","execution_count":118,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003eupper_bound_b = 1.5810e-04\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"upper_bound_b = 1.5810e-04","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":118,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003eupper_bound_A = 9.2353e-04\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"upper_bound_A = 9.2353e-04","content_type":"text/plain"}}}],"key":"TDTbxXxXeV"}],"data":{},"key":"be8AMZX3na"},{"type":"paragraph","position":{"start":{"line":1147,"column":1},"end":{"line":1147,"column":1}},"children":[{"type":"text","value":"Even if we didn’t make any manual perturbations to the data, machine roundoff does so at the relative level of ","position":{"start":{"line":1147,"column":1},"end":{"line":1147,"column":1}},"key":"sddK4Fa0Gb"},{"type":"inlineMath","value":"\\macheps","position":{"start":{"line":1147,"column":1},"end":{"line":1147,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsub\u003e\u003cmi\u003eϵ\u003c/mi\u003e\u003cmtext\u003emach\u003c/mtext\u003e\u003c/msub\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\macheps\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003eϵ\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3361em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord text mtight\"\u003e\u003cspan class=\"mord mtight\"\u003emach\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"Tl8ImYJZRZ"},{"type":"text","value":".","position":{"start":{"line":1147,"column":1},"end":{"line":1147,"column":1}},"key":"sFSeQ4Kchu"}],"key":"lcwM3QQydy"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"dx = A\\b - x;\nrelative_error = norm(dx) / norm(x)\nrounding_bound = kappa * eps","key":"OEuDdFCBWZ"},{"type":"output","id":"EKmjnr5POyFbLVZf1uzbn","data":[{"output_type":"execute_result","execution_count":119,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003erelative_error = 4.5027e-11\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"relative_error = 4.5027e-11","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":119,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003erounding_bound = 3.3198e-09\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"rounding_bound = 3.3198e-09","content_type":"text/plain"}}}],"key":"S2SL5h7soe"}],"data":{},"key":"DhmILaBG78"},{"type":"paragraph","position":{"start":{"line":1155,"column":1},"end":{"line":1155,"column":1}},"children":[{"type":"text","value":"Larger Hilbert matrices are even more poorly conditioned:","position":{"start":{"line":1155,"column":1},"end":{"line":1155,"column":1}},"key":"kkEIfuHBvd"}],"key":"f3l53kqYgW"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A = hilb(14);\nkappa = cond(A)","key":"ashGzRG5a3"},{"type":"output","id":"evb62doP3cU2Gu8LeBU7-","data":[{"output_type":"execute_result","execution_count":120,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003ekappa = 2.4325e+17\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"kappa = 2.4325e+17","content_type":"text/plain"}}}],"key":"F7tDIDrlN6"}],"data":{},"key":"FOkxCUvLmW"},{"type":"paragraph","position":{"start":{"line":1162,"column":1},"end":{"line":1162,"column":1}},"children":[{"type":"text","value":"Note that ","position":{"start":{"line":1162,"column":1},"end":{"line":1162,"column":1}},"key":"ZO4QPFsfPn"},{"type":"text","value":"κ","position":{"start":{"line":1162,"column":1},"end":{"line":1162,"column":1}},"key":"Wb10AkntlQ"},{"type":"text","value":" exceeds ","position":{"start":{"line":1162,"column":1},"end":{"line":1162,"column":1}},"key":"LMv4dXnm20"},{"type":"inlineMath","value":"1/\\macheps","position":{"start":{"line":1162,"column":1},"end":{"line":1162,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmn\u003e1\u003c/mn\u003e\u003cmi mathvariant=\"normal\"\u003e/\u003c/mi\u003e\u003cmsub\u003e\u003cmi\u003eϵ\u003c/mi\u003e\u003cmtext\u003emach\u003c/mtext\u003e\u003c/msub\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e1/\\macheps\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e1/\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003eϵ\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3361em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord text mtight\"\u003e\u003cspan class=\"mord mtight\"\u003emach\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"rt2b3fxetM"},{"type":"text","value":". In principle we therefore may end up with an answer that has relative error greater than 100%.","position":{"start":{"line":1162,"column":1},"end":{"line":1162,"column":1}},"key":"jKlFQpFAQU"}],"key":"kkseDzhtLA"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"rounding_bound = kappa * eps","key":"i7wtqvk89u"},{"type":"output","id":"p2EuxBu-W-I5EEyiVPCZP","data":[{"output_type":"execute_result","execution_count":121,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003erounding_bound = 54.0132\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"rounding_bound = 54.0132","content_type":"text/plain"}}}],"key":"Yxre6ZU3Qe"}],"data":{},"key":"smMtglK8Y8"},{"type":"paragraph","position":{"start":{"line":1168,"column":1},"end":{"line":1168,"column":1}},"children":[{"type":"text","value":"Let’s put that prediction to the test.","position":{"start":{"line":1168,"column":1},"end":{"line":1168,"column":1}},"key":"RVS9uvs90s"}],"key":"XiS72Fkbho"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"x = (1:14)';  b = A * x;\ndx = A\\b - x;\nrelative_error = norm(dx) / norm(x)","key":"j83I8xddcR"},{"type":"output","id":"NzD-X2urh3AuGE3Hy8iMl","data":[{"output_type":"stream","name":"stderr","text":"Warning: Matrix is close to singular or badly scaled. Results may be inaccurate. RCOND =  7.292772e-20."},{"output_type":"execute_result","execution_count":122,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003erelative_error = 61.0121\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"relative_error = 61.0121","content_type":"text/plain"}}}],"key":"df78PRm0Gl"}],"data":{},"key":"XMPynLKT5b"},{"type":"paragraph","position":{"start":{"line":1176,"column":1},"end":{"line":1176,"column":1}},"children":[{"type":"text","value":"As anticipated, the solution has zero accurate digits in the 2-norm.","position":{"start":{"line":1176,"column":1},"end":{"line":1176,"column":1}},"key":"U4peJROgcU"}],"key":"nNG7wt8oSF"}],"label":"demo-condition-bound-matlab","identifier":"demo-condition-bound-matlab","html_id":"demo-condition-bound-matlab","key":"KKtEzrDrKy"},{"type":"heading","depth":3,"position":{"start":{"line":1179,"column":1},"end":{"line":1179,"column":1}},"children":[{"type":"text","value":"Section 2.9","position":{"start":{"line":1179,"column":1},"end":{"line":1179,"column":1}},"key":"Yo6AGwvGxk"}],"identifier":"section-2-9","label":"Section 2.9","html_id":"section-2-9","implicit":true,"key":"dY6nhJCTuE"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Banded matrices","position":{"start":{"line":1181,"column":1},"end":{"line":1181,"column":1}},"key":"hAkztjuqqf"}],"key":"Zcd1vi0FEN"},{"type":"paragraph","position":{"start":{"line":1185,"column":1},"end":{"line":1185,"column":1}},"children":[{"type":"text","value":"Here is a small tridiagonal matrix. Note that there is one fewer element on the super- and subdiagonals than on the main diagonal.","position":{"start":{"line":1185,"column":1},"end":{"line":1185,"column":1}},"key":"goEHQlsed0"}],"indexEntries":[{"entry":"MATLAB","subEntry":{"value":"fill","kind":"entry"},"emphasis":true},{"entry":"MATLAB","subEntry":{"value":"diagm","kind":"entry"},"emphasis":false},{"entry":"MATLAB","subEntry":{"value":"diag","kind":"entry"},"emphasis":true}],"label":"index-uj40pGZcMb","identifier":"index-uj40pgzcmb","html_id":"index-uj40pgzcmb","key":"EXcZqSoMpC"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A = [ 2 -1  0  0  0  0\n      4  2 -1  0  0  0\n      0  3  0 -1  0  0\n      0  0  2  2 -1  0\n      0  0  0  1  1 -1\n      0  0  0  0  0  2 ];","key":"HSLG4p3R1o"},{"type":"output","id":"KjYzJnCl5_wYNvx4YSy2w","data":[],"key":"Ymgrg4Vof8"}],"data":{},"key":"TLRuZfwAYj"},{"type":"grid","columns":[1,1,2,2],"children":[{"type":"paragraph","position":{"start":{"line":1200,"column":1},"end":{"line":1200,"column":1}},"children":[{"type":"text","value":"We can extract the elements on any diagonal using the ","position":{"start":{"line":1200,"column":1},"end":{"line":1200,"column":1}},"key":"jyj99Fahv6"},{"type":"inlineCode","value":"diag","position":{"start":{"line":1200,"column":1},"end":{"line":1200,"column":1}},"key":"KBFw4K6rV3"},{"type":"text","value":" function. The main or central diagonal is numbered zero, above and to the right of that is positive, and below and to the left is negative.","position":{"start":{"line":1200,"column":1},"end":{"line":1200,"column":1}},"key":"NDj0Ojlmvb"}],"key":"q3AsH82iNO"},{"type":"card","children":[{"type":"paragraph","position":{"start":{"line":1202,"column":1},"end":{"line":1202,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":1202,"column":1},"end":{"line":1202,"column":1}},"key":"Foa7KNdGuo"},{"type":"inlineCode","value":"diag","position":{"start":{"line":1202,"column":1},"end":{"line":1202,"column":1}},"key":"NQBM2IimCU"},{"type":"text","value":" function extracts the elements from a specified diagonal of a matrix.","position":{"start":{"line":1202,"column":1},"end":{"line":1202,"column":1}},"key":"EZE277kkJm"}],"key":"zoBHgGhfRU"}],"key":"GEm8Rw5ARx"}],"indexEntries":[{"entry":"MATLAB","subEntry":{"value":"diag","kind":"entry"},"emphasis":true}],"label":"index-gfWM2NcERF","identifier":"index-gfwm2ncerf","html_id":"index-gfwm2ncerf","key":"mREw15hn1g"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"diag_main = diag(A, 0)'\ndiag_plusone = diag(A, 1)'\ndiag_minusone = diag(A,-1)'","key":"WF1cweJ0it"},{"type":"output","id":"OQprwVktUWwzaclhxRPls","data":[{"output_type":"execute_result","execution_count":124,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003ediag_main = 1×6 double\n     2     2     0     2     1     2\n\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"diag_main = 1×6 double\n     2     2     0     2     1     2\n","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":124,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003ediag_plusone = 1×5 double\n    -1    -1    -1    -1    -1\n\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"diag_plusone = 1×5 double\n    -1    -1    -1    -1    -1\n","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":124,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003ediag_minusone = 1×5 double\n     4     3     2     1     0\n\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"diag_minusone = 1×5 double\n     4     3     2     1     0\n","content_type":"text/plain"}}}],"key":"iVk6ovCJOK"}],"data":{},"key":"dMNQ5vbGp3"},{"type":"comment","value":"We can also put whatever numbers we like onto any diagonal with `diag`.","position":{"start":{"line":1212,"column":1},"end":{"line":1212,"column":1}},"key":"nJ45Ffnuyj"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A = A + diag([5 8 6 7], 2)","key":"XwLMKZVcDM"},{"type":"output","id":"YF7eyeUvAt4x364pGBj_l","data":[{"output_type":"execute_result","execution_count":125,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003eA = 6×6 double\n     2    -1     5     0     0     0\n     4     2    -1     8     0     0\n     0     3     0    -1     6     0\n     0     0     2     2    -1     7\n     0     0     0     1     1    -1\n     0     0     0     0     0     2\n\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"A = 6×6 double\n     2    -1     5     0     0     0\n     4     2    -1     8     0     0\n     0     3     0    -1     6     0\n     0     0     2     2    -1     7\n     0     0     0     1     1    -1\n     0     0     0     0     0     2\n","content_type":"text/plain"}}}],"key":"GZe21AyC2J"}],"data":{},"key":"tdNcSAyLHu"},{"type":"paragraph","position":{"start":{"line":1218,"column":1},"end":{"line":1218,"column":1}},"children":[{"type":"text","value":"The lower and upper bandwidths of ","position":{"start":{"line":1218,"column":1},"end":{"line":1218,"column":1}},"key":"CMRjCkWmQV"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":1218,"column":1},"end":{"line":1218,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi mathvariant=\"bold\"\u003eA\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\mathbf{A}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6861em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathbf\"\u003eA\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"sybu6yRdxo"},{"type":"text","value":" are repeated in the factors from the unpivoted ","key":"p1RniYn0lp"},{"type":"abbreviation","title":"lower triangular times upper triangular","children":[{"type":"text","value":"LU","key":"wgGeqeqmDs"}],"key":"gq5xIQCbKL"},{"type":"text","value":" factorization.","key":"aOJO1Vm2hn"}],"key":"zauKxp5ABn"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[L, U] = lufact(A)","key":"zADODFC5Bf"},{"type":"output","id":"JgAQRLLVt454hJaaGRT5H","data":[{"output_type":"execute_result","execution_count":126,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003eL = 6×6 double\n    1.0000         0         0         0         0         0\n    2.0000    1.0000         0         0         0         0\n         0    0.7500    1.0000         0         0         0\n         0         0    0.2424    1.0000         0         0\n         0         0         0    0.2705    1.0000         0\n         0         0         0         0         0    1.0000\n\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"L = 6×6 double\n    1.0000         0         0         0         0         0\n    2.0000    1.0000         0         0         0         0\n         0    0.7500    1.0000         0         0         0\n         0         0    0.2424    1.0000         0         0\n         0         0         0    0.2705    1.0000         0\n         0         0         0         0         0    1.0000\n","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":126,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003eU = 6×6 double\n    2.0000   -1.0000    5.0000         0         0         0\n         0    4.0000  -11.0000    8.0000         0         0\n         0         0    8.2500   -7.0000    6.0000         0\n         0         0         0    3.6970   -2.4545    7.0000\n         0         0         0         0    1.6639   -2.8934\n         0         0         0         0         0    2.0000\n\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"U = 6×6 double\n    2.0000   -1.0000    5.0000         0         0         0\n         0    4.0000  -11.0000    8.0000         0         0\n         0         0    8.2500   -7.0000    6.0000         0\n         0         0         0    3.6970   -2.4545    7.0000\n         0         0         0         0    1.6639   -2.8934\n         0         0         0         0         0    2.0000\n","content_type":"text/plain"}}}],"key":"lsV7jb1JU3"}],"data":{},"key":"d89b3N3aJq"}],"label":"demo-structure-banded-matlab","identifier":"demo-structure-banded-matlab","html_id":"demo-structure-banded-matlab","key":"nbtYCByfCc"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Timing banded ","key":"lT4oNZPbtX"},{"type":"abbreviation","title":"lower triangular times upper triangular","children":[{"type":"text","value":"LU","key":"lqhnBYJPQJ"}],"key":"QpzR0Ok9wE"}],"key":"K33G0k2EOt"},{"type":"paragraph","position":{"start":{"line":1227,"column":1},"end":{"line":1227,"column":1}},"children":[{"type":"text","value":"If we use an ordinary or dense matrix, then there’s no way to exploit a banded structure such as tridiagonality.","position":{"start":{"line":1227,"column":1},"end":{"line":1227,"column":1}},"key":"xUkbCY8qOz"}],"key":"cDX7ubbqGJ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"n = 10000;\nA = diag(1:n) + diag(n-1:-1:1, 1) + diag(ones(n-1, 1), -1);\ntic, [L,U] = lu(A); toc","key":"B12tJsNDsK"},{"type":"output","id":"3eh6ruB4aoV8Y2hs9CEKc","data":[{"output_type":"stream","name":"stdout","text":"Elapsed time is 4.969522 seconds.\n"}],"key":"fABcknRCHj"}],"data":{},"key":"WYShF7oDYE"},{"type":"paragraph","position":{"start":{"line":1235,"column":1},"end":{"line":1235,"column":1}},"children":[{"type":"text","value":"If instead we convert the matrix to ","position":{"start":{"line":1235,"column":1},"end":{"line":1235,"column":1}},"key":"boZCrGvZij"},{"type":"inlineCode","value":"sparse","position":{"start":{"line":1235,"column":1},"end":{"line":1235,"column":1}},"key":"f4A2M2Cj8a"},{"type":"text","value":" form, though, the speedup can be dramatic.","position":{"start":{"line":1235,"column":1},"end":{"line":1235,"column":1}},"key":"V53KxEK6QS"}],"key":"MbSckpRKGD"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"tic, [L,U] = lu(sparse(A)); toc","key":"uuG2AFc2C4"},{"type":"output","id":"cqOiydPB9AEYhnHYWB_8g","data":[{"output_type":"stream","name":"stdout","text":"Elapsed time is 0.244077 seconds.\n"}],"key":"qA9KBpulnR"}],"data":{},"key":"Xb24XFUQcC"}],"label":"demo-structure-timing-matlab","identifier":"demo-structure-timing-matlab","html_id":"demo-structure-timing-matlab","key":"a0BqrKrSzq"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Symmetric LDL","position":{"start":{"line":1243,"column":1},"end":{"line":1243,"column":1}},"key":"Zzf7xrX7Sv"},{"type":"superscript","position":{"start":{"line":1243,"column":1},"end":{"line":1243,"column":1}},"children":[{"type":"text","value":"T","key":"oSGnbbeHDs"}],"key":"ie4OCTq63c"},{"type":"text","value":" factorization","position":{"start":{"line":1243,"column":1},"end":{"line":1243,"column":1}},"key":"Qqt1rDytH9"}],"key":"zK0LE3oIl5"},{"type":"paragraph","position":{"start":{"line":1245,"column":1},"end":{"line":1245,"column":1}},"children":[{"type":"text","value":"We begin with a symmetric ","position":{"start":{"line":1245,"column":1},"end":{"line":1245,"column":1}},"key":"De7kJe8Pqa"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":1245,"column":1},"end":{"line":1245,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi mathvariant=\"bold\"\u003eA\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\mathbf{A}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6861em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathbf\"\u003eA\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"RyDRuVOi8i"},{"type":"text","value":".","position":{"start":{"line":1245,"column":1},"end":{"line":1245,"column":1}},"key":"fOCPFfVZCH"}],"key":"anOnT4wQrX"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A_1 = [ 2     4     4     2\n        4     5     8    -5\n        4     8     6     2\n        2    -5     2   -26 ];","key":"vNT4aH23EN"},{"type":"output","id":"XhDcucupgXxh-x2NYOGyS","data":[],"key":"gvsS7CsZgd"}],"data":{},"key":"ZXre2crIHD"},{"type":"paragraph","position":{"start":{"line":1254,"column":1},"end":{"line":1254,"column":1}},"children":[{"type":"text","value":"We won’t use pivoting, so the pivot element is at position (1,1). This will become the first element on the diagonal of ","position":{"start":{"line":1254,"column":1},"end":{"line":1254,"column":1}},"key":"nwM6MboUSQ"},{"type":"inlineMath","value":"\\mathbf{D}","position":{"start":{"line":1254,"column":1},"end":{"line":1254,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi mathvariant=\"bold\"\u003eD\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\mathbf{D}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6861em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathbf\"\u003eD\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"qplIe5LdK3"},{"type":"text","value":". Then we divide by that pivot to get the first column of ","position":{"start":{"line":1254,"column":1},"end":{"line":1254,"column":1}},"key":"iQh1Rsd74A"},{"type":"inlineMath","value":"\\mathbf{L}","position":{"start":{"line":1254,"column":1},"end":{"line":1254,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi mathvariant=\"bold\"\u003eL\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\mathbf{L}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6861em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathbf\"\u003eL\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"Wsv8NUOBLG"},{"type":"text","value":".","position":{"start":{"line":1254,"column":1},"end":{"line":1254,"column":1}},"key":"fUbnp0CxqB"}],"key":"yiAhSJbWfG"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"L = eye(4);\nd = zeros(4, 1);\nd(1) = A_1(1, 1);\nL(:, 1) = A_1(:, 1) / d(1);\nA_2 = A_1 - d(1) * L(:, 1) * L(:, 1)'","key":"vpMRLR2ChO"},{"type":"output","id":"5SAx81bgAdF3G8Azd4T4_","data":[{"output_type":"execute_result","execution_count":130,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003eA_2 = 4×4 double\n     0     0     0     0\n     0    -3     0    -9\n     0     0    -2    -2\n     0    -9    -2   -28\n\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"A_2 = 4×4 double\n     0     0     0     0\n     0    -3     0    -9\n     0     0    -2    -2\n     0    -9    -2   -28\n","content_type":"text/plain"}}}],"key":"PmVFOLONrI"}],"data":{},"key":"gGYdPEHo7g"},{"type":"paragraph","position":{"start":{"line":1264,"column":1},"end":{"line":1264,"column":1}},"children":[{"type":"text","value":"We are now set up the same way for the submatrix in rows and columns 2–4.","position":{"start":{"line":1264,"column":1},"end":{"line":1264,"column":1}},"key":"h2XI6stKKq"}],"key":"GqQBXpJM7R"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"d(2) = A_2(2, 2);\nL(:, 2) = A_2(:, 2) / d(2);\nA_3 = A_2 - d(2) * L(:, 2) * L(:, 2)'","key":"cqBudLrO0M"},{"type":"output","id":"X-5FIrx5akXlnx-KMpvV2","data":[{"output_type":"execute_result","execution_count":131,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003eA_3 = 4×4 double\n     0     0     0     0\n     0     0     0     0\n     0     0    -2    -2\n     0     0    -2    -1\n\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"A_3 = 4×4 double\n     0     0     0     0\n     0     0     0     0\n     0     0    -2    -2\n     0     0    -2    -1\n","content_type":"text/plain"}}}],"key":"VnZKOAyldr"}],"data":{},"key":"VkkyH263K4"},{"type":"paragraph","position":{"start":{"line":1272,"column":1},"end":{"line":1272,"column":1}},"children":[{"type":"text","value":"We continue working our way down the diagonal.","position":{"start":{"line":1272,"column":1},"end":{"line":1272,"column":1}},"key":"pqcWLprpZ6"}],"key":"tMDFKGavtI"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"d(3) = A_3(3, 3);\nL(:, 3) = A_3(:, 3) / d(3);\nA_4 = A_3 - d(3) * L(:, 3) * L(:, 3)'\nd(4) = A_4(4, 4);\nd\nL","key":"AB9ZkGUDaP"},{"type":"output","id":"v2A-JTZvcnePOp0LNrHFN","data":[{"output_type":"execute_result","execution_count":132,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003eA_4 = 4×4 double\n     0     0     0     0\n     0     0     0     0\n     0     0     0     0\n     0     0     0     1\n\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"A_4 = 4×4 double\n     0     0     0     0\n     0     0     0     0\n     0     0     0     0\n     0     0     0     1\n","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":132,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003ed = 4×1 double\n     2\n    -3\n    -2\n     1\n\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"d = 4×1 double\n     2\n    -3\n    -2\n     1\n","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":132,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003eL = 4×4 double\n     1     0     0     0\n     2     1     0     0\n     2     0     1     0\n     1     3     1     1\n\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"L = 4×4 double\n     1     0     0     0\n     2     1     0     0\n     2     0     1     0\n     1     3     1     1\n","content_type":"text/plain"}}}],"key":"pc8iDS9tNY"}],"data":{},"key":"w6GUwHHmTW"},{"type":"paragraph","position":{"start":{"line":1283,"column":1},"end":{"line":1283,"column":1}},"children":[{"type":"text","value":"We have arrived at the desired factorization, which we can validate:","position":{"start":{"line":1283,"column":1},"end":{"line":1283,"column":1}},"key":"vXIYO9uFxb"}],"key":"u267k18ajj"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"norm(A_1 - (L * diag(d) * L'))","key":"mrNuhydgEg"},{"type":"output","id":"J-I5TAdeXSRrKfNrxY6gk","data":[{"output_type":"execute_result","execution_count":133,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003eans = 0\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"ans = 0","content_type":"text/plain"}}}],"key":"BRX9sLxS2H"}],"data":{},"key":"FeeaQa3RA7"}],"label":"demo-structure-symm-matlab","identifier":"demo-structure-symm-matlab","html_id":"demo-structure-symm-matlab","key":"fzXX3xKjyo"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Cholesky factorization","position":{"start":{"line":1291,"column":1},"end":{"line":1291,"column":1}},"key":"DLPpUrfXuB"}],"key":"QmgFleGNmI"},{"type":"paragraph","position":{"start":{"line":1292,"column":1},"end":{"line":1292,"column":1}},"children":[{"type":"text","value":"A randomly chosen matrix is extremely unlikely to be symmetric. However, there is a simple way to symmetrize one.","position":{"start":{"line":1292,"column":1},"end":{"line":1292,"column":1}},"key":"YHusWyLXHs"}],"key":"l7pQL5WPJl"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A = magic(4) + eye(4);\nB = A + A'","key":"Clv2t2Dvfw"},{"type":"output","id":"bcxxpheKWHE7T0msm69ui","data":[{"output_type":"execute_result","execution_count":134,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003eB = 4×4 double\n    34     7    12    17\n     7    24    17    22\n    12    17    14    27\n    17    22    27     4\n\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"B = 4×4 double\n    34     7    12    17\n     7    24    17    22\n    12    17    14    27\n    17    22    27     4\n","content_type":"text/plain"}}}],"key":"SksUnMWWat"}],"data":{},"key":"M2kTL3Xs9X"},{"type":"grid","columns":[1,1,2,2],"children":[{"type":"paragraph","position":{"start":{"line":1303,"column":1},"end":{"line":1303,"column":1}},"children":[{"type":"text","value":"Similarly, a random symmetric matrix is unlikely to be positive definite. The Cholesky algorithm always detects a non-PD matrix by quitting with an error.","position":{"start":{"line":1303,"column":1},"end":{"line":1303,"column":1}},"key":"Omx5cY6Odd"}],"key":"wsHEQR8p8b"},{"type":"card","children":[{"type":"paragraph","position":{"start":{"line":1305,"column":1},"end":{"line":1305,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":1305,"column":1},"end":{"line":1305,"column":1}},"key":"u8icNcN4ww"},{"type":"inlineCode","value":"chol","position":{"start":{"line":1305,"column":1},"end":{"line":1305,"column":1}},"key":"ZP29KV2phK"},{"type":"text","value":" function computes a Cholesky factorization if possible, or throws an error for a non-positive-definite matrix.","position":{"start":{"line":1305,"column":1},"end":{"line":1305,"column":1}},"key":"ngMm2PReOw"}],"key":"tiRJcyGUxS"}],"key":"OHGU4nH46T"}],"indexEntries":[{"entry":"MATLAB","subEntry":{"value":"chol","kind":"entry"},"emphasis":true}],"label":"index-G50tNhxKlL","identifier":"index-g50tnhxkll","html_id":"index-g50tnhxkll","key":"DSZrCJ3VBm"},{"type":"admonition","kind":"warning","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Warning","key":"lN3mgv1rz4"}],"key":"dwtnSYrGFV"},{"type":"paragraph","position":{"start":{"line":1310,"column":1},"end":{"line":1310,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":1310,"column":1},"end":{"line":1310,"column":1}},"key":"iIeUKD1TUn"},{"type":"inlineCode","value":"chol","position":{"start":{"line":1310,"column":1},"end":{"line":1310,"column":1}},"key":"QNEyKF3O0H"},{"type":"text","value":" function does ","position":{"start":{"line":1310,"column":1},"end":{"line":1310,"column":1}},"key":"E5Ke24xHMv"},{"type":"emphasis","position":{"start":{"line":1310,"column":1},"end":{"line":1310,"column":1}},"children":[{"type":"text","value":"not","position":{"start":{"line":1310,"column":1},"end":{"line":1310,"column":1}},"key":"QDZxXrjOQY"}],"key":"jUhNFJo8AZ"},{"type":"text","value":" check for symmetry. It may give a nonsensical result if the input is not symmetric.","position":{"start":{"line":1310,"column":1},"end":{"line":1310,"column":1}},"key":"LrU3Trkvft"}],"key":"lVvydxw5tU"}],"key":"QyI8Sn3TCJ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"chol(B)    % throws an error","visibility":"show","key":"W8dd9IFxpD"},{"type":"output","id":"ecAkmmmXnvoUQJzElN5im","data":[{"output_type":"stream","name":"stderr","text":"Error using chol\nMatrix must be positive definite."}],"visibility":"show","key":"UHCi2zCv8I"}],"data":{"tags":["raises-exception"]},"visibility":"show","key":"z8ZxsDFeOg"},{"type":"paragraph","position":{"start":{"line":1318,"column":1},"end":{"line":1318,"column":1}},"children":[{"type":"text","value":"It’s not hard to manufacture an SPD matrix to try out the Cholesky factorization.","position":{"start":{"line":1318,"column":1},"end":{"line":1318,"column":1}},"key":"ffJG0O7So6"}],"key":"uuG4o7Scky"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"B = A' * A;\nR = chol(B)","key":"TC2qUyMi1h"},{"type":"output","id":"zcWTIHFWRwhVv9aFEVRta","data":[{"output_type":"execute_result","execution_count":136,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003eR = 4×4 double\n   20.2731   10.5065   11.0491   18.5960\n         0   16.8111   15.9961    2.2973\n         0         0    2.2453   -4.1053\n         0         0         0    3.6133\n\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"R = 4×4 double\n   20.2731   10.5065   11.0491   18.5960\n         0   16.8111   15.9961    2.2973\n         0         0    2.2453   -4.1053\n         0         0         0    3.6133\n","content_type":"text/plain"}}}],"key":"sIPk0tiyQk"}],"data":{},"key":"FoWd7DaiYk"},{"type":"paragraph","position":{"start":{"line":1325,"column":1},"end":{"line":1325,"column":1}},"children":[{"type":"text","value":"Here we validate the factorization:","position":{"start":{"line":1325,"column":1},"end":{"line":1325,"column":1}},"key":"BzGzDDrEio"}],"key":"K8xT2E02TS"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"norm(R' * R - B) / norm(B)","key":"U5RAjKoN7B"},{"type":"output","id":"63g-KeWnXfTXxFASPgzO_","data":[{"output_type":"execute_result","execution_count":137,"metadata":{},"data":{"text/html":{"content":"\u003chtml\u003e\u003cbody\u003e\u003cpre\u003eans = 5.6013e-17\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e","content_type":"text/html"},"text/plain":{"content":"ans = 5.6013e-17","content_type":"text/plain"}}}],"key":"GkuueOnVpB"}],"data":{},"key":"fNmUXbQYZE"}],"label":"demo-structure-cholesky-matlab","identifier":"demo-structure-cholesky-matlab","html_id":"demo-structure-cholesky-matlab","key":"n7ewHW40hB"}],"key":"glpHPbZkX5"}],"key":"VjLq7WHl8v"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Chapter 1","url":"/chapter1-1","group":"MATLAB codes"},"next":{"title":"Chapter 3","url":"/chapter3-1","group":"MATLAB codes"}}},"domain":"http://localhost:3000"},"project":{"numbering":{"heading_1":{"enabled":true},"heading_2":{"enabled":true},"heading_3":{"enabled":false}},"math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"LU":"lower triangular times upper triangular","QR":"orthogonal times upper triangular"},"exports":[{"format":"pdf","filename":"myst.pdf","url":"/fnc/build/myst-17d85fc44120abd982ec3b44467ee78e.pdf"}],"title":"Fundamentals of Numerical Computation","short_title":"FNC","description":"Online textbook for computational mathematics","authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","id":"a36af5d8-56ed-4bf2-92e6-5f7fdb82e8e1","toc":[{"file":"home.md"},{"children":[{"file":"preface.md"},{"file":"preface-original.md"}],"title":"Preface"},{"children":[{"file":"chapter1/floating-point.md"},{"file":"chapter1/conditioning.md"},{"file":"chapter1/algorithms.md"},{"file":"chapter1/stability.md"},{"file":"chapter1/next.md"}],"file":"chapter1/overview.md"},{"children":[{"file":"chapter2/polyinterp.md"},{"file":"chapter2/matrices.md"},{"file":"chapter2/linear-systems.md"},{"file":"chapter2/lu.md"},{"file":"chapter2/efficiency.md"},{"file":"chapter2/pivoting.md"},{"file":"chapter2/norms.md"},{"file":"chapter2/condition-number.md"},{"file":"chapter2/structure.md"},{"file":"chapter2/next.md"}],"file":"chapter2/overview.md"},{"children":[{"file":"chapter3/fitting.md"},{"file":"chapter3/normaleqns.md"},{"file":"chapter3/qr.md"},{"file":"chapter3/house.md"},{"file":"chapter3/next.md"}],"file":"chapter3/overview.md"},{"children":[{"file":"chapter4/rootproblem.md"},{"file":"chapter4/fixed-point.md"},{"file":"chapter4/newton.md"},{"file":"chapter4/secant.md"},{"file":"chapter4/newtonsys.md"},{"file":"chapter4/quasinewton.md"},{"file":"chapter4/nlsq.md"},{"file":"chapter4/next.md"}],"file":"chapter4/overview.md"},{"children":[{"file":"chapter5/interpolation.md"},{"file":"chapter5/pwlin.md"},{"file":"chapter5/splines.md"},{"file":"chapter5/finitediffs.md"},{"file":"chapter5/fd-converge.md"},{"file":"chapter5/integration.md"},{"file":"chapter5/adaptive.md"},{"file":"chapter5/next.md"}],"file":"chapter5/overview.md"},{"children":[{"file":"chapter6/basics.md"},{"file":"chapter6/euler.md"},{"file":"chapter6/systems.md"},{"file":"chapter6/rk.md"},{"file":"chapter6/adaptive-rk.md"},{"file":"chapter6/multistep.md"},{"file":"chapter6/implicit.md"},{"file":"chapter6/zerostability.md"},{"file":"chapter6/next.md"}],"file":"chapter6/overview.md"},{"children":[{"file":"appendix/linear-algebra.md"},{"children":[{"file":"julia/chapter1.md"},{"file":"julia/chapter2.md"},{"file":"julia/chapter3.md"},{"file":"julia/chapter4.md"},{"file":"julia/chapter5.md"},{"file":"julia/chapter6.md"}],"title":"Julia codes"},{"children":[{"file":"matlab/chapter1.md"},{"file":"matlab/chapter2.md"},{"file":"matlab/chapter3.md"},{"file":"matlab/chapter4.md"},{"file":"matlab/chapter5.md"},{"file":"matlab/chapter6.md"}],"title":"MATLAB codes"},{"children":[{"file":"python/chapter1.md"},{"file":"python/chapter2.md"},{"file":"python/chapter3.md"},{"file":"python/chapter4.md"},{"file":"python/chapter5.md"},{"file":"python/chapter6.md"}],"title":"Python codes"}],"title":"Appendices"},{"file":"genindex.md"}],"thumbnail":"/fnc/build/front_cover_small-3b81a246c798b3ded1375244c3419355.png","thumbnailOptimized":"/fnc/build/front_cover_small-3b81a246c798b3ded1375244c3419355.webp","bibliography":[],"index":"home","pages":[{"level":1,"title":"Preface"},{"slug":"preface","title":"Preface to the Julia edition","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"preface-original","title":"Preface to the original edition","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"overview","title":"Introduction","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"floating-point","title":"Floating-point numbers","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"conditioning","title":"Problems and conditioning","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"algorithms","title":"Algorithms","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"stability","title":"Stability","description":"","date":"","thumbnail":"/fnc/build/backwarderror-bdcf58e0d5f4193c2230d0af9181d25c.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"next","title":"Next steps","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"overview-1","title":"Linear systems of equations","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"polyinterp","title":"Polynomial interpolation","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"matrices","title":"Computing with matrices","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"linear-systems","title":"Linear systems","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"lu","title":"LU factorization","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"efficiency","title":"Efficiency of matrix computations","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"pivoting","title":"Row pivoting","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"norms","title":"Vector and matrix norms","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"condition-number","title":"Conditioning of linear systems","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"structure","title":"Exploiting matrix structure","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"next-1","title":"Next steps","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"overview-2","title":"Overdetermined linear systems","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"fitting","title":"Fitting functions to data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"normaleqns","title":"The normal equations","description":"","date":"","thumbnail":"/fnc/build/normaleqns2d-3a9bdadad6b0273ad3bb332f316bfd7c.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"qr","title":"The QR factorization","description":"","date":"","thumbnail":"/fnc/build/nonorthogonal-b17ed1afa4e72fd15dc1d03a95b2c3d7.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"house","title":"Computing QR factorizations","description":"","date":"","thumbnail":"/fnc/build/hhreflect-4c7ca3f245617111b6fd9e68dcaee10e.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"next-2","title":"Next steps","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"overview-3","title":"Roots of nonlinear equations","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"rootproblem","title":"The rootfinding problem","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fixed-point","title":"Fixed-point iteration","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"newton","title":"Newton’s method","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"secant","title":"Interpolation-based methods","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"newtonsys","title":"Newton for nonlinear systems","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"quasinewton","title":"Quasi-Newton methods","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"nlsq","title":"Nonlinear least squares","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"next-3","title":"Next steps","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"overview-4","title":"Piecewise interpolation","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"interpolation","title":"The interpolation problem","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"pwlin","title":"Piecewise linear interpolation","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"splines","title":"Cubic splines","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"finitediffs","title":"Finite differences","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fd-converge","title":"Convergence of finite differences","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"integration","title":"Numerical integration","description":"","date":"","thumbnail":"/fnc/build/trapezoid-a279167525570df0e1ac47b0fceef54c.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"adaptive","title":"Adaptive integration","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"next-4","title":"Next steps","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"overview-5","title":"Initial-value problems for ODEs","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"basics","title":"Basics of IVPs","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"euler","title":"Euler’s method","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"systems","title":"IVP systems","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"rk","title":"Runge–Kutta methods","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"adaptive-rk","title":"Adaptive Runge–Kutta","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"multistep","title":"Multistep methods","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"implicit","title":"Implementation of multistep methods","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"zerostability","title":"Zero-stability of multistep methods","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"next-5","title":"Next steps","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Appendices"},{"slug":"linear-algebra","title":"Review of linear algebra","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":2,"title":"Julia codes"},{"slug":"chapter1","title":"Chapter 1","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter2","title":"Chapter 2","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter3","title":"Chapter 3","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter4","title":"Chapter 4","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter5","title":"Chapter 5","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter6","title":"Chapter 6","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":2,"title":"MATLAB codes"},{"slug":"chapter1-1","title":"Chapter 1","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter2-1","title":"Chapter 2","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter3-1","title":"Chapter 3","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter4-1","title":"Chapter 4","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter5-1","title":"Chapter 5","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter6-1","title":"Chapter 6","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":2,"title":"Python codes"},{"slug":"chapter1-2","title":"Chapter 1","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter2-2","title":"Chapter 2","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter3-2","title":"Chapter 3","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter4-2","title":"Chapter 4","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter5-2","title":"Chapter 5","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter6-2","title":"Chapter 6","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"genindex","title":"Index","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1}]}}},"actionData":null,"errors":null},"future":{"unstable_dev":false,"unstable_postcss":false,"unstable_tailwind":false,"v2_errorBoundary":true,"v2_headers":true,"v2_meta":true,"v2_normalizeFormMethod":true,"v2_routeConvention":true}};</script><script type="module" async="">import "/fnc/build/manifest-A92797E9.js";
import * as route0 from "/fnc/build/root-HROFNPGU.js";
import * as route1 from "/fnc/build/routes/$-WNZNXUO2.js";
window.__remixRouteModules = {"root":route0,"routes/$":route1};

import("/fnc/build/entry.client-UNPC4GT3.js");</script></body></html>