{"kind":"Article","sha256":"56b4270e44c697524afb442377b420796b872efab4f70ffa619d3d11d076395f","slug":"traffic","location":"/chapter12/section1/traffic.md","dependencies":[],"frontmatter":{"title":"Traffic flow","numbering":{"heading_1":{"enabled":true},"heading_2":{"enabled":true},"heading_3":{"enabled":false},"enumerator":{"template":"12.1.%s"}},"content_includes_title":false,"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"exports":[{"format":"md","filename":"traffic.md","url":"/build/traffic-1cd21e73d6452b2d3bf36c5967085c07.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Have you ever been driving on a highway when you suddenly came upon a traffic jam? Maybe you had to brake harder than you would like to admit, endured a period of bumper-to-bumper progress, and experienced a much more gradual emergence from dense traffic than the abrupt entry into it. The mathematics of this phenomenon are well understood.","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"PELeTUSlZm"}],"key":"LCfa6wEoGL"},{"type":"paragraph","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Consider a one-dimensional road extending in the ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"BkXraFklic"},{"type":"inlineMath","value":"x","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"W0m1M1eU0v"},{"type":"text","value":" direction. We represent the vehicles by a continuous density function ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"NlfMcYVQES"},{"type":"inlineMath","value":"\\rho(x)","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ρ</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\rho(x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">ρ</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span>","key":"sqtrVTvJI0"},{"type":"text","value":".  The flow rate or ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"Ljv7QfDz3h"},{"type":"strong","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"flux","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"N8GB674Xpt"}],"key":"UA0dll6ky5"},{"type":"text","value":" of vehicles, expressed as the number of cars per unit time crossing a fixed point on the road, is denoted by ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"EBFTj3z1zR"},{"type":"inlineMath","value":"q","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>q</mi></mrow><annotation encoding=\"application/x-tex\">q</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span></span></span></span>","key":"OpgH7qOAbI"},{"type":"text","value":". We assume that this flux depends on the local density of cars. It’s reasonable to suppose that the flux will be zero when ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"QOUH3XLSMl"},{"type":"inlineMath","value":"\\rho=0","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ρ</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">\\rho=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">ρ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"dr23EzIvCt"},{"type":"text","value":" (no cars), reach a maximum ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"ay6PmgcSzq"},{"type":"inlineMath","value":"q_m","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>q</mi><mi>m</mi></msub></mrow><annotation encoding=\"application/x-tex\">q_m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"agyvn2sgoZ"},{"type":"text","value":" at some ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"N8HtFSHCBa"},{"type":"inlineMath","value":"\\rho=\\rho_m","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ρ</mi><mo>=</mo><msub><mi>ρ</mi><mi>m</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\rho=\\rho_m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">ρ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">ρ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"TYVb3JvAcE"},{"type":"text","value":", and approach zero again as the density approaches a critical density ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"fJFqLC184b"},{"type":"inlineMath","value":"\\rho_c","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>ρ</mi><mi>c</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\rho_c</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">ρ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">c</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"qDqNKMyZjs"},{"type":"text","value":". These conditions are met by the model","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"hSNjAdmiyg"}],"key":"gax21jG1rn"},{"type":"math","value":"Q_0(\\rho) = \\frac{4 q_m \\rho_m \\rho (\\rho-\\rho_c) (\\rho_m-\\rho_c)}{[\\rho (\\rho_c-2 \\rho_m)+\\rho_c \\rho_m]^2}.","label":"trafficQ","identifier":"trafficq","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>Q</mi><mn>0</mn></msub><mo stretchy=\"false\">(</mo><mi>ρ</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mfrac><mrow><mn>4</mn><msub><mi>q</mi><mi>m</mi></msub><msub><mi>ρ</mi><mi>m</mi></msub><mi>ρ</mi><mo stretchy=\"false\">(</mo><mi>ρ</mi><mo>−</mo><msub><mi>ρ</mi><mi>c</mi></msub><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">(</mo><msub><mi>ρ</mi><mi>m</mi></msub><mo>−</mo><msub><mi>ρ</mi><mi>c</mi></msub><mo stretchy=\"false\">)</mo></mrow><mrow><mo stretchy=\"false\">[</mo><mi>ρ</mi><mo stretchy=\"false\">(</mo><msub><mi>ρ</mi><mi>c</mi></msub><mo>−</mo><mn>2</mn><msub><mi>ρ</mi><mi>m</mi></msub><mo stretchy=\"false\">)</mo><mo>+</mo><msub><mi>ρ</mi><mi>c</mi></msub><msub><mi>ρ</mi><mi>m</mi></msub><msup><mo stretchy=\"false\">]</mo><mn>2</mn></msup></mrow></mfrac><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">Q_0(\\rho) = \\frac{4 q_m \\rho_m \\rho (\\rho-\\rho_c) (\\rho_m-\\rho_c)}{[\\rho (\\rho_c-2 \\rho_m)+\\rho_c \\rho_m]^2}.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">Q</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">ρ</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.363em;vertical-align:-0.936em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.427em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mopen\">[</span><span class=\"mord mathnormal\">ρ</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">ρ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">c</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">2</span><span class=\"mord\"><span class=\"mord mathnormal\">ρ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">ρ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">c</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\">ρ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"mclose\">]</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7401em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">4</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\">ρ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord mathnormal\">ρ</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">ρ</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">ρ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">c</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">ρ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">ρ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">c</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.936em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mord\">.</span></span></span></span></span>","enumerator":"12.1.1","html_id":"trafficq","key":"OAbbSpREux"},{"type":"paragraph","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"Observations (","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"cDBSrLO4es"},{"type":"cite","kind":"narrative","label":"whithamLinearNonlinear1974","identifier":"whithamlinearnonlinear1974","children":[{"type":"text","value":"Whitham (1974)","key":"qptKnP9GZD"}],"enumerator":"1","key":"bVscg3YI9C"},{"type":"text","value":", Chapter 3) suggest that good values for a three-lane highway are ","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"HubSgYDX1z"},{"type":"inlineMath","value":"\\rho_c = 1080","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>ρ</mi><mi>c</mi></msub><mo>=</mo><mn>1080</mn></mrow><annotation encoding=\"application/x-tex\">\\rho_c = 1080</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">ρ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">c</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1080</span></span></span></span>","key":"T7fRLLwvk3"},{"type":"text","value":" vehicles per km, ","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"MBdTx33Nul"},{"type":"inlineMath","value":"\\rho_m=380","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>ρ</mi><mi>m</mi></msub><mo>=</mo><mn>380</mn></mrow><annotation encoding=\"application/x-tex\">\\rho_m=380</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">ρ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">380</span></span></span></span>","key":"xxum2ROOri"},{"type":"text","value":" vehicles per km, and ","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"BJs5Mx1x5q"},{"type":"inlineMath","value":"q_m=4500","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>q</mi><mi>m</mi></msub><mo>=</mo><mn>4500</mn></mrow><annotation encoding=\"application/x-tex\">q_m=4500</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">4500</span></span></span></span>","key":"s5klPz2dZM"},{"type":"text","value":" vehicles per hour. In addition, we want to account for the fact that drivers anticipate slowing down or speeding up when they perceive changes in density, and therefore use","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"jHcIzABENb"}],"key":"sdjfnSfJ5t"},{"type":"math","value":"q=Q_0(\\rho)-\\epsilon \\rho_x","position":{"start":{"line":19,"column":1},"end":{"line":21,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>q</mi><mo>=</mo><msub><mi>Q</mi><mn>0</mn></msub><mo stretchy=\"false\">(</mo><mi>ρ</mi><mo stretchy=\"false\">)</mo><mo>−</mo><mi>ϵ</mi><msub><mi>ρ</mi><mi>x</mi></msub></mrow><annotation encoding=\"application/x-tex\">q=Q_0(\\rho)-\\epsilon \\rho_x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">Q</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">ρ</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">ϵ</span><span class=\"mord\"><span class=\"mord mathnormal\">ρ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></span>","enumerator":"12.1.2","key":"SVNuXrjaFU"},{"type":"paragraph","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"text","value":"for a small ","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"Y43drLhDB6"},{"type":"inlineMath","value":"\\epsilon > 0","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ϵ</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">\\epsilon &gt; 0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span class=\"mord mathnormal\">ϵ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&gt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"xp8sAaHROG"},{"type":"text","value":".","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"QqTDuT5Tzu"}],"key":"WtcmMW81QP"},{"type":"heading","depth":2,"position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"text","value":"Conservation laws","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"SpAKozWoNy"}],"identifier":"conservation-laws","label":"Conservation laws","html_id":"conservation-laws","implicit":true,"enumerator":"12.1.1","key":"W7gqMGcb5X"},{"type":"paragraph","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"children":[{"type":"emphasis","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"children":[{"type":"text","value":"Conservation laws","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"nikiH5X0zO"}],"key":"wPGxeXQMEu"},{"type":"text","value":" play a major role in science and engineering. They are typically statements that matter, energy, momentum, or some other meaningful quantity cannot be created or destroyed. In one dimension they take the form","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"pN9pxL9Qm9"}],"indexEntries":[{"entry":"conservation law","emphasis":true}],"label":"index-N0QbXh98If","identifier":"index-n0qbxh98if","html_id":"index-n0qbxh98if","key":"E5m7zTtIiT"},{"type":"math","value":"u_t + q_x = 0,","label":"conservation","identifier":"conservation","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>u</mi><mi>t</mi></msub><mo>+</mo><msub><mi>q</mi><mi>x</mi></msub><mo>=</mo><mn>0</mn><mo separator=\"true\">,</mo></mrow><annotation encoding=\"application/x-tex\">u_t + q_x = 0,</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8389em;vertical-align:-0.1944em;\"></span><span class=\"mord\">0</span><span class=\"mpunct\">,</span></span></span></span></span>","enumerator":"12.1.3","html_id":"conservation","key":"bjJSglgKbm"},{"type":"paragraph","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"children":[{"type":"text","value":"where ","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"dd31VNRWky"},{"type":"inlineMath","value":"u","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span>","key":"ivMBwztA1g"},{"type":"text","value":" represents a conserved quantity and ","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"bZrrBHtxlS"},{"type":"inlineMath","value":"q","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>q</mi></mrow><annotation encoding=\"application/x-tex\">q</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span></span></span></span>","key":"ANNBWrC8re"},{"type":"text","value":" represents the flux (flow rate) of ","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"NaFCRqAbqp"},{"type":"inlineMath","value":"u.","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">u.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mord\">.</span></span></span></span>","key":"iOeB9W7XjB"},{"type":"text","value":" Using this in our traffic flow, we arrive at the evolutionary ","key":"Jm9jdB9dp8"},{"type":"abbreviation","title":"partial differential equation","children":[{"type":"text","value":"PDE","key":"Dv3h0BEREB"}],"key":"c5eQLarses"}],"key":"kHvFZIgPfA"},{"type":"math","value":"  \\rho_t + Q_0'(\\rho) \\rho_x = \\epsilon \\rho_{xx}.","label":"trafficpde","identifier":"trafficpde","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>ρ</mi><mi>t</mi></msub><mo>+</mo><msubsup><mi>Q</mi><mn>0</mn><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msubsup><mo stretchy=\"false\">(</mo><mi>ρ</mi><mo stretchy=\"false\">)</mo><msub><mi>ρ</mi><mi>x</mi></msub><mo>=</mo><mi>ϵ</mi><msub><mi>ρ</mi><mrow><mi>x</mi><mi>x</mi></mrow></msub><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">  \\rho_t + Q_0&#x27;(\\rho) \\rho_x = \\epsilon \\rho_{xx}.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7778em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">ρ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0519em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">Q</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8019em;\"><span style=\"top:-2.453em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">ρ</span><span class=\"mclose\">)</span><span class=\"mord\"><span class=\"mord mathnormal\">ρ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">ϵ</span><span class=\"mord\"><span class=\"mord mathnormal\">ρ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">xx</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">.</span></span></span></span></span>","enumerator":"12.1.4","html_id":"trafficpde","key":"FaRgSAgWuS"},{"type":"paragraph","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"children":[{"type":"text","value":"Note that ","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"hQpWlKr7IP"},{"type":"inlineMath","value":"Q_0'","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msubsup><mi>Q</mi><mn>0</mn><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msubsup></mrow><annotation encoding=\"application/x-tex\">Q_0&#x27;</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.2481em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">Q</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-2.4519em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2481em;\"><span></span></span></span></span></span></span></span></span></span>","key":"mKMZ5RzYjK"},{"type":"text","value":" has the dimensions of (cars per time) over (cars per length), or length over time. We recognize the first and last terms as indicative of diffusion, but the middle term has a different effect. A similar term appears in the Black–Scholes equation.","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"GJY9Qc4tXK"}],"key":"LulOgwnV0Z"},{"type":"heading","depth":2,"position":{"start":{"line":45,"column":1},"end":{"line":45,"column":1}},"children":[{"type":"text","value":"Advection equation","position":{"start":{"line":45,"column":1},"end":{"line":45,"column":1}},"key":"lIHxo3hNQF"}],"identifier":"advection-equation","label":"Advection equation","html_id":"advection-equation","implicit":true,"enumerator":"12.1.2","key":"QWFkTzoGOg"},{"type":"paragraph","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"children":[{"type":"text","value":"Let’s momentarily consider a simpler, more fundamental ","key":"YUbWqrnWlp"},{"type":"abbreviation","title":"partial differential equation","children":[{"type":"text","value":"PDE","key":"AKtCNvMVto"}],"key":"JUlJyyL26d"},{"type":"text","value":".","key":"DXT5V9XMqN"}],"key":"ZpHzgDYeBc"},{"type":"proof","kind":"definition","enumerated":true,"children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Advection equation","position":{"start":{"line":51,"column":1},"end":{"line":51,"column":1}},"key":"yGpQgDkW46"}],"key":"rFc6lV9GA9"},{"type":"paragraph","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"key":"f4aaCkcrvi"},{"type":"strong","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"children":[{"type":"text","value":"advection equation","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"key":"HvKuxEsLhm"}],"key":"xr0EaOczjF"},{"type":"text","value":" in one dimension is","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"key":"ZMAwPfEAmL"}],"key":"DIZBSMRbvd"},{"type":"math","value":"  u_t + cu_x = 0,","label":"advectpde","identifier":"advectpde","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>u</mi><mi>t</mi></msub><mo>+</mo><mi>c</mi><msub><mi>u</mi><mi>x</mi></msub><mo>=</mo><mn>0</mn><mo separator=\"true\">,</mo></mrow><annotation encoding=\"application/x-tex\">  u_t + cu_x = 0,</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord mathnormal\">c</span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8389em;vertical-align:-0.1944em;\"></span><span class=\"mord\">0</span><span class=\"mpunct\">,</span></span></span></span></span>","enumerator":"12.1.5","html_id":"advectpde","key":"zx8ueN8e2J"},{"type":"paragraph","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"children":[{"type":"text","value":"where ","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"WEAjUpr8jZ"},{"type":"inlineMath","value":"c","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>c</mi></mrow><annotation encoding=\"application/x-tex\">c</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">c</span></span></span></span>","key":"scqjyfwD53"},{"type":"text","value":" is constant.","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"HyHp9RU7xQ"}],"key":"lYvWCGAvMQ"}],"indexEntries":[{"entry":"advection equation","emphasis":true},{"entry":"hyperbolic PDE","emphasis":true}],"label":"index-poaULIxk2T","identifier":"index-poaulixk2t","html_id":"index-poaulixk2t","enumerator":"12.1.1","key":"QbeYc5tXju"},{"type":"paragraph","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"children":[{"type":"text","value":"The advection equation is the archetype of a ","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"key":"ZYbaXbnovJ"},{"type":"strong","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"children":[{"type":"text","value":"hyperbolic ","key":"dtFr9VKue6"},{"type":"abbreviation","title":"partial differential equation","children":[{"type":"text","value":"PDE","key":"PYQPAfDCUY"}],"key":"XlCfdRfoXQ"}],"key":"PKN4R0yxqV"},{"type":"text","value":", which is a separate class from the parabolic ","key":"BSpnrjmz85"},{"type":"abbreviation","title":"partial differential equation","children":[{"type":"text","value":"PDE","key":"m7exI4SSeV"}],"key":"hR0a3SHRpJ"},{"type":"text","value":"s. By comparison with ","key":"wZOKFdr3nr"},{"type":"crossReference","kind":"equation","identifier":"conservation","label":"conservation","children":[{"type":"text","value":"(","key":"WsqrBl9PQl"},{"type":"text","value":"12.1.3","key":"YMpzqErbW0"},{"type":"text","value":")","key":"rK6LGYHYrj"}],"template":"(%s)","enumerator":"12.1.3","resolved":true,"html_id":"conservation","key":"aVxs8IBsKs"},{"type":"text","value":", we can interpret ","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"key":"omyPLOV8kG"},{"type":"crossReference","kind":"equation","identifier":"advectpde","label":"advectpde","children":[{"type":"text","value":"(","key":"eR2nMJaM8R"},{"type":"text","value":"12.1.5","key":"oBFR4LMwvI"},{"type":"text","value":")","key":"XsI5kdWpff"}],"template":"(%s)","enumerator":"12.1.5","resolved":true,"html_id":"advectpde","key":"MpcUPv2DOO"},{"type":"text","value":" as having a flux proportional to the gradient.","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"key":"VGGlT1OqUa"}],"key":"ha2pCrVIgE"},{"type":"paragraph","position":{"start":{"line":64,"column":1},"end":{"line":64,"column":1}},"children":[{"type":"text","value":"It’s easy to produce a solution of ","position":{"start":{"line":64,"column":1},"end":{"line":64,"column":1}},"key":"ukezAQGY8N"},{"type":"crossReference","kind":"equation","identifier":"advectpde","label":"advectpde","children":[{"type":"text","value":"(","key":"aXMCsoUU2r"},{"type":"text","value":"12.1.5","key":"N1t3TDvWVZ"},{"type":"text","value":")","key":"GUoma45LaP"}],"template":"(%s)","enumerator":"12.1.5","resolved":true,"html_id":"advectpde","key":"TBOtgN7SQS"},{"type":"text","value":". Let ","position":{"start":{"line":64,"column":1},"end":{"line":64,"column":1}},"key":"mld1lJRam6"},{"type":"inlineMath","value":"u(t,x)=\\psi(x-c t)","position":{"start":{"line":64,"column":1},"end":{"line":64,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo stretchy=\"false\">(</mo><mi>t</mi><mo separator=\"true\">,</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>ψ</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo>−</mo><mi>c</mi><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">u(t,x)=\\psi(x-c t)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">ψ</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">c</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span></span></span></span>","key":"fVy67T8vAO"},{"type":"text","value":", where ","position":{"start":{"line":64,"column":1},"end":{"line":64,"column":1}},"key":"s8TylFHqzb"},{"type":"text","value":"ψ","position":{"start":{"line":64,"column":1},"end":{"line":64,"column":1}},"key":"byyvgnn9E3"},{"type":"text","value":" is any differentiable function of one variable. Then the chain rule says that","position":{"start":{"line":64,"column":1},"end":{"line":64,"column":1}},"key":"phvtl4Xlst"}],"key":"dP18EXdcqa"},{"type":"math","value":"u_t + cu_x = \\psi'(x-c t)\\cdot(-c)  + c [\\psi'(x-c t)] = 0,","position":{"start":{"line":66,"column":1},"end":{"line":68,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>u</mi><mi>t</mi></msub><mo>+</mo><mi>c</mi><msub><mi>u</mi><mi>x</mi></msub><mo>=</mo><msup><mi>ψ</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo stretchy=\"false\">(</mo><mi>x</mi><mo>−</mo><mi>c</mi><mi>t</mi><mo stretchy=\"false\">)</mo><mo>⋅</mo><mo stretchy=\"false\">(</mo><mo>−</mo><mi>c</mi><mo stretchy=\"false\">)</mo><mo>+</mo><mi>c</mi><mo stretchy=\"false\">[</mo><msup><mi>ψ</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo stretchy=\"false\">(</mo><mi>x</mi><mo>−</mo><mi>c</mi><mi>t</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">]</mo><mo>=</mo><mn>0</mn><mo separator=\"true\">,</mo></mrow><annotation encoding=\"application/x-tex\">u_t + cu_x = \\psi&#x27;(x-c t)\\cdot(-c)  + c [\\psi&#x27;(x-c t)] = 0,</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord mathnormal\">c</span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0519em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">ψ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8019em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">c</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\">−</span><span class=\"mord mathnormal\">c</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0519em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">c</span><span class=\"mopen\">[</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">ψ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8019em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">c</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)]</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8389em;vertical-align:-0.1944em;\"></span><span class=\"mord\">0</span><span class=\"mpunct\">,</span></span></span></span></span>","enumerator":"12.1.6","key":"SbHW4SFyAE"},{"type":"paragraph","position":{"start":{"line":70,"column":1},"end":{"line":70,"column":1}},"children":[{"type":"text","value":"and the ","key":"rFwZedA8Qb"},{"type":"abbreviation","title":"partial differential equation","children":[{"type":"text","value":"PDE","key":"bCEyLCdq3B"}],"key":"pGbqfQWmED"},{"type":"text","value":" is satisfied. The form of the solution tells us that ","key":"O4ZipliFDk"},{"type":"inlineMath","value":"u","position":{"start":{"line":70,"column":1},"end":{"line":70,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span>","key":"EPHHIa85BG"},{"type":"text","value":" remains constant along any path with ","position":{"start":{"line":70,"column":1},"end":{"line":70,"column":1}},"key":"IHDLiFNSdR"},{"type":"inlineMath","value":"x-c t=a","position":{"start":{"line":70,"column":1},"end":{"line":70,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mo>−</mo><mi>c</mi><mi>t</mi><mo>=</mo><mi>a</mi></mrow><annotation encoding=\"application/x-tex\">x-c t=a</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">c</span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">a</span></span></span></span>","key":"Fd4gB0WqHm"},{"type":"text","value":" for a constant ","position":{"start":{"line":70,"column":1},"end":{"line":70,"column":1}},"key":"Sex8xjurD9"},{"type":"inlineMath","value":"a","position":{"start":{"line":70,"column":1},"end":{"line":70,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi></mrow><annotation encoding=\"application/x-tex\">a</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">a</span></span></span></span>","key":"xvTPZUeiqy"},{"type":"text","value":", i.e., ","position":{"start":{"line":70,"column":1},"end":{"line":70,"column":1}},"key":"GCZzda8APg"},{"type":"inlineMath","value":"x=a + c t","position":{"start":{"line":70,"column":1},"end":{"line":70,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mo>=</mo><mi>a</mi><mo>+</mo><mi>c</mi><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">x=a + c t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">c</span><span class=\"mord mathnormal\">t</span></span></span></span>","key":"HbVY8WxbwC"},{"type":"text","value":". So if ","position":{"start":{"line":70,"column":1},"end":{"line":70,"column":1}},"key":"WSvbtoksZA"},{"type":"inlineMath","value":"c>0","position":{"start":{"line":70,"column":1},"end":{"line":70,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>c</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">c&gt;0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span class=\"mord mathnormal\">c</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&gt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"I8Pf8CzmqR"},{"type":"text","value":", a fixed value of ","position":{"start":{"line":70,"column":1},"end":{"line":70,"column":1}},"key":"rk6c1IKdUx"},{"type":"inlineMath","value":"u","position":{"start":{"line":70,"column":1},"end":{"line":70,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span>","key":"TEuW1gvuCs"},{"type":"text","value":" moves rightward with speed ","position":{"start":{"line":70,"column":1},"end":{"line":70,"column":1}},"key":"p1oqkRSqm1"},{"type":"inlineMath","value":"|c|","position":{"start":{"line":70,"column":1},"end":{"line":70,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">∣</mi><mi>c</mi><mi mathvariant=\"normal\">∣</mi></mrow><annotation encoding=\"application/x-tex\">|c|</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">∣</span><span class=\"mord mathnormal\">c</span><span class=\"mord\">∣</span></span></span></span>","key":"JECmWd6CTo"},{"type":"text","value":", and if ","position":{"start":{"line":70,"column":1},"end":{"line":70,"column":1}},"key":"gBNxMXSfHo"},{"type":"inlineMath","value":"c<0","position":{"start":{"line":70,"column":1},"end":{"line":70,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>c</mi><mo>&lt;</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">c&lt;0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span class=\"mord mathnormal\">c</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&lt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"HEnOKO9PIi"},{"type":"text","value":", it moves leftward with speed ","position":{"start":{"line":70,"column":1},"end":{"line":70,"column":1}},"key":"cLqOLx7WSD"},{"type":"inlineMath","value":"|c|","position":{"start":{"line":70,"column":1},"end":{"line":70,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">∣</mi><mi>c</mi><mi mathvariant=\"normal\">∣</mi></mrow><annotation encoding=\"application/x-tex\">|c|</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">∣</span><span class=\"mord mathnormal\">c</span><span class=\"mord\">∣</span></span></span></span>","key":"U2S5YoT0Wu"},{"type":"text","value":".","position":{"start":{"line":70,"column":1},"end":{"line":70,"column":1}},"key":"CkgPLByHml"}],"key":"BDiM9jEUyg"},{"type":"proof","kind":"observation","enumerated":true,"children":[{"type":"paragraph","position":{"start":{"line":73,"column":1},"end":{"line":73,"column":1}},"children":[{"type":"text","value":"Solutions to the advection equation propagates with constant speed and fixed shape.","position":{"start":{"line":73,"column":1},"end":{"line":73,"column":1}},"key":"VorOxZFrls"}],"key":"Js6Ocg8urd"}],"enumerator":"12.1.1","key":"BOolMF4Cto"},{"type":"paragraph","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"children":[{"type":"text","value":"We can solve ","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"key":"v4el2qoKcE"},{"type":"crossReference","kind":"equation","identifier":"advectpde","label":"advectpde","children":[{"type":"text","value":"(","key":"OPUg6WYXgy"},{"type":"text","value":"12.1.5","key":"Cdl3xP4P0r"},{"type":"text","value":")","key":"YhOpeGdPz9"}],"template":"(%s)","enumerator":"12.1.5","resolved":true,"html_id":"advectpde","key":"zE8fss5ln3"},{"type":"text","value":" by the method of lines as in ","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"key":"eWJ4VLs3LB"},{"type":"link","url":"../diffusion/overview","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"children":[{"type":"text","value":"Chapter 11","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"key":"JoVPbWHmFj"}],"urlSource":"../diffusion/overview","key":"X00N4DTrPP"},{"type":"text","value":". We need the second-order first-derivative matrix for periodic end conditions,","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"key":"TXWUYaQmaq"}],"key":"co9ESNPhoJ"},{"type":"math","value":"  \\mathbf{D}_x =\n \\frac{1}{2h}\n    \\begin{bmatrix}\n      0 & 1 & & & -1 \\\\\n      -1 & 0 & 1 & & \\\\\n      & \\ddots & \\ddots & \\ddots & \\\\\n      & & -1 & 0 & 1 \\\\\n      1 & & & -1 & 0\n    \\end{bmatrix}.","label":"trafficdiffmat","identifier":"trafficdiffmat","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi mathvariant=\"bold\">D</mi><mi>x</mi></msub><mo>=</mo><mfrac><mn>1</mn><mrow><mn>2</mn><mi>h</mi></mrow></mfrac><mrow><mo fence=\"true\">[</mo><mtable rowspacing=\"0.16em\" columnalign=\"center center center center center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mn>1</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mn>1</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mo lspace=\"0em\" rspace=\"0em\">⋱</mo></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mo lspace=\"0em\" rspace=\"0em\">⋱</mo></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mo lspace=\"0em\" rspace=\"0em\">⋱</mo></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mn>1</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mn>1</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>0</mn></mstyle></mtd></mtr></mtable><mo fence=\"true\">]</mo></mrow><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">  \\mathbf{D}_x =\n \\frac{1}{2h}\n    \\begin{bmatrix}\n      0 &amp; 1 &amp; &amp; &amp; -1 \\\\\n      -1 &amp; 0 &amp; 1 &amp; &amp; \\\\\n      &amp; \\ddots &amp; \\ddots &amp; \\ddots &amp; \\\\\n      &amp; &amp; -1 &amp; 0 &amp; 1 \\\\\n      1 &amp; &amp; &amp; -1 &amp; 0\n    \\end{bmatrix}.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8361em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">D</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:6.0001em;vertical-align:-2.75em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"mord mathnormal\">h</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.25em;\"><span style=\"top:-2.311em;\"><span class=\"pstrut\" style=\"height:4.416em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎣</span></span></span><span style=\"top:-3.458em;\"><span class=\"pstrut\" style=\"height:4.416em;\"></span><span style=\"height:2.416em;width:0.6667em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.6667em' height='2.416em' style='width:0.6667em' viewBox='0 0 666.67 2416' preserveAspectRatio='xMinYMin'><path d='M319 0 H403 V2416 H319z M319 0 H403 V2416 H319z'/></svg></span></span><span style=\"top:-6.5111em;\"><span class=\"pstrut\" style=\"height:4.416em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎡</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.75em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.25em;\"><span style=\"top:-5.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">0</span></span></span><span style=\"top:-4.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord\">1</span></span></span><span style=\"top:-3.01em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span><span style=\"top:-1.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span><span style=\"top:-0.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.75em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.25em;\"><span style=\"top:-5.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span><span style=\"top:-4.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">0</span></span></span><span style=\"top:-3.01em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"minner\">⋱</span></span></span><span style=\"top:-1.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span><span style=\"top:-0.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.75em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.25em;\"><span style=\"top:-5.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span><span style=\"top:-4.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span><span style=\"top:-3.01em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"minner\">⋱</span></span></span><span style=\"top:-1.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord\">1</span></span></span><span style=\"top:-0.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.75em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.25em;\"><span style=\"top:-5.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span><span style=\"top:-4.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span><span style=\"top:-3.01em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"minner\">⋱</span></span></span><span style=\"top:-1.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">0</span></span></span><span style=\"top:-0.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.75em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.25em;\"><span style=\"top:-5.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord\">1</span></span></span><span style=\"top:-4.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span><span style=\"top:-3.01em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span><span style=\"top:-1.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span><span style=\"top:-0.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.75em;\"><span></span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.25em;\"><span style=\"top:-2.311em;\"><span class=\"pstrut\" style=\"height:4.416em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎦</span></span></span><span style=\"top:-3.458em;\"><span class=\"pstrut\" style=\"height:4.416em;\"></span><span style=\"height:2.416em;width:0.6667em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.6667em' height='2.416em' style='width:0.6667em' viewBox='0 0 666.67 2416' preserveAspectRatio='xMinYMin'><path d='M263 0 H347 V2416 H263z M263 0 H347 V2416 H263z'/></svg></span></span><span style=\"top:-6.5111em;\"><span class=\"pstrut\" style=\"height:4.416em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎤</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.75em;\"><span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">.</span></span></span></span></span>","enumerator":"12.1.7","html_id":"trafficdiffmat","key":"j4E7DND1hj"},{"type":"paragraph","position":{"start":{"line":91,"column":1},"end":{"line":91,"column":1}},"children":[{"type":"text","value":"This matrix is returned by ","position":{"start":{"line":91,"column":1},"end":{"line":91,"column":1}},"key":"JgGJqgyVmx"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-diffper","label":"function-diffper","children":[{"type":"text","value":"Function ","key":"TfOMsL7FzQ"},{"type":"text","value":"11.2.1","key":"HW1e32IC3y"}],"template":"Algorithm %s","enumerator":"11.2.1","resolved":true,"html_id":"function-diffper","remote":true,"url":"/methodlines","dataUrl":"/methodlines.json","key":"g8s5or0qFq"},{"type":"text","value":".","position":{"start":{"line":91,"column":1},"end":{"line":91,"column":1}},"key":"uMbVu5agwm"}],"key":"W1yIpEVJmR"},{"type":"proof","kind":"example","enumerated":true,"children":[{"type":"tabSet","children":[{"type":"tabItem","title":"Julia","sync":"julia","children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Advection equation","position":{"start":{"line":98,"column":1},"end":{"line":98,"column":1}},"key":"HN443r1C3C"}],"key":"SYSOLv6Pui"},{"type":"include","file":"julia/advection.ipynb","children":[{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"GyvgGH2Jp9"},{"type":"text","value":"12.1.1","key":"t7GoGJiotT"}],"key":"MpaINWopJF"}],"identifier":"demo-traffic-advection","label":"demo-traffic-advection","kind":"proof:example","template":"Example %s","enumerator":"12.1.1","resolved":true,"html_id":"demo-traffic-advection","key":"LWwUcKUJgD"}],"key":"roFzbT8FLz"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"In the following definition we allow the velocity ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"Lr5sVFdSVy"},{"type":"inlineMath","value":"c","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>c</mi></mrow><annotation encoding=\"application/x-tex\">c</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">c</span></span></span></span>","key":"A7MRiupMk8"},{"type":"text","value":" to be specified as a parameter in the ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"ciV2V9gUpM"},{"type":"inlineCode","value":"ODEProblem","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"Iabbewy1vP"},{"type":"text","value":".","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"JCItVQYzjt"}],"key":"J4ehGsf4ev"}],"key":"IKKsLq8v8x"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:34:20.824000Z","iopub.status.busy":"2025-01-14T15:34:14.493000Z","iopub.execute_input":"2025-01-14T15:34:16.484000Z","shell.execute_reply":"2025-01-14T15:34:20.817000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"x, Dₓ, Dₓₓ = FNC.diffper(300, [-4, 4])\nf = (u, c, t) -> -c * (Dₓ*u);","key":"sFlPOvkM9f"},{"type":"output","id":"gMjHZsFHLYaI_NfqCI6NV","data":[],"key":"EEquduKJdh"}],"key":"WJNLwrkrj9"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The following initial condition isn’t mathematically periodic, but the deviation is less than machine precision. We specify RK4 as the solver.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pyIxhiw5ks"}],"key":"hJfxCTxiJh"}],"key":"HbUQMZonrQ"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:34:34.859000Z","iopub.status.busy":"2025-01-14T15:34:20.839000Z","iopub.execute_input":"2025-01-14T15:34:20.840000Z","shell.execute_reply":"2025-01-14T15:34:34.858000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"using OrdinaryDiffEq\nu_init = @. 1 + exp( -3x^2 )\nIVP = ODEProblem(f, u_init, (0., 4.), 2)\nsol = solve(IVP, RK4());","key":"Ue7GKVjaos"},{"type":"output","id":"CRnnE4Y14oZBXTQV-Qc-G","data":[],"key":"B3YyqXOpd2"}],"key":"lPINRVvv09"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:35:16.904000Z","iopub.status.busy":"2025-01-14T15:34:34.880000Z","iopub.execute_input":"2025-01-14T15:34:34.880000Z","shell.execute_reply":"2025-01-14T15:35:16.903000Z"},"tags":[]},"children":[{"type":"code","lang":"julia","executable":true,"value":"using Plots\nplt = plot(\n    legend=:bottomleft,\n    title=\"Advection with periodic boundary\",\n    xaxis=(L\"x\"),  yaxis=(L\"u(x,t)\"))\nfor t in (0:4) * 2/3\n    plot!(x, sol(t), label=@sprintf(\"t=%.1f\", t))\nend\nplt","visibility":"hide","key":"wnMhjVASw5"},{"type":"output","id":"kSxaMobWsn2Hvw-xWZko9","data":[{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"3f0a22fd72789354fa8b05c10c3037ad","path":"/build/3f0a22fd72789354fa8b05c10c3037ad.png"},"text/html":{"content_type":"text/html","hash":"d75a1061ca95d6d57d7b1679b1d89b9a","path":"/build/d75a1061ca95d6d57d7b1679b1d89b9a.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"7f313c603441d9c3cd2e52cb4472fc27","path":"/build/7f313c603441d9c3cd2e52cb4472fc27.svg"}}}],"visibility":"show","key":"rrNOvFC1nd"}],"visibility":"show","key":"HGtyAnXME2"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"An animation shows the solution nicely. The bump moves with speed 2 to the right, reentering on the left as it exits to the right because of the periodic conditions.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Ky3VwMU0QA"}],"key":"U9Y6FVT3QL"}],"key":"YpmJAtpRZM"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:36:12.528000Z","iopub.status.busy":"2025-01-14T15:35:16.930000Z","iopub.execute_input":"2025-01-14T15:35:16.932000Z","shell.execute_reply":"2025-01-14T15:36:12.498000Z"},"tags":[]},"children":[{"type":"code","lang":"julia","executable":true,"value":"anim = @animate for t in range(0, 4, 120) \n    plot(x, sol(t),\n        title=@sprintf(\"Advection equation, t = %.2f\", t),\n        xaxis=(L\"x\"),  yaxis=([1, 2], L\"u(x,t)\"),\n        dpi=150)\nend\nmp4(anim, \"advection.mp4\")","visibility":"hide","key":"zk8SFbeWr2"},{"type":"output","id":"EyEphZqsGOPJ-6O8qZDdN","data":[{"name":"stderr","output_type":"stream","text":"\u001b[36m\u001b[1m[ \u001b[22m\u001b[39m\u001b[36m\u001b[1mInfo: \u001b[22m\u001b[39mSaved animation to /Users/driscoll/Dropbox/Mac/Documents/GitHub/fnc-notebooks/chapter12/section1/julia/advection.mp4\n"},{"output_type":"execute_result","execution_count":5,"metadata":{},"data":{"text/plain":{"content":"Plots.AnimatedGif(\"/Users/driscoll/Dropbox/Mac/Documents/GitHub/fnc-notebooks/chapter12/section1/julia/advection.mp4\")","content_type":"text/plain"},"text/html":{"content_type":"text/html","hash":"2aa36b0f116daf57a36937f6baad0023","path":"/build/2aa36b0f116daf57a36937f6baad0023.html"}}}],"visibility":"show","key":"kI1gNZcsDL"}],"visibility":"show","key":"DZDRiAeajL"}],"key":"h5FkYAtCwg"}],"key":"yizRNJe4vn"}],"key":"ufjzv9UwU8"},{"type":"tabItem","title":"MATLAB","sync":"matlab","children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Advection equation","position":{"start":{"line":107,"column":1},"end":{"line":107,"column":1}},"key":"fQa8h90uXB"}],"key":"MuQZElGyy4"},{"type":"include","file":"matlab/advection.ipynb","children":[{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"EvHmiWkPXd"},{"type":"text","value":"12.1.1","key":"lr10HZww3x"}],"key":"HcLBTqIymD"}],"identifier":"demo-traffic-advection","label":"demo-traffic-advection","kind":"proof:example","template":"Example %s","enumerator":"12.1.1","resolved":true,"html_id":"demo-traffic-advection","key":"N3xUtpvsKd"}],"key":"TCkPMkFF6C"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"In the following definition we allow the velocity ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"v6rGsOW3Hq"},{"type":"inlineMath","value":"c","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>c</mi></mrow><annotation encoding=\"application/x-tex\">c</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">c</span></span></span></span>","key":"w3zi0sPMMl"},{"type":"text","value":" to be specified as a parameter.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"c9cb71GsJo"}],"key":"ptN3p2Lbxd"}],"key":"CJ0W2Jlcg5"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"[x, Dx, Dxx] = diffper(300, [-4, 4]);\nf = @(t, u, c) -c * (Dx*u);\nivp = ode(ODEFcn=f);\nivp.Parameters = 2;\nivp.InitialTime = 0;\nivp.RelativeTolerance = 1e-5;","key":"YMuhqJUvil"},{"type":"output","id":"jtFnHIYEjQRkozj0MFcXX","data":[],"key":"CxzsccATDG"}],"key":"LI6Ovj8fPt"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The following initial condition isn’t mathematically periodic, but the deviation is less than machine precision. We specify RK4 as the solver.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qoyf4MnkXR"}],"key":"J84W3l61Ms"}],"key":"Y7slxWD6bO"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"u_init = 1 + exp(-3*x.^2);\nivp.InitialValue = u_init;\nt = linspace(0, 3, 201);\nsol = solve(ivp, t);\nU = sol.Solution;","key":"lI6w8qEHfg"},{"type":"output","id":"gf3sqv2MzT79ZnHgEEd-s","data":[],"key":"MiNPkpaVuD"}],"key":"SsG0QvD3Wc"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"matlab","executable":true,"value":"waterfall(x, t(1:5:end), U(:, 1:5:end)')\nview(-13, 65)\nxlabel('x'), ylabel('t'), zlabel('u(x,t)')\ntitle('Advection equation') ","visibility":"hide","key":"v6eyaKNZ0y"},{"type":"output","id":"vIOj0yzosRLurycr4IkQu","data":[{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"b405e20794cd6512e34db25ab86c6264","path":"/build/b405e20794cd6512e34db25ab86c6264.png"}}}],"visibility":"show","key":"EKNG7oypI4"}],"visibility":"show","key":"E8CqWSHKSZ"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"An animation shows the solution nicely. The bump moves with speed 2 to the right, reentering on the left as it exits to the right because of the periodic conditions.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"apVfwCwmqx"}],"key":"zHLh5o5F5G"}],"key":"xJ1d1x4nrs"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"matlab","executable":true,"value":"clf\nplot(x, U(:, 1))\nhold on,  grid on\naxis([-4, 4, 0.9, 2.1])\ntitle('Advection equation with periodic boundary') \nxlabel('x'),  ylabel('u(x,t)')\nvid = VideoWriter(\"advection-periodic.mp4\",\"MPEG-4\");\nvid.Quality = 85;\nopen(vid);\nfor frame = 1:length(t)\n    cla, plot(x, U(:, frame))\n    str = sprintf(\"t = %.2f\", t(frame));\n    text(-3.5, 1.9, str);\n    writeVideo(vid, frame2im(getframe(gcf)));\nend\nclose(vid)\nclose(gcf)","visibility":"hide","key":"Ur2uixYUBa"},{"type":"output","id":"hJt8n8AiZWxpOaYy5V6fv","data":[],"visibility":"remove","key":"oBwD5oV9zu"}],"visibility":"show","key":"diHKXMKkCR"}],"key":"hyAdQXgM0G"},{"type":"image","url":"/build/advection-periodic-151c1b5f81e108c2f64f3a381cb98eaa.mp4","alt":"Advection equation with periodic boundary","position":{"start":{"line":111,"column":1},"end":{"line":111,"column":1}},"key":"O3GWYiV9ZR","urlSource":"../../matlab/advection-periodic.mp4"}],"key":"XR3bNMVcJn"}],"key":"tZWCD9vJOu"},{"type":"tabItem","title":"Python","sync":"python","children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Advection equation","position":{"start":{"line":118,"column":1},"end":{"line":118,"column":1}},"key":"hagaaQz0am"}],"key":"ZD6IayGMCB"},{"type":"include","file":"python/advection.ipynb","children":[{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-09T21:23:17.225117Z","iopub.status.busy":"2025-01-09T21:23:17.224976Z","iopub.status.idle":"2025-01-09T21:23:17.724951Z","shell.execute_reply":"2025-01-09T21:23:17.724559Z"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"exec(open(\"../../../python/FNC_init.py\").read())","visibility":"show","key":"t0EShBkBXj"},{"type":"output","id":"UBBo7vtQL9x0gjRzGilvX","data":[],"visibility":"show","key":"ssnpQmspVA"}],"visibility":"remove","key":"WsJDTr45Kh"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"X3Yg6FMuRD"},{"type":"text","value":"12.1.1","key":"fQCCS3t22I"}],"key":"gq4Iyj2YAX"}],"identifier":"demo-traffic-advection","label":"demo-traffic-advection","kind":"proof:example","template":"Example %s","enumerator":"12.1.1","resolved":true,"html_id":"demo-traffic-advection","key":"o0DTtWT67D"}],"key":"KlX0oo03lA"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"In the following definition we allow the velocity ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"RrUmBZAzOy"},{"type":"inlineMath","value":"c","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>c</mi></mrow><annotation encoding=\"application/x-tex\">c</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">c</span></span></span></span>","key":"XElsG2wKpK"},{"type":"text","value":" to be specified as a parameter in the ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"hy3Bh7izAO"},{"type":"inlineCode","value":"ODEProblem","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"fvyPTRFsou"},{"type":"text","value":".","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"rQto8FQoCK"}],"key":"vCrKwfE7gE"}],"key":"KP8m2i9o1q"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-09T21:23:17.726712Z","iopub.status.busy":"2025-01-09T21:23:17.726507Z","iopub.status.idle":"2025-01-09T21:23:17.729116Z","shell.execute_reply":"2025-01-09T21:23:17.728867Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"x, Dx, Dxx = FNC.diffper(300, [-4, 4])\nf = lambda t, u: -c * (Dx @ u)","key":"LCpS59wNN0"},{"type":"output","id":"garDCHxRPfg8sVuEWwg5l","data":[],"key":"o0KFlwaMQe"}],"key":"envlWOtii6"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The following initial condition isn’t mathematically periodic, but the deviation is less than machine precision. We specify RK4 as the solver.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"c9Q9HZWHcM"}],"key":"Xq7LOfELvu"}],"key":"et47GI7SQb"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-09T21:23:17.730508Z","iopub.status.busy":"2025-01-09T21:23:17.730395Z","iopub.status.idle":"2025-01-09T21:23:18.336925Z","shell.execute_reply":"2025-01-09T21:23:18.336457Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"from scipy.integrate import solve_ivp\nu_init = 1 + exp(-3 * x**2)\nc = 2\nsol = solve_ivp(f, [0, 3.0], u_init, method=\"Radau\", dense_output=True)","key":"YqgsWBwRWd"},{"type":"output","id":"yBaZSElCQKT8SYrcZd-qo","data":[],"key":"N2gWQi8mai"}],"key":"jcKkNxbeIv"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-09T21:23:18.338777Z","iopub.status.busy":"2025-01-09T21:23:18.338635Z","iopub.status.idle":"2025-01-09T21:23:18.552591Z","shell.execute_reply":"2025-01-09T21:23:18.552285Z"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"for t in arange(0, 3, 2/3):\n    plot(x, sol.sol(t), label=f\"t = {t:.1f}\")\nlegend()\nxlabel(\"$x$\"),  ylabel(\"$u(x,t)$\")\ntitle(\"Advection with periodic boundary\");","visibility":"hide","key":"BAYjGsEkRJ"},{"type":"output","id":"yiNqHuaajKnNGJDusnDDk","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"90d83096cc78a91ce8cbe069ea40ac09","path":"/build/90d83096cc78a91ce8cbe069ea40ac09.png"},"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"}}}],"visibility":"show","key":"m4cO3KPAFi"}],"visibility":"show","key":"kteLIvxD2V"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"An animation shows the solution nicely. The bump moves with speed 2 to the right, reentering on the left as it exits to the right because of the periodic conditions.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hSAz105eId"}],"key":"eaRTjxisqZ"}],"key":"WYmxmwjj2g"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-09T21:23:18.554628Z","iopub.status.busy":"2025-01-09T21:23:18.554477Z","iopub.status.idle":"2025-01-09T21:23:23.429623Z","shell.execute_reply":"2025-01-09T21:23:23.429221Z"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"from matplotlib.animation import FuncAnimation\nfig, ax = subplots()\ncurve = ax.plot(x, u_init)[0]\ntime_text = ax.text(0.05, 0.9, '', transform=ax.transAxes)\n\nax.set_xlabel(\"$x$\")\nax.set_ylabel(\"$u(x,t)$\")\nax.set_ylim(0.9, 2.1)\nax.set_title(\"Advection equation with periodic boundary\")\n\ndef snapshot(t):\n    curve.set_ydata(sol.sol(t))\n    time_text.set_text(f\"t = {t:.2f}\")\n\nanim = FuncAnimation(fig, snapshot, frames=linspace(0, 3, 201))\nanim.save(\"advection-periodic.mp4\", fps=30)\nclose()","visibility":"hide","key":"GEO1d5g7vl"},{"type":"output","id":"SLum7fx12Gk4XngxZNpLG","data":[],"visibility":"show","key":"f1tixqv8L4"}],"visibility":"show","key":"dcMsOHVRAN"}],"key":"s1kHfmJ3Bv"},{"type":"image","url":"/build/advection-periodic-a4bb6f76d1837605fdbd5231fc77b9bd.mp4","alt":"Advection equation with periodic boundary","position":{"start":{"line":122,"column":1},"end":{"line":122,"column":1}},"key":"SuJorhH7Up","urlSource":"python/advection-periodic.mp4"}],"key":"dshpVUPOI2"}],"key":"At60UfqwnO"}],"key":"GZhodGFqM5"}],"label":"demo-traffic-advection","identifier":"demo-traffic-advection","html_id":"demo-traffic-advection","enumerator":"12.1.1","key":"b8l5uZg4cm"},{"type":"paragraph","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"children":[{"type":"text","value":"If you look carefully at ","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"key":"M1s0x2B5MS"},{"type":"crossReference","kind":"proof:example","identifier":"demo-traffic-advection","label":"demo-traffic-advection","children":[{"type":"text","value":"Demo ","key":"GHcIcKfPvJ"},{"type":"text","value":"12.1.1","key":"Vo581QCdIx"}],"template":"Example %s","enumerator":"12.1.1","resolved":true,"html_id":"demo-traffic-advection","key":"Uzi1NPlzq0"},{"type":"text","value":", you’ll notice that we used the time integrator ","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"key":"F3IPX3inxe"},{"type":"inlineCode","value":"RK4","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"key":"eLQXH8gYkW"},{"type":"text","value":", a nonstiff method. As we will see later in this chapter, the pure advection equation is not inherently stiff.","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"key":"kyw3tq9TAr"}],"key":"jfeBJl9KDC"},{"type":"heading","depth":2,"position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"children":[{"type":"text","value":"Solutions for traffic flow","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"key":"PAIVPS0X6f"}],"identifier":"solutions-for-traffic-flow","label":"Solutions for traffic flow","html_id":"solutions-for-traffic-flow","implicit":true,"enumerator":"12.1.3","key":"l2hvJ3b43k"},{"type":"paragraph","position":{"start":{"line":138,"column":1},"end":{"line":138,"column":1}},"children":[{"type":"text","value":"Returning to the traffic flow ","key":"Vtld13Vzxy"},{"type":"abbreviation","title":"partial differential equation","children":[{"type":"text","value":"PDE","key":"xZ7EaRr5La"}],"key":"ZW0bs0amcl"},{"type":"text","value":" ","key":"KDpw7kVKga"},{"type":"crossReference","kind":"equation","identifier":"trafficpde","label":"trafficpde","children":[{"type":"text","value":"(","key":"NDoqw855Le"},{"type":"text","value":"12.1.4","key":"bdwnMpElwE"},{"type":"text","value":")","key":"awiY0CbolL"}],"template":"(%s)","enumerator":"12.1.4","resolved":true,"html_id":"trafficpde","key":"f2NekeDJSv"},{"type":"text","value":", we can interpret the conservation law as advection at velocity ","position":{"start":{"line":138,"column":1},"end":{"line":138,"column":1}},"key":"x5QBtDZbuM"},{"type":"inlineMath","value":"Q_0'(\\rho)","position":{"start":{"line":138,"column":1},"end":{"line":138,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msubsup><mi>Q</mi><mn>0</mn><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msubsup><mo stretchy=\"false\">(</mo><mi>ρ</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">Q_0&#x27;(\\rho)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0019em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">Q</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-2.4519em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2481em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">ρ</span><span class=\"mclose\">)</span></span></span></span>","key":"O1VT4dd5Jc"},{"type":"text","value":".  The dependence of velocity on the solution is different from the linear ","key":"J3KP6JPcSB"},{"type":"abbreviation","title":"partial differential equation","children":[{"type":"text","value":"PDE","key":"gWkQtPNBrm"}],"key":"LgTRWeUnSW"},{"type":"text","value":" ","key":"NQGE7rloLu"},{"type":"crossReference","kind":"equation","identifier":"advectpde","label":"advectpde","children":[{"type":"text","value":"(","key":"mNmYjRFcs2"},{"type":"text","value":"12.1.5","key":"CjjbksWyVn"},{"type":"text","value":")","key":"uYcX8CNjOo"}],"template":"(%s)","enumerator":"12.1.5","resolved":true,"html_id":"advectpde","key":"Iv3emON9ju"},{"type":"text","value":" and is the key to the peculiar behavior of traffic jams. In particular, the velocity is low at high density, and higher at low density.  The term on the right side of ","position":{"start":{"line":138,"column":1},"end":{"line":138,"column":1}},"key":"ttCphG25Xh"},{"type":"crossReference","kind":"equation","identifier":"trafficpde","label":"trafficpde","children":[{"type":"text","value":"(","key":"znChy3j9JS"},{"type":"text","value":"12.1.4","key":"MVTvYWPpac"},{"type":"text","value":")","key":"HZkzo48H7L"}],"template":"(%s)","enumerator":"12.1.4","resolved":true,"html_id":"trafficpde","key":"CLMHiPrP9K"},{"type":"text","value":" provides a bit of diffusion, and the parameter ","position":{"start":{"line":138,"column":1},"end":{"line":138,"column":1}},"key":"jYNGzlF1xE"},{"type":"text","value":"ε","position":{"start":{"line":138,"column":1},"end":{"line":138,"column":1}},"key":"keyCDqgrnW"},{"type":"text","value":" determines the balance between the two effects—advection effects dominate if ","position":{"start":{"line":138,"column":1},"end":{"line":138,"column":1}},"key":"YKJNn5c08L"},{"type":"text","value":"ε","position":{"start":{"line":138,"column":1},"end":{"line":138,"column":1}},"key":"abZoxSQjsg"},{"type":"text","value":" is small.","position":{"start":{"line":138,"column":1},"end":{"line":138,"column":1}},"key":"KYIJbZNnHW"}],"indexEntries":[{"entry":"advection-diffusion equation","emphasis":false}],"label":"index-DXpJnHfLHV","identifier":"index-dxpjnhflhv","html_id":"index-dxpjnhflhv","key":"tmTlmCwk09"},{"type":"paragraph","position":{"start":{"line":140,"column":1},"end":{"line":140,"column":1}},"children":[{"type":"text","value":"Exact solutions of ","position":{"start":{"line":140,"column":1},"end":{"line":140,"column":1}},"key":"Rp7kUWeITr"},{"type":"crossReference","kind":"equation","identifier":"trafficpde","label":"trafficpde","children":[{"type":"text","value":"(","key":"JGi5nZTmi7"},{"type":"text","value":"12.1.4","key":"rroj0n5mZF"},{"type":"text","value":")","key":"sSLZvYkTMi"}],"template":"(%s)","enumerator":"12.1.4","resolved":true,"html_id":"trafficpde","key":"PxLGajyTHU"},{"type":"text","value":" are much harder to come by than for the standard advection equation, but the method of lines is still effective.","position":{"start":{"line":140,"column":1},"end":{"line":140,"column":1}},"key":"P2vbBaFJvh"}],"key":"MduwfrYebV"},{"type":"proof","kind":"example","enumerated":true,"children":[{"type":"tabSet","children":[{"type":"tabItem","title":"Julia","sync":"julia","children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Traffic flow model","position":{"start":{"line":147,"column":1},"end":{"line":147,"column":1}},"key":"uNsJ9ftDGX"}],"key":"iT2CLOR3n5"},{"type":"include","file":"julia/solve.ipynb","children":[{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"BD49TZAcuL"},{"type":"text","value":"12.1.2","key":"b9XOO77l98"}],"key":"Ar0OhbzuDv"}],"identifier":"demo-traffic-solve","label":"demo-traffic-solve","kind":"proof:example","template":"Example %s","enumerator":"12.1.2","resolved":true,"html_id":"demo-traffic-solve","key":"raHyLqBVme"}],"key":"QnviHy4zh1"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The following are parameters and a function relevant to defining the problem.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"L7SL7X1X8s"}],"key":"DoTNUXwgkd"}],"key":"Ihxl1PxZtg"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:30:46.697000Z","iopub.status.busy":"2025-01-14T15:30:44.066000Z","iopub.execute_input":"2025-01-14T15:30:46.209000Z","shell.execute_reply":"2025-01-14T15:30:46.686000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"ρc = 1080;  ρm = 380;  q_m = 10000;\ndQ0 = ρ -> 4q_m * ρc^2 * (ρc-ρm) * ρm * (ρm-ρ) / (ρ*(ρc-2*ρm) + ρc*ρm)^3;","key":"lmFKs6AWgU"},{"type":"output","id":"yEjF60wzwGP4rnbO8zDwU","data":[],"key":"dNkOKxOvhc"}],"key":"AyvkL5KLXN"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Here we create a discretization on ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"tFV0SHd5YP"},{"type":"inlineMath","value":"m=800","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi><mo>=</mo><mn>800</mn></mrow><annotation encoding=\"application/x-tex\">m=800</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">800</span></span></span></span>","key":"t05WOulh3v"},{"type":"text","value":" points.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PYRxedAM2J"}],"key":"BAZjiThU2Z"}],"key":"gg6s1EHJ7h"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:30:49.546000Z","iopub.status.busy":"2025-01-14T15:30:46.787000Z","iopub.execute_input":"2025-01-14T15:30:46.792000Z","shell.execute_reply":"2025-01-14T15:30:49.543000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"x, Dₓ, Dₓₓ = FNC.diffper(800, [0, 4]);","key":"B6BLkI7cNs"},{"type":"output","id":"ieki50Fku-5UGtgO5R1AT","data":[],"key":"UaOxCoyl34"}],"key":"UKrXza8UGY"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Next we define the ","key":"lI5GqJLWqY"},{"type":"abbreviation","title":"ordinary differential equation","children":[{"type":"text","value":"ODE","key":"Za2IiEains"}],"key":"LEhamebVfa"},{"type":"text","value":" resulting from the method of lines.","key":"xwjSLfDZYu"}],"key":"u3yY07yItQ"}],"key":"EIAydtgdKI"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:30:49.577000Z","iopub.status.busy":"2025-01-14T15:30:49.568000Z","iopub.execute_input":"2025-01-14T15:30:49.569000Z","shell.execute_reply":"2025-01-14T15:30:49.575000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"ode = (ρ, ϵ, t) -> -dQ0.(ρ) .* (Dₓ*ρ) + ϵ * (Dₓₓ*ρ);","key":"anWkyZmE34"},{"type":"output","id":"SqrCnN596llBnPF0QVtfz","data":[],"key":"r50qS9Td0H"}],"key":"dHtpT6Q8tM"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Our first initial condition has moderate density with a small bump. Because of the diffusion present, we use a stiff solver for the ","key":"qWIsWn2bHq"},{"type":"abbreviation","title":"initial-value problem","children":[{"type":"text","value":"IVP","key":"AQCyOQB2I6"}],"key":"gOwDjFqmkJ"},{"type":"text","value":".","key":"BSUkXru8sx"}],"key":"iAed1lDFYU"}],"key":"dXFA2thXum"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:32:29.202000Z","iopub.status.busy":"2025-01-14T15:30:49.596000Z","iopub.execute_input":"2025-01-14T15:30:49.596000Z","shell.execute_reply":"2025-01-14T15:32:29.201000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"using OrdinaryDiffEq\nρ_init = @. 400 + 10 * exp( -20*(x-3)^2 )\nIVP = ODEProblem(ode, ρ_init, (0., 1.), 0.02)\nsol = solve(IVP, Rodas4P());","key":"ZG0olXM2Si"},{"type":"output","id":"j9y4nCaAyoi2Sudcf2qpC","data":[],"key":"WtdcHiTFxI"}],"key":"eLQItuet2L"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:33:16.775000Z","iopub.status.busy":"2025-01-14T15:32:29.217000Z","iopub.execute_input":"2025-01-14T15:32:29.220000Z","shell.execute_reply":"2025-01-14T15:33:16.770000Z"},"tags":[]},"children":[{"type":"code","lang":"julia","executable":true,"value":"plt = plot(\n    legend=:topleft, \n    title=\"Traffic flow\",\n    xaxis=(L\"x\"),  yaxis=(\"car density\"))\nfor t in 0:0.2:1\n    plot!(x, sol(t), label=@sprintf(\"t=%.1f\", t))\nend\nplt","visibility":"hide","key":"Lz5RyRuX9j"},{"type":"output","id":"5LC0MwyzQzj0QS61KTFSg","data":[{"output_type":"execute_result","execution_count":6,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"7abd9c7be7bbcd6482ecf213933ba178","path":"/build/7abd9c7be7bbcd6482ecf213933ba178.png"},"text/html":{"content_type":"text/html","hash":"fefc4e88258649b97ecdd8026f826906","path":"/build/fefc4e88258649b97ecdd8026f826906.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"261f02789ad7788212091af6dbca47ab","path":"/build/261f02789ad7788212091af6dbca47ab.svg"}}}],"visibility":"show","key":"Q2OPGIfpV3"}],"visibility":"show","key":"Q0I6FFzsNB"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The bump slowly moves backward on the roadway, spreading out and gradually fading away due to the presence of diffusion.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"W2RndGXng7"}],"key":"WRQX5cQE5U"}],"key":"QJcxsQRAYE"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:34:12.611000Z","iopub.status.busy":"2025-01-14T15:33:16.837000Z","iopub.execute_input":"2025-01-14T15:33:16.839000Z","shell.execute_reply":"2025-01-14T15:34:12.608000Z"},"tags":[]},"children":[{"type":"code","lang":"julia","executable":true,"value":"anim = @animate for t in range(0,0.9,91) \n    plot(x, sol(t);\n        xaxis=(L\"x\"),  yaxis=([400,410], \"density\"),\n        dpi=150,  title=@sprintf(\"Traffic flow, t=%.2f\",t))\nend\nmp4(anim, \"traffic-fade.mp4\")","visibility":"hide","key":"eRTNQPH1u9"},{"type":"output","id":"YdBSgQRfLXb5_GmyC58_n","data":[{"name":"stderr","output_type":"stream","text":"\u001b[36m\u001b[1m[ \u001b[22m\u001b[39m\u001b[36m\u001b[1mInfo: \u001b[22m\u001b[39mSaved animation to /Users/driscoll/Dropbox/Mac/Documents/GitHub/fnc-notebooks/chapter12/section1/julia/traffic-fade.mp4\n"},{"output_type":"execute_result","execution_count":7,"metadata":{},"data":{"text/plain":{"content":"Plots.AnimatedGif(\"/Users/driscoll/Dropbox/Mac/Documents/GitHub/fnc-notebooks/chapter12/section1/julia/traffic-fade.mp4\")","content_type":"text/plain"},"text/html":{"content_type":"text/html","hash":"04ba6f64d6095f98be3ec71671dfc10c","path":"/build/04ba6f64d6095f98be3ec71671dfc10c.html"}}}],"visibility":"show","key":"Vy5Nx9BVFG"}],"visibility":"show","key":"zJSNdNP3jN"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now we use an initial condition with a larger bump. Note that the scale on the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"SfvwWsz8ZN"},{"type":"inlineMath","value":"y","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>","key":"VhgbTxSp7D"},{"type":"text","value":"-axis is much different for this solution.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"BPxk8WDby1"}],"key":"PRObsDlYRY"}],"key":"K2y1NyDYcc"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:37:53.555000Z","iopub.status.busy":"2025-01-14T15:34:12.640000Z","iopub.execute_input":"2025-01-14T15:34:12.642000Z","shell.execute_reply":"2025-01-14T15:37:53.549000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"ρ_init = @. 400 + 80 * exp( -16*(x - 3)^2 )\nIVP = ODEProblem(ode, ρ_init, (0., 0.5), 0.02)\nsol = solve(IVP, Rodas4P());","key":"kjVyGU1jsz"},{"type":"output","id":"GR_2GBXwqF3yeQQJEO0OT","data":[],"key":"LoFljYxBrb"}],"key":"HQMzun8sd9"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:37:55.523000Z","iopub.status.busy":"2025-01-14T15:37:53.580000Z","iopub.execute_input":"2025-01-14T15:37:53.582000Z","shell.execute_reply":"2025-01-14T15:37:55.519000Z"},"tags":[]},"children":[{"type":"code","lang":"julia","executable":true,"value":"plt = plot(\n    legend=:topleft,\n    title=\"Traffic jam\",\n    xaxis=(L\"x\"),  yaxis=(\"car density\"))\nfor t in range(0, 0.5, 11)\n    plot!(x, sol(t), label=@sprintf(\"t=%.1f\", t))\nend\nplt","visibility":"hide","key":"TjYDfKbgc9"},{"type":"output","id":"fisDLCQseXbhEkKFyldk3","data":[{"output_type":"execute_result","execution_count":9,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"4c4dd2a590aa9b7216ff23592fd28913","path":"/build/4c4dd2a590aa9b7216ff23592fd28913.png"},"text/html":{"content_type":"text/html","hash":"4b1a296d0862be11d2f73922115272cc","path":"/build/4b1a296d0862be11d2f73922115272cc.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"9b3f0969634b12e1fcc2c0e3d9c18a23","path":"/build/9b3f0969634b12e1fcc2c0e3d9c18a23.svg"}}}],"visibility":"show","key":"NhSXZ391k6"}],"visibility":"show","key":"EIuaH30rbw"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:38:28.213000Z","iopub.status.busy":"2025-01-14T15:37:55.547000Z","iopub.execute_input":"2025-01-14T15:37:55.551000Z","shell.execute_reply":"2025-01-14T15:38:28.213000Z"},"tags":[]},"children":[{"type":"code","lang":"julia","executable":true,"value":"anim = @animate for t in range(0, 0.5, 101) \n    plot(x, sol(t);\n        xaxis=(L\"x\"),  yaxis=([400,480], \"density\"),\n        dpi=150,  title=@sprintf(\"Traffic jam, t=%.2f\",t))\nend\nmp4(anim,\"traffic-jam.mp4\")","visibility":"hide","key":"TrUs7sx7vq"},{"type":"output","id":"S8gAnkbATqARxPjRyACe2","data":[{"name":"stderr","output_type":"stream","text":"\u001b[36m\u001b[1m[ \u001b[22m\u001b[39m\u001b[36m\u001b[1mInfo: \u001b[22m\u001b[39mSaved animation to /Users/driscoll/Dropbox/Mac/Documents/GitHub/fnc-notebooks/chapter12/section1/julia/traffic-jam.mp4\n"},{"output_type":"execute_result","execution_count":10,"metadata":{},"data":{"text/plain":{"content":"Plots.AnimatedGif(\"/Users/driscoll/Dropbox/Mac/Documents/GitHub/fnc-notebooks/chapter12/section1/julia/traffic-jam.mp4\")","content_type":"text/plain"},"text/html":{"content_type":"text/html","hash":"5e6c0173dc440b6138780c5c63c24a23","path":"/build/5e6c0173dc440b6138780c5c63c24a23.html"}}}],"visibility":"show","key":"mylvYhP7U4"}],"visibility":"show","key":"WPEr8kqQQE"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"In this case the density bump travels backward along the road. It also steepens on the side facing the incoming traffic and decreases much more slowly on the other side. A motorist would experience this as an abrupt increase in density, followed by a much more gradual decrease in density and resulting gradual increase in speed. (You also see some transient, high-frequency oscillations. These are caused by instabilities, as we discuss in simpler situations later in this chapter.)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"SC7Lv7k6s5"}],"key":"bu3ZKbx7ZL"}],"key":"Mb43PyFuoh"}],"key":"jj9COMoWkk"}],"key":"zkVmlb9Hw8"}],"key":"h5uWm0SVH0"},{"type":"tabItem","title":"MATLAB","sync":"matlab","children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Traffic flow model","position":{"start":{"line":156,"column":1},"end":{"line":156,"column":1}},"key":"Yx2BnXT1nQ"}],"key":"q9hgpPhx66"},{"type":"include","file":"matlab/solve-a.ipynb","children":[{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"link","url":"#demo-traffic-solvea","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo %s","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"EgIn4NXitG"}],"key":"g68ScQ0ilo"}],"urlSource":"#demo-traffic-solvea","key":"OCgRlhYccR"}],"key":"c0czpERJ66"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The following are parameters and a function relevant to defining the problem.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"EEviWwMqNI"}],"key":"o4ZGFy52IQ"}],"key":"QM6cxyzEwl"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"rho_c = 1080;  rho_m = 380;  q_m = 10000;\nQ0prime = @(rho) 4*q_m*rho_c^2 * (rho_c - rho_m) * rho_m ...\n    *(rho_m - rho) ./ ((rho_c - 2*rho_m) * rho + rho_c * rho_m).^3;\nep = 0.02;","key":"KJa1a1OYmx"},{"type":"output","id":"m3Ueis5uk7pcIDY2aa0OP","data":[],"key":"O9ldx0qvAo"}],"key":"Bby1Uvobxh"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Here we create a discretization on ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jbLaa8X829"},{"type":"inlineMath","value":"m=800","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi><mo>=</mo><mn>800</mn></mrow><annotation encoding=\"application/x-tex\">m=800</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">800</span></span></span></span>","key":"I5bAgTTqb5"},{"type":"text","value":" points.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PA8RN3q1s9"}],"key":"T0HgzaUaeu"}],"key":"q2ouvtomjn"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"[x, Dx, Dxx] = diffper(800, [0, 4]);","key":"Rxfw5jdKhT"},{"type":"output","id":"3Jethj41i003XpJebO1N_","data":[],"key":"aJTaK5lNv3"}],"key":"ZyvbwIX4HQ"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Next we define the ","key":"i4dgn1vhgo"},{"type":"abbreviation","title":"ordinary differential equation","children":[{"type":"text","value":"ODE","key":"I20KkVmSCW"}],"key":"RitCuRcHRk"},{"type":"text","value":" resulting from the method of lines.","key":"jdpwFkLI6A"}],"key":"G2stIjWxDb"}],"key":"AqUbDSVjbz"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"odefun = @(t, rho) -Q0prime(rho) .* (Dx*rho) + ep * (Dxx*rho);\nivp = ode(ODEFcn=odefun);\nivp.InitialTime = 0;\nivp.RelativeTolerance = 1e-5;","key":"S7gwOQpng6"},{"type":"output","id":"djhN1D2SGCArHsMQATvDx","data":[],"key":"NQ6eXtRS0f"}],"key":"uDB8aojwur"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Our first initial condition has moderate density with a small bump. Because of the diffusion present, we use a stiff solver for the ","key":"CXHSY0sxL2"},{"type":"abbreviation","title":"initial-value problem","children":[{"type":"text","value":"IVP","key":"a06Iyn2Ux4"}],"key":"jWeVigxUSV"},{"type":"text","value":".","key":"Jv4TAcaY9h"}],"key":"Qe7Ao39HWu"}],"key":"s5ByDqU3Z4"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"rho_init = 400 + 10 * exp(-20*(x-3).^2);\nivp.InitialValue = rho_init;\n\nt = linspace(0, 1, 101);\nsol = solve(ivp, t);\nRHO = sol.Solution;","key":"vK0Tq3DwQc"},{"type":"output","id":"EDMqpjtfRw1NL0e-k6boP","data":[],"key":"HS2ciViXbm"}],"key":"CZncv4nEmp"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"matlab","executable":true,"value":"clf\nfor plot_idx = 1:20:101\n    str = sprintf(\"t = %.2f\", t(plot_idx));\n    plot(x, RHO(:, plot_idx), displayname=str)\n    hold on\nend\nxlabel('x'),  ylabel('car density')\ntitle('Traffic flow') \nlegend(location=\"northwest\")","visibility":"hide","key":"dAG6VuJiYD"},{"type":"output","id":"isMBkVWrasRES_HSG0A7H","data":[{"output_type":"execute_result","execution_count":6,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"189297f946ff3e88373c9991134c8265","path":"/build/189297f946ff3e88373c9991134c8265.png"}}}],"visibility":"show","key":"OPdhWeqQR7"}],"visibility":"show","key":"R00MEyhWDI"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The bump slowly moves backward on the roadway, spreading out and gradually fading away due to the presence of diffusion.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"em9A0hw9Y9"}],"key":"VQR4dRfboU"}],"key":"cc4XrgR7jG"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"matlab","executable":true,"value":"clf\nplot(x, RHO(:, 1))\nhold on,  grid on\naxis([0, 4, 398, 410])\ntitle('Traffic flow') \nxlabel('x'),  ylabel('u(x,t)')\nvid = VideoWriter(\"traffic-small.mp4\",\"MPEG-4\");\nvid.Quality = 85;\nopen(vid);\nfor frame = 1:length(t)\n    cla, plot(x, RHO(:, frame))\n    str = sprintf(\"t = %.2f\", t(frame));\n    text(0.2, 409, str);\n    writeVideo(vid, frame2im(getframe(gcf)));\nend\nclose(vid)\nclose(gcf)","visibility":"hide","key":"ZAKwVKEONR"},{"type":"output","id":"lWbIgBSM1Yw73TkHI1Y8G","data":[],"visibility":"remove","key":"LmnlQatbEl"}],"visibility":"show","key":"Szoo0e5WL3"}],"key":"ps0OVY8TS0"},{"type":"image","url":"/build/traffic-small-121273c51be3a1226c39f1551c10dc7d.mp4","alt":"Traffic simulation","position":{"start":{"line":160,"column":1},"end":{"line":160,"column":1}},"urlSource":"../../matlab/traffic-small.mp4","key":"cNPC3AmPMv"},{"type":"include","file":"matlab/solve-b.ipynb","children":[{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"link","url":"#demo-traffic-solveb","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo %s","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xPos5tHHBh"}],"key":"iX18Xa27XD"}],"urlSource":"#demo-traffic-solveb","key":"gj4CnSPv4H"}],"key":"S7ieYkyt2V"}],"key":"Q2nzxYAlyG"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now we use an initial condition with a larger bump. Note that the scale on the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"A4ae1610qA"},{"type":"inlineMath","value":"y","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>","key":"KlojZ2JvxP"},{"type":"text","value":"-axis is much different for this solution.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zeAYnzo1cR"}],"key":"bOzHibTJOV"}],"key":"MzyTqBnwwL"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"rho_init = 400 + 80 * exp( -16*(x - 3).^2 );\nivp.InitialValue = rho_init;\nt = linspace(0, 0.5, 81);\nsol = solve(ivp, t);\nRHO = sol.Solution;","key":"pYpE1YYdLJ"},{"type":"output","id":"RCQYpC1m8eWywUzhOkbsB","data":[],"key":"bWQXWrKS69"}],"key":"qYz1yjR2gj"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"matlab","executable":true,"value":"for plot_idx = 1:16:81\n    str = sprintf(\"t = %.2f\", t(plot_idx));\n    plot(x, RHO(:, plot_idx), displayname=str)\n    hold on\nend\nxlabel('x'),  ylabel('car density')\ntitle('Traffic jam') \nlegend(location=\"northwest\")","visibility":"hide","key":"flmk34b6et"},{"type":"output","id":"DhPNgidHJCp396WMRGyeW","data":[{"output_type":"execute_result","execution_count":16,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"53a2309f822042a6572ba9abf497ad8e","path":"/build/53a2309f822042a6572ba9abf497ad8e.png"}}}],"visibility":"show","key":"ycNYcwcDSf"}],"visibility":"show","key":"jBRj6KwuXx"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"matlab","executable":true,"value":"clf\nplot(x, RHO(:, 1))\nhold on,  grid on\naxis([0, 4, 395, 480])\ntitle('Traffic jam') \nxlabel('x'),  ylabel('u(x,t)')\nvid = VideoWriter(\"traffic-jam.mp4\", \"MPEG-4\");\nvid.Quality = 85;\nopen(vid);\nfor frame = 1:length(t)\n    cla, plot(x, RHO(:, frame))\n    str = sprintf(\"t = %.2f\", t(frame));\n    text(0.2, 470, str);\n    writeVideo(vid, frame2im(getframe(gcf)));\nend\nclose(vid)\nclose(gcf)","visibility":"hide","key":"aU156hmHh5"},{"type":"output","id":"oedcseHesiwLX0RNGrDDV","data":[],"visibility":"remove","key":"BSawdbEAbh"}],"visibility":"show","key":"C6LbQU95Up"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"In this case the density bump travels backward along the road. It also steepens on the side facing the incoming traffic and decreases much more slowly on the other side. A motorist would experience this as an abrupt increase in density, followed by a much more gradual decrease in density and resulting gradual increase in speed. (You also see some transient, high-frequency oscillations. These are caused by instabilities, as we discuss in simpler situations later in this chapter.)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WNHmAkAXUC"}],"key":"KyKYmQFOxs"}],"key":"V1I8zfqIAt"}],"key":"lpXaFBO4ZN"},{"type":"image","url":"/build/traffic-jam-53ad1384b7bd2e23a60121bdb32b93ac.mp4","alt":"Traffic jam","position":{"start":{"line":165,"column":1},"end":{"line":165,"column":1}},"urlSource":"../../matlab/traffic-jam.mp4","key":"fSmYRNy3RM"}],"key":"YAoX89wdXk"}],"key":"E6Domp5sEj"},{"type":"tabItem","title":"Python","sync":"python","children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Traffic flow model","position":{"start":{"line":171,"column":1},"end":{"line":171,"column":1}},"key":"avQFZoNpyW"}],"key":"YVD1PMDRKj"},{"type":"include","file":"python/solve-a.ipynb","children":[{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-09T21:28:58.247590Z","iopub.status.busy":"2025-01-09T21:28:58.247506Z","iopub.status.idle":"2025-01-09T21:28:58.694312Z","shell.execute_reply":"2025-01-09T21:28:58.694041Z"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"exec(open(\"../../../python/FNC_init.py\").read())","visibility":"show","key":"JNtj4QxizN"},{"type":"output","id":"5mCVNVjH_O8FsO_TCkiAO","data":[],"visibility":"show","key":"EkM2mwzgsf"}],"visibility":"remove","key":"gcEuaxpKla"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"blOkA6yee2"},{"type":"text","value":"12.1.2","key":"XwHFxMnl6T"}],"key":"kvK1MTXnyk"}],"identifier":"demo-traffic-solve","label":"demo-traffic-solve","kind":"proof:example","template":"Example %s","enumerator":"12.1.2","resolved":true,"html_id":"demo-traffic-solve","key":"fcpmsHsBZD"}],"key":"GhPtiQ3GyD"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The following are parameters and a function relevant to defining the problem.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"PMSHBTj6Ta"}],"key":"YUueNYcbAg"}],"key":"qZJXbUnbnn"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-09T21:28:58.695868Z","iopub.status.busy":"2025-01-09T21:28:58.695712Z","iopub.status.idle":"2025-01-09T21:28:58.697701Z","shell.execute_reply":"2025-01-09T21:28:58.697502Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"rho_c = 1080\nrho_m = 380\nq_m = 10000\nQ0prime = (\n    lambda rho: q_m\n    * 4\n    * rho_c**2\n    * (rho_c - rho_m)\n    * rho_m\n    * (rho_m - rho)\n    / (rho * (rho_c - 2 * rho_m) + rho_c * rho_m) ** 3\n)","key":"LWcsebewX5"},{"type":"output","id":"BIrl-gQb_hX8zUV_FiypV","data":[],"key":"hZ81BHE1KB"}],"key":"MbJOBNnVJP"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Here we create a discretization on ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"FMEcnkzIMS"},{"type":"inlineMath","value":"m=800","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi><mo>=</mo><mn>800</mn></mrow><annotation encoding=\"application/x-tex\">m=800</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">800</span></span></span></span>","key":"YEk6f5Zjzm"},{"type":"text","value":" points.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"uXCptCTeUo"}],"key":"cHshyN9zQd"}],"key":"wnX9GzYRB9"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-09T21:28:58.698913Z","iopub.status.busy":"2025-01-09T21:28:58.698820Z","iopub.status.idle":"2025-01-09T21:28:58.702837Z","shell.execute_reply":"2025-01-09T21:28:58.702604Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"x, Dx, Dxx = FNC.diffper(800, [0, 4])","key":"Q23NApTwjk"},{"type":"output","id":"iMJEq-drkQinD5B8S9TQl","data":[],"key":"FAv3sYcLjc"}],"key":"OLlLEaLoeM"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Next we define the ","key":"c34LzT0baC"},{"type":"abbreviation","title":"ordinary differential equation","children":[{"type":"text","value":"ODE","key":"Riaar2E1ob"}],"key":"U8D639pHLe"},{"type":"text","value":" resulting from the method of lines.","key":"VofG4r8mBx"}],"key":"vBbNa4l3uq"}],"key":"EuLU0YCIKk"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-09T21:28:58.704052Z","iopub.status.busy":"2025-01-09T21:28:58.703955Z","iopub.status.idle":"2025-01-09T21:28:58.705632Z","shell.execute_reply":"2025-01-09T21:28:58.705419Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"ode = lambda t, rho: -Q0prime(rho) * (Dx @ rho) + ep * (Dxx @ rho)","key":"rL2Tgn4cwh"},{"type":"output","id":"mCmIlPPufM4Kb__NbYgpO","data":[],"key":"g9YaNXTS4z"}],"key":"mOuaZg8dIs"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Our first initial condition has moderate density with a small bump. Because of the diffusion present, we use a stiff solver for the ","key":"ksYZlRDAAn"},{"type":"abbreviation","title":"initial-value problem","children":[{"type":"text","value":"IVP","key":"PgPBtu56fB"}],"key":"RJK6BYuFID"},{"type":"text","value":".","key":"kNIWhZcgw0"}],"key":"F70e5k6vre"}],"key":"NYmGi2rq51"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-09T21:28:58.706709Z","iopub.status.busy":"2025-01-09T21:28:58.706623Z","iopub.status.idle":"2025-01-09T21:28:59.542173Z","shell.execute_reply":"2025-01-09T21:28:59.541837Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"from scipy.integrate import solve_ivp\nrho_init = 400 + 10 * exp(-20 * (x - 3) ** 2)\nep = 0.02\nsol = solve_ivp(ode, [0, 1.0], rho_init, method=\"Radau\", dense_output=True)","key":"npjJJJJrvp"},{"type":"output","id":"UKqAzLnrtG6WwM6Q2vVNa","data":[],"key":"yUW6wfQewh"}],"key":"XYyRLjocLB"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-09T21:28:59.543757Z","iopub.status.busy":"2025-01-09T21:28:59.543651Z","iopub.status.idle":"2025-01-09T21:28:59.717923Z","shell.execute_reply":"2025-01-09T21:28:59.717664Z"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"for t in linspace(0, 1, 6):\n    plot(x, sol.sol(t), label=f\"t = {t:.1f}\")\n\nxlabel(\"$x$\"),  ylabel(\"car density\")\nlegend(),  title(\"Traffic flow\");","visibility":"hide","key":"ULsss6LARY"},{"type":"output","id":"njqZILrMYSMdlZ0wQYxoO","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"c69af6eeb30e5b1f38cf3752419dda9d","path":"/build/c69af6eeb30e5b1f38cf3752419dda9d.png"},"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"}}}],"visibility":"show","key":"ZdUqoTc0M2"}],"visibility":"show","key":"VObEWquwhS"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The bump slowly moves backward on the roadway, spreading out and gradually fading away due to the presence of diffusion.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ba4HtfxR27"}],"key":"KVtxNCsVio"}],"key":"pq04AtWgBz"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-09T21:28:59.719280Z","iopub.status.busy":"2025-01-09T21:28:59.719164Z","iopub.status.idle":"2025-01-09T21:29:01.836625Z","shell.execute_reply":"2025-01-09T21:29:01.836305Z"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"from matplotlib.animation import FuncAnimation\nfig, ax = subplots()\ncurve = ax.plot(x, rho_init)[0]\ntime_text = ax.text(0.05, 0.9, '', transform=ax.transAxes)\nax.set_xlabel(\"$x$\")\nax.set_ylabel(\"density\")\nax.set_ylim(400, 410)\nax.set_title(\"Traffic flow\")\ndef snapshot(t):\n    curve.set_ydata(sol.sol(t))\n    time_text.set_text(f\"t = {t:.2f}\")\n\nanim = FuncAnimation(fig, snapshot, frames=linspace(0, 1, 101))\nanim.save(\"traffic-small.mp4\", fps=30)\nclose()","visibility":"hide","key":"g5puwFa1gJ"},{"type":"output","id":"dR4tKGKGD6q70zdyegzXa","data":[],"visibility":"show","key":"G4zyhEQLOV"}],"visibility":"show","key":"fNv2UGsTQn"}],"key":"J7RDdR1rCk"},{"type":"image","url":"/build/traffic-small-b703e3951f26547aeeb1fb0d814a102a.mp4","alt":"Traffic simulation","position":{"start":{"line":176,"column":1},"end":{"line":176,"column":1}},"urlSource":"python/traffic-small.mp4","key":"wfTzHmN4QM"},{"type":"include","file":"python/solve-b.ipynb","children":[{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-09T21:29:02.589994Z","iopub.status.busy":"2025-01-09T21:29:02.589905Z","iopub.status.idle":"2025-01-09T21:29:02.931504Z","shell.execute_reply":"2025-01-09T21:29:02.931172Z"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"exec(open(\"../../../python/FNC_init.py\").read())","visibility":"show","key":"cdVtIWpL2U"},{"type":"output","id":"egkJFvsMvDQrIjFzWLDSX","data":[],"visibility":"show","key":"uD8T8ejDsF"}],"visibility":"remove","key":"jTJOVri6QZ"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now we use an initial condition with a larger bump. Note that the scale on the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"F20SoCQYTi"},{"type":"inlineMath","value":"y","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>","key":"qTWHL530gY"},{"type":"text","value":"-axis is much different for this solution.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zBNIjqhDHD"}],"key":"iHQ3MeUzTV"}],"key":"jIOXewZPAM"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-09T21:29:02.933127Z","iopub.status.busy":"2025-01-09T21:29:02.932997Z","iopub.status.idle":"2025-01-09T21:29:02.938099Z","shell.execute_reply":"2025-01-09T21:29:02.937844Z"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"from scipy.integrate import solve_ivp\nrho_c, rho_m, q_m, ep = (1080, 380, 10000, 0.02)\nQ0prime = (\n    lambda rho: q_m * 4 * rho_c**2 * (rho_c - rho_m) * rho_m * (rho_m - rho)\n    / (rho * (rho_c - 2 * rho_m) + rho_c * rho_m) ** 3\n)\nx, Dx, Dxx = FNC.diffper(800, [0, 4])\node = lambda t, rho: -Q0prime(rho) * (Dx @ rho) + ep * (Dxx @ rho)","visibility":"show","key":"cFbXOaV88O"},{"type":"output","id":"L4aBhQJtmbfjgu-c6sVIk","data":[],"visibility":"show","key":"rUDOFbVtnv"}],"visibility":"remove","key":"jYhHbz75tv"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-09T21:29:02.939402Z","iopub.status.busy":"2025-01-09T21:29:02.939312Z","iopub.status.idle":"2025-01-09T21:29:09.166930Z","shell.execute_reply":"2025-01-09T21:29:09.166512Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"rho_init = 400 + 80 * exp(-16 * (x - 3) ** 2)\nsol = solve_ivp(ode, [0, 0.5], rho_init, method=\"Radau\", dense_output=True)","key":"tUyUQt3Dz1"},{"type":"output","id":"ifYi0RBTa5y0-8fYml5ms","data":[],"key":"rm6xc8BLnX"}],"key":"JSvLqOYIrX"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-09T21:29:09.168515Z","iopub.status.busy":"2025-01-09T21:29:09.168396Z","iopub.status.idle":"2025-01-09T21:29:09.361900Z","shell.execute_reply":"2025-01-09T21:29:09.361641Z"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"for t in linspace(0, 0.5, 6):\n    plot(x, sol.sol(t), label=f\"t = {t:.1f}\")\nxlabel(\"$x$\"),  ylabel(\"car density\")\nlegend(),  title(\"Traffic jam\");","visibility":"hide","key":"gGSEteGRxG"},{"type":"output","id":"q37CYgyiCHyGYg7qBVY2M","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"2f68ad8a46233750fdb440fd5cbdc67f","path":"/build/2f68ad8a46233750fdb440fd5cbdc67f.png"},"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"}}}],"visibility":"show","key":"wbuBy7mUEt"}],"visibility":"show","key":"hN3PnuZkzO"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-09T21:29:09.366684Z","iopub.status.busy":"2025-01-09T21:29:09.366548Z","iopub.status.idle":"2025-01-09T21:29:11.656991Z","shell.execute_reply":"2025-01-09T21:29:11.656577Z"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"from matplotlib.animation import FuncAnimation\nfig, ax = subplots()\ncurve = ax.plot(x, rho_init)[0]\ntime_text = ax.text(0.05, 0.9, '', transform=ax.transAxes)\nax.set_xlabel(\"$x$\")\nax.set_ylabel(\"density\")\nax.set_ylim(400, 480)\nax.set_title(\"Traffic jam\")\ndef snapshot(t):\n    curve.set_ydata(sol.sol(t))\n    time_text.set_text(f\"t = {t:.2f}\")\n\nanim = FuncAnimation(fig, snapshot, frames=linspace(0, 0.5, 101))\nanim.save(\"traffic-jam.mp4\", fps=30)\nclose()","visibility":"hide","key":"uD3vTsXKKH"},{"type":"output","id":"ohPSkbA6l9Mw4GOiZiLXb","data":[],"visibility":"show","key":"XEqszmcjfO"}],"visibility":"show","key":"cW4oGaKQFe"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"In this case the density bump travels backward along the road. It also steepens on the side facing the incoming traffic and decreases much more slowly on the other side. A motorist would experience this as an abrupt increase in density, followed by a much more gradual decrease in density and resulting gradual increase in speed. (You also see some transient, high-frequency oscillations. These are caused by instabilities, as we discuss in simpler situations later in this chapter.)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ka99OnY2XR"}],"key":"ND0WH2TgoC"}],"key":"owu1JifrNE"}],"key":"CEt7x5ZCXP"},{"type":"image","url":"/build/traffic-jam-00118e5d440f113109818c1fc984e7cd.mp4","alt":"Traffic jam","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"urlSource":"python/traffic-jam.mp4","key":"wDin9emysw"}],"key":"ROhGZ6nBdQ"}],"key":"we5xj8LNim"}],"key":"PZU2IhQhIV"}],"label":"demo-traffic-solve","identifier":"demo-traffic-solve","html_id":"demo-traffic-solve","enumerator":"12.1.2","key":"i4qwDiKdw7"},{"type":"paragraph","position":{"start":{"line":194,"column":1},"end":{"line":194,"column":1}},"children":[{"type":"text","value":"The phenomenon in the second plot of ","position":{"start":{"line":194,"column":1},"end":{"line":194,"column":1}},"key":"zEKio1OlAe"},{"type":"crossReference","kind":"proof:example","identifier":"demo-traffic-solve","label":"demo-traffic-solve","children":[{"type":"text","value":"Demo ","key":"rybdYiGV3n"},{"type":"text","value":"12.1.2","key":"b5Xy0BIamp"}],"template":"Example %s","enumerator":"12.1.2","resolved":true,"html_id":"demo-traffic-solve","key":"p3KTfA3zQY"},{"type":"text","value":" is called a ","position":{"start":{"line":194,"column":1},"end":{"line":194,"column":1}},"key":"tOsM36cFks"},{"type":"emphasis","position":{"start":{"line":194,"column":1},"end":{"line":194,"column":1}},"children":[{"type":"text","value":"shock wave","position":{"start":{"line":194,"column":1},"end":{"line":194,"column":1}},"key":"eLB0hE4glf"}],"key":"OLvT7AfEnX"},{"type":"text","value":". The underlying mathematics is not much different from the shock wave that comes off of the wing of a supersonic aircraft in the form of a sonic boom, or from cresting waves under certain conditions in the ocean. In the absence of diffusion (","position":{"start":{"line":194,"column":1},"end":{"line":194,"column":1}},"key":"HWQdawPosn"},{"type":"inlineMath","value":"\\epsilon=0","position":{"start":{"line":194,"column":1},"end":{"line":194,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ϵ</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">\\epsilon=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">ϵ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"CCyjQgaQQt"},{"type":"text","value":"), the shock becomes a jump discontinuity in the solution, which breaks down both the finite differences and the original ","key":"YddEBcNiXr"},{"type":"abbreviation","title":"partial differential equation","children":[{"type":"text","value":"PDE","key":"h6rLSTw4Lu"}],"key":"vgPJAbHtS0"},{"type":"text","value":", requiring different approaches. For many applications, the addition of a small amount of diffusion is appropriate and simple. However, we will first try to come to terms with pure advection in a linear problem.","key":"EcTSw8cHqp"}],"indexEntries":[{"entry":"shock wave","emphasis":false}],"label":"index-EUW9HC6aHZ","identifier":"index-euw9hc6ahz","html_id":"index-euw9hc6ahz","key":"odY8b3QV3c"},{"type":"heading","depth":2,"position":{"start":{"line":196,"column":1},"end":{"line":196,"column":1}},"children":[{"type":"text","value":"Exercises","position":{"start":{"line":196,"column":1},"end":{"line":196,"column":1}},"key":"B3nB91V977"}],"identifier":"exercises","label":"Exercises","html_id":"exercises","implicit":true,"enumerator":"12.1.4","key":"ks610cVqps"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":198,"column":1},"end":{"line":220,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":198,"column":1},"end":{"line":199,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"children":[{"type":"text","value":"✍ By the analogy between ","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"key":"kXIPNnQZKs"},{"type":"crossReference","kind":"equation","identifier":"trafficpde","label":"trafficpde","children":[{"type":"text","value":"(","key":"rYvjsCGuvM"},{"type":"text","value":"12.1.4","key":"F8OtzI6BnG"},{"type":"text","value":")","key":"isa6bXt78R"}],"template":"(%s)","enumerator":"12.1.4","resolved":true,"html_id":"trafficpde","key":"yKfQdDTu7v"},{"type":"text","value":" and ","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"key":"qJlHiBsMW5"},{"type":"crossReference","kind":"equation","identifier":"advectpde","label":"advectpde","children":[{"type":"text","value":"(","key":"SXGSAdo1AT"},{"type":"text","value":"12.1.5","key":"ddchGJGf58"},{"type":"text","value":")","key":"A18jtJS7bO"}],"template":"(%s)","enumerator":"12.1.5","resolved":true,"html_id":"advectpde","key":"Q1cZME1EdB"},{"type":"text","value":", use ","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"key":"q29RFzFhsS"},{"type":"crossReference","kind":"equation","identifier":"trafficq","label":"trafficQ","children":[{"type":"text","value":"(","key":"hFY92koUtf"},{"type":"text","value":"12.1.1","key":"MH8mFFIXEp"},{"type":"text","value":")","key":"ritHHf13C7"}],"template":"(%s)","enumerator":"12.1.1","resolved":true,"html_id":"trafficq","key":"cg2n7LgUun"},{"type":"text","value":" to confirm that constant traffic density moves backward (right to left) for ","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"key":"olNo6WxqV6"},{"type":"inlineMath","value":"\\rho_m<\\rho<\\rho_c","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>ρ</mi><mi>m</mi></msub><mo>&lt;</mo><mi>ρ</mi><mo>&lt;</mo><msub><mi>ρ</mi><mi>c</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\rho_m&lt;\\rho&lt;\\rho_c</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7335em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">ρ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&lt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7335em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">ρ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&lt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">ρ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">c</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"yC4cJ7wArl"},{"type":"text","value":", as observed in ","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"key":"kRItJDP66B"},{"type":"crossReference","kind":"proof:example","identifier":"demo-traffic-solve","label":"demo-traffic-solve","children":[{"type":"text","value":"Demo ","key":"Ikb20JwIpc"},{"type":"text","value":"12.1.2","key":"WsodVxvXBm"}],"template":"Example %s","enumerator":"12.1.2","resolved":true,"html_id":"demo-traffic-solve","key":"C9lCkB9kq6"},{"type":"text","value":". (Note that the derivative of ","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"key":"RZ1cZAi6KQ"},{"type":"inlineMath","value":"Q_0","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>Q</mi><mn>0</mn></msub></mrow><annotation encoding=\"application/x-tex\">Q_0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">Q</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"GfQ1ENPqK8"},{"type":"text","value":" is given in the code for the example.)","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"key":"FSukzLA9Nt"}],"key":"NCizI9KC4l"}],"key":"nye06azLy3"},{"type":"listItem","spread":true,"position":{"start":{"line":200,"column":1},"end":{"line":205,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"children":[{"type":"text","value":"⌨ ","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"key":"FqVMe4uNJC"},{"type":"strong","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"children":[{"type":"text","value":"(a)","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"key":"wL9n8wO053"}],"key":"PxB9F88e7C"},{"type":"text","value":" Using as large a discretization and as small a dissipation parameter ","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"key":"YtK9yPoiiw"},{"type":"text","value":"ε","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"key":"Jg2oxTzKNO"},{"type":"text","value":"  as you can get away with, perform experiments to estimate the speed of the shockwave in ","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"key":"cfZ3aPkmYJ"},{"type":"crossReference","kind":"proof:example","identifier":"demo-traffic-solve","label":"demo-traffic-solve","children":[{"type":"text","value":"Demo ","key":"GBw79UuLwK"},{"type":"text","value":"12.1.2","key":"N346AquWGP"}],"template":"Example %s","enumerator":"12.1.2","resolved":true,"html_id":"demo-traffic-solve","key":"E0dmbwWym3"},{"type":"text","value":" between times ","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"key":"zj20z9o30e"},{"type":"inlineMath","value":"t=0.11","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi><mo>=</mo><mn>0.11</mn></mrow><annotation encoding=\"application/x-tex\">t=0.11</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0.11</span></span></span></span>","key":"TezE63w0XJ"},{"type":"text","value":" and ","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"key":"D7kfb88iCy"},{"type":"inlineMath","value":"t=0.15","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi><mo>=</mo><mn>0.15</mn></mrow><annotation encoding=\"application/x-tex\">t=0.15</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0.15</span></span></span></span>","key":"gy0cbzyNEP"},{"type":"text","value":". (Hint: You can use ","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"key":"lPXwsmYnTA"},{"type":"inlineCode","value":"argmax","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"key":"MGycBmK0ZU"},{"type":"text","value":" to locate the peak of the solution vector at a particular time.)","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"key":"eT9kY1hZFJ"}],"key":"R43t4Abzp6"},{"type":"paragraph","position":{"start":{"line":202,"column":1},"end":{"line":202,"column":1}},"children":[{"type":"strong","position":{"start":{"line":202,"column":1},"end":{"line":202,"column":1}},"children":[{"type":"text","value":"(b)","position":{"start":{"line":202,"column":1},"end":{"line":202,"column":1}},"key":"XygXJX2pss"}],"key":"Z0x8RZb6Uf"},{"type":"text","value":" Theory predicts that the speed of the shockwave is the average of ","position":{"start":{"line":202,"column":1},"end":{"line":202,"column":1}},"key":"EPYXL8DrBF"},{"type":"inlineMath","value":"Q_0'","position":{"start":{"line":202,"column":1},"end":{"line":202,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msubsup><mi>Q</mi><mn>0</mn><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msubsup></mrow><annotation encoding=\"application/x-tex\">Q_0&#x27;</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.2481em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">Q</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-2.4519em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2481em;\"><span></span></span></span></span></span></span></span></span></span>","key":"DbaFUpM3DA"},{"type":"text","value":" evaluated at the values of ","position":{"start":{"line":202,"column":1},"end":{"line":202,"column":1}},"key":"IoVB8RpEJ5"},{"type":"text","value":"ρ","position":{"start":{"line":202,"column":1},"end":{"line":202,"column":1}},"key":"fcU6C6uAPz"},{"type":"text","value":" at the top and bottom of the shock. Perform this calculation and compare to the result of part (a).","position":{"start":{"line":202,"column":1},"end":{"line":202,"column":1}},"key":"JSu6cV5oqc"}],"key":"GV0tMLRXCp"}],"key":"YzUn1K0722"},{"type":"listItem","spread":true,"position":{"start":{"line":206,"column":1},"end":{"line":209,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":206,"column":1},"end":{"line":206,"column":1}},"children":[{"type":"text","value":"⌨ The simplest model that includes both diffusion and nonlinear advection is the ","position":{"start":{"line":206,"column":1},"end":{"line":206,"column":1}},"key":"QqPlq7KcoD"},{"type":"emphasis","position":{"start":{"line":206,"column":1},"end":{"line":206,"column":1}},"children":[{"type":"text","value":"viscous Burgers equation","position":{"start":{"line":206,"column":1},"end":{"line":206,"column":1}},"key":"RzEzORj9y6"}],"key":"TY0t6YVaxy"},{"type":"text","value":", ","position":{"start":{"line":206,"column":1},"end":{"line":206,"column":1}},"key":"wpaQfdKFPm"},{"type":"inlineMath","value":"u_t+u u_x=\\epsilon u_{xx}","position":{"start":{"line":206,"column":1},"end":{"line":206,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>u</mi><mi>t</mi></msub><mo>+</mo><mi>u</mi><msub><mi>u</mi><mi>x</mi></msub><mo>=</mo><mi>ϵ</mi><msub><mi>u</mi><mrow><mi>x</mi><mi>x</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">u_t+u u_x=\\epsilon u_{xx}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord mathnormal\">ϵ</span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">xx</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"pd38FrYRyk"},{"type":"text","value":". Assume periodic end conditions on ","position":{"start":{"line":206,"column":1},"end":{"line":206,"column":1}},"key":"BvAibaOawC"},{"type":"inlineMath","value":"-4\\le x < 4","position":{"start":{"line":206,"column":1},"end":{"line":206,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>−</mo><mn>4</mn><mo>≤</mo><mi>x</mi><mo>&lt;</mo><mn>4</mn></mrow><annotation encoding=\"application/x-tex\">-4\\le x &lt; 4</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7804em;vertical-align:-0.136em;\"></span><span class=\"mord\">−</span><span class=\"mord\">4</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&lt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">4</span></span></span></span>","key":"gy4P8995r2"},{"type":"text","value":", let ","position":{"start":{"line":206,"column":1},"end":{"line":206,"column":1}},"key":"xQzPI8PHKd"},{"type":"inlineMath","value":"\\epsilon=0.04","position":{"start":{"line":206,"column":1},"end":{"line":206,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ϵ</mi><mo>=</mo><mn>0.04</mn></mrow><annotation encoding=\"application/x-tex\">\\epsilon=0.04</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">ϵ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0.04</span></span></span></span>","key":"MIhWObVL1l"},{"type":"text","value":", and suppose ","position":{"start":{"line":206,"column":1},"end":{"line":206,"column":1}},"key":"ivOYpyg0Jw"},{"type":"inlineMath","value":"u(x,0)=e^{-2x^2}","position":{"start":{"line":206,"column":1},"end":{"line":206,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo separator=\"true\">,</mo><mn>0</mn><mo stretchy=\"false\">)</mo><mo>=</mo><msup><mi>e</mi><mrow><mo>−</mo><mn>2</mn><msup><mi>x</mi><mn>2</mn></msup></mrow></msup></mrow><annotation encoding=\"application/x-tex\">u(x,0)=e^{-2x^2}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">0</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.9869em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9869em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">2</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913em;\"><span style=\"top:-2.931em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>","key":"sVepmhBD0t"},{"type":"text","value":". Solve the problem numerically with ","position":{"start":{"line":206,"column":1},"end":{"line":206,"column":1}},"key":"yWpv2HruUy"},{"type":"inlineMath","value":"m=200","position":{"start":{"line":206,"column":1},"end":{"line":206,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi><mo>=</mo><mn>200</mn></mrow><annotation encoding=\"application/x-tex\">m=200</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">200</span></span></span></span>","key":"dtNZUTLusI"},{"type":"text","value":", plotting the solution on one graph at times ","position":{"start":{"line":206,"column":1},"end":{"line":206,"column":1}},"key":"EMW6XcfUSJ"},{"type":"inlineMath","value":"t=0,0.5,1,\\ldots,3","position":{"start":{"line":206,"column":1},"end":{"line":206,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi><mo>=</mo><mn>0</mn><mo separator=\"true\">,</mo><mn>0.5</mn><mo separator=\"true\">,</mo><mn>1</mn><mo separator=\"true\">,</mo><mo>…</mo><mo separator=\"true\">,</mo><mn>3</mn></mrow><annotation encoding=\"application/x-tex\">t=0,0.5,1,\\ldots,3</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8389em;vertical-align:-0.1944em;\"></span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">0.5</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">3</span></span></span></span>","key":"odyOkjLY6k"},{"type":"text","value":". (You should see that the bump decays but also steepens as it moves to the right.)","position":{"start":{"line":206,"column":1},"end":{"line":206,"column":1}},"key":"CZVrTu5xht"}],"key":"uche8MuDXo"}],"key":"lZezVVpIPp"},{"type":"listItem","spread":true,"position":{"start":{"line":210,"column":1},"end":{"line":211,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"children":[{"type":"text","value":"⌨ The ","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"key":"ZoURSrLH3e"},{"type":"emphasis","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"children":[{"type":"text","value":"Kuramoto–Sivashinsky equation","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"key":"h569tFO0HD"}],"key":"UIOsTaIDhs"},{"type":"text","value":", ","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"key":"tvDwgR9PVl"},{"type":"inlineMath","value":"u_t+u u_x=-u_{xx}-\\epsilon u_{xxxx}","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>u</mi><mi>t</mi></msub><mo>+</mo><mi>u</mi><msub><mi>u</mi><mi>x</mi></msub><mo>=</mo><mo>−</mo><msub><mi>u</mi><mrow><mi>x</mi><mi>x</mi></mrow></msub><mo>−</mo><mi>ϵ</mi><msub><mi>u</mi><mrow><mi>x</mi><mi>x</mi><mi>x</mi><mi>x</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">u_t+u u_x=-u_{xx}-\\epsilon u_{xxxx}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7333em;vertical-align:-0.15em;\"></span><span class=\"mord\">−</span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">xx</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord mathnormal\">ϵ</span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">xxxx</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"yFNQwDgYfT"},{"type":"text","value":", exhibits solutions that are considered chaotic. Assume periodic end conditions, ","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"key":"MwbxFq1Rie"},{"type":"inlineMath","value":"\\epsilon=0.05","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ϵ</mi><mo>=</mo><mn>0.05</mn></mrow><annotation encoding=\"application/x-tex\">\\epsilon=0.05</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">ϵ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0.05</span></span></span></span>","key":"Mi729kPh3d"},{"type":"text","value":", and initial condition ","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"key":"YIwGnvA3LQ"},{"type":"inlineMath","value":"u(x,0)=1+e^{-2x^2}","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo separator=\"true\">,</mo><mn>0</mn><mo stretchy=\"false\">)</mo><mo>=</mo><mn>1</mn><mo>+</mo><msup><mi>e</mi><mrow><mo>−</mo><mn>2</mn><msup><mi>x</mi><mn>2</mn></msup></mrow></msup></mrow><annotation encoding=\"application/x-tex\">u(x,0)=1+e^{-2x^2}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">0</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.9869em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9869em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">2</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913em;\"><span style=\"top:-2.931em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>","key":"ZHwq0gNN9C"},{"type":"text","value":". Using the method of lines, solve the problem numerically with ","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"key":"ClR0u1rur9"},{"type":"inlineMath","value":"m=200","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi><mo>=</mo><mn>200</mn></mrow><annotation encoding=\"application/x-tex\">m=200</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">200</span></span></span></span>","key":"EBO3pVkvMR"},{"type":"text","value":" for ","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"key":"lj9POF9Jwy"},{"type":"inlineMath","value":"-4\\le x \\le 4","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>−</mo><mn>4</mn><mo>≤</mo><mi>x</mi><mo>≤</mo><mn>4</mn></mrow><annotation encoding=\"application/x-tex\">-4\\le x \\le 4</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7804em;vertical-align:-0.136em;\"></span><span class=\"mord\">−</span><span class=\"mord\">4</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7719em;vertical-align:-0.136em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">4</span></span></span></span>","key":"wg4vdKcDPo"},{"type":"text","value":" and ","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"key":"qL1AoZB753"},{"type":"inlineMath","value":"0\\le t \\le 20","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0</mn><mo>≤</mo><mi>t</mi><mo>≤</mo><mn>20</mn></mrow><annotation encoding=\"application/x-tex\">0\\le t \\le 20</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7804em;vertical-align:-0.136em;\"></span><span class=\"mord\">0</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7719em;vertical-align:-0.136em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">20</span></span></span></span>","key":"yuGuJfFWa3"},{"type":"text","value":". (You should discretize the fourth derivative as repeated second derivatives.) Make an animation of the plot (preferred), or plot the solution as a surface over ","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"key":"i3cpOxmjYz"},{"type":"inlineMath","value":"x","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"ypCvWSTtf2"},{"type":"text","value":" and ","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"key":"fMq77FzGQ2"},{"type":"inlineMath","value":"t","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span></span></span></span>","key":"Qy5xyORgur"},{"type":"text","value":".","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"key":"vvrKFEw99m"}],"key":"n06fc9OfHm"}],"key":"aUKV6gcDqH"},{"type":"listItem","spread":true,"position":{"start":{"line":212,"column":1},"end":{"line":220,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":212,"column":1},"end":{"line":212,"column":1}},"children":[{"type":"text","value":"⌨ (Adapted from ","position":{"start":{"line":212,"column":1},"end":{"line":212,"column":1}},"key":"H4sOpyPr1E"},{"type":"cite","kind":"narrative","label":"trefethenSpectralMethods2000","identifier":"trefethenspectralmethods2000","children":[{"type":"text","value":"Trefethen (2000)","key":"cBZhk0Wezp"}],"enumerator":"2","key":"ZBu4vEvpS8"},{"type":"text","value":".) Consider the problem ","position":{"start":{"line":212,"column":1},"end":{"line":212,"column":1}},"key":"RCOwltSDGH"},{"type":"inlineMath","value":"u_t + c(x) u_x =0","position":{"start":{"line":212,"column":1},"end":{"line":212,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>u</mi><mi>t</mi></msub><mo>+</mo><mi>c</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><msub><mi>u</mi><mi>x</mi></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">u_t + c(x) u_x =0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">c</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"HTeFlxtaPD"},{"type":"text","value":", for ","position":{"start":{"line":212,"column":1},"end":{"line":212,"column":1}},"key":"Ejt19mMQpo"},{"type":"inlineMath","value":"0 \\le x \\le 2\\pi","position":{"start":{"line":212,"column":1},"end":{"line":212,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0</mn><mo>≤</mo><mi>x</mi><mo>≤</mo><mn>2</mn><mi>π</mi></mrow><annotation encoding=\"application/x-tex\">0 \\le x \\le 2\\pi</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7804em;vertical-align:-0.136em;\"></span><span class=\"mord\">0</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7719em;vertical-align:-0.136em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span></span></span></span>","key":"FEr9WgEe5Z"},{"type":"text","value":", with periodic boundary conditions and variable speed ","position":{"start":{"line":212,"column":1},"end":{"line":212,"column":1}},"key":"cuuPjL8aDn"},{"type":"inlineMath","value":"c(x) = 0.2 + \\sin^2(x-1)","position":{"start":{"line":212,"column":1},"end":{"line":212,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>c</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mn>0.2</mn><mo>+</mo><msup><mrow><mi>sin</mi><mo>⁡</mo></mrow><mn>2</mn></msup><mo stretchy=\"false\">(</mo><mi>x</mi><mo>−</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">c(x) = 0.2 + \\sin^2(x-1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">c</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">0.2</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1219em;vertical-align:-0.25em;\"></span><span class=\"mop\"><span class=\"mop\">sin</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8719em;\"><span style=\"top:-3.1208em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span></span></span>","key":"Lignj5YPLO"},{"type":"text","value":". This problem has a solution that is ","position":{"start":{"line":212,"column":1},"end":{"line":212,"column":1}},"key":"AV2Md6nlye"},{"type":"inlineMath","value":"T","position":{"start":{"line":212,"column":1},"end":{"line":212,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>T</mi></mrow><annotation encoding=\"application/x-tex\">T</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span></span></span></span>","key":"V7RDRwqg30"},{"type":"text","value":"-periodic in time, for some ","position":{"start":{"line":212,"column":1},"end":{"line":212,"column":1}},"key":"jap6ypqhsC"},{"type":"inlineMath","value":"T\\approx 13","position":{"start":{"line":212,"column":1},"end":{"line":212,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>T</mi><mo>≈</mo><mn>13</mn></mrow><annotation encoding=\"application/x-tex\">T\\approx 13</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">13</span></span></span></span>","key":"DVKsjLbcEG"},{"type":"text","value":".","position":{"start":{"line":212,"column":1},"end":{"line":212,"column":1}},"key":"CcoT8AEFje"}],"key":"UcQvwLEzMD"},{"type":"paragraph","position":{"start":{"line":214,"column":1},"end":{"line":215,"column":1}},"children":[{"type":"strong","position":{"start":{"line":214,"column":1},"end":{"line":214,"column":1}},"children":[{"type":"text","value":"(a)","position":{"start":{"line":214,"column":1},"end":{"line":214,"column":1}},"key":"LRuCB5g3dG"}],"key":"qgmSoCGSbN"},{"type":"text","value":" Find this value ","position":{"start":{"line":214,"column":1},"end":{"line":214,"column":1}},"key":"dIBbZlJfBA"},{"type":"inlineMath","value":"T","position":{"start":{"line":214,"column":1},"end":{"line":214,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>T</mi></mrow><annotation encoding=\"application/x-tex\">T</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span></span></span></span>","key":"u7usqMObsE"},{"type":"text","value":" accurately to 10 digits by converting the integral ","position":{"start":{"line":214,"column":1},"end":{"line":214,"column":1}},"key":"gy20d0zi5W"},{"type":"inlineMath","value":"T\n = \\int_0^T \\,dt","position":{"start":{"line":214,"column":1},"end":{"line":214,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>T</mi><mo>=</mo><msubsup><mo>∫</mo><mn>0</mn><mi>T</mi></msubsup><mtext> </mtext><mi>d</mi><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">T\n = \\int_0^T \\,dt</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.3921em;vertical-align:-0.3558em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"margin-right:0.19445em;position:relative;top:-0.0006em;\">∫</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.0362em;\"><span style=\"top:-2.3442em;margin-left:-0.1945em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span><span style=\"top:-3.2579em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3558em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">t</span></span></span></span>","key":"LKo9bWV2IB"},{"type":"text","value":" to an integral in ","position":{"start":{"line":214,"column":1},"end":{"line":214,"column":1}},"key":"hDvntfP3Bo"},{"type":"inlineMath","value":"x","position":{"start":{"line":214,"column":1},"end":{"line":214,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"sUtovvj6qw"},{"type":"text","value":" via ","position":{"start":{"line":214,"column":1},"end":{"line":214,"column":1}},"key":"KLdpB9hFE6"},{"type":"inlineMath","value":"\\frac{dx}{dt}=c(x)","position":{"start":{"line":214,"column":1},"end":{"line":214,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mfrac><mrow><mi>d</mi><mi>x</mi></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac><mo>=</mo><mi>c</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\frac{dx}{dt}=c(x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.2251em;vertical-align:-0.345em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8801em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">d</span><span class=\"mord mathnormal mtight\">t</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">d</span><span class=\"mord mathnormal mtight\">x</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">c</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span>","key":"XXvAIpaIRX"},{"type":"text","value":", then applying numerical integration.","position":{"start":{"line":214,"column":1},"end":{"line":214,"column":1}},"key":"kZlaRO4M3C"}],"key":"SRpkhDU9YU"},{"type":"paragraph","position":{"start":{"line":217,"column":1},"end":{"line":217,"column":1}},"children":[{"type":"strong","position":{"start":{"line":217,"column":1},"end":{"line":217,"column":1}},"children":[{"type":"text","value":"(b)","position":{"start":{"line":217,"column":1},"end":{"line":217,"column":1}},"key":"AsCHIroWFv"}],"key":"J2Kzh9Fjw2"},{"type":"text","value":" Using ","position":{"start":{"line":217,"column":1},"end":{"line":217,"column":1}},"key":"ByiyeC02RN"},{"type":"inlineMath","value":"u(x,0) =e^{\\sin x}","position":{"start":{"line":217,"column":1},"end":{"line":217,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo separator=\"true\">,</mo><mn>0</mn><mo stretchy=\"false\">)</mo><mo>=</mo><msup><mi>e</mi><mrow><mi>sin</mi><mo>⁡</mo><mi>x</mi></mrow></msup></mrow><annotation encoding=\"application/x-tex\">u(x,0) =e^{\\sin x}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">0</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8305em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8305em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mop mtight\"><span class=\"mtight\">s</span><span class=\"mtight\">i</span><span class=\"mtight\">n</span></span><span class=\"mspace mtight\" style=\"margin-right:0.1952em;\"></span><span class=\"mord mathnormal mtight\">x</span></span></span></span></span></span></span></span></span></span></span></span>","key":"rGjkP3ZlHa"},{"type":"text","value":", solve the ","key":"rogMIq58VJ"},{"type":"abbreviation","title":"partial differential equation","children":[{"type":"text","value":"PDE","key":"UUs6voksYt"}],"key":"aQsyZLhmyc"},{"type":"text","value":" numerically for ","key":"NR94gr9Lg7"},{"type":"inlineMath","value":"0\\le t \\le T","position":{"start":{"line":217,"column":1},"end":{"line":217,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0</mn><mo>≤</mo><mi>t</mi><mo>≤</mo><mi>T</mi></mrow><annotation encoding=\"application/x-tex\">0\\le t \\le T</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7804em;vertical-align:-0.136em;\"></span><span class=\"mord\">0</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7719em;vertical-align:-0.136em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span></span></span></span>","key":"PF5u9Tx448"},{"type":"text","value":" using the answer from part (a). Make an animation of the solution, or a surface plot of the solution as a function of ","position":{"start":{"line":217,"column":1},"end":{"line":217,"column":1}},"key":"ZD3UpGdRFo"},{"type":"inlineMath","value":"x","position":{"start":{"line":217,"column":1},"end":{"line":217,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"pogvOmC7hH"},{"type":"text","value":" and ","position":{"start":{"line":217,"column":1},"end":{"line":217,"column":1}},"key":"s3wjPf8QcW"},{"type":"inlineMath","value":"t","position":{"start":{"line":217,"column":1},"end":{"line":217,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span></span></span></span>","key":"oBZOh9go88"},{"type":"text","value":".","position":{"start":{"line":217,"column":1},"end":{"line":217,"column":1}},"key":"QegpwCLzfi"}],"key":"ogguHDYwZI"},{"type":"paragraph","position":{"start":{"line":219,"column":1},"end":{"line":219,"column":1}},"children":[{"type":"strong","position":{"start":{"line":219,"column":1},"end":{"line":219,"column":1}},"children":[{"type":"text","value":"(c)","position":{"start":{"line":219,"column":1},"end":{"line":219,"column":1}},"key":"zQpqVZ1Lwl"}],"key":"j7V0qPShwC"},{"type":"text","value":"  Adjust the accuracy in time and space until you can verify that ","position":{"start":{"line":219,"column":1},"end":{"line":219,"column":1}},"key":"Mx1ObEyrMn"},{"type":"inlineMath","value":"\\|u(x,T)-u(x,0)\\|_\\infty < 0.03","position":{"start":{"line":219,"column":1},"end":{"line":219,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">∥</mi><mi>u</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo separator=\"true\">,</mo><mi>T</mi><mo stretchy=\"false\">)</mo><mo>−</mo><mi>u</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo separator=\"true\">,</mo><mn>0</mn><mo stretchy=\"false\">)</mo><msub><mi mathvariant=\"normal\">∥</mi><mi mathvariant=\"normal\">∞</mi></msub><mo>&lt;</mo><mn>0.03</mn></mrow><annotation encoding=\"application/x-tex\">\\|u(x,T)-u(x,0)\\|_\\infty &lt; 0.03</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">∥</span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">0</span><span class=\"mclose\">)</span><span class=\"mord\"><span class=\"mord\">∥</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">∞</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&lt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0.03</span></span></span></span>","key":"zeEWPpYSl2"},{"type":"text","value":".","position":{"start":{"line":219,"column":1},"end":{"line":219,"column":1}},"key":"nCvqCYviRn"}],"key":"kWmx589SrH"}],"key":"tu0NbXvNvy"}],"key":"gitHJYajnd"}],"key":"TUqo5QnjuZ"}],"key":"SAvWo8vxRY"},"references":{"cite":{"order":["whithamLinearNonlinear1974","trefethenSpectralMethods2000"],"data":{"whithamLinearNonlinear1974":{"label":"whithamLinearNonlinear1974","enumerator":"1","html":"Whitham, G. B. (1974). <i>Linear and Nonlinear Waves</i>. John Wiley & Sons."},"trefethenSpectralMethods2000":{"label":"trefethenSpectralMethods2000","enumerator":"2","html":"Trefethen, L. N. (2000). <i>Spectral Methods in MATLAB</i>. SIAM."}}}},"footer":{"navigation":{"prev":{"title":"12. Advection equations","url":"/overview-11","group":"Preface"},"next":{"title":"Upwinding and stability","url":"/upwind","group":"Preface"}}},"domain":"http://localhost:3000"}