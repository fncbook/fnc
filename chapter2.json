{"version":2,"kind":"Notebook","sha256":"7192ea3c25b95dc86d91fa2f01b0cd70f857b770f4dab0f683b4c4e3f3f554fa","slug":"chapter2","location":"/julia/chapter2.md","dependencies":[],"frontmatter":{"title":"Chapter 2","numbering":{"heading_1":{"enabled":false},"heading_2":{"enabled":false},"heading_3":{"enabled":false},"heading_4":{"enabled":false},"heading_5":{"enabled":false},"heading_6":{"enabled":false},"title":{"offset":2}},"kernelspec":{"name":"julia-1.11","display_name":"Julia 1","language":"julia"},"content_includes_title":false,"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","TPBVP":"two-point boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"edit_url":"https://github.com/fncbook/fnc/blob/master/julia/chapter2.md","exports":[{"format":"md","filename":"chapter2.md","url":"/build/chapter2-33ef5e1f3617f297813a2c9e20ffd230.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"Functions","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"wpXkGM91vn"}],"identifier":"functions","label":"Functions","html_id":"functions","implicit":true,"key":"p8IdXLOP8L"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Forward substitution","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"o1yev6mq4f"}],"key":"z9h0hI4fr6"},{"type":"include","file":"FNCFunctions/src/chapter02.jl","literal":true,"filter":{"startAfter":"# begin forwardsub","endBefore":"# end forwardsub"},"children":[{"type":"code","value":"\"\"\"\n    forwardsub(L,b)\n\nSolve the lower-triangular linear system with matrix `L` and\nright-hand side vector `b`.\n\"\"\"\nfunction forwardsub(L, b)\n    n = size(L, 1)\n    x = zeros(n)\n    x[1] = b[1] / L[1, 1]\n    for i in 2:n\n        s = sum(L[i, j] * x[j] for j in 1:i-1)\n        x[i] = (b[i] - s) / L[i, i]\n    end\n    return x\nend","lang":"julia","showLineNumbers":true,"filename":"forwardsub.jl","key":"uG1OM9jGuj"}],"key":"WQYAqXXCfn"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"About the code","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"xhlCiM3zzO"}],"key":"YSio2UydV4"},{"type":"paragraph","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"zd1LVETZms"},{"type":"inlineCode","value":"sum","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"HLHNnpJabe"},{"type":"text","value":" in line 12 gives an error if ","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"WYntK3fkBr"},{"type":"inlineCode","value":"i","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"CxFgFLVEIx"},{"type":"text","value":" equals 1, so that case is taken care of before the loop starts.","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"Jm0N43k6XA"}],"key":"aYp4XmHweV"}],"class":"dropdown","indexEntries":[{"entry":"Julia","subEntry":{"value":"sum","kind":"entry"},"emphasis":false}],"label":"index-IMYcdGbNEK","identifier":"index-imycdgbnek","html_id":"index-imycdgbnek","key":"t0xhChrk8K"}],"label":"function-forwardsub-julia","identifier":"function-forwardsub-julia","html_id":"function-forwardsub-julia","key":"xDaFM87YaP"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Backward substitution","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"mT4bPFTCYC"}],"key":"KUJMrHDfv5"},{"type":"include","file":"FNCFunctions/src/chapter02.jl","literal":true,"filter":{"startAfter":"# begin backsub","endBefore":"# end backsub"},"children":[{"type":"code","value":"\"\"\"\n    backsub(U,b)\n\nSolve the upper-triangular linear system with matrix `U` and\nright-hand side vector `b`.\n\"\"\"\nfunction backsub(U, b)\n    n = size(U, 1)\n    x = zeros(n)\n    x[n] = b[n] / U[n, n]\n    for i in n-1:-1:1\n        s = sum(U[i, j] * x[j] for j in i+1:n)\n        x[i] = (b[i] - s) / U[i, i]\n    end\n    return x\nend","lang":"julia","showLineNumbers":true,"filename":"backsub.jl","key":"cqBGdREldd"}],"key":"jCcSe8C5Zd"}],"label":"function-backsub-julia","identifier":"function-backsub-julia","html_id":"function-backsub-julia","key":"tOR52pHLYs"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"LU factorization (not stable)","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"key":"O8P0lZNKgT"}],"key":"HeAeatvP38"},{"type":"include","file":"FNCFunctions/src/chapter02.jl","literal":true,"filter":{"startAfter":"# begin lufact","endBefore":"# end lufact"},"children":[{"type":"code","value":"\"\"\"\n    lufact(A)\n\nCompute the LU factorization of square matrix `A`, returning the\nfactors.\n\"\"\"\nfunction lufact(A)\n    n = size(A, 1)        # detect the dimensions from the input\n    L = diagm(ones(n))   # ones on main diagonal, zeros elsewhere\n    U = zeros(n, n)\n    Aₖ = float(copy(A))  # make a working copy\n\n    # Reduction by outer products\n    for k in 1:n-1\n        U[k, :] = Aₖ[k, :]\n        L[:, k] = Aₖ[:, k] / U[k, k]\n        Aₖ -= L[:, k] * U[k, :]'\n    end\n    U[n, n] = Aₖ[n, n]\n    return LowerTriangular(L), UpperTriangular(U)\nend","lang":"julia","showLineNumbers":true,"filename":"lufact.jl","key":"iBdQIPKkqt"}],"key":"MJnM3Pgyqj"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"About the code","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"OsfBCk3OWo"}],"key":"VAU6tzgMZa"},{"type":"paragraph","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"children":[{"type":"text","value":"Line 11 of ","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"BU0FTrlIXb"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-lufact","label":"function-lufact","children":[{"type":"text","value":"Function ","key":"GQO2LKhI98"},{"type":"text","value":"2.4.1","key":"QYPykOFzJi"}],"template":"Algorithm %s","enumerator":"2.4.1","resolved":true,"html_id":"function-lufact","remote":true,"url":"/lu","dataUrl":"/lu.json","key":"pvO3jeDKDt"},{"type":"text","value":" points out two subtle Julia issues. First, vectors and matrix variables are really just references to blocks of memory. Such a reference is much more efficient to pass around than the complete contents of the array. However, it means that a statement ","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"nPYbfyGnTS"},{"type":"inlineCode","value":"Aₖ=A","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"Z9idWNMSCE"},{"type":"text","value":" just clones the array reference of ","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"iUCPSoms6W"},{"type":"inlineCode","value":"A","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"r5gOTZsp3D"},{"type":"text","value":" into the variable ","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"qOqRhO1VXL"},{"type":"inlineCode","value":"Aₖ","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"VB90UtdCJ9"},{"type":"text","value":". Any changes made to entries of ","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"oDKG8Rhi49"},{"type":"inlineCode","value":"Aₖ","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"o8s0XCssZM"},{"type":"text","value":" would then also be made to entries of ","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"fz4ibb0sh0"},{"type":"inlineCode","value":"A","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"QVr7vhZpHi"},{"type":"text","value":" because they refer to the same location in memory. In this context we don’t want to change the original matrix, so we use ","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"PVnIBtGvP8"},{"type":"inlineCode","value":"copy","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"zlppDkq3il"},{"type":"text","value":" here to create an independent copy of the array contents and a new reference to them.","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"zaKtjfYNNU"}],"key":"LJ58V7GGqh"},{"type":"paragraph","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"children":[{"type":"text","value":"The second issue is that even when ","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"fXYW2JoAhQ"},{"type":"inlineCode","value":"A","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"qmCdos4vB1"},{"type":"text","value":" has all integer entries, its LU factors may not. So we convert ","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"ws91SawUpx"},{"type":"inlineCode","value":"Aₖ","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"w8bboSD0Ma"},{"type":"text","value":" to floating point so that line 17 will not fail due to the creation of floating-point values in an integer matrix. An alternative would be to require the caller to provide a floating-point array in the first place.","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"UHq4G7UjRz"}],"key":"kBEfmTA6HE"}],"class":"dropdown","key":"CRUowLwSH2"}],"label":"function-lufact-julia","identifier":"function-lufact-julia","html_id":"function-lufact-julia","key":"T2bOIfpIoU"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"LU factorization with partial pivoting","position":{"start":{"line":66,"column":1},"end":{"line":66,"column":1}},"key":"QCroz96GeJ"}],"key":"znN1JpXWHG"},{"type":"include","file":"FNCFunctions/src/chapter02.jl","literal":true,"filter":{"startAfter":"# begin plufact","endBefore":"# end plufact"},"children":[{"type":"code","value":"\"\"\"\n    plufact(A)\n\nCompute the PLU factorization of square matrix `A`, returning the\ntriangular factors and a row permutation vector.\n\"\"\"\nfunction plufact(A)\n    n = size(A, 1)\n    L = zeros(n, n)\n    U = zeros(n, n)\n    p = fill(0, n)\n    Aₖ = float(copy(A))\n\n    # Reduction by outer products\n    for k in 1:n\n        p[k] = argmax(abs.(Aₖ[:, k]))    # best pivot in column k\n        U[k, :] = Aₖ[p[k], :]\n        L[:, k] = Aₖ[:, k] / U[k, k]\n        if k < n    # no update needed on last iteration\n            Aₖ -= L[:, k] * U[k, :]'\n        end\n    end\n    return LowerTriangular(L[p, :]), U, p\nend","lang":"julia","showLineNumbers":true,"filename":"plufact.jl","key":"l8J3haOepq"}],"key":"ldAvjtfkGT"},{"type":"code","lang":"","value":"","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"key":"QMYMbYaLqS"}],"label":"function-plufact-julia","identifier":"function-plufact-julia","html_id":"function-plufact-julia","key":"g0TBnQfGPb"},{"type":"heading","depth":2,"position":{"start":{"line":78,"column":1},"end":{"line":78,"column":1}},"children":[{"type":"text","value":"Examples","position":{"start":{"line":78,"column":1},"end":{"line":78,"column":1}},"key":"wZyP8hgLR5"}],"identifier":"examples","label":"Examples","html_id":"examples","implicit":true,"key":"AF2tOXPOf5"}],"key":"RL4S4MhzUS"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"include(\"FNC_init.jl\")","visibility":"show","key":"XbJCjWaf23"},{"type":"output","id":"eLO5vLazKkRz5nMoj2VzY","data":[{"output_type":"stream","name":"stderr","text":"\u001b[32m\u001b[1m  Activating\u001b[22m\u001b[39m "},{"output_type":"stream","name":"stderr","text":"project at `~/Documents/GitHub/fnc`\n"}],"visibility":"show","key":"TosBfPV0a8"}],"data":{"tags":[]},"visibility":"remove","key":"WGwrVFVtgM"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"children":[{"type":"text","value":"2.1 ","position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"key":"EIVjNwb2G2"},{"type":"link","identifier":"section-linsys-polyinterp","label":"section-linsys-polyinterp","kind":"narrative","position":{"start":{"line":85,"column":5},"end":{"line":85,"column":31}},"url":"/polyinterp","internal":true,"dataUrl":"/polyinterp.json","children":[{"type":"text","value":"Polynomial interpolation","key":"udIz5Xuj86"}],"key":"UBQa8faFj5"}],"identifier":"id-2-1","label":"2.1 ","html_id":"id-2-1","implicit":true,"key":"XD4EthzdaS"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-interp-vander","label":"demo-interp-vander","kind":"proof:example","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":20}},"children":[{"type":"text","value":"Example ","key":"zYcspiIe9z"},{"type":"text","value":"2.1.1","key":"h0ROMYUoWL"}],"template":"Example %s","enumerator":"2.1.1","resolved":true,"html_id":"demo-interp-vander","remote":true,"url":"/polyinterp","dataUrl":"/polyinterp.json","key":"b7gO4BT5bf"}],"key":"YPvqvJpcey"},{"type":"paragraph","position":{"start":{"line":90,"column":1},"end":{"line":90,"column":1}},"children":[{"type":"text","value":"We create two vectors for data about the population of China. The first has the years of census data and the other has the population, in millions of people.","position":{"start":{"line":90,"column":1},"end":{"line":90,"column":1}},"key":"eQaL990k4w"}],"key":"mXrrSOc29c"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"year = [1982, 2000, 2010, 2015]; \npop = [1008.18, 1262.64, 1337.82, 1374.62];","key":"NeS9SI42U5"},{"type":"output","id":"tCyqrs1JsTAXnmaJcGns6","data":[],"key":"sBIMk97elG"}],"key":"YJFoE2NUvl"},{"type":"paragraph","position":{"start":{"line":103,"column":1},"end":{"line":103,"column":1}},"children":[{"type":"text","value":"It’s convenient to measure time in years since 1980. We use ","position":{"start":{"line":103,"column":1},"end":{"line":103,"column":1}},"key":"MchW8GIb3X"},{"type":"inlineCode","value":".-","position":{"start":{"line":103,"column":1},"end":{"line":103,"column":1}},"key":"hhFQEcK8k7"},{"type":"text","value":" to subtract a scalar from every element of a vector. We will also use a floating-point value in the subtraction, so the result is also in double precision.","position":{"start":{"line":103,"column":1},"end":{"line":103,"column":1}},"key":"U9tJD6VVsx"}],"indexEntries":[{"entry":"Julia","subEntry":{"value":"broadcasting","kind":"entry"},"emphasis":false},{"entry":"Julia","subEntry":{"value":".-","kind":"entry"},"emphasis":true},{"entry":"Julia","subEntry":{"value":".+","kind":"entry"},"emphasis":true}],"label":"index-vO206iswrl","identifier":"index-vo206iswrl","html_id":"index-vo206iswrl","key":"i2gXVgip1K"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"NUcAgtuD9b"}],"key":"YcswUDHMCe"},{"type":"paragraph","position":{"start":{"line":106,"column":1},"end":{"line":106,"column":1}},"children":[{"type":"text","value":"A dotted operator such as ","position":{"start":{"line":106,"column":1},"end":{"line":106,"column":1}},"key":"IcNrwqn3UQ"},{"type":"inlineCode","value":".-","position":{"start":{"line":106,"column":1},"end":{"line":106,"column":1}},"key":"ftubbEELsP"},{"type":"text","value":" or ","position":{"start":{"line":106,"column":1},"end":{"line":106,"column":1}},"key":"NYtS5qmU05"},{"type":"inlineCode","value":".*","position":{"start":{"line":106,"column":1},"end":{"line":106,"column":1}},"key":"eUbIN3va5P"},{"type":"text","value":" acts elementwise, broadcasting scalar values to match up with elements of an array.","position":{"start":{"line":106,"column":1},"end":{"line":106,"column":1}},"key":"tBMNeLYcI2"}],"key":"aHH6GSr7o8"}],"class":"dropdown","key":"U04Kw12YwU"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"t = year .- 1980.0\ny = pop;","key":"yJDVXL0Pvm"},{"type":"output","id":"lUSN49pJ2haa8s0QxSjmk","data":[],"key":"xulhEWbUNQ"}],"key":"IEBNvn0jvr"},{"type":"paragraph","position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"children":[{"type":"text","value":"Now we have four data points ","position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"key":"Cu1Whr5Wl5"},{"type":"inlineMath","value":"(t_1,y_1),\\dots,(t_4,y_4)","position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><msub><mi>t</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><msub><mi>y</mi><mn>1</mn></msub><mo stretchy=\"false\">)</mo><mo separator=\"true\">,</mo><mo>…</mo><mo separator=\"true\">,</mo><mo stretchy=\"false\">(</mo><msub><mi>t</mi><mn>4</mn></msub><mo separator=\"true\">,</mo><msub><mi>y</mi><mn>4</mn></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(t_1,y_1),\\dots,(t_4,y_4)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">4</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">4</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"zhFT6D01Xk"},{"type":"text","value":", so ","position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"key":"PO9bD8CBhN"},{"type":"inlineMath","value":"n=4","position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>=</mo><mn>4</mn></mrow><annotation encoding=\"application/x-tex\">n=4</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">4</span></span></span></span>","key":"a4c6PLyY6Y"},{"type":"text","value":" and we seek an interpolating cubic polynomial. We construct the associated Vandermonde matrix:","position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"key":"oVeNOHXd4T"}],"indexEntries":[{"entry":"Julia","subEntry":{"value":"comprehension","kind":"entry"},"emphasis":true}],"label":"index-sZRptSWxCl","identifier":"index-szrptswxcl","html_id":"index-szrptswxcl","key":"vhvd3pGuVE"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"ceEHt0tUGo"}],"key":"C9COS17ylY"},{"type":"paragraph","position":{"start":{"line":121,"column":1},"end":{"line":121,"column":1}},"children":[{"type":"text","value":"An expression inside square brackets and ending with a ","position":{"start":{"line":121,"column":1},"end":{"line":121,"column":1}},"key":"RaBevKEsrO"},{"type":"inlineCode","value":"for","position":{"start":{"line":121,"column":1},"end":{"line":121,"column":1}},"key":"IVVhSxUZ6u"},{"type":"text","value":" statement is called a ","position":{"start":{"line":121,"column":1},"end":{"line":121,"column":1}},"key":"z8WB6xblQO"},{"type":"strong","position":{"start":{"line":121,"column":1},"end":{"line":121,"column":1}},"children":[{"type":"text","value":"comprehension","position":{"start":{"line":121,"column":1},"end":{"line":121,"column":1}},"key":"S4wYOYSPIx"}],"key":"RV6HRvQJrF"},{"type":"text","value":". It’s often an easy and readable way to construct vectors and matrices.","position":{"start":{"line":121,"column":1},"end":{"line":121,"column":1}},"key":"swbsuivKCg"}],"key":"Hpy1oeSlhK"}],"class":"dropdown","key":"lxv7DsJ3RV"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"V = [ t[i]^j for i in 1:4, j in 0:3 ]","key":"j9Qr6XX3Oh"},{"type":"output","id":"SAltncjjSCNYpzZIrnZ88","data":[{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n 1.0   2.0     4.0      8.0\n 1.0  20.0   400.0   8000.0\n 1.0  30.0   900.0  27000.0\n 1.0  35.0  1225.0  42875.0","content_type":"text/plain"}}}],"key":"P2Bz0xn7e5"}],"key":"fMvRZcKV7b"},{"type":"paragraph","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"children":[{"type":"text","value":"To solve for the vector of polynomial coefficients, we use a backslash to solve the linear system:","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"key":"q5MOwGAvQx"}],"indexEntries":[{"entry":"Julia","subEntry":{"value":"\\\\","kind":"entry"},"emphasis":false}],"label":"index-RQpdoY7py7","identifier":"index-rqpdoy7py7","html_id":"index-rqpdoy7py7","key":"UegYx0TBkW"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"g1FS5RLX9d"}],"key":"LaX4zpkvS0"},{"type":"paragraph","position":{"start":{"line":134,"column":1},"end":{"line":134,"column":1}},"children":[{"type":"text","value":"A ","position":{"start":{"line":134,"column":1},"end":{"line":134,"column":1}},"key":"lysnXqaBB0"},{"type":"strong","position":{"start":{"line":134,"column":1},"end":{"line":134,"column":1}},"children":[{"type":"text","value":"backslash","position":{"start":{"line":134,"column":1},"end":{"line":134,"column":1}},"key":"GeD4jcR3Nq"}],"key":"hBvERVv6Lt"},{"type":"text","value":" ","position":{"start":{"line":134,"column":1},"end":{"line":134,"column":1}},"key":"La3tl4N3hq"},{"type":"inlineCode","value":"\\","position":{"start":{"line":134,"column":1},"end":{"line":134,"column":1}},"key":"vpJNXGWcg3"},{"type":"text","value":" is used to solve a linear system of equations.","position":{"start":{"line":134,"column":1},"end":{"line":134,"column":1}},"key":"z57QVsjFKg"}],"key":"zVucA4u0Ci"}],"class":"dropdown","key":"v6hlMDvIMH"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"c = V \\ y","key":"evvkUFPtHF"},{"type":"output","id":"bLuY7ermPjgDaN3iyetkO","data":[{"output_type":"execute_result","execution_count":5,"metadata":{},"data":{"text/plain":{"content":"4-element Vector{Float64}:\n 962.2387878787875\n  24.127754689754774\n  -0.5922620490620537\n   0.00684386724386731","content_type":"text/plain"}}}],"key":"qfhEfoCH3T"}],"key":"bMtyp5z0Yr"},{"type":"paragraph","position":{"start":{"line":141,"column":1},"end":{"line":141,"column":1}},"children":[{"type":"text","value":"The algorithms used by the backslash operator are the main topic of this chapter. As a check on the solution, we can compute the ","position":{"start":{"line":141,"column":1},"end":{"line":141,"column":1}},"key":"DfyAvR8Gc0"},{"type":"emphasis","position":{"start":{"line":141,"column":1},"end":{"line":141,"column":1}},"children":[{"type":"text","value":"residual","position":{"start":{"line":141,"column":1},"end":{"line":141,"column":1}},"key":"VRdIE9mgnQ"}],"key":"baK1O6sUh8"},{"type":"text","value":".","position":{"start":{"line":141,"column":1},"end":{"line":141,"column":1}},"key":"rD4vVWVD1r"}],"key":"i5uqWEgjzv"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"y - V * c","key":"p7YI2eCR87"},{"type":"output","id":"tUtkS9pIiuIKM09jhJPe1","data":[{"output_type":"execute_result","execution_count":6,"metadata":{},"data":{"text/plain":{"content":"4-element Vector{Float64}:\n 0.0\n 0.0\n 2.2737367544323206e-13\n 0.0","content_type":"text/plain"}}}],"key":"Bosp58czWK"}],"key":"ebV5trnKbB"},{"type":"paragraph","position":{"start":{"line":147,"column":1},"end":{"line":147,"column":1}},"children":[{"type":"text","value":"Using floating-point arithmetic, it is not realistic to expect exact equality of quantities; a relative difference comparable to ","position":{"start":{"line":147,"column":1},"end":{"line":147,"column":1}},"key":"Le86t7139L"},{"type":"inlineMath","value":"\\macheps","position":{"start":{"line":147,"column":1},"end":{"line":147,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>ϵ</mi><mtext>mach</mtext></msub></mrow><annotation encoding=\"application/x-tex\">\\macheps</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">ϵ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">mach</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"wuGyiP89Id"},{"type":"text","value":" is all we can look for.","position":{"start":{"line":147,"column":1},"end":{"line":147,"column":1}},"key":"IQM4ss63GR"}],"key":"LnSZ6tKGxZ"},{"type":"paragraph","position":{"start":{"line":149,"column":1},"end":{"line":149,"column":1}},"children":[{"type":"text","value":"By our definitions, the elements of ","position":{"start":{"line":149,"column":1},"end":{"line":149,"column":1}},"key":"PbAB0RQEYV"},{"type":"inlineCode","value":"c","position":{"start":{"line":149,"column":1},"end":{"line":149,"column":1}},"key":"JhkZ06GkzU"},{"type":"text","value":" are coefficients in ascending-degree order for the interpolating polynomial. We can use the polynomial to estimate the population of China in 2005:","position":{"start":{"line":149,"column":1},"end":{"line":149,"column":1}},"key":"b992FS9igI"}],"key":"kqXBtaPl6X"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"DN2stXyfJ8"}],"key":"Jin7JcJcU3"},{"type":"paragraph","position":{"start":{"line":152,"column":1},"end":{"line":152,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":152,"column":1},"end":{"line":152,"column":1}},"key":"cSrjlYJjTf"},{"type":"inlineCode","value":"Polynomials","position":{"start":{"line":152,"column":1},"end":{"line":152,"column":1}},"key":"vnJQRtsgvG"},{"type":"text","value":" package has functions to make working with polynomials easy and efficient.","position":{"start":{"line":152,"column":1},"end":{"line":152,"column":1}},"key":"Vbub1X7j3l"}],"key":"gWiBSMOyBI"}],"class":"dropdown","key":"M9wp4QtqBO"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"using Polynomials\np = Polynomial(c)    # construct a polynomial\np(2005-1980)         # include the 1980 time shift","key":"iZk2blCeCz"},{"type":"output","id":"nfUsyjyyG_AY8RuiCE4de","data":[{"output_type":"execute_result","execution_count":7,"metadata":{},"data":{"text/plain":{"content":"1302.2043001443","content_type":"text/plain"}}}],"key":"MXSmMW4bMj"}],"key":"RnvmJ1YKTW"},{"type":"paragraph","position":{"start":{"line":161,"column":1},"end":{"line":161,"column":1}},"children":[{"type":"text","value":"The official population value for 2005 was 1303.72, so our result is rather good.","position":{"start":{"line":161,"column":1},"end":{"line":161,"column":1}},"key":"samGCm3Fdy"}],"key":"ZFaosbPNnu"},{"type":"paragraph","position":{"start":{"line":166,"column":1},"end":{"line":166,"column":1}},"children":[{"type":"text","value":"We can visualize the interpolation process. First, we plot the data as points.","position":{"start":{"line":166,"column":1},"end":{"line":166,"column":1}},"key":"wJYNtJDHce"}],"indexEntries":[{"entry":"Julia","subEntry":{"value":"scatter","kind":"entry"},"emphasis":true}],"label":"index-DbwUYrJjL0","identifier":"index-dbwuyrjjl0","html_id":"index-dbwuyrjjl0","key":"DmgrWSTZNP"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"dVkrMlT9Hd"}],"key":"yvydOPWwwJ"},{"type":"paragraph","position":{"start":{"line":170,"column":1},"end":{"line":170,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":170,"column":1},"end":{"line":170,"column":1}},"key":"fLo75kQQ1W"},{"type":"inlineCode","value":"scatter","position":{"start":{"line":170,"column":1},"end":{"line":170,"column":1}},"key":"BS0dvrhz7u"},{"type":"text","value":" function creates a scatter plot of points; you can specify a line connecting the points as well.","position":{"start":{"line":170,"column":1},"end":{"line":170,"column":1}},"key":"R71QOIArfX"}],"key":"pyYDxPB4LY"}],"class":"dropdown","key":"p0wLbg97qV"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"using Plots\nscatter(t, y;\n    label=\"actual\",  legend=:topleft,\n    xlabel=\"years since 1980\",  ylabel=\"population (millions)\", \n    title=\"Population of China\")","key":"YxJwoTvIaw"},{"type":"output","id":"znmd_KQ1ghtDMshwWjOLY","data":[{"output_type":"execute_result","execution_count":8,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"d495b0bb6644569fcd6b65070d52332b","path":"/build/d495b0bb6644569fcd6b65070d52332b.png"},"text/html":{"content_type":"text/html","hash":"59e39b74b1a886e92bca3c2e75d6bc95","path":"/build/59e39b74b1a886e92bca3c2e75d6bc95.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"0fee221d5da7affae670ea9b1f92c1f8","path":"/build/0fee221d5da7affae670ea9b1f92c1f8.svg"}}}],"key":"eeUdpDJurT"}],"key":"CCF1b0Mg5q"},{"type":"grid","columns":[1,1,2,2],"children":[{"type":"paragraph","position":{"start":{"line":188,"column":1},"end":{"line":188,"column":1}},"children":[{"type":"text","value":"We want to superimpose a plot of the polynomial. We do that by evaluating it at a vector of points in the interval. The dot after the name of the polynomial is a universal way to apply a function to every element of an array, a technique known as ","position":{"start":{"line":188,"column":1},"end":{"line":188,"column":1}},"key":"r569CdqerB"},{"type":"strong","position":{"start":{"line":188,"column":1},"end":{"line":188,"column":1}},"children":[{"type":"text","value":"broadcasting","position":{"start":{"line":188,"column":1},"end":{"line":188,"column":1}},"key":"zu5NH4xka4"}],"key":"YfoXt0M85E"},{"type":"text","value":".","position":{"start":{"line":188,"column":1},"end":{"line":188,"column":1}},"key":"ARy9q5WWGr"}],"key":"UfxyWRZVJx"},{"type":"card","children":[{"type":"paragraph","position":{"start":{"line":190,"column":1},"end":{"line":190,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":190,"column":1},"end":{"line":190,"column":1}},"key":"KcgYGSCpw9"},{"type":"inlineCode","value":"range","position":{"start":{"line":190,"column":1},"end":{"line":190,"column":1}},"key":"jVRmZmovSj"},{"type":"text","value":" function constructs evenly spaced values given the endpoints and either the number of values, or the step size between them.","position":{"start":{"line":190,"column":1},"end":{"line":190,"column":1}},"key":"tilRIpMaiP"}],"key":"t4JnmVe9RZ"},{"type":"paragraph","position":{"start":{"line":192,"column":1},"end":{"line":192,"column":1}},"children":[{"type":"text","value":"Adding a dot to the end of a function name causes it to be broadcast, i.e., applied to every element of a vector or matrix.","position":{"start":{"line":192,"column":1},"end":{"line":192,"column":1}},"key":"hrMIl8jFwJ"}],"key":"DiZKhtOSWl"}],"key":"LSyCw5glv7"}],"indexEntries":[{"entry":"Julia","subEntry":{"value":"broadcasting","kind":"entry"},"emphasis":true},{"entry":"Julia","subEntry":{"value":"range","kind":"entry"},"emphasis":false}],"label":"index-f9KDbTgPCm","identifier":"index-f9kdbtgpcm","html_id":"index-f9kdbtgpcm","key":"bLRGmsFKey"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"# Choose 500 times in the interval [0,35].\ntt = range(0, 35, 500)\n\n# Evaluate the polynomial at all the vector components.\nyy = p.(tt)\n\nforeach(println, yy[1:4])","key":"eZ2AAeOBEd"},{"type":"output","id":"zL8qruK1kHyp46gj5FX4T","data":[{"output_type":"stream","name":"stdout","text":"962.2387878787875\n963.9282039963299\n965.6118068288089\n967.2896105457506\n"}],"key":"mY6gh7hjgU"}],"key":"ZdYvDtmwKE"},{"type":"paragraph","position":{"start":{"line":209,"column":1},"end":{"line":209,"column":1}},"children":[{"type":"text","value":"Now we use ","position":{"start":{"line":209,"column":1},"end":{"line":209,"column":1}},"key":"Wm5KjCQiME"},{"type":"inlineCode","value":"plot!","position":{"start":{"line":209,"column":1},"end":{"line":209,"column":1}},"key":"zPlj3WnjTT"},{"type":"text","value":" to add to the current plot, rather than replacing it.","position":{"start":{"line":209,"column":1},"end":{"line":209,"column":1}},"key":"lLDQxRr3B8"}],"indexEntries":[{"entry":"Julia","subEntry":{"value":"\\!","kind":"entry"},"emphasis":true}],"label":"index-oNllLJh4eY","identifier":"index-onllljh4ey","html_id":"index-onllljh4ey","key":"Mhvt8TrdmK"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"PQPCjLnxIW"}],"key":"CIUUiAH1Yc"},{"type":"paragraph","position":{"start":{"line":212,"column":1},"end":{"line":213,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":212,"column":1},"end":{"line":212,"column":1}},"key":"OTzvAYd4ZH"},{"type":"inlineCode","value":"plot","position":{"start":{"line":212,"column":1},"end":{"line":212,"column":1}},"key":"IcuDo5RxHY"},{"type":"text","value":" function plots lines connecting the given ","position":{"start":{"line":212,"column":1},"end":{"line":212,"column":1}},"key":"Io50NxdCTB"},{"type":"inlineMath","value":"x","position":{"start":{"line":212,"column":1},"end":{"line":212,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"ubJWXhqIGm"},{"type":"text","value":" and ","position":{"start":{"line":212,"column":1},"end":{"line":212,"column":1}},"key":"ICcZBJuJZ7"},{"type":"inlineMath","value":"y","position":{"start":{"line":212,"column":1},"end":{"line":212,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>","key":"CxqP1ElFd1"},{"type":"text","value":" values; you can also specify markers at the points.\nBy convention, functions whose names end with the bang ","position":{"start":{"line":212,"column":1},"end":{"line":212,"column":1}},"key":"iQu6eg3FJa"},{"type":"inlineCode","value":"!","position":{"start":{"line":212,"column":1},"end":{"line":212,"column":1}},"key":"bIKKNa33xV"},{"type":"text","value":" change the value or state of something, in addition to possibly returning output.","position":{"start":{"line":212,"column":1},"end":{"line":212,"column":1}},"key":"rJzloDXFAx"}],"key":"qtJ861140X"}],"class":"dropdown","key":"jSzsIQGZYi"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"plot!(tt, yy, label=\"interpolant\")","key":"kl0ntYjsnO"},{"type":"output","id":"2m1UynCZ2ifOkDjdUlvJp","data":[{"output_type":"execute_result","execution_count":10,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"b4dc50521b4946a34ff28779a35cb609","path":"/build/b4dc50521b4946a34ff28779a35cb609.png"},"text/html":{"content_type":"text/html","hash":"ac2ca402590f6be2b4d1aa209c2a3cf4","path":"/build/ac2ca402590f6be2b4d1aa209c2a3cf4.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"d74d6861b93f0d3b7f9654ced477f4f9","path":"/build/d74d6861b93f0d3b7f9654ced477f4f9.svg"}}}],"key":"T0D8ijZhXB"}],"key":"s3vvHoUcQD"}],"label":"demo-interp-vander-julia","identifier":"demo-interp-vander-julia","html_id":"demo-interp-vander-julia","key":"k0JFsamLJr"},{"type":"heading","depth":3,"position":{"start":{"line":221,"column":1},"end":{"line":221,"column":1}},"children":[{"type":"text","value":"2.2 ","position":{"start":{"line":221,"column":1},"end":{"line":221,"column":1}},"key":"vq7DBJiOMq"},{"type":"link","identifier":"section-linsys-matrices","label":"section-linsys-matrices","kind":"narrative","position":{"start":{"line":221,"column":5},"end":{"line":221,"column":29}},"url":"/matrices","internal":true,"dataUrl":"/matrices.json","children":[{"type":"text","value":"Computing with matrices","key":"Kr4yD868di"}],"key":"hDL2Dqe5Yw"}],"identifier":"id-2-2","label":"2.2 ","html_id":"id-2-2","implicit":true,"key":"UJnDR7pu30"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-matrices","label":"demo-matrices","kind":"proof:example","position":{"start":{"line":223,"column":1},"end":{"line":223,"column":15}},"children":[{"type":"text","value":"Example ","key":"gHAke7mYz7"},{"type":"text","value":"2.2.1","key":"XtR68PWtuH"}],"template":"Example %s","enumerator":"2.2.1","resolved":true,"html_id":"demo-matrices","remote":true,"url":"/matrices","dataUrl":"/matrices.json","key":"dNYBta0BxU"}],"key":"FIKJeCxxn9"},{"type":"paragraph","position":{"start":{"line":228,"column":1},"end":{"line":228,"column":1}},"children":[{"type":"text","value":"In Julia, vectors and matrices are one-dimensional and two-dimensional arrays, respectively. Square brackets are used to enclose elements of a matrix or vector. Use spaces for horizontal concatenation, and semicolons or new lines to indicate vertical concatenation.","position":{"start":{"line":228,"column":1},"end":{"line":228,"column":1}},"key":"tJWNTmvWf4"}],"indexEntries":[{"entry":"Julia","subEntry":{"value":"size","kind":"entry"},"emphasis":true},{"entry":"Julia","subEntry":{"value":"length","kind":"entry"},"emphasis":true}],"label":"index-Mty7tL6Wa2","identifier":"index-mty7tl6wa2","html_id":"index-mty7tl6wa2","key":"Y2misBprA1"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"as2g4i8jW6"}],"key":"f8UWklVIxm"},{"type":"paragraph","position":{"start":{"line":231,"column":1},"end":{"line":231,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":231,"column":1},"end":{"line":231,"column":1}},"key":"fOUooIOyU3"},{"type":"inlineCode","value":"size","position":{"start":{"line":231,"column":1},"end":{"line":231,"column":1}},"key":"d6cgV9PwS6"},{"type":"text","value":" function returns the number of rows and columns in a matrix. Use ","position":{"start":{"line":231,"column":1},"end":{"line":231,"column":1}},"key":"JVXksKIXhf"},{"type":"inlineCode","value":"length","position":{"start":{"line":231,"column":1},"end":{"line":231,"column":1}},"key":"IH95xhS2sb"},{"type":"text","value":" to get the number of elements in a vector or matrix.","position":{"start":{"line":231,"column":1},"end":{"line":231,"column":1}},"key":"gzxIpKaqzS"}],"key":"Lm3ySDPPf7"}],"class":"dropdown","key":"HlnbKEu21p"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"A = [ 1 2 3 4 5; 50 40 30 20 10\n    π sqrt(2) exp(1) (1+sqrt(5))/2 log(3) ]","key":"BWD901h2rk"},{"type":"output","id":"YCYS3QQhHVrzU-V-Ubx5G","data":[{"output_type":"execute_result","execution_count":11,"metadata":{},"data":{"text/plain":{"content":"3×5 Matrix{Float64}:\n  1.0       2.0       3.0       4.0       5.0\n 50.0      40.0      30.0      20.0      10.0\n  3.14159   1.41421   2.71828   1.61803   1.09861","content_type":"text/plain"}}}],"key":"ISp265oXoy"}],"key":"MI8gr6S67v"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"m, n = size(A)","key":"pNzNxyxTdH"},{"type":"output","id":"kmrZ6gTcnnw6e6ff46wZ1","data":[{"output_type":"execute_result","execution_count":12,"metadata":{},"data":{"text/plain":{"content":"(3, 5)","content_type":"text/plain"}}}],"key":"AO61N9Do4A"}],"key":"zKJ9qsPXC4"},{"type":"paragraph","position":{"start":{"line":242,"column":1},"end":{"line":242,"column":1}},"children":[{"type":"text","value":"A vector is not quite the same thing as a matrix: it has only one dimension, not two. Separate its elements by commas or semicolons:","position":{"start":{"line":242,"column":1},"end":{"line":242,"column":1}},"key":"obzssj6JdO"}],"key":"gXDU1baXKg"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"x = [ 3, 3, 0, 1, 0 ]\nsize(x)","key":"YrdwpISmAA"},{"type":"output","id":"SWLzMra9QWBZ7esBlKRGX","data":[{"output_type":"execute_result","execution_count":13,"metadata":{},"data":{"text/plain":{"content":"(5,)","content_type":"text/plain"}}}],"key":"a91S6bNXb0"}],"key":"gFoy9Qlpif"},{"type":"paragraph","position":{"start":{"line":249,"column":1},"end":{"line":249,"column":1}},"children":[{"type":"text","value":"For some purposes, however, an ","position":{"start":{"line":249,"column":1},"end":{"line":249,"column":1}},"key":"Kdz1IrVEKx"},{"type":"inlineMath","value":"n","position":{"start":{"line":249,"column":1},"end":{"line":249,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"t7oTPeNTcD"},{"type":"text","value":"-vector in Julia is treated like having a column shape. Note the difference if we use spaces instead of commas inside the brackets:","position":{"start":{"line":249,"column":1},"end":{"line":249,"column":1}},"key":"GR9efdl7Ph"}],"key":"F0UuOFnjJt"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"y = [ 3 3 0 1 0 ]\nsize(y)","key":"IatCn1c2cT"},{"type":"output","id":"yT5yylO7r2gsgMh2Tg6fF","data":[{"output_type":"execute_result","execution_count":14,"metadata":{},"data":{"text/plain":{"content":"(1, 5)","content_type":"text/plain"}}}],"key":"SaV4WSWJQS"}],"key":"DpEuLn63Ly"},{"type":"paragraph","position":{"start":{"line":256,"column":1},"end":{"line":256,"column":1}},"children":[{"type":"text","value":"This ","position":{"start":{"line":256,"column":1},"end":{"line":256,"column":1}},"key":"IRO2hw5FDG"},{"type":"inlineMath","value":"1\\times 5","position":{"start":{"line":256,"column":1},"end":{"line":256,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mo>×</mo><mn>5</mn></mrow><annotation encoding=\"application/x-tex\">1\\times 5</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">5</span></span></span></span>","key":"xYohlipp7a"},{"type":"text","value":" matrix is not equivalent to a vector.","position":{"start":{"line":256,"column":1},"end":{"line":256,"column":1}},"key":"M2yUfTy4TT"}],"key":"DaOFckwwui"},{"type":"paragraph","position":{"start":{"line":258,"column":1},"end":{"line":258,"column":1}},"children":[{"type":"text","value":"Concatenated elements within brackets may be matrices or vectors for a block representation, as long as all the block sizes are compatible.","position":{"start":{"line":258,"column":1},"end":{"line":258,"column":1}},"key":"bms2nzTxnx"}],"key":"hwoJvP1LhF"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"[ x  x ]","key":"yA9RUGPtQ4"},{"type":"output","id":"_uO-g6hwoAna36KJD8Xcb","data":[{"output_type":"execute_result","execution_count":15,"metadata":{},"data":{"text/plain":{"content":"5×2 Matrix{Int64}:\n 3  3\n 3  3\n 0  0\n 1  1\n 0  0","content_type":"text/plain"}}}],"key":"YpvgTJirI1"}],"key":"imEiULTaB4"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"[ x; x ]","key":"EBxoMrJOvo"},{"type":"output","id":"0qM5E29H3Wp_9FbAKSghw","data":[{"output_type":"execute_result","execution_count":16,"metadata":{},"data":{"text/plain":{"content":"10-element Vector{Int64}:\n 3\n 3\n 0\n 1\n 0\n 3\n 3\n 0\n 1\n 0","content_type":"text/plain"}}}],"key":"MT83MbbpXP"}],"key":"J8O27Jux5S"},{"type":"paragraph","position":{"start":{"line":268,"column":1},"end":{"line":268,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":268,"column":1},"end":{"line":268,"column":1}},"key":"B6NozFjia1"},{"type":"inlineCode","value":"zeros","position":{"start":{"line":268,"column":1},"end":{"line":268,"column":1}},"key":"dVz2pnlaLI"},{"type":"text","value":" and ","position":{"start":{"line":268,"column":1},"end":{"line":268,"column":1}},"key":"Xb10rYvOEK"},{"type":"inlineCode","value":"ones","position":{"start":{"line":268,"column":1},"end":{"line":268,"column":1}},"key":"M9SevgAyzI"},{"type":"text","value":" functions construct matrices with entries all zero or one, respectively.","position":{"start":{"line":268,"column":1},"end":{"line":268,"column":1}},"key":"mn1IWjcJbV"}],"key":"X5oJ8ly6cE"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"B = [ zeros(3, 2) ones(3, 1) ]","key":"nCEdK96xCN"},{"type":"output","id":"HKFVW-u3UmGxweTliOP-Q","data":[{"output_type":"execute_result","execution_count":17,"metadata":{},"data":{"text/plain":{"content":"3×3 Matrix{Float64}:\n 0.0  0.0  1.0\n 0.0  0.0  1.0\n 0.0  0.0  1.0","content_type":"text/plain"}}}],"key":"mTp8DAHTPG"}],"key":"b652RdTRcm"},{"type":"paragraph","position":{"start":{"line":277,"column":1},"end":{"line":277,"column":1}},"children":[{"type":"text","value":"A single quote ","position":{"start":{"line":277,"column":1},"end":{"line":277,"column":1}},"key":"eFvxD0KUe2"},{"type":"inlineCode","value":"'","position":{"start":{"line":277,"column":1},"end":{"line":277,"column":1}},"key":"oUuKDAUUFf"},{"type":"text","value":" after a matrix returns its adjoint. For real matrices, this is the transpose; for complex-valued matrices, the elements are also conjugated.","position":{"start":{"line":277,"column":1},"end":{"line":277,"column":1}},"key":"ALJZEQKSaW"}],"indexEntries":[{"entry":"Julia","subEntry":{"value":"transpose","kind":"entry"},"emphasis":true},{"entry":"Julia","subEntry":{"value":"adjoint","kind":"entry"},"emphasis":true},{"entry":"Julia","subEntry":{"value":"\\'","kind":"entry"},"emphasis":true}],"label":"index-Y4kPnekijj","identifier":"index-y4kpnekijj","html_id":"index-y4kpnekijj","key":"hyMcOymqCB"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"A'","key":"tXveLqN4Wo"},{"type":"output","id":"nQnBMvLPRT2T8Q2DUEmJE","data":[{"output_type":"execute_result","execution_count":18,"metadata":{},"data":{"text/plain":{"content":"5×3 adjoint(::Matrix{Float64}) with eltype Float64:\n 1.0  50.0  3.14159\n 2.0  40.0  1.41421\n 3.0  30.0  2.71828\n 4.0  20.0  1.61803\n 5.0  10.0  1.09861","content_type":"text/plain"}}}],"key":"DIuxHVUtRi"}],"key":"mkTZzeLjry"},{"type":"paragraph","position":{"start":{"line":283,"column":1},"end":{"line":283,"column":1}},"children":[{"type":"text","value":"If ","position":{"start":{"line":283,"column":1},"end":{"line":283,"column":1}},"key":"lcZKroDXAd"},{"type":"inlineCode","value":"x","position":{"start":{"line":283,"column":1},"end":{"line":283,"column":1}},"key":"iIlHbyucye"},{"type":"text","value":" is simply a vector, then its transpose has a row shape.","position":{"start":{"line":283,"column":1},"end":{"line":283,"column":1}},"key":"nzoetU8tKh"}],"key":"uQ2RgBvfqP"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"x'","key":"Y3gtafgFNP"},{"type":"output","id":"1k5V3xxwUPIjpyVq2CymU","data":[{"output_type":"execute_result","execution_count":19,"metadata":{},"data":{"text/plain":{"content":"1×5 adjoint(::Vector{Int64}) with eltype Int64:\n 3  3  0  1  0","content_type":"text/plain"}}}],"key":"C1B5U6Y9oa"}],"key":"xrNUiFMTlD"},{"type":"paragraph","position":{"start":{"line":292,"column":1},"end":{"line":292,"column":1}},"children":[{"type":"text","value":"There are many convenient shorthand ways of building vectors and matrices other than entering all of their entries directly or in a loop. To get a range with evenly spaced entries between two endpoints, you have two options. One is to use a colon ","position":{"start":{"line":292,"column":1},"end":{"line":292,"column":1}},"key":"hoVtgTFXUk"},{"type":"inlineCode","value":":","position":{"start":{"line":292,"column":1},"end":{"line":292,"column":1}},"key":"nWcw1ineAa"},{"type":"text","value":".","position":{"start":{"line":292,"column":1},"end":{"line":292,"column":1}},"key":"gUqQV6mTZh"}],"indexEntries":[{"entry":"Julia","subEntry":{"value":"range","kind":"entry"},"emphasis":true},{"entry":"Julia","subEntry":{"value":":","kind":"entry"},"emphasis":true}],"label":"index-peUWFtv5UT","identifier":"index-peuwftv5ut","html_id":"index-peuwftv5ut","key":"R6Z9XZZF8e"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"y = 1:4              # start:stop","key":"L0WRQp4I04"},{"type":"output","id":"ckTAb0PRyTPh2atW9ENMM","data":[{"output_type":"execute_result","execution_count":20,"metadata":{},"data":{"text/plain":{"content":"1:4","content_type":"text/plain"}}}],"key":"uUwvN1SSCI"}],"key":"OSBLGSwzVv"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"z = 0:3:12           # start:step:stop","key":"de9rKW9l9Q"},{"type":"output","id":"UM36c31HNCdSpjDC6TPpT","data":[{"output_type":"execute_result","execution_count":21,"metadata":{},"data":{"text/plain":{"content":"0:3:12","content_type":"text/plain"}}}],"key":"oduDvq00fF"}],"key":"AZJyqDXLyh"},{"type":"paragraph","position":{"start":{"line":302,"column":1},"end":{"line":302,"column":1}},"children":[{"type":"text","value":"(Ranges are not strictly considered vectors, but they behave identically in most circumstances.) Instead of specifying the step size, you can give the number of points in the range if you use ","position":{"start":{"line":302,"column":1},"end":{"line":302,"column":1}},"key":"w9ub99hZBO"},{"type":"inlineCode","value":"range","position":{"start":{"line":302,"column":1},"end":{"line":302,"column":1}},"key":"hCw6SMrswz"},{"type":"text","value":".","position":{"start":{"line":302,"column":1},"end":{"line":302,"column":1}},"key":"alW6f6I0hT"}],"key":"a2auqyDHqV"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"s = range(-1, 1, 5)","key":"NondGN5mTF"},{"type":"output","id":"DbX-8El58vT2ltcSDljdL","data":[{"output_type":"execute_result","execution_count":22,"metadata":{},"data":{"text/plain":{"content":"-1.0:0.5:1.0","content_type":"text/plain"}}}],"key":"tZaReAymZg"}],"key":"HaKVzxLkbE"},{"type":"paragraph","position":{"start":{"line":311,"column":1},"end":{"line":311,"column":1}},"children":[{"type":"text","value":"Accessing an element is done by giving one (for a vector) or two (for a matrix) index values within square brackets.","position":{"start":{"line":311,"column":1},"end":{"line":311,"column":1}},"key":"wk14doW6zk"}],"indexEntries":[{"entry":"Julia","subEntry":{"value":"end","kind":"entry"},"emphasis":true},{"entry":"Julia","subEntry":{"value":"indexing arrays","kind":"entry"},"emphasis":true}],"label":"index-lTgLIeM1Mp","identifier":"index-ltgliem1mp","html_id":"index-ltgliem1mp","key":"eopKmMetAI"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"vcfOLNAypZ"}],"key":"yIncVXoiF4"},{"type":"paragraph","position":{"start":{"line":315,"column":1},"end":{"line":315,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":315,"column":1},"end":{"line":315,"column":1}},"key":"ohAICvFOkm"},{"type":"inlineCode","value":"end","position":{"start":{"line":315,"column":1},"end":{"line":315,"column":1}},"key":"i8e1jOX3LS"},{"type":"text","value":" keyword refers to the last element in a dimension. It saves you from having to compute and store the size of the matrix first.","position":{"start":{"line":315,"column":1},"end":{"line":315,"column":1}},"key":"Dix6MzbFDm"}],"key":"XJV5qeR8Qc"}],"class":"dropdown","key":"FSqwbanEQr"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"a = A[2, end-1]","key":"FoOzqioXZ2"},{"type":"output","id":"lfTLpK5zlf93BPypsaZQ8","data":[{"output_type":"execute_result","execution_count":23,"metadata":{},"data":{"text/plain":{"content":"20.0","content_type":"text/plain"}}}],"key":"I4WhVpS3mf"}],"key":"CP434nxY4R"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"x[2]","key":"d29d9VYGkM"},{"type":"output","id":"ona_bI3aCUI71D75zF78F","data":[{"output_type":"execute_result","execution_count":24,"metadata":{},"data":{"text/plain":{"content":"3","content_type":"text/plain"}}}],"key":"tG89O5sbuf"}],"key":"vSDl0jiJzT"},{"type":"paragraph","position":{"start":{"line":326,"column":1},"end":{"line":326,"column":1}},"children":[{"type":"text","value":"The indices can be vectors or ranges, in which case a block of the matrix is accessed.","position":{"start":{"line":326,"column":1},"end":{"line":326,"column":1}},"key":"tc46VhmEPR"}],"key":"LNe8sqUSem"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"A[1:2, end-2:end]    # first two rows, last three columns","key":"p7DJ5Ni6pk"},{"type":"output","id":"58IUyVgVADXMjBzvh2NiA","data":[{"output_type":"execute_result","execution_count":25,"metadata":{},"data":{"text/plain":{"content":"2×3 Matrix{Float64}:\n  3.0   4.0   5.0\n 30.0  20.0  10.0","content_type":"text/plain"}}}],"key":"mP3dTG9GUT"}],"key":"Jra5I77BK4"},{"type":"paragraph","position":{"start":{"line":335,"column":1},"end":{"line":335,"column":1}},"children":[{"type":"text","value":"If a dimension has only the index ","position":{"start":{"line":335,"column":1},"end":{"line":335,"column":1}},"key":"GHlEqlyVjl"},{"type":"inlineCode","value":":","position":{"start":{"line":335,"column":1},"end":{"line":335,"column":1}},"key":"Bhjk6R8MKk"},{"type":"text","value":" (a colon), then it refers to all the entries in that dimension of the matrix.","position":{"start":{"line":335,"column":1},"end":{"line":335,"column":1}},"key":"FcS2Nk0aNU"}],"indexEntries":[{"entry":"Julia","subEntry":{"value":":","kind":"entry"},"emphasis":false}],"label":"index-yyyrqbZ7WM","identifier":"index-yyyrqbz7wm","html_id":"index-yyyrqbz7wm","key":"ae2oeU0ps5"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"A[:, 1:2:end]        # all of the odd columns","key":"l9SngWYrWb"},{"type":"output","id":"4bOQgoGVw1uYQ7D1kB36C","data":[{"output_type":"execute_result","execution_count":26,"metadata":{},"data":{"text/plain":{"content":"3×3 Matrix{Float64}:\n  1.0       3.0       5.0\n 50.0      30.0      10.0\n  3.14159   2.71828   1.09861","content_type":"text/plain"}}}],"key":"KO0AQ5IG1X"}],"key":"diwG7esljg"},{"type":"paragraph","position":{"start":{"line":344,"column":1},"end":{"line":344,"column":1}},"children":[{"type":"text","value":"The matrix and vector senses of addition, subtraction, scalar multiplication, multiplication, and power are all handled by the usual symbols.","position":{"start":{"line":344,"column":1},"end":{"line":344,"column":1}},"key":"mmSTWMlqfM"}],"indexEntries":[{"entry":"Julia","subEntry":{"value":"diagm","kind":"entry"},"emphasis":true}],"label":"index-X1PllEmEws","identifier":"index-x1pllemews","html_id":"index-x1pllemews","key":"z6r4btgp71"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"XWQRizBySd"}],"key":"iQfhby9y0o"},{"type":"paragraph","position":{"start":{"line":348,"column":1},"end":{"line":348,"column":1}},"children":[{"type":"text","value":"Use ","position":{"start":{"line":348,"column":1},"end":{"line":348,"column":1}},"key":"zeZWt1ehQm"},{"type":"inlineCode","value":"diagm","position":{"start":{"line":348,"column":1},"end":{"line":348,"column":1}},"key":"NcMzrYFvVK"},{"type":"text","value":" to construct a matrix by its diagonals. A more general syntax puts elements on super- or subdiagonals.","position":{"start":{"line":348,"column":1},"end":{"line":348,"column":1}},"key":"Rvu2q4UI0q"}],"key":"TC7dELBkP0"}],"class":"dropdown","key":"jpCRjGNMXm"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"B = diagm( [-1, 0, -5] )   # create a diagonal matrix","key":"POn6TcXCut"},{"type":"output","id":"0JBjPmORm2-_VY2aw6GA3","data":[{"output_type":"execute_result","execution_count":27,"metadata":{},"data":{"text/plain":{"content":"3×3 Matrix{Int64}:\n -1  0   0\n  0  0   0\n  0  0  -5","content_type":"text/plain"}}}],"key":"VYlzIHuF2y"}],"key":"o8t0V42Anz"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"@show size(A), size(B);\nBA = B * A     # matrix product","key":"hvfegpvQS0"},{"type":"output","id":"tcUQncahhmPurkthvI8n5","data":[{"output_type":"stream","name":"stdout","text":"(size(A), size(B)) = ((3, 5), (3, 3))"},{"output_type":"stream","name":"stdout","text":"\n"},{"output_type":"execute_result","execution_count":28,"metadata":{},"data":{"text/plain":{"content":"3×5 Matrix{Float64}:\n  -1.0    -2.0       -3.0     -4.0      -5.0\n   0.0     0.0        0.0      0.0       0.0\n -15.708  -7.07107  -13.5914  -8.09017  -5.49306","content_type":"text/plain"}}}],"key":"JJtP0JpVVV"}],"key":"GOZZm62KGl"},{"type":"paragraph","position":{"start":{"line":360,"column":1},"end":{"line":360,"column":1}},"children":[{"type":"inlineCode","value":"A * B","position":{"start":{"line":360,"column":1},"end":{"line":360,"column":1}},"key":"fIXt077hu2"},{"type":"text","value":" causes an error here, because the dimensions aren’t compatible.","position":{"start":{"line":360,"column":1},"end":{"line":360,"column":1}},"key":"n74ZTk1XnW"}],"key":"T2flVXllGs"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"wt4iS9YTnH"}],"key":"OVfWCi6qWl"},{"type":"paragraph","position":{"start":{"line":364,"column":1},"end":{"line":364,"column":1}},"children":[{"type":"text","value":"Errors are formally called ","position":{"start":{"line":364,"column":1},"end":{"line":364,"column":1}},"key":"dDdR8RjVgJ"},{"type":"emphasis","position":{"start":{"line":364,"column":1},"end":{"line":364,"column":1}},"children":[{"type":"text","value":"exceptions","position":{"start":{"line":364,"column":1},"end":{"line":364,"column":1}},"key":"IO8dOegM9p"}],"key":"rtD7DUZLDU"},{"type":"text","value":" in Julia.","position":{"start":{"line":364,"column":1},"end":{"line":364,"column":1}},"key":"v8oJH28f8m"}],"key":"qfUgFM93v5"}],"class":"dropdown","key":"aueynvupod"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"A * B    # throws an error","visibility":"show","key":"po5zeWODmS"},{"type":"output","id":"h9LFHs2PZw8HL9VnxDbc5","data":[{"output_type":"error","traceback":"DimensionMismatch: matrix A has axes (Base.OneTo(3),Base.OneTo(5)), matrix B has axes (Base.OneTo(3),Base.OneTo(3))\n\nStacktrace:\n [1] \u001b[0m\u001b[1m_generic_matmatmul!\u001b[22m\u001b[0m\u001b[1m(\u001b[22m\u001b[90mC\u001b[39m::\u001b[0mMatrix\u001b[90m{Float64}\u001b[39m, \u001b[90mA\u001b[39m::\u001b[0mMatrix\u001b[90m{Float64}\u001b[39m, \u001b[90mB\u001b[39m::\u001b[0mMatrix\u001b[90m{Int64}\u001b[39m, \u001b[90m_add\u001b[39m::\u001b[0mLinearAlgebra.MulAddMul\u001b[90m{true, true, Bool, Bool}\u001b[39m\u001b[0m\u001b[1m)\u001b[22m\n\u001b[90m   @\u001b[39m \u001b[35mLinearAlgebra\u001b[39m \u001b[90m~/.julia/juliaup/julia-1.11.5+0.aarch64.apple.darwin14/share/julia/stdlib/v1.11/LinearAlgebra/src/\u001b[39m\u001b[90m\u001b[4mmatmul.jl:883\u001b[24m\u001b[39m\n [2] \u001b[0m\u001b[1mgeneric_matmatmul!\u001b[22m\n\u001b[90m   @\u001b[39m \u001b[90m~/.julia/juliaup/julia-1.11.5+0.aarch64.apple.darwin14/share/julia/stdlib/v1.11/LinearAlgebra/src/\u001b[39m\u001b[90m\u001b[4mmatmul.jl:868\u001b[24m\u001b[39m\u001b[90m [inlined]\u001b[39m\n [3] \u001b[0m\u001b[1m_mul!\u001b[22m\n\u001b[90m   @\u001b[39m \u001b[90m~/.julia/juliaup/julia-1.11.5+0.aarch64.apple.darwin14/share/julia/stdlib/v1.11/LinearAlgebra/src/\u001b[39m\u001b[90m\u001b[4mmatmul.jl:287\u001b[24m\u001b[39m\u001b[90m [inlined]\u001b[39m\n [4] \u001b[0m\u001b[1mmul!\u001b[22m\n\u001b[90m   @\u001b[39m \u001b[90m~/.julia/juliaup/julia-1.11.5+0.aarch64.apple.darwin14/share/julia/stdlib/v1.11/LinearAlgebra/src/\u001b[39m\u001b[90m\u001b[4mmatmul.jl:285\u001b[24m\u001b[39m\u001b[90m [inlined]\u001b[39m\n [5] \u001b[0m\u001b[1mmul!\u001b[22m\n\u001b[90m   @\u001b[39m \u001b[90m~/.julia/juliaup/julia-1.11.5+0.aarch64.apple.darwin14/share/julia/stdlib/v1.11/LinearAlgebra/src/\u001b[39m\u001b[90m\u001b[4mmatmul.jl:253\u001b[24m\u001b[39m\u001b[90m [inlined]\u001b[39m\n [6] \u001b[0m\u001b[1m*\u001b[22m\u001b[0m\u001b[1m(\u001b[22m\u001b[90mA\u001b[39m::\u001b[0mMatrix\u001b[90m{Float64}\u001b[39m, \u001b[90mB\u001b[39m::\u001b[0mMatrix\u001b[90m{Int64}\u001b[39m\u001b[0m\u001b[1m)\u001b[22m\n\u001b[90m   @\u001b[39m \u001b[35mLinearAlgebra\u001b[39m \u001b[90m~/.julia/juliaup/julia-1.11.5+0.aarch64.apple.darwin14/share/julia/stdlib/v1.11/LinearAlgebra/src/\u001b[39m\u001b[90m\u001b[4mmatmul.jl:114\u001b[24m\u001b[39m\n [7] top-level scope\n\u001b[90m   @\u001b[39m \u001b[90m\u001b[4mIn[29]:1\u001b[24m\u001b[39m","ename":"LoadError","evalue":"DimensionMismatch: matrix A has axes (Base.OneTo(3),Base.OneTo(5)), matrix B has axes (Base.OneTo(3),Base.OneTo(3))"}],"visibility":"show","key":"QlrFrPGAmq"}],"data":{"tags":["raises-exception"]},"visibility":"show","key":"dYRC0k7dCq"},{"type":"paragraph","position":{"start":{"line":372,"column":1},"end":{"line":372,"column":1}},"children":[{"type":"text","value":"A square matrix raised to an integer power is the same as repeated matrix multiplication.","position":{"start":{"line":372,"column":1},"end":{"line":372,"column":1}},"key":"fnw79YpjRU"}],"key":"yVMuIxAuF0"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"B^3    # same as B*B*B","key":"xxCzp7Gg75"},{"type":"output","id":"9lqwUxhd-2RUFHzQ1SbJ3","data":[{"output_type":"execute_result","execution_count":30,"metadata":{},"data":{"text/plain":{"content":"3×3 Matrix{Int64}:\n -1  0     0\n  0  0     0\n  0  0  -125","content_type":"text/plain"}}}],"key":"pAtVNZRKA5"}],"key":"qcyOvdpt41"},{"type":"paragraph","position":{"start":{"line":378,"column":1},"end":{"line":378,"column":1}},"children":[{"type":"text","value":"Sometimes one instead wants to treat a matrix or vector as a mere array and simply apply a single operation to each element of it. For multiplication, division, and power, the corresponding operators start with a dot.","position":{"start":{"line":378,"column":1},"end":{"line":378,"column":1}},"key":"R7oxSSeuWI"}],"key":"V1H2dtHFJV"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"C = -A;","key":"XAdGXJjESk"},{"type":"output","id":"bYaxQJzHl1IQncNHUmpdv","data":[],"key":"wPdGanc12K"}],"key":"CvY0i8qFuH"},{"type":"paragraph","position":{"start":{"line":384,"column":1},"end":{"line":384,"column":1}},"children":[{"type":"text","value":"Because both matrices are ","position":{"start":{"line":384,"column":1},"end":{"line":384,"column":1}},"key":"IbRvhlzCHg"},{"type":"inlineMath","value":"3\\times 5","position":{"start":{"line":384,"column":1},"end":{"line":384,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>3</mn><mo>×</mo><mn>5</mn></mrow><annotation encoding=\"application/x-tex\">3\\times 5</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">3</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">5</span></span></span></span>","key":"ihjCFkbRmx"},{"type":"text","value":", ","position":{"start":{"line":384,"column":1},"end":{"line":384,"column":1}},"key":"y2Opb2n8Xj"},{"type":"inlineCode","value":"A * C","position":{"start":{"line":384,"column":1},"end":{"line":384,"column":1}},"key":"Q7xFZNfpU5"},{"type":"text","value":" would be an error here, but elementwise operations are fine.","position":{"start":{"line":384,"column":1},"end":{"line":384,"column":1}},"key":"ihNnqku2n4"}],"key":"K9gOMj2aLl"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"elementwise = A .* C","key":"HhtdhOJFQt"},{"type":"output","id":"mZHyPYUL80UdWO09ZIEmY","data":[{"output_type":"execute_result","execution_count":32,"metadata":{},"data":{"text/plain":{"content":"3×5 Matrix{Float64}:\n    -1.0        -4.0    -9.0       -16.0       -25.0\n -2500.0     -1600.0  -900.0      -400.0      -100.0\n    -9.8696     -2.0    -7.38906    -2.61803    -1.20695","content_type":"text/plain"}}}],"key":"IAzLPXAiS4"}],"key":"UgpgVgH2OW"},{"type":"paragraph","position":{"start":{"line":393,"column":1},"end":{"line":393,"column":1}},"children":[{"type":"text","value":"The two operands of a dot operator have to have the same size—unless one is a scalar, in which case it is expanded or ","position":{"start":{"line":393,"column":1},"end":{"line":393,"column":1}},"key":"hYkMyCDslk"},{"type":"emphasis","position":{"start":{"line":393,"column":1},"end":{"line":393,"column":1}},"children":[{"type":"text","value":"broadcast","position":{"start":{"line":393,"column":1},"end":{"line":393,"column":1}},"key":"U5LpPk6PBV"}],"key":"egoQkQ3biP"},{"type":"text","value":" to be the same size as the other operand.","position":{"start":{"line":393,"column":1},"end":{"line":393,"column":1}},"key":"eRavrWKmMh"}],"indexEntries":[{"entry":"Julia","subEntry":{"value":"broadcasting","kind":"entry"},"emphasis":false}],"label":"index-RJSj1wwWp2","identifier":"index-rjsj1wwwp2","html_id":"index-rjsj1wwwp2","key":"uE0KNV8XSE"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"x_to_two = x .^ 2","key":"taE3P6CSkk"},{"type":"output","id":"uXIle1TRUn1ILFwUYftTA","data":[{"output_type":"execute_result","execution_count":33,"metadata":{},"data":{"text/plain":{"content":"5-element Vector{Int64}:\n 9\n 9\n 0\n 1\n 0","content_type":"text/plain"}}}],"key":"EqmsvRGoLg"}],"key":"b9fWxFrJOn"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"two_to_x = 2 .^ x","key":"D0CTzzjVrt"},{"type":"output","id":"MCn3N3U85Lv7oUy_Zpzbx","data":[{"output_type":"execute_result","execution_count":34,"metadata":{},"data":{"text/plain":{"content":"5-element Vector{Int64}:\n 8\n 8\n 1\n 2\n 1","content_type":"text/plain"}}}],"key":"Ef7MP7MMTV"}],"key":"NQ9eXExWkU"},{"type":"paragraph","position":{"start":{"line":403,"column":1},"end":{"line":403,"column":1}},"children":[{"type":"text","value":"Most of the mathematical functions, such as cos, sin, log, exp, and sqrt, expect scalars as operands. However, you can broadcast any function, including ones that you have defined, across a vector or array by using a special dot syntax.","position":{"start":{"line":403,"column":1},"end":{"line":403,"column":1}},"key":"WHbnIGY8Md"}],"key":"iBENe0b3BX"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"v8n1xvZcg7"}],"key":"xvI43XzkDt"},{"type":"paragraph","position":{"start":{"line":406,"column":1},"end":{"line":406,"column":1}},"children":[{"type":"text","value":"A dot added to the end of a function name means to apply the function elementwise to an array.","position":{"start":{"line":406,"column":1},"end":{"line":406,"column":1}},"key":"kroOtIYOXZ"}],"key":"clE7fCHaQI"}],"class":"dropdown","key":"qX9aZwjEY0"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"show(cos.(π * x))    # broadcast to a function","key":"tHOkwNevRs"},{"type":"output","id":"TtUC8x8rwVn0i3pknF8uw","data":[{"output_type":"stream","name":"stdout","text":"[-1.0, -1.0, 1.0, -1.0, 1.0]"}],"key":"gA7A3ZfNgc"}],"key":"tU4yFlpOsf"},{"type":"paragraph","position":{"start":{"line":413,"column":1},"end":{"line":413,"column":1}},"children":[{"type":"text","value":"Rather than dotting multiple individual functions, you can use ","position":{"start":{"line":413,"column":1},"end":{"line":413,"column":1}},"key":"TIxpkGXH3o"},{"type":"inlineCode","value":"@.","position":{"start":{"line":413,"column":1},"end":{"line":413,"column":1}},"key":"bEAMAFv3LJ"},{"type":"text","value":" before an expression to broadcast everything within it.","position":{"start":{"line":413,"column":1},"end":{"line":413,"column":1}},"key":"E5Gy3o67KT"}],"key":"UVS5yQFVEG"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"show(@. cospi( (x + 1)^3) )    # broadcast an entire expression","key":"czs6RXaODA"},{"type":"output","id":"Cy9l1ikFetN6YNITqlXpt","data":[{"output_type":"stream","name":"stdout","text":"[1.0, 1.0, -1.0, 1.0, -1.0]"}],"key":"tU2VRJoYfw"}],"key":"btEZUnKm7b"}],"label":"demo-matrices-julia","identifier":"demo-matrices-julia","html_id":"demo-matrices-julia","key":"jNobzxtPPV"},{"type":"heading","depth":3,"position":{"start":{"line":420,"column":1},"end":{"line":420,"column":1}},"children":[{"type":"text","value":"2.3 ","position":{"start":{"line":420,"column":1},"end":{"line":420,"column":1}},"key":"lAhLCGk7yJ"},{"type":"link","identifier":"section-linsys-linear-systems","label":"section-linsys-linear-systems","kind":"narrative","position":{"start":{"line":420,"column":5},"end":{"line":420,"column":35}},"url":"/linear-systems","internal":true,"dataUrl":"/linear-systems.json","children":[{"type":"text","value":"Linear systems","key":"tUYfNoMWp9"}],"key":"PBKJsqP31J"}],"identifier":"id-2-3","label":"2.3 ","html_id":"id-2-3","implicit":true,"key":"s1Mz0QKEnh"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-systems-backslash","label":"demo-systems-backslash","kind":"proof:example","position":{"start":{"line":422,"column":1},"end":{"line":422,"column":24}},"children":[{"type":"text","value":"Example ","key":"VJPfZiiitc"},{"type":"text","value":"2.3.2","key":"FtITOzvO4P"}],"template":"Example %s","enumerator":"2.3.2","resolved":true,"html_id":"demo-systems-backslash","remote":true,"url":"/linear-systems","dataUrl":"/linear-systems.json","key":"itKVjf3E3Z"}],"key":"Mzksko1Hkp"},{"type":"paragraph","position":{"start":{"line":424,"column":1},"end":{"line":424,"column":1}},"children":[{"type":"text","value":"For a square matrix ","position":{"start":{"line":424,"column":1},"end":{"line":424,"column":1}},"key":"EwVZBgh26N"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":424,"column":1},"end":{"line":424,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"ejaEgnwIyG"},{"type":"text","value":", the syntax ","position":{"start":{"line":424,"column":1},"end":{"line":424,"column":1}},"key":"byPBzeZ7xM"},{"type":"inlineCode","value":"A \\ b","position":{"start":{"line":424,"column":1},"end":{"line":424,"column":1}},"key":"U2wZmk3EgF"},{"type":"text","value":" is mathematically equivalent to ","position":{"start":{"line":424,"column":1},"end":{"line":424,"column":1}},"key":"ARjP0tSIiC"},{"type":"inlineMath","value":"\\mathbf{A}^{-1} \\mathbf{b}","position":{"start":{"line":424,"column":1},"end":{"line":424,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi mathvariant=\"bold\">A</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}^{-1} \\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">A</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"RJ338pERQt"},{"type":"text","value":".","position":{"start":{"line":424,"column":1},"end":{"line":424,"column":1}},"key":"Fg4Mi6Mbwx"}],"key":"mZMmIoG6cw"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"A = [1 0 -1; 2 2 1; -1 -3 0]","key":"c7fBB7M7Ax"},{"type":"output","id":"ogYbU9Sky0hPSRRLAKv-C","data":[{"output_type":"execute_result","execution_count":37,"metadata":{},"data":{"text/plain":{"content":"3×3 Matrix{Int64}:\n  1   0  -1\n  2   2   1\n -1  -3   0","content_type":"text/plain"}}}],"key":"VaQAdeZoWy"}],"key":"TfDKVArqed"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"b = [1, 2, 3]","key":"XY7PckPfRG"},{"type":"output","id":"TD4gfxzKg8x7niBV8PgCw","data":[{"output_type":"execute_result","execution_count":38,"metadata":{},"data":{"text/plain":{"content":"3-element Vector{Int64}:\n 1\n 2\n 3","content_type":"text/plain"}}}],"key":"dfuflF6gNh"}],"key":"UEGyFuYa2m"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"x = A \\ b","key":"eQNEOwQIn1"},{"type":"output","id":"Foq5XmmVVC1OPDgB-3wuS","data":[{"output_type":"execute_result","execution_count":39,"metadata":{},"data":{"text/plain":{"content":"3-element Vector{Float64}:\n  2.1428571428571432\n -1.7142857142857144\n  1.1428571428571428","content_type":"text/plain"}}}],"key":"FaCzj84imU"}],"key":"PmzG8L1hUy"},{"type":"paragraph","position":{"start":{"line":441,"column":1},"end":{"line":441,"column":1}},"children":[{"type":"text","value":"One way to check the answer is to compute a quantity known as the ","position":{"start":{"line":441,"column":1},"end":{"line":441,"column":1}},"key":"TCnkjtyPuk"},{"type":"strong","position":{"start":{"line":441,"column":1},"end":{"line":441,"column":1}},"children":[{"type":"text","value":"residual","position":{"start":{"line":441,"column":1},"end":{"line":441,"column":1}},"key":"MBrjzP3uD5"}],"key":"VfjF0RkA0y"},{"type":"text","value":". It is (ideally) close to machine precision (relative to the elements in the data).","position":{"start":{"line":441,"column":1},"end":{"line":441,"column":1}},"key":"URi8qUh6pI"}],"indexEntries":[{"entry":"residual","emphasis":false}],"label":"index-AVEJCdMFhB","identifier":"index-avejcdmfhb","html_id":"index-avejcdmfhb","key":"GGEeWwIJfW"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"residual = b - A * x","key":"iytZxMIrPa"},{"type":"output","id":"rTK2DSXYJlbyazTDKVI_H","data":[{"output_type":"execute_result","execution_count":40,"metadata":{},"data":{"text/plain":{"content":"3-element Vector{Float64}:\n -4.440892098500626e-16\n -4.440892098500626e-16\n  0.0","content_type":"text/plain"}}}],"key":"hqXMGVPPkr"}],"key":"xqOPjpWDQ3"},{"type":"paragraph","position":{"start":{"line":447,"column":1},"end":{"line":447,"column":1}},"children":[{"type":"text","value":"If the matrix ","position":{"start":{"line":447,"column":1},"end":{"line":447,"column":1}},"key":"TrKrf81bDZ"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":447,"column":1},"end":{"line":447,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"nbn2nyLxQO"},{"type":"text","value":" is singular, you may get an error.","position":{"start":{"line":447,"column":1},"end":{"line":447,"column":1}},"key":"iYYZAniwr4"}],"key":"QV0MdiV8mP"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"A = [0 1; 0 0]\nb = [1, -1]\nx = A \\ b    # throws an error","visibility":"show","key":"Ra1iDWycnU"},{"type":"output","id":"6uiKznDO2xVEz2EY3m--N","data":[{"output_type":"error","traceback":"SingularException(2)\n\nStacktrace:\n [1] \u001b[0m\u001b[1mgeneric_trimatdiv!\u001b[22m\u001b[0m\u001b[1m(\u001b[22m\u001b[90mC\u001b[39m::\u001b[0mVector\u001b[90m{Float64}\u001b[39m, \u001b[90muploc\u001b[39m::\u001b[0mChar, \u001b[90misunitc\u001b[39m::\u001b[0mChar, \u001b[90mtfun\u001b[39m::\u001b[0mtypeof(identity), \u001b[90mA\u001b[39m::\u001b[0mMatrix\u001b[90m{Int64}\u001b[39m, \u001b[90mB\u001b[39m::\u001b[0mVector\u001b[90m{Int64}\u001b[39m\u001b[0m\u001b[1m)\u001b[22m\n\u001b[90m   @\u001b[39m \u001b[35mLinearAlgebra\u001b[39m \u001b[90m~/.julia/juliaup/julia-1.11.5+0.aarch64.apple.darwin14/share/julia/stdlib/v1.11/LinearAlgebra/src/\u001b[39m\u001b[90m\u001b[4mtriangular.jl:1388\u001b[24m\u001b[39m\n [2] \u001b[0m\u001b[1m_ldiv!\u001b[22m\n\u001b[90m   @\u001b[39m \u001b[90m~/.julia/juliaup/julia-1.11.5+0.aarch64.apple.darwin14/share/julia/stdlib/v1.11/LinearAlgebra/src/\u001b[39m\u001b[90m\u001b[4mtriangular.jl:966\u001b[24m\u001b[39m\u001b[90m [inlined]\u001b[39m\n [3] \u001b[0m\u001b[1mldiv!\u001b[22m\n\u001b[90m   @\u001b[39m \u001b[90m~/.julia/juliaup/julia-1.11.5+0.aarch64.apple.darwin14/share/julia/stdlib/v1.11/LinearAlgebra/src/\u001b[39m\u001b[90m\u001b[4mtriangular.jl:959\u001b[24m\u001b[39m\u001b[90m [inlined]\u001b[39m\n [4] \u001b[0m\u001b[1m\\\u001b[22m\n\u001b[90m   @\u001b[39m \u001b[90m~/.julia/juliaup/julia-1.11.5+0.aarch64.apple.darwin14/share/julia/stdlib/v1.11/LinearAlgebra/src/\u001b[39m\u001b[90m\u001b[4mtriangular.jl:1721\u001b[24m\u001b[39m\u001b[90m [inlined]\u001b[39m\n [5] \u001b[0m\u001b[1m\\\u001b[22m\u001b[0m\u001b[1m(\u001b[22m\u001b[90mA\u001b[39m::\u001b[0mMatrix\u001b[90m{Int64}\u001b[39m, \u001b[90mB\u001b[39m::\u001b[0mVector\u001b[90m{Int64}\u001b[39m\u001b[0m\u001b[1m)\u001b[22m\n\u001b[90m   @\u001b[39m \u001b[35mLinearAlgebra\u001b[39m \u001b[90m~/.julia/juliaup/julia-1.11.5+0.aarch64.apple.darwin14/share/julia/stdlib/v1.11/LinearAlgebra/src/\u001b[39m\u001b[90m\u001b[4mgeneric.jl:1130\u001b[24m\u001b[39m\n [6] top-level scope\n\u001b[90m   @\u001b[39m \u001b[90m\u001b[4mIn[41]:3\u001b[24m\u001b[39m","ename":"LoadError","evalue":"SingularException(2)"}],"visibility":"show","key":"T3K3b0z7XK"}],"data":{"tags":["raises-exception"]},"visibility":"show","key":"aZYStFh1TE"},{"type":"paragraph","position":{"start":{"line":459,"column":1},"end":{"line":459,"column":1}},"children":[{"type":"text","value":"In this case we can check that the rank of ","position":{"start":{"line":459,"column":1},"end":{"line":459,"column":1}},"key":"xtFDI5tqM4"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":459,"column":1},"end":{"line":459,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"Zp22BO5CL9"},{"type":"text","value":" is less than its number of columns, indicating singularity.","position":{"start":{"line":459,"column":1},"end":{"line":459,"column":1}},"key":"fx4MXoKkl0"}],"indexEntries":[{"entry":"Julia","subEntry":{"value":"rank","kind":"entry"},"emphasis":true}],"label":"index-mP4AiwxWg2","identifier":"index-mp4aiwxwg2","html_id":"index-mp4aiwxwg2","key":"N1xo1tDvVJ"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"LpSV3tGSYl"}],"key":"xgzYPN9AtS"},{"type":"paragraph","position":{"start":{"line":462,"column":1},"end":{"line":462,"column":1}},"children":[{"type":"text","value":"The function ","position":{"start":{"line":462,"column":1},"end":{"line":462,"column":1}},"key":"YjpHNerrob"},{"type":"inlineCode","value":"rank","position":{"start":{"line":462,"column":1},"end":{"line":462,"column":1}},"key":"bJIoclUth9"},{"type":"text","value":" computes the rank of a matrix. However, it is numerically unstable for matrices that are nearly singular, in a sense to be defined in a later section.","position":{"start":{"line":462,"column":1},"end":{"line":462,"column":1}},"key":"ShS8tgc3ww"}],"key":"joKpmjESBt"}],"class":"dropdown","key":"LUmEsN3AOf"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"rank(A)","key":"o1B9z2qxfn"},{"type":"output","id":"o5zwKbwPax632Mt5s4cuE","data":[{"output_type":"execute_result","execution_count":42,"metadata":{},"data":{"text/plain":{"content":"1","content_type":"text/plain"}}}],"key":"wh3fNTQoyR"}],"key":"qfLGSlf66y"},{"type":"paragraph","position":{"start":{"line":469,"column":1},"end":{"line":469,"column":1}},"children":[{"type":"text","value":"A linear system with a singular matrix might have no solution or infinitely many solutions, but in either case, backslash will fail. Moreover, detecting singularity is a lot like checking whether two floating-point numbers are ","position":{"start":{"line":469,"column":1},"end":{"line":469,"column":1}},"key":"q50peEdapv"},{"type":"emphasis","position":{"start":{"line":469,"column":1},"end":{"line":469,"column":1}},"children":[{"type":"text","value":"exactly","position":{"start":{"line":469,"column":1},"end":{"line":469,"column":1}},"key":"AbKi5V2Vmx"}],"key":"IQxUK7oYbx"},{"type":"text","value":" equal: because of roundoff, it could be missed. In ","position":{"start":{"line":469,"column":1},"end":{"line":469,"column":1}},"key":"qFRKslssQX"},{"type":"link","kind":"numref","identifier":"section-linsys-condition-number","label":"section-linsys-condition-number","url":"/condition-number","internal":true,"dataUrl":"/condition-number.json","children":[{"type":"text","value":"Conditioning of linear systems","key":"P881CYi8vs"}],"key":"c8TuDXIFnv"},{"type":"text","value":" we’ll find a robust way to fully describe this situation.","position":{"start":{"line":469,"column":1},"end":{"line":469,"column":1}},"key":"DJaKizkEJd"}],"key":"Anu2XiUysb"}],"label":"demo-systems-backslash-julia","identifier":"demo-systems-backslash-julia","html_id":"demo-systems-backslash-julia","key":"Gi37XC9tJi"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-systems-triangular","label":"demo-systems-triangular","kind":"proof:example","position":{"start":{"line":473,"column":1},"end":{"line":473,"column":25}},"children":[{"type":"text","value":"Example ","key":"PUvl4StGWP"},{"type":"text","value":"2.3.3","key":"uLcEHGWmXW"}],"template":"Example %s","enumerator":"2.3.3","resolved":true,"html_id":"demo-systems-triangular","remote":true,"url":"/linear-systems","dataUrl":"/linear-systems.json","key":"yqdLm9tLiS"}],"key":"cDfIKRHMBg"},{"type":"paragraph","position":{"start":{"line":478,"column":1},"end":{"line":478,"column":1}},"children":[{"type":"text","value":"It’s easy to get just the lower triangular part of any matrix using the ","position":{"start":{"line":478,"column":1},"end":{"line":478,"column":1}},"key":"EjGie9TaLE"},{"type":"inlineCode","value":"tril","position":{"start":{"line":478,"column":1},"end":{"line":478,"column":1}},"key":"rchBa2uGqg"},{"type":"text","value":" function.","position":{"start":{"line":478,"column":1},"end":{"line":478,"column":1}},"key":"ZpluC84KXi"}],"indexEntries":[{"entry":"Julia","subEntry":{"value":"tril","kind":"entry"},"emphasis":true},{"entry":"Julia","subEntry":{"value":"triu","kind":"entry"},"emphasis":true}],"label":"index-bkVfRkGnSH","identifier":"index-bkvfrkgnsh","html_id":"index-bkvfrkgnsh","key":"RHXXFI45bh"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"mUxe2jonfZ"}],"key":"YMjFwhJpaH"},{"type":"paragraph","position":{"start":{"line":481,"column":1},"end":{"line":481,"column":1}},"children":[{"type":"text","value":"Use ","position":{"start":{"line":481,"column":1},"end":{"line":481,"column":1}},"key":"GsMvE5usib"},{"type":"inlineCode","value":"tril","position":{"start":{"line":481,"column":1},"end":{"line":481,"column":1}},"key":"Znwn3KaoIG"},{"type":"text","value":" to return a matrix that zeros out everything above the main diagonal. The ","position":{"start":{"line":481,"column":1},"end":{"line":481,"column":1}},"key":"HBpRMgh8yR"},{"type":"inlineCode","value":"triu","position":{"start":{"line":481,"column":1},"end":{"line":481,"column":1}},"key":"XL5YpnDC4s"},{"type":"text","value":" function zeros out below the diagonal.","position":{"start":{"line":481,"column":1},"end":{"line":481,"column":1}},"key":"AXG2d7GgOA"}],"key":"DhIfS2EYK6"}],"class":"dropdown","key":"PjJgUZFHvz"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"A = rand(1.:9., 5, 5)\nL = tril(A)","key":"q62cQnikLr"},{"type":"output","id":"gAyHFd5xuA7l_XLZseWU7","data":[{"output_type":"execute_result","execution_count":43,"metadata":{},"data":{"text/plain":{"content":"5×5 Matrix{Float64}:\n 1.0  0.0  0.0  0.0  0.0\n 9.0  3.0  0.0  0.0  0.0\n 3.0  9.0  4.0  0.0  0.0\n 7.0  8.0  8.0  8.0  0.0\n 7.0  7.0  6.0  9.0  1.0","content_type":"text/plain"}}}],"key":"hEzJHkBNDo"}],"key":"Etyj32VC5Z"},{"type":"paragraph","position":{"start":{"line":489,"column":1},"end":{"line":489,"column":1}},"children":[{"type":"text","value":"We’ll set up and solve a linear system with this matrix.","position":{"start":{"line":489,"column":1},"end":{"line":489,"column":1}},"key":"v12Ci0jQ5I"}],"key":"NPB3I97J8Y"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"b = ones(5)\nx = FNC.forwardsub(L,b)","key":"UhMwFaV27q"},{"type":"output","id":"5GbQvPk62oLJOf31A1_qC","data":[{"output_type":"execute_result","execution_count":44,"metadata":{},"data":{"text/plain":{"content":"5-element Vector{Float64}:\n  1.0\n -2.6666666666666665\n  5.5\n -3.5833333333333335\n 11.916666666666664","content_type":"text/plain"}}}],"key":"Logchc66Ux"}],"key":"dBOxDxDm7D"},{"type":"paragraph","position":{"start":{"line":496,"column":1},"end":{"line":496,"column":1}},"children":[{"type":"text","value":"It’s not clear how accurate this answer is. However, the residual should be zero or comparable to ","position":{"start":{"line":496,"column":1},"end":{"line":496,"column":1}},"key":"QAUGRRrfmt"},{"type":"inlineMath","value":"\\macheps","position":{"start":{"line":496,"column":1},"end":{"line":496,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>ϵ</mi><mtext>mach</mtext></msub></mrow><annotation encoding=\"application/x-tex\">\\macheps</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">ϵ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">mach</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"TrMcksn3XC"},{"type":"text","value":".","position":{"start":{"line":496,"column":1},"end":{"line":496,"column":1}},"key":"ih1r8f7hSA"}],"key":"b9Wu4IuDXm"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"b - L * x","key":"OseJbJWvDw"},{"type":"output","id":"eeFhaQ-kcDv9nqsAmzcb6","data":[{"output_type":"execute_result","execution_count":45,"metadata":{},"data":{"text/plain":{"content":"5-element Vector{Float64}:\n  0.0\n -4.440892098500626e-16\n  0.0\n  0.0\n  1.7763568394002505e-15","content_type":"text/plain"}}}],"key":"iaoNATZnZt"}],"key":"aGRHlvkrHf"},{"type":"paragraph","position":{"start":{"line":505,"column":1},"end":{"line":505,"column":1}},"children":[{"type":"text","value":"Next we’ll engineer a problem to which we know the exact answer. Use ","position":{"start":{"line":505,"column":1},"end":{"line":505,"column":1}},"key":"xOGSvylHHs"},{"type":"inlineCode","value":"\\alpha","position":{"start":{"line":505,"column":1},"end":{"line":505,"column":1}},"key":"NIFJh82f8H"},{"type":"text","value":" ","position":{"start":{"line":505,"column":1},"end":{"line":505,"column":1}},"key":"SeeJ5CKzS6"},{"type":"keyboard","children":[{"type":"text","value":"Tab","key":"yapL1Bd710"}],"key":"Gn6YQn75oa"},{"type":"text","value":" and ","position":{"start":{"line":505,"column":1},"end":{"line":505,"column":1}},"key":"FXxY8wBC42"},{"type":"inlineCode","value":"\\beta","position":{"start":{"line":505,"column":1},"end":{"line":505,"column":1}},"key":"AEk5lLTO7S"},{"type":"text","value":" ","position":{"start":{"line":505,"column":1},"end":{"line":505,"column":1}},"key":"XUGjbRBINM"},{"type":"keyboard","children":[{"type":"text","value":"Tab","key":"gBANsuZWsO"}],"key":"mimhxiGkoP"},{"type":"text","value":" to get the Greek letters.","position":{"start":{"line":505,"column":1},"end":{"line":505,"column":1}},"key":"TTDScnoJmf"}],"indexEntries":[{"entry":"Julia","subEntry":{"value":"Pair","kind":"entry"},"emphasis":true},{"entry":"Julia","subEntry":{"value":"diagm","kind":"entry"},"emphasis":false}],"label":"index-DTRKFA46HE","identifier":"index-dtrkfa46he","html_id":"index-dtrkfa46he","key":"yBw3iXySyt"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"WekCvEKOpL"}],"key":"qK8y6nIaW8"},{"type":"paragraph","position":{"start":{"line":508,"column":1},"end":{"line":508,"column":1}},"children":[{"type":"text","value":"The notation ","position":{"start":{"line":508,"column":1},"end":{"line":508,"column":1}},"key":"QPOmMgCEMs"},{"type":"inlineCode","value":"0=>ones(5)","position":{"start":{"line":508,"column":1},"end":{"line":508,"column":1}},"key":"SgwBafbR0M"},{"type":"text","value":" creates a ","position":{"start":{"line":508,"column":1},"end":{"line":508,"column":1}},"key":"emPA00NwBd"},{"type":"inlineCode","value":"Pair","position":{"start":{"line":508,"column":1},"end":{"line":508,"column":1}},"key":"wOVWYTtTaS"},{"type":"text","value":". In ","position":{"start":{"line":508,"column":1},"end":{"line":508,"column":1}},"key":"Xfs92v01Hi"},{"type":"inlineCode","value":"diagm","position":{"start":{"line":508,"column":1},"end":{"line":508,"column":1}},"key":"Kc8Ugbn2dH"},{"type":"text","value":", pairs indicate the position of a diagonal and the elements that are to be placed on it.","position":{"start":{"line":508,"column":1},"end":{"line":508,"column":1}},"key":"lnhoXfQqXS"}],"key":"Y8HLlbiHpI"}],"class":"dropdown","key":"sKtMQ19Ur5"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"α = 0.3;\nβ = 2.2;\nU = diagm( 0=>ones(5), 1=>[-1, -1, -1, -1] )\nU[1, [4, 5]] = [ α - β, β ]\nU","key":"pjlKRPL5h9"},{"type":"output","id":"uQwmD1p3rcr_uTEgNNIqP","data":[{"output_type":"execute_result","execution_count":46,"metadata":{},"data":{"text/plain":{"content":"5×5 Matrix{Float64}:\n 1.0  -1.0   0.0  -1.9   2.2\n 0.0   1.0  -1.0   0.0   0.0\n 0.0   0.0   1.0  -1.0   0.0\n 0.0   0.0   0.0   1.0  -1.0\n 0.0   0.0   0.0   0.0   1.0","content_type":"text/plain"}}}],"key":"obOHDpIe8G"}],"key":"yE2ZTN4NLp"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"x_exact = ones(5)\nb = [α, 0, 0, 0, 1]","key":"VjSucGvqr4"},{"type":"output","id":"FJQm5BwAMu56qP83idWTa","data":[{"output_type":"execute_result","execution_count":47,"metadata":{},"data":{"text/plain":{"content":"5-element Vector{Float64}:\n 0.3\n 0.0\n 0.0\n 0.0\n 1.0","content_type":"text/plain"}}}],"key":"yTFVbymFVh"}],"key":"B9ow6zZ0XX"},{"type":"paragraph","position":{"start":{"line":524,"column":1},"end":{"line":524,"column":1}},"children":[{"type":"text","value":"Now we use backward substitution to solve for ","position":{"start":{"line":524,"column":1},"end":{"line":524,"column":1}},"key":"wjGz8Lv1eP"},{"type":"inlineMath","value":"\\mathbf{x}","position":{"start":{"line":524,"column":1},"end":{"line":524,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">x</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{x}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4444em;\"></span><span class=\"mord mathbf\">x</span></span></span></span>","key":"zkouZLtcjb"},{"type":"text","value":", and compare to the exact solution we know already.","position":{"start":{"line":524,"column":1},"end":{"line":524,"column":1}},"key":"mFpFyVR0y7"}],"key":"rGV9g4GxVY"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"x = FNC.backsub(U,b)\nerr = x - x_exact","key":"Es0v3UsXN7"},{"type":"output","id":"VPJ8Urb2Yl-IH-x_MJrLM","data":[{"output_type":"execute_result","execution_count":48,"metadata":{},"data":{"text/plain":{"content":"5-element Vector{Float64}:\n 2.220446049250313e-16\n 0.0\n 0.0\n 0.0\n 0.0","content_type":"text/plain"}}}],"key":"j3h0c7qDpN"}],"key":"QhWS72Cl7t"},{"type":"paragraph","position":{"start":{"line":531,"column":1},"end":{"line":531,"column":1}},"children":[{"type":"text","value":"Everything seems OK here. But another example, with a different value for ","position":{"start":{"line":531,"column":1},"end":{"line":531,"column":1}},"key":"tqNxMhbvWy"},{"type":"text","value":"β","position":{"start":{"line":531,"column":1},"end":{"line":531,"column":1}},"key":"ZOsqpDRZij"},{"type":"text","value":", is more troubling.","position":{"start":{"line":531,"column":1},"end":{"line":531,"column":1}},"key":"Edrn2NrSSg"}],"key":"xqgoDNDN4D"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"α = 0.3;\nβ = 1e12;\nU = diagm( 0=>ones(5), 1=>[-1, -1, -1, -1] )\nU[1, [4, 5]] = [ α - β, β ]\nb = [α, 0, 0, 0, 1]\n\nx = FNC.backsub(U,b)\nerr = x - x_exact","key":"FK1LX1gSZC"},{"type":"output","id":"MiEgPOzRSuHgPrqu6JFU5","data":[{"output_type":"execute_result","execution_count":49,"metadata":{},"data":{"text/plain":{"content":"5-element Vector{Float64}:\n -4.882812499995559e-5\n  0.0\n  0.0\n  0.0\n  0.0","content_type":"text/plain"}}}],"key":"nRbRdWFGt0"}],"key":"yW3FOGSo18"},{"type":"paragraph","position":{"start":{"line":544,"column":1},"end":{"line":544,"column":1}},"children":[{"type":"text","value":"It’s not so good to get 4 digits of accuracy after starting with 16! The source of the error is not hard to track down. Solving for ","position":{"start":{"line":544,"column":1},"end":{"line":544,"column":1}},"key":"QtVX0W9N6P"},{"type":"inlineMath","value":"x_1","position":{"start":{"line":544,"column":1},"end":{"line":544,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">x_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"yIUIMWxcUY"},{"type":"text","value":" performs ","position":{"start":{"line":544,"column":1},"end":{"line":544,"column":1}},"key":"ZhhwXRhO08"},{"type":"inlineMath","value":"(\\alpha-\\beta)+\\beta","position":{"start":{"line":544,"column":1},"end":{"line":544,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>α</mi><mo>−</mo><mi>β</mi><mo stretchy=\"false\">)</mo><mo>+</mo><mi>β</mi></mrow><annotation encoding=\"application/x-tex\">(\\alpha-\\beta)+\\beta</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05278em;\">β</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05278em;\">β</span></span></span></span>","key":"qBiDLOYivX"},{"type":"text","value":" in the first row. Since ","position":{"start":{"line":544,"column":1},"end":{"line":544,"column":1}},"key":"w7YETxRXLo"},{"type":"inlineMath","value":"|\\alpha|","position":{"start":{"line":544,"column":1},"end":{"line":544,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">∣</mi><mi>α</mi><mi mathvariant=\"normal\">∣</mi></mrow><annotation encoding=\"application/x-tex\">|\\alpha|</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">∣</span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span><span class=\"mord\">∣</span></span></span></span>","key":"UtZjcQyVwh"},{"type":"text","value":" is so much smaller than ","position":{"start":{"line":544,"column":1},"end":{"line":544,"column":1}},"key":"wYevpAvQMg"},{"type":"inlineMath","value":"|\\beta|","position":{"start":{"line":544,"column":1},"end":{"line":544,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">∣</mi><mi>β</mi><mi mathvariant=\"normal\">∣</mi></mrow><annotation encoding=\"application/x-tex\">|\\beta|</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">∣</span><span class=\"mord mathnormal\" style=\"margin-right:0.05278em;\">β</span><span class=\"mord\">∣</span></span></span></span>","key":"ygCXj1FcUO"},{"type":"text","value":", this a recipe for losing digits to subtractive cancellation.","position":{"start":{"line":544,"column":1},"end":{"line":544,"column":1}},"key":"REYWAwpN7n"}],"key":"SG05RYVTfN"}],"label":"demo-systems-triangular-julia","identifier":"demo-systems-triangular-julia","html_id":"demo-systems-triangular-julia","key":"e2srKMfYyT"},{"type":"heading","depth":3,"position":{"start":{"line":546,"column":1},"end":{"line":546,"column":1}},"children":[{"type":"text","value":"2.4 ","position":{"start":{"line":546,"column":1},"end":{"line":546,"column":1}},"key":"RedEnAcBOh"},{"type":"link","identifier":"section-linsys-lu","label":"section-linsys-lu","kind":"narrative","position":{"start":{"line":546,"column":5},"end":{"line":546,"column":23}},"url":"/lu","internal":true,"dataUrl":"/lu.json","children":[{"type":"text","value":"LU factorization","key":"MN4idKXrVU"}],"key":"MjsVAg3xpU"}],"identifier":"id-2-4","label":"2.4 ","html_id":"id-2-4","implicit":true,"key":"sEUpv01Anw"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-lu-outertri","label":"demo-lu-outertri","kind":"proof:example","position":{"start":{"line":548,"column":1},"end":{"line":548,"column":18}},"children":[{"type":"text","value":"Example ","key":"HhsuzCo2ap"},{"type":"text","value":"2.4.2","key":"lhy8tmiHvt"}],"template":"Example %s","enumerator":"2.4.2","resolved":true,"html_id":"demo-lu-outertri","remote":true,"url":"/lu","dataUrl":"/lu.json","key":"pX44yO90tX"}],"key":"iFxpk9KIS7"},{"type":"paragraph","position":{"start":{"line":553,"column":1},"end":{"line":553,"column":1}},"children":[{"type":"text","value":"We explore the outer product formula for two random triangular matrices.","position":{"start":{"line":553,"column":1},"end":{"line":553,"column":1}},"key":"ZbmRzf66Pr"}],"indexEntries":[{"entry":"Julia","subEntry":{"value":"tril","kind":"entry"},"emphasis":false},{"entry":"Julia","subEntry":{"value":"triu","kind":"entry"},"emphasis":false}],"label":"index-VBdYLAlhMt","identifier":"index-vbdylalhmt","html_id":"index-vbdylalhmt","key":"YeqgP3G5n7"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"L = tril( rand(1:9, 3, 3) )","key":"DMosbAS84Z"},{"type":"output","id":"6ziYWDkSg8c7ZqOJzzMUU","data":[{"output_type":"execute_result","execution_count":50,"metadata":{},"data":{"text/plain":{"content":"3×3 Matrix{Int64}:\n 2  0  0\n 4  3  0\n 7  8  5","content_type":"text/plain"}}}],"key":"vaogf8xunS"}],"key":"zxF5JraBA8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"U = triu( rand(1:9, 3, 3) )","key":"HTtZtcmaCY"},{"type":"output","id":"VI4BsD_y_zCprGnfVYoM1","data":[{"output_type":"execute_result","execution_count":51,"metadata":{},"data":{"text/plain":{"content":"3×3 Matrix{Int64}:\n 9  6  9\n 0  4  7\n 0  0  2","content_type":"text/plain"}}}],"key":"rGdrWqqk2c"}],"key":"nndG2XqKo7"},{"type":"paragraph","position":{"start":{"line":563,"column":1},"end":{"line":563,"column":1}},"children":[{"type":"text","value":"Here are the three outer products in the sum in ","position":{"start":{"line":563,"column":1},"end":{"line":563,"column":1}},"key":"Anu7NMP4I2"},{"type":"crossReference","kind":"equation","identifier":"matrixouter","label":"matrixouter","children":[{"type":"text","value":"(","key":"sCH8eHXWwz"},{"type":"text","value":"2.4.4","key":"cWVZ6sWMQh"},{"type":"text","value":")","key":"vJNhpBIfaR"}],"template":"(%s)","enumerator":"2.4.4","resolved":true,"html_id":"matrixouter","remote":true,"url":"/lu","dataUrl":"/lu.json","key":"Bw0N1rVqlq"},{"type":"text","value":":","position":{"start":{"line":563,"column":1},"end":{"line":563,"column":1}},"key":"OdrWANTyCs"}],"key":"oElJCTQyli"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"K7wVOBbyRt"}],"key":"pDWyXSlnYU"},{"type":"paragraph","position":{"start":{"line":566,"column":1},"end":{"line":566,"column":1}},"children":[{"type":"text","value":"Although ","position":{"start":{"line":566,"column":1},"end":{"line":566,"column":1}},"key":"rRuMtnVt2L"},{"type":"inlineCode","value":"U[1,:]","position":{"start":{"line":566,"column":1},"end":{"line":566,"column":1}},"key":"AimNav95oT"},{"type":"text","value":" is a row of ","position":{"start":{"line":566,"column":1},"end":{"line":566,"column":1}},"key":"XLV9A5O3U4"},{"type":"inlineCode","value":"U","position":{"start":{"line":566,"column":1},"end":{"line":566,"column":1}},"key":"WlLO8A4whg"},{"type":"text","value":", it is a vector, and as such it has a default column interpretation.","position":{"start":{"line":566,"column":1},"end":{"line":566,"column":1}},"key":"LAqFcV3Zx5"}],"key":"PHP1erZdTy"}],"class":"dropdown","key":"vDYSPl3zEQ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"L[:, 1] * U[1, :]'","key":"JVT7ripdXH"},{"type":"output","id":"5I1XXRciOPscHrGRrqUFT","data":[{"output_type":"execute_result","execution_count":52,"metadata":{},"data":{"text/plain":{"content":"3×3 Matrix{Int64}:\n 18  12  18\n 36  24  36\n 63  42  63","content_type":"text/plain"}}}],"key":"h2iPzDkClf"}],"key":"mj3qcNezQ7"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"L[:, 2] * U[2, :]'","key":"yu6tfHwfWj"},{"type":"output","id":"MPzSCJ1B-MTyY5P0NuK_N","data":[{"output_type":"execute_result","execution_count":53,"metadata":{},"data":{"text/plain":{"content":"3×3 Matrix{Int64}:\n 0   0   0\n 0  12  21\n 0  32  56","content_type":"text/plain"}}}],"key":"aUed4PHcCN"}],"key":"HO1aXrtkom"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"L[:, 3] * U[3, :]'","key":"uJh3jYNI4y"},{"type":"output","id":"-Cs85Pc4dhKasR44Hhka0","data":[{"output_type":"execute_result","execution_count":54,"metadata":{},"data":{"text/plain":{"content":"3×3 Matrix{Int64}:\n 0  0   0\n 0  0   0\n 0  0  10","content_type":"text/plain"}}}],"key":"ax29MRxSLd"}],"key":"Gbpov0aPRs"},{"type":"paragraph","position":{"start":{"line":581,"column":1},"end":{"line":581,"column":1}},"children":[{"type":"text","value":"Simply because of the triangular zero structures, only the first outer product contributes to the first row and first column of the entire product.","position":{"start":{"line":581,"column":1},"end":{"line":581,"column":1}},"key":"IVDcKmjVA0"}],"key":"tRxBUcFk7Y"}],"label":"demo-lu-outertri-julia","identifier":"demo-lu-outertri-julia","html_id":"demo-lu-outertri-julia","key":"RjJR1N8Qd3"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-lu-derive","label":"demo-lu-derive","kind":"proof:example","position":{"start":{"line":585,"column":1},"end":{"line":585,"column":16}},"children":[{"type":"text","value":"Example ","key":"ujaGuKNxUH"},{"type":"text","value":"2.4.3","key":"UOidbMkH1J"}],"template":"Example %s","enumerator":"2.4.3","resolved":true,"html_id":"demo-lu-derive","remote":true,"url":"/lu","dataUrl":"/lu.json","key":"K32kxB1HU3"}],"key":"IOczhQSXBo"},{"type":"paragraph","position":{"start":{"line":587,"column":1},"end":{"line":587,"column":1}},"children":[{"type":"text","value":"For illustration, we work on a ","position":{"start":{"line":587,"column":1},"end":{"line":587,"column":1}},"key":"Wa1Wmud2bS"},{"type":"inlineMath","value":"4 \\times 4","position":{"start":{"line":587,"column":1},"end":{"line":587,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>4</mn><mo>×</mo><mn>4</mn></mrow><annotation encoding=\"application/x-tex\">4 \\times 4</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">4</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">4</span></span></span></span>","key":"X88le4jn7k"},{"type":"text","value":" matrix. We name it with a subscript in preparation for what comes.","position":{"start":{"line":587,"column":1},"end":{"line":587,"column":1}},"key":"sgCDOkyaVu"}],"key":"NJwA1Ys79c"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"A₁ = [\n     2    0    4     3 \n    -4    5   -7   -10 \n     1   15    2   -4.5\n    -2    0    2   -13\n    ];\nL = diagm(ones(4))\nU = zeros(4, 4);","key":"omDBj13q0x"},{"type":"output","id":"QtHtQv58U7-d6DU3r6sSB","data":[],"key":"rj2Ig7iK5w"}],"key":"mWyrCgv0uF"},{"type":"paragraph","position":{"start":{"line":600,"column":1},"end":{"line":600,"column":1}},"children":[{"type":"text","value":"Now we appeal to ","position":{"start":{"line":600,"column":1},"end":{"line":600,"column":1}},"key":"fl9wK9WR8o"},{"type":"crossReference","kind":"equation","identifier":"outer-row1","label":"outer-row1","children":[{"type":"text","value":"(","key":"dpNNuxABgI"},{"type":"text","value":"2.4.5","key":"LEsFpfVzqv"},{"type":"text","value":")","key":"PMMQaSURU6"}],"template":"(%s)","enumerator":"2.4.5","resolved":true,"html_id":"outer-row1","remote":true,"url":"/lu","dataUrl":"/lu.json","key":"kVwQCZQAvO"},{"type":"text","value":". Since ","position":{"start":{"line":600,"column":1},"end":{"line":600,"column":1}},"key":"P2jDsEDj5T"},{"type":"inlineMath","value":"L_{11}=1","position":{"start":{"line":600,"column":1},"end":{"line":600,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>L</mi><mn>11</mn></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">L_{11}=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">L</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">11</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"YfszQV8cDs"},{"type":"text","value":", we see that the first row of ","position":{"start":{"line":600,"column":1},"end":{"line":600,"column":1}},"key":"Hmm0MOy7C0"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":600,"column":1},"end":{"line":600,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"f0wC9K7KUm"},{"type":"text","value":" is just the first row of ","position":{"start":{"line":600,"column":1},"end":{"line":600,"column":1}},"key":"Kgo63VZn1w"},{"type":"inlineMath","value":"\\mathbf{A}_1","position":{"start":{"line":600,"column":1},"end":{"line":600,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">A</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8361em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"V1gkB9uOZq"},{"type":"text","value":".","position":{"start":{"line":600,"column":1},"end":{"line":600,"column":1}},"key":"LtL4u4dNWx"}],"key":"mBr3rc1MqB"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"U[1, :] = A₁[1, :]\nU","key":"BavXtEzppj"},{"type":"output","id":"upUUQOKtKhBt0UKGalQzT","data":[{"output_type":"execute_result","execution_count":56,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n 2.0  0.0  4.0  3.0\n 0.0  0.0  0.0  0.0\n 0.0  0.0  0.0  0.0\n 0.0  0.0  0.0  0.0","content_type":"text/plain"}}}],"key":"x8nQkJJa8R"}],"key":"l6DpheeDUt"},{"type":"paragraph","position":{"start":{"line":607,"column":1},"end":{"line":607,"column":1}},"children":[{"type":"text","value":"From ","position":{"start":{"line":607,"column":1},"end":{"line":607,"column":1}},"key":"ICK8zj39Vu"},{"type":"crossReference","kind":"equation","identifier":"outer-col1","label":"outer-col1","children":[{"type":"text","value":"(","key":"u4CUnc42SU"},{"type":"text","value":"2.4.6","key":"zHti7ilTJx"},{"type":"text","value":")","key":"L2YDUMu7Wn"}],"template":"(%s)","enumerator":"2.4.6","resolved":true,"html_id":"outer-col1","remote":true,"url":"/lu","dataUrl":"/lu.json","key":"FT2fEeiwMp"},{"type":"text","value":", we see that we can find the first column of ","position":{"start":{"line":607,"column":1},"end":{"line":607,"column":1}},"key":"Z66zrrxrAW"},{"type":"inlineMath","value":"\\mathbf{L}","position":{"start":{"line":607,"column":1},"end":{"line":607,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">L</span></span></span></span>","key":"oSGX715ZVT"},{"type":"text","value":" from the first column of ","position":{"start":{"line":607,"column":1},"end":{"line":607,"column":1}},"key":"q25rxCswPe"},{"type":"inlineMath","value":"\\mathbf{A}_1","position":{"start":{"line":607,"column":1},"end":{"line":607,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">A</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8361em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"KzjmvX01oK"},{"type":"text","value":".","position":{"start":{"line":607,"column":1},"end":{"line":607,"column":1}},"key":"gIgenrSXIE"}],"key":"OBGCSiPCYR"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"L[:, 1] = A₁[:, 1] / U[1, 1]\nL","key":"T9FsnhcTgm"},{"type":"output","id":"13DtaHoiVZFfB6OT_9DZ-","data":[{"output_type":"execute_result","execution_count":57,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n  1.0  0.0  0.0  0.0\n -2.0  1.0  0.0  0.0\n  0.5  0.0  1.0  0.0\n -1.0  0.0  0.0  1.0","content_type":"text/plain"}}}],"key":"F0x9uutuRd"}],"key":"tGOC8n41Sc"},{"type":"paragraph","position":{"start":{"line":614,"column":1},"end":{"line":614,"column":1}},"children":[{"type":"text","value":"We have obtained the first term in the sum ","position":{"start":{"line":614,"column":1},"end":{"line":614,"column":1}},"key":"uxZ2yAQDNj"},{"type":"crossReference","kind":"equation","identifier":"matrixouter","label":"matrixouter","children":[{"type":"text","value":"(","key":"fYj53CeVMY"},{"type":"text","value":"2.4.4","key":"kUwDFRx3V4"},{"type":"text","value":")","key":"gqj1OKAAYE"}],"template":"(%s)","enumerator":"2.4.4","resolved":true,"html_id":"matrixouter","remote":true,"url":"/lu","dataUrl":"/lu.json","key":"TuhDvFLVFv"},{"type":"text","value":" for ","position":{"start":{"line":614,"column":1},"end":{"line":614,"column":1}},"key":"qMD5iJhc09"},{"type":"inlineMath","value":"\\mathbf{L}\\mathbf{U}","position":{"start":{"line":614,"column":1},"end":{"line":614,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">LU</span></span></span></span>","key":"Q5rscOFmAy"},{"type":"text","value":", and we subtract it away from ","position":{"start":{"line":614,"column":1},"end":{"line":614,"column":1}},"key":"UnIYpc88Uv"},{"type":"inlineMath","value":"\\mathbf{A}_1","position":{"start":{"line":614,"column":1},"end":{"line":614,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">A</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8361em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"vuKyUtpDLk"},{"type":"text","value":".","position":{"start":{"line":614,"column":1},"end":{"line":614,"column":1}},"key":"AjtX0A82cJ"}],"key":"GNhGgq2jKm"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"A₂ = A₁ - L[:, 1] * U[1, :]'","key":"iXwPLDO1lL"},{"type":"output","id":"v-aSYJelWiJ5YJzSaoo2f","data":[{"output_type":"execute_result","execution_count":58,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n 0.0   0.0  0.0    0.0\n 0.0   5.0  1.0   -4.0\n 0.0  15.0  0.0   -6.0\n 0.0   0.0  6.0  -10.0","content_type":"text/plain"}}}],"key":"q3s9xpp9dL"}],"key":"LjQd5Im5R1"},{"type":"paragraph","position":{"start":{"line":620,"column":1},"end":{"line":620,"column":1}},"children":[{"type":"text","value":"Now ","position":{"start":{"line":620,"column":1},"end":{"line":620,"column":1}},"key":"hTHlRzrNxK"},{"type":"inlineMath","value":"\\mathbf{A}_2 = \\boldsymbol{\\ell}_2\\mathbf{u}_2^T + \\boldsymbol{\\ell}_3\\mathbf{u}_3^T + \\boldsymbol{\\ell}_4\\mathbf{u}_4^T.","position":{"start":{"line":620,"column":1},"end":{"line":620,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">A</mi><mn>2</mn></msub><mo>=</mo><msub><mi mathvariant=\"bold\">ℓ</mi><mn>2</mn></msub><msubsup><mi mathvariant=\"bold\">u</mi><mn>2</mn><mi>T</mi></msubsup><mo>+</mo><msub><mi mathvariant=\"bold\">ℓ</mi><mn>3</mn></msub><msubsup><mi mathvariant=\"bold\">u</mi><mn>3</mn><mi>T</mi></msubsup><mo>+</mo><msub><mi mathvariant=\"bold\">ℓ</mi><mn>4</mn></msub><msubsup><mi mathvariant=\"bold\">u</mi><mn>4</mn><mi>T</mi></msubsup><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}_2 = \\boldsymbol{\\ell}_2\\mathbf{u}_2^T + \\boldsymbol{\\ell}_3\\mathbf{u}_3^T + \\boldsymbol{\\ell}_4\\mathbf{u}_4^T.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8361em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0894em;vertical-align:-0.2481em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">ℓ</span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathbf\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-2.4519em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2481em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0894em;vertical-align:-0.2481em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">ℓ</span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathbf\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-2.4519em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2481em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0894em;vertical-align:-0.2481em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">ℓ</span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">4</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathbf\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-2.4519em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">4</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2481em;\"><span></span></span></span></span></span></span><span class=\"mord\">.</span></span></span></span>","key":"PB38AgllWS"},{"type":"text","value":" If we ignore the first row and first column of the matrices in this equation, then in what remains we are in the same situation as at the start. Specifically, only ","position":{"start":{"line":620,"column":1},"end":{"line":620,"column":1}},"key":"T5VEdrReY2"},{"type":"inlineMath","value":"\\boldsymbol{\\ell}_2\\mathbf{u}_2^T","position":{"start":{"line":620,"column":1},"end":{"line":620,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">ℓ</mi><mn>2</mn></msub><msubsup><mi mathvariant=\"bold\">u</mi><mn>2</mn><mi>T</mi></msubsup></mrow><annotation encoding=\"application/x-tex\">\\boldsymbol{\\ell}_2\\mathbf{u}_2^T</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0894em;vertical-align:-0.2481em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">ℓ</span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathbf\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-2.4519em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2481em;\"><span></span></span></span></span></span></span></span></span></span>","key":"KBcbm08IJr"},{"type":"text","value":" has any effect on the second row and column, so we can deduce them now.","position":{"start":{"line":620,"column":1},"end":{"line":620,"column":1}},"key":"TQUziqcKcq"}],"key":"Gclg611XCm"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"U[2, :] = A₂[2, :]\nL[:, 2] = A₂[:, 2] / U[2, 2]\nL","key":"hGgUjytH95"},{"type":"output","id":"6SxSSN5BVeBCPp-gE_cGn","data":[{"output_type":"execute_result","execution_count":59,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n  1.0  0.0  0.0  0.0\n -2.0  1.0  0.0  0.0\n  0.5  3.0  1.0  0.0\n -1.0  0.0  0.0  1.0","content_type":"text/plain"}}}],"key":"WIX684lx50"}],"key":"CMDV8cQoLi"},{"type":"paragraph","position":{"start":{"line":628,"column":1},"end":{"line":628,"column":1}},"children":[{"type":"text","value":"If we subtract off the latest outer product, we have a matrix that is zero in the first ","position":{"start":{"line":628,"column":1},"end":{"line":628,"column":1}},"key":"OxqcR03Skz"},{"type":"emphasis","position":{"start":{"line":628,"column":1},"end":{"line":628,"column":1}},"children":[{"type":"text","value":"two","position":{"start":{"line":628,"column":1},"end":{"line":628,"column":1}},"key":"zAiQPEWs6U"}],"key":"aSgtcfNd9u"},{"type":"text","value":" rows and columns.","position":{"start":{"line":628,"column":1},"end":{"line":628,"column":1}},"key":"kTESdtcj4Z"}],"key":"FbU2ZjerCx"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"A₃ = A₂ - L[:, 2] * U[2, :]'","key":"c9Lh9a5QOs"},{"type":"output","id":"kbMvrg28QTH51fyEr5ul6","data":[{"output_type":"execute_result","execution_count":60,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n 0.0  0.0   0.0    0.0\n 0.0  0.0   0.0    0.0\n 0.0  0.0  -3.0    6.0\n 0.0  0.0   6.0  -10.0","content_type":"text/plain"}}}],"key":"JpQSzQcrX7"}],"key":"TltwiLhksH"},{"type":"paragraph","position":{"start":{"line":634,"column":1},"end":{"line":634,"column":1}},"children":[{"type":"text","value":"Now we can deal with the lower right ","position":{"start":{"line":634,"column":1},"end":{"line":634,"column":1}},"key":"bsy2mouObv"},{"type":"inlineMath","value":"2\\times 2","position":{"start":{"line":634,"column":1},"end":{"line":634,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>2</mn><mo>×</mo><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">2\\times 2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">2</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span></span></span></span>","key":"IaFLTT5WXN"},{"type":"text","value":" submatrix of the remainder in a similar fashion.","position":{"start":{"line":634,"column":1},"end":{"line":634,"column":1}},"key":"RFSdEhDuB8"}],"key":"csdqVeVoPe"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"U[3, :] = A₃[3, :]\nL[:, 3] = A₃[:, 3] / U[3, 3]\nA₄ = A₃ - L[:, 3] * U[3, :]'","key":"x9ljGpUjSg"},{"type":"output","id":"TPVYhcfDPSj2Sxs3DWCB-","data":[{"output_type":"execute_result","execution_count":61,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n 0.0  0.0  0.0  0.0\n 0.0  0.0  0.0  0.0\n 0.0  0.0  0.0  0.0\n 0.0  0.0  0.0  2.0","content_type":"text/plain"}}}],"key":"TsPJFP2tie"}],"key":"spcgXeThzy"},{"type":"paragraph","position":{"start":{"line":642,"column":1},"end":{"line":642,"column":1}},"children":[{"type":"text","value":"Finally, we pick up the last unknown in the factors.","position":{"start":{"line":642,"column":1},"end":{"line":642,"column":1}},"key":"wIjgSJokVT"}],"key":"pgb94n2Ly6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"U[4, 4] = A₄[4, 4];","key":"zKm1gqFy2Z"},{"type":"output","id":"T-SyyqVCcppuH5FDklCNs","data":[],"key":"NXDUsvD1G4"}],"key":"crfEeJEmSX"},{"type":"paragraph","position":{"start":{"line":648,"column":1},"end":{"line":648,"column":1}},"children":[{"type":"text","value":"We now have all of ","position":{"start":{"line":648,"column":1},"end":{"line":648,"column":1}},"key":"sizE6jv2JZ"},{"type":"inlineMath","value":"\\mathbf{L}","position":{"start":{"line":648,"column":1},"end":{"line":648,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">L</span></span></span></span>","key":"XtjTIDjtPM"},{"type":"text","value":",","position":{"start":{"line":648,"column":1},"end":{"line":648,"column":1}},"key":"jlktlzDWXw"}],"key":"SR2TFjKXHW"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"L","key":"kYSQ6tNWn0"},{"type":"output","id":"QMS0dEnlLa5pnPCNQ40sg","data":[{"output_type":"execute_result","execution_count":63,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n  1.0  0.0  -0.0  0.0\n -2.0  1.0  -0.0  0.0\n  0.5  3.0   1.0  0.0\n -1.0  0.0  -2.0  1.0","content_type":"text/plain"}}}],"key":"tas58Pq0QW"}],"key":"XQZJu5oX1x"},{"type":"paragraph","position":{"start":{"line":654,"column":1},"end":{"line":654,"column":1}},"children":[{"type":"text","value":"and all of ","position":{"start":{"line":654,"column":1},"end":{"line":654,"column":1}},"key":"nMuRminc2n"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":654,"column":1},"end":{"line":654,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"EGhAhgK1Xh"},{"type":"text","value":",","position":{"start":{"line":654,"column":1},"end":{"line":654,"column":1}},"key":"lHnc4Jv4Uk"}],"key":"efuNaQ03MX"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"U","key":"qYqaUghA1l"},{"type":"output","id":"FS6IofK74q1qHLehp6gBh","data":[{"output_type":"execute_result","execution_count":64,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n 2.0  0.0   4.0   3.0\n 0.0  5.0   1.0  -4.0\n 0.0  0.0  -3.0   6.0\n 0.0  0.0   0.0   2.0","content_type":"text/plain"}}}],"key":"TvJaQzAprK"}],"key":"X6x4zDuYLt"},{"type":"paragraph","position":{"start":{"line":660,"column":1},"end":{"line":660,"column":1}},"children":[{"type":"text","value":"We can verify that we have a correct factorization of the original matrix by computing the backward error:","position":{"start":{"line":660,"column":1},"end":{"line":660,"column":1}},"key":"rvdFysUX62"}],"key":"GQuOYBm8GO"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"A₁ - L * U","key":"SxobiDTeLG"},{"type":"output","id":"AgXuMq5hathUfNPjy46gY","data":[{"output_type":"execute_result","execution_count":65,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n 0.0  0.0  0.0  0.0\n 0.0  0.0  0.0  0.0\n 0.0  0.0  0.0  0.0\n 0.0  0.0  0.0  0.0","content_type":"text/plain"}}}],"key":"dcC2iLm0sj"}],"key":"efCO2E7afX"},{"type":"paragraph","position":{"start":{"line":666,"column":1},"end":{"line":666,"column":1}},"children":[{"type":"text","value":"IIn floating point, we cannot expect the difference to be exactly zero as we found in this toy example. Instead, we would be satisfied to see that each element of the difference above is comparable in size to machine precision.","position":{"start":{"line":666,"column":1},"end":{"line":666,"column":1}},"key":"O16aJdJ8eI"}],"key":"ZcsMX4Sl6x"}],"label":"demo-lu-derive-julia","identifier":"demo-lu-derive-julia","html_id":"demo-lu-derive-julia","key":"m84zT3mDNC"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-lu-solve","label":"demo-lu-solve","kind":"proof:example","position":{"start":{"line":671,"column":1},"end":{"line":671,"column":15}},"children":[{"type":"text","value":"Example ","key":"f1reSDxlzk"},{"type":"text","value":"2.4.4","key":"NhH5tslMvd"}],"template":"Example %s","enumerator":"2.4.4","resolved":true,"html_id":"demo-lu-solve","remote":true,"url":"/lu","dataUrl":"/lu.json","key":"oZ16XuHrFY"}],"key":"hRSD4hnmzm"},{"type":"paragraph","position":{"start":{"line":673,"column":1},"end":{"line":673,"column":1}},"children":[{"type":"text","value":"Here are the data for a linear system ","position":{"start":{"line":673,"column":1},"end":{"line":673,"column":1}},"key":"yvtcDmsSk4"},{"type":"inlineMath","value":"\\mathbf{A}\\mathbf{x}=\\mathbf{b}","position":{"start":{"line":673,"column":1},"end":{"line":673,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi><mi mathvariant=\"bold\">x</mi><mo>=</mo><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}\\mathbf{x}=\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">Ax</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"aubhtqqCbl"},{"type":"text","value":".","position":{"start":{"line":673,"column":1},"end":{"line":673,"column":1}},"key":"GArtXDj86R"}],"key":"SWjKkk5J99"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"A = [2 0 4 3; -4 5 -7 -10; 1 15 2 -4.5; -2 0 2 -13];\nb = [4,9,9,4];","key":"bLdCZPabWj"},{"type":"output","id":"hHSimYOO09qej1PvwgrdT","data":[],"key":"hR22gqA0O4"}],"key":"ltmZCUWjdx"},{"type":"paragraph","position":{"start":{"line":680,"column":1},"end":{"line":680,"column":1}},"children":[{"type":"text","value":"We apply ","position":{"start":{"line":680,"column":1},"end":{"line":680,"column":1}},"key":"uQ9dajFD5f"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-lufact","label":"function-lufact","children":[{"type":"text","value":"Function ","key":"ae15TJvWAt"},{"type":"text","value":"2.4.1","key":"fWxL00jpZN"}],"template":"Algorithm %s","enumerator":"2.4.1","resolved":true,"html_id":"function-lufact","remote":true,"url":"/lu","dataUrl":"/lu.json","key":"jZuNECqE4a"},{"type":"text","value":" and then do two triangular solves.","position":{"start":{"line":680,"column":1},"end":{"line":680,"column":1}},"key":"dAnBa6JuLN"}],"key":"aEJamFjR0C"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"L, U = FNC.lufact(A)\nz = FNC.forwardsub(L, b)\nx = FNC.backsub(U, z)","key":"isVLAWToSU"},{"type":"output","id":"LB_O1TI9HBGPjZltqC-JS","data":[{"output_type":"execute_result","execution_count":67,"metadata":{},"data":{"text/plain":{"content":"4-element Vector{Float64}:\n 192.66666666666666\n -15.533333333333335\n -65.33333333333333\n -40.0","content_type":"text/plain"}}}],"key":"nOuFpFLTfH"}],"key":"Mo4nhBJpOI"},{"type":"paragraph","position":{"start":{"line":688,"column":1},"end":{"line":688,"column":1}},"children":[{"type":"text","value":"A check on the residual assures us that we found the solution.","position":{"start":{"line":688,"column":1},"end":{"line":688,"column":1}},"key":"V51auDtMXg"}],"key":"ErW0wwSFsY"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"b - A*x","key":"radpvmTZAU"},{"type":"output","id":"NMbprakjSlYknqHNllZlo","data":[{"output_type":"execute_result","execution_count":68,"metadata":{},"data":{"text/plain":{"content":"4-element Vector{Float64}:\n  0.0\n -5.684341886080802e-14\n  2.842170943040401e-14\n  0.0","content_type":"text/plain"}}}],"key":"UrzqoPwrz9"}],"key":"WUmj17hE4Z"}],"label":"demo-lu-solve-julia","identifier":"demo-lu-solve-julia","html_id":"demo-lu-solve-julia","key":"mAX2fyt2Vp"},{"type":"heading","depth":3,"position":{"start":{"line":695,"column":1},"end":{"line":695,"column":1}},"children":[{"type":"text","value":"2.5 ","position":{"start":{"line":695,"column":1},"end":{"line":695,"column":1}},"key":"ThyJmVQr6a"},{"type":"link","identifier":"section-linsys-efficiency","label":"section-linsys-efficiency","kind":"narrative","position":{"start":{"line":695,"column":5},"end":{"line":695,"column":31}},"url":"/efficiency","internal":true,"dataUrl":"/efficiency.json","children":[{"type":"text","value":"Efficiency of matrix computations","key":"B4pgY7GMvh"}],"key":"KNw60HCIGp"}],"identifier":"id-2-5","label":"2.5 ","html_id":"id-2-5","implicit":true,"key":"nN14fnGPnY"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-flops-mvmult","label":"demo-flops-mvmult","kind":"proof:example","position":{"start":{"line":698,"column":1},"end":{"line":698,"column":19}},"children":[{"type":"text","value":"Example ","key":"a91APcBkrj"},{"type":"text","value":"2.5.4","key":"SrcfmLLplL"}],"template":"Example %s","enumerator":"2.5.4","resolved":true,"html_id":"demo-flops-mvmult","remote":true,"url":"/efficiency","dataUrl":"/efficiency.json","key":"ZqUwDBOuLS"}],"key":"LsQbkluNJ3"},{"type":"paragraph","position":{"start":{"line":700,"column":1},"end":{"line":700,"column":1}},"children":[{"type":"text","value":"Here is a straightforward implementation of matrix-vector multiplication.","position":{"start":{"line":700,"column":1},"end":{"line":700,"column":1}},"key":"o56tngrN1L"}],"key":"fhbhMtZ68M"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"n = 6\nA = randn(n, n)\nx = rand(n)\ny = zeros(n)\nfor i in 1:n\n    for j in 1:n\n        y[i] += A[i, j] * x[j]    # 1 multiply, 1 add\n    end\nend","key":"N3s8rmn3Wh"},{"type":"output","id":"cuQv0PVyw1Opr2V9Bit7c","data":[],"key":"JEXhBi3FjY"}],"key":"S1yaWM8OG9"},{"type":"paragraph","position":{"start":{"line":714,"column":1},"end":{"line":714,"column":1}},"children":[{"type":"text","value":"Each of the loops implies a summation of flops. The total flop count for this algorithm is","position":{"start":{"line":714,"column":1},"end":{"line":714,"column":1}},"key":"tWhaEWEqLN"}],"key":"TiDsEaEa5I"},{"type":"math","value":"\\sum_{i=1}^n \\sum_{j=1}^n 2 = \\sum_{i=1}^n 2n = 2n^2.","position":{"start":{"line":716,"column":1},"end":{"line":716,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mn>2</mn><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mn>2</mn><mi>n</mi><mo>=</mo><mn>2</mn><msup><mi>n</mi><mn>2</mn></msup><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">\\sum_{i=1}^n \\sum_{j=1}^n 2 = \\sum_{i=1}^n 2n = 2n^2.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:3.0652em;vertical-align:-1.4138em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.6514em;\"><span style=\"top:-1.8723em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span><span style=\"top:-4.3em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.2777em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.6514em;\"><span style=\"top:-1.8723em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span><span style=\"top:-4.3em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.4138em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">2</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.9291em;vertical-align:-1.2777em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.6514em;\"><span style=\"top:-1.8723em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span><span style=\"top:-4.3em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.2777em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">2</span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8641em;\"></span><span class=\"mord\">2</span><span class=\"mord\"><span class=\"mord mathnormal\">n</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mord\">.</span></span></span></span></span>","enumerator":"1","key":"XvnbBwqQRs"},{"type":"paragraph","position":{"start":{"line":718,"column":1},"end":{"line":718,"column":1}},"children":[{"type":"text","value":"Since the matrix ","position":{"start":{"line":718,"column":1},"end":{"line":718,"column":1}},"key":"mJYPlTBa65"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":718,"column":1},"end":{"line":718,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"XobJ8ANRwp"},{"type":"text","value":" has ","position":{"start":{"line":718,"column":1},"end":{"line":718,"column":1}},"key":"tFt7LHb5uN"},{"type":"inlineMath","value":"n^2","position":{"start":{"line":718,"column":1},"end":{"line":718,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>n</mi><mn>2</mn></msup></mrow><annotation encoding=\"application/x-tex\">n^2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">n</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span>","key":"dxRW4rPc3n"},{"type":"text","value":" elements, all of which have to be involved in the product, it seems unlikely that we could get a flop count that is smaller than ","position":{"start":{"line":718,"column":1},"end":{"line":718,"column":1}},"key":"f4ioqF2W5S"},{"type":"inlineMath","value":"O(n^2)","position":{"start":{"line":718,"column":1},"end":{"line":718,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(n^2)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">n</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"vkjeb0uBTT"},{"type":"text","value":" in general.","position":{"start":{"line":718,"column":1},"end":{"line":718,"column":1}},"key":"BWGZXzcJgy"}],"key":"J8boJ6CjTo"},{"type":"paragraph","position":{"start":{"line":723,"column":1},"end":{"line":723,"column":1}},"children":[{"type":"text","value":"Let’s run an experiment with the built-in matrix-vector multiplication. Note that Julia is unusual in that loops have a variable scope separate from its enclosing code. Thus, ","position":{"start":{"line":723,"column":1},"end":{"line":723,"column":1}},"key":"CeK28tVM1H"},{"type":"inlineCode","value":"for n in n","position":{"start":{"line":723,"column":1},"end":{"line":723,"column":1}},"key":"E7d7q2KjVu"},{"type":"text","value":" below means that inside the loop, the name ","position":{"start":{"line":723,"column":1},"end":{"line":723,"column":1}},"key":"H17TNYthBq"},{"type":"inlineCode","value":"n","position":{"start":{"line":723,"column":1},"end":{"line":723,"column":1}},"key":"kc4Qk4kuYl"},{"type":"text","value":" will take on each one of the values that were previously assigned to the vector ","position":{"start":{"line":723,"column":1},"end":{"line":723,"column":1}},"key":"Jeh8TmCgyh"},{"type":"inlineCode","value":"n","position":{"start":{"line":723,"column":1},"end":{"line":723,"column":1}},"key":"LLjUaHwzh6"},{"type":"text","value":".","position":{"start":{"line":723,"column":1},"end":{"line":723,"column":1}},"key":"gSDbGtNa7f"}],"indexEntries":[{"entry":"Julia","subEntry":{"value":"push\\!","kind":"entry"},"emphasis":true},{"entry":"Julia","subEntry":{"value":"for","kind":"entry"},"emphasis":true}],"label":"index-sFGW5QqU7S","identifier":"index-sfgw5qqu7s","html_id":"index-sfgw5qqu7s","key":"GSF5XH8GWX"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"XrDZDORdlN"}],"key":"Dl791REsj2"},{"type":"paragraph","position":{"start":{"line":726,"column":1},"end":{"line":726,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":726,"column":1},"end":{"line":726,"column":1}},"key":"R9UuXwvomf"},{"type":"inlineCode","value":"push!","position":{"start":{"line":726,"column":1},"end":{"line":726,"column":1}},"key":"hiBV4VbpFy"},{"type":"text","value":" function attaches a new value to the end of a vector.","position":{"start":{"line":726,"column":1},"end":{"line":726,"column":1}},"key":"tfniYDaBLI"}],"key":"ZE3zXQQejP"}],"class":"dropdown","key":"CcjBcz6ITX"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"n = 1000:1000:5000\nt = []\nfor n in n\n    A = randn(n, n)  \n    x = randn(n)\n    time = @elapsed for j in 1:80; A * x; end\n    push!(t, time)\nend","key":"koa4WofkeY"},{"type":"output","id":"QyOl_n3aLQV4S96KMB6vT","data":[],"key":"qaWc62DJ3G"}],"key":"yKYc7j2MSD"},{"type":"paragraph","position":{"start":{"line":740,"column":1},"end":{"line":740,"column":1}},"children":[{"type":"text","value":"The reason for doing multiple repetitions at each value of ","position":{"start":{"line":740,"column":1},"end":{"line":740,"column":1}},"key":"fuiVMOta4c"},{"type":"inlineMath","value":"n","position":{"start":{"line":740,"column":1},"end":{"line":740,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"mUsIrrJaB3"},{"type":"text","value":" in the loop above is to avoid having times so short that the resolution of the timer is significant.","position":{"start":{"line":740,"column":1},"end":{"line":740,"column":1}},"key":"GG0OVeZRtD"}],"key":"OZWwGi5CkF"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"@pt :header = [\"size\", \"time (sec.)\"] [n t]","key":"xMEQXGdgDb"},{"type":"output","id":"e3HtEkoMeDvJekFMgcCJq","data":[{"output_type":"display_data","metadata":{},"data":{"text/html":{"content":"<table>\n  <thead>\n    <tr class = \"header headerLastRow\">\n      <th style = \"text-align: right;\">size</th>\n      <th style = \"text-align: right;\">time (sec.)</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td style = \"text-align: right;\">1000</td>\n      <td style = \"text-align: right;\">0.00811133</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">2000</td>\n      <td style = \"text-align: right;\">0.0395782</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">3000</td>\n      <td style = \"text-align: right;\">0.0677195</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">4000</td>\n      <td style = \"text-align: right;\">0.111539</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">5000</td>\n      <td style = \"text-align: right;\">0.164734</td>\n    </tr>\n  </tbody>\n</table>\n","content_type":"text/html"}}}],"key":"kB6w1hi9CX"}],"key":"aDpxufu8mN"},{"type":"paragraph","position":{"start":{"line":749,"column":1},"end":{"line":749,"column":1}},"children":[{"type":"text","value":"Looking at the timings just for ","position":{"start":{"line":749,"column":1},"end":{"line":749,"column":1}},"key":"W97P0tAK97"},{"type":"inlineMath","value":"n=2000","position":{"start":{"line":749,"column":1},"end":{"line":749,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>=</mo><mn>2000</mn></mrow><annotation encoding=\"application/x-tex\">n=2000</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2000</span></span></span></span>","key":"Oo8Xs5qFO2"},{"type":"text","value":" and ","position":{"start":{"line":749,"column":1},"end":{"line":749,"column":1}},"key":"S8KJPXfRxP"},{"type":"inlineMath","value":"n=4000","position":{"start":{"line":749,"column":1},"end":{"line":749,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>=</mo><mn>4000</mn></mrow><annotation encoding=\"application/x-tex\">n=4000</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">4000</span></span></span></span>","key":"SlyzfogWUv"},{"type":"text","value":", they have ratio","position":{"start":{"line":749,"column":1},"end":{"line":749,"column":1}},"key":"ktWAvmn868"}],"indexEntries":[{"entry":"Julia","subEntry":{"value":"Boolean indexing","kind":"entry"},"emphasis":false}],"label":"index-BsG38yuft0","identifier":"index-bsg38yuft0","html_id":"index-bsg38yuft0","key":"iW6wbNqbp1"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"VQWYDUoHoO"}],"key":"hpRm4fkNUV"},{"type":"paragraph","position":{"start":{"line":752,"column":1},"end":{"line":752,"column":1}},"children":[{"type":"text","value":"The expression ","position":{"start":{"line":752,"column":1},"end":{"line":752,"column":1}},"key":"CPj9hAvZOW"},{"type":"inlineCode","value":"n.==4000","position":{"start":{"line":752,"column":1},"end":{"line":752,"column":1}},"key":"Fg43FvUwNP"},{"type":"text","value":" here produces a vector of Boolean (true/false) values the same size as ","position":{"start":{"line":752,"column":1},"end":{"line":752,"column":1}},"key":"T62OEnWDXW"},{"type":"inlineCode","value":"n","position":{"start":{"line":752,"column":1},"end":{"line":752,"column":1}},"key":"qfoeuhU1r9"},{"type":"text","value":". This result is used to index within ","position":{"start":{"line":752,"column":1},"end":{"line":752,"column":1}},"key":"D22hGPxmcZ"},{"type":"inlineCode","value":"t","position":{"start":{"line":752,"column":1},"end":{"line":752,"column":1}},"key":"BKiLhqcyQT"},{"type":"text","value":", accessing only the value for which the comparison is true.","position":{"start":{"line":752,"column":1},"end":{"line":752,"column":1}},"key":"sH95eKJA8X"}],"key":"b2laiiaXJ7"}],"class":"dropdown","key":"UjnYpuXlVP"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"@show t[n.==4000] ./ t[n.==2000];","key":"N3bKilUdqr"},{"type":"output","id":"y-pFTF4EuSmDgsYatxMkH","data":[{"output_type":"stream","name":"stdout","text":"t[n .== 4000] ./ t[n .== 2000] = [2.8181890443804565]"},{"output_type":"stream","name":"stdout","text":"\n"}],"key":"UG8ljXMKCS"}],"key":"cOx2K1pePw"},{"type":"paragraph","position":{"start":{"line":759,"column":1},"end":{"line":759,"column":1}},"children":[{"type":"text","value":"If the run time is dominated by flops, then we expect this ratio to be","position":{"start":{"line":759,"column":1},"end":{"line":759,"column":1}},"key":"sHor1Dtkh1"}],"key":"orsbAHugmx"},{"type":"math","value":"\\frac{2(4000)^2}{2(2000)^2}=4.","position":{"start":{"line":761,"column":1},"end":{"line":763,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mfrac><mrow><mn>2</mn><mo stretchy=\"false\">(</mo><mn>4000</mn><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup></mrow><mrow><mn>2</mn><mo stretchy=\"false\">(</mo><mn>2000</mn><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup></mrow></mfrac><mo>=</mo><mn>4.</mn></mrow><annotation encoding=\"application/x-tex\">\\frac{2(4000)^2}{2(2000)^2}=4.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.4271em;vertical-align:-0.936em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.4911em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"mopen\">(</span><span class=\"mord\">2000</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7401em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"mopen\">(</span><span class=\"mord\">4000</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.936em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">4.</span></span></span></span></span>","enumerator":"2","key":"zIwwYC9PlB"}],"label":"demo-flops-mvmult-julia","identifier":"demo-flops-mvmult-julia","html_id":"demo-flops-mvmult-julia","key":"zs5qUeLdoa"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-flops-loglog","label":"demo-flops-loglog","kind":"proof:example","position":{"start":{"line":767,"column":1},"end":{"line":767,"column":19}},"children":[{"type":"text","value":"Example ","key":"iH6702rBWQ"},{"type":"text","value":"2.5.5","key":"VEzrNItYxa"}],"template":"Example %s","enumerator":"2.5.5","resolved":true,"html_id":"demo-flops-loglog","remote":true,"url":"/efficiency","dataUrl":"/efficiency.json","key":"h5B224IQbX"}],"key":"xQPnt7UuSj"},{"type":"paragraph","position":{"start":{"line":769,"column":1},"end":{"line":769,"column":1}},"children":[{"type":"text","value":"Let’s repeat the experiment of the previous figure for more, and larger, values of ","position":{"start":{"line":769,"column":1},"end":{"line":769,"column":1}},"key":"d62cpRSSjq"},{"type":"inlineMath","value":"n","position":{"start":{"line":769,"column":1},"end":{"line":769,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"s7J5bAbdCp"},{"type":"text","value":".","position":{"start":{"line":769,"column":1},"end":{"line":769,"column":1}},"key":"HXG7iqO7CI"}],"key":"mIcDaSudxj"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"randn(5,5)*randn(5);  # throwaway to force compilation\n\nn = 400:200:6000\nt = []\nfor n in n\n    A = randn(n, n)  \n    x = randn(n)\n    time = @elapsed for j in 1:50; A * x; end\n    push!(t, time)\nend","key":"gobDcaYHMD"},{"type":"output","id":"3Sul5XlHYQTbkv1eWRjV_","data":[],"key":"quQd1kHVjj"}],"key":"CT1S99TSZ8"},{"type":"paragraph","position":{"start":{"line":784,"column":1},"end":{"line":784,"column":1}},"children":[{"type":"text","value":"Plotting the time as a function of ","position":{"start":{"line":784,"column":1},"end":{"line":784,"column":1}},"key":"qkx3U4EysL"},{"type":"inlineMath","value":"n","position":{"start":{"line":784,"column":1},"end":{"line":784,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"KZ3viSHhzA"},{"type":"text","value":" on log-log scales is equivalent to plotting the logs of the variables.","position":{"start":{"line":784,"column":1},"end":{"line":784,"column":1}},"key":"z1d9QEUu6W"}],"key":"uSyApWXe2x"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"scatter(n, t, label=\"data\", legend=false,\n    xaxis=(:log10, L\"n\"), yaxis=(:log10, \"elapsed time (sec)\"),\n    title=\"Timing of matrix-vector multiplications\")","key":"hVNrsw51yE"},{"type":"output","id":"JDVciXuDOyhsBQ6PLs1hx","data":[{"output_type":"execute_result","execution_count":74,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"eb4f36c8ba1e92d45a2edc4aa8c8bf8e","path":"/build/eb4f36c8ba1e92d45a2edc4aa8c8bf8e.png"},"text/html":{"content":"<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" width=\"500\" height=\"320\" viewBox=\"0 0 2000 1280\">\n<defs>\n  <clipPath id=\"clip070\">\n    <rect x=\"0\" y=\"0\" width=\"2000\" height=\"1280\"/>\n  </clipPath>\n</defs>\n<path clip-path=\"url(#clip070)\" d=\"M0 1280 L2000 1280 L2000 0 L0 0  Z\" fill=\"#ffffff\" fill-rule=\"evenodd\" fill-opacity=\"1\"/>\n<defs>\n  <clipPath id=\"clip071\">\n    <rect x=\"400\" y=\"0\" width=\"1401\" height=\"1280\"/>\n  </clipPath>\n</defs>\n<path clip-path=\"url(#clip070)\" d=\"M244.586 1099.23 L1952.76 1099.23 L1952.76 107.256 L244.586 107.256  Z\" fill=\"#ffffff\" fill-rule=\"evenodd\" fill-opacity=\"1\"/>\n<defs>\n  <clipPath id=\"clip072\">\n    <rect x=\"244\" y=\"107\" width=\"1709\" height=\"993\"/>\n  </clipPath>\n</defs>\n<polyline clip-path=\"url(#clip072)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"838.188,1099.23 838.188,107.256 \"/>\n<polyline clip-path=\"url(#clip072)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"1523.29,1099.23 1523.29,107.256 \"/>\n<polyline clip-path=\"url(#clip072)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"244.586,1061.38 1952.76,1061.38 \"/>\n<polyline clip-path=\"url(#clip072)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"244.586,627.753 1952.76,627.753 \"/>\n<polyline clip-path=\"url(#clip072)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"244.586,194.129 1952.76,194.129 \"/>\n<polyline clip-path=\"url(#clip070)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"244.586,1099.23 1952.76,1099.23 \"/>\n<polyline clip-path=\"url(#clip070)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"838.188,1099.23 838.188,1080.33 \"/>\n<polyline clip-path=\"url(#clip070)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"1523.29,1099.23 1523.29,1080.33 \"/>\n<path clip-path=\"url(#clip070)\" d=\"M784.993 1170.15 L792.632 1170.15 L792.632 1143.79 L784.322 1145.45 L784.322 1141.19 L792.586 1139.53 L797.262 1139.53 L797.262 1170.15 L804.901 1170.15 L804.901 1174.09 L784.993 1174.09 L784.993 1170.15 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip070)\" d=\"M824.345 1142.61 Q820.734 1142.61 818.905 1146.17 Q817.1 1149.71 817.1 1156.84 Q817.1 1163.95 818.905 1167.51 Q820.734 1171.05 824.345 1171.05 Q827.979 1171.05 829.785 1167.51 Q831.613 1163.95 831.613 1156.84 Q831.613 1149.71 829.785 1146.17 Q827.979 1142.61 824.345 1142.61 M824.345 1138.9 Q830.155 1138.9 833.211 1143.51 Q836.289 1148.09 836.289 1156.84 Q836.289 1165.57 833.211 1170.17 Q830.155 1174.76 824.345 1174.76 Q818.535 1174.76 815.456 1170.17 Q812.401 1165.57 812.401 1156.84 Q812.401 1148.09 815.456 1143.51 Q818.535 1138.9 824.345 1138.9 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip070)\" d=\"M848.985 1131.54 Q851.712 1132.12 853.235 1133.96 Q854.777 1135.81 854.777 1138.51 Q854.777 1142.67 851.919 1144.95 Q849.06 1147.22 843.794 1147.22 Q842.026 1147.22 840.145 1146.86 Q838.283 1146.53 836.289 1145.83 L836.289 1142.16 Q837.869 1143.08 839.75 1143.55 Q841.631 1144.02 843.681 1144.02 Q847.254 1144.02 849.116 1142.61 Q850.997 1141.2 850.997 1138.51 Q850.997 1136.03 849.248 1134.64 Q847.518 1133.23 844.414 1133.23 L841.142 1133.23 L841.142 1130.11 L844.565 1130.11 Q847.367 1130.11 848.853 1129 Q850.339 1127.87 850.339 1125.76 Q850.339 1123.6 848.796 1122.45 Q847.273 1121.29 844.414 1121.29 Q842.853 1121.29 841.066 1121.62 Q839.28 1121.96 837.136 1122.68 L837.136 1119.29 Q839.299 1118.69 841.179 1118.39 Q843.079 1118.09 844.753 1118.09 Q849.079 1118.09 851.599 1120.06 Q854.119 1122.02 854.119 1125.37 Q854.119 1127.7 852.784 1129.32 Q851.448 1130.92 848.985 1131.54 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip070)\" d=\"M861.981 1141.9 L865.949 1141.9 L865.949 1146.68 L861.981 1146.68 L861.981 1141.9 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip070)\" d=\"M882.35 1121.1 Q879.416 1121.1 877.93 1123.99 Q876.463 1126.87 876.463 1132.66 Q876.463 1138.44 877.93 1141.33 Q879.416 1144.21 882.35 1144.21 Q885.302 1144.21 886.769 1141.33 Q888.255 1138.44 888.255 1132.66 Q888.255 1126.87 886.769 1123.99 Q885.302 1121.1 882.35 1121.1 M882.35 1118.09 Q887.07 1118.09 889.553 1121.83 Q892.054 1125.56 892.054 1132.66 Q892.054 1139.75 889.553 1143.5 Q887.07 1147.22 882.35 1147.22 Q877.629 1147.22 875.127 1143.5 Q872.645 1139.75 872.645 1132.66 Q872.645 1125.56 875.127 1121.83 Q877.629 1118.09 882.35 1118.09 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip070)\" d=\"M1470.5 1170.15 L1478.14 1170.15 L1478.14 1143.79 L1469.83 1145.45 L1469.83 1141.19 L1478.09 1139.53 L1482.77 1139.53 L1482.77 1170.15 L1490.41 1170.15 L1490.41 1174.09 L1470.5 1174.09 L1470.5 1170.15 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip070)\" d=\"M1509.85 1142.61 Q1506.24 1142.61 1504.41 1146.17 Q1502.6 1149.71 1502.6 1156.84 Q1502.6 1163.95 1504.41 1167.51 Q1506.24 1171.05 1509.85 1171.05 Q1513.48 1171.05 1515.29 1167.51 Q1517.12 1163.95 1517.12 1156.84 Q1517.12 1149.71 1515.29 1146.17 Q1513.48 1142.61 1509.85 1142.61 M1509.85 1138.9 Q1515.66 1138.9 1518.72 1143.51 Q1521.79 1148.09 1521.79 1156.84 Q1521.79 1165.57 1518.72 1170.17 Q1515.66 1174.76 1509.85 1174.76 Q1504.04 1174.76 1500.96 1170.17 Q1497.91 1165.57 1497.91 1156.84 Q1497.91 1148.09 1500.96 1143.51 Q1504.04 1138.9 1509.85 1138.9 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip070)\" d=\"M1534.49 1131.54 Q1537.22 1132.12 1538.74 1133.96 Q1540.28 1135.81 1540.28 1138.51 Q1540.28 1142.67 1537.42 1144.95 Q1534.56 1147.22 1529.3 1147.22 Q1527.53 1147.22 1525.65 1146.86 Q1523.79 1146.53 1521.79 1145.83 L1521.79 1142.16 Q1523.37 1143.08 1525.25 1143.55 Q1527.14 1144.02 1529.19 1144.02 Q1532.76 1144.02 1534.62 1142.61 Q1536.5 1141.2 1536.5 1138.51 Q1536.5 1136.03 1534.75 1134.64 Q1533.02 1133.23 1529.92 1133.23 L1526.65 1133.23 L1526.65 1130.11 L1530.07 1130.11 Q1532.87 1130.11 1534.36 1129 Q1535.84 1127.87 1535.84 1125.76 Q1535.84 1123.6 1534.3 1122.45 Q1532.78 1121.29 1529.92 1121.29 Q1528.36 1121.29 1526.57 1121.62 Q1524.78 1121.96 1522.64 1122.68 L1522.64 1119.29 Q1524.8 1118.69 1526.68 1118.39 Q1528.58 1118.09 1530.26 1118.09 Q1534.58 1118.09 1537.1 1120.06 Q1539.62 1122.02 1539.62 1125.37 Q1539.62 1127.7 1538.29 1129.32 Q1536.95 1130.92 1534.49 1131.54 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip070)\" d=\"M1547.49 1141.9 L1551.45 1141.9 L1551.45 1146.68 L1547.49 1146.68 L1547.49 1141.9 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip070)\" d=\"M1559.77 1118.6 L1574.68 1118.6 L1574.68 1121.79 L1563.25 1121.79 L1563.25 1128.68 Q1564.07 1128.4 1564.9 1128.26 Q1565.73 1128.11 1566.56 1128.11 Q1571.26 1128.11 1574 1130.69 Q1576.75 1133.27 1576.75 1137.67 Q1576.75 1142.2 1573.93 1144.72 Q1571.11 1147.22 1565.97 1147.22 Q1564.21 1147.22 1562.36 1146.92 Q1560.54 1146.62 1558.58 1146.02 L1558.58 1142.2 Q1560.27 1143.12 1562.08 1143.57 Q1563.89 1144.02 1565.9 1144.02 Q1569.15 1144.02 1571.05 1142.31 Q1572.95 1140.6 1572.95 1137.67 Q1572.95 1134.73 1571.05 1133.02 Q1569.15 1131.31 1565.9 1131.31 Q1564.37 1131.31 1562.85 1131.65 Q1561.35 1131.99 1559.77 1132.7 L1559.77 1118.6 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><g clip-path=\"url(#clip070)\">\n<image width=\"36\" height=\"30\" xlink:href=\"data:image/png;base64,\niVBORw0KGgoAAAANSUhEUgAAACQAAAAeCAYAAABE4bxTAAABuUlEQVRYhbVYW4GEMAyMBDRUAhoq\nAQ1IQAMS0FAJaEACGmph7uOue21I+trykR+aHSaZSVuWABAP7z2stSAiGGPgnIOUp8W2bZjnGUSE\naZpgrcV5nlUY8kMi8Ni2rQh4nufjd3Gs61rEUMlc1wUAtCxLAiqBXNeV5BzH8cnz3sMYk6zf960S\nE8nkOmatTdZjaXKVBwvkCksIhXZLWvMKw/NpmkBE1R6LMbQCit2JuxDCOfcxrfe+2vDcU0VCmulC\nJ3gEnw0ntO97XtfOiSnhSAUV5dIItZKRcKRp+yQaY8SX8JFu9U2zZN57dbogGLq3O1JhqodyYzvC\nO8BzHypOWS2hUXIty9JOSDqbesi0FJYFGeWfsK00HR1v+ofjaBPdTGiUf6pP+zf80yJXltAo/3CM\neZ77CHGgmhvjt7I75971z7qu1V0+juM3R2X6glzaZpjkSov8hthDKJyR1Wb+I1xVWc/+wz8OcoSC\ntNBMPcI//JaZGwqi/zv2a/7hsmtFxd0RCY3wD/DcEHM+iy1RlKt3/+FYGhn+OVQk1EsGSI+f8OL4\nfwMJPytZ7+kex33fDwsQEfZ9F7F/AEI9aqd2YHXbAAAAAElFTkSuQmCC\n\" transform=\"translate(1081, 1212)\"/>\n</g>\n<polyline clip-path=\"url(#clip070)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"244.586,1099.23 244.586,107.256 \"/>\n<polyline clip-path=\"url(#clip070)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"244.586,1061.38 263.484,1061.38 \"/>\n<polyline clip-path=\"url(#clip070)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"244.586,627.753 263.484,627.753 \"/>\n<polyline clip-path=\"url(#clip070)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"244.586,194.129 263.484,194.129 \"/>\n<path clip-path=\"url(#clip070)\" d=\"M113.675 1081.17 L121.314 1081.17 L121.314 1054.8 L113.004 1056.47 L113.004 1052.21 L121.268 1050.54 L125.944 1050.54 L125.944 1081.17 L133.583 1081.17 L133.583 1085.1 L113.675 1085.1 L113.675 1081.17 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip070)\" d=\"M153.027 1053.62 Q149.416 1053.62 147.587 1057.19 Q145.782 1060.73 145.782 1067.86 Q145.782 1074.97 147.587 1078.53 Q149.416 1082.07 153.027 1082.07 Q156.661 1082.07 158.467 1078.53 Q160.295 1074.97 160.295 1067.86 Q160.295 1060.73 158.467 1057.19 Q156.661 1053.62 153.027 1053.62 M153.027 1049.92 Q158.837 1049.92 161.893 1054.53 Q164.971 1059.11 164.971 1067.86 Q164.971 1076.59 161.893 1081.19 Q158.837 1085.78 153.027 1085.78 Q147.217 1085.78 144.138 1081.19 Q141.082 1076.59 141.082 1067.86 Q141.082 1059.11 144.138 1054.53 Q147.217 1049.92 153.027 1049.92 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip070)\" d=\"M164.971 1044.02 L189.083 1044.02 L189.083 1047.22 L164.971 1047.22 L164.971 1044.02 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip070)\" d=\"M208.793 1042.55 Q211.52 1043.14 213.044 1044.98 Q214.586 1046.82 214.586 1049.53 Q214.586 1053.69 211.727 1055.96 Q208.869 1058.24 203.602 1058.24 Q201.834 1058.24 199.954 1057.88 Q198.092 1057.54 196.098 1056.85 L196.098 1053.18 Q197.678 1054.1 199.559 1054.57 Q201.439 1055.04 203.49 1055.04 Q207.063 1055.04 208.925 1053.63 Q210.806 1052.22 210.806 1049.53 Q210.806 1047.05 209.057 1045.66 Q207.326 1044.25 204.223 1044.25 L200.95 1044.25 L200.95 1041.12 L204.374 1041.12 Q207.176 1041.12 208.662 1040.01 Q210.147 1038.89 210.147 1036.78 Q210.147 1034.62 208.605 1033.47 Q207.082 1032.3 204.223 1032.3 Q202.662 1032.3 200.875 1032.64 Q199.089 1032.98 196.944 1033.7 L196.944 1030.31 Q199.107 1029.71 200.988 1029.41 Q202.888 1029.11 204.562 1029.11 Q208.887 1029.11 211.408 1031.08 Q213.928 1033.04 213.928 1036.38 Q213.928 1038.72 212.592 1040.33 Q211.257 1041.93 208.793 1042.55 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip070)\" d=\"M114.446 647.546 L122.085 647.546 L122.085 621.18 L113.775 622.847 L113.775 618.587 L122.039 616.921 L126.715 616.921 L126.715 647.546 L134.354 647.546 L134.354 651.481 L114.446 651.481 L114.446 647.546 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip070)\" d=\"M153.798 619.999 Q150.187 619.999 148.358 623.564 Q146.553 627.106 146.553 634.235 Q146.553 641.342 148.358 644.907 Q150.187 648.448 153.798 648.448 Q157.432 648.448 159.238 644.907 Q161.066 641.342 161.066 634.235 Q161.066 627.106 159.238 623.564 Q157.432 619.999 153.798 619.999 M153.798 616.296 Q159.608 616.296 162.664 620.902 Q165.742 625.486 165.742 634.235 Q165.742 642.962 162.664 647.569 Q159.608 652.152 153.798 652.152 Q147.988 652.152 144.909 647.569 Q141.854 642.962 141.854 634.235 Q141.854 625.486 144.909 620.902 Q147.988 616.296 153.798 616.296 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip070)\" d=\"M165.742 610.397 L189.854 610.397 L189.854 613.594 L165.742 613.594 L165.742 610.397 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip070)\" d=\"M201.327 620.873 L214.586 620.873 L214.586 624.07 L196.756 624.07 L196.756 620.873 Q198.919 618.635 202.643 614.873 Q206.386 611.093 207.345 610.002 Q209.169 607.952 209.884 606.541 Q210.618 605.112 210.618 603.739 Q210.618 601.501 209.038 600.09 Q207.477 598.68 204.957 598.68 Q203.17 598.68 201.176 599.301 Q199.201 599.921 196.944 601.181 L196.944 597.344 Q199.239 596.423 201.233 595.953 Q203.226 595.483 204.881 595.483 Q209.245 595.483 211.84 597.664 Q214.436 599.846 214.436 603.495 Q214.436 605.225 213.777 606.786 Q213.138 608.328 211.426 610.435 Q210.956 610.98 208.436 613.594 Q205.916 616.19 201.327 620.873 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip070)\" d=\"M114.145 213.922 L121.784 213.922 L121.784 187.556 L113.474 189.223 L113.474 184.964 L121.738 183.297 L126.414 183.297 L126.414 213.922 L134.053 213.922 L134.053 217.857 L114.145 217.857 L114.145 213.922 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip070)\" d=\"M153.497 186.376 Q149.886 186.376 148.057 189.941 Q146.252 193.482 146.252 200.612 Q146.252 207.718 148.057 211.283 Q149.886 214.825 153.497 214.825 Q157.131 214.825 158.937 211.283 Q160.766 207.718 160.766 200.612 Q160.766 193.482 158.937 189.941 Q157.131 186.376 153.497 186.376 M153.497 182.672 Q159.307 182.672 162.363 187.279 Q165.441 191.862 165.441 200.612 Q165.441 209.339 162.363 213.945 Q159.307 218.528 153.497 218.528 Q147.687 218.528 144.608 213.945 Q141.553 209.339 141.553 200.612 Q141.553 191.862 144.608 187.279 Q147.687 182.672 153.497 182.672 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip070)\" d=\"M165.441 176.773 L189.553 176.773 L189.553 179.971 L165.441 179.971 L165.441 176.773 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip070)\" d=\"M198.411 187.249 L204.618 187.249 L204.618 165.827 L197.866 167.181 L197.866 163.721 L204.58 162.367 L208.38 162.367 L208.38 187.249 L214.586 187.249 L214.586 190.447 L198.411 190.447 L198.411 187.249 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><g clip-path=\"url(#clip070)\">\n<text style=\"fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:66px; text-anchor:middle;\" transform=\"rotate(-90, 71.4418, 603.241)\" x=\"71.4418\" y=\"603.241\">elapsed time (sec)</text>\n</g>\n<g clip-path=\"url(#clip070)\">\n<text style=\"fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:66px; text-anchor:middle;\" transform=\"rotate(0, 1098.67, 57.6)\" x=\"1098.67\" y=\"57.6\">Timing of matrix-vector multiplications</text>\n</g>\n<circle clip-path=\"url(#clip072)\" cx=\"292.931\" cy=\"1071.15\" r=\"10.8\" fill=\"#009af9\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"#000000\" stroke-opacity=\"1\" stroke-width=\"2.56\"/>\n<circle clip-path=\"url(#clip072)\" cx=\"534.211\" cy=\"914.19\" r=\"10.8\" fill=\"#009af9\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"#000000\" stroke-opacity=\"1\" stroke-width=\"2.56\"/>\n<circle clip-path=\"url(#clip072)\" cx=\"705.402\" cy=\"871.36\" r=\"10.8\" fill=\"#009af9\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"#000000\" stroke-opacity=\"1\" stroke-width=\"2.56\"/>\n<circle clip-path=\"url(#clip072)\" cx=\"838.188\" cy=\"770.197\" r=\"10.8\" fill=\"#009af9\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"#000000\" stroke-opacity=\"1\" stroke-width=\"2.56\"/>\n<circle clip-path=\"url(#clip072)\" cx=\"946.682\" cy=\"752.961\" r=\"10.8\" fill=\"#009af9\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"#000000\" stroke-opacity=\"1\" stroke-width=\"2.56\"/>\n<circle clip-path=\"url(#clip072)\" cx=\"1038.41\" cy=\"670.366\" r=\"10.8\" fill=\"#009af9\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"#000000\" stroke-opacity=\"1\" stroke-width=\"2.56\"/>\n<circle clip-path=\"url(#clip072)\" cx=\"1117.87\" cy=\"630.023\" r=\"10.8\" fill=\"#009af9\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"#000000\" stroke-opacity=\"1\" stroke-width=\"2.56\"/>\n<circle clip-path=\"url(#clip072)\" cx=\"1187.96\" cy=\"590.824\" r=\"10.8\" fill=\"#009af9\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"#000000\" stroke-opacity=\"1\" stroke-width=\"2.56\"/>\n<circle clip-path=\"url(#clip072)\" cx=\"1250.66\" cy=\"545.541\" r=\"10.8\" fill=\"#009af9\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"#000000\" stroke-opacity=\"1\" stroke-width=\"2.56\"/>\n<circle clip-path=\"url(#clip072)\" cx=\"1307.38\" cy=\"527.491\" r=\"10.8\" fill=\"#009af9\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"#000000\" stroke-opacity=\"1\" stroke-width=\"2.56\"/>\n<circle clip-path=\"url(#clip072)\" cx=\"1359.15\" cy=\"451.549\" r=\"10.8\" fill=\"#009af9\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"#000000\" stroke-opacity=\"1\" stroke-width=\"2.56\"/>\n<circle clip-path=\"url(#clip072)\" cx=\"1406.78\" cy=\"428.686\" r=\"10.8\" fill=\"#009af9\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"#000000\" stroke-opacity=\"1\" stroke-width=\"2.56\"/>\n<circle clip-path=\"url(#clip072)\" cx=\"1450.88\" cy=\"392.493\" r=\"10.8\" fill=\"#009af9\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"#000000\" stroke-opacity=\"1\" stroke-width=\"2.56\"/>\n<circle clip-path=\"url(#clip072)\" cx=\"1491.94\" cy=\"365.132\" r=\"10.8\" fill=\"#009af9\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"#000000\" stroke-opacity=\"1\" stroke-width=\"2.56\"/>\n<circle clip-path=\"url(#clip072)\" cx=\"1530.34\" cy=\"322.606\" r=\"10.8\" fill=\"#009af9\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"#000000\" stroke-opacity=\"1\" stroke-width=\"2.56\"/>\n<circle clip-path=\"url(#clip072)\" cx=\"1566.42\" cy=\"183.89\" r=\"10.8\" fill=\"#009af9\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"#000000\" stroke-opacity=\"1\" stroke-width=\"2.56\"/>\n<circle clip-path=\"url(#clip072)\" cx=\"1600.43\" cy=\"291.761\" r=\"10.8\" fill=\"#009af9\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"#000000\" stroke-opacity=\"1\" stroke-width=\"2.56\"/>\n<circle clip-path=\"url(#clip072)\" cx=\"1632.61\" cy=\"253.352\" r=\"10.8\" fill=\"#009af9\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"#000000\" stroke-opacity=\"1\" stroke-width=\"2.56\"/>\n<circle clip-path=\"url(#clip072)\" cx=\"1663.13\" cy=\"227.157\" r=\"10.8\" fill=\"#009af9\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"#000000\" stroke-opacity=\"1\" stroke-width=\"2.56\"/>\n<circle clip-path=\"url(#clip072)\" cx=\"1692.16\" cy=\"236.349\" r=\"10.8\" fill=\"#009af9\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"#000000\" stroke-opacity=\"1\" stroke-width=\"2.56\"/>\n<circle clip-path=\"url(#clip072)\" cx=\"1719.85\" cy=\"221.833\" r=\"10.8\" fill=\"#009af9\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"#000000\" stroke-opacity=\"1\" stroke-width=\"2.56\"/>\n<circle clip-path=\"url(#clip072)\" cx=\"1746.3\" cy=\"205.039\" r=\"10.8\" fill=\"#009af9\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"#000000\" stroke-opacity=\"1\" stroke-width=\"2.56\"/>\n<circle clip-path=\"url(#clip072)\" cx=\"1771.63\" cy=\"187.936\" r=\"10.8\" fill=\"#009af9\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"#000000\" stroke-opacity=\"1\" stroke-width=\"2.56\"/>\n<circle clip-path=\"url(#clip072)\" cx=\"1795.92\" cy=\"200.005\" r=\"10.8\" fill=\"#009af9\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"#000000\" stroke-opacity=\"1\" stroke-width=\"2.56\"/>\n<circle clip-path=\"url(#clip072)\" cx=\"1819.26\" cy=\"168.309\" r=\"10.8\" fill=\"#009af9\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"#000000\" stroke-opacity=\"1\" stroke-width=\"2.56\"/>\n<circle clip-path=\"url(#clip072)\" cx=\"1841.71\" cy=\"176.836\" r=\"10.8\" fill=\"#009af9\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"#000000\" stroke-opacity=\"1\" stroke-width=\"2.56\"/>\n<circle clip-path=\"url(#clip072)\" cx=\"1863.36\" cy=\"167.054\" r=\"10.8\" fill=\"#009af9\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"#000000\" stroke-opacity=\"1\" stroke-width=\"2.56\"/>\n<circle clip-path=\"url(#clip072)\" cx=\"1884.24\" cy=\"160.921\" r=\"10.8\" fill=\"#009af9\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"#000000\" stroke-opacity=\"1\" stroke-width=\"2.56\"/>\n<circle clip-path=\"url(#clip072)\" cx=\"1904.41\" cy=\"135.331\" r=\"10.8\" fill=\"#009af9\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"#000000\" stroke-opacity=\"1\" stroke-width=\"2.56\"/>\n</svg>\n","content_type":"text/html"},"image/svg+xml":{"content":"<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" width=\"500\" height=\"320\" viewBox=\"0 0 2000 1280\">\n<defs>\n  <clipPath id=\"clip020\">\n    <rect x=\"0\" y=\"0\" width=\"2000\" height=\"1280\"/>\n  </clipPath>\n</defs>\n<path clip-path=\"url(#clip020)\" d=\"M0 1280 L2000 1280 L2000 0 L0 0  Z\" fill=\"#ffffff\" fill-rule=\"evenodd\" fill-opacity=\"1\"/>\n<defs>\n  <clipPath id=\"clip021\">\n    <rect x=\"400\" y=\"0\" width=\"1401\" height=\"1280\"/>\n  </clipPath>\n</defs>\n<path clip-path=\"url(#clip020)\" d=\"M244.586 1099.23 L1952.76 1099.23 L1952.76 107.256 L244.586 107.256  Z\" fill=\"#ffffff\" fill-rule=\"evenodd\" fill-opacity=\"1\"/>\n<defs>\n  <clipPath id=\"clip022\">\n    <rect x=\"244\" y=\"107\" width=\"1709\" height=\"993\"/>\n  </clipPath>\n</defs>\n<polyline clip-path=\"url(#clip022)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"838.188,1099.23 838.188,107.256 \"/>\n<polyline clip-path=\"url(#clip022)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"1523.29,1099.23 1523.29,107.256 \"/>\n<polyline clip-path=\"url(#clip022)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"244.586,1061.38 1952.76,1061.38 \"/>\n<polyline clip-path=\"url(#clip022)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"244.586,627.753 1952.76,627.753 \"/>\n<polyline clip-path=\"url(#clip022)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"244.586,194.129 1952.76,194.129 \"/>\n<polyline clip-path=\"url(#clip020)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"244.586,1099.23 1952.76,1099.23 \"/>\n<polyline clip-path=\"url(#clip020)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"838.188,1099.23 838.188,1080.33 \"/>\n<polyline clip-path=\"url(#clip020)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"1523.29,1099.23 1523.29,1080.33 \"/>\n<path clip-path=\"url(#clip020)\" d=\"M784.993 1170.15 L792.632 1170.15 L792.632 1143.79 L784.322 1145.45 L784.322 1141.19 L792.586 1139.53 L797.262 1139.53 L797.262 1170.15 L804.901 1170.15 L804.901 1174.09 L784.993 1174.09 L784.993 1170.15 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip020)\" d=\"M824.345 1142.61 Q820.734 1142.61 818.905 1146.17 Q817.1 1149.71 817.1 1156.84 Q817.1 1163.95 818.905 1167.51 Q820.734 1171.05 824.345 1171.05 Q827.979 1171.05 829.785 1167.51 Q831.613 1163.95 831.613 1156.84 Q831.613 1149.71 829.785 1146.17 Q827.979 1142.61 824.345 1142.61 M824.345 1138.9 Q830.155 1138.9 833.211 1143.51 Q836.289 1148.09 836.289 1156.84 Q836.289 1165.57 833.211 1170.17 Q830.155 1174.76 824.345 1174.76 Q818.535 1174.76 815.456 1170.17 Q812.401 1165.57 812.401 1156.84 Q812.401 1148.09 815.456 1143.51 Q818.535 1138.9 824.345 1138.9 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip020)\" d=\"M848.985 1131.54 Q851.712 1132.12 853.235 1133.96 Q854.777 1135.81 854.777 1138.51 Q854.777 1142.67 851.919 1144.95 Q849.06 1147.22 843.794 1147.22 Q842.026 1147.22 840.145 1146.86 Q838.283 1146.53 836.289 1145.83 L836.289 1142.16 Q837.869 1143.08 839.75 1143.55 Q841.631 1144.02 843.681 1144.02 Q847.254 1144.02 849.116 1142.61 Q850.997 1141.2 850.997 1138.51 Q850.997 1136.03 849.248 1134.64 Q847.518 1133.23 844.414 1133.23 L841.142 1133.23 L841.142 1130.11 L844.565 1130.11 Q847.367 1130.11 848.853 1129 Q850.339 1127.87 850.339 1125.76 Q850.339 1123.6 848.796 1122.45 Q847.273 1121.29 844.414 1121.29 Q842.853 1121.29 841.066 1121.62 Q839.28 1121.96 837.136 1122.68 L837.136 1119.29 Q839.299 1118.69 841.179 1118.39 Q843.079 1118.09 844.753 1118.09 Q849.079 1118.09 851.599 1120.06 Q854.119 1122.02 854.119 1125.37 Q854.119 1127.7 852.784 1129.32 Q851.448 1130.92 848.985 1131.54 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip020)\" d=\"M861.981 1141.9 L865.949 1141.9 L865.949 1146.68 L861.981 1146.68 L861.981 1141.9 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip020)\" d=\"M882.35 1121.1 Q879.416 1121.1 877.93 1123.99 Q876.463 1126.87 876.463 1132.66 Q876.463 1138.44 877.93 1141.33 Q879.416 1144.21 882.35 1144.21 Q885.302 1144.21 886.769 1141.33 Q888.255 1138.44 888.255 1132.66 Q888.255 1126.87 886.769 1123.99 Q885.302 1121.1 882.35 1121.1 M882.35 1118.09 Q887.07 1118.09 889.553 1121.83 Q892.054 1125.56 892.054 1132.66 Q892.054 1139.75 889.553 1143.5 Q887.07 1147.22 882.35 1147.22 Q877.629 1147.22 875.127 1143.5 Q872.645 1139.75 872.645 1132.66 Q872.645 1125.56 875.127 1121.83 Q877.629 1118.09 882.35 1118.09 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip020)\" d=\"M1470.5 1170.15 L1478.14 1170.15 L1478.14 1143.79 L1469.83 1145.45 L1469.83 1141.19 L1478.09 1139.53 L1482.77 1139.53 L1482.77 1170.15 L1490.41 1170.15 L1490.41 1174.09 L1470.5 1174.09 L1470.5 1170.15 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip020)\" d=\"M1509.85 1142.61 Q1506.24 1142.61 1504.41 1146.17 Q1502.6 1149.71 1502.6 1156.84 Q1502.6 1163.95 1504.41 1167.51 Q1506.24 1171.05 1509.85 1171.05 Q1513.48 1171.05 1515.29 1167.51 Q1517.12 1163.95 1517.12 1156.84 Q1517.12 1149.71 1515.29 1146.17 Q1513.48 1142.61 1509.85 1142.61 M1509.85 1138.9 Q1515.66 1138.9 1518.72 1143.51 Q1521.79 1148.09 1521.79 1156.84 Q1521.79 1165.57 1518.72 1170.17 Q1515.66 1174.76 1509.85 1174.76 Q1504.04 1174.76 1500.96 1170.17 Q1497.91 1165.57 1497.91 1156.84 Q1497.91 1148.09 1500.96 1143.51 Q1504.04 1138.9 1509.85 1138.9 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip020)\" d=\"M1534.49 1131.54 Q1537.22 1132.12 1538.74 1133.96 Q1540.28 1135.81 1540.28 1138.51 Q1540.28 1142.67 1537.42 1144.95 Q1534.56 1147.22 1529.3 1147.22 Q1527.53 1147.22 1525.65 1146.86 Q1523.79 1146.53 1521.79 1145.83 L1521.79 1142.16 Q1523.37 1143.08 1525.25 1143.55 Q1527.14 1144.02 1529.19 1144.02 Q1532.76 1144.02 1534.62 1142.61 Q1536.5 1141.2 1536.5 1138.51 Q1536.5 1136.03 1534.75 1134.64 Q1533.02 1133.23 1529.92 1133.23 L1526.65 1133.23 L1526.65 1130.11 L1530.07 1130.11 Q1532.87 1130.11 1534.36 1129 Q1535.84 1127.87 1535.84 1125.76 Q1535.84 1123.6 1534.3 1122.45 Q1532.78 1121.29 1529.92 1121.29 Q1528.36 1121.29 1526.57 1121.62 Q1524.78 1121.96 1522.64 1122.68 L1522.64 1119.29 Q1524.8 1118.69 1526.68 1118.39 Q1528.58 1118.09 1530.26 1118.09 Q1534.58 1118.09 1537.1 1120.06 Q1539.62 1122.02 1539.62 1125.37 Q1539.62 1127.7 1538.29 1129.32 Q1536.95 1130.92 1534.49 1131.54 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip020)\" d=\"M1547.49 1141.9 L1551.45 1141.9 L1551.45 1146.68 L1547.49 1146.68 L1547.49 1141.9 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip020)\" d=\"M1559.77 1118.6 L1574.68 1118.6 L1574.68 1121.79 L1563.25 1121.79 L1563.25 1128.68 Q1564.07 1128.4 1564.9 1128.26 Q1565.73 1128.11 1566.56 1128.11 Q1571.26 1128.11 1574 1130.69 Q1576.75 1133.27 1576.75 1137.67 Q1576.75 1142.2 1573.93 1144.72 Q1571.11 1147.22 1565.97 1147.22 Q1564.21 1147.22 1562.36 1146.92 Q1560.54 1146.62 1558.58 1146.02 L1558.58 1142.2 Q1560.27 1143.12 1562.08 1143.57 Q1563.89 1144.02 1565.9 1144.02 Q1569.15 1144.02 1571.05 1142.31 Q1572.95 1140.6 1572.95 1137.67 Q1572.95 1134.73 1571.05 1133.02 Q1569.15 1131.31 1565.9 1131.31 Q1564.37 1131.31 1562.85 1131.65 Q1561.35 1131.99 1559.77 1132.7 L1559.77 1118.6 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><g clip-path=\"url(#clip020)\">\n<image width=\"36\" height=\"30\" xlink:href=\"data:image/png;base64,\niVBORw0KGgoAAAANSUhEUgAAACQAAAAeCAYAAABE4bxTAAABuUlEQVRYhbVYW4GEMAyMBDRUAhoq\nAQ1IQAMS0FAJaEACGmph7uOue21I+trykR+aHSaZSVuWABAP7z2stSAiGGPgnIOUp8W2bZjnGUSE\naZpgrcV5nlUY8kMi8Ni2rQh4nufjd3Gs61rEUMlc1wUAtCxLAiqBXNeV5BzH8cnz3sMYk6zf960S\nE8nkOmatTdZjaXKVBwvkCksIhXZLWvMKw/NpmkBE1R6LMbQCit2JuxDCOfcxrfe+2vDcU0VCmulC\nJ3gEnw0ntO97XtfOiSnhSAUV5dIItZKRcKRp+yQaY8SX8JFu9U2zZN57dbogGLq3O1JhqodyYzvC\nO8BzHypOWS2hUXIty9JOSDqbesi0FJYFGeWfsK00HR1v+ofjaBPdTGiUf6pP+zf80yJXltAo/3CM\neZ77CHGgmhvjt7I75971z7qu1V0+juM3R2X6glzaZpjkSov8hthDKJyR1Wb+I1xVWc/+wz8OcoSC\ntNBMPcI//JaZGwqi/zv2a/7hsmtFxd0RCY3wD/DcEHM+iy1RlKt3/+FYGhn+OVQk1EsGSI+f8OL4\nfwMJPytZ7+kex33fDwsQEfZ9F7F/AEI9aqd2YHXbAAAAAElFTkSuQmCC\n\" transform=\"translate(1081, 1212)\"/>\n</g>\n<polyline clip-path=\"url(#clip020)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"244.586,1099.23 244.586,107.256 \"/>\n<polyline clip-path=\"url(#clip020)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"244.586,1061.38 263.484,1061.38 \"/>\n<polyline clip-path=\"url(#clip020)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"244.586,627.753 263.484,627.753 \"/>\n<polyline clip-path=\"url(#clip020)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"244.586,194.129 263.484,194.129 \"/>\n<path clip-path=\"url(#clip020)\" d=\"M113.675 1081.17 L121.314 1081.17 L121.314 1054.8 L113.004 1056.47 L113.004 1052.21 L121.268 1050.54 L125.944 1050.54 L125.944 1081.17 L133.583 1081.17 L133.583 1085.1 L113.675 1085.1 L113.675 1081.17 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip020)\" d=\"M153.027 1053.62 Q149.416 1053.62 147.587 1057.19 Q145.782 1060.73 145.782 1067.86 Q145.782 1074.97 147.587 1078.53 Q149.416 1082.07 153.027 1082.07 Q156.661 1082.07 158.467 1078.53 Q160.295 1074.97 160.295 1067.86 Q160.295 1060.73 158.467 1057.19 Q156.661 1053.62 153.027 1053.62 M153.027 1049.92 Q158.837 1049.92 161.893 1054.53 Q164.971 1059.11 164.971 1067.86 Q164.971 1076.59 161.893 1081.19 Q158.837 1085.78 153.027 1085.78 Q147.217 1085.78 144.138 1081.19 Q141.082 1076.59 141.082 1067.86 Q141.082 1059.11 144.138 1054.53 Q147.217 1049.92 153.027 1049.92 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip020)\" d=\"M164.971 1044.02 L189.083 1044.02 L189.083 1047.22 L164.971 1047.22 L164.971 1044.02 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip020)\" d=\"M208.793 1042.55 Q211.52 1043.14 213.044 1044.98 Q214.586 1046.82 214.586 1049.53 Q214.586 1053.69 211.727 1055.96 Q208.869 1058.24 203.602 1058.24 Q201.834 1058.24 199.954 1057.88 Q198.092 1057.54 196.098 1056.85 L196.098 1053.18 Q197.678 1054.1 199.559 1054.57 Q201.439 1055.04 203.49 1055.04 Q207.063 1055.04 208.925 1053.63 Q210.806 1052.22 210.806 1049.53 Q210.806 1047.05 209.057 1045.66 Q207.326 1044.25 204.223 1044.25 L200.95 1044.25 L200.95 1041.12 L204.374 1041.12 Q207.176 1041.12 208.662 1040.01 Q210.147 1038.89 210.147 1036.78 Q210.147 1034.62 208.605 1033.47 Q207.082 1032.3 204.223 1032.3 Q202.662 1032.3 200.875 1032.64 Q199.089 1032.98 196.944 1033.7 L196.944 1030.31 Q199.107 1029.71 200.988 1029.41 Q202.888 1029.11 204.562 1029.11 Q208.887 1029.11 211.408 1031.08 Q213.928 1033.04 213.928 1036.38 Q213.928 1038.72 212.592 1040.33 Q211.257 1041.93 208.793 1042.55 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip020)\" d=\"M114.446 647.546 L122.085 647.546 L122.085 621.18 L113.775 622.847 L113.775 618.587 L122.039 616.921 L126.715 616.921 L126.715 647.546 L134.354 647.546 L134.354 651.481 L114.446 651.481 L114.446 647.546 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip020)\" d=\"M153.798 619.999 Q150.187 619.999 148.358 623.564 Q146.553 627.106 146.553 634.235 Q146.553 641.342 148.358 644.907 Q150.187 648.448 153.798 648.448 Q157.432 648.448 159.238 644.907 Q161.066 641.342 161.066 634.235 Q161.066 627.106 159.238 623.564 Q157.432 619.999 153.798 619.999 M153.798 616.296 Q159.608 616.296 162.664 620.902 Q165.742 625.486 165.742 634.235 Q165.742 642.962 162.664 647.569 Q159.608 652.152 153.798 652.152 Q147.988 652.152 144.909 647.569 Q141.854 642.962 141.854 634.235 Q141.854 625.486 144.909 620.902 Q147.988 616.296 153.798 616.296 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip020)\" d=\"M165.742 610.397 L189.854 610.397 L189.854 613.594 L165.742 613.594 L165.742 610.397 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip020)\" d=\"M201.327 620.873 L214.586 620.873 L214.586 624.07 L196.756 624.07 L196.756 620.873 Q198.919 618.635 202.643 614.873 Q206.386 611.093 207.345 610.002 Q209.169 607.952 209.884 606.541 Q210.618 605.112 210.618 603.739 Q210.618 601.501 209.038 600.09 Q207.477 598.68 204.957 598.68 Q203.17 598.68 201.176 599.301 Q199.201 599.921 196.944 601.181 L196.944 597.344 Q199.239 596.423 201.233 595.953 Q203.226 595.483 204.881 595.483 Q209.245 595.483 211.84 597.664 Q214.436 599.846 214.436 603.495 Q214.436 605.225 213.777 606.786 Q213.138 608.328 211.426 610.435 Q210.956 610.98 208.436 613.594 Q205.916 616.19 201.327 620.873 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip020)\" d=\"M114.145 213.922 L121.784 213.922 L121.784 187.556 L113.474 189.223 L113.474 184.964 L121.738 183.297 L126.414 183.297 L126.414 213.922 L134.053 213.922 L134.053 217.857 L114.145 217.857 L114.145 213.922 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip020)\" d=\"M153.497 186.376 Q149.886 186.376 148.057 189.941 Q146.252 193.482 146.252 200.612 Q146.252 207.718 148.057 211.283 Q149.886 214.825 153.497 214.825 Q157.131 214.825 158.937 211.283 Q160.766 207.718 160.766 200.612 Q160.766 193.482 158.937 189.941 Q157.131 186.376 153.497 186.376 M153.497 182.672 Q159.307 182.672 162.363 187.279 Q165.441 191.862 165.441 200.612 Q165.441 209.339 162.363 213.945 Q159.307 218.528 153.497 218.528 Q147.687 218.528 144.608 213.945 Q141.553 209.339 141.553 200.612 Q141.553 191.862 144.608 187.279 Q147.687 182.672 153.497 182.672 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip020)\" d=\"M165.441 176.773 L189.553 176.773 L189.553 179.971 L165.441 179.971 L165.441 176.773 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip020)\" d=\"M198.411 187.249 L204.618 187.249 L204.618 165.827 L197.866 167.181 L197.866 163.721 L204.58 162.367 L208.38 162.367 L208.38 187.249 L214.586 187.249 L214.586 190.447 L198.411 190.447 L198.411 187.249 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><g clip-path=\"url(#clip020)\">\n<text style=\"fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:66px; text-anchor:middle;\" transform=\"rotate(-90, 71.4418, 603.241)\" x=\"71.4418\" y=\"603.241\">elapsed time (sec)</text>\n</g>\n<g clip-path=\"url(#clip020)\">\n<text style=\"fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:66px; text-anchor:middle;\" transform=\"rotate(0, 1098.67, 57.6)\" x=\"1098.67\" y=\"57.6\">Timing of matrix-vector multiplications</text>\n</g>\n<circle clip-path=\"url(#clip022)\" cx=\"292.931\" cy=\"1071.15\" r=\"10.8\" fill=\"#009af9\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"#000000\" stroke-opacity=\"1\" stroke-width=\"2.56\"/>\n<circle clip-path=\"url(#clip022)\" cx=\"534.211\" cy=\"914.19\" r=\"10.8\" fill=\"#009af9\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"#000000\" stroke-opacity=\"1\" stroke-width=\"2.56\"/>\n<circle clip-path=\"url(#clip022)\" cx=\"705.402\" cy=\"871.36\" r=\"10.8\" fill=\"#009af9\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"#000000\" stroke-opacity=\"1\" stroke-width=\"2.56\"/>\n<circle clip-path=\"url(#clip022)\" cx=\"838.188\" cy=\"770.197\" r=\"10.8\" fill=\"#009af9\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"#000000\" stroke-opacity=\"1\" stroke-width=\"2.56\"/>\n<circle clip-path=\"url(#clip022)\" cx=\"946.682\" cy=\"752.961\" r=\"10.8\" fill=\"#009af9\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"#000000\" stroke-opacity=\"1\" stroke-width=\"2.56\"/>\n<circle clip-path=\"url(#clip022)\" cx=\"1038.41\" cy=\"670.366\" r=\"10.8\" fill=\"#009af9\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"#000000\" stroke-opacity=\"1\" stroke-width=\"2.56\"/>\n<circle clip-path=\"url(#clip022)\" cx=\"1117.87\" cy=\"630.023\" r=\"10.8\" fill=\"#009af9\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"#000000\" stroke-opacity=\"1\" stroke-width=\"2.56\"/>\n<circle clip-path=\"url(#clip022)\" cx=\"1187.96\" cy=\"590.824\" r=\"10.8\" fill=\"#009af9\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"#000000\" stroke-opacity=\"1\" stroke-width=\"2.56\"/>\n<circle clip-path=\"url(#clip022)\" cx=\"1250.66\" cy=\"545.541\" r=\"10.8\" fill=\"#009af9\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"#000000\" stroke-opacity=\"1\" stroke-width=\"2.56\"/>\n<circle clip-path=\"url(#clip022)\" cx=\"1307.38\" cy=\"527.491\" r=\"10.8\" fill=\"#009af9\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"#000000\" stroke-opacity=\"1\" stroke-width=\"2.56\"/>\n<circle clip-path=\"url(#clip022)\" cx=\"1359.15\" cy=\"451.549\" r=\"10.8\" fill=\"#009af9\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"#000000\" stroke-opacity=\"1\" stroke-width=\"2.56\"/>\n<circle clip-path=\"url(#clip022)\" cx=\"1406.78\" cy=\"428.686\" r=\"10.8\" fill=\"#009af9\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"#000000\" stroke-opacity=\"1\" stroke-width=\"2.56\"/>\n<circle clip-path=\"url(#clip022)\" cx=\"1450.88\" cy=\"392.493\" r=\"10.8\" fill=\"#009af9\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"#000000\" stroke-opacity=\"1\" stroke-width=\"2.56\"/>\n<circle clip-path=\"url(#clip022)\" cx=\"1491.94\" cy=\"365.132\" r=\"10.8\" fill=\"#009af9\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"#000000\" stroke-opacity=\"1\" stroke-width=\"2.56\"/>\n<circle clip-path=\"url(#clip022)\" cx=\"1530.34\" cy=\"322.606\" r=\"10.8\" fill=\"#009af9\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"#000000\" stroke-opacity=\"1\" stroke-width=\"2.56\"/>\n<circle clip-path=\"url(#clip022)\" cx=\"1566.42\" cy=\"183.89\" r=\"10.8\" fill=\"#009af9\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"#000000\" stroke-opacity=\"1\" stroke-width=\"2.56\"/>\n<circle clip-path=\"url(#clip022)\" cx=\"1600.43\" cy=\"291.761\" r=\"10.8\" fill=\"#009af9\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"#000000\" stroke-opacity=\"1\" stroke-width=\"2.56\"/>\n<circle clip-path=\"url(#clip022)\" cx=\"1632.61\" cy=\"253.352\" r=\"10.8\" fill=\"#009af9\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"#000000\" stroke-opacity=\"1\" stroke-width=\"2.56\"/>\n<circle clip-path=\"url(#clip022)\" cx=\"1663.13\" cy=\"227.157\" r=\"10.8\" fill=\"#009af9\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"#000000\" stroke-opacity=\"1\" stroke-width=\"2.56\"/>\n<circle clip-path=\"url(#clip022)\" cx=\"1692.16\" cy=\"236.349\" r=\"10.8\" fill=\"#009af9\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"#000000\" stroke-opacity=\"1\" stroke-width=\"2.56\"/>\n<circle clip-path=\"url(#clip022)\" cx=\"1719.85\" cy=\"221.833\" r=\"10.8\" fill=\"#009af9\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"#000000\" stroke-opacity=\"1\" stroke-width=\"2.56\"/>\n<circle clip-path=\"url(#clip022)\" cx=\"1746.3\" cy=\"205.039\" r=\"10.8\" fill=\"#009af9\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"#000000\" stroke-opacity=\"1\" stroke-width=\"2.56\"/>\n<circle clip-path=\"url(#clip022)\" cx=\"1771.63\" cy=\"187.936\" r=\"10.8\" fill=\"#009af9\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"#000000\" stroke-opacity=\"1\" stroke-width=\"2.56\"/>\n<circle clip-path=\"url(#clip022)\" cx=\"1795.92\" cy=\"200.005\" r=\"10.8\" fill=\"#009af9\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"#000000\" stroke-opacity=\"1\" stroke-width=\"2.56\"/>\n<circle clip-path=\"url(#clip022)\" cx=\"1819.26\" cy=\"168.309\" r=\"10.8\" fill=\"#009af9\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"#000000\" stroke-opacity=\"1\" stroke-width=\"2.56\"/>\n<circle clip-path=\"url(#clip022)\" cx=\"1841.71\" cy=\"176.836\" r=\"10.8\" fill=\"#009af9\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"#000000\" stroke-opacity=\"1\" stroke-width=\"2.56\"/>\n<circle clip-path=\"url(#clip022)\" cx=\"1863.36\" cy=\"167.054\" r=\"10.8\" fill=\"#009af9\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"#000000\" stroke-opacity=\"1\" stroke-width=\"2.56\"/>\n<circle clip-path=\"url(#clip022)\" cx=\"1884.24\" cy=\"160.921\" r=\"10.8\" fill=\"#009af9\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"#000000\" stroke-opacity=\"1\" stroke-width=\"2.56\"/>\n<circle clip-path=\"url(#clip022)\" cx=\"1904.41\" cy=\"135.331\" r=\"10.8\" fill=\"#009af9\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"#000000\" stroke-opacity=\"1\" stroke-width=\"2.56\"/>\n</svg>\n","content_type":"image/svg+xml"}}}],"key":"u12u6v8C3s"}],"key":"zgtvU7Nq1R"},{"type":"paragraph","position":{"start":{"line":792,"column":1},"end":{"line":792,"column":1}},"children":[{"type":"text","value":"You can see that while the full story is complicated, the graph is trending to a straight line of positive slope. For comparison, we can plot a line that represents ","position":{"start":{"line":792,"column":1},"end":{"line":792,"column":1}},"key":"nulQsZIPXm"},{"type":"inlineMath","value":"O(n^2)","position":{"start":{"line":792,"column":1},"end":{"line":792,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(n^2)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">n</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"cijGvn9LVe"},{"type":"text","value":" growth exactly. (All such lines have slope equal to 2.)","position":{"start":{"line":792,"column":1},"end":{"line":792,"column":1}},"key":"cD2l6cdVFS"}],"key":"B2kT3QvBXP"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"plot!(n, t[end] * (n/n[end]).^2, l=:dash,\n    label=L\"O(n^2)\", legend=:topleft)","key":"rLFGVvdI6e"},{"type":"output","id":"FNxeDsXqAIMPWISlhxW3w","data":[{"output_type":"execute_result","execution_count":75,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"b54e56aabfcea11b10bde475ad097f4b","path":"/build/b54e56aabfcea11b10bde475ad097f4b.png"},"text/html":{"content_type":"text/html","hash":"891a5f272daf8fbcf90380cc67a7509a","path":"/build/891a5f272daf8fbcf90380cc67a7509a.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"0a3fc208328924c5be060ad2f9b01140","path":"/build/0a3fc208328924c5be060ad2f9b01140.svg"}}}],"key":"V7A9PJFhA1"}],"key":"lYcBXawhtq"}],"label":"demo-flops-loglog-julia","identifier":"demo-flops-loglog-julia","html_id":"demo-flops-loglog-julia","key":"AsQVT7gnMg"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-flops-lufact","label":"demo-flops-lufact","kind":"proof:example","position":{"start":{"line":801,"column":1},"end":{"line":801,"column":19}},"children":[{"type":"text","value":"Example ","key":"RuEu59qdqv"},{"type":"text","value":"2.5.6","key":"yk1YpCY75u"}],"template":"Example %s","enumerator":"2.5.6","resolved":true,"html_id":"demo-flops-lufact","remote":true,"url":"/efficiency","dataUrl":"/efficiency.json","key":"aEuOGIHPBK"}],"key":"Bhvy1sAhHG"},{"type":"paragraph","position":{"start":{"line":803,"column":1},"end":{"line":803,"column":1}},"children":[{"type":"text","value":"We’ll test the conclusion of ","position":{"start":{"line":803,"column":1},"end":{"line":803,"column":1}},"key":"sazNZ5ML2n"},{"type":"inlineMath","value":"O(n^3)","position":{"start":{"line":803,"column":1},"end":{"line":803,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><msup><mi>n</mi><mn>3</mn></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(n^3)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">n</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"OcBz0pJAbp"},{"type":"text","value":" flops experimentally, using the built-in ","position":{"start":{"line":803,"column":1},"end":{"line":803,"column":1}},"key":"ATdKMwjg5q"},{"type":"inlineCode","value":"lu","position":{"start":{"line":803,"column":1},"end":{"line":803,"column":1}},"key":"bmoV8Gx2Gs"},{"type":"text","value":" function instead of the purely instructive ","position":{"start":{"line":803,"column":1},"end":{"line":803,"column":1}},"key":"FucfLA8164"},{"type":"inlineCode","value":"lufact","position":{"start":{"line":803,"column":1},"end":{"line":803,"column":1}},"key":"UBbdOtniFS"},{"type":"text","value":".","position":{"start":{"line":803,"column":1},"end":{"line":803,"column":1}},"key":"INZyLLB7nz"}],"key":"cF8NkRJuf8"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"yG7qMitGvO"}],"key":"kg1wZHABuU"},{"type":"paragraph","position":{"start":{"line":806,"column":1},"end":{"line":806,"column":1}},"children":[{"type":"text","value":"The first time a function is invoked, there may be significant time needed to compile it in memory. Thus, when timing a function, run it at least once before beginning the timing.","position":{"start":{"line":806,"column":1},"end":{"line":806,"column":1}},"key":"gk6qxMrLty"}],"key":"KneRAESBNB"}],"class":"dropdown","key":"g1sKU9AIUT"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"lu(randn(3, 3));   # throwaway to force compilation\n\nn = 400:400:4000\nt = []\nfor n in n\n    A = randn(n, n)  \n    time = @elapsed for j in 1:12; lu(A); end\n    push!(t, time)\nend","key":"coJQ7TMr1e"},{"type":"output","id":"PAbPIPIOZfhR8KWEii1bz","data":[],"key":"GnZJbI52xa"}],"key":"jDw2rflO90"},{"type":"paragraph","position":{"start":{"line":821,"column":1},"end":{"line":821,"column":1}},"children":[{"type":"text","value":"We plot the timings on a log-log graph and compare it to ","position":{"start":{"line":821,"column":1},"end":{"line":821,"column":1}},"key":"Dhxjjmnur0"},{"type":"inlineMath","value":"O(n^3)","position":{"start":{"line":821,"column":1},"end":{"line":821,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><msup><mi>n</mi><mn>3</mn></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(n^3)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">n</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"oa0ZFv3608"},{"type":"text","value":". The result could vary significantly from machine to machine, but in theory the data should start to parallel the line as ","position":{"start":{"line":821,"column":1},"end":{"line":821,"column":1}},"key":"VBUfuTiFe3"},{"type":"inlineMath","value":"n\\to\\infty","position":{"start":{"line":821,"column":1},"end":{"line":821,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>→</mo><mi mathvariant=\"normal\">∞</mi></mrow><annotation encoding=\"application/x-tex\">n\\to\\infty</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord\">∞</span></span></span></span>","key":"eYsYabahUv"},{"type":"text","value":".","position":{"start":{"line":821,"column":1},"end":{"line":821,"column":1}},"key":"KwZ4JCbEZv"}],"key":"nNOETSyw6n"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"scatter(n, t, label=\"data\", legend=:topleft,\n    xaxis=(:log10, L\"n\"), yaxis=(:log10, \"elapsed time\"))\nplot!(n, t[end ]* (n/n[end]).^3, l=:dash, label=L\"O(n^3)\")","key":"hZC2ccyXuy"},{"type":"output","id":"mOI7tX-JCA1qfy5LE_j6L","data":[{"output_type":"execute_result","execution_count":77,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"7cb139b05bb7975efc51839a389a40e2","path":"/build/7cb139b05bb7975efc51839a389a40e2.png"},"text/html":{"content_type":"text/html","hash":"f07191bc138bd36f72b637e7a0d995d2","path":"/build/f07191bc138bd36f72b637e7a0d995d2.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"2146dec32cca142f9411219485ace40b","path":"/build/2146dec32cca142f9411219485ace40b.svg"}}}],"key":"xGjuflq4Ky"}],"key":"vCrEYPyTlB"}],"label":"demo-flops-lufact-julia","identifier":"demo-flops-lufact-julia","html_id":"demo-flops-lufact-julia","key":"FnRTpWw8L9"},{"type":"heading","depth":3,"position":{"start":{"line":830,"column":1},"end":{"line":830,"column":1}},"children":[{"type":"text","value":"2.6 ","position":{"start":{"line":830,"column":1},"end":{"line":830,"column":1}},"key":"dLHxV15ijz"},{"type":"link","identifier":"section-linsys-pivoting","label":"section-linsys-pivoting","kind":"narrative","position":{"start":{"line":830,"column":5},"end":{"line":830,"column":29}},"url":"/pivoting","internal":true,"dataUrl":"/pivoting.json","children":[{"type":"text","value":"Row pivoting","key":"eIcIjTzZM0"}],"key":"Mwh6xzrmsm"}],"identifier":"id-2-6","label":"2.6 ","html_id":"id-2-6","implicit":true,"key":"D09c3vClER"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-pivoting-fail","label":"demo-pivoting-fail","kind":"proof:example","position":{"start":{"line":832,"column":1},"end":{"line":832,"column":20}},"children":[{"type":"text","value":"Example ","key":"BhRKQvqBf6"},{"type":"text","value":"2.6.1","key":"YsRMfbyRC1"}],"template":"Example %s","enumerator":"2.6.1","resolved":true,"html_id":"demo-pivoting-fail","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"dCNzI35sU5"}],"key":"HfIN2puYGm"},{"type":"paragraph","position":{"start":{"line":834,"column":1},"end":{"line":834,"column":1}},"children":[{"type":"text","value":"Here is a previously encountered matrix that factors well.","position":{"start":{"line":834,"column":1},"end":{"line":834,"column":1}},"key":"QTVltQid1X"}],"key":"lvFR5TuEau"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"A = [2 0 4 3 ; -4 5 -7 -10 ; 1 15 2 -4.5 ; -2 0 2 -13];\nL, U = FNC.lufact(A)\nL","key":"bMyrRLu9sk"},{"type":"output","id":"huLU3Gxe0nMKBGg-iOAWT","data":[{"output_type":"execute_result","execution_count":78,"metadata":{},"data":{"text/plain":{"content":"4×4 LowerTriangular{Float64, Matrix{Float64}}:\n  1.0   ⋅     ⋅    ⋅ \n -2.0  1.0    ⋅    ⋅ \n  0.5  3.0   1.0   ⋅ \n -1.0  0.0  -2.0  1.0","content_type":"text/plain"}}}],"key":"FsICf2YQ7e"}],"key":"e1uTiydgMx"},{"type":"paragraph","position":{"start":{"line":842,"column":1},"end":{"line":842,"column":1}},"children":[{"type":"text","value":"If we swap the second and fourth rows of ","position":{"start":{"line":842,"column":1},"end":{"line":842,"column":1}},"key":"Fo5mDojFYE"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":842,"column":1},"end":{"line":842,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"GCYSIKDUCW"},{"type":"text","value":", the result is still nonsingular. However, the factorization now fails.","position":{"start":{"line":842,"column":1},"end":{"line":842,"column":1}},"key":"HXgLgobCyC"}],"key":"JbxSQ8FVMH"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"A[[2, 4], :] = A[[4, 2], :]  \nL, U = FNC.lufact(A)\nL","key":"o516QABTwJ"},{"type":"output","id":"68QHpDewcRTQa0Z-Xbtoj","data":[{"output_type":"execute_result","execution_count":79,"metadata":{},"data":{"text/plain":{"content":"4×4 LowerTriangular{Float64, Matrix{Float64}}:\n  1.0     ⋅      ⋅    ⋅ \n -1.0  NaN       ⋅    ⋅ \n  0.5   Inf   NaN     ⋅ \n -2.0   Inf   NaN    1.0","content_type":"text/plain"}}}],"key":"IIFMMcxT8l"}],"key":"x284zmcpkn"},{"type":"paragraph","position":{"start":{"line":853,"column":1},"end":{"line":853,"column":1}},"children":[{"type":"text","value":"The presence of ","position":{"start":{"line":853,"column":1},"end":{"line":853,"column":1}},"key":"doFg3uhGoi"},{"type":"inlineCode","value":"NaN","position":{"start":{"line":853,"column":1},"end":{"line":853,"column":1}},"key":"H5aykux9mH"},{"type":"text","value":" in the result indicates that some impossible operation was required. The source of the problem is easy to locate. We can find the first outer product in the factorization just fine:","position":{"start":{"line":853,"column":1},"end":{"line":853,"column":1}},"key":"hatr6HYctn"}],"indexEntries":[{"entry":"Julia","subEntry":{"value":"NaN","kind":"entry"},"emphasis":false}],"label":"index-Y53bOkMRKV","identifier":"index-y53bokmrkv","html_id":"index-y53bokmrkv","key":"xUxh2Xlcvs"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"U[1, :] = A[1, :]\nL[:, 1] = A[:, 1] / U[1, 1]\nA -= L[:, 1] * U[1, :]'","key":"wFUEZtZUvM"},{"type":"output","id":"zr4gk9MN-Fr-LA1vm5yDa","data":[{"output_type":"execute_result","execution_count":80,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n 0.0   0.0  0.0    0.0\n 0.0   0.0  6.0  -10.0\n 0.0  15.0  0.0   -6.0\n 0.0   5.0  1.0   -4.0","content_type":"text/plain"}}}],"key":"VEyRtpjByS"}],"key":"Hl5zFoYlAN"},{"type":"paragraph","position":{"start":{"line":861,"column":1},"end":{"line":861,"column":1}},"children":[{"type":"text","value":"The next step is ","position":{"start":{"line":861,"column":1},"end":{"line":861,"column":1}},"key":"ozDDe9AeGB"},{"type":"inlineCode","value":"U[2, :] = A[2, :]","position":{"start":{"line":861,"column":1},"end":{"line":861,"column":1}},"key":"vhipKCzFcV"},{"type":"text","value":", which is also OK. But then we are supposed to divide by ","position":{"start":{"line":861,"column":1},"end":{"line":861,"column":1}},"key":"GH4igwftwn"},{"type":"inlineCode","value":"U[2, 2]","position":{"start":{"line":861,"column":1},"end":{"line":861,"column":1}},"key":"LzuopfM72a"},{"type":"text","value":", which is zero. The algorithm cannot continue.","position":{"start":{"line":861,"column":1},"end":{"line":861,"column":1}},"key":"xfXrQmlqN0"}],"key":"nSeZWmAmB8"}],"label":"demo-pivoting-fail-julia","identifier":"demo-pivoting-fail-julia","html_id":"demo-pivoting-fail-julia","key":"uy31qgoT0y"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-pivoting-fix","label":"demo-pivoting-fix","kind":"proof:example","position":{"start":{"line":865,"column":1},"end":{"line":865,"column":19}},"children":[{"type":"text","value":"Example ","key":"Wy4InoqwVX"},{"type":"text","value":"2.6.2","key":"XlqzUe0xqb"}],"template":"Example %s","enumerator":"2.6.2","resolved":true,"html_id":"demo-pivoting-fix","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"mrvmKG4a4h"}],"key":"fAygBw1wPO"},{"type":"paragraph","position":{"start":{"line":867,"column":1},"end":{"line":867,"column":1}},"children":[{"type":"text","value":"Here is the trouble-making matrix from ","position":{"start":{"line":867,"column":1},"end":{"line":867,"column":1}},"key":"y0YWSaeWBL"},{"type":"crossReference","identifier":"demo-pivoting-fail","label":"demo-pivoting-fail","kind":"proof:example","position":{"start":{"line":867,"column":40},"end":{"line":867,"column":59}},"children":[{"type":"text","value":"Example ","key":"n26aJIN8Vb"},{"type":"text","value":"2.6.1","key":"km8TVrpOyk"}],"template":"Example %s","enumerator":"2.6.1","resolved":true,"html_id":"demo-pivoting-fail","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"y2BoQJnzKD"},{"type":"text","value":".","position":{"start":{"line":867,"column":1},"end":{"line":867,"column":1}},"key":"UOoEWCi2l3"}],"key":"tTV0qA4zpu"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"A₁ = [2 0 4 3 ; -2 0 2 -13; 1 15 2 -4.5 ; -4 5 -7 -10]","key":"pjavdl1Idp"},{"type":"output","id":"7Z_FI3pQt54b4ein7L4Dr","data":[{"output_type":"execute_result","execution_count":81,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n  2.0   0.0   4.0    3.0\n -2.0   0.0   2.0  -13.0\n  1.0  15.0   2.0   -4.5\n -4.0   5.0  -7.0  -10.0","content_type":"text/plain"}}}],"key":"rdKinLOq6R"}],"key":"fnhbQH5rrI"},{"type":"paragraph","position":{"start":{"line":873,"column":1},"end":{"line":873,"column":1}},"children":[{"type":"text","value":"We now find the largest candidate pivot in the first column. We don’t care about sign, so we take absolute values before finding the max.","position":{"start":{"line":873,"column":1},"end":{"line":873,"column":1}},"key":"XefmO0wS3E"}],"key":"vR1mzNYbYu"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"zf7WWi137q"}],"key":"nZKWsbK62u"},{"type":"paragraph","position":{"start":{"line":876,"column":1},"end":{"line":876,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":876,"column":1},"end":{"line":876,"column":1}},"key":"DPvU5EEqgf"},{"type":"inlineCode","value":"argmax","position":{"start":{"line":876,"column":1},"end":{"line":876,"column":1}},"key":"opiMkhNKZc"},{"type":"text","value":" function returns the location of the largest element of a vector or matrix.","position":{"start":{"line":876,"column":1},"end":{"line":876,"column":1}},"key":"dZiBWVdAe3"}],"key":"fDHigj8mv4"}],"class":"dropdown","key":"HXuvBGCkZw"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"i = argmax( abs.(A₁[:, 1]) )","key":"IiPcT3oaXh"},{"type":"output","id":"Ykt794qbWSQmBL0NXBie1","data":[{"output_type":"execute_result","execution_count":82,"metadata":{},"data":{"text/plain":{"content":"4","content_type":"text/plain"}}}],"key":"m17yL9EvGP"}],"key":"fswAnD6rSk"},{"type":"paragraph","position":{"start":{"line":884,"column":1},"end":{"line":884,"column":1}},"children":[{"type":"text","value":"This is the row of the matrix that we extract to put into ","position":{"start":{"line":884,"column":1},"end":{"line":884,"column":1}},"key":"UBsOLzsBvP"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":884,"column":1},"end":{"line":884,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"o4O6iwwjNA"},{"type":"text","value":". That guarantees that the division used to find ","position":{"start":{"line":884,"column":1},"end":{"line":884,"column":1}},"key":"rng6cSpa9j"},{"type":"inlineMath","value":"\\boldsymbol{\\ell}_1","position":{"start":{"line":884,"column":1},"end":{"line":884,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">ℓ</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\boldsymbol{\\ell}_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">ℓ</span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"OQDR4fh5Ft"},{"type":"text","value":" will be valid.","position":{"start":{"line":884,"column":1},"end":{"line":884,"column":1}},"key":"I08ewhTKyG"}],"key":"l2mtf8Px2e"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"L, U = zeros(4,4),zeros(4,4)\nU[1, :] = A₁[i, :]\nL[:, 1] = A₁[:, 1] / U[1, 1]\nA₂ = A₁ - L[:, 1] * U[1, :]'","key":"Hoxu2uthgW"},{"type":"output","id":"Nc_Q9eLar4lnSYxVPK28E","data":[{"output_type":"execute_result","execution_count":83,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n 0.0   2.5   0.5   -2.0\n 0.0  -2.5   5.5   -8.0\n 0.0  16.25  0.25  -7.0\n 0.0   0.0   0.0    0.0","content_type":"text/plain"}}}],"key":"JL9AvA0c3T"}],"key":"uMZMyfHGeh"},{"type":"paragraph","position":{"start":{"line":893,"column":1},"end":{"line":893,"column":1}},"children":[{"type":"text","value":"Observe that ","position":{"start":{"line":893,"column":1},"end":{"line":893,"column":1}},"key":"LjgrMtWjBp"},{"type":"inlineMath","value":"\\mathbf{A}_2","position":{"start":{"line":893,"column":1},"end":{"line":893,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">A</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8361em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"n5zdglR2bP"},{"type":"text","value":" has a new zero row and zero column, but the zero row is the fourth rather than the first. However, we forge on by using the largest possible pivot in column 2 for the next outer product.","position":{"start":{"line":893,"column":1},"end":{"line":893,"column":1}},"key":"nuFBJDh5j6"}],"key":"Swtezkotn7"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"@show i = argmax( abs.(A₂[:, 2]) ) \nU[2, :] = A₂[i, :]\nL[:, 2] = A₂[:, 2] / U[2, 2]\nA₃ = A₂ - L[:, 2] * U[2, :]'","key":"osGFcZGDVH"},{"type":"output","id":"aiP5OAbI6_Or5066rUPzG","data":[{"output_type":"stream","name":"stdout","text":"i = argmax(abs.(A₂[:, 2])) = 3\n"},{"output_type":"execute_result","execution_count":84,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n 0.0  0.0  0.461538  -0.923077\n 0.0  0.0  5.53846   -9.07692\n 0.0  0.0  0.0        0.0\n 0.0  0.0  0.0        0.0","content_type":"text/plain"}}}],"key":"papjkoDCTq"}],"key":"TIVX14aqlC"},{"type":"paragraph","position":{"start":{"line":902,"column":1},"end":{"line":902,"column":1}},"children":[{"type":"text","value":"Now we have zeroed out the third row as well as the second column. We can finish out the procedure.","position":{"start":{"line":902,"column":1},"end":{"line":902,"column":1}},"key":"a4QPkALMd8"}],"key":"KqAORsyui2"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"@show i = argmax( abs.(A₃[:, 3]) ) \nU[3, :] = A₃[i, :]\nL[:, 3] = A₃[:, 3] / U[3, 3]\nA₄ = A₃ - L[:, 3] * U[3, :]'","key":"cXTL1E488n"},{"type":"output","id":"pubJ70jY9PLC7SKEpKi-h","data":[{"output_type":"stream","name":"stdout","text":"i = argmax(abs.(A₃[:, 3])) = 2\n"},{"output_type":"execute_result","execution_count":85,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n 0.0  0.0  0.0  -0.166667\n 0.0  0.0  0.0   0.0\n 0.0  0.0  0.0   0.0\n 0.0  0.0  0.0   0.0","content_type":"text/plain"}}}],"key":"Gb6BW3chHN"}],"key":"GZRKpsTnTi"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"@show i = argmax( abs.(A₄[:, 4]) ) \nU[4, :] = A₄[i, :]\nL[:, 4] = A₄[:, 4] / U[4, 4];","key":"T5RpbMcDdP"},{"type":"output","id":"gw4eODsy0uC8lwZ1-zJwz","data":[{"output_type":"stream","name":"stdout","text":"i = argmax(abs.(A₄[:, 4])) = 1\n"}],"key":"eY4zvMMFlJ"}],"key":"L1N6okgWfy"},{"type":"paragraph","position":{"start":{"line":917,"column":1},"end":{"line":917,"column":1}},"children":[{"type":"text","value":"We do have a factorization of the original matrix:","position":{"start":{"line":917,"column":1},"end":{"line":917,"column":1}},"key":"WoTYhpAxRX"}],"key":"id7198O9iE"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"A₁ - L * U","key":"AiGyGbdw7C"},{"type":"output","id":"9bKuAaHEUOMeqGCtrd4kW","data":[{"output_type":"execute_result","execution_count":87,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n 0.0  -1.38778e-16  0.0  0.0\n 0.0   1.38778e-16  0.0  0.0\n 0.0   0.0          0.0  0.0\n 0.0   0.0          0.0  0.0","content_type":"text/plain"}}}],"key":"NzbfkBRxed"}],"key":"eLxJbUfBN7"},{"type":"paragraph","position":{"start":{"line":923,"column":1},"end":{"line":923,"column":1}},"children":[{"type":"text","value":"And ","position":{"start":{"line":923,"column":1},"end":{"line":923,"column":1}},"key":"PCkI735Tnu"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":923,"column":1},"end":{"line":923,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"L5mKZZGh6m"},{"type":"text","value":" has the required structure:","position":{"start":{"line":923,"column":1},"end":{"line":923,"column":1}},"key":"cwNRtO6mcT"}],"key":"yQ8DJCEw4x"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"U","key":"eMBieMLflM"},{"type":"output","id":"HTs50kVp_8AmvtgrqXjCK","data":[{"output_type":"execute_result","execution_count":88,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n -4.0   5.0   -7.0      -10.0\n  0.0  16.25   0.25      -7.0\n  0.0   0.0    5.53846   -9.07692\n  0.0   0.0    0.0       -0.166667","content_type":"text/plain"}}}],"key":"RzwtP97ku3"}],"key":"soPb0heDMj"},{"type":"paragraph","position":{"start":{"line":929,"column":1},"end":{"line":929,"column":1}},"children":[{"type":"text","value":"However, the triangularity of ","position":{"start":{"line":929,"column":1},"end":{"line":929,"column":1}},"key":"g219huolK2"},{"type":"inlineMath","value":"\\mathbf{L}","position":{"start":{"line":929,"column":1},"end":{"line":929,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">L</span></span></span></span>","key":"V4lkU0i15r"},{"type":"text","value":" has been broken.","position":{"start":{"line":929,"column":1},"end":{"line":929,"column":1}},"key":"lo0wGzi0Ow"}],"key":"of1LsYDVRE"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"L","key":"qYqDTnDX9h"},{"type":"output","id":"JBVYn8MIHV1AMxuk8B45m","data":[{"output_type":"execute_result","execution_count":89,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n -0.5    0.153846  0.0833333   1.0\n  0.5   -0.153846  1.0        -0.0\n -0.25   1.0       0.0        -0.0\n  1.0    0.0       0.0        -0.0","content_type":"text/plain"}}}],"key":"tHu5sml5rx"}],"key":"DMiTNN4TW1"}],"label":"demo-pivoting-fix-julia","identifier":"demo-pivoting-fix-julia","html_id":"demo-pivoting-fix-julia","key":"duCNUAslXz"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-pivoting-permute","label":"demo-pivoting-permute","kind":"proof:example","position":{"start":{"line":937,"column":1},"end":{"line":937,"column":23}},"children":[{"type":"text","value":"Example ","key":"MkTMIIIupI"},{"type":"text","value":"2.6.3","key":"FdgYWUwAtU"}],"template":"Example %s","enumerator":"2.6.3","resolved":true,"html_id":"demo-pivoting-permute","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"KSoD8iGkXt"}],"key":"i0Mpv4eVN8"},{"type":"paragraph","position":{"start":{"line":939,"column":1},"end":{"line":939,"column":1}},"children":[{"type":"text","value":"Here again is the matrix from ","position":{"start":{"line":939,"column":1},"end":{"line":939,"column":1}},"key":"GAE2CZZIS3"},{"type":"crossReference","identifier":"demo-pivoting-fix","label":"demo-pivoting-fix","kind":"proof:example","position":{"start":{"line":939,"column":31},"end":{"line":939,"column":49}},"children":[{"type":"text","value":"Example ","key":"SE6wIgnRht"},{"type":"text","value":"2.6.2","key":"yPGzN31vJN"}],"template":"Example %s","enumerator":"2.6.2","resolved":true,"html_id":"demo-pivoting-fix","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"Bw3NpXsATr"},{"type":"text","value":".","position":{"start":{"line":939,"column":1},"end":{"line":939,"column":1}},"key":"dhhHG1p7tG"}],"key":"PXz1HDLqPc"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"A = [2 0 4 3 ; -2 0 2 -13; 1 15 2 -4.5 ; -4 5 -7 -10]","key":"uuKh519dvg"},{"type":"output","id":"28X8YQCvgf-4FFTvNr_G_","data":[{"output_type":"execute_result","execution_count":90,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n  2.0   0.0   4.0    3.0\n -2.0   0.0   2.0  -13.0\n  1.0  15.0   2.0   -4.5\n -4.0   5.0  -7.0  -10.0","content_type":"text/plain"}}}],"key":"NHjLGKPkRz"}],"key":"CI7zukbtvG"},{"type":"paragraph","position":{"start":{"line":945,"column":1},"end":{"line":945,"column":1}},"children":[{"type":"text","value":"As the factorization proceeded, the pivots were selected from rows 4, 3, 2, and finally 1. If we were to put the rows of ","position":{"start":{"line":945,"column":1},"end":{"line":945,"column":1}},"key":"W2l7mrWdcr"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":945,"column":1},"end":{"line":945,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"XtvbdOBiRA"},{"type":"text","value":" into that order, then the algorithm would run exactly like the plain LU factorization from ","position":{"start":{"line":945,"column":1},"end":{"line":945,"column":1}},"key":"xXLA88f3Xg"},{"type":"link","kind":"numref","identifier":"section-linsys-lu","label":"section-linsys-lu","url":"/lu","internal":true,"dataUrl":"/lu.json","children":[{"type":"text","value":"LU factorization","key":"e7W9fxVeOQ"}],"key":"dzLAiGLIF8"},{"type":"text","value":".","position":{"start":{"line":945,"column":1},"end":{"line":945,"column":1}},"key":"xH1tOvAuTA"}],"key":"hwhCyvG0QA"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"B = A[[4, 3, 2, 1], :]\nL, U = FNC.lufact(B);","key":"jXPJ4pu6s8"},{"type":"output","id":"xPaO7RgnrHLSq2wrC7X-O","data":[],"key":"FgR5Gs4zN2"}],"key":"Q0S0wUA8g0"},{"type":"paragraph","position":{"start":{"line":952,"column":1},"end":{"line":952,"column":1}},"children":[{"type":"text","value":"We obtain the same ","position":{"start":{"line":952,"column":1},"end":{"line":952,"column":1}},"key":"wuloq6pBb2"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":952,"column":1},"end":{"line":952,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"xOyHVysDvw"},{"type":"text","value":" as before:","position":{"start":{"line":952,"column":1},"end":{"line":952,"column":1}},"key":"RlF4cPIQ9d"}],"key":"Tw84TJjlSc"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"U","key":"sHtUkYKZGf"},{"type":"output","id":"ko70Ukj1iA2uNE9Dd_52W","data":[{"output_type":"execute_result","execution_count":92,"metadata":{},"data":{"text/plain":{"content":"4×4 UpperTriangular{Float64, Matrix{Float64}}:\n -4.0   5.0   -7.0      -10.0\n   ⋅   16.25   0.25      -7.0\n   ⋅     ⋅     5.53846   -9.07692\n   ⋅     ⋅      ⋅        -0.166667","content_type":"text/plain"}}}],"key":"mncBNvhNEd"}],"key":"SJDfMItR1L"},{"type":"paragraph","position":{"start":{"line":958,"column":1},"end":{"line":958,"column":1}},"children":[{"type":"text","value":"And ","position":{"start":{"line":958,"column":1},"end":{"line":958,"column":1}},"key":"JY8twwchlk"},{"type":"inlineMath","value":"\\mathbf{L}","position":{"start":{"line":958,"column":1},"end":{"line":958,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">L</span></span></span></span>","key":"OBL24Bwrip"},{"type":"text","value":" has the same rows as before, but arranged into triangular order:","position":{"start":{"line":958,"column":1},"end":{"line":958,"column":1}},"key":"JQxhViaCq7"}],"key":"dyy3u4yURh"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"L","key":"u7QHvjluVW"},{"type":"output","id":"cGnGLhc2M2s3rxcnohGxJ","data":[{"output_type":"execute_result","execution_count":93,"metadata":{},"data":{"text/plain":{"content":"4×4 LowerTriangular{Float64, Matrix{Float64}}:\n  1.0     ⋅         ⋅          ⋅ \n -0.25   1.0        ⋅          ⋅ \n  0.5   -0.153846  1.0         ⋅ \n -0.5    0.153846  0.0833333  1.0","content_type":"text/plain"}}}],"key":"dhrY3pEKfd"}],"key":"FDv2LvB7G0"}],"label":"demo-pivoting-permute-julia","identifier":"demo-pivoting-permute-julia","html_id":"demo-pivoting-permute-julia","key":"MlOUTDr6NC"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-pivoting-usage","label":"demo-pivoting-usage","kind":"proof:example","position":{"start":{"line":966,"column":1},"end":{"line":966,"column":21}},"children":[{"type":"text","value":"Example ","key":"FkeUehWC80"},{"type":"text","value":"2.6.4","key":"F2JwmeCn1H"}],"template":"Example %s","enumerator":"2.6.4","resolved":true,"html_id":"demo-pivoting-usage","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"MwzW20wVLs"}],"key":"hhfHcDX2WL"},{"type":"paragraph","position":{"start":{"line":968,"column":1},"end":{"line":968,"column":1}},"children":[{"type":"text","value":"The third output of ","position":{"start":{"line":968,"column":1},"end":{"line":968,"column":1}},"key":"o0qLQAAmNT"},{"type":"inlineCode","value":"plufact","position":{"start":{"line":968,"column":1},"end":{"line":968,"column":1}},"key":"YMOBEqZQfu"},{"type":"text","value":" is the permutation vector we need to apply to ","position":{"start":{"line":968,"column":1},"end":{"line":968,"column":1}},"key":"z0idvyolBT"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":968,"column":1},"end":{"line":968,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"f4KdsKZDGv"},{"type":"text","value":".","position":{"start":{"line":968,"column":1},"end":{"line":968,"column":1}},"key":"yqR4dxcTP5"}],"key":"d9VGsAvgEn"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"A = rand(1:20, 4, 4)\nL, U, p = FNC.plufact(A)\nA[p,:] - L * U   # should be ≈ 0","key":"TXTWevEe4Z"},{"type":"output","id":"Y42jejc9fEoeMp50larPy","data":[{"output_type":"execute_result","execution_count":94,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n 0.0  0.0  0.0          0.0\n 0.0  0.0  0.0          0.0\n 0.0  0.0  0.0          0.0\n 0.0  0.0  8.88178e-16  0.0","content_type":"text/plain"}}}],"key":"yQbQgg73OS"}],"key":"SOQF0jPKMc"},{"type":"paragraph","position":{"start":{"line":976,"column":1},"end":{"line":976,"column":1}},"children":[{"type":"text","value":"Given a vector ","position":{"start":{"line":976,"column":1},"end":{"line":976,"column":1}},"key":"Uw5qebuU33"},{"type":"inlineMath","value":"\\mathbf{b}","position":{"start":{"line":976,"column":1},"end":{"line":976,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"k73VOHmW2W"},{"type":"text","value":", we solve ","position":{"start":{"line":976,"column":1},"end":{"line":976,"column":1}},"key":"DB9rTqyS1x"},{"type":"inlineMath","value":"\\mathbf{A}\\mathbf{x}=\\mathbf{b}","position":{"start":{"line":976,"column":1},"end":{"line":976,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi><mi mathvariant=\"bold\">x</mi><mo>=</mo><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}\\mathbf{x}=\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">Ax</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"Y9a3pyHgPD"},{"type":"text","value":" by first permuting the entries of ","position":{"start":{"line":976,"column":1},"end":{"line":976,"column":1}},"key":"tA4DhmNRIj"},{"type":"inlineMath","value":"\\mathbf{b}","position":{"start":{"line":976,"column":1},"end":{"line":976,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"EIA88yvcmq"},{"type":"text","value":" and then proceeding as before.","position":{"start":{"line":976,"column":1},"end":{"line":976,"column":1}},"key":"VgOOOU4FAP"}],"key":"AtrQCGACjb"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"b = rand(4)\nz = FNC.forwardsub(L,b[p])\nx = FNC.backsub(U,z)","key":"dUUE0DRyB6"},{"type":"output","id":"OUa8pJmZnElMAAg6rs3Z7","data":[{"output_type":"execute_result","execution_count":95,"metadata":{},"data":{"text/plain":{"content":"4-element Vector{Float64}:\n -0.017919223295716297\n  0.05327729444860891\n -0.04843588667431248\n  0.062460046127767246","content_type":"text/plain"}}}],"key":"t50J4AKRbX"}],"key":"fkUr2smrjz"},{"type":"paragraph","position":{"start":{"line":984,"column":1},"end":{"line":984,"column":1}},"children":[{"type":"text","value":"A residual check is successful:","position":{"start":{"line":984,"column":1},"end":{"line":984,"column":1}},"key":"WIRvLOiG9p"}],"key":"dyC7fHXA4s"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"b - A*x","key":"dvN8NDTdrH"},{"type":"output","id":"6sln7jTfBwNpB8xYsK8HL","data":[{"output_type":"execute_result","execution_count":96,"metadata":{},"data":{"text/plain":{"content":"4-element Vector{Float64}:\n -1.1102230246251565e-16\n -1.1102230246251565e-16\n -1.1102230246251565e-16\n  0.0","content_type":"text/plain"}}}],"key":"ZWZrp94Om3"}],"key":"KIg0BichHZ"}],"label":"demo-pivoting-usage-julia","identifier":"demo-pivoting-usage-julia","html_id":"demo-pivoting-usage-julia","key":"mKpB82ioTO"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-pivoting-builtin","label":"demo-pivoting-builtin","kind":"proof:example","position":{"start":{"line":992,"column":1},"end":{"line":992,"column":23}},"children":[{"type":"text","value":"Example ","key":"kkqZpRiJp0"},{"type":"text","value":"2.6.5","key":"vpBXT8yZsr"}],"template":"Example %s","enumerator":"2.6.5","resolved":true,"html_id":"demo-pivoting-builtin","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"eK4XSxvYe9"}],"key":"MNyQLQZWgB"},{"type":"paragraph","position":{"start":{"line":994,"column":1},"end":{"line":994,"column":1}},"children":[{"type":"text","value":"With the syntax ","position":{"start":{"line":994,"column":1},"end":{"line":994,"column":1}},"key":"LKAU58vuqU"},{"type":"inlineCode","value":"A \\ b","position":{"start":{"line":994,"column":1},"end":{"line":994,"column":1}},"key":"T5N0x7LO7A"},{"type":"text","value":", the matrix ","position":{"start":{"line":994,"column":1},"end":{"line":994,"column":1}},"key":"tKVWlZr0x3"},{"type":"inlineCode","value":"A","position":{"start":{"line":994,"column":1},"end":{"line":994,"column":1}},"key":"EXNJS58hQI"},{"type":"text","value":" is PLU-factored, followed by two triangular solves.","position":{"start":{"line":994,"column":1},"end":{"line":994,"column":1}},"key":"VL4KcOljK0"}],"key":"yme4thEr9P"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"A = randn(500, 500)    # 500x500 with normal random entries\nA \\ rand(500)          # force compilation for timing\n@elapsed for k=1:50; A \\ rand(500); end","key":"i2Wzc6hYkY"},{"type":"output","id":"IlqcuJztHOqLlr4CS_6PV","data":[{"output_type":"execute_result","execution_count":97,"metadata":{},"data":{"text/plain":{"content":"0.086060709","content_type":"text/plain"}}}],"key":"ilVMDVGDr8"}],"key":"hXDFpSarjA"},{"type":"paragraph","position":{"start":{"line":1002,"column":1},"end":{"line":1002,"column":1}},"children":[{"type":"text","value":"In ","position":{"start":{"line":1002,"column":1},"end":{"line":1002,"column":1}},"key":"LdPP4A70Io"},{"type":"link","kind":"numref","identifier":"section-linsys-efficiency","label":"section-linsys-efficiency","url":"/efficiency","internal":true,"dataUrl":"/efficiency.json","children":[{"type":"text","value":"Efficiency of matrix computations","key":"HjksocRmH4"}],"key":"PruqgEFgD7"},{"type":"text","value":" we showed that the factorization is by far the most costly part of the solution process. The ","position":{"start":{"line":1002,"column":1},"end":{"line":1002,"column":1}},"key":"LndaahxKbg"},{"type":"inlineCode","value":"lu","position":{"start":{"line":1002,"column":1},"end":{"line":1002,"column":1}},"key":"PVTl15rgMY"},{"type":"text","value":" function from the built-in package ","position":{"start":{"line":1002,"column":1},"end":{"line":1002,"column":1}},"key":"Y1hQli7qwc"},{"type":"inlineCode","value":"LinearAlgebra","position":{"start":{"line":1002,"column":1},"end":{"line":1002,"column":1}},"key":"SdEo8lJZ9o"},{"type":"text","value":" returns a factorization object that allows us to do that costly step only once per unique matrix.","position":{"start":{"line":1002,"column":1},"end":{"line":1002,"column":1}},"key":"MeGgWWkhN0"}],"key":"HIjKNCUyzm"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"factored = lu(A)       # store factorization result\nfactored \\ rand(500)   # force compilation for timing\n@elapsed for k=1:50; factored \\ rand(500); end","key":"uJW8GqXsUF"},{"type":"output","id":"Hz7bGGXQsRi6KkchRmrO0","data":[{"output_type":"execute_result","execution_count":98,"metadata":{},"data":{"text/plain":{"content":"0.002334416","content_type":"text/plain"}}}],"key":"xa1yjUWz4V"}],"key":"AXimjPuWqM"}],"label":"demo-pivoting-builtin-julia","identifier":"demo-pivoting-builtin-julia","html_id":"demo-pivoting-builtin-julia","key":"hwKghsUCkN"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-pivoting-stable","label":"demo-pivoting-stable","kind":"proof:example","position":{"start":{"line":1012,"column":1},"end":{"line":1012,"column":22}},"children":[{"type":"text","value":"Example ","key":"Pr7kjs5ZLL"},{"type":"text","value":"2.6.6","key":"iIJD25ENBH"}],"template":"Example %s","enumerator":"2.6.6","resolved":true,"html_id":"demo-pivoting-stable","remote":true,"url":"/pivoting","dataUrl":"/pivoting.json","key":"mckJnEOGgP"}],"key":"k7C3OklPw3"},{"type":"paragraph","position":{"start":{"line":1014,"column":1},"end":{"line":1014,"column":1}},"children":[{"type":"text","value":"We construct a linear system for this matrix with ","position":{"start":{"line":1014,"column":1},"end":{"line":1014,"column":1}},"key":"WMLpKkXuYM"},{"type":"inlineMath","value":"\\epsilon=10^{-12}","position":{"start":{"line":1014,"column":1},"end":{"line":1014,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ϵ</mi><mo>=</mo><mn>1</mn><msup><mn>0</mn><mrow><mo>−</mo><mn>12</mn></mrow></msup></mrow><annotation encoding=\"application/x-tex\">\\epsilon=10^{-12}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">ϵ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">12</span></span></span></span></span></span></span></span></span></span></span></span>","key":"tnX83TaeEG"},{"type":"text","value":" and exact solution ","position":{"start":{"line":1014,"column":1},"end":{"line":1014,"column":1}},"key":"uwu7VBMpyq"},{"type":"inlineMath","value":"[1,1]","position":{"start":{"line":1014,"column":1},"end":{"line":1014,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[1,1]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]</span></span></span></span>","key":"ocayubNs0H"},{"type":"text","value":":","position":{"start":{"line":1014,"column":1},"end":{"line":1014,"column":1}},"key":"z69CogYU6D"}],"key":"ERjRnZqDuH"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"ϵ = 1e-12\nA = [-ϵ 1; 1 -1]\nb = A * [1, 1]","key":"f7S3OmGsun"},{"type":"output","id":"hmekzGDKsszyOf8Itq4mW","data":[{"output_type":"execute_result","execution_count":99,"metadata":{},"data":{"text/plain":{"content":"2-element Vector{Float64}:\n 0.999999999999\n 0.0","content_type":"text/plain"}}}],"key":"fhICjTdWKt"}],"key":"bJSWYwhH0S"},{"type":"paragraph","position":{"start":{"line":1022,"column":1},"end":{"line":1022,"column":1}},"children":[{"type":"text","value":"We can factor the matrix without pivoting and solve for ","position":{"start":{"line":1022,"column":1},"end":{"line":1022,"column":1}},"key":"xB8KfqhZgn"},{"type":"inlineMath","value":"\\mathbf{x}","position":{"start":{"line":1022,"column":1},"end":{"line":1022,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">x</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{x}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4444em;\"></span><span class=\"mord mathbf\">x</span></span></span></span>","key":"QuCPHgKJSp"},{"type":"text","value":".","position":{"start":{"line":1022,"column":1},"end":{"line":1022,"column":1}},"key":"qRyNo1jEJe"}],"key":"tAVoh2VIyK"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"L, U = FNC.lufact(A)\nx = FNC.backsub( U, FNC.forwardsub(L, b) )","key":"kTeEcJ6SFo"},{"type":"output","id":"i-RDgsLUhJgSua9OXdgEr","data":[{"output_type":"execute_result","execution_count":100,"metadata":{},"data":{"text/plain":{"content":"2-element Vector{Float64}:\n 0.9999778782798785\n 1.0","content_type":"text/plain"}}}],"key":"VDCgFxpSeQ"}],"key":"oVwMr76MaA"},{"type":"paragraph","position":{"start":{"line":1029,"column":1},"end":{"line":1029,"column":1}},"children":[{"type":"text","value":"Note that we have obtained only about 5 accurate digits for ","position":{"start":{"line":1029,"column":1},"end":{"line":1029,"column":1}},"key":"qi2jtq1g08"},{"type":"inlineMath","value":"x_1","position":{"start":{"line":1029,"column":1},"end":{"line":1029,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">x_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"annS9VWmTe"},{"type":"text","value":". We could make the result even more inaccurate by making ","position":{"start":{"line":1029,"column":1},"end":{"line":1029,"column":1}},"key":"RIO6DMkTGP"},{"type":"text","value":"ε","position":{"start":{"line":1029,"column":1},"end":{"line":1029,"column":1}},"key":"KnU5kHKeLu"},{"type":"text","value":" even smaller:","position":{"start":{"line":1029,"column":1},"end":{"line":1029,"column":1}},"key":"vwA3z7TYZW"}],"key":"rPLsOQy2HY"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"ϵ = 1e-20; A = [-ϵ 1; 1 -1]\nb = A * [1, 1]\nL, U = FNC.lufact(A)\nx = FNC.backsub( U, FNC.forwardsub(L, b) )","key":"tMOw3GVF9x"},{"type":"output","id":"TlhmS-uW_z9pdKoooMqiD","data":[{"output_type":"execute_result","execution_count":101,"metadata":{},"data":{"text/plain":{"content":"2-element Vector{Float64}:\n -0.0\n  1.0","content_type":"text/plain"}}}],"key":"YuogHF9Grg"}],"key":"xhwhAdprUJ"},{"type":"paragraph","position":{"start":{"line":1038,"column":1},"end":{"line":1038,"column":1}},"children":[{"type":"text","value":"This effect is not due to ill conditioning of the problem—a solution with PLU factorization works perfectly:","position":{"start":{"line":1038,"column":1},"end":{"line":1038,"column":1}},"key":"BnrICJ1aP7"}],"key":"Na8er2oDhV"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"A \\ b","key":"eiTutW281X"},{"type":"output","id":"Z65jQw4aGVdnjT84QcGce","data":[{"output_type":"execute_result","execution_count":102,"metadata":{},"data":{"text/plain":{"content":"2-element Vector{Float64}:\n 1.0\n 1.0","content_type":"text/plain"}}}],"key":"NyLIFtsUqC"}],"key":"G3m0HkzgOh"}],"label":"demo-pivoting-stable-julia","identifier":"demo-pivoting-stable-julia","html_id":"demo-pivoting-stable-julia","key":"DzRXFjM03S"},{"type":"heading","depth":3,"position":{"start":{"line":1045,"column":1},"end":{"line":1045,"column":1}},"children":[{"type":"text","value":"2.7 ","position":{"start":{"line":1045,"column":1},"end":{"line":1045,"column":1}},"key":"iJAJxR6nRb"},{"type":"link","identifier":"section-linsys-norms","label":"section-linsys-norms","kind":"narrative","position":{"start":{"line":1045,"column":5},"end":{"line":1045,"column":26}},"url":"/norms","internal":true,"dataUrl":"/norms.json","children":[{"type":"text","value":"Vector and matrix norms","key":"c2lBdvhJgV"}],"key":"UkI2dHub1A"}],"identifier":"id-2-7","label":"2.7 ","html_id":"id-2-7","implicit":true,"key":"pW2AmRoFks"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-norms-vector","label":"demo-norms-vector","kind":"proof:example","position":{"start":{"line":1047,"column":1},"end":{"line":1047,"column":19}},"children":[{"type":"text","value":"Example ","key":"HLUMEGQngM"},{"type":"text","value":"2.7.1","key":"yoNKvBCEBn"}],"template":"Example %s","enumerator":"2.7.1","resolved":true,"html_id":"demo-norms-vector","remote":true,"url":"/norms","dataUrl":"/norms.json","key":"B4DNMbFBDL"}],"key":"owT69A2JMp"},{"type":"paragraph","position":{"start":{"line":1053,"column":1},"end":{"line":1053,"column":1}},"children":[{"type":"text","value":"In Julia the ","position":{"start":{"line":1053,"column":1},"end":{"line":1053,"column":1}},"key":"HiWOM9fP1L"},{"type":"inlineCode","value":"LinearAlgebra","position":{"start":{"line":1053,"column":1},"end":{"line":1053,"column":1}},"key":"jHAX3T7Yki"},{"type":"text","value":" package has a ","position":{"start":{"line":1053,"column":1},"end":{"line":1053,"column":1}},"key":"txI9XlO29i"},{"type":"inlineCode","value":"norm","position":{"start":{"line":1053,"column":1},"end":{"line":1053,"column":1}},"key":"dmaltbHSQB"},{"type":"text","value":" function for vector norms.","position":{"start":{"line":1053,"column":1},"end":{"line":1053,"column":1}},"key":"BcpOXRC2hd"}],"indexEntries":[{"entry":"Julia","subEntry":{"value":"norm","kind":"entry"},"emphasis":true}],"label":"index-RaRa7Q8C8y","identifier":"index-rara7q8c8y","html_id":"index-rara7q8c8y","key":"GrnYfBOsy4"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"x = [2, -3, 1, -1]\ntwonorm = norm(x)         # or norm(x,2)","key":"xrhjZxnUwI"},{"type":"output","id":"Dm79FBaTXZS-hg9C1TF9K","data":[{"output_type":"execute_result","execution_count":103,"metadata":{},"data":{"text/plain":{"content":"3.872983346207417","content_type":"text/plain"}}}],"key":"Qgfrub7ZKo"}],"key":"QZoSpRKs6i"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"infnorm = norm(x, Inf)","key":"N4es9lRU4p"},{"type":"output","id":"tM9_wk3t5Y2iw8kesAqGe","data":[{"output_type":"execute_result","execution_count":104,"metadata":{},"data":{"text/plain":{"content":"3.0","content_type":"text/plain"}}}],"key":"oJSyVEmxXr"}],"key":"VU8ZBOmtnB"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"onenorm = norm(x, 1)","key":"dvqTpinWG4"},{"type":"output","id":"jE3etK2Hesq7sSwdx0jXD","data":[{"output_type":"execute_result","execution_count":105,"metadata":{},"data":{"text/plain":{"content":"7.0","content_type":"text/plain"}}}],"key":"gXCX3pIhcV"}],"key":"HMzh5aEs5P"},{"type":"paragraph","position":{"start":{"line":1071,"column":1},"end":{"line":1071,"column":1}},"children":[{"type":"text","value":"There is also a ","position":{"start":{"line":1071,"column":1},"end":{"line":1071,"column":1}},"key":"OYOVjRlTV8"},{"type":"inlineCode","value":"normalize","position":{"start":{"line":1071,"column":1},"end":{"line":1071,"column":1}},"key":"jwITEKHFfk"},{"type":"text","value":" function that divides a vector by its norm, making it a unit vector.","position":{"start":{"line":1071,"column":1},"end":{"line":1071,"column":1}},"key":"fULJD6X0II"}],"indexEntries":[{"entry":"Julia","subEntry":{"value":"normalize","kind":"entry"},"emphasis":true}],"label":"index-VWWoGnKWH8","identifier":"index-vwwognkwh8","html_id":"index-vwwognkwh8","key":"GpZILo19k1"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"normalize(x, Inf)","key":"EwSEZnFLxX"},{"type":"output","id":"Zg-KEvLCgir5i0DT4joSL","data":[{"output_type":"execute_result","execution_count":106,"metadata":{},"data":{"text/plain":{"content":"4-element Vector{Float64}:\n  0.6666666666666666\n -1.0\n  0.3333333333333333\n -0.3333333333333333","content_type":"text/plain"}}}],"key":"NJr0zjqBJ3"}],"key":"jvL8H4PE0i"}],"label":"demo-norms-vector-julia","identifier":"demo-norms-vector-julia","html_id":"demo-norms-vector-julia","key":"ncufn9JDgD"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-norms-matrix","label":"demo-norms-matrix","kind":"proof:example","position":{"start":{"line":1079,"column":1},"end":{"line":1079,"column":19}},"children":[{"type":"text","value":"Example ","key":"FIivsPSXzN"},{"type":"text","value":"2.7.3","key":"k4iYkT6kAS"}],"template":"Example %s","enumerator":"2.7.3","resolved":true,"html_id":"demo-norms-matrix","remote":true,"url":"/norms","dataUrl":"/norms.json","key":"poNFBZoHZA"}],"key":"GlgHVe1C22"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"A = [ 2 0; 1 -1 ]","key":"g0ILxROWtB"},{"type":"output","id":"fO21psMSDBHvCgJiYGSMo","data":[{"output_type":"execute_result","execution_count":107,"metadata":{},"data":{"text/plain":{"content":"2×2 Matrix{Int64}:\n 2   0\n 1  -1","content_type":"text/plain"}}}],"key":"xx8JjycBNs"}],"key":"Q0IlQ4TuEy"},{"type":"paragraph","position":{"start":{"line":1085,"column":1},"end":{"line":1085,"column":1}},"children":[{"type":"text","value":"In Julia, one uses ","position":{"start":{"line":1085,"column":1},"end":{"line":1085,"column":1}},"key":"A0tDIgtjSt"},{"type":"inlineCode","value":"norm","position":{"start":{"line":1085,"column":1},"end":{"line":1085,"column":1}},"key":"fhX6n1LFtT"},{"type":"text","value":" for vector norms and for the Frobenius norm of a matrix, which is like stacking the matrix into a single vector before taking the 2-norm.","position":{"start":{"line":1085,"column":1},"end":{"line":1085,"column":1}},"key":"qcqLOtA2gR"}],"key":"L7Z4r47QK9"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"Fronorm = norm(A)","key":"v0evssVErz"},{"type":"output","id":"NJTKzm3DUPuxYD0w-qe4F","data":[{"output_type":"execute_result","execution_count":108,"metadata":{},"data":{"text/plain":{"content":"2.449489742783178","content_type":"text/plain"}}}],"key":"zvPz5eUEOH"}],"key":"FZnR65Zdeo"},{"type":"admonition","kind":"warning","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Warning","key":"Kb0xvtO0X4"}],"key":"VqZzd3i4S2"},{"type":"paragraph","position":{"start":{"line":1095,"column":1},"end":{"line":1095,"column":1}},"children":[{"type":"text","value":"In Julia, ","position":{"start":{"line":1095,"column":1},"end":{"line":1095,"column":1}},"key":"GlmHgFFHzb"},{"type":"inlineCode","value":"norm(A)","position":{"start":{"line":1095,"column":1},"end":{"line":1095,"column":1}},"key":"YwSkCvbg6U"},{"type":"text","value":" is the Frobenius norm of a matrix, not the induced norm. To compute the induced norm, use ","position":{"start":{"line":1095,"column":1},"end":{"line":1095,"column":1}},"key":"ECvTlPxMpS"},{"type":"inlineCode","value":"opnorm","position":{"start":{"line":1095,"column":1},"end":{"line":1095,"column":1}},"key":"hHPNgwnHQE"},{"type":"text","value":".","position":{"start":{"line":1095,"column":1},"end":{"line":1095,"column":1}},"key":"V5iDTvjbzF"}],"key":"z0rrIOYbl4"}],"indexEntries":[{"entry":"Julia","subEntry":{"value":"opnorm","kind":"entry"},"emphasis":true}],"label":"index-T2kCLqyO1H","identifier":"index-t2kclqyo1h","html_id":"index-t2kclqyo1h","key":"Q1LogH1RZw"},{"type":"paragraph","position":{"start":{"line":1098,"column":1},"end":{"line":1098,"column":1}},"children":[{"type":"text","value":"The default for ","position":{"start":{"line":1098,"column":1},"end":{"line":1098,"column":1}},"key":"LpADvPpAs2"},{"type":"inlineCode","value":"opnorm","position":{"start":{"line":1098,"column":1},"end":{"line":1098,"column":1}},"key":"vzTGHZ6eFX"},{"type":"text","value":" is the 2-norm.","position":{"start":{"line":1098,"column":1},"end":{"line":1098,"column":1}},"key":"pQG5fjUWqj"}],"key":"vfhcstqvqi"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"twonorm = opnorm(A)","key":"mY4uH8zIx9"},{"type":"output","id":"CLOBKrEa-iWG7rG2Av9MF","data":[{"output_type":"execute_result","execution_count":109,"metadata":{},"data":{"text/plain":{"content":"2.2882456112707374","content_type":"text/plain"}}}],"key":"lja07lYDCB"}],"key":"UEiBM7WJ1o"},{"type":"paragraph","position":{"start":{"line":1104,"column":1},"end":{"line":1104,"column":1}},"children":[{"type":"text","value":"You can get the 1-norm as well.","position":{"start":{"line":1104,"column":1},"end":{"line":1104,"column":1}},"key":"emtbWc7uAu"}],"key":"JaqkxkTKYu"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"onenorm = opnorm(A, 1)","key":"YBovYUeIum"},{"type":"output","id":"aaQg8l31ODeJaNYi9wkBZ","data":[{"output_type":"execute_result","execution_count":110,"metadata":{},"data":{"text/plain":{"content":"3.0","content_type":"text/plain"}}}],"key":"fKNxWQrRca"}],"key":"ac9CslRhIZ"},{"type":"paragraph","position":{"start":{"line":1113,"column":1},"end":{"line":1113,"column":1}},"children":[{"type":"text","value":"According to ","position":{"start":{"line":1113,"column":1},"end":{"line":1113,"column":1}},"key":"sOE0n0yYVk"},{"type":"crossReference","kind":"equation","identifier":"mxonenorm","label":"mxonenorm","children":[{"type":"text","value":"(","key":"w0WyHAm0et"},{"type":"text","value":"2.7.12","key":"cZZrElXVGe"},{"type":"text","value":")","key":"X7GdiDVNdK"}],"template":"(%s)","enumerator":"2.7.12","resolved":true,"html_id":"mxonenorm","remote":true,"url":"/norms","dataUrl":"/norms.json","key":"ygVVStAWc8"},{"type":"text","value":", the matrix 1-norm is equivalent to the maximum of the sums down the columns (in absolute value).","position":{"start":{"line":1113,"column":1},"end":{"line":1113,"column":1}},"key":"hzzUprC6YU"}],"indexEntries":[{"entry":"Julia","subEntry":{"value":"maximum","kind":"entry"},"emphasis":true},{"entry":"Julia","subEntry":{"value":"minimum","kind":"entry"},"emphasis":true},{"entry":"Julia","subEntry":{"value":"sum","kind":"entry"},"emphasis":true}],"label":"index-FNWvfbiJGE","identifier":"index-fnwvfbijge","html_id":"index-fnwvfbijge","key":"P5A9uWw08v"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"vYYLdGTsCI"}],"key":"EmceycPST1"},{"type":"paragraph","position":{"start":{"line":1116,"column":1},"end":{"line":1117,"column":1}},"children":[{"type":"text","value":"Use ","position":{"start":{"line":1116,"column":1},"end":{"line":1116,"column":1}},"key":"SXxKsRlpsP"},{"type":"inlineCode","value":"sum","position":{"start":{"line":1116,"column":1},"end":{"line":1116,"column":1}},"key":"LHItAfo864"},{"type":"text","value":" to sum along a dimension of a matrix. You can also sum over the entire matrix by omitting the ","position":{"start":{"line":1116,"column":1},"end":{"line":1116,"column":1}},"key":"htGaVUXvab"},{"type":"inlineCode","value":"dims","position":{"start":{"line":1116,"column":1},"end":{"line":1116,"column":1}},"key":"v0BQXjtIeM"},{"type":"text","value":" argument.\nThe ","position":{"start":{"line":1116,"column":1},"end":{"line":1116,"column":1}},"key":"xmRszCuipD"},{"type":"inlineCode","value":"maximum","position":{"start":{"line":1116,"column":1},"end":{"line":1116,"column":1}},"key":"WUJXnb68Mq"},{"type":"text","value":" and ","position":{"start":{"line":1116,"column":1},"end":{"line":1116,"column":1}},"key":"L025wuoj1v"},{"type":"inlineCode","value":"minimum","position":{"start":{"line":1116,"column":1},"end":{"line":1116,"column":1}},"key":"eht8632sSY"},{"type":"text","value":" functions also work along one dimension or over an entire matrix. To get both values at once, use ","position":{"start":{"line":1116,"column":1},"end":{"line":1116,"column":1}},"key":"KsgU9cgScT"},{"type":"inlineCode","value":"extrema","position":{"start":{"line":1116,"column":1},"end":{"line":1116,"column":1}},"key":"AArSXhTJ2A"},{"type":"text","value":".","position":{"start":{"line":1116,"column":1},"end":{"line":1116,"column":1}},"key":"dC9XbrMYyk"}],"key":"WnICllLDqs"}],"class":"dropdown","key":"IvzS5tmshf"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"# Sum down the rows (1st matrix dimension):\nmaximum( sum(abs.(A), dims=1) )","key":"oiWUBpphm1"},{"type":"output","id":"NexugDhItBXuoga8ax5zX","data":[{"output_type":"execute_result","execution_count":111,"metadata":{},"data":{"text/plain":{"content":"3","content_type":"text/plain"}}}],"key":"Jn8rmmUQLH"}],"key":"vJLYb66Spc"},{"type":"paragraph","position":{"start":{"line":1125,"column":1},"end":{"line":1125,"column":1}},"children":[{"type":"text","value":"Similarly, we can get the ","position":{"start":{"line":1125,"column":1},"end":{"line":1125,"column":1}},"key":"pIkNC0N9iD"},{"type":"text","value":"∞","position":{"start":{"line":1125,"column":1},"end":{"line":1125,"column":1}},"key":"WT4az44eL3"},{"type":"text","value":"-norm and check our formula for it.","position":{"start":{"line":1125,"column":1},"end":{"line":1125,"column":1}},"key":"MsGYL4qaIN"}],"key":"RskGtCkTKD"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"infnorm = opnorm(A, Inf)","key":"i6zjvnqhcv"},{"type":"output","id":"wMhIiMalsfTBHyRmQX-wH","data":[{"output_type":"execute_result","execution_count":112,"metadata":{},"data":{"text/plain":{"content":"2.0","content_type":"text/plain"}}}],"key":"mE6KD8ZF5X"}],"key":"mcxt2TqD1Q"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":" # Sum across columns (2nd matrix dimension):\nmaximum( sum(abs.(A), dims=2) )","key":"Ap6o3ty80S"},{"type":"output","id":"p-AYRdVAH6CHhee7uHiHx","data":[{"output_type":"execute_result","execution_count":113,"metadata":{},"data":{"text/plain":{"content":"2","content_type":"text/plain"}}}],"key":"SMgEUFokVj"}],"key":"rAxXvqjrXR"},{"type":"paragraph","position":{"start":{"line":1135,"column":1},"end":{"line":1135,"column":1}},"children":[{"type":"text","value":"Next we illustrate a geometric interpretation of the 2-norm. First, we will sample a lot of vectors on the unit circle in ","position":{"start":{"line":1135,"column":1},"end":{"line":1135,"column":1}},"key":"Edsx6HRFfV"},{"type":"inlineMath","value":"\\mathbb{R}^2","position":{"start":{"line":1135,"column":1},"end":{"line":1135,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi mathvariant=\"double-struck\">R</mi><mn>2</mn></msup></mrow><annotation encoding=\"application/x-tex\">\\mathbb{R}^2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathbb\">R</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span>","key":"MbRbJoaSAH"},{"type":"text","value":".","position":{"start":{"line":1135,"column":1},"end":{"line":1135,"column":1}},"key":"jLDu6dSp0w"}],"key":"MaxFDcz3pA"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"pHIm4sJmu3"}],"key":"xnmI04xAhf"},{"type":"paragraph","position":{"start":{"line":1138,"column":1},"end":{"line":1138,"column":1}},"children":[{"type":"text","value":"You can use functions as values, e.g., as elements of a vector.","position":{"start":{"line":1138,"column":1},"end":{"line":1138,"column":1}},"key":"WpIMTYu74x"}],"key":"YOdV4F9rKE"}],"class":"dropdown","key":"QBQ5cZTD8s"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"# Construct 601 unit column vectors.\nθ = 2π * (0:1/600:1)   # type \\theta then Tab\nx = [ fun(t) for fun in [cos, sin], t in θ ];","key":"BQCVGu3uRE"},{"type":"output","id":"R_TZf3JRTLV2_ucYYw6Fn","data":[],"key":"BKxFR2OGP0"}],"key":"XXPFEoTGkZ"},{"type":"paragraph","position":{"start":{"line":1150,"column":1},"end":{"line":1150,"column":1}},"children":[{"type":"text","value":"To create an array of plots, start with a ","position":{"start":{"line":1150,"column":1},"end":{"line":1150,"column":1}},"key":"yIO75m17Cq"},{"type":"inlineCode","value":"plot","position":{"start":{"line":1150,"column":1},"end":{"line":1150,"column":1}},"key":"uEjYqa1PYt"},{"type":"text","value":" that has a ","position":{"start":{"line":1150,"column":1},"end":{"line":1150,"column":1}},"key":"lshR2GYmd0"},{"type":"inlineCode","value":"layout","position":{"start":{"line":1150,"column":1},"end":{"line":1150,"column":1}},"key":"es7An7qjYD"},{"type":"text","value":" argument, then do subsequent ","position":{"start":{"line":1150,"column":1},"end":{"line":1150,"column":1}},"key":"DC51GKRAKt"},{"type":"inlineCode","value":"plot!","position":{"start":{"line":1150,"column":1},"end":{"line":1150,"column":1}},"key":"ZtvQtmibca"},{"type":"text","value":" calls with a ","position":{"start":{"line":1150,"column":1},"end":{"line":1150,"column":1}},"key":"AKp5ax5XR8"},{"type":"inlineCode","value":"subplot","position":{"start":{"line":1150,"column":1},"end":{"line":1150,"column":1}},"key":"vcPPku2UvY"},{"type":"text","value":" argument.","position":{"start":{"line":1150,"column":1},"end":{"line":1150,"column":1}},"key":"Yh0Cno76WF"}],"indexEntries":[{"entry":"Julia","subEntry":{"value":"subplots","kind":"entry"},"emphasis":true}],"label":"index-KHGoJsjdeO","identifier":"index-khgojsjdeo","html_id":"index-khgojsjdeo","key":"v4Ou0WjOzV"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"plot(aspect_ratio=1, layout=(1, 2),\n    xlabel=L\"x_1\",  ylabel=L\"x_2\")\nplot!(x[1, :], x[2, :], subplot=1, title=\"Unit circle\")","key":"NAFkyxwQmm"},{"type":"output","id":"F4JbOIR9gus60wysZHBYd","data":[{"output_type":"execute_result","execution_count":115,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"e50ef40213f6763a778c257642097ebe","path":"/build/e50ef40213f6763a778c257642097ebe.png"},"text/html":{"content_type":"text/html","hash":"c353a829736e2018208dc0bcdafd4606","path":"/build/c353a829736e2018208dc0bcdafd4606.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"f19f80fb1270d36343c0a87c2a97b045","path":"/build/f19f80fb1270d36343c0a87c2a97b045.svg"}}}],"key":"g7kxqza1AU"}],"key":"SiH5rsU7jl"},{"type":"paragraph","position":{"start":{"line":1158,"column":1},"end":{"line":1158,"column":1}},"children":[{"type":"text","value":"The linear function ","position":{"start":{"line":1158,"column":1},"end":{"line":1158,"column":1}},"key":"itCboEafcc"},{"type":"inlineMath","value":"\\mathbf{f}(\\mathbf{x}) = \\mathbf{A}\\mathbf{x}","position":{"start":{"line":1158,"column":1},"end":{"line":1158,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">f</mi><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi mathvariant=\"bold\">A</mi><mi mathvariant=\"bold\">x</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{f}(\\mathbf{x}) = \\mathbf{A}\\mathbf{x}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.10903em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathbf\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">Ax</span></span></span></span>","key":"eNbokFfLjd"},{"type":"text","value":" defines a mapping from ","position":{"start":{"line":1158,"column":1},"end":{"line":1158,"column":1}},"key":"gT7Oo6YqXf"},{"type":"inlineMath","value":"\\mathbb{R}^2","position":{"start":{"line":1158,"column":1},"end":{"line":1158,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi mathvariant=\"double-struck\">R</mi><mn>2</mn></msup></mrow><annotation encoding=\"application/x-tex\">\\mathbb{R}^2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathbb\">R</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span>","key":"bGiuxoPTs2"},{"type":"text","value":" to ","position":{"start":{"line":1158,"column":1},"end":{"line":1158,"column":1}},"key":"ItZakzQMjB"},{"type":"inlineMath","value":"\\mathbb{R}^2","position":{"start":{"line":1158,"column":1},"end":{"line":1158,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi mathvariant=\"double-struck\">R</mi><mn>2</mn></msup></mrow><annotation encoding=\"application/x-tex\">\\mathbb{R}^2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathbb\">R</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span>","key":"aWWWdWaVJQ"},{"type":"text","value":". We can apply ","position":{"start":{"line":1158,"column":1},"end":{"line":1158,"column":1}},"key":"P0WfSoi86G"},{"type":"inlineCode","value":"A","position":{"start":{"line":1158,"column":1},"end":{"line":1158,"column":1}},"key":"EhfJggIMUj"},{"type":"text","value":" to every column of ","position":{"start":{"line":1158,"column":1},"end":{"line":1158,"column":1}},"key":"ydotJ9PIDU"},{"type":"inlineCode","value":"x","position":{"start":{"line":1158,"column":1},"end":{"line":1158,"column":1}},"key":"ycok1vVwRx"},{"type":"text","value":" by using a single matrix multiplication.","position":{"start":{"line":1158,"column":1},"end":{"line":1158,"column":1}},"key":"VWWTSYPBIt"}],"key":"CzgruMiAAQ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"Ax = A * x;","key":"KiVqCx7cUC"},{"type":"output","id":"OAX1RDg0zO37pegoSvJ1V","data":[],"key":"BvQkcJsqr1"}],"key":"t3bdqOrEi6"},{"type":"paragraph","position":{"start":{"line":1164,"column":1},"end":{"line":1164,"column":1}},"children":[{"type":"text","value":"The image of the transformed vectors is an ellipse.","position":{"start":{"line":1164,"column":1},"end":{"line":1164,"column":1}},"key":"GEvasPs9Gf"}],"key":"VGpJ4ONkju"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"plot!(Ax[1, :], Ax[2, :], \n    subplot=2, title=\"Image under x → Ax\")","key":"BdlhBBdi4p"},{"type":"output","id":"utxILNeIccPO3eQ9BNqMA","data":[{"output_type":"execute_result","execution_count":117,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"e0d45207de6b5eae1f8cf024dea1b616","path":"/build/e0d45207de6b5eae1f8cf024dea1b616.png"},"text/html":{"content_type":"text/html","hash":"dd38386476c690da4897dad779f3440f","path":"/build/dd38386476c690da4897dad779f3440f.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"573aa7b2c7591bf486d1f7160cfecbbf","path":"/build/573aa7b2c7591bf486d1f7160cfecbbf.svg"}}}],"key":"fH6jBl1Mss"}],"key":"iBEFa6hwWL"},{"type":"paragraph","position":{"start":{"line":1171,"column":1},"end":{"line":1171,"column":1}},"children":[{"type":"text","value":"That ellipse just touches the circle of radius ","position":{"start":{"line":1171,"column":1},"end":{"line":1171,"column":1}},"key":"eI1AlomBtZ"},{"type":"inlineMath","value":"\\|\\mathbf{A}\\|_2","position":{"start":{"line":1171,"column":1},"end":{"line":1171,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">∥</mi><mi mathvariant=\"bold\">A</mi><msub><mi mathvariant=\"normal\">∥</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\|\\mathbf{A}\\|_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">∥</span><span class=\"mord mathbf\">A</span><span class=\"mord\"><span class=\"mord\">∥</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"ouJ0w7NaeK"},{"type":"text","value":".","position":{"start":{"line":1171,"column":1},"end":{"line":1171,"column":1}},"key":"bqHGtc3c2E"}],"key":"FxihQ37kdJ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"plot!(twonorm*x[1, :], twonorm*x[2, :], subplot=2, l=:dash)","key":"MhJgIR0afX"},{"type":"output","id":"PoK_ClBxEP-qhcmjgdGyH","data":[{"output_type":"execute_result","execution_count":118,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"b1f3feb48fcd6085f0b99b057ae7efe8","path":"/build/b1f3feb48fcd6085f0b99b057ae7efe8.png"},"text/html":{"content_type":"text/html","hash":"edb1ad171f2cdd6799ba611a93e388b6","path":"/build/edb1ad171f2cdd6799ba611a93e388b6.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"e5b82e627d0f88d475c79ebfea0c04c6","path":"/build/e5b82e627d0f88d475c79ebfea0c04c6.svg"}}}],"key":"uY72r2kyYf"}],"key":"GVjHjAaDq3"}],"label":"demo-norms-matrix-julia","identifier":"demo-norms-matrix-julia","html_id":"demo-norms-matrix-julia","key":"AUP45FXCJj"},{"type":"heading","depth":3,"position":{"start":{"line":1179,"column":1},"end":{"line":1179,"column":1}},"children":[{"type":"text","value":"2.8 ","position":{"start":{"line":1179,"column":1},"end":{"line":1179,"column":1}},"key":"pz6jfONKEO"},{"type":"link","identifier":"section-linsys-condition-number","label":"section-linsys-condition-number","kind":"narrative","position":{"start":{"line":1179,"column":5},"end":{"line":1179,"column":37}},"url":"/condition-number","internal":true,"dataUrl":"/condition-number.json","children":[{"type":"text","value":"Conditioning of linear systems","key":"oTR7JAjSQm"}],"key":"eaeJuNSZIW"}],"identifier":"id-2-8","label":"2.8 ","html_id":"id-2-8","implicit":true,"key":"coR6WH3jQh"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-condition-bound","label":"demo-condition-bound","kind":"proof:example","position":{"start":{"line":1181,"column":1},"end":{"line":1181,"column":22}},"children":[{"type":"text","value":"Example ","key":"XxLIe53s3P"},{"type":"text","value":"2.8.1","key":"K6HstGnWHL"}],"template":"Example %s","enumerator":"2.8.1","resolved":true,"html_id":"demo-condition-bound","remote":true,"url":"/condition-number","dataUrl":"/condition-number.json","key":"dq7pywOCOi"}],"key":"RNprqmPj8u"},{"type":"paragraph","position":{"start":{"line":1186,"column":1},"end":{"line":1186,"column":1}},"children":[{"type":"text","value":"Julia has a function ","position":{"start":{"line":1186,"column":1},"end":{"line":1186,"column":1}},"key":"Nx4BbJnVkF"},{"type":"inlineCode","value":"cond","position":{"start":{"line":1186,"column":1},"end":{"line":1186,"column":1}},"key":"ziBAX5nD7l"},{"type":"text","value":" to compute matrix condition numbers. By default, the 2-norm is used. As an example, the family of ","position":{"start":{"line":1186,"column":1},"end":{"line":1186,"column":1}},"key":"bL0jXXgIVw"},{"type":"emphasis","position":{"start":{"line":1186,"column":1},"end":{"line":1186,"column":1}},"children":[{"type":"text","value":"Hilbert matrices","position":{"start":{"line":1186,"column":1},"end":{"line":1186,"column":1}},"key":"KlqcPvMC9g"}],"key":"tetZhYeDjJ"},{"type":"text","value":" is famously badly conditioned. Here is the ","position":{"start":{"line":1186,"column":1},"end":{"line":1186,"column":1}},"key":"RL7BMBocU4"},{"type":"inlineMath","value":"6\\times 6","position":{"start":{"line":1186,"column":1},"end":{"line":1186,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>6</mn><mo>×</mo><mn>6</mn></mrow><annotation encoding=\"application/x-tex\">6\\times 6</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">6</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">6</span></span></span></span>","key":"JM8iii7gnU"},{"type":"text","value":"  case.","position":{"start":{"line":1186,"column":1},"end":{"line":1186,"column":1}},"key":"x4Nwm9sYFF"}],"indexEntries":[{"entry":"Julia","subEntry":{"value":"cond","kind":"entry"},"emphasis":true}],"label":"index-kxN8K1USzp","identifier":"index-kxn8k1uszp","html_id":"index-kxn8k1uszp","key":"vLCb4VYwY2"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"xKN3UgzvTB"}],"key":"bGT32hML1I"},{"type":"paragraph","position":{"start":{"line":1189,"column":1},"end":{"line":1189,"column":1}},"children":[{"type":"text","value":"Type ","position":{"start":{"line":1189,"column":1},"end":{"line":1189,"column":1}},"key":"QT18LUzbKB"},{"type":"inlineCode","value":"\\kappa","position":{"start":{"line":1189,"column":1},"end":{"line":1189,"column":1}},"key":"js1tXQQRms"},{"type":"text","value":" followed by ","position":{"start":{"line":1189,"column":1},"end":{"line":1189,"column":1}},"key":"K2GH0nzGcS"},{"type":"keyboard","children":[{"type":"text","value":"Tab","key":"xwaJPThHN3"}],"key":"wKCAfscdYp"},{"type":"text","value":" to get the Greek letter ","position":{"start":{"line":1189,"column":1},"end":{"line":1189,"column":1}},"key":"YnOSM2UOid"},{"type":"text","value":"κ","position":{"start":{"line":1189,"column":1},"end":{"line":1189,"column":1}},"key":"A9ZWR6TfpL"},{"type":"text","value":".","position":{"start":{"line":1189,"column":1},"end":{"line":1189,"column":1}},"key":"jVmxqEQGGB"}],"key":"UazL38b0xy"}],"class":"dropdown","key":"JxP7lMkgh7"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"A = [ 1 / (i + j) for i in 1:6, j in 1:6 ]\nκ = cond(A)","key":"ubym2QyXCf"},{"type":"output","id":"ZB0BLs3gBMmcQ9TFyJjtg","data":[{"output_type":"execute_result","execution_count":119,"metadata":{},"data":{"text/plain":{"content":"5.109816297946132e7","content_type":"text/plain"}}}],"key":"jvnHimJmPG"}],"key":"OJGkWhVzpP"},{"type":"paragraph","position":{"start":{"line":1197,"column":1},"end":{"line":1197,"column":1}},"children":[{"type":"text","value":"Because ","position":{"start":{"line":1197,"column":1},"end":{"line":1197,"column":1}},"key":"KpBea1hSZ3"},{"type":"inlineMath","value":"\\kappa\\approx 10^8","position":{"start":{"line":1197,"column":1},"end":{"line":1197,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>κ</mi><mo>≈</mo><mn>1</mn><msup><mn>0</mn><mn>8</mn></msup></mrow><annotation encoding=\"application/x-tex\">\\kappa\\approx 10^8</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4831em;\"></span><span class=\"mord mathnormal\">κ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">8</span></span></span></span></span></span></span></span></span></span></span>","key":"LH9Vt81sLt"},{"type":"text","value":", it’s possible to lose nearly 8 digits of accuracy in the process of passing from ","position":{"start":{"line":1197,"column":1},"end":{"line":1197,"column":1}},"key":"dwwOeCJqX8"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":1197,"column":1},"end":{"line":1197,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"gn5r4rh9kX"},{"type":"text","value":" and ","position":{"start":{"line":1197,"column":1},"end":{"line":1197,"column":1}},"key":"frmFb65rKb"},{"type":"inlineMath","value":"\\mathbf{b}","position":{"start":{"line":1197,"column":1},"end":{"line":1197,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"VoHgZn3PXD"},{"type":"text","value":" to ","position":{"start":{"line":1197,"column":1},"end":{"line":1197,"column":1}},"key":"AhRMaet4Ao"},{"type":"inlineMath","value":"\\mathbf{x}","position":{"start":{"line":1197,"column":1},"end":{"line":1197,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">x</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{x}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4444em;\"></span><span class=\"mord mathbf\">x</span></span></span></span>","key":"c7uC3Uc1mf"},{"type":"text","value":". That fact is independent of the algorithm; it’s inevitable once the data are expressed in finite precision.","position":{"start":{"line":1197,"column":1},"end":{"line":1197,"column":1}},"key":"qUMzKueuHN"}],"key":"kVQyRX9K7i"},{"type":"paragraph","position":{"start":{"line":1199,"column":1},"end":{"line":1199,"column":1}},"children":[{"type":"text","value":"Let’s engineer a linear system problem to observe the effect of a perturbation. We will make sure we know the exact answer.","position":{"start":{"line":1199,"column":1},"end":{"line":1199,"column":1}},"key":"gyZUD1OjhC"}],"key":"gEvzYC3TEb"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"x = 1:6\nb = A * x","key":"ICPwMWpfgW"},{"type":"output","id":"c1IrmYwlx8gnqodjh-jVz","data":[{"output_type":"execute_result","execution_count":120,"metadata":{},"data":{"text/plain":{"content":"6-element Vector{Float64}:\n 4.407142857142857\n 3.564285714285714\n 3.013095238095238\n 2.6174603174603175\n 2.317279942279942\n 2.0807359307359308","content_type":"text/plain"}}}],"key":"LXuFKhPa21"}],"key":"NtB4NxkLo4"},{"type":"paragraph","position":{"start":{"line":1206,"column":1},"end":{"line":1206,"column":1}},"children":[{"type":"text","value":"Now we perturb the system matrix and vector randomly by ","position":{"start":{"line":1206,"column":1},"end":{"line":1206,"column":1}},"key":"jwh08Gcq5c"},{"type":"span","position":{"start":{"line":1206,"column":1},"end":{"line":1206,"column":1}},"children":[{"type":"text","value":"10","key":"mXe9pbgXUn"},{"type":"superscript","children":[{"type":"text","value":"-10","key":"rnZCmRmF9n"}],"key":"Yj853lcyKa"}],"key":"UzpzJaYxIN"},{"type":"text","value":" in norm.","position":{"start":{"line":1206,"column":1},"end":{"line":1206,"column":1}},"key":"AmqsLQta7x"}],"key":"gTPCHywhjz"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"# type \\Delta then Tab to get Δ\nΔA = randn(size(A));  ΔA = 1e-10 * (ΔA / opnorm(ΔA));\nΔb = randn(size(b));  Δb = 1e-10 * normalize(Δb);","key":"jf6FfiWcgd"},{"type":"output","id":"ioSvy1kpSeepympuFx1X1","data":[],"key":"lMzHYkIgJo"}],"key":"LnVgojbATo"},{"type":"paragraph","position":{"start":{"line":1214,"column":1},"end":{"line":1214,"column":1}},"children":[{"type":"text","value":"We solve the perturbed problem using pivoted LU and see how the solution was changed.","position":{"start":{"line":1214,"column":1},"end":{"line":1214,"column":1}},"key":"cfDPifemQ7"}],"key":"pkmXq1iE1G"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"new_x = ((A + ΔA) \\ (b + Δb))\nΔx = new_x - x","key":"vJviaEX53R"},{"type":"output","id":"sEqfe4fyObQCRbfGbTNOw","data":[{"output_type":"execute_result","execution_count":122,"metadata":{},"data":{"text/plain":{"content":"6-element Vector{Float64}:\n -2.63316304516259e-6\n  6.105562814973098e-5\n -0.00037343844275161686\n  0.0009113456616178794\n -0.0009615404173253239\n  0.00036618496129481315","content_type":"text/plain"}}}],"key":"Uoriyba8iw"}],"key":"q2FHabCAlN"},{"type":"paragraph","position":{"start":{"line":1221,"column":1},"end":{"line":1221,"column":1}},"children":[{"type":"text","value":"Here is the relative error in the solution.","position":{"start":{"line":1221,"column":1},"end":{"line":1221,"column":1}},"key":"JNDG0a6Rs1"}],"key":"Q7rYVheiNB"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"@show relative_error = norm(Δx) / norm(x);","key":"fITmSvRsfl"},{"type":"output","id":"jRkfVre5WitlHFhohOGHr","data":[{"output_type":"stream","name":"stdout","text":"relative_error = norm(Δx) / norm(x) = 0.00014944561687841633\n"}],"key":"S1wyijxyIV"}],"key":"lN1XUMR6te"},{"type":"paragraph","position":{"start":{"line":1227,"column":1},"end":{"line":1227,"column":1}},"children":[{"type":"text","value":"And here are upper bounds predicted using the condition number of the original matrix.","position":{"start":{"line":1227,"column":1},"end":{"line":1227,"column":1}},"key":"nATUfkBkgS"}],"key":"myi7OhiljI"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"println(\"Upper bound due to b: $(κ * norm(Δb) / norm(b))\")\nprintln(\"Upper bound due to A: $(κ * opnorm(ΔA) / opnorm(A))\")","key":"Ez2tQLNSKm"},{"type":"output","id":"Hy8D8kpjo2qftnWdWMVRt","data":[{"output_type":"stream","name":"stdout","text":"Upper bound due to b: 0.0006723667714371329\nUpper bound due to A: 0.0045669898739390665\n"}],"key":"OYUbSp7lew"}],"key":"MUSEX057Cg"},{"type":"paragraph","position":{"start":{"line":1234,"column":1},"end":{"line":1234,"column":1}},"children":[{"type":"text","value":"Even if we didn’t make any manual perturbations to the data, machine roundoff does so at the relative level of ","position":{"start":{"line":1234,"column":1},"end":{"line":1234,"column":1}},"key":"YrYcrrS0YY"},{"type":"inlineMath","value":"\\macheps","position":{"start":{"line":1234,"column":1},"end":{"line":1234,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>ϵ</mi><mtext>mach</mtext></msub></mrow><annotation encoding=\"application/x-tex\">\\macheps</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">ϵ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">mach</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"uTeoytzALf"},{"type":"text","value":".","position":{"start":{"line":1234,"column":1},"end":{"line":1234,"column":1}},"key":"ShgoAGUFes"}],"key":"Zz7lKtk7zA"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"Δx = A\\b - x\n@show relative_error = norm(Δx) / norm(x);\n@show rounding_bound = κ * eps();","key":"Cxok74zelN"},{"type":"output","id":"mJtu9XvBQ3dyvyBo4579h","data":[{"output_type":"stream","name":"stdout","text":"relative_error = norm(Δx) / norm(x) = 7.822650774976615e-10\nrounding_bound = κ * eps() = 1.134607141116935e-8\n"}],"key":"ssmxf8z8ty"}],"key":"cUbLCTuWGR"},{"type":"paragraph","position":{"start":{"line":1242,"column":1},"end":{"line":1242,"column":1}},"children":[{"type":"text","value":"Larger Hilbert matrices are even more poorly conditioned:","position":{"start":{"line":1242,"column":1},"end":{"line":1242,"column":1}},"key":"XouLfWhQn7"}],"key":"KoKYakY43u"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"A = [ 1 / (i + j) for i=1:14, j=1:14 ];\nκ = cond(A)","key":"aYs2AwZJZ7"},{"type":"output","id":"Rgc-BvfyA8yRpbGV9AjIP","data":[{"output_type":"execute_result","execution_count":126,"metadata":{},"data":{"text/plain":{"content":"5.802584125151949e17","content_type":"text/plain"}}}],"key":"Iaf29VeDUk"}],"key":"LAc8yFicY0"},{"type":"paragraph","position":{"start":{"line":1249,"column":1},"end":{"line":1249,"column":1}},"children":[{"type":"text","value":"Note that ","position":{"start":{"line":1249,"column":1},"end":{"line":1249,"column":1}},"key":"OOcWJuKT3T"},{"type":"text","value":"κ","position":{"start":{"line":1249,"column":1},"end":{"line":1249,"column":1}},"key":"VjtXY5zlI7"},{"type":"text","value":" exceeds ","position":{"start":{"line":1249,"column":1},"end":{"line":1249,"column":1}},"key":"ahOoZSyev5"},{"type":"inlineMath","value":"1/\\macheps","position":{"start":{"line":1249,"column":1},"end":{"line":1249,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mi mathvariant=\"normal\">/</mi><msub><mi>ϵ</mi><mtext>mach</mtext></msub></mrow><annotation encoding=\"application/x-tex\">1/\\macheps</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1/</span><span class=\"mord\"><span class=\"mord mathnormal\">ϵ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">mach</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"rG0d7RROUN"},{"type":"text","value":". In principle we therefore may end up with an answer that has relative error greater than 100%.","position":{"start":{"line":1249,"column":1},"end":{"line":1249,"column":1}},"key":"pRGmOBMvYy"}],"key":"RBiqmhsMQ2"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"rounding_bound = κ*eps()","key":"sAaCwHOvBV"},{"type":"output","id":"ftD-1ioGTldGOkw9-GPmH","data":[{"output_type":"execute_result","execution_count":127,"metadata":{},"data":{"text/plain":{"content":"128.8432499613623","content_type":"text/plain"}}}],"key":"CScPI7VGTj"}],"key":"sPOTEXHFSK"},{"type":"paragraph","position":{"start":{"line":1255,"column":1},"end":{"line":1255,"column":1}},"children":[{"type":"text","value":"Let’s put that prediction to the test.","position":{"start":{"line":1255,"column":1},"end":{"line":1255,"column":1}},"key":"EvOtNa513H"}],"key":"gpyekdbmd9"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"x = 1:14\nb = A * x  \nΔx = A\\b - x\n@show relative_error = norm(Δx) / norm(x);","key":"aeYgRQHeya"},{"type":"output","id":"01WkoEPIbmxhj4ct08RiX","data":[{"output_type":"stream","name":"stdout","text":"relative_error = norm(Δx) / norm(x) = 4.469466154206132\n"}],"key":"UhT57orMjV"}],"key":"j4cB5lIfWj"},{"type":"paragraph","position":{"start":{"line":1264,"column":1},"end":{"line":1264,"column":1}},"children":[{"type":"text","value":"As anticipated, the solution has zero accurate digits in the 2-norm.","position":{"start":{"line":1264,"column":1},"end":{"line":1264,"column":1}},"key":"GlFTk3m77B"}],"key":"MxCtULIFGp"}],"label":"demo-condition-bound-julia","identifier":"demo-condition-bound-julia","html_id":"demo-condition-bound-julia","key":"GdZH3Brv48"},{"type":"heading","depth":3,"position":{"start":{"line":1267,"column":1},"end":{"line":1267,"column":1}},"children":[{"type":"text","value":"2.9 ","position":{"start":{"line":1267,"column":1},"end":{"line":1267,"column":1}},"key":"TDp6os1pan"},{"type":"link","identifier":"section-linsys-structure","label":"section-linsys-structure","kind":"narrative","position":{"start":{"line":1267,"column":5},"end":{"line":1267,"column":30}},"url":"/structure","internal":true,"dataUrl":"/structure.json","children":[{"type":"text","value":"Exploiting matrix structure","key":"wj0aWGzXCg"}],"key":"DdoDwNVs9M"}],"identifier":"id-2-9","label":"2.9 ","html_id":"id-2-9","implicit":true,"key":"RDbPUJ5C2c"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-structure-banded","label":"demo-structure-banded","kind":"proof:example","position":{"start":{"line":1269,"column":1},"end":{"line":1269,"column":23}},"children":[{"type":"text","value":"Example ","key":"umVUImfb3E"},{"type":"text","value":"2.9.1","key":"hNgkHjKkmP"}],"template":"Example %s","enumerator":"2.9.1","resolved":true,"html_id":"demo-structure-banded","remote":true,"url":"/structure","dataUrl":"/structure.json","key":"cBqRQrtWEj"}],"key":"f3vUkl6vlN"},{"type":"paragraph","position":{"start":{"line":1274,"column":1},"end":{"line":1274,"column":1}},"children":[{"type":"text","value":"Here is a small tridiagonal matrix. Note that there is one fewer element on the super- and subdiagonals than on the main diagonal.","position":{"start":{"line":1274,"column":1},"end":{"line":1274,"column":1}},"key":"nd7JS9AfZD"}],"indexEntries":[{"entry":"Julia","subEntry":{"value":"fill","kind":"entry"},"emphasis":true},{"entry":"Julia","subEntry":{"value":"diagm","kind":"entry"},"emphasis":false},{"entry":"Julia","subEntry":{"value":"diag","kind":"entry"},"emphasis":true}],"label":"index-fOB30nPwiX","identifier":"index-fob30npwix","html_id":"index-fob30npwix","key":"WbcyBSkmUc"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"FeXRxgpZRt"}],"key":"vj6VLmyz0i"},{"type":"paragraph","position":{"start":{"line":1277,"column":1},"end":{"line":1277,"column":1}},"children":[{"type":"text","value":"Use ","position":{"start":{"line":1277,"column":1},"end":{"line":1277,"column":1}},"key":"tujZqxFPjx"},{"type":"inlineCode","value":"fill","position":{"start":{"line":1277,"column":1},"end":{"line":1277,"column":1}},"key":"zSq1quhS9o"},{"type":"text","value":" to create an array of a given size, with each element equal to a provided value.","position":{"start":{"line":1277,"column":1},"end":{"line":1277,"column":1}},"key":"HFI09xrGlU"}],"key":"dwI5i630K8"}],"class":"dropdown","key":"lFQd5D6IOw"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"A = diagm( -1 => [4, 3, 2, 1, 0], \n    0 => [2, 2, 0, 2, 1, 2], \n    1 => fill(-1, 5) )","key":"FypJ39G9Qw"},{"type":"output","id":"VOItMWmDUbNjI2yA_XNKZ","data":[{"output_type":"execute_result","execution_count":129,"metadata":{},"data":{"text/plain":{"content":"6×6 Matrix{Int64}:\n 2  -1   0   0   0   0\n 4   2  -1   0   0   0\n 0   3   0  -1   0   0\n 0   0   2   2  -1   0\n 0   0   0   1   1  -1\n 0   0   0   0   0   2","content_type":"text/plain"}}}],"key":"SHJXr2JKCp"}],"key":"SpVKj1CCGJ"},{"type":"paragraph","position":{"start":{"line":1289,"column":1},"end":{"line":1289,"column":1}},"children":[{"type":"text","value":"We can extract the elements on any diagonal using the ","position":{"start":{"line":1289,"column":1},"end":{"line":1289,"column":1}},"key":"nrTdRvH7yz"},{"type":"inlineCode","value":"diag","position":{"start":{"line":1289,"column":1},"end":{"line":1289,"column":1}},"key":"fdFIFsLnq5"},{"type":"text","value":" function. The main or central diagonal is numbered zero, above and to the right of that is positive, and below and to the left is negative.","position":{"start":{"line":1289,"column":1},"end":{"line":1289,"column":1}},"key":"E79ETfu4Qu"}],"indexEntries":[{"entry":"Julia","subEntry":{"value":"diag","kind":"entry"},"emphasis":true}],"label":"index-Ku7oerOxta","identifier":"index-ku7oeroxta","html_id":"index-ku7oeroxta","key":"IvDcKBSbtk"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"xGqLFVF8Kh"}],"key":"C6kDka7T9H"},{"type":"paragraph","position":{"start":{"line":1292,"column":1},"end":{"line":1292,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":1292,"column":1},"end":{"line":1292,"column":1}},"key":"f69CYdzjb8"},{"type":"inlineCode","value":"diag","position":{"start":{"line":1292,"column":1},"end":{"line":1292,"column":1}},"key":"gcWXP27cLg"},{"type":"text","value":" function extracts the elements from a specified diagonal of a matrix.","position":{"start":{"line":1292,"column":1},"end":{"line":1292,"column":1}},"key":"o2vFQ0vQ9A"}],"key":"T15dCn3OL4"}],"class":"dropdown","key":"BXjzgxytov"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"@show diag_main = diag(A);\n@show diag_minusone = diag(A, -1);","key":"XGXtW25D6t"},{"type":"output","id":"3qgh8AvCprx_DxAEB7Fnx","data":[{"output_type":"stream","name":"stdout","text":"diag_main = diag(A) = [2, 2, 0, 2, 1, 2]\ndiag_minusone = diag(A, -1) = [4, 3, 2, 1, 0]\n"}],"key":"o2hEdmpzVT"}],"key":"eHL816DYF9"},{"type":"paragraph","position":{"start":{"line":1299,"column":1},"end":{"line":1299,"column":1}},"children":[{"type":"text","value":"The lower and upper bandwidths of ","position":{"start":{"line":1299,"column":1},"end":{"line":1299,"column":1}},"key":"J2iAs1kxXC"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":1299,"column":1},"end":{"line":1299,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"n4qxH6T704"},{"type":"text","value":" are repeated in the factors from the unpivoted LU factorization.","position":{"start":{"line":1299,"column":1},"end":{"line":1299,"column":1}},"key":"ua9E6oICGb"}],"key":"JkN1eHoIaS"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"L, U = FNC.lufact(A)\nL","key":"Gr1G4kzfmk"},{"type":"output","id":"hQkeZMir5nSJdkmaN6Tgm","data":[{"output_type":"execute_result","execution_count":131,"metadata":{},"data":{"text/plain":{"content":"6×6 LowerTriangular{Float64, Matrix{Float64}}:\n 1.0   ⋅     ⋅        ⋅         ⋅    ⋅ \n 2.0  1.0    ⋅        ⋅         ⋅    ⋅ \n 0.0  0.75  1.0       ⋅         ⋅    ⋅ \n 0.0  0.0   2.66667  1.0        ⋅    ⋅ \n 0.0  0.0   0.0      0.214286  1.0   ⋅ \n 0.0  0.0   0.0      0.0       0.0  1.0","content_type":"text/plain"}}}],"key":"TlI5uZ0pte"}],"key":"DKw9X7hkEM"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"U","key":"rw5m17uImW"},{"type":"output","id":"k4tDSH0GuGVF9_ynNgT2s","data":[{"output_type":"execute_result","execution_count":132,"metadata":{},"data":{"text/plain":{"content":"6×6 UpperTriangular{Float64, Matrix{Float64}}:\n 2.0  -1.0   0.0    0.0       0.0       0.0\n  ⋅    4.0  -1.0    0.0       0.0       0.0\n  ⋅     ⋅    0.75  -1.0       0.0       0.0\n  ⋅     ⋅     ⋅     4.66667  -1.0       0.0\n  ⋅     ⋅     ⋅      ⋅        1.21429  -1.0\n  ⋅     ⋅     ⋅      ⋅         ⋅        2.0","content_type":"text/plain"}}}],"key":"ktbpKwgOoq"}],"key":"A1TPr0AexR"}],"label":"demo-structure-banded-julia","identifier":"demo-structure-banded-julia","html_id":"demo-structure-banded-julia","key":"xw6H2pxCMi"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-structure-symm","label":"demo-structure-symm","kind":"proof:example","position":{"start":{"line":1312,"column":1},"end":{"line":1312,"column":21}},"children":[{"type":"text","value":"Example ","key":"FMtWUNo5FL"},{"type":"text","value":"2.9.2","key":"nI8ML9SfGe"}],"template":"Example %s","enumerator":"2.9.2","resolved":true,"html_id":"demo-structure-symm","remote":true,"url":"/structure","dataUrl":"/structure.json","key":"iusjObdTpM"}],"key":"mSUxepDGVb"},{"type":"paragraph","position":{"start":{"line":1315,"column":1},"end":{"line":1315,"column":1}},"children":[{"type":"text","value":"We begin with a symmetric ","position":{"start":{"line":1315,"column":1},"end":{"line":1315,"column":1}},"key":"NVXshUjIqK"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":1315,"column":1},"end":{"line":1315,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"cnCl5q34nn"},{"type":"text","value":".","position":{"start":{"line":1315,"column":1},"end":{"line":1315,"column":1}},"key":"fDAPQlELZW"}],"key":"ROWsRexOU6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"A₁ = [  2     4     4     2\n        4     5     8    -5\n        4     8     6     2\n        2    -5     2   -26 ];","key":"Ul8jTZKxEh"},{"type":"output","id":"Iu2fR5zkPLmmRoQBtUNds","data":[],"key":"VZHDjX8SYQ"}],"key":"L09OLiS6Pp"},{"type":"paragraph","position":{"start":{"line":1324,"column":1},"end":{"line":1324,"column":1}},"children":[{"type":"text","value":"We won’t use pivoting, so the pivot element is at position (1,1). This will become the first element on the diagonal of ","position":{"start":{"line":1324,"column":1},"end":{"line":1324,"column":1}},"key":"TaZlvC4YGd"},{"type":"inlineMath","value":"\\mathbf{D}","position":{"start":{"line":1324,"column":1},"end":{"line":1324,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">D</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{D}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">D</span></span></span></span>","key":"vqEqA68F9R"},{"type":"text","value":". Then we divide by that pivot to get the first column of ","position":{"start":{"line":1324,"column":1},"end":{"line":1324,"column":1}},"key":"C3iKMKK0p8"},{"type":"inlineMath","value":"\\mathbf{L}","position":{"start":{"line":1324,"column":1},"end":{"line":1324,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">L</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{L}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">L</span></span></span></span>","key":"CbLgp79oZn"},{"type":"text","value":".","position":{"start":{"line":1324,"column":1},"end":{"line":1324,"column":1}},"key":"QyoQTdWj8o"}],"key":"MkoRNGRhHf"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"L = diagm(ones(4))\nd = zeros(4)\nd[1] = A₁[1, 1]\nL[:, 1] = A₁[:, 1] / d[1]\nA₂ = A₁ - d[1] * L[:, 1] * L[:, 1]'","key":"zezLS4zPfG"},{"type":"output","id":"0__5zT0d8OyJ1OPe6Ic61","data":[{"output_type":"execute_result","execution_count":134,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n 0.0   0.0   0.0    0.0\n 0.0  -3.0   0.0   -9.0\n 0.0   0.0  -2.0   -2.0\n 0.0  -9.0  -2.0  -28.0","content_type":"text/plain"}}}],"key":"teU1sUOtnB"}],"key":"HolU7BX2mk"},{"type":"paragraph","position":{"start":{"line":1334,"column":1},"end":{"line":1334,"column":1}},"children":[{"type":"text","value":"We are now set up the same way for the submatrix in rows and columns 2–4.","position":{"start":{"line":1334,"column":1},"end":{"line":1334,"column":1}},"key":"xFL6QyOob4"}],"key":"Saf1ZeeFfZ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"d[2] = A₂[2, 2]\nL[:, 2] = A₂[:, 2] / d[2]\nA₃ = A₂ - d[2] * L[:, 2] * L[:, 2]'","key":"WQW91mMgDQ"},{"type":"output","id":"fNVE5D4v5cNNij-F5R4wH","data":[{"output_type":"execute_result","execution_count":135,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n 0.0  0.0   0.0   0.0\n 0.0  0.0   0.0   0.0\n 0.0  0.0  -2.0  -2.0\n 0.0  0.0  -2.0  -1.0","content_type":"text/plain"}}}],"key":"SLgaqqjJRW"}],"key":"zK6dgSvmY3"},{"type":"paragraph","position":{"start":{"line":1342,"column":1},"end":{"line":1342,"column":1}},"children":[{"type":"text","value":"We continue working our way down the diagonal.","position":{"start":{"line":1342,"column":1},"end":{"line":1342,"column":1}},"key":"BPKtKA2u3N"}],"key":"pH41phQ565"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"d[3] = A₃[3, 3]\nL[:, 3] = A₃[:, 3] / d[3]\nA₄ = A₃ - d[3] * L[:, 3] * L[:, 3]'\nd[4] = A₄[4, 4]\n@show d;\nL","key":"AlGqWRdZ64"},{"type":"output","id":"Ztvg5TPQnSjbb9q8vprqb","data":[{"output_type":"stream","name":"stdout","text":"d = [2.0, -3.0, -2.0, 1.0]\n"},{"output_type":"execute_result","execution_count":136,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n 1.0  -0.0  -0.0  0.0\n 2.0   1.0  -0.0  0.0\n 2.0  -0.0   1.0  0.0\n 1.0   3.0   1.0  1.0","content_type":"text/plain"}}}],"key":"LoPONmMccP"}],"key":"XZaombZa8M"},{"type":"paragraph","position":{"start":{"line":1353,"column":1},"end":{"line":1353,"column":1}},"children":[{"type":"text","value":"We have arrived at the desired factorization, which we can validate:","position":{"start":{"line":1353,"column":1},"end":{"line":1353,"column":1}},"key":"vQ7mJEuY0X"}],"key":"qSBcRNnMEl"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"opnorm(A₁ - (L * diagm(d) * L'))","key":"uU8ffQqmvi"},{"type":"output","id":"hAup-uyHCFExP4jCufGdy","data":[{"output_type":"execute_result","execution_count":137,"metadata":{},"data":{"text/plain":{"content":"0.0","content_type":"text/plain"}}}],"key":"XyK9FH52Hb"}],"key":"C0JyWiq0rV"}],"label":"demo-structure-symm-julia","identifier":"demo-structure-symm-julia","html_id":"demo-structure-symm-julia","key":"O8PbPJ4W6X"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-structure-cholesky","label":"demo-structure-cholesky","kind":"proof:example","position":{"start":{"line":1361,"column":1},"end":{"line":1361,"column":25}},"children":[{"type":"text","value":"Example ","key":"eIErMTNOvE"},{"type":"text","value":"2.9.3","key":"aVNEyb751S"}],"template":"Example %s","enumerator":"2.9.3","resolved":true,"html_id":"demo-structure-cholesky","remote":true,"url":"/structure","dataUrl":"/structure.json","key":"OmUSjcsemg"}],"key":"UouavuT4WZ"},{"type":"paragraph","position":{"start":{"line":1363,"column":1},"end":{"line":1363,"column":1}},"children":[{"type":"text","value":"A randomly chosen matrix is extremely unlikely to be symmetric. However, there is a simple way to symmetrize one.","position":{"start":{"line":1363,"column":1},"end":{"line":1363,"column":1}},"key":"OSAcnMlJbJ"}],"key":"V2k6le0GxG"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"A = rand(1.0:9.0, 4, 4)\nB = A + A'","key":"b3qAPSx9p7"},{"type":"output","id":"YGjmJwN_t9qqmqWhn3nAP","data":[{"output_type":"execute_result","execution_count":138,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n 14.0  14.0  14.0   9.0\n 14.0  10.0  11.0  12.0\n 14.0  11.0   2.0   7.0\n  9.0  12.0   7.0   4.0","content_type":"text/plain"}}}],"key":"zSRYUXRV1U"}],"key":"rSG6tSOTJs"},{"type":"paragraph","position":{"start":{"line":1373,"column":1},"end":{"line":1373,"column":1}},"children":[{"type":"text","value":"Similarly, a random symmetric matrix is unlikely to be positive definite. The Cholesky algorithm always detects a non-PD matrix by quitting with an error.","position":{"start":{"line":1373,"column":1},"end":{"line":1373,"column":1}},"key":"vrDQlrL9ke"}],"indexEntries":[{"entry":"Julia","subEntry":{"value":"cholesky","kind":"entry"},"emphasis":true}],"label":"index-kMiS7B1U77","identifier":"index-kmis7b1u77","html_id":"index-kmis7b1u77","key":"Gj5uJSWbGu"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"rnhKZbVrkL"}],"key":"rLPuwyVFHe"},{"type":"paragraph","position":{"start":{"line":1376,"column":1},"end":{"line":1376,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":1376,"column":1},"end":{"line":1376,"column":1}},"key":"mRgJ0E0avi"},{"type":"inlineCode","value":"cholesky","position":{"start":{"line":1376,"column":1},"end":{"line":1376,"column":1}},"key":"P0hrcxanhK"},{"type":"text","value":" function computes a Cholesky factorization if possible, or throws an error for a non-positive-definite matrix. However, it does ","position":{"start":{"line":1376,"column":1},"end":{"line":1376,"column":1}},"key":"rnVOsy8VMO"},{"type":"emphasis","position":{"start":{"line":1376,"column":1},"end":{"line":1376,"column":1}},"children":[{"type":"text","value":"not","position":{"start":{"line":1376,"column":1},"end":{"line":1376,"column":1}},"key":"Npse8zt3gD"}],"key":"IUuNr3UJ2k"},{"type":"text","value":" check for symmetry.","position":{"start":{"line":1376,"column":1},"end":{"line":1376,"column":1}},"key":"D8z9d74o9M"}],"key":"L9dDgAP4Gq"}],"class":"dropdown","key":"RJqEyk3vCo"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"cholesky(B)    # throws an error","visibility":"show","key":"WiWwF59zYd"},{"type":"output","id":"mvEvOSF-uboqUml9m6_km","data":[{"output_type":"error","traceback":"PosDefException: matrix is not positive definite; Factorization failed.\n\nStacktrace:\n  [1] \u001b[0m\u001b[1mcheckpositivedefinite\u001b[22m\n\u001b[90m    @\u001b[39m \u001b[90m~/.julia/juliaup/julia-1.11.5+0.aarch64.apple.darwin14/share/julia/stdlib/v1.11/LinearAlgebra/src/\u001b[39m\u001b[90m\u001b[4mfactorization.jl:68\u001b[24m\u001b[39m\u001b[90m [inlined]\u001b[39m\n  [2] \u001b[0m\u001b[1m#cholesky!#163\u001b[22m\n\u001b[90m    @\u001b[39m \u001b[90m~/.julia/juliaup/julia-1.11.5+0.aarch64.apple.darwin14/share/julia/stdlib/v1.11/LinearAlgebra/src/\u001b[39m\u001b[90m\u001b[4mcholesky.jl:269\u001b[24m\u001b[39m\u001b[90m [inlined]\u001b[39m\n  [3] \u001b[0m\u001b[1mcholesky!\u001b[22m\n\u001b[90m    @\u001b[39m \u001b[90m~/.julia/juliaup/julia-1.11.5+0.aarch64.apple.darwin14/share/julia/stdlib/v1.11/LinearAlgebra/src/\u001b[39m\u001b[90m\u001b[4mcholesky.jl:267\u001b[24m\u001b[39m\u001b[90m [inlined]\u001b[39m\n  [4] \u001b[0m\u001b[1m#cholesky!#164\u001b[22m\n\u001b[90m    @\u001b[39m \u001b[90m~/.julia/juliaup/julia-1.11.5+0.aarch64.apple.darwin14/share/julia/stdlib/v1.11/LinearAlgebra/src/\u001b[39m\u001b[90m\u001b[4mcholesky.jl:301\u001b[24m\u001b[39m\u001b[90m [inlined]\u001b[39m\n  [5] \u001b[0m\u001b[1mcholesky!\u001b[22m\u001b[90m (repeats 2 times)\u001b[39m\n\u001b[90m    @\u001b[39m \u001b[90m~/.julia/juliaup/julia-1.11.5+0.aarch64.apple.darwin14/share/julia/stdlib/v1.11/LinearAlgebra/src/\u001b[39m\u001b[90m\u001b[4mcholesky.jl:295\u001b[24m\u001b[39m\u001b[90m [inlined]\u001b[39m\n  [6] \u001b[0m\u001b[1m_cholesky\u001b[22m\n\u001b[90m    @\u001b[39m \u001b[90m~/.julia/juliaup/julia-1.11.5+0.aarch64.apple.darwin14/share/julia/stdlib/v1.11/LinearAlgebra/src/\u001b[39m\u001b[90m\u001b[4mcholesky.jl:411\u001b[24m\u001b[39m\u001b[90m [inlined]\u001b[39m\n  [7] \u001b[0m\u001b[1mcholesky\u001b[22m\u001b[0m\u001b[1m(\u001b[22m\u001b[90mA\u001b[39m::\u001b[0mMatrix\u001b[90m{Float64}\u001b[39m, ::\u001b[0mNoPivot; \u001b[90mcheck\u001b[39m::\u001b[0mBool\u001b[0m\u001b[1m)\u001b[22m\n\u001b[90m    @\u001b[39m \u001b[35mLinearAlgebra\u001b[39m \u001b[90m~/.julia/juliaup/julia-1.11.5+0.aarch64.apple.darwin14/share/julia/stdlib/v1.11/LinearAlgebra/src/\u001b[39m\u001b[90m\u001b[4mcholesky.jl:401\u001b[24m\u001b[39m\n  [8] \u001b[0m\u001b[1mcholesky\u001b[22m\n\u001b[90m    @\u001b[39m \u001b[90m~/.julia/juliaup/julia-1.11.5+0.aarch64.apple.darwin14/share/julia/stdlib/v1.11/LinearAlgebra/src/\u001b[39m\u001b[90m\u001b[4mcholesky.jl:401\u001b[24m\u001b[39m\u001b[90m [inlined]\u001b[39m\n  [9] \u001b[0m\u001b[1mcholesky\u001b[22m\u001b[0m\u001b[1m(\u001b[22m\u001b[90mA\u001b[39m::\u001b[0mMatrix\u001b[90m{Float64}\u001b[39m\u001b[0m\u001b[1m)\u001b[22m\n\u001b[90m    @\u001b[39m \u001b[35mLinearAlgebra\u001b[39m \u001b[90m~/.julia/juliaup/julia-1.11.5+0.aarch64.apple.darwin14/share/julia/stdlib/v1.11/LinearAlgebra/src/\u001b[39m\u001b[90m\u001b[4mcholesky.jl:401\u001b[24m\u001b[39m\n [10] top-level scope\n\u001b[90m    @\u001b[39m \u001b[90m\u001b[4mIn[139]:1\u001b[24m\u001b[39m","ename":"LoadError","evalue":"PosDefException: matrix is not positive definite; Factorization failed."}],"visibility":"show","key":"kkU5ygnPRp"}],"data":{"tags":["raises-exception"]},"visibility":"show","key":"scLdDSSlJE"},{"type":"paragraph","position":{"start":{"line":1384,"column":1},"end":{"line":1384,"column":1}},"children":[{"type":"text","value":"It’s not hard to manufacture an ","key":"lzENrDqUvY"},{"type":"abbreviation","title":"symmetric positive definite","children":[{"type":"text","value":"SPD","key":"X4qZeTGkzd"}],"key":"adzy8SbEXL"},{"type":"text","value":" matrix to try out the Cholesky factorization.","key":"wEzmJ7kwIK"}],"key":"XhezHI4zY0"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"B = A' * A\ncf = cholesky(B)","key":"GfZx6FyaB1"},{"type":"output","id":"aQO44_YBXO8d_XhbFQOmm","data":[{"output_type":"execute_result","execution_count":140,"metadata":{},"data":{"text/plain":{"content":"Cholesky{Float64, Matrix{Float64}}\nU factor:\n4×4 UpperTriangular{Float64, Matrix{Float64}}:\n 14.0712  7.39096  9.59403  11.726\n   ⋅      3.92094  3.59376   1.61526\n   ⋅       ⋅       4.12788   1.13742\n   ⋅       ⋅        ⋅        0.772793","content_type":"text/plain"}}}],"key":"HC5iNQ77xD"}],"key":"PYTVJDHaz3"},{"type":"paragraph","position":{"start":{"line":1391,"column":1},"end":{"line":1391,"column":1}},"children":[{"type":"text","value":"What’s returned is a factorization object. Another step is required to extract the factor as a matrix:","position":{"start":{"line":1391,"column":1},"end":{"line":1391,"column":1}},"key":"njQh7YjmWh"}],"key":"PqVCElleHS"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"R = cf.U","key":"lqEe5gqEsL"},{"type":"output","id":"JAKg5vl6p87IZ55xZ_pzy","data":[{"output_type":"execute_result","execution_count":141,"metadata":{},"data":{"text/plain":{"content":"4×4 UpperTriangular{Float64, Matrix{Float64}}:\n 14.0712  7.39096  9.59403  11.726\n   ⋅      3.92094  3.59376   1.61526\n   ⋅       ⋅       4.12788   1.13742\n   ⋅       ⋅        ⋅        0.772793","content_type":"text/plain"}}}],"key":"Ll1VPUDeDf"}],"key":"LLYwho9LeI"},{"type":"paragraph","position":{"start":{"line":1397,"column":1},"end":{"line":1397,"column":1}},"children":[{"type":"text","value":"Here we validate the factorization:","position":{"start":{"line":1397,"column":1},"end":{"line":1397,"column":1}},"key":"h4YqIr1Tkn"}],"key":"DQfPNpele2"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"opnorm(R' * R - B) / opnorm(B)","key":"jfHNJKjgYD"},{"type":"output","id":"FWZ24WsmVze1CbuzMniC0","data":[{"output_type":"execute_result","execution_count":142,"metadata":{},"data":{"text/plain":{"content":"6.315313875154444e-17","content_type":"text/plain"}}}],"key":"aj0DYmYEPy"}],"key":"Ufs1nP1GJ8"}],"label":"demo-structure-cholesky-julia","identifier":"demo-structure-cholesky-julia","html_id":"demo-structure-cholesky-julia","key":"yRMZsqehaj"}],"key":"m8F0C8rPGn"}],"key":"jKp2pBqZxv"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Chapter 1","url":"/chapter1","group":"Julia codes"},"next":{"title":"Chapter 3","url":"/chapter3","group":"Julia codes"}}},"domain":"http://localhost:3000"}