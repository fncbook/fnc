{"kind":"Notebook","sha256":"8a1928080ef9fd44382b4ace6d6713e84edf7f8c359981734931a24c889b1b53","slug":"chapter6","location":"/julia/chapter6.md","dependencies":[],"frontmatter":{"title":"Chapter 6","numbering":{"heading_1":{"enabled":false},"heading_2":{"enabled":false},"heading_3":{"enabled":false},"heading_4":{"enabled":false},"heading_5":{"enabled":false},"heading_6":{"enabled":false},"title":{"offset":2}},"kernelspec":{"name":"julia-1.11","display_name":"Julia 1","language":"julia"},"content_includes_title":false,"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"edit_url":"https://github.com/fncbook/fnc/blob/master/julia/chapter6.md","exports":[{"format":"md","filename":"chapter6.md","url":"/build/chapter6-9ecdb565a81ceaf807e7e581b45ba478.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Functions","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"Stq2aIexLz"}],"identifier":"functions","label":"Functions","html_id":"functions","implicit":true,"key":"Y99zoOxEtO"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Euler’s method for an initial-value problem","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"cI51xwi2St"}],"key":"EQENeheyJe"},{"type":"include","file":"FNCFunctions/src/chapter06.jl","literal":true,"filter":{"startAfter":"# begin euler","endBefore":"# end euler"},"children":[{"type":"code","value":"\"\"\"\n    euler(ivp, n)\n\nApply Euler's method to solve the given IVP using `n` time steps.\nReturns a vector of times and a vector of solution values.\n\"\"\"\nfunction euler(ivp, n)\n    # Time discretization.\n    a, b = ivp.tspan\n    h = (b - a) / n\n    t = [a + i * h for i in 0:n]\n\n    # Initial condition and output setup.\n    u = fill(float(ivp.u0), n+1)\n\n    # The time stepping iteration.\n    for i in 1:n\n        u[i+1] = u[i] + h * ivp.f(u[i], ivp.p, t[i])\n    end\n    return t, u\nend","lang":"julia","showLineNumbers":true,"filename":"euler.jl","key":"riY3INOb9K"}],"key":"pbdP8yV9ec"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"About the code","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"a5AtaMLKhH"}],"key":"maFnS2kI4A"},{"type":"paragraph","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"HEnV7lzV44"},{"type":"inlineCode","value":"ivp","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"Q06rlxqGw1"},{"type":"text","value":" input argument is an ","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"VFLMkERfkg"},{"type":"inlineCode","value":"ODEProblem","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"GXQceqaK5P"},{"type":"text","value":", like in ","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"yKjmpfxL1p"},{"type":"crossReference","kind":"proof:example","identifier":"demo-basics-first","label":"demo-basics-first","children":[{"type":"text","value":"Demo ","key":"PLeUYTLgCX"},{"type":"text","value":"6.1.2","key":"t7draHS0cT"}],"template":"Example %s","enumerator":"6.1.2","resolved":true,"html_id":"demo-basics-first","remote":true,"url":"/basics","dataUrl":"/basics.json","key":"F6o5YS2iUt"},{"type":"text","value":". It has fields ","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"DK27CYLBpP"},{"type":"inlineCode","value":"ivp.f","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"reBS4zCZwK"},{"type":"text","value":", ","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"UVF4JYVJTj"},{"type":"inlineCode","value":"ivp.tspan","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"hSVHVwR5OP"},{"type":"text","value":", ","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"DZF2XKev6N"},{"type":"inlineCode","value":"ivp.u0","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"LC3yUdvl3G"},{"type":"text","value":", and ","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"t1Fp5mfmQY"},{"type":"inlineCode","value":"ivp.p","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"rDhKD1K6Rz"},{"type":"text","value":" that fully define the problem. The outputs are vectors of the nodes and approximate solution values at those nodes.","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"d2DHAviWEg"}],"key":"TOuky5pmAj"}],"class":"dropdown","key":"Nc5YSC53vv"}],"label":"function-euler-julia","identifier":"function-euler-julia","html_id":"function-euler-julia","key":"V2OITjUfLR"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Improved Euler method for an ","key":"RI6el0IZnA"},{"type":"abbreviation","title":"initial-value problem","children":[{"type":"text","value":"IVP","key":"f7sb5LOfsH"}],"key":"RvSFKGb7P0"}],"key":"KPfekecxX9"},{"type":"include","file":"FNCFunctions/src/chapter06.jl","literal":true,"filter":{"startAfter":"# begin ie2","endBefore":"# end ie2"},"children":[{"type":"code","value":"\"\"\"\n    ie2(ivp, n)\n\nApply the Improved Euler method to solve the given IVP using `n`\ntime steps. Returns a vector of times and a vector of solution\nvalues.\n\"\"\"\nfunction ie2(ivp, n)\n    # Time discretization.\n    a, b = ivp.tspan\n    h = (b - a) / n\n    t = [a + i * h for i in 0:n]\n\n    # Initialize output.\n    u = fill(float(ivp.u0), n+1)\n\n    # Time stepping.\n    for i in 1:n\n        uhalf = u[i] + h / 2 * ivp.f(u[i], ivp.p, t[i])\n        u[i+1] = u[i] + h * ivp.f(uhalf, ivp.p, t[i] + h / 2)\n    end\n    return t, u\nend","lang":"julia","showLineNumbers":true,"filename":"ie2.jl","key":"a3AK8XoWt2"}],"key":"lfkEX22W3f"}],"label":"function-ie2-julia","identifier":"function-ie2-julia","html_id":"function-ie2-julia","key":"y1uvXaO1hQ"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Fourth-order Runge-Kutta for an ","key":"XN4t4TYCHS"},{"type":"abbreviation","title":"initial-value problem","children":[{"type":"text","value":"IVP","key":"i5Yu0K9wqf"}],"key":"XK0cXDXn5E"}],"key":"V2c9w3AKzj"},{"type":"include","file":"FNCFunctions/src/chapter06.jl","literal":true,"filter":{"startAfter":"# begin rk4","endBefore":"# end rk4"},"children":[{"type":"code","value":"\"\"\"\n    rk4(ivp, n)\n\nApply the common Runge-Kutta 4th order method to solve the given\nIVP using `n` time steps. Returns a vector of times and a vector of\nsolution values.\n\"\"\"\nfunction rk4(ivp, n)\n\n    # Time discretization.\n    a, b = ivp.tspan\n    h = (b - a) / n\n    t = [a + i * h for i in 0:n]\n\n    # Initialize output.\n    u = fill(float(ivp.u0), n+1)\n\n    # Time stepping.\n    for i in 1:n\n        k₁ = h * ivp.f(u[i], ivp.p, t[i])\n        k₂ = h * ivp.f(u[i] + k₁ / 2, ivp.p, t[i] + h / 2)\n        k₃ = h * ivp.f(u[i] + k₂ / 2, ivp.p, t[i] + h / 2)\n        k₄ = h * ivp.f(u[i] + k₃, ivp.p, t[i] + h)\n        u[i+1] = u[i] + (k₁ + 2(k₂ + k₃) + k₄) / 6\n    end\n    return t, u\nend","lang":"julia","showLineNumbers":true,"filename":"rk4.jl","key":"ExMgOmOAhB"}],"key":"WBdJjxL4Oc"}],"label":"function-rk4-julia","identifier":"function-rk4-julia","html_id":"function-rk4-julia","key":"Zbl7cfpOQa"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Adaptive ","key":"oW40gVfCOr"},{"type":"abbreviation","title":"initial-value problem","children":[{"type":"text","value":"IVP","key":"kDZYhiv13E"}],"key":"dtWG061g2t"},{"type":"text","value":" solver based on embedded RK formulas","key":"clCDBrtBGd"}],"key":"bHqWcLpQX1"},{"type":"include","file":"FNCFunctions/src/chapter06.jl","literal":true,"filter":{"startAfter":"# begin rk23","endBefore":"# end rk23"},"children":[{"type":"code","value":"\"\"\"\n    rk23(ivp, tol)\n\nApply an adaptive embedded RK formula pair to solve given IVP with\nestimated error `tol`. Returns a vector of times and a vector of\nsolution values.\n\"\"\"\nfunction rk23(ivp, tol)\n    # Initialize for the first time step.\n    a, b = ivp.tspan\n    t = [a]\n    u = [float(ivp.u0)]\n    i = 1\n    h = 0.5 * tol^(1 / 3)\n    s₁ = ivp.f(ivp.u0, ivp.p, a)\n\n    # Time stepping.\n    while t[i] < b\n        # Detect underflow of the step size.\n        if t[i] + h == t[i]\n            @warn \"Stepsize too small near t=$(t[i])\"\n            break  # quit time stepping loop\n        end\n\n        # New RK stages.\n        s₂ = ivp.f(u[i] + (h / 2) * s₁, ivp.p, t[i] + h / 2)\n        s₃ = ivp.f(u[i] + (3h / 4) * s₂, ivp.p, t[i] + 3h / 4)\n        u_new3 = u[i] + h * (2s₁ + 3s₂ + 4s₃) / 9   # 3rd order solution\n        s₄ = ivp.f(u_new3, ivp.p, t[i] + h)\n        err = h * (-5s₁ / 72 + s₂ / 12 + s₃ / 9 - s₄ / 8)  # 2nd/3rd difference\n        E = norm(err, Inf)                         # error estimate\n        maxerr = tol * (1 + norm(u[i], Inf))     # relative/absolute blend\n\n        # Accept the proposed step?\n        if E < maxerr     # yes\n            push!(t, t[i] + h)\n            push!(u, u_new3)\n            i += 1\n            s₁ = s₄       # use FSAL property\n        end\n\n        # Adjust step size.\n        q = 0.8 * (maxerr / E)^(1 / 3)   # conservative optimal step factor\n        q = min(q, 4)               # limit stepsize growth\n        h = min(q * h, b - t[i])        # don't step past the end\n    end\n    return t, u\nend","lang":"julia","showLineNumbers":true,"filename":"rk23.jl","key":"mfyE7ISYad"}],"key":"p0XuhSIM4C"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"About the code","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"key":"p5vwTcHH9C"}],"key":"ohXcJQk3mt"},{"type":"paragraph","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"children":[{"type":"text","value":"The check ","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"uUiGsaRmw4"},{"type":"inlineCode","value":"t[i]+h == t[i]","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"UdVnHof2ps"},{"type":"text","value":"on line 19 is to detect when ","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"dBte53Ng8F"},{"type":"inlineMath","value":"h","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>h</mi></mrow><annotation encoding=\"application/x-tex\">h</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">h</span></span></span></span>","key":"lgjhzbZmzw"},{"type":"text","value":" has become so small that it no longer changes the floating-point value of ","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"DUwqQpdgua"},{"type":"inlineMath","value":"t_i","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>t</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">t_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7651em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"G5Z6pprOUm"},{"type":"text","value":". This may be a sign that the underlying exact solution has a singularity near ","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"FBre8hV3f9"},{"type":"inlineMath","value":"t=t_i","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi><mo>=</mo><msub><mi>t</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">t=t_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7651em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"KjjGnWxuyl"},{"type":"text","value":", but in any case, the solver must halt by using a ","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"A9KSfW9qGB"},{"type":"inlineCode","value":"break","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"BlJKwG1WXu"},{"type":"text","value":" statement to exit the loop.","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"ntnwQuzeV5"}],"key":"ShBRJmbFgm"},{"type":"paragraph","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"children":[{"type":"text","value":"On line 30, we use a combination of absolute and relative tolerances to judge the acceptability of a solution value, as in ","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"key":"RptSL9CSMB"},{"type":"crossReference","kind":"equation","identifier":"absreltolerance","label":"absreltolerance","children":[{"type":"text","value":"(","key":"fvaxInOJgI"},{"type":"text","value":"5.7.6","key":"FG1cxx7CHV"},{"type":"text","value":")","key":"lcgntDvbyr"}],"template":"(%s)","enumerator":"5.7.6","resolved":true,"html_id":"absreltolerance","remote":true,"url":"/adaptive","dataUrl":"/adaptive.json","key":"XvOgRZi0FI"},{"type":"text","value":". In lines 41--43 we underestimate the step factor ","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"key":"bJnpWbiaHH"},{"type":"inlineMath","value":"q","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>q</mi></mrow><annotation encoding=\"application/x-tex\">q</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span></span></span></span>","key":"Q9gEZmavSM"},{"type":"text","value":" a bit and prevent a huge increase in the step size, since a rejected step is expensive, and then we make sure that our final step doesn’t take us past the end of the domain.","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"key":"paWJtsn3BG"}],"key":"ZxMZwDuB9p"},{"type":"paragraph","position":{"start":{"line":69,"column":1},"end":{"line":70,"column":1}},"children":[{"type":"text","value":"Finally, line 37 exploits a subtle property of the BS23 formula called ","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"key":"GNnTCzJ1CG"},{"type":"emphasis","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"children":[{"type":"text","value":"first same as last","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"key":"n8cHD7028S"}],"key":"tqnqCw5Xzp"},{"type":"text","value":" (FSAL).\nWhile ","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"key":"nRvaonO2FL"},{"type":"crossReference","kind":"equation","identifier":"bs23","label":"bs23","children":[{"type":"text","value":"(","key":"swf4KJgDgF"},{"type":"text","value":"6.5.5","key":"kDzgI8spmj"},{"type":"text","value":")","key":"vsuXBPLVlD"}],"template":"(%s)","enumerator":"6.5.5","resolved":true,"html_id":"bs23","remote":true,"url":"/adaptive-rk","dataUrl":"/adaptive-rk.json","key":"heeFhLfU5B"},{"type":"text","value":" calls for four stages to find the paired second- and third-order estimates, the final stage computed in stepping from ","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"key":"kMs3zAZajW"},{"type":"inlineMath","value":"t_i","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>t</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">t_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7651em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"S48WApofiQ"},{"type":"text","value":" to ","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"key":"zdbQ3guJaB"},{"type":"inlineMath","value":"t_{i+1}","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>t</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding=\"application/x-tex\">t_{i+1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8234em;vertical-align:-0.2083em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span></span></span></span>","key":"ONTT40yJGv"},{"type":"text","value":" is identical to the first stage needed to step from ","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"key":"XpsmxZlQe2"},{"type":"inlineMath","value":"t_{i+1}","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>t</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding=\"application/x-tex\">t_{i+1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8234em;vertical-align:-0.2083em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span></span></span></span>","key":"zFBjxfAuIu"},{"type":"text","value":" to ","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"key":"as0g42zFXC"},{"type":"inlineMath","value":"t_{i+2}","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>t</mi><mrow><mi>i</mi><mo>+</mo><mn>2</mn></mrow></msub></mrow><annotation encoding=\"application/x-tex\">t_{i+2}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8234em;vertical-align:-0.2083em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">2</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span></span></span></span>","key":"ki6aZdSHWF"},{"type":"text","value":". By repurposing ","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"key":"A6bMOW7jU1"},{"type":"inlineCode","value":"s₄","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"key":"KOU3b5WEMM"},{"type":"text","value":" as ","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"key":"PFnCTeqhPV"},{"type":"inlineCode","value":"s₁","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"key":"ZCvzXE4d6g"},{"type":"text","value":" for the next pass, one of the stage evaluations comes for free, and only three evaluations of ","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"key":"iJs0N03O7W"},{"type":"inlineMath","value":"f","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>","key":"yx07VYG974"},{"type":"text","value":" are needed per successful step.","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"key":"KBOAjooQjJ"}],"key":"UptVbL1QoC"}],"class":"dropdown","key":"DnLBTzvFmL"}],"label":"function-rk23-julia","identifier":"function-rk23-julia","html_id":"function-rk23-julia","key":"ROyBeXybpw"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"4th-order Adams–Bashforth formula for an ","key":"vrPK8xkRcb"},{"type":"abbreviation","title":"initial-value problem","children":[{"type":"text","value":"IVP","key":"PyTSzGKWmB"}],"key":"u78xP75SzT"}],"key":"k8nhN6kIed"},{"type":"include","file":"FNCFunctions/src/chapter06.jl","literal":true,"filter":{"startAfter":"# begin ab4","endBefore":"# end ab4"},"children":[{"type":"code","value":"\"\"\"\n    ab4(ivp, n)\n\nApply the Adams-Bashforth 4th order method to solve the given IVP\nusing `n` time steps. Returns a vector of times and a vector of\nsolution values.\n\"\"\"\nfunction ab4(ivp, n)\n    # Time discretization.\n    a, b = ivp.tspan\n    h = (b - a) / n\n    t = [a + i * h for i in 0:n]\n\n    # Constants in the AB4 method.\n    k = 4\n    σ = [55, -59, 37, -9] / 24\n\n    # Find starting values by RK4.\n    u = fill(float(ivp.u0), n+1)\n    rkivp = ODEProblem(ivp.f, ivp.u0, (a, a + (k - 1) * h), ivp.p)\n    ts, us = rk4(rkivp, k - 1)\n    u[1:k] .= us\n\n    # Compute history of u' values, from newest to oldest.\n    f = [ivp.f(u[k-i], ivp.p, t[k-i]) for i in 1:k-1]\n\n    # Time stepping.\n    for i in k:n\n        f = [ivp.f(u[i], ivp.p, t[i]), f[1:k-1]...]   # new value of du/dt\n        u[i+1] = u[i] + h * sum(f[j] * σ[j] for j in 1:k)  # advance a step\n    end\n    return t, u\nend","lang":"julia","showLineNumbers":true,"filename":"ab4.jl","key":"MdORzokM1I"}],"key":"AZcbYKAt2E"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"About the code","position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"key":"lOJbQiMC0o"}],"key":"lQTQ5v7N5i"},{"type":"paragraph","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"children":[{"type":"text","value":"Line 15 sets ","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"PItBNxpvgM"},{"type":"inlineCode","value":"σ","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"C1N3dCil2w"},{"type":"text","value":" to be the coefficients of the generating polynomial ","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"cNli4hnGte"},{"type":"inlineMath","value":"\\sigma(z)","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>σ</mi><mo stretchy=\"false\">(</mo><mi>z</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\sigma(z)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"mclose\">)</span></span></span></span>","key":"yPQN9Ln04D"},{"type":"text","value":" of AB4. Lines 19--21 set up the ","key":"Gp1nCEGWqW"},{"type":"abbreviation","title":"initial-value problem","children":[{"type":"text","value":"IVP","key":"tIdH7opg2v"}],"key":"pQd9jjj6ns"},{"type":"text","value":" over the time interval ","key":"sQdrIlNx0Z"},{"type":"inlineMath","value":"a \\le t \\le a+3 h","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi><mo>≤</mo><mi>t</mi><mo>≤</mo><mi>a</mi><mo>+</mo><mn>3</mn><mi>h</mi></mrow><annotation encoding=\"application/x-tex\">a \\le t \\le a+3 h</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7719em;vertical-align:-0.136em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7719em;vertical-align:-0.136em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord\">3</span><span class=\"mord mathnormal\">h</span></span></span></span>","key":"VekA9rocxa"},{"type":"text","value":", call ","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"Zvc8J9uEu2"},{"type":"inlineCode","value":"rk4","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"CM256oBYxt"},{"type":"text","value":" to solve it using the step size ","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"N5FcHLQHp3"},{"type":"inlineMath","value":"h","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>h</mi></mrow><annotation encoding=\"application/x-tex\">h</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">h</span></span></span></span>","key":"JPhNbZSuly"},{"type":"text","value":", and use the result to fill the first four values of the solution. Then line 24 computes the vector ","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"SkrYuZLtGW"},{"type":"inlineMath","value":"[f_2,f_1,f_0]","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><msub><mi>f</mi><mn>2</mn></msub><mo separator=\"true\">,</mo><msub><mi>f</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><msub><mi>f</mi><mn>0</mn></msub><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[f_2,f_1,f_0]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">]</span></span></span></span>","key":"rFxeoUK8nm"},{"type":"text","value":".","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"Z78zron1ZQ"}],"key":"y1fRveP4To"},{"type":"paragraph","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"children":[{"type":"text","value":"Line 28 computes ","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"key":"rljBGxrDdT"},{"type":"inlineMath","value":"f_i","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>f</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">f_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"vgoHAAOeEB"},{"type":"text","value":", based on the most recent solution value and time. That goes into the first spot of ","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"key":"QSiIhWYEOM"},{"type":"inlineCode","value":"f","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"key":"PpJe4PjSpm"},{"type":"text","value":", followed by the three values that were previously most recent. These are the four values that appear in ","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"key":"LJophuQZgm"},{"type":"crossReference","kind":"equation","identifier":"ab4","label":"ab4","children":[{"type":"text","value":"(","key":"SxsI5N0x5X"},{"type":"text","value":"6.7.1","key":"BxOSAtj0Bp"},{"type":"text","value":")","key":"hBJg4Of3KK"}],"template":"(%s)","enumerator":"6.7.1","resolved":true,"html_id":"ab4","remote":true,"url":"/implicit","dataUrl":"/implicit.json","key":"JNIblvQzvI"},{"type":"text","value":". Each particular ","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"key":"A9XW2titXs"},{"type":"inlineMath","value":"f_i","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>f</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">f_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"W7zbvnNyZP"},{"type":"text","value":" value starts at the front of ","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"key":"wdea3Zb3wj"},{"type":"inlineCode","value":"f","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"key":"uTHxSwX1pP"},{"type":"text","value":", moves through each position in the vector over three iterations, and then is forgotten.","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"key":"xAGcpiIS2M"}],"key":"TWwLE0FuhL"}],"class":"dropdown","key":"iDLJ6HLnOO"}],"label":"function-ab4-julia","identifier":"function-ab4-julia","html_id":"function-ab4-julia","key":"tmwZ95n2B3"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"2nd-order Adams–Moulton (trapezoid) formula for an ","key":"GNVRDITFl7"},{"type":"abbreviation","title":"initial-value problem","children":[{"type":"text","value":"IVP","key":"ELNtL0JIIL"}],"key":"TBIicnimmY"}],"key":"AuAdyHbwYL"},{"type":"include","file":"FNCFunctions/src/chapter06.jl","literal":true,"filter":{"startAfter":"# begin am2","endBefore":"# end am2"},"children":[{"type":"code","value":"\"\"\"\n    am2(ivp, n)\n\nApply the Adams-Moulton 2nd order method to solve given IVP using\n`n` time steps. Returns a vector of times and a vector of\nsolution values.\n\"\"\"\nfunction am2(ivp, n)\n    # Time discretization.\n    a, b = ivp.tspan\n    h = (b - a) / n\n    t = [a + i * h for i in 0:n]\n\n    # Initialize output.\n    u = fill(float(ivp.u0), n+1)\n\n    # Time stepping.\n    for i in 1:n\n        # Data that does not depend on the new value.\n        known = u[i] + h / 2 * ivp.f(u[i], ivp.p, t[i])\n        # Find a root for the new value.\n        g = z -> z - h / 2 * ivp.f(z, ivp.p, t[i+1]) - known\n        u_new = levenberg(g, known)\n        u[i+1] = u_new[end]\n    end\n    return t, u\nend","lang":"julia","showLineNumbers":true,"filename":"am2.jl","key":"Z6r858ejAG"}],"key":"Z8N0mzguOs"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"About the code","position":{"start":{"line":103,"column":1},"end":{"line":103,"column":1}},"key":"KWL2vG85wk"}],"key":"dFPM325Hu2"},{"type":"paragraph","position":{"start":{"line":105,"column":1},"end":{"line":105,"column":1}},"children":[{"type":"text","value":"Lines 22-23 define the function ","position":{"start":{"line":105,"column":1},"end":{"line":105,"column":1}},"key":"xMB2sO2sLb"},{"type":"inlineMath","value":"\\mathbf{g}","position":{"start":{"line":105,"column":1},"end":{"line":105,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">g</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{g}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6389em;vertical-align:-0.1944em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">g</span></span></span></span>","key":"hSXYMhBmXU"},{"type":"text","value":" and call ","position":{"start":{"line":105,"column":1},"end":{"line":105,"column":1}},"key":"uj7WyxOTOE"},{"type":"inlineCode","value":"levenberg","position":{"start":{"line":105,"column":1},"end":{"line":105,"column":1}},"key":"YNRFR1EZLC"},{"type":"text","value":" to find the new solution value, using an Euler half-step as its starting value. A robust code would have to intercept the case where ","position":{"start":{"line":105,"column":1},"end":{"line":105,"column":1}},"key":"M4B54CSTsO"},{"type":"inlineCode","value":"levenberg","position":{"start":{"line":105,"column":1},"end":{"line":105,"column":1}},"key":"wrh50DTnsp"},{"type":"text","value":" fails to converge, but we have ignored this issue for the sake of brevity.","position":{"start":{"line":105,"column":1},"end":{"line":105,"column":1}},"key":"IjNuePqbUj"}],"key":"vkmMdlrxhq"}],"class":"dropdown","key":"ROw2gMIfKm"}],"label":"function-am2-julia","identifier":"function-am2-julia","html_id":"function-am2-julia","key":"MgERywBr8J"},{"type":"heading","depth":2,"position":{"start":{"line":109,"column":1},"end":{"line":109,"column":1}},"children":[{"type":"text","value":"Examples","position":{"start":{"line":109,"column":1},"end":{"line":109,"column":1}},"key":"Tryhuht8Fq"}],"identifier":"examples","label":"Examples","html_id":"examples","implicit":true,"key":"rM6L948IRK"}],"key":"relkv4y3N8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"include(\"FNC_init.jl\")","visibility":"show","key":"AY2Zk56dfX"},{"type":"output","id":"ZKaHBTSfzJajgDhZJzgi3","data":[{"output_type":"stream","name":"stderr","text":"\u001b[32m\u001b[1m  Activating\u001b[22m\u001b[39m "},{"output_type":"stream","name":"stderr","text":"project at `~/Documents/GitHub/fnc`\n"}],"visibility":"show","key":"Qz5kf6QQSn"}],"data":{"tags":[]},"visibility":"remove","key":"mE6NqZin5b"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"children":[{"type":"text","value":"6.1 ","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"key":"Ht5iZN0rx3"},{"type":"link","identifier":"section-ivp-basics","label":"section-ivp-basics","kind":"narrative","position":{"start":{"line":116,"column":5},"end":{"line":116,"column":24}},"url":"/basics","internal":true,"dataUrl":"/basics.json","children":[{"type":"text","value":"Basics of IVPs","key":"txEPXQa4CC"}],"key":"qgKGbTQNVV"}],"identifier":"id-6-1","label":"6.1 ","html_id":"id-6-1","implicit":true,"key":"MGHcsiQ5S2"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-basics-first","label":"demo-basics-first","kind":"proof:example","position":{"start":{"line":118,"column":1},"end":{"line":118,"column":19}},"children":[{"type":"text","value":"Example ","key":"X1URuqzlYn"},{"type":"text","value":"6.1.2","key":"QoW3MmTBUQ"}],"template":"Example %s","enumerator":"6.1.2","resolved":true,"html_id":"demo-basics-first","remote":true,"url":"/basics","dataUrl":"/basics.json","key":"YZ96iz2wIy"}],"key":"PJ4YBcZXqr"},{"type":"paragraph","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"key":"ph6uLYPQWh"},{"type":"inlineCode","value":"OrdinaryDiffEq","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"key":"SuLzUkiZxx"},{"type":"text","value":" package offers solvers for ","key":"BwQQ16Fb52"},{"type":"abbreviation","title":"initial-value problem","children":[{"type":"text","value":"IVP","key":"WiciMT5I4f"}],"key":"hF3D5NlddS"},{"type":"text","value":"s. Let’s use it to define and solve an initial-value problem for ","key":"q62XwvsjxS"},{"type":"inlineMath","value":"u'=\\sin[(u+t)^2]","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>u</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo>=</mo><mi>sin</mi><mo>⁡</mo><mo stretchy=\"false\">[</mo><mo stretchy=\"false\">(</mo><mi>u</mi><mo>+</mo><mi>t</mi><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">u&#x27;=\\sin[(u+t)^2]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop\">sin</span><span class=\"mopen\">[(</span><span class=\"mord mathnormal\">u</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mclose\">]</span></span></span></span>","key":"jdRyq6Mb1g"},{"type":"text","value":" over ","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"key":"gnCs9F2U3y"},{"type":"inlineMath","value":"t \\in [0,4]","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi><mo>∈</mo><mo stretchy=\"false\">[</mo><mn>0</mn><mo separator=\"true\">,</mo><mn>4</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">t \\in [0,4]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6542em;vertical-align:-0.0391em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">4</span><span class=\"mclose\">]</span></span></span></span>","key":"vIAikZ72F1"},{"type":"text","value":", such that ","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"key":"qgOydSsOL3"},{"type":"inlineMath","value":"u(0)=-1","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo stretchy=\"false\">(</mo><mn>0</mn><mo stretchy=\"false\">)</mo><mo>=</mo><mo>−</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">u(0)=-1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">−</span><span class=\"mord\">1</span></span></span></span>","key":"YwyumhAIH1"},{"type":"text","value":".","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"key":"DbHovaAadn"}],"key":"LUZI1fXPwT"},{"type":"paragraph","position":{"start":{"line":122,"column":1},"end":{"line":122,"column":1}},"children":[{"type":"text","value":"Because many practical problems come with parameters that are fixed within an instance but varied from one instance to another, the syntax for ","key":"pGnPEWIeRD"},{"type":"abbreviation","title":"initial-value problem","children":[{"type":"text","value":"IVP","key":"AQxVuU4dBk"}],"key":"ToEvOuJxJl"},{"type":"text","value":"s includes a input argument ","key":"HBu23l5JJ0"},{"type":"inlineCode","value":"p","position":{"start":{"line":122,"column":1},"end":{"line":122,"column":1}},"key":"qUnO7quYuO"},{"type":"text","value":" that stays fixed throughout the solution. Here we don’t want to use that argument, but it must be in the definition for the solver to work.","position":{"start":{"line":122,"column":1},"end":{"line":122,"column":1}},"key":"hwJ9VAhOx5"}],"key":"xbQdbHJDhS"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"jXIlEUJHYh"}],"key":"b8MDbg6La1"},{"type":"paragraph","position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"children":[{"type":"text","value":"To create an initial-value problem for ","position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"key":"gMoTEqOytO"},{"type":"inlineMath","value":"u(t)","position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">u(t)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span></span></span></span>","key":"pPWyTdalG9"},{"type":"text","value":", you must supply a function that computes ","position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"key":"p8zYSsRJ81"},{"type":"inlineMath","value":"u'","position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>u</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup></mrow><annotation encoding=\"application/x-tex\">u&#x27;</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span></span></span></span>","key":"hroPtvh8Ir"},{"type":"text","value":", an initial value for ","position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"key":"IxLr5K6KvK"},{"type":"inlineMath","value":"u","position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span>","key":"eO5c5ldxbA"},{"type":"text","value":", and the endpoints of the interval for ","position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"key":"p33Nya7z9i"},{"type":"inlineMath","value":"t","position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span></span></span></span>","key":"wPzW5Gsva8"},{"type":"text","value":". The ","position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"key":"vDcs17attb"},{"type":"inlineMath","value":"t","position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span></span></span></span>","key":"UZSLwf4Ise"},{"type":"text","value":" interval should be defined as ","position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"key":"KDIahfYTr3"},{"type":"inlineCode","value":"(a,b)","position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"key":"ot48olmRhK"},{"type":"text","value":", where at least one of the values is a float.","position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"key":"XSMI2Zqaem"}],"key":"mWeVuRCRH1"}],"class":"dropdown","key":"bKVZyoXrac"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"f(u, p, t) = sin((t + u)^2)     # defines du/dt, must include p argument\nu₀ = -1.0                       # initial value\ntspan = (0.0, 4.0)               # t interval","key":"S6f2i0ZNK5"},{"type":"output","id":"x6VUimNbpkPUYuD2K21wF","data":[{"output_type":"execute_result","execution_count":2,"metadata":{},"data":{"text/plain":{"content":"(0.0, 4.0)","content_type":"text/plain"}}}],"key":"CseDiUcDJW"}],"data":{},"indexEntries":[{"entry":"Julia","subEntry":{"value":"ODEProblem","kind":"entry"},"emphasis":true},{"entry":"Julia","subEntry":{"value":"solve","kind":"entry"},"emphasis":true}],"label":"index-G4Z8gMPRjp","identifier":"index-g4z8gmprjp","html_id":"index-g4z8gmprjp","key":"IqYKhkFzjN"},{"type":"paragraph","position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"children":[{"type":"text","value":"With the data above we define an ","key":"rubzSCTd90"},{"type":"abbreviation","title":"initial-value problem","children":[{"type":"text","value":"IVP","key":"m0qlZ4QRyY"}],"key":"lFGe9trsao"},{"type":"text","value":" problem object and then solve it. Here we tell the solver to use the ","key":"pvDGhhapVH"},{"type":"inlineCode","value":"Tsit5","position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"key":"xeLrESBomb"},{"type":"text","value":" method, which is a good first choice for most problems.","position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"key":"Z00rFMgvU1"}],"key":"TsuLs3dhuU"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"using OrdinaryDiffEq\nivp = ODEProblem(f, u₀, tspan)\nsol = solve(ivp, Tsit5());","key":"yMXwrcfdsl"},{"type":"output","id":"1gbE2jeDtNt_jc3WE1_UL","data":[],"key":"vqKhpNDaNJ"}],"data":{},"key":"Q8mPyGlTzL"},{"type":"paragraph","position":{"start":{"line":145,"column":1},"end":{"line":145,"column":1}},"children":[{"type":"text","value":"The resulting solution object can be shown using ","position":{"start":{"line":145,"column":1},"end":{"line":145,"column":1}},"key":"NJmCXkBa0S"},{"type":"inlineCode","value":"plot","position":{"start":{"line":145,"column":1},"end":{"line":145,"column":1}},"key":"imfFfRJpiw"},{"type":"text","value":".","position":{"start":{"line":145,"column":1},"end":{"line":145,"column":1}},"key":"iC2heYliAA"}],"key":"hk1kfms579"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"using Plots\nplot(sol;\n    label=\"solution\", legend=:bottom,\n    xlabel=\"t\",  ylabel=L\"u(t)\",\n    title=L\"u'=\\sin((t+u)^2)\")","key":"Nnt11gnnFf"},{"type":"output","id":"75LHy3vPA5rlbPtgrWMjc","data":[{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"c1a911d4a2c83f089b47213439a5c492","path":"/build/c1a911d4a2c83f089b47213439a5c492.png"},"text/html":{"content_type":"text/html","hash":"16498ea610695e9bd5b57401cf2cdba8","path":"/build/16498ea610695e9bd5b57401cf2cdba8.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"d652727be1220b3f0228b2de2dd1d76f","path":"/build/d652727be1220b3f0228b2de2dd1d76f.svg"}}}],"key":"w4TwovVKiE"}],"data":{},"key":"JraFsapqPf"},{"type":"paragraph","position":{"start":{"line":155,"column":1},"end":{"line":155,"column":1}},"children":[{"type":"text","value":"The solution also acts like any callable function that can be evaluated at different values of ","position":{"start":{"line":155,"column":1},"end":{"line":155,"column":1}},"key":"Ig0cBMUSdp"},{"type":"inlineMath","value":"t","position":{"start":{"line":155,"column":1},"end":{"line":155,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span></span></span></span>","key":"e2g6FOuPQ9"},{"type":"text","value":".","position":{"start":{"line":155,"column":1},"end":{"line":155,"column":1}},"key":"buIrq8sNcu"}],"key":"HdjFKQhSby"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"@show sol(1.0);","key":"nCJ2InDsrC"},{"type":"output","id":"ubiG553J5tO141KLt5cKe","data":[{"output_type":"stream","name":"stdout","text":"sol(1.0) = -0.7903205813665345"},{"output_type":"stream","name":"stdout","text":"\n"}],"key":"bSJixsF5of"}],"data":{},"key":"P49g3VovQ5"},{"type":"paragraph","position":{"start":{"line":161,"column":1},"end":{"line":161,"column":1}},"children":[{"type":"text","value":"Under the hood, the solution object holds some information about how the values and plot are produced:","position":{"start":{"line":161,"column":1},"end":{"line":161,"column":1}},"key":"dGdtJhkC1s"}],"key":"syVQRSLN4A"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"[sol.t sol.u]","key":"bPAIUTuq0a"},{"type":"output","id":"TreAlZ_ww2zkE2CLqbPQ4","data":[{"output_type":"execute_result","execution_count":6,"metadata":{},"data":{"text/plain":{"content":"15×2 Matrix{Float64}:\n 0.0        -1.0\n 0.0867807  -0.93483\n 0.241035   -0.856617\n 0.464665   -0.805668\n 0.696832   -0.793614\n 1.00862    -0.789925\n 1.37461    -0.718601\n 1.70407    -0.476837\n 1.93572    -0.29033\n 2.17184    -0.294994\n 2.4843     -0.483948\n 2.69425    -0.654121\n 3.27049    -1.1783\n 3.62534    -1.51729\n 4.0        -1.88086","content_type":"text/plain"}}}],"key":"opFkltncsx"}],"data":{},"key":"kPOA0AMn2G"},{"type":"paragraph","position":{"start":{"line":167,"column":1},"end":{"line":167,"column":1}},"children":[{"type":"text","value":"The solver initially finds approximate values of the solution (second column above) at some automatically chosen times (first column above). To compute the solution at other times, the object performs an interpolation on those values. This chapter is about how the discrete ","position":{"start":{"line":167,"column":1},"end":{"line":167,"column":1}},"key":"OBHL1JiXqe"},{"type":"inlineMath","value":"t","position":{"start":{"line":167,"column":1},"end":{"line":167,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span></span></span></span>","key":"kvd8oONMqV"},{"type":"text","value":" and ","position":{"start":{"line":167,"column":1},"end":{"line":167,"column":1}},"key":"ftGBilVUIq"},{"type":"inlineMath","value":"u","position":{"start":{"line":167,"column":1},"end":{"line":167,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span>","key":"lzPij55WaY"},{"type":"text","value":" values are computed. For now, just note how we can extract them from the solution object.","position":{"start":{"line":167,"column":1},"end":{"line":167,"column":1}},"key":"QWXs8UyzSG"}],"key":"pSCyhFba9j"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"scatter!(sol.t, sol.u, label=\"discrete values\")","key":"NiyVjUZnFr"},{"type":"output","id":"7SQkBkRle5ISKtyz9yuHD","data":[{"output_type":"execute_result","execution_count":7,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"a97d455ce06ece4839e5818a8d4390eb","path":"/build/a97d455ce06ece4839e5818a8d4390eb.png"},"text/html":{"content_type":"text/html","hash":"12cb06f41ef6100be9c96180858db228","path":"/build/12cb06f41ef6100be9c96180858db228.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"59398974d84668f989ad2c4c1bd8bc46","path":"/build/59398974d84668f989ad2c4c1bd8bc46.svg"}}}],"key":"FBZwoi6ZpR"}],"data":{},"key":"q7F1Qc7PEM"}],"label":"demo-basics-first-julia","identifier":"demo-basics-first-julia","html_id":"demo-basics-first-julia","key":"rOvjPjWnrN"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-basics-sing","label":"demo-basics-sing","kind":"proof:example","position":{"start":{"line":175,"column":1},"end":{"line":175,"column":18}},"children":[{"type":"text","value":"Example ","key":"cuMnO2rI8l"},{"type":"text","value":"6.1.3","key":"ezE2doGqCp"}],"template":"Example %s","enumerator":"6.1.3","resolved":true,"html_id":"demo-basics-sing","remote":true,"url":"/basics","dataUrl":"/basics.json","key":"G07tBKmXMY"}],"key":"ICNMXtcUUP"},{"type":"paragraph","position":{"start":{"line":178,"column":1},"end":{"line":178,"column":1}},"children":[{"type":"text","value":"The equation ","position":{"start":{"line":178,"column":1},"end":{"line":178,"column":1}},"key":"t2Qwgd33rZ"},{"type":"inlineMath","value":"u'=(u+t)^2","position":{"start":{"line":178,"column":1},"end":{"line":178,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>u</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo>=</mo><mo stretchy=\"false\">(</mo><mi>u</mi><mo>+</mo><mi>t</mi><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup></mrow><annotation encoding=\"application/x-tex\">u&#x27;=(u+t)^2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">u</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span>","key":"Q5RvKszS9g"},{"type":"text","value":" gives us some trouble.","position":{"start":{"line":178,"column":1},"end":{"line":178,"column":1}},"key":"l4NedQKFd1"}],"key":"Ry5fG1Zqlm"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"f(u, p, t) = (t + u)^2\nivp = ODEProblem(f, 1.0, (0.0, 1.0))\nsol = solve(ivp, Tsit5());","key":"Ef8rwosVIE"},{"type":"output","id":"qHkMgfVr_X0mS0iuq6Q9K","data":[{"output_type":"stream","name":"stderr","text":"\u001b[33m\u001b[1m┌ \u001b[22m\u001b[39m\u001b[33m\u001b[1mWarning: \u001b[22m\u001b[39mAt t=0.7853839417697203, dt was forced below floating point epsilon 1.1102230246251565e-16, and step error estimate = 42.16290621054672. Aborting. There is either an error in your model specification or the true solution is unstable (or the true solution can not be represented in the precision of Float64).\n\u001b[33m\u001b[1m└ \u001b[22m\u001b[39m\u001b[90m@ SciMLBase ~/.julia/packages/SciMLBase/XzPx0/src/integrator_interface.jl:623\u001b[39m\n"}],"key":"DQV7in0vDL"}],"data":{},"key":"TZ0WCzfE6R"},{"type":"paragraph","position":{"start":{"line":186,"column":1},"end":{"line":186,"column":1}},"children":[{"type":"text","value":"The warning message we received can mean that there is a bug in the formulation of the problem. But if everything has been done correctly, it suggests that the solution may not exist past the indicated time. This is a possibility in nonlinear ","key":"HUnfRKaucK"},{"type":"abbreviation","title":"ordinary differential equation","children":[{"type":"text","value":"ODE","key":"PTe007me1k"}],"key":"jjOY8aeCpI"},{"type":"text","value":"s.","key":"OZc9kSY1bk"}],"key":"lHNCQPt2Ab"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"plot(sol, label=\"\";\n    xlabel=L\"t\",  yaxis=(:log10, L\"u(t)\"),\n    title=\"Finite-time blowup\")","key":"BbPa36z0Ms"},{"type":"output","id":"0lF1wEoG9ls_pd0jvGlsL","data":[{"output_type":"execute_result","execution_count":9,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"c3a4b5fd4476d26fdcf1206840520f67","path":"/build/c3a4b5fd4476d26fdcf1206840520f67.png"},"text/html":{"content_type":"text/html","hash":"1a1a14b9902c60df1648cf8abf9590b5","path":"/build/1a1a14b9902c60df1648cf8abf9590b5.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"2572f136ab0a7f0764085e9297d64dbf","path":"/build/2572f136ab0a7f0764085e9297d64dbf.svg"}}}],"key":"HXu8XGoxtJ"}],"data":{},"key":"dlj2rQ01y6"}],"label":"demo-basics-sing-julia","identifier":"demo-basics-sing-julia","html_id":"demo-basics-sing-julia","key":"BLPKMzR4PO"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-basics-cond","label":"demo-basics-cond","kind":"proof:example","position":{"start":{"line":196,"column":1},"end":{"line":196,"column":18}},"children":[{"type":"text","value":"Example ","key":"MdbEA4SYkE"},{"type":"text","value":"6.1.5","key":"pAw9wc8XfI"}],"template":"Example %s","enumerator":"6.1.5","resolved":true,"html_id":"demo-basics-cond","remote":true,"url":"/basics","dataUrl":"/basics.json","key":"Kwto3Eo1Zr"}],"key":"MBeduA5kN1"},{"type":"paragraph","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"children":[{"type":"text","value":"Consider the ","key":"ypMqe4QW1b"},{"type":"abbreviation","title":"ordinary differential equation","children":[{"type":"text","value":"ODE","key":"cCXkfvTgOY"}],"key":"ISaLJ4b8dv"},{"type":"text","value":"s ","key":"tKut5UXcWq"},{"type":"inlineMath","value":"u'=u","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>u</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo>=</mo><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u&#x27;=u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span>","key":"QupjjAr6cF"},{"type":"text","value":" and ","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"key":"FkQfqkUKxr"},{"type":"inlineMath","value":"u'=-u","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>u</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo>=</mo><mo>−</mo><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u&#x27;=-u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord\">−</span><span class=\"mord mathnormal\">u</span></span></span></span>","key":"qQqZUdRd0O"},{"type":"text","value":". In each case we compute ","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"key":"AjEGc6J1RR"},{"type":"inlineMath","value":"\\partial f/\\partial u = \\pm 1","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">∂</mi><mi>f</mi><mi mathvariant=\"normal\">/</mi><mi mathvariant=\"normal\">∂</mi><mi>u</mi><mo>=</mo><mo>±</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">\\partial f/\\partial u = \\pm 1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mord\">/</span><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">u</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">±</span><span class=\"mord\">1</span></span></span></span>","key":"Fev3aKYUJP"},{"type":"text","value":", so the condition number bound from ","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"key":"Gwf2wkXesh"},{"type":"crossReference","kind":"proof:theorem","identifier":"theorem-depic","label":"theorem-depIC","children":[{"type":"text","value":"Theorem ","key":"iUSeIjw8eL"},{"type":"text","value":"6.1.2","key":"MhHqpLW5AO"}],"template":"Theorem %s","enumerator":"6.1.2","resolved":true,"html_id":"theorem-depic","remote":true,"url":"/basics","dataUrl":"/basics.json","key":"sS3isF5Px3"},{"type":"text","value":" is ","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"key":"YsxvpHnXBe"},{"type":"inlineMath","value":"e^{b-a}","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>e</mi><mrow><mi>b</mi><mo>−</mo><mi>a</mi></mrow></msup></mrow><annotation encoding=\"application/x-tex\">e^{b-a}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8491em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">b</span><span class=\"mbin mtight\">−</span><span class=\"mord mathnormal mtight\">a</span></span></span></span></span></span></span></span></span></span></span></span>","key":"xV3imr78yf"},{"type":"text","value":" in both problems. However, they behave quite differently. In the case of exponential growth, ","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"key":"Uc3Uw7qM0s"},{"type":"inlineMath","value":"u'=u","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>u</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo>=</mo><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u&#x27;=u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span>","key":"Npjxh4ErG0"},{"type":"text","value":", the bound is the actual condition number.","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"key":"PJ8n5Wcfl5"}],"key":"aT1nv7iq7Q"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"t = range(0, 3, length=800)\nu = @. exp(t) * 1\nlower, upper = @. exp(t) * 0.7, @. exp(t) * 1.3\nplot(t, u;\n    l=:black, ribbon=(lower, upper),\n    leg=:none,  xlabel=L\"t\",  ylabel=L\"u(t)\",\n    title=\"Exponential divergence of solutions\")","visibility":"remove","key":"pqcw24tdzr"},{"type":"output","id":"7wQo4E3c_V30BlnRsvIvY","data":[{"output_type":"execute_result","execution_count":10,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"3d190cabc0b0e1685544434ddba8644a","path":"/build/3d190cabc0b0e1685544434ddba8644a.png"},"text/html":{"content_type":"text/html","hash":"99444ce79554fda46649a7e5c6f22e4c","path":"/build/99444ce79554fda46649a7e5c6f22e4c.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"b84a8e7f52ce7c9bdfa618d14132d0a2","path":"/build/b84a8e7f52ce7c9bdfa618d14132d0a2.svg"}}}],"visibility":"show","key":"gFS8FbYASZ"}],"data":{"tags":[]},"visibility":"show","key":"AjYQ8cuAEF"},{"type":"paragraph","position":{"start":{"line":211,"column":1},"end":{"line":211,"column":1}},"children":[{"type":"text","value":"But with ","position":{"start":{"line":211,"column":1},"end":{"line":211,"column":1}},"key":"Yv9vPJTVxd"},{"type":"inlineMath","value":"u'=-u","position":{"start":{"line":211,"column":1},"end":{"line":211,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>u</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo>=</mo><mo>−</mo><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u&#x27;=-u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord\">−</span><span class=\"mord mathnormal\">u</span></span></span></span>","key":"tVEGVUyeAo"},{"type":"text","value":", solutions actually get closer together with time.","position":{"start":{"line":211,"column":1},"end":{"line":211,"column":1}},"key":"HqB0ipOubt"}],"key":"Uqz8vzzJtR"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"u = @. exp(-t) * 1\nlower, upper = @. exp(-t) * 0.7, @. exp(-t) * 1.3\nplot(t, u;\n    l=:black,  ribbon=(lower, upper),\n    leg=:none,  xlabel=L\"t\",  ylabel=L\"u(t)\",\n    title=\"Exponential convergence of solutions\")","visibility":"remove","key":"eHvOx0UIcA"},{"type":"output","id":"P5lIvNDhxKl4tYuBB3Hne","data":[{"output_type":"execute_result","execution_count":11,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"a186c208e5a5487c201a0bffc3aeebe2","path":"/build/a186c208e5a5487c201a0bffc3aeebe2.png"},"text/html":{"content_type":"text/html","hash":"cda7e67a3528fca7b0f10fa5363c71a9","path":"/build/cda7e67a3528fca7b0f10fa5363c71a9.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"e7cd0eea8d8cbd9f9393494535e4bc43","path":"/build/e7cd0eea8d8cbd9f9393494535e4bc43.svg"}}}],"visibility":"show","key":"NEXFCe4BNy"}],"data":{"tags":[]},"visibility":"show","key":"kNu5DMzcUc"},{"type":"paragraph","position":{"start":{"line":223,"column":1},"end":{"line":223,"column":1}},"children":[{"type":"text","value":"In this case the actual condition number is one, because the initial difference between solutions is the largest over all time. Hence the exponentially growing bound ","position":{"start":{"line":223,"column":1},"end":{"line":223,"column":1}},"key":"q0i7leUW4i"},{"type":"inlineMath","value":"e^{b-a}","position":{"start":{"line":223,"column":1},"end":{"line":223,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>e</mi><mrow><mi>b</mi><mo>−</mo><mi>a</mi></mrow></msup></mrow><annotation encoding=\"application/x-tex\">e^{b-a}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8491em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">b</span><span class=\"mbin mtight\">−</span><span class=\"mord mathnormal mtight\">a</span></span></span></span></span></span></span></span></span></span></span></span>","key":"O2o3e82zCu"},{"type":"text","value":" is a gross overestimate.","position":{"start":{"line":223,"column":1},"end":{"line":223,"column":1}},"key":"JpSHrhWLw8"}],"key":"h1UNEdUbba"}],"label":"demo-basics-cond-julia","identifier":"demo-basics-cond-julia","html_id":"demo-basics-cond-julia","key":"yLDW4b0Mkv"},{"type":"heading","depth":3,"position":{"start":{"line":226,"column":1},"end":{"line":226,"column":1}},"children":[{"type":"text","value":"6.2 ","position":{"start":{"line":226,"column":1},"end":{"line":226,"column":1}},"key":"wPhCwutAlH"},{"type":"link","identifier":"section-ivp-euler","label":"section-ivp-euler","kind":"narrative","position":{"start":{"line":226,"column":5},"end":{"line":226,"column":23}},"url":"/euler","internal":true,"dataUrl":"/euler.json","children":[{"type":"text","value":"Euler’s method","key":"FaCUsxaB91"}],"key":"k753uu6FUQ"}],"identifier":"id-6-2","label":"6.2 ","html_id":"id-6-2","implicit":true,"key":"ovzuFIHpMM"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-euler-converge","label":"demo-euler-converge","kind":"proof:example","position":{"start":{"line":229,"column":1},"end":{"line":229,"column":21}},"children":[{"type":"text","value":"Example ","key":"XI3LPAMmCU"},{"type":"text","value":"6.2.1","key":"bShArYAgh5"}],"template":"Example %s","enumerator":"6.2.1","resolved":true,"html_id":"demo-euler-converge","remote":true,"url":"/euler","dataUrl":"/euler.json","key":"q7h2H97VWh"}],"key":"Ddj7VkEMmP"},{"type":"paragraph","position":{"start":{"line":231,"column":1},"end":{"line":231,"column":1}},"children":[{"type":"text","value":"We consider the ","key":"aRqnm7MO5K"},{"type":"abbreviation","title":"initial-value problem","children":[{"type":"text","value":"IVP","key":"TMXFIdMXIg"}],"key":"Yt155iN0cH"},{"type":"text","value":" ","key":"dL7wijw80x"},{"type":"inlineMath","value":"u'=\\sin[(u+t)^2]","position":{"start":{"line":231,"column":1},"end":{"line":231,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>u</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo>=</mo><mi>sin</mi><mo>⁡</mo><mo stretchy=\"false\">[</mo><mo stretchy=\"false\">(</mo><mi>u</mi><mo>+</mo><mi>t</mi><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">u&#x27;=\\sin[(u+t)^2]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop\">sin</span><span class=\"mopen\">[(</span><span class=\"mord mathnormal\">u</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mclose\">]</span></span></span></span>","key":"bkVGb7CCmf"},{"type":"text","value":" over ","position":{"start":{"line":231,"column":1},"end":{"line":231,"column":1}},"key":"UKx9wgviWK"},{"type":"inlineMath","value":"0\\le t \\le 4","position":{"start":{"line":231,"column":1},"end":{"line":231,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0</mn><mo>≤</mo><mi>t</mi><mo>≤</mo><mn>4</mn></mrow><annotation encoding=\"application/x-tex\">0\\le t \\le 4</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7804em;vertical-align:-0.136em;\"></span><span class=\"mord\">0</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7719em;vertical-align:-0.136em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">4</span></span></span></span>","key":"ApPXdKCRNv"},{"type":"text","value":", with ","position":{"start":{"line":231,"column":1},"end":{"line":231,"column":1}},"key":"snQLk09x27"},{"type":"inlineMath","value":"u(0)=-1","position":{"start":{"line":231,"column":1},"end":{"line":231,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo stretchy=\"false\">(</mo><mn>0</mn><mo stretchy=\"false\">)</mo><mo>=</mo><mo>−</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">u(0)=-1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">−</span><span class=\"mord\">1</span></span></span></span>","key":"sWxL0FyIc4"},{"type":"text","value":".","position":{"start":{"line":231,"column":1},"end":{"line":231,"column":1}},"key":"upsLnAtTHd"}],"key":"OZWnXQTLt6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"using OrdinaryDiffEq\nf(u, p, t) = sin((t + u)^2);\ntspan = (0.0, 4.0);\nu0 = -1.0;\nivp = ODEProblem(f, u0, tspan)","key":"lFVZrmUNpT"},{"type":"output","id":"Bf7ZN8A262wr_-aKhmdF0","data":[{"output_type":"execute_result","execution_count":12,"metadata":{},"data":{"text/plain":{"content":"\u001b[38;2;86;182;194mODEProblem\u001b[0m with uType \u001b[38;2;86;182;194mFloat64\u001b[0m and tType \u001b[38;2;86;182;194mFloat64\u001b[0m. In-place: \u001b[38;2;86;182;194mfalse\u001b[0m\ntimespan: (0.0, 4.0)\nu0: -1.0","content_type":"text/plain"}}}],"key":"IpsUgEGAOy"}],"data":{},"key":"tsOkplSUtM"},{"type":"paragraph","position":{"start":{"line":241,"column":1},"end":{"line":241,"column":1}},"children":[{"type":"text","value":"Here is the call to ","position":{"start":{"line":241,"column":1},"end":{"line":241,"column":1}},"key":"XuzBMPNDGK"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-euler","label":"function-euler","children":[{"type":"text","value":"Function ","key":"yEgsgmJ5Xy"},{"type":"text","value":"6.2.2","key":"miS3BDLGnZ"}],"template":"Algorithm %s","enumerator":"6.2.2","resolved":true,"html_id":"function-euler","remote":true,"url":"/euler","dataUrl":"/euler.json","key":"TOOuvdiO6S"},{"type":"text","value":".","position":{"start":{"line":241,"column":1},"end":{"line":241,"column":1}},"key":"niStYxf3II"}],"key":"KrvBVFO27U"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"using Plots\nt, u = FNC.euler(ivp, 20)\nplot(t, u;\n    m=2,  label=\"n=20\", \n    xlabel=L\"t\",  ylabel=L\"u(t)\",\n    title=\"Solution by Euler's method\")","key":"GOdpM94dxn"},{"type":"output","id":"TeYQCkEF8avg4dxdgJpYL","data":[{"output_type":"execute_result","execution_count":13,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"19d57bb88bdf9820acf701191a375e41","path":"/build/19d57bb88bdf9820acf701191a375e41.png"},"text/html":{"content_type":"text/html","hash":"dfbf8c668e18323933fa126a3c4239e2","path":"/build/dfbf8c668e18323933fa126a3c4239e2.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"86a77cb2a494f9796448fa40bb190a99","path":"/build/86a77cb2a494f9796448fa40bb190a99.svg"}}}],"key":"JWjfnIRlCk"}],"data":{},"key":"RqTxJD5I29"},{"type":"paragraph","position":{"start":{"line":252,"column":1},"end":{"line":252,"column":1}},"children":[{"type":"text","value":"We could define a different interpolant to get a smoother picture above, but the derivation of Euler’s method assumed a piecewise linear interpolant. We can instead request more steps to make the interpolant look smoother.","position":{"start":{"line":252,"column":1},"end":{"line":252,"column":1}},"key":"nRPWTkCh0x"}],"key":"rZDzJp3bg8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"t, u = FNC.euler(ivp, 50)\nplot!(t, u, m=2, label=\"n=50\")","key":"vAfXXWD7w0"},{"type":"output","id":"-QKU1vBRgNy4-EVRlS-UY","data":[{"output_type":"execute_result","execution_count":14,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"fd436d5573949ff23fba44a3b64b90aa","path":"/build/fd436d5573949ff23fba44a3b64b90aa.png"},"text/html":{"content_type":"text/html","hash":"181020c582aaa325d6b6fa09fcb19a90","path":"/build/181020c582aaa325d6b6fa09fcb19a90.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"5552cea2055896bd4e3fd4769d726f1c","path":"/build/5552cea2055896bd4e3fd4769d726f1c.svg"}}}],"key":"XFWg7Zwksm"}],"data":{},"key":"C5YMnbPHT4"},{"type":"paragraph","position":{"start":{"line":259,"column":1},"end":{"line":259,"column":1}},"children":[{"type":"text","value":"Increasing ","position":{"start":{"line":259,"column":1},"end":{"line":259,"column":1}},"key":"evVBhVktWA"},{"type":"inlineMath","value":"n","position":{"start":{"line":259,"column":1},"end":{"line":259,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"CFJMcDjQhL"},{"type":"text","value":" changed the solution noticeably. Since we know that interpolants and finite differences become more accurate as ","position":{"start":{"line":259,"column":1},"end":{"line":259,"column":1}},"key":"jxyWMtVTbp"},{"type":"inlineMath","value":"h\\to 0","position":{"start":{"line":259,"column":1},"end":{"line":259,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>h</mi><mo>→</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">h\\to 0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">h</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"jsqdHYTWew"},{"type":"text","value":", we should anticipate the same behavior from Euler’s method. We don’t have an exact solution to compare to, so we will use a ","position":{"start":{"line":259,"column":1},"end":{"line":259,"column":1}},"key":"LnmUbFMRtY"},{"type":"inlineCode","value":"DifferentialEquations","position":{"start":{"line":259,"column":1},"end":{"line":259,"column":1}},"key":"DE7Ho5Fx8b"},{"type":"text","value":" solver to construct an accurate reference solution.","position":{"start":{"line":259,"column":1},"end":{"line":259,"column":1}},"key":"Kb3wPqxXj0"}],"key":"chzLb6PzPS"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"u_exact = solve(ivp, Tsit5(), reltol=1e-14, abstol=1e-14)\nplot!(u_exact, l=(2, :black), label=\"reference\")","key":"HkdroTJcCp"},{"type":"output","id":"fvxWTkW5JdNVIJB4_t41i","data":[{"output_type":"execute_result","execution_count":15,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"ae6edd271be1369086b2f56b34e11239","path":"/build/ae6edd271be1369086b2f56b34e11239.png"},"text/html":{"content_type":"text/html","hash":"6db2d5feaf4fd66433452e775fc96992","path":"/build/6db2d5feaf4fd66433452e775fc96992.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"306dfdaf729374bcdb4ec6034891a9cf","path":"/build/306dfdaf729374bcdb4ec6034891a9cf.svg"}}}],"key":"QYTocEXnzR"}],"data":{},"key":"QmquPNZjd3"},{"type":"paragraph","position":{"start":{"line":266,"column":1},"end":{"line":266,"column":1}},"children":[{"type":"text","value":"Now we can perform a convergence study.","position":{"start":{"line":266,"column":1},"end":{"line":266,"column":1}},"key":"QxHYJboiUu"}],"key":"HZDrMGrqJ6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"n = [round(Int, 5 * 10^k) for k in 0:0.5:3]\nerr = []\nfor n in n\n    t, u = FNC.euler(ivp, n)\n    push!(err, norm(u_exact.(t) - u, Inf))\nend\n@pt :header=[\"n\", \"inf-norm error\"] [n err]","key":"FkhHGc5JiD"},{"type":"output","id":"y06jUQEycX54ZUAF_XW5C","data":[{"output_type":"display_data","metadata":{},"data":{"text/html":{"content":"<table>\n  <thead>\n    <tr class = \"header headerLastRow\">\n      <th style = \"text-align: right;\">n</th>\n      <th style = \"text-align: right;\">inf-norm error</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td style = \"text-align: right;\">5</td>\n      <td style = \"text-align: right;\">2.7342</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">16</td>\n      <td style = \"text-align: right;\">0.107594</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">50</td>\n      <td style = \"text-align: right;\">0.0299962</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">158</td>\n      <td style = \"text-align: right;\">0.00885025</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">500</td>\n      <td style = \"text-align: right;\">0.00273659</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">1581</td>\n      <td style = \"text-align: right;\">0.000859654</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">5000</td>\n      <td style = \"text-align: right;\">0.000271243</td>\n    </tr>\n  </tbody>\n</table>\n","content_type":"text/html"}}}],"key":"mzZWqMcVaz"}],"data":{},"key":"GQxmv0bgD1"},{"type":"paragraph","position":{"start":{"line":278,"column":1},"end":{"line":278,"column":1}},"children":[{"type":"text","value":"The error is approximately cut by a factor of 10 for each increase in ","position":{"start":{"line":278,"column":1},"end":{"line":278,"column":1}},"key":"drvvhkd34t"},{"type":"inlineMath","value":"n","position":{"start":{"line":278,"column":1},"end":{"line":278,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"HswiJeX7gj"},{"type":"text","value":" by the same factor. A log-log plot also confirms first-order convergence. Keep in mind that since ","position":{"start":{"line":278,"column":1},"end":{"line":278,"column":1}},"key":"CZPXXXHv9L"},{"type":"inlineMath","value":"h=(b-a)/n","position":{"start":{"line":278,"column":1},"end":{"line":278,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>h</mi><mo>=</mo><mo stretchy=\"false\">(</mo><mi>b</mi><mo>−</mo><mi>a</mi><mo stretchy=\"false\">)</mo><mi mathvariant=\"normal\">/</mi><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">h=(b-a)/n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">h</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">b</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mclose\">)</span><span class=\"mord\">/</span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"LTaLASLBz5"},{"type":"text","value":", it follows that ","position":{"start":{"line":278,"column":1},"end":{"line":278,"column":1}},"key":"GS7VbZws0x"},{"type":"inlineMath","value":"O(h)=O(n^{-1})","position":{"start":{"line":278,"column":1},"end":{"line":278,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>h</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>O</mi><mo stretchy=\"false\">(</mo><msup><mi>n</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(h)=O(n^{-1})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">h</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">n</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"Ynf8uE3J13"},{"type":"text","value":".","position":{"start":{"line":278,"column":1},"end":{"line":278,"column":1}},"key":"GtjNsptP7J"}],"key":"CyIJAvgqWg"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"plot(n, err;\n    m=:o, label=\"results\",\n    xaxis=(:log10, L\"n\"),  yaxis=(:log10, \"inf-norm global error\"),\n    title=\"Convergence of Euler's method\")\n\n# Add line for perfect 1st order.\nplot!(n, 0.5 * err[end] * (n / n[end]) .^ (-1), l=:dash, label=L\"O(n^{-1})\")","key":"kmZ1av0FP4"},{"type":"output","id":"0f_PihYpmhLkmB9aGD-MU","data":[{"output_type":"execute_result","execution_count":17,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"831770c47c180b7b696aeac095422ddb","path":"/build/831770c47c180b7b696aeac095422ddb.png"},"text/html":{"content_type":"text/html","hash":"046e1c67b9ff9789f477856ff32bb4e2","path":"/build/046e1c67b9ff9789f477856ff32bb4e2.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"7b92cb08ffc746899efd9acc08f170fa","path":"/build/7b92cb08ffc746899efd9acc08f170fa.svg"}}}],"key":"h2aEJ2VVe7"}],"data":{},"key":"CBgtzZNX7X"}],"label":"demo-euler-converge-julia","identifier":"demo-euler-converge-julia","html_id":"demo-euler-converge-julia","key":"wmh7xbXBIs"},{"type":"heading","depth":3,"position":{"start":{"line":291,"column":1},"end":{"line":291,"column":1}},"children":[{"type":"text","value":"6.3 ","position":{"start":{"line":291,"column":1},"end":{"line":291,"column":1}},"key":"GlfdcWYLk8"},{"type":"link","identifier":"section-ivp-systems","label":"section-ivp-systems","kind":"narrative","position":{"start":{"line":291,"column":5},"end":{"line":291,"column":25}},"url":"/systems","internal":true,"dataUrl":"/systems.json","children":[{"type":"text","value":"IVP systems","key":"e4WCXbiPnH"}],"key":"fOKZdiMYv2"}],"identifier":"id-6-3","label":"6.3 ","html_id":"id-6-3","implicit":true,"key":"yrxGTG29av"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-systems-predator","label":"demo-systems-predator","kind":"proof:example","position":{"start":{"line":294,"column":1},"end":{"line":294,"column":23}},"children":[{"type":"text","value":"Example ","key":"FnG1eJC22b"},{"type":"text","value":"6.3.2","key":"TgBnO4GAeb"}],"template":"Example %s","enumerator":"6.3.2","resolved":true,"html_id":"demo-systems-predator","remote":true,"url":"/systems","dataUrl":"/systems.json","key":"bxh7JaGxyp"}],"key":"jT9VlH1uNh"},{"type":"paragraph","position":{"start":{"line":296,"column":1},"end":{"line":296,"column":1}},"children":[{"type":"text","value":"We encode the predator–prey equations via a function.","position":{"start":{"line":296,"column":1},"end":{"line":296,"column":1}},"key":"kmbapTNGq9"}],"key":"t4UEUg6kcQ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"function predprey(u, p, t)\n    α, β = p      # rename parameters for convenience\n    y, z = u      # rename solution components\n    s = (y * z) / (1 + β * y)     # appears in both equations\n    return [y * (1 - α * y) - s, -z + s]\nend;","key":"qt7qF14RW8"},{"type":"output","id":"m__GZdmkaUCaIgPU-HsUu","data":[],"key":"rc8dLRq70E"}],"data":{},"key":"Vxj37LxVXw"},{"type":"paragraph","position":{"start":{"line":307,"column":1},"end":{"line":307,"column":1}},"children":[{"type":"text","value":"As before, the ","key":"VUvecSlWfN"},{"type":"abbreviation","title":"ordinary differential equation","children":[{"type":"text","value":"ODE","key":"HWOYgCv1W3"}],"key":"lgvisDjqkB"},{"type":"text","value":" function must accept three inputs, ","key":"zT0M3zplCn"},{"type":"inlineCode","value":"u","position":{"start":{"line":307,"column":1},"end":{"line":307,"column":1}},"key":"Xx2K4T71Jx"},{"type":"text","value":", ","position":{"start":{"line":307,"column":1},"end":{"line":307,"column":1}},"key":"M3uB2fuL6t"},{"type":"inlineCode","value":"p","position":{"start":{"line":307,"column":1},"end":{"line":307,"column":1}},"key":"qEs8GqdSZ1"},{"type":"text","value":", and ","position":{"start":{"line":307,"column":1},"end":{"line":307,"column":1}},"key":"tYjHPZU52G"},{"type":"inlineCode","value":"t","position":{"start":{"line":307,"column":1},"end":{"line":307,"column":1}},"key":"dEmUArdq7F"},{"type":"text","value":", even though in this case there is no explicit dependence on ","position":{"start":{"line":307,"column":1},"end":{"line":307,"column":1}},"key":"jvSfnGJQIp"},{"type":"inlineCode","value":"t","position":{"start":{"line":307,"column":1},"end":{"line":307,"column":1}},"key":"KItlnhGeFM"},{"type":"text","value":". The second input is used to pass parameters that don’t change throughout a single instance of the problem.","position":{"start":{"line":307,"column":1},"end":{"line":307,"column":1}},"key":"F7vufxYusS"}],"key":"JjUIZn7h6O"},{"type":"paragraph","position":{"start":{"line":309,"column":1},"end":{"line":309,"column":1}},"children":[{"type":"text","value":"To specify the ","key":"VXrXkVUEf6"},{"type":"abbreviation","title":"initial-value problem","children":[{"type":"text","value":"IVP","key":"OkZbgwIeZI"}],"key":"H8ifVhCpZq"},{"type":"text","value":" we must also provide the initial condition, which is a 2-vector here, and the interval for the independent variable.","key":"YxVtQQU9i5"}],"key":"f7AfDosJpF"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"using OrdinaryDiffEq\nu₀ = [1, 0.01]\ntspan = (0.0, 60.0)\nα, β = 0.1, 0.25\nivp = ODEProblem(predprey, u₀, tspan, [α, β])","key":"U4QomPXvIB"},{"type":"output","id":"5R57leVzDm7rBj2du7-zS","data":[{"output_type":"execute_result","execution_count":19,"metadata":{},"data":{"text/plain":{"content":"\u001b[38;2;86;182;194mODEProblem\u001b[0m with uType \u001b[38;2;86;182;194mVector{Float64}\u001b[0m and tType \u001b[38;2;86;182;194mFloat64\u001b[0m. In-place: \u001b[38;2;86;182;194mfalse\u001b[0m\ntimespan: (0.0, 60.0)\nu0: 2-element Vector{Float64}:\n 1.0\n 0.01","content_type":"text/plain"}}}],"key":"lQ3jUim20i"}],"data":{},"key":"U9pULs02iJ"},{"type":"paragraph","position":{"start":{"line":319,"column":1},"end":{"line":319,"column":1}},"children":[{"type":"text","value":"You can use any ","position":{"start":{"line":319,"column":1},"end":{"line":319,"column":1}},"key":"c3xAl907ny"},{"type":"inlineCode","value":"DifferentialEquations","position":{"start":{"line":319,"column":1},"end":{"line":319,"column":1}},"key":"WTLctWO1dn"},{"type":"text","value":" solver on the ","key":"ZSgr04gzS2"},{"type":"abbreviation","title":"initial-value problem","children":[{"type":"text","value":"IVP","key":"UNjVOirqXE"}],"key":"ta8aT8KPwq"},{"type":"text","value":" system.","key":"hpgRgEAXbR"}],"key":"oe3QIrltFa"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"using Plots\nsol = solve(ivp, Tsit5());\nplot(sol, label=[\"prey\" \"predator\"],\n    title=\"Predator-prey solution\")","key":"lFIqolYlO1"},{"type":"output","id":"R7uH0ySDFhBccsvqmOZIE","data":[{"output_type":"execute_result","execution_count":20,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"c20d139de7db8f0267c34a6e01cd176a","path":"/build/c20d139de7db8f0267c34a6e01cd176a.png"},"text/html":{"content_type":"text/html","hash":"cdfb197e01418e31844f5634710ff312","path":"/build/cdfb197e01418e31844f5634710ff312.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"eaa7cbca0f5d70d06fc94396ea219efd","path":"/build/eaa7cbca0f5d70d06fc94396ea219efd.svg"}}}],"key":"ueA6EQUzSy"}],"data":{},"key":"VlL3Syrhvl"},{"type":"paragraph","position":{"start":{"line":328,"column":1},"end":{"line":328,"column":1}},"children":[{"type":"text","value":"We can find the discrete values used to compute the interpolated solution. The ","position":{"start":{"line":328,"column":1},"end":{"line":328,"column":1}},"key":"vTAk6Hshqb"},{"type":"inlineCode","value":"sol.u","position":{"start":{"line":328,"column":1},"end":{"line":328,"column":1}},"key":"gXKt2zAuWa"},{"type":"text","value":" value is a vector of vectors.","position":{"start":{"line":328,"column":1},"end":{"line":328,"column":1}},"key":"L0nv73YVpx"}],"key":"eKc60UvDtv"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"t, u = sol.t, sol.u    # extract times and solution values\n@show size(u);\n@show t[20];\n@show u[20];","key":"r4nIy5ievu"},{"type":"output","id":"_YqfD3h6wMjoaXANmw49o","data":[{"output_type":"stream","name":"stdout","text":"size(u) = (100,)"},{"output_type":"stream","name":"stdout","text":"\nt[20] = 8.386698083051241\nu[20] = [0.027739191695661334, 0.699418322938034]\n"}],"key":"a681EPDQfW"}],"data":{},"key":"KxVVqOkdsk"},{"type":"paragraph","position":{"start":{"line":337,"column":1},"end":{"line":337,"column":1}},"children":[{"type":"text","value":"We can also use ","position":{"start":{"line":337,"column":1},"end":{"line":337,"column":1}},"key":"ZsuAjFzgtA"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-euler","label":"function-euler","children":[{"type":"text","value":"Function ","key":"gkTJnrjcsK"},{"type":"text","value":"6.2.2","key":"pDbIUYb7sy"}],"template":"Algorithm %s","enumerator":"6.2.2","resolved":true,"html_id":"function-euler","remote":true,"url":"/euler","dataUrl":"/euler.json","key":"dYoCn05m9E"},{"type":"text","value":" to find the solution.","position":{"start":{"line":337,"column":1},"end":{"line":337,"column":1}},"key":"zveeqBhRON"}],"key":"bzTstDQKEg"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"t, u = FNC.euler(ivp, 1200);","key":"Gt18yo8L1n"},{"type":"output","id":"sJeh1FApcWyhlhXTO3Go7","data":[],"key":"TNI5bjWUCQ"}],"data":{},"key":"Kt5MIddPmc"},{"type":"paragraph","position":{"start":{"line":343,"column":1},"end":{"line":343,"column":1}},"children":[{"type":"text","value":"The solution ","position":{"start":{"line":343,"column":1},"end":{"line":343,"column":1}},"key":"bYtpz4oNx6"},{"type":"inlineCode","value":"u","position":{"start":{"line":343,"column":1},"end":{"line":343,"column":1}},"key":"KWrLN91nk2"},{"type":"text","value":" is a vector of [prey,predator] 2-vectors for each of the discrete times in ","position":{"start":{"line":343,"column":1},"end":{"line":343,"column":1}},"key":"WAAl4hOlMU"},{"type":"inlineCode","value":"t","position":{"start":{"line":343,"column":1},"end":{"line":343,"column":1}},"key":"YdiNriVHNf"},{"type":"text","value":". Manipulating the vector-of-vectors output can be a little tricky. Here, we convert it to an ","position":{"start":{"line":343,"column":1},"end":{"line":343,"column":1}},"key":"mV4epXvFb9"},{"type":"inlineMath","value":"n\\times 2","position":{"start":{"line":343,"column":1},"end":{"line":343,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>×</mo><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">n\\times 2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span></span></span></span>","key":"m6XvDJs1HB"},{"type":"text","value":" matrix. Each column is one component, while each row is a single value of ","position":{"start":{"line":343,"column":1},"end":{"line":343,"column":1}},"key":"dBLxzWl7UY"},{"type":"inlineMath","value":"t","position":{"start":{"line":343,"column":1},"end":{"line":343,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span></span></span></span>","key":"B8Yf66KaRa"},{"type":"text","value":".","position":{"start":{"line":343,"column":1},"end":{"line":343,"column":1}},"key":"UPA92RDIve"}],"key":"ewITXlgKgu"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"u = [u[j] for u in u, j in 1:2]\nplot!(t[1:3:end], u[1:3:end, :];\n    l=(1, :black),  m=2,\n    label=[\"Euler prey\" \"Euler predator\"])","key":"uxC80stwck"},{"type":"output","id":"sabkAQlsHLBtfcBcANyY2","data":[{"output_type":"execute_result","execution_count":23,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"0c08aeb8ae9351d455099a7f18318980","path":"/build/0c08aeb8ae9351d455099a7f18318980.png"},"text/html":{"content_type":"text/html","hash":"9db47f431a78c7a3cf437b89df77fab1","path":"/build/9db47f431a78c7a3cf437b89df77fab1.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"7e90c3bc52a9361f8212a6d9cf06ac55","path":"/build/7e90c3bc52a9361f8212a6d9cf06ac55.svg"}}}],"key":"XGY9WkmYr9"}],"data":{},"key":"OatGJyz2pt"},{"type":"paragraph","position":{"start":{"line":352,"column":1},"end":{"line":352,"column":1}},"children":[{"type":"text","value":"Notice above that the accuracy of the Euler solution deteriorates rapidly.","position":{"start":{"line":352,"column":1},"end":{"line":352,"column":1}},"key":"W2qzhp3sJg"}],"key":"kZHLQIQSsA"},{"type":"paragraph","position":{"start":{"line":354,"column":1},"end":{"line":354,"column":1}},"children":[{"type":"text","value":"When there are just two components, it’s common to plot the solution in the ","position":{"start":{"line":354,"column":1},"end":{"line":354,"column":1}},"key":"M9qqAe9bj5"},{"type":"emphasis","position":{"start":{"line":354,"column":1},"end":{"line":354,"column":1}},"children":[{"type":"text","value":"phase plane","position":{"start":{"line":354,"column":1},"end":{"line":354,"column":1}},"key":"BeqHaOKzht"}],"key":"zTS8fzuUk2"},{"type":"text","value":", i.e., with ","position":{"start":{"line":354,"column":1},"end":{"line":354,"column":1}},"key":"O3Nr9D1QSF"},{"type":"inlineMath","value":"u_1","position":{"start":{"line":354,"column":1},"end":{"line":354,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>u</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">u_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"VdVcB6X4AV"},{"type":"text","value":" and ","position":{"start":{"line":354,"column":1},"end":{"line":354,"column":1}},"key":"LIHmkzEiZX"},{"type":"inlineMath","value":"u_2","position":{"start":{"line":354,"column":1},"end":{"line":354,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>u</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">u_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"B4ifUBmnHN"},{"type":"text","value":" along the axes and time as a parameterization of the curve.","position":{"start":{"line":354,"column":1},"end":{"line":354,"column":1}},"key":"zq2dmyPNSD"}],"key":"lF2q4VGUR2"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"Jx1tgRyLxw"}],"key":"A75ari825w"},{"type":"paragraph","position":{"start":{"line":357,"column":1},"end":{"line":357,"column":1}},"children":[{"type":"text","value":"You can use ","position":{"start":{"line":357,"column":1},"end":{"line":357,"column":1}},"key":"DHnFJZMbt8"},{"type":"inlineCode","value":"idxs","position":{"start":{"line":357,"column":1},"end":{"line":357,"column":1}},"key":"UO5SGbFQ1f"},{"type":"text","value":" in the plot of a solution produced by ","position":{"start":{"line":357,"column":1},"end":{"line":357,"column":1}},"key":"QpBwEpuTzz"},{"type":"inlineCode","value":"solve","position":{"start":{"line":357,"column":1},"end":{"line":357,"column":1}},"key":"tb368aW4oC"},{"type":"text","value":" to specify the components of the solution that appear on each axis.","position":{"start":{"line":357,"column":1},"end":{"line":357,"column":1}},"key":"KzJQNgohfm"}],"key":"HRUFZZmEWC"}],"class":"dropdown","key":"Z5AWBBJdcO"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"plot(sol, idxs=(1, 2),\n    title=\"Predator-prey in the phase plane\",\n    xlabel=L\"y\",  ylabel=L\"z\")","key":"xYYl5a0Crw"},{"type":"output","id":"aCwBk3ttmWt1rSzuEiuK1","data":[{"output_type":"execute_result","execution_count":24,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"9f759107870311a6d62b6a53302231c4","path":"/build/9f759107870311a6d62b6a53302231c4.png"},"text/html":{"content_type":"text/html","hash":"6026b2b8c4d0aeacc07fc28cd3bf6154","path":"/build/6026b2b8c4d0aeacc07fc28cd3bf6154.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"d3108c806da5e527385bbe8f3c90ddfb","path":"/build/d3108c806da5e527385bbe8f3c90ddfb.svg"}}}],"key":"e0PiMRCFH5"}],"data":{},"key":"tsURelVSHi"},{"type":"paragraph","position":{"start":{"line":366,"column":1},"end":{"line":366,"column":1}},"children":[{"type":"text","value":"From this plot we can deduce that the solution approaches a periodic one, which in the phase plane is represented by a closed loop.","position":{"start":{"line":366,"column":1},"end":{"line":366,"column":1}},"key":"ibJ9JwG7ZX"}],"key":"zdyzWZwSN1"}],"label":"demo-systems-predator-julia","identifier":"demo-systems-predator-julia","html_id":"demo-systems-predator-julia","key":"hGKaNGBPF6"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-systems-coupledpendula","label":"demo-systems-coupledpendula","kind":"proof:example","position":{"start":{"line":370,"column":1},"end":{"line":370,"column":29}},"children":[{"type":"text","value":"Example ","key":"P3JefQgSMm"},{"type":"text","value":"6.3.5","key":"GI5OQ1BHHK"}],"template":"Example %s","enumerator":"6.3.5","resolved":true,"html_id":"demo-systems-coupledpendula","remote":true,"url":"/systems","dataUrl":"/systems.json","key":"XwyFVVsM1S"}],"key":"BiwQXyacak"},{"type":"paragraph","position":{"start":{"line":372,"column":1},"end":{"line":372,"column":1}},"children":[{"type":"text","value":"Let’s implement the coupled pendulums from ","position":{"start":{"line":372,"column":1},"end":{"line":372,"column":1}},"key":"F2Oas5LFZJ"},{"type":"crossReference","kind":"proof:example","identifier":"example-systems-coupledpendula","label":"example-systems-coupledpendula","children":[{"type":"text","value":"Example ","key":"CU8hOWqIE2"},{"type":"text","value":"6.3.4","key":"Kt7zeiCxQC"}],"template":"Example %s","enumerator":"6.3.4","resolved":true,"html_id":"example-systems-coupledpendula","remote":true,"url":"/systems","dataUrl":"/systems.json","key":"POGiOfLIyp"},{"type":"text","value":". The pendulums will be pulled in opposite directions and then released together from rest.","position":{"start":{"line":372,"column":1},"end":{"line":372,"column":1}},"key":"OVDZQGE8Wx"}],"key":"GJw7oHUSQY"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"KmlyOsa1qk"}],"key":"BSsFQ9CfKW"},{"type":"paragraph","position":{"start":{"line":375,"column":1},"end":{"line":375,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":375,"column":1},"end":{"line":375,"column":1}},"key":"TAWpxdR56N"},{"type":"inlineCode","value":"similar","position":{"start":{"line":375,"column":1},"end":{"line":375,"column":1}},"key":"DmiwWefPX0"},{"type":"text","value":" function creates an array of the same size and type as a given value, without initializing the contents.","position":{"start":{"line":375,"column":1},"end":{"line":375,"column":1}},"key":"iVNafw9qci"}],"key":"XuWqcFWowc"}],"class":"dropdown","key":"GoC4CMpwpa"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"function couple(u, p, t)\n    γ, L, k = p\n    g = 9.8\n    udot = similar(u)\n    udot[1:2] .= u[3:4]\n    udot[3] = -γ * u[3] - (g / L) * sin(u[1]) + k * (u[2] - u[1])\n    udot[4] = -γ * u[4] - (g / L) * sin(u[2]) + k * (u[1] - u[2])\n    return udot\nend\n\nu₀ = [1.25, -0.5, 0, 0]\ntspan = (0.0, 50.0);","key":"qJhUNiuRme"},{"type":"output","id":"Desy9CSiEK95D76k4Mrzh","data":[],"key":"hmOZhBROd1"}],"data":{},"key":"ARYM30CL6n"},{"type":"paragraph","position":{"start":{"line":393,"column":1},"end":{"line":393,"column":1}},"children":[{"type":"text","value":"First we check the behavior of the system when the pendulums are uncoupled, i.e., when ","position":{"start":{"line":393,"column":1},"end":{"line":393,"column":1}},"key":"TZYhGvapeS"},{"type":"inlineMath","value":"k=0","position":{"start":{"line":393,"column":1},"end":{"line":393,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">k=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"Entpl9SzP6"},{"type":"text","value":".","position":{"start":{"line":393,"column":1},"end":{"line":393,"column":1}},"key":"i2rTtg45H2"}],"key":"CXWxsD9rZX"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"OziD494b0K"}],"key":"t7LRZMywDy"},{"type":"paragraph","position":{"start":{"line":396,"column":1},"end":{"line":396,"column":1}},"children":[{"type":"text","value":"Here ","position":{"start":{"line":396,"column":1},"end":{"line":396,"column":1}},"key":"glICnfzG0A"},{"type":"inlineCode","value":"idxs","position":{"start":{"line":396,"column":1},"end":{"line":396,"column":1}},"key":"jSiOCTgynm"},{"type":"text","value":" is used to plot two components as functions of time.","position":{"start":{"line":396,"column":1},"end":{"line":396,"column":1}},"key":"TnKoTX3Gaw"}],"key":"tDJtmrY7wI"}],"class":"dropdown","key":"C0rBzxCVwL"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"γ, L, k = 0, 0.5, 0\nivp = ODEProblem(couple, u₀, tspan, [γ, L, k])\nsol = solve(ivp, Tsit5())\nplot(sol, idxs=[1, 2], \n    label=[L\"\\theta_1\" L\"\\theta_2\"],\n    xlims=[20, 50], \n    title=\"Uncoupled pendulums\")","key":"EEl39DlPh5"},{"type":"output","id":"eNQEHwFfpreIHY7QClSdK","data":[{"output_type":"execute_result","execution_count":26,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"94cfe8381bb3d4b0bb277c1c444b43c4","path":"/build/94cfe8381bb3d4b0bb277c1c444b43c4.png"},"text/html":{"content_type":"text/html","hash":"d8a53fb00663a9acea7694e650b14982","path":"/build/d8a53fb00663a9acea7694e650b14982.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"32911756a599495cdcecdd5d6563d146","path":"/build/32911756a599495cdcecdd5d6563d146.svg"}}}],"key":"Jud0eHtOwV"}],"data":{},"key":"wVf7MepNeq"},{"type":"paragraph","position":{"start":{"line":409,"column":1},"end":{"line":409,"column":1}},"children":[{"type":"text","value":"You can see that the pendulums swing independently. Because the model is nonlinear and the initial angles are not small, they have slightly different periods of oscillation, and they go in and out of phase.","position":{"start":{"line":409,"column":1},"end":{"line":409,"column":1}},"key":"azqUiWWiNm"}],"key":"sKL1KtL7Po"},{"type":"paragraph","position":{"start":{"line":411,"column":1},"end":{"line":411,"column":1}},"children":[{"type":"text","value":"With coupling activated, a different behavior is seen.","position":{"start":{"line":411,"column":1},"end":{"line":411,"column":1}},"key":"lpwpOUP7zl"}],"key":"MCp6WIPJVs"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"k = 1\nivp = ODEProblem(couple, u₀, tspan, [γ, L, k])\nsol = solve(ivp, Tsit5())\nplot(sol, idxs=[1, 2], \n    label=[L\"\\theta_1\" L\"\\theta_2\"],\n    xlims=[20, 50], \n    title=\"Coupled pendulums\")","key":"vgYXh5a19J"},{"type":"output","id":"TkXa280oKpJcqK0ekleLR","data":[{"output_type":"execute_result","execution_count":27,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"16056e7e5cd15352f27dd1edac5311f7","path":"/build/16056e7e5cd15352f27dd1edac5311f7.png"},"text/html":{"content_type":"text/html","hash":"facf39990acd8295559e9515ad3a04b8","path":"/build/facf39990acd8295559e9515ad3a04b8.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"2887384d380dc6b4ae8cfb465498cd9f","path":"/build/2887384d380dc6b4ae8cfb465498cd9f.svg"}}}],"key":"LEP6oxjoLP"}],"data":{},"key":"f6CTGVyGYm"},{"type":"paragraph","position":{"start":{"line":423,"column":1},"end":{"line":423,"column":1}},"children":[{"type":"text","value":"The coupling makes the pendulums swap energy back and forth.","position":{"start":{"line":423,"column":1},"end":{"line":423,"column":1}},"key":"WxUczvhYZT"}],"key":"NmBbU6Q7wR"}],"label":"demo-systems-coupledpendula-julia","identifier":"demo-systems-coupledpendula-julia","html_id":"demo-systems-coupledpendula-julia","key":"PJfCP8i0Fr"},{"type":"heading","depth":3,"position":{"start":{"line":426,"column":1},"end":{"line":426,"column":1}},"children":[{"type":"text","value":"6.4 ","position":{"start":{"line":426,"column":1},"end":{"line":426,"column":1}},"key":"t5mEF4AaZX"},{"type":"link","identifier":"section-ivp-rk","label":"section-ivp-rk","kind":"narrative","position":{"start":{"line":426,"column":5},"end":{"line":426,"column":20}},"url":"/rk","internal":true,"dataUrl":"/rk.json","children":[{"type":"text","value":"Runge–Kutta methods","key":"bYMPiiSLyC"}],"key":"FzpZFGF382"}],"identifier":"id-6-4","label":"6.4 ","html_id":"id-6-4","implicit":true,"key":"i1O5TNMco8"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-rk-converge","label":"demo-rk-converge","kind":"proof:example","position":{"start":{"line":429,"column":1},"end":{"line":429,"column":18}},"children":[{"type":"text","value":"Example ","key":"hGVqAy6Zlx"},{"type":"text","value":"6.4.1","key":"LUID2A7xq5"}],"template":"Example %s","enumerator":"6.4.1","resolved":true,"html_id":"demo-rk-converge","remote":true,"url":"/rk","dataUrl":"/rk.json","key":"HlCci3AWqi"}],"key":"OIIh75jh3m"},{"type":"paragraph","position":{"start":{"line":431,"column":1},"end":{"line":431,"column":1}},"children":[{"type":"text","value":"We solve the ","key":"eljCyWTul9"},{"type":"abbreviation","title":"initial-value problem","children":[{"type":"text","value":"IVP","key":"ZOvZ9h3qNh"}],"key":"g4BP46ruht"},{"type":"text","value":" ","key":"AUI24XcnfU"},{"type":"inlineMath","value":"u'=\\sin[(u+t)^2]","position":{"start":{"line":431,"column":1},"end":{"line":431,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>u</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo>=</mo><mi>sin</mi><mo>⁡</mo><mo stretchy=\"false\">[</mo><mo stretchy=\"false\">(</mo><mi>u</mi><mo>+</mo><mi>t</mi><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">u&#x27;=\\sin[(u+t)^2]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop\">sin</span><span class=\"mopen\">[(</span><span class=\"mord mathnormal\">u</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mclose\">]</span></span></span></span>","key":"aCJkHMvhrr"},{"type":"text","value":" over ","position":{"start":{"line":431,"column":1},"end":{"line":431,"column":1}},"key":"NoI0wUn7TB"},{"type":"inlineMath","value":"0\\le t \\le 4","position":{"start":{"line":431,"column":1},"end":{"line":431,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0</mn><mo>≤</mo><mi>t</mi><mo>≤</mo><mn>4</mn></mrow><annotation encoding=\"application/x-tex\">0\\le t \\le 4</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7804em;vertical-align:-0.136em;\"></span><span class=\"mord\">0</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7719em;vertical-align:-0.136em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">4</span></span></span></span>","key":"RIJ88JnmpQ"},{"type":"text","value":", with ","position":{"start":{"line":431,"column":1},"end":{"line":431,"column":1}},"key":"GjLgaMcesr"},{"type":"inlineMath","value":"u(0)=-1","position":{"start":{"line":431,"column":1},"end":{"line":431,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo stretchy=\"false\">(</mo><mn>0</mn><mo stretchy=\"false\">)</mo><mo>=</mo><mo>−</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">u(0)=-1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">−</span><span class=\"mord\">1</span></span></span></span>","key":"xwizPyHB4g"},{"type":"text","value":".","position":{"start":{"line":431,"column":1},"end":{"line":431,"column":1}},"key":"doM3aCnued"}],"key":"Sl83RAsKa8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"using OrdinaryDiffEq\nf(u, p, t) = sin((t + u)^2)\ntspan = (0.0, 4.0)\nu₀ = -1.0\nivp = ODEProblem(f, u₀, tspan)","key":"wJMVjCbTom"},{"type":"output","id":"OjaLiVBoiKp7bx5yce9o5","data":[{"output_type":"execute_result","execution_count":28,"metadata":{},"data":{"text/plain":{"content":"\u001b[38;2;86;182;194mODEProblem\u001b[0m with uType \u001b[38;2;86;182;194mFloat64\u001b[0m and tType \u001b[38;2;86;182;194mFloat64\u001b[0m. In-place: \u001b[38;2;86;182;194mfalse\u001b[0m\ntimespan: (0.0, 4.0)\nu0: -1.0","content_type":"text/plain"}}}],"key":"SYIc0Weg1b"}],"data":{},"key":"tNj0dJqzVm"},{"type":"paragraph","position":{"start":{"line":441,"column":1},"end":{"line":441,"column":1}},"children":[{"type":"text","value":"We use a ","position":{"start":{"line":441,"column":1},"end":{"line":441,"column":1}},"key":"M57xcEGnOU"},{"type":"inlineCode","value":"DifferentialEquations","position":{"start":{"line":441,"column":1},"end":{"line":441,"column":1}},"key":"HBWea1LWYf"},{"type":"text","value":" solver to construct an accurate approximation to the exact solution.","position":{"start":{"line":441,"column":1},"end":{"line":441,"column":1}},"key":"GN48CoAJjB"}],"key":"ljPZOhePxi"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"u_ref = solve(ivp, Tsit5(), reltol=1e-14, abstol=1e-14);","key":"e1xhfFfGY6"},{"type":"output","id":"Wizx-fzNVdVEh8LDYdHsZ","data":[],"key":"OZXbwoirct"}],"data":{},"key":"UVfzYdh2Bp"},{"type":"paragraph","position":{"start":{"line":447,"column":1},"end":{"line":447,"column":1}},"children":[{"type":"text","value":"Now we perform a convergence study of our two Runge–Kutta implementations.","position":{"start":{"line":447,"column":1},"end":{"line":447,"column":1}},"key":"wHuTwHlGWy"}],"key":"DE0WXlCdAj"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"n = [round(Int, 2 * 10^k) for k in 0:0.5:3]\nerr = zeros(length(n), 2)\nfor (k, n) in enumerate(n)\n    t, u = FNC.ie2(ivp, n)\n    err[k, 1] = norm(u_ref.(t) - u, Inf)\n    t, u = FNC.rk4(ivp, n)\n    err[k, 2] = norm(u_ref.(t) - u, Inf)\nend\n@pt :header=[\"n\", \"IE2 error\", \"RK4 error\"] [n err]","key":"JNlfcikyYh"},{"type":"output","id":"dtiSFqFtwlEBGW2BcdGg9","data":[{"output_type":"display_data","metadata":{},"data":{"text/html":{"content":"<table>\n  <thead>\n    <tr class = \"header headerLastRow\">\n      <th style = \"text-align: right;\">n</th>\n      <th style = \"text-align: right;\">IE2 error</th>\n      <th style = \"text-align: right;\">RK4 error</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td style = \"text-align: right;\">2.0</td>\n      <td style = \"text-align: right;\">1.76903</td>\n      <td style = \"text-align: right;\">0.820651</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">6.0</td>\n      <td style = \"text-align: right;\">0.512684</td>\n      <td style = \"text-align: right;\">0.791925</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">20.0</td>\n      <td style = \"text-align: right;\">0.0240594</td>\n      <td style = \"text-align: right;\">0.00081269</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">63.0</td>\n      <td style = \"text-align: right;\">0.00225327</td>\n      <td style = \"text-align: right;\">8.06216e-6</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">200.0</td>\n      <td style = \"text-align: right;\">0.000222419</td>\n      <td style = \"text-align: right;\">7.60655e-8</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">632.0</td>\n      <td style = \"text-align: right;\">2.22528e-5</td>\n      <td style = \"text-align: right;\">7.513e-10</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">2000.0</td>\n      <td style = \"text-align: right;\">2.22177e-6</td>\n      <td style = \"text-align: right;\">7.45187e-12</td>\n    </tr>\n  </tbody>\n</table>\n","content_type":"text/html"}}}],"key":"JPAZJCZ3qK"}],"data":{},"key":"DYorlI5qiV"},{"type":"paragraph","position":{"start":{"line":461,"column":1},"end":{"line":461,"column":1}},"children":[{"type":"text","value":"The amount of computational work at each time step is assumed to be proportional to the number of stages. Let’s compare on an apples-to-apples basis by using the number of ","position":{"start":{"line":461,"column":1},"end":{"line":461,"column":1}},"key":"IxaWtuuLXn"},{"type":"inlineMath","value":"f","position":{"start":{"line":461,"column":1},"end":{"line":461,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>","key":"vgLl2DOMe4"},{"type":"text","value":"-evaluations on the horizontal axis.","position":{"start":{"line":461,"column":1},"end":{"line":461,"column":1}},"key":"Hqp0lWA9vo"}],"key":"xMTIZYzmPt"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"using Plots\nplot([2n 4n], err;\n    m=3, label=[\"IE2\" \"RK4\"], legend=:bottomleft,\n    xaxis=(:log10, \"f-evaluations\"),  yaxis=(:log10, \"inf-norm error\"),\n    title=\"Convergence of RK methods\")\n\nplot!(2n, 0.1 * err[end,1] * (n / n[end]) .^ (-2), l=:dash, label=L\"O(n^{-2})\")\nplot!(4n, 0.1 * err[end,2] * (n / n[end]) .^ (-4), l=:dash, label=L\"O(n^{-4})\")","key":"zdmc9F0BFl"},{"type":"output","id":"BDrqCU_wij9d6os7mcf1N","data":[{"output_type":"execute_result","execution_count":31,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"43f68048deaee5ef384de5bb9a789a6e","path":"/build/43f68048deaee5ef384de5bb9a789a6e.png"},"text/html":{"content_type":"text/html","hash":"69fdab7557706b666817017dd590e22c","path":"/build/69fdab7557706b666817017dd590e22c.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"7e3b059a558f30028b8b24876de63c0e","path":"/build/7e3b059a558f30028b8b24876de63c0e.svg"}}}],"key":"oZ9EPDNoOu"}],"data":{},"key":"ZgUnF4BI8e"},{"type":"paragraph","position":{"start":{"line":474,"column":1},"end":{"line":474,"column":1}},"children":[{"type":"text","value":"The fourth-order variant is more efficient in this problem over a wide range of accuracy.","position":{"start":{"line":474,"column":1},"end":{"line":474,"column":1}},"key":"pOUmOZwhhL"}],"key":"XBwyvpK2zL"}],"label":"demo-rk-converge-julia","identifier":"demo-rk-converge-julia","html_id":"demo-rk-converge-julia","key":"gEXIbriRjc"},{"type":"heading","depth":3,"position":{"start":{"line":477,"column":1},"end":{"line":477,"column":1}},"children":[{"type":"text","value":"6.5 ","position":{"start":{"line":477,"column":1},"end":{"line":477,"column":1}},"key":"zbKbyttLWQ"},{"type":"link","identifier":"section-ivp-adaptive","label":"section-ivp-adaptive","kind":"narrative","position":{"start":{"line":477,"column":5},"end":{"line":477,"column":26}},"url":"/adaptive-rk","internal":true,"dataUrl":"/adaptive-rk.json","children":[{"type":"text","value":"Adaptive Runge–Kutta","key":"MZTxbRxOQX"}],"key":"Xgzf6bJjuW"}],"identifier":"id-6-5","label":"6.5 ","html_id":"id-6-5","implicit":true,"key":"Ue4jnbxuhr"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-adapt-basic","label":"demo-adapt-basic","kind":"proof:example","position":{"start":{"line":480,"column":1},"end":{"line":480,"column":18}},"children":[{"type":"text","value":"Example ","key":"lbgGb4nwGn"},{"type":"text","value":"6.5.1","key":"RWDfhz0f7d"}],"template":"Example %s","enumerator":"6.5.1","resolved":true,"html_id":"demo-adapt-basic","remote":true,"url":"/adaptive-rk","dataUrl":"/adaptive-rk.json","key":"nIPLIb2AhT"}],"key":"NguVsykXky"},{"type":"paragraph","position":{"start":{"line":482,"column":1},"end":{"line":482,"column":1}},"children":[{"type":"text","value":"Let’s run adaptive RK on  ","position":{"start":{"line":482,"column":1},"end":{"line":482,"column":1}},"key":"WCoS5MLPbs"},{"type":"inlineMath","value":"u'=e^{t-u\\sin u}","position":{"start":{"line":482,"column":1},"end":{"line":482,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>u</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo>=</mo><msup><mi>e</mi><mrow><mi>t</mi><mo>−</mo><mi>u</mi><mi>sin</mi><mo>⁡</mo><mi>u</mi></mrow></msup></mrow><annotation encoding=\"application/x-tex\">u&#x27;=e^{t-u\\sin u}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8305em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8305em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mbin mtight\">−</span><span class=\"mord mathnormal mtight\">u</span><span class=\"mspace mtight\" style=\"margin-right:0.1952em;\"></span><span class=\"mop mtight\"><span class=\"mtight\">s</span><span class=\"mtight\">i</span><span class=\"mtight\">n</span></span><span class=\"mspace mtight\" style=\"margin-right:0.1952em;\"></span><span class=\"mord mathnormal mtight\">u</span></span></span></span></span></span></span></span></span></span></span></span>","key":"K3AkG2VAxX"},{"type":"text","value":".","position":{"start":{"line":482,"column":1},"end":{"line":482,"column":1}},"key":"But30N7qFg"}],"key":"XaQgh75de3"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"using OrdinaryDiffEq, Plots\nf(u, p, t) = exp(t - u * sin(u))\nivp = ODEProblem(f, 0, (0.0, 5.0))\nt, u = FNC.rk23(ivp, 1e-5)\nplot(t, u, m=2,\n    xlabel=L\"t\",  ylabel=L\"u(t)\", \n    title=\"Adaptive IVP solution\")","key":"qit01xncYo"},{"type":"output","id":"Lt23doK9NSrQf7JcvDoBT","data":[{"output_type":"execute_result","execution_count":32,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"13c76cef9dc6e9251aa46e34e2c48c95","path":"/build/13c76cef9dc6e9251aa46e34e2c48c95.png"},"text/html":{"content_type":"text/html","hash":"eac66844fd5e7b5f80a30a5ecdcce5c2","path":"/build/eac66844fd5e7b5f80a30a5ecdcce5c2.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"8f3fa63c5cdf70a49fc815ca3eecd657","path":"/build/8f3fa63c5cdf70a49fc815ca3eecd657.svg"}}}],"key":"rKI4KSlDHo"}],"data":{},"key":"CHMlLJKZrt"},{"type":"paragraph","position":{"start":{"line":494,"column":1},"end":{"line":494,"column":1}},"children":[{"type":"text","value":"The solution makes a very abrupt change near ","position":{"start":{"line":494,"column":1},"end":{"line":494,"column":1}},"key":"PHZTiFD25P"},{"type":"inlineMath","value":"t=2.4","position":{"start":{"line":494,"column":1},"end":{"line":494,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi><mo>=</mo><mn>2.4</mn></mrow><annotation encoding=\"application/x-tex\">t=2.4</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2.4</span></span></span></span>","key":"D5gkvCG8VT"},{"type":"text","value":". The resulting time steps vary over three orders of magnitude.","position":{"start":{"line":494,"column":1},"end":{"line":494,"column":1}},"key":"fviTkLb5UQ"}],"key":"VqF0heVCTP"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"Δt = diff(t)\nplot(t[1:end-1], Δt;\n    xaxis=(L\"t\", (0, 5)), yaxis=(:log10, \"step size\"),\n    title=\"Adaptive step sizes\")","key":"smlc1At2Qz"},{"type":"output","id":"PN4DIpLIsVP2d3ufWnZWY","data":[{"output_type":"execute_result","execution_count":33,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"a0fb87535fa921065e3241b4f03a05c7","path":"/build/a0fb87535fa921065e3241b4f03a05c7.png"},"text/html":{"content":"<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" width=\"500\" height=\"320\" viewBox=\"0 0 2000 1280\">\n<defs>\n  <clipPath id=\"clip930\">\n    <rect x=\"0\" y=\"0\" width=\"2000\" height=\"1280\"/>\n  </clipPath>\n</defs>\n<path clip-path=\"url(#clip930)\" d=\"M0 1280 L2000 1280 L2000 -2.66454e-14 L0 -2.66454e-14  Z\" fill=\"#ffffff\" fill-rule=\"evenodd\" fill-opacity=\"1\"/>\n<defs>\n  <clipPath id=\"clip931\">\n    <rect x=\"400\" y=\"0\" width=\"1401\" height=\"1280\"/>\n  </clipPath>\n</defs>\n<path clip-path=\"url(#clip930)\" d=\"M245.508 1111.02 L1952.76 1111.02 L1952.76 107.256 L245.508 107.256  Z\" fill=\"#ffffff\" fill-rule=\"evenodd\" fill-opacity=\"1\"/>\n<defs>\n  <clipPath id=\"clip932\">\n    <rect x=\"245\" y=\"107\" width=\"1708\" height=\"1005\"/>\n  </clipPath>\n</defs>\n<polyline clip-path=\"url(#clip932)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"245.508,1111.02 245.508,107.256 \"/>\n<polyline clip-path=\"url(#clip932)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"586.957,1111.02 586.957,107.256 \"/>\n<polyline clip-path=\"url(#clip932)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"928.407,1111.02 928.407,107.256 \"/>\n<polyline clip-path=\"url(#clip932)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"1269.86,1111.02 1269.86,107.256 \"/>\n<polyline clip-path=\"url(#clip932)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"1611.31,1111.02 1611.31,107.256 \"/>\n<polyline clip-path=\"url(#clip932)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"1952.76,1111.02 1952.76,107.256 \"/>\n<polyline clip-path=\"url(#clip932)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"245.508,1000.16 1952.76,1000.16 \"/>\n<polyline clip-path=\"url(#clip932)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"245.508,509.899 1952.76,509.899 \"/>\n<polyline clip-path=\"url(#clip930)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"245.508,1111.02 1952.76,1111.02 \"/>\n<polyline clip-path=\"url(#clip930)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"245.508,1111.02 245.508,1092.12 \"/>\n<polyline clip-path=\"url(#clip930)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"586.957,1111.02 586.957,1092.12 \"/>\n<polyline clip-path=\"url(#clip930)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"928.407,1111.02 928.407,1092.12 \"/>\n<polyline clip-path=\"url(#clip930)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"1269.86,1111.02 1269.86,1092.12 \"/>\n<polyline clip-path=\"url(#clip930)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"1611.31,1111.02 1611.31,1092.12 \"/>\n<polyline clip-path=\"url(#clip930)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"1952.76,1111.02 1952.76,1092.12 \"/>\n<path clip-path=\"url(#clip930)\" d=\"M245.508 1138.74 Q241.897 1138.74 240.068 1142.3 Q238.262 1145.84 238.262 1152.97 Q238.262 1160.08 240.068 1163.64 Q241.897 1167.19 245.508 1167.19 Q249.142 1167.19 250.947 1163.64 Q252.776 1160.08 252.776 1152.97 Q252.776 1145.84 250.947 1142.3 Q249.142 1138.74 245.508 1138.74 M245.508 1135.03 Q251.318 1135.03 254.373 1139.64 Q257.452 1144.22 257.452 1152.97 Q257.452 1161.7 254.373 1166.31 Q251.318 1170.89 245.508 1170.89 Q239.698 1170.89 236.619 1166.31 Q233.563 1161.7 233.563 1152.97 Q233.563 1144.22 236.619 1139.64 Q239.698 1135.03 245.508 1135.03 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip930)\" d=\"M577.339 1166.28 L584.978 1166.28 L584.978 1139.92 L576.668 1141.58 L576.668 1137.33 L584.932 1135.66 L589.608 1135.66 L589.608 1166.28 L597.247 1166.28 L597.247 1170.22 L577.339 1170.22 L577.339 1166.28 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip930)\" d=\"M923.06 1166.28 L939.379 1166.28 L939.379 1170.22 L917.435 1170.22 L917.435 1166.28 Q920.097 1163.53 924.68 1158.9 Q929.287 1154.25 930.467 1152.9 Q932.713 1150.38 933.592 1148.64 Q934.495 1146.89 934.495 1145.2 Q934.495 1142.44 932.55 1140.7 Q930.629 1138.97 927.527 1138.97 Q925.328 1138.97 922.875 1139.73 Q920.444 1140.5 917.666 1142.05 L917.666 1137.33 Q920.49 1136.19 922.944 1135.61 Q925.398 1135.03 927.435 1135.03 Q932.805 1135.03 936 1137.72 Q939.194 1140.4 939.194 1144.89 Q939.194 1147.02 938.384 1148.95 Q937.597 1150.84 935.49 1153.44 Q934.912 1154.11 931.81 1157.33 Q928.708 1160.52 923.06 1166.28 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip930)\" d=\"M1274.1 1151.58 Q1277.46 1152.3 1279.34 1154.57 Q1281.23 1156.84 1281.23 1160.17 Q1281.23 1165.29 1277.72 1168.09 Q1274.2 1170.89 1267.72 1170.89 Q1265.54 1170.89 1263.22 1170.45 Q1260.93 1170.03 1258.48 1169.18 L1258.48 1164.66 Q1260.42 1165.8 1262.74 1166.38 Q1265.05 1166.95 1267.58 1166.95 Q1271.97 1166.95 1274.27 1165.22 Q1276.58 1163.48 1276.58 1160.17 Q1276.58 1157.12 1274.43 1155.4 Q1272.3 1153.67 1268.48 1153.67 L1264.45 1153.67 L1264.45 1149.83 L1268.66 1149.83 Q1272.11 1149.83 1273.94 1148.46 Q1275.77 1147.07 1275.77 1144.48 Q1275.77 1141.82 1273.87 1140.4 Q1272 1138.97 1268.48 1138.97 Q1266.56 1138.97 1264.36 1139.39 Q1262.16 1139.8 1259.52 1140.68 L1259.52 1136.51 Q1262.18 1135.77 1264.5 1135.4 Q1266.84 1135.03 1268.9 1135.03 Q1274.22 1135.03 1277.32 1137.46 Q1280.42 1139.87 1280.42 1143.99 Q1280.42 1146.86 1278.78 1148.85 Q1277.14 1150.82 1274.1 1151.58 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip930)\" d=\"M1614.32 1139.73 L1602.51 1158.18 L1614.32 1158.18 L1614.32 1139.73 M1613.09 1135.66 L1618.97 1135.66 L1618.97 1158.18 L1623.9 1158.18 L1623.9 1162.07 L1618.97 1162.07 L1618.97 1170.22 L1614.32 1170.22 L1614.32 1162.07 L1598.71 1162.07 L1598.71 1157.56 L1613.09 1135.66 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip930)\" d=\"M1943.03 1135.66 L1961.39 1135.66 L1961.39 1139.59 L1947.32 1139.59 L1947.32 1148.07 Q1948.33 1147.72 1949.35 1147.56 Q1950.37 1147.37 1951.39 1147.37 Q1957.18 1147.37 1960.56 1150.54 Q1963.94 1153.71 1963.94 1159.13 Q1963.94 1164.71 1960.46 1167.81 Q1956.99 1170.89 1950.67 1170.89 Q1948.5 1170.89 1946.23 1170.52 Q1943.98 1170.15 1941.58 1169.41 L1941.58 1164.71 Q1943.66 1165.84 1945.88 1166.4 Q1948.1 1166.95 1950.58 1166.95 Q1954.58 1166.95 1956.92 1164.85 Q1959.26 1162.74 1959.26 1159.13 Q1959.26 1155.52 1956.92 1153.41 Q1954.58 1151.31 1950.58 1151.31 Q1948.71 1151.31 1946.83 1151.72 Q1944.98 1152.14 1943.03 1153.02 L1943.03 1135.66 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><g clip-path=\"url(#clip930)\">\n<image width=\"20\" height=\"42\" xlink:href=\"data:image/png;base64,\niVBORw0KGgoAAAANSUhEUgAAABQAAAAqCAYAAACz+XvQAAABb0lEQVRIia2WXbGEMAyFT6+CggQk\noAUN4AANSAAL4KAaKgENAQfZhws70B8mLduZPADpafr1TAqYGSlBRNy2LVtrOfQ9SWyeZwbwjXVd\nPdEkwasYAB7H0RNUR6JoKKVuycys3Jw/qdg0TbKVpdvVWt+2+z/VzxNXuO/77bnv+2CemKGEHyBk\nuCyL/OQk/KqqEvET+9AVG4YhKihiKOUHCBgm8QMAa63HJze01mHDvokvw23bglsry/L2TETR3RZF\noZLaFR7sIrKN6z+t9TtBt7pQ/0vyYYr/zhH1obj/uUPa/yT8Hhkig98jwxx+QIRhNr9j5Z/xizJE\nJr8ow1x+QIDhK37H6j/jF2SIF/xEglKh8+K6vRzHMbn/XecR0fv+d92VV2EOP2MMA2BjDHs+zPHf\nOefMFf99hUbXdQw4F1fuCa/rygC4aZpb3qOpY2JEFD20Rx8SkTfhPISYA6KeckWvd3Rd19HqH/mE\nIlT1NT62/UqELBm6rwAAAABJRU5ErkJggg==\n\" transform=\"translate(1089, 1200)\"/>\n</g>\n<polyline clip-path=\"url(#clip930)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"245.508,1111.02 245.508,107.256 \"/>\n<polyline clip-path=\"url(#clip930)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"245.508,1000.16 264.405,1000.16 \"/>\n<polyline clip-path=\"url(#clip930)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"245.508,509.899 264.405,509.899 \"/>\n<path clip-path=\"url(#clip930)\" d=\"M113.675 1019.96 L121.314 1019.96 L121.314 993.592 L113.004 995.258 L113.004 990.999 L121.268 989.332 L125.944 989.332 L125.944 1019.96 L133.583 1019.96 L133.583 1023.89 L113.675 1023.89 L113.675 1019.96 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip930)\" d=\"M153.027 992.411 Q149.416 992.411 147.587 995.976 Q145.782 999.518 145.782 1006.65 Q145.782 1013.75 147.587 1017.32 Q149.416 1020.86 153.027 1020.86 Q156.661 1020.86 158.467 1017.32 Q160.295 1013.75 160.295 1006.65 Q160.295 999.518 158.467 995.976 Q156.661 992.411 153.027 992.411 M153.027 988.707 Q158.837 988.707 161.893 993.314 Q164.971 997.897 164.971 1006.65 Q164.971 1015.37 161.893 1019.98 Q158.837 1024.56 153.027 1024.56 Q147.217 1024.56 144.138 1019.98 Q141.082 1015.37 141.082 1006.65 Q141.082 997.897 144.138 993.314 Q147.217 988.707 153.027 988.707 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip930)\" d=\"M164.971 982.809 L189.083 982.809 L189.083 986.006 L164.971 986.006 L164.971 982.809 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip930)\" d=\"M207.721 971.712 L198.129 986.702 L207.721 986.702 L207.721 971.712 M206.724 968.402 L211.502 968.402 L211.502 986.702 L215.508 986.702 L215.508 989.862 L211.502 989.862 L211.502 996.482 L207.721 996.482 L207.721 989.862 L195.045 989.862 L195.045 986.194 L206.724 968.402 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip930)\" d=\"M115.368 529.691 L123.007 529.691 L123.007 503.326 L114.697 504.992 L114.697 500.733 L122.96 499.066 L127.636 499.066 L127.636 529.691 L135.275 529.691 L135.275 533.626 L115.368 533.626 L115.368 529.691 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip930)\" d=\"M154.72 502.145 Q151.108 502.145 149.28 505.71 Q147.474 509.252 147.474 516.381 Q147.474 523.488 149.28 527.052 Q151.108 530.594 154.72 530.594 Q158.354 530.594 160.159 527.052 Q161.988 523.488 161.988 516.381 Q161.988 509.252 160.159 505.71 Q158.354 502.145 154.72 502.145 M154.72 498.441 Q160.53 498.441 163.585 503.048 Q166.664 507.631 166.664 516.381 Q166.664 525.108 163.585 529.714 Q160.53 534.298 154.72 534.298 Q148.909 534.298 145.831 529.714 Q142.775 525.108 142.775 516.381 Q142.775 507.631 145.831 503.048 Q148.909 498.441 154.72 498.441 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip930)\" d=\"M166.664 492.543 L190.775 492.543 L190.775 495.74 L166.664 495.74 L166.664 492.543 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip930)\" d=\"M202.248 503.019 L215.508 503.019 L215.508 506.216 L197.678 506.216 L197.678 503.019 Q199.841 500.781 203.565 497.019 Q207.308 493.239 208.267 492.148 Q210.091 490.098 210.806 488.687 Q211.539 487.258 211.539 485.885 Q211.539 483.647 209.959 482.236 Q208.398 480.826 205.878 480.826 Q204.091 480.826 202.098 481.446 Q200.123 482.067 197.866 483.327 L197.866 479.49 Q200.161 478.569 202.154 478.098 Q204.148 477.628 205.803 477.628 Q210.166 477.628 212.762 479.81 Q215.357 481.992 215.357 485.64 Q215.357 487.371 214.699 488.932 Q214.06 490.474 212.348 492.58 Q211.878 493.126 209.358 495.74 Q206.837 498.336 202.248 503.019 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><g clip-path=\"url(#clip930)\">\n<text style=\"fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:66px; text-anchor:middle;\" transform=\"rotate(-90, 71.4418, 609.137)\" x=\"71.4418\" y=\"609.137\">step size</text>\n</g>\n<g clip-path=\"url(#clip930)\">\n<text style=\"fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:66px; text-anchor:middle;\" transform=\"rotate(0, 1099.13, 57.6)\" x=\"1099.13\" y=\"57.6\">Adaptive step sizes</text>\n</g>\n<polyline clip-path=\"url(#clip932)\" style=\"stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none\" points=\"245.508,501.98 249.186,354.395 263.898,325.393 283.218,336.127 300.685,343.179 317.033,346.864 332.824,348.257 348.409,347.805 364.062,345.672 380.031,341.853 396.583,336.198 414.038,328.349 432.829,317.582 453.619,302.269 477.626,277.557 507.905,262.52 542.778,255.132 580.158,273.539 611.602,278.885 641.505,280.343 671.003,280.884 700.35,281.538 729.518,282.904 758.314,285.377 786.449,289.188 813.595,294.41 839.441,300.988 863.739,308.773 886.323,317.581 907.113,327.224 926.104,337.54 943.34,348.396 958.906,359.692 972.904,371.354 985.45,383.325 996.662,395.566 1006.66,408.048 1015.54,420.747 1023.43,433.647 1030.42,446.734 1036.6,459.997 1042.06,473.426 1046.87,487.013 1051.1,500.75 1054.82,514.63 1058.09,528.646 1060.95,542.791 1063.46,557.057 1065.65,571.439 1067.57,585.929 1069.24,600.519 1070.7,615.203 1071.97,629.972 1073.07,644.819 1074.03,659.736 1074.87,674.713 1075.59,689.741 1076.22,704.811 1076.77,719.914 1077.25,735.037 1077.66,750.17 1078.02,765.302 1078.33,780.418 1078.6,795.504 1078.83,810.547 1079.03,825.529 1079.21,840.433 1079.36,855.239 1079.49,869.923 1079.61,884.463 1079.71,898.829 1079.8,912.99 1079.88,926.907 1079.95,940.535 1080,953.823 1080.06,966.702 1080.1,979.091 1080.15,990.88 1080.18,1001.92 1080.22,1012.01 1080.25,1020.82 1080.28,1027.84 1080.3,1032.06 1080.33,1031.14 1080.35,1016.34 1080.38,1063.72 1080.4,1053.13 1080.42,1073.01 1080.44,1081.82 1080.45,1082.61 1080.47,1077.39 1080.49,1065.47 1080.51,1042.48 1080.53,1017.51 1080.56,1014.28 1080.59,1027.3 1080.61,1025.75 1080.64,1019.66 1080.67,1011.54 1080.7,1002.14 1080.73,991.809 1080.77,980.762 1080.81,969.133 1080.86,957.018 1080.91,944.485 1080.97,931.587 1081.03,918.366 1081.1,904.855 1081.19,891.081 1081.28,877.068 1081.39,862.834 1081.52,848.398 1081.66,833.772 1081.82,818.972 1082.01,804.007 1082.22,788.888 1082.47,773.626 1082.76,758.227 1083.09,742.701 1083.47,727.053 1083.92,711.291 1084.43,695.421 1085.03,679.449 1085.72,663.379 1086.53,647.217 1087.47,630.967 1088.57,614.635 1089.84,598.223 1091.33,581.736 1093.07,565.178 1095.1,548.551 1097.48,531.86 1100.26,515.106 1103.51,498.294 1107.32,481.425 1111.78,464.501 1117.01,447.525 1123.14,430.499 1130.34,413.423 1138.79,396.298 1148.72,379.126 1160.38,361.905 1174.09,344.636 1190.22,327.317 1209.19,309.948 1231.53,292.526 1257.83,275.052 1288.83,257.529 1325.38,239.964 1368.48,222.384 1419.32,204.846 1479.27,187.479 1549.84,170.558 1632.56,154.658 1728.62,140.874 1837.94,135.664 \"/>\n</svg>\n","content_type":"text/html"},"image/svg+xml":{"content":"<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" width=\"500\" height=\"320\" viewBox=\"0 0 2000 1280\">\n<defs>\n  <clipPath id=\"clip880\">\n    <rect x=\"0\" y=\"0\" width=\"2000\" height=\"1280\"/>\n  </clipPath>\n</defs>\n<path clip-path=\"url(#clip880)\" d=\"M0 1280 L2000 1280 L2000 -2.66454e-14 L0 -2.66454e-14  Z\" fill=\"#ffffff\" fill-rule=\"evenodd\" fill-opacity=\"1\"/>\n<defs>\n  <clipPath id=\"clip881\">\n    <rect x=\"400\" y=\"0\" width=\"1401\" height=\"1280\"/>\n  </clipPath>\n</defs>\n<path clip-path=\"url(#clip880)\" d=\"M245.508 1111.02 L1952.76 1111.02 L1952.76 107.256 L245.508 107.256  Z\" fill=\"#ffffff\" fill-rule=\"evenodd\" fill-opacity=\"1\"/>\n<defs>\n  <clipPath id=\"clip882\">\n    <rect x=\"245\" y=\"107\" width=\"1708\" height=\"1005\"/>\n  </clipPath>\n</defs>\n<polyline clip-path=\"url(#clip882)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"245.508,1111.02 245.508,107.256 \"/>\n<polyline clip-path=\"url(#clip882)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"586.957,1111.02 586.957,107.256 \"/>\n<polyline clip-path=\"url(#clip882)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"928.407,1111.02 928.407,107.256 \"/>\n<polyline clip-path=\"url(#clip882)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"1269.86,1111.02 1269.86,107.256 \"/>\n<polyline clip-path=\"url(#clip882)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"1611.31,1111.02 1611.31,107.256 \"/>\n<polyline clip-path=\"url(#clip882)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"1952.76,1111.02 1952.76,107.256 \"/>\n<polyline clip-path=\"url(#clip882)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"245.508,1000.16 1952.76,1000.16 \"/>\n<polyline clip-path=\"url(#clip882)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"245.508,509.899 1952.76,509.899 \"/>\n<polyline clip-path=\"url(#clip880)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"245.508,1111.02 1952.76,1111.02 \"/>\n<polyline clip-path=\"url(#clip880)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"245.508,1111.02 245.508,1092.12 \"/>\n<polyline clip-path=\"url(#clip880)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"586.957,1111.02 586.957,1092.12 \"/>\n<polyline clip-path=\"url(#clip880)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"928.407,1111.02 928.407,1092.12 \"/>\n<polyline clip-path=\"url(#clip880)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"1269.86,1111.02 1269.86,1092.12 \"/>\n<polyline clip-path=\"url(#clip880)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"1611.31,1111.02 1611.31,1092.12 \"/>\n<polyline clip-path=\"url(#clip880)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"1952.76,1111.02 1952.76,1092.12 \"/>\n<path clip-path=\"url(#clip880)\" d=\"M245.508 1138.74 Q241.897 1138.74 240.068 1142.3 Q238.262 1145.84 238.262 1152.97 Q238.262 1160.08 240.068 1163.64 Q241.897 1167.19 245.508 1167.19 Q249.142 1167.19 250.947 1163.64 Q252.776 1160.08 252.776 1152.97 Q252.776 1145.84 250.947 1142.3 Q249.142 1138.74 245.508 1138.74 M245.508 1135.03 Q251.318 1135.03 254.373 1139.64 Q257.452 1144.22 257.452 1152.97 Q257.452 1161.7 254.373 1166.31 Q251.318 1170.89 245.508 1170.89 Q239.698 1170.89 236.619 1166.31 Q233.563 1161.7 233.563 1152.97 Q233.563 1144.22 236.619 1139.64 Q239.698 1135.03 245.508 1135.03 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip880)\" d=\"M577.339 1166.28 L584.978 1166.28 L584.978 1139.92 L576.668 1141.58 L576.668 1137.33 L584.932 1135.66 L589.608 1135.66 L589.608 1166.28 L597.247 1166.28 L597.247 1170.22 L577.339 1170.22 L577.339 1166.28 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip880)\" d=\"M923.06 1166.28 L939.379 1166.28 L939.379 1170.22 L917.435 1170.22 L917.435 1166.28 Q920.097 1163.53 924.68 1158.9 Q929.287 1154.25 930.467 1152.9 Q932.713 1150.38 933.592 1148.64 Q934.495 1146.89 934.495 1145.2 Q934.495 1142.44 932.55 1140.7 Q930.629 1138.97 927.527 1138.97 Q925.328 1138.97 922.875 1139.73 Q920.444 1140.5 917.666 1142.05 L917.666 1137.33 Q920.49 1136.19 922.944 1135.61 Q925.398 1135.03 927.435 1135.03 Q932.805 1135.03 936 1137.72 Q939.194 1140.4 939.194 1144.89 Q939.194 1147.02 938.384 1148.95 Q937.597 1150.84 935.49 1153.44 Q934.912 1154.11 931.81 1157.33 Q928.708 1160.52 923.06 1166.28 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip880)\" d=\"M1274.1 1151.58 Q1277.46 1152.3 1279.34 1154.57 Q1281.23 1156.84 1281.23 1160.17 Q1281.23 1165.29 1277.72 1168.09 Q1274.2 1170.89 1267.72 1170.89 Q1265.54 1170.89 1263.22 1170.45 Q1260.93 1170.03 1258.48 1169.18 L1258.48 1164.66 Q1260.42 1165.8 1262.74 1166.38 Q1265.05 1166.95 1267.58 1166.95 Q1271.97 1166.95 1274.27 1165.22 Q1276.58 1163.48 1276.58 1160.17 Q1276.58 1157.12 1274.43 1155.4 Q1272.3 1153.67 1268.48 1153.67 L1264.45 1153.67 L1264.45 1149.83 L1268.66 1149.83 Q1272.11 1149.83 1273.94 1148.46 Q1275.77 1147.07 1275.77 1144.48 Q1275.77 1141.82 1273.87 1140.4 Q1272 1138.97 1268.48 1138.97 Q1266.56 1138.97 1264.36 1139.39 Q1262.16 1139.8 1259.52 1140.68 L1259.52 1136.51 Q1262.18 1135.77 1264.5 1135.4 Q1266.84 1135.03 1268.9 1135.03 Q1274.22 1135.03 1277.32 1137.46 Q1280.42 1139.87 1280.42 1143.99 Q1280.42 1146.86 1278.78 1148.85 Q1277.14 1150.82 1274.1 1151.58 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip880)\" d=\"M1614.32 1139.73 L1602.51 1158.18 L1614.32 1158.18 L1614.32 1139.73 M1613.09 1135.66 L1618.97 1135.66 L1618.97 1158.18 L1623.9 1158.18 L1623.9 1162.07 L1618.97 1162.07 L1618.97 1170.22 L1614.32 1170.22 L1614.32 1162.07 L1598.71 1162.07 L1598.71 1157.56 L1613.09 1135.66 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip880)\" d=\"M1943.03 1135.66 L1961.39 1135.66 L1961.39 1139.59 L1947.32 1139.59 L1947.32 1148.07 Q1948.33 1147.72 1949.35 1147.56 Q1950.37 1147.37 1951.39 1147.37 Q1957.18 1147.37 1960.56 1150.54 Q1963.94 1153.71 1963.94 1159.13 Q1963.94 1164.71 1960.46 1167.81 Q1956.99 1170.89 1950.67 1170.89 Q1948.5 1170.89 1946.23 1170.52 Q1943.98 1170.15 1941.58 1169.41 L1941.58 1164.71 Q1943.66 1165.84 1945.88 1166.4 Q1948.1 1166.95 1950.58 1166.95 Q1954.58 1166.95 1956.92 1164.85 Q1959.26 1162.74 1959.26 1159.13 Q1959.26 1155.52 1956.92 1153.41 Q1954.58 1151.31 1950.58 1151.31 Q1948.71 1151.31 1946.83 1151.72 Q1944.98 1152.14 1943.03 1153.02 L1943.03 1135.66 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><g clip-path=\"url(#clip880)\">\n<image width=\"20\" height=\"42\" xlink:href=\"data:image/png;base64,\niVBORw0KGgoAAAANSUhEUgAAABQAAAAqCAYAAACz+XvQAAABb0lEQVRIia2WXbGEMAyFT6+CggQk\noAUN4AANSAAL4KAaKgENAQfZhws70B8mLduZPADpafr1TAqYGSlBRNy2LVtrOfQ9SWyeZwbwjXVd\nPdEkwasYAB7H0RNUR6JoKKVuycys3Jw/qdg0TbKVpdvVWt+2+z/VzxNXuO/77bnv+2CemKGEHyBk\nuCyL/OQk/KqqEvET+9AVG4YhKihiKOUHCBgm8QMAa63HJze01mHDvokvw23bglsry/L2TETR3RZF\noZLaFR7sIrKN6z+t9TtBt7pQ/0vyYYr/zhH1obj/uUPa/yT8Hhkig98jwxx+QIRhNr9j5Z/xizJE\nJr8ow1x+QIDhK37H6j/jF2SIF/xEglKh8+K6vRzHMbn/XecR0fv+d92VV2EOP2MMA2BjDHs+zPHf\nOefMFf99hUbXdQw4F1fuCa/rygC4aZpb3qOpY2JEFD20Rx8SkTfhPISYA6KeckWvd3Rd19HqH/mE\nIlT1NT62/UqELBm6rwAAAABJRU5ErkJggg==\n\" transform=\"translate(1089, 1200)\"/>\n</g>\n<polyline clip-path=\"url(#clip880)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"245.508,1111.02 245.508,107.256 \"/>\n<polyline clip-path=\"url(#clip880)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"245.508,1000.16 264.405,1000.16 \"/>\n<polyline clip-path=\"url(#clip880)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"245.508,509.899 264.405,509.899 \"/>\n<path clip-path=\"url(#clip880)\" d=\"M113.675 1019.96 L121.314 1019.96 L121.314 993.592 L113.004 995.258 L113.004 990.999 L121.268 989.332 L125.944 989.332 L125.944 1019.96 L133.583 1019.96 L133.583 1023.89 L113.675 1023.89 L113.675 1019.96 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip880)\" d=\"M153.027 992.411 Q149.416 992.411 147.587 995.976 Q145.782 999.518 145.782 1006.65 Q145.782 1013.75 147.587 1017.32 Q149.416 1020.86 153.027 1020.86 Q156.661 1020.86 158.467 1017.32 Q160.295 1013.75 160.295 1006.65 Q160.295 999.518 158.467 995.976 Q156.661 992.411 153.027 992.411 M153.027 988.707 Q158.837 988.707 161.893 993.314 Q164.971 997.897 164.971 1006.65 Q164.971 1015.37 161.893 1019.98 Q158.837 1024.56 153.027 1024.56 Q147.217 1024.56 144.138 1019.98 Q141.082 1015.37 141.082 1006.65 Q141.082 997.897 144.138 993.314 Q147.217 988.707 153.027 988.707 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip880)\" d=\"M164.971 982.809 L189.083 982.809 L189.083 986.006 L164.971 986.006 L164.971 982.809 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip880)\" d=\"M207.721 971.712 L198.129 986.702 L207.721 986.702 L207.721 971.712 M206.724 968.402 L211.502 968.402 L211.502 986.702 L215.508 986.702 L215.508 989.862 L211.502 989.862 L211.502 996.482 L207.721 996.482 L207.721 989.862 L195.045 989.862 L195.045 986.194 L206.724 968.402 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip880)\" d=\"M115.368 529.691 L123.007 529.691 L123.007 503.326 L114.697 504.992 L114.697 500.733 L122.96 499.066 L127.636 499.066 L127.636 529.691 L135.275 529.691 L135.275 533.626 L115.368 533.626 L115.368 529.691 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip880)\" d=\"M154.72 502.145 Q151.108 502.145 149.28 505.71 Q147.474 509.252 147.474 516.381 Q147.474 523.488 149.28 527.052 Q151.108 530.594 154.72 530.594 Q158.354 530.594 160.159 527.052 Q161.988 523.488 161.988 516.381 Q161.988 509.252 160.159 505.71 Q158.354 502.145 154.72 502.145 M154.72 498.441 Q160.53 498.441 163.585 503.048 Q166.664 507.631 166.664 516.381 Q166.664 525.108 163.585 529.714 Q160.53 534.298 154.72 534.298 Q148.909 534.298 145.831 529.714 Q142.775 525.108 142.775 516.381 Q142.775 507.631 145.831 503.048 Q148.909 498.441 154.72 498.441 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip880)\" d=\"M166.664 492.543 L190.775 492.543 L190.775 495.74 L166.664 495.74 L166.664 492.543 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip880)\" d=\"M202.248 503.019 L215.508 503.019 L215.508 506.216 L197.678 506.216 L197.678 503.019 Q199.841 500.781 203.565 497.019 Q207.308 493.239 208.267 492.148 Q210.091 490.098 210.806 488.687 Q211.539 487.258 211.539 485.885 Q211.539 483.647 209.959 482.236 Q208.398 480.826 205.878 480.826 Q204.091 480.826 202.098 481.446 Q200.123 482.067 197.866 483.327 L197.866 479.49 Q200.161 478.569 202.154 478.098 Q204.148 477.628 205.803 477.628 Q210.166 477.628 212.762 479.81 Q215.357 481.992 215.357 485.64 Q215.357 487.371 214.699 488.932 Q214.06 490.474 212.348 492.58 Q211.878 493.126 209.358 495.74 Q206.837 498.336 202.248 503.019 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><g clip-path=\"url(#clip880)\">\n<text style=\"fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:66px; text-anchor:middle;\" transform=\"rotate(-90, 71.4418, 609.137)\" x=\"71.4418\" y=\"609.137\">step size</text>\n</g>\n<g clip-path=\"url(#clip880)\">\n<text style=\"fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:66px; text-anchor:middle;\" transform=\"rotate(0, 1099.13, 57.6)\" x=\"1099.13\" y=\"57.6\">Adaptive step sizes</text>\n</g>\n<polyline clip-path=\"url(#clip882)\" style=\"stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none\" points=\"245.508,501.98 249.186,354.395 263.898,325.393 283.218,336.127 300.685,343.179 317.033,346.864 332.824,348.257 348.409,347.805 364.062,345.672 380.031,341.853 396.583,336.198 414.038,328.349 432.829,317.582 453.619,302.269 477.626,277.557 507.905,262.52 542.778,255.132 580.158,273.539 611.602,278.885 641.505,280.343 671.003,280.884 700.35,281.538 729.518,282.904 758.314,285.377 786.449,289.188 813.595,294.41 839.441,300.988 863.739,308.773 886.323,317.581 907.113,327.224 926.104,337.54 943.34,348.396 958.906,359.692 972.904,371.354 985.45,383.325 996.662,395.566 1006.66,408.048 1015.54,420.747 1023.43,433.647 1030.42,446.734 1036.6,459.997 1042.06,473.426 1046.87,487.013 1051.1,500.75 1054.82,514.63 1058.09,528.646 1060.95,542.791 1063.46,557.057 1065.65,571.439 1067.57,585.929 1069.24,600.519 1070.7,615.203 1071.97,629.972 1073.07,644.819 1074.03,659.736 1074.87,674.713 1075.59,689.741 1076.22,704.811 1076.77,719.914 1077.25,735.037 1077.66,750.17 1078.02,765.302 1078.33,780.418 1078.6,795.504 1078.83,810.547 1079.03,825.529 1079.21,840.433 1079.36,855.239 1079.49,869.923 1079.61,884.463 1079.71,898.829 1079.8,912.99 1079.88,926.907 1079.95,940.535 1080,953.823 1080.06,966.702 1080.1,979.091 1080.15,990.88 1080.18,1001.92 1080.22,1012.01 1080.25,1020.82 1080.28,1027.84 1080.3,1032.06 1080.33,1031.14 1080.35,1016.34 1080.38,1063.72 1080.4,1053.13 1080.42,1073.01 1080.44,1081.82 1080.45,1082.61 1080.47,1077.39 1080.49,1065.47 1080.51,1042.48 1080.53,1017.51 1080.56,1014.28 1080.59,1027.3 1080.61,1025.75 1080.64,1019.66 1080.67,1011.54 1080.7,1002.14 1080.73,991.809 1080.77,980.762 1080.81,969.133 1080.86,957.018 1080.91,944.485 1080.97,931.587 1081.03,918.366 1081.1,904.855 1081.19,891.081 1081.28,877.068 1081.39,862.834 1081.52,848.398 1081.66,833.772 1081.82,818.972 1082.01,804.007 1082.22,788.888 1082.47,773.626 1082.76,758.227 1083.09,742.701 1083.47,727.053 1083.92,711.291 1084.43,695.421 1085.03,679.449 1085.72,663.379 1086.53,647.217 1087.47,630.967 1088.57,614.635 1089.84,598.223 1091.33,581.736 1093.07,565.178 1095.1,548.551 1097.48,531.86 1100.26,515.106 1103.51,498.294 1107.32,481.425 1111.78,464.501 1117.01,447.525 1123.14,430.499 1130.34,413.423 1138.79,396.298 1148.72,379.126 1160.38,361.905 1174.09,344.636 1190.22,327.317 1209.19,309.948 1231.53,292.526 1257.83,275.052 1288.83,257.529 1325.38,239.964 1368.48,222.384 1419.32,204.846 1479.27,187.479 1549.84,170.558 1632.56,154.658 1728.62,140.874 1837.94,135.664 \"/>\n</svg>\n","content_type":"image/svg+xml"}}}],"key":"X2evINA1IF"}],"data":{},"key":"URrf1TFLOB"},{"type":"paragraph","position":{"start":{"line":503,"column":1},"end":{"line":503,"column":1}},"children":[{"type":"text","value":"If we had to run with a uniform step size to get this accuracy, it would be","position":{"start":{"line":503,"column":1},"end":{"line":503,"column":1}},"key":"etfc2rrgei"}],"key":"MqA2J0NbDF"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"println(\"minimum step size = $(minimum(Δt))\")","key":"De1RSyoGZr"},{"type":"output","id":"rdzeh9znCDxKyFOXCcmJX","data":[{"output_type":"stream","name":"stdout","text":"minimum step size = 4.6096854609878335e-5\n"}],"key":"h3g7BThnhC"}],"data":{},"key":"euuKOmKCCY"},{"type":"paragraph","position":{"start":{"line":509,"column":1},"end":{"line":509,"column":1}},"children":[{"type":"text","value":"On the other hand, the average step size that was actually taken was","position":{"start":{"line":509,"column":1},"end":{"line":509,"column":1}},"key":"cf0xJN8Yqw"}],"key":"IdvVZTiuF4"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"println(\"average step size = $(sum(Δt)/(length(t)-1))\")","key":"PeAirfeEX3"},{"type":"output","id":"XMu1_eEKfYNMEh2hKObwT","data":[{"output_type":"stream","name":"stdout","text":"average step size = 0.03205128205128205\n"}],"key":"U2T0HL6fh8"}],"data":{},"key":"nGvU6Dysgr"},{"type":"paragraph","position":{"start":{"line":515,"column":1},"end":{"line":515,"column":1}},"children":[{"type":"text","value":"We took fewer steps by a factor of almost 1000! Even accounting for the extra stage per step and the occasional rejected step, the savings are clear.","position":{"start":{"line":515,"column":1},"end":{"line":515,"column":1}},"key":"EYAwcAVveE"}],"key":"bpmwgtHZCa"}],"label":"demo-adapt-basic-julia","identifier":"demo-adapt-basic-julia","html_id":"demo-adapt-basic-julia","key":"iLLeLQsx7h"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-adapt-sing","label":"demo-adapt-sing","kind":"proof:example","position":{"start":{"line":520,"column":1},"end":{"line":520,"column":17}},"children":[{"type":"text","value":"Example ","key":"Jwv04HyRHU"},{"type":"text","value":"6.5.2","key":"BU4mUnICb0"}],"template":"Example %s","enumerator":"6.5.2","resolved":true,"html_id":"demo-adapt-sing","remote":true,"url":"/adaptive-rk","dataUrl":"/adaptive-rk.json","key":"rWXNhtTlMU"}],"key":"OyfUijdFOK"},{"type":"paragraph","position":{"start":{"line":522,"column":1},"end":{"line":522,"column":1}},"children":[{"type":"text","value":"In ","position":{"start":{"line":522,"column":1},"end":{"line":522,"column":1}},"key":"LUvrMdUpoE"},{"type":"crossReference","kind":"proof:example","identifier":"demo-basics-sing","label":"demo-basics-sing","children":[{"type":"text","value":"Demo ","key":"DxGC5Bq1qB"},{"type":"text","value":"6.1.3","key":"LjUECMX9LZ"}],"template":"Example %s","enumerator":"6.1.3","resolved":true,"html_id":"demo-basics-sing","remote":true,"url":"/basics","dataUrl":"/basics.json","key":"eoiZqryCO2"},{"type":"text","value":" we saw an ","key":"GEASx84i9e"},{"type":"abbreviation","title":"initial-value problem","children":[{"type":"text","value":"IVP","key":"VXZy42YVJz"}],"key":"g4EYeZTb2a"},{"type":"text","value":" that appears to blow up in a finite amount of time. Because the solution increases so rapidly as it approaches the blowup, adaptive stepping is required even to get close.","key":"os0pskYsnO"}],"key":"oyz02mguCs"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"f(u, p, t) = (t + u)^2\nivp = ODEProblem(f, 1, (0.0, 1.0))\nt, u = FNC.rk23(ivp, 1e-5);","key":"wXQOZKDQC8"},{"type":"output","id":"lSMd8xBGRXfPQ49g3Hhw4","data":[{"output_type":"stream","name":"stderr","text":"\u001b[33m\u001b[1m┌ \u001b[22m\u001b[39m\u001b[33m\u001b[1mWarning: \u001b[22m\u001b[39mStepsize too small near t=0.7854087204072808\n\u001b[33m\u001b[1m└ \u001b[22m\u001b[39m\u001b[90m@ FNCFunctions ~/.julia/packages/FNCFunctions/CAkzc/src/chapter06.jl:102\u001b[39m\n"}],"key":"bvp1O3N1yK"}],"data":{},"key":"wqu1KQ0qch"},{"type":"paragraph","position":{"start":{"line":530,"column":1},"end":{"line":530,"column":1}},"children":[{"type":"text","value":"In fact, the failure of the adaptivity gives a decent idea of when the singularity occurs.","position":{"start":{"line":530,"column":1},"end":{"line":530,"column":1}},"key":"yjCPh3P7XV"}],"key":"ZLz3iieCP6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"plot(t, u;\n    legend=:none,\n    xlabel=L\"t\",  yaxis=(:log10, L\"u(t)\"), \n    title=\"Finite-time blowup\")\n\ntf = t[end]\nvline!([tf], l=:dash)\nannotate!(tf, 1e5, latexstring(@sprintf(\"t = %.6f \", tf)), :right)","key":"ZKLZKxjWCE"},{"type":"output","id":"H0xkUYrhLVJHpl0AUiocw","data":[{"output_type":"execute_result","execution_count":37,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"79dfa2cf97e3907772dff193a0db65fa","path":"/build/79dfa2cf97e3907772dff193a0db65fa.png"},"text/html":{"content_type":"text/html","hash":"c13d210a22c158a64a3786e84e7e33ff","path":"/build/c13d210a22c158a64a3786e84e7e33ff.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"606aedf7f3f514f3cc23ae27d945fa2d","path":"/build/606aedf7f3f514f3cc23ae27d945fa2d.svg"}}}],"key":"dyGPystEeL"}],"data":{},"key":"rOfalraKCM"}],"label":"demo-adapt-sing-julia","identifier":"demo-adapt-sing-julia","html_id":"demo-adapt-sing-julia","key":"acOwqu2iMK"},{"type":"heading","depth":3,"position":{"start":{"line":544,"column":1},"end":{"line":544,"column":1}},"children":[{"type":"text","value":"6.6 ","position":{"start":{"line":544,"column":1},"end":{"line":544,"column":1}},"key":"wjnHtuIJqi"},{"type":"link","identifier":"section-ivp-multistep","label":"section-ivp-multistep","kind":"narrative","position":{"start":{"line":544,"column":5},"end":{"line":544,"column":27}},"url":"/multistep","internal":true,"dataUrl":"/multistep.json","children":[{"type":"text","value":"Multistep methods","key":"abVOYbkXEx"}],"key":"diHJVVrYBD"}],"identifier":"id-6-6","label":"6.6 ","html_id":"id-6-6","implicit":true,"key":"sEw2RVBskW"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-implicit-ab4","label":"demo-implicit-ab4","kind":"proof:example","position":{"start":{"line":547,"column":1},"end":{"line":547,"column":19}},"children":[{"type":"text","value":"Example ","key":"GyeyQ3yEPg"},{"type":"text","value":"6.7.1","key":"VNUrCpjRGv"}],"template":"Example %s","enumerator":"6.7.1","resolved":true,"html_id":"demo-implicit-ab4","remote":true,"url":"/implicit","dataUrl":"/implicit.json","key":"pH33GEANBl"}],"key":"fXro5drkPd"},{"type":"paragraph","position":{"start":{"line":549,"column":1},"end":{"line":549,"column":1}},"children":[{"type":"text","value":"We study the convergence of AB4 using the ","key":"NpPizs3Dxh"},{"type":"abbreviation","title":"initial-value problem","children":[{"type":"text","value":"IVP","key":"F9HEfUPLsj"}],"key":"DQcT10aGm2"},{"type":"text","value":" ","key":"W4n5sxfEK7"},{"type":"inlineMath","value":"u'=\\sin[(u+t)^2]","position":{"start":{"line":549,"column":1},"end":{"line":549,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>u</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo>=</mo><mi>sin</mi><mo>⁡</mo><mo stretchy=\"false\">[</mo><mo stretchy=\"false\">(</mo><mi>u</mi><mo>+</mo><mi>t</mi><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">u&#x27;=\\sin[(u+t)^2]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop\">sin</span><span class=\"mopen\">[(</span><span class=\"mord mathnormal\">u</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mclose\">]</span></span></span></span>","key":"iZL9eoWu2F"},{"type":"text","value":" over ","position":{"start":{"line":549,"column":1},"end":{"line":549,"column":1}},"key":"RBtuX2Rdm0"},{"type":"inlineMath","value":"0\\le t \\le 4","position":{"start":{"line":549,"column":1},"end":{"line":549,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0</mn><mo>≤</mo><mi>t</mi><mo>≤</mo><mn>4</mn></mrow><annotation encoding=\"application/x-tex\">0\\le t \\le 4</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7804em;vertical-align:-0.136em;\"></span><span class=\"mord\">0</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7719em;vertical-align:-0.136em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">4</span></span></span></span>","key":"BS0V4VDgj3"},{"type":"text","value":", with ","position":{"start":{"line":549,"column":1},"end":{"line":549,"column":1}},"key":"AV26Gufhzi"},{"type":"inlineMath","value":"u(0)=-1","position":{"start":{"line":549,"column":1},"end":{"line":549,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo stretchy=\"false\">(</mo><mn>0</mn><mo stretchy=\"false\">)</mo><mo>=</mo><mo>−</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">u(0)=-1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">−</span><span class=\"mord\">1</span></span></span></span>","key":"uyBiSbnboK"},{"type":"text","value":". As usual, ","position":{"start":{"line":549,"column":1},"end":{"line":549,"column":1}},"key":"dY9u8yhSbs"},{"type":"inlineCode","value":"solve","position":{"start":{"line":549,"column":1},"end":{"line":549,"column":1}},"key":"YzZNhwDJid"},{"type":"text","value":" is called to give an accurate reference solution.","position":{"start":{"line":549,"column":1},"end":{"line":549,"column":1}},"key":"PUBNCk5siF"}],"key":"a5pTQDE4ux"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"using OrdinaryDiffEq\nivp = ODEProblem((u, p, t) -> sin((t + u)^2), -1.0, (0.0, 4.0))\nu_ref = solve(ivp, Tsit5(), reltol=1e-14, abstol=1e-14);","key":"g2cEVMhd1p"},{"type":"output","id":"GcU_N55Df8gAtO0p5iKBS","data":[],"key":"Sa2QUsfxN9"}],"data":{},"key":"hCJeeC1rAe"},{"type":"paragraph","position":{"start":{"line":557,"column":1},"end":{"line":557,"column":1}},"children":[{"type":"text","value":"Now we perform a convergence study of the AB4 code.","position":{"start":{"line":557,"column":1},"end":{"line":557,"column":1}},"key":"nP1JfDJEy3"}],"key":"p4HBTR9jFT"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"n = @. [round(Int, 4 * 10^k) for k in 0:0.5:3]\nerr = []\nfor n in n\n    t, u = FNC.ab4(ivp, n)\n    push!(err, norm(u_ref.(t) - u, Inf))\nend\n@pt :header=[\"n\", \"inf-norm error\"] [n err]","key":"RSPPrQnJoZ"},{"type":"output","id":"bgXgsqeIkLEJkYKS0VDWq","data":[{"output_type":"display_data","metadata":{},"data":{"text/html":{"content":"<table>\n  <thead>\n    <tr class = \"header headerLastRow\">\n      <th style = \"text-align: right;\">n</th>\n      <th style = \"text-align: right;\">inf-norm error</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td style = \"text-align: right;\">4</td>\n      <td style = \"text-align: right;\">0.50044</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">13</td>\n      <td style = \"text-align: right;\">1.39129</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">40</td>\n      <td style = \"text-align: right;\">0.00627809</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">126</td>\n      <td style = \"text-align: right;\">9.94942e-5</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">400</td>\n      <td style = \"text-align: right;\">1.09598e-6</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">1265</td>\n      <td style = \"text-align: right;\">1.12766e-8</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">4000</td>\n      <td style = \"text-align: right;\">1.13736e-10</td>\n    </tr>\n  </tbody>\n</table>\n","content_type":"text/html"}}}],"key":"C5UG14vBm2"}],"data":{},"key":"Mka6S0uPeC"},{"type":"paragraph","position":{"start":{"line":569,"column":1},"end":{"line":569,"column":1}},"children":[{"type":"text","value":"The method should converge as ","position":{"start":{"line":569,"column":1},"end":{"line":569,"column":1}},"key":"n0mWKKHv9s"},{"type":"inlineMath","value":"O(h^4)","position":{"start":{"line":569,"column":1},"end":{"line":569,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><msup><mi>h</mi><mn>4</mn></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(h^4)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">h</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">4</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"hove4UgbzK"},{"type":"text","value":", so a log-log scale is appropriate for the errors.","position":{"start":{"line":569,"column":1},"end":{"line":569,"column":1}},"key":"mDRaqlce5I"}],"key":"Ve2uPz73bV"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"using Plots\nplot(n, err, m=3, \n    label=\"AB4\",  legend=:bottomleft,\n    xaxis=(:log10, L\"n\"),  yaxis=(:log10, \"inf-norm error\"),\n    title=\"Convergence of AB4\")\n\nplot!(n, 0.1 * err[end] * (n / n[end]) .^ (-4), l=:dash, label=L\"O(n^{-4})\")","key":"ZuP0XcLA3v"},{"type":"output","id":"fv5xmmwGeVveJnaNljzRm","data":[{"output_type":"execute_result","execution_count":40,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"1a6608e91439812f15001c4d38acc94a","path":"/build/1a6608e91439812f15001c4d38acc94a.png"},"text/html":{"content":"<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" width=\"500\" height=\"320\" viewBox=\"0 0 2000 1280\">\n<defs>\n  <clipPath id=\"clip110\">\n    <rect x=\"0\" y=\"0\" width=\"2000\" height=\"1280\"/>\n  </clipPath>\n</defs>\n<path clip-path=\"url(#clip110)\" d=\"M0 1280 L2000 1280 L2000 -2.66454e-14 L0 -2.66454e-14  Z\" fill=\"#ffffff\" fill-rule=\"evenodd\" fill-opacity=\"1\"/>\n<defs>\n  <clipPath id=\"clip111\">\n    <rect x=\"400\" y=\"0\" width=\"1401\" height=\"1280\"/>\n  </clipPath>\n</defs>\n<path clip-path=\"url(#clip110)\" d=\"M269.619 1099.23 L1952.76 1099.23 L1952.76 107.256 L269.619 107.256  Z\" fill=\"#ffffff\" fill-rule=\"evenodd\" fill-opacity=\"1\"/>\n<defs>\n  <clipPath id=\"clip112\">\n    <rect x=\"269\" y=\"107\" width=\"1684\" height=\"993\"/>\n  </clipPath>\n</defs>\n<polyline clip-path=\"url(#clip112)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"527.88,1099.23 527.88,107.256 \"/>\n<polyline clip-path=\"url(#clip112)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"1057.17,1099.23 1057.17,107.256 \"/>\n<polyline clip-path=\"url(#clip112)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"1586.46,1099.23 1586.46,107.256 \"/>\n<polyline clip-path=\"url(#clip112)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"269.619,997.526 1952.76,997.526 \"/>\n<polyline clip-path=\"url(#clip112)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"269.619,607.601 1952.76,607.601 \"/>\n<polyline clip-path=\"url(#clip112)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"269.619,217.675 1952.76,217.675 \"/>\n<polyline clip-path=\"url(#clip110)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"269.619,1099.23 1952.76,1099.23 \"/>\n<polyline clip-path=\"url(#clip110)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"527.88,1099.23 527.88,1080.33 \"/>\n<polyline clip-path=\"url(#clip110)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"1057.17,1099.23 1057.17,1080.33 \"/>\n<polyline clip-path=\"url(#clip110)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"1586.46,1099.23 1586.46,1080.33 \"/>\n<path clip-path=\"url(#clip110)\" d=\"M494.208 1170.15 L501.847 1170.15 L501.847 1143.79 L493.536 1145.45 L493.536 1141.19 L501.8 1139.53 L506.476 1139.53 L506.476 1170.15 L514.115 1170.15 L514.115 1174.09 L494.208 1174.09 L494.208 1170.15 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip110)\" d=\"M533.559 1142.61 Q529.948 1142.61 528.12 1146.17 Q526.314 1149.71 526.314 1156.84 Q526.314 1163.95 528.12 1167.51 Q529.948 1171.05 533.559 1171.05 Q537.194 1171.05 538.999 1167.51 Q540.828 1163.95 540.828 1156.84 Q540.828 1149.71 538.999 1146.17 Q537.194 1142.61 533.559 1142.61 M533.559 1138.9 Q539.37 1138.9 542.425 1143.51 Q545.504 1148.09 545.504 1156.84 Q545.504 1165.57 542.425 1170.17 Q539.37 1174.76 533.559 1174.76 Q527.749 1174.76 524.671 1170.17 Q521.615 1165.57 521.615 1156.84 Q521.615 1148.09 524.671 1143.51 Q527.749 1138.9 533.559 1138.9 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip110)\" d=\"M546.049 1143.48 L552.256 1143.48 L552.256 1122.06 L545.504 1123.41 L545.504 1119.95 L552.218 1118.6 L556.017 1118.6 L556.017 1143.48 L562.224 1143.48 L562.224 1146.68 L546.049 1146.68 L546.049 1143.48 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip110)\" d=\"M1022.94 1170.15 L1030.58 1170.15 L1030.58 1143.79 L1022.27 1145.45 L1022.27 1141.19 L1030.53 1139.53 L1035.21 1139.53 L1035.21 1170.15 L1042.85 1170.15 L1042.85 1174.09 L1022.94 1174.09 L1022.94 1170.15 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip110)\" d=\"M1062.29 1142.61 Q1058.68 1142.61 1056.85 1146.17 Q1055.05 1149.71 1055.05 1156.84 Q1055.05 1163.95 1056.85 1167.51 Q1058.68 1171.05 1062.29 1171.05 Q1065.93 1171.05 1067.73 1167.51 Q1069.56 1163.95 1069.56 1156.84 Q1069.56 1149.71 1067.73 1146.17 Q1065.93 1142.61 1062.29 1142.61 M1062.29 1138.9 Q1068.1 1138.9 1071.16 1143.51 Q1074.24 1148.09 1074.24 1156.84 Q1074.24 1165.57 1071.16 1170.17 Q1068.1 1174.76 1062.29 1174.76 Q1056.48 1174.76 1053.4 1170.17 Q1050.35 1165.57 1050.35 1156.84 Q1050.35 1148.09 1053.4 1143.51 Q1056.48 1138.9 1062.29 1138.9 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip110)\" d=\"M1078.81 1143.48 L1092.07 1143.48 L1092.07 1146.68 L1074.24 1146.68 L1074.24 1143.48 Q1076.4 1141.24 1080.12 1137.48 Q1083.87 1133.7 1084.83 1132.61 Q1086.65 1130.56 1087.37 1129.15 Q1088.1 1127.72 1088.1 1126.35 Q1088.1 1124.11 1086.52 1122.7 Q1084.96 1121.29 1082.44 1121.29 Q1080.65 1121.29 1078.66 1121.91 Q1076.68 1122.53 1074.43 1123.79 L1074.43 1119.95 Q1076.72 1119.03 1078.71 1118.56 Q1080.71 1118.09 1082.36 1118.09 Q1086.73 1118.09 1089.32 1120.27 Q1091.92 1122.45 1091.92 1126.1 Q1091.92 1127.83 1091.26 1129.39 Q1090.62 1130.93 1088.91 1133.04 Q1088.44 1133.59 1085.92 1136.2 Q1083.4 1138.8 1078.81 1143.48 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip110)\" d=\"M1551.9 1170.15 L1559.54 1170.15 L1559.54 1143.79 L1551.23 1145.45 L1551.23 1141.19 L1559.49 1139.53 L1564.17 1139.53 L1564.17 1170.15 L1571.81 1170.15 L1571.81 1174.09 L1551.9 1174.09 L1551.9 1170.15 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip110)\" d=\"M1591.25 1142.61 Q1587.64 1142.61 1585.81 1146.17 Q1584.01 1149.71 1584.01 1156.84 Q1584.01 1163.95 1585.81 1167.51 Q1587.64 1171.05 1591.25 1171.05 Q1594.89 1171.05 1596.69 1167.51 Q1598.52 1163.95 1598.52 1156.84 Q1598.52 1149.71 1596.69 1146.17 Q1594.89 1142.61 1591.25 1142.61 M1591.25 1138.9 Q1597.06 1138.9 1600.12 1143.51 Q1603.2 1148.09 1603.2 1156.84 Q1603.2 1165.57 1600.12 1170.17 Q1597.06 1174.76 1591.25 1174.76 Q1585.44 1174.76 1582.36 1170.17 Q1579.31 1165.57 1579.31 1156.84 Q1579.31 1148.09 1582.36 1143.51 Q1585.44 1138.9 1591.25 1138.9 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip110)\" d=\"M1615.89 1131.54 Q1618.62 1132.12 1620.14 1133.96 Q1621.68 1135.81 1621.68 1138.51 Q1621.68 1142.67 1618.83 1144.95 Q1615.97 1147.22 1610.7 1147.22 Q1608.93 1147.22 1607.05 1146.86 Q1605.19 1146.53 1603.2 1145.83 L1603.2 1142.16 Q1604.78 1143.08 1606.66 1143.55 Q1608.54 1144.02 1610.59 1144.02 Q1614.16 1144.02 1616.02 1142.61 Q1617.9 1141.2 1617.9 1138.51 Q1617.9 1136.03 1616.15 1134.64 Q1614.42 1133.23 1611.32 1133.23 L1608.05 1133.23 L1608.05 1130.11 L1611.47 1130.11 Q1614.27 1130.11 1615.76 1129 Q1617.25 1127.87 1617.25 1125.76 Q1617.25 1123.6 1615.7 1122.45 Q1614.18 1121.29 1611.32 1121.29 Q1609.76 1121.29 1607.97 1121.62 Q1606.19 1121.96 1604.04 1122.68 L1604.04 1119.29 Q1606.21 1118.69 1608.09 1118.39 Q1609.99 1118.09 1611.66 1118.09 Q1615.99 1118.09 1618.51 1120.06 Q1621.03 1122.02 1621.03 1125.37 Q1621.03 1127.7 1619.69 1129.32 Q1618.36 1130.92 1615.89 1131.54 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><g clip-path=\"url(#clip110)\">\n<image width=\"36\" height=\"30\" xlink:href=\"data:image/png;base64,\niVBORw0KGgoAAAANSUhEUgAAACQAAAAeCAYAAABE4bxTAAABuUlEQVRYhbVYW4GEMAyMBDRUAhoq\nAQ1IQAMS0FAJaEACGmph7uOue21I+trykR+aHSaZSVuWABAP7z2stSAiGGPgnIOUp8W2bZjnGUSE\naZpgrcV5nlUY8kMi8Ni2rQh4nufjd3Gs61rEUMlc1wUAtCxLAiqBXNeV5BzH8cnz3sMYk6zf960S\nE8nkOmatTdZjaXKVBwvkCksIhXZLWvMKw/NpmkBE1R6LMbQCit2JuxDCOfcxrfe+2vDcU0VCmulC\nJ3gEnw0ntO97XtfOiSnhSAUV5dIItZKRcKRp+yQaY8SX8JFu9U2zZN57dbogGLq3O1JhqodyYzvC\nO8BzHypOWS2hUXIty9JOSDqbesi0FJYFGeWfsK00HR1v+ofjaBPdTGiUf6pP+zf80yJXltAo/3CM\neZ77CHGgmhvjt7I75971z7qu1V0+juM3R2X6glzaZpjkSov8hthDKJyR1Wb+I1xVWc/+wz8OcoSC\ntNBMPcI//JaZGwqi/zv2a/7hsmtFxd0RCY3wD/DcEHM+iy1RlKt3/+FYGhn+OVQk1EsGSI+f8OL4\nfwMJPytZ7+kex33fDwsQEfZ9F7F/AEI9aqd2YHXbAAAAAElFTkSuQmCC\n\" transform=\"translate(1093, 1212)\"/>\n</g>\n<polyline clip-path=\"url(#clip110)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"269.619,1099.23 269.619,107.256 \"/>\n<polyline clip-path=\"url(#clip110)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"269.619,997.526 288.517,997.526 \"/>\n<polyline clip-path=\"url(#clip110)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"269.619,607.601 288.517,607.601 \"/>\n<polyline clip-path=\"url(#clip110)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"269.619,217.675 288.517,217.675 \"/>\n<path clip-path=\"url(#clip110)\" d=\"M113.675 1017.32 L121.314 1017.32 L121.314 990.953 L113.004 992.62 L113.004 988.36 L121.268 986.694 L125.944 986.694 L125.944 1017.32 L133.583 1017.32 L133.583 1021.25 L113.675 1021.25 L113.675 1017.32 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip110)\" d=\"M153.027 989.772 Q149.416 989.772 147.587 993.337 Q145.782 996.879 145.782 1004.01 Q145.782 1011.11 147.587 1014.68 Q149.416 1018.22 153.027 1018.22 Q156.661 1018.22 158.467 1014.68 Q160.295 1011.11 160.295 1004.01 Q160.295 996.879 158.467 993.337 Q156.661 989.772 153.027 989.772 M153.027 986.069 Q158.837 986.069 161.893 990.675 Q164.971 995.259 164.971 1004.01 Q164.971 1012.74 161.893 1017.34 Q158.837 1021.93 153.027 1021.93 Q147.217 1021.93 144.138 1017.34 Q141.082 1012.74 141.082 1004.01 Q141.082 995.259 144.138 990.675 Q147.217 986.069 153.027 986.069 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip110)\" d=\"M164.971 980.17 L189.083 980.17 L189.083 983.367 L164.971 983.367 L164.971 980.17 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip110)\" d=\"M197.941 990.646 L204.148 990.646 L204.148 969.224 L197.396 970.578 L197.396 967.118 L204.11 965.763 L207.909 965.763 L207.909 990.646 L214.116 990.646 L214.116 993.843 L197.941 993.843 L197.941 990.646 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip110)\" d=\"M229.914 968.265 Q226.98 968.265 225.495 971.161 Q224.028 974.039 224.028 979.832 Q224.028 985.606 225.495 988.502 Q226.98 991.38 229.914 991.38 Q232.867 991.38 234.334 988.502 Q235.82 985.606 235.82 979.832 Q235.82 974.039 234.334 971.161 Q232.867 968.265 229.914 968.265 M229.914 965.256 Q234.635 965.256 237.118 968.998 Q239.619 972.722 239.619 979.832 Q239.619 986.922 237.118 990.665 Q234.635 994.389 229.914 994.389 Q225.194 994.389 222.692 990.665 Q220.21 986.922 220.21 979.832 Q220.21 972.722 222.692 968.998 Q225.194 965.256 229.914 965.256 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip110)\" d=\"M138.99 627.393 L146.629 627.393 L146.629 601.027 L138.319 602.694 L138.319 598.435 L146.583 596.768 L151.259 596.768 L151.259 627.393 L158.898 627.393 L158.898 631.328 L138.99 631.328 L138.99 627.393 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip110)\" d=\"M178.342 599.847 Q174.731 599.847 172.902 603.412 Q171.097 606.953 171.097 614.083 Q171.097 621.189 172.902 624.754 Q174.731 628.296 178.342 628.296 Q181.976 628.296 183.782 624.754 Q185.611 621.189 185.611 614.083 Q185.611 606.953 183.782 603.412 Q181.976 599.847 178.342 599.847 M178.342 596.143 Q184.152 596.143 187.208 600.75 Q190.286 605.333 190.286 614.083 Q190.286 622.81 187.208 627.416 Q184.152 631.999 178.342 631.999 Q172.532 631.999 169.453 627.416 Q166.398 622.81 166.398 614.083 Q166.398 605.333 169.453 600.75 Q172.532 596.143 178.342 596.143 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip110)\" d=\"M190.286 590.245 L214.398 590.245 L214.398 593.442 L190.286 593.442 L190.286 590.245 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip110)\" d=\"M222.636 575.838 L237.55 575.838 L237.55 579.035 L226.115 579.035 L226.115 585.919 Q226.943 585.637 227.77 585.505 Q228.598 585.355 229.425 585.355 Q234.127 585.355 236.873 587.931 Q239.619 590.508 239.619 594.909 Q239.619 599.442 236.798 601.962 Q233.977 604.463 228.842 604.463 Q227.074 604.463 225.231 604.162 Q223.407 603.861 221.451 603.26 L221.451 599.442 Q223.144 600.363 224.949 600.815 Q226.755 601.266 228.767 601.266 Q232.021 601.266 233.921 599.554 Q235.82 597.843 235.82 594.909 Q235.82 591.975 233.921 590.263 Q232.021 588.552 228.767 588.552 Q227.244 588.552 225.72 588.89 Q224.216 589.229 222.636 589.944 L222.636 575.838 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip110)\" d=\"M168.914 237.467 L176.552 237.467 L176.552 211.102 L168.242 212.768 L168.242 208.509 L176.506 206.843 L181.182 206.843 L181.182 237.467 L188.821 237.467 L188.821 241.403 L168.914 241.403 L168.914 237.467 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip110)\" d=\"M208.265 209.921 Q204.654 209.921 202.825 213.486 Q201.02 217.028 201.02 224.157 Q201.02 231.264 202.825 234.829 Q204.654 238.37 208.265 238.37 Q211.9 238.37 213.705 234.829 Q215.534 231.264 215.534 224.157 Q215.534 217.028 213.705 213.486 Q211.9 209.921 208.265 209.921 M208.265 206.218 Q214.075 206.218 217.131 210.824 Q220.21 215.407 220.21 224.157 Q220.21 232.884 217.131 237.491 Q214.075 242.074 208.265 242.074 Q202.455 242.074 199.376 237.491 Q196.321 232.884 196.321 224.157 Q196.321 215.407 199.376 210.824 Q202.455 206.218 208.265 206.218 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip110)\" d=\"M229.914 188.414 Q226.98 188.414 225.495 191.31 Q224.028 194.188 224.028 199.98 Q224.028 205.754 225.495 208.651 Q226.98 211.528 229.914 211.528 Q232.867 211.528 234.334 208.651 Q235.82 205.754 235.82 199.98 Q235.82 194.188 234.334 191.31 Q232.867 188.414 229.914 188.414 M229.914 185.404 Q234.635 185.404 237.118 189.147 Q239.619 192.871 239.619 199.98 Q239.619 207.071 237.118 210.814 Q234.635 214.538 229.914 214.538 Q225.194 214.538 222.692 210.814 Q220.21 207.071 220.21 199.98 Q220.21 192.871 222.692 189.147 Q225.194 185.404 229.914 185.404 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><g clip-path=\"url(#clip110)\">\n<text style=\"fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:66px; text-anchor:middle;\" transform=\"rotate(-90, 71.4418, 603.241)\" x=\"71.4418\" y=\"603.241\">inf-norm error</text>\n</g>\n<g clip-path=\"url(#clip110)\">\n<text style=\"fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:66px; text-anchor:middle;\" transform=\"rotate(0, 1111.19, 57.6)\" x=\"1111.19\" y=\"57.6\">Convergence of AB4</text>\n</g>\n<polyline clip-path=\"url(#clip112)\" style=\"stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none\" points=\"317.255,241.121 588.189,206.49 846.543,389.412 1110.29,529.787 1375.83,682.482 1640.49,837.487 1905.12,993.167 \"/>\n<circle clip-path=\"url(#clip112)\" cx=\"317.255\" cy=\"241.121\" r=\"10.8\" fill=\"#009af9\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"#000000\" stroke-opacity=\"1\" stroke-width=\"2.56\"/>\n<circle clip-path=\"url(#clip112)\" cx=\"588.189\" cy=\"206.49\" r=\"10.8\" fill=\"#009af9\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"#000000\" stroke-opacity=\"1\" stroke-width=\"2.56\"/>\n<circle clip-path=\"url(#clip112)\" cx=\"846.543\" cy=\"389.412\" r=\"10.8\" fill=\"#009af9\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"#000000\" stroke-opacity=\"1\" stroke-width=\"2.56\"/>\n<circle clip-path=\"url(#clip112)\" cx=\"1110.29\" cy=\"529.787\" r=\"10.8\" fill=\"#009af9\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"#000000\" stroke-opacity=\"1\" stroke-width=\"2.56\"/>\n<circle clip-path=\"url(#clip112)\" cx=\"1375.83\" cy=\"682.482\" r=\"10.8\" fill=\"#009af9\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"#000000\" stroke-opacity=\"1\" stroke-width=\"2.56\"/>\n<circle clip-path=\"url(#clip112)\" cx=\"1640.49\" cy=\"837.487\" r=\"10.8\" fill=\"#009af9\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"#000000\" stroke-opacity=\"1\" stroke-width=\"2.56\"/>\n<circle clip-path=\"url(#clip112)\" cx=\"1905.12\" cy=\"993.167\" r=\"10.8\" fill=\"#009af9\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"#000000\" stroke-opacity=\"1\" stroke-width=\"2.56\"/>\n<polyline clip-path=\"url(#clip112)\" style=\"stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none\" stroke-dasharray=\"32, 20\" points=\"317.255,135.331 588.189,295.008 846.543,447.271 1110.29,602.714 1375.83,759.211 1640.49,915.191 1905.12,1071.15 \"/>\n<path clip-path=\"url(#clip110)\" d=\"M325.724 1066.16 L648.862 1066.16 L648.862 910.641 L325.724 910.641  Z\" fill=\"#ffffff\" fill-rule=\"evenodd\" fill-opacity=\"1\"/>\n<polyline clip-path=\"url(#clip110)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"325.724,1066.16 648.862,1066.16 648.862,910.641 325.724,910.641 325.724,1066.16 \"/>\n<polyline clip-path=\"url(#clip110)\" style=\"stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none\" points=\"344.425,962.481 456.634,962.481 \"/>\n<circle clip-path=\"url(#clip110)\" cx=\"400.53\" cy=\"962.481\" r=\"15.5846\" fill=\"#009af9\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"#000000\" stroke-opacity=\"1\" stroke-width=\"4.68114\"/>\n<path clip-path=\"url(#clip110)\" d=\"M491.169 949.807 L484.827 967.006 L497.535 967.006 L491.169 949.807 M488.53 945.201 L493.831 945.201 L507.002 979.761 L502.141 979.761 L498.993 970.895 L483.415 970.895 L480.266 979.761 L475.336 979.761 L488.53 945.201 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip110)\" d=\"M516.725 963.256 L516.725 975.918 L524.225 975.918 Q527.998 975.918 529.803 974.367 Q531.632 972.793 531.632 969.576 Q531.632 966.335 529.803 964.807 Q527.998 963.256 524.225 963.256 L516.725 963.256 M516.725 949.043 L516.725 959.46 L523.646 959.46 Q527.072 959.46 528.738 958.187 Q530.428 956.891 530.428 954.252 Q530.428 951.636 528.738 950.34 Q527.072 949.043 523.646 949.043 L516.725 949.043 M512.049 945.201 L523.993 945.201 Q529.34 945.201 532.234 947.423 Q535.127 949.645 535.127 953.743 Q535.127 956.914 533.646 958.789 Q532.164 960.664 529.294 961.127 Q532.743 961.868 534.641 964.229 Q536.562 966.567 536.562 970.085 Q536.562 974.715 533.414 977.238 Q530.266 979.761 524.456 979.761 L512.049 979.761 L512.049 945.201 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip110)\" d=\"M557.836 949.275 L546.03 967.724 L557.836 967.724 L557.836 949.275 M556.609 945.201 L562.488 945.201 L562.488 967.724 L567.419 967.724 L567.419 971.613 L562.488 971.613 L562.488 979.761 L557.836 979.761 L557.836 971.613 L542.234 971.613 L542.234 967.099 L556.609 945.201 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><polyline clip-path=\"url(#clip110)\" style=\"stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none\" stroke-dasharray=\"32, 20\" points=\"344.425,1014.32 456.634,1014.32 \"/>\n<path clip-path=\"url(#clip110)\" d=\"M508.502 1005.84 Q508.502 1009.19 507.308 1012.52 Q506.136 1015.82 504.075 1018.54 Q502.014 1021.26 499.391 1023.36 Q496.768 1025.47 493.699 1026.64 Q490.631 1027.81 487.633 1027.81 Q482.316 1027.81 478.826 1024.33 Q475.336 1020.84 475.336 1015 Q475.336 1010.93 477.163 1006.88 Q478.99 1002.8 481.894 999.778 Q484.799 996.733 488.616 994.836 Q492.458 992.939 496.252 992.939 Q501.639 992.939 505.059 996.523 Q508.502 1000.08 508.502 1005.84 M504.216 1003.97 Q504.216 1001.39 503.49 999.45 Q502.764 997.483 501.546 996.359 Q500.351 995.234 498.922 994.696 Q497.517 994.133 495.971 994.133 Q492.973 994.133 489.764 996.078 Q486.555 998.022 484.166 1001.63 Q482.878 1003.6 481.941 1005.96 Q481.004 1008.3 480.583 1010.39 Q480.161 1012.45 479.974 1013.9 Q479.81 1015.35 479.81 1016.36 Q479.81 1021.05 482.058 1023.81 Q484.307 1026.57 487.914 1026.57 Q490.748 1026.57 493.512 1024.91 Q496.276 1023.22 498.173 1020.81 Q499.859 1018.73 501.101 1016.22 Q502.365 1013.71 502.998 1011.42 Q503.63 1009.12 503.911 1007.27 Q504.216 1005.42 504.216 1003.97 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip110)\" d=\"M514.838 1014.77 Q514.838 1006.66 517.859 1000.13 Q519.148 997.389 520.951 995.094 Q522.755 992.798 523.949 991.791 Q525.144 990.784 525.472 990.784 Q525.94 990.784 525.964 991.253 Q525.964 991.487 525.331 992.072 Q517.602 999.942 517.625 1014.77 Q517.625 1029.64 525.144 1037.21 Q525.964 1038.03 525.964 1038.28 Q525.964 1038.75 525.472 1038.75 Q525.144 1038.75 523.996 1037.79 Q522.848 1036.83 521.068 1034.63 Q519.288 1032.43 518 1029.74 Q514.838 1023.2 514.838 1014.77 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip110)\" d=\"M559.257 1019.9 Q559.257 1020.09 559.047 1020.81 Q558.836 1021.54 558.321 1022.66 Q557.829 1023.79 557.149 1024.82 Q556.47 1025.82 555.346 1026.57 Q554.245 1027.3 552.98 1027.3 Q551.294 1027.3 550.17 1026.18 Q549.045 1025.05 549.045 1023.36 Q549.045 1022.43 549.537 1021.14 Q552.652 1012.82 552.652 1009.97 Q552.652 1006.62 550.052 1006.62 Q548.764 1006.62 547.546 1007.11 Q546.352 1007.58 545.532 1008.23 Q544.712 1008.89 543.963 1009.8 Q543.236 1010.69 542.862 1011.3 Q542.51 1011.89 542.229 1012.47 L541.62 1014.86 Q541.48 1015.52 540.801 1018.07 L539.747 1022.4 Q538.997 1025.64 538.833 1025.94 Q538.599 1026.6 538.084 1026.95 Q537.568 1027.3 537.053 1027.3 Q536.467 1027.3 536.069 1026.95 Q535.671 1026.6 535.671 1025.99 Q535.671 1025.89 535.741 1025.54 Q535.812 1025.19 535.929 1024.7 Q536.046 1024.21 536.093 1023.93 L538.88 1012.85 Q539.395 1010.83 539.512 1010.2 Q539.653 1009.55 539.653 1008.82 Q539.653 1006.62 538.154 1006.62 Q536.936 1006.62 536.139 1008.07 Q535.343 1009.52 534.664 1012.33 Q534.453 1013.11 534.313 1013.27 Q534.195 1013.43 533.844 1013.43 Q533.258 1013.41 533.258 1012.94 Q533.258 1012.82 533.446 1012.05 Q533.633 1011.28 533.985 1010.18 Q534.359 1009.05 534.711 1008.3 Q535.015 1007.74 535.179 1007.48 Q535.367 1007.2 535.812 1006.66 Q536.28 1006.1 536.889 1005.84 Q537.521 1005.56 538.294 1005.56 Q540.028 1005.56 541.292 1006.69 Q542.557 1007.79 542.721 1009.73 Q545.836 1005.56 550.193 1005.56 Q552.769 1005.56 554.245 1006.92 Q555.721 1008.28 555.721 1010.69 Q555.721 1011.26 555.604 1011.98 Q555.51 1012.68 555.276 1013.57 Q555.065 1014.46 554.877 1015.14 Q554.69 1015.82 554.315 1016.92 Q553.941 1018 553.777 1018.47 Q553.613 1018.94 553.214 1020.04 Q552.84 1021.12 552.793 1021.23 Q551.926 1023.41 551.926 1024.65 Q551.926 1025.47 552.184 1025.85 Q552.465 1026.22 553.074 1026.22 Q554.713 1026.22 555.931 1024.61 Q557.173 1022.97 557.969 1020.3 Q558.157 1019.71 558.25 1019.57 Q558.367 1019.43 558.695 1019.43 Q559.257 1019.43 559.257 1019.9 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip110)\" d=\"M586.288 1003.66 Q586.484 1003.85 586.484 1004.13 Q586.484 1004.41 586.288 1004.61 Q586.091 1004.81 585.812 1004.81 L564.793 1004.81 Q564.514 1004.81 564.317 1004.61 Q564.121 1004.41 564.121 1004.13 Q564.121 1003.85 564.317 1003.66 Q564.514 1003.46 564.793 1003.46 L585.812 1003.46 Q586.091 1003.46 586.288 1003.66 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip110)\" d=\"M589.991 1006.99 L589.991 1005.95 L600.304 990.197 Q600.566 989.787 600.976 989.804 Q601.353 989.804 601.435 989.951 Q601.517 990.099 601.517 990.673 L601.517 1005.95 L604.878 1005.95 L604.878 1006.99 L601.517 1006.99 L601.517 1009.9 Q601.517 1010.87 601.91 1011.18 Q602.32 1011.5 604.058 1011.5 L604.763 1011.5 L604.763 1012.53 Q603.386 1012.43 600.205 1012.43 Q597.041 1012.43 595.664 1012.53 L595.664 1011.5 L596.369 1011.5 Q598.107 1011.5 598.516 1011.2 Q598.926 1010.89 598.926 1009.9 L598.926 1006.99 L589.991 1006.99 M590.942 1005.95 L599.123 1005.95 L599.123 993.427 L590.942 1005.95 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip110)\" d=\"M611.74 1038.28 Q611.74 1038.05 612.349 1037.47 Q620.079 1029.6 620.079 1014.77 Q620.079 999.895 612.654 992.377 Q611.74 991.51 611.74 991.253 Q611.74 990.784 612.209 990.784 Q612.537 990.784 613.684 991.744 Q614.855 992.705 616.612 994.906 Q618.392 997.108 619.704 999.802 Q622.866 1006.34 622.866 1014.77 Q622.866 1022.87 619.844 1029.41 Q618.556 1032.15 616.753 1034.44 Q614.949 1036.74 613.755 1037.75 Q612.56 1038.75 612.209 1038.75 Q611.74 1038.75 611.74 1038.28 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /></svg>\n","content_type":"text/html"},"image/svg+xml":{"content":"<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" width=\"500\" height=\"320\" viewBox=\"0 0 2000 1280\">\n<defs>\n  <clipPath id=\"clip060\">\n    <rect x=\"0\" y=\"0\" width=\"2000\" height=\"1280\"/>\n  </clipPath>\n</defs>\n<path clip-path=\"url(#clip060)\" d=\"M0 1280 L2000 1280 L2000 -2.66454e-14 L0 -2.66454e-14  Z\" fill=\"#ffffff\" fill-rule=\"evenodd\" fill-opacity=\"1\"/>\n<defs>\n  <clipPath id=\"clip061\">\n    <rect x=\"400\" y=\"0\" width=\"1401\" height=\"1280\"/>\n  </clipPath>\n</defs>\n<path clip-path=\"url(#clip060)\" d=\"M269.619 1099.23 L1952.76 1099.23 L1952.76 107.256 L269.619 107.256  Z\" fill=\"#ffffff\" fill-rule=\"evenodd\" fill-opacity=\"1\"/>\n<defs>\n  <clipPath id=\"clip062\">\n    <rect x=\"269\" y=\"107\" width=\"1684\" height=\"993\"/>\n  </clipPath>\n</defs>\n<polyline clip-path=\"url(#clip062)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"527.88,1099.23 527.88,107.256 \"/>\n<polyline clip-path=\"url(#clip062)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"1057.17,1099.23 1057.17,107.256 \"/>\n<polyline clip-path=\"url(#clip062)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"1586.46,1099.23 1586.46,107.256 \"/>\n<polyline clip-path=\"url(#clip062)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"269.619,997.526 1952.76,997.526 \"/>\n<polyline clip-path=\"url(#clip062)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"269.619,607.601 1952.76,607.601 \"/>\n<polyline clip-path=\"url(#clip062)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"269.619,217.675 1952.76,217.675 \"/>\n<polyline clip-path=\"url(#clip060)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"269.619,1099.23 1952.76,1099.23 \"/>\n<polyline clip-path=\"url(#clip060)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"527.88,1099.23 527.88,1080.33 \"/>\n<polyline clip-path=\"url(#clip060)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"1057.17,1099.23 1057.17,1080.33 \"/>\n<polyline clip-path=\"url(#clip060)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"1586.46,1099.23 1586.46,1080.33 \"/>\n<path clip-path=\"url(#clip060)\" d=\"M494.208 1170.15 L501.847 1170.15 L501.847 1143.79 L493.536 1145.45 L493.536 1141.19 L501.8 1139.53 L506.476 1139.53 L506.476 1170.15 L514.115 1170.15 L514.115 1174.09 L494.208 1174.09 L494.208 1170.15 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip060)\" d=\"M533.559 1142.61 Q529.948 1142.61 528.12 1146.17 Q526.314 1149.71 526.314 1156.84 Q526.314 1163.95 528.12 1167.51 Q529.948 1171.05 533.559 1171.05 Q537.194 1171.05 538.999 1167.51 Q540.828 1163.95 540.828 1156.84 Q540.828 1149.71 538.999 1146.17 Q537.194 1142.61 533.559 1142.61 M533.559 1138.9 Q539.37 1138.9 542.425 1143.51 Q545.504 1148.09 545.504 1156.84 Q545.504 1165.57 542.425 1170.17 Q539.37 1174.76 533.559 1174.76 Q527.749 1174.76 524.671 1170.17 Q521.615 1165.57 521.615 1156.84 Q521.615 1148.09 524.671 1143.51 Q527.749 1138.9 533.559 1138.9 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip060)\" d=\"M546.049 1143.48 L552.256 1143.48 L552.256 1122.06 L545.504 1123.41 L545.504 1119.95 L552.218 1118.6 L556.017 1118.6 L556.017 1143.48 L562.224 1143.48 L562.224 1146.68 L546.049 1146.68 L546.049 1143.48 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip060)\" d=\"M1022.94 1170.15 L1030.58 1170.15 L1030.58 1143.79 L1022.27 1145.45 L1022.27 1141.19 L1030.53 1139.53 L1035.21 1139.53 L1035.21 1170.15 L1042.85 1170.15 L1042.85 1174.09 L1022.94 1174.09 L1022.94 1170.15 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip060)\" d=\"M1062.29 1142.61 Q1058.68 1142.61 1056.85 1146.17 Q1055.05 1149.71 1055.05 1156.84 Q1055.05 1163.95 1056.85 1167.51 Q1058.68 1171.05 1062.29 1171.05 Q1065.93 1171.05 1067.73 1167.51 Q1069.56 1163.95 1069.56 1156.84 Q1069.56 1149.71 1067.73 1146.17 Q1065.93 1142.61 1062.29 1142.61 M1062.29 1138.9 Q1068.1 1138.9 1071.16 1143.51 Q1074.24 1148.09 1074.24 1156.84 Q1074.24 1165.57 1071.16 1170.17 Q1068.1 1174.76 1062.29 1174.76 Q1056.48 1174.76 1053.4 1170.17 Q1050.35 1165.57 1050.35 1156.84 Q1050.35 1148.09 1053.4 1143.51 Q1056.48 1138.9 1062.29 1138.9 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip060)\" d=\"M1078.81 1143.48 L1092.07 1143.48 L1092.07 1146.68 L1074.24 1146.68 L1074.24 1143.48 Q1076.4 1141.24 1080.12 1137.48 Q1083.87 1133.7 1084.83 1132.61 Q1086.65 1130.56 1087.37 1129.15 Q1088.1 1127.72 1088.1 1126.35 Q1088.1 1124.11 1086.52 1122.7 Q1084.96 1121.29 1082.44 1121.29 Q1080.65 1121.29 1078.66 1121.91 Q1076.68 1122.53 1074.43 1123.79 L1074.43 1119.95 Q1076.72 1119.03 1078.71 1118.56 Q1080.71 1118.09 1082.36 1118.09 Q1086.73 1118.09 1089.32 1120.27 Q1091.92 1122.45 1091.92 1126.1 Q1091.92 1127.83 1091.26 1129.39 Q1090.62 1130.93 1088.91 1133.04 Q1088.44 1133.59 1085.92 1136.2 Q1083.4 1138.8 1078.81 1143.48 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip060)\" d=\"M1551.9 1170.15 L1559.54 1170.15 L1559.54 1143.79 L1551.23 1145.45 L1551.23 1141.19 L1559.49 1139.53 L1564.17 1139.53 L1564.17 1170.15 L1571.81 1170.15 L1571.81 1174.09 L1551.9 1174.09 L1551.9 1170.15 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip060)\" d=\"M1591.25 1142.61 Q1587.64 1142.61 1585.81 1146.17 Q1584.01 1149.71 1584.01 1156.84 Q1584.01 1163.95 1585.81 1167.51 Q1587.64 1171.05 1591.25 1171.05 Q1594.89 1171.05 1596.69 1167.51 Q1598.52 1163.95 1598.52 1156.84 Q1598.52 1149.71 1596.69 1146.17 Q1594.89 1142.61 1591.25 1142.61 M1591.25 1138.9 Q1597.06 1138.9 1600.12 1143.51 Q1603.2 1148.09 1603.2 1156.84 Q1603.2 1165.57 1600.12 1170.17 Q1597.06 1174.76 1591.25 1174.76 Q1585.44 1174.76 1582.36 1170.17 Q1579.31 1165.57 1579.31 1156.84 Q1579.31 1148.09 1582.36 1143.51 Q1585.44 1138.9 1591.25 1138.9 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip060)\" d=\"M1615.89 1131.54 Q1618.62 1132.12 1620.14 1133.96 Q1621.68 1135.81 1621.68 1138.51 Q1621.68 1142.67 1618.83 1144.95 Q1615.97 1147.22 1610.7 1147.22 Q1608.93 1147.22 1607.05 1146.86 Q1605.19 1146.53 1603.2 1145.83 L1603.2 1142.16 Q1604.78 1143.08 1606.66 1143.55 Q1608.54 1144.02 1610.59 1144.02 Q1614.16 1144.02 1616.02 1142.61 Q1617.9 1141.2 1617.9 1138.51 Q1617.9 1136.03 1616.15 1134.64 Q1614.42 1133.23 1611.32 1133.23 L1608.05 1133.23 L1608.05 1130.11 L1611.47 1130.11 Q1614.27 1130.11 1615.76 1129 Q1617.25 1127.87 1617.25 1125.76 Q1617.25 1123.6 1615.7 1122.45 Q1614.18 1121.29 1611.32 1121.29 Q1609.76 1121.29 1607.97 1121.62 Q1606.19 1121.96 1604.04 1122.68 L1604.04 1119.29 Q1606.21 1118.69 1608.09 1118.39 Q1609.99 1118.09 1611.66 1118.09 Q1615.99 1118.09 1618.51 1120.06 Q1621.03 1122.02 1621.03 1125.37 Q1621.03 1127.7 1619.69 1129.32 Q1618.36 1130.92 1615.89 1131.54 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><g clip-path=\"url(#clip060)\">\n<image width=\"36\" height=\"30\" xlink:href=\"data:image/png;base64,\niVBORw0KGgoAAAANSUhEUgAAACQAAAAeCAYAAABE4bxTAAABuUlEQVRYhbVYW4GEMAyMBDRUAhoq\nAQ1IQAMS0FAJaEACGmph7uOue21I+trykR+aHSaZSVuWABAP7z2stSAiGGPgnIOUp8W2bZjnGUSE\naZpgrcV5nlUY8kMi8Ni2rQh4nufjd3Gs61rEUMlc1wUAtCxLAiqBXNeV5BzH8cnz3sMYk6zf960S\nE8nkOmatTdZjaXKVBwvkCksIhXZLWvMKw/NpmkBE1R6LMbQCit2JuxDCOfcxrfe+2vDcU0VCmulC\nJ3gEnw0ntO97XtfOiSnhSAUV5dIItZKRcKRp+yQaY8SX8JFu9U2zZN57dbogGLq3O1JhqodyYzvC\nO8BzHypOWS2hUXIty9JOSDqbesi0FJYFGeWfsK00HR1v+ofjaBPdTGiUf6pP+zf80yJXltAo/3CM\neZ77CHGgmhvjt7I75971z7qu1V0+juM3R2X6glzaZpjkSov8hthDKJyR1Wb+I1xVWc/+wz8OcoSC\ntNBMPcI//JaZGwqi/zv2a/7hsmtFxd0RCY3wD/DcEHM+iy1RlKt3/+FYGhn+OVQk1EsGSI+f8OL4\nfwMJPytZ7+kex33fDwsQEfZ9F7F/AEI9aqd2YHXbAAAAAElFTkSuQmCC\n\" transform=\"translate(1093, 1212)\"/>\n</g>\n<polyline clip-path=\"url(#clip060)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"269.619,1099.23 269.619,107.256 \"/>\n<polyline clip-path=\"url(#clip060)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"269.619,997.526 288.517,997.526 \"/>\n<polyline clip-path=\"url(#clip060)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"269.619,607.601 288.517,607.601 \"/>\n<polyline clip-path=\"url(#clip060)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"269.619,217.675 288.517,217.675 \"/>\n<path clip-path=\"url(#clip060)\" d=\"M113.675 1017.32 L121.314 1017.32 L121.314 990.953 L113.004 992.62 L113.004 988.36 L121.268 986.694 L125.944 986.694 L125.944 1017.32 L133.583 1017.32 L133.583 1021.25 L113.675 1021.25 L113.675 1017.32 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip060)\" d=\"M153.027 989.772 Q149.416 989.772 147.587 993.337 Q145.782 996.879 145.782 1004.01 Q145.782 1011.11 147.587 1014.68 Q149.416 1018.22 153.027 1018.22 Q156.661 1018.22 158.467 1014.68 Q160.295 1011.11 160.295 1004.01 Q160.295 996.879 158.467 993.337 Q156.661 989.772 153.027 989.772 M153.027 986.069 Q158.837 986.069 161.893 990.675 Q164.971 995.259 164.971 1004.01 Q164.971 1012.74 161.893 1017.34 Q158.837 1021.93 153.027 1021.93 Q147.217 1021.93 144.138 1017.34 Q141.082 1012.74 141.082 1004.01 Q141.082 995.259 144.138 990.675 Q147.217 986.069 153.027 986.069 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip060)\" d=\"M164.971 980.17 L189.083 980.17 L189.083 983.367 L164.971 983.367 L164.971 980.17 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip060)\" d=\"M197.941 990.646 L204.148 990.646 L204.148 969.224 L197.396 970.578 L197.396 967.118 L204.11 965.763 L207.909 965.763 L207.909 990.646 L214.116 990.646 L214.116 993.843 L197.941 993.843 L197.941 990.646 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip060)\" d=\"M229.914 968.265 Q226.98 968.265 225.495 971.161 Q224.028 974.039 224.028 979.832 Q224.028 985.606 225.495 988.502 Q226.98 991.38 229.914 991.38 Q232.867 991.38 234.334 988.502 Q235.82 985.606 235.82 979.832 Q235.82 974.039 234.334 971.161 Q232.867 968.265 229.914 968.265 M229.914 965.256 Q234.635 965.256 237.118 968.998 Q239.619 972.722 239.619 979.832 Q239.619 986.922 237.118 990.665 Q234.635 994.389 229.914 994.389 Q225.194 994.389 222.692 990.665 Q220.21 986.922 220.21 979.832 Q220.21 972.722 222.692 968.998 Q225.194 965.256 229.914 965.256 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip060)\" d=\"M138.99 627.393 L146.629 627.393 L146.629 601.027 L138.319 602.694 L138.319 598.435 L146.583 596.768 L151.259 596.768 L151.259 627.393 L158.898 627.393 L158.898 631.328 L138.99 631.328 L138.99 627.393 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip060)\" d=\"M178.342 599.847 Q174.731 599.847 172.902 603.412 Q171.097 606.953 171.097 614.083 Q171.097 621.189 172.902 624.754 Q174.731 628.296 178.342 628.296 Q181.976 628.296 183.782 624.754 Q185.611 621.189 185.611 614.083 Q185.611 606.953 183.782 603.412 Q181.976 599.847 178.342 599.847 M178.342 596.143 Q184.152 596.143 187.208 600.75 Q190.286 605.333 190.286 614.083 Q190.286 622.81 187.208 627.416 Q184.152 631.999 178.342 631.999 Q172.532 631.999 169.453 627.416 Q166.398 622.81 166.398 614.083 Q166.398 605.333 169.453 600.75 Q172.532 596.143 178.342 596.143 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip060)\" d=\"M190.286 590.245 L214.398 590.245 L214.398 593.442 L190.286 593.442 L190.286 590.245 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip060)\" d=\"M222.636 575.838 L237.55 575.838 L237.55 579.035 L226.115 579.035 L226.115 585.919 Q226.943 585.637 227.77 585.505 Q228.598 585.355 229.425 585.355 Q234.127 585.355 236.873 587.931 Q239.619 590.508 239.619 594.909 Q239.619 599.442 236.798 601.962 Q233.977 604.463 228.842 604.463 Q227.074 604.463 225.231 604.162 Q223.407 603.861 221.451 603.26 L221.451 599.442 Q223.144 600.363 224.949 600.815 Q226.755 601.266 228.767 601.266 Q232.021 601.266 233.921 599.554 Q235.82 597.843 235.82 594.909 Q235.82 591.975 233.921 590.263 Q232.021 588.552 228.767 588.552 Q227.244 588.552 225.72 588.89 Q224.216 589.229 222.636 589.944 L222.636 575.838 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip060)\" d=\"M168.914 237.467 L176.552 237.467 L176.552 211.102 L168.242 212.768 L168.242 208.509 L176.506 206.843 L181.182 206.843 L181.182 237.467 L188.821 237.467 L188.821 241.403 L168.914 241.403 L168.914 237.467 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip060)\" d=\"M208.265 209.921 Q204.654 209.921 202.825 213.486 Q201.02 217.028 201.02 224.157 Q201.02 231.264 202.825 234.829 Q204.654 238.37 208.265 238.37 Q211.9 238.37 213.705 234.829 Q215.534 231.264 215.534 224.157 Q215.534 217.028 213.705 213.486 Q211.9 209.921 208.265 209.921 M208.265 206.218 Q214.075 206.218 217.131 210.824 Q220.21 215.407 220.21 224.157 Q220.21 232.884 217.131 237.491 Q214.075 242.074 208.265 242.074 Q202.455 242.074 199.376 237.491 Q196.321 232.884 196.321 224.157 Q196.321 215.407 199.376 210.824 Q202.455 206.218 208.265 206.218 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip060)\" d=\"M229.914 188.414 Q226.98 188.414 225.495 191.31 Q224.028 194.188 224.028 199.98 Q224.028 205.754 225.495 208.651 Q226.98 211.528 229.914 211.528 Q232.867 211.528 234.334 208.651 Q235.82 205.754 235.82 199.98 Q235.82 194.188 234.334 191.31 Q232.867 188.414 229.914 188.414 M229.914 185.404 Q234.635 185.404 237.118 189.147 Q239.619 192.871 239.619 199.98 Q239.619 207.071 237.118 210.814 Q234.635 214.538 229.914 214.538 Q225.194 214.538 222.692 210.814 Q220.21 207.071 220.21 199.98 Q220.21 192.871 222.692 189.147 Q225.194 185.404 229.914 185.404 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><g clip-path=\"url(#clip060)\">\n<text style=\"fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:66px; text-anchor:middle;\" transform=\"rotate(-90, 71.4418, 603.241)\" x=\"71.4418\" y=\"603.241\">inf-norm error</text>\n</g>\n<g clip-path=\"url(#clip060)\">\n<text style=\"fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:66px; text-anchor:middle;\" transform=\"rotate(0, 1111.19, 57.6)\" x=\"1111.19\" y=\"57.6\">Convergence of AB4</text>\n</g>\n<polyline clip-path=\"url(#clip062)\" style=\"stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none\" points=\"317.255,241.121 588.189,206.49 846.543,389.412 1110.29,529.787 1375.83,682.482 1640.49,837.487 1905.12,993.167 \"/>\n<circle clip-path=\"url(#clip062)\" cx=\"317.255\" cy=\"241.121\" r=\"10.8\" fill=\"#009af9\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"#000000\" stroke-opacity=\"1\" stroke-width=\"2.56\"/>\n<circle clip-path=\"url(#clip062)\" cx=\"588.189\" cy=\"206.49\" r=\"10.8\" fill=\"#009af9\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"#000000\" stroke-opacity=\"1\" stroke-width=\"2.56\"/>\n<circle clip-path=\"url(#clip062)\" cx=\"846.543\" cy=\"389.412\" r=\"10.8\" fill=\"#009af9\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"#000000\" stroke-opacity=\"1\" stroke-width=\"2.56\"/>\n<circle clip-path=\"url(#clip062)\" cx=\"1110.29\" cy=\"529.787\" r=\"10.8\" fill=\"#009af9\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"#000000\" stroke-opacity=\"1\" stroke-width=\"2.56\"/>\n<circle clip-path=\"url(#clip062)\" cx=\"1375.83\" cy=\"682.482\" r=\"10.8\" fill=\"#009af9\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"#000000\" stroke-opacity=\"1\" stroke-width=\"2.56\"/>\n<circle clip-path=\"url(#clip062)\" cx=\"1640.49\" cy=\"837.487\" r=\"10.8\" fill=\"#009af9\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"#000000\" stroke-opacity=\"1\" stroke-width=\"2.56\"/>\n<circle clip-path=\"url(#clip062)\" cx=\"1905.12\" cy=\"993.167\" r=\"10.8\" fill=\"#009af9\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"#000000\" stroke-opacity=\"1\" stroke-width=\"2.56\"/>\n<polyline clip-path=\"url(#clip062)\" style=\"stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none\" stroke-dasharray=\"32, 20\" points=\"317.255,135.331 588.189,295.008 846.543,447.271 1110.29,602.714 1375.83,759.211 1640.49,915.191 1905.12,1071.15 \"/>\n<path clip-path=\"url(#clip060)\" d=\"M325.724 1066.16 L648.862 1066.16 L648.862 910.641 L325.724 910.641  Z\" fill=\"#ffffff\" fill-rule=\"evenodd\" fill-opacity=\"1\"/>\n<polyline clip-path=\"url(#clip060)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"325.724,1066.16 648.862,1066.16 648.862,910.641 325.724,910.641 325.724,1066.16 \"/>\n<polyline clip-path=\"url(#clip060)\" style=\"stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none\" points=\"344.425,962.481 456.634,962.481 \"/>\n<circle clip-path=\"url(#clip060)\" cx=\"400.53\" cy=\"962.481\" r=\"15.5846\" fill=\"#009af9\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"#000000\" stroke-opacity=\"1\" stroke-width=\"4.68114\"/>\n<path clip-path=\"url(#clip060)\" d=\"M491.169 949.807 L484.827 967.006 L497.535 967.006 L491.169 949.807 M488.53 945.201 L493.831 945.201 L507.002 979.761 L502.141 979.761 L498.993 970.895 L483.415 970.895 L480.266 979.761 L475.336 979.761 L488.53 945.201 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip060)\" d=\"M516.725 963.256 L516.725 975.918 L524.225 975.918 Q527.998 975.918 529.803 974.367 Q531.632 972.793 531.632 969.576 Q531.632 966.335 529.803 964.807 Q527.998 963.256 524.225 963.256 L516.725 963.256 M516.725 949.043 L516.725 959.46 L523.646 959.46 Q527.072 959.46 528.738 958.187 Q530.428 956.891 530.428 954.252 Q530.428 951.636 528.738 950.34 Q527.072 949.043 523.646 949.043 L516.725 949.043 M512.049 945.201 L523.993 945.201 Q529.34 945.201 532.234 947.423 Q535.127 949.645 535.127 953.743 Q535.127 956.914 533.646 958.789 Q532.164 960.664 529.294 961.127 Q532.743 961.868 534.641 964.229 Q536.562 966.567 536.562 970.085 Q536.562 974.715 533.414 977.238 Q530.266 979.761 524.456 979.761 L512.049 979.761 L512.049 945.201 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip060)\" d=\"M557.836 949.275 L546.03 967.724 L557.836 967.724 L557.836 949.275 M556.609 945.201 L562.488 945.201 L562.488 967.724 L567.419 967.724 L567.419 971.613 L562.488 971.613 L562.488 979.761 L557.836 979.761 L557.836 971.613 L542.234 971.613 L542.234 967.099 L556.609 945.201 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><polyline clip-path=\"url(#clip060)\" style=\"stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none\" stroke-dasharray=\"32, 20\" points=\"344.425,1014.32 456.634,1014.32 \"/>\n<path clip-path=\"url(#clip060)\" d=\"M508.502 1005.84 Q508.502 1009.19 507.308 1012.52 Q506.136 1015.82 504.075 1018.54 Q502.014 1021.26 499.391 1023.36 Q496.768 1025.47 493.699 1026.64 Q490.631 1027.81 487.633 1027.81 Q482.316 1027.81 478.826 1024.33 Q475.336 1020.84 475.336 1015 Q475.336 1010.93 477.163 1006.88 Q478.99 1002.8 481.894 999.778 Q484.799 996.733 488.616 994.836 Q492.458 992.939 496.252 992.939 Q501.639 992.939 505.059 996.523 Q508.502 1000.08 508.502 1005.84 M504.216 1003.97 Q504.216 1001.39 503.49 999.45 Q502.764 997.483 501.546 996.359 Q500.351 995.234 498.922 994.696 Q497.517 994.133 495.971 994.133 Q492.973 994.133 489.764 996.078 Q486.555 998.022 484.166 1001.63 Q482.878 1003.6 481.941 1005.96 Q481.004 1008.3 480.583 1010.39 Q480.161 1012.45 479.974 1013.9 Q479.81 1015.35 479.81 1016.36 Q479.81 1021.05 482.058 1023.81 Q484.307 1026.57 487.914 1026.57 Q490.748 1026.57 493.512 1024.91 Q496.276 1023.22 498.173 1020.81 Q499.859 1018.73 501.101 1016.22 Q502.365 1013.71 502.998 1011.42 Q503.63 1009.12 503.911 1007.27 Q504.216 1005.42 504.216 1003.97 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip060)\" d=\"M514.838 1014.77 Q514.838 1006.66 517.859 1000.13 Q519.148 997.389 520.951 995.094 Q522.755 992.798 523.949 991.791 Q525.144 990.784 525.472 990.784 Q525.94 990.784 525.964 991.253 Q525.964 991.487 525.331 992.072 Q517.602 999.942 517.625 1014.77 Q517.625 1029.64 525.144 1037.21 Q525.964 1038.03 525.964 1038.28 Q525.964 1038.75 525.472 1038.75 Q525.144 1038.75 523.996 1037.79 Q522.848 1036.83 521.068 1034.63 Q519.288 1032.43 518 1029.74 Q514.838 1023.2 514.838 1014.77 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip060)\" d=\"M559.257 1019.9 Q559.257 1020.09 559.047 1020.81 Q558.836 1021.54 558.321 1022.66 Q557.829 1023.79 557.149 1024.82 Q556.47 1025.82 555.346 1026.57 Q554.245 1027.3 552.98 1027.3 Q551.294 1027.3 550.17 1026.18 Q549.045 1025.05 549.045 1023.36 Q549.045 1022.43 549.537 1021.14 Q552.652 1012.82 552.652 1009.97 Q552.652 1006.62 550.052 1006.62 Q548.764 1006.62 547.546 1007.11 Q546.352 1007.58 545.532 1008.23 Q544.712 1008.89 543.963 1009.8 Q543.236 1010.69 542.862 1011.3 Q542.51 1011.89 542.229 1012.47 L541.62 1014.86 Q541.48 1015.52 540.801 1018.07 L539.747 1022.4 Q538.997 1025.64 538.833 1025.94 Q538.599 1026.6 538.084 1026.95 Q537.568 1027.3 537.053 1027.3 Q536.467 1027.3 536.069 1026.95 Q535.671 1026.6 535.671 1025.99 Q535.671 1025.89 535.741 1025.54 Q535.812 1025.19 535.929 1024.7 Q536.046 1024.21 536.093 1023.93 L538.88 1012.85 Q539.395 1010.83 539.512 1010.2 Q539.653 1009.55 539.653 1008.82 Q539.653 1006.62 538.154 1006.62 Q536.936 1006.62 536.139 1008.07 Q535.343 1009.52 534.664 1012.33 Q534.453 1013.11 534.313 1013.27 Q534.195 1013.43 533.844 1013.43 Q533.258 1013.41 533.258 1012.94 Q533.258 1012.82 533.446 1012.05 Q533.633 1011.28 533.985 1010.18 Q534.359 1009.05 534.711 1008.3 Q535.015 1007.74 535.179 1007.48 Q535.367 1007.2 535.812 1006.66 Q536.28 1006.1 536.889 1005.84 Q537.521 1005.56 538.294 1005.56 Q540.028 1005.56 541.292 1006.69 Q542.557 1007.79 542.721 1009.73 Q545.836 1005.56 550.193 1005.56 Q552.769 1005.56 554.245 1006.92 Q555.721 1008.28 555.721 1010.69 Q555.721 1011.26 555.604 1011.98 Q555.51 1012.68 555.276 1013.57 Q555.065 1014.46 554.877 1015.14 Q554.69 1015.82 554.315 1016.92 Q553.941 1018 553.777 1018.47 Q553.613 1018.94 553.214 1020.04 Q552.84 1021.12 552.793 1021.23 Q551.926 1023.41 551.926 1024.65 Q551.926 1025.47 552.184 1025.85 Q552.465 1026.22 553.074 1026.22 Q554.713 1026.22 555.931 1024.61 Q557.173 1022.97 557.969 1020.3 Q558.157 1019.71 558.25 1019.57 Q558.367 1019.43 558.695 1019.43 Q559.257 1019.43 559.257 1019.9 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip060)\" d=\"M586.288 1003.66 Q586.484 1003.85 586.484 1004.13 Q586.484 1004.41 586.288 1004.61 Q586.091 1004.81 585.812 1004.81 L564.793 1004.81 Q564.514 1004.81 564.317 1004.61 Q564.121 1004.41 564.121 1004.13 Q564.121 1003.85 564.317 1003.66 Q564.514 1003.46 564.793 1003.46 L585.812 1003.46 Q586.091 1003.46 586.288 1003.66 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip060)\" d=\"M589.991 1006.99 L589.991 1005.95 L600.304 990.197 Q600.566 989.787 600.976 989.804 Q601.353 989.804 601.435 989.951 Q601.517 990.099 601.517 990.673 L601.517 1005.95 L604.878 1005.95 L604.878 1006.99 L601.517 1006.99 L601.517 1009.9 Q601.517 1010.87 601.91 1011.18 Q602.32 1011.5 604.058 1011.5 L604.763 1011.5 L604.763 1012.53 Q603.386 1012.43 600.205 1012.43 Q597.041 1012.43 595.664 1012.53 L595.664 1011.5 L596.369 1011.5 Q598.107 1011.5 598.516 1011.2 Q598.926 1010.89 598.926 1009.9 L598.926 1006.99 L589.991 1006.99 M590.942 1005.95 L599.123 1005.95 L599.123 993.427 L590.942 1005.95 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /><path clip-path=\"url(#clip060)\" d=\"M611.74 1038.28 Q611.74 1038.05 612.349 1037.47 Q620.079 1029.6 620.079 1014.77 Q620.079 999.895 612.654 992.377 Q611.74 991.51 611.74 991.253 Q611.74 990.784 612.209 990.784 Q612.537 990.784 613.684 991.744 Q614.855 992.705 616.612 994.906 Q618.392 997.108 619.704 999.802 Q622.866 1006.34 622.866 1014.77 Q622.866 1022.87 619.844 1029.41 Q618.556 1032.15 616.753 1034.44 Q614.949 1036.74 613.755 1037.75 Q612.56 1038.75 612.209 1038.75 Q611.74 1038.75 611.74 1038.28 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /></svg>\n","content_type":"image/svg+xml"}}}],"key":"YnKoE1UANh"}],"data":{},"key":"AwjClqJjQc"}],"label":"demo-implicit-ab4-julia","identifier":"demo-implicit-ab4-julia","html_id":"demo-implicit-ab4-julia","key":"gB45O4ziBy"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-implicit-stiff","label":"demo-implicit-stiff","kind":"proof:example","position":{"start":{"line":583,"column":1},"end":{"line":583,"column":21}},"children":[{"type":"text","value":"Example ","key":"wuSIKo0rze"},{"type":"text","value":"6.7.2","key":"NWe2KASJ6K"}],"template":"Example %s","enumerator":"6.7.2","resolved":true,"html_id":"demo-implicit-stiff","remote":true,"url":"/implicit","dataUrl":"/implicit.json","key":"LpV62vcDxN"}],"key":"IoN9qjTqKZ"},{"type":"paragraph","position":{"start":{"line":585,"column":1},"end":{"line":585,"column":1}},"children":[{"type":"text","value":"The following simple ","key":"LqTeHOuLqW"},{"type":"abbreviation","title":"ordinary differential equation","children":[{"type":"text","value":"ODE","key":"eT20CXURi9"}],"key":"SVxy4HuIDb"},{"type":"text","value":" uncovers a surprise.","key":"UEovHI94nK"}],"key":"A6yVlRSM2C"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"ivp = ODEProblem((u, p, t) -> u^2 - u^3, 0.005, (0, 400.0))","key":"Y1rmbgF8Eo"},{"type":"output","id":"KoDuY6ia3oVOpg9eq9zF1","data":[{"output_type":"execute_result","execution_count":41,"metadata":{},"data":{"text/plain":{"content":"\u001b[38;2;86;182;194mODEProblem\u001b[0m with uType \u001b[38;2;86;182;194mFloat64\u001b[0m and tType \u001b[38;2;86;182;194mFloat64\u001b[0m. In-place: \u001b[38;2;86;182;194mfalse\u001b[0m\ntimespan: (0.0, 400.0)\nu0: 0.005","content_type":"text/plain"}}}],"key":"aYI9DeatKr"}],"data":{},"key":"EcUYah1lsC"},{"type":"paragraph","position":{"start":{"line":591,"column":1},"end":{"line":591,"column":1}},"children":[{"type":"text","value":"We will solve the problem first with the implicit AM2 method using ","position":{"start":{"line":591,"column":1},"end":{"line":591,"column":1}},"key":"rmu3NTLJHH"},{"type":"inlineMath","value":"n=200","position":{"start":{"line":591,"column":1},"end":{"line":591,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>=</mo><mn>200</mn></mrow><annotation encoding=\"application/x-tex\">n=200</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">200</span></span></span></span>","key":"fL1V5KGIv5"},{"type":"text","value":" steps.","position":{"start":{"line":591,"column":1},"end":{"line":591,"column":1}},"key":"MOxykgvzRY"}],"key":"iEHJALgaIW"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"tI, uI = FNC.am2(ivp, 200)\n\nplot(tI, uI;\n    label=\"AM2\", legend=:bottomright,\n    xlabel=L\"t\",  ylabel=L\"u(t)\")","key":"KDvQpMhLZK"},{"type":"output","id":"vWYBwnhHxfqpFK0Cv0eUC","data":[{"output_type":"execute_result","execution_count":42,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"8f1115b44e1856a7b7aef897b549db0b","path":"/build/8f1115b44e1856a7b7aef897b549db0b.png"},"text/html":{"content_type":"text/html","hash":"4dfcd96de4f3fa3330032f050434e95b","path":"/build/4dfcd96de4f3fa3330032f050434e95b.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"e8d5f9b11980e4651a1da634c9369d7f","path":"/build/e8d5f9b11980e4651a1da634c9369d7f.svg"}}}],"key":"W2PrBQf5sL"}],"data":{},"key":"pqCIdxJsBO"},{"type":"paragraph","position":{"start":{"line":601,"column":1},"end":{"line":601,"column":1}},"children":[{"type":"text","value":"Now we repeat the process using the explicit AB4 method.","position":{"start":{"line":601,"column":1},"end":{"line":601,"column":1}},"key":"YlLZuw0S2S"}],"key":"igsNmnfD65"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"tE, uE = FNC.ab4(ivp, 200)\nscatter!(tE, uE, m=3, label=\"AB4\", ylim=[-4, 2])","key":"nCEfNQE3M3"},{"type":"output","id":"K83_fq1ywBnkd8_Y8cJcX","data":[{"output_type":"execute_result","execution_count":43,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"687a93fef86d3e878b424c77dd42c260","path":"/build/687a93fef86d3e878b424c77dd42c260.png"},"text/html":{"content_type":"text/html","hash":"fea24089ca4180ffab8019417555708f","path":"/build/fea24089ca4180ffab8019417555708f.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"3c6c43b0ec46fda8bb48e7155b78cf9b","path":"/build/3c6c43b0ec46fda8bb48e7155b78cf9b.svg"}}}],"key":"acLlzXAztM"}],"data":{},"key":"kcbXfOaZs9"},{"type":"paragraph","position":{"start":{"line":608,"column":1},"end":{"line":608,"column":1}},"children":[{"type":"text","value":"Once the solution starts to take off, the AB4 result goes catastrophically wrong.","position":{"start":{"line":608,"column":1},"end":{"line":608,"column":1}},"key":"p3pKbawKKP"}],"key":"RcH2aX48eq"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"uE[105:111]","key":"dq2ZX0ivrY"},{"type":"output","id":"3S_mIFUtnYRXIswI2QlQI","data":[{"output_type":"execute_result","execution_count":44,"metadata":{},"data":{"text/plain":{"content":"7-element Vector{Float64}:\n   0.7553857798343923\n   1.4372970308402562\n  -3.2889768512289934\n 214.1791132643978\n  -4.482089146771584e7\n   4.1268902909420876e23\n  -3.221441244795439e71","content_type":"text/plain"}}}],"key":"R4eU8JNlK8"}],"data":{},"key":"ZRtLAUJ18V"},{"type":"paragraph","position":{"start":{"line":614,"column":1},"end":{"line":614,"column":1}},"children":[{"type":"text","value":"We hope that AB4 will converge in the limit ","position":{"start":{"line":614,"column":1},"end":{"line":614,"column":1}},"key":"WklKBrqLLB"},{"type":"inlineMath","value":"h\\to 0","position":{"start":{"line":614,"column":1},"end":{"line":614,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>h</mi><mo>→</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">h\\to 0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">h</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"gy75aG34fw"},{"type":"text","value":", so let’s try using more steps.","position":{"start":{"line":614,"column":1},"end":{"line":614,"column":1}},"key":"jLqoP09cr9"}],"key":"CDwaf8xTtb"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"plt = scatter(tI, uI;\n    m=3,  label=\"AM2, n=200\",  legend=:bottomright,\n    xlabel=L\"t\",  ylabel=L\"u(t)\")\n\nfor n in [1000, 1600]\n    tE, uE = FNC.ab4(ivp, n)\n    plot!(tE, uE, label=\"AM4, n=$n\")\nend\nplt","key":"vzpsDepgvC"},{"type":"output","id":"vd48jgflUQ925BX1-2t3U","data":[{"output_type":"execute_result","execution_count":45,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"fc1d3c2ba788e2f71389087627aa0364","path":"/build/fc1d3c2ba788e2f71389087627aa0364.png"},"text/html":{"content_type":"text/html","hash":"4056518f45b1f72bb83a47abfd24417c","path":"/build/4056518f45b1f72bb83a47abfd24417c.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"7d9341d6e4c0d0779b77f51b041a6f13","path":"/build/7d9341d6e4c0d0779b77f51b041a6f13.svg"}}}],"key":"ukeq7twndk"}],"data":{},"key":"OVfpryzY8T"},{"type":"paragraph","position":{"start":{"line":628,"column":1},"end":{"line":628,"column":1}},"children":[{"type":"text","value":"So AB4, which is supposed to be ","position":{"start":{"line":628,"column":1},"end":{"line":628,"column":1}},"key":"QUf9DHnrho"},{"type":"emphasis","position":{"start":{"line":628,"column":1},"end":{"line":628,"column":1}},"children":[{"type":"text","value":"more","position":{"start":{"line":628,"column":1},"end":{"line":628,"column":1}},"key":"MKS2HagoZj"}],"key":"BRxNCktbUB"},{"type":"text","value":" accurate than AM2, actually needs something like 8 times as many steps to get a reasonable-looking answer!","position":{"start":{"line":628,"column":1},"end":{"line":628,"column":1}},"key":"Y26t1U2uPX"}],"key":"NFrQoJVWiq"}],"label":"demo-implicit-stiff-julia","identifier":"demo-implicit-stiff-julia","html_id":"demo-implicit-stiff-julia","key":"LvwGBHm40F"},{"type":"heading","depth":3,"position":{"start":{"line":631,"column":1},"end":{"line":631,"column":1}},"children":[{"type":"text","value":"6.7 ","position":{"start":{"line":631,"column":1},"end":{"line":631,"column":1}},"key":"LNQ9tGwg27"},{"type":"link","identifier":"section-ivp-implicit","label":"section-ivp-implicit","kind":"narrative","position":{"start":{"line":631,"column":5},"end":{"line":631,"column":26}},"url":"/implicit","internal":true,"dataUrl":"/implicit.json","children":[{"type":"text","value":"Implementation of multistep methods","key":"HGFWQWw8IA"}],"key":"ShYpNDi8QV"}],"identifier":"id-6-7","label":"6.7 ","html_id":"id-6-7","implicit":true,"key":"gl6bvbLtaa"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-zs-liaf","label":"demo-zs-LIAF","kind":"proof:example","position":{"start":{"line":634,"column":1},"end":{"line":634,"column":14}},"children":[{"type":"text","value":"Example ","key":"DDLH7p7f3e"},{"type":"text","value":"6.8.1","key":"DtUDlGvpoZ"}],"template":"Example %s","enumerator":"6.8.1","resolved":true,"html_id":"demo-zs-liaf","remote":true,"url":"/zerostability","dataUrl":"/zerostability.json","key":"ddhLh1YKRu"}],"key":"cBVbXuT0TC"},{"type":"paragraph","position":{"start":{"line":636,"column":1},"end":{"line":636,"column":1}},"children":[{"type":"text","value":"We’ll measure the error at the time ","position":{"start":{"line":636,"column":1},"end":{"line":636,"column":1}},"key":"uDaIrGUE3n"},{"type":"inlineMath","value":"t=1","position":{"start":{"line":636,"column":1},"end":{"line":636,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">t=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"GKoq9hq5jV"},{"type":"text","value":".","position":{"start":{"line":636,"column":1},"end":{"line":636,"column":1}},"key":"J9Colmoj6l"}],"key":"zYuTE0MVKx"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"du_dt(u, t) = u\nû = exp\na, b = 0.0, 1.0;\nn = [5, 10, 20, 40, 60]\nerr = []\nt, u = [], []\nfor n in n\n    h = (b - a) / n\n    t = [a + i * h for i in 0:n]\n    u = [1; û(h); zeros(n - 1)]\n    f_val = [du_dt(u[1], t[1]); zeros(n)]\n    for i in 2:n\n        f_val[i] = du_dt(u[i], t[i])\n        u[i+1] = -4 * u[i] + 5 * u[i-1] + h * (4 * f_val[i] + 2 * f_val[i-1])\n    end\n    push!(err, abs(û(b) - u[end]))\nend\n@pt :header=[\"n\", \"h\", \"error\"] [n (b - a) ./ n err]","key":"mQfwRnJv05"},{"type":"output","id":"jTqTgzz_CmJIx0ihsnLMe","data":[{"output_type":"display_data","metadata":{},"data":{"text/html":{"content":"<table>\n  <thead>\n    <tr class = \"header headerLastRow\">\n      <th style = \"text-align: right;\">n</th>\n      <th style = \"text-align: right;\">h</th>\n      <th style = \"text-align: right;\">error</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td style = \"text-align: right;\">5</td>\n      <td style = \"text-align: right;\">0.2</td>\n      <td style = \"text-align: right;\">0.0160452</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">10</td>\n      <td style = \"text-align: right;\">0.1</td>\n      <td style = \"text-align: right;\">2.84548</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">20</td>\n      <td style = \"text-align: right;\">0.05</td>\n      <td style = \"text-align: right;\">1.6225e6</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">40</td>\n      <td style = \"text-align: right;\">0.025</td>\n      <td style = \"text-align: right;\">9.3442e18</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">60</td>\n      <td style = \"text-align: right;\">0.0166667</td>\n      <td style = \"text-align: right;\">1.74013e32</td>\n    </tr>\n  </tbody>\n</table>\n","content_type":"text/html"}}}],"key":"GzK94N8aWO"}],"data":{},"key":"w4Wuf9Feai"},{"type":"paragraph","position":{"start":{"line":659,"column":1},"end":{"line":659,"column":1}},"children":[{"type":"text","value":"The error starts out promisingly, but things explode from there. A graph of the last numerical attempt yields a clue.","position":{"start":{"line":659,"column":1},"end":{"line":659,"column":1}},"key":"DK6vvTPvqH"}],"key":"ur3lwQYFtY"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"using Plots\nplot(t, abs.(u);\n    m=3,  label=\"\",\n    xlabel=L\"t\",  yaxis=(:log10, L\"|u(t)|\"), \n    title=\"LIAF solution\")","key":"smnCUOQsMO"},{"type":"output","id":"kzaWybV-0c0lgqO22ZmMS","data":[{"output_type":"execute_result","execution_count":47,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"9f00a40313ee1cd673fbce6eb9e5c8d1","path":"/build/9f00a40313ee1cd673fbce6eb9e5c8d1.png"},"text/html":{"content_type":"text/html","hash":"a0fc07d8cbfe9adf67dbbbd9adf0e687","path":"/build/a0fc07d8cbfe9adf67dbbbd9adf0e687.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"895047a3b7db699939f72dd6b30a86d9","path":"/build/895047a3b7db699939f72dd6b30a86d9.svg"}}}],"key":"YOSBcCU296"}],"data":{},"key":"BRspjTnAg8"},{"type":"paragraph","position":{"start":{"line":669,"column":1},"end":{"line":669,"column":1}},"children":[{"type":"text","value":"It’s clear that the solution is growing exponentially in time.","position":{"start":{"line":669,"column":1},"end":{"line":669,"column":1}},"key":"ALBqCIf4Uf"}],"key":"x6VUBVsFwT"}],"label":"demo-zs-LIAF-julia","identifier":"demo-zs-liaf-julia","html_id":"demo-zs-liaf-julia","key":"wZqgTItfmU"}],"key":"CbAz7l3Jp4"}],"key":"HeoSzpVv3W"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Chapter 5","url":"/chapter5","group":"Julia codes"},"next":{"title":"Chapter 7","url":"/chapter7","group":"Julia codes"}}},"domain":"http://localhost:3000"}