{"kind":"Notebook","sha256":"9903a3ae725f1f394a13a3e8f6525822e135b34073e981cb5718606e94f65555","slug":"motive-2","location":"/chapter5/section7/python/motive.ipynb","dependencies":[],"frontmatter":{"numbering":{"heading_1":{"enabled":false},"heading_2":{"enabled":false},"heading_3":{"enabled":false},"heading_4":{"enabled":false},"heading_5":{"enabled":false},"heading_6":{"enabled":false}},"kernelspec":{"name":"python3","display_name":"myst","language":"python"},"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"exports":[{"format":"ipynb","filename":"motive.ipynb","url":"/fnc/build/motive-fe654bbe16f06864663bd8e59b743752.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T16:48:31.987518Z","iopub.status.busy":"2025-01-11T16:48:31.987178Z","iopub.status.idle":"2025-01-11T16:48:32.317764Z","shell.execute_reply":"2025-01-11T16:48:32.317355Z"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"exec(open(\"../../../python/FNC_init.py\").read())","visibility":"show","key":"tMvbH6BxOQ"},{"type":"output","id":"eBlTjD3EE7YTXr7PcAW_P","data":[],"visibility":"show","key":"s3aj6js8mj"}],"visibility":"remove","key":"oclaZ98TAi"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"N5AJtropE7"},{"type":"text","value":"5.7.1","key":"NZgItHYG2H"}],"key":"yAOwa8VYGC"}],"identifier":"demo-adapt-motive","label":"demo-adapt-motive","kind":"proof:example","template":"ExampleÂ %s","enumerator":"5.7.1","resolved":true,"html_id":"demo-adapt-motive","remote":true,"url":"/adaptive","dataUrl":"/adaptive.json","key":"Z4oh8128ml"}],"key":"MCopRzG9ei"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"This function gets increasingly oscillatory as ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"eMoUejnmzE"},{"type":"inlineMath","value":"x","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"dIbDLizHLX"},{"type":"text","value":" increases.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"v3mwvphjXo"}],"key":"PbUg7xOHdA"}],"key":"Glk10EQOH4"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T16:48:32.319411Z","iopub.status.busy":"2025-01-11T16:48:32.319297Z","iopub.status.idle":"2025-01-11T16:48:32.426936Z","shell.execute_reply":"2025-01-11T16:48:32.426657Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"f = lambda x: (x + 1) ** 2 * cos((2 * x + 1) / (x - 4.3))\nx = linspace(0, 4, 600)\nplot(x, f(x))\nxlabel(\"$x$\")\nylabel(\"$f(x)$\");","key":"fBNehSdT5R"},{"type":"output","id":"gmpCaiO-lO2xWu0MEL_S0","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"7c769bb884f3540889a2d7d98abd5464","path":"/fnc/build/7c769bb884f3540889a2d7d98abd5464.png"},"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"}}}],"key":"go0ZY4WFNl"}],"key":"nq1InmzCy3"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Accordingly, the trapezoid rule is more accurate on the left half of this interval than on the right half.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Q3nO6xD5uo"}],"key":"UlCb4xr0pM"}],"key":"VHKTq9fGwh"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T16:48:32.428201Z","iopub.status.busy":"2025-01-11T16:48:32.428110Z","iopub.status.idle":"2025-01-11T16:48:32.431136Z","shell.execute_reply":"2025-01-11T16:48:32.430874Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"n = 50 * 2 ** arange(4)\nTleft = zeros(4)\nTright = zeros(4)\nfor k in range(len(n)):\n    Tleft[k], _, _ = FNC.trapezoid(f, 0, 2, n[k])\n    Tright[k], _, _ = FNC.trapezoid(f, 2, 4, n[k])\nresults = PrettyTable()\nresults.add_column(\"n\", n)\nresults.add_column(\"left side\", Tleft)\nresults.add_column(\"right side\", Tright)\nprint(results)","key":"bxLbFLecuR"},{"type":"output","id":"qBaeJ4bkA5PZuS4jpj8iN","data":[{"output_type":"execute_result","execution_count":15,"metadata":{},"data":{"text/plain":{"content":"'<table>\\n    <thead>\\n        <tr>\\n            <th>n</th>\\n            <th>left side</th>\\n            <th>right side</th>\\n        </tr>\\n    </thead>\\n    <tbody>\\n        <tr>\\n            <td>50</td>\\n            <td>2.0041912243977023</td>\\n            <td>-4.327986370465979</td>\\n        </tr>\\n        <tr>\\n            <td>100</td>\\n            <td>2.006059574093049</td>\\n            <td>-4.736211288669688</td>\\n        </tr>\\n        <tr>\\n            <td>200</td>\\n            <td>2.006526613344454</td>\\n            <td>-4.809668389494285</td>\\n        </tr>\\n        <tr>\\n            <td>400</td>\\n            <td>2.0066433701440323</td>\\n            <td>-4.82666143974999</td>\\n        </tr>\\n    </tbody>\\n</table>'","content_type":"text/plain"}}}],"key":"grNwoiKqKI"}],"key":"PBrK15917d"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T16:48:32.432262Z","iopub.status.busy":"2025-01-11T16:48:32.432164Z","iopub.status.idle":"2025-01-11T16:48:32.434491Z","shell.execute_reply":"2025-01-11T16:48:32.434246Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"from scipy.integrate import quad\nleft_val, err = quad(f, 0, 2, epsabs=1e-13, epsrel=1e-13)\nright_val, err = quad(f, 2, 4, epsabs=1e-13, epsrel=1e-13)\nresults = PrettyTable()\nresults.add_column(\"n\", n)\nresults.add_column(\"left error\", Tleft - left_val)\nresults.add_column(\"right error\", Tright - right_val)\nprint(results)","key":"PBvzsgW58n"},{"type":"output","id":"Nsqd8cl9DGmqsWVk4XhB1","data":[{"name":"stdout","output_type":"stream","text":"+-----+-------------------------+----------------------+\n|  n  |        left error       |     right error      |\n+-----+-------------------------+----------------------+\n|  50 |  -0.0024910644116191705 |  0.5042292917807911  |\n| 100 |  -0.0006227147162722879 | 0.09600437357708191  |\n| 200 |  -0.0001556754648674996 | 0.022547272752484915 |\n| 400 | -3.8918665289155996e-05 | 0.00555422249678017  |\n+-----+-------------------------+----------------------+\n"}],"key":"Z6kytRLROQ"}],"key":"GYJGsjAOoG"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Both the picture and the numerical results suggest that more nodes should be used on the right half of the interval than on the left half.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jHoAVnNOIm"}],"key":"jg9LHZFlNT"}],"key":"P81Vwz921o"}],"key":"VbjT3KqfnX"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Extrap","url":"/extrap-2","group":"Chapter 5"},"next":{"title":"Usage","url":"/usage-11","group":"Chapter 5"}}},"domain":"http://localhost:3000"}