{"kind":"Notebook","sha256":"566bb871131b3313b8df16048b5b2da6787a77da967345f2ab0a471292d31bd8","slug":"extrap","location":"/chapter5/section6/julia/extrap.ipynb","dependencies":[],"frontmatter":{"numbering":{"heading_1":{"enabled":false},"heading_2":{"enabled":false},"heading_3":{"enabled":false},"heading_4":{"enabled":false},"heading_5":{"enabled":false},"heading_6":{"enabled":false}},"kernelspec":{"name":"julia-1.11","display_name":"Julia 1","language":"julia"},"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"exports":[{"format":"ipynb","filename":"extrap.ipynb","url":"/fnc/build/extrap-40dd2ad4cb48955e6871d1d8be1e3247.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"nfBCGJLL3S"},{"type":"text","value":"5.6.3","key":"hY4JJHex5k"}],"key":"hfyQqIT4Zl"}],"identifier":"demo-int-extrap","label":"demo-int-extrap","kind":"proof:example","template":"Example %s","enumerator":"5.6.3","resolved":true,"html_id":"demo-int-extrap","remote":true,"url":"/integration","dataUrl":"/integration.json","key":"F2Fovd6Jw3"}],"key":"WOcst7JYbw"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We estimate ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"sc8Wltn4GQ"},{"type":"inlineMath","value":"\\displaystyle\\int_0^2 x^2 e^{-2x}\\, dx","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle scriptlevel=\"0\" displaystyle=\"true\"><msubsup><mo>∫</mo><mn>0</mn><mn>2</mn></msubsup><msup><mi>x</mi><mn>2</mn></msup><msup><mi>e</mi><mrow><mo>−</mo><mn>2</mn><mi>x</mi></mrow></msup><mtext> </mtext><mi>d</mi><mi>x</mi></mstyle></mrow><annotation encoding=\"application/x-tex\">\\displaystyle\\int_0^2 x^2 e^{-2x}\\, dx</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.476em;vertical-align:-0.9119em;\"></span><span class=\"mop\"><span class=\"mop op-symbol large-op\" style=\"margin-right:0.44445em;position:relative;top:-0.0011em;\">∫</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.564em;\"><span style=\"top:-1.7881em;margin-left:-0.4445em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span><span style=\"top:-3.8129em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9119em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">2</span><span class=\"mord mathnormal mtight\">x</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"MAIn8gvtuz"},{"type":"text","value":" using extrapolation. First we use ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"pHH1evhVni"},{"type":"inlineCode","value":"quadgk","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"OeqWQFv50X"},{"type":"text","value":" to get an accurate value.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"LjHLCV1LdM"}],"key":"JRbjcNfBOa"}],"key":"kN2Nowtw0u"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T16:02:46.803000Z","iopub.status.busy":"2025-01-14T16:02:34.613000Z","iopub.execute_input":"2025-01-14T16:02:37.505000Z","shell.execute_reply":"2025-01-14T16:02:46.799000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"using QuadGK\nf = x -> x^2 * exp(-2x);\na = 0;\nb = 2;\nQ, _ = quadgk(f, a, b, atol=1e-14, rtol=1e-14)\n@show Q;","key":"du5iYzzyfi"},{"type":"output","id":"vDxj6idmaJZLZqlbEurj6","data":[{"name":"stdout","output_type":"stream","text":"Q = 0.1904741736116139"},{"name":"stdout","output_type":"stream","text":"\n"}],"key":"t2KKUQ3hqw"}],"key":"kvUvLL5G2t"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We start with the trapezoid formula on ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"I70He8ohRJ"},{"type":"inlineMath","value":"n=N","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>=</mo><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">n=N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span>","key":"M4bPzQ9afg"},{"type":"text","value":" nodes.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pKe9NrkS2i"}],"key":"wLcNSnCTMy"}],"key":"lKNZTNwqh6"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T16:02:47.294000Z","iopub.status.busy":"2025-01-14T16:02:46.851000Z","iopub.execute_input":"2025-01-14T16:02:46.862000Z","shell.execute_reply":"2025-01-14T16:02:47.293000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"N = 20;       # the coarsest formula\nn = N;\nh = (b - a) / n;\nt = h * (0:n);\ny = f.(t);","key":"nnWni2qu7f"},{"type":"output","id":"BH1GjqCbeycChMA7k8nn9","data":[],"key":"BQves3AVpw"}],"key":"rQ19DTdbgW"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We can now apply weights to get the estimate ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WqHQp7OxAH"},{"type":"inlineMath","value":"T_f(N)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>T</mi><mi>f</mi></msub><mo stretchy=\"false\">(</mo><mi>N</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">T_f(N)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0361em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10764em;\">f</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span></span></span></span>","key":"b04QWigsJ8"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mCX161FKND"}],"key":"TsStSdTq89"}],"key":"cZc0lOc5hc"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T16:03:08.794000Z","iopub.status.busy":"2025-01-14T16:02:47.312000Z","iopub.execute_input":"2025-01-14T16:02:47.312000Z","shell.execute_reply":"2025-01-14T16:03:08.793000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"T = [h * (sum(y[2:n]) + y[1] / 2 + y[n+1] / 2)]","key":"HtsQLyeLEM"},{"type":"output","id":"X9oD1fwipi8DBxt0HMm0y","data":[{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"text/plain":{"content":"1-element Vector{Float64}:\n 0.19041144993926784","content_type":"text/plain"}}}],"key":"OobsfT0x2R"}],"key":"XFgS3HiQDK"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now we double to ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"vLrhHA0CdM"},{"type":"inlineMath","value":"n=2N","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>=</mo><mn>2</mn><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">n=2N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord\">2</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span>","key":"WgnBs7uvP5"},{"type":"text","value":", but we only need to evaluate ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TrV3GIbVyn"},{"type":"inlineMath","value":"f","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>","key":"MR5Xz8Q0GP"},{"type":"text","value":" at every other interior node and apply ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XhfpVYKC4X"},{"type":"crossReference","kind":"equation","identifier":"nc-doubling","label":"nc-doubling","children":[{"type":"text","value":"(","key":"v2qpMEOqOA"},{"type":"text","value":"5.6.18","key":"EDDQtXlX2j"},{"type":"text","value":")","key":"x14SGmp9CK"}],"template":"(%s)","enumerator":"5.6.18","resolved":true,"html_id":"nc-doubling","remote":true,"url":"/integration","dataUrl":"/integration.json","key":"QJddANjUUt"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"CKI2C8Gv8j"}],"key":"Fr5cuLI1xM"}],"key":"tb1hTP6zLR"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T16:03:08.985000Z","iopub.status.busy":"2025-01-14T16:03:08.808000Z","iopub.execute_input":"2025-01-14T16:03:08.812000Z","shell.execute_reply":"2025-01-14T16:03:08.985000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"n = 2n;\nh = h / 2;\nt = h * (0:n);\nT = [T; T[end] / 2 + h * sum(f.(t[2:2:n]))]","key":"CWRm7Ecsz0"},{"type":"output","id":"MsavuXQ6TFy0zLAWzGb5m","data":[{"output_type":"execute_result","execution_count":5,"metadata":{},"data":{"text/plain":{"content":"2-element Vector{Float64}:\n 0.19041144993926784\n 0.19045880585951175","content_type":"text/plain"}}}],"key":"Sv8ekCwHev"}],"key":"WSinxVjQml"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We can repeat the same code to double ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"gHVJ4bODX8"},{"type":"inlineMath","value":"n","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"sjYPh0OWHl"},{"type":"text","value":" again.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OBDkfPEXrF"}],"key":"zsAJFKEsri"}],"key":"nLMkAYue7S"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T16:03:08.999000Z","iopub.status.busy":"2025-01-14T16:03:08.990000Z","iopub.execute_input":"2025-01-14T16:03:08.991000Z","shell.execute_reply":"2025-01-14T16:03:08.999000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"n = 2n;\nh = h / 2;\nt = h * (0:n);\nT = [T; T[end] / 2 + h * sum(f.(t[2:2:n]))]","key":"n3qw7TN2za"},{"type":"output","id":"j5bfl-Lb4AbW7iMyyOhhk","data":[{"output_type":"execute_result","execution_count":6,"metadata":{},"data":{"text/plain":{"content":"3-element Vector{Float64}:\n 0.19041144993926784\n 0.19045880585951175\n 0.1904703513046443","content_type":"text/plain"}}}],"key":"rblk0BxNX6"}],"key":"pP45EvFXwp"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Let us now do the first level of extrapolation to get results from Simpson’s formula. We combine the elements ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"R8Oy423aTU"},{"type":"inlineCode","value":"T[i]","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YyxGSAD4gV"},{"type":"text","value":" and ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"sQ2o2UhaFt"},{"type":"inlineCode","value":"T[i+1]","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"q9xkpOnPdx"},{"type":"text","value":" the same way for ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"c7yfHmQqAE"},{"type":"inlineMath","value":"i=1","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">i=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"fDZzyxeVAp"},{"type":"text","value":" and ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"VSmXknNZ5Y"},{"type":"inlineMath","value":"i=2","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi><mo>=</mo><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">i=2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span></span></span></span>","key":"N4ahjPJQSE"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"gRT4sU5Qqn"}],"key":"HKo1iGFvqs"}],"key":"DveL5Vj1a2"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T16:03:09.354000Z","iopub.status.busy":"2025-01-14T16:03:09.003000Z","iopub.execute_input":"2025-01-14T16:03:09.004000Z","shell.execute_reply":"2025-01-14T16:03:09.354000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"S = [(4T[i+1] - T[i]) / 3 for i in 1:2]","key":"afSc2Xf9T2"},{"type":"output","id":"R540Uis8VApeJC2mtsS3g","data":[{"output_type":"execute_result","execution_count":7,"metadata":{},"data":{"text/plain":{"content":"2-element Vector{Float64}:\n 0.19047459116625973\n 0.19047419978635513","content_type":"text/plain"}}}],"key":"EnvuWXFHmX"}],"key":"ZCbIC5jW1f"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"With the two Simpson values ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"tsPY9nKrTD"},{"type":"inlineMath","value":"S_f(N)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>S</mi><mi>f</mi></msub><mo stretchy=\"false\">(</mo><mi>N</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">S_f(N)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0361em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10764em;\">f</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span></span></span></span>","key":"K5odz7G6K8"},{"type":"text","value":" and ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"NkqdGY0p8n"},{"type":"inlineMath","value":"S_f(2N)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>S</mi><mi>f</mi></msub><mo stretchy=\"false\">(</mo><mn>2</mn><mi>N</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">S_f(2N)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0361em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10764em;\">f</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\">2</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span></span></span></span>","key":"ZGZGmewdp5"},{"type":"text","value":" in hand, we can do one more level of extrapolation to get a sixth-order accurate result.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JEjM0oOPVo"}],"key":"ZvLPlbWUEa"}],"key":"cVL9cnj7hk"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T16:03:10.702000Z","iopub.status.busy":"2025-01-14T16:03:09.358000Z","iopub.execute_input":"2025-01-14T16:03:09.358000Z","shell.execute_reply":"2025-01-14T16:03:10.701000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"R = (16S[2] - S[1]) / 15","key":"n3ny4rp28m"},{"type":"output","id":"PxpdwEPDiNaJeX9q3xZnZ","data":[{"output_type":"execute_result","execution_count":8,"metadata":{},"data":{"text/plain":{"content":"0.1904741736943615","content_type":"text/plain"}}}],"key":"xn7BdBeSPW"}],"key":"bgyFDdAa6O"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We can make a triangular table of the errors:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"miqeGeeDvK"}],"key":"q7BSiIhtGN"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"HanXS51zZM"}],"key":"LlQCWQLK8K"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"The value ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"TowDmZbsXB"},{"type":"inlineCode","value":"nothing","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"OaEPH0Dr94"},{"type":"text","value":" equals nothing except ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"EiNhNchTBn"},{"type":"inlineCode","value":"nothing","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"S98jfkTPvI"},{"type":"text","value":".","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"K8XY1rNTyw"}],"key":"gSkdoOE41R"}],"class":"dropdown","key":"UUlypWpBY3"}],"key":"rP2d2TQPzD"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T16:03:22.016000Z","iopub.status.busy":"2025-01-14T16:03:10.717000Z","iopub.execute_input":"2025-01-14T16:03:10.717000Z","shell.execute_reply":"2025-01-14T16:03:22.016000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"err = [T .- Q [nothing; S .- Q] [nothing; nothing; R - Q]]\n@pt :header=[\"order 2\", \"order 4\", \"order 6\"] err","key":"fU1MgdQaMf"},{"type":"output","id":"UtzdkNDNLASfFQeBFe9Xy","data":[{"output_type":"display_data","metadata":{},"data":{"text/html":{"content":"<table>\n  <thead>\n    <tr class = \"header headerLastRow\">\n      <th style = \"text-align: right;\">order 2</th>\n      <th style = \"text-align: right;\">order 4</th>\n      <th style = \"text-align: right;\">order 6</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td style = \"text-align: right;\">-6.27237e-5</td>\n      <td style = \"text-align: right;\">nothing</td>\n      <td style = \"text-align: right;\">nothing</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">-1.53678e-5</td>\n      <td style = \"text-align: right;\">4.17555e-7</td>\n      <td style = \"text-align: right;\">nothing</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">-3.82231e-6</td>\n      <td style = \"text-align: right;\">2.61747e-8</td>\n      <td style = \"text-align: right;\">8.27476e-11</td>\n    </tr>\n  </tbody>\n</table>\n","content_type":"text/html"}}}],"key":"NL9Y0Xq95K"}],"key":"vtDlcTneps"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"If we consider the computational time to be dominated by evaluations of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"iIGmsI2mG9"},{"type":"inlineMath","value":"f","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>","key":"aiWY1DYCrI"},{"type":"text","value":", then we have obtained a result with about twice as many accurate digits as the best trapezoid result, at virtually no extra cost.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"sM2JfRUK5m"}],"key":"JEmIibadtw"}],"key":"pe4u6j2i59"}],"key":"PjdoLuYPJN"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Trap","url":"/trap","group":"Chapter 5"},"next":{"title":"Motive","url":"/motive","group":"Chapter 5"}}},"domain":"http://localhost:3000"}