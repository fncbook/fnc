{"kind":"Notebook","sha256":"0684d696af7b641d979fa2dbe8f916b3ff78b3a5660aaf6d8c44067430f5818c","slug":"extrap-2","location":"/chapter5/section6/python/extrap.ipynb","dependencies":[],"frontmatter":{"numbering":{"heading_1":{"enabled":false},"heading_2":{"enabled":false},"heading_3":{"enabled":false},"heading_4":{"enabled":false},"heading_5":{"enabled":false},"heading_6":{"enabled":false}},"kernelspec":{"name":"python3","display_name":"Python 3","language":"python"},"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"exports":[{"format":"ipynb","filename":"extrap.ipynb","url":"/fnc/build/extrap-55979eaf3cff0e8121bd0eb06f397028.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T16:48:28.692341Z","iopub.status.busy":"2025-01-11T16:48:28.692118Z","iopub.status.idle":"2025-01-11T16:48:29.056874Z","shell.execute_reply":"2025-01-11T16:48:29.056592Z"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"exec(open(\"../../../python/FNC_init.py\").read())","visibility":"show","key":"qeDMo9jklf"},{"type":"output","id":"kkGpaVpaWqQm4jGdyy2Zu","data":[],"visibility":"show","key":"lcO2txGppg"}],"visibility":"remove","key":"mQJvS6nMH1"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"b4e6amiJds"},{"type":"text","value":"5.6.3","key":"lpN5gTuAB5"}],"key":"nMA26PC5Ct"}],"identifier":"demo-int-extrap","label":"demo-int-extrap","kind":"proof:example","template":"Example %s","enumerator":"5.6.3","resolved":true,"html_id":"demo-int-extrap","remote":true,"url":"/integration","dataUrl":"/integration.json","key":"uTVtXAFs7r"}],"key":"SpKGMhRv5v"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We estimate ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"kkdY56Tu9c"},{"type":"inlineMath","value":"\\displaystyle\\int_0^2 x^2 e^{-2x}\\, dx","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle scriptlevel=\"0\" displaystyle=\"true\"><msubsup><mo>∫</mo><mn>0</mn><mn>2</mn></msubsup><msup><mi>x</mi><mn>2</mn></msup><msup><mi>e</mi><mrow><mo>−</mo><mn>2</mn><mi>x</mi></mrow></msup><mtext> </mtext><mi>d</mi><mi>x</mi></mstyle></mrow><annotation encoding=\"application/x-tex\">\\displaystyle\\int_0^2 x^2 e^{-2x}\\, dx</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.476em;vertical-align:-0.9119em;\"></span><span class=\"mop\"><span class=\"mop op-symbol large-op\" style=\"margin-right:0.44445em;position:relative;top:-0.0011em;\">∫</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.564em;\"><span style=\"top:-1.7881em;margin-left:-0.4445em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span><span style=\"top:-3.8129em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9119em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">2</span><span class=\"mord mathnormal mtight\">x</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"ei6SZfig3D"},{"type":"text","value":" using extrapolation. First we use ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"oQh0K7UYDM"},{"type":"inlineCode","value":"quadgk","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"dnUb7RGbpM"},{"type":"text","value":" to get an accurate value.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ASjRIXlerz"}],"key":"T3d9PlGmhF"}],"key":"FP5vivSDGM"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T16:48:29.058496Z","iopub.status.busy":"2025-01-11T16:48:29.058383Z","iopub.status.idle":"2025-01-11T16:48:29.060668Z","shell.execute_reply":"2025-01-11T16:48:29.060404Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"from scipy.integrate import quad\nf = lambda x: x**2 * exp(-2 * x)\na = 0\nb = 2\nI, errest = quad(f, a, b, epsabs=1e-13, epsrel=1e-13)\nprint(f\"Integral = {I:.14f}\")","key":"pQ17BfNns3"},{"type":"output","id":"C2pgKHiW4FhqNJHDxpEHE","data":[{"name":"stdout","output_type":"stream","text":"Integral = 0.19047417361161\n"}],"key":"jTITItCmVk"}],"key":"jRu0fSnTdD"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We start with the trapezoid formula on ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"eIUlUHEscM"},{"type":"inlineMath","value":"n=N","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>=</mo><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">n=N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span>","key":"eO9cNWffUj"},{"type":"text","value":" nodes.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OlCYPTSpTa"}],"key":"jRDYKqHSGm"}],"key":"Z1PPHC22eU"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T16:48:29.064239Z","iopub.status.busy":"2025-01-11T16:48:29.064133Z","iopub.status.idle":"2025-01-11T16:48:29.065917Z","shell.execute_reply":"2025-01-11T16:48:29.065663Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"N = 20    # the coarsest formula\nn = N\nh = (b - a) / n\nt = h * arange(n + 1)\ny = f(t)","key":"INF5TBp2ym"},{"type":"output","id":"sbpQgydVfKQdBbVw8IUMb","data":[],"key":"Te7lc3Trz4"}],"key":"HKKlBocXfg"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We can now apply weights to get the estimate ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ilctfHITr2"},{"type":"inlineMath","value":"T_f(N)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>T</mi><mi>f</mi></msub><mo stretchy=\"false\">(</mo><mi>N</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">T_f(N)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0361em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10764em;\">f</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span></span></span></span>","key":"zyVs4iERX4"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qplDNIu1JQ"}],"key":"r9fj5UQyL9"}],"key":"lOff7XykfZ"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T16:48:29.067054Z","iopub.status.busy":"2025-01-11T16:48:29.066974Z","iopub.status.idle":"2025-01-11T16:48:29.068899Z","shell.execute_reply":"2025-01-11T16:48:29.068667Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"T = zeros(3)\nT[0] = h * (sum(y[1:-1]) + y[0] / 2 + y[-1] / 2)\nprint(f\"error (2nd order): {I - T[0]:.2e}\")","key":"WQreVdaCzy"},{"type":"output","id":"et6a5_cyhdkt0SauDqHUP","data":[{"name":"stdout","output_type":"stream","text":"error (2nd order): 6.27e-05\n"}],"key":"PUuSV966tr"}],"key":"Siq8jwmQ08"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now we double to ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"fxSSHwBif6"},{"type":"inlineMath","value":"n=2N","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>=</mo><mn>2</mn><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">n=2N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord\">2</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span>","key":"IWgAfcNt2C"},{"type":"text","value":", but we only need to evaluate ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"lUlZpjMBCn"},{"type":"inlineMath","value":"f","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>","key":"WcIKV8Gsdr"},{"type":"text","value":" at every other interior node and apply ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MVzZ2GzmBd"},{"type":"crossReference","kind":"equation","identifier":"nc-doubling","label":"nc-doubling","children":[{"type":"text","value":"(","key":"EeV2GTzJrK"},{"type":"text","value":"5.6.18","key":"x3Erszh7kk"},{"type":"text","value":")","key":"vtCMf5dFn2"}],"template":"(%s)","enumerator":"5.6.18","resolved":true,"html_id":"nc-doubling","remote":true,"url":"/integration","dataUrl":"/integration.json","key":"M2shLwACOE"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"lsk25FdAg6"}],"key":"iqmg42Nd1m"}],"key":"b2iptWtwm6"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T16:48:29.070136Z","iopub.status.busy":"2025-01-11T16:48:29.070024Z","iopub.status.idle":"2025-01-11T16:48:29.072036Z","shell.execute_reply":"2025-01-11T16:48:29.071800Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"n = 2 * n\nh = h / 2\nt = h * arange(n + 1)\nT[1] = T[0] / 2 + h * sum(f(t[1:-1:2]))\nprint(\"error (2nd order):\", I - T[:2])","key":"ER7SovybS0"},{"type":"output","id":"TAHeRyUXFl3unfIa_J5pA","data":[{"name":"stdout","output_type":"stream","text":"error (2nd order): [6.27236723e-05 1.53677521e-05]\n"}],"key":"AnAtirLP6L"}],"key":"KmudOctTWn"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"As expected for a second-order estimate, the error went down by a factor of about 4. We can repeat the same code to double ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zTmQprfqs0"},{"type":"inlineMath","value":"n","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"CswGhLraTj"},{"type":"text","value":" again.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"znCisXshsG"}],"key":"NsOJtGQarT"}],"key":"esVw1Wmwwy"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T16:48:29.073129Z","iopub.status.busy":"2025-01-11T16:48:29.073056Z","iopub.status.idle":"2025-01-11T16:48:29.075068Z","shell.execute_reply":"2025-01-11T16:48:29.074849Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"n = 2 * n\nh = h / 2\nt = h * arange(n + 1)\nT[2] = T[1] / 2 + h * sum(f(t[1:-1:2]))\nprint(\"error (2nd order):\", I - T[:3])","key":"ylwnrNalu1"},{"type":"output","id":"0cMusEAPg1dO-0y_hapDa","data":[{"name":"stdout","output_type":"stream","text":"error (2nd order): [6.27236723e-05 1.53677521e-05 3.82230697e-06]\n"}],"key":"FCmV9wxJBE"}],"key":"ljlQMaRNxD"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Let us now do the first level of extrapolation to get results from Simpson’s formula. We combine the elements ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nGzEX5A2xw"},{"type":"inlineCode","value":"T[i]","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wgYlPJjNRC"},{"type":"text","value":" and ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XfWV0afo5O"},{"type":"inlineCode","value":"T[i+1]","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hQyjNK72fW"},{"type":"text","value":" the same way for ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GXV2sinC8F"},{"type":"inlineMath","value":"i=1","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">i=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"BMKzGmtEQN"},{"type":"text","value":" and ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XVRCF8LZ6R"},{"type":"inlineMath","value":"i=2","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi><mo>=</mo><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">i=2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span></span></span></span>","key":"Lj1MWnAIU4"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JeCKA5eZEP"}],"key":"Iw8xp47gNK"}],"key":"JETgpmbiFm"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T16:48:29.076191Z","iopub.status.busy":"2025-01-11T16:48:29.076115Z","iopub.status.idle":"2025-01-11T16:48:29.077988Z","shell.execute_reply":"2025-01-11T16:48:29.077759Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"S = array([(4 * T[i + 1] - T[i]) / 3 for i in range(2)])\nprint(\"error (4th order):\", I - S)","key":"k1Ma1jHKSR"},{"type":"output","id":"TkYM-Giq-ejoHTAS7aroz","data":[{"name":"stdout","output_type":"stream","text":"error (4th order): [-4.17554646e-07 -2.61747412e-08]\n"}],"key":"xeqTeNN0y9"}],"key":"QDxY4NqkR5"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"With the two Simpson values ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"oBh2aIpRRZ"},{"type":"inlineMath","value":"S_f(N)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>S</mi><mi>f</mi></msub><mo stretchy=\"false\">(</mo><mi>N</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">S_f(N)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0361em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10764em;\">f</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span></span></span></span>","key":"pFMkNFtiaq"},{"type":"text","value":" and ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Q5b0hhAhPo"},{"type":"inlineMath","value":"S_f(2N)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>S</mi><mi>f</mi></msub><mo stretchy=\"false\">(</mo><mn>2</mn><mi>N</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">S_f(2N)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0361em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10764em;\">f</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\">2</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span></span></span></span>","key":"jf9aLlNjfM"},{"type":"text","value":" in hand, we can do one more level of extrapolation to get a sixth-order accurate result.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Jg08WpFnTI"}],"key":"jxOVS124Fp"}],"key":"ipMiRv0bfy"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T16:48:29.079108Z","iopub.status.busy":"2025-01-11T16:48:29.079033Z","iopub.status.idle":"2025-01-11T16:48:29.080753Z","shell.execute_reply":"2025-01-11T16:48:29.080528Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"R = (16 * S[1] - S[0]) / 15\nprint(\"error (6th order):\", I - R)","key":"pjnpQmYAzQ"},{"type":"output","id":"c7nrJXpTcRhgfgV0yg-JS","data":[{"name":"stdout","output_type":"stream","text":"error (6th order): -8.274758656057202e-11\n"}],"key":"vp95blAywX"}],"key":"EAkdMfgIL6"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We can make a triangular table of the errors:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cherhKbMMM"}],"key":"R6F5HhROSA"}],"key":"ALSvLHDyU4"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T16:48:29.081869Z","iopub.status.busy":"2025-01-11T16:48:29.081796Z","iopub.status.idle":"2025-01-11T16:48:29.083988Z","shell.execute_reply":"2025-01-11T16:48:29.083731Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"err = nan * ones((3, 3))\nerr[0, :] = I - T\nerr[1, 1:] = I - S\nerr[2, 2] = I - R\nresults = PrettyTable([\"2nd order\", \"4th order\", \"6th order\"])\nresults.add_rows(err.T)\nprint(results)","key":"rF1JLCmc90"},{"type":"output","id":"yOhbCLL9vWNAPSZMaye3Z","data":[{"name":"stdout","output_type":"stream","text":"+------------------------+-------------------------+------------------------+\n|       2nd order        |        4th order        |       6th order        |\n+------------------------+-------------------------+------------------------+\n| 6.272367234608223e-05  |           nan           |          nan           |\n| 1.5367752102174448e-05 | -4.1755464580406354e-07 |          nan           |\n| 3.822306969658573e-06  | -2.6174741207807273e-08 | -8.274758656057202e-11 |\n+------------------------+-------------------------+------------------------+\n"}],"key":"jsnWfcPfqB"}],"key":"SIwFQtiIOU"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"If we consider the computational time to be dominated by evaluations of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ZpmoIbp1aN"},{"type":"inlineMath","value":"f","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>","key":"b0FSebIlQI"},{"type":"text","value":", then we have obtained a result with about twice as many accurate digits as the best trapezoid result, at virtually no extra cost.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ZfyuT8HYsc"}],"key":"rCcfxky1DD"}],"key":"siz8N7WCE9"}],"key":"q5aZD3qswK"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Trap","url":"/trap-2","group":"Chapter 5"},"next":{"title":"Motive","url":"/motive-2","group":"Chapter 5"}}},"domain":"http://localhost:3000"}