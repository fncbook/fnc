{"kind":"Notebook","sha256":"03e8d2ab563ccedb75112d5ea84cdd94383bb868f8b973cd853fb1959807f385","slug":"converge-10","location":"/chapter4/section2/matlab/converge.ipynb","dependencies":[],"frontmatter":{"numbering":{"heading_1":{"enabled":false},"heading_2":{"enabled":false},"heading_3":{"enabled":false},"heading_4":{"enabled":false},"heading_5":{"enabled":false},"heading_6":{"enabled":false}},"kernelspec":{"name":"jupyter_matlab_kernel","display_name":"MATLAB Kernel","language":"matlab"},"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"exports":[{"format":"ipynb","filename":"converge.ipynb","url":"/fnc/build/converge-823e7eb46ff38fa13cd3f6c965db164a.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"HG9PTc5lWG"},{"type":"text","value":"4.2.3","key":"oXmOAWfcO7"}],"key":"xy8PUe3Wny"}],"identifier":"demo-fp-converge","label":"demo-fp-converge","kind":"proof:example","template":"Example %s","enumerator":"4.2.3","resolved":true,"html_id":"demo-fp-converge","remote":true,"url":"/fixed-point","dataUrl":"/fixed-point.json","key":"qRPctObqfY"}],"key":"SqdULIdPFx"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We revisit ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"baIrqmFBxp"},{"type":"crossReference","kind":"proof:example","identifier":"demo-fp-spiral","label":"demo-fp-spiral","children":[{"type":"text","value":"Demo ","key":"AAl59DPsKU"},{"type":"text","value":"4.2.1","key":"vbo6IyT94q"}],"template":"Example %s","enumerator":"4.2.1","resolved":true,"html_id":"demo-fp-spiral","remote":true,"url":"/fixed-point","dataUrl":"/fixed-point.json","key":"c8nTTv6X4k"},{"type":"text","value":" and investigate the observed convergence more closely. Recall that above we calculated ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"fVc0ptVkMl"},{"type":"inlineMath","value":"g'(p)\\approx-0.42","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>g</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo stretchy=\"false\">(</mo><mi>p</mi><mo stretchy=\"false\">)</mo><mo>≈</mo><mo>−</mo><mn>0.42</mn></mrow><annotation encoding=\"application/x-tex\">g&#x27;(p)\\approx-0.42</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0019em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">p</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">−</span><span class=\"mord\">0.42</span></span></span></span>","key":"BEpbSxmb0d"},{"type":"text","value":" at the convergent fixed point.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"JljazYQN1D"}],"key":"QPwdUoTFa0"}],"key":"UQ8F0yjHZF"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"f = @(x) x.^2 - 4*x + 3.5;\nr = roots([1, -4, 3.5]);","key":"vlV3YQwkln"},{"type":"output","id":"MR7voFYyYi-7K0mRJ8y8X","data":[],"key":"KRrkornOmc"}],"key":"BVQJkHPs77"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Here is the fixed-point iteration. This time we keep track of the whole sequence of approximations.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"oW03DtUMGz"}],"key":"UvFDAgD51E"}],"key":"G3Jk16y5op"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"g = @(x) x - f(x);\nx = 2.1; \nfor k = 1:12\n    x(k+1) = g(x(k));\nend","key":"eqKzN9Ndwi"},{"type":"output","id":"On0XrQ-6m9WVBGyEPwaCe","data":[],"key":"SmgoQKT6Hg"}],"key":"cNOac8f1yl"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"It’s illuminating to construct and plot the sequence of errors.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LKzNqUb5Hf"}],"key":"tDglzsHv45"}],"key":"jiWnwxdE6H"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"err = abs(x - r(1));\nclf\nsemilogy(err, 'o-'), axis tight\nxlabel('iteration'),  ylabel('error')\ntitle(('Convergence of fixed-point iteration'));","key":"K1G0ZxyYYR"},{"type":"output","id":"GLzuwf2ozdjMC7bcdAkS_","data":[{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"02ae44c2de1695cb107ea487d94476ec","path":"/fnc/build/02ae44c2de1695cb107ea487d94476ec.png"}}}],"key":"gYUU3KXcZq"}],"key":"KPimRjOlaI"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"It’s quite clear that the convergence quickly settles into a linear rate. We could estimate this rate by doing a least-squares fit to a straight line. Keep in mind that the values for small ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"IWJKM1V5Ya"},{"type":"inlineMath","value":"k","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span>","key":"N1lEyYMgTQ"},{"type":"text","value":" should be left out of the computation, as they don’t represent the linear trend.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"T6esc3lNHU"}],"key":"RWI6n5F1Ah"}],"key":"IVD2OAMmzK"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"y = log(err(5:12));\np = polyfit(5:12, y, 1);","key":"Q52rkpPFa2"},{"type":"output","id":"pyd-f-xrov6RALQ7qcpbb","data":[],"key":"LWFLc0CN0e"}],"key":"zm1Hw9oNBx"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We can exponentiate the slope to get the convergence constant ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"q0OxwQEnx6"},{"type":"text","value":"σ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"HUM47fRq74"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"coAO0BDQ0U"}],"key":"VQpPe2sFMi"}],"key":"DFFV0EsAmH"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"sigma = exp(p(1))","key":"DZBaheWWVp"},{"type":"output","id":"adIMwmuTfS3jo7MgIUed7","data":[{"output_type":"execute_result","execution_count":6,"metadata":{},"data":{"text/plain":{"content":"sigma = 0.4145","content_type":"text/plain"},"text/html":{"content":"<html><body><pre>sigma = 0.4145</pre></body></html>","content_type":"text/html"}}}],"key":"BCDNLdksh4"}],"key":"xaA1eb4jJI"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The error should therefore decrease by a factor of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LKm7Agoj4D"},{"type":"text","value":"σ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pW8dZXXTq2"},{"type":"text","value":" at each iteration. We can check this easily from the observed data.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zhAVPjHFod"}],"key":"xqNzkGtnra"}],"key":"Mud6FQSu2l"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"err(9:12) ./ err(8:11)","key":"rYX1WiNZcd"},{"type":"output","id":"qjwACBZGJemUe1UFU92ub","data":[{"output_type":"execute_result","execution_count":7,"metadata":{},"data":{"text/plain":{"content":"ans = 1×4 double\n    0.4138    0.4144    0.4141    0.4142\n","content_type":"text/plain"},"text/html":{"content":"<html><body><pre>ans = 1×4 double\n    0.4138    0.4144    0.4141    0.4142\n</pre></body></html>","content_type":"text/html"}}}],"key":"x9sup4vtCQ"}],"key":"MZ4HM4LhnE"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The methods for finding ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"K6EFYcKQrz"},{"type":"text","value":"σ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JPetfv4WZl"},{"type":"text","value":" agree well.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jJP3LAholC"}],"key":"TdbWlESSa7"}],"key":"qxNMpQQUsX"}],"key":"VdRMnME84k"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Spiral","url":"/spiral-1","group":"Chapter 4"},"next":{"title":"Line","url":"/line-2","group":"Chapter 4"}}},"domain":"http://localhost:3000"}