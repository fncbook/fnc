{"kind":"Notebook","sha256":"8947b17488c1846887134a9110523fb2f7069e80e4874001f761917169f0aab6","slug":"chapter4-1","location":"/matlab/chapter4.md","dependencies":[],"frontmatter":{"title":"Chapter 4","numbering":{"heading_1":{"enabled":false},"heading_2":{"enabled":false},"heading_3":{"enabled":false},"heading_4":{"enabled":false},"heading_5":{"enabled":false},"heading_6":{"enabled":false}},"kernelspec":{"name":"jupyter_matlab_kernel","display_name":"MATLAB","language":"matlab"},"content_includes_title":false,"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"exports":[{"format":"md","filename":"chapter4.md","url":"/fnc/build/chapter4-cdf1dd9caed5bccebf1a05fd18f63192.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Functions","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"gCUih46h7J"}],"identifier":"functions","label":"Functions","html_id":"functions","implicit":true,"key":"cKOeWiRU1i"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Newton’s method","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"l5FgCdtS5x"}],"key":"tBY93VyULo"},{"type":"include","file":"../matlab/fnc/newton.m","literal":true,"filter":{},"children":[{"type":"code","value":"function x = newton(f,dfdx,x1)\r\n% NEWTON   Newton's method for a scalar equation.\r\n% Input:\r\n%   f        objective function \r\n%   dfdx     derivative function\r\n%   x1       initial root approximation\r\n% Output       \r\n%   x        vector of root approximations (last one is best)\r\n\r\n% Operating parameters.\r\nfuntol = 100*eps;  xtol = 100*eps;  maxiter = 40;\r\n\r\nx = x1;  \r\ny = f(x1);\r\ndx = Inf;   % for initial pass below\r\nk = 1;\r\n\r\nwhile (abs(dx) > xtol) && (abs(y) > funtol) && (k < maxiter)\r\n    dydx = dfdx(x(k));\r\n    dx = -y/dydx;           % Newton step\r\n    x(k+1) = x(k) + dx;\r\n\r\n    k = k+1;\r\n    y = f(x(k));\r\nend\r\n\r\nif k==maxiter\r\n  warning('Maximum number of iterations reached.')\r\nend","lang":"matlab","showLineNumbers":true,"filename":"newton.m","key":"H4CHe2ojMs"}],"key":"s5R4OnHul7"}],"label":"function-newton-matlab","identifier":"function-newton-matlab","html_id":"function-newton-matlab","key":"aicjCH0vyc"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Secant method","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"l30KjSdRrL"}],"key":"DkeS4Z4kmZ"},{"type":"include","file":"../matlab/fnc/secant.m","literal":true,"filter":{},"children":[{"type":"code","value":"function x = secant(f,x1,x2)\r\n% SECANT   Secant method for a scalar equation.\r\n% Input:\r\n%   f        objective function \r\n%   x1,x2    initial root approximations\r\n% Output       \r\n%   x        vector of root approximations (last is best)\r\n\r\n% Operating parameters.\r\nfuntol = 100*eps;  xtol = 100*eps;  maxiter = 40;\r\n\r\nx = [x1 x2];\r\ndx = Inf;  y1 = f(x1);\r\nk = 2;  y2 = f(x2);\r\n\r\nwhile (abs(dx) > xtol) && (abs(y2) > funtol) && (k < maxiter)\r\n    dx = -y2 * (x(k)-x(k-1)) / (y2-y1);   % secant step\r\n    x(k+1) = x(k) + dx;\r\n    \r\n    k = k+1;\r\n    y1 = y2;    % current f-value becomes the old one next time\r\n    y2 = f(x(k));\r\nend\r\n\r\nif k==maxiter\r\n    warning('Maximum number of iterations reached.')\r\nend","lang":"matlab","showLineNumbers":true,"filename":"secant.m","key":"cpHBVj80YF"}],"key":"fW4v6O43YN"}],"label":"function-secant-matlab","identifier":"function-secant-matlab","html_id":"function-secant-matlab","key":"WmP9Z7nPde"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Newton’s method for systems","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"EcatUo40f7"}],"key":"xnuNptS8MV"},{"type":"include","file":"../matlab/fnc/newtonsys.m","literal":true,"filter":{},"children":[{"type":"code","value":"function x = newtonsys(f,x1)\r\n% NEWTONSYS   Newton's method for a system of equations.\r\n% Input:\r\n%   f        function that computes residual and Jacobian matrix\r\n%   x1       initial root approximation (n-vector)\r\n% Output       \r\n%   x        array of approximations (one per column, last is best)\r\n\r\n% Operating parameters.\r\nfuntol = 1000*eps;  xtol = 1000*eps;  maxiter = 40;\r\n\r\nx = x1(:);  \r\n[y,J] = f(x1);\r\ndx = Inf;\r\nk = 1;\r\n\r\nwhile (norm(dx) > xtol) && (norm(y) > funtol) && (k < maxiter)\r\n    dx = -(J\\y);   % Newton step\r\n    x(:,k+1) = x(:,k) + dx;\r\n\r\n    k = k+1;\r\n    [y,J] = f(x(:,k));\r\nend\r\n\r\nif k==maxiter\r\n    warning('Maximum number of iterations reached.')\r\nend","lang":"matlab","showLineNumbers":true,"filename":"newtonsys.m","key":"Ba1ZRU6X5R"}],"key":"i6S9VcV79R"}],"label":"function-newtonsys-matlab","identifier":"function-newtonsys-matlab","html_id":"function-newtonsys-matlab","key":"Wo10aBiX8j"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Finite differences for Jacobian","position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"key":"k5Rvhod57Q"}],"key":"ujOz9Kq03h"},{"type":"include","file":"../matlab/fnc/fdjac.m","literal":true,"filter":{},"children":[{"type":"code","value":"function J = fdjac(f,x0,y0)\n% FDJAC   Finite-difference approximation of a Jacobian.\n% Input:\n%   f        function to be differentiated\n%   x0       evaluation point (n-vector)\n%   y0       value of f at x0 (m-vector)\n% Output       \n%   J        approximate Jacobian (m-by-n)\n\ndelta = sqrt(eps);   % FD step size\nm = length(y0);  n = length(x0);\nJ = zeros(m,n);\nI = eye(n);\nfor j = 1:n\n    J(:,j) = ( f(x0+delta*I(:,j)) - y0) / delta;\nend","lang":"matlab","showLineNumbers":true,"filename":"fdjac.m","key":"Q0FeTcyPF8"}],"key":"mQbFAnFfsT"}],"label":"function-fdjac-matlab","identifier":"function-fdjac-matlab","html_id":"function-fdjac-matlab","key":"irtrVw8GqJ"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Levenberg’s method","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"key":"IylJIr7dqH"}],"key":"idaVuGD5tj"},{"type":"include","file":"../matlab/fnc/levenberg.m","literal":true,"filter":{},"children":[{"type":"code","value":"function x = levenberg(f,x1,tol)\r\n% LEVENBERG   Quasi-Newton method for nonlinear systems.\r\n% Input:\r\n%   f         objective function \r\n%   x1        initial root approximation\r\n%   tol       stopping tolerance (default is 1e-12)\r\n% Output       \r\n%   x         array of approximations (one per column)\r\n\r\n% Operating parameters.\r\nif nargin < 3, tol = 1e-12; end\r\nftol = tol;  xtol = tol;  maxiter = 40;\r\n\r\nx = x1(:);     fk = f(x1);\r\nk = 1;  s = Inf;        \r\nAk = fdjac(f,x(:,1),fk);   % start with FD Jacobian\r\njac_is_new = true;\r\nI = eye(length(x));\r\n\r\nlambda = 10; \r\nwhile (norm(s) > xtol) && (norm(fk) > ftol) && (k < maxiter)\r\n    % Compute the proposed step.\r\n    B = Ak'*Ak + lambda*I;\r\n    z = Ak'*fk;\r\n    s = -(B\\z);\r\n\r\n    xnew = x(:,k) + s;   fnew = f(xnew);\r\n    \r\n    % Do we accept the result?\r\n    if norm(fnew) < norm(fk)    % accept\r\n        y = fnew - fk;\r\n        x(:,k+1) = xnew;  fk = fnew;  \r\n        k = k+1;\r\n        \r\n        lambda = lambda/10;  % get closer to Newton\r\n        % Broyden update of the Jacobian.\r\n        Ak = Ak + (y-Ak*s)*(s'/(s'*s));\r\n        jac_is_new = false;\r\n    else                       % don't accept\r\n        % Get closer to steepest descent.\r\n        lambda = lambda*4;\r\n        % Re-initialize the Jacobian if it's out of date.\r\n        if ~jac_is_new\r\n            Ak = fdjac(f,x(:,k),fk);\r\n            jac_is_new = true;\r\n        end\r\n    end\r\nend\r\n\r\nif (norm(fk) > 1e-3)\r\n    warning('Iteration did not find a root.')\r\nend","lang":"matlab","showLineNumbers":true,"filename":"levenberg.m","key":"qc84BsiIUz"}],"key":"uv3iJfv3ql"}],"label":"function-levenberg-matlab","identifier":"function-levenberg-matlab","html_id":"function-levenberg-matlab","key":"I9U635ndSB"},{"type":"heading","depth":2,"position":{"start":{"line":58,"column":1},"end":{"line":58,"column":1}},"children":[{"type":"text","value":"Examples","position":{"start":{"line":58,"column":1},"end":{"line":58,"column":1}},"key":"adjEDO6OzU"}],"identifier":"examples","label":"Examples","html_id":"examples","implicit":true,"key":"DiLslfSsTi"}],"key":"srsFjjt4zj"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"addpath /Users/driscoll/Documents/GitHub/fnc/matlab/fnc\naddpath /Users/driscoll/Documents/GitHub/fnc/matlab\nFNC_init","visibility":"show","key":"xA2Yr5TyJg"},{"type":"output","id":"sXyOaXGxqXQoTir730j3P","data":[{"output_type":"stream","name":"stdout","text":"Starting MATLAB ...\n"},{"output_type":"stream","name":"stdout","text":"Executing ..."},{"output_type":"execute_result","execution_count":1,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = \n  Figure (1) with properties:\n\n      Number: 1\n        Name: ''\n       Color: [1 1 1]\n    Position: [1224 1070 560 420]\n       Units: 'pixels'\n\n  Use GET to show all properties\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = \n  Figure (1) with properties:\n\n      Number: 1\n        Name: ''\n       Color: [1 1 1]\n    Position: [1224 1070 560 420]\n       Units: 'pixels'\n\n  Use GET to show all properties\n","content_type":"text/plain"}}}],"visibility":"show","key":"VIeWrgW1Zb"}],"data":{"tags":[]},"visibility":"remove","key":"RvnnTY8lFl"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"children":[{"type":"text","value":"4.1 ","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"key":"NY5sz5NIGD"},{"type":"link","identifier":"section-nonlineqn-rootproblem","label":"section-nonlineqn-rootproblem","kind":"narrative","position":{"start":{"line":67,"column":5},"end":{"line":67,"column":35}},"url":"/rootproblem","internal":true,"dataUrl":"/rootproblem.json","children":[{"type":"text","value":"The rootfinding problem","key":"gCNpzwDPSi"}],"key":"nVp4FdKGwR"}],"identifier":"id-4-1","label":"4.1 ","html_id":"id-4-1","implicit":true,"key":"nZDb7UCNwX"},{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-rootproblem-bessel","label":"demo-rootproblem-bessel","kind":"proof:example","position":{"start":{"line":70,"column":1},"end":{"line":70,"column":25}},"children":[{"type":"text","value":"Example ","key":"ODPEoqwvI5"},{"type":"text","value":"4.1.1","key":"WHhLCwwIvp"}],"template":"Example %s","enumerator":"4.1.1","resolved":true,"html_id":"demo-rootproblem-bessel","remote":true,"url":"/rootproblem","dataUrl":"/rootproblem.json","key":"BKLU92j4T0"}],"key":"FxGx8FGwku"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"J3 = @(x) besselj(3,x);\nfplot(J3, [0, 20])\ngrid on\nxlabel('x'), ylabel('J_3(x)')  \ntitle('Bessel function')","key":"mhcRJQHpoi"},{"type":"output","id":"kdYL2uy5PZFhe3B4811XX","data":[{"output_type":"execute_result","execution_count":2,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"047ed7009980ef35808be8f01bd2d303","path":"/fnc/build/047ed7009980ef35808be8f01bd2d303.png"}}}],"key":"pUL13YIeKD"}],"data":{},"key":"sgigXaUlm0"},{"type":"paragraph","position":{"start":{"line":79,"column":1},"end":{"line":79,"column":1}},"children":[{"type":"text","value":"From the graph we see roots near 6, 10, 13, 16, and 19. We use ","position":{"start":{"line":79,"column":1},"end":{"line":79,"column":1}},"key":"BtqrKq3Hk3"},{"type":"inlineCode","value":"nlsolve","position":{"start":{"line":79,"column":1},"end":{"line":79,"column":1}},"key":"qlBsvhjga3"},{"type":"text","value":" from the ","position":{"start":{"line":79,"column":1},"end":{"line":79,"column":1}},"key":"vyZ44I2mrQ"},{"type":"inlineCode","value":"NLsolve","position":{"start":{"line":79,"column":1},"end":{"line":79,"column":1}},"key":"TI7XpGKShD"},{"type":"text","value":" package to find these roots accurately. It uses vector variables, so we have to code accordingly.","position":{"start":{"line":79,"column":1},"end":{"line":79,"column":1}},"key":"swKPPyNMbI"}],"key":"sa7HIwRZpr"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"KeMMfKSmjR"}],"key":"GPBYZWRuYh"},{"type":"paragraph","position":{"start":{"line":82,"column":1},"end":{"line":83,"column":1}},"children":[{"type":"text","value":"Type ","position":{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},"key":"H9go01Swpk"},{"type":"inlineCode","value":"\\omega","position":{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},"key":"X0vK9qP4Uv"},{"type":"text","value":" followed by ","position":{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},"key":"PD04BCkZ3T"},{"type":"keyboard","children":[{"type":"text","value":"Tab","key":"avOv1mLhXN"}],"key":"iPC3YcTUjf"},{"type":"text","value":" to get the character ","position":{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},"key":"Mor3ZeBC4r"},{"type":"inlineCode","value":"ω","position":{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},"key":"MOSzsYJQvt"},{"type":"text","value":".\nThe argument ","position":{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},"key":"iBksyOEJsN"},{"type":"inlineCode","value":"ftol=1e-14","position":{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},"key":"xYoRBbYrgw"},{"type":"text","value":" below is called a ","position":{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},"key":"ugxC0AVhvW"},{"type":"strong","position":{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},"children":[{"type":"text","value":"keyword argument","position":{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},"key":"HYEoKJgHFD"}],"key":"dyjdxZ2Mqi"},{"type":"text","value":". Here it sets a goal for the maximum value of ","position":{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},"key":"Px5iiATRQK"},{"type":"inlineMath","value":"|f(x)|","position":{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">∣</mi><mi>f</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mi mathvariant=\"normal\">∣</mi></mrow><annotation encoding=\"application/x-tex\">|f(x)|</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">∣</span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mord\">∣</span></span></span></span>","key":"LwxFURIc0C"},{"type":"text","value":".","position":{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},"key":"PmZCk6b93p"}],"key":"qgxtqDWQPb"}],"class":"dropdown","key":"RFueOKAHMD"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"omega = [];\nfor guess = [6, 10, 13, 16, 19]\n    omega = [omega; fzero(J3, guess)];\nend\nomega","key":"MyHteOP60a"},{"type":"output","id":"DgkO7cACH7B9QoBGf_9BR","data":[{"output_type":"execute_result","execution_count":3,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>omega = 5×1 double\n    6.3802\n    9.7610\n   13.0152\n   16.2235\n   19.4094\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"omega = 5×1 double\n    6.3802\n    9.7610\n   13.0152\n   16.2235\n   19.4094\n","content_type":"text/plain"}}}],"key":"H8DGr20KdP"}],"data":{},"key":"J3rAcDYhj6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"table(omega, J3(omega), 'VariableNames', {'root estimate', 'function value'})","key":"yCv0RWv6SM"},{"type":"output","id":"2wwKQYDXnxnA80qTYj3Y8","data":[{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"text/html":{"content":"<html><head><style>.mwBasicVariableOutputWrapper .mwBasicVariableOutputHeader {font-style: italic;}</style></head><body><div class='mwBasicVariableOutputWrapper'><div>ans = <span class='mwBasicVariableOutputHeader'>5x2 table</span></div><table><thead><tr><th>root estimate</th><th>function value</th></tr></thead><tbody><tr><td>6.3802</td><td>-6.6245e-17</td></tr><tr><td>9.7610</td><td>1.3306e-16</td></tr><tr><td>13.0152</td><td>-2.5589e-16</td></tr><tr><td>16.2235</td><td>-6.9345e-16</td></tr><tr><td>19.4094</td><td>-6.0679e-16</td></tr></tbody></table></div></body></html>","content_type":"text/html"},"text/plain":{"content":"<html><head><style>.mwBasicVariableOutputWrapper .mwBasicVariableOutputHeader {font-style: italic;}</style></head><body><div class='mwBasicVariableOutputWrapper'><div>ans = <span class='mwBasicVariableOutputHeader'>5x2 table</span></div><table><thead><tr><th>root estimate</th><th>function value</th></tr></thead><tbody><tr><td>6.3802</td><td>-6.6245e-17</td></tr><tr><td>9.7610</td><td>1.3306e-16</td></tr><tr><td>13.0152</td><td>-2.5589e-16</td></tr><tr><td>16.2235</td><td>-6.9345e-16</td></tr><tr><td>19.4094</td><td>-6.0679e-16</td></tr></tbody></table></div></body></html>","content_type":"text/plain"}}}],"key":"sXGuTxEnGj"}],"data":{},"key":"Cg4fXyn7Vx"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"hold on\nscatter(omega, J3(omega))\ntitle('Bessel roots')","key":"lfXyQzF18J"},{"type":"output","id":"kOmrLN9g53ctuJCIoGSkV","data":[{"output_type":"execute_result","execution_count":5,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"616c1d2167b6813fd308c206bd562f3c","path":"/fnc/build/616c1d2167b6813fd308c206bd562f3c.png"}}}],"key":"H3zDaRAaNC"}],"data":{},"key":"iF92hdl42e"},{"type":"paragraph","position":{"start":{"line":104,"column":1},"end":{"line":104,"column":1}},"children":[{"type":"text","value":"If instead we seek values at which ","position":{"start":{"line":104,"column":1},"end":{"line":104,"column":1}},"key":"RGcZODqMZ1"},{"type":"inlineMath","value":"J_3(x)=0.2","position":{"start":{"line":104,"column":1},"end":{"line":104,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>J</mi><mn>3</mn></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mn>0.2</mn></mrow><annotation encoding=\"application/x-tex\">J_3(x)=0.2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.09618em;\">J</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0962em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0.2</span></span></span></span>","key":"Pn5ykaocVf"},{"type":"text","value":", then we must find roots of the function ","position":{"start":{"line":104,"column":1},"end":{"line":104,"column":1}},"key":"kwWoWlRZDT"},{"type":"inlineMath","value":"J_3(x)-0.2","position":{"start":{"line":104,"column":1},"end":{"line":104,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>J</mi><mn>3</mn></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>−</mo><mn>0.2</mn></mrow><annotation encoding=\"application/x-tex\">J_3(x)-0.2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.09618em;\">J</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0962em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0.2</span></span></span></span>","key":"jnvr9Doiuy"},{"type":"text","value":".","position":{"start":{"line":104,"column":1},"end":{"line":104,"column":1}},"key":"twe1ncwGvg"}],"key":"YshHYcFGqg"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"omega = [];\nfor guess = [3, 6, 10, 13]\n    f = @(x) J3(x) - 0.2;\n    omega = [omega; fzero(f, guess)];\nend\nscatter(omega, J3(omega), '<')","key":"ha87Y98tx9"},{"type":"output","id":"6mbezeOeVXssY9DNbTeSQ","data":[{"output_type":"execute_result","execution_count":6,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"f1c2de8933f1528089efb4ca7d250792","path":"/fnc/build/f1c2de8933f1528089efb4ca7d250792.png"}}}],"key":"jt2MEm4bqY"}],"data":{},"key":"wldZDZKHkY"}],"label":"demo-rootproblem-bessel-matlab","identifier":"demo-rootproblem-bessel-matlab","html_id":"demo-rootproblem-bessel-matlab","key":"WeBHzNHz9e"},{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-roots-cond","label":"demo-roots-cond","kind":"proof:example","position":{"start":{"line":117,"column":1},"end":{"line":117,"column":17}},"children":[{"type":"text","value":"Example ","key":"Orcn02FvNm"},{"type":"text","value":"4.1.2","key":"EmYc1Nh0Yw"}],"template":"Example %s","enumerator":"4.1.2","resolved":true,"html_id":"demo-roots-cond","remote":true,"url":"/rootproblem","dataUrl":"/rootproblem.json","key":"dDibvhWFVC"}],"key":"aVM3fx4qP4"},{"type":"paragraph","position":{"start":{"line":118,"column":1},"end":{"line":118,"column":1}},"children":[{"type":"text","value":"Consider first the function","position":{"start":{"line":118,"column":1},"end":{"line":118,"column":1}},"key":"lvcGrgnY8S"}],"key":"xbdhNVFKh1"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"f  = @(x) (x - 1) .* (x - 2);","key":"L3PKOPu3e7"},{"type":"output","id":"-MH2Ja6H4RZFWaTM4Pa8J","data":[],"key":"n8gFqzZakS"}],"data":{},"key":"G0xWMO7mRQ"},{"type":"paragraph","position":{"start":{"line":124,"column":1},"end":{"line":124,"column":1}},"children":[{"type":"text","value":"At the root ","position":{"start":{"line":124,"column":1},"end":{"line":124,"column":1}},"key":"GCjfl8JtO8"},{"type":"inlineMath","value":"r=1","position":{"start":{"line":124,"column":1},"end":{"line":124,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>r</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">r=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"W4ARx8jb27"},{"type":"text","value":", we have ","position":{"start":{"line":124,"column":1},"end":{"line":124,"column":1}},"key":"ZizU6jXXj5"},{"type":"inlineMath","value":"f'(r)=-1","position":{"start":{"line":124,"column":1},"end":{"line":124,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>f</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo stretchy=\"false\">(</mo><mi>r</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mo>−</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">f&#x27;(r)=-1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0019em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">−</span><span class=\"mord\">1</span></span></span></span>","key":"ZE9uHc7G8u"},{"type":"text","value":". If the values of ","position":{"start":{"line":124,"column":1},"end":{"line":124,"column":1}},"key":"t1CLT1AAJi"},{"type":"inlineMath","value":"f","position":{"start":{"line":124,"column":1},"end":{"line":124,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>","key":"vgQdu8w1Ki"},{"type":"text","value":" were perturbed at every point by a small amount of noise, we can imagine finding the root of the function drawn with a thick ribbon, giving a range of potential roots.","position":{"start":{"line":124,"column":1},"end":{"line":124,"column":1}},"key":"tf5M0AQAMs"}],"key":"e8Keyt4p7d"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf\ninterval = [0.8, 1.2];\nfplot(f, interval)\ngrid on, hold on\nfplot(@(x) f(x) + 0.02, interval, 'k')\nfplot(@(x) f(x) - 0.02, interval, 'k')\naxis equal \nxlabel('x'), ylabel('f(x)')\ntitle(('Well-conditioned root'));","key":"LWqjsMLKJT"},{"type":"output","id":"0vh6daW-PL7e3hhJ3SyOZ","data":[{"output_type":"execute_result","execution_count":8,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"70732618aad6367afff4e79f2e440aaa","path":"/fnc/build/70732618aad6367afff4e79f2e440aaa.png"}}}],"key":"LXBtw9MSVY"}],"data":{},"key":"YTwmOzvt3I"},{"type":"paragraph","position":{"start":{"line":139,"column":1},"end":{"line":139,"column":1}},"children":[{"type":"text","value":"The possible values for a perturbed root all lie within the interval where the ribbon intersects the ","position":{"start":{"line":139,"column":1},"end":{"line":139,"column":1}},"key":"vlUN8tmOcc"},{"type":"inlineMath","value":"x","position":{"start":{"line":139,"column":1},"end":{"line":139,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"E5VCDUOHpi"},{"type":"text","value":"-axis. The width of that zone is about the same as the vertical thickness of the ribbon.","position":{"start":{"line":139,"column":1},"end":{"line":139,"column":1}},"key":"gUmdZtULlM"}],"key":"hDB69ffdt6"},{"type":"paragraph","position":{"start":{"line":141,"column":1},"end":{"line":141,"column":1}},"children":[{"type":"text","value":"By contrast, consider the function","position":{"start":{"line":141,"column":1},"end":{"line":141,"column":1}},"key":"PwUE1iw6Vo"}],"key":"rQ3eVYeOHG"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"f = @(x) (x - 1) .* (x - 1.01);","key":"S863gbZs2h"},{"type":"output","id":"wEhOGSE3S_XMd61b70OT1","data":[],"key":"uYtuVc0cCU"}],"data":{},"key":"zfGMMqMeVy"},{"type":"paragraph","position":{"start":{"line":147,"column":1},"end":{"line":147,"column":1}},"children":[{"type":"text","value":"Now ","position":{"start":{"line":147,"column":1},"end":{"line":147,"column":1}},"key":"HusXL8I8SV"},{"type":"inlineMath","value":"f'(1)=-0.01","position":{"start":{"line":147,"column":1},"end":{"line":147,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>f</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo><mo>=</mo><mo>−</mo><mn>0.01</mn></mrow><annotation encoding=\"application/x-tex\">f&#x27;(1)=-0.01</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0019em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">−</span><span class=\"mord\">0.01</span></span></span></span>","key":"wHgOVArkf2"},{"type":"text","value":", and the graph of ","position":{"start":{"line":147,"column":1},"end":{"line":147,"column":1}},"key":"FZBOqNNl4N"},{"type":"inlineMath","value":"f","position":{"start":{"line":147,"column":1},"end":{"line":147,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>","key":"wbGxlsMxMh"},{"type":"text","value":" will be much shallower near ","position":{"start":{"line":147,"column":1},"end":{"line":147,"column":1}},"key":"p5pGwYjqHB"},{"type":"inlineMath","value":"x=1","position":{"start":{"line":147,"column":1},"end":{"line":147,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">x=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"mGn8Lu9mip"},{"type":"text","value":". Look at the effect this has on our thick rendering:","position":{"start":{"line":147,"column":1},"end":{"line":147,"column":1}},"key":"I61Ht2AXT8"}],"key":"JnuCTXp1Lq"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"axis(axis), cla\nfplot(f, interval)\nfplot(@(x) f(x) + 0.02, interval, 'k')\nfplot(@(x) f(x) - 0.02, interval, 'k')\ntitle('Poorly conditioned root')","key":"rLwbSwCD4l"},{"type":"output","id":"PpluIkueW0SFrzOzMdvZk","data":[{"output_type":"execute_result","execution_count":10,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"6e95a0bddc99a71a2a5d6724c6c405d5","path":"/fnc/build/6e95a0bddc99a71a2a5d6724c6c405d5.png"}}}],"key":"LyObFS4y3m"}],"data":{},"key":"q6t4b0OwMv"},{"type":"paragraph","position":{"start":{"line":157,"column":1},"end":{"line":157,"column":1}},"children":[{"type":"text","value":"The vertical displacements in this picture are exactly the same as before. But the potential ","position":{"start":{"line":157,"column":1},"end":{"line":157,"column":1}},"key":"jKOX2lVSXz"},{"type":"emphasis","position":{"start":{"line":157,"column":1},"end":{"line":157,"column":1}},"children":[{"type":"text","value":"horizontal","position":{"start":{"line":157,"column":1},"end":{"line":157,"column":1}},"key":"PoJrZE3uoy"}],"key":"MFmxW4p926"},{"type":"text","value":" displacement of the root is much wider. In fact, if we perturb the function entirely upward by the amount drawn here, the root disappears!","position":{"start":{"line":157,"column":1},"end":{"line":157,"column":1}},"key":"DdS7LPzjIi"}],"key":"mn2NO3kTbT"}],"label":"demo-roots-cond-matlab","identifier":"demo-roots-cond-matlab","html_id":"demo-roots-cond-matlab","key":"Ov1A6evGMR"},{"type":"heading","depth":3,"position":{"start":{"line":160,"column":1},"end":{"line":160,"column":1}},"children":[{"type":"text","value":"4.2 ","position":{"start":{"line":160,"column":1},"end":{"line":160,"column":1}},"key":"XZDiZi0ImG"},{"type":"link","identifier":"section-nonlineqn-fixed-point","label":"section-nonlineqn-fixed-point","kind":"narrative","position":{"start":{"line":160,"column":5},"end":{"line":160,"column":35}},"url":"/fixed-point","internal":true,"dataUrl":"/fixed-point.json","children":[{"type":"text","value":"Fixed-point iteration","key":"jsInnJiFtj"}],"key":"fDoO8CaEs2"}],"identifier":"id-4-2","label":"4.2 ","html_id":"id-4-2","implicit":true,"key":"HxnPi8wZqh"},{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-fp-spiral","label":"demo-fp-spiral","kind":"proof:example","position":{"start":{"line":162,"column":1},"end":{"line":162,"column":16}},"children":[{"type":"text","value":"Example ","key":"GuhBhpcjom"},{"type":"text","value":"4.2.1","key":"qDqpeUKaVy"}],"template":"Example %s","enumerator":"4.2.1","resolved":true,"html_id":"demo-fp-spiral","remote":true,"url":"/fixed-point","dataUrl":"/fixed-point.json","key":"tCTykTkWC8"}],"key":"mz4H3wy8Nd"},{"type":"paragraph","position":{"start":{"line":163,"column":1},"end":{"line":163,"column":1}},"children":[{"type":"text","value":"Let’s convert the roots of a quadratic polynomial ","position":{"start":{"line":163,"column":1},"end":{"line":163,"column":1}},"key":"VtQa94Vuw2"},{"type":"inlineMath","value":"f(x)","position":{"start":{"line":163,"column":1},"end":{"line":163,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">f(x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span>","key":"Gg7uffQCen"},{"type":"text","value":" to a fixed point problem.","position":{"start":{"line":163,"column":1},"end":{"line":163,"column":1}},"key":"mNZOY7lCgn"}],"key":"IGqtc3FXdt"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"f = @(x) x.^2 - 4*x + 3.5;\nr = roots([1, -4, 3.5])","key":"yte5s7yx5q"},{"type":"output","id":"0R3pcOsK9SDNEi2ZxP9CV","data":[{"output_type":"execute_result","execution_count":11,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>r = 2×1 double\n    2.7071\n    1.2929\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"r = 2×1 double\n    2.7071\n    1.2929\n","content_type":"text/plain"}}}],"key":"AV0MDCtyX7"}],"data":{},"key":"eu7fNdnSlA"},{"type":"paragraph","position":{"start":{"line":170,"column":1},"end":{"line":170,"column":1}},"children":[{"type":"text","value":"We define ","position":{"start":{"line":170,"column":1},"end":{"line":170,"column":1}},"key":"R97H1SniHj"},{"type":"inlineMath","value":"g(x)=x-p(x)","position":{"start":{"line":170,"column":1},"end":{"line":170,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>g</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>x</mi><mo>−</mo><mi>p</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">g(x)=x-p(x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span>","key":"ffSTJ4SMRN"},{"type":"text","value":".","position":{"start":{"line":170,"column":1},"end":{"line":170,"column":1}},"key":"fjCZZBUxGm"}],"key":"sNR8Zo6i6S"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"g = @(x) x - f(x);","key":"WuDeSaZMn1"},{"type":"output","id":"dIb2fuNJXBMR0nOAAa5Le","data":[],"key":"hjNR38awfF"}],"data":{},"key":"KfKPrbiJjO"},{"type":"paragraph","position":{"start":{"line":176,"column":1},"end":{"line":176,"column":1}},"children":[{"type":"text","value":"Intersections of ","position":{"start":{"line":176,"column":1},"end":{"line":176,"column":1}},"key":"s4u1uVVbZX"},{"type":"inlineMath","value":"y=g(x)","position":{"start":{"line":176,"column":1},"end":{"line":176,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi><mo>=</mo><mi>g</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">y=g(x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span>","key":"ZDJIR4W3d6"},{"type":"text","value":" with the line ","position":{"start":{"line":176,"column":1},"end":{"line":176,"column":1}},"key":"gQOC2G9wFp"},{"type":"inlineMath","value":"y=x","position":{"start":{"line":176,"column":1},"end":{"line":176,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi><mo>=</mo><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">y=x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"lVcd4b0nn1"},{"type":"text","value":" are fixed points of ","position":{"start":{"line":176,"column":1},"end":{"line":176,"column":1}},"key":"jxqpmbJQL3"},{"type":"inlineMath","value":"g","position":{"start":{"line":176,"column":1},"end":{"line":176,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>g</mi></mrow><annotation encoding=\"application/x-tex\">g</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span></span></span></span>","key":"By2v24u9SN"},{"type":"text","value":" and thus roots of ","position":{"start":{"line":176,"column":1},"end":{"line":176,"column":1}},"key":"xd04q7gYdO"},{"type":"inlineMath","value":"f","position":{"start":{"line":176,"column":1},"end":{"line":176,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>","key":"YBxbyz4CF8"},{"type":"text","value":". (Only one is shown in the chosen plot range.)","position":{"start":{"line":176,"column":1},"end":{"line":176,"column":1}},"key":"UsqxCSxUfr"}],"key":"cmo4Z8Nier"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf\nfplot(g, [2, 3])\nhold on,  plot([2, 3], [2, 3], 'k')\ntitle('Finding a fixed point'),  axis equal  \nxlabel('x'),  ylabel('y')","key":"dJjZMdKuSo"},{"type":"output","id":"QNzxjY56yhQrLQGifAGLf","data":[{"output_type":"execute_result","execution_count":13,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"c5a250d4b22ff05a509e1cb11aad8a90","path":"/fnc/build/c5a250d4b22ff05a509e1cb11aad8a90.png"}}}],"key":"FJLojLFVsk"}],"data":{},"key":"T22qe1H0UN"},{"type":"paragraph","position":{"start":{"line":186,"column":1},"end":{"line":186,"column":1}},"children":[{"type":"text","value":"If we evaluate ","position":{"start":{"line":186,"column":1},"end":{"line":186,"column":1}},"key":"cd9DpPgKF4"},{"type":"inlineMath","value":"g(2.1)","position":{"start":{"line":186,"column":1},"end":{"line":186,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>g</mi><mo stretchy=\"false\">(</mo><mn>2.1</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">g(2.1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mopen\">(</span><span class=\"mord\">2.1</span><span class=\"mclose\">)</span></span></span></span>","key":"wq9WjDo4ZB"},{"type":"text","value":", we get a value of almost 2.6, so this is not a fixed point.","position":{"start":{"line":186,"column":1},"end":{"line":186,"column":1}},"key":"zoECgCiE1g"}],"key":"S6ixTl3kS8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"x = 2.1;\ny = g(x)","key":"z6koELBjFQ"},{"type":"output","id":"Mm9tdAUJcdX6c1PEsc002","data":[{"output_type":"execute_result","execution_count":14,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>y = 2.5900</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"y = 2.5900","content_type":"text/plain"}}}],"key":"c7a8fQHKNv"}],"data":{},"key":"zkF2b0b7oN"},{"type":"paragraph","position":{"start":{"line":193,"column":1},"end":{"line":193,"column":1}},"children":[{"type":"text","value":"However, ","position":{"start":{"line":193,"column":1},"end":{"line":193,"column":1}},"key":"rW7rvbWCfW"},{"type":"inlineMath","value":"y=g(x)","position":{"start":{"line":193,"column":1},"end":{"line":193,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi><mo>=</mo><mi>g</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">y=g(x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span>","key":"lpMnRZpJcw"},{"type":"text","value":" is considerably closer to the fixed point at around 2.7 than ","position":{"start":{"line":193,"column":1},"end":{"line":193,"column":1}},"key":"oqgOZPCYUa"},{"type":"inlineMath","value":"x","position":{"start":{"line":193,"column":1},"end":{"line":193,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"y1mrf7icVT"},{"type":"text","value":" is. Suppose then that we adopt ","position":{"start":{"line":193,"column":1},"end":{"line":193,"column":1}},"key":"j5pKu2uVnI"},{"type":"inlineMath","value":"y","position":{"start":{"line":193,"column":1},"end":{"line":193,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>","key":"kWSzM5BhKe"},{"type":"text","value":" as our new ","position":{"start":{"line":193,"column":1},"end":{"line":193,"column":1}},"key":"pubD4LbReS"},{"type":"inlineMath","value":"x","position":{"start":{"line":193,"column":1},"end":{"line":193,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"qIGkJR4Aah"},{"type":"text","value":" value. Changing the ","position":{"start":{"line":193,"column":1},"end":{"line":193,"column":1}},"key":"OuIOoH04Pi"},{"type":"inlineMath","value":"x","position":{"start":{"line":193,"column":1},"end":{"line":193,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"ueeY9qoG62"},{"type":"text","value":" coordinate in this way is the same as following a horizontal line over to the graph of ","position":{"start":{"line":193,"column":1},"end":{"line":193,"column":1}},"key":"nHTP0sGXyF"},{"type":"inlineMath","value":"y=x","position":{"start":{"line":193,"column":1},"end":{"line":193,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi><mo>=</mo><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">y=x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"XjAkaLEez0"},{"type":"text","value":".","position":{"start":{"line":193,"column":1},"end":{"line":193,"column":1}},"key":"QNmwRjtIZH"}],"key":"BpNZmaoGnR"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"plot([x, y], [y, y], '-')\nx = y;","key":"LqQLjYOHaQ"},{"type":"output","id":"bFhOIXwpAYn2U95FqC-5W","data":[{"output_type":"execute_result","execution_count":15,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"7d5abea0a25c469327308faf4f931db6","path":"/fnc/build/7d5abea0a25c469327308faf4f931db6.png"}}}],"key":"spM6xB6xOf"}],"data":{},"key":"IEa5tyiZIb"},{"type":"paragraph","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"children":[{"type":"text","value":"Now we can compute a new value for ","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"key":"vISVmNDENo"},{"type":"inlineMath","value":"y","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>","key":"oei63WPgQv"},{"type":"text","value":". We leave ","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"key":"aJ2gP2lC2t"},{"type":"inlineMath","value":"x","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"G2WKkvcNig"},{"type":"text","value":" alone here, so we travel along a vertical line to the graph of ","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"key":"f3Q2TcpEpx"},{"type":"inlineMath","value":"g","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>g</mi></mrow><annotation encoding=\"application/x-tex\">g</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span></span></span></span>","key":"vJqkUZQVGp"},{"type":"text","value":".","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"key":"xs8Xg5yHgZ"}],"key":"aJOMKtiiv3"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"y = g(x)\nplot([x, x],[x, y], '-')","key":"LyIsqIPV1t"},{"type":"output","id":"cvHyXsx1oWmVZ_KEiLBDV","data":[{"output_type":"execute_result","execution_count":16,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>y = 2.7419</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"y = 2.7419","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":16,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"098322390b34846b1cc26c7f2a93b8b0","path":"/fnc/build/098322390b34846b1cc26c7f2a93b8b0.png"}}}],"key":"OjDqQ8OxfQ"}],"data":{},"key":"sJUmSp8yg8"},{"type":"paragraph","position":{"start":{"line":207,"column":1},"end":{"line":207,"column":1}},"children":[{"type":"text","value":"You see that we are in a position to repeat these steps as often as we like. Let’s apply them a few times and see the result.","position":{"start":{"line":207,"column":1},"end":{"line":207,"column":1}},"key":"ieL6CIhQlr"}],"key":"HueYVImCew"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"for k = 1:5\n    plot([x, y], [y, y], '-')\n    x = y;       % y --> new x\n    y = g(x);    % g(x) --> new y\n    plot([x, x], [x, y], '-')  \nend","key":"PVlPSvp8Qi"},{"type":"output","id":"GRjonxvmVRTxXxIVE_6Eq","data":[{"output_type":"execute_result","execution_count":17,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"0a17a26c687745b298ee7afe309554b2","path":"/fnc/build/0a17a26c687745b298ee7afe309554b2.png"}}}],"key":"eS3n8yYtmw"}],"data":{},"key":"YeZm3GtaQA"},{"type":"paragraph","position":{"start":{"line":218,"column":1},"end":{"line":218,"column":1}},"children":[{"type":"text","value":"The process spirals in beautifully toward the fixed point we seek. Our last estimate has almost 4 accurate digits.","position":{"start":{"line":218,"column":1},"end":{"line":218,"column":1}},"key":"nElueYauu0"}],"key":"yKQYknDAXO"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"abs(y - r(1)) / r(1)","key":"mpjHAVQp7q"},{"type":"output","id":"wMmIKMHK0QW5xeEx3Q8Gf","data":[{"output_type":"execute_result","execution_count":18,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = 1.6531e-04</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = 1.6531e-04","content_type":"text/plain"}}}],"key":"ppVJzdsfb3"}],"data":{},"key":"NQ529Xcsc0"},{"type":"paragraph","position":{"start":{"line":224,"column":1},"end":{"line":224,"column":1}},"children":[{"type":"text","value":"Now let’s try to find the other fixed point ","position":{"start":{"line":224,"column":1},"end":{"line":224,"column":1}},"key":"lZKBB3MC7R"},{"type":"inlineMath","value":"\\approx 1.29","position":{"start":{"line":224,"column":1},"end":{"line":224,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>≈</mo><mn>1.29</mn></mrow><annotation encoding=\"application/x-tex\">\\approx 1.29</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4831em;\"></span><span class=\"mrel\">≈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1.29</span></span></span></span>","key":"jd6PDMtHlj"},{"type":"text","value":" in the same way. We’ll use 1.3 as a starting approximation.","position":{"start":{"line":224,"column":1},"end":{"line":224,"column":1}},"key":"OoeEnImh3O"}],"key":"Rm91kvOdQ8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"cla\nfplot(g, [1, 2])\nhold on, plot([1, 2], [1, 2], 'k')\nylim([1, 2])\nx = 1.3;  y = g(x);\nfor k = 1:5\n    plot([x, y], [y, y], '-'),  \n    x = y;       % y --> new x\n    y = g(x);    % g(x) --> new y\n    plot([x, x], [x, y], '-') \nend\ntitle('No convergence')","key":"RpxAItlbRa"},{"type":"output","id":"W0cyzSlFkKJd0823L-wQ5","data":[{"output_type":"execute_result","execution_count":19,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"cf03fe09f600d22147322ed48f7e2644","path":"/fnc/build/cf03fe09f600d22147322ed48f7e2644.png"}}}],"key":"Re2eHl5qqk"}],"data":{},"key":"FF40XVL17O"},{"type":"paragraph","position":{"start":{"line":241,"column":1},"end":{"line":241,"column":1}},"children":[{"type":"text","value":"This time, the iteration is pushing us ","position":{"start":{"line":241,"column":1},"end":{"line":241,"column":1}},"key":"t21zUhP846"},{"type":"emphasis","position":{"start":{"line":241,"column":1},"end":{"line":241,"column":1}},"children":[{"type":"text","value":"away from","position":{"start":{"line":241,"column":1},"end":{"line":241,"column":1}},"key":"fuXttXESZg"}],"key":"cTkpDFdHS9"},{"type":"text","value":" the correct answer.","position":{"start":{"line":241,"column":1},"end":{"line":241,"column":1}},"key":"NmOalzSiSQ"}],"key":"BC3SIu2nmH"}],"label":"demo-fp-spiral-matlab","identifier":"demo-fp-spiral-matlab","html_id":"demo-fp-spiral-matlab","key":"QSzTkne8Z7"},{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-fp-converge","label":"demo-fp-converge","kind":"proof:example","position":{"start":{"line":245,"column":1},"end":{"line":245,"column":18}},"children":[{"type":"text","value":"Example ","key":"lUSicdFz77"},{"type":"text","value":"4.2.3","key":"Tn17F6TS3i"}],"template":"Example %s","enumerator":"4.2.3","resolved":true,"html_id":"demo-fp-converge","remote":true,"url":"/fixed-point","dataUrl":"/fixed-point.json","key":"H6WqS8dLVV"}],"key":"fZSWJYAmce"},{"type":"paragraph","position":{"start":{"line":246,"column":1},"end":{"line":246,"column":1}},"children":[{"type":"text","value":"We revisit ","position":{"start":{"line":246,"column":1},"end":{"line":246,"column":1}},"key":"ubdhL9AViV"},{"type":"crossReference","kind":"proof:example","identifier":"demo-fp-spiral","label":"demo-fp-spiral","children":[{"type":"text","value":"Demo ","key":"p3E1Re9xIG"},{"type":"text","value":"4.2.1","key":"cFgr4vOHei"}],"template":"Example %s","enumerator":"4.2.1","resolved":true,"html_id":"demo-fp-spiral","remote":true,"url":"/fixed-point","dataUrl":"/fixed-point.json","key":"da4WTR8fnU"},{"type":"text","value":" and investigate the observed convergence more closely. Recall that above we calculated ","position":{"start":{"line":246,"column":1},"end":{"line":246,"column":1}},"key":"OgtbT0YsKi"},{"type":"inlineMath","value":"g'(p)\\approx-0.42","position":{"start":{"line":246,"column":1},"end":{"line":246,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>g</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo stretchy=\"false\">(</mo><mi>p</mi><mo stretchy=\"false\">)</mo><mo>≈</mo><mo>−</mo><mn>0.42</mn></mrow><annotation encoding=\"application/x-tex\">g&#x27;(p)\\approx-0.42</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0019em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">p</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">−</span><span class=\"mord\">0.42</span></span></span></span>","key":"zIUWG44H9N"},{"type":"text","value":" at the convergent fixed point.","position":{"start":{"line":246,"column":1},"end":{"line":246,"column":1}},"key":"PimowQ1Fpv"}],"key":"rPzK6cp7vi"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"f = @(x) x.^2 - 4*x + 3.5;\nr = roots([1, -4, 3.5]);","key":"uZC2KIro9w"},{"type":"output","id":"NCPwRuIQz6MPHTM-i_LHU","data":[],"key":"QrhTW2F0ij"}],"data":{},"key":"HVAQlT6rve"},{"type":"paragraph","position":{"start":{"line":253,"column":1},"end":{"line":253,"column":1}},"children":[{"type":"text","value":"Here is the fixed-point iteration. This time we keep track of the whole sequence of approximations.","position":{"start":{"line":253,"column":1},"end":{"line":253,"column":1}},"key":"LI4iVhzbeQ"}],"key":"YI5u6tkBqH"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"g = @(x) x - f(x);\nx = 2.1; \nfor k = 1:12\n    x(k+1) = g(x(k));\nend","key":"sH0Ef5puuD"},{"type":"output","id":"1oCazl_rlbs2v5SDqhhsE","data":[],"key":"XH5Tju8yUS"}],"data":{},"indexEntries":[{"entry":"Julia","subEntry":{"value":"push!","kind":"entry"},"emphasis":false}],"label":"index-jEVsG8OTTx","identifier":"index-jevsg8ottx","html_id":"index-jevsg8ottx","key":"dCMAopWq2X"},{"type":"paragraph","position":{"start":{"line":266,"column":1},"end":{"line":266,"column":1}},"children":[{"type":"text","value":"It’s illuminating to construct and plot the sequence of errors.","position":{"start":{"line":266,"column":1},"end":{"line":266,"column":1}},"key":"BsLBJXjLxt"}],"key":"iWXGp4i9pO"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"err = abs(x - r(1));\nclf\nsemilogy(err, 'o-'), axis tight\nxlabel('iteration'),  ylabel('error')\ntitle(('Convergence of fixed-point iteration'));","key":"uzCyMQ5551"},{"type":"output","id":"XYGdeW5jSokBXLvlPzoWv","data":[{"output_type":"execute_result","execution_count":22,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"7dc8779479d5239e9ddfa69f821ec37c","path":"/fnc/build/7dc8779479d5239e9ddfa69f821ec37c.png"}}}],"key":"XQtRog85w5"}],"data":{},"key":"Bf8f1D0ltl"},{"type":"paragraph","position":{"start":{"line":276,"column":1},"end":{"line":276,"column":1}},"children":[{"type":"text","value":"It’s quite clear that the convergence quickly settles into a linear rate. We could estimate this rate by doing a least-squares fit to a straight line. Keep in mind that the values for small ","position":{"start":{"line":276,"column":1},"end":{"line":276,"column":1}},"key":"FKoY8PtHlY"},{"type":"inlineMath","value":"k","position":{"start":{"line":276,"column":1},"end":{"line":276,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span>","key":"Fevn7DwLtZ"},{"type":"text","value":" should be left out of the computation, as they don’t represent the linear trend.","position":{"start":{"line":276,"column":1},"end":{"line":276,"column":1}},"key":"f5bDhWHjrI"}],"key":"rCvDQrFMdJ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"y = log(err(5:12));\np = polyfit(5:12, y, 1);","key":"IgoKh9gwVs"},{"type":"output","id":"69nm2Af4ObBHs96IYT0-t","data":[],"key":"bFBUtXRTTr"}],"data":{},"key":"EIoxLadWZq"},{"type":"paragraph","position":{"start":{"line":283,"column":1},"end":{"line":283,"column":1}},"children":[{"type":"text","value":"We can exponentiate the slope to get the convergence constant ","position":{"start":{"line":283,"column":1},"end":{"line":283,"column":1}},"key":"igi4HbXk3D"},{"type":"text","value":"σ","position":{"start":{"line":283,"column":1},"end":{"line":283,"column":1}},"key":"o5JgV69x6y"},{"type":"text","value":".","position":{"start":{"line":283,"column":1},"end":{"line":283,"column":1}},"key":"pLAeF7BQfo"}],"key":"Qvv8ubfefv"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"sigma = exp(p(1))","key":"eI3tYwO8h1"},{"type":"output","id":"r-VBJaG1DNNW1qnKPr0UR","data":[{"output_type":"execute_result","execution_count":24,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>sigma = 0.4145</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"sigma = 0.4145","content_type":"text/plain"}}}],"key":"xRLdqVaWtt"}],"data":{},"key":"X4vkRoORlT"},{"type":"paragraph","position":{"start":{"line":289,"column":1},"end":{"line":289,"column":1}},"children":[{"type":"text","value":"The error should therefore decrease by a factor of ","position":{"start":{"line":289,"column":1},"end":{"line":289,"column":1}},"key":"ue8LAEQWJq"},{"type":"text","value":"σ","position":{"start":{"line":289,"column":1},"end":{"line":289,"column":1}},"key":"DEkTgVxlyR"},{"type":"text","value":" at each iteration. We can check this easily from the observed data.","position":{"start":{"line":289,"column":1},"end":{"line":289,"column":1}},"key":"W24JZf0qTd"}],"key":"v49NaZGYMU"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"err(9:12) ./ err(8:11)","key":"GT1dSLHMWG"},{"type":"output","id":"HISZiHbVQXu82NvM4z49V","data":[{"output_type":"execute_result","execution_count":25,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = 1×4 double\n    0.4138    0.4144    0.4141    0.4142\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = 1×4 double\n    0.4138    0.4144    0.4141    0.4142\n","content_type":"text/plain"}}}],"key":"BBxOjHa31D"}],"data":{},"key":"d1Omr5dbU0"},{"type":"paragraph","position":{"start":{"line":295,"column":1},"end":{"line":295,"column":1}},"children":[{"type":"text","value":"The methods for finding ","position":{"start":{"line":295,"column":1},"end":{"line":295,"column":1}},"key":"pm4nk2CUbw"},{"type":"text","value":"σ","position":{"start":{"line":295,"column":1},"end":{"line":295,"column":1}},"key":"tAV0r6mbLE"},{"type":"text","value":" agree well.","position":{"start":{"line":295,"column":1},"end":{"line":295,"column":1}},"key":"RADRVz2xHF"}],"key":"liVGY2qIOo"}],"label":"demo-fp-converge-matlab","identifier":"demo-fp-converge-matlab","html_id":"demo-fp-converge-matlab","key":"T64kmX9Rmf"},{"type":"heading","depth":3,"position":{"start":{"line":297,"column":1},"end":{"line":297,"column":1}},"children":[{"type":"text","value":"4.3 ","position":{"start":{"line":297,"column":1},"end":{"line":297,"column":1}},"key":"T8vvsxggxh"},{"type":"link","identifier":"section-nonlineqn-newton","label":"section-nonlineqn-newton","kind":"narrative","position":{"start":{"line":297,"column":5},"end":{"line":297,"column":30}},"url":"/newton","internal":true,"dataUrl":"/newton.json","children":[{"type":"text","value":"Newton’s method","key":"mqmrVaRo3F"}],"key":"nK9Wln5qxL"}],"identifier":"id-4-3","label":"4.3 ","html_id":"id-4-3","implicit":true,"key":"g3cq5bSS7T"},{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-newton-line","label":"demo-newton-line","kind":"proof:example","position":{"start":{"line":299,"column":1},"end":{"line":299,"column":18}},"children":[{"type":"text","value":"Example ","key":"NhfUDTu8zn"},{"type":"text","value":"4.3.1","key":"VrrwTj5v4K"}],"template":"Example %s","enumerator":"4.3.1","resolved":true,"html_id":"demo-newton-line","remote":true,"url":"/newton","dataUrl":"/newton.json","key":"btDzxJcvLz"}],"key":"qatVx5gvCG"},{"type":"paragraph","position":{"start":{"line":301,"column":1},"end":{"line":301,"column":1}},"children":[{"type":"text","value":"Suppose we want to find a root of the function","position":{"start":{"line":301,"column":1},"end":{"line":301,"column":1}},"key":"mSOatrNf5x"}],"key":"anOG396WnK"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"f = @(x) x .* exp(x) - 2;\nclf, fplot(f, [0, 1.5])\nxlabel('x'), ylabel('y')    \nset(gca, 'ygrid', 'on')  \ntitle('Objective function')","key":"IRCOhSgwJx"},{"type":"output","id":"bMpCZhF93WJHA6MsZqybK","data":[{"output_type":"execute_result","execution_count":26,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"30b1843d963618a85b89904f83bf0f19","path":"/fnc/build/30b1843d963618a85b89904f83bf0f19.png"}}}],"key":"pbAHOpYByE"}],"data":{},"key":"rxSo7w5Hzj"},{"type":"paragraph","position":{"start":{"line":312,"column":1},"end":{"line":312,"column":1}},"children":[{"type":"text","value":"From the graph, it is clear that there is a root near ","position":{"start":{"line":312,"column":1},"end":{"line":312,"column":1}},"key":"sbcHgY5OH3"},{"type":"inlineMath","value":"x=1","position":{"start":{"line":312,"column":1},"end":{"line":312,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">x=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"A062GxvY7z"},{"type":"text","value":". So we call that our initial guess, ","position":{"start":{"line":312,"column":1},"end":{"line":312,"column":1}},"key":"nLgXD3J8rS"},{"type":"inlineMath","value":"x_1","position":{"start":{"line":312,"column":1},"end":{"line":312,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">x_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"rVIRk6SatH"},{"type":"text","value":".","position":{"start":{"line":312,"column":1},"end":{"line":312,"column":1}},"key":"suBEVaJENH"}],"key":"rCwez7dZw1"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"x1 = 1;\ny1 = f(x1)\nhold on, scatter(x1, y1)","key":"nUqB2X2SCC"},{"type":"output","id":"XfxRbRWrX1CR5XD2bLjii","data":[{"output_type":"execute_result","execution_count":27,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>y1 = 0.7183</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"y1 = 0.7183","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":27,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"b8319eb290f8c8212c819bcbd6b3b810","path":"/fnc/build/b8319eb290f8c8212c819bcbd6b3b810.png"}}}],"key":"Rbm6UjLvNb"}],"data":{},"key":"mfCR09vwhS"},{"type":"paragraph","position":{"start":{"line":320,"column":1},"end":{"line":320,"column":1}},"children":[{"type":"text","value":"Next, we can compute the tangent line at the point ","position":{"start":{"line":320,"column":1},"end":{"line":320,"column":1}},"key":"zaUHtjlAT5"},{"type":"inlineMath","value":"\\bigl(x_1,f(x_1)\\bigr)","position":{"start":{"line":320,"column":1},"end":{"line":320,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo fence=\"true\" stretchy=\"true\" minsize=\"1.2em\" maxsize=\"1.2em\">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><mi>f</mi><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy=\"false\">)</mo><mo fence=\"true\" stretchy=\"true\" minsize=\"1.2em\" maxsize=\"1.2em\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\bigl(x_1,f(x_1)\\bigr)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.2em;vertical-align:-0.35em;\"></span><span class=\"mopen\"><span class=\"delimsizing size1\">(</span></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mclose\"><span class=\"delimsizing size1\">)</span></span></span></span></span>","key":"cGx8wQp8XC"},{"type":"text","value":", using the derivative.","position":{"start":{"line":320,"column":1},"end":{"line":320,"column":1}},"key":"AZQ1Y87cAn"}],"key":"mpstv6KK3J"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"dfdx = @(x) exp(x) .* (x + 1);\nslope1 = dfdx(x1);\ntangent1 = @(x) y1 + slope1 * (x - x1);\nfplot(tangent1, [0, 1.5],'--')\ntitle('Function and tangent line')","key":"Xsp8YlIZtF"},{"type":"output","id":"p5Ovyy3n3XlAT4smAGOg8","data":[{"output_type":"execute_result","execution_count":28,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"f666d8d450c50874d2d34b32ce17d21f","path":"/fnc/build/f666d8d450c50874d2d34b32ce17d21f.png"}}}],"key":"iDPVzT8oLD"}],"data":{},"key":"XQ94JIFjVg"},{"type":"paragraph","position":{"start":{"line":331,"column":1},"end":{"line":331,"column":1}},"children":[{"type":"text","value":"In lieu of finding the root of ","position":{"start":{"line":331,"column":1},"end":{"line":331,"column":1}},"key":"k9GdWbne29"},{"type":"inlineMath","value":"f","position":{"start":{"line":331,"column":1},"end":{"line":331,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>","key":"GizJNhFnDf"},{"type":"text","value":" itself, we settle for finding the root of the tangent line approximation, which is trivial. Call this ","position":{"start":{"line":331,"column":1},"end":{"line":331,"column":1}},"key":"x3u824f1S4"},{"type":"inlineMath","value":"x_2","position":{"start":{"line":331,"column":1},"end":{"line":331,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">x_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"lsvHo4rHUo"},{"type":"text","value":", our next approximation to the root.","position":{"start":{"line":331,"column":1},"end":{"line":331,"column":1}},"key":"tgyDrY9wdM"}],"key":"UEHthFvOrL"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"x2 = x1 - y1 / slope1\nscatter(x2, 0)\ntitle('Root of the tangent')","key":"RREGgFymZy"},{"type":"output","id":"xY3xuncAETXLQilebr2en","data":[{"output_type":"execute_result","execution_count":29,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>x2 = 0.8679</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"x2 = 0.8679","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":29,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"6df63a4d5964b1b8b010b79fc000e1e4","path":"/fnc/build/6df63a4d5964b1b8b010b79fc000e1e4.png"}}}],"key":"CSeJF4REpS"}],"data":{},"key":"kiJzT2lzhv"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"y2 = f(x2)","key":"CYPhMbW4hl"},{"type":"output","id":"ksbGKdatoP6rkmcUyzBsg","data":[{"output_type":"execute_result","execution_count":30,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>y2 = 0.0672</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"y2 = 0.0672","content_type":"text/plain"}}}],"key":"rTBwgl809f"}],"data":{},"key":"QFLcD1SOI4"},{"type":"paragraph","position":{"start":{"line":343,"column":1},"end":{"line":343,"column":1}},"children":[{"type":"text","value":"The residual (i.e., value of ","position":{"start":{"line":343,"column":1},"end":{"line":343,"column":1}},"key":"nEH3AFShcx"},{"type":"inlineMath","value":"f","position":{"start":{"line":343,"column":1},"end":{"line":343,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>","key":"BFBtrpNwiz"},{"type":"text","value":") is smaller than before, but not zero. So we repeat the process with a new tangent line based on the latest point on the curve.","position":{"start":{"line":343,"column":1},"end":{"line":343,"column":1}},"key":"mvlf7XTQqg"}],"key":"ZnLSRzw8yc"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"cla, fplot(f, [0.8, 0.9])\nscatter(x2, y2)\nslope2 = dfdx(x2);\ntangent2 = @(x) y2 + slope2 * (x - x2);\nfplot(tangent2, [0.8, 0.9], '--')\nx3 = x2 - y2 / slope2;\nscatter(x3, 0)\ntitle('Next iteration')","key":"qMqoXaKgha"},{"type":"output","id":"OBVJ6O6EKnCNI8KwQ8eY3","data":[{"output_type":"execute_result","execution_count":31,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"abc3911b4b5c1ee8e3d8da1b5a2d18cf","path":"/fnc/build/abc3911b4b5c1ee8e3d8da1b5a2d18cf.png"}}}],"key":"X2sJeJ8llZ"}],"data":{},"key":"gjEsYKc4bm"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"y3 = f(x3)","key":"a0vH0qDK4u"},{"type":"output","id":"wysrZ-6CsHtzChboefQPS","data":[{"output_type":"execute_result","execution_count":32,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>y3 = 7.7309e-04</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"y3 = 7.7309e-04","content_type":"text/plain"}}}],"key":"IjHpqLOFFS"}],"data":{},"key":"FTWzRRSyxl"},{"type":"paragraph","position":{"start":{"line":360,"column":1},"end":{"line":360,"column":1}},"children":[{"type":"text","value":"Judging by the residual, we appear to be getting closer to the true root each time.","position":{"start":{"line":360,"column":1},"end":{"line":360,"column":1}},"key":"QaJw32JNut"}],"key":"jcJHZc9vlN"}],"label":"demo-newton-line-matlab","identifier":"demo-newton-line-matlab","html_id":"demo-newton-line-matlab","key":"HQWEWhq2j4"},{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-newton-converge","label":"demo-newton-converge","kind":"proof:example","position":{"start":{"line":364,"column":1},"end":{"line":364,"column":22}},"children":[{"type":"text","value":"Example ","key":"u9B7foZj95"},{"type":"text","value":"4.3.2","key":"LepUR9du7m"}],"template":"Example %s","enumerator":"4.3.2","resolved":true,"html_id":"demo-newton-converge","remote":true,"url":"/newton","dataUrl":"/newton.json","key":"GumXfDXWTm"}],"key":"mBVK2shhjk"},{"type":"paragraph","position":{"start":{"line":365,"column":1},"end":{"line":365,"column":1}},"children":[{"type":"text","value":"We again look at finding a solution of ","position":{"start":{"line":365,"column":1},"end":{"line":365,"column":1}},"key":"V2IiBHnMQU"},{"type":"inlineMath","value":"x e^x=2","position":{"start":{"line":365,"column":1},"end":{"line":365,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><msup><mi>e</mi><mi>x</mi></msup><mo>=</mo><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">x e^x=2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6644em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span></span></span></span>","key":"zasrVng00C"},{"type":"text","value":" near ","position":{"start":{"line":365,"column":1},"end":{"line":365,"column":1}},"key":"MTg0sUAvNB"},{"type":"inlineMath","value":"x=1","position":{"start":{"line":365,"column":1},"end":{"line":365,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">x=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"OLsyqDfNpV"},{"type":"text","value":". To apply Newton’s method, we need to calculate values of both the residual function ","position":{"start":{"line":365,"column":1},"end":{"line":365,"column":1}},"key":"dGUAvDc09j"},{"type":"inlineMath","value":"f","position":{"start":{"line":365,"column":1},"end":{"line":365,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>","key":"BE5nennw8r"},{"type":"text","value":" and its derivative.","position":{"start":{"line":365,"column":1},"end":{"line":365,"column":1}},"key":"v1gRL1sq2J"}],"key":"PxpL4du888"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"f = @(x) x.*exp(x) - 2;\ndfdx = @(x) exp(x).*(x+1);","key":"t6Ht7FQK52"},{"type":"output","id":"grnKNuvIDgq1h2Of25uhO","data":[],"key":"dksTj1SnYo"}],"data":{},"key":"FjTSVkOeEF"},{"type":"paragraph","position":{"start":{"line":372,"column":1},"end":{"line":372,"column":1}},"children":[{"type":"text","value":"We don’t know the exact root, so we use ","position":{"start":{"line":372,"column":1},"end":{"line":372,"column":1}},"key":"usr26AlJf5"},{"type":"inlineCode","value":"nlsolve","position":{"start":{"line":372,"column":1},"end":{"line":372,"column":1}},"key":"EQmYxu3mtG"},{"type":"text","value":" to determine a proxy for it.","position":{"start":{"line":372,"column":1},"end":{"line":372,"column":1}},"key":"EtNGbSslpp"}],"key":"Q0TKqDuQ7Z"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"format long,  r = fzero(f,1)","key":"HFi2aoGt4q"},{"type":"output","id":"BVIC-XRfWjzHF_wF11Ew1","data":[{"output_type":"execute_result","execution_count":34,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>r = \n   0.852605502013726\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"r = \n   0.852605502013726\n","content_type":"text/plain"}}}],"key":"edMn69XkRF"}],"data":{},"key":"P4e112eg9Y"},{"type":"paragraph","position":{"start":{"line":378,"column":1},"end":{"line":378,"column":1}},"children":[{"type":"text","value":"We use ","position":{"start":{"line":378,"column":1},"end":{"line":378,"column":1}},"key":"aWNcpzQFvj"},{"type":"inlineMath","value":"x_1=1","position":{"start":{"line":378,"column":1},"end":{"line":378,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">x_1=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"GJuo1OA6Zr"},{"type":"text","value":" as a starting guess and apply the iteration in a loop, storing the sequence of iterates in a vector.","position":{"start":{"line":378,"column":1},"end":{"line":378,"column":1}},"key":"qIFOoyIT0Q"}],"key":"RjLVTHNzN4"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"x = 1;\nfor k = 1:6\n    x(k+1) = x(k) - f(x(k)) / dfdx(x(k));\nend\nx","key":"RIaqVV1NgR"},{"type":"output","id":"MqWJwDBPnyxfubk9sSJYq","data":[{"output_type":"execute_result","execution_count":35,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>x = 1×7 double\n   1.000000000000000   0.867879441171442   0.852783373416410   0.852605526368922   0.852605502013726   0.852605502013725   0.852605502013725\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"x = 1×7 double\n   1.000000000000000   0.867879441171442   0.852783373416410   0.852605526368922   0.852605502013726   0.852605502013725   0.852605502013725\n","content_type":"text/plain"}}}],"key":"brlR8Qc1nn"}],"data":{},"key":"ddscQKnSBw"},{"type":"paragraph","position":{"start":{"line":388,"column":1},"end":{"line":388,"column":1}},"children":[{"type":"text","value":"Here is the sequence of errors.","position":{"start":{"line":388,"column":1},"end":{"line":388,"column":1}},"key":"klD2LUcmeQ"}],"key":"y8MUzismsz"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"format short e\nerr = x' - r","key":"BnPzTabzmC"},{"type":"output","id":"g5OL_U0GTI04fU1AYZt2C","data":[{"output_type":"execute_result","execution_count":36,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>err = 7×1 double\n   1.4739e-01\n   1.5274e-02\n   1.7787e-04\n   2.4355e-08\n   4.4409e-16\n  -1.1102e-16\n  -1.1102e-16\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"err = 7×1 double\n   1.4739e-01\n   1.5274e-02\n   1.7787e-04\n   2.4355e-08\n   4.4409e-16\n  -1.1102e-16\n  -1.1102e-16\n","content_type":"text/plain"}}}],"key":"pM2BAOrXy7"}],"data":{},"key":"wg79nXc7qq"},{"type":"paragraph","position":{"start":{"line":395,"column":1},"end":{"line":395,"column":1}},"children":[{"type":"text","value":"The exponents in the scientific notation definitely suggest a squaring sequence. We can check the evolution of the ratio in ","position":{"start":{"line":395,"column":1},"end":{"line":395,"column":1}},"key":"ZiB4Xz8eXY"},{"type":"crossReference","kind":"equation","identifier":"quadratictest","label":"quadratictest","children":[{"type":"text","value":"(","key":"Q49fb5eAoE"},{"type":"text","value":"4.3.9","key":"IQa3z0X3av"},{"type":"text","value":")","key":"csQpqe1ekK"}],"template":"(%s)","enumerator":"4.3.9","resolved":true,"html_id":"quadratictest","remote":true,"url":"/newton","dataUrl":"/newton.json","key":"Sj4vSCSsog"},{"type":"text","value":".","position":{"start":{"line":395,"column":1},"end":{"line":395,"column":1}},"key":"UrVnbjuYyX"}],"key":"BriAaGTefx"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"format short\nlogerr = log(abs(err))","key":"ny3TvS25PQ"},{"type":"output","id":"J0i2b6VKic0qjrsThKqnE","data":[{"output_type":"execute_result","execution_count":37,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>logerr = 7×1 double\n   -1.9146\n   -4.1816\n   -8.6344\n  -17.5305\n  -35.3505\n  -36.7368\n  -36.7368\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"logerr = 7×1 double\n   -1.9146\n   -4.1816\n   -8.6344\n  -17.5305\n  -35.3505\n  -36.7368\n  -36.7368\n","content_type":"text/plain"}}}],"key":"zDWRU5Ke0K"}],"data":{},"key":"cSm6VicH1l"},{"type":"paragraph","position":{"start":{"line":402,"column":1},"end":{"line":402,"column":1}},"children":[{"type":"text","value":"The clear convergence to 2 above constitutes good evidence of quadratic convergence.","position":{"start":{"line":402,"column":1},"end":{"line":402,"column":1}},"key":"Gjv7ZHSAuQ"}],"key":"Hn4muOGNE4"}],"label":"demo-newton-converge-matlab","identifier":"demo-newton-converge-matlab","html_id":"demo-newton-converge-matlab","key":"hq3zdnnTjI"},{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-newton-usage","label":"demo-newton-usage","kind":"proof:example","position":{"start":{"line":406,"column":1},"end":{"line":406,"column":19}},"children":[{"type":"text","value":"Example ","key":"KPsHqcQL2B"},{"type":"text","value":"4.3.3","key":"Y8XZgZNYAL"}],"template":"Example %s","enumerator":"4.3.3","resolved":true,"html_id":"demo-newton-usage","remote":true,"url":"/newton","dataUrl":"/newton.json","key":"SV8zw8jsTD"}],"key":"ukAXjBh7yn"},{"type":"paragraph","position":{"start":{"line":410,"column":1},"end":{"line":410,"column":1}},"children":[{"type":"text","value":"Suppose we want to evaluate the inverse of the function ","position":{"start":{"line":410,"column":1},"end":{"line":410,"column":1}},"key":"L4utwYLsmJ"},{"type":"inlineMath","value":"h(x)=e^x-x","position":{"start":{"line":410,"column":1},"end":{"line":410,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>h</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msup><mi>e</mi><mi>x</mi></msup><mo>−</mo><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">h(x)=e^x-x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">h</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7477em;vertical-align:-0.0833em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"pT5TWUIHPK"},{"type":"text","value":". This means solving ","position":{"start":{"line":410,"column":1},"end":{"line":410,"column":1}},"key":"GmIoseV6FY"},{"type":"inlineMath","value":"y=e^x-x","position":{"start":{"line":410,"column":1},"end":{"line":410,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi><mo>=</mo><msup><mi>e</mi><mi>x</mi></msup><mo>−</mo><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">y=e^x-x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7477em;vertical-align:-0.0833em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"JqE42dGixi"},{"type":"text","value":" for ","position":{"start":{"line":410,"column":1},"end":{"line":410,"column":1}},"key":"siwwJoNVfO"},{"type":"inlineMath","value":"x","position":{"start":{"line":410,"column":1},"end":{"line":410,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"ef4SM3vnLu"},{"type":"text","value":" when ","position":{"start":{"line":410,"column":1},"end":{"line":410,"column":1}},"key":"Aq6f19jkFQ"},{"type":"inlineMath","value":"y","position":{"start":{"line":410,"column":1},"end":{"line":410,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>","key":"qstgzaSmTa"},{"type":"text","value":" is given, which has no elementary form. If a value of ","position":{"start":{"line":410,"column":1},"end":{"line":410,"column":1}},"key":"Lamcp8lmtB"},{"type":"inlineMath","value":"y","position":{"start":{"line":410,"column":1},"end":{"line":410,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>","key":"SNMw7ZoY8g"},{"type":"text","value":" is given numerically, though, we simply have a rootfinding problem for ","position":{"start":{"line":410,"column":1},"end":{"line":410,"column":1}},"key":"LPMhRy8xkr"},{"type":"inlineMath","value":"f(x)=e^x-x-y","position":{"start":{"line":410,"column":1},"end":{"line":410,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msup><mi>e</mi><mi>x</mi></msup><mo>−</mo><mi>x</mi><mo>−</mo><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">f(x)=e^x-x-y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7477em;vertical-align:-0.0833em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>","key":"LQenUqVyKH"},{"type":"text","value":".","position":{"start":{"line":410,"column":1},"end":{"line":410,"column":1}},"key":"n7WBMO0E9C"}],"indexEntries":[{"entry":"Julia","subEntry":{"value":"enumerate","kind":"entry"},"emphasis":true}],"label":"index-gXU4iRC5zj","identifier":"index-gxu4irc5zj","html_id":"index-gxu4irc5zj","key":"yYHQfx7MPV"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"t2fBFb2m3C"}],"key":"EGeuOIy3eh"},{"type":"paragraph","position":{"start":{"line":413,"column":1},"end":{"line":413,"column":1}},"children":[{"type":"text","value":"When a function is created, it can refer to any variables in scope at that moment. Those values are locked in to the definition, which is called a ","position":{"start":{"line":413,"column":1},"end":{"line":413,"column":1}},"key":"ynsCzpzA0e"},{"type":"emphasis","position":{"start":{"line":413,"column":1},"end":{"line":413,"column":1}},"children":[{"type":"text","value":"closure","position":{"start":{"line":413,"column":1},"end":{"line":413,"column":1}},"key":"CthgPUUuGX"}],"key":"wK4jM5eXZo"},{"type":"text","value":". If the enclosed variables change values later, the function still uses the values it was created with.","position":{"start":{"line":413,"column":1},"end":{"line":413,"column":1}},"key":"zulxwgs41J"}],"key":"TTaFpfeqL4"}],"class":"dropdown","key":"ZJGSxik8gq"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"h = @(x) exp(x) - x;\ndh_dx = @(x) exp(x) - 1;\ny_ = linspace(h(0), h(2), 200);\nx_ = zeros(size(y_));\nfor i = 1:length(y_)\n    f = @(x) h(x) - y_(i);\n    df_dx = @(x) dh_dx(x);\n    x = newton(f, df_dx, 1);  x_(i) = x(end);\nend","key":"BYm2u1FVOh"},{"type":"output","id":"ZHHqYZNtWYRcEYeugRBq1","data":[],"key":"T3VvWtBtCt"}],"data":{},"key":"HwcA8l6Dlu"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf, fplot(h, [0, 2])\nhold on, axis equal\nplot(y_, x_)\nplot([0, max(y_)], [0, max(y_)], 'k--')\nxlabel('x'), ylabel('y')\nlegend('h(x)', 'inverse', 'y=x');","visibility":"hide","key":"fDiX59bEm4"},{"type":"output","id":"VDNxjnGgSFBKlIII8BK8B","data":[{"output_type":"execute_result","execution_count":39,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"ad08c4b1254e833622c4cdbd65a25f28","path":"/fnc/build/ad08c4b1254e833622c4cdbd65a25f28.png"}}}],"visibility":"show","key":"RZf1vRo6Cn"}],"data":{"tags":[]},"visibility":"show","key":"X4FiD8aaZk"}],"label":"demo-newton-usage-matlab","identifier":"demo-newton-usage-matlab","html_id":"demo-newton-usage-matlab","key":"o3KIEvZcTi"},{"type":"heading","depth":3,"position":{"start":{"line":439,"column":1},"end":{"line":439,"column":1}},"children":[{"type":"text","value":"4.4 ","position":{"start":{"line":439,"column":1},"end":{"line":439,"column":1}},"key":"Hyi5vDsL42"},{"type":"link","identifier":"section-nonlineqn-secant","label":"section-nonlineqn-secant","kind":"narrative","position":{"start":{"line":439,"column":5},"end":{"line":439,"column":30}},"url":"/secant","internal":true,"dataUrl":"/secant.json","children":[{"type":"text","value":"Interpolation-based methods","key":"RJucDigHAr"}],"key":"eR704kztga"}],"identifier":"id-4-4","label":"4.4 ","html_id":"id-4-4","implicit":true,"key":"tct16MA15A"},{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-secant-line","label":"demo-secant-line","kind":"proof:example","position":{"start":{"line":442,"column":1},"end":{"line":442,"column":18}},"children":[{"type":"text","value":"Example ","key":"mj10ViQjMp"},{"type":"text","value":"4.4.1","key":"oAJ2Ophwl7"}],"template":"Example %s","enumerator":"4.4.1","resolved":true,"html_id":"demo-secant-line","remote":true,"url":"/secant","dataUrl":"/secant.json","key":"Do1ZXe93Ou"}],"key":"Xhqu6hFrQY"},{"type":"paragraph","position":{"start":{"line":445,"column":1},"end":{"line":445,"column":1}},"children":[{"type":"text","value":"We return to finding a root of the equation ","position":{"start":{"line":445,"column":1},"end":{"line":445,"column":1}},"key":"JyuUFoi6Vg"},{"type":"inlineMath","value":"x e^x=2","position":{"start":{"line":445,"column":1},"end":{"line":445,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><msup><mi>e</mi><mi>x</mi></msup><mo>=</mo><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">x e^x=2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6644em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span></span></span></span>","key":"d7ryL1tzsK"},{"type":"text","value":".","position":{"start":{"line":445,"column":1},"end":{"line":445,"column":1}},"key":"FmwELDm1uL"}],"key":"Kg0bk4Uw2X"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"f = @(x) x .* exp(x) - 2;\nclf, fplot(f, [0.25, 1.25])\nset(gca, 'ygrid', 'on')  \nxlabel('x'), ylabel('y')    \ntitle('Objective function')","key":"Py5PVO5ukw"},{"type":"output","id":"InY8jieaIb15VirAaLr5e","data":[{"output_type":"execute_result","execution_count":40,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"57aa2e4a5a0936173cee920d9894ba48","path":"/fnc/build/57aa2e4a5a0936173cee920d9894ba48.png"}}}],"key":"EtgHJhpjOM"}],"data":{},"key":"QSX6CJ4rEH"},{"type":"paragraph","position":{"start":{"line":455,"column":1},"end":{"line":455,"column":1}},"children":[{"type":"text","value":"From the graph, it’s clear that there is a root near ","position":{"start":{"line":455,"column":1},"end":{"line":455,"column":1}},"key":"n4I9x8geIp"},{"type":"inlineMath","value":"x=1","position":{"start":{"line":455,"column":1},"end":{"line":455,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">x=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"r6KSgqA7hW"},{"type":"text","value":". To be more precise, there is a root in the interval ","position":{"start":{"line":455,"column":1},"end":{"line":455,"column":1}},"key":"rGoMsV7kP0"},{"type":"inlineMath","value":"[0.5,1]","position":{"start":{"line":455,"column":1},"end":{"line":455,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mn>0.5</mn><mo separator=\"true\">,</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[0.5,1]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">0.5</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]</span></span></span></span>","key":"tId1jB4zsG"},{"type":"text","value":". So let us take the endpoints of that interval as ","position":{"start":{"line":455,"column":1},"end":{"line":455,"column":1}},"key":"kzofgcD0eB"},{"type":"emphasis","position":{"start":{"line":455,"column":1},"end":{"line":455,"column":1}},"children":[{"type":"text","value":"two","position":{"start":{"line":455,"column":1},"end":{"line":455,"column":1}},"key":"K4KRzrDTpP"}],"key":"EJUNpegSdr"},{"type":"text","value":" initial approximations.","position":{"start":{"line":455,"column":1},"end":{"line":455,"column":1}},"key":"lsx9FjvYmw"}],"key":"ozIpSey4sP"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"x1 = 1;    y1 = f(x1);\nx2 = 0.5;  y2 = f(x2);\nhold on, scatter([x1, x2], [y1, y2])\ntitle('Two initial values')","key":"aiX6J6mCVB"},{"type":"output","id":"WuRRhlfnGqTIvDuJiuqOZ","data":[{"output_type":"execute_result","execution_count":41,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"a852ccd5e9d34e074b7747a2ef98ecd4","path":"/fnc/build/a852ccd5e9d34e074b7747a2ef98ecd4.png"}}}],"key":"qsQVyFl77w"}],"data":{},"key":"WuaSecFfb1"},{"type":"paragraph","position":{"start":{"line":464,"column":1},"end":{"line":464,"column":1}},"children":[{"type":"text","value":"Instead of constructing the tangent line by evaluating the derivative, we can construct a linear model function by drawing the line between the two points ","position":{"start":{"line":464,"column":1},"end":{"line":464,"column":1}},"key":"OElJ6rYOF1"},{"type":"inlineMath","value":"\\bigl(x_1,f(x_1)\\bigr)","position":{"start":{"line":464,"column":1},"end":{"line":464,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo fence=\"true\" stretchy=\"true\" minsize=\"1.2em\" maxsize=\"1.2em\">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><mi>f</mi><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy=\"false\">)</mo><mo fence=\"true\" stretchy=\"true\" minsize=\"1.2em\" maxsize=\"1.2em\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\bigl(x_1,f(x_1)\\bigr)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.2em;vertical-align:-0.35em;\"></span><span class=\"mopen\"><span class=\"delimsizing size1\">(</span></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mclose\"><span class=\"delimsizing size1\">)</span></span></span></span></span>","key":"ZpBvG07HMy"},{"type":"text","value":" and ","position":{"start":{"line":464,"column":1},"end":{"line":464,"column":1}},"key":"QooMbnR4Km"},{"type":"inlineMath","value":"\\bigl(x_2,f(x_2)\\bigr)","position":{"start":{"line":464,"column":1},"end":{"line":464,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo fence=\"true\" stretchy=\"true\" minsize=\"1.2em\" maxsize=\"1.2em\">(</mo><msub><mi>x</mi><mn>2</mn></msub><mo separator=\"true\">,</mo><mi>f</mi><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mn>2</mn></msub><mo stretchy=\"false\">)</mo><mo fence=\"true\" stretchy=\"true\" minsize=\"1.2em\" maxsize=\"1.2em\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\bigl(x_2,f(x_2)\\bigr)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.2em;vertical-align:-0.35em;\"></span><span class=\"mopen\"><span class=\"delimsizing size1\">(</span></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mclose\"><span class=\"delimsizing size1\">)</span></span></span></span></span>","key":"aBgjRzj68O"},{"type":"text","value":". This is called a ","position":{"start":{"line":464,"column":1},"end":{"line":464,"column":1}},"key":"T8Gd8ytscR"},{"type":"emphasis","position":{"start":{"line":464,"column":1},"end":{"line":464,"column":1}},"children":[{"type":"text","value":"secant line","position":{"start":{"line":464,"column":1},"end":{"line":464,"column":1}},"key":"I6z2N28J5M"}],"key":"atyPrroVtM"},{"type":"text","value":".","position":{"start":{"line":464,"column":1},"end":{"line":464,"column":1}},"key":"ynvDCQ4gxg"}],"key":"TtAnJk61vo"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"slope2 = (y2 - y1) / (x2 - x1);\nsecant2 = @(x) y2 + slope2 * (x - x2);","key":"SN2vMSUMVa"},{"type":"output","id":"ApcoM1_BRaGNvNPlmU4Em","data":[],"key":"D5iN4TMg3T"}],"data":{},"key":"GSMocjRAM9"},{"type":"paragraph","position":{"start":{"line":471,"column":1},"end":{"line":471,"column":1}},"children":[{"type":"text","value":"As before, the next root estimate in the iteration is the root of this linear model.","position":{"start":{"line":471,"column":1},"end":{"line":471,"column":1}},"key":"bfYL9rfu5o"}],"key":"Dgc3NYz07Z"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"fplot(secant2,[0.25, 1.25],'k--')\nx3 = x2 - y2 / slope2;\ny3 = f(x3)\nscatter(x3, 0)\ntitle('Next value')","key":"ljNjrqH7Up"},{"type":"output","id":"Aa6LnwYGfGLRIPzT4-M9X","data":[{"output_type":"execute_result","execution_count":43,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"1d10f55e1ef4f7fd02b206be79f57eff","path":"/fnc/build/1d10f55e1ef4f7fd02b206be79f57eff.png"}}},{"output_type":"execute_result","execution_count":43,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>y3 = -0.1777</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"y3 = -0.1777","content_type":"text/plain"}}}],"key":"Wbp3mycfBD"}],"data":{},"key":"ryBfvTDLPl"},{"type":"paragraph","position":{"start":{"line":481,"column":1},"end":{"line":481,"column":1}},"children":[{"type":"text","value":"For the next linear model, we use the line through the two most recent points. The next iterate is the root of that secant line, and so on.","position":{"start":{"line":481,"column":1},"end":{"line":481,"column":1}},"key":"jdMupFB70E"}],"key":"CsfvFIIiOD"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"slope2 = (y3 - y2) / (x3 - x2);\nx4 = x3 - y3 / slope2;\ny4 = f(x4)","key":"VPUmSaexhw"},{"type":"output","id":"IgD1qFYbLn7mVosHcssGz","data":[{"output_type":"execute_result","execution_count":44,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>y4 = 0.0572</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"y4 = 0.0572","content_type":"text/plain"}}}],"key":"wZ8dUldB4D"}],"data":{},"key":"YeqBNYWKHL"}],"label":"demo-secant-line-matlab","identifier":"demo-secant-line-matlab","html_id":"demo-secant-line-matlab","key":"EH2kt88lUF"},{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-secant-converge","label":"demo-secant-converge","kind":"proof:example","position":{"start":{"line":491,"column":1},"end":{"line":491,"column":22}},"children":[{"type":"text","value":"Example ","key":"d14JAUZ2Y0"},{"type":"text","value":"4.4.2","key":"yxsvvCtAov"}],"template":"Example %s","enumerator":"4.4.2","resolved":true,"html_id":"demo-secant-converge","remote":true,"url":"/secant","dataUrl":"/secant.json","key":"oMbNXs86qq"}],"key":"s77g8mSrv7"},{"type":"paragraph","position":{"start":{"line":492,"column":1},"end":{"line":492,"column":1}},"children":[{"type":"text","value":"We check the convergence of the secant method from ","position":{"start":{"line":492,"column":1},"end":{"line":492,"column":1}},"key":"qwme3iYJVb"},{"type":"crossReference","kind":"proof:example","identifier":"demo-secant-line","label":"demo-secant-line","children":[{"type":"text","value":"Demo ","key":"Nj5cqFEG7q"},{"type":"text","value":"4.4.1","key":"UYsGsulzVO"}],"template":"Example %s","enumerator":"4.4.1","resolved":true,"html_id":"demo-secant-line","remote":true,"url":"/secant","dataUrl":"/secant.json","key":"EGQ7w9GMog"},{"type":"text","value":".","position":{"start":{"line":492,"column":1},"end":{"line":492,"column":1}},"key":"hjxnMfZr4q"}],"key":"lVMN0PHpbC"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"f = @(x) x .* exp(x) - 2;\nx = secant(f, 1, 0.5);","key":"oBg8lsMkHm"},{"type":"output","id":"G3zOAGaJL2n63aG9mCpht","data":[],"key":"XW31J69oxj"}],"data":{},"key":"Nbf6lPd0GU"},{"type":"paragraph","position":{"start":{"line":499,"column":1},"end":{"line":499,"column":1}},"children":[{"type":"text","value":"We don’t know the exact root, so we use ","position":{"start":{"line":499,"column":1},"end":{"line":499,"column":1}},"key":"sxNzv6pyPr"},{"type":"inlineCode","value":"fzero","position":{"start":{"line":499,"column":1},"end":{"line":499,"column":1}},"key":"i3N0367wIr"},{"type":"text","value":" to get a good proxy.","position":{"start":{"line":499,"column":1},"end":{"line":499,"column":1}},"key":"N1hqFlnj4y"}],"key":"oZan0OuNrQ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"r = fzero(f, 1);","key":"LOnKG1FxAt"},{"type":"output","id":"Pupf1TCGmXShdzcGQ5T3o","data":[],"key":"WX8NmK0PP4"}],"data":{},"key":"POfXpX5Khw"},{"type":"paragraph","position":{"start":{"line":505,"column":1},"end":{"line":505,"column":1}},"children":[{"type":"text","value":"Here is the sequence of errors.","position":{"start":{"line":505,"column":1},"end":{"line":505,"column":1}},"key":"yX5pK6oUo2"}],"key":"tc1n3p2Ni7"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"format short e\nerr = r - x(1:end-1)'","key":"OqcaSgRdDD"},{"type":"output","id":"Vpk4tAd5el1aypR-JDXK4","data":[{"output_type":"execute_result","execution_count":47,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>err = 7×1 double\n  -1.4739e-01\n   3.5261e-01\n   4.2234e-02\n  -1.3026e-02\n   4.2748e-04\n   4.2699e-06\n  -1.4055e-09\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"err = 7×1 double\n  -1.4739e-01\n   3.5261e-01\n   4.2234e-02\n  -1.3026e-02\n   4.2748e-04\n   4.2699e-06\n  -1.4055e-09\n","content_type":"text/plain"}}}],"key":"ITJmRLDxDk"}],"data":{},"key":"YWGdWiBBc5"},{"type":"paragraph","position":{"start":{"line":512,"column":1},"end":{"line":512,"column":1}},"children":[{"type":"text","value":"It’s not easy to see the convergence rate by staring at these numbers. We can use ","position":{"start":{"line":512,"column":1},"end":{"line":512,"column":1}},"key":"HX7vrOaFZ3"},{"type":"crossReference","kind":"equation","identifier":"superlinear-rate","label":"superlinear-rate","children":[{"type":"text","value":"(","key":"N5TolwkHbo"},{"type":"text","value":"4.4.8","key":"iMrnNnWUQR"},{"type":"text","value":")","key":"jXjtk9CLcv"}],"template":"(%s)","enumerator":"4.4.8","resolved":true,"html_id":"superlinear-rate","remote":true,"url":"/secant","dataUrl":"/secant.json","key":"p63DkSB4Vf"},{"type":"text","value":" to try to expose the superlinear convergence rate.","position":{"start":{"line":512,"column":1},"end":{"line":512,"column":1}},"key":"E4tt5T9Cpl"}],"key":"dIoD90jYUM"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"logerr = log(abs(err));\nratios = logerr(2:end) ./ logerr(1:end-1)","key":"PUpIIXlrcF"},{"type":"output","id":"Y3RaIh55Q7izUmEbFvJEp","data":[{"output_type":"execute_result","execution_count":48,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ratios = 6×1 double\n   5.4444e-01\n   3.0358e+00\n   1.3717e+00\n   1.7871e+00\n   1.5938e+00\n   1.6486e+00\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ratios = 6×1 double\n   5.4444e-01\n   3.0358e+00\n   1.3717e+00\n   1.7871e+00\n   1.5938e+00\n   1.6486e+00\n","content_type":"text/plain"}}}],"key":"tCYEFSuE1U"}],"data":{},"key":"segEiPcJnj"},{"type":"paragraph","position":{"start":{"line":519,"column":1},"end":{"line":519,"column":1}},"children":[{"type":"text","value":"As expected, this settles in at around 1.618.","position":{"start":{"line":519,"column":1},"end":{"line":519,"column":1}},"key":"h32YKL2lqY"}],"key":"DFpak6aBnn"}],"label":"demo-secant-converge-matlab","identifier":"demo-secant-converge-matlab","html_id":"demo-secant-converge-matlab","key":"DmSuyjskzi"},{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-secant-iqi","label":"demo-secant-iqi","kind":"proof:example","position":{"start":{"line":523,"column":1},"end":{"line":523,"column":17}},"children":[{"type":"text","value":"Example ","key":"us1YlSMXrk"},{"type":"text","value":"4.4.3","key":"S33hhm0ppX"}],"template":"Example %s","enumerator":"4.4.3","resolved":true,"html_id":"demo-secant-iqi","remote":true,"url":"/secant","dataUrl":"/secant.json","key":"Dnp5Wlavg7"}],"key":"aHAkxXRowW"},{"type":"paragraph","position":{"start":{"line":524,"column":1},"end":{"line":524,"column":1}},"children":[{"type":"text","value":"Here we look for a root of ","position":{"start":{"line":524,"column":1},"end":{"line":524,"column":1}},"key":"xv4rxxhnTm"},{"type":"inlineMath","value":"x+\\cos(10x)","position":{"start":{"line":524,"column":1},"end":{"line":524,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mo>+</mo><mi>cos</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mn>10</mn><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">x+\\cos(10x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop\">cos</span><span class=\"mopen\">(</span><span class=\"mord\">10</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span>","key":"U4ZVg2T41q"},{"type":"text","value":" that is close to 1.","position":{"start":{"line":524,"column":1},"end":{"line":524,"column":1}},"key":"RAHU32gzY8"}],"key":"GASIYEfZUP"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"f = @(x) x + cos(10 * x);\ninterval = [0.5, 1.5];\nclf, fplot(f, interval)\nset(gca, 'ygrid', 'on'), axis(axis)   \ntitle('Objective function')    \nxlabel('x'), ylabel('y')    \nr = fzero(f, 1)","key":"JNHkEzwYrW"},{"type":"output","id":"8CxCKqZeV56d2y0xcAjSq","data":[{"output_type":"execute_result","execution_count":49,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"5cae23804c699313dff81bbe8cdd82b0","path":"/fnc/build/5cae23804c699313dff81bbe8cdd82b0.png"}}},{"output_type":"execute_result","execution_count":49,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>r = \n   9.6789e-01\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"r = \n   9.6789e-01\n","content_type":"text/plain"}}}],"key":"UdtbI1VtOc"}],"data":{},"key":"eOzj0Bv9td"},{"type":"paragraph","position":{"start":{"line":536,"column":1},"end":{"line":536,"column":1}},"children":[{"type":"text","value":"We choose three values to get the iteration started.","position":{"start":{"line":536,"column":1},"end":{"line":536,"column":1}},"key":"O5H3MB17zX"}],"key":"rHkJDKouwo"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"x = [0.8, 1.2, 1]';\ny = f(x);\nhold on, scatter(x, y)\ntitle('Three initial points')","key":"xpkrtxpbjE"},{"type":"output","id":"wKx070TDa4-MAcR9gdna_","data":[{"output_type":"execute_result","execution_count":50,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"32c4350dc4a80f7c2ba8085cd684c534","path":"/fnc/build/32c4350dc4a80f7c2ba8085cd684c534.png"}}}],"key":"TWB6zo8e8h"}],"data":{},"key":"cGpFgaIRQv"},{"type":"paragraph","position":{"start":{"line":545,"column":1},"end":{"line":545,"column":1}},"children":[{"type":"text","value":"If we were using forward interpolation, we would ask for the polynomial interpolant of ","position":{"start":{"line":545,"column":1},"end":{"line":545,"column":1}},"key":"kX758rsdaR"},{"type":"inlineMath","value":"y","position":{"start":{"line":545,"column":1},"end":{"line":545,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>","key":"jmgz1eiZ0W"},{"type":"text","value":" as a function of ","position":{"start":{"line":545,"column":1},"end":{"line":545,"column":1}},"key":"p7cBNVGerg"},{"type":"inlineMath","value":"x","position":{"start":{"line":545,"column":1},"end":{"line":545,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"lVhwmop9Uk"},{"type":"text","value":". But that parabola has no real roots.","position":{"start":{"line":545,"column":1},"end":{"line":545,"column":1}},"key":"QbkzLozTnU"}],"key":"UilOOyp5Yt"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"c = polyfit(x, y, 2);    % coefficients of interpolant\nq = @(x) polyval(c, x);\nfplot(q, interval, '--')\ntitle('Parabola model')","key":"S3Q9F2df97"},{"type":"output","id":"RRmOBSrSdOAJPlwPtaaDA","data":[{"output_type":"execute_result","execution_count":51,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"2297739ff894504f01e8c23a6414b250","path":"/fnc/build/2297739ff894504f01e8c23a6414b250.png"}}}],"key":"tHMjFCG14Y"}],"data":{},"key":"s4quQqAxGc"},{"type":"paragraph","position":{"start":{"line":554,"column":1},"end":{"line":554,"column":1}},"children":[{"type":"text","value":"To do inverse interpolation, we swap the roles of ","position":{"start":{"line":554,"column":1},"end":{"line":554,"column":1}},"key":"nUmNUDU3NF"},{"type":"inlineMath","value":"x","position":{"start":{"line":554,"column":1},"end":{"line":554,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"DvXvOxI6Tf"},{"type":"text","value":" and ","position":{"start":{"line":554,"column":1},"end":{"line":554,"column":1}},"key":"bW5jEHgEsW"},{"type":"inlineMath","value":"y","position":{"start":{"line":554,"column":1},"end":{"line":554,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>","key":"zQDLDV5rYJ"},{"type":"text","value":" in the interpolation.","position":{"start":{"line":554,"column":1},"end":{"line":554,"column":1}},"key":"WQLRBSauX0"}],"key":"Wr5kLiWgW8"},{"type":"code","lang":"","value":"```{tip}\n:class: dropdown\nBy giving two functions in the `fplot` call, we get the parametric plot $(q(y),y)$ as a function of $y$.\n```\n\n```{code-cell}\ncla, fplot(f, interval)\nscatter(x, y)     \nc = polyfit(y, x, 2);    % coefficients of interpolating polynomial\nq = @(y) polyval(c, y);\nfplot(q, @(y) y, ylim,'--')    % plot x=q(y), y=y\ntitle('Sideways parabola')    \n```\n\nWe seek the value of $x$ that makes $y$ zero. This means evaluating $q$ at zero.\n\n```{code-cell}\nx = [x; q(0)];\ny = [y; f(x(end))]\n```\n\nWe repeat the process a few more times.\n\n```{code-cell}\nfor k = 4:8\n    c = polyfit(y(k-2:k), x(k-2:k), 2);\n    x(k+1) = polyval(c, 0);\n    y(k+1) = f(x(k+1));\nend\ndisp('final residual:')\ny(end)\n```\n\nHere is the sequence of errors.\n\n```{code-cell}\nformat short e\nerr = x - r\n```\n\nThe convergence is probably superlinear:\n\n```{code-cell}\nlogerr = log(abs(err));\nratios = logerr(2:end) ./ logerr(1:end-1)\n```","position":{"start":{"line":555,"column":1},"end":{"line":601,"column":1}},"key":"SvzQYuuclk"}],"label":"demo-secant-iqi-matlab","identifier":"demo-secant-iqi-matlab","html_id":"demo-secant-iqi-matlab","key":"FBeKnAViFJ"},{"type":"heading","depth":3,"position":{"start":{"line":604,"column":1},"end":{"line":604,"column":1}},"children":[{"type":"text","value":"4.5 ","position":{"start":{"line":604,"column":1},"end":{"line":604,"column":1}},"key":"v7Gg6aLLIW"},{"type":"link","identifier":"section-nonlineqn-newtonsys","label":"section-nonlineqn-newtonsys","kind":"narrative","position":{"start":{"line":604,"column":5},"end":{"line":604,"column":33}},"url":"/newtonsys","internal":true,"dataUrl":"/newtonsys.json","children":[{"type":"text","value":"Newton for nonlinear systems","key":"gzskhTCjEe"}],"key":"TJ1Fij1mB6"}],"identifier":"id-4-5","label":"4.5 ","html_id":"id-4-5","implicit":true,"key":"tJpJZYM3PH"},{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-newtonsys-converge","label":"demo-newtonsys-converge","kind":"proof:example","position":{"start":{"line":606,"column":1},"end":{"line":606,"column":25}},"children":[{"type":"text","value":"Example ","key":"exXiODgOPo"},{"type":"text","value":"4.5.3","key":"Xtbs9R0OFy"}],"template":"Example %s","enumerator":"4.5.3","resolved":true,"html_id":"demo-newtonsys-converge","remote":true,"url":"/newtonsys","dataUrl":"/newtonsys.json","key":"qZaeZGqAgt"}],"key":"WX27PSxsM3"},{"type":"paragraph","position":{"start":{"line":607,"column":1},"end":{"line":607,"column":1}},"children":[{"type":"text","value":"A system of nonlinear equations is defined by its residual and Jacobian.","position":{"start":{"line":607,"column":1},"end":{"line":607,"column":1}},"key":"XK4VcDULtP"}],"key":"pWdW94ZIFA"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"hxogZqM6VJ"}],"key":"k6yBgYabWu"},{"type":"paragraph","position":{"start":{"line":610,"column":1},"end":{"line":610,"column":1}},"children":[{"type":"text","value":"This function needs to be defined within a script file or in a file of its own with the ","position":{"start":{"line":610,"column":1},"end":{"line":610,"column":1}},"key":"nijZv2cHBW"},{"type":"inlineCode","value":".m","position":{"start":{"line":610,"column":1},"end":{"line":610,"column":1}},"key":"WrWFOknGwJ"},{"type":"text","value":" extension.","position":{"start":{"line":610,"column":1},"end":{"line":610,"column":1}},"key":"vmiAT0Nm4y"}],"key":"XDUuUEa2tL"}],"class":"dropdown","key":"N2K2qCrsGU"},{"type":"include","file":"f45_nlsystem.m","literal":true,"filter":{},"children":[{"type":"code","value":"function [f, J] = nlsystem(x)\n    f = zeros(3, 1);   % ensure a column vector output\n    f(1) = exp(x(2) - x(1)) - 2;\n    f(2) = x(1) * x(2) + x(3);\n    f(3) = x(2) * x(3) + x(1)^2 - x(2);\n    J(1, :) = [-exp(x(2) - x(1)), exp(x(2) - x(1)), 0];\n    J(2, :) = [x(2), x(1), 1];\n    J(3, :) = [2 * x(1), x(3)-1, x(2)];\nend","lang":"matlab","filename":"f45_nlsystem.m","key":"FwGAPWrGij"}],"key":"lvJRUs1ebN"},{"type":"paragraph","position":{"start":{"line":617,"column":1},"end":{"line":617,"column":1}},"children":[{"type":"text","value":"Since our system function is defined in an external file here, we need to use ","position":{"start":{"line":617,"column":1},"end":{"line":617,"column":1}},"key":"Tb1KXMSRbI"},{"type":"inlineCode","value":"@","position":{"start":{"line":617,"column":1},"end":{"line":617,"column":1}},"key":"kej9fGRAPI"},{"type":"text","value":" in order to reference it as a function argument.","position":{"start":{"line":617,"column":1},"end":{"line":617,"column":1}},"key":"sJSfNuwlU0"}],"key":"vIXrglUyVw"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"nlsystem = @f45_nlsystem;\nx1 = [0; 0; 0];    % column vector!\nx = newtonsys(nlsystem, x1);\nnum_iter = size(x, 2)","key":"hgo4vMFbmc"},{"type":"output","id":"UuJA9QyeSgvYp_334z_gW","data":[{"output_type":"execute_result","execution_count":52,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>num_iter = \n     7\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"num_iter = \n     7\n","content_type":"text/plain"}}}],"key":"Klh0L0D7WB"}],"data":{},"key":"HBIcDdris4"},{"type":"paragraph","position":{"start":{"line":626,"column":1},"end":{"line":626,"column":1}},"children":[{"type":"text","value":"Let’s compute the residual of the last result in order to check the quality.","position":{"start":{"line":626,"column":1},"end":{"line":626,"column":1}},"key":"wWY5acR4Rs"}],"key":"LMrCsU9bu1"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"r = x(:, end)\nback_err = norm(nlsystem(r))","key":"n8NfEtxcoE"},{"type":"output","id":"HJSgccVmSVycVEa_sHAvR","data":[{"output_type":"execute_result","execution_count":53,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>r = 3×1 double\n  -4.5803e-01\n   2.3511e-01\n   1.0769e-01\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"r = 3×1 double\n  -4.5803e-01\n   2.3511e-01\n   1.0769e-01\n","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":53,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>back_err = \n   1.3878e-17\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"back_err = \n   1.3878e-17\n","content_type":"text/plain"}}}],"key":"eCWAOD34cF"}],"data":{},"key":"Dv3N498KoI"},{"type":"paragraph","position":{"start":{"line":633,"column":1},"end":{"line":633,"column":1}},"children":[{"type":"text","value":"We take the sequence errors in the first component of the solution, applying the log so that we can look at the exponents.","position":{"start":{"line":633,"column":1},"end":{"line":633,"column":1}},"key":"K8hz1COW8B"}],"key":"iwycMxRJhS"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"log10( abs(x(1, 1:end-1) - r(1)) )'","key":"LkVFo2xspq"},{"type":"output","id":"CvxZNmMN-vpmhvDVGV4RH","data":[{"output_type":"execute_result","execution_count":54,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = 6×1 double\n  -3.3910e-01\n  -2.6603e-01\n  -9.1882e-01\n  -2.2920e+00\n  -5.1929e+00\n  -9.9685e+00\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = 6×1 double\n  -3.3910e-01\n  -2.6603e-01\n  -9.1882e-01\n  -2.2920e+00\n  -5.1929e+00\n  -9.9685e+00\n","content_type":"text/plain"}}}],"key":"ZW9tpuugAH"}],"data":{},"key":"rSyo1fzMhz"},{"type":"paragraph","position":{"start":{"line":639,"column":1},"end":{"line":639,"column":1}},"children":[{"type":"text","value":"This sequence looks to be nearly doubling at each iteration, which is a good sign of quadratic convergence.","position":{"start":{"line":639,"column":1},"end":{"line":639,"column":1}},"key":"dVdXYosNU1"}],"key":"cAYeIiRbj3"}],"label":"demo-newtonsys-converge-matlab","identifier":"demo-newtonsys-converge-matlab","html_id":"demo-newtonsys-converge-matlab","key":"OPO2zM7N03"},{"type":"heading","depth":3,"position":{"start":{"line":642,"column":1},"end":{"line":642,"column":1}},"children":[{"type":"text","value":"4.6 ","position":{"start":{"line":642,"column":1},"end":{"line":642,"column":1}},"key":"iZKwTjvEWB"},{"type":"link","identifier":"section-nonlineqn-quasinewton","label":"section-nonlineqn-quasinewton","kind":"narrative","position":{"start":{"line":642,"column":5},"end":{"line":642,"column":35}},"url":"/quasinewton","internal":true,"dataUrl":"/quasinewton.json","children":[{"type":"text","value":"Quasi-Newton methods","key":"uZEc0j1moG"}],"key":"oF1j9pRtDg"}],"identifier":"id-4-6","label":"4.6 ","html_id":"id-4-6","implicit":true,"key":"XXUx8yPj50"},{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-quasi-levenberg","label":"demo-quasi-levenberg","kind":"proof:example","position":{"start":{"line":644,"column":1},"end":{"line":644,"column":22}},"children":[{"type":"text","value":"Example ","key":"xNMNT3ciQ3"},{"type":"text","value":"4.6.1","key":"Wdj75on0x5"}],"template":"Example %s","enumerator":"4.6.1","resolved":true,"html_id":"demo-quasi-levenberg","remote":true,"url":"/quasinewton","dataUrl":"/quasinewton.json","key":"WoKKA1ecHm"}],"key":"IxHpwF6JI3"},{"type":"paragraph","position":{"start":{"line":646,"column":1},"end":{"line":646,"column":1}},"children":[{"type":"text","value":"To solve a nonlinear system, we need to code only the function defining the system, and not its Jacobian.","position":{"start":{"line":646,"column":1},"end":{"line":646,"column":1}},"key":"jALsrBKewh"}],"key":"Z7Da7amPbh"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"sQKZxuIyPU"}],"key":"UpPnML4qJp"},{"type":"paragraph","position":{"start":{"line":649,"column":1},"end":{"line":649,"column":1}},"children":[{"type":"text","value":"A rule of thumb is that if you use a function as an input argument for another function, there needs to be an ","position":{"start":{"line":649,"column":1},"end":{"line":649,"column":1}},"key":"NXtM9Rb08O"},{"type":"inlineCode","value":"@","position":{"start":{"line":649,"column":1},"end":{"line":649,"column":1}},"key":"IrvEO451Q1"},{"type":"text","value":" involved once: either for an anonymous definition or to reference a function defined elsewhere.","position":{"start":{"line":649,"column":1},"end":{"line":649,"column":1}},"key":"ucx1Pv4Lzy"}],"key":"gitJFnF2oB"},{"type":"include","file":"f45_nlsystem.m","literal":true,"filter":{},"children":[{"type":"code","value":"function [f, J] = nlsystem(x)\n    f = zeros(3, 1);   % ensure a column vector output\n    f(1) = exp(x(2) - x(1)) - 2;\n    f(2) = x(1) * x(2) + x(3);\n    f(3) = x(2) * x(3) + x(1)^2 - x(2);\n    J(1, :) = [-exp(x(2) - x(1)), exp(x(2) - x(1)), 0];\n    J(2, :) = [x(2), x(1), 1];\n    J(3, :) = [2 * x(1), x(3)-1, x(2)];\nend","lang":"matlab","filename":"f45_nlsystem.m","key":"hkxev1kqsN"}],"key":"Dk5m30iAhd"}],"class":"dropdown","key":"eCeFV5L9pD"},{"type":"paragraph","position":{"start":{"line":653,"column":1},"end":{"line":653,"column":1}},"children":[{"type":"text","value":"In all other respects usage is the same as for the ","position":{"start":{"line":653,"column":1},"end":{"line":653,"column":1}},"key":"yJsIVcBXMo"},{"type":"inlineCode","value":"newtonsys","position":{"start":{"line":653,"column":1},"end":{"line":653,"column":1}},"key":"iNWiSZelIC"},{"type":"text","value":" function.","position":{"start":{"line":653,"column":1},"end":{"line":653,"column":1}},"key":"keBj9f3VAw"}],"key":"pJ5rAIl5J3"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"f = @f46_nlsystem;\nx1 = [0; 0; 0];   \nx = levenberg(f, x1);","key":"vEUZiDzqVu"},{"type":"output","id":"2lXlTaZs6XnplQ3Egee-h","data":[],"key":"Q2scXoj2Pn"}],"data":{},"key":"SOujhO5Q2A"},{"type":"paragraph","position":{"start":{"line":659,"column":1},"end":{"line":659,"column":1}},"children":[{"type":"text","value":"It’s always a good idea to check the accuracy of the root, by measuring the residual (backward error).","position":{"start":{"line":659,"column":1},"end":{"line":659,"column":1}},"key":"eBqUkO8GrB"}],"key":"qboN43ZeRv"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"r = x(:, end)\nbackward_err = norm(f(r))","key":"hqWxU62FBC"},{"type":"output","id":"MIgCBlkhGUxCi4CKj9nYc","data":[{"output_type":"execute_result","execution_count":56,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>r = 3×1 double\n  -4.5803e-01\n   2.3511e-01\n   1.0769e-01\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"r = 3×1 double\n  -4.5803e-01\n   2.3511e-01\n   1.0769e-01\n","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":56,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>backward_err = \n   1.2708e-13\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"backward_err = \n   1.2708e-13\n","content_type":"text/plain"}}}],"key":"mge45iq8oa"}],"data":{},"key":"dOhIMAd18B"},{"type":"paragraph","position":{"start":{"line":664,"column":1},"end":{"line":664,"column":1}},"children":[{"type":"text","value":"Looking at the convergence of the first component, we find a rate between linear and quadratic, like with the secant method.","position":{"start":{"line":664,"column":1},"end":{"line":664,"column":1}},"key":"QIHtOA3Q82"}],"key":"LGUsdzKAmf"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"log10( abs(x(1, 1:end-1) - r(1)) )'","key":"D8IgshzIKr"},{"type":"output","id":"OrvUj1sKm2pjMS1Ula28W","data":[{"output_type":"execute_result","execution_count":57,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = 11×1 double\n  -3.3910e-01\n  -4.2705e-01\n  -1.4439e+00\n  -1.5517e+00\n  -2.7571e+00\n  -2.6208e+00\n  -3.4403e+00\n  -4.9947e+00\n  -7.3448e+00\n  -8.7366e+00\n...</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = 11×1 double\n  -3.3910e-01\n  -4.2705e-01\n  -1.4439e+00\n  -1.5517e+00\n  -2.7571e+00\n  -2.6208e+00\n  -3.4403e+00\n  -4.9947e+00\n  -7.3448e+00\n  -8.7366e+00\n...","content_type":"text/plain"}}}],"key":"QxPHW5SDk4"}],"data":{},"key":"ypOJ9PdQK2"}],"label":"demo-quasi-levenberg-matlab","identifier":"demo-quasi-levenberg-matlab","html_id":"demo-quasi-levenberg-matlab","key":"GhqmFR0K4x"},{"type":"heading","depth":3,"position":{"start":{"line":669,"column":1},"end":{"line":669,"column":1}},"children":[{"type":"text","value":"4.7 ","position":{"start":{"line":669,"column":1},"end":{"line":669,"column":1}},"key":"G1ci7PPUOn"},{"type":"link","identifier":"section-nonlineqn-nlsq","label":"section-nonlineqn-nlsq","kind":"narrative","position":{"start":{"line":669,"column":5},"end":{"line":669,"column":28}},"url":"/nlsq","internal":true,"dataUrl":"/nlsq.json","children":[{"type":"text","value":"Nonlinear least squares","key":"RpkPZRCAOB"}],"key":"NHYeSalnlB"}],"identifier":"id-4-7","label":"4.7 ","html_id":"id-4-7","implicit":true,"key":"Kooi2G2OhD"},{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-nlsq-converge","label":"demo-nlsq-converge","kind":"proof:example","position":{"start":{"line":671,"column":1},"end":{"line":671,"column":20}},"children":[{"type":"text","value":"Example ","key":"v7Js4AGSU5"},{"type":"text","value":"4.7.1","key":"kxMlEOr09W"}],"template":"Example %s","enumerator":"4.7.1","resolved":true,"html_id":"demo-nlsq-converge","remote":true,"url":"/nlsq","dataUrl":"/nlsq.json","key":"FhYT3QIaGh"}],"key":"BWjquMnaRD"},{"type":"paragraph","position":{"start":{"line":672,"column":1},"end":{"line":672,"column":1}},"children":[{"type":"text","value":"We will observe the convergence of ","position":{"start":{"line":672,"column":1},"end":{"line":672,"column":1}},"key":"ZrObSfYqIw"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-levenberg","label":"function-levenberg","children":[{"type":"text","value":"Function ","key":"yDHXhYhcnl"},{"type":"text","value":"4.6.3","key":"zdSd29HPhu"}],"template":"Algorithm %s","enumerator":"4.6.3","resolved":true,"html_id":"function-levenberg","remote":true,"url":"/quasinewton","dataUrl":"/quasinewton.json","key":"sF1u9sns0r"},{"type":"text","value":" for different levels of the minimum least-squares residual. We start with a function mapping from ","position":{"start":{"line":672,"column":1},"end":{"line":672,"column":1}},"key":"fj1ycTogYl"},{"type":"inlineMath","value":"\\real^2","position":{"start":{"line":672,"column":1},"end":{"line":672,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi mathvariant=\"double-struck\">R</mi><mn>2</mn></msup></mrow><annotation encoding=\"application/x-tex\">\\real^2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathbb\">R</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span>","key":"K7qUVRx6sg"},{"type":"text","value":" into ","position":{"start":{"line":672,"column":1},"end":{"line":672,"column":1}},"key":"swPVEYBPEC"},{"type":"inlineMath","value":"\\real^3","position":{"start":{"line":672,"column":1},"end":{"line":672,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi mathvariant=\"double-struck\">R</mi><mn>3</mn></msup></mrow><annotation encoding=\"application/x-tex\">\\real^3</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathbb\">R</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span></span></span></span></span></span></span></span>","key":"o528P3wyQZ"},{"type":"text","value":", and a point that will be near the optimum.","position":{"start":{"line":672,"column":1},"end":{"line":672,"column":1}},"key":"eaRzqfFSYh"}],"key":"ded9mGqOmI"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"g = @(x) [sin(x(1) + x(2)); cos(x(1) - x(2)); exp(x(1) - x(2))];\np = [1; 1];","key":"vNmTB12dqR"},{"type":"output","id":"eAowan2gp2I21LmFz2RLj","data":[],"key":"wWtol5w45f"}],"data":{},"key":"bYob9QIluC"},{"type":"paragraph","position":{"start":{"line":680,"column":1},"end":{"line":680,"column":1}},"children":[{"type":"text","value":"The function ","position":{"start":{"line":680,"column":1},"end":{"line":680,"column":1}},"key":"GC97YLMXHf"},{"type":"inlineMath","value":"\\mathbf{g}(\\mathbf{x}) - \\mathbf{g}(\\mathbf{p})","position":{"start":{"line":680,"column":1},"end":{"line":680,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">g</mi><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">x</mi><mo stretchy=\"false\">)</mo><mo>−</mo><mi mathvariant=\"bold\">g</mi><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">p</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\mathbf{g}(\\mathbf{x}) - \\mathbf{g}(\\mathbf{p})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">g</span><span class=\"mopen\">(</span><span class=\"mord mathbf\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">g</span><span class=\"mopen\">(</span><span class=\"mord mathbf\">p</span><span class=\"mclose\">)</span></span></span></span>","key":"reCRbKdrhq"},{"type":"text","value":" obviously has a zero residual at ","position":{"start":{"line":680,"column":1},"end":{"line":680,"column":1}},"key":"D8nbGjGuxO"},{"type":"inlineMath","value":"\\mathbf{p}","position":{"start":{"line":680,"column":1},"end":{"line":680,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">p</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{p}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6389em;vertical-align:-0.1944em;\"></span><span class=\"mord mathbf\">p</span></span></span></span>","key":"S7NjiO6Wbi"},{"type":"text","value":". We’ll make different perturbations of that function in order to create nonzero residuals.","position":{"start":{"line":680,"column":1},"end":{"line":680,"column":1}},"key":"sgxSNjvoMu"}],"indexEntries":[{"entry":"Julia","subEntry":{"value":"@sprintf","kind":"entry"},"emphasis":true}],"label":"index-oh0kaIALPX","identifier":"index-oh0kaialpx","html_id":"index-oh0kaialpx","key":"YXaUS6Z7Ti"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"P4ZEyf2ljt"}],"key":"OrdTbuehs2"},{"type":"paragraph","position":{"start":{"line":684,"column":1},"end":{"line":684,"column":1}},"children":[{"type":"inlineCode","value":"@sprintf","position":{"start":{"line":684,"column":1},"end":{"line":684,"column":1}},"key":"uhwMOwMhM7"},{"type":"text","value":" is a way to format numerical values as strings, patterned after the C function ","position":{"start":{"line":684,"column":1},"end":{"line":684,"column":1}},"key":"ezFfVjDDrL"},{"type":"inlineCode","value":"printf","position":{"start":{"line":684,"column":1},"end":{"line":684,"column":1}},"key":"wsQrJiUBWn"},{"type":"text","value":".","position":{"start":{"line":684,"column":1},"end":{"line":684,"column":1}},"key":"Sc7qosgg4R"}],"key":"yMhOOamYHB"}],"class":"dropdown","key":"pwioNZCUS6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf\nlabels = [];\nfor R = [1e-3, 1e-2, 1e-1]\n    % Define the perturbed function.\n    f = @(x) g(x) - g(p) + R * [-1; 1; -1] / sqrt(3)\n    x = levenberg(f, [0; 0]);\n    r = x(:, end);\n    err = abs(x(1, 1:end-1) - r(1));\n    normres = norm(f(r));\n    semilogy(err), hold on\n    labels = [labels; sprintf(\"R=%.2g\", normres)];\nend\nxlabel(\"iteration\"), ylabel(\"error\")\nlegend(labels);","key":"BVBsm45sgG"},{"type":"output","id":"7Q1IiDF-9enpYyrr-JVCm","data":[{"output_type":"execute_result","execution_count":59,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"1e3266afcc60d7b03bf4e3d9911ea18d","path":"/fnc/build/1e3266afcc60d7b03bf4e3d9911ea18d.png"}}},{"output_type":"execute_result","execution_count":59,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>f = function_handle with value:\n    @(x)g(x)-g(p)+R*[-1;1;-1]/sqrt(3)\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"f = function_handle with value:\n    @(x)g(x)-g(p)+R*[-1;1;-1]/sqrt(3)\n","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":59,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>f = function_handle with value:\n    @(x)g(x)-g(p)+R*[-1;1;-1]/sqrt(3)\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"f = function_handle with value:\n    @(x)g(x)-g(p)+R*[-1;1;-1]/sqrt(3)\n","content_type":"text/plain"}}},{"output_type":"stream","name":"stderr","text":"Warning: Iteration did not find a root."},{"output_type":"execute_result","execution_count":59,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>f = function_handle with value:\n    @(x)g(x)-g(p)+R*[-1;1;-1]/sqrt(3)\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"f = function_handle with value:\n    @(x)g(x)-g(p)+R*[-1;1;-1]/sqrt(3)\n","content_type":"text/plain"}}},{"output_type":"stream","name":"stderr","text":"Warning: Iteration did not find a root."}],"key":"MYu6aLVRLd"}],"data":{},"key":"DP24esHTsc"},{"type":"paragraph","position":{"start":{"line":704,"column":1},"end":{"line":704,"column":1}},"children":[{"type":"text","value":"In the least perturbed case, where the minimized residual is less than ","position":{"start":{"line":704,"column":1},"end":{"line":704,"column":1}},"key":"qpmQmm0oSs"},{"type":"span","position":{"start":{"line":704,"column":1},"end":{"line":704,"column":1}},"children":[{"type":"text","value":"10","key":"mzX4e4je9b"},{"type":"superscript","children":[{"type":"text","value":"-3","key":"z7zjjIrlJL"}],"key":"OnGaZy44Yf"}],"key":"Y6OAW57v8B"},{"type":"text","value":", the convergence is plausibly quadratic. At the next level up, the convergence starts similarly but suddenly stagnates for a long time. In the most perturbed case, the quadratic phase is nearly gone and the overall shape looks linear.","position":{"start":{"line":704,"column":1},"end":{"line":704,"column":1}},"key":"uzKGfbybpb"}],"key":"pWLNanR1cs"}],"label":"demo-nlsq-converge-matlab","identifier":"demo-nlsq-converge-matlab","html_id":"demo-nlsq-converge-matlab","key":"wNc0xpxCbA"},{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-nlsq-mm","label":"demo-nlsq-MM","kind":"proof:example","position":{"start":{"line":708,"column":1},"end":{"line":708,"column":14}},"children":[{"type":"text","value":"Example ","key":"IJQVsuITT3"},{"type":"text","value":"4.7.2","key":"kuCWWWNwsr"}],"template":"Example %s","enumerator":"4.7.2","resolved":true,"html_id":"demo-nlsq-mm","remote":true,"url":"/nlsq","dataUrl":"/nlsq.json","key":"BcBMmrgGK0"}],"key":"XLxwFDUEt5"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"m = 25; V = 2; Km = 0.5;\ns = linspace(0.05, 6, m)';\nw = V * s ./ (Km + s);                      % exactly on the curve\nw = w + 0.15 * cos(2 * exp(s / 16) .* s);   % noise added\nclf, fplot(@(s) V * s ./ (Km + s), [0, 6], '--')\nhold on, scatter(s, w)\nxlabel('concentration'), ylabel('reaction rate')    \nlabels = [\"ideal\", \"noisy data\"];    \nlegend(labels, 'location', 'east');","key":"gob7B72rVx"},{"type":"output","id":"q4GGIGB7Soqozz2Dw_rJ9","data":[{"output_type":"execute_result","execution_count":60,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"6a5e28862267a704be8a69cb61c2c5e1","path":"/fnc/build/6a5e28862267a704be8a69cb61c2c5e1.png"}}}],"key":"mngI9msagL"}],"data":{},"key":"qo0k9NaWJw"},{"type":"paragraph","position":{"start":{"line":721,"column":1},"end":{"line":721,"column":1}},"children":[{"type":"text","value":"The idea is to pretend that we know nothing of the origins of this data and use nonlinear least squares to find the parameters in the theoretical model function ","position":{"start":{"line":721,"column":1},"end":{"line":721,"column":1}},"key":"vel1iPywcG"},{"type":"inlineMath","value":"v(s)","position":{"start":{"line":721,"column":1},"end":{"line":721,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>v</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">v(s)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">s</span><span class=\"mclose\">)</span></span></span></span>","key":"zyqDV7OuSG"},{"type":"text","value":". In ","position":{"start":{"line":721,"column":1},"end":{"line":721,"column":1}},"key":"iC9gNfjf02"},{"type":"crossReference","kind":"equation","identifier":"nlsq-misfit","label":"nlsq-misfit","children":[{"type":"text","value":"(","key":"aX3d6hGybd"},{"type":"text","value":"4.7.2","key":"PcpZacm95a"},{"type":"text","value":")","key":"oZRW40clno"}],"template":"(%s)","enumerator":"4.7.2","resolved":true,"html_id":"nlsq-misfit","remote":true,"url":"/nlsq","dataUrl":"/nlsq.json","key":"ZXriduaaBm"},{"type":"text","value":", the ","position":{"start":{"line":721,"column":1},"end":{"line":721,"column":1}},"key":"d8jADbslpi"},{"type":"inlineMath","value":"s","position":{"start":{"line":721,"column":1},"end":{"line":721,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>s</mi></mrow><annotation encoding=\"application/x-tex\">s</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">s</span></span></span></span>","key":"RCLy1o23bz"},{"type":"text","value":" variable plays the role of ","position":{"start":{"line":721,"column":1},"end":{"line":721,"column":1}},"key":"aEoUFdzXjS"},{"type":"inlineMath","value":"t","position":{"start":{"line":721,"column":1},"end":{"line":721,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span></span></span></span>","key":"KwmsxrCte5"},{"type":"text","value":", and ","position":{"start":{"line":721,"column":1},"end":{"line":721,"column":1}},"key":"RFtgoo5o98"},{"type":"inlineMath","value":"v","position":{"start":{"line":721,"column":1},"end":{"line":721,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>v</mi></mrow><annotation encoding=\"application/x-tex\">v</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span></span></span></span>","key":"YI8MVQLovG"},{"type":"text","value":" plays the role of ","position":{"start":{"line":721,"column":1},"end":{"line":721,"column":1}},"key":"SqqURQ4K4e"},{"type":"inlineMath","value":"g","position":{"start":{"line":721,"column":1},"end":{"line":721,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>g</mi></mrow><annotation encoding=\"application/x-tex\">g</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span></span></span></span>","key":"aLB8fxwvAs"},{"type":"text","value":". In the Jacobian, the derivatives are with respect to the parameters in ","position":{"start":{"line":721,"column":1},"end":{"line":721,"column":1}},"key":"uAA1AUCLHo"},{"type":"inlineMath","value":"\\mathbf{x}","position":{"start":{"line":721,"column":1},"end":{"line":721,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">x</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{x}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4444em;\"></span><span class=\"mord mathbf\">x</span></span></span></span>","key":"AoXYtgZi4E"},{"type":"text","value":".","position":{"start":{"line":721,"column":1},"end":{"line":721,"column":1}},"key":"mt9dUeXokg"}],"key":"IxGeFxwf0s"},{"type":"include","file":"f47_misfit.m","literal":true,"filter":{},"children":[{"type":"code","value":"function [f, J] = misfit(c, s, w)\n    V = c(1);   Km = c(2);\n    f = V * s ./ (Km + s) - w;\n    J(:,1) = s ./ (Km + s);            % d/d(V)\n    J(:,2) = -V * s ./ (Km + s).^2;    % d/d(Km)\nend\n","lang":"matlab","filename":"f47_misfit.m","key":"Upu7li4dYb"}],"key":"LJ0DR5rEvI"},{"type":"paragraph","position":{"start":{"line":727,"column":1},"end":{"line":727,"column":1}},"children":[{"type":"text","value":"The misfit function above has to know the parameters ","position":{"start":{"line":727,"column":1},"end":{"line":727,"column":1}},"key":"b4lDHTYGgt"},{"type":"inlineCode","value":"x","position":{"start":{"line":727,"column":1},"end":{"line":727,"column":1}},"key":"IJsc9yrNYT"},{"type":"text","value":" that are being optimized as well as the data ","position":{"start":{"line":727,"column":1},"end":{"line":727,"column":1}},"key":"J0rxBIzpUc"},{"type":"inlineCode","value":"s","position":{"start":{"line":727,"column":1},"end":{"line":727,"column":1}},"key":"cjai4M7O5z"},{"type":"text","value":" and ","position":{"start":{"line":727,"column":1},"end":{"line":727,"column":1}},"key":"bL4tRJQKjI"},{"type":"inlineCode","value":"w","position":{"start":{"line":727,"column":1},"end":{"line":727,"column":1}},"key":"vpCsWE1Zad"},{"type":"text","value":" that remain fixed. We use a closure to pass the data values along.","position":{"start":{"line":727,"column":1},"end":{"line":727,"column":1}},"key":"chrWsliZQl"}],"key":"W3ucLnP6S0"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"f = @(x) f47_misfit(x, s, w);","key":"LHi8Xpuaue"},{"type":"output","id":"vvhV8GhBMisuOeRo44DN2","data":[],"key":"Yu67QrZQUZ"}],"data":{},"key":"vQFDV1mXoI"},{"type":"paragraph","position":{"start":{"line":733,"column":1},"end":{"line":733,"column":1}},"children":[{"type":"text","value":"Now we have a function that accepts a single 2-vector input and returns a 25-vector output. We can pass this function to ","position":{"start":{"line":733,"column":1},"end":{"line":733,"column":1}},"key":"pJHZB9oF6m"},{"type":"inlineCode","value":"levenberg","position":{"start":{"line":733,"column":1},"end":{"line":733,"column":1}},"key":"EtpWtDMrsK"},{"type":"text","value":" to find the best-fit parameters.","position":{"start":{"line":733,"column":1},"end":{"line":733,"column":1}},"key":"cYDT61ETQz"}],"key":"OtpfyjnruT"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"x1 = [1; 0.75];\nx = newtonsys(f, x1);\nV = x(1, end),  Km = x(2, end)     % final values\nmodel = @(s) V * s ./ (Km + s);    % best-fit model","key":"uWqwCAb1A7"},{"type":"output","id":"-I5uMmi_GZkeylYL_seRd","data":[{"output_type":"execute_result","execution_count":62,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>V = \n   1.9687e+00\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"V = \n   1.9687e+00\n","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":62,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>Km = \n   4.6930e-01\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"Km = \n   4.6930e-01\n","content_type":"text/plain"}}}],"key":"hAKRAdngoL"}],"data":{},"key":"k5PDhKXU2T"},{"type":"paragraph","position":{"start":{"line":742,"column":1},"end":{"line":742,"column":1}},"children":[{"type":"text","value":"The final values are reasonably close to the values ","position":{"start":{"line":742,"column":1},"end":{"line":742,"column":1}},"key":"oZ7GqL58qc"},{"type":"inlineMath","value":"V=2","position":{"start":{"line":742,"column":1},"end":{"line":742,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>V</mi><mo>=</mo><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">V=2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span></span></span></span>","key":"G00dU3nnnr"},{"type":"text","value":", ","position":{"start":{"line":742,"column":1},"end":{"line":742,"column":1}},"key":"drOr7X7PC7"},{"type":"inlineMath","value":"K_m=0.5","position":{"start":{"line":742,"column":1},"end":{"line":742,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>K</mi><mi>m</mi></msub><mo>=</mo><mn>0.5</mn></mrow><annotation encoding=\"application/x-tex\">K_m=0.5</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0.5</span></span></span></span>","key":"RumVmAgRl4"},{"type":"text","value":" that we used to generate the noise-free data. Graphically, the model looks close to the original data:","position":{"start":{"line":742,"column":1},"end":{"line":742,"column":1}},"key":"rILOUZN6iW"}],"key":"E0IohPrtxP"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"final_misfit_norm = norm(model(s) - w) \nhold on, fplot(model, [0, 6])\ntitle('Michaelis-Menten fitting')    \nlabels = [labels, \"nonlinear fit\"];    \nlegend(labels, 'location', 'east');","key":"hZxyZtcCJL"},{"type":"output","id":"jJoPQVyrExa1JX-ErYIwr","data":[{"output_type":"execute_result","execution_count":63,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>final_misfit_norm = \n   5.2340e-01\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"final_misfit_norm = \n   5.2340e-01\n","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":63,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"95b65fffd708700d546e0a7862c53c29","path":"/fnc/build/95b65fffd708700d546e0a7862c53c29.png"}}}],"key":"XV5AgJsjbF"}],"data":{},"key":"yWuLwVyR8j"},{"type":"paragraph","position":{"start":{"line":752,"column":1},"end":{"line":752,"column":1}},"children":[{"type":"text","value":"For this particular model, we also have the option of linearizing the fit process. Rewrite the model as","position":{"start":{"line":752,"column":1},"end":{"line":752,"column":1}},"key":"VMRKsW014g"}],"key":"xoodbn3NlR"},{"type":"math","value":"\\frac{1}{w} = \\frac{\\alpha}{s} + \\beta = \\alpha \\cdot s^{-1} + \\beta","enumerated":false,"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mfrac><mn>1</mn><mi>w</mi></mfrac><mo>=</mo><mfrac><mi>α</mi><mi>s</mi></mfrac><mo>+</mo><mi>β</mi><mo>=</mo><mi>α</mi><mo>⋅</mo><msup><mi>s</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo>+</mo><mi>β</mi></mrow><annotation encoding=\"application/x-tex\">\\frac{1}{w} = \\frac{\\alpha}{s} + \\beta = \\alpha \\cdot s^{-1} + \\beta</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.0074em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.7936em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.1076em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">s</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05278em;\">β</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4445em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.9474em;vertical-align:-0.0833em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05278em;\">β</span></span></span></span></span>","key":"AOAPGHJFyn"},{"type":"paragraph","position":{"start":{"line":759,"column":1},"end":{"line":759,"column":1}},"children":[{"type":"text","value":"for the new fitting parameters ","position":{"start":{"line":759,"column":1},"end":{"line":759,"column":1}},"key":"YwlLY7UhNv"},{"type":"inlineMath","value":"\\alpha=K_m/V","position":{"start":{"line":759,"column":1},"end":{"line":759,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>α</mi><mo>=</mo><msub><mi>K</mi><mi>m</mi></msub><mi mathvariant=\"normal\">/</mi><mi>V</mi></mrow><annotation encoding=\"application/x-tex\">\\alpha=K_m/V</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">/</span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span></span></span></span>","key":"eCB5cw2rfV"},{"type":"text","value":" and ","position":{"start":{"line":759,"column":1},"end":{"line":759,"column":1}},"key":"X6x43frB4E"},{"type":"inlineMath","value":"\\beta=1/V","position":{"start":{"line":759,"column":1},"end":{"line":759,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>β</mi><mo>=</mo><mn>1</mn><mi mathvariant=\"normal\">/</mi><mi>V</mi></mrow><annotation encoding=\"application/x-tex\">\\beta=1/V</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05278em;\">β</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1/</span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span></span></span></span>","key":"fkTHcMtEpA"},{"type":"text","value":". This corresponds to the misfit function whose entries are","position":{"start":{"line":759,"column":1},"end":{"line":759,"column":1}},"key":"lfIehVWKmy"}],"key":"gagvSRS9XX"},{"type":"math","value":"f_i([\\alpha,\\beta]) = \\left(\\alpha \\cdot \\frac{1}{s_i} + \\beta\\right) - \\frac{1}{w_i}","position":{"start":{"line":761,"column":1},"end":{"line":761,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>f</mi><mi>i</mi></msub><mo stretchy=\"false\">(</mo><mo stretchy=\"false\">[</mo><mi>α</mi><mo separator=\"true\">,</mo><mi>β</mi><mo stretchy=\"false\">]</mo><mo stretchy=\"false\">)</mo><mo>=</mo><mrow><mo fence=\"true\">(</mo><mi>α</mi><mo>⋅</mo><mfrac><mn>1</mn><msub><mi>s</mi><mi>i</mi></msub></mfrac><mo>+</mo><mi>β</mi><mo fence=\"true\">)</mo></mrow><mo>−</mo><mfrac><mn>1</mn><msub><mi>w</mi><mi>i</mi></msub></mfrac></mrow><annotation encoding=\"application/x-tex\">f_i([\\alpha,\\beta]) = \\left(\\alpha \\cdot \\frac{1}{s_i} + \\beta\\right) - \\frac{1}{w_i}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">([</span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05278em;\">β</span><span class=\"mclose\">])</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.4em;vertical-align:-0.95em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">(</span></span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05278em;\">β</span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">)</span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.1574em;vertical-align:-0.836em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span>","enumerator":"1","key":"OcJc0ocyY8"},{"type":"paragraph","position":{"start":{"line":763,"column":1},"end":{"line":763,"column":1}},"children":[{"type":"text","value":"for ","position":{"start":{"line":763,"column":1},"end":{"line":763,"column":1}},"key":"TPJJrKvwFA"},{"type":"inlineMath","value":"i=1,\\ldots,m","position":{"start":{"line":763,"column":1},"end":{"line":763,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi><mo>=</mo><mn>1</mn><mo separator=\"true\">,</mo><mo>…</mo><mo separator=\"true\">,</mo><mi>m</mi></mrow><annotation encoding=\"application/x-tex\">i=1,\\ldots,m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8389em;vertical-align:-0.1944em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">m</span></span></span></span>","key":"ebDMxEJuRm"},{"type":"text","value":". Although this misfit is nonlinear in ","position":{"start":{"line":763,"column":1},"end":{"line":763,"column":1}},"key":"PgryqxcxxV"},{"type":"inlineMath","value":"s","position":{"start":{"line":763,"column":1},"end":{"line":763,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>s</mi></mrow><annotation encoding=\"application/x-tex\">s</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">s</span></span></span></span>","key":"VZGz1XuE4a"},{"type":"text","value":" and ","position":{"start":{"line":763,"column":1},"end":{"line":763,"column":1}},"key":"fYOpd4lNXW"},{"type":"inlineMath","value":"w","position":{"start":{"line":763,"column":1},"end":{"line":763,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>w</mi></mrow><annotation encoding=\"application/x-tex\">w</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span></span></span></span>","key":"E2hfK6qcfU"},{"type":"text","value":", it’s linear in the unknown parameters ","position":{"start":{"line":763,"column":1},"end":{"line":763,"column":1}},"key":"py4PQAt9qZ"},{"type":"text","value":"α","position":{"start":{"line":763,"column":1},"end":{"line":763,"column":1}},"key":"OsR8V4TZ8k"},{"type":"text","value":" and ","position":{"start":{"line":763,"column":1},"end":{"line":763,"column":1}},"key":"Ux5jPlqPR2"},{"type":"text","value":"β","position":{"start":{"line":763,"column":1},"end":{"line":763,"column":1}},"key":"KkrNBb1iMi"},{"type":"text","value":". This lets us pose and solve it as a linear least-squares problem.","position":{"start":{"line":763,"column":1},"end":{"line":763,"column":1}},"key":"bNBvtsIB2R"}],"key":"oTksjDY3wr"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"u = 1 ./ w;\nA = [s.^(-1), s.^0];  \nz = A \\ u;\nalpha = z(1);  beta = z(2);","key":"MBN7Fr3HGJ"},{"type":"output","id":"vU2FM6Mm04e5c4L7MMwWI","data":[],"key":"MUcAohFeK8"}],"data":{},"key":"TFpuE2B0pZ"},{"type":"paragraph","position":{"start":{"line":772,"column":1},"end":{"line":772,"column":1}},"children":[{"type":"text","value":"The two fits are different because they do not optimize the same quantities.","position":{"start":{"line":772,"column":1},"end":{"line":772,"column":1}},"key":"in5JcyXiAM"}],"key":"hGUWsMnB9Z"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"linmodel = @(s) 1 ./ (beta + alpha ./ s);\nfinal_misfit_linearized = norm(linmodel(s) - w)\nfplot(linmodel, [0, 6])\nlabels = [labels, \"linearized fit\"];    \nlegend(labels, 'location', 'east');","key":"RxowI8OyL2"},{"type":"output","id":"0rR68cqKTJDzJMVPJvOKI","data":[{"output_type":"execute_result","execution_count":65,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>final_misfit_linearized = \n   7.4871e-01\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"final_misfit_linearized = \n   7.4871e-01\n","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":65,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"fc6bbbab56daf8cbbbcd11b3e68555fb","path":"/fnc/build/fc6bbbab56daf8cbbbcd11b3e68555fb.png"}}}],"key":"gqTbbpIgDQ"}],"data":{},"key":"gYtiGeujpm"},{"type":"paragraph","position":{"start":{"line":782,"column":1},"end":{"line":782,"column":1}},"children":[{"type":"text","value":"The truly nonlinear fit is clearly better in this case. It optimizes a residual for the original measured quantity rather than a transformed one we picked for algorithmic convenience.","position":{"start":{"line":782,"column":1},"end":{"line":782,"column":1}},"key":"MtBkbgwANQ"}],"key":"BVyPBEZl3v"}],"label":"demo-nlsq-MM-matlab","identifier":"demo-nlsq-mm-matlab","html_id":"demo-nlsq-mm-matlab","key":"W6qmHp5T44"}],"key":"Lq9J0ZqsXY"}],"key":"SEz9s7wYpI"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Chapter 3","url":"/chapter3-1","group":"MATLAB codes"},"next":{"title":"Chapter 5","url":"/chapter5-1","group":"MATLAB codes"}}},"domain":"http://localhost:3000"}