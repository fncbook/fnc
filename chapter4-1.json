{"version":2,"kind":"Notebook","sha256":"38b78e88bc2a0b744d2d3eaf64fab6729fc6522bb8eb397fd188705a0e53ed93","slug":"chapter4-1","location":"/matlab/chapter4.md","dependencies":[],"frontmatter":{"title":"Chapter 4","numbering":{"heading_1":{"enabled":false},"heading_2":{"enabled":false},"heading_3":{"enabled":false},"heading_4":{"enabled":false},"heading_5":{"enabled":false},"heading_6":{"enabled":false},"title":{"offset":2}},"kernelspec":{"name":"jupyter_matlab_kernel","display_name":"MATLAB","language":"matlab"},"content_includes_title":false,"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","TPBVP":"two-point boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"edit_url":"https://github.com/fncbook/fnc/blob/master/matlab/chapter4.md","exports":[{"format":"md","filename":"chapter4.md","url":"/build/chapter4-9f871979132ef4fc8a5e912178fdd1d8.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Functions","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"Z080fdpRLD"}],"identifier":"functions","label":"Functions","html_id":"functions","implicit":true,"key":"b1wzTYgBrA"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Newton’s method","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"iELpnkvVFJ"}],"key":"j7cukkIlY9"},{"type":"include","file":"FNC-matlab/newton.m","literal":true,"children":[{"type":"code","value":"function x = newton(f,dfdx,x1)\r\n% NEWTON   Newton's method for a scalar equation.\r\n% Input:\r\n%   f        objective function \r\n%   dfdx     derivative function\r\n%   x1       initial root approximation\r\n% Output       \r\n%   x        vector of root approximations (last one is best)\r\n\r\n% Operating parameters.\r\nfuntol = 100*eps;  xtol = 100*eps;  maxiter = 40;\r\n\r\nx = x1;  \r\ny = f(x1);\r\ndx = Inf;   % for initial pass below\r\nk = 1;\r\n\r\nwhile (abs(dx) > xtol) && (abs(y) > funtol) && (k < maxiter)\r\n    dydx = dfdx(x(k));\r\n    dx = -y/dydx;           % Newton step\r\n    x(k+1) = x(k) + dx;\r\n\r\n    k = k+1;\r\n    y = f(x(k));\r\nend\r\n\r\nif k==maxiter\r\n  warning('Maximum number of iterations reached.')\r\nend","lang":"matlab","showLineNumbers":true,"filename":"newton.m","key":"c5rGKcd8to"}],"key":"B95QtkFdjS"}],"label":"function-newton-matlab","identifier":"function-newton-matlab","html_id":"function-newton-matlab","key":"vkATrAQ514"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Secant method","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"lXIScW2KDA"}],"key":"w1yvVELn4M"},{"type":"include","file":"FNC-matlab/secant.m","literal":true,"children":[{"type":"code","value":"function x = secant(f,x1,x2)\r\n% SECANT   Secant method for a scalar equation.\r\n% Input:\r\n%   f        objective function \r\n%   x1,x2    initial root approximations\r\n% Output       \r\n%   x        vector of root approximations (last is best)\r\n\r\n% Operating parameters.\r\nfuntol = 100*eps;  xtol = 100*eps;  maxiter = 40;\r\n\r\nx = [x1 x2];\r\ndx = Inf;  y1 = f(x1);\r\nk = 2;  y2 = f(x2);\r\n\r\nwhile (abs(dx) > xtol) && (abs(y2) > funtol) && (k < maxiter)\r\n    dx = -y2 * (x(k)-x(k-1)) / (y2-y1);   % secant step\r\n    x(k+1) = x(k) + dx;\r\n    \r\n    k = k+1;\r\n    y1 = y2;    % current f-value becomes the old one next time\r\n    y2 = f(x(k));\r\nend\r\n\r\nif k==maxiter\r\n    warning('Maximum number of iterations reached.')\r\nend","lang":"matlab","showLineNumbers":true,"filename":"secant.m","key":"cKiy6iQmim"}],"key":"rGnUNDEHya"}],"label":"function-secant-matlab","identifier":"function-secant-matlab","html_id":"function-secant-matlab","key":"TX3Qw4oK6K"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Newton’s method for systems","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"lekhA01TJp"}],"key":"CUGCboqzUP"},{"type":"include","file":"FNC-matlab/newtonsys.m","literal":true,"children":[{"type":"code","value":"function x = newtonsys(f,x1)\r\n% NEWTONSYS   Newton's method for a system of equations.\r\n% Input:\r\n%   f        function that computes residual and Jacobian matrix\r\n%   x1       initial root approximation (n-vector)\r\n% Output       \r\n%   x        array of approximations (one per column, last is best)\r\n\r\n% Operating parameters.\r\nfuntol = 1000*eps;  xtol = 1000*eps;  maxiter = 40;\r\n\r\nx = x1(:);  \r\n[y,J] = f(x1);\r\ndx = Inf;\r\nk = 1;\r\n\r\nwhile (norm(dx) > xtol) && (norm(y) > funtol) && (k < maxiter)\r\n    dx = -(J\\y);   % Newton step\r\n    x(:,k+1) = x(:,k) + dx;\r\n\r\n    k = k+1;\r\n    [y,J] = f(x(:,k));\r\nend\r\n\r\nif k==maxiter\r\n    warning('Maximum number of iterations reached.')\r\nend","lang":"matlab","showLineNumbers":true,"filename":"newtonsys.m","key":"SGQ5iHUkI1"}],"key":"aM6VTBMhey"}],"label":"function-newtonsys-matlab","identifier":"function-newtonsys-matlab","html_id":"function-newtonsys-matlab","key":"qSpBrPMkZu"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Finite differences for Jacobian","position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"key":"I3hbpsls80"}],"key":"eQv72Rbt9E"},{"type":"include","file":"FNC-matlab/fdjac.m","literal":true,"children":[{"type":"code","value":"function J = fdjac(f,x0,y0)\n% FDJAC   Finite-difference approximation of a Jacobian.\n% Input:\n%   f        function to be differentiated\n%   x0       evaluation point (n-vector)\n%   y0       value of f at x0 (m-vector)\n% Output       \n%   J        approximate Jacobian (m-by-n)\n\ndelta = sqrt(eps);   % FD step size\nm = length(y0);  n = length(x0);\nJ = zeros(m,n);\nI = eye(n);\nfor j = 1:n\n    J(:,j) = ( f(x0+delta*I(:,j)) - y0) / delta;\nend","lang":"matlab","showLineNumbers":true,"filename":"fdjac.m","key":"FRpjuwp4Pl"}],"key":"kxife145mG"}],"label":"function-fdjac-matlab","identifier":"function-fdjac-matlab","html_id":"function-fdjac-matlab","key":"ZNa359IFDo"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Levenberg’s method","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"key":"VCWpEIehZk"}],"key":"QgICeKeYIS"},{"type":"include","file":"FNC-matlab/levenberg.m","literal":true,"children":[{"type":"code","value":"function x = levenberg(f,x1,tol)\r\n% LEVENBERG   Quasi-Newton method for nonlinear systems.\r\n% Input:\r\n%   f         objective function \r\n%   x1        initial root approximation\r\n%   tol       stopping tolerance (default is 1e-12)\r\n% Output       \r\n%   x         array of approximations (one per column)\r\n\r\n% Operating parameters.\r\nif nargin < 3, tol = 1e-12; end\r\nftol = tol;  xtol = tol;  maxiter = 40;\r\n\r\nx = x1(:);     fk = f(x1);\r\nk = 1;  s = Inf;        \r\nAk = fdjac(f,x(:,1),fk);   % start with FD Jacobian\r\njac_is_new = true;\r\nI = eye(length(x));\r\n\r\nlambda = 10; \r\nwhile (norm(s) > xtol) && (norm(fk) > ftol) && (k < maxiter)\r\n    % Compute the proposed step.\r\n    B = Ak'*Ak + lambda*I;\r\n    z = Ak'*fk;\r\n    s = -(B\\z);\r\n\r\n    xnew = x(:,k) + s;   fnew = f(xnew);\r\n    \r\n    % Do we accept the result?\r\n    if norm(fnew) < norm(fk)    % accept\r\n        y = fnew - fk;\r\n        x(:,k+1) = xnew;  fk = fnew;  \r\n        k = k+1;\r\n        \r\n        lambda = lambda/10;  % get closer to Newton\r\n        % Broyden update of the Jacobian.\r\n        Ak = Ak + (y-Ak*s)*(s'/(s'*s));\r\n        jac_is_new = false;\r\n    else                       % don't accept\r\n        % Get closer to steepest descent.\r\n        lambda = lambda*4;\r\n        % Re-initialize the Jacobian if it's out of date.\r\n        if ~jac_is_new\r\n            Ak = fdjac(f,x(:,k),fk);\r\n            jac_is_new = true;\r\n        end\r\n    end\r\nend\r\n\r\nif (norm(fk) > 1e-3)\r\n    warning('Iteration did not find a root.')\r\nend","lang":"matlab","showLineNumbers":true,"filename":"levenberg.m","key":"EcAfLS4l62"}],"key":"kGIPznkVRM"}],"label":"function-levenberg-matlab","identifier":"function-levenberg-matlab","html_id":"function-levenberg-matlab","key":"EgGmtBm5Dn"},{"type":"heading","depth":2,"position":{"start":{"line":58,"column":1},"end":{"line":58,"column":1}},"children":[{"type":"text","value":"Examples","position":{"start":{"line":58,"column":1},"end":{"line":58,"column":1}},"key":"t8I5CoYzjC"}],"identifier":"examples","label":"Examples","html_id":"examples","implicit":true,"key":"yxjzh1h3ki"}],"key":"bAjzOs9Y7D"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"cd  /Users/driscoll/Documents/GitHub/fnc/matlab\nFNC_init;\npwd","visibility":"show","key":"PcvZQBWvzx"},{"type":"output","id":"wyfKm-SMTEDYExY8vPvXa","data":[{"output_type":"stream","name":"stdout","text":"Starting MATLAB ...\n"},{"output_type":"stream","name":"stdout","text":"Executing ..."},{"output_type":"execute_result","execution_count":1,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = '/Users/driscoll/Documents/GitHub/fnc/matlab'</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = '/Users/driscoll/Documents/GitHub/fnc/matlab'","content_type":"text/plain"}}}],"visibility":"show","key":"k5ouTVW733"}],"data":{"tags":[]},"visibility":"remove","key":"Uwfbr5aUsC"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"children":[{"type":"text","value":"4.1 ","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"key":"T2SyW55CyN"},{"type":"link","identifier":"section-nonlineqn-rootproblem","label":"section-nonlineqn-rootproblem","kind":"narrative","position":{"start":{"line":67,"column":5},"end":{"line":67,"column":35}},"url":"/rootproblem","internal":true,"dataUrl":"/rootproblem.json","children":[{"type":"text","value":"The rootfinding problem","key":"PuPSp0dE5g"}],"key":"mmF7yyjo5S"}],"identifier":"id-4-1","label":"4.1 ","html_id":"id-4-1","implicit":true,"key":"ZOZyC6cc9c"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-rootproblem-bessel","label":"demo-rootproblem-bessel","kind":"proof:example","position":{"start":{"line":70,"column":1},"end":{"line":70,"column":25}},"children":[{"type":"text","value":"Example ","key":"lTA3Ve2sUm"},{"type":"text","value":"4.1.1","key":"xTPu5ouC5I"}],"template":"Example %s","enumerator":"4.1.1","resolved":true,"html_id":"demo-rootproblem-bessel","remote":true,"url":"/rootproblem","dataUrl":"/rootproblem.json","key":"au4o5vzO0V"}],"key":"cgmtXW5cwX"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"J3 = @(x) besselj(3,x);\nfplot(J3, [0, 20])\ngrid on\nxlabel('x'), ylabel('J_3(x)')  \ntitle('Bessel function')","key":"dvamXjFyjv"},{"type":"output","id":"eyPqqek3vDkdUD2HwWAXI","data":[{"output_type":"execute_result","execution_count":2,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"b1e5f5749e18f3ba7cbb6a526f592d15","path":"/build/b1e5f5749e18f3ba7cbb6a526f592d15.png"}}}],"key":"TKzNNmxzSi"}],"key":"dwTu38MahK"},{"type":"paragraph","position":{"start":{"line":80,"column":1},"end":{"line":80,"column":1}},"children":[{"type":"text","value":"From the graph we see roots near 6, 10, 13, 16, and 19. We use ","position":{"start":{"line":80,"column":1},"end":{"line":80,"column":1}},"key":"j7UjiSGgSj"},{"type":"inlineCode","value":"nlsolve","position":{"start":{"line":80,"column":1},"end":{"line":80,"column":1}},"key":"GOoKnFr5VX"},{"type":"text","value":" from the ","position":{"start":{"line":80,"column":1},"end":{"line":80,"column":1}},"key":"RyKLgOhFry"},{"type":"inlineCode","value":"NLsolve","position":{"start":{"line":80,"column":1},"end":{"line":80,"column":1}},"key":"sjm7b8hKTN"},{"type":"text","value":" package to find these roots accurately. It uses vector variables, so we have to code accordingly.","position":{"start":{"line":80,"column":1},"end":{"line":80,"column":1}},"key":"nxgdgaHSXl"}],"key":"uYr2EnbsKu"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"n1CE6kYe3D"}],"key":"VH6cRuyjG6"},{"type":"paragraph","position":{"start":{"line":83,"column":1},"end":{"line":84,"column":1}},"children":[{"type":"text","value":"Type ","position":{"start":{"line":83,"column":1},"end":{"line":83,"column":1}},"key":"RbKEu2iNGG"},{"type":"inlineCode","value":"\\omega","position":{"start":{"line":83,"column":1},"end":{"line":83,"column":1}},"key":"hgmsJHWxpp"},{"type":"text","value":" followed by ","position":{"start":{"line":83,"column":1},"end":{"line":83,"column":1}},"key":"gV0mRtv4rf"},{"type":"keyboard","children":[{"type":"text","value":"Tab","key":"P7g2PGTrM2"}],"key":"wdLAS2LFNW"},{"type":"text","value":" to get the character ","position":{"start":{"line":83,"column":1},"end":{"line":83,"column":1}},"key":"GOh133uFmY"},{"type":"inlineCode","value":"ω","position":{"start":{"line":83,"column":1},"end":{"line":83,"column":1}},"key":"G9ATAAcnDX"},{"type":"text","value":".\nThe argument ","position":{"start":{"line":83,"column":1},"end":{"line":83,"column":1}},"key":"vIPLACN2RM"},{"type":"inlineCode","value":"ftol=1e-14","position":{"start":{"line":83,"column":1},"end":{"line":83,"column":1}},"key":"r4gSjZAgGf"},{"type":"text","value":" below is called a ","position":{"start":{"line":83,"column":1},"end":{"line":83,"column":1}},"key":"T2II1eKCGj"},{"type":"strong","position":{"start":{"line":83,"column":1},"end":{"line":83,"column":1}},"children":[{"type":"text","value":"keyword argument","position":{"start":{"line":83,"column":1},"end":{"line":83,"column":1}},"key":"vBlOt3yMiW"}],"key":"Y2hsMJVmUv"},{"type":"text","value":". Here it sets a goal for the maximum value of ","position":{"start":{"line":83,"column":1},"end":{"line":83,"column":1}},"key":"f9OMpjczJE"},{"type":"inlineMath","value":"|f(x)|","position":{"start":{"line":83,"column":1},"end":{"line":83,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">∣</mi><mi>f</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mi mathvariant=\"normal\">∣</mi></mrow><annotation encoding=\"application/x-tex\">|f(x)|</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">∣</span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mord\">∣</span></span></span></span>","key":"wCa0XSOcrf"},{"type":"text","value":".","position":{"start":{"line":83,"column":1},"end":{"line":83,"column":1}},"key":"DWM2GPurTi"}],"key":"zgN9cpA8WZ"}],"class":"dropdown","key":"XzmKxlMvPS"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"omega = [];\nfor guess = [6, 10, 13, 16, 19]\n    omega = [omega; fzero(J3, guess)];\nend\nomega","key":"fzMGdIj0VB"},{"type":"output","id":"u_ScArI4BjTTegsCfKbzI","data":[{"output_type":"execute_result","execution_count":3,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>omega = 5×1 double\n   6.380161895923984\n   9.761023129981670\n  13.015200721698434\n  16.223466160318765\n  19.409415226435016\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"omega = 5×1 double\n   6.380161895923984\n   9.761023129981670\n  13.015200721698434\n  16.223466160318765\n  19.409415226435016\n","content_type":"text/plain"}}}],"key":"DYV1LWMQ6s"}],"key":"ltpHchds85"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"table(omega, J3(omega), 'VariableNames', {'root estimate', 'function value'})","key":"L7twrmPeSm"},{"type":"output","id":"A2VFu7F5i1DPF3_cC3gMu","data":[{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"text/html":{"content":"<html><head><style>.mwBasicVariableOutputWrapper .mwBasicVariableOutputHeader {font-style: italic;}</style></head><body><div class='mwBasicVariableOutputWrapper'><div>ans = <span class='mwBasicVariableOutputHeader'>5x2 table</span></div><table><thead><tr><th>root estimate</th><th>function value</th></tr></thead><tbody><tr><td>6.3802</td><td>-6.6245e-17</td></tr><tr><td>9.7610</td><td>1.3306e-16</td></tr><tr><td>13.0152</td><td>-2.5589e-16</td></tr><tr><td>16.2235</td><td>-6.9345e-16</td></tr><tr><td>19.4094</td><td>-6.0679e-16</td></tr></tbody></table></div></body></html>","content_type":"text/html"},"text/plain":{"content":"<html><head><style>.mwBasicVariableOutputWrapper .mwBasicVariableOutputHeader {font-style: italic;}</style></head><body><div class='mwBasicVariableOutputWrapper'><div>ans = <span class='mwBasicVariableOutputHeader'>5x2 table</span></div><table><thead><tr><th>root estimate</th><th>function value</th></tr></thead><tbody><tr><td>6.3802</td><td>-6.6245e-17</td></tr><tr><td>9.7610</td><td>1.3306e-16</td></tr><tr><td>13.0152</td><td>-2.5589e-16</td></tr><tr><td>16.2235</td><td>-6.9345e-16</td></tr><tr><td>19.4094</td><td>-6.0679e-16</td></tr></tbody></table></div></body></html>","content_type":"text/plain"}}}],"key":"cfygobVgQh"}],"key":"eWD2klBsvk"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"hold on\nscatter(omega, J3(omega))\ntitle('Bessel roots')","key":"ll1GEKH965"},{"type":"output","id":"2PNczgYAJyFz-RtXE1LRx","data":[{"output_type":"execute_result","execution_count":5,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"698d92ff8c620d70e81882a89edafbb2","path":"/build/698d92ff8c620d70e81882a89edafbb2.png"}}}],"key":"D5VPiABaJF"}],"key":"rYMfBwAS7F"},{"type":"paragraph","position":{"start":{"line":105,"column":1},"end":{"line":105,"column":1}},"children":[{"type":"text","value":"If instead we seek values at which ","position":{"start":{"line":105,"column":1},"end":{"line":105,"column":1}},"key":"EYGF1OO36L"},{"type":"inlineMath","value":"J_3(x)=0.2","position":{"start":{"line":105,"column":1},"end":{"line":105,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>J</mi><mn>3</mn></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mn>0.2</mn></mrow><annotation encoding=\"application/x-tex\">J_3(x)=0.2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.09618em;\">J</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0962em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0.2</span></span></span></span>","key":"g4tIhpsKA6"},{"type":"text","value":", then we must find roots of the function ","position":{"start":{"line":105,"column":1},"end":{"line":105,"column":1}},"key":"JDrpH3655L"},{"type":"inlineMath","value":"J_3(x)-0.2","position":{"start":{"line":105,"column":1},"end":{"line":105,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>J</mi><mn>3</mn></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>−</mo><mn>0.2</mn></mrow><annotation encoding=\"application/x-tex\">J_3(x)-0.2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.09618em;\">J</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0962em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0.2</span></span></span></span>","key":"vdy5g626ka"},{"type":"text","value":".","position":{"start":{"line":105,"column":1},"end":{"line":105,"column":1}},"key":"Eka54XOHjr"}],"key":"KjGzB9ERQJ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"omega = [];\nfor guess = [3, 6, 10, 13]\n    f = @(x) J3(x) - 0.2;\n    omega = [omega; fzero(f, guess)];\nend\nscatter(omega, J3(omega), '<')","key":"rDXkkDD3R1"},{"type":"output","id":"KXFkU_niBwIfdTqT4wXlX","data":[{"output_type":"execute_result","execution_count":6,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"28a9be670001423aa7560ff486116885","path":"/build/28a9be670001423aa7560ff486116885.png"}}}],"key":"fUeQyfa43C"}],"key":"LiqnJ7rURR"}],"label":"demo-rootproblem-bessel-matlab","identifier":"demo-rootproblem-bessel-matlab","html_id":"demo-rootproblem-bessel-matlab","key":"KTUi9q8XA3"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-roots-cond","label":"demo-roots-cond","kind":"proof:example","position":{"start":{"line":118,"column":1},"end":{"line":118,"column":17}},"children":[{"type":"text","value":"Example ","key":"zGQX1m7kL2"},{"type":"text","value":"4.1.2","key":"KsRxf0Uhtr"}],"template":"Example %s","enumerator":"4.1.2","resolved":true,"html_id":"demo-roots-cond","remote":true,"url":"/rootproblem","dataUrl":"/rootproblem.json","key":"IVI29r67Ph"}],"key":"kYCEAQ8grM"},{"type":"paragraph","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"children":[{"type":"text","value":"Consider first the function","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"key":"lKUqmwwNRt"}],"key":"znvjvibYC4"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"f  = @(x) (x - 1) .* (x - 2);","key":"uAUGHRhGoj"},{"type":"output","id":"5M4f4NVfXb2uozvB-gEf2","data":[],"key":"ZdTH4dMya7"}],"key":"RavP6zXnzB"},{"type":"paragraph","position":{"start":{"line":126,"column":1},"end":{"line":126,"column":1}},"children":[{"type":"text","value":"At the root ","position":{"start":{"line":126,"column":1},"end":{"line":126,"column":1}},"key":"TrD6dX9RVA"},{"type":"inlineMath","value":"r=1","position":{"start":{"line":126,"column":1},"end":{"line":126,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>r</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">r=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"oV5GMdbUcO"},{"type":"text","value":", we have ","position":{"start":{"line":126,"column":1},"end":{"line":126,"column":1}},"key":"SSqlUW9yhU"},{"type":"inlineMath","value":"f'(r)=-1","position":{"start":{"line":126,"column":1},"end":{"line":126,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>f</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo stretchy=\"false\">(</mo><mi>r</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mo>−</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">f&#x27;(r)=-1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0019em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">−</span><span class=\"mord\">1</span></span></span></span>","key":"UiV2Gt6Ozm"},{"type":"text","value":". If the values of ","position":{"start":{"line":126,"column":1},"end":{"line":126,"column":1}},"key":"d9Poc0TTnH"},{"type":"inlineMath","value":"f","position":{"start":{"line":126,"column":1},"end":{"line":126,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>","key":"HjFmvu7BFt"},{"type":"text","value":" were perturbed at every point by a small amount of noise, we can imagine finding the root of the function drawn with a thick ribbon, giving a range of potential roots.","position":{"start":{"line":126,"column":1},"end":{"line":126,"column":1}},"key":"kHkAOawltO"}],"key":"rQDAaayrEm"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf\ninterval = [0.8, 1.2];\nfplot(f, interval)\ngrid on, hold on\nfplot(@(x) f(x) + 0.02, interval, 'k')\nfplot(@(x) f(x) - 0.02, interval, 'k')\naxis equal,  yticks([0])\nylim([-0.1, 0.1])\nxlabel('x'), ylabel('f(x)')\ntitle('Well-conditioned root')","key":"o2IHNJM36H"},{"type":"output","id":"WYepUfaCHQL2rDcNFKJwq","data":[{"output_type":"execute_result","execution_count":8,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"64e00ad61d08cb584f09e80fff5fac1b","path":"/build/64e00ad61d08cb584f09e80fff5fac1b.png"}}}],"key":"uBDdgZK32Z"}],"key":"H4vLNbqNMq"},{"type":"paragraph","position":{"start":{"line":142,"column":1},"end":{"line":142,"column":1}},"children":[{"type":"text","value":"The possible values for a perturbed root all lie within the interval where the ribbon intersects the ","position":{"start":{"line":142,"column":1},"end":{"line":142,"column":1}},"key":"WL0hOoSxJL"},{"type":"inlineMath","value":"x","position":{"start":{"line":142,"column":1},"end":{"line":142,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"QDf7UoQZlA"},{"type":"text","value":"-axis. The width of that zone is about the same as the vertical thickness of the ribbon.","position":{"start":{"line":142,"column":1},"end":{"line":142,"column":1}},"key":"RWNocJbR0G"}],"key":"VfG71Y4vdO"},{"type":"paragraph","position":{"start":{"line":144,"column":1},"end":{"line":144,"column":1}},"children":[{"type":"text","value":"By contrast, consider the function","position":{"start":{"line":144,"column":1},"end":{"line":144,"column":1}},"key":"uF52axgpHN"}],"key":"sEOM8rSzRX"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"f = @(x) (x - 1) .* (x - 1.01);","key":"fT2hIaXBDM"},{"type":"output","id":"Jh5h7ps0L6ZYk-3HACExZ","data":[],"key":"xsLjZ6boKD"}],"key":"KRt9ULZg8t"},{"type":"paragraph","position":{"start":{"line":150,"column":1},"end":{"line":150,"column":1}},"children":[{"type":"text","value":"Now ","position":{"start":{"line":150,"column":1},"end":{"line":150,"column":1}},"key":"g5AApOJzRX"},{"type":"inlineMath","value":"f'(1)=-0.01","position":{"start":{"line":150,"column":1},"end":{"line":150,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>f</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo><mo>=</mo><mo>−</mo><mn>0.01</mn></mrow><annotation encoding=\"application/x-tex\">f&#x27;(1)=-0.01</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0019em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">−</span><span class=\"mord\">0.01</span></span></span></span>","key":"OGwAXk0jSC"},{"type":"text","value":", and the graph of ","position":{"start":{"line":150,"column":1},"end":{"line":150,"column":1}},"key":"bmrnwI9U6O"},{"type":"inlineMath","value":"f","position":{"start":{"line":150,"column":1},"end":{"line":150,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>","key":"k8zMUVBAy1"},{"type":"text","value":" will be much shallower near ","position":{"start":{"line":150,"column":1},"end":{"line":150,"column":1}},"key":"fC4auC8l6t"},{"type":"inlineMath","value":"x=1","position":{"start":{"line":150,"column":1},"end":{"line":150,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">x=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"Ukzmh1lnK0"},{"type":"text","value":". Look at the effect this has on our thick rendering:","position":{"start":{"line":150,"column":1},"end":{"line":150,"column":1}},"key":"vMD05YZNno"}],"key":"yPSQmkDfb6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"axis(axis), cla\nfplot(f, interval)\nfplot(@(x) f(x) + 0.02, interval, 'k')\nfplot(@(x) f(x) - 0.02, interval, 'k')\nylim([-0.1, 0.1]), yticks([0])\ntitle('Poorly conditioned root')","key":"BoSBKjHiZL"},{"type":"output","id":"66QwC2t-DMWY5gG1lZfsn","data":[{"output_type":"execute_result","execution_count":10,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"6b9fcd5321f5399ede0c7feedeaaf1df","path":"/build/6b9fcd5321f5399ede0c7feedeaaf1df.png"}}}],"key":"dB1h8CE9eA"}],"key":"xHfRd9FEGW"},{"type":"paragraph","position":{"start":{"line":161,"column":1},"end":{"line":161,"column":1}},"children":[{"type":"text","value":"The vertical displacements in this picture are exactly the same as before. But the potential ","position":{"start":{"line":161,"column":1},"end":{"line":161,"column":1}},"key":"irSqvMFqpL"},{"type":"emphasis","position":{"start":{"line":161,"column":1},"end":{"line":161,"column":1}},"children":[{"type":"text","value":"horizontal","position":{"start":{"line":161,"column":1},"end":{"line":161,"column":1}},"key":"x193vIeyfA"}],"key":"zGNOIb6xmW"},{"type":"text","value":" displacement of the root is much wider. In fact, if we perturb the function entirely upward by the amount drawn here, the root disappears!","position":{"start":{"line":161,"column":1},"end":{"line":161,"column":1}},"key":"XhVeLlZA8M"}],"key":"EHs7K4AUKT"}],"label":"demo-roots-cond-matlab","identifier":"demo-roots-cond-matlab","html_id":"demo-roots-cond-matlab","key":"IyeUeI8FKl"},{"type":"heading","depth":3,"position":{"start":{"line":164,"column":1},"end":{"line":164,"column":1}},"children":[{"type":"text","value":"4.2 ","position":{"start":{"line":164,"column":1},"end":{"line":164,"column":1}},"key":"sr80zlaQ1N"},{"type":"link","identifier":"section-nonlineqn-fixed-point","label":"section-nonlineqn-fixed-point","kind":"narrative","position":{"start":{"line":164,"column":5},"end":{"line":164,"column":35}},"url":"/fixed-point","internal":true,"dataUrl":"/fixed-point.json","children":[{"type":"text","value":"Fixed-point iteration","key":"mFk2irRTNL"}],"key":"eiJo2Axccl"}],"identifier":"id-4-2","label":"4.2 ","html_id":"id-4-2","implicit":true,"key":"ei3oNM07dk"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-fp-spiral","label":"demo-fp-spiral","kind":"proof:example","position":{"start":{"line":166,"column":1},"end":{"line":166,"column":16}},"children":[{"type":"text","value":"Example ","key":"XxtKfhjhro"},{"type":"text","value":"4.2.1","key":"SydoKNhfe3"}],"template":"Example %s","enumerator":"4.2.1","resolved":true,"html_id":"demo-fp-spiral","remote":true,"url":"/fixed-point","dataUrl":"/fixed-point.json","key":"yMf4hFzgpS"}],"key":"DK1d06ZegY"},{"type":"paragraph","position":{"start":{"line":168,"column":1},"end":{"line":168,"column":1}},"children":[{"type":"text","value":"Let’s convert the roots of a quadratic polynomial ","position":{"start":{"line":168,"column":1},"end":{"line":168,"column":1}},"key":"uohKdhGCWT"},{"type":"inlineMath","value":"f(x)","position":{"start":{"line":168,"column":1},"end":{"line":168,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">f(x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span>","key":"rvwqxByL9c"},{"type":"text","value":" to a fixed point problem.","position":{"start":{"line":168,"column":1},"end":{"line":168,"column":1}},"key":"RfjvBfbUXv"}],"key":"DcEF7KhkQ5"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"f = @(x) x.^2 - 4*x + 3.5;\nr = roots([1, -4, 3.5])","key":"LWfHyGETCl"},{"type":"output","id":"XMgXEL3_3Sy0Y71vdFYX2","data":[{"output_type":"execute_result","execution_count":11,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>r = 2×1 double\n   2.7071e+00\n   1.2929e+00\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"r = 2×1 double\n   2.7071e+00\n   1.2929e+00\n","content_type":"text/plain"}}}],"key":"d3xR87i8nr"}],"key":"R7xhmecKHw"},{"type":"paragraph","position":{"start":{"line":175,"column":1},"end":{"line":175,"column":1}},"children":[{"type":"text","value":"We define ","position":{"start":{"line":175,"column":1},"end":{"line":175,"column":1}},"key":"fQ3V3G3K2J"},{"type":"inlineMath","value":"g(x)=x-p(x)","position":{"start":{"line":175,"column":1},"end":{"line":175,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>g</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>x</mi><mo>−</mo><mi>p</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">g(x)=x-p(x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span>","key":"hHpRegjhoF"},{"type":"text","value":".","position":{"start":{"line":175,"column":1},"end":{"line":175,"column":1}},"key":"d72D98De79"}],"key":"mQYmAna8Mx"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"g = @(x) x - f(x);","key":"eJk0SnS10w"},{"type":"output","id":"X65pQVwFbutpB4uYJ6cRl","data":[],"key":"Elz78cQbsc"}],"key":"UZLzr8VmX6"},{"type":"paragraph","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"children":[{"type":"text","value":"Intersections of ","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"key":"b1OFcUMZkh"},{"type":"inlineMath","value":"y=g(x)","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi><mo>=</mo><mi>g</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">y=g(x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span>","key":"rdc7ku2hFP"},{"type":"text","value":" with the line ","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"key":"dyy783pid9"},{"type":"inlineMath","value":"y=x","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi><mo>=</mo><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">y=x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"KVO1fl2KtV"},{"type":"text","value":" are fixed points of ","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"key":"kzZuDnZvYi"},{"type":"inlineMath","value":"g","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>g</mi></mrow><annotation encoding=\"application/x-tex\">g</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span></span></span></span>","key":"AZubUByR2w"},{"type":"text","value":" and thus roots of ","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"key":"cvDe7umfyg"},{"type":"inlineMath","value":"f","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>","key":"H7BFuBX88Y"},{"type":"text","value":". (Only one is shown in the chosen plot range.)","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"key":"NACtmRw7e0"}],"key":"u3OkNHBhVa"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf\nfplot(g, [2, 3])\nhold on,  plot([2, 3], [2, 3], 'k')\ntitle('Finding a fixed point'),  axis equal  \nxlabel('x'),  ylabel('y')","key":"MTKvcHlEXt"},{"type":"output","id":"E4oUWHNhoQOPaPrv6iHV4","data":[{"output_type":"execute_result","execution_count":13,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"78fe3f0797fa1543f0c3da493b92068c","path":"/build/78fe3f0797fa1543f0c3da493b92068c.png"}}}],"key":"rFYKNZz5ku"}],"key":"Tze76WkjTu"},{"type":"paragraph","position":{"start":{"line":191,"column":1},"end":{"line":191,"column":1}},"children":[{"type":"text","value":"If we evaluate ","position":{"start":{"line":191,"column":1},"end":{"line":191,"column":1}},"key":"w0nSDEx1oR"},{"type":"inlineMath","value":"g(2.1)","position":{"start":{"line":191,"column":1},"end":{"line":191,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>g</mi><mo stretchy=\"false\">(</mo><mn>2.1</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">g(2.1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mopen\">(</span><span class=\"mord\">2.1</span><span class=\"mclose\">)</span></span></span></span>","key":"G6G63wQS39"},{"type":"text","value":", we get a value of almost 2.6, so this is not a fixed point.","position":{"start":{"line":191,"column":1},"end":{"line":191,"column":1}},"key":"KXk06BZ6Oz"}],"key":"i7EStvnBbE"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"x = 2.1;\ny = g(x)","key":"WFhv0PQJM7"},{"type":"output","id":"FQnZ5XqJum2pPpsUA5HrR","data":[{"output_type":"execute_result","execution_count":14,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>y = \n   2.051004409603136\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"y = \n   2.051004409603136\n","content_type":"text/plain"}}}],"key":"o6MkLt5zml"}],"key":"J5qqW5Gg18"},{"type":"paragraph","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"children":[{"type":"text","value":"However, ","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"key":"ACXdM1JLSU"},{"type":"inlineMath","value":"y=g(x)","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi><mo>=</mo><mi>g</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">y=g(x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span>","key":"qb3GCpry6g"},{"type":"text","value":" is considerably closer to the fixed point at around 2.7 than ","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"key":"LFUlNHiqtk"},{"type":"inlineMath","value":"x","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"mnz1cFR6BY"},{"type":"text","value":" is. Suppose then that we adopt ","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"key":"lO6vE1Xt8F"},{"type":"inlineMath","value":"y","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>","key":"oN25EjX6Us"},{"type":"text","value":" as our new ","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"key":"TrBBlVeJ6f"},{"type":"inlineMath","value":"x","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"QAJnRfDJdx"},{"type":"text","value":" value. Changing the ","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"key":"R3HHJSjZhf"},{"type":"inlineMath","value":"x","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"wosNtbnga0"},{"type":"text","value":" coordinate in this way is the same as following a horizontal line over to the graph of ","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"key":"fJc4TWV95g"},{"type":"inlineMath","value":"y=x","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi><mo>=</mo><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">y=x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"rgSs23wyz1"},{"type":"text","value":".","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"key":"em0Ez9k33q"}],"key":"OX2jXW2Gld"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"plot([x, y], [y, y], '-')\nx = y;","key":"e8rVA3XJxb"},{"type":"output","id":"cfejciFve3ANk_Kcx4Fl3","data":[{"output_type":"stream","name":"stderr","text":"Error using horzcat\nDimensions of arrays being concatenated are not consistent."}],"key":"tvc0MH45cH"}],"key":"a0V9N5ApIg"},{"type":"paragraph","position":{"start":{"line":205,"column":1},"end":{"line":205,"column":1}},"children":[{"type":"text","value":"Now we can compute a new value for ","position":{"start":{"line":205,"column":1},"end":{"line":205,"column":1}},"key":"iFdbdhxOy1"},{"type":"inlineMath","value":"y","position":{"start":{"line":205,"column":1},"end":{"line":205,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>","key":"TxVBxInLgG"},{"type":"text","value":". We leave ","position":{"start":{"line":205,"column":1},"end":{"line":205,"column":1}},"key":"GdGvH4f2kq"},{"type":"inlineMath","value":"x","position":{"start":{"line":205,"column":1},"end":{"line":205,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"HmpRcrDHkF"},{"type":"text","value":" alone here, so we travel along a vertical line to the graph of ","position":{"start":{"line":205,"column":1},"end":{"line":205,"column":1}},"key":"whk79Uc0yH"},{"type":"inlineMath","value":"g","position":{"start":{"line":205,"column":1},"end":{"line":205,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>g</mi></mrow><annotation encoding=\"application/x-tex\">g</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span></span></span></span>","key":"zV1H5hMFv5"},{"type":"text","value":".","position":{"start":{"line":205,"column":1},"end":{"line":205,"column":1}},"key":"kstYQUoAGv"}],"key":"Qgbqq8nhyu"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"y = g(x)\nplot([x, x],[x, y], '-')","key":"okCq8jGqng"},{"type":"output","id":"BJUA7nM6U1gOaMVgSNKA3","data":[{"output_type":"execute_result","execution_count":16,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>y = 10001×1 double\n  -6.2500e-02\n  -6.2400e-02\n  -6.2300e-02\n  -6.2200e-02\n  -6.2100e-02\n  -6.2000e-02\n  -6.1900e-02\n  -6.1800e-02\n  -6.1700e-02\n  -6.1600e-02\n...</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"y = 10001×1 double\n  -6.2500e-02\n  -6.2400e-02\n  -6.2300e-02\n  -6.2200e-02\n  -6.2100e-02\n  -6.2000e-02\n  -6.1900e-02\n  -6.1800e-02\n  -6.1700e-02\n  -6.1600e-02\n...","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":16,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"4b15aba8d3ea2b6d09a1b38672bd06ad","path":"/build/4b15aba8d3ea2b6d09a1b38672bd06ad.png"}}}],"key":"XKVJsnRJsR"}],"key":"P4cBgi4sma"},{"type":"paragraph","position":{"start":{"line":212,"column":1},"end":{"line":212,"column":1}},"children":[{"type":"text","value":"You see that we are in a position to repeat these steps as often as we like. Let’s apply them a few times and see the result.","position":{"start":{"line":212,"column":1},"end":{"line":212,"column":1}},"key":"uXZ5sFB8W1"}],"key":"oydUfAzLw9"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"for k = 1:5\n    plot([x, y], [y, y], '-')\n    x = y;       % y --> new x\n    y = g(x);    % g(x) --> new y\n    plot([x, x], [x, y], '-')  \nend","key":"SVlS949lkw"},{"type":"output","id":"YjTATXcoddU1h8I8NIADo","data":[{"output_type":"stream","name":"stderr","text":"Error using horzcat\nDimensions of arrays being concatenated are not consistent."}],"key":"x18iLVutJd"}],"key":"ibOjggdpqU"},{"type":"paragraph","position":{"start":{"line":223,"column":1},"end":{"line":223,"column":1}},"children":[{"type":"text","value":"The process spirals in beautifully toward the fixed point we seek. Our last estimate has almost 4 accurate digits.","position":{"start":{"line":223,"column":1},"end":{"line":223,"column":1}},"key":"UNbuiKo6Dx"}],"key":"bNcbhxHo4I"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"abs(y - r(1)) / r(1)","key":"OjVrXSOoe2"},{"type":"output","id":"PD3FXUhX8NRjee7DFrESm","data":[{"output_type":"execute_result","execution_count":18,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = 1×6 double\n   6.3060e-01   3.9023e-01   1.1824e-02   8.0728e-01   8.6170e-01   2.8744e-01\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = 1×6 double\n   6.3060e-01   3.9023e-01   1.1824e-02   8.0728e-01   8.6170e-01   2.8744e-01\n","content_type":"text/plain"}}}],"key":"PMiZB2YQs2"}],"key":"hro4j3sZZm"},{"type":"paragraph","position":{"start":{"line":229,"column":1},"end":{"line":229,"column":1}},"children":[{"type":"text","value":"Now let’s try to find the other fixed point ","position":{"start":{"line":229,"column":1},"end":{"line":229,"column":1}},"key":"sheL3cUw3G"},{"type":"inlineMath","value":"\\approx 1.29","position":{"start":{"line":229,"column":1},"end":{"line":229,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>≈</mo><mn>1.29</mn></mrow><annotation encoding=\"application/x-tex\">\\approx 1.29</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4831em;\"></span><span class=\"mrel\">≈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1.29</span></span></span></span>","key":"ok9Bn0xuVO"},{"type":"text","value":" in the same way. We’ll use 1.3 as a starting approximation.","position":{"start":{"line":229,"column":1},"end":{"line":229,"column":1}},"key":"cu0Gt830Ne"}],"key":"hdwqFTe29w"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"cla\nfplot(g, [1, 2])\nhold on, plot([1, 2], [1, 2], 'k')\nylim([1, 2])\nx = 1.3;  y = g(x);\nfor k = 1:5\n    plot([x, y], [y, y], '-'),  \n    x = y;       % y --> new x\n    y = g(x);    % g(x) --> new y\n    plot([x, x], [x, y], '-') \nend\ntitle('No convergence')","key":"Evzosn51Ro"},{"type":"output","id":"Z-Xn05uvj9fAAEvYYUJxr","data":[{"output_type":"execute_result","execution_count":19,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"1858f624e3413a36d1630492ea8c421d","path":"/build/1858f624e3413a36d1630492ea8c421d.png"}}}],"key":"JjIqLCS0YC"}],"key":"MQ5XPDLGo4"},{"type":"paragraph","position":{"start":{"line":246,"column":1},"end":{"line":246,"column":1}},"children":[{"type":"text","value":"This time, the iteration is pushing us ","position":{"start":{"line":246,"column":1},"end":{"line":246,"column":1}},"key":"c1KexAW03a"},{"type":"emphasis","position":{"start":{"line":246,"column":1},"end":{"line":246,"column":1}},"children":[{"type":"text","value":"away from","position":{"start":{"line":246,"column":1},"end":{"line":246,"column":1}},"key":"GgkD9HRckP"}],"key":"kYRL27o2h8"},{"type":"text","value":" the correct answer.","position":{"start":{"line":246,"column":1},"end":{"line":246,"column":1}},"key":"tIUb1Ein5H"}],"key":"W0ueyJI1gz"}],"label":"demo-fp-spiral-matlab","identifier":"demo-fp-spiral-matlab","html_id":"demo-fp-spiral-matlab","key":"cOeoIeXDyA"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-fp-converge","label":"demo-fp-converge","kind":"proof:example","position":{"start":{"line":250,"column":1},"end":{"line":250,"column":18}},"children":[{"type":"text","value":"Example ","key":"vgN7rIRC73"},{"type":"text","value":"4.2.3","key":"dDI80HHwJ9"}],"template":"Example %s","enumerator":"4.2.3","resolved":true,"html_id":"demo-fp-converge","remote":true,"url":"/fixed-point","dataUrl":"/fixed-point.json","key":"JY8qJkvjGl"}],"key":"pmcuV4eky8"},{"type":"paragraph","position":{"start":{"line":252,"column":1},"end":{"line":252,"column":1}},"children":[{"type":"text","value":"We revisit ","position":{"start":{"line":252,"column":1},"end":{"line":252,"column":1}},"key":"UmiRIBfBCC"},{"type":"crossReference","kind":"proof:example","identifier":"demo-fp-spiral","label":"demo-fp-spiral","children":[{"type":"text","value":"Demo ","key":"sIFRrMvFNG"},{"type":"text","value":"4.2.1","key":"o49uVmcQzC"}],"template":"Example %s","enumerator":"4.2.1","resolved":true,"html_id":"demo-fp-spiral","remote":true,"url":"/fixed-point","dataUrl":"/fixed-point.json","key":"SG1lQhVHpX"},{"type":"text","value":" and investigate the observed convergence more closely. Recall that above we calculated ","position":{"start":{"line":252,"column":1},"end":{"line":252,"column":1}},"key":"NX0fjgIJBe"},{"type":"inlineMath","value":"g'(p)\\approx-0.42","position":{"start":{"line":252,"column":1},"end":{"line":252,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>g</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo stretchy=\"false\">(</mo><mi>p</mi><mo stretchy=\"false\">)</mo><mo>≈</mo><mo>−</mo><mn>0.42</mn></mrow><annotation encoding=\"application/x-tex\">g&#x27;(p)\\approx-0.42</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0019em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">p</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">−</span><span class=\"mord\">0.42</span></span></span></span>","key":"HLOGca2BWz"},{"type":"text","value":" at the convergent fixed point.","position":{"start":{"line":252,"column":1},"end":{"line":252,"column":1}},"key":"MNCSYrNcF3"}],"key":"FurvtnQccX"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"f = @(x) x.^2 - 4*x + 3.5;\nr = roots([1, -4, 3.5]);","key":"a3lucBj763"},{"type":"output","id":"orj4KtQ5d8xA0GZcN8xTr","data":[],"key":"CcP71WZ3P8"}],"key":"h9YurNynS2"},{"type":"paragraph","position":{"start":{"line":259,"column":1},"end":{"line":259,"column":1}},"children":[{"type":"text","value":"Here is the fixed-point iteration. This time we keep track of the whole sequence of approximations.","position":{"start":{"line":259,"column":1},"end":{"line":259,"column":1}},"key":"iQTsztxXTu"}],"key":"yZDC3RtPtL"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"g = @(x) x - f(x);\nx = 2.1; \nfor k = 1:12\n    x(k+1) = g(x(k));\nend","key":"dQMWP6bhRv"},{"type":"output","id":"DiLPx-RJZqXlBuLSLqvOM","data":[],"key":"vu3Thw8Unc"}],"indexEntries":[{"entry":"Julia","subEntry":{"value":"push!","kind":"entry"},"emphasis":false}],"label":"index-ZG6QsmVrns","identifier":"index-zg6qsmvrns","html_id":"index-zg6qsmvrns","key":"bN5ZWlJoaV"},{"type":"paragraph","position":{"start":{"line":272,"column":1},"end":{"line":272,"column":1}},"children":[{"type":"text","value":"It’s illuminating to construct and plot the sequence of errors.","position":{"start":{"line":272,"column":1},"end":{"line":272,"column":1}},"key":"XMOxqqol7M"}],"key":"D4vJbBQNSp"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"err = abs(x - r(1));\nclf\nsemilogy(err, 'o-'), axis tight\nxlabel('iteration'),  ylabel('error')\ntitle('Convergence of fixed-point iteration')","key":"DWXwF3QxxQ"},{"type":"output","id":"yTNwao9PMMst9pqLGHjTE","data":[{"output_type":"execute_result","execution_count":22,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"988ccce30ab844672b1be2ea28edc55c","path":"/build/988ccce30ab844672b1be2ea28edc55c.png"}}}],"key":"VxjqbSUlRI"}],"key":"xHOsiP5sCB"},{"type":"paragraph","position":{"start":{"line":282,"column":1},"end":{"line":282,"column":1}},"children":[{"type":"text","value":"It’s quite clear that the convergence quickly settles into a linear rate. We could estimate this rate by doing a least-squares fit to a straight line. Keep in mind that the values for small ","position":{"start":{"line":282,"column":1},"end":{"line":282,"column":1}},"key":"QItk0ccpXp"},{"type":"inlineMath","value":"k","position":{"start":{"line":282,"column":1},"end":{"line":282,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span>","key":"jcqlzAxXL5"},{"type":"text","value":" should be left out of the computation, as they don’t represent the linear trend.","position":{"start":{"line":282,"column":1},"end":{"line":282,"column":1}},"key":"nR82TljEam"}],"key":"FxzT06nhhK"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"y = log(err(5:12));\np = polyfit(5:12, y, 1);","key":"Hdr2TS4jb6"},{"type":"output","id":"Ycpi4pln44y2x0GGKB_Qa","data":[],"key":"kV0VYdnOG8"}],"key":"XNGPAyRcyb"},{"type":"paragraph","position":{"start":{"line":289,"column":1},"end":{"line":289,"column":1}},"children":[{"type":"text","value":"We can exponentiate the slope to get the convergence constant ","position":{"start":{"line":289,"column":1},"end":{"line":289,"column":1}},"key":"BEldU1DypJ"},{"type":"text","value":"σ","position":{"start":{"line":289,"column":1},"end":{"line":289,"column":1}},"key":"rRt4tMIMbK"},{"type":"text","value":".","position":{"start":{"line":289,"column":1},"end":{"line":289,"column":1}},"key":"PTVS1YRsoT"}],"key":"Tgth9Eqc0T"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"sigma = exp(p(1))","key":"NvsqLps1Jb"},{"type":"output","id":"hp__PG9rV4XfrrQhvwLw6","data":[{"output_type":"execute_result","execution_count":24,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>sigma = 1.6182e+03</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"sigma = 1.6182e+03","content_type":"text/plain"}}}],"key":"EiCIuRwIwQ"}],"key":"YyYaioIHWm"},{"type":"paragraph","position":{"start":{"line":295,"column":1},"end":{"line":295,"column":1}},"children":[{"type":"text","value":"The error should therefore decrease by a factor of ","position":{"start":{"line":295,"column":1},"end":{"line":295,"column":1}},"key":"TcDBVif2Fv"},{"type":"text","value":"σ","position":{"start":{"line":295,"column":1},"end":{"line":295,"column":1}},"key":"ShZD7QmFvj"},{"type":"text","value":" at each iteration. We can check this easily from the observed data.","position":{"start":{"line":295,"column":1},"end":{"line":295,"column":1}},"key":"RuXK1IvMVy"}],"key":"jBOiKtog75"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"err(9:12) ./ err(8:11)","key":"hib7VfOjp8"},{"type":"output","id":"jf6LxC_QyCZITS3CumXhz","data":[{"output_type":"execute_result","execution_count":25,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = 1×4 double\n   NaN   NaN   NaN   NaN\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = 1×4 double\n   NaN   NaN   NaN   NaN\n","content_type":"text/plain"}}}],"key":"oKOGiSfZC5"}],"key":"KXBVSl1lcH"},{"type":"paragraph","position":{"start":{"line":301,"column":1},"end":{"line":301,"column":1}},"children":[{"type":"text","value":"The methods for finding ","position":{"start":{"line":301,"column":1},"end":{"line":301,"column":1}},"key":"uPr7mYtT5p"},{"type":"text","value":"σ","position":{"start":{"line":301,"column":1},"end":{"line":301,"column":1}},"key":"FQNoTI9mlV"},{"type":"text","value":" agree well.","position":{"start":{"line":301,"column":1},"end":{"line":301,"column":1}},"key":"Au7aaNxBR8"}],"key":"Vd5bmuneJP"}],"label":"demo-fp-converge-matlab","identifier":"demo-fp-converge-matlab","html_id":"demo-fp-converge-matlab","key":"k17VAarFTO"},{"type":"heading","depth":3,"position":{"start":{"line":303,"column":1},"end":{"line":303,"column":1}},"children":[{"type":"text","value":"4.3 ","position":{"start":{"line":303,"column":1},"end":{"line":303,"column":1}},"key":"zPLSxQnMTA"},{"type":"link","identifier":"section-nonlineqn-newton","label":"section-nonlineqn-newton","kind":"narrative","position":{"start":{"line":303,"column":5},"end":{"line":303,"column":30}},"url":"/newton","internal":true,"dataUrl":"/newton.json","children":[{"type":"text","value":"Newton’s method","key":"wZJf6vzMHE"}],"key":"UZmOcbJ0QR"}],"identifier":"id-4-3","label":"4.3 ","html_id":"id-4-3","implicit":true,"key":"XnHbVgInlA"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-newton-line","label":"demo-newton-line","kind":"proof:example","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":18}},"children":[{"type":"text","value":"Example ","key":"NtHSHxoCLy"},{"type":"text","value":"4.3.1","key":"RnKsbswx99"}],"template":"Example %s","enumerator":"4.3.1","resolved":true,"html_id":"demo-newton-line","remote":true,"url":"/newton","dataUrl":"/newton.json","key":"lHto3Rj6Np"}],"key":"zUeThVFyx5"},{"type":"paragraph","position":{"start":{"line":308,"column":1},"end":{"line":308,"column":1}},"children":[{"type":"text","value":"Suppose we want to find a root of the function","position":{"start":{"line":308,"column":1},"end":{"line":308,"column":1}},"key":"EAzvhNkPuD"}],"key":"XcdHJKw1tB"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"f = @(x) x .* exp(x) - 2;\nclf, fplot(f, [0, 1.5])\nxlabel('x'), ylabel('y')    \nset(gca, 'ygrid', 'on')  \ntitle('Objective function')","key":"hPW1NE9vXh"},{"type":"output","id":"i7-p8Y4nPm5M8hF59vYmt","data":[{"output_type":"execute_result","execution_count":26,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"452ccfa6abd6b292047644f74fe65bf3","path":"/build/452ccfa6abd6b292047644f74fe65bf3.png"}}}],"key":"hrHLmkslqJ"}],"key":"NHzmPWLJLK"},{"type":"paragraph","position":{"start":{"line":319,"column":1},"end":{"line":319,"column":1}},"children":[{"type":"text","value":"From the graph, it is clear that there is a root near ","position":{"start":{"line":319,"column":1},"end":{"line":319,"column":1}},"key":"dVQxQRLeib"},{"type":"inlineMath","value":"x=1","position":{"start":{"line":319,"column":1},"end":{"line":319,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">x=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"uBPcR7hELK"},{"type":"text","value":". So we call that our initial guess, ","position":{"start":{"line":319,"column":1},"end":{"line":319,"column":1}},"key":"rMhrrVbKzx"},{"type":"inlineMath","value":"x_1","position":{"start":{"line":319,"column":1},"end":{"line":319,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">x_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"jBW1Kfdlm2"},{"type":"text","value":".","position":{"start":{"line":319,"column":1},"end":{"line":319,"column":1}},"key":"lNqcAdZoZd"}],"key":"EGQRcdvB5s"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"x1 = 1;\ny1 = f(x1)\nhold on, scatter(x1, y1, 'k')","key":"K4ranWCMlz"},{"type":"output","id":"9aeApDuPgu7w26U3BP1zn","data":[{"output_type":"execute_result","execution_count":27,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>y1 = 0.7183</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"y1 = 0.7183","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":27,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"f208c056133ac175a51e15b7cdca2f52","path":"/build/f208c056133ac175a51e15b7cdca2f52.png"}}}],"key":"MAV4IhZpot"}],"key":"MnpNOGPYk9"},{"type":"paragraph","position":{"start":{"line":327,"column":1},"end":{"line":327,"column":1}},"children":[{"type":"text","value":"Next, we can compute the tangent line at the point ","position":{"start":{"line":327,"column":1},"end":{"line":327,"column":1}},"key":"XRqD4aLeRo"},{"type":"inlineMath","value":"\\bigl(x_1,f(x_1)\\bigr)","position":{"start":{"line":327,"column":1},"end":{"line":327,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo fence=\"true\" stretchy=\"true\" minsize=\"1.2em\" maxsize=\"1.2em\">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><mi>f</mi><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy=\"false\">)</mo><mo fence=\"true\" stretchy=\"true\" minsize=\"1.2em\" maxsize=\"1.2em\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\bigl(x_1,f(x_1)\\bigr)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.2em;vertical-align:-0.35em;\"></span><span class=\"mopen\"><span class=\"delimsizing size1\">(</span></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mclose\"><span class=\"delimsizing size1\">)</span></span></span></span></span>","key":"qgSvRczMNA"},{"type":"text","value":", using the derivative.","position":{"start":{"line":327,"column":1},"end":{"line":327,"column":1}},"key":"uiDtk2cOLP"}],"key":"eNlWBZMY8U"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"df_dx = @(x) exp(x) .* (x + 1);\nslope1 = df_dx(x1);\ntangent1 = @(x) y1 + slope1 * (x - x1);\naxis(axis)\nfplot(tangent1, [0, 1.5], 'k--')\ntitle('Function and tangent line')","key":"TLspnTxXy5"},{"type":"output","id":"8D__Zv0yNmmmtRDSe591m","data":[{"output_type":"execute_result","execution_count":28,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"564a37e1f60fc1883fb16c4da231359f","path":"/build/564a37e1f60fc1883fb16c4da231359f.png"}}}],"key":"eRyas1LeJs"}],"key":"zQizSuObsm"},{"type":"paragraph","position":{"start":{"line":339,"column":1},"end":{"line":339,"column":1}},"children":[{"type":"text","value":"In lieu of finding the root of ","position":{"start":{"line":339,"column":1},"end":{"line":339,"column":1}},"key":"cAI3zpP3sH"},{"type":"inlineMath","value":"f","position":{"start":{"line":339,"column":1},"end":{"line":339,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>","key":"tMuENgvHm1"},{"type":"text","value":" itself, we settle for finding the root of the tangent line approximation, which is trivial. Call this ","position":{"start":{"line":339,"column":1},"end":{"line":339,"column":1}},"key":"DzQsQcrmjl"},{"type":"inlineMath","value":"x_2","position":{"start":{"line":339,"column":1},"end":{"line":339,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">x_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"pZARa9uvmJ"},{"type":"text","value":", our next approximation to the root.","position":{"start":{"line":339,"column":1},"end":{"line":339,"column":1}},"key":"vopY1ivHHj"}],"key":"PpZdpMvtKw"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"x2 = x1 - y1 / slope1\nscatter(x2, 0, 'r')\ntitle('Root of the tangent')","key":"lrEj7lRdfi"},{"type":"output","id":"88fkZAXcDHgamFD7DtwOl","data":[{"output_type":"execute_result","execution_count":29,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>x2 = \n   0.867879441171442\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"x2 = \n   0.867879441171442\n","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":29,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"b562eda8256f2630e894650d24b132a8","path":"/build/b562eda8256f2630e894650d24b132a8.png"}}}],"key":"ImSpYiL4EG"}],"key":"OtwqrTXqCF"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"y2 = f(x2)","key":"msplUoa2t7"},{"type":"output","id":"pXHDX1r7IwKrAymjP-ljA","data":[{"output_type":"execute_result","execution_count":30,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>y2 = 0.2492</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"y2 = 0.2492","content_type":"text/plain"}}}],"key":"TidXiddGNG"}],"key":"PkJQYRvrhP"},{"type":"paragraph","position":{"start":{"line":351,"column":1},"end":{"line":351,"column":1}},"children":[{"type":"text","value":"The residual (i.e., value of ","position":{"start":{"line":351,"column":1},"end":{"line":351,"column":1}},"key":"cbUpaOpAZG"},{"type":"inlineMath","value":"f","position":{"start":{"line":351,"column":1},"end":{"line":351,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>","key":"Pyu5GYiwyo"},{"type":"text","value":") is smaller than before, but not zero. So we repeat the process with a new tangent line based on the latest point on the curve.","position":{"start":{"line":351,"column":1},"end":{"line":351,"column":1}},"key":"bJ5TW7jjvY"}],"key":"rBWyTErZkJ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"cla,  axis auto\nfplot(f, [0.83, 0.88])\nscatter(x2, y2, 'k')\nslope2 = df_dx(x2);\ntangent2 = @(x) y2 + slope2 * (x - x2);\naxis(axis)\nfplot(tangent2, [0.8, 0.9], 'k--')\nx3 = x2 - y2 / slope2;\nscatter(x3, 0, 'r')\ntitle('Next iteration')","key":"jfz0Z22OLT"},{"type":"output","id":"XOAFSrqnplpimMe0re5EE","data":[{"output_type":"execute_result","execution_count":31,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"29ffd379e58b1c30567727755c222eca","path":"/build/29ffd379e58b1c30567727755c222eca.png"}}}],"key":"A0keC283q8"}],"key":"QntUhWuPeX"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"y3 = f(x3)","key":"lL6I06sjJO"},{"type":"output","id":"r-wSskGyq-WX4QoTaAP52","data":[{"output_type":"execute_result","execution_count":32,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>y3 = 0.0866</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"y3 = 0.0866","content_type":"text/plain"}}}],"key":"zmfmbqsYW0"}],"key":"rTDrIHhTZb"},{"type":"paragraph","position":{"start":{"line":370,"column":1},"end":{"line":370,"column":1}},"children":[{"type":"text","value":"Judging by the residual, we appear to be getting closer to the true root each time.","position":{"start":{"line":370,"column":1},"end":{"line":370,"column":1}},"key":"UZ6jXgyDQO"}],"key":"DWMAzQJznN"}],"label":"demo-newton-line-matlab","identifier":"demo-newton-line-matlab","html_id":"demo-newton-line-matlab","key":"ABgT3KiLFN"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-newton-converge","label":"demo-newton-converge","kind":"proof:example","position":{"start":{"line":374,"column":1},"end":{"line":374,"column":22}},"children":[{"type":"text","value":"Example ","key":"vbcX2Y0O3T"},{"type":"text","value":"4.3.2","key":"Ny7jXZApN0"}],"template":"Example %s","enumerator":"4.3.2","resolved":true,"html_id":"demo-newton-converge","remote":true,"url":"/newton","dataUrl":"/newton.json","key":"uHhYUbr2AT"}],"key":"n56cl4XUJd"},{"type":"paragraph","position":{"start":{"line":376,"column":1},"end":{"line":376,"column":1}},"children":[{"type":"text","value":"We again look at finding a solution of ","position":{"start":{"line":376,"column":1},"end":{"line":376,"column":1}},"key":"TRN4M1n6j4"},{"type":"inlineMath","value":"x e^x=2","position":{"start":{"line":376,"column":1},"end":{"line":376,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><msup><mi>e</mi><mi>x</mi></msup><mo>=</mo><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">x e^x=2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6644em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span></span></span></span>","key":"GFYTx3XxUN"},{"type":"text","value":" near ","position":{"start":{"line":376,"column":1},"end":{"line":376,"column":1}},"key":"PNCxk3rCay"},{"type":"inlineMath","value":"x=1","position":{"start":{"line":376,"column":1},"end":{"line":376,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">x=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"A56FyZiiJH"},{"type":"text","value":". To apply Newton’s method, we need to calculate values of both the residual function ","position":{"start":{"line":376,"column":1},"end":{"line":376,"column":1}},"key":"sonwpxfMew"},{"type":"inlineMath","value":"f","position":{"start":{"line":376,"column":1},"end":{"line":376,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>","key":"yTXAY69BnH"},{"type":"text","value":" and its derivative.","position":{"start":{"line":376,"column":1},"end":{"line":376,"column":1}},"key":"KK8o6p7pud"}],"key":"MsxY8V0hUE"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"f = @(x) x.*exp(x) - 2;\ndf_dx = @(x) exp(x).*(x+1);","key":"JI2ho13RNy"},{"type":"output","id":"JTgrzXudiMq_KVUy87RlJ","data":[],"key":"UrF4YB31XZ"}],"key":"vlfEslKtat"},{"type":"paragraph","position":{"start":{"line":383,"column":1},"end":{"line":383,"column":1}},"children":[{"type":"text","value":"We don’t know the exact root, so we use ","position":{"start":{"line":383,"column":1},"end":{"line":383,"column":1}},"key":"mu8fqHI1Ao"},{"type":"inlineCode","value":"nlsolve","position":{"start":{"line":383,"column":1},"end":{"line":383,"column":1}},"key":"Tdbo8CN2uj"},{"type":"text","value":" to determine a proxy for it.","position":{"start":{"line":383,"column":1},"end":{"line":383,"column":1}},"key":"DfraKfxp9H"}],"key":"rE8LbhIX7N"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"format long,  r = fzero(f,1)","key":"JSx7Ett3nh"},{"type":"output","id":"vGlObjAGpHeTA_XlHk982","data":[{"output_type":"execute_result","execution_count":34,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>r = \n   0.852605502013726\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"r = \n   0.852605502013726\n","content_type":"text/plain"}}}],"key":"W0tFOxEhCM"}],"key":"epfYlIhrMU"},{"type":"paragraph","position":{"start":{"line":389,"column":1},"end":{"line":389,"column":1}},"children":[{"type":"text","value":"We use ","position":{"start":{"line":389,"column":1},"end":{"line":389,"column":1}},"key":"bJCSUZr5dO"},{"type":"inlineMath","value":"x_1=1","position":{"start":{"line":389,"column":1},"end":{"line":389,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">x_1=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"KXmx7XtRKI"},{"type":"text","value":" as a starting guess and apply the iteration in a loop, storing the sequence of iterates in a vector.","position":{"start":{"line":389,"column":1},"end":{"line":389,"column":1}},"key":"FTuuRmbmco"}],"key":"eSmI6LtXg3"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"x = 1;\nfor k = 1:6\n    x(k+1) = x(k) - f(x(k)) / df_dx(x(k));\nend\nx","key":"nphctweyCn"},{"type":"output","id":"R5j0KgYXI6ZAeJuDUQ0tb","data":[{"output_type":"execute_result","execution_count":35,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>x = 1×7 double\n   1.000000000000000   0.908030139707139   0.792175358038169   0.636918797456303   0.407049725626879   0.001234602266551  -0.996298478312728\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"x = 1×7 double\n   1.000000000000000   0.908030139707139   0.792175358038169   0.636918797456303   0.407049725626879   0.001234602266551  -0.996298478312728\n","content_type":"text/plain"}}}],"key":"JXNgRnzRlU"}],"key":"rf4sOACJkW"},{"type":"paragraph","position":{"start":{"line":399,"column":1},"end":{"line":399,"column":1}},"children":[{"type":"text","value":"Here is the sequence of errors.","position":{"start":{"line":399,"column":1},"end":{"line":399,"column":1}},"key":"kR3WP1mvbz"}],"key":"gsUkHCc8mh"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"format short e\nerr = x' - r","key":"GwPauXvMLK"},{"type":"output","id":"K4B48CFalNt9fWmP0kRUf","data":[{"output_type":"execute_result","execution_count":36,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>err = 1×5 double\n   1.4739e-01   1.4739e-01   1.4739e-01   1.4739e-01   1.4739e-01\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"err = 1×5 double\n   1.4739e-01   1.4739e-01   1.4739e-01   1.4739e-01   1.4739e-01\n","content_type":"text/plain"}}}],"key":"Azpx2O2Q8w"}],"key":"X14h20lXnD"},{"type":"paragraph","position":{"start":{"line":406,"column":1},"end":{"line":406,"column":1}},"children":[{"type":"text","value":"The exponents in the scientific notation definitely suggest a squaring sequence. We can check the evolution of the ratio in ","position":{"start":{"line":406,"column":1},"end":{"line":406,"column":1}},"key":"Jdgq1Q6s3A"},{"type":"crossReference","kind":"equation","identifier":"quadratictest","label":"quadratictest","children":[{"type":"text","value":"(","key":"da2kRTpjEK"},{"type":"text","value":"4.3.9","key":"Okmk99KO70"},{"type":"text","value":")","key":"l90GD8e4GK"}],"template":"(%s)","enumerator":"4.3.9","resolved":true,"html_id":"quadratictest","remote":true,"url":"/newton","dataUrl":"/newton.json","key":"HS9tq8rJkH"},{"type":"text","value":".","position":{"start":{"line":406,"column":1},"end":{"line":406,"column":1}},"key":"Wjg6Momfc4"}],"key":"vy7PzipYnp"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"format short\nlogerr = log(abs(err))","key":"Si2l5TmkKw"},{"type":"output","id":"92VFS1_4OsI91huAXVRNi","data":[{"output_type":"execute_result","execution_count":37,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>logerr = 19×2 double\n   -8.9731  -16.5427\n  -10.3747  -16.5427\n  -11.2124  -13.7476\n  -12.1778  -15.1431\n  -13.0243  -16.3820\n  -14.2799  -20.0692\n  -15.2674  -18.6929\n  -16.1452  -20.0935\n  -17.3150  -20.9849\n  -18.2044  -22.8298\n...</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"logerr = 19×2 double\n   -8.9731  -16.5427\n  -10.3747  -16.5427\n  -11.2124  -13.7476\n  -12.1778  -15.1431\n  -13.0243  -16.3820\n  -14.2799  -20.0692\n  -15.2674  -18.6929\n  -16.1452  -20.0935\n  -17.3150  -20.9849\n  -18.2044  -22.8298\n...","content_type":"text/plain"}}}],"key":"QkHsHX56GZ"}],"key":"wRb82UEKCS"},{"type":"paragraph","position":{"start":{"line":413,"column":1},"end":{"line":413,"column":1}},"children":[{"type":"text","value":"The clear convergence to 2 above constitutes good evidence of quadratic convergence.","position":{"start":{"line":413,"column":1},"end":{"line":413,"column":1}},"key":"u6j0of1BoX"}],"key":"WXhJsaPzHE"}],"label":"demo-newton-converge-matlab","identifier":"demo-newton-converge-matlab","html_id":"demo-newton-converge-matlab","key":"XmkM8T9OaE"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-newton-usage","label":"demo-newton-usage","kind":"proof:example","position":{"start":{"line":417,"column":1},"end":{"line":417,"column":19}},"children":[{"type":"text","value":"Example ","key":"YOeD23MnTI"},{"type":"text","value":"4.3.3","key":"CcmW2GaAWu"}],"template":"Example %s","enumerator":"4.3.3","resolved":true,"html_id":"demo-newton-usage","remote":true,"url":"/newton","dataUrl":"/newton.json","key":"YgI4gsqHLm"}],"key":"IYjU8HIGNV"},{"type":"paragraph","position":{"start":{"line":422,"column":1},"end":{"line":422,"column":1}},"children":[{"type":"text","value":"Suppose we want to evaluate the inverse of the function ","position":{"start":{"line":422,"column":1},"end":{"line":422,"column":1}},"key":"Iid9RjQqbQ"},{"type":"inlineMath","value":"h(x)=e^x-x","position":{"start":{"line":422,"column":1},"end":{"line":422,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>h</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msup><mi>e</mi><mi>x</mi></msup><mo>−</mo><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">h(x)=e^x-x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">h</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7477em;vertical-align:-0.0833em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"iKWTmPSCq6"},{"type":"text","value":". This means solving ","position":{"start":{"line":422,"column":1},"end":{"line":422,"column":1}},"key":"Zm1zFAdZqZ"},{"type":"inlineMath","value":"y=e^x-x","position":{"start":{"line":422,"column":1},"end":{"line":422,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi><mo>=</mo><msup><mi>e</mi><mi>x</mi></msup><mo>−</mo><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">y=e^x-x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7477em;vertical-align:-0.0833em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"TbDzmAIHjV"},{"type":"text","value":" for ","position":{"start":{"line":422,"column":1},"end":{"line":422,"column":1}},"key":"mWvT1mV9vI"},{"type":"inlineMath","value":"x","position":{"start":{"line":422,"column":1},"end":{"line":422,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"c4B7OsXaY5"},{"type":"text","value":" when ","position":{"start":{"line":422,"column":1},"end":{"line":422,"column":1}},"key":"T4CNCArzpO"},{"type":"inlineMath","value":"y","position":{"start":{"line":422,"column":1},"end":{"line":422,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>","key":"ayJ2alOfZc"},{"type":"text","value":" is given, which has no elementary form. If a value of ","position":{"start":{"line":422,"column":1},"end":{"line":422,"column":1}},"key":"b7owXbbL1p"},{"type":"inlineMath","value":"y","position":{"start":{"line":422,"column":1},"end":{"line":422,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>","key":"biS1keCay8"},{"type":"text","value":" is given numerically, though, we simply have a rootfinding problem for ","position":{"start":{"line":422,"column":1},"end":{"line":422,"column":1}},"key":"wBjMPzg6eY"},{"type":"inlineMath","value":"f(x)=e^x-x-y","position":{"start":{"line":422,"column":1},"end":{"line":422,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msup><mi>e</mi><mi>x</mi></msup><mo>−</mo><mi>x</mi><mo>−</mo><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">f(x)=e^x-x-y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7477em;vertical-align:-0.0833em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>","key":"Jgi8p2aTjL"},{"type":"text","value":".","position":{"start":{"line":422,"column":1},"end":{"line":422,"column":1}},"key":"ApqLELg71P"}],"indexEntries":[{"entry":"Julia","subEntry":{"value":"enumerate","kind":"entry"},"emphasis":true}],"label":"index-XA5vZSmVaw","identifier":"index-xa5vzsmvaw","html_id":"index-xa5vzsmvaw","key":"sXqphZ3S9E"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"rxR5Iw3Uff"}],"key":"Xa1oweKuI5"},{"type":"paragraph","position":{"start":{"line":425,"column":1},"end":{"line":425,"column":1}},"children":[{"type":"text","value":"When a function is created, it can refer to any variables in scope at that moment. Those values are locked in to the definition, which is called a ","position":{"start":{"line":425,"column":1},"end":{"line":425,"column":1}},"key":"gaQQDbf7Pq"},{"type":"emphasis","position":{"start":{"line":425,"column":1},"end":{"line":425,"column":1}},"children":[{"type":"text","value":"closure","position":{"start":{"line":425,"column":1},"end":{"line":425,"column":1}},"key":"JSXPzBMU0U"}],"key":"Xa94hyCCLV"},{"type":"text","value":". If the enclosed variables change values later, the function still uses the values it was created with.","position":{"start":{"line":425,"column":1},"end":{"line":425,"column":1}},"key":"Fd6mCrFzOk"}],"key":"Nf1LFwZjIS"}],"class":"dropdown","key":"vNNDMBDZc3"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"h = @(x) exp(x) - x;\ndh_dx = @(x) exp(x) - 1;\ny_ = linspace(h(0), h(2), 200);\nx_ = zeros(size(y_));\nfor i = 1:length(y_)\n    f = @(x) h(x) - y_(i);\n    df_dx = @(x) dh_dx(x);\n    x = newton(f, df_dx, 1);  x_(i) = x(end);\nend","key":"EhrKsFClzN"},{"type":"output","id":"Ju4ZD7dbD8tPHA75P_uwu","data":[],"key":"ECxSRRoexd"}],"key":"y0321BxR1M"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf, fplot(h, [0, 2])\nhold on, axis equal\nplot(y_, x_)\nplot([0, max(y_)], [0, max(y_)], 'k--')\nxlabel('x'), ylabel('y')\nlegend('h(x)', 'inverse', 'y=x');","visibility":"hide","key":"BWwHNuWNnY"},{"type":"output","id":"4D66Tdec4TP9iGMOpm5mc","data":[{"output_type":"execute_result","execution_count":39,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"e6d39e160d8bf7bb32fd62584823140a","path":"/build/e6d39e160d8bf7bb32fd62584823140a.png"}}}],"visibility":"show","key":"MdAGi5p2tZ"}],"data":{"tags":[]},"visibility":"show","key":"zW12D84c6c"}],"label":"demo-newton-usage-matlab","identifier":"demo-newton-usage-matlab","html_id":"demo-newton-usage-matlab","key":"j10N17rJTK"},{"type":"heading","depth":3,"position":{"start":{"line":451,"column":1},"end":{"line":451,"column":1}},"children":[{"type":"text","value":"4.4 ","position":{"start":{"line":451,"column":1},"end":{"line":451,"column":1}},"key":"EqVOjYmkCF"},{"type":"link","identifier":"section-nonlineqn-secant","label":"section-nonlineqn-secant","kind":"narrative","position":{"start":{"line":451,"column":5},"end":{"line":451,"column":30}},"url":"/secant","internal":true,"dataUrl":"/secant.json","children":[{"type":"text","value":"Interpolation-based methods","key":"K1FwWwQfSd"}],"key":"ulhZMY6YfJ"}],"identifier":"id-4-4","label":"4.4 ","html_id":"id-4-4","implicit":true,"key":"aPrD7kYsZP"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-secant-line","label":"demo-secant-line","kind":"proof:example","position":{"start":{"line":454,"column":1},"end":{"line":454,"column":18}},"children":[{"type":"text","value":"Example ","key":"k7akiT2xcv"},{"type":"text","value":"4.4.1","key":"I8e9hpDQQS"}],"template":"Example %s","enumerator":"4.4.1","resolved":true,"html_id":"demo-secant-line","remote":true,"url":"/secant","dataUrl":"/secant.json","key":"XeGOtMrjTY"}],"key":"PaGe2aEnG5"},{"type":"paragraph","position":{"start":{"line":458,"column":1},"end":{"line":458,"column":1}},"children":[{"type":"text","value":"We return to finding a root of the equation ","position":{"start":{"line":458,"column":1},"end":{"line":458,"column":1}},"key":"HjJZG5SIyk"},{"type":"inlineMath","value":"x e^x=2","position":{"start":{"line":458,"column":1},"end":{"line":458,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><msup><mi>e</mi><mi>x</mi></msup><mo>=</mo><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">x e^x=2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6644em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span></span></span></span>","key":"GjDMiXZwA2"},{"type":"text","value":".","position":{"start":{"line":458,"column":1},"end":{"line":458,"column":1}},"key":"iBLF6jRvMB"}],"key":"eV1d1kMNCd"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"f = @(x) x .* exp(x) - 2;\nclf, fplot(f, [0.25, 1.25])\nset(gca, 'ygrid', 'on')  \nxlabel('x'), ylabel('y')    \ntitle('Objective function')","key":"ozxgsQhQfN"},{"type":"output","id":"VcYR55DJ8cGvLPbpH6jwQ","data":[{"output_type":"execute_result","execution_count":40,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"022619a7f00f0d4b7f1ff5e728b649ea","path":"/build/022619a7f00f0d4b7f1ff5e728b649ea.png"}}}],"key":"kAxrEMUCf4"}],"key":"HXWeoPUUsK"},{"type":"paragraph","position":{"start":{"line":468,"column":1},"end":{"line":468,"column":1}},"children":[{"type":"text","value":"From the graph, it’s clear that there is a root near ","position":{"start":{"line":468,"column":1},"end":{"line":468,"column":1}},"key":"srP8KaT4q2"},{"type":"inlineMath","value":"x=1","position":{"start":{"line":468,"column":1},"end":{"line":468,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">x=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"SMrYguVM43"},{"type":"text","value":". To be more precise, there is a root in the interval ","position":{"start":{"line":468,"column":1},"end":{"line":468,"column":1}},"key":"XZmVicBMO4"},{"type":"inlineMath","value":"[0.5,1]","position":{"start":{"line":468,"column":1},"end":{"line":468,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mn>0.5</mn><mo separator=\"true\">,</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[0.5,1]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">0.5</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]</span></span></span></span>","key":"AYASGTU5ti"},{"type":"text","value":". So let us take the endpoints of that interval as ","position":{"start":{"line":468,"column":1},"end":{"line":468,"column":1}},"key":"LeNAyR9UoH"},{"type":"emphasis","position":{"start":{"line":468,"column":1},"end":{"line":468,"column":1}},"children":[{"type":"text","value":"two","position":{"start":{"line":468,"column":1},"end":{"line":468,"column":1}},"key":"A2EugM00mM"}],"key":"UGhT6nnVW9"},{"type":"text","value":" initial approximations.","position":{"start":{"line":468,"column":1},"end":{"line":468,"column":1}},"key":"XRYSd0zQEb"}],"key":"llamGEV3KQ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"x1 = 1;    y1 = f(x1);\nx2 = 0.5;  y2 = f(x2);\nhold on, scatter([x1, x2], [y1, y2])\ntitle('Two initial values')","key":"tDXywyeiZY"},{"type":"output","id":"thRSaZGVWr2Z5eLohN30q","data":[{"output_type":"stream","name":"stderr","text":"Array indices must be positive integers or logical values."}],"key":"z8aII5XL3l"}],"key":"amEtYBxJM8"},{"type":"paragraph","position":{"start":{"line":477,"column":1},"end":{"line":477,"column":1}},"children":[{"type":"text","value":"Instead of constructing the tangent line by evaluating the derivative, we can construct a linear model function by drawing the line between the two points ","position":{"start":{"line":477,"column":1},"end":{"line":477,"column":1}},"key":"tS7ZaCT5EE"},{"type":"inlineMath","value":"\\bigl(x_1,f(x_1)\\bigr)","position":{"start":{"line":477,"column":1},"end":{"line":477,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo fence=\"true\" stretchy=\"true\" minsize=\"1.2em\" maxsize=\"1.2em\">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><mi>f</mi><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy=\"false\">)</mo><mo fence=\"true\" stretchy=\"true\" minsize=\"1.2em\" maxsize=\"1.2em\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\bigl(x_1,f(x_1)\\bigr)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.2em;vertical-align:-0.35em;\"></span><span class=\"mopen\"><span class=\"delimsizing size1\">(</span></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mclose\"><span class=\"delimsizing size1\">)</span></span></span></span></span>","key":"u20VaVO4Y3"},{"type":"text","value":" and ","position":{"start":{"line":477,"column":1},"end":{"line":477,"column":1}},"key":"eSi0WTOosv"},{"type":"inlineMath","value":"\\bigl(x_2,f(x_2)\\bigr)","position":{"start":{"line":477,"column":1},"end":{"line":477,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo fence=\"true\" stretchy=\"true\" minsize=\"1.2em\" maxsize=\"1.2em\">(</mo><msub><mi>x</mi><mn>2</mn></msub><mo separator=\"true\">,</mo><mi>f</mi><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mn>2</mn></msub><mo stretchy=\"false\">)</mo><mo fence=\"true\" stretchy=\"true\" minsize=\"1.2em\" maxsize=\"1.2em\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\bigl(x_2,f(x_2)\\bigr)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.2em;vertical-align:-0.35em;\"></span><span class=\"mopen\"><span class=\"delimsizing size1\">(</span></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mclose\"><span class=\"delimsizing size1\">)</span></span></span></span></span>","key":"Unrb4CzVJ7"},{"type":"text","value":". This is called a ","position":{"start":{"line":477,"column":1},"end":{"line":477,"column":1}},"key":"TrnKhqDOje"},{"type":"emphasis","position":{"start":{"line":477,"column":1},"end":{"line":477,"column":1}},"children":[{"type":"text","value":"secant line","position":{"start":{"line":477,"column":1},"end":{"line":477,"column":1}},"key":"A3jyWRMRki"}],"key":"viLTACcmVv"},{"type":"text","value":".","position":{"start":{"line":477,"column":1},"end":{"line":477,"column":1}},"key":"jx84l4I0XO"}],"key":"zxoiYQqZwO"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"slope2 = (y2 - y1) / (x2 - x1);\nsecant2 = @(x) y2 + slope2 * (x - x2);","key":"TAxNwR7ioN"},{"type":"output","id":"7omWTKRMbaZ36mSLxgA6r","data":[{"output_type":"stream","name":"stderr","text":"Failed to execute. Operation may have interrupted by user."}],"key":"lXcWiaM9or"}],"key":"k0umXlhG7k"},{"type":"paragraph","position":{"start":{"line":484,"column":1},"end":{"line":484,"column":1}},"children":[{"type":"text","value":"As before, the next root estimate in the iteration is the root of this linear model.","position":{"start":{"line":484,"column":1},"end":{"line":484,"column":1}},"key":"JG02hW5yEV"}],"key":"vp7ngOMzRh"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"fplot(secant2,[0.25, 1.25],'k--')\nx3 = x2 - y2 / slope2;\ny3 = f(x3)\nscatter(x3, 0)\ntitle('Next value')","key":"AcI6ZQRQ7b"},{"type":"output","id":"27GHEI5mZwzjY3o0QjaJf","data":[{"output_type":"stream","name":"stderr","text":"Unrecognized function or variable 'secant2'."}],"key":"rp3aRtZ4Ml"}],"key":"kHmQu6gm7U"},{"type":"paragraph","position":{"start":{"line":494,"column":1},"end":{"line":494,"column":1}},"children":[{"type":"text","value":"For the next linear model, we use the line through the two most recent points. The next iterate is the root of that secant line, and so on.","position":{"start":{"line":494,"column":1},"end":{"line":494,"column":1}},"key":"FUzOud4lAf"}],"key":"rpQ1qYVRTc"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"slope2 = (y3 - y2) / (x3 - x2);\nx4 = x3 - y3 / slope2;\ny4 = f(x4)","key":"qJ0d7UUZQi"},{"type":"output","id":"x-gLYiCSiOnqNFmlM8mkS","data":[{"output_type":"execute_result","execution_count":44,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>y4 = \n   1.7050e+00\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"y4 = \n   1.7050e+00\n","content_type":"text/plain"}}}],"key":"KffbeEGSUE"}],"key":"dtacRNbwfK"}],"label":"demo-secant-line-matlab","identifier":"demo-secant-line-matlab","html_id":"demo-secant-line-matlab","key":"fxu2EI3lq0"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-secant-converge","label":"demo-secant-converge","kind":"proof:example","position":{"start":{"line":504,"column":1},"end":{"line":504,"column":22}},"children":[{"type":"text","value":"Example ","key":"yhodhSzEVi"},{"type":"text","value":"4.4.2","key":"TzqjKED1JJ"}],"template":"Example %s","enumerator":"4.4.2","resolved":true,"html_id":"demo-secant-converge","remote":true,"url":"/secant","dataUrl":"/secant.json","key":"BvJ8JsjgSf"}],"key":"nhEHYN3tS2"},{"type":"paragraph","position":{"start":{"line":506,"column":1},"end":{"line":506,"column":1}},"children":[{"type":"text","value":"We check the convergence of the secant method from ","position":{"start":{"line":506,"column":1},"end":{"line":506,"column":1}},"key":"M35iOYCA6i"},{"type":"crossReference","kind":"proof:example","identifier":"demo-secant-line","label":"demo-secant-line","children":[{"type":"text","value":"Demo ","key":"HSy1MGdIVH"},{"type":"text","value":"4.4.1","key":"eZF4WV8B0j"}],"template":"Example %s","enumerator":"4.4.1","resolved":true,"html_id":"demo-secant-line","remote":true,"url":"/secant","dataUrl":"/secant.json","key":"w8wEd4tnCG"},{"type":"text","value":".","position":{"start":{"line":506,"column":1},"end":{"line":506,"column":1}},"key":"pOFKLP7ucN"}],"key":"Ir00QT0Vyp"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"f = @(x) x .* exp(x) - 2;\nx = secant(f, 1, 0.5);","key":"i9e3gB1Ejv"},{"type":"output","id":"3ykLFVH0YLfV8ary7Tuhn","data":[],"key":"rXAQFrjvmm"}],"key":"Vs48u7ZlG9"},{"type":"paragraph","position":{"start":{"line":513,"column":1},"end":{"line":513,"column":1}},"children":[{"type":"text","value":"We don’t know the exact root, so we use ","position":{"start":{"line":513,"column":1},"end":{"line":513,"column":1}},"key":"WxJE0SBbL2"},{"type":"inlineCode","value":"fzero","position":{"start":{"line":513,"column":1},"end":{"line":513,"column":1}},"key":"Aciy14Xrim"},{"type":"text","value":" to get a good proxy.","position":{"start":{"line":513,"column":1},"end":{"line":513,"column":1}},"key":"EOm3CZ7kzs"}],"key":"RiF30DQnS0"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"r = fzero(f, 1);","key":"J7SWSgIZnm"},{"type":"output","id":"h5g2J4BxO5jP4P_abhiiR","data":[],"key":"QPVv5CHtYM"}],"key":"vaDWmeuRNz"},{"type":"paragraph","position":{"start":{"line":519,"column":1},"end":{"line":519,"column":1}},"children":[{"type":"text","value":"Here is the sequence of errors.","position":{"start":{"line":519,"column":1},"end":{"line":519,"column":1}},"key":"CegkkPugad"}],"key":"ho8PoMrAmJ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"format short e\nerr = r - x(1:end-1)'","key":"IpfQWZC0w1"},{"type":"output","id":"p6qEk9WYPcmjUWRK-kcfO","data":[{"output_type":"execute_result","execution_count":47,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>err = 1×50 double\n   1.0000e+00   9.8000e-01   9.6000e-01   9.4000e-01   9.2000e-01   9.0000e-01   8.8000e-01   8.6000e-01   8.4000e-01   8.2000e-01   8.0000e-01   7.8000e-01   7.6000e-01   7.4000e-01   7.2000e-01   7.0000e-01   6.8000e-01   6.6000e-01   6.4000e-01   6.2000e-01   6.0000e-01   5.8000e-01   5.6000e-01   5.4000e-01   5.2000e-01   5.0000e-01   4.8000e-01   4.6000e-01   4.4000e-01   4.2000e-01\n...</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"err = 1×50 double\n   1.0000e+00   9.8000e-01   9.6000e-01   9.4000e-01   9.2000e-01   9.0000e-01   8.8000e-01   8.6000e-01   8.4000e-01   8.2000e-01   8.0000e-01   7.8000e-01   7.6000e-01   7.4000e-01   7.2000e-01   7.0000e-01   6.8000e-01   6.6000e-01   6.4000e-01   6.2000e-01   6.0000e-01   5.8000e-01   5.6000e-01   5.4000e-01   5.2000e-01   5.0000e-01   4.8000e-01   4.6000e-01   4.4000e-01   4.2000e-01\n...","content_type":"text/plain"}}}],"key":"cGFRkxTDEC"}],"key":"hcamU36ape"},{"type":"paragraph","position":{"start":{"line":526,"column":1},"end":{"line":526,"column":1}},"children":[{"type":"text","value":"It’s not easy to see the convergence rate by staring at these numbers. We can use ","position":{"start":{"line":526,"column":1},"end":{"line":526,"column":1}},"key":"zF4R6HrWxy"},{"type":"crossReference","kind":"equation","identifier":"superlinear-rate","label":"superlinear-rate","children":[{"type":"text","value":"(","key":"gOUYNfAp1r"},{"type":"text","value":"4.4.8","key":"IlT2IcJ2t6"},{"type":"text","value":")","key":"V5hJPYujkJ"}],"template":"(%s)","enumerator":"4.4.8","resolved":true,"html_id":"superlinear-rate","remote":true,"url":"/secant","dataUrl":"/secant.json","key":"etW9JKlK9o"},{"type":"text","value":" to try to expose the superlinear convergence rate.","position":{"start":{"line":526,"column":1},"end":{"line":526,"column":1}},"key":"K6CDD7UPFP"}],"key":"vaRIALMHCE"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"logerr = log(abs(err));\nratios = logerr(2:end) ./ logerr(1:end-1)","key":"HK9eMtkSxH"},{"type":"output","id":"4o3DCWTsN_MY7-tYGIj-d","data":[{"output_type":"execute_result","execution_count":48,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ratios = 1×49 double\n                -Inf   2.020620002986183   1.515736907156411   1.347572766053351   1.263594178601675   1.213294854450433   1.179839723799517   1.156014100058703   1.138210974697328   1.124426786535555   1.113459734037484   1.104545376700020   1.097174441041137   1.090994721925133   1.085755032582578   1.081271581774557   1.077406967581674   1.074056594319013   1.071139627669264   1.068592818274924   1.066366192490006   1.064419991131923   1.062722463095990   1.061248258550796   1.059977252960600   1.058893689053569   1.057985561061397   1.057244191293298   1.056663967882805   1.056242227366518\n...</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ratios = 1×49 double\n                -Inf   2.020620002986183   1.515736907156411   1.347572766053351   1.263594178601675   1.213294854450433   1.179839723799517   1.156014100058703   1.138210974697328   1.124426786535555   1.113459734037484   1.104545376700020   1.097174441041137   1.090994721925133   1.085755032582578   1.081271581774557   1.077406967581674   1.074056594319013   1.071139627669264   1.068592818274924   1.066366192490006   1.064419991131923   1.062722463095990   1.061248258550796   1.059977252960600   1.058893689053569   1.057985561061397   1.057244191293298   1.056663967882805   1.056242227366518\n...","content_type":"text/plain"}}}],"key":"hJ5XvrANmR"}],"key":"L3RxciMbto"},{"type":"paragraph","position":{"start":{"line":533,"column":1},"end":{"line":533,"column":1}},"children":[{"type":"text","value":"As expected, this settles in at around 1.618.","position":{"start":{"line":533,"column":1},"end":{"line":533,"column":1}},"key":"LUfLLSLnUW"}],"key":"gLPoJv25OM"}],"label":"demo-secant-converge-matlab","identifier":"demo-secant-converge-matlab","html_id":"demo-secant-converge-matlab","key":"JRY04FOsNn"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-secant-iqi","label":"demo-secant-iqi","kind":"proof:example","position":{"start":{"line":537,"column":1},"end":{"line":537,"column":17}},"children":[{"type":"text","value":"Example ","key":"eozL6IPHDW"},{"type":"text","value":"4.4.3","key":"U2d2CuCWIX"}],"template":"Example %s","enumerator":"4.4.3","resolved":true,"html_id":"demo-secant-iqi","remote":true,"url":"/secant","dataUrl":"/secant.json","key":"vIMNcsTW33"}],"key":"jOhk7OA9H5"},{"type":"paragraph","position":{"start":{"line":539,"column":1},"end":{"line":539,"column":1}},"children":[{"type":"text","value":"Here we look for a root of ","position":{"start":{"line":539,"column":1},"end":{"line":539,"column":1}},"key":"qh28aedqCW"},{"type":"inlineMath","value":"x+\\cos(10x)","position":{"start":{"line":539,"column":1},"end":{"line":539,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mo>+</mo><mi>cos</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mn>10</mn><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">x+\\cos(10x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop\">cos</span><span class=\"mopen\">(</span><span class=\"mord\">10</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span>","key":"NRz9ZfKZH0"},{"type":"text","value":" that is close to 1.","position":{"start":{"line":539,"column":1},"end":{"line":539,"column":1}},"key":"rFvizlOEV9"}],"key":"D4EWMaSGKX"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"f = @(x) x + cos(10 * x);\ninterval = [0.5, 1.5];\nclf, fplot(f, interval)\nset(gca, 'ygrid', 'on'), axis(axis)   \ntitle('Objective function')    \nxlabel('x'), ylabel('y')    \nr = fzero(f, 1)","key":"xXvMJBJIcF"},{"type":"output","id":"upiIO5HA6rjZ_BbvsZ2WO","data":[{"output_type":"execute_result","execution_count":49,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"a87d0b468b1f2bc034915119cc16b3e1","path":"/build/a87d0b468b1f2bc034915119cc16b3e1.png"}}},{"output_type":"execute_result","execution_count":49,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>r = \n   0.967888401848826\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"r = \n   0.967888401848826\n","content_type":"text/plain"}}}],"key":"dDlddYYmx2"}],"key":"TneD4I1PFu"},{"type":"paragraph","position":{"start":{"line":551,"column":1},"end":{"line":551,"column":1}},"children":[{"type":"text","value":"We choose three values to get the iteration started.","position":{"start":{"line":551,"column":1},"end":{"line":551,"column":1}},"key":"bJv0ivPxIb"}],"key":"hzCoyGJSQV"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"x = [0.8, 1.2, 1]';\ny = f(x);\nhold on, scatter(x, y)\ntitle('Three initial points')","key":"R0yCIlNVIC"},{"type":"output","id":"Ics_z7Y59qOyYKiEIRWi6","data":[{"output_type":"execute_result","execution_count":50,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"a5f5865bd25937ad463f66a55348949f","path":"/build/a5f5865bd25937ad463f66a55348949f.png"}}}],"key":"Dev5ioBrRt"}],"key":"mad7VAr6RY"},{"type":"paragraph","position":{"start":{"line":560,"column":1},"end":{"line":560,"column":1}},"children":[{"type":"text","value":"If we were using forward interpolation, we would ask for the polynomial interpolant of ","position":{"start":{"line":560,"column":1},"end":{"line":560,"column":1}},"key":"vAEYOhWXhN"},{"type":"inlineMath","value":"y","position":{"start":{"line":560,"column":1},"end":{"line":560,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>","key":"mGz6CtV4bA"},{"type":"text","value":" as a function of ","position":{"start":{"line":560,"column":1},"end":{"line":560,"column":1}},"key":"iwpuoeUdKm"},{"type":"inlineMath","value":"x","position":{"start":{"line":560,"column":1},"end":{"line":560,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"eKcUkEMPG0"},{"type":"text","value":". But that parabola has no real roots.","position":{"start":{"line":560,"column":1},"end":{"line":560,"column":1}},"key":"SuzPo3TxoY"}],"key":"GC1KeYI5dm"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"c = polyfit(x, y, 2);    % coefficients of interpolant\nq = @(x) polyval(c, x);\nfplot(q, interval, '--')\ntitle('Parabola model')","key":"XD74iRgLX8"},{"type":"output","id":"KnVfx-AuSL39TU8XbRrtq","data":[{"output_type":"execute_result","execution_count":51,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"edab403e2ea4cbaaf6b411e39c6837a8","path":"/build/edab403e2ea4cbaaf6b411e39c6837a8.png"}}}],"key":"L91NoTdOS7"}],"key":"YjlyB8Z4TQ"},{"type":"paragraph","position":{"start":{"line":569,"column":1},"end":{"line":569,"column":1}},"children":[{"type":"text","value":"To do inverse interpolation, we swap the roles of ","position":{"start":{"line":569,"column":1},"end":{"line":569,"column":1}},"key":"vOBS8FPyp0"},{"type":"inlineMath","value":"x","position":{"start":{"line":569,"column":1},"end":{"line":569,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"zVpJYiUbFF"},{"type":"text","value":" and ","position":{"start":{"line":569,"column":1},"end":{"line":569,"column":1}},"key":"ObrzutweYu"},{"type":"inlineMath","value":"y","position":{"start":{"line":569,"column":1},"end":{"line":569,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>","key":"s4dHmTFHZz"},{"type":"text","value":" in the interpolation.","position":{"start":{"line":569,"column":1},"end":{"line":569,"column":1}},"key":"KsEAPQvE2A"}],"key":"ye0zzZNpeI"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"rZxniSOU2L"}],"key":"CzT2TwIHXR"},{"type":"paragraph","position":{"start":{"line":573,"column":1},"end":{"line":573,"column":1}},"children":[{"type":"text","value":"By giving two functions in the ","position":{"start":{"line":573,"column":1},"end":{"line":573,"column":1}},"key":"LEyAJ2wvUh"},{"type":"inlineCode","value":"fplot","position":{"start":{"line":573,"column":1},"end":{"line":573,"column":1}},"key":"Pn9mStoUUX"},{"type":"text","value":" call, we get the parametric plot ","position":{"start":{"line":573,"column":1},"end":{"line":573,"column":1}},"key":"ST7moaTwaD"},{"type":"inlineMath","value":"(q(y),y)","position":{"start":{"line":573,"column":1},"end":{"line":573,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>q</mi><mo stretchy=\"false\">(</mo><mi>y</mi><mo stretchy=\"false\">)</mo><mo separator=\"true\">,</mo><mi>y</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(q(y),y)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span></span></span></span>","key":"bSDlvLpyx9"},{"type":"text","value":" as a function of ","position":{"start":{"line":573,"column":1},"end":{"line":573,"column":1}},"key":"L2lSrxHNQf"},{"type":"inlineMath","value":"y","position":{"start":{"line":573,"column":1},"end":{"line":573,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>","key":"hSxhMNoIhS"},{"type":"text","value":".","position":{"start":{"line":573,"column":1},"end":{"line":573,"column":1}},"key":"DveJ7jnTFX"}],"key":"Q3Zx8OCo3i"}],"class":"dropdown","key":"QI3mcIzunN"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"cla, fplot(f, interval)\nscatter(x, y)     \nc = polyfit(y, x, 2);    % coefficients of interpolating polynomial\nq = @(y) polyval(c, y);\nfplot(q, @(y) y, ylim,'--')    % plot x=q(y), y=y\ntitle('Sideways parabola')","key":"V0Vy23smtJ"},{"type":"output","id":"KAKmIx_YZOywie_FGRtJN","data":[{"output_type":"execute_result","execution_count":52,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"ce0d8e13a55e00c70743f9aec21f6689","path":"/build/ce0d8e13a55e00c70743f9aec21f6689.png"}}}],"key":"bumlRw9eAN"}],"key":"Mo2OtFU6PD"},{"type":"paragraph","position":{"start":{"line":585,"column":1},"end":{"line":585,"column":1}},"children":[{"type":"text","value":"We seek the value of ","position":{"start":{"line":585,"column":1},"end":{"line":585,"column":1}},"key":"BGKYycFMtn"},{"type":"inlineMath","value":"x","position":{"start":{"line":585,"column":1},"end":{"line":585,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"CVQalWTVVI"},{"type":"text","value":" that makes ","position":{"start":{"line":585,"column":1},"end":{"line":585,"column":1}},"key":"YwLubBssNi"},{"type":"inlineMath","value":"y","position":{"start":{"line":585,"column":1},"end":{"line":585,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>","key":"C85vxw2vtx"},{"type":"text","value":" zero. This means evaluating ","position":{"start":{"line":585,"column":1},"end":{"line":585,"column":1}},"key":"GvxZJ07Vx8"},{"type":"inlineMath","value":"q","position":{"start":{"line":585,"column":1},"end":{"line":585,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>q</mi></mrow><annotation encoding=\"application/x-tex\">q</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span></span></span></span>","key":"AmahLkXHqu"},{"type":"text","value":" at zero.","position":{"start":{"line":585,"column":1},"end":{"line":585,"column":1}},"key":"PReVIFXwqS"}],"key":"WDMKN4a1zy"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"x = [x; q(0)];\ny = [y; f(x(end))]","key":"H5stffvjlA"},{"type":"output","id":"57oAoEYKtCLOBhXiQjrpw","data":[{"output_type":"stream","name":"stderr","text":"Error using vertcat\nDimensions of arrays being concatenated are not consistent."}],"key":"DbhCYb5Aff"}],"key":"q8e4HurOLi"},{"type":"paragraph","position":{"start":{"line":592,"column":1},"end":{"line":592,"column":1}},"children":[{"type":"text","value":"We repeat the process a few more times.","position":{"start":{"line":592,"column":1},"end":{"line":592,"column":1}},"key":"gTCaMjb0BM"}],"key":"EBUmpKFx6V"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"for k = 4:8\n    c = polyfit(y(k-2:k), x(k-2:k), 2);\n    x(k+1) = polyval(c, 0);\n    y(k+1) = f(x(k+1));\nend\ndisp('final residual:')\ny(end)","key":"FxVnZrImKK"},{"type":"output","id":"dkVEgWdd4B4wyPlkd5Gj1","data":[{"output_type":"stream","name":"stdout","text":"final residual:\n"},{"output_type":"execute_result","execution_count":54,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = \n     1\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = \n     1\n","content_type":"text/plain"}}}],"key":"L9KNeGSCff"}],"key":"RIbQo8eMtM"},{"type":"paragraph","position":{"start":{"line":604,"column":1},"end":{"line":604,"column":1}},"children":[{"type":"text","value":"Here is the sequence of errors.","position":{"start":{"line":604,"column":1},"end":{"line":604,"column":1}},"key":"kr6XbRKnxW"}],"key":"vyTEHy5wWB"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"format short e\nerr = x - r","key":"SFcM7gNe3d"},{"type":"output","id":"1VXO5RkjDy6Bc3ULSl_Tj","data":[{"output_type":"execute_result","execution_count":55,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>err = 1×80 double\n  -9.6789e-01  -9.5523e-01  -9.4257e-01  -9.2991e-01  -9.6789e-01  -9.6891e-01  -8.8926e-01   4.2352e+00  -2.8668e-01  -8.5396e-01  -8.4131e-01  -8.2865e-01  -8.1599e-01  -8.0333e-01  -7.9067e-01  -7.7801e-01  -7.6536e-01  -7.5270e-01  -7.4004e-01  -7.2738e-01  -7.1472e-01  -7.0207e-01  -6.8941e-01  -6.7675e-01  -6.6409e-01  -6.5143e-01  -6.3877e-01  -6.2612e-01  -6.1346e-01  -6.0080e-01\n...</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"err = 1×80 double\n  -9.6789e-01  -9.5523e-01  -9.4257e-01  -9.2991e-01  -9.6789e-01  -9.6891e-01  -8.8926e-01   4.2352e+00  -2.8668e-01  -8.5396e-01  -8.4131e-01  -8.2865e-01  -8.1599e-01  -8.0333e-01  -7.9067e-01  -7.7801e-01  -7.6536e-01  -7.5270e-01  -7.4004e-01  -7.2738e-01  -7.1472e-01  -7.0207e-01  -6.8941e-01  -6.7675e-01  -6.6409e-01  -6.5143e-01  -6.3877e-01  -6.2612e-01  -6.1346e-01  -6.0080e-01\n...","content_type":"text/plain"}}}],"key":"TIckuwyZ5q"}],"key":"tsyGF0Wf86"},{"type":"paragraph","position":{"start":{"line":611,"column":1},"end":{"line":611,"column":1}},"children":[{"type":"text","value":"The convergence is probably superlinear:","position":{"start":{"line":611,"column":1},"end":{"line":611,"column":1}},"key":"RY8Rj8wUUr"}],"key":"sNj6Ht8XR0"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"logerr = log(abs(err));\nratios = logerr(2:end) ./ logerr(1:end-1)","key":"PSjfqrjmkI"},{"type":"output","id":"kdrDpwxcans34dBn430-y","data":[{"output_type":"execute_result","execution_count":56,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ratios = 1×79 double\n   1.4033e+00   1.2912e+00   1.2286e+00   4.4917e-01   9.6756e-01   3.7163e+00  -1.2299e+01  -8.6556e-01   1.2636e-01   1.0946e+00   1.0877e+00   1.0819e+00   1.0769e+00   1.0725e+00   1.0687e+00   1.0654e+00   1.0624e+00   1.0597e+00   1.0573e+00   1.0552e+00   1.0532e+00   1.0514e+00   1.0498e+00   1.0484e+00   1.0470e+00   1.0458e+00   1.0447e+00   1.0436e+00   1.0427e+00   1.0418e+00\n...</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ratios = 1×79 double\n   1.4033e+00   1.2912e+00   1.2286e+00   4.4917e-01   9.6756e-01   3.7163e+00  -1.2299e+01  -8.6556e-01   1.2636e-01   1.0946e+00   1.0877e+00   1.0819e+00   1.0769e+00   1.0725e+00   1.0687e+00   1.0654e+00   1.0624e+00   1.0597e+00   1.0573e+00   1.0552e+00   1.0532e+00   1.0514e+00   1.0498e+00   1.0484e+00   1.0470e+00   1.0458e+00   1.0447e+00   1.0436e+00   1.0427e+00   1.0418e+00\n...","content_type":"text/plain"}}}],"key":"IUo7uLVN7C"}],"key":"icJ2OlvzJo"}],"label":"demo-secant-iqi-matlab","identifier":"demo-secant-iqi-matlab","html_id":"demo-secant-iqi-matlab","key":"T5Max1oZVe"},{"type":"heading","depth":3,"position":{"start":{"line":619,"column":1},"end":{"line":619,"column":1}},"children":[{"type":"text","value":"4.5 ","position":{"start":{"line":619,"column":1},"end":{"line":619,"column":1}},"key":"oZUuX35EcY"},{"type":"link","identifier":"section-nonlineqn-newtonsys","label":"section-nonlineqn-newtonsys","kind":"narrative","position":{"start":{"line":619,"column":5},"end":{"line":619,"column":33}},"url":"/newtonsys","internal":true,"dataUrl":"/newtonsys.json","children":[{"type":"text","value":"Newton for nonlinear systems","key":"V0v51T5Uy2"}],"key":"VRvsYBSKKl"}],"identifier":"id-4-5","label":"4.5 ","html_id":"id-4-5","implicit":true,"key":"znKfEkpAZU"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-newtonsys-converge","label":"demo-newtonsys-converge","kind":"proof:example","position":{"start":{"line":621,"column":1},"end":{"line":621,"column":25}},"children":[{"type":"text","value":"Example ","key":"R3otxAEC9f"},{"type":"text","value":"4.5.3","key":"Wr5JqczemO"}],"template":"Example %s","enumerator":"4.5.3","resolved":true,"html_id":"demo-newtonsys-converge","remote":true,"url":"/newtonsys","dataUrl":"/newtonsys.json","key":"CkR9ovZFmw"}],"key":"lSG8dpCcj6"},{"type":"paragraph","position":{"start":{"line":623,"column":1},"end":{"line":623,"column":1}},"children":[{"type":"text","value":"A system of nonlinear equations is defined by its residual and Jacobian.","position":{"start":{"line":623,"column":1},"end":{"line":623,"column":1}},"key":"fv4MBJKp5H"}],"key":"pXxzd8KWnY"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"Qxt7MaA4hZ"}],"key":"vy9FuOf6HC"},{"type":"paragraph","position":{"start":{"line":626,"column":1},"end":{"line":626,"column":1}},"children":[{"type":"text","value":"This function needs to be defined within a script file or in a file of its own with the ","position":{"start":{"line":626,"column":1},"end":{"line":626,"column":1}},"key":"Nj5Qd47qE8"},{"type":"inlineCode","value":".m","position":{"start":{"line":626,"column":1},"end":{"line":626,"column":1}},"key":"dGKfUvLC8Y"},{"type":"text","value":" extension.","position":{"start":{"line":626,"column":1},"end":{"line":626,"column":1}},"key":"SgmCCZH87Z"}],"key":"WTq1AIKy0K"}],"class":"dropdown","key":"ekCs74fVdG"},{"type":"include","file":"f45_nlsystem.m","literal":true,"children":[{"type":"code","value":"function [f, J] = nlsystem(x)\n    f = zeros(3, 1);   % ensure a column vector output\n    f(1) = exp(x(2) - x(1)) - 2;\n    f(2) = x(1) * x(2) + x(3);\n    f(3) = x(2) * x(3) + x(1)^2 - x(2);\n    J(1, :) = [-exp(x(2) - x(1)), exp(x(2) - x(1)), 0];\n    J(2, :) = [x(2), x(1), 1];\n    J(3, :) = [2 * x(1), x(3)-1, x(2)];\nend","lang":"matlab","filename":"f45_nlsystem.m","key":"ixjfSruyba"}],"key":"Cv2D8QbCHN"},{"type":"paragraph","position":{"start":{"line":633,"column":1},"end":{"line":633,"column":1}},"children":[{"type":"text","value":"Since our system function is defined in an external file here, we need to use ","position":{"start":{"line":633,"column":1},"end":{"line":633,"column":1}},"key":"ciOgP25bu2"},{"type":"inlineCode","value":"@","position":{"start":{"line":633,"column":1},"end":{"line":633,"column":1}},"key":"h70lO4fjOS"},{"type":"text","value":" in order to reference it as a function argument.","position":{"start":{"line":633,"column":1},"end":{"line":633,"column":1}},"key":"utTHBAHWLw"}],"key":"wlz6SeqXS5"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"nlsystem = @f45_nlsystem;\nx1 = [0; 0; 0];    % column vector!\nx = newtonsys(nlsystem, x1);\nnum_iter = size(x, 2)","key":"cYpHsSXTSe"},{"type":"output","id":"2vESFifjjQuG2HhKDbEN7","data":[{"output_type":"execute_result","execution_count":57,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>num_iter = \n     7\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"num_iter = \n     7\n","content_type":"text/plain"}}}],"key":"fHBnNRbmUZ"}],"key":"iBPQ5xgBOz"},{"type":"paragraph","position":{"start":{"line":642,"column":1},"end":{"line":642,"column":1}},"children":[{"type":"text","value":"Let’s compute the residual of the last result in order to check the quality.","position":{"start":{"line":642,"column":1},"end":{"line":642,"column":1}},"key":"XSIyZrVVDf"}],"key":"sT4KOhYtLN"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"r = x(:, end)\nback_err = norm(nlsystem(r))","key":"IMVaZX7koI"},{"type":"output","id":"-PgUmSMik8M9kk0dJ9t7A","data":[{"output_type":"execute_result","execution_count":58,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>r = 3×1 double\n  -4.5803e-01\n   2.3511e-01\n   1.0769e-01\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"r = 3×1 double\n  -4.5803e-01\n   2.3511e-01\n   1.0769e-01\n","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":58,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>back_err = \n   1.3878e-17\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"back_err = \n   1.3878e-17\n","content_type":"text/plain"}}}],"key":"YQEp7zyC4y"}],"key":"hOYolOeqzJ"},{"type":"paragraph","position":{"start":{"line":649,"column":1},"end":{"line":649,"column":1}},"children":[{"type":"text","value":"We take the sequence errors in the first component of the solution, applying the log so that we can look at the exponents.","position":{"start":{"line":649,"column":1},"end":{"line":649,"column":1}},"key":"G1jogt3ptb"}],"key":"MOOPyJbdVK"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"log10( abs(x(1, 1:end-1) - r(1)) )'","key":"mh7SYXRvLi"},{"type":"output","id":"5BJpSCrXraoKhDiFze2bk","data":[{"output_type":"execute_result","execution_count":59,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = 6×1 double\n  -3.3910e-01\n  -2.6603e-01\n  -9.1882e-01\n  -2.2920e+00\n  -5.1929e+00\n  -9.9685e+00\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = 6×1 double\n  -3.3910e-01\n  -2.6603e-01\n  -9.1882e-01\n  -2.2920e+00\n  -5.1929e+00\n  -9.9685e+00\n","content_type":"text/plain"}}}],"key":"xvtCEgFxbR"}],"key":"MK3nARMW0W"},{"type":"paragraph","position":{"start":{"line":655,"column":1},"end":{"line":655,"column":1}},"children":[{"type":"text","value":"This sequence looks to be nearly doubling at each iteration, which is a good sign of quadratic convergence.","position":{"start":{"line":655,"column":1},"end":{"line":655,"column":1}},"key":"p1iL3AHEgs"}],"key":"oYCXRRrKe3"}],"label":"demo-newtonsys-converge-matlab","identifier":"demo-newtonsys-converge-matlab","html_id":"demo-newtonsys-converge-matlab","key":"M7j0PO3ts1"},{"type":"heading","depth":3,"position":{"start":{"line":658,"column":1},"end":{"line":658,"column":1}},"children":[{"type":"text","value":"4.6 ","position":{"start":{"line":658,"column":1},"end":{"line":658,"column":1}},"key":"w9SkuUBAt4"},{"type":"link","identifier":"section-nonlineqn-quasinewton","label":"section-nonlineqn-quasinewton","kind":"narrative","position":{"start":{"line":658,"column":5},"end":{"line":658,"column":35}},"url":"/quasinewton","internal":true,"dataUrl":"/quasinewton.json","children":[{"type":"text","value":"Quasi-Newton methods","key":"mJ4ryXGl7b"}],"key":"WfdByG2JL1"}],"identifier":"id-4-6","label":"4.6 ","html_id":"id-4-6","implicit":true,"key":"atAo9wjkdA"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-quasi-levenberg","label":"demo-quasi-levenberg","kind":"proof:example","position":{"start":{"line":660,"column":1},"end":{"line":660,"column":22}},"children":[{"type":"text","value":"Example ","key":"lh9MkT01vy"},{"type":"text","value":"4.6.1","key":"Bd9b4a5NkY"}],"template":"Example %s","enumerator":"4.6.1","resolved":true,"html_id":"demo-quasi-levenberg","remote":true,"url":"/quasinewton","dataUrl":"/quasinewton.json","key":"sLYYxoFu9D"}],"key":"Eeaz8FjvTr"},{"type":"paragraph","position":{"start":{"line":663,"column":1},"end":{"line":663,"column":1}},"children":[{"type":"text","value":"To solve a nonlinear system, we need to code only the function defining the system, and not its Jacobian.","position":{"start":{"line":663,"column":1},"end":{"line":663,"column":1}},"key":"itrSl8LvLb"}],"key":"JpsQFoT7rM"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"hvDAN1aslt"}],"key":"W5LxEvx5mE"},{"type":"paragraph","position":{"start":{"line":666,"column":1},"end":{"line":666,"column":1}},"children":[{"type":"text","value":"A rule of thumb is that if you use a function as an input argument for another function, there needs to be an ","position":{"start":{"line":666,"column":1},"end":{"line":666,"column":1}},"key":"rrJXIfSsHX"},{"type":"inlineCode","value":"@","position":{"start":{"line":666,"column":1},"end":{"line":666,"column":1}},"key":"MDLja0tvdX"},{"type":"text","value":" involved once: either for an anonymous definition or to reference a function defined elsewhere.","position":{"start":{"line":666,"column":1},"end":{"line":666,"column":1}},"key":"uXW9NtC9T3"}],"key":"QAR9t5OJAh"},{"type":"include","file":"f45_nlsystem.m","literal":true,"children":[{"type":"code","value":"function [f, J] = nlsystem(x)\n    f = zeros(3, 1);   % ensure a column vector output\n    f(1) = exp(x(2) - x(1)) - 2;\n    f(2) = x(1) * x(2) + x(3);\n    f(3) = x(2) * x(3) + x(1)^2 - x(2);\n    J(1, :) = [-exp(x(2) - x(1)), exp(x(2) - x(1)), 0];\n    J(2, :) = [x(2), x(1), 1];\n    J(3, :) = [2 * x(1), x(3)-1, x(2)];\nend","lang":"matlab","filename":"f45_nlsystem.m","key":"Lidtzb6IC1"}],"key":"Rwa3wvx1V0"}],"class":"dropdown","key":"jYLTzYLq9Q"},{"type":"paragraph","position":{"start":{"line":670,"column":1},"end":{"line":670,"column":1}},"children":[{"type":"text","value":"In all other respects usage is the same as for the ","position":{"start":{"line":670,"column":1},"end":{"line":670,"column":1}},"key":"O7dME8sqwg"},{"type":"inlineCode","value":"newtonsys","position":{"start":{"line":670,"column":1},"end":{"line":670,"column":1}},"key":"x1xvc1L6yS"},{"type":"text","value":" function.","position":{"start":{"line":670,"column":1},"end":{"line":670,"column":1}},"key":"tcBi1xq0k2"}],"key":"R57kXO0IF4"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"f = @f46_nlsystem;\nx1 = [0; 0; 0];   \nx = levenberg(f, x1);","key":"qjOz7SG8l0"},{"type":"output","id":"5EWnlwrsLXaQSj-GKdndy","data":[],"key":"zUZDvddUM9"}],"key":"NqQpS5oSKO"},{"type":"paragraph","position":{"start":{"line":676,"column":1},"end":{"line":676,"column":1}},"children":[{"type":"text","value":"It’s always a good idea to check the accuracy of the root, by measuring the residual (backward error).","position":{"start":{"line":676,"column":1},"end":{"line":676,"column":1}},"key":"FVUOBx2eHW"}],"key":"nCzZLt6Z0C"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"r = x(:, end)\nbackward_err = norm(f(r))","key":"wCS3LK1IVC"},{"type":"output","id":"6ct-eiaxTIah5w48r3qKp","data":[{"output_type":"execute_result","execution_count":61,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>r = 3×1 double\n  -4.5803e-01\n   2.3511e-01\n   1.0769e-01\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"r = 3×1 double\n  -4.5803e-01\n   2.3511e-01\n   1.0769e-01\n","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":61,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>backward_err = \n   1.2708e-13\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"backward_err = \n   1.2708e-13\n","content_type":"text/plain"}}}],"key":"aXqy2Y8ISl"}],"key":"HNfenUDWRC"},{"type":"paragraph","position":{"start":{"line":681,"column":1},"end":{"line":681,"column":1}},"children":[{"type":"text","value":"Looking at the convergence of the first component, we find a rate between linear and quadratic, like with the secant method.","position":{"start":{"line":681,"column":1},"end":{"line":681,"column":1}},"key":"Yz09XNDiIL"}],"key":"S5oszOfQsw"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"log10( abs(x(1, 1:end-1) - r(1)) )'","key":"xfnw4fCd0T"},{"type":"output","id":"3IgzWvGMkoWnwIKUzDEq1","data":[{"output_type":"stream","name":"stderr","text":"Failed to execute. Operation may have interrupted by user."}],"key":"CqTXGWnSkw"}],"key":"dC0fQXRS78"}],"label":"demo-quasi-levenberg-matlab","identifier":"demo-quasi-levenberg-matlab","html_id":"demo-quasi-levenberg-matlab","key":"cElS530naH"},{"type":"heading","depth":3,"position":{"start":{"line":686,"column":1},"end":{"line":686,"column":1}},"children":[{"type":"text","value":"4.7 ","position":{"start":{"line":686,"column":1},"end":{"line":686,"column":1}},"key":"mwsAgJOlCg"},{"type":"link","identifier":"section-nonlineqn-nlsq","label":"section-nonlineqn-nlsq","kind":"narrative","position":{"start":{"line":686,"column":5},"end":{"line":686,"column":28}},"url":"/nlsq","internal":true,"dataUrl":"/nlsq.json","children":[{"type":"text","value":"Nonlinear least squares","key":"FqgxOWt2fC"}],"key":"LI0iJT3NdE"}],"identifier":"id-4-7","label":"4.7 ","html_id":"id-4-7","implicit":true,"key":"kM3PRmCqAz"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-nlsq-converge","label":"demo-nlsq-converge","kind":"proof:example","position":{"start":{"line":688,"column":1},"end":{"line":688,"column":20}},"children":[{"type":"text","value":"Example ","key":"aqpuPQtyEV"},{"type":"text","value":"4.7.1","key":"xCE8txYEQn"}],"template":"Example %s","enumerator":"4.7.1","resolved":true,"html_id":"demo-nlsq-converge","remote":true,"url":"/nlsq","dataUrl":"/nlsq.json","key":"Z9EQvTno7u"}],"key":"mQLmIOXgnC"},{"type":"paragraph","position":{"start":{"line":690,"column":1},"end":{"line":690,"column":1}},"children":[{"type":"text","value":"We will observe the convergence of ","position":{"start":{"line":690,"column":1},"end":{"line":690,"column":1}},"key":"cSGlVuBCJq"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-levenberg","label":"function-levenberg","children":[{"type":"text","value":"Function ","key":"TySaP7veCX"},{"type":"text","value":"4.6.3","key":"Jrdyf2eynn"}],"template":"Algorithm %s","enumerator":"4.6.3","resolved":true,"html_id":"function-levenberg","remote":true,"url":"/quasinewton","dataUrl":"/quasinewton.json","key":"widYMkjvH3"},{"type":"text","value":" for different levels of the minimum least-squares residual. We start with a function mapping from ","position":{"start":{"line":690,"column":1},"end":{"line":690,"column":1}},"key":"fyt6RGnCwN"},{"type":"inlineMath","value":"\\real^2","position":{"start":{"line":690,"column":1},"end":{"line":690,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi mathvariant=\"double-struck\">R</mi><mn>2</mn></msup></mrow><annotation encoding=\"application/x-tex\">\\real^2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathbb\">R</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span>","key":"HIjUzkoDZQ"},{"type":"text","value":" into ","position":{"start":{"line":690,"column":1},"end":{"line":690,"column":1}},"key":"GxJqDrh92s"},{"type":"inlineMath","value":"\\real^3","position":{"start":{"line":690,"column":1},"end":{"line":690,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi mathvariant=\"double-struck\">R</mi><mn>3</mn></msup></mrow><annotation encoding=\"application/x-tex\">\\real^3</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathbb\">R</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span></span></span></span></span></span></span></span>","key":"TuqEt0mZ08"},{"type":"text","value":", and a point that will be near the optimum.","position":{"start":{"line":690,"column":1},"end":{"line":690,"column":1}},"key":"G7jXEgnl7A"}],"key":"T06dTdiZgQ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"g = @(x) [sin(x(1) + x(2)); cos(x(1) - x(2)); exp(x(1) - x(2))];\np = [1; 1];","key":"NWUlmteKrA"},{"type":"output","id":"YacUoNH-pz381qbXx0W5E","data":[],"key":"l4Knecjtrh"}],"key":"xQC2SLZ1m4"},{"type":"paragraph","position":{"start":{"line":698,"column":1},"end":{"line":698,"column":1}},"children":[{"type":"text","value":"The function ","position":{"start":{"line":698,"column":1},"end":{"line":698,"column":1}},"key":"Sfeoioa5gy"},{"type":"inlineMath","value":"\\mathbf{g}(\\mathbf{x}) - \\mathbf{g}(\\mathbf{p})","position":{"start":{"line":698,"column":1},"end":{"line":698,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">g</mi><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">x</mi><mo stretchy=\"false\">)</mo><mo>−</mo><mi mathvariant=\"bold\">g</mi><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">p</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\mathbf{g}(\\mathbf{x}) - \\mathbf{g}(\\mathbf{p})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">g</span><span class=\"mopen\">(</span><span class=\"mord mathbf\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">g</span><span class=\"mopen\">(</span><span class=\"mord mathbf\">p</span><span class=\"mclose\">)</span></span></span></span>","key":"uC6Ca3aAZz"},{"type":"text","value":" obviously has a zero residual at ","position":{"start":{"line":698,"column":1},"end":{"line":698,"column":1}},"key":"yvfZpWN5W8"},{"type":"inlineMath","value":"\\mathbf{p}","position":{"start":{"line":698,"column":1},"end":{"line":698,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">p</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{p}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6389em;vertical-align:-0.1944em;\"></span><span class=\"mord mathbf\">p</span></span></span></span>","key":"FUx7TzWspy"},{"type":"text","value":". We’ll make different perturbations of that function in order to create nonzero residuals.","position":{"start":{"line":698,"column":1},"end":{"line":698,"column":1}},"key":"o0gVBUY8un"}],"indexEntries":[{"entry":"Julia","subEntry":{"value":"@sprintf","kind":"entry"},"emphasis":true}],"label":"index-UWzWhn5Gpv","identifier":"index-uwzwhn5gpv","html_id":"index-uwzwhn5gpv","key":"VXiR0EZPu4"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"C4Xhd1Bw5X"}],"key":"cciFVu4R53"},{"type":"paragraph","position":{"start":{"line":702,"column":1},"end":{"line":702,"column":1}},"children":[{"type":"inlineCode","value":"@sprintf","position":{"start":{"line":702,"column":1},"end":{"line":702,"column":1}},"key":"h2q57TXSqX"},{"type":"text","value":" is a way to format numerical values as strings, patterned after the C function ","position":{"start":{"line":702,"column":1},"end":{"line":702,"column":1}},"key":"kXKNgQCDYA"},{"type":"inlineCode","value":"printf","position":{"start":{"line":702,"column":1},"end":{"line":702,"column":1}},"key":"GtKXRiYygw"},{"type":"text","value":".","position":{"start":{"line":702,"column":1},"end":{"line":702,"column":1}},"key":"yW3NjCegds"}],"key":"AgZq8r3xhB"}],"class":"dropdown","key":"vPpA9KgkJJ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf\nlabels = [];\nfor R = [1e-3, 1e-2, 1e-1]\n    % Define the perturbed function.\n    f = @(x) g(x) - g(p) + R * [-1; 1; -1] / sqrt(3)\n    x = levenberg(f, [0; 0]);\n    r = x(:, end);\n    err = abs(x(1, 1:end-1) - r(1));\n    normres = norm(f(r));\n    semilogy(err), hold on\n    labels = [labels; sprintf(\"R=%.2g\", normres)];\nend\nxlabel(\"iteration\"), ylabel(\"error\")\nlegend(labels);","key":"poxDX0pI62"},{"type":"output","id":"7996s0_KjUjT4CBf8XMpo","data":[{"output_type":"execute_result","execution_count":64,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"64eeee8a90109e0c1af2926f5ed51b5f","path":"/build/64eeee8a90109e0c1af2926f5ed51b5f.png"}}},{"output_type":"execute_result","execution_count":64,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>f = function_handle with value:\n    @(x)g(x)-g(p)+R*[-1;1;-1]/sqrt(3)\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"f = function_handle with value:\n    @(x)g(x)-g(p)+R*[-1;1;-1]/sqrt(3)\n","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":64,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>f = function_handle with value:\n    @(x)g(x)-g(p)+R*[-1;1;-1]/sqrt(3)\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"f = function_handle with value:\n    @(x)g(x)-g(p)+R*[-1;1;-1]/sqrt(3)\n","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":64,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>f = function_handle with value:\n    @(x)g(x)-g(p)+R*[-1;1;-1]/sqrt(3)\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"f = function_handle with value:\n    @(x)g(x)-g(p)+R*[-1;1;-1]/sqrt(3)\n","content_type":"text/plain"}}}],"key":"KvTqD49fJ0"}],"key":"ApsFFkn03r"},{"type":"paragraph","position":{"start":{"line":722,"column":1},"end":{"line":722,"column":1}},"children":[{"type":"text","value":"In the least perturbed case, where the minimized residual is less than ","position":{"start":{"line":722,"column":1},"end":{"line":722,"column":1}},"key":"YNcNhHA8Zi"},{"type":"span","position":{"start":{"line":722,"column":1},"end":{"line":722,"column":1}},"children":[{"type":"text","value":"10","key":"wALGejX18c"},{"type":"superscript","children":[{"type":"text","value":"-3","key":"MdFWwya9J1"}],"key":"c4kZfS8V70"}],"key":"wntALkI3VA"},{"type":"text","value":", the convergence is plausibly quadratic. At the next level up, the convergence starts similarly but suddenly stagnates for a long time. In the most perturbed case, the quadratic phase is nearly gone and the overall shape looks linear.","position":{"start":{"line":722,"column":1},"end":{"line":722,"column":1}},"key":"LWtRXSpUU5"}],"key":"zcVb1N3vhl"}],"label":"demo-nlsq-converge-matlab","identifier":"demo-nlsq-converge-matlab","html_id":"demo-nlsq-converge-matlab","key":"YPfFd9ws4F"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-nlsq-mm","label":"demo-nlsq-MM","kind":"proof:example","position":{"start":{"line":726,"column":1},"end":{"line":726,"column":14}},"children":[{"type":"text","value":"Example ","key":"Sf4ybDxNDX"},{"type":"text","value":"4.7.2","key":"FvmMIg7qzs"}],"template":"Example %s","enumerator":"4.7.2","resolved":true,"html_id":"demo-nlsq-mm","remote":true,"url":"/nlsq","dataUrl":"/nlsq.json","key":"TAL6vAKf6Q"}],"key":"CXYya4NMXe"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"m = 25; V = 2; Km = 0.5;\ns = linspace(0.05, 6, m)';\nw = V * s ./ (Km + s);                      % exactly on the curve\nw = w + 0.15 * cos(2 * exp(s / 16) .* s);   % noise added\nclf, fplot(@(s) V * s ./ (Km + s), [0, 6], '--')\nhold on, scatter(s, w)\nxlabel('concentration'), ylabel('reaction rate')    \nlabels = [\"ideal\", \"noisy data\"];    \nlegend(labels, 'location', 'east');","key":"vlLvfGayv2"},{"type":"output","id":"4xD7PawyI9DpACMRyW_t0","data":[{"output_type":"execute_result","execution_count":65,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"df2ee0304be7aacdc3a3c1349e6f9505","path":"/build/df2ee0304be7aacdc3a3c1349e6f9505.png"}}}],"key":"PG4v2AwK2R"}],"key":"gANzIJa9nV"},{"type":"paragraph","position":{"start":{"line":740,"column":1},"end":{"line":740,"column":1}},"children":[{"type":"text","value":"The idea is to pretend that we know nothing of the origins of this data and use nonlinear least squares to find the parameters in the theoretical model function ","position":{"start":{"line":740,"column":1},"end":{"line":740,"column":1}},"key":"G7s4lWERiG"},{"type":"inlineMath","value":"v(s)","position":{"start":{"line":740,"column":1},"end":{"line":740,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>v</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">v(s)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">s</span><span class=\"mclose\">)</span></span></span></span>","key":"eW4W8v5XyJ"},{"type":"text","value":". In ","position":{"start":{"line":740,"column":1},"end":{"line":740,"column":1}},"key":"wDUTZeXOuk"},{"type":"crossReference","kind":"equation","identifier":"nlsq-misfit","label":"nlsq-misfit","children":[{"type":"text","value":"(","key":"EvvU6ZbRra"},{"type":"text","value":"4.7.2","key":"kvQwfgGjmR"},{"type":"text","value":")","key":"qEEko48VFu"}],"template":"(%s)","enumerator":"4.7.2","resolved":true,"html_id":"nlsq-misfit","remote":true,"url":"/nlsq","dataUrl":"/nlsq.json","key":"AOZapzHRtB"},{"type":"text","value":", the ","position":{"start":{"line":740,"column":1},"end":{"line":740,"column":1}},"key":"TR7whHmPGC"},{"type":"inlineMath","value":"s","position":{"start":{"line":740,"column":1},"end":{"line":740,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>s</mi></mrow><annotation encoding=\"application/x-tex\">s</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">s</span></span></span></span>","key":"o3pucEqbAA"},{"type":"text","value":" variable plays the role of ","position":{"start":{"line":740,"column":1},"end":{"line":740,"column":1}},"key":"vvv7DESjYK"},{"type":"inlineMath","value":"t","position":{"start":{"line":740,"column":1},"end":{"line":740,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span></span></span></span>","key":"cZAYNuvAj4"},{"type":"text","value":", and ","position":{"start":{"line":740,"column":1},"end":{"line":740,"column":1}},"key":"bWzZb5Y0Ux"},{"type":"inlineMath","value":"v","position":{"start":{"line":740,"column":1},"end":{"line":740,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>v</mi></mrow><annotation encoding=\"application/x-tex\">v</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span></span></span></span>","key":"Dx4hka4Oq5"},{"type":"text","value":" plays the role of ","position":{"start":{"line":740,"column":1},"end":{"line":740,"column":1}},"key":"RbfBRXCl5B"},{"type":"inlineMath","value":"g","position":{"start":{"line":740,"column":1},"end":{"line":740,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>g</mi></mrow><annotation encoding=\"application/x-tex\">g</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span></span></span></span>","key":"lJeH9FMX9r"},{"type":"text","value":". In the Jacobian, the derivatives are with respect to the parameters in ","position":{"start":{"line":740,"column":1},"end":{"line":740,"column":1}},"key":"p0m5AASXus"},{"type":"inlineMath","value":"\\mathbf{x}","position":{"start":{"line":740,"column":1},"end":{"line":740,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">x</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{x}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4444em;\"></span><span class=\"mord mathbf\">x</span></span></span></span>","key":"U9Fd96mV8m"},{"type":"text","value":".","position":{"start":{"line":740,"column":1},"end":{"line":740,"column":1}},"key":"E9jWl8Zy1u"}],"key":"v4uzTcdlRU"},{"type":"include","file":"f47_misfit.m","literal":true,"children":[{"type":"code","value":"function [f, J] = misfit(c, s, w)\n    V = c(1);   Km = c(2);\n    f = V * s ./ (Km + s) - w;\n    J(:,1) = s ./ (Km + s);            % d/d(V)\n    J(:,2) = -V * s ./ (Km + s).^2;    % d/d(Km)\nend\n","lang":"matlab","filename":"f47_misfit.m","key":"Mp0Qt7YZPt"}],"key":"YEylAJtjcS"},{"type":"paragraph","position":{"start":{"line":746,"column":1},"end":{"line":746,"column":1}},"children":[{"type":"text","value":"The misfit function above has to know the parameters ","position":{"start":{"line":746,"column":1},"end":{"line":746,"column":1}},"key":"gNIA52mvOb"},{"type":"inlineCode","value":"x","position":{"start":{"line":746,"column":1},"end":{"line":746,"column":1}},"key":"zYIkBuwvRA"},{"type":"text","value":" that are being optimized as well as the data ","position":{"start":{"line":746,"column":1},"end":{"line":746,"column":1}},"key":"lcVXTfloTF"},{"type":"inlineCode","value":"s","position":{"start":{"line":746,"column":1},"end":{"line":746,"column":1}},"key":"BlktJpAMxB"},{"type":"text","value":" and ","position":{"start":{"line":746,"column":1},"end":{"line":746,"column":1}},"key":"LeW72hYrFc"},{"type":"inlineCode","value":"w","position":{"start":{"line":746,"column":1},"end":{"line":746,"column":1}},"key":"XrUDqoLoWk"},{"type":"text","value":" that remain fixed. We use a closure to pass the data values along.","position":{"start":{"line":746,"column":1},"end":{"line":746,"column":1}},"key":"OpHDtg6H65"}],"key":"Xw3X0FRtD1"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"f = @(x) f47_misfit(x, s, w);","key":"b1OnmonV2Q"},{"type":"output","id":"k4JSPr-g-S7qxeQojkHZl","data":[],"key":"VxhxPYG5qT"}],"key":"y5s0qeldBN"},{"type":"paragraph","position":{"start":{"line":752,"column":1},"end":{"line":752,"column":1}},"children":[{"type":"text","value":"Now we have a function that accepts a single 2-vector input and returns a 25-vector output. We can pass this function to ","position":{"start":{"line":752,"column":1},"end":{"line":752,"column":1}},"key":"xbsXrxHUPi"},{"type":"inlineCode","value":"levenberg","position":{"start":{"line":752,"column":1},"end":{"line":752,"column":1}},"key":"xLc3ikRvQw"},{"type":"text","value":" to find the best-fit parameters.","position":{"start":{"line":752,"column":1},"end":{"line":752,"column":1}},"key":"zg6eINIaVp"}],"key":"y0K4OKqcaD"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"x1 = [1; 0.75];\nx = newtonsys(f, x1);\nV = x(1, end),  Km = x(2, end)     % final values\nmodel = @(s) V * s ./ (Km + s);    % best-fit model","key":"hbs6Zho5AM"},{"type":"output","id":"DejjOPGQ6MvZBjyK3KZEw","data":[{"output_type":"execute_result","execution_count":67,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>V = \n   1.9687e+00\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"V = \n   1.9687e+00\n","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":67,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>Km = \n   4.6930e-01\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"Km = \n   4.6930e-01\n","content_type":"text/plain"}}}],"key":"vEYCTipPNt"}],"key":"olCxTOnc2W"},{"type":"paragraph","position":{"start":{"line":761,"column":1},"end":{"line":761,"column":1}},"children":[{"type":"text","value":"The final values are reasonably close to the values ","position":{"start":{"line":761,"column":1},"end":{"line":761,"column":1}},"key":"DS8w90PE24"},{"type":"inlineMath","value":"V=2","position":{"start":{"line":761,"column":1},"end":{"line":761,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>V</mi><mo>=</mo><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">V=2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span></span></span></span>","key":"EzPQ7oEgvW"},{"type":"text","value":", ","position":{"start":{"line":761,"column":1},"end":{"line":761,"column":1}},"key":"AF5bMGOhCU"},{"type":"inlineMath","value":"K_m=0.5","position":{"start":{"line":761,"column":1},"end":{"line":761,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>K</mi><mi>m</mi></msub><mo>=</mo><mn>0.5</mn></mrow><annotation encoding=\"application/x-tex\">K_m=0.5</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0.5</span></span></span></span>","key":"Ur67XhzOY1"},{"type":"text","value":" that we used to generate the noise-free data. Graphically, the model looks close to the original data:","position":{"start":{"line":761,"column":1},"end":{"line":761,"column":1}},"key":"gaGwjLzI4r"}],"key":"uZIU9vMHa2"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"final_misfit_norm = norm(model(s) - w) \nhold on, fplot(model, [0, 6])\ntitle('Michaelis-Menten fitting')    \nlabels = [labels, \"nonlinear fit\"];    \nlegend(labels, 'location', 'east');","key":"scjTOIapdF"},{"type":"output","id":"t7MGemS341aLYZIxwMoS4","data":[{"output_type":"execute_result","execution_count":68,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>final_misfit_norm = \n   5.2340e-01\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"final_misfit_norm = \n   5.2340e-01\n","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":68,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"ed58fec075ceff8c7084e8e330eb408f","path":"/build/ed58fec075ceff8c7084e8e330eb408f.png"}}}],"key":"k922Ur7N0B"}],"key":"yV3Zj3iNuH"},{"type":"paragraph","position":{"start":{"line":771,"column":1},"end":{"line":771,"column":1}},"children":[{"type":"text","value":"For this particular model, we also have the option of linearizing the fit process. Rewrite the model as","position":{"start":{"line":771,"column":1},"end":{"line":771,"column":1}},"key":"pIEOoyG2LW"}],"key":"rqxqE0SQk8"},{"type":"math","value":"\\frac{1}{w} = \\frac{\\alpha}{s} + \\beta = \\alpha \\cdot s^{-1} + \\beta","enumerated":false,"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mfrac><mn>1</mn><mi>w</mi></mfrac><mo>=</mo><mfrac><mi>α</mi><mi>s</mi></mfrac><mo>+</mo><mi>β</mi><mo>=</mo><mi>α</mi><mo>⋅</mo><msup><mi>s</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo>+</mo><mi>β</mi></mrow><annotation encoding=\"application/x-tex\">\\frac{1}{w} = \\frac{\\alpha}{s} + \\beta = \\alpha \\cdot s^{-1} + \\beta</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.0074em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.7936em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.1076em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">s</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05278em;\">β</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4445em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.9474em;vertical-align:-0.0833em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05278em;\">β</span></span></span></span></span>","key":"HEmaF0GxGw"},{"type":"paragraph","position":{"start":{"line":778,"column":1},"end":{"line":778,"column":1}},"children":[{"type":"text","value":"for the new fitting parameters ","position":{"start":{"line":778,"column":1},"end":{"line":778,"column":1}},"key":"r7ZHaONInc"},{"type":"inlineMath","value":"\\alpha=K_m/V","position":{"start":{"line":778,"column":1},"end":{"line":778,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>α</mi><mo>=</mo><msub><mi>K</mi><mi>m</mi></msub><mi mathvariant=\"normal\">/</mi><mi>V</mi></mrow><annotation encoding=\"application/x-tex\">\\alpha=K_m/V</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">/</span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span></span></span></span>","key":"Grubd3LyxN"},{"type":"text","value":" and ","position":{"start":{"line":778,"column":1},"end":{"line":778,"column":1}},"key":"QqOsTdReez"},{"type":"inlineMath","value":"\\beta=1/V","position":{"start":{"line":778,"column":1},"end":{"line":778,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>β</mi><mo>=</mo><mn>1</mn><mi mathvariant=\"normal\">/</mi><mi>V</mi></mrow><annotation encoding=\"application/x-tex\">\\beta=1/V</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05278em;\">β</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1/</span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span></span></span></span>","key":"K9Ih2mFKhQ"},{"type":"text","value":". This corresponds to the misfit function whose entries are","position":{"start":{"line":778,"column":1},"end":{"line":778,"column":1}},"key":"FOCjzfgkRz"}],"key":"bMhniDNnC5"},{"type":"math","value":"f_i([\\alpha,\\beta]) = \\left(\\alpha \\cdot \\frac{1}{s_i} + \\beta\\right) - \\frac{1}{w_i}","position":{"start":{"line":780,"column":1},"end":{"line":780,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>f</mi><mi>i</mi></msub><mo stretchy=\"false\">(</mo><mo stretchy=\"false\">[</mo><mi>α</mi><mo separator=\"true\">,</mo><mi>β</mi><mo stretchy=\"false\">]</mo><mo stretchy=\"false\">)</mo><mo>=</mo><mrow><mo fence=\"true\">(</mo><mi>α</mi><mo>⋅</mo><mfrac><mn>1</mn><msub><mi>s</mi><mi>i</mi></msub></mfrac><mo>+</mo><mi>β</mi><mo fence=\"true\">)</mo></mrow><mo>−</mo><mfrac><mn>1</mn><msub><mi>w</mi><mi>i</mi></msub></mfrac></mrow><annotation encoding=\"application/x-tex\">f_i([\\alpha,\\beta]) = \\left(\\alpha \\cdot \\frac{1}{s_i} + \\beta\\right) - \\frac{1}{w_i}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">([</span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05278em;\">β</span><span class=\"mclose\">])</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.4em;vertical-align:-0.95em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">(</span></span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05278em;\">β</span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">)</span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.1574em;vertical-align:-0.836em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span>","enumerator":"1","key":"W3qxW1eZo8"},{"type":"paragraph","position":{"start":{"line":782,"column":1},"end":{"line":782,"column":1}},"children":[{"type":"text","value":"for ","position":{"start":{"line":782,"column":1},"end":{"line":782,"column":1}},"key":"cnJ8f6YAEf"},{"type":"inlineMath","value":"i=1,\\ldots,m","position":{"start":{"line":782,"column":1},"end":{"line":782,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi><mo>=</mo><mn>1</mn><mo separator=\"true\">,</mo><mo>…</mo><mo separator=\"true\">,</mo><mi>m</mi></mrow><annotation encoding=\"application/x-tex\">i=1,\\ldots,m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8389em;vertical-align:-0.1944em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">m</span></span></span></span>","key":"MMkyesr029"},{"type":"text","value":". Although this misfit is nonlinear in ","position":{"start":{"line":782,"column":1},"end":{"line":782,"column":1}},"key":"T7OhjL3kKx"},{"type":"inlineMath","value":"s","position":{"start":{"line":782,"column":1},"end":{"line":782,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>s</mi></mrow><annotation encoding=\"application/x-tex\">s</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">s</span></span></span></span>","key":"rNLgcXM9o6"},{"type":"text","value":" and ","position":{"start":{"line":782,"column":1},"end":{"line":782,"column":1}},"key":"EUx8bv7SpN"},{"type":"inlineMath","value":"w","position":{"start":{"line":782,"column":1},"end":{"line":782,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>w</mi></mrow><annotation encoding=\"application/x-tex\">w</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span></span></span></span>","key":"OWsODir8GV"},{"type":"text","value":", it’s linear in the unknown parameters ","position":{"start":{"line":782,"column":1},"end":{"line":782,"column":1}},"key":"cJPB3vzv0r"},{"type":"text","value":"α","position":{"start":{"line":782,"column":1},"end":{"line":782,"column":1}},"key":"uz5G7WXfKd"},{"type":"text","value":" and ","position":{"start":{"line":782,"column":1},"end":{"line":782,"column":1}},"key":"tuZugYE2sv"},{"type":"text","value":"β","position":{"start":{"line":782,"column":1},"end":{"line":782,"column":1}},"key":"hnGLNx4b91"},{"type":"text","value":". This lets us pose and solve it as a linear least-squares problem.","position":{"start":{"line":782,"column":1},"end":{"line":782,"column":1}},"key":"i393tHtj43"}],"key":"kSkHbWN3LL"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"u = 1 ./ w;\nA = [s.^(-1), s.^0];  \nz = A \\ u;\nalpha = z(1);  beta = z(2);","key":"catBiEODhY"},{"type":"output","id":"BlB25GoCp-us_FVdeVGK6","data":[],"key":"OrP670mdu4"}],"key":"UDots8JcDW"},{"type":"paragraph","position":{"start":{"line":791,"column":1},"end":{"line":791,"column":1}},"children":[{"type":"text","value":"The two fits are different because they do not optimize the same quantities.","position":{"start":{"line":791,"column":1},"end":{"line":791,"column":1}},"key":"Rlj5yWwDqP"}],"key":"BGeAeJxLK6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"linmodel = @(s) 1 ./ (beta + alpha ./ s);\nfinal_misfit_linearized = norm(linmodel(s) - w)\nfplot(linmodel, [0, 6])\nlabels = [labels, \"linearized fit\"];    \nlegend(labels, 'location', 'east');","key":"GKHtw79Bd7"},{"type":"output","id":"Pn9dbvJL28VYmJspA5dUi","data":[{"output_type":"execute_result","execution_count":70,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>final_misfit_linearized = \n   7.4871e-01\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"final_misfit_linearized = \n   7.4871e-01\n","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":70,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"51ac168f5af34d9d1b2e3ee1cec67340","path":"/build/51ac168f5af34d9d1b2e3ee1cec67340.png"}}}],"key":"QXYpEBvmHO"}],"key":"ye5mj9nXlV"},{"type":"paragraph","position":{"start":{"line":801,"column":1},"end":{"line":801,"column":1}},"children":[{"type":"text","value":"The truly nonlinear fit is clearly better in this case. It optimizes a residual for the original measured quantity rather than a transformed one we picked for algorithmic convenience.","position":{"start":{"line":801,"column":1},"end":{"line":801,"column":1}},"key":"wufMk2tmRK"}],"key":"adJdQFrBvs"}],"label":"demo-nlsq-MM-matlab","identifier":"demo-nlsq-mm-matlab","html_id":"demo-nlsq-mm-matlab","key":"Qduyj6hHRb"}],"key":"KO7WdAXWa8"}],"key":"ZGmkggQ04U"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Chapter 3","url":"/chapter3-1","group":"MATLAB codes"},"next":{"title":"Chapter 5","url":"/chapter5-1","group":"MATLAB codes"}}},"domain":"http://localhost:3000"}