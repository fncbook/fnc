{"version":2,"kind":"Notebook","sha256":"8416899e69fa9023b4c84635acc810b825b353fce4676dc32a956e35d6895871","slug":"chapter4-1","location":"/matlab/chapter4.md","dependencies":[],"frontmatter":{"title":"Chapter 4","numbering":{"heading_1":{"enabled":false},"heading_2":{"enabled":false},"heading_3":{"enabled":false},"heading_4":{"enabled":false},"heading_5":{"enabled":false},"heading_6":{"enabled":false},"title":{"offset":2}},"kernelspec":{"name":"jupyter_matlab_kernel","display_name":"MATLAB","language":"matlab"},"content_includes_title":false,"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","TPBVP":"two-point boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"source_url":"https://github.com/fncbook/fnc/blob/master/matlab/chapter4.md","edit_url":"https://github.com/fncbook/fnc/edit/master/matlab/chapter4.md","exports":[{"format":"md","filename":"chapter4.md","url":"/build/chapter4-616db875d3dd8f151c0f8b2ecc88e302.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Functions","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"tKeovjvSmD"}],"identifier":"functions","label":"Functions","html_id":"functions","implicit":true,"key":"AlUVu2AzpV"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Newton’s method","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"M6gIrOcC0S"}],"key":"lBLjMBJgy5"},{"type":"include","file":"FNC-matlab/newton.m","literal":true,"children":[{"type":"code","value":"function x = newton(f, df_dx, x1)\r\n% NEWTON   Newton's method for a scalar equation.\r\n% Input:\r\n%   f        objective function \r\n%   df_dx    derivative function\r\n%   x1       initial root approximation\r\n% Output       \r\n%   x        vector of root approximations (last one is best)\r\n\r\n    % Stopping parameters.\r\n    funtol = 100 * eps;    % stop for small f(x)\r\n    xtol = 100 * eps;      % stop for small x change\r\n    maxiter = 40;          % stop after this many iterations\r\n\r\n    x = x1;  \r\n    y = f(x1);\r\n    dx = Inf;   % for initial pass below\r\n    k = 1;\r\n\r\n    while (abs(dx) > xtol) && (abs(y) > funtol) && (k < maxiter)\r\n        dydx = df_dx(x(k));\r\n        dx = -y / dydx;    % Newton step\r\n        x(k+1) = x(k) + dx;\r\n\r\n        k = k+1;\r\n        y = f(x(k));\r\n    end\r\n\r\n    if k==maxiter\r\n      warning('Maximum number of iterations reached.')\r\n    end\r\nend","lang":"matlab","showLineNumbers":true,"filename":"newton.m","key":"EeIIa0INck"}],"key":"AO8PQZqVpO"}],"label":"function-newton-matlab","identifier":"function-newton-matlab","html_id":"function-newton-matlab","key":"tAsR7BgGB6"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Secant method","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"T6R7R2rxkR"}],"key":"kCvANLdhT1"},{"type":"include","file":"FNC-matlab/secant.m","literal":true,"children":[{"type":"code","value":"function x = secant(f, x1, x2)\r\n% SECANT   Secant method for a scalar equation.\r\n% Input:\r\n%   f        objective function \r\n%   x1, x2   initial root approximations\r\n% Output       \r\n%   x        vector of root approximations (last is best)\r\n\r\n    % Stopping parameters.\r\n    funtol = 100 * eps;    % stop for small f(x)\r\n    xtol = 100 * eps;      % stop for small x change\r\n    maxiter = 40;          % stop after this many iterations\r\n\r\n    x = [x1 x2];\r\n    y1 = f(x1);  y2 = f(x2);\r\n    k = 2;       % iteration counter\r\n    dx = Inf;    % for initial pass below\r\n\r\n    while (abs(dx) > xtol) && (abs(y2) > funtol) && (k < maxiter)\r\n        dx = -y2 * (x(k) - x(k-1)) / (y2 - y1);    % secant step\r\n        x(k+1) = x(k) + dx;\r\n        \r\n        k = k+1;\r\n        y1 = y2;    % current f-value becomes the old one next time\r\n        y2 = f(x(k));\r\n    end\r\n\r\n    if k==maxiter\r\n        warning('Maximum number of iterations reached.')\r\n    end\r\nend\r\n","lang":"matlab","showLineNumbers":true,"filename":"secant.m","key":"xlsgVRo17X"}],"key":"XwquLwEe3P"}],"label":"function-secant-matlab","identifier":"function-secant-matlab","html_id":"function-secant-matlab","key":"irLW2zguYz"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Newton’s method for systems","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"XB3Z9EEdvV"}],"key":"olax1rBvv1"},{"type":"include","file":"FNC-matlab/newtonsys.m","literal":true,"children":[{"type":"code","value":"function x = newtonsys(f,x1)\r\n% NEWTONSYS   Newton's method for a system of equations.\r\n% Input:\r\n%   f        function that computes residual and Jacobian matrix\r\n%   x1       initial root approximation (n-vector)\r\n% Output       \r\n%   x        array of approximations (one per column, last is best)\r\n\r\n    % Stopping parameters.\r\n    funtol = 1000 * eps;    % stop for small || f(x) ||\r\n    xtol = 1000 * eps;      % stop for small || x change ||\r\n    maxiter = 40;           % stop after this many iterations\r\n\r\n    x = x1(:);  \r\n    [y, J] = f(x1);\r\n    dx = Inf;\r\n    k = 1;\r\n\r\n    while (norm(dx) > xtol) && (norm(y) > funtol) && (k < maxiter)\r\n        dx = -(J \\ y);    % Newton step\r\n        x(:, k+1) = x(:, k) + dx;\r\n\r\n        k = k+1;\r\n        [y, J] = f(x(:, k));\r\n    end\r\n\r\n    if k==maxiter\r\n        warning('Maximum number of iterations reached.')\r\n    end\r\nend","lang":"matlab","showLineNumbers":true,"filename":"newtonsys.m","key":"cF3OypyruK"}],"key":"HAt1RshBRH"}],"label":"function-newtonsys-matlab","identifier":"function-newtonsys-matlab","html_id":"function-newtonsys-matlab","key":"oUZUR0ePPs"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Finite differences for Jacobian","position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"key":"fcONis9XSn"}],"key":"UEoTSbGPZm"},{"type":"include","file":"FNC-matlab/fdjac.m","literal":true,"children":[{"type":"code","value":"function J = fdjac(f, x0, y0)\n    % FDJAC   Finite-difference approximation of a Jacobian.\n    % Input:\n    %   f        function to be differentiated\n    %   x0       evaluation point (n-vector)\n    %   y0       value of f at x0 (m-vector)\n    % Output       \n    %   J        approximate Jacobian (m by n)\n\n    delta = sqrt(eps);   % FD step size\n    m = length(y0);\n    n = length(x0);\n    J = zeros(m, n);\n    I = eye(n);\n    for j = 1:n\n        yj = f(x0 + delta*I(:, j));\n        J(:, j) = (yj  - y0) / delta;\n    end\nend","lang":"matlab","showLineNumbers":true,"filename":"fdjac.m","key":"X3p7wmYJBh"}],"key":"nPZeZC8p0Y"}],"label":"function-fdjac-matlab","identifier":"function-fdjac-matlab","html_id":"function-fdjac-matlab","key":"RVzIoIfLg9"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Levenberg’s method","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"key":"mzM3G9OF9K"}],"key":"BRtlhJ6w5o"},{"type":"include","file":"FNC-matlab/levenberg.m","literal":true,"children":[{"type":"code","value":"function x = levenberg(f,x1,tol)\r\n% LEVENBERG   Quasi-Newton method for nonlinear systems.\r\n% Input:\r\n%   f         objective function \r\n%   x1        initial root approximation\r\n%   tol       stopping tolerance (default is 1e-12)\r\n% Output       \r\n%   x         array of approximations (one per column)\r\n\r\n% Operating parameters.\r\n    if nargin < 3, tol = 1e-12; end\r\n    ftol = tol;  xtol = tol;  maxiter = 40;\r\n\r\n    x = x1(:);\r\n    fk = f(x1);\r\n    k = 1;  s = Inf;        \r\n    Ak = fdjac(f,x(:, 1), fk);   % start with FD Jacobian\r\n    jac_is_new = true;\r\n    I = eye(length(x));\r\n\r\n    lambda = 10; \r\n    while (norm(s) > xtol) && (norm(fk) > ftol) && (k < maxiter)\r\n        % Compute the proposed step.\r\n        B = Ak' * Ak + lambda * I;\r\n        z = Ak' * fk;\r\n        s = -(B \\ z);\r\n\r\n        xnew = x(:, k) + s;\r\n        fnew = f(xnew);\r\n        \r\n        % Do we accept the result?\r\n        if norm(fnew) < norm(fk)    % accept\r\n            y = fnew - fk;\r\n            x(:, k+1) = xnew;\r\n            fk = fnew;  \r\n            k = k+1;\r\n            \r\n            lambda = lambda / 10;  % get closer to Newton\r\n            % Broyden update of the Jacobian.\r\n            Ak = Ak + (y - Ak * s) * (s' / (s' * s));\r\n            jac_is_new = false;\r\n        else                       % don't accept\r\n            % Get closer to steepest descent.\r\n            lambda = 4 * lambda;\r\n            % Re-initialize the Jacobian if it's out of date.\r\n            if ~jac_is_new\r\n                Ak = fdjac(f, x(:, k), fk);\r\n                jac_is_new = true;\r\n            end\r\n        end\r\n    end\r\n\r\n    if (norm(fk) > 1e-3)\r\n        warning('Iteration did not find a root.')\r\n    end\r\nend","lang":"matlab","showLineNumbers":true,"filename":"levenberg.m","key":"vhKN5kFmD0"}],"key":"RrICAS3FzE"}],"label":"function-levenberg-matlab","identifier":"function-levenberg-matlab","html_id":"function-levenberg-matlab","key":"T3tA1HYgbV"},{"type":"heading","depth":2,"position":{"start":{"line":58,"column":1},"end":{"line":58,"column":1}},"children":[{"type":"text","value":"Examples","position":{"start":{"line":58,"column":1},"end":{"line":58,"column":1}},"key":"xqtBi74ikW"}],"identifier":"examples","label":"Examples","html_id":"examples","implicit":true,"key":"dJH62cjf6l"}],"key":"qZaeyHFsBR"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"cd  /Users/driscoll/Documents/GitHub/fnc/matlab\nFNC_init;\npwd\npwd;","visibility":"show","key":"wNB5Y1lcAX"},{"type":"output","id":"5wAzA5cYTHnFgsAoNO_pg","data":[{"output_type":"stream","name":"stdout","text":"Starting MATLAB ...\n"},{"output_type":"stream","name":"stdout","text":"Executing ..."},{"output_type":"execute_result","execution_count":1,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = '/Users/driscoll/Documents/GitHub/fnc/matlab'</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = '/Users/driscoll/Documents/GitHub/fnc/matlab'","content_type":"text/plain"}}}],"visibility":"show","key":"XCznBrEhZT"}],"data":{"tags":[]},"visibility":"remove","key":"qb2BWOYZoG"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":68,"column":1},"end":{"line":68,"column":1}},"children":[{"type":"text","value":"4.1 ","position":{"start":{"line":68,"column":1},"end":{"line":68,"column":1}},"key":"tBhXiE5wP2"},{"type":"link","identifier":"section-nonlineqn-rootproblem","label":"section-nonlineqn-rootproblem","kind":"narrative","position":{"start":{"line":68,"column":5},"end":{"line":68,"column":35}},"url":"/rootproblem","internal":true,"dataUrl":"/rootproblem.json","children":[{"type":"text","value":"The rootfinding problem","key":"COtfUdfFGP"}],"key":"fD6CeXk6j9"}],"identifier":"id-4-1","label":"4.1 ","html_id":"id-4-1","implicit":true,"key":"d0FMdez1dk"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-rootproblem-bessel","label":"demo-rootproblem-bessel","kind":"proof:example","position":{"start":{"line":71,"column":1},"end":{"line":71,"column":25}},"children":[{"type":"text","value":"Example ","key":"YPkqd7DUCi"},{"type":"text","value":"4.1.1","key":"GSXQwt3O8R"}],"template":"Example %s","enumerator":"4.1.1","resolved":true,"html_id":"demo-rootproblem-bessel","remote":true,"url":"/rootproblem","dataUrl":"/rootproblem.json","key":"QI7jiuQuZG"}],"key":"svqZ3UTDk2"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"J3 = @(x) besselj(3,x);\nfplot(J3, [0, 20])\ngrid on\nxlabel('x'), ylabel('J_3(x)')  \ntitle('Bessel function')","key":"IZnq6lnTEH"},{"type":"output","id":"oac1ZOFChLroNl1QAWT6y","data":[{"output_type":"execute_result","execution_count":2,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"a7a150d6550ad0d0a0ca417566d9fb01","path":"/build/a7a150d6550ad0d0a0ca417566d9fb01.png"}}}],"key":"gWGiKn0SnQ"}],"key":"ITeJYtJ3Bf"},{"type":"paragraph","position":{"start":{"line":81,"column":1},"end":{"line":81,"column":1}},"children":[{"type":"text","value":"From the graph we see roots near 6, 10, 13, 16, and 19. We use ","position":{"start":{"line":81,"column":1},"end":{"line":81,"column":1}},"key":"eSLzYvqwOU"},{"type":"inlineCode","value":"nlsolve","position":{"start":{"line":81,"column":1},"end":{"line":81,"column":1}},"key":"zko9zUPngM"},{"type":"text","value":" from the ","position":{"start":{"line":81,"column":1},"end":{"line":81,"column":1}},"key":"hpe2kLUKcn"},{"type":"inlineCode","value":"NLsolve","position":{"start":{"line":81,"column":1},"end":{"line":81,"column":1}},"key":"OEqxPMAA3X"},{"type":"text","value":" package to find these roots accurately. It uses vector variables, so we have to code accordingly.","position":{"start":{"line":81,"column":1},"end":{"line":81,"column":1}},"key":"mVsVTo96mA"}],"key":"Oxb2ijyoQD"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"kv3hiNiR8j"}],"key":"TKsBXPdyX7"},{"type":"paragraph","position":{"start":{"line":84,"column":1},"end":{"line":85,"column":1}},"children":[{"type":"text","value":"Type ","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"key":"gC6Q59EjPg"},{"type":"inlineCode","value":"\\omega","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"key":"aQvKgo4IGP"},{"type":"text","value":" followed by ","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"key":"RIV4Pvr4kS"},{"type":"keyboard","children":[{"type":"text","value":"Tab","key":"nTVWa5YppD"}],"key":"s93FIl8eHr"},{"type":"text","value":" to get the character ","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"key":"bXZA2hl91X"},{"type":"inlineCode","value":"ω","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"key":"Cn0Ek2PeCG"},{"type":"text","value":".\nThe argument ","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"key":"o9lbBv8WCf"},{"type":"inlineCode","value":"ftol=1e-14","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"key":"Ld4z7EQgaB"},{"type":"text","value":" below is called a ","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"key":"DiEkk9Q51I"},{"type":"strong","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"children":[{"type":"text","value":"keyword argument","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"key":"CACi8JJdBG"}],"key":"JXNnOUhGEf"},{"type":"text","value":". Here it sets a goal for the maximum value of ","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"key":"Gx8WsJSvI6"},{"type":"inlineMath","value":"|f(x)|","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">∣</mi><mi>f</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mi mathvariant=\"normal\">∣</mi></mrow><annotation encoding=\"application/x-tex\">|f(x)|</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">∣</span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mord\">∣</span></span></span></span>","key":"PzCiz9tH1o"},{"type":"text","value":".","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"key":"jdJvrYBdNp"}],"key":"f3ioXWhzt9"}],"class":"dropdown","key":"cD5C2wv5Vf"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"omega = [];\nfor guess = [6, 10, 13, 16, 19]\n    omega = [omega; fzero(J3, guess)];\nend\nomega","key":"JQiQrYCxos"},{"type":"output","id":"tKup1Q_OzC5ClmnvrPAot","data":[{"output_type":"execute_result","execution_count":3,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>omega = 5×1 double\n    6.3802\n    9.7610\n   13.0152\n   16.2235\n   19.4094\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"omega = 5×1 double\n    6.3802\n    9.7610\n   13.0152\n   16.2235\n   19.4094\n","content_type":"text/plain"}}}],"key":"xGj8wH9bXo"}],"key":"N4XQJ5neZ2"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"table(omega, J3(omega), 'VariableNames', {'root estimate', 'function value'})","key":"cZhF6Gx9y3"},{"type":"output","id":"edLqouitgRZhAdRvm8bkh","data":[{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"text/html":{"content":"<html><head><style>.mwBasicVariableOutputWrapper .mwBasicVariableOutputHeader {font-style: italic;}</style></head><body><div class='mwBasicVariableOutputWrapper'><div>ans = <span class='mwBasicVariableOutputHeader'>5x2 table</span></div><table><thead><tr><th>root estimate</th><th>function value</th></tr></thead><tbody><tr><td>6.3802</td><td>-6.6245e-17</td></tr><tr><td>9.7610</td><td>1.3306e-16</td></tr><tr><td>13.0152</td><td>-2.5589e-16</td></tr><tr><td>16.2235</td><td>-6.9345e-16</td></tr><tr><td>19.4094</td><td>-6.0679e-16</td></tr></tbody></table></div></body></html>","content_type":"text/html"},"text/plain":{"content":"<html><head><style>.mwBasicVariableOutputWrapper .mwBasicVariableOutputHeader {font-style: italic;}</style></head><body><div class='mwBasicVariableOutputWrapper'><div>ans = <span class='mwBasicVariableOutputHeader'>5x2 table</span></div><table><thead><tr><th>root estimate</th><th>function value</th></tr></thead><tbody><tr><td>6.3802</td><td>-6.6245e-17</td></tr><tr><td>9.7610</td><td>1.3306e-16</td></tr><tr><td>13.0152</td><td>-2.5589e-16</td></tr><tr><td>16.2235</td><td>-6.9345e-16</td></tr><tr><td>19.4094</td><td>-6.0679e-16</td></tr></tbody></table></div></body></html>","content_type":"text/plain"}}}],"key":"XxHq57VBGU"}],"key":"YQYo6IbaMX"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"hold on\nscatter(omega, J3(omega))\ntitle('Bessel roots')","key":"U0qW5sI97n"},{"type":"output","id":"NZjXZn664mXvio4qDpcLu","data":[{"output_type":"execute_result","execution_count":5,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"9e9389dd5e65ad60cee143beeeff891b","path":"/build/9e9389dd5e65ad60cee143beeeff891b.png"}}}],"key":"kMcVsj04aN"}],"key":"geoq7W2S0e"},{"type":"paragraph","position":{"start":{"line":106,"column":1},"end":{"line":106,"column":1}},"children":[{"type":"text","value":"If instead we seek values at which ","position":{"start":{"line":106,"column":1},"end":{"line":106,"column":1}},"key":"UmaXkW6lp5"},{"type":"inlineMath","value":"J_3(x)=0.2","position":{"start":{"line":106,"column":1},"end":{"line":106,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>J</mi><mn>3</mn></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mn>0.2</mn></mrow><annotation encoding=\"application/x-tex\">J_3(x)=0.2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.09618em;\">J</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0962em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0.2</span></span></span></span>","key":"hXdubblz4a"},{"type":"text","value":", then we must find roots of the function ","position":{"start":{"line":106,"column":1},"end":{"line":106,"column":1}},"key":"EeYTfis0ZK"},{"type":"inlineMath","value":"J_3(x)-0.2","position":{"start":{"line":106,"column":1},"end":{"line":106,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>J</mi><mn>3</mn></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>−</mo><mn>0.2</mn></mrow><annotation encoding=\"application/x-tex\">J_3(x)-0.2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.09618em;\">J</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0962em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0.2</span></span></span></span>","key":"Y33WytS4GS"},{"type":"text","value":".","position":{"start":{"line":106,"column":1},"end":{"line":106,"column":1}},"key":"cpGlShTyIU"}],"key":"wQ8g1KgdrV"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"omega = [];\nfor guess = [3, 6, 10, 13]\n    f = @(x) J3(x) - 0.2;\n    omega = [omega; fzero(f, guess)];\nend\nscatter(omega, J3(omega), '<')","key":"aTl31RKN7T"},{"type":"output","id":"z9L-a7LlDOScBB3uMxzEj","data":[{"output_type":"execute_result","execution_count":6,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"0de7a3fe50532dc39107c5306407060a","path":"/build/0de7a3fe50532dc39107c5306407060a.png"}}}],"key":"jwskG1k04E"}],"key":"tCIz8YpCVy"}],"label":"demo-rootproblem-bessel-matlab","identifier":"demo-rootproblem-bessel-matlab","html_id":"demo-rootproblem-bessel-matlab","key":"aqnMX1X7bO"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-roots-cond","label":"demo-roots-cond","kind":"proof:example","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":17}},"children":[{"type":"text","value":"Example ","key":"mKv8key21U"},{"type":"text","value":"4.1.2","key":"Vl4Vq2IjVz"}],"template":"Example %s","enumerator":"4.1.2","resolved":true,"html_id":"demo-roots-cond","remote":true,"url":"/rootproblem","dataUrl":"/rootproblem.json","key":"j703OZ3tWc"}],"key":"BQs1J0WyZS"},{"type":"paragraph","position":{"start":{"line":121,"column":1},"end":{"line":121,"column":1}},"children":[{"type":"text","value":"Consider first the function","position":{"start":{"line":121,"column":1},"end":{"line":121,"column":1}},"key":"etgReCq4AK"}],"key":"cw7yRhPz7j"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"f  = @(x) (x - 1) .* (x - 2);","key":"nXtnNfokpo"},{"type":"output","id":"CXM7BZW5FSU4H5pwjifhZ","data":[],"key":"lRjcXexjMD"}],"key":"OcyapPXwYt"},{"type":"paragraph","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"children":[{"type":"text","value":"At the root ","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"key":"GYZiW3KldA"},{"type":"inlineMath","value":"r=1","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>r</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">r=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"RFcv5D5mSB"},{"type":"text","value":", we have ","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"key":"Vz71NzAuER"},{"type":"inlineMath","value":"f'(r)=-1","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>f</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo stretchy=\"false\">(</mo><mi>r</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mo>−</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">f&#x27;(r)=-1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0019em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">−</span><span class=\"mord\">1</span></span></span></span>","key":"qNKZ9a4i5W"},{"type":"text","value":". If the values of ","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"key":"CehvLEzl5j"},{"type":"inlineMath","value":"f","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>","key":"TelWwMmjSV"},{"type":"text","value":" were perturbed at every point by a small amount of noise, we can imagine finding the root of the function drawn with a thick ribbon, giving a range of potential roots.","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"key":"sWFjWqRFdB"}],"key":"GlSZ21KzQf"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf\ninterval = [0.8, 1.2];\nfplot(f, interval)\ngrid on, hold on\nfplot(@(x) f(x) + 0.02, interval, 'k')\nfplot(@(x) f(x) - 0.02, interval, 'k')\naxis equal,  yticks([0])\nylim([-0.1, 0.1])\nxlabel('x'), ylabel('f(x)')\ntitle('Well-conditioned root')","key":"nPui63l6DZ"},{"type":"output","id":"Tul2-UCNkMZwLCEafgfhn","data":[{"output_type":"execute_result","execution_count":8,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"b32cd7504eed75a360d51dec4396bfdb","path":"/build/b32cd7504eed75a360d51dec4396bfdb.png"}}}],"key":"YVdTBUQh6U"}],"key":"p1rORziIZ8"},{"type":"paragraph","position":{"start":{"line":143,"column":1},"end":{"line":143,"column":1}},"children":[{"type":"text","value":"The possible values for a perturbed root all lie within the interval where the ribbon intersects the ","position":{"start":{"line":143,"column":1},"end":{"line":143,"column":1}},"key":"vBuquRNnXY"},{"type":"inlineMath","value":"x","position":{"start":{"line":143,"column":1},"end":{"line":143,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"aDATARyzFX"},{"type":"text","value":"-axis. The width of that zone is about the same as the vertical thickness of the ribbon.","position":{"start":{"line":143,"column":1},"end":{"line":143,"column":1}},"key":"GIMc16NeGo"}],"key":"Jq8yT486iz"},{"type":"paragraph","position":{"start":{"line":145,"column":1},"end":{"line":145,"column":1}},"children":[{"type":"text","value":"By contrast, consider the function","position":{"start":{"line":145,"column":1},"end":{"line":145,"column":1}},"key":"psB3kAJlyr"}],"key":"xhrtKVPK5u"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"f = @(x) (x - 1) .* (x - 1.01);","key":"mVnot83UwD"},{"type":"output","id":"iC7Yl9yUT-NoRJx5aGK8b","data":[],"key":"Z3uVSATXwF"}],"key":"ag0iqnkZLH"},{"type":"paragraph","position":{"start":{"line":151,"column":1},"end":{"line":151,"column":1}},"children":[{"type":"text","value":"Now ","position":{"start":{"line":151,"column":1},"end":{"line":151,"column":1}},"key":"f8t3bPcn42"},{"type":"inlineMath","value":"f'(1)=-0.01","position":{"start":{"line":151,"column":1},"end":{"line":151,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>f</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo><mo>=</mo><mo>−</mo><mn>0.01</mn></mrow><annotation encoding=\"application/x-tex\">f&#x27;(1)=-0.01</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0019em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">−</span><span class=\"mord\">0.01</span></span></span></span>","key":"btzq9pr9f2"},{"type":"text","value":", and the graph of ","position":{"start":{"line":151,"column":1},"end":{"line":151,"column":1}},"key":"s3epgIXsKS"},{"type":"inlineMath","value":"f","position":{"start":{"line":151,"column":1},"end":{"line":151,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>","key":"QDUNicdl1l"},{"type":"text","value":" will be much shallower near ","position":{"start":{"line":151,"column":1},"end":{"line":151,"column":1}},"key":"yz80g7QlWy"},{"type":"inlineMath","value":"x=1","position":{"start":{"line":151,"column":1},"end":{"line":151,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">x=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"rqXGeQZ4Oe"},{"type":"text","value":". Look at the effect this has on our thick rendering:","position":{"start":{"line":151,"column":1},"end":{"line":151,"column":1}},"key":"g7OhBCImsO"}],"key":"Le0CCjReHe"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"axis(axis), cla\nfplot(f, interval)\nfplot(@(x) f(x) + 0.02, interval, 'k')\nfplot(@(x) f(x) - 0.02, interval, 'k')\nylim([-0.1, 0.1]), yticks([0])\ntitle('Poorly conditioned root')","key":"j7Qq8UdSdf"},{"type":"output","id":"UcnzUVapciZf5vInVxSUC","data":[{"output_type":"execute_result","execution_count":10,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"181e8cba7e3538fee74b2f27fd210a5c","path":"/build/181e8cba7e3538fee74b2f27fd210a5c.png"}}}],"key":"XTIxrHrnBd"}],"key":"UL08fxde0B"},{"type":"paragraph","position":{"start":{"line":162,"column":1},"end":{"line":162,"column":1}},"children":[{"type":"text","value":"The vertical displacements in this picture are exactly the same as before. But the potential ","position":{"start":{"line":162,"column":1},"end":{"line":162,"column":1}},"key":"tqHlNaFRkW"},{"type":"emphasis","position":{"start":{"line":162,"column":1},"end":{"line":162,"column":1}},"children":[{"type":"text","value":"horizontal","position":{"start":{"line":162,"column":1},"end":{"line":162,"column":1}},"key":"aGH2YdVt3r"}],"key":"L4hFs7DeAl"},{"type":"text","value":" displacement of the root is much wider. In fact, if we perturb the function entirely upward by the amount drawn here, the root disappears!","position":{"start":{"line":162,"column":1},"end":{"line":162,"column":1}},"key":"zSeJqL2OMA"}],"key":"LOlL0UMLT3"}],"label":"demo-roots-cond-matlab","identifier":"demo-roots-cond-matlab","html_id":"demo-roots-cond-matlab","key":"M8ddOxceE7"},{"type":"heading","depth":3,"position":{"start":{"line":165,"column":1},"end":{"line":165,"column":1}},"children":[{"type":"text","value":"4.2 ","position":{"start":{"line":165,"column":1},"end":{"line":165,"column":1}},"key":"WcT0Ls5obA"},{"type":"link","identifier":"section-nonlineqn-fixed-point","label":"section-nonlineqn-fixed-point","kind":"narrative","position":{"start":{"line":165,"column":5},"end":{"line":165,"column":35}},"url":"/fixed-point","internal":true,"dataUrl":"/fixed-point.json","children":[{"type":"text","value":"Fixed-point iteration","key":"heKfFsErGV"}],"key":"SNK0g3XXgb"}],"identifier":"id-4-2","label":"4.2 ","html_id":"id-4-2","implicit":true,"key":"PjAW2qLobg"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-fp-spiral","label":"demo-fp-spiral","kind":"proof:example","position":{"start":{"line":167,"column":1},"end":{"line":167,"column":16}},"children":[{"type":"text","value":"Example ","key":"DQZGlGAW9d"},{"type":"text","value":"4.2.1","key":"Fuht0BLBkD"}],"template":"Example %s","enumerator":"4.2.1","resolved":true,"html_id":"demo-fp-spiral","remote":true,"url":"/fixed-point","dataUrl":"/fixed-point.json","key":"CvlSnFnCHI"}],"key":"YaRqtsYpag"},{"type":"paragraph","position":{"start":{"line":169,"column":1},"end":{"line":169,"column":1}},"children":[{"type":"text","value":"Let’s convert the roots of a quadratic polynomial ","position":{"start":{"line":169,"column":1},"end":{"line":169,"column":1}},"key":"V0MMCi41lT"},{"type":"inlineMath","value":"f(x)","position":{"start":{"line":169,"column":1},"end":{"line":169,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">f(x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span>","key":"gnn05BHON4"},{"type":"text","value":" to a fixed point problem.","position":{"start":{"line":169,"column":1},"end":{"line":169,"column":1}},"key":"wsxFObTsoW"}],"key":"xVgT1NwPLd"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"f = @(x) x.^2 - 4*x + 3.5;\nr = roots([1, -4, 3.5])","key":"Nc76SGXN9g"},{"type":"output","id":"OwkmhPWgVo_4WEHojwFHk","data":[{"output_type":"execute_result","execution_count":11,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>r = 2×1 double\n    2.7071\n    1.2929\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"r = 2×1 double\n    2.7071\n    1.2929\n","content_type":"text/plain"}}}],"key":"txW2zfFgpO"}],"key":"FC7fogbBwu"},{"type":"paragraph","position":{"start":{"line":176,"column":1},"end":{"line":176,"column":1}},"children":[{"type":"text","value":"We define ","position":{"start":{"line":176,"column":1},"end":{"line":176,"column":1}},"key":"OOXeZnahHH"},{"type":"inlineMath","value":"g(x)=x-p(x)","position":{"start":{"line":176,"column":1},"end":{"line":176,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>g</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>x</mi><mo>−</mo><mi>p</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">g(x)=x-p(x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span>","key":"JSuDp4zPNX"},{"type":"text","value":".","position":{"start":{"line":176,"column":1},"end":{"line":176,"column":1}},"key":"Px9QxTsvpF"}],"key":"pEI2O9NpeW"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"g = @(x) x - f(x);","key":"wsgyKfrUuk"},{"type":"output","id":"KBBFoIABLljMUtKpAKfSd","data":[],"key":"HGGWfImaPp"}],"key":"SwxHwrIl7L"},{"type":"paragraph","position":{"start":{"line":182,"column":1},"end":{"line":182,"column":1}},"children":[{"type":"text","value":"Intersections of ","position":{"start":{"line":182,"column":1},"end":{"line":182,"column":1}},"key":"VwrXfHwEYX"},{"type":"inlineMath","value":"y=g(x)","position":{"start":{"line":182,"column":1},"end":{"line":182,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi><mo>=</mo><mi>g</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">y=g(x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span>","key":"WlvFU3za1b"},{"type":"text","value":" with the line ","position":{"start":{"line":182,"column":1},"end":{"line":182,"column":1}},"key":"rNmVoNknaQ"},{"type":"inlineMath","value":"y=x","position":{"start":{"line":182,"column":1},"end":{"line":182,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi><mo>=</mo><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">y=x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"QLLfTd8MGO"},{"type":"text","value":" are fixed points of ","position":{"start":{"line":182,"column":1},"end":{"line":182,"column":1}},"key":"JgSLivkrX4"},{"type":"inlineMath","value":"g","position":{"start":{"line":182,"column":1},"end":{"line":182,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>g</mi></mrow><annotation encoding=\"application/x-tex\">g</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span></span></span></span>","key":"SooR8FtuFX"},{"type":"text","value":" and thus roots of ","position":{"start":{"line":182,"column":1},"end":{"line":182,"column":1}},"key":"Dp0KpvukVf"},{"type":"inlineMath","value":"f","position":{"start":{"line":182,"column":1},"end":{"line":182,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>","key":"VeXF3Ac3An"},{"type":"text","value":". (Only one is shown in the chosen plot range.)","position":{"start":{"line":182,"column":1},"end":{"line":182,"column":1}},"key":"QH7TBjfk96"}],"key":"UXwFZf6idb"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf\nfplot(g, [2, 3])\nhold on,  plot([2, 3], [2, 3], 'k')\ntitle('Finding a fixed point'),  axis equal  \nxlabel('x'),  ylabel('y')","key":"ToOKedDFLK"},{"type":"output","id":"SU_9cxnp85OLC7Xtuj7dT","data":[{"output_type":"execute_result","execution_count":13,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"a6597aeadc33673db0b2530a34e55f99","path":"/build/a6597aeadc33673db0b2530a34e55f99.png"}}}],"key":"Mf7tlKe46j"}],"key":"MZ1mBjmEcF"},{"type":"paragraph","position":{"start":{"line":192,"column":1},"end":{"line":192,"column":1}},"children":[{"type":"text","value":"If we evaluate ","position":{"start":{"line":192,"column":1},"end":{"line":192,"column":1}},"key":"Xx2cB7oGz4"},{"type":"inlineMath","value":"g(2.1)","position":{"start":{"line":192,"column":1},"end":{"line":192,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>g</mi><mo stretchy=\"false\">(</mo><mn>2.1</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">g(2.1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mopen\">(</span><span class=\"mord\">2.1</span><span class=\"mclose\">)</span></span></span></span>","key":"JqMj9NKejA"},{"type":"text","value":", we get a value of almost 2.6, so this is not a fixed point.","position":{"start":{"line":192,"column":1},"end":{"line":192,"column":1}},"key":"YL8vGaB5ir"}],"key":"Oo2I4BUXmm"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"x = 2.1;\ny = g(x)","key":"f0UjOEyyPS"},{"type":"output","id":"si0XfSHwWVjMTW-bcYiqU","data":[{"output_type":"execute_result","execution_count":14,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>y = 2.5900</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"y = 2.5900","content_type":"text/plain"}}}],"key":"KaF4x3KtEL"}],"key":"dpfNzFnVEW"},{"type":"paragraph","position":{"start":{"line":199,"column":1},"end":{"line":199,"column":1}},"children":[{"type":"text","value":"However, ","position":{"start":{"line":199,"column":1},"end":{"line":199,"column":1}},"key":"kYoCrrsa5N"},{"type":"inlineMath","value":"y=g(x)","position":{"start":{"line":199,"column":1},"end":{"line":199,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi><mo>=</mo><mi>g</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">y=g(x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span>","key":"yc8xse0vKp"},{"type":"text","value":" is considerably closer to the fixed point at around 2.7 than ","position":{"start":{"line":199,"column":1},"end":{"line":199,"column":1}},"key":"xle5IaeMsE"},{"type":"inlineMath","value":"x","position":{"start":{"line":199,"column":1},"end":{"line":199,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"g27kFvpjIa"},{"type":"text","value":" is. Suppose then that we adopt ","position":{"start":{"line":199,"column":1},"end":{"line":199,"column":1}},"key":"xgGlri110J"},{"type":"inlineMath","value":"y","position":{"start":{"line":199,"column":1},"end":{"line":199,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>","key":"JjRCFMtmRq"},{"type":"text","value":" as our new ","position":{"start":{"line":199,"column":1},"end":{"line":199,"column":1}},"key":"uruHcuWZYz"},{"type":"inlineMath","value":"x","position":{"start":{"line":199,"column":1},"end":{"line":199,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"kMxrabSXrk"},{"type":"text","value":" value. Changing the ","position":{"start":{"line":199,"column":1},"end":{"line":199,"column":1}},"key":"l9hubgePNp"},{"type":"inlineMath","value":"x","position":{"start":{"line":199,"column":1},"end":{"line":199,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"gZYJmHsfJT"},{"type":"text","value":" coordinate in this way is the same as following a horizontal line over to the graph of ","position":{"start":{"line":199,"column":1},"end":{"line":199,"column":1}},"key":"g8kmHs3HXq"},{"type":"inlineMath","value":"y=x","position":{"start":{"line":199,"column":1},"end":{"line":199,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi><mo>=</mo><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">y=x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"OFqfeLbPkh"},{"type":"text","value":".","position":{"start":{"line":199,"column":1},"end":{"line":199,"column":1}},"key":"pgILsauQUa"}],"key":"bqMOnbYm4l"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"plot([x, y], [y, y], '-')\nx = y;","key":"ecEU3F94Pb"},{"type":"output","id":"tScUD-1oJVWbQvVEzmJDp","data":[{"output_type":"execute_result","execution_count":15,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"b512332ed3b2f73b6268c8dbd51f1261","path":"/build/b512332ed3b2f73b6268c8dbd51f1261.png"}}}],"key":"fQkCknGhLU"}],"key":"WYOUUbAxMd"},{"type":"paragraph","position":{"start":{"line":206,"column":1},"end":{"line":206,"column":1}},"children":[{"type":"text","value":"Now we can compute a new value for ","position":{"start":{"line":206,"column":1},"end":{"line":206,"column":1}},"key":"zZZPsCywhx"},{"type":"inlineMath","value":"y","position":{"start":{"line":206,"column":1},"end":{"line":206,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>","key":"hNtg4BeJvu"},{"type":"text","value":". We leave ","position":{"start":{"line":206,"column":1},"end":{"line":206,"column":1}},"key":"mGfLpnhnHe"},{"type":"inlineMath","value":"x","position":{"start":{"line":206,"column":1},"end":{"line":206,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"rXqh6ltAVm"},{"type":"text","value":" alone here, so we travel along a vertical line to the graph of ","position":{"start":{"line":206,"column":1},"end":{"line":206,"column":1}},"key":"dh9N7nvevs"},{"type":"inlineMath","value":"g","position":{"start":{"line":206,"column":1},"end":{"line":206,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>g</mi></mrow><annotation encoding=\"application/x-tex\">g</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span></span></span></span>","key":"d0C43v82x9"},{"type":"text","value":".","position":{"start":{"line":206,"column":1},"end":{"line":206,"column":1}},"key":"cnXOc0LsCm"}],"key":"l7TGIrLQ6D"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"y = g(x)\nplot([x, x],[x, y], '-')","key":"tJpLP1yFwd"},{"type":"output","id":"SgM4rgaCpMPT7hn1_yKmo","data":[{"output_type":"execute_result","execution_count":16,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>y = 2.7419</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"y = 2.7419","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":16,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"c9d0d9f172ed4ca5e5716c1dabed10a2","path":"/build/c9d0d9f172ed4ca5e5716c1dabed10a2.png"}}}],"key":"Suvr3ayhl7"}],"key":"QKC8SLLa0u"},{"type":"paragraph","position":{"start":{"line":213,"column":1},"end":{"line":213,"column":1}},"children":[{"type":"text","value":"You see that we are in a position to repeat these steps as often as we like. Let’s apply them a few times and see the result.","position":{"start":{"line":213,"column":1},"end":{"line":213,"column":1}},"key":"XuF8gYM4Am"}],"key":"IlpKpgLOKg"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"for k = 1:5\n    plot([x, y], [y, y], '-')\n    x = y;       % y --> new x\n    y = g(x);    % g(x) --> new y\n    plot([x, x], [x, y], '-')  \nend","key":"pnV496wpHG"},{"type":"output","id":"udlLKNYIn1wmzafK7qjEg","data":[{"output_type":"execute_result","execution_count":17,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"02290cae5a79b3fd69c83535c288dd71","path":"/build/02290cae5a79b3fd69c83535c288dd71.png"}}}],"key":"KlmHJtcLMn"}],"key":"f3ztZKYlw4"},{"type":"paragraph","position":{"start":{"line":224,"column":1},"end":{"line":224,"column":1}},"children":[{"type":"text","value":"The process spirals in beautifully toward the fixed point we seek. Our last estimate has almost 4 accurate digits.","position":{"start":{"line":224,"column":1},"end":{"line":224,"column":1}},"key":"dSl1WuD5Fo"}],"key":"oPTcLcMFfl"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"abs(y - r(1)) / r(1)","key":"I7b7VwqSjE"},{"type":"output","id":"fY1C3Wq1PtfpGvxCBNW1-","data":[{"output_type":"execute_result","execution_count":18,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = 1.6531e-04</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = 1.6531e-04","content_type":"text/plain"}}}],"key":"cCU9Ll1Yfs"}],"key":"dSGljRl0NJ"},{"type":"paragraph","position":{"start":{"line":230,"column":1},"end":{"line":230,"column":1}},"children":[{"type":"text","value":"Now let’s try to find the other fixed point ","position":{"start":{"line":230,"column":1},"end":{"line":230,"column":1}},"key":"WDJyYq9OZb"},{"type":"inlineMath","value":"\\approx 1.29","position":{"start":{"line":230,"column":1},"end":{"line":230,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>≈</mo><mn>1.29</mn></mrow><annotation encoding=\"application/x-tex\">\\approx 1.29</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4831em;\"></span><span class=\"mrel\">≈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1.29</span></span></span></span>","key":"BNGajJcC0H"},{"type":"text","value":" in the same way. We’ll use 1.3 as a starting approximation.","position":{"start":{"line":230,"column":1},"end":{"line":230,"column":1}},"key":"QGkKMVXxMT"}],"key":"b64IDsez7v"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"cla\nfplot(g, [1, 2])\nhold on, plot([1, 2], [1, 2], 'k')\nylim([1, 2])\nx = 1.3;  y = g(x);\nfor k = 1:5\n    plot([x, y], [y, y], '-'),  \n    x = y;       % y --> new x\n    y = g(x);    % g(x) --> new y\n    plot([x, x], [x, y], '-') \nend\ntitle('No convergence')","key":"hNCw4RV3cg"},{"type":"output","id":"1ibuyD3-Zj_LaIxEsReuT","data":[{"output_type":"execute_result","execution_count":19,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"028f6148ea37a11266b57d25ea899807","path":"/build/028f6148ea37a11266b57d25ea899807.png"}}}],"key":"UAwTdbc2Cp"}],"key":"OCBXIvtW2T"},{"type":"paragraph","position":{"start":{"line":247,"column":1},"end":{"line":247,"column":1}},"children":[{"type":"text","value":"This time, the iteration is pushing us ","position":{"start":{"line":247,"column":1},"end":{"line":247,"column":1}},"key":"NNtggJCNgU"},{"type":"emphasis","position":{"start":{"line":247,"column":1},"end":{"line":247,"column":1}},"children":[{"type":"text","value":"away from","position":{"start":{"line":247,"column":1},"end":{"line":247,"column":1}},"key":"AFhMQMVlto"}],"key":"DqfqTuDytI"},{"type":"text","value":" the correct answer.","position":{"start":{"line":247,"column":1},"end":{"line":247,"column":1}},"key":"FLfft8LWfR"}],"key":"wXGYPkEFMK"}],"label":"demo-fp-spiral-matlab","identifier":"demo-fp-spiral-matlab","html_id":"demo-fp-spiral-matlab","key":"b3Hnbbtndu"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-fp-converge","label":"demo-fp-converge","kind":"proof:example","position":{"start":{"line":251,"column":1},"end":{"line":251,"column":18}},"children":[{"type":"text","value":"Example ","key":"UorLjCAsSx"},{"type":"text","value":"4.2.3","key":"QjjYW0Dghp"}],"template":"Example %s","enumerator":"4.2.3","resolved":true,"html_id":"demo-fp-converge","remote":true,"url":"/fixed-point","dataUrl":"/fixed-point.json","key":"NG0QktB1TI"}],"key":"PYJaeAlew1"},{"type":"paragraph","position":{"start":{"line":253,"column":1},"end":{"line":253,"column":1}},"children":[{"type":"text","value":"We revisit ","position":{"start":{"line":253,"column":1},"end":{"line":253,"column":1}},"key":"xsK3QN99ob"},{"type":"crossReference","identifier":"demo-fp-spiral","label":"demo-fp-spiral","kind":"proof:example","position":{"start":{"line":253,"column":12},"end":{"line":253,"column":27}},"children":[{"type":"text","value":"Example ","key":"hYa80O1yd0"},{"type":"text","value":"4.2.1","key":"Ev0SdE3ekT"}],"template":"Example %s","enumerator":"4.2.1","resolved":true,"html_id":"demo-fp-spiral","remote":true,"url":"/fixed-point","dataUrl":"/fixed-point.json","key":"uIFRhIGRJM"},{"type":"text","value":" and investigate the observed convergence more closely. Recall that above we calculated ","position":{"start":{"line":253,"column":1},"end":{"line":253,"column":1}},"key":"a4nJKKmQ9E"},{"type":"inlineMath","value":"g'(p)\\approx-0.42","position":{"start":{"line":253,"column":1},"end":{"line":253,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>g</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo stretchy=\"false\">(</mo><mi>p</mi><mo stretchy=\"false\">)</mo><mo>≈</mo><mo>−</mo><mn>0.42</mn></mrow><annotation encoding=\"application/x-tex\">g&#x27;(p)\\approx-0.42</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0019em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">p</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">−</span><span class=\"mord\">0.42</span></span></span></span>","key":"c0eS36RoQx"},{"type":"text","value":" at the convergent fixed point.","position":{"start":{"line":253,"column":1},"end":{"line":253,"column":1}},"key":"tciLeKa99n"}],"key":"b7TzXcxIgX"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"f = @(x) x.^2 - 4*x + 3.5;\nr = roots([1, -4, 3.5]);","key":"RKDq855eOx"},{"type":"output","id":"gUUY_forzuikfY-5xDhjd","data":[],"key":"d8gybHfXBh"}],"key":"HI9BhsDXLH"},{"type":"paragraph","position":{"start":{"line":260,"column":1},"end":{"line":260,"column":1}},"children":[{"type":"text","value":"Here is the fixed-point iteration. This time we keep track of the whole sequence of approximations.","position":{"start":{"line":260,"column":1},"end":{"line":260,"column":1}},"key":"PgsZlzXKs7"}],"key":"gttwhv46hJ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"g = @(x) x - f(x);\nx = 2.1; \nfor k = 1:12\n    x(k+1) = g(x(k));\nend","key":"mXG1ITdZqG"},{"type":"output","id":"hVnZE8BFQrK1Rp6sm1G4m","data":[],"key":"wsCTUq0FiP"}],"indexEntries":[{"entry":"Julia","subEntry":{"value":"push!","kind":"entry"},"emphasis":false}],"label":"index-HlueJL4quy","identifier":"index-hluejl4quy","html_id":"index-hluejl4quy","key":"ToVrE6PVas"},{"type":"paragraph","position":{"start":{"line":273,"column":1},"end":{"line":273,"column":1}},"children":[{"type":"text","value":"It’s illuminating to construct and plot the sequence of errors.","position":{"start":{"line":273,"column":1},"end":{"line":273,"column":1}},"key":"X0ZyR7yUgr"}],"key":"k9atiZtE9E"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"err = abs(x - r(1));\nclf\nsemilogy(err, 'o-'), axis tight\nxlabel('iteration'),  ylabel('error')\ntitle('Convergence of fixed-point iteration')","key":"NsXnUB6Aue"},{"type":"output","id":"1uA8p9EdeIhpQQEhc15Z-","data":[{"output_type":"execute_result","execution_count":22,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"2556b739267d0f2dc3702c33adc72c30","path":"/build/2556b739267d0f2dc3702c33adc72c30.png"}}}],"key":"b7ddRN7hE3"}],"key":"PMC13JedNn"},{"type":"paragraph","position":{"start":{"line":283,"column":1},"end":{"line":283,"column":1}},"children":[{"type":"text","value":"It’s quite clear that the convergence quickly settles into a linear rate. We could estimate this rate by doing a least-squares fit to a straight line. Keep in mind that the values for small ","position":{"start":{"line":283,"column":1},"end":{"line":283,"column":1}},"key":"d6NAES4ODD"},{"type":"inlineMath","value":"k","position":{"start":{"line":283,"column":1},"end":{"line":283,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span>","key":"PErb67SiWq"},{"type":"text","value":" should be left out of the computation, as they don’t represent the linear trend.","position":{"start":{"line":283,"column":1},"end":{"line":283,"column":1}},"key":"p49oPJnSZa"}],"key":"YkakqLqxzx"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"y = log(err(5:12));\np = polyfit(5:12, y, 1);","key":"NwtI1WQI0y"},{"type":"output","id":"pI5-jWwC7QU76bMUmOXrc","data":[],"key":"E4qnhOyjbe"}],"key":"pfb0BBhlrQ"},{"type":"paragraph","position":{"start":{"line":290,"column":1},"end":{"line":290,"column":1}},"children":[{"type":"text","value":"We can exponentiate the slope to get the convergence constant ","position":{"start":{"line":290,"column":1},"end":{"line":290,"column":1}},"key":"trKO6hJlXr"},{"type":"inlineMath","value":"\\sigma","position":{"start":{"line":290,"column":1},"end":{"line":290,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>σ</mi></mrow><annotation encoding=\"application/x-tex\">\\sigma</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span></span></span></span>","key":"JRemeqZybo"},{"type":"text","value":".","position":{"start":{"line":290,"column":1},"end":{"line":290,"column":1}},"key":"G9DccZ2V5l"}],"key":"x9BQ8GZgG7"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"sigma = exp(p(1))","key":"LQRTP93s9p"},{"type":"output","id":"6DQ4dRPOh9lknGHLDlK4J","data":[{"output_type":"execute_result","execution_count":24,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>sigma = 0.4145</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"sigma = 0.4145","content_type":"text/plain"}}}],"key":"yEwYFdLpZZ"}],"key":"REl3Stn7HN"},{"type":"paragraph","position":{"start":{"line":296,"column":1},"end":{"line":296,"column":1}},"children":[{"type":"text","value":"The error should therefore decrease by a factor of ","position":{"start":{"line":296,"column":1},"end":{"line":296,"column":1}},"key":"xE4FkIxkqo"},{"type":"inlineMath","value":"\\sigma","position":{"start":{"line":296,"column":1},"end":{"line":296,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>σ</mi></mrow><annotation encoding=\"application/x-tex\">\\sigma</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span></span></span></span>","key":"XFUUFI1eor"},{"type":"text","value":" at each iteration. We can check this easily from the observed data.","position":{"start":{"line":296,"column":1},"end":{"line":296,"column":1}},"key":"SusPr82e3i"}],"key":"QxBn2k7eIy"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"err(9:12) ./ err(8:11)","key":"N0JjlYdRM1"},{"type":"output","id":"V_RW6aQkHiCXxg2PV5k9o","data":[{"output_type":"execute_result","execution_count":25,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = 1×4 double\n    0.4138    0.4144    0.4141    0.4142\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = 1×4 double\n    0.4138    0.4144    0.4141    0.4142\n","content_type":"text/plain"}}}],"key":"VxaSyCEK4f"}],"key":"UYo36TNDEY"},{"type":"paragraph","position":{"start":{"line":302,"column":1},"end":{"line":302,"column":1}},"children":[{"type":"text","value":"The methods for finding ","position":{"start":{"line":302,"column":1},"end":{"line":302,"column":1}},"key":"asLJb2JfBS"},{"type":"inlineMath","value":"\\sigma","position":{"start":{"line":302,"column":1},"end":{"line":302,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>σ</mi></mrow><annotation encoding=\"application/x-tex\">\\sigma</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span></span></span></span>","key":"RodeOy9OGF"},{"type":"text","value":" agree well.","position":{"start":{"line":302,"column":1},"end":{"line":302,"column":1}},"key":"S3mTJJVaCm"}],"key":"g5i1GrVsEY"}],"label":"demo-fp-converge-matlab","identifier":"demo-fp-converge-matlab","html_id":"demo-fp-converge-matlab","key":"ZpPuGAbEUU"},{"type":"heading","depth":3,"position":{"start":{"line":304,"column":1},"end":{"line":304,"column":1}},"children":[{"type":"text","value":"4.3 ","position":{"start":{"line":304,"column":1},"end":{"line":304,"column":1}},"key":"LcCcu4M2eP"},{"type":"link","identifier":"section-nonlineqn-newton","label":"section-nonlineqn-newton","kind":"narrative","position":{"start":{"line":304,"column":5},"end":{"line":304,"column":30}},"url":"/newton","internal":true,"dataUrl":"/newton.json","children":[{"type":"text","value":"Newton’s method","key":"WPwHgXS0Ja"}],"key":"Q859FKCUxI"}],"identifier":"id-4-3","label":"4.3 ","html_id":"id-4-3","implicit":true,"key":"oknXdVfzNG"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-newton-line","label":"demo-newton-line","kind":"proof:example","position":{"start":{"line":306,"column":1},"end":{"line":306,"column":18}},"children":[{"type":"text","value":"Example ","key":"pjRWe8FXCn"},{"type":"text","value":"4.3.1","key":"zs2Snwjtsp"}],"template":"Example %s","enumerator":"4.3.1","resolved":true,"html_id":"demo-newton-line","remote":true,"url":"/newton","dataUrl":"/newton.json","key":"S6Pc4ePcBN"}],"key":"k9RvUZxEX6"},{"type":"paragraph","position":{"start":{"line":309,"column":1},"end":{"line":309,"column":1}},"children":[{"type":"text","value":"Suppose we want to find a root of the function","position":{"start":{"line":309,"column":1},"end":{"line":309,"column":1}},"key":"pmKXtHMwtp"}],"key":"fTBFtnVyOL"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"f = @(x) x .* exp(x) - 2;\nclf, fplot(f, [0, 1.5])\nxlabel('x'), ylabel('y')    \nset(gca, 'ygrid', 'on')  \ntitle('Objective function')","key":"AU64op9zfu"},{"type":"output","id":"FQWYNuV9wZ_c66IodBinU","data":[{"output_type":"execute_result","execution_count":26,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"a775a517c1c0949db38d66905063dba5","path":"/build/a775a517c1c0949db38d66905063dba5.png"}}}],"key":"zkqfpoTEfV"}],"key":"PzdR8qfdw2"},{"type":"paragraph","position":{"start":{"line":320,"column":1},"end":{"line":320,"column":1}},"children":[{"type":"text","value":"From the graph, it is clear that there is a root near ","position":{"start":{"line":320,"column":1},"end":{"line":320,"column":1}},"key":"rXQuLk1SiH"},{"type":"inlineMath","value":"x=1","position":{"start":{"line":320,"column":1},"end":{"line":320,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">x=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"endTVSaI6M"},{"type":"text","value":". So we call that our initial guess, ","position":{"start":{"line":320,"column":1},"end":{"line":320,"column":1}},"key":"YklTHkQMGE"},{"type":"inlineMath","value":"x_1","position":{"start":{"line":320,"column":1},"end":{"line":320,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">x_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"z8Uc7gPAJB"},{"type":"text","value":".","position":{"start":{"line":320,"column":1},"end":{"line":320,"column":1}},"key":"cSOmDjnImu"}],"key":"yROk2bBzGY"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"x1 = 1;\ny1 = f(x1)\nhold on, scatter(x1, y1, 'k')","key":"iuvTEaCtFA"},{"type":"output","id":"L6WHkiuadOm4jRCzHHu3y","data":[{"output_type":"execute_result","execution_count":27,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>y1 = 0.7183</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"y1 = 0.7183","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":27,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"5e47d3a3656aa5ced56501c3209a14c4","path":"/build/5e47d3a3656aa5ced56501c3209a14c4.png"}}}],"key":"VSsGfncXOZ"}],"key":"DnLpEa092k"},{"type":"paragraph","position":{"start":{"line":328,"column":1},"end":{"line":328,"column":1}},"children":[{"type":"text","value":"Next, we can compute the tangent line at the point ","position":{"start":{"line":328,"column":1},"end":{"line":328,"column":1}},"key":"eghUpxs1DV"},{"type":"inlineMath","value":"\\bigl(x_1,f(x_1)\\bigr)","position":{"start":{"line":328,"column":1},"end":{"line":328,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo fence=\"true\" stretchy=\"true\" minsize=\"1.2em\" maxsize=\"1.2em\">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><mi>f</mi><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy=\"false\">)</mo><mo fence=\"true\" stretchy=\"true\" minsize=\"1.2em\" maxsize=\"1.2em\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\bigl(x_1,f(x_1)\\bigr)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.2em;vertical-align:-0.35em;\"></span><span class=\"mopen\"><span class=\"delimsizing size1\">(</span></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mclose\"><span class=\"delimsizing size1\">)</span></span></span></span></span>","key":"wE01yTLmRn"},{"type":"text","value":", using the derivative.","position":{"start":{"line":328,"column":1},"end":{"line":328,"column":1}},"key":"KKVJncrAqZ"}],"key":"wkffyIWvMZ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"df_dx = @(x) exp(x) .* (x + 1);\nslope1 = df_dx(x1);\ntangent1 = @(x) y1 + slope1 * (x - x1);\naxis(axis)\nfplot(tangent1, [0, 1.5], 'k--')\ntitle('Function and tangent line')","key":"eqR27BAvHA"},{"type":"output","id":"6Hq040Q15g2W2ohXFYuzU","data":[{"output_type":"execute_result","execution_count":28,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"f283fb901f617aec55f541ed90b94df1","path":"/build/f283fb901f617aec55f541ed90b94df1.png"}}}],"key":"pkR2O87er6"}],"key":"bwW8Ud6iip"},{"type":"paragraph","position":{"start":{"line":340,"column":1},"end":{"line":340,"column":1}},"children":[{"type":"text","value":"In lieu of finding the root of ","position":{"start":{"line":340,"column":1},"end":{"line":340,"column":1}},"key":"rt0TERuCbn"},{"type":"inlineMath","value":"f","position":{"start":{"line":340,"column":1},"end":{"line":340,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>","key":"zBYOHM9fKi"},{"type":"text","value":" itself, we settle for finding the root of the tangent line approximation, which is trivial. Call this ","position":{"start":{"line":340,"column":1},"end":{"line":340,"column":1}},"key":"hnHuHwWkCT"},{"type":"inlineMath","value":"x_2","position":{"start":{"line":340,"column":1},"end":{"line":340,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">x_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"uHvSuhCXpx"},{"type":"text","value":", our next approximation to the root.","position":{"start":{"line":340,"column":1},"end":{"line":340,"column":1}},"key":"J3zBoNSQzA"}],"key":"nFFpaLO7My"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"x2 = x1 - y1 / slope1\nscatter(x2, 0, 'r')\ntitle('Root of the tangent')","key":"cbQMuAvagH"},{"type":"output","id":"-jcEGD5Ia2V-c5np4BlGv","data":[{"output_type":"execute_result","execution_count":29,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>x2 = 0.8679</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"x2 = 0.8679","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":29,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"baed05ce5d94eeb513f7fa661c7fa62f","path":"/build/baed05ce5d94eeb513f7fa661c7fa62f.png"}}}],"key":"datfeg8XfV"}],"key":"QXPrzBcTFF"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"y2 = f(x2)","key":"qrVSXUM8p2"},{"type":"output","id":"OSHuyh97j9QeNPL2gwisr","data":[{"output_type":"execute_result","execution_count":30,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>y2 = 0.0672</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"y2 = 0.0672","content_type":"text/plain"}}}],"key":"ryl3rrGQqU"}],"key":"CM49ZW0wTC"},{"type":"paragraph","position":{"start":{"line":352,"column":1},"end":{"line":352,"column":1}},"children":[{"type":"text","value":"The residual (i.e., value of ","position":{"start":{"line":352,"column":1},"end":{"line":352,"column":1}},"key":"p3fSLFsEh0"},{"type":"inlineMath","value":"f","position":{"start":{"line":352,"column":1},"end":{"line":352,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>","key":"qryglYSVSs"},{"type":"text","value":") is smaller than before, but not zero. So we repeat the process with a new tangent line based on the latest point on the curve.","position":{"start":{"line":352,"column":1},"end":{"line":352,"column":1}},"key":"FaXqm3iDqZ"}],"key":"d4w3AeVgPR"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"cla,  axis auto\nfplot(f, [0.83, 0.88])\nscatter(x2, y2, 'k')\nslope2 = df_dx(x2);\ntangent2 = @(x) y2 + slope2 * (x - x2);\naxis(axis)\nfplot(tangent2, [0.8, 0.9], 'k--')\nx3 = x2 - y2 / slope2;\nscatter(x3, 0, 'r')\ntitle('Next iteration')","key":"yqND0gIDcD"},{"type":"output","id":"ofG83T_iFV87QsgcNrn6j","data":[{"output_type":"execute_result","execution_count":31,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"9e725d9d8d962e1180b5042fd96860ca","path":"/build/9e725d9d8d962e1180b5042fd96860ca.png"}}}],"key":"Zo0ECWOujy"}],"key":"P9f98bJHB0"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"y3 = f(x3)","key":"fQLWzgQzB1"},{"type":"output","id":"rIOYJ_wwdoE8CsEv6JSv1","data":[{"output_type":"execute_result","execution_count":32,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>y3 = 7.7309e-04</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"y3 = 7.7309e-04","content_type":"text/plain"}}}],"key":"cANEbQ8HWk"}],"key":"XQes2z7AF3"},{"type":"paragraph","position":{"start":{"line":371,"column":1},"end":{"line":371,"column":1}},"children":[{"type":"text","value":"Judging by the residual, we appear to be getting closer to the true root each time.","position":{"start":{"line":371,"column":1},"end":{"line":371,"column":1}},"key":"Jq1uURH9iS"}],"key":"SSftJVzhxE"}],"label":"demo-newton-line-matlab","identifier":"demo-newton-line-matlab","html_id":"demo-newton-line-matlab","key":"eXGj58XxcZ"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-newton-converge","label":"demo-newton-converge","kind":"proof:example","position":{"start":{"line":375,"column":1},"end":{"line":375,"column":22}},"children":[{"type":"text","value":"Example ","key":"Y30XhC5uK5"},{"type":"text","value":"4.3.2","key":"Dg4KJyxfBo"}],"template":"Example %s","enumerator":"4.3.2","resolved":true,"html_id":"demo-newton-converge","remote":true,"url":"/newton","dataUrl":"/newton.json","key":"CFZCAq32DO"}],"key":"pdWBFbj2tJ"},{"type":"paragraph","position":{"start":{"line":377,"column":1},"end":{"line":377,"column":1}},"children":[{"type":"text","value":"We again look at finding a solution of ","position":{"start":{"line":377,"column":1},"end":{"line":377,"column":1}},"key":"XAguiINGer"},{"type":"inlineMath","value":"x e^x=2","position":{"start":{"line":377,"column":1},"end":{"line":377,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><msup><mi>e</mi><mi>x</mi></msup><mo>=</mo><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">x e^x=2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6644em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span></span></span></span>","key":"LpoOZRrJQy"},{"type":"text","value":" near ","position":{"start":{"line":377,"column":1},"end":{"line":377,"column":1}},"key":"uEAqKDJbIX"},{"type":"inlineMath","value":"x=1","position":{"start":{"line":377,"column":1},"end":{"line":377,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">x=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"vDb2tgqpVr"},{"type":"text","value":". To apply Newton’s method, we need to calculate values of both the residual function ","position":{"start":{"line":377,"column":1},"end":{"line":377,"column":1}},"key":"LyJyrzbRJQ"},{"type":"inlineMath","value":"f","position":{"start":{"line":377,"column":1},"end":{"line":377,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>","key":"n7LvZwwGXK"},{"type":"text","value":" and its derivative.","position":{"start":{"line":377,"column":1},"end":{"line":377,"column":1}},"key":"DoF6xCxuMS"}],"key":"YErp8c3rCu"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"f = @(x) x.*exp(x) - 2;\ndf_dx = @(x) exp(x).*(x+1);","key":"w3U3GuUNoX"},{"type":"output","id":"nEml_-wz2yjALvh6A06Xy","data":[],"key":"X9sutXi5mP"}],"key":"HY3ZdS6BwP"},{"type":"paragraph","position":{"start":{"line":384,"column":1},"end":{"line":384,"column":1}},"children":[{"type":"text","value":"We don’t know the exact root, so we use ","position":{"start":{"line":384,"column":1},"end":{"line":384,"column":1}},"key":"CIP6gfjVuc"},{"type":"inlineCode","value":"nlsolve","position":{"start":{"line":384,"column":1},"end":{"line":384,"column":1}},"key":"XrLy8P6F5R"},{"type":"text","value":" to determine a proxy for it.","position":{"start":{"line":384,"column":1},"end":{"line":384,"column":1}},"key":"gGf59GMPkz"}],"key":"YYZGC6tG4w"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"format long,  r = fzero(f,1)","key":"fuEUBrFKQU"},{"type":"output","id":"7VCJbWvLpqFWMTFyuHbBn","data":[{"output_type":"execute_result","execution_count":34,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>r = \n   0.852605502013726\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"r = \n   0.852605502013726\n","content_type":"text/plain"}}}],"key":"AS9rGqXI5f"}],"key":"tpljq5hwmt"},{"type":"paragraph","position":{"start":{"line":390,"column":1},"end":{"line":390,"column":1}},"children":[{"type":"text","value":"We use ","position":{"start":{"line":390,"column":1},"end":{"line":390,"column":1}},"key":"ARfkXNKQNx"},{"type":"inlineMath","value":"x_1=1","position":{"start":{"line":390,"column":1},"end":{"line":390,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">x_1=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"Xj4StufKQp"},{"type":"text","value":" as a starting guess and apply the iteration in a loop, storing the sequence of iterates in a vector.","position":{"start":{"line":390,"column":1},"end":{"line":390,"column":1}},"key":"yW7dLXAYHT"}],"key":"kdVxwpxlWK"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"x = 1;\nfor k = 1:6\n    x(k+1) = x(k) - f(x(k)) / df_dx(x(k));\nend\nx","key":"RGTUwodKSi"},{"type":"output","id":"69-WZlEEfcnEjNxeCCTIa","data":[{"output_type":"execute_result","execution_count":35,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>x = 1×7 double\n   1.000000000000000   0.867879441171442   0.852783373416410   0.852605526368922   0.852605502013726   0.852605502013725   0.852605502013725\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"x = 1×7 double\n   1.000000000000000   0.867879441171442   0.852783373416410   0.852605526368922   0.852605502013726   0.852605502013725   0.852605502013725\n","content_type":"text/plain"}}}],"key":"W5KMCTMsjE"}],"key":"mKUcVkV67x"},{"type":"paragraph","position":{"start":{"line":400,"column":1},"end":{"line":400,"column":1}},"children":[{"type":"text","value":"Here is the sequence of errors.","position":{"start":{"line":400,"column":1},"end":{"line":400,"column":1}},"key":"yF01hmOOWt"}],"key":"RrLi32rkte"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"format short e\nerr = x' - r","key":"L434xDMNVg"},{"type":"output","id":"llyK_imoLbuXKzZBsVsSs","data":[{"output_type":"execute_result","execution_count":36,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>err = 7×1 double\n   1.4739e-01\n   1.5274e-02\n   1.7787e-04\n   2.4355e-08\n   4.4409e-16\n  -1.1102e-16\n  -1.1102e-16\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"err = 7×1 double\n   1.4739e-01\n   1.5274e-02\n   1.7787e-04\n   2.4355e-08\n   4.4409e-16\n  -1.1102e-16\n  -1.1102e-16\n","content_type":"text/plain"}}}],"key":"qRR774vLOT"}],"key":"VKH9wHWW1J"},{"type":"paragraph","position":{"start":{"line":407,"column":1},"end":{"line":407,"column":1}},"children":[{"type":"text","value":"The exponents in the scientific notation definitely suggest a squaring sequence. We can check the evolution of the ratio in ","position":{"start":{"line":407,"column":1},"end":{"line":407,"column":1}},"key":"rtQS1MgBEf"},{"type":"crossReference","kind":"equation","identifier":"quadratictest","label":"quadratictest","children":[{"type":"text","value":"(","key":"pMS1dunjqj"},{"type":"text","value":"4.3.9","key":"PWoqSan2Jf"},{"type":"text","value":")","key":"Sj37vJjkzi"}],"template":"(%s)","enumerator":"4.3.9","resolved":true,"html_id":"quadratictest","remote":true,"url":"/newton","dataUrl":"/newton.json","key":"goMlhlDxuU"},{"type":"text","value":".","position":{"start":{"line":407,"column":1},"end":{"line":407,"column":1}},"key":"FOtLtWvQpk"}],"key":"XlzoK3qfaa"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"format short\nlogerr = log(abs(err))","key":"ptqYAGXBFG"},{"type":"output","id":"qV4kkbNo5OPwJPv8eE2J8","data":[{"output_type":"execute_result","execution_count":37,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>logerr = 7×1 double\n   -1.9146\n   -4.1816\n   -8.6344\n  -17.5305\n  -35.3505\n  -36.7368\n  -36.7368\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"logerr = 7×1 double\n   -1.9146\n   -4.1816\n   -8.6344\n  -17.5305\n  -35.3505\n  -36.7368\n  -36.7368\n","content_type":"text/plain"}}}],"key":"uN1vfomtQQ"}],"key":"AtXbLcQv3J"},{"type":"paragraph","position":{"start":{"line":414,"column":1},"end":{"line":414,"column":1}},"children":[{"type":"text","value":"The clear convergence to 2 above constitutes good evidence of quadratic convergence.","position":{"start":{"line":414,"column":1},"end":{"line":414,"column":1}},"key":"e8kSkHiR2i"}],"key":"CChzLrBZ3Y"}],"label":"demo-newton-converge-matlab","identifier":"demo-newton-converge-matlab","html_id":"demo-newton-converge-matlab","key":"JJCfsOzyID"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-newton-usage","label":"demo-newton-usage","kind":"proof:example","position":{"start":{"line":418,"column":1},"end":{"line":418,"column":19}},"children":[{"type":"text","value":"Example ","key":"Ys6vmQcpEC"},{"type":"text","value":"4.3.3","key":"FRMu3TsSnV"}],"template":"Example %s","enumerator":"4.3.3","resolved":true,"html_id":"demo-newton-usage","remote":true,"url":"/newton","dataUrl":"/newton.json","key":"S9A3bpCwQ5"}],"key":"gZdojsYaIv"},{"type":"paragraph","position":{"start":{"line":423,"column":1},"end":{"line":423,"column":1}},"children":[{"type":"text","value":"Suppose we want to evaluate the inverse of the function ","position":{"start":{"line":423,"column":1},"end":{"line":423,"column":1}},"key":"LCRErLjIeL"},{"type":"inlineMath","value":"h(x)=e^x-x","position":{"start":{"line":423,"column":1},"end":{"line":423,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>h</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msup><mi>e</mi><mi>x</mi></msup><mo>−</mo><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">h(x)=e^x-x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">h</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7477em;vertical-align:-0.0833em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"lc3ZWiERyH"},{"type":"text","value":". This means solving ","position":{"start":{"line":423,"column":1},"end":{"line":423,"column":1}},"key":"YbKlhDWhbV"},{"type":"inlineMath","value":"y=e^x-x","position":{"start":{"line":423,"column":1},"end":{"line":423,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi><mo>=</mo><msup><mi>e</mi><mi>x</mi></msup><mo>−</mo><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">y=e^x-x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7477em;vertical-align:-0.0833em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"POaRpdV86L"},{"type":"text","value":" for ","position":{"start":{"line":423,"column":1},"end":{"line":423,"column":1}},"key":"fFInRhUBbG"},{"type":"inlineMath","value":"x","position":{"start":{"line":423,"column":1},"end":{"line":423,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"hy8M9jwA1Z"},{"type":"text","value":" when ","position":{"start":{"line":423,"column":1},"end":{"line":423,"column":1}},"key":"lJPdgFeCT2"},{"type":"inlineMath","value":"y","position":{"start":{"line":423,"column":1},"end":{"line":423,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>","key":"NNTDP8spck"},{"type":"text","value":" is given, which has no elementary form. If a value of ","position":{"start":{"line":423,"column":1},"end":{"line":423,"column":1}},"key":"CoR6Tva8Pd"},{"type":"inlineMath","value":"y","position":{"start":{"line":423,"column":1},"end":{"line":423,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>","key":"tBv1kOSjBP"},{"type":"text","value":" is given numerically, though, we simply have a rootfinding problem for ","position":{"start":{"line":423,"column":1},"end":{"line":423,"column":1}},"key":"e1iYPXYNCw"},{"type":"inlineMath","value":"f(x)=e^x-x-y","position":{"start":{"line":423,"column":1},"end":{"line":423,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msup><mi>e</mi><mi>x</mi></msup><mo>−</mo><mi>x</mi><mo>−</mo><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">f(x)=e^x-x-y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7477em;vertical-align:-0.0833em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>","key":"fGaO9ziKJQ"},{"type":"text","value":".","position":{"start":{"line":423,"column":1},"end":{"line":423,"column":1}},"key":"kcuk62lDTy"}],"indexEntries":[{"entry":"Julia","subEntry":{"value":"enumerate","kind":"entry"},"emphasis":true}],"label":"index-NEmgPzG4Mu","identifier":"index-nemgpzg4mu","html_id":"index-nemgpzg4mu","key":"UwIZTdMzW6"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"gr7L644vvC"}],"key":"f6XIex3gfW"},{"type":"paragraph","position":{"start":{"line":426,"column":1},"end":{"line":426,"column":1}},"children":[{"type":"text","value":"When a function is created, it can refer to any variables in scope at that moment. Those values are locked in to the definition, which is called a ","position":{"start":{"line":426,"column":1},"end":{"line":426,"column":1}},"key":"Gc2mzZ8UJD"},{"type":"emphasis","position":{"start":{"line":426,"column":1},"end":{"line":426,"column":1}},"children":[{"type":"text","value":"closure","position":{"start":{"line":426,"column":1},"end":{"line":426,"column":1}},"key":"yxsdiZ1okf"}],"key":"X3ZQTa17Fv"},{"type":"text","value":". If the enclosed variables change values later, the function still uses the values it was created with.","position":{"start":{"line":426,"column":1},"end":{"line":426,"column":1}},"key":"n34N5MpGlS"}],"key":"OyHIbIUYp0"}],"class":"dropdown","key":"FeP15WyPdw"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"h = @(x) exp(x) - x;\ndh_dx = @(x) exp(x) - 1;\ny_ = linspace(h(0), h(2), 200);\nx_ = zeros(size(y_));\nfor i = 1:length(y_)\n    f = @(x) h(x) - y_(i);\n    df_dx = @(x) dh_dx(x);\n    x = newton(f, df_dx, 1);  x_(i) = x(end);\nend","key":"S8g5TrhNGt"},{"type":"output","id":"xoQeKV2PgzBCgoDyDYxTw","data":[],"key":"o8zdz43DCN"}],"key":"GrnlW3YZOO"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf, fplot(h, [0, 2])\nhold on, axis equal\nplot(y_, x_)\nplot([0, max(y_)], [0, max(y_)], 'k--')\nxlabel('x'), ylabel('y')\nlegend('h(x)', 'inverse', 'y=x');","visibility":"hide","key":"BTNiWvJnDT"},{"type":"output","id":"OfsYobTzfHsf3pIX7GDne","data":[{"output_type":"execute_result","execution_count":39,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"102055311e18fa320f980252add2bd81","path":"/build/102055311e18fa320f980252add2bd81.png"}}}],"visibility":"show","key":"OrTA45L9wu"}],"data":{"tags":[]},"visibility":"show","key":"Lk572yyD1G"}],"label":"demo-newton-usage-matlab","identifier":"demo-newton-usage-matlab","html_id":"demo-newton-usage-matlab","key":"v0pW7bqW7d"},{"type":"heading","depth":3,"position":{"start":{"line":452,"column":1},"end":{"line":452,"column":1}},"children":[{"type":"text","value":"4.4 ","position":{"start":{"line":452,"column":1},"end":{"line":452,"column":1}},"key":"CD4E3Zv9fw"},{"type":"link","identifier":"section-nonlineqn-secant","label":"section-nonlineqn-secant","kind":"narrative","position":{"start":{"line":452,"column":5},"end":{"line":452,"column":30}},"url":"/secant","internal":true,"dataUrl":"/secant.json","children":[{"type":"text","value":"Interpolation-based methods","key":"B8HP1CYLlm"}],"key":"USlzcVFm8Y"}],"identifier":"id-4-4","label":"4.4 ","html_id":"id-4-4","implicit":true,"key":"x5hrvSZhUm"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-secant-line","label":"demo-secant-line","kind":"proof:example","position":{"start":{"line":455,"column":1},"end":{"line":455,"column":18}},"children":[{"type":"text","value":"Example ","key":"AiNkIBGjjp"},{"type":"text","value":"4.4.1","key":"XdUWdwMHvX"}],"template":"Example %s","enumerator":"4.4.1","resolved":true,"html_id":"demo-secant-line","remote":true,"url":"/secant","dataUrl":"/secant.json","key":"kDx11u7BoE"}],"key":"PocHRdqm1t"},{"type":"paragraph","position":{"start":{"line":459,"column":1},"end":{"line":459,"column":1}},"children":[{"type":"text","value":"We return to finding a root of the equation ","position":{"start":{"line":459,"column":1},"end":{"line":459,"column":1}},"key":"hcpoBodHaB"},{"type":"inlineMath","value":"x e^x=2","position":{"start":{"line":459,"column":1},"end":{"line":459,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><msup><mi>e</mi><mi>x</mi></msup><mo>=</mo><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">x e^x=2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6644em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span></span></span></span>","key":"r3zUEwx5Fb"},{"type":"text","value":".","position":{"start":{"line":459,"column":1},"end":{"line":459,"column":1}},"key":"sQmFSCtyYY"}],"key":"iajcatCqse"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"f = @(x) x .* exp(x) - 2;\nclf, fplot(f, [0.25, 1.25])\nset(gca, 'ygrid', 'on')  \nxlabel('x'), ylabel('y')    \ntitle('Objective function')","key":"LuUPmYAjmz"},{"type":"output","id":"MjhFkgASHKKLwCQxYnI7Z","data":[{"output_type":"execute_result","execution_count":40,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"f25a0a2e3808faf71209f2fd607a7d1d","path":"/build/f25a0a2e3808faf71209f2fd607a7d1d.png"}}}],"key":"Wc2BLbiLlF"}],"key":"brpj67f2ds"},{"type":"paragraph","position":{"start":{"line":469,"column":1},"end":{"line":469,"column":1}},"children":[{"type":"text","value":"From the graph, it’s clear that there is a root near ","position":{"start":{"line":469,"column":1},"end":{"line":469,"column":1}},"key":"RGY9U8Q35R"},{"type":"inlineMath","value":"x=1","position":{"start":{"line":469,"column":1},"end":{"line":469,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">x=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"NrTvaNt9Hg"},{"type":"text","value":". To be more precise, there is a root in the interval ","position":{"start":{"line":469,"column":1},"end":{"line":469,"column":1}},"key":"ju0kqL4JJ6"},{"type":"inlineMath","value":"[0.5,1]","position":{"start":{"line":469,"column":1},"end":{"line":469,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mn>0.5</mn><mo separator=\"true\">,</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[0.5,1]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">0.5</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]</span></span></span></span>","key":"mOhsGfcjQw"},{"type":"text","value":". So let us take the endpoints of that interval as ","position":{"start":{"line":469,"column":1},"end":{"line":469,"column":1}},"key":"F0KyfPIhAF"},{"type":"emphasis","position":{"start":{"line":469,"column":1},"end":{"line":469,"column":1}},"children":[{"type":"text","value":"two","position":{"start":{"line":469,"column":1},"end":{"line":469,"column":1}},"key":"XbTTB49t4a"}],"key":"l1EpHYsPjH"},{"type":"text","value":" initial approximations.","position":{"start":{"line":469,"column":1},"end":{"line":469,"column":1}},"key":"cWcFuwgs2n"}],"key":"XHzUAwX3iK"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"x1 = 1;    y1 = f(x1);\nx2 = 0.5;  y2 = f(x2);\nhold on, scatter([x1, x2], [y1, y2])\ntitle('Two initial values')","key":"xItZDXSO9L"},{"type":"output","id":"L6NtNN1KUbBBEhW3Kskln","data":[{"output_type":"execute_result","execution_count":41,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"27600963008c4c489bb9654a750a9f76","path":"/build/27600963008c4c489bb9654a750a9f76.png"}}}],"key":"NjgrCYvbTU"}],"key":"hgsa72OVu2"},{"type":"paragraph","position":{"start":{"line":478,"column":1},"end":{"line":478,"column":1}},"children":[{"type":"text","value":"Instead of constructing the tangent line by evaluating the derivative, we can construct a linear model function by drawing the line between the two points ","position":{"start":{"line":478,"column":1},"end":{"line":478,"column":1}},"key":"msRLxh1St8"},{"type":"inlineMath","value":"\\bigl(x_1,f(x_1)\\bigr)","position":{"start":{"line":478,"column":1},"end":{"line":478,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo fence=\"true\" stretchy=\"true\" minsize=\"1.2em\" maxsize=\"1.2em\">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><mi>f</mi><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy=\"false\">)</mo><mo fence=\"true\" stretchy=\"true\" minsize=\"1.2em\" maxsize=\"1.2em\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\bigl(x_1,f(x_1)\\bigr)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.2em;vertical-align:-0.35em;\"></span><span class=\"mopen\"><span class=\"delimsizing size1\">(</span></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mclose\"><span class=\"delimsizing size1\">)</span></span></span></span></span>","key":"FcFxkKPIuR"},{"type":"text","value":" and ","position":{"start":{"line":478,"column":1},"end":{"line":478,"column":1}},"key":"sprOoWh7aS"},{"type":"inlineMath","value":"\\bigl(x_2,f(x_2)\\bigr)","position":{"start":{"line":478,"column":1},"end":{"line":478,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo fence=\"true\" stretchy=\"true\" minsize=\"1.2em\" maxsize=\"1.2em\">(</mo><msub><mi>x</mi><mn>2</mn></msub><mo separator=\"true\">,</mo><mi>f</mi><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mn>2</mn></msub><mo stretchy=\"false\">)</mo><mo fence=\"true\" stretchy=\"true\" minsize=\"1.2em\" maxsize=\"1.2em\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\bigl(x_2,f(x_2)\\bigr)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.2em;vertical-align:-0.35em;\"></span><span class=\"mopen\"><span class=\"delimsizing size1\">(</span></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mclose\"><span class=\"delimsizing size1\">)</span></span></span></span></span>","key":"ZXvkcoGWS0"},{"type":"text","value":". This is called a ","position":{"start":{"line":478,"column":1},"end":{"line":478,"column":1}},"key":"YHcfQ9ioMd"},{"type":"emphasis","position":{"start":{"line":478,"column":1},"end":{"line":478,"column":1}},"children":[{"type":"text","value":"secant line","position":{"start":{"line":478,"column":1},"end":{"line":478,"column":1}},"key":"xEXG3CxfLY"}],"key":"FS1H1HPX2w"},{"type":"text","value":".","position":{"start":{"line":478,"column":1},"end":{"line":478,"column":1}},"key":"UQg8013w9O"}],"key":"iY1Scyddso"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"slope2 = (y2 - y1) / (x2 - x1);\nsecant2 = @(x) y2 + slope2 * (x - x2);","key":"vPD14Rkhet"},{"type":"output","id":"Vggp5USFQt-2VinkUzfY9","data":[],"key":"N0JsJDiVaG"}],"key":"Yc1JyqVUuV"},{"type":"paragraph","position":{"start":{"line":485,"column":1},"end":{"line":485,"column":1}},"children":[{"type":"text","value":"As before, the next root estimate in the iteration is the root of this linear model.","position":{"start":{"line":485,"column":1},"end":{"line":485,"column":1}},"key":"ikYCCqMFZj"}],"key":"yc9f5r8x0T"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"fplot(secant2,[0.25, 1.25],'k--')\nx3 = x2 - y2 / slope2;\ny3 = f(x3)\nscatter(x3, 0)\ntitle('Next value')","key":"FCgyAax90i"},{"type":"output","id":"S7GwiXuSHQaMt9AClhKvg","data":[{"output_type":"execute_result","execution_count":43,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"123671bb6ee46ba89c385eeef6a1700a","path":"/build/123671bb6ee46ba89c385eeef6a1700a.png"}}},{"output_type":"execute_result","execution_count":43,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>y3 = -0.1777</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"y3 = -0.1777","content_type":"text/plain"}}}],"key":"sWA3958oyl"}],"key":"KSxXSWqLN3"},{"type":"paragraph","position":{"start":{"line":495,"column":1},"end":{"line":495,"column":1}},"children":[{"type":"text","value":"For the next linear model, we use the line through the two most recent points. The next iterate is the root of that secant line, and so on.","position":{"start":{"line":495,"column":1},"end":{"line":495,"column":1}},"key":"bAZBE2RWjD"}],"key":"eU6XZy988b"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"slope2 = (y3 - y2) / (x3 - x2);\nx4 = x3 - y3 / slope2;\ny4 = f(x4)","key":"IHKIavWqIK"},{"type":"output","id":"3E_czUXo9cIkIj90FP6QK","data":[{"output_type":"execute_result","execution_count":44,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>y4 = 0.0572</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"y4 = 0.0572","content_type":"text/plain"}}}],"key":"Ri8YXq4TYH"}],"key":"Iawt5Rm34P"}],"label":"demo-secant-line-matlab","identifier":"demo-secant-line-matlab","html_id":"demo-secant-line-matlab","key":"bz75B2kFnH"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-secant-converge","label":"demo-secant-converge","kind":"proof:example","position":{"start":{"line":505,"column":1},"end":{"line":505,"column":22}},"children":[{"type":"text","value":"Example ","key":"DZcZ7ajXar"},{"type":"text","value":"4.4.2","key":"xqYQ4Unalx"}],"template":"Example %s","enumerator":"4.4.2","resolved":true,"html_id":"demo-secant-converge","remote":true,"url":"/secant","dataUrl":"/secant.json","key":"qLOmH19Cyf"}],"key":"SjXFI2DKYq"},{"type":"paragraph","position":{"start":{"line":507,"column":1},"end":{"line":507,"column":1}},"children":[{"type":"text","value":"We check the convergence of the secant method from ","position":{"start":{"line":507,"column":1},"end":{"line":507,"column":1}},"key":"VHcCf5sKJq"},{"type":"crossReference","identifier":"demo-secant-line","label":"demo-secant-line","kind":"proof:example","position":{"start":{"line":507,"column":52},"end":{"line":507,"column":69}},"children":[{"type":"text","value":"Example ","key":"ALh5hcUHk0"},{"type":"text","value":"4.4.1","key":"HmAHiC5oyq"}],"template":"Example %s","enumerator":"4.4.1","resolved":true,"html_id":"demo-secant-line","remote":true,"url":"/secant","dataUrl":"/secant.json","key":"XZwgUdr6ns"},{"type":"text","value":".","position":{"start":{"line":507,"column":1},"end":{"line":507,"column":1}},"key":"FtIhC17HCg"}],"key":"ngAu5ENPUS"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"f = @(x) x .* exp(x) - 2;\nx = secant(f, 1, 0.5);","key":"wNP4W5HA3X"},{"type":"output","id":"PE44Ukgs_OtUqObwbPUL5","data":[],"key":"otU0QR4c0s"}],"key":"YEQUni8ghl"},{"type":"paragraph","position":{"start":{"line":514,"column":1},"end":{"line":514,"column":1}},"children":[{"type":"text","value":"We don’t know the exact root, so we use ","position":{"start":{"line":514,"column":1},"end":{"line":514,"column":1}},"key":"N6pywbgkqo"},{"type":"inlineCode","value":"fzero","position":{"start":{"line":514,"column":1},"end":{"line":514,"column":1}},"key":"zfh4jaOkcj"},{"type":"text","value":" to get a good proxy.","position":{"start":{"line":514,"column":1},"end":{"line":514,"column":1}},"key":"g5zm3W2IzZ"}],"key":"nNUFKWwkgh"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"r = fzero(f, 1);","key":"zujS2jHC55"},{"type":"output","id":"HrdzEP1kOippJRMBYZpzP","data":[],"key":"a8J5phiOZL"}],"key":"UhGqnL2t6N"},{"type":"paragraph","position":{"start":{"line":520,"column":1},"end":{"line":520,"column":1}},"children":[{"type":"text","value":"Here is the sequence of errors.","position":{"start":{"line":520,"column":1},"end":{"line":520,"column":1}},"key":"LKqhoBTibV"}],"key":"pOwXn1snVf"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"format short e\nerr = r - x(1:end-1)'","key":"xQerSV5xLE"},{"type":"output","id":"xgfInOhPaq3rYHVJoORdg","data":[{"output_type":"execute_result","execution_count":47,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>err = 7×1 double\n  -1.4739e-01\n   3.5261e-01\n   4.2234e-02\n  -1.3026e-02\n   4.2748e-04\n   4.2699e-06\n  -1.4055e-09\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"err = 7×1 double\n  -1.4739e-01\n   3.5261e-01\n   4.2234e-02\n  -1.3026e-02\n   4.2748e-04\n   4.2699e-06\n  -1.4055e-09\n","content_type":"text/plain"}}}],"key":"roblT7OD5Y"}],"key":"mU6qAkHcu8"},{"type":"paragraph","position":{"start":{"line":527,"column":1},"end":{"line":527,"column":1}},"children":[{"type":"text","value":"It’s not easy to see the convergence rate by staring at these numbers. We can use ","position":{"start":{"line":527,"column":1},"end":{"line":527,"column":1}},"key":"a2ILZ4sbSD"},{"type":"crossReference","kind":"equation","identifier":"superlinear-rate","label":"superlinear-rate","children":[{"type":"text","value":"(","key":"GBeIriygtW"},{"type":"text","value":"4.4.8","key":"RpkT2nuafU"},{"type":"text","value":")","key":"tMvvRF1GVT"}],"template":"(%s)","enumerator":"4.4.8","resolved":true,"html_id":"superlinear-rate","remote":true,"url":"/secant","dataUrl":"/secant.json","key":"LFvadM1ASv"},{"type":"text","value":" to try to expose the superlinear convergence rate.","position":{"start":{"line":527,"column":1},"end":{"line":527,"column":1}},"key":"RzeWwtVX1R"}],"key":"tIdP4zuOOg"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"logerr = log(abs(err));\nratios = logerr(2:end) ./ logerr(1:end-1)","key":"H5Yh83XTvq"},{"type":"output","id":"ZcKH7-opUITgw8ho5Bay2","data":[{"output_type":"execute_result","execution_count":48,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ratios = 6×1 double\n   5.4444e-01\n   3.0358e+00\n   1.3717e+00\n   1.7871e+00\n   1.5938e+00\n   1.6486e+00\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ratios = 6×1 double\n   5.4444e-01\n   3.0358e+00\n   1.3717e+00\n   1.7871e+00\n   1.5938e+00\n   1.6486e+00\n","content_type":"text/plain"}}}],"key":"eXdNTIyKBg"}],"key":"gjyXROkZZ9"},{"type":"paragraph","position":{"start":{"line":534,"column":1},"end":{"line":534,"column":1}},"children":[{"type":"text","value":"As expected, this settles in at around 1.618.","position":{"start":{"line":534,"column":1},"end":{"line":534,"column":1}},"key":"N7pFE38S0p"}],"key":"q0IEIsGWIT"}],"label":"demo-secant-converge-matlab","identifier":"demo-secant-converge-matlab","html_id":"demo-secant-converge-matlab","key":"c8xpiSf2Lu"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-secant-iqi","label":"demo-secant-iqi","kind":"proof:example","position":{"start":{"line":538,"column":1},"end":{"line":538,"column":17}},"children":[{"type":"text","value":"Example ","key":"rlsYMsJLh2"},{"type":"text","value":"4.4.3","key":"r6D9kfTTd0"}],"template":"Example %s","enumerator":"4.4.3","resolved":true,"html_id":"demo-secant-iqi","remote":true,"url":"/secant","dataUrl":"/secant.json","key":"Zkqa9xjgzW"}],"key":"G4xxZ3Gu2o"},{"type":"paragraph","position":{"start":{"line":540,"column":1},"end":{"line":540,"column":1}},"children":[{"type":"text","value":"Here we look for a root of ","position":{"start":{"line":540,"column":1},"end":{"line":540,"column":1}},"key":"mPNRiYIVG6"},{"type":"inlineMath","value":"x+\\cos(10x)","position":{"start":{"line":540,"column":1},"end":{"line":540,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mo>+</mo><mi>cos</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mn>10</mn><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">x+\\cos(10x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop\">cos</span><span class=\"mopen\">(</span><span class=\"mord\">10</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span>","key":"Brgrq18KcF"},{"type":"text","value":" that is close to 1.","position":{"start":{"line":540,"column":1},"end":{"line":540,"column":1}},"key":"DikHfhJVFH"}],"key":"ralLp3tBSa"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"f = @(x) x + cos(10 * x);\ninterval = [0.5, 1.5];\nclf, fplot(f, interval)\nset(gca, 'ygrid', 'on'), axis(axis)   \ntitle('Objective function')    \nxlabel('x'), ylabel('y')    \nr = fzero(f, 1)","key":"BDsinRe17g"},{"type":"output","id":"TxoYzc_4WjkMLTdwgjDq4","data":[{"output_type":"execute_result","execution_count":49,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"9a7ea71e8db97370f2e219e3a3ca533e","path":"/build/9a7ea71e8db97370f2e219e3a3ca533e.png"}}},{"output_type":"execute_result","execution_count":49,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>r = \n   9.6789e-01\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"r = \n   9.6789e-01\n","content_type":"text/plain"}}}],"key":"ph82lg4y6S"}],"key":"K8rztlGxnS"},{"type":"paragraph","position":{"start":{"line":552,"column":1},"end":{"line":552,"column":1}},"children":[{"type":"text","value":"We choose three values to get the iteration started.","position":{"start":{"line":552,"column":1},"end":{"line":552,"column":1}},"key":"kTHCSmwQeF"}],"key":"rYzSYC1f5X"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"x = [0.8, 1.2, 1]';\ny = f(x);\nhold on, scatter(x, y)\ntitle('Three initial points')","key":"j4eu75r7cc"},{"type":"output","id":"7Q3bRXmqfrHjlhGqDNjCg","data":[{"output_type":"execute_result","execution_count":50,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"d7c97abffc26d02231476f5ce0ef0fc8","path":"/build/d7c97abffc26d02231476f5ce0ef0fc8.png"}}}],"key":"RWSIn2wNH0"}],"key":"jhbuiMapiJ"},{"type":"paragraph","position":{"start":{"line":561,"column":1},"end":{"line":561,"column":1}},"children":[{"type":"text","value":"If we were using forward interpolation, we would ask for the polynomial interpolant of ","position":{"start":{"line":561,"column":1},"end":{"line":561,"column":1}},"key":"BKdTAIj2PO"},{"type":"inlineMath","value":"y","position":{"start":{"line":561,"column":1},"end":{"line":561,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>","key":"n9HPxHE978"},{"type":"text","value":" as a function of ","position":{"start":{"line":561,"column":1},"end":{"line":561,"column":1}},"key":"DSMOpFBOpX"},{"type":"inlineMath","value":"x","position":{"start":{"line":561,"column":1},"end":{"line":561,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"KL0u1BkN2h"},{"type":"text","value":". But that parabola has no real roots.","position":{"start":{"line":561,"column":1},"end":{"line":561,"column":1}},"key":"glBSwozdBv"}],"key":"hukI0NPqYy"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"c = polyfit(x, y, 2);    % coefficients of interpolant\nq = @(x) polyval(c, x);\nfplot(q, interval, '--')\ntitle('Parabola model')","key":"VIFK6LSp2C"},{"type":"output","id":"lGYR7qSyxOUqnc-co3Lpo","data":[{"output_type":"execute_result","execution_count":51,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"77477539d100b8f557c232282abb7c43","path":"/build/77477539d100b8f557c232282abb7c43.png"}}}],"key":"xWea2GMibI"}],"key":"hZuyH9NA7s"},{"type":"paragraph","position":{"start":{"line":570,"column":1},"end":{"line":570,"column":1}},"children":[{"type":"text","value":"To do inverse interpolation, we swap the roles of ","position":{"start":{"line":570,"column":1},"end":{"line":570,"column":1}},"key":"lxmClHhgo3"},{"type":"inlineMath","value":"x","position":{"start":{"line":570,"column":1},"end":{"line":570,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"Hblaj9h1Ji"},{"type":"text","value":" and ","position":{"start":{"line":570,"column":1},"end":{"line":570,"column":1}},"key":"MMp8xlGIKq"},{"type":"inlineMath","value":"y","position":{"start":{"line":570,"column":1},"end":{"line":570,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>","key":"u8gmjTYvZG"},{"type":"text","value":" in the interpolation.","position":{"start":{"line":570,"column":1},"end":{"line":570,"column":1}},"key":"MkHRtYiY5r"}],"key":"vCpi38iQFD"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"dyvqk82hwK"}],"key":"LR0jKrSvUB"},{"type":"paragraph","position":{"start":{"line":574,"column":1},"end":{"line":574,"column":1}},"children":[{"type":"text","value":"By giving two functions in the ","position":{"start":{"line":574,"column":1},"end":{"line":574,"column":1}},"key":"r7IOIigxhB"},{"type":"inlineCode","value":"fplot","position":{"start":{"line":574,"column":1},"end":{"line":574,"column":1}},"key":"wnxEjob6G0"},{"type":"text","value":" call, we get the parametric plot ","position":{"start":{"line":574,"column":1},"end":{"line":574,"column":1}},"key":"Rjojqbt1gz"},{"type":"inlineMath","value":"(q(y),y)","position":{"start":{"line":574,"column":1},"end":{"line":574,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>q</mi><mo stretchy=\"false\">(</mo><mi>y</mi><mo stretchy=\"false\">)</mo><mo separator=\"true\">,</mo><mi>y</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(q(y),y)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span></span></span></span>","key":"KbTDqd6sdr"},{"type":"text","value":" as a function of ","position":{"start":{"line":574,"column":1},"end":{"line":574,"column":1}},"key":"SghPOl2km2"},{"type":"inlineMath","value":"y","position":{"start":{"line":574,"column":1},"end":{"line":574,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>","key":"mYNDUYRKLx"},{"type":"text","value":".","position":{"start":{"line":574,"column":1},"end":{"line":574,"column":1}},"key":"mtAAsxEwYo"}],"key":"Q5dgq8sjnV"}],"class":"dropdown","key":"rCLkQawHU6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"cla, fplot(f, interval)\nscatter(x, y)     \nc = polyfit(y, x, 2);    % coefficients of interpolating polynomial\nq = @(y) polyval(c, y);\nfplot(q, @(y) y, ylim,'--')    % plot x=q(y), y=y\ntitle('Sideways parabola')","key":"cyeqRilb97"},{"type":"output","id":"_kAhSE1_iOpx5vWo9-0TS","data":[{"output_type":"execute_result","execution_count":52,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"ed64194fb98df5a41961aab2ae3f8af1","path":"/build/ed64194fb98df5a41961aab2ae3f8af1.png"}}}],"key":"RVbrOhPaT8"}],"key":"cG71XasOBe"},{"type":"paragraph","position":{"start":{"line":586,"column":1},"end":{"line":586,"column":1}},"children":[{"type":"text","value":"We seek the value of ","position":{"start":{"line":586,"column":1},"end":{"line":586,"column":1}},"key":"g47qZ5K5to"},{"type":"inlineMath","value":"x","position":{"start":{"line":586,"column":1},"end":{"line":586,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"gnPYow6aUX"},{"type":"text","value":" that makes ","position":{"start":{"line":586,"column":1},"end":{"line":586,"column":1}},"key":"WNH62Q2CSq"},{"type":"inlineMath","value":"y","position":{"start":{"line":586,"column":1},"end":{"line":586,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>","key":"yagj3l07rE"},{"type":"text","value":" zero. This means evaluating ","position":{"start":{"line":586,"column":1},"end":{"line":586,"column":1}},"key":"zqH26GvxqJ"},{"type":"inlineMath","value":"q","position":{"start":{"line":586,"column":1},"end":{"line":586,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>q</mi></mrow><annotation encoding=\"application/x-tex\">q</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span></span></span></span>","key":"hrn7wiFCpF"},{"type":"text","value":" at zero.","position":{"start":{"line":586,"column":1},"end":{"line":586,"column":1}},"key":"YPJ8c8Ixu2"}],"key":"SZHM5MfEDE"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"x = [x; q(0)];\ny = [y; f(x(end))]","key":"rVoAncv0ur"},{"type":"output","id":"vdzETm_A2ofW5GS6UYZNA","data":[{"output_type":"execute_result","execution_count":53,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>y = 4×1 double\n   6.5450e-01\n   2.0439e+00\n   1.6093e-01\n   1.1482e+00\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"y = 4×1 double\n   6.5450e-01\n   2.0439e+00\n   1.6093e-01\n   1.1482e+00\n","content_type":"text/plain"}}}],"key":"YJe3w2dlVM"}],"key":"meuwLaYnZN"},{"type":"paragraph","position":{"start":{"line":593,"column":1},"end":{"line":593,"column":1}},"children":[{"type":"text","value":"We repeat the process a few more times.","position":{"start":{"line":593,"column":1},"end":{"line":593,"column":1}},"key":"DP2Bdzda6M"}],"key":"uGFgbw7pRb"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"for k = 4:8\n    c = polyfit(y(k-2:k), x(k-2:k), 2);\n    x(k+1) = polyval(c, 0);\n    y(k+1) = f(x(k+1));\nend\ndisp('final residual:')\ny(end)","key":"RxZpXo7Wqr"},{"type":"output","id":"dJjYw-U6fW26pjKm_tUH2","data":[{"output_type":"stream","name":"stdout","text":"final residual:\n"},{"output_type":"execute_result","execution_count":54,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = \n   1.2084e-08\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = \n   1.2084e-08\n","content_type":"text/plain"}}}],"key":"K1i93QVwKO"}],"key":"dIBoCeZbyL"},{"type":"paragraph","position":{"start":{"line":605,"column":1},"end":{"line":605,"column":1}},"children":[{"type":"text","value":"Here is the sequence of errors.","position":{"start":{"line":605,"column":1},"end":{"line":605,"column":1}},"key":"qyil9wT4UN"}],"key":"EQvJmg07vW"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"format short e\nerr = x - r","key":"CRq8kKEq87"},{"type":"output","id":"F3Dowwg8pZUfpCcDmwV_w","data":[{"output_type":"execute_result","execution_count":55,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>err = 9×1 double\n  -1.6789e-01\n   2.3211e-01\n   3.2112e-02\n   1.3609e-01\n   1.5347e-02\n   3.2683e-03\n   4.6174e-04\n   6.2958e-06\n   3.4390e-09\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"err = 9×1 double\n  -1.6789e-01\n   2.3211e-01\n   3.2112e-02\n   1.3609e-01\n   1.5347e-02\n   3.2683e-03\n   4.6174e-04\n   6.2958e-06\n   3.4390e-09\n","content_type":"text/plain"}}}],"key":"PMxF9Hjr42"}],"key":"krYdpSerjv"},{"type":"paragraph","position":{"start":{"line":612,"column":1},"end":{"line":612,"column":1}},"children":[{"type":"text","value":"The convergence is probably superlinear:","position":{"start":{"line":612,"column":1},"end":{"line":612,"column":1}},"key":"RudVMM3B3P"}],"key":"lbWidwfStM"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"logerr = log(abs(err));\nratios = logerr(2:end) ./ logerr(1:end-1)","key":"VSat97bfxq"},{"type":"output","id":"ZFz9Pk-KQJgaTN9V1TQHO","data":[{"output_type":"execute_result","execution_count":56,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ratios = 8×1 double\n   8.1848e-01\n   2.3543e+00\n   5.8002e-01\n   2.0943e+00\n   1.3703e+00\n   1.3419e+00\n   1.5592e+00\n   1.6273e+00\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ratios = 8×1 double\n   8.1848e-01\n   2.3543e+00\n   5.8002e-01\n   2.0943e+00\n   1.3703e+00\n   1.3419e+00\n   1.5592e+00\n   1.6273e+00\n","content_type":"text/plain"}}}],"key":"wnWc5DM1Jp"}],"key":"rp5jnpThzi"}],"label":"demo-secant-iqi-matlab","identifier":"demo-secant-iqi-matlab","html_id":"demo-secant-iqi-matlab","key":"cf8CY0pJgh"},{"type":"heading","depth":3,"position":{"start":{"line":620,"column":1},"end":{"line":620,"column":1}},"children":[{"type":"text","value":"4.5 ","position":{"start":{"line":620,"column":1},"end":{"line":620,"column":1}},"key":"g9N3PbGnB6"},{"type":"link","identifier":"section-nonlineqn-newtonsys","label":"section-nonlineqn-newtonsys","kind":"narrative","position":{"start":{"line":620,"column":5},"end":{"line":620,"column":33}},"url":"/newtonsys","internal":true,"dataUrl":"/newtonsys.json","children":[{"type":"text","value":"Newton for nonlinear systems","key":"ajwiyiGn6n"}],"key":"Zljw2eS6KL"}],"identifier":"id-4-5","label":"4.5 ","html_id":"id-4-5","implicit":true,"key":"QSu8e2Ftx6"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-newtonsys-converge","label":"demo-newtonsys-converge","kind":"proof:example","position":{"start":{"line":622,"column":1},"end":{"line":622,"column":25}},"children":[{"type":"text","value":"Example ","key":"GuHse7aHTp"},{"type":"text","value":"4.5.3","key":"YF2lp9R9zB"}],"template":"Example %s","enumerator":"4.5.3","resolved":true,"html_id":"demo-newtonsys-converge","remote":true,"url":"/newtonsys","dataUrl":"/newtonsys.json","key":"JX75x4sDd5"}],"key":"nARWhgHeYP"},{"type":"paragraph","position":{"start":{"line":624,"column":1},"end":{"line":624,"column":1}},"children":[{"type":"text","value":"A system of nonlinear equations is defined by its residual and Jacobian.","position":{"start":{"line":624,"column":1},"end":{"line":624,"column":1}},"key":"OigsA2upOQ"}],"key":"NRHlrC2baN"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"fAhsu7Fqq1"}],"key":"tK1FLOaew9"},{"type":"paragraph","position":{"start":{"line":627,"column":1},"end":{"line":627,"column":1}},"children":[{"type":"text","value":"This function needs to be defined within a script file or in a file of its own with the ","position":{"start":{"line":627,"column":1},"end":{"line":627,"column":1}},"key":"NqC1mMqDJr"},{"type":"inlineCode","value":".m","position":{"start":{"line":627,"column":1},"end":{"line":627,"column":1}},"key":"KbdXlWyVpg"},{"type":"text","value":" extension.","position":{"start":{"line":627,"column":1},"end":{"line":627,"column":1}},"key":"buh7ltZsdL"}],"key":"UXiKP2o5TG"}],"class":"dropdown","key":"jBHfpFHUAT"},{"type":"include","file":"f45_nlsystem.m","literal":true,"children":[{"type":"code","value":"function [f, J] = nlsystem(x)\n    f = zeros(3, 1);   % ensure a column vector output\n    f(1) = exp(x(2) - x(1)) - 2;\n    f(2) = x(1) * x(2) + x(3);\n    f(3) = x(2) * x(3) + x(1)^2 - x(2);\n    J(1, :) = [-exp(x(2) - x(1)), exp(x(2) - x(1)), 0];\n    J(2, :) = [x(2), x(1), 1];\n    J(3, :) = [2 * x(1), x(3)-1, x(2)];\nend","lang":"matlab","filename":"f45_nlsystem.m","key":"JvJuVJn8SB"}],"key":"A22QFtIytf"},{"type":"paragraph","position":{"start":{"line":634,"column":1},"end":{"line":634,"column":1}},"children":[{"type":"text","value":"Since our system function is defined in an external file here, we need to use ","position":{"start":{"line":634,"column":1},"end":{"line":634,"column":1}},"key":"YSTqniAWmU"},{"type":"inlineCode","value":"@","position":{"start":{"line":634,"column":1},"end":{"line":634,"column":1}},"key":"kB2a2oAiCr"},{"type":"text","value":" in order to reference it as a function argument.","position":{"start":{"line":634,"column":1},"end":{"line":634,"column":1}},"key":"XNIvWLcyBd"}],"key":"J00W81WowF"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"nlsystem = @f45_nlsystem;\nx1 = [0; 0; 0];    % column vector!\nx = newtonsys(nlsystem, x1);\nnum_iter = size(x, 2)","key":"GY4G4mBr5P"},{"type":"output","id":"SREXNRU4su5rEKCX79F4a","data":[{"output_type":"execute_result","execution_count":57,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>num_iter = \n     7\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"num_iter = \n     7\n","content_type":"text/plain"}}}],"key":"XnNT7NsEmi"}],"key":"xtQEGO1MJK"},{"type":"paragraph","position":{"start":{"line":643,"column":1},"end":{"line":643,"column":1}},"children":[{"type":"text","value":"Let’s compute the residual of the last result in order to check the quality.","position":{"start":{"line":643,"column":1},"end":{"line":643,"column":1}},"key":"iS9RoVRV6C"}],"key":"Wp0pFYdcJW"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"r = x(:, end)\nback_err = norm(nlsystem(r))","key":"CpxrIL61C5"},{"type":"output","id":"yczCjI7fi689ArLnkjEI0","data":[{"output_type":"execute_result","execution_count":58,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>r = 3×1 double\n  -4.5803e-01\n   2.3511e-01\n   1.0769e-01\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"r = 3×1 double\n  -4.5803e-01\n   2.3511e-01\n   1.0769e-01\n","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":58,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>back_err = \n   1.3878e-17\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"back_err = \n   1.3878e-17\n","content_type":"text/plain"}}}],"key":"qhZbu56tI0"}],"key":"IK4cWuELvb"},{"type":"paragraph","position":{"start":{"line":650,"column":1},"end":{"line":650,"column":1}},"children":[{"type":"text","value":"We take the sequence errors in the first component of the solution, applying the log so that we can look at the exponents.","position":{"start":{"line":650,"column":1},"end":{"line":650,"column":1}},"key":"tXDkIOYbhl"}],"key":"JwdS50WvNg"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"log10( abs(x(1, 1:end-1) - r(1)) )'","key":"W6cKF8qbS6"},{"type":"output","id":"WteEjiC77fMlf2mDe7NI4","data":[{"output_type":"execute_result","execution_count":59,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = 6×1 double\n  -3.3910e-01\n  -2.6603e-01\n  -9.1882e-01\n  -2.2920e+00\n  -5.1929e+00\n  -9.9685e+00\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = 6×1 double\n  -3.3910e-01\n  -2.6603e-01\n  -9.1882e-01\n  -2.2920e+00\n  -5.1929e+00\n  -9.9685e+00\n","content_type":"text/plain"}}}],"key":"MsrgpUEjxp"}],"key":"Un3FKYzCCw"},{"type":"paragraph","position":{"start":{"line":656,"column":1},"end":{"line":656,"column":1}},"children":[{"type":"text","value":"This sequence looks to be nearly doubling at each iteration, which is a good sign of quadratic convergence.","position":{"start":{"line":656,"column":1},"end":{"line":656,"column":1}},"key":"qcXLjaL3Us"}],"key":"kmEOdkVkaE"}],"label":"demo-newtonsys-converge-matlab","identifier":"demo-newtonsys-converge-matlab","html_id":"demo-newtonsys-converge-matlab","key":"VHzGEvOHdt"},{"type":"heading","depth":3,"position":{"start":{"line":659,"column":1},"end":{"line":659,"column":1}},"children":[{"type":"text","value":"4.6 ","position":{"start":{"line":659,"column":1},"end":{"line":659,"column":1}},"key":"g1G9F1lvUb"},{"type":"link","identifier":"section-nonlineqn-quasinewton","label":"section-nonlineqn-quasinewton","kind":"narrative","position":{"start":{"line":659,"column":5},"end":{"line":659,"column":35}},"url":"/quasinewton","internal":true,"dataUrl":"/quasinewton.json","children":[{"type":"text","value":"Quasi-Newton methods","key":"nZaUOd2OJs"}],"key":"Unkn9CDxpI"}],"identifier":"id-4-6","label":"4.6 ","html_id":"id-4-6","implicit":true,"key":"EIuWDeBOQG"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-quasi-levenberg","label":"demo-quasi-levenberg","kind":"proof:example","position":{"start":{"line":661,"column":1},"end":{"line":661,"column":22}},"children":[{"type":"text","value":"Example ","key":"rZ4OkB11xe"},{"type":"text","value":"4.6.1","key":"YGrdGNy3zQ"}],"template":"Example %s","enumerator":"4.6.1","resolved":true,"html_id":"demo-quasi-levenberg","remote":true,"url":"/quasinewton","dataUrl":"/quasinewton.json","key":"ksY2029NGh"}],"key":"vp71bghh14"},{"type":"paragraph","position":{"start":{"line":664,"column":1},"end":{"line":664,"column":1}},"children":[{"type":"text","value":"To solve a nonlinear system, we need to code only the function defining the system, and not its Jacobian.","position":{"start":{"line":664,"column":1},"end":{"line":664,"column":1}},"key":"VdNc0NI1Zb"}],"key":"ZLOke9QP0D"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"S09yw2t5eo"}],"key":"sSytiro3l0"},{"type":"paragraph","position":{"start":{"line":667,"column":1},"end":{"line":667,"column":1}},"children":[{"type":"text","value":"A rule of thumb is that if you use a function as an input argument for another function, there needs to be an ","position":{"start":{"line":667,"column":1},"end":{"line":667,"column":1}},"key":"n0EWRKPH04"},{"type":"inlineCode","value":"@","position":{"start":{"line":667,"column":1},"end":{"line":667,"column":1}},"key":"iv4WmgQrHu"},{"type":"text","value":" involved once: either for an anonymous definition or to reference a function defined elsewhere.","position":{"start":{"line":667,"column":1},"end":{"line":667,"column":1}},"key":"rqngp5NmJV"}],"key":"W3YsZP75Az"},{"type":"include","file":"f45_nlsystem.m","literal":true,"children":[{"type":"code","value":"function [f, J] = nlsystem(x)\n    f = zeros(3, 1);   % ensure a column vector output\n    f(1) = exp(x(2) - x(1)) - 2;\n    f(2) = x(1) * x(2) + x(3);\n    f(3) = x(2) * x(3) + x(1)^2 - x(2);\n    J(1, :) = [-exp(x(2) - x(1)), exp(x(2) - x(1)), 0];\n    J(2, :) = [x(2), x(1), 1];\n    J(3, :) = [2 * x(1), x(3)-1, x(2)];\nend","lang":"matlab","filename":"f45_nlsystem.m","key":"MKn1n9m124"}],"key":"UoQt2nWXLi"}],"class":"dropdown","key":"MlWBVlvnu0"},{"type":"paragraph","position":{"start":{"line":671,"column":1},"end":{"line":671,"column":1}},"children":[{"type":"text","value":"In all other respects usage is the same as for the ","position":{"start":{"line":671,"column":1},"end":{"line":671,"column":1}},"key":"R0fvJVlba9"},{"type":"inlineCode","value":"newtonsys","position":{"start":{"line":671,"column":1},"end":{"line":671,"column":1}},"key":"hJDZzjE9rc"},{"type":"text","value":" function.","position":{"start":{"line":671,"column":1},"end":{"line":671,"column":1}},"key":"axRLaquP1I"}],"key":"lLXWNpbeXQ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"f = @f46_nlsystem;\nx1 = [0; 0; 0];   \nx = levenberg(f, x1);","key":"y51oGQJ0KY"},{"type":"output","id":"Dx4cuxcpn_gIYx7-lQzPr","data":[],"key":"clUflTq4SB"}],"key":"Mr5ytHb9Q7"},{"type":"paragraph","position":{"start":{"line":677,"column":1},"end":{"line":677,"column":1}},"children":[{"type":"text","value":"It’s always a good idea to check the accuracy of the root, by measuring the residual (backward error).","position":{"start":{"line":677,"column":1},"end":{"line":677,"column":1}},"key":"TZUFIixQTE"}],"key":"osXgHuXydS"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"r = x(:, end)\nbackward_err = norm(f(r))","key":"Jr980hCzyc"},{"type":"output","id":"RmlIma-gVjBFxEmuZgm_q","data":[{"output_type":"execute_result","execution_count":61,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>r = 3×1 double\n  -4.5803e-01\n   2.3511e-01\n   1.0769e-01\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"r = 3×1 double\n  -4.5803e-01\n   2.3511e-01\n   1.0769e-01\n","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":61,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>backward_err = \n   1.2708e-13\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"backward_err = \n   1.2708e-13\n","content_type":"text/plain"}}}],"key":"NxRQ7prNTi"}],"key":"GjEPvwTvaO"},{"type":"paragraph","position":{"start":{"line":682,"column":1},"end":{"line":682,"column":1}},"children":[{"type":"text","value":"Looking at the convergence of the first component, we find a rate between linear and quadratic, like with the secant method.","position":{"start":{"line":682,"column":1},"end":{"line":682,"column":1}},"key":"kXzD9Nx7Mj"}],"key":"V8YJjJqfz3"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"log10( abs(x(1, 1:end-1) - r(1)) )'","key":"Dr6Qq2dm2H"},{"type":"output","id":"3JA7L5or8yqtSFwVLHBTU","data":[{"output_type":"execute_result","execution_count":62,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = 11×1 double\n  -3.3910e-01\n  -4.2705e-01\n  -1.4439e+00\n  -1.5517e+00\n  -2.7571e+00\n  -2.6208e+00\n  -3.4403e+00\n  -4.9947e+00\n  -7.3448e+00\n  -8.7366e+00\n...</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = 11×1 double\n  -3.3910e-01\n  -4.2705e-01\n  -1.4439e+00\n  -1.5517e+00\n  -2.7571e+00\n  -2.6208e+00\n  -3.4403e+00\n  -4.9947e+00\n  -7.3448e+00\n  -8.7366e+00\n...","content_type":"text/plain"}}}],"key":"Gh7AUIMxXN"}],"key":"IzF2ooOmG3"}],"label":"demo-quasi-levenberg-matlab","identifier":"demo-quasi-levenberg-matlab","html_id":"demo-quasi-levenberg-matlab","key":"ke5fzeEnQd"},{"type":"heading","depth":3,"position":{"start":{"line":687,"column":1},"end":{"line":687,"column":1}},"children":[{"type":"text","value":"4.7 ","position":{"start":{"line":687,"column":1},"end":{"line":687,"column":1}},"key":"gLGMFqvrUM"},{"type":"link","identifier":"section-nonlineqn-nlsq","label":"section-nonlineqn-nlsq","kind":"narrative","position":{"start":{"line":687,"column":5},"end":{"line":687,"column":28}},"url":"/nlsq","internal":true,"dataUrl":"/nlsq.json","children":[{"type":"text","value":"Nonlinear least squares","key":"tbg5komfE8"}],"key":"bnBuLp1m3t"}],"identifier":"id-4-7","label":"4.7 ","html_id":"id-4-7","implicit":true,"key":"BgrUL0UV2o"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-nlsq-converge","label":"demo-nlsq-converge","kind":"proof:example","position":{"start":{"line":689,"column":1},"end":{"line":689,"column":20}},"children":[{"type":"text","value":"Example ","key":"mTllgdVVxu"},{"type":"text","value":"4.7.1","key":"cJK8XgBaDp"}],"template":"Example %s","enumerator":"4.7.1","resolved":true,"html_id":"demo-nlsq-converge","remote":true,"url":"/nlsq","dataUrl":"/nlsq.json","key":"xxoKEBTneG"}],"key":"Qo6mBazSoO"},{"type":"paragraph","position":{"start":{"line":691,"column":1},"end":{"line":691,"column":1}},"children":[{"type":"text","value":"We will observe the convergence of ","position":{"start":{"line":691,"column":1},"end":{"line":691,"column":1}},"key":"vtjENHPjwl"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-levenberg","label":"function-levenberg","children":[{"type":"text","value":"Function ","key":"xJOVYYMaa9"},{"type":"text","value":"4.6.3","key":"Sm0g8YF3JX"}],"template":"Algorithm %s","enumerator":"4.6.3","resolved":true,"html_id":"function-levenberg","remote":true,"url":"/quasinewton","dataUrl":"/quasinewton.json","key":"bbMsf8dx6W"},{"type":"text","value":" for different levels of the minimum least-squares residual. We start with a function mapping from ","position":{"start":{"line":691,"column":1},"end":{"line":691,"column":1}},"key":"tuTvxtC7kZ"},{"type":"inlineMath","value":"\\real^2","position":{"start":{"line":691,"column":1},"end":{"line":691,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi mathvariant=\"double-struck\">R</mi><mn>2</mn></msup></mrow><annotation encoding=\"application/x-tex\">\\real^2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathbb\">R</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span>","key":"Rmy3UVdspL"},{"type":"text","value":" into ","position":{"start":{"line":691,"column":1},"end":{"line":691,"column":1}},"key":"fHFdZMIFc3"},{"type":"inlineMath","value":"\\real^3","position":{"start":{"line":691,"column":1},"end":{"line":691,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi mathvariant=\"double-struck\">R</mi><mn>3</mn></msup></mrow><annotation encoding=\"application/x-tex\">\\real^3</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathbb\">R</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span></span></span></span></span></span></span></span>","key":"G3yeckKuSf"},{"type":"text","value":", and a point that will be near the optimum.","position":{"start":{"line":691,"column":1},"end":{"line":691,"column":1}},"key":"yQcLFrmoBV"}],"key":"FBHeAu2KCM"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"g = @(x) [sin(x(1) + x(2)); cos(x(1) - x(2)); exp(x(1) - x(2))];\np = [1; 1];","key":"CMyizULIyw"},{"type":"output","id":"cRzR6i597B_vE4hHIXAe_","data":[],"key":"PkbpEMn50R"}],"key":"awj4PjhXve"},{"type":"paragraph","position":{"start":{"line":699,"column":1},"end":{"line":699,"column":1}},"children":[{"type":"text","value":"The function ","position":{"start":{"line":699,"column":1},"end":{"line":699,"column":1}},"key":"L08Izf4GQy"},{"type":"inlineMath","value":"\\mathbf{g}(\\mathbf{x}) - \\mathbf{g}(\\mathbf{p})","position":{"start":{"line":699,"column":1},"end":{"line":699,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">g</mi><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">x</mi><mo stretchy=\"false\">)</mo><mo>−</mo><mi mathvariant=\"bold\">g</mi><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">p</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\mathbf{g}(\\mathbf{x}) - \\mathbf{g}(\\mathbf{p})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">g</span><span class=\"mopen\">(</span><span class=\"mord mathbf\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">g</span><span class=\"mopen\">(</span><span class=\"mord mathbf\">p</span><span class=\"mclose\">)</span></span></span></span>","key":"ZyEnSa7hGM"},{"type":"text","value":" obviously has a zero residual at ","position":{"start":{"line":699,"column":1},"end":{"line":699,"column":1}},"key":"ZPZ9W4QotN"},{"type":"inlineMath","value":"\\mathbf{p}","position":{"start":{"line":699,"column":1},"end":{"line":699,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">p</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{p}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6389em;vertical-align:-0.1944em;\"></span><span class=\"mord mathbf\">p</span></span></span></span>","key":"vk3JKk6dgd"},{"type":"text","value":". We’ll make different perturbations of that function in order to create nonzero residuals.","position":{"start":{"line":699,"column":1},"end":{"line":699,"column":1}},"key":"f7xs2kAzxR"}],"indexEntries":[{"entry":"Julia","subEntry":{"value":"@sprintf","kind":"entry"},"emphasis":true}],"label":"index-ebu5KsdHBO","identifier":"index-ebu5ksdhbo","html_id":"index-ebu5ksdhbo","key":"v4C4VJD89z"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"UEhntGUpKd"}],"key":"OIZZUDDNzD"},{"type":"paragraph","position":{"start":{"line":703,"column":1},"end":{"line":703,"column":1}},"children":[{"type":"inlineCode","value":"@sprintf","position":{"start":{"line":703,"column":1},"end":{"line":703,"column":1}},"key":"EPaMrWutfl"},{"type":"text","value":" is a way to format numerical values as strings, patterned after the C function ","position":{"start":{"line":703,"column":1},"end":{"line":703,"column":1}},"key":"R10YzgMZFQ"},{"type":"inlineCode","value":"printf","position":{"start":{"line":703,"column":1},"end":{"line":703,"column":1}},"key":"a9IPxG1R2p"},{"type":"text","value":".","position":{"start":{"line":703,"column":1},"end":{"line":703,"column":1}},"key":"ve6Ip6Pa8y"}],"key":"ZAywoHEXyI"}],"class":"dropdown","key":"vkSFsQEK85"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf\nlabels = [];\nfor R = [1e-3, 1e-2, 1e-1]\n    % Define the perturbed function.\n    f = @(x) g(x) - g(p) + R * [-1; 1; -1] / sqrt(3)\n    x = levenberg(f, [0; 0]);\n    r = x(:, end);\n    err = abs(x(1, 1:end-1) - r(1));\n    normres = norm(f(r));\n    semilogy(err), hold on\n    labels = [labels; sprintf(\"R=%.2g\", normres)];\nend\nxlabel(\"iteration\"), ylabel(\"error\")\nlegend(labels);","key":"Nvt4msxe3E"},{"type":"output","id":"c8nhT-ctpqjrV7c1a5qpx","data":[{"output_type":"execute_result","execution_count":64,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"31b772e51597e8e3057e6355d1d5a024","path":"/build/31b772e51597e8e3057e6355d1d5a024.png"}}},{"output_type":"execute_result","execution_count":64,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>f = function_handle with value:\n    @(x)g(x)-g(p)+R*[-1;1;-1]/sqrt(3)\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"f = function_handle with value:\n    @(x)g(x)-g(p)+R*[-1;1;-1]/sqrt(3)\n","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":64,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>f = function_handle with value:\n    @(x)g(x)-g(p)+R*[-1;1;-1]/sqrt(3)\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"f = function_handle with value:\n    @(x)g(x)-g(p)+R*[-1;1;-1]/sqrt(3)\n","content_type":"text/plain"}}},{"output_type":"stream","name":"stderr","text":"Warning: Iteration did not find a root."},{"output_type":"execute_result","execution_count":64,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>f = function_handle with value:\n    @(x)g(x)-g(p)+R*[-1;1;-1]/sqrt(3)\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"f = function_handle with value:\n    @(x)g(x)-g(p)+R*[-1;1;-1]/sqrt(3)\n","content_type":"text/plain"}}},{"output_type":"stream","name":"stderr","text":"Warning: Iteration did not find a root."}],"key":"BADFfTHLIr"}],"key":"OXBMFbSvro"},{"type":"paragraph","position":{"start":{"line":723,"column":1},"end":{"line":723,"column":1}},"children":[{"type":"text","value":"In the least perturbed case, where the minimized residual is less than ","position":{"start":{"line":723,"column":1},"end":{"line":723,"column":1}},"key":"s7Gy9OmiIJ"},{"type":"span","position":{"start":{"line":723,"column":1},"end":{"line":723,"column":1}},"children":[{"type":"text","value":"10","key":"fHkusV4Eou"},{"type":"superscript","children":[{"type":"text","value":"-3","key":"TOTLfynQ3M"}],"key":"pTPNEnMKz2"}],"key":"D9KFAbdonn"},{"type":"text","value":", the convergence is plausibly quadratic. At the next level up, the convergence starts similarly but suddenly stagnates for a long time. In the most perturbed case, the quadratic phase is nearly gone and the overall shape looks linear.","position":{"start":{"line":723,"column":1},"end":{"line":723,"column":1}},"key":"Lr25l5HrWh"}],"key":"ANEhh2Ta6a"}],"label":"demo-nlsq-converge-matlab","identifier":"demo-nlsq-converge-matlab","html_id":"demo-nlsq-converge-matlab","key":"qSGO7X9dbE"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-nlsq-mm","label":"demo-nlsq-MM","kind":"proof:example","position":{"start":{"line":727,"column":1},"end":{"line":727,"column":14}},"children":[{"type":"text","value":"Example ","key":"cRjIj3Ejqa"},{"type":"text","value":"4.7.2","key":"ngexwzINMW"}],"template":"Example %s","enumerator":"4.7.2","resolved":true,"html_id":"demo-nlsq-mm","remote":true,"url":"/nlsq","dataUrl":"/nlsq.json","key":"gmruFXjm9W"}],"key":"Fy9rhUuuwY"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"m = 25; V = 2; Km = 0.5;\ns = linspace(0.05, 6, m)';\nw = V * s ./ (Km + s);                      % exactly on the curve\nw = w + 0.15 * cos(2 * exp(s / 16) .* s);   % noise added\nclf, fplot(@(s) V * s ./ (Km + s), [0, 6], '--')\nhold on, scatter(s, w)\nxlabel('concentration'), ylabel('reaction rate')    \nlabels = [\"ideal\", \"noisy data\"];    \nlegend(labels, 'location', 'east');","key":"nELx78JS0h"},{"type":"output","id":"cYetPnHFTGzbfyErhwFbv","data":[{"output_type":"execute_result","execution_count":65,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"1f2b061f600803ae8645376fbf6f8f09","path":"/build/1f2b061f600803ae8645376fbf6f8f09.png"}}}],"key":"cEZPrj3jmQ"}],"key":"iIbznL42iB"},{"type":"paragraph","position":{"start":{"line":741,"column":1},"end":{"line":741,"column":1}},"children":[{"type":"text","value":"The idea is to pretend that we know nothing of the origins of this data and use nonlinear least squares to find the parameters in the theoretical model function ","position":{"start":{"line":741,"column":1},"end":{"line":741,"column":1}},"key":"fnq417mjZe"},{"type":"inlineMath","value":"v(s)","position":{"start":{"line":741,"column":1},"end":{"line":741,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>v</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">v(s)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">s</span><span class=\"mclose\">)</span></span></span></span>","key":"w8wIL5gVQ4"},{"type":"text","value":". In ","position":{"start":{"line":741,"column":1},"end":{"line":741,"column":1}},"key":"kOugNrKESM"},{"type":"crossReference","kind":"equation","identifier":"nlsq-misfit","label":"nlsq-misfit","children":[{"type":"text","value":"(","key":"RqVpFW4Jxj"},{"type":"text","value":"4.7.2","key":"Z4N2VXLfs6"},{"type":"text","value":")","key":"Xbk09yQ0XJ"}],"template":"(%s)","enumerator":"4.7.2","resolved":true,"html_id":"nlsq-misfit","remote":true,"url":"/nlsq","dataUrl":"/nlsq.json","key":"UsTGSh6FAy"},{"type":"text","value":", the ","position":{"start":{"line":741,"column":1},"end":{"line":741,"column":1}},"key":"ZXWoPse2T5"},{"type":"inlineMath","value":"s","position":{"start":{"line":741,"column":1},"end":{"line":741,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>s</mi></mrow><annotation encoding=\"application/x-tex\">s</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">s</span></span></span></span>","key":"ozVLQQjX0C"},{"type":"text","value":" variable plays the role of ","position":{"start":{"line":741,"column":1},"end":{"line":741,"column":1}},"key":"IFwWTnV46K"},{"type":"inlineMath","value":"t","position":{"start":{"line":741,"column":1},"end":{"line":741,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span></span></span></span>","key":"eveDVSDKh5"},{"type":"text","value":", and ","position":{"start":{"line":741,"column":1},"end":{"line":741,"column":1}},"key":"VPsIoc0Aaf"},{"type":"inlineMath","value":"v","position":{"start":{"line":741,"column":1},"end":{"line":741,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>v</mi></mrow><annotation encoding=\"application/x-tex\">v</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span></span></span></span>","key":"iZS6ehWlBj"},{"type":"text","value":" plays the role of ","position":{"start":{"line":741,"column":1},"end":{"line":741,"column":1}},"key":"cdmyUm4cJZ"},{"type":"inlineMath","value":"g","position":{"start":{"line":741,"column":1},"end":{"line":741,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>g</mi></mrow><annotation encoding=\"application/x-tex\">g</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span></span></span></span>","key":"f9VVevOMgn"},{"type":"text","value":". In the Jacobian, the derivatives are with respect to the parameters in ","position":{"start":{"line":741,"column":1},"end":{"line":741,"column":1}},"key":"BrHpR4x759"},{"type":"inlineMath","value":"\\mathbf{x}","position":{"start":{"line":741,"column":1},"end":{"line":741,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">x</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{x}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4444em;\"></span><span class=\"mord mathbf\">x</span></span></span></span>","key":"am1nhVPEp0"},{"type":"text","value":".","position":{"start":{"line":741,"column":1},"end":{"line":741,"column":1}},"key":"kyDXEkg6sb"}],"key":"TOOKrBTFsw"},{"type":"include","file":"f47_misfit.m","literal":true,"children":[{"type":"code","value":"function [f, J] = misfit(c, s, w)\n    V = c(1);   Km = c(2);\n    f = V * s ./ (Km + s) - w;\n    J(:,1) = s ./ (Km + s);            % d/d(V)\n    J(:,2) = -V * s ./ (Km + s).^2;    % d/d(Km)\nend\n","lang":"matlab","filename":"f47_misfit.m","key":"BE1wQI7U9p"}],"key":"cAOKaVfLx3"},{"type":"paragraph","position":{"start":{"line":747,"column":1},"end":{"line":747,"column":1}},"children":[{"type":"text","value":"The misfit function above has to know the parameters ","position":{"start":{"line":747,"column":1},"end":{"line":747,"column":1}},"key":"iXHGunkBJu"},{"type":"inlineCode","value":"x","position":{"start":{"line":747,"column":1},"end":{"line":747,"column":1}},"key":"b1chOV8UOb"},{"type":"text","value":" that are being optimized as well as the data ","position":{"start":{"line":747,"column":1},"end":{"line":747,"column":1}},"key":"ATLVtfG196"},{"type":"inlineCode","value":"s","position":{"start":{"line":747,"column":1},"end":{"line":747,"column":1}},"key":"FHLKv3VLew"},{"type":"text","value":" and ","position":{"start":{"line":747,"column":1},"end":{"line":747,"column":1}},"key":"qSaflJDy7t"},{"type":"inlineCode","value":"w","position":{"start":{"line":747,"column":1},"end":{"line":747,"column":1}},"key":"lmiXZ6optZ"},{"type":"text","value":" that remain fixed. We use a closure to pass the data values along.","position":{"start":{"line":747,"column":1},"end":{"line":747,"column":1}},"key":"K71KYZgEuA"}],"key":"kccKgvEwMO"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"f = @(x) f47_misfit(x, s, w);","key":"eqeorvAdy3"},{"type":"output","id":"DAnAvOx7RnxhZ9Lt2RKqw","data":[],"key":"Zd5x8LeYVO"}],"key":"ZhbCwBflQX"},{"type":"paragraph","position":{"start":{"line":753,"column":1},"end":{"line":753,"column":1}},"children":[{"type":"text","value":"Now we have a function that accepts a single 2-vector input and returns a 25-vector output. We can pass this function to ","position":{"start":{"line":753,"column":1},"end":{"line":753,"column":1}},"key":"VcKLQE6BQs"},{"type":"inlineCode","value":"levenberg","position":{"start":{"line":753,"column":1},"end":{"line":753,"column":1}},"key":"VOr72Oegr5"},{"type":"text","value":" to find the best-fit parameters.","position":{"start":{"line":753,"column":1},"end":{"line":753,"column":1}},"key":"uiGbxBl9BS"}],"key":"Zozg446OSc"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"x1 = [1; 0.75];\nx = newtonsys(f, x1);\nV = x(1, end),  Km = x(2, end)     % final values\nmodel = @(s) V * s ./ (Km + s);    % best-fit model","key":"QMr4UHq08E"},{"type":"output","id":"tI7_JPwDr-0jyLjlWgj1g","data":[{"output_type":"execute_result","execution_count":67,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>V = \n   1.9687e+00\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"V = \n   1.9687e+00\n","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":67,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>Km = \n   4.6930e-01\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"Km = \n   4.6930e-01\n","content_type":"text/plain"}}}],"key":"fjLBclK2lW"}],"key":"e9fyrsyOel"},{"type":"paragraph","position":{"start":{"line":762,"column":1},"end":{"line":762,"column":1}},"children":[{"type":"text","value":"The final values are reasonably close to the values ","position":{"start":{"line":762,"column":1},"end":{"line":762,"column":1}},"key":"rQoi0Sf0rF"},{"type":"inlineMath","value":"V=2","position":{"start":{"line":762,"column":1},"end":{"line":762,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>V</mi><mo>=</mo><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">V=2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span></span></span></span>","key":"r0DqeWWqME"},{"type":"text","value":", ","position":{"start":{"line":762,"column":1},"end":{"line":762,"column":1}},"key":"U4kzBmnJLq"},{"type":"inlineMath","value":"K_m=0.5","position":{"start":{"line":762,"column":1},"end":{"line":762,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>K</mi><mi>m</mi></msub><mo>=</mo><mn>0.5</mn></mrow><annotation encoding=\"application/x-tex\">K_m=0.5</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0.5</span></span></span></span>","key":"ZWUOviJtox"},{"type":"text","value":" that we used to generate the noise-free data. Graphically, the model looks close to the original data:","position":{"start":{"line":762,"column":1},"end":{"line":762,"column":1}},"key":"D5vkGBaaaJ"}],"key":"IRE3jC0Fwp"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"final_misfit_norm = norm(model(s) - w) \nhold on, fplot(model, [0, 6])\ntitle('Michaelis-Menten fitting')    \nlabels = [labels, \"nonlinear fit\"];    \nlegend(labels, 'location', 'east');","key":"CT8DP3QmgN"},{"type":"output","id":"S0sOqvotQY3KiFtuP4gCi","data":[{"output_type":"execute_result","execution_count":68,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>final_misfit_norm = \n   5.2340e-01\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"final_misfit_norm = \n   5.2340e-01\n","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":68,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"cb72f9f80e656daf7f0784a004274f51","path":"/build/cb72f9f80e656daf7f0784a004274f51.png"}}}],"key":"LzHnqROIb3"}],"key":"FYvcnfgB4M"},{"type":"paragraph","position":{"start":{"line":772,"column":1},"end":{"line":772,"column":1}},"children":[{"type":"text","value":"For this particular model, we also have the option of linearizing the fit process. Rewrite the model as","position":{"start":{"line":772,"column":1},"end":{"line":772,"column":1}},"key":"NaKsQ0fqe6"}],"key":"HVqpBG5c0U"},{"type":"math","value":"\\frac{1}{w} = \\frac{\\alpha}{s} + \\beta = \\alpha \\cdot s^{-1} + \\beta","enumerated":false,"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mfrac><mn>1</mn><mi>w</mi></mfrac><mo>=</mo><mfrac><mi>α</mi><mi>s</mi></mfrac><mo>+</mo><mi>β</mi><mo>=</mo><mi>α</mi><mo>⋅</mo><msup><mi>s</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo>+</mo><mi>β</mi></mrow><annotation encoding=\"application/x-tex\">\\frac{1}{w} = \\frac{\\alpha}{s} + \\beta = \\alpha \\cdot s^{-1} + \\beta</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.0074em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.7936em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.1076em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">s</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05278em;\">β</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4445em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.9474em;vertical-align:-0.0833em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05278em;\">β</span></span></span></span></span>","key":"kjMJXd9GO0"},{"type":"paragraph","position":{"start":{"line":779,"column":1},"end":{"line":779,"column":1}},"children":[{"type":"text","value":"for the new fitting parameters ","position":{"start":{"line":779,"column":1},"end":{"line":779,"column":1}},"key":"ZB0OmU20D0"},{"type":"inlineMath","value":"\\alpha=K_m/V","position":{"start":{"line":779,"column":1},"end":{"line":779,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>α</mi><mo>=</mo><msub><mi>K</mi><mi>m</mi></msub><mi mathvariant=\"normal\">/</mi><mi>V</mi></mrow><annotation encoding=\"application/x-tex\">\\alpha=K_m/V</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">/</span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span></span></span></span>","key":"B07mHPrgdT"},{"type":"text","value":" and ","position":{"start":{"line":779,"column":1},"end":{"line":779,"column":1}},"key":"sUSUF6QGvs"},{"type":"inlineMath","value":"\\beta=1/V","position":{"start":{"line":779,"column":1},"end":{"line":779,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>β</mi><mo>=</mo><mn>1</mn><mi mathvariant=\"normal\">/</mi><mi>V</mi></mrow><annotation encoding=\"application/x-tex\">\\beta=1/V</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05278em;\">β</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1/</span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span></span></span></span>","key":"adalC3PmU5"},{"type":"text","value":". This corresponds to the misfit function whose entries are","position":{"start":{"line":779,"column":1},"end":{"line":779,"column":1}},"key":"f5QogLcngF"}],"key":"dw04HhIK1h"},{"type":"math","value":"f_i([\\alpha,\\beta]) = \\left(\\alpha \\cdot \\frac{1}{s_i} + \\beta\\right) - \\frac{1}{w_i}","position":{"start":{"line":781,"column":1},"end":{"line":781,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>f</mi><mi>i</mi></msub><mo stretchy=\"false\">(</mo><mo stretchy=\"false\">[</mo><mi>α</mi><mo separator=\"true\">,</mo><mi>β</mi><mo stretchy=\"false\">]</mo><mo stretchy=\"false\">)</mo><mo>=</mo><mrow><mo fence=\"true\">(</mo><mi>α</mi><mo>⋅</mo><mfrac><mn>1</mn><msub><mi>s</mi><mi>i</mi></msub></mfrac><mo>+</mo><mi>β</mi><mo fence=\"true\">)</mo></mrow><mo>−</mo><mfrac><mn>1</mn><msub><mi>w</mi><mi>i</mi></msub></mfrac></mrow><annotation encoding=\"application/x-tex\">f_i([\\alpha,\\beta]) = \\left(\\alpha \\cdot \\frac{1}{s_i} + \\beta\\right) - \\frac{1}{w_i}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">([</span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05278em;\">β</span><span class=\"mclose\">])</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.4em;vertical-align:-0.95em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">(</span></span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05278em;\">β</span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">)</span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.1574em;vertical-align:-0.836em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span>","enumerator":"1","key":"VQS3AN0p9f"},{"type":"paragraph","position":{"start":{"line":783,"column":1},"end":{"line":783,"column":1}},"children":[{"type":"text","value":"for ","position":{"start":{"line":783,"column":1},"end":{"line":783,"column":1}},"key":"Gd4VA6ssUF"},{"type":"inlineMath","value":"i=1,\\ldots,m","position":{"start":{"line":783,"column":1},"end":{"line":783,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi><mo>=</mo><mn>1</mn><mo separator=\"true\">,</mo><mo>…</mo><mo separator=\"true\">,</mo><mi>m</mi></mrow><annotation encoding=\"application/x-tex\">i=1,\\ldots,m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8389em;vertical-align:-0.1944em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">m</span></span></span></span>","key":"pOx3P54SFd"},{"type":"text","value":". Although this misfit is nonlinear in ","position":{"start":{"line":783,"column":1},"end":{"line":783,"column":1}},"key":"IyYvVuZvZw"},{"type":"inlineMath","value":"s","position":{"start":{"line":783,"column":1},"end":{"line":783,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>s</mi></mrow><annotation encoding=\"application/x-tex\">s</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">s</span></span></span></span>","key":"zYgQbYeBs4"},{"type":"text","value":" and ","position":{"start":{"line":783,"column":1},"end":{"line":783,"column":1}},"key":"vLGt0xWInM"},{"type":"inlineMath","value":"w","position":{"start":{"line":783,"column":1},"end":{"line":783,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>w</mi></mrow><annotation encoding=\"application/x-tex\">w</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span></span></span></span>","key":"dipZCohIPs"},{"type":"text","value":", it’s linear in the unknown parameters ","position":{"start":{"line":783,"column":1},"end":{"line":783,"column":1}},"key":"R5F7J9Ow3W"},{"type":"inlineMath","value":"\\alpha","position":{"start":{"line":783,"column":1},"end":{"line":783,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>α</mi></mrow><annotation encoding=\"application/x-tex\">\\alpha</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span></span></span></span>","key":"jjS42bhwsE"},{"type":"text","value":" and ","position":{"start":{"line":783,"column":1},"end":{"line":783,"column":1}},"key":"c52lWRvVCJ"},{"type":"inlineMath","value":"\\beta","position":{"start":{"line":783,"column":1},"end":{"line":783,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>β</mi></mrow><annotation encoding=\"application/x-tex\">\\beta</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05278em;\">β</span></span></span></span>","key":"iwsqGAgnFT"},{"type":"text","value":". This lets us pose and solve it as a linear least-squares problem.","position":{"start":{"line":783,"column":1},"end":{"line":783,"column":1}},"key":"fqS1ltgZYK"}],"key":"I4TPXlgKdx"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"u = 1 ./ w;\nA = [s.^(-1), s.^0];  \nz = A \\ u;\nalpha = z(1);  beta = z(2);","key":"rWKoCI2g93"},{"type":"output","id":"mrjaH1BseRgVWd6-ttT7t","data":[],"key":"hNEZBTOUkp"}],"key":"YhPCEN8X6M"},{"type":"paragraph","position":{"start":{"line":792,"column":1},"end":{"line":792,"column":1}},"children":[{"type":"text","value":"The two fits are different because they do not optimize the same quantities.","position":{"start":{"line":792,"column":1},"end":{"line":792,"column":1}},"key":"xKR9MtHz0d"}],"key":"SadNxU4YQY"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"linmodel = @(s) 1 ./ (beta + alpha ./ s);\nfinal_misfit_linearized = norm(linmodel(s) - w)\nfplot(linmodel, [0, 6])\nlabels = [labels, \"linearized fit\"];    \nlegend(labels, 'location', 'east');","key":"tQwLrYBgQo"},{"type":"output","id":"WS6A9FQF2rO6N_rmxP3VR","data":[{"output_type":"execute_result","execution_count":70,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>final_misfit_linearized = \n   7.4871e-01\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"final_misfit_linearized = \n   7.4871e-01\n","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":70,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"acf3556d13847b03745182151133b96d","path":"/build/acf3556d13847b03745182151133b96d.png"}}}],"key":"XMb2BMoM4v"}],"key":"AviuX91LBr"},{"type":"paragraph","position":{"start":{"line":802,"column":1},"end":{"line":802,"column":1}},"children":[{"type":"text","value":"The truly nonlinear fit is clearly better in this case. It optimizes a residual for the original measured quantity rather than a transformed one we picked for algorithmic convenience.","position":{"start":{"line":802,"column":1},"end":{"line":802,"column":1}},"key":"Lg5HI0teX4"}],"key":"jrTjSnf8ne"}],"label":"demo-nlsq-MM-matlab","identifier":"demo-nlsq-mm-matlab","html_id":"demo-nlsq-mm-matlab","key":"mXMlRyyJ50"}],"key":"v1CdUxrmN7"}],"key":"kH3blKRY3x"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Chapter 3","url":"/chapter3-1","group":"MATLAB codes"},"next":{"title":"Chapter 5","url":"/chapter5-1","group":"MATLAB codes"}}},"domain":"http://localhost:3000"}