{"kind":"Notebook","sha256":"d4fa9fe948ba2f2b148143643f88c92d30b380d75979f3ff6a0e39f7f1c25c83","slug":"extrap-1","location":"/chapter5/section6/matlab/extrap.ipynb","dependencies":[],"frontmatter":{"numbering":{"heading_1":{"enabled":false},"heading_2":{"enabled":false},"heading_3":{"enabled":false},"heading_4":{"enabled":false},"heading_5":{"enabled":false},"heading_6":{"enabled":false}},"kernelspec":{"name":"jupyter_matlab_kernel","display_name":"MATLAB Kernel","language":"matlab"},"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"exports":[{"format":"ipynb","filename":"extrap.ipynb","url":"/fnc/build/extrap-6828901a47fa5f3df4fedf5129383cc6.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"jo0AdeMrle"},{"type":"text","value":"5.6.3","key":"FQPMXpwnGb"}],"key":"okAdnOyLiJ"}],"identifier":"demo-int-extrap","label":"demo-int-extrap","kind":"proof:example","template":"Example %s","enumerator":"5.6.3","resolved":true,"html_id":"demo-int-extrap","remote":true,"url":"/integration","dataUrl":"/integration.json","key":"JbY4aejYSW"}],"key":"ysSsHugQKz"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We estimate ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"f9fvimxhS3"},{"type":"inlineMath","value":"\\displaystyle\\int_0^2 x^2 e^{-2x}\\, dx","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle scriptlevel=\"0\" displaystyle=\"true\"><msubsup><mo>∫</mo><mn>0</mn><mn>2</mn></msubsup><msup><mi>x</mi><mn>2</mn></msup><msup><mi>e</mi><mrow><mo>−</mo><mn>2</mn><mi>x</mi></mrow></msup><mtext> </mtext><mi>d</mi><mi>x</mi></mstyle></mrow><annotation encoding=\"application/x-tex\">\\displaystyle\\int_0^2 x^2 e^{-2x}\\, dx</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.476em;vertical-align:-0.9119em;\"></span><span class=\"mop\"><span class=\"mop op-symbol large-op\" style=\"margin-right:0.44445em;position:relative;top:-0.0011em;\">∫</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.564em;\"><span style=\"top:-1.7881em;margin-left:-0.4445em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span><span style=\"top:-3.8129em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9119em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">2</span><span class=\"mord mathnormal mtight\">x</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"aFrF7Xjbmi"},{"type":"text","value":" using extrapolation. First we use ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"R9lx5lF7au"},{"type":"inlineCode","value":"quadgk","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Y7fvCidCxn"},{"type":"text","value":" to get an accurate value.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"vokUM0IOSC"}],"key":"vFa5hy6HL6"}],"key":"xqCGRXSaqF"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"f = @(x) x.^2 .* exp(-2 * x);\na = 0;  b = 2;\nformat long\nI = integral(f, a, b, abstol=1e-14, reltol=1e-14)","key":"RcjMBrvQd0"},{"type":"output","id":"66pQ-WsAv-UtfwuKjcWjZ","data":[{"output_type":"execute_result","execution_count":2,"metadata":{},"data":{"text/plain":{"content":"I = \n   0.190474173611614\n","content_type":"text/plain"},"text/html":{"content":"<html><body><pre>I = \n   0.190474173611614\n</pre></body></html>","content_type":"text/html"}}}],"key":"OjxdNhCJ9c"}],"key":"jWUTT9S6Qr"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We start with the trapezoid formula on ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jMZkm3kAuz"},{"type":"inlineMath","value":"n=N","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>=</mo><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">n=N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span>","key":"Mbn1dX7yqQ"},{"type":"text","value":" nodes.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rdbbNxOqIT"}],"key":"lR4YSVN7ZB"}],"key":"QWIbDUO1hQ"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"N = 20;       % the coarsest formula\nn = N;  h = (b - a) / n;\nt = h * (0:n)';\ny = f(t);","key":"CD9kJCaHde"},{"type":"output","id":"tVKJJEouUXbTbw3nCAQUk","data":[],"key":"R5JxtWTlrS"}],"key":"pmRhU7s6xX"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We can now apply weights to get the estimate ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Sq4RYgZXnl"},{"type":"inlineMath","value":"T_f(N)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>T</mi><mi>f</mi></msub><mo stretchy=\"false\">(</mo><mi>N</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">T_f(N)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0361em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10764em;\">f</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span></span></span></span>","key":"GHHthp7eN3"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MqokDywTjR"}],"key":"DYZs098ggT"}],"key":"V2TDOhLhGX"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"T = h * ( sum(y(2:n)) + y(1) / 2 + y(n+1) / 2 )","key":"t9IRAJU7wQ"},{"type":"output","id":"A3kNoGet2sjLzWqxPXNI7","data":[{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"text/plain":{"content":"T = \n   0.190411449939268\n","content_type":"text/plain"},"text/html":{"content":"<html><body><pre>T = \n   0.190411449939268\n</pre></body></html>","content_type":"text/html"}}}],"key":"DKJ5HJvoMI"}],"key":"khGXNMejTm"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now we double to ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"j6r2gaf5nu"},{"type":"inlineMath","value":"n=2N","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>=</mo><mn>2</mn><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">n=2N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord\">2</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span>","key":"w4VNQw5vDJ"},{"type":"text","value":", but we only need to evaluate ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jSKYIDJhDd"},{"type":"inlineMath","value":"f","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>","key":"Wzyt0FHNC0"},{"type":"text","value":" at every other interior node and apply ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"IsFvyj5Hdr"},{"type":"crossReference","kind":"equation","identifier":"nc-doubling","label":"nc-doubling","children":[{"type":"text","value":"(","key":"bf98FortXl"},{"type":"text","value":"5.6.18","key":"XHkqQniUEs"},{"type":"text","value":")","key":"GrXDvsubX3"}],"template":"(%s)","enumerator":"5.6.18","resolved":true,"html_id":"nc-doubling","remote":true,"url":"/integration","dataUrl":"/integration.json","key":"dIiz9RrD2T"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"glhc5dpoJp"}],"key":"hLTxnPJxJ0"}],"key":"qgdNyP0oBU"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"n = 2*n;  h = h / 2;\nt = h * (0:n)';\nT(2) = T(1) / 2 + h * sum( f(t(2:2:n)) )","key":"mvP51ZpP8T"},{"type":"output","id":"pxwF2QmXvLYEXUdnedClm","data":[{"output_type":"execute_result","execution_count":5,"metadata":{},"data":{"text/plain":{"content":"T = 1×2 double\n   0.190411449939268   0.190458805859512\n","content_type":"text/plain"},"text/html":{"content":"<html><body><pre>T = 1×2 double\n   0.190411449939268   0.190458805859512\n</pre></body></html>","content_type":"text/html"}}}],"key":"AjTHSaPoQU"}],"key":"DjThQEq2Xi"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We can repeat the same code to double ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Fb2c3v0Gfo"},{"type":"inlineMath","value":"n","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"Tr2ArSbsPg"},{"type":"text","value":" again.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Fl84ACDAnd"}],"key":"X9cVsfxyug"}],"key":"i5ycyAg4yE"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"n = 2*n;  h = h / 2;\nt = h * (0:n)';\nT(3) = T(2) / 2 + h * sum( f(t(2:2:n)) )","key":"CKRKQF6Ddu"},{"type":"output","id":"kXxvOrLdtDMLbiwOGMiuD","data":[{"output_type":"execute_result","execution_count":6,"metadata":{},"data":{"text/plain":{"content":"T = 1×3 double\n   0.190411449939268   0.190458805859512   0.190470351304644\n","content_type":"text/plain"},"text/html":{"content":"<html><body><pre>T = 1×3 double\n   0.190411449939268   0.190458805859512   0.190470351304644\n</pre></body></html>","content_type":"text/html"}}}],"key":"gtwojupYuh"}],"key":"gcHkIHJfCK"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Let us now do the first level of extrapolation to get results from Simpson’s formula. We combine the elements ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"adZ570s2W2"},{"type":"inlineCode","value":"T[i]","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"iOdw2GvJnc"},{"type":"text","value":" and ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"HWgpRIuGSb"},{"type":"inlineCode","value":"T[i+1]","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DG1zkTkcSp"},{"type":"text","value":" the same way for ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"I6SKcp1oRy"},{"type":"inlineMath","value":"i=1","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">i=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"qN7yJOjzgs"},{"type":"text","value":" and ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"CMIpkVGrSL"},{"type":"inlineMath","value":"i=2","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi><mo>=</mo><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">i=2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span></span></span></span>","key":"X9WfUCgdUk"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kF8N3pTxn9"}],"key":"delubCpTF5"}],"key":"Vpg05MD5Of"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"S = (4 * T(2:3) - T(1:2)) / 3","key":"qG0yZ7Q9KR"},{"type":"output","id":"rYf9bitdZwHo5YpjMuCUy","data":[{"output_type":"execute_result","execution_count":7,"metadata":{},"data":{"text/plain":{"content":"S = 1×2 double\n   0.190474591166260   0.190474199786355\n","content_type":"text/plain"},"text/html":{"content":"<html><body><pre>S = 1×2 double\n   0.190474591166260   0.190474199786355\n</pre></body></html>","content_type":"text/html"}}}],"key":"fplBdK56Lu"}],"key":"pOWcWCaD30"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"With the two Simpson values ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ugKz8aCDr9"},{"type":"inlineMath","value":"S_f(N)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>S</mi><mi>f</mi></msub><mo stretchy=\"false\">(</mo><mi>N</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">S_f(N)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0361em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10764em;\">f</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span></span></span></span>","key":"z7pN26JPkv"},{"type":"text","value":" and ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ZdWRM6nUhB"},{"type":"inlineMath","value":"S_f(2N)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>S</mi><mi>f</mi></msub><mo stretchy=\"false\">(</mo><mn>2</mn><mi>N</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">S_f(2N)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0361em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10764em;\">f</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\">2</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span></span></span></span>","key":"a6eaVpNM5y"},{"type":"text","value":" in hand, we can do one more level of extrapolation to get a sixth-order accurate result.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UAtKFlwWQj"}],"key":"SfYm0RYQo3"}],"key":"JvWyQUYOmW"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"R = (16*S(2) - S(1)) / 15","key":"CBIUbWVQ7D"},{"type":"output","id":"KAlzdAulVMKF5i187adno","data":[{"output_type":"execute_result","execution_count":8,"metadata":{},"data":{"text/plain":{"content":"R = \n   0.190474173694362\n","content_type":"text/plain"},"text/html":{"content":"<html><body><pre>R = \n   0.190474173694362\n</pre></body></html>","content_type":"text/html"}}}],"key":"NeDeppMVe0"}],"key":"Os1jPeNjAj"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We can make a triangular table of the errors:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"oa8BWc699K"}],"key":"OHL3S0UeOt"}],"key":"zhfa3hkXnw"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"err2 = T(:) - I;\nerr4 = [NaN; S(:) - I];\nerr6 = [NaN; NaN; R - I];\nformat short e\ndisp(table(err2, err4, err6, variablenames=[\"order 2\", \"order 4\", \"order 6\"]))","key":"CVVU4B9T6p"},{"type":"output","id":"IZtqMvVKUtiP_NhWNUNGJ","data":[{"name":"stdout","output_type":"stream","text":"      order 2       order 4       order 6  \n    ___________    __________    __________\n\n    -6.2724e-05           NaN           NaN\n    -1.5368e-05    4.1755e-07           NaN\n    -3.8223e-06    2.6175e-08    8.2748e-11\n\n"}],"key":"GXKCm7WIEj"}],"key":"KVPXzUZWK8"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"If we consider the computational time to be dominated by evaluations of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JkTrBWQYCw"},{"type":"inlineMath","value":"f","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>","key":"TTW4RfybEl"},{"type":"text","value":", then we have obtained a result with about twice as many accurate digits as the best trapezoid result, at virtually no extra cost.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WNuU3wFcfr"}],"key":"xVrdU05NhP"}],"key":"MsfqMG2U0N"}],"key":"b4dfF4HVen"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Trap","url":"/trap-1","group":"Chapter 5"},"next":{"title":"Motive","url":"/motive-1","group":"Chapter 5"}}},"domain":"http://localhost:3000"}