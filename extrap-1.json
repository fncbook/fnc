{"kind":"Notebook","sha256":"d4fa9fe948ba2f2b148143643f88c92d30b380d75979f3ff6a0e39f7f1c25c83","slug":"extrap-1","location":"/chapter5/section6/matlab/extrap.ipynb","dependencies":[],"frontmatter":{"numbering":{"heading_1":{"enabled":false},"heading_2":{"enabled":false},"heading_3":{"enabled":false},"heading_4":{"enabled":false},"heading_5":{"enabled":false},"heading_6":{"enabled":false}},"kernelspec":{"name":"jupyter_matlab_kernel","display_name":"MATLAB Kernel","language":"matlab"},"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"exports":[{"format":"ipynb","filename":"extrap.ipynb","url":"/build/extrap-6828901a47fa5f3df4fedf5129383cc6.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"w6gFfbq44B"},{"type":"text","value":"5.6.3","key":"Znx50smlm5"}],"key":"fu07P3NcOz"}],"identifier":"demo-int-extrap","label":"demo-int-extrap","kind":"proof:example","template":"Example %s","enumerator":"5.6.3","resolved":true,"html_id":"demo-int-extrap","remote":true,"url":"/integration","dataUrl":"/integration.json","key":"jPzsn93sw1"}],"key":"HS2i63f6b8"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We estimate ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"gfsWM8AObc"},{"type":"inlineMath","value":"\\displaystyle\\int_0^2 x^2 e^{-2x}\\, dx","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle scriptlevel=\"0\" displaystyle=\"true\"><msubsup><mo>∫</mo><mn>0</mn><mn>2</mn></msubsup><msup><mi>x</mi><mn>2</mn></msup><msup><mi>e</mi><mrow><mo>−</mo><mn>2</mn><mi>x</mi></mrow></msup><mtext> </mtext><mi>d</mi><mi>x</mi></mstyle></mrow><annotation encoding=\"application/x-tex\">\\displaystyle\\int_0^2 x^2 e^{-2x}\\, dx</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.476em;vertical-align:-0.9119em;\"></span><span class=\"mop\"><span class=\"mop op-symbol large-op\" style=\"margin-right:0.44445em;position:relative;top:-0.0011em;\">∫</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.564em;\"><span style=\"top:-1.7881em;margin-left:-0.4445em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span><span style=\"top:-3.8129em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9119em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">2</span><span class=\"mord mathnormal mtight\">x</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"wifiOskJ7i"},{"type":"text","value":" using extrapolation. First we use ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"tRNQCF41pW"},{"type":"inlineCode","value":"quadgk","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"B64iaZLPY5"},{"type":"text","value":" to get an accurate value.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"VSLR0XMWLN"}],"key":"aL1G3hyMb7"}],"key":"VK4U2V9DxD"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"f = @(x) x.^2 .* exp(-2 * x);\na = 0;  b = 2;\nformat long\nI = integral(f, a, b, abstol=1e-14, reltol=1e-14)","key":"VavNNtaHTk"},{"type":"output","id":"o5IcH0Lfcxzq1nd3JQBJx","data":[{"output_type":"execute_result","execution_count":2,"metadata":{},"data":{"text/plain":{"content":"I = \n   0.190474173611614\n","content_type":"text/plain"},"text/html":{"content":"<html><body><pre>I = \n   0.190474173611614\n</pre></body></html>","content_type":"text/html"}}}],"key":"gj23sYm16P"}],"key":"ntIoNtxIUH"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We start with the trapezoid formula on ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WRh69mdm6W"},{"type":"inlineMath","value":"n=N","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>=</mo><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">n=N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span>","key":"ENQXqa7HmC"},{"type":"text","value":" nodes.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"y6F046vuRc"}],"key":"rsDkLzMbus"}],"key":"EheUGBA6oa"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"N = 20;       % the coarsest formula\nn = N;  h = (b - a) / n;\nt = h * (0:n)';\ny = f(t);","key":"GeNwd675m3"},{"type":"output","id":"wZE1vQ1iqFol_xN6eN4gM","data":[],"key":"T921GOCQc8"}],"key":"NzOaJLQRhI"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We can now apply weights to get the estimate ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JkHiOo9e7D"},{"type":"inlineMath","value":"T_f(N)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>T</mi><mi>f</mi></msub><mo stretchy=\"false\">(</mo><mi>N</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">T_f(N)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0361em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10764em;\">f</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span></span></span></span>","key":"GficzTX8RQ"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"VYWoEq5LnJ"}],"key":"KYQXzPwmB0"}],"key":"HFMN4G6bbN"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"T = h * ( sum(y(2:n)) + y(1) / 2 + y(n+1) / 2 )","key":"b2XcN5kRCP"},{"type":"output","id":"-eaoti10YBAu8aS7d8Wig","data":[{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"text/plain":{"content":"T = \n   0.190411449939268\n","content_type":"text/plain"},"text/html":{"content":"<html><body><pre>T = \n   0.190411449939268\n</pre></body></html>","content_type":"text/html"}}}],"key":"C4O6R9sKAT"}],"key":"wDbvMtcKVB"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now we double to ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"HqW4ZnZiTc"},{"type":"inlineMath","value":"n=2N","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>=</mo><mn>2</mn><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">n=2N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord\">2</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span>","key":"sPGreGNnHw"},{"type":"text","value":", but we only need to evaluate ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"lqdYaIo7Vr"},{"type":"inlineMath","value":"f","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>","key":"m8obh9vRqU"},{"type":"text","value":" at every other interior node and apply ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LiCzyd5CJL"},{"type":"crossReference","kind":"equation","identifier":"nc-doubling","label":"nc-doubling","children":[{"type":"text","value":"(","key":"zgzg5z7Umw"},{"type":"text","value":"5.6.18","key":"RWk2WY6lnX"},{"type":"text","value":")","key":"cMpusshF9r"}],"template":"(%s)","enumerator":"5.6.18","resolved":true,"html_id":"nc-doubling","remote":true,"url":"/integration","dataUrl":"/integration.json","key":"ReGcV3aVFF"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"NYD3pykaom"}],"key":"RqXGCJKZzx"}],"key":"ttRZxvMDTO"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"n = 2*n;  h = h / 2;\nt = h * (0:n)';\nT(2) = T(1) / 2 + h * sum( f(t(2:2:n)) )","key":"x3DLmTUoYl"},{"type":"output","id":"yRUCnbJNsq0gF7tTDNXtf","data":[{"output_type":"execute_result","execution_count":5,"metadata":{},"data":{"text/plain":{"content":"T = 1×2 double\n   0.190411449939268   0.190458805859512\n","content_type":"text/plain"},"text/html":{"content":"<html><body><pre>T = 1×2 double\n   0.190411449939268   0.190458805859512\n</pre></body></html>","content_type":"text/html"}}}],"key":"Ex7LRat6W7"}],"key":"lXxVKMU0Ou"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We can repeat the same code to double ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"a1x4kIYzRm"},{"type":"inlineMath","value":"n","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"sTgwMldaOf"},{"type":"text","value":" again.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zctZydnaR6"}],"key":"meSLo6eSRx"}],"key":"p0eMJ7rvMl"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"n = 2*n;  h = h / 2;\nt = h * (0:n)';\nT(3) = T(2) / 2 + h * sum( f(t(2:2:n)) )","key":"Tpj6R8lHrD"},{"type":"output","id":"2rnuqN_qNF2SpInqFpTaJ","data":[{"output_type":"execute_result","execution_count":6,"metadata":{},"data":{"text/plain":{"content":"T = 1×3 double\n   0.190411449939268   0.190458805859512   0.190470351304644\n","content_type":"text/plain"},"text/html":{"content":"<html><body><pre>T = 1×3 double\n   0.190411449939268   0.190458805859512   0.190470351304644\n</pre></body></html>","content_type":"text/html"}}}],"key":"fadce7psuz"}],"key":"sli4V79UJ4"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Let us now do the first level of extrapolation to get results from Simpson’s formula. We combine the elements ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dJ8PKAWmHh"},{"type":"inlineCode","value":"T[i]","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"IQWJ5FkYos"},{"type":"text","value":" and ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"vpM4dimKz4"},{"type":"inlineCode","value":"T[i+1]","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jrlOpX2QC0"},{"type":"text","value":" the same way for ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pSgk1MjPh0"},{"type":"inlineMath","value":"i=1","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">i=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"xcL8jHLVg4"},{"type":"text","value":" and ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UqAdnus9Zp"},{"type":"inlineMath","value":"i=2","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi><mo>=</mo><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">i=2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span></span></span></span>","key":"zuJCg4wlpM"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"tq8ZP9MuyB"}],"key":"AoWLV7NZn8"}],"key":"aAVLXQDFZv"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"S = (4 * T(2:3) - T(1:2)) / 3","key":"fokf9DBJ4F"},{"type":"output","id":"dgIpJerH-egbotl_FisB3","data":[{"output_type":"execute_result","execution_count":7,"metadata":{},"data":{"text/plain":{"content":"S = 1×2 double\n   0.190474591166260   0.190474199786355\n","content_type":"text/plain"},"text/html":{"content":"<html><body><pre>S = 1×2 double\n   0.190474591166260   0.190474199786355\n</pre></body></html>","content_type":"text/html"}}}],"key":"dsTeBbiWKp"}],"key":"BZSeH1FdJP"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"With the two Simpson values ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qzVaaJ1BgA"},{"type":"inlineMath","value":"S_f(N)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>S</mi><mi>f</mi></msub><mo stretchy=\"false\">(</mo><mi>N</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">S_f(N)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0361em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10764em;\">f</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span></span></span></span>","key":"EsiAgOWC1q"},{"type":"text","value":" and ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"o0ImHJ04a1"},{"type":"inlineMath","value":"S_f(2N)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>S</mi><mi>f</mi></msub><mo stretchy=\"false\">(</mo><mn>2</mn><mi>N</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">S_f(2N)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0361em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10764em;\">f</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\">2</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span></span></span></span>","key":"QsJfrowsrG"},{"type":"text","value":" in hand, we can do one more level of extrapolation to get a sixth-order accurate result.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MjQgkn5UyH"}],"key":"gZuJQzSU85"}],"key":"raahZjsLHH"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"R = (16*S(2) - S(1)) / 15","key":"M1Mhpeuatr"},{"type":"output","id":"-WhYB2N1JK_LGkOipty5p","data":[{"output_type":"execute_result","execution_count":8,"metadata":{},"data":{"text/plain":{"content":"R = \n   0.190474173694362\n","content_type":"text/plain"},"text/html":{"content":"<html><body><pre>R = \n   0.190474173694362\n</pre></body></html>","content_type":"text/html"}}}],"key":"n8j4lfW8Hv"}],"key":"StuT3ZKuto"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We can make a triangular table of the errors:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"N4Dv2IrYgM"}],"key":"RT2jEB481t"}],"key":"z5hhq8O0G1"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"err2 = T(:) - I;\nerr4 = [NaN; S(:) - I];\nerr6 = [NaN; NaN; R - I];\nformat short e\ndisp(table(err2, err4, err6, variablenames=[\"order 2\", \"order 4\", \"order 6\"]))","key":"T6rN5KcP8a"},{"type":"output","id":"PLvri68SGXGHqwYNjVQ2I","data":[{"name":"stdout","output_type":"stream","text":"      order 2       order 4       order 6  \n    ___________    __________    __________\n\n    -6.2724e-05           NaN           NaN\n    -1.5368e-05    4.1755e-07           NaN\n    -3.8223e-06    2.6175e-08    8.2748e-11\n\n"}],"key":"fYVZKppopg"}],"key":"eD7zO7Pi4e"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"If we consider the computational time to be dominated by evaluations of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"FRevo7txcD"},{"type":"inlineMath","value":"f","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>","key":"aIxzZFGgWR"},{"type":"text","value":", then we have obtained a result with about twice as many accurate digits as the best trapezoid result, at virtually no extra cost.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"uBBNyXAtVD"}],"key":"AMHSA2MRTh"}],"key":"j0FloW8pV8"}],"key":"KQ6Wbyv6HT"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Trap","url":"/trap-1","group":"Chapter 5"},"next":{"title":"Motive","url":"/motive-1","group":"Chapter 5"}}},"domain":"http://localhost:3000"}