{"version":1,"kind":"Notebook","sha256":"c09c0b4a9ee497c2d3cd34fbf0a93ce331fa61d75eeb34fee9cae5f670c7c60e","slug":"chapter5-1","location":"/matlab/chapter5.md","dependencies":[],"frontmatter":{"title":"Chapter 5","numbering":{"heading_1":{"enabled":false},"heading_2":{"enabled":false},"heading_3":{"enabled":false},"heading_4":{"enabled":false},"heading_5":{"enabled":false},"heading_6":{"enabled":false},"title":{"offset":2}},"kernelspec":{"name":"jupyter_matlab_kernel","display_name":"MATLAB","language":"matlab"},"content_includes_title":false,"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"edit_url":"https://github.com/fncbook/fnc/blob/master/matlab/chapter5.md","exports":[{"format":"md","filename":"chapter5.md","url":"/build/chapter5-470b4b80dfa1a90b9e46666ab078691b.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Functions","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"KadoPNcgGL"}],"identifier":"functions","label":"Functions","html_id":"functions","implicit":true,"key":"cZB74jxkNb"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Hat function","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"zfMB99BQTA"}],"key":"Ge14XDFdbO"},{"type":"include","file":"FNC-matlab/hatfun.m","literal":true,"children":[{"type":"code","value":"function H = hatfun(t, k)\r\n% HATFUN   Hat function/piecewise linear basis function.\r\n% Input: \r\n%   t      interpolation nodes (vector, length n+1)\r\n%   k      node index (integer, in 0,...,n)\r\n% Output:\r\n%   H      kth hat function (function)\r\n\r\nn = length(t) - 1;\r\n\r\nfunction y = evaluate(x)\r\n    y = zeros(size(x));\r\n    for i = 1:numel(x)\r\n        if (k > 0) && (t(k) <= x(i)) && (x(i) <= t(k+1))\r\n            y(i) = (x(i) - t(k)) / (t(k+1) - t(k));\r\n        elseif (k < n) && (t(k+1) <= x(i)) && (x(i) <= t(k+2))\r\n            y(i) = (t(k+2) - x(i)) / (t(k+2) - t(k+1));\r\n        end\r\n    end\r\nend\r\n\r\nH = @evaluate;\r\nend","lang":"matlab","showLineNumbers":true,"filename":"hatfun.m","key":"Dz2PKjPEyP"}],"key":"krW55iJGd3"}],"label":"function-hatfun-matlab","identifier":"function-hatfun-matlab","html_id":"function-hatfun-matlab","key":"PTloTGhX9P"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Piecewise linear interpolation","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"SPwzvCaDcg"}],"key":"h48rlF8tzd"},{"type":"include","file":"FNC-matlab/plinterp.m","literal":true,"children":[{"type":"code","value":"function p = plinterp(t,y)\r\n% PLINTERP   Piecewise linear interpolation.\r\n% Input:\r\n%   t     interpolation nodes (vector, length n+1)\r\n%   y     interpolation values (vector, length n+1)\r\n% Output:\r\n%   p     piecewise linear interpolant (function)\r\n\r\nn = length(t) - 1;\r\nH = {};\r\nfor k = 0:n\r\n    H{k+1} = hatfun(t, k);\r\nend\r\np = @evaluate;\r\n\r\n    % This function evaluates p when called.\r\n    function f = evaluate(x)\r\n        f = 0;\r\n        for k = 0:n\r\n            f = f + y(k+1) * H{k+1}(x);\r\n        end\r\n    end\r\n\r\nend","lang":"matlab","showLineNumbers":true,"filename":"plinterp.m","key":"aztW9AQHtd"}],"key":"ShBSk4Yhpl"}],"label":"function-plinterp-matlab","identifier":"function-plinterp-matlab","html_id":"function-plinterp-matlab","key":"MwEtB8bdTW"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Cubic spline interpolation","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"tG89HaWtXz"}],"key":"PkduhTKXBz"},{"type":"include","file":"FNC-matlab/spinterp.m","literal":true,"children":[{"type":"code","value":"function S = spinterp(t,y)\r\n% SPINTERP   Cubic not-a-knot spline interpolation.\r\n% Input:\r\n%   t     interpolation nodes (vector, length n+1)\r\n%   y     interpolation values (vector, length n+1)\r\n% Output:\r\n%   S     not-a-knot cubic spline (function)\r\n\r\nt = t(:);  y = y(:);  % ensure column vectors\r\nn = length(t)-1;\r\nh = diff(t);          % differences of all adjacent pairs\r\n\r\n% Preliminary definitions.\r\nZ = zeros(n);\r\nI = eye(n);  E = I(1:n-1,:);\r\nJ = I - diag(ones(n-1,1),1);\r\nH = diag(h);\r\n\r\n% Left endpoint interpolation:\r\nAL = [ I, Z, Z, Z ];\r\nvL = y(1:n);\r\n\r\n% Right endpoint interpolation:\r\nAR = [ I, H, H^2, H^3 ];\r\nvR = y(2:n+1);\r\n\r\n% Continuity of first derivative:\r\nA1 = E*[ Z, J, 2*H, 3*H^2 ];\r\nv1 = zeros(n-1,1);\r\n\r\n% Continuity of second derivative:\r\nA2 = E*[ Z, Z, J, 3*H ];\r\nv2 = zeros(n-1,1);\r\n\r\n% Not-a-knot conditions:\r\nnakL = [ zeros(1,3*n), [1,-1, zeros(1,n-2)] ];\r\nnakR = [ zeros(1,3*n), [zeros(1,n-2), 1,-1] ];\r\n\r\n% Assemble and solve the full system.\r\nA = [ AL; AR; A1; A2; nakL; nakR ];\r\nv = [ vL; vR; v1; v2; 0 ;0 ];\r\nz = A\\v;\r\n\r\n% Break the coefficients into separate vectors.\r\nrows = 1:n;\r\na = z(rows);\r\nb = z(n+rows);  c = z(2*n+rows);  d = z(3*n+rows);\r\nS = @evaulate;\r\n\r\n    % This function evaluates the spline when called with a value for x.\r\n    function f = evaulate(x)\r\n        f = zeros(size(x));\r\n        for k = 1:n       % iterate over the pieces\r\n            % Evalaute this piece's cubic at the points inside it.\r\n            index = (x>=t(k)) & (x<=t(k+1));   \r\n            f(index) = polyval( [d(k),c(k),b(k),a(k)], x(index)-t(k) );\r\n        end\r\n    end\r\n\r\nend","lang":"matlab","showLineNumbers":true,"filename":"spinterp.m","key":"K9THfgmMF9"}],"key":"kjnjaxs6T6"}],"label":"function-spinterp-matlab","identifier":"function-spinterp-matlab","html_id":"function-spinterp-matlab","key":"IsTFAYIdRE"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Fornberg’s algorithm for finite difference weights","position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"key":"Md7tymXd4f"}],"key":"j0bKEaRwBQ"},{"type":"include","file":"FNC-matlab/fdweights.m","literal":true,"children":[{"type":"code","value":"function w = fdweights(t,m)\r\n%FDWEIGHTS   Fornberg's algorithm for finite difference weights.\r\n% Input:\r\n%   t    nodes (vector, length r+1)\r\n%   m    order of derivative sought at x=0 (integer scalar)\r\n% Output:\r\n%   w    weights for the approximation to the jth derivative (vector)\r\n\r\n% This is a compact implementation, not an efficient one. \r\n\r\nr = length(t)-1;\r\nw = zeros(size(t));\r\nfor k = 0:r\r\n  w(k+1) = weight(t,m,r,k);\r\nend\r\n\r\n\r\nfunction c = weight(t,m,r,k)\r\n% Implement a recursion for the weights.\r\n% Input:\r\n%   t   nodes (vector)\r\n%   m   order of derivative sought \r\n%   r   number of nodes to use from t (<= length(t))\r\n%   k   index of node whose weight is found \r\n% Output:\r\n%   c   finite difference weight \r\n\r\nif (m<0) || (m>r)        % undefined coeffs must be zero\r\n  c = 0;    \r\nelseif (m==0) && (r==0)  % base case of one-point interpolation\r\n  c = 1;   \r\nelse                     % generic recursion \r\n  if k<r\r\n    c = (t(r+1)*weight(t,m,r-1,k) - ...\r\n        m*weight(t,m-1,r-1,k))/(t(r+1)-t(k+1));\r\n  else\r\n    beta = prod(t(r)-t(1:r-1)) / prod(t(r+1)-t(1:r));\r\n    c = beta*(m*weight(t,m-1,r-1,r-1) - t(r)*weight(t,m,r-1,r-1));\r\n  end\r\nend","lang":"matlab","showLineNumbers":true,"filename":"fdweights.m","key":"EMxQqlYlGp"}],"key":"CdELl2t2D9"}],"label":"function-fdweights-matlab","identifier":"function-fdweights-matlab","html_id":"function-fdweights-matlab","key":"VipN0MFSBE"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Trapezoid formula for numerical integration","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"key":"tzTkIBIWKY"}],"key":"LaLrI62F28"},{"type":"include","file":"FNC-matlab/trapezoid.m","literal":true,"children":[{"type":"code","value":"function [T,t,y] = trapezoid(f,a,b,n)\n%TRAPEZOID   Trapezoid formula for numerical integration.\n% Input:\n%   f     integrand (function)\n%   a,b   interval of integration (scalars)\n%   n     number of interval divisions\n% Output:\n%   T     approximation to the integral of f over (a,b)\n%   t     vector of nodes used\n%   y     vector of function values at nodes\n\nh = (b-a)/n;\nt = a + h*(0:n)';\ny = f(t);\nT = h * ( sum(y(2:n)) + 0.5*(y(1) + y(n+1)) );","lang":"matlab","showLineNumbers":true,"filename":"trapezoid.m","key":"b83LtBabYH"}],"key":"WiUuxiQYDG"}],"label":"function-trapezoid-matlab","identifier":"function-trapezoid-matlab","html_id":"function-trapezoid-matlab","key":"ZE2wCTrLFR"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Adaptive integration","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"K6JJyugRYq"}],"key":"kxz1uCQzpr"},{"type":"include","file":"FNC-matlab/intadapt.m","literal":true,"children":[{"type":"code","value":"function [Q,t] = intadapt(f,a,b,tol)\n%INTADAPT   Adaptive integration with error estimation.\n% Input:\n%   f     integrand (function)\n%   a,b   interval of integration (scalars)\n%   tol   acceptable error\n% Output:\n%   Q     approximation to integral(f,a,b)\n%   t     vector of nodes used\n\nm = (b+a)/2;\n[Q,t] = do_integral(a,f(a),b,f(b),m,f(m),tol);\n\n    % Use error estimation and recursive bisection. \n    function [Q,t] = do_integral(a,fa,b,fb,m,fm,tol)\n        \n        % These are the two new nodes and their f-values.\n        xl = (a+m)/2;  fl = f(xl);\n        xr = (m+b)/2;  fr = f(xr);\n        t = [a;xl;m;xr;b];              % all 5 nodes at this level\n\n        % Compute the trapezoid values iteratively. \n        h = (b-a);\n        T(1) = h*(fa+fb)/2;\n        T(2) = T(1)/2 + (h/2)*fm;\n        T(3) = T(2)/2 + (h/4)*(fl+fr);\n        \n        S = (4*T(2:3)-T(1:2)) / 3;      % Simpson values\n        E = (S(2)-S(1)) / 15;           % error estimate\n                \n        if abs(E) < tol*(1+abs(S(2)))   % acceptable error?\n            Q = S(2);                   % yes--done\n        else\n            % Error is too large--bisect and recurse. \n            [QL,tL] = do_integral(a,fa,m,fm,xl,fl,tol);\n            [QR,tR] = do_integral(m,fm,b,fb,xr,fr,tol);\n            Q = QL + QR;\n            t = [tL;tR(2:end)];         % merge the nodes w/o duplicate\n        end        \n    end\n\nend  % main function","lang":"matlab","showLineNumbers":true,"filename":"intadapt.m","key":"LsOjKVNWmB"}],"key":"RjMRSshfUE"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"About the code","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"zsjXAPqYAK"}],"key":"XUxG3U7WR1"},{"type":"paragraph","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"children":[{"type":"text","value":"The intended way for a user to call ","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"key":"A6oDYPQK6D"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-intadapt","label":"function-intadapt","children":[{"type":"text","value":"Function ","key":"reZsR4jPUn"},{"type":"text","value":"5.7.1","key":"hdFEmcxPvt"}],"template":"Algorithm %s","enumerator":"5.7.1","resolved":true,"html_id":"function-intadapt","remote":true,"url":"/adaptive","dataUrl":"/adaptive.json","key":"rMpcBip9pW"},{"type":"text","value":" is with only ","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"key":"xaoEDsGg51"},{"type":"inlineCode","value":"f","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"key":"oe0ImhZwrr"},{"type":"text","value":", ","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"key":"SDeU2bzuYi"},{"type":"inlineCode","value":"a","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"key":"j6Aa8L4EMI"},{"type":"text","value":", ","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"key":"fouWK0mPK5"},{"type":"inlineCode","value":"b","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"key":"MQObIOEfvM"},{"type":"text","value":", and ","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"key":"ESzg2QR1SL"},{"type":"inlineCode","value":"tol","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"key":"YbuAq2t1cg"},{"type":"text","value":" provided. We then use default values on the other parameters to compute the function values at the endpoints, the interval’s midpoint, and the function value at the midpoint. Recursive calls from within the function itself will provide all of that information, since it was already calculated along the way.","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"key":"YiQOfqe2Po"}],"key":"ZxqwU8FIoC"}],"class":"dropdown","key":"IKqwYVvJas"}],"label":"function-intadapt-matlab","identifier":"function-intadapt-matlab","html_id":"function-intadapt-matlab","key":"Z7QJUKAB7Z"},{"type":"heading","depth":2,"position":{"start":{"line":71,"column":1},"end":{"line":71,"column":1}},"children":[{"type":"text","value":"Examples","position":{"start":{"line":71,"column":1},"end":{"line":71,"column":1}},"key":"xY0lbLCgrX"}],"identifier":"examples","label":"Examples","html_id":"examples","implicit":true,"key":"qvhvxjNXOn"}],"key":"PYKcr7Yrbz"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"cd  /Users/driscoll/Documents/GitHub/fnc/matlab\nFNC_init;\npwd","visibility":"show","key":"y9GOh1rBN8"},{"type":"output","id":"4geDxfuksZFr_3GV2ay_e","data":[{"output_type":"stream","name":"stdout","text":"Starting MATLAB ...\n"},{"output_type":"stream","name":"stdout","text":"Executing ..."},{"output_type":"execute_result","execution_count":1,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = '/Users/driscoll/Dropbox/Mac/Documents/GitHub/fnc/matlab'</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = '/Users/driscoll/Dropbox/Mac/Documents/GitHub/fnc/matlab'","content_type":"text/plain"}}}],"visibility":"show","key":"U48h8VVCFZ"}],"data":{"tags":[]},"visibility":"remove","key":"NsRHV5qlRS"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":80,"column":1},"end":{"line":80,"column":1}},"children":[{"type":"text","value":"5.1 ","position":{"start":{"line":80,"column":1},"end":{"line":80,"column":1}},"key":"z5EUUPiudb"},{"type":"link","identifier":"section-localapprox-interpolation","label":"section-localapprox-interpolation","kind":"narrative","position":{"start":{"line":80,"column":5},"end":{"line":80,"column":39}},"url":"/interpolation","internal":true,"dataUrl":"/interpolation.json","children":[{"type":"text","value":"The interpolation problem","key":"yFdy1R30pg"}],"key":"puWWVIHwIq"}],"identifier":"id-5-1","label":"5.1 ","html_id":"id-5-1","implicit":true,"key":"JCYLh8NnVO"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-interpolation-global","label":"demo-interpolation-global","kind":"proof:example","position":{"start":{"line":83,"column":1},"end":{"line":83,"column":27}},"children":[{"type":"text","value":"Example ","key":"XRRK8ZnLtA"},{"type":"text","value":"5.1.1","key":"BSpOIRH4i6"}],"template":"Example %s","enumerator":"5.1.1","resolved":true,"html_id":"demo-interpolation-global","remote":true,"url":"/interpolation","dataUrl":"/interpolation.json","key":"j6KCp92JQS"}],"key":"aFU3Ixcd1S"},{"type":"paragraph","position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"children":[{"type":"text","value":"Here are some points that we could consider to be observations of an unknown function on ","position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"key":"vXuQz0BpSx"},{"type":"inlineMath","value":"[-1,1]","position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mo>−</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[-1,1]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">−</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]</span></span></span></span>","key":"GEFOz62khe"},{"type":"text","value":".","position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"key":"FI3enFfgbZ"}],"key":"DFtkcFvGhr"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"n = 5;\nt = linspace(-1,1,n+1)';  \ny = t.^2 + t + 0.05 * sin(20 * t);\nclf, scatter(t,y)","key":"toJN28mcD6"},{"type":"output","id":"2nTlE-TydxCmidAKHJOG-","data":[{"output_type":"execute_result","execution_count":2,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"bb38cc64daccd5d8c714dac9d988566a","path":"/build/bb38cc64daccd5d8c714dac9d988566a.png"}}}],"key":"T8dcDBgDP9"}],"data":{},"key":"ZrRGRJI0Zf"},{"type":"paragraph","position":{"start":{"line":97,"column":1},"end":{"line":97,"column":1}},"children":[{"type":"text","value":"The polynomial interpolant, as computed using ","position":{"start":{"line":97,"column":1},"end":{"line":97,"column":1}},"key":"kK7iVUEfEO"},{"type":"inlineCode","value":"polyfit","position":{"start":{"line":97,"column":1},"end":{"line":97,"column":1}},"key":"sdKewzeYVX"},{"type":"text","value":", looks very sensible. It’s the kind of function you’d take home to meet your parents.","position":{"start":{"line":97,"column":1},"end":{"line":97,"column":1}},"key":"HuvymFG12C"}],"indexEntries":[{"entry":"Julia","subEntry":{"value":"fit","kind":"entry"},"emphasis":true}],"label":"index-TXQdBSsAz7","identifier":"index-txqdbssaz7","html_id":"index-txqdbssaz7","key":"zdS6cOgMjW"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"c = polyfit(t, y, n);     % polynomial coefficients\np = @(x) polyval(c, x);\nhold on\nfplot(p, [-1 1])\nlegend('data', 'interpolant', 'location', 'north');","key":"GTnVJoptcz"},{"type":"output","id":"erMOtnTLgkNKL5HmhPx_A","data":[{"output_type":"stream","name":"stderr","text":"Error using polyfit (line 49)\nThe first two inputs must have the same number of elements."}],"key":"VO8FJvk6RO"}],"data":{},"key":"nINhRfWPsS"},{"type":"paragraph","position":{"start":{"line":107,"column":1},"end":{"line":107,"column":1}},"children":[{"type":"text","value":"But now consider a different set of points generated in almost exactly the same way.","position":{"start":{"line":107,"column":1},"end":{"line":107,"column":1}},"key":"EOGe8fiA0I"}],"key":"IEbwru8vbH"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"n = 18;\nt = linspace(-1, 1, n+1);\ny = t.^2 + t + 0.05 * sin(20 * t);\nclf, scatter(t, y)","key":"iaqCo6cgmX"},{"type":"output","id":"v2Km8V7Gxytrzle1y0GsV","data":[{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"fbeb7dd0d0c829ad982f34c25ae3551c","path":"/build/fbeb7dd0d0c829ad982f34c25ae3551c.png"}}}],"key":"UAHla6zJ0O"}],"data":{},"key":"gxJ6Gl3SXt"},{"type":"paragraph","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"children":[{"type":"text","value":"The points themselves are unremarkable. But take a look at what happens to the polynomial interpolant.","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"key":"HgJoQBPima"}],"key":"y3q8Tbru6F"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"c = polyfit(t, y, n);     % polynomial coefficients\np = @(x) polyval(c, x);\nhold on, fplot(p, [-1 1])\nlegend('data', 'interpolant', 'location', 'north');","key":"YzvE5ixhtl"},{"type":"output","id":"aYzAS1TEcpg7r-PfscaSw","data":[{"output_type":"execute_result","execution_count":5,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"4916b705c31780758ca2534ef2fa301c","path":"/build/4916b705c31780758ca2534ef2fa301c.png"}}}],"key":"pDSPbZOYG5"}],"data":{},"key":"Fzz0tYYjZA"},{"type":"paragraph","position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"children":[{"type":"text","value":"Surely there must be functions that are more intuitively representative of those points!","position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"key":"vqoRCidcsE"}],"key":"xprio0HoXy"}],"label":"demo-interpolation-global-matlab","identifier":"demo-interpolation-global-matlab","html_id":"demo-interpolation-global-matlab","key":"SuKVosg0Xz"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-interpolation-pwise","label":"demo-interpolation-pwise","kind":"proof:example","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":26}},"children":[{"type":"text","value":"Example ","key":"UxSfZEggNZ"},{"type":"text","value":"5.1.3","key":"NWJoyCAYuj"}],"template":"Example %s","enumerator":"5.1.3","resolved":true,"html_id":"demo-interpolation-pwise","remote":true,"url":"/interpolation","dataUrl":"/interpolation.json","key":"YDVDkWePr5"}],"key":"FBdK9HiwFN"},{"type":"paragraph","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"children":[{"type":"text","value":"Let us recall the data from ","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"key":"JBuVeYaCsu"},{"type":"crossReference","kind":"proof:example","identifier":"demo-interpolation-global","label":"demo-interpolation-global","children":[{"type":"text","value":"Demo ","key":"bT1n513rBb"},{"type":"text","value":"5.1.1","key":"OByZHSLe1l"}],"template":"Example %s","enumerator":"5.1.1","resolved":true,"html_id":"demo-interpolation-global","remote":true,"url":"/interpolation","dataUrl":"/interpolation.json","key":"eP12M212Sd"},{"type":"text","value":".","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"key":"HkkcqqzAxx"}],"key":"zDfpCMcLW6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"n = 18;\nt = linspace(-1, 1, n+1);\ny = t.^2 + t + 0.05 * sin(20 * t);\nclf, scatter(t, y)","key":"W5SmGgVcNp"},{"type":"output","id":"GZkDM78F_L-Y3gTXSEBsW","data":[{"output_type":"execute_result","execution_count":6,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"5b2c6ca63846f7cd09735b49d236565a","path":"/build/5b2c6ca63846f7cd09735b49d236565a.png"}}}],"key":"vpRjq2Ovll"}],"data":{},"key":"AQWvwtOLtk"},{"type":"paragraph","position":{"start":{"line":140,"column":1},"end":{"line":140,"column":1}},"children":[{"type":"text","value":"Here is an interpolant that is linear between each consecutive pair of nodes, using ","position":{"start":{"line":140,"column":1},"end":{"line":140,"column":1}},"key":"kv3Qctsr8M"},{"type":"inlineCode","value":"interp1","position":{"start":{"line":140,"column":1},"end":{"line":140,"column":1}},"key":"j2ddkmJMK8"},{"type":"text","value":" from MATLAB.","position":{"start":{"line":140,"column":1},"end":{"line":140,"column":1}},"key":"Lhc56rlGW0"}],"key":"zh0iMeN4bG"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"x = linspace(-1, 1, 400)';\nhold on, plot(x, interp1(t, y, x))\ntitle('Piecewise linear interpolant')","key":"YTS3LajzXf"},{"type":"output","id":"-CztuYbSoXa4JOrSMPzAF","data":[{"output_type":"execute_result","execution_count":7,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"588a702ff0ba69afb5f768126e30d4c3","path":"/build/588a702ff0ba69afb5f768126e30d4c3.png"}}},{"output_type":"stream","name":"stderr","text":"Error using interp1>reshapeAndSortXandV (line 448)\nX and V must be of the same length.\n\nError in interp1 (line 128)\n    [X,V,orig_size_v] = reshapeAndSortXandV(X,V);"}],"key":"cGd39qPct2"}],"data":{},"key":"s3UTvNByg6"},{"type":"paragraph","position":{"start":{"line":148,"column":1},"end":{"line":148,"column":1}},"children":[{"type":"text","value":"We may prefer a smoother interpolant that is piecewise cubic, generated using ","position":{"start":{"line":148,"column":1},"end":{"line":148,"column":1}},"key":"Q5qf13R7rS"},{"type":"inlineCode","value":"Spline1D","position":{"start":{"line":148,"column":1},"end":{"line":148,"column":1}},"key":"gn68bByDjv"},{"type":"text","value":" from the ","position":{"start":{"line":148,"column":1},"end":{"line":148,"column":1}},"key":"RAWgGP1hCd"},{"type":"inlineCode","value":"Dierckx","position":{"start":{"line":148,"column":1},"end":{"line":148,"column":1}},"key":"duyzQSqO4p"},{"type":"text","value":" package.","position":{"start":{"line":148,"column":1},"end":{"line":148,"column":1}},"key":"Z2s82ED5yF"}],"key":"BJpvpfqjNY"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"cla\nscatter(t, y)\nplot(x, interp1(t, y, x, 'spline'))\ntitle('Piecewise cubic interpolant')","key":"eNV86xhKkY"},{"type":"output","id":"Ucn1G8c2qbaBjb_Xi5B4C","data":[{"output_type":"execute_result","execution_count":8,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"b0bd63c6f168eab49227d69879426591","path":"/build/b0bd63c6f168eab49227d69879426591.png"}}},{"output_type":"stream","name":"stderr","text":"Error using scatter (line 68)\nX and Y must be vectors of the same length, matrices of the same size, or a combination of a vector and a matrix where the length of the vector matches either the number of rows or columns of the matrix."}],"key":"VeFoRT7apB"}],"data":{},"key":"JQIRSS17g7"}],"label":"demo-interpolation-pwise-matlab","identifier":"demo-interpolation-pwise-matlab","html_id":"demo-interpolation-pwise-matlab","key":"XyT0jeRE8Z"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-interp-cond","label":"demo-interp-cond","kind":"proof:example","position":{"start":{"line":159,"column":1},"end":{"line":159,"column":18}},"children":[{"type":"text","value":"Example ","key":"bFWOsyzdGS"},{"type":"text","value":"5.1.4","key":"HwnipvKbk4"}],"template":"Example %s","enumerator":"5.1.4","resolved":true,"html_id":"demo-interp-cond","remote":true,"url":"/interpolation","dataUrl":"/interpolation.json","key":"UkcqB8YxHa"}],"key":"YfD15AJclX"},{"type":"paragraph","position":{"start":{"line":161,"column":1},"end":{"line":161,"column":1}},"children":[{"type":"text","value":"In ","position":{"start":{"line":161,"column":1},"end":{"line":161,"column":1}},"key":"Z2wfh6lCD6"},{"type":"crossReference","kind":"proof:example","identifier":"demo-interpolation-global","label":"demo-interpolation-global","children":[{"type":"text","value":"Demo ","key":"UwBfHDAnKc"},{"type":"text","value":"5.1.1","key":"ncL1wepmNd"}],"template":"Example %s","enumerator":"5.1.1","resolved":true,"html_id":"demo-interpolation-global","remote":true,"url":"/interpolation","dataUrl":"/interpolation.json","key":"wNAj7BLREG"},{"type":"text","value":" and ","position":{"start":{"line":161,"column":1},"end":{"line":161,"column":1}},"key":"spBjrfOyka"},{"type":"crossReference","kind":"proof:example","identifier":"demo-interpolation-pwise","label":"demo-interpolation-pwise","children":[{"type":"text","value":"Demo ","key":"aWnf79ZpuJ"},{"type":"text","value":"5.1.3","key":"eh65vZuK3L"}],"template":"Example %s","enumerator":"5.1.3","resolved":true,"html_id":"demo-interpolation-pwise","remote":true,"url":"/interpolation","dataUrl":"/interpolation.json","key":"P7x03Om5Sr"},{"type":"text","value":" we saw a big difference between polynomial interpolation and piecewise polynomial interpolation of some arbitrarily chosen data. The same effects can be seen clearly in the cardinal functions, which are closely tied to the condition numbers.","position":{"start":{"line":161,"column":1},"end":{"line":161,"column":1}},"key":"CFlS2fU1fc"}],"key":"hnThIDaLT8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"n = 18;\nt = linspace(-1, 1, n+1)';\ny = [zeros(9, 1); 1; zeros(n - 9, 1)];    % 10th cardinal function\nclf, scatter(t, y)\nhold on\nx = linspace(-1, 1, 400)';\nplot(x, interp1(t, y, x, 'spline'))\ntitle('Piecewise cubic cardinal function') \nxlabel('x'), ylabel('p(x)')","key":"fGtinrtyNH"},{"type":"output","id":"tN5_3E5Vjhm6XTnQ_WYx-","data":[{"output_type":"execute_result","execution_count":9,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"41cf43b0bc612306153e07e277c96644","path":"/build/41cf43b0bc612306153e07e277c96644.png"}}}],"key":"Nb4tv12ZUb"}],"data":{},"key":"QjwpC8rnoQ"},{"type":"paragraph","position":{"start":{"line":175,"column":1},"end":{"line":175,"column":1}},"children":[{"type":"text","value":"The piecewise cubic cardinal function is nowhere greater than one in absolute value. This happens to be true for all the cardinal functions, ensuring a good condition number for any interpolation with these functions. But the story for global polynomials is very different.","position":{"start":{"line":175,"column":1},"end":{"line":175,"column":1}},"key":"CH9y6YlabD"}],"key":"MOlGo4LAeg"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf, scatter(t, y)\nc = polyfit(t, y, n);\nhold on, plot(x, polyval(c, x))\ntitle('Polynomial cardinal function')\nxlabel('x'), ylabel(('p(x)'));","key":"IcJSWgHYHh"},{"type":"output","id":"5HKn1_vuG74mcdkHkBorn","data":[{"output_type":"stream","name":"stderr","text":"Error using scatter (line 68)\nX and Y must be vectors of the same length, matrices of the same size, or a combination of a vector and a matrix where the length of the vector matches either the number of rows or columns of the matrix."}],"key":"QTsfoMHynR"}],"data":{},"key":"gb2rHeQbdh"},{"type":"paragraph","position":{"start":{"line":185,"column":1},"end":{"line":185,"column":1}},"children":[{"type":"text","value":"From the figure we can see that the condition number for polynomial interpolation on these nodes is at least 500.","position":{"start":{"line":185,"column":1},"end":{"line":185,"column":1}},"key":"O4IOaXqNFF"}],"key":"wzH0sYk0kk"}],"label":"demo-interp-cond-matlab","identifier":"demo-interp-cond-matlab","html_id":"demo-interp-cond-matlab","key":"SZ7LuhqBln"},{"type":"heading","depth":3,"position":{"start":{"line":188,"column":1},"end":{"line":188,"column":1}},"children":[{"type":"text","value":"5.2 ","position":{"start":{"line":188,"column":1},"end":{"line":188,"column":1}},"key":"GoBO0lXKJX"},{"type":"link","identifier":"section-localapprox-pwlin","label":"section-localapprox-pwlin","kind":"narrative","position":{"start":{"line":188,"column":5},"end":{"line":188,"column":31}},"url":"/pwlin","internal":true,"dataUrl":"/pwlin.json","children":[{"type":"text","value":"Piecewise linear interpolation","key":"sHpngO0SGt"}],"key":"VvpZijr4Q8"}],"identifier":"id-5-2","label":"5.2 ","html_id":"id-5-2","implicit":true,"key":"KS0yluQwHP"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-pwlin-hat","label":"demo-pwlin-hat","kind":"proof:example","position":{"start":{"line":191,"column":1},"end":{"line":191,"column":16}},"children":[{"type":"text","value":"Example ","key":"rA4O1uxWxT"},{"type":"text","value":"5.2.1","key":"xTp4QvZElk"}],"template":"Example %s","enumerator":"5.2.1","resolved":true,"html_id":"demo-pwlin-hat","remote":true,"url":"/pwlin","dataUrl":"/pwlin.json","key":"yD7gA1oBYs"}],"key":"n2F8yHa3sS"},{"type":"paragraph","position":{"start":{"line":193,"column":1},"end":{"line":193,"column":1}},"children":[{"type":"text","value":"Let’s define a set of four nodes (i.e., ","position":{"start":{"line":193,"column":1},"end":{"line":193,"column":1}},"key":"xx1WSspstG"},{"type":"inlineMath","value":"n=3","position":{"start":{"line":193,"column":1},"end":{"line":193,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>=</mo><mn>3</mn></mrow><annotation encoding=\"application/x-tex\">n=3</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">3</span></span></span></span>","key":"OG4VFFPd8f"},{"type":"text","value":" in our formulas).","position":{"start":{"line":193,"column":1},"end":{"line":193,"column":1}},"key":"JRQU1wXot1"}],"key":"h3IEzrbLFa"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"t = [0, 0.55, 0.7, 1];","key":"JYMuCGVMX5"},{"type":"output","id":"CCFSSteh16H7FSn4-GLXG","data":[],"key":"SGN1zyfCW7"}],"data":{},"indexEntries":[{"entry":"Julia","subEntry":{"value":"annotate!","kind":"entry"},"emphasis":true}],"label":"index-BV9jnkXMWO","identifier":"index-bv9jnkxmwo","html_id":"index-bv9jnkxmwo","key":"BCNmDROXNo"},{"type":"paragraph","position":{"start":{"line":202,"column":1},"end":{"line":202,"column":1}},"children":[{"type":"text","value":"We plot the hat functions ","position":{"start":{"line":202,"column":1},"end":{"line":202,"column":1}},"key":"ruWXf6IWun"},{"type":"inlineMath","value":"H_0,\\ldots,H_3","position":{"start":{"line":202,"column":1},"end":{"line":202,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>H</mi><mn>0</mn></msub><mo separator=\"true\">,</mo><mo>…</mo><mo separator=\"true\">,</mo><msub><mi>H</mi><mn>3</mn></msub></mrow><annotation encoding=\"application/x-tex\">H_0,\\ldots,H_3</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0813em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0813em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"a7j1iB3xcy"},{"type":"text","value":".","position":{"start":{"line":202,"column":1},"end":{"line":202,"column":1}},"key":"EQTO5gDRHf"}],"key":"AAgCJPtJTj"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf\nfor k = 0:3\n    subplot(4, 1, k+1)\n    Hk = hatfun(t, k);\n    fplot(Hk, [0, 1])\n    hold on\n    scatter(t, Hk(t))\n    text(t(k+1), 0.6, sprintf(\"H_%d\", k))\nend","key":"vTmJlQ38tG"},{"type":"output","id":"WeJL7a9zcHmQN6mIO-Z59","data":[{"output_type":"execute_result","execution_count":12,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"6d3266d6d3d4f8f6cadb31fe1247e1d2","path":"/build/6d3266d6d3d4f8f6cadb31fe1247e1d2.png"}}}],"key":"vjh6jn9UfC"}],"data":{},"key":"kyQKFCfO3i"}],"label":"demo-pwlin-hat-matlab","identifier":"demo-pwlin-hat-matlab","html_id":"demo-pwlin-hat-matlab","key":"SMhO9i9AE1"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-pwlin-usage","label":"demo-pwlin-usage","kind":"proof:example","position":{"start":{"line":218,"column":1},"end":{"line":218,"column":18}},"children":[{"type":"text","value":"Example ","key":"uj91pMMHDY"},{"type":"text","value":"5.2.2","key":"X1u4qhZdpy"}],"template":"Example %s","enumerator":"5.2.2","resolved":true,"html_id":"demo-pwlin-usage","remote":true,"url":"/pwlin","dataUrl":"/pwlin.json","key":"PaNd0E1tkJ"}],"key":"sL8wd2GDfi"},{"type":"paragraph","position":{"start":{"line":220,"column":1},"end":{"line":220,"column":1}},"children":[{"type":"text","value":"We generate a piecewise linear interpolant of ","position":{"start":{"line":220,"column":1},"end":{"line":220,"column":1}},"key":"HHE9eP6qY6"},{"type":"inlineMath","value":"f(x)=e^{\\sin 7x}","position":{"start":{"line":220,"column":1},"end":{"line":220,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msup><mi>e</mi><mrow><mi>sin</mi><mo>⁡</mo><mn>7</mn><mi>x</mi></mrow></msup></mrow><annotation encoding=\"application/x-tex\">f(x)=e^{\\sin 7x}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8305em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8305em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mop mtight\"><span class=\"mtight\">s</span><span class=\"mtight\">i</span><span class=\"mtight\">n</span></span><span class=\"mspace mtight\" style=\"margin-right:0.1952em;\"></span><span class=\"mord mtight\">7</span><span class=\"mord mathnormal mtight\">x</span></span></span></span></span></span></span></span></span></span></span></span>","key":"E82hBx0Ty8"},{"type":"text","value":".","position":{"start":{"line":220,"column":1},"end":{"line":220,"column":1}},"key":"YK06WU0F52"}],"key":"d4IEV8BPAQ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"f = @(x) exp(sin(7 * x));\nclf\nfplot(f, [0, 1], displayname=\"function\")\nxlabel(\"x\");  ylabel((\"y\"));","key":"VrefpOxPH1"},{"type":"output","id":"DPDCwMli2mz7UZUZpXICG","data":[{"output_type":"execute_result","execution_count":13,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"b8fcd8f2d2e2e03c0925c7e84600b258","path":"/build/b8fcd8f2d2e2e03c0925c7e84600b258.png"}}}],"key":"G8nQUwisgO"}],"data":{},"key":"IGbyEYFjs6"},{"type":"paragraph","position":{"start":{"line":229,"column":1},"end":{"line":229,"column":1}},"children":[{"type":"text","value":"First we sample the function to create the data.","position":{"start":{"line":229,"column":1},"end":{"line":229,"column":1}},"key":"itGS2Ggii8"}],"key":"z0wed8tJ9K"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"t = [0, 0.075, 0.25, 0.55, 0.7, 1];    % nodes\ny = f(t);                              % function values","key":"Ir7Hg39XY1"},{"type":"output","id":"dNiCWyYzKJNODS1utLRgW","data":[],"key":"MRqgSajKk0"}],"data":{},"key":"PSwl2nGyMc"},{"type":"paragraph","position":{"start":{"line":236,"column":1},"end":{"line":236,"column":1}},"children":[{"type":"text","value":"Now we create a callable function that will evaluate the piecewise linear interpolant at any ","position":{"start":{"line":236,"column":1},"end":{"line":236,"column":1}},"key":"TZxB8lJkeL"},{"type":"inlineMath","value":"x","position":{"start":{"line":236,"column":1},"end":{"line":236,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"NOUITOMKMs"},{"type":"text","value":", and then plot it.","position":{"start":{"line":236,"column":1},"end":{"line":236,"column":1}},"key":"LX9QzcWiRw"}],"key":"ozb7vMI41j"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"p = plinterp(t, y);\nhold on\nfplot(p, [0, 1], displayname=\"interpolant\")\nscatter(t, y, displayname=\"values at nodes\")\ntitle(\"PL interpolation\")\nlegend();","key":"JdreiyHiMp"},{"type":"output","id":"c9QYuHoPZ85Rvc_8ofBaL","data":[{"output_type":"execute_result","execution_count":15,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"d28826e8c61d9976375c9bac1ddc061c","path":"/build/d28826e8c61d9976375c9bac1ddc061c.png"}}},{"output_type":"stream","name":"stderr","text":"Error using scatter (line 68)\nX and Y must be vectors of the same length, matrices of the same size, or a combination of a vector and a matrix where the length of the vector matches either the number of rows or columns of the matrix."}],"key":"MXGIIDBihb"}],"data":{},"key":"HS1JlGBLgR"}],"label":"demo-pwlin-usage-matlab","identifier":"demo-pwlin-usage-matlab","html_id":"demo-pwlin-usage-matlab","key":"itpxsbdNGq"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-pwlin-converge","label":"demo-pwlin-converge","kind":"proof:example","position":{"start":{"line":249,"column":1},"end":{"line":249,"column":21}},"children":[{"type":"text","value":"Example ","key":"qmAmVXHSQv"},{"type":"text","value":"5.2.3","key":"yLJwhbvGJA"}],"template":"Example %s","enumerator":"5.2.3","resolved":true,"html_id":"demo-pwlin-converge","remote":true,"url":"/pwlin","dataUrl":"/pwlin.json","key":"P4d3RssADC"}],"key":"DZnU5B10yh"},{"type":"paragraph","position":{"start":{"line":251,"column":1},"end":{"line":251,"column":1}},"children":[{"type":"text","value":"We measure the convergence rate for piecewise linear interpolation of ","position":{"start":{"line":251,"column":1},"end":{"line":251,"column":1}},"key":"NRjpK0Zhav"},{"type":"inlineMath","value":"e^{\\sin 7x}","position":{"start":{"line":251,"column":1},"end":{"line":251,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>e</mi><mrow><mi>sin</mi><mo>⁡</mo><mn>7</mn><mi>x</mi></mrow></msup></mrow><annotation encoding=\"application/x-tex\">e^{\\sin 7x}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8305em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8305em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mop mtight\"><span class=\"mtight\">s</span><span class=\"mtight\">i</span><span class=\"mtight\">n</span></span><span class=\"mspace mtight\" style=\"margin-right:0.1952em;\"></span><span class=\"mord mtight\">7</span><span class=\"mord mathnormal mtight\">x</span></span></span></span></span></span></span></span></span></span></span></span>","key":"fLyMXIEIAF"},{"type":"text","value":" over ","position":{"start":{"line":251,"column":1},"end":{"line":251,"column":1}},"key":"lrHL5X1NJL"},{"type":"inlineMath","value":"x \\in [0,1]","position":{"start":{"line":251,"column":1},"end":{"line":251,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mo>∈</mo><mo stretchy=\"false\">[</mo><mn>0</mn><mo separator=\"true\">,</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">x \\in [0,1]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]</span></span></span></span>","key":"PZloo7ZZ1s"},{"type":"text","value":".","position":{"start":{"line":251,"column":1},"end":{"line":251,"column":1}},"key":"lo8tl34J23"}],"key":"lGDg10dHfy"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"f = @(x) exp(sin(7 * x));\nx = linspace(0, 1, 10001)';    % sample the difference at many points\nn = round(10.^(1:0.25:3.5))';\nmaxerr = zeros(size(n));\nfor i = 1:length(n)\n    t = (0:n(i)) / n(i);       % interpolation nodes\n    p = plinterp(t, f(t));\n    maxerr(i) = norm(f(x) - p(x), Inf);\nend\ntable(n(1:4:end), maxerr(1:4:end), variableNames=[\"n\", \"inf-norm error\"])","key":"u8899Ot54f"},{"type":"output","id":"CMQvRwyF_PFjuNy_5hRBI","data":[{"output_type":"execute_result","execution_count":16,"metadata":{},"data":{"text/html":{"content":"<html><head><style>.mwBasicVariableOutputWrapper .mwBasicVariableOutputHeader {font-style: italic;}</style></head><body><div class='mwBasicVariableOutputWrapper'><div>ans = <span class='mwBasicVariableOutputHeader'>3x2 table</span></div><table><thead><tr><th>n</th><th>inf-norm error</th></tr></thead><tbody><tr><td>10</td><td>0.150470931225636</td></tr><tr><td>100</td><td>0.001664209186467</td></tr><tr><td>1000</td><td>1.664939172663082e-05</td></tr></tbody></table></div></body></html>","content_type":"text/html"},"text/plain":{"content":"<html><head><style>.mwBasicVariableOutputWrapper .mwBasicVariableOutputHeader {font-style: italic;}</style></head><body><div class='mwBasicVariableOutputWrapper'><div>ans = <span class='mwBasicVariableOutputHeader'>3x2 table</span></div><table><thead><tr><th>n</th><th>inf-norm error</th></tr></thead><tbody><tr><td>10</td><td>0.150470931225636</td></tr><tr><td>100</td><td>0.001664209186467</td></tr><tr><td>1000</td><td>1.664939172663082e-05</td></tr></tbody></table></div></body></html>","content_type":"text/plain"}}}],"key":"EflkCXzTqg"}],"data":{},"key":"Tnmzz4AKqw"},{"type":"paragraph","position":{"start":{"line":266,"column":1},"end":{"line":266,"column":1}},"children":[{"type":"text","value":"As predicted, a factor of 10 in ","position":{"start":{"line":266,"column":1},"end":{"line":266,"column":1}},"key":"MOI1d2PFAD"},{"type":"inlineMath","value":"n","position":{"start":{"line":266,"column":1},"end":{"line":266,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"WDmLSDgwcU"},{"type":"text","value":" produces a factor of 100 reduction in the error. In a convergence plot, it is traditional to have ","position":{"start":{"line":266,"column":1},"end":{"line":266,"column":1}},"key":"Kkc4zViH8C"},{"type":"inlineMath","value":"h","position":{"start":{"line":266,"column":1},"end":{"line":266,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>h</mi></mrow><annotation encoding=\"application/x-tex\">h</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">h</span></span></span></span>","key":"bVWeQUYe5d"},{"type":"text","value":" ","position":{"start":{"line":266,"column":1},"end":{"line":266,"column":1}},"key":"HtlrThkxDw"},{"type":"emphasis","position":{"start":{"line":266,"column":1},"end":{"line":266,"column":1}},"children":[{"type":"text","value":"decrease","position":{"start":{"line":266,"column":1},"end":{"line":266,"column":1}},"key":"EcjP6LmgWN"}],"key":"v6yVeoo70T"},{"type":"text","value":" from left to right, so we expect a straight line of slope ","position":{"start":{"line":266,"column":1},"end":{"line":266,"column":1}},"key":"HCOYnaa70D"},{"type":"text","value":"-2","position":{"start":{"line":266,"column":1},"end":{"line":266,"column":1}},"key":"IAX3PauMis"},{"type":"text","value":" on a log-log plot.","position":{"start":{"line":266,"column":1},"end":{"line":266,"column":1}},"key":"wgE8DpYLee"}],"key":"GSGkIlOeg3"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf\nloglog(n, maxerr, \"-o\", displayname=\"error\")\norder2 = 0.5 * maxerr(end) * (n / n(end)) .^ (-2);\nhold on\nloglog(n, order2, \"k--\", displayname=\"O(n^{-2})\")\nxlabel(\"n\");  ylabel(\"|| f-p ||_{\\infty}\")\ntitle(\"Convergence of PL interpolation\")\nlegend();","key":"DeYj838CXp"},{"type":"output","id":"38etMeN67SV_qXrnDTGYF","data":[{"output_type":"execute_result","execution_count":17,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"8d265d3f6f1d97e1a20b1ccb1b61aa3e","path":"/build/8d265d3f6f1d97e1a20b1ccb1b61aa3e.png"}}}],"key":"GgufdDnpJw"}],"data":{},"key":"lnZGhaXiBn"}],"label":"demo-pwlin-converge-matlab","identifier":"demo-pwlin-converge-matlab","html_id":"demo-pwlin-converge-matlab","key":"Cu5mpGTNkP"},{"type":"heading","depth":3,"position":{"start":{"line":280,"column":1},"end":{"line":280,"column":1}},"children":[{"type":"text","value":"5.3 ","position":{"start":{"line":280,"column":1},"end":{"line":280,"column":1}},"key":"TSxpxLgcH8"},{"type":"link","identifier":"section-localapprox-splines","label":"section-localapprox-splines","kind":"narrative","position":{"start":{"line":280,"column":5},"end":{"line":280,"column":33}},"url":"/splines","internal":true,"dataUrl":"/splines.json","children":[{"type":"text","value":"Cubic splines","key":"SUegnazyGa"}],"key":"dpn9V72BKU"}],"identifier":"id-5-3","label":"5.3 ","html_id":"id-5-3","implicit":true,"key":"cKmVn9r78G"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-splines-splines","label":"demo-splines-splines","kind":"proof:example","position":{"start":{"line":283,"column":1},"end":{"line":283,"column":22}},"children":[{"type":"text","value":"Example ","key":"ox1BV7Bvdg"},{"type":"text","value":"5.3.1","key":"zgdUqcEGAv"}],"template":"Example %s","enumerator":"5.3.1","resolved":true,"html_id":"demo-splines-splines","remote":true,"url":"/splines","dataUrl":"/splines.json","key":"cw59ljFcq5"}],"key":"WXGAMpbIjj"},{"type":"paragraph","position":{"start":{"line":285,"column":1},"end":{"line":285,"column":1}},"children":[{"type":"text","value":"For illustration, here is a spline interpolant using just a few nodes.","position":{"start":{"line":285,"column":1},"end":{"line":285,"column":1}},"key":"BHLml2jNfi"}],"key":"YhO2329zOP"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf\nf = @(x) exp(sin(7 * x));\nfplot(f, [0, 1], displayname=\"function\")\n\nt = [0, 0.075, 0.25, 0.55, 0.7, 1];    % nodes\ny = f(t);                              % values at nodes\nhold on, scatter(t, y, displayname=\"values at nodes\")\n\nS = spinterp(t, y);\nfplot(S, [0, 1], displayname=\"spline\")\n\nxlabel(\"x\");  ylabel(\"y\")\nlegend();","key":"XGi50cImTS"},{"type":"output","id":"qT46d11KOmUDUd8bsv0We","data":[{"output_type":"execute_result","execution_count":18,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"6d7e62ab698f6b66f480f5d14f8adfd2","path":"/build/6d7e62ab698f6b66f480f5d14f8adfd2.png"}}}],"key":"fYd2bbeuhY"}],"data":{},"key":"u3JOKzNLdh"},{"type":"paragraph","position":{"start":{"line":303,"column":1},"end":{"line":303,"column":1}},"children":[{"type":"text","value":"Now we look at the convergence rate as the number of nodes increases.","position":{"start":{"line":303,"column":1},"end":{"line":303,"column":1}},"key":"oMwVM1ZSUb"}],"key":"jcLsuyEodI"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"x = (0:10000)' / 1e4;              % sample the difference at many points\nn = round(2 .^ (3:0.5:7))';        % numbers of nodes\nmaxerr = zeros(size(n));\nfor i = 1:length(n)\n    t = (0:n(i))' / n(i);\n    S = spinterp(t, f(t));\n    err = f(x) - S(x);\n    maxerr(i) = norm(err, Inf);\nend\ntable(n(1:2:end), maxerr(1:2:end), variableNames=[\"n\", \"inf-norm error\"])","key":"PUJHiLr0xS"},{"type":"output","id":"imfrjXOS0eqmC_GKsbs3y","data":[{"output_type":"execute_result","execution_count":19,"metadata":{},"data":{"text/html":{"content":"<html><head><style>.mwBasicVariableOutputWrapper .mwBasicVariableOutputHeader {font-style: italic;}</style></head><body><div class='mwBasicVariableOutputWrapper'><div>ans = <span class='mwBasicVariableOutputHeader'>5x2 table</span></div><table><thead><tr><th>n</th><th>inf-norm error</th></tr></thead><tbody><tr><td>8</td><td>3.0563e-02</td></tr><tr><td>16</td><td>5.9076e-03</td></tr><tr><td>32</td><td>3.6705e-04</td></tr><tr><td>64</td><td>2.1531e-05</td></tr><tr><td>128</td><td>1.2401e-06</td></tr></tbody></table></div></body></html>","content_type":"text/html"},"text/plain":{"content":"<html><head><style>.mwBasicVariableOutputWrapper .mwBasicVariableOutputHeader {font-style: italic;}</style></head><body><div class='mwBasicVariableOutputWrapper'><div>ans = <span class='mwBasicVariableOutputHeader'>5x2 table</span></div><table><thead><tr><th>n</th><th>inf-norm error</th></tr></thead><tbody><tr><td>8</td><td>3.0563e-02</td></tr><tr><td>16</td><td>5.9076e-03</td></tr><tr><td>32</td><td>3.6705e-04</td></tr><tr><td>64</td><td>2.1531e-05</td></tr><tr><td>128</td><td>1.2401e-06</td></tr></tbody></table></div></body></html>","content_type":"text/plain"}}}],"key":"HNoG0d2mCG"}],"data":{},"key":"uTNP0NUw7W"},{"type":"paragraph","position":{"start":{"line":318,"column":1},"end":{"line":318,"column":1}},"children":[{"type":"text","value":"Since we expect convergence that is ","position":{"start":{"line":318,"column":1},"end":{"line":318,"column":1}},"key":"wxoQDvVsAx"},{"type":"inlineMath","value":"O(h^4)=O(n^{-4})","position":{"start":{"line":318,"column":1},"end":{"line":318,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><msup><mi>h</mi><mn>4</mn></msup><mo stretchy=\"false\">)</mo><mo>=</mo><mi>O</mi><mo stretchy=\"false\">(</mo><msup><mi>n</mi><mrow><mo>−</mo><mn>4</mn></mrow></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(h^4)=O(n^{-4})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">h</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">4</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">n</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">4</span></span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"ydCun5vM9k"},{"type":"text","value":", we use a log-log graph of error and expect a straight line of slope ","position":{"start":{"line":318,"column":1},"end":{"line":318,"column":1}},"key":"YcmTwhefk5"},{"type":"text","value":"-4","position":{"start":{"line":318,"column":1},"end":{"line":318,"column":1}},"key":"qAd7YNEGXE"},{"type":"text","value":".","position":{"start":{"line":318,"column":1},"end":{"line":318,"column":1}},"key":"d8grJZAhpX"}],"key":"NYQAyeow4D"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf\nloglog(n, maxerr, \"-o\", displayname=\"error\")\norder4 = 0.5 * maxerr(end) * (n / n(end)) .^ (-4);\nhold on\nloglog(n, order4, \"k--\", displayname=\"O(n^{-4})\")\nxlabel(\"n\");  ylabel(\"|| f-S ||_{\\infty}\")\ntitle((\"Convergence of spline interpolation\"));","key":"a9cF9FbOxJ"},{"type":"output","id":"ZM28vYG9xB3XoMXe09f4q","data":[{"output_type":"execute_result","execution_count":20,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"630f0ff560b68ae3da629626d40978d5","path":"/build/630f0ff560b68ae3da629626d40978d5.png"}}}],"key":"IRlEEhnSup"}],"data":{},"key":"lZhdrh6018"}],"label":"demo-splines-splines-matlab","identifier":"demo-splines-splines-matlab","html_id":"demo-splines-splines-matlab","key":"y45DwiRxVs"},{"type":"heading","depth":3,"position":{"start":{"line":331,"column":1},"end":{"line":331,"column":1}},"children":[{"type":"text","value":"5.4 ","position":{"start":{"line":331,"column":1},"end":{"line":331,"column":1}},"key":"IL41Mifs3i"},{"type":"link","identifier":"section-localapprox-finitediffs","label":"section-localapprox-finitediffs","kind":"narrative","position":{"start":{"line":331,"column":5},"end":{"line":331,"column":37}},"url":"/finitediffs","internal":true,"dataUrl":"/finitediffs.json","children":[{"type":"text","value":"Finite differences","key":"pLrjhobBdH"}],"key":"lnS5Yzc2TF"}],"identifier":"id-5-4","label":"5.4 ","html_id":"id-5-4","implicit":true,"key":"DUQcghwhQp"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-finitediffs-fd1","label":"demo-finitediffs-fd1","kind":"proof:example","position":{"start":{"line":334,"column":1},"end":{"line":334,"column":22}},"children":[{"type":"text","value":"Example ","key":"wDRYMLkzIC"},{"type":"text","value":"5.4.3","key":"xF3oSkJpuy"}],"template":"Example %s","enumerator":"5.4.3","resolved":true,"html_id":"demo-finitediffs-fd1","remote":true,"url":"/finitediffs","dataUrl":"/finitediffs.json","key":"sJIAUWFyv1"}],"key":"GQP0pFcXoN"},{"type":"paragraph","position":{"start":{"line":336,"column":1},"end":{"line":336,"column":1}},"children":[{"type":"text","value":"If ","position":{"start":{"line":336,"column":1},"end":{"line":336,"column":1}},"key":"kw1uO4DZM8"},{"type":"inlineMath","value":"f(x)=e^{\\,\\sin(x)}","position":{"start":{"line":336,"column":1},"end":{"line":336,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msup><mi>e</mi><mrow><mtext> </mtext><mi>sin</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></msup></mrow><annotation encoding=\"application/x-tex\">f(x)=e^{\\,\\sin(x)}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.888em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.888em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mspace mtight\" style=\"margin-right:0.1952em;\"></span><span class=\"mop mtight\"><span class=\"mtight\">s</span><span class=\"mtight\">i</span><span class=\"mtight\">n</span></span><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\">x</span><span class=\"mclose mtight\">)</span></span></span></span></span></span></span></span></span></span></span></span>","key":"kLPP0HFx1v"},{"type":"text","value":", then ","position":{"start":{"line":336,"column":1},"end":{"line":336,"column":1}},"key":"YAIFbRhvin"},{"type":"inlineMath","value":"f'(0)=1","position":{"start":{"line":336,"column":1},"end":{"line":336,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>f</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo stretchy=\"false\">(</mo><mn>0</mn><mo stretchy=\"false\">)</mo><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">f&#x27;(0)=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0019em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"ZpF9XLX6Er"},{"type":"text","value":".","position":{"start":{"line":336,"column":1},"end":{"line":336,"column":1}},"key":"a2SaL1gt4o"}],"key":"mIM5nhILhy"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"f = @(x) exp(sin(x));","key":"Sz5HWzl1Sv"},{"type":"output","id":"yL4FjeP5heLWKgta8X4cX","data":[],"key":"kT5iR60q4c"}],"data":{},"key":"dbj0ymKkcA"},{"type":"paragraph","position":{"start":{"line":342,"column":1},"end":{"line":342,"column":1}},"children":[{"type":"text","value":"Here are the first two centered differences from ","position":{"start":{"line":342,"column":1},"end":{"line":342,"column":1}},"key":"XLaeSIhJHy"},{"type":"crossReference","kind":"table","identifier":"table-fdcenter","label":"table-FDcenter","children":[{"type":"text","value":"Table ","key":"zwYyuyLWbt"},{"type":"text","value":"5.4.1","key":"SHQRvKItlE"}],"template":"Table %s","enumerator":"5.4.1","resolved":true,"html_id":"table-fdcenter","remote":true,"url":"/finitediffs","dataUrl":"/finitediffs.json","key":"wCKHq8jMUN"},{"type":"text","value":".","position":{"start":{"line":342,"column":1},"end":{"line":342,"column":1}},"key":"Pw67bgHVZz"}],"key":"dGX6AqZtcN"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"h = 0.05;\nformat long\nCD2 = (-f(-h) + f(h)) / (2*h)\nCD4 = (f(-2*h) - 8*f(-h) + 8*f(h) - f(2*h)) / (12*h)","key":"o7NbB3Ujne"},{"type":"output","id":"-2QRBiwX1eNDLhJmk12QY","data":[{"output_type":"execute_result","execution_count":22,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>CD2 = \n   0.999999583506951\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"CD2 = \n   0.999999583506951\n","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":22,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>CD4 = \n   1.000001663193875\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"CD4 = \n   1.000001663193875\n","content_type":"text/plain"}}}],"key":"WROSWCAqei"}],"data":{},"key":"aSZmoT3wy6"},{"type":"paragraph","position":{"start":{"line":351,"column":1},"end":{"line":351,"column":1}},"children":[{"type":"text","value":"Here are the first two forward differences from ","position":{"start":{"line":351,"column":1},"end":{"line":351,"column":1}},"key":"Jmjj2mVjCX"},{"type":"crossReference","kind":"table","identifier":"table-fdforward","label":"table-FDforward","children":[{"type":"text","value":"Table ","key":"NwaN3QVrol"},{"type":"text","value":"5.4.2","key":"pw91nqcZku"}],"template":"Table %s","enumerator":"5.4.2","resolved":true,"html_id":"table-fdforward","remote":true,"url":"/finitediffs","dataUrl":"/finitediffs.json","key":"qdAcE46GrW"},{"type":"text","value":".","position":{"start":{"line":351,"column":1},"end":{"line":351,"column":1}},"key":"Ub8WiRr8MY"}],"key":"LK6knY4KVm"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"FD1 = (-f(0) + f(h)) / h\nFD2 = (-3*f(0) + 4*f(h) - f(2*h)) / (2*h)","key":"wa8ysb8ySX"},{"type":"output","id":"nzvFLV299HGbXKOuyVSsS","data":[{"output_type":"execute_result","execution_count":23,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>FD1 = \n   5.395571120012379\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"FD1 = \n   5.395571120012379\n","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":23,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>FD2 = \n   5.029922775567477\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"FD2 = \n   5.029922775567477\n","content_type":"text/plain"}}}],"key":"A1siyJDkSw"}],"data":{},"key":"jZXjcPz3rR"},{"type":"paragraph","position":{"start":{"line":358,"column":1},"end":{"line":358,"column":1}},"children":[{"type":"text","value":"Finally, here are the backward differences that come from reverse-negating the forward differences.","position":{"start":{"line":358,"column":1},"end":{"line":358,"column":1}},"key":"SssGfaUOTb"}],"key":"lPmuwyQV3G"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"BD1 = (-f(-h) + f(0)) / h\nBD2 = (f(-2*h) - 4*f(-h) + 3*f(0)) / (2*h)","key":"eXxuMQfcja"},{"type":"output","id":"0a4v-fCX_ESWwQmbULZGa","data":[{"output_type":"execute_result","execution_count":24,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>BD1 = \n   0.334260526211337\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"BD1 = \n   0.334260526211337\n","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":24,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>BD2 = \n   0.410935758455839\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"BD2 = \n   0.410935758455839\n","content_type":"text/plain"}}}],"key":"AG0EtSOyin"}],"data":{},"key":"b7GFlvLLGe"}],"label":"demo-finitediffs-fd1-matlab","identifier":"demo-finitediffs-fd1-matlab","html_id":"demo-finitediffs-fd1-matlab","key":"R3ajefNmO5"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-finitediffs-fd2","label":"demo-finitediffs-fd2","kind":"proof:example","position":{"start":{"line":367,"column":1},"end":{"line":367,"column":22}},"children":[{"type":"text","value":"Example ","key":"MIjn2XZKTZ"},{"type":"text","value":"5.4.4","key":"EOUAZG24Q9"}],"template":"Example %s","enumerator":"5.4.4","resolved":true,"html_id":"demo-finitediffs-fd2","remote":true,"url":"/finitediffs","dataUrl":"/finitediffs.json","key":"DT5JwWSsB4"}],"key":"h2gNvROkS6"},{"type":"paragraph","position":{"start":{"line":369,"column":1},"end":{"line":369,"column":1}},"children":[{"type":"text","value":"If ","position":{"start":{"line":369,"column":1},"end":{"line":369,"column":1}},"key":"LBkNGO3vkD"},{"type":"inlineMath","value":"f(x)=e^{\\,\\sin(x)}","position":{"start":{"line":369,"column":1},"end":{"line":369,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msup><mi>e</mi><mrow><mtext> </mtext><mi>sin</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></msup></mrow><annotation encoding=\"application/x-tex\">f(x)=e^{\\,\\sin(x)}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.888em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.888em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mspace mtight\" style=\"margin-right:0.1952em;\"></span><span class=\"mop mtight\"><span class=\"mtight\">s</span><span class=\"mtight\">i</span><span class=\"mtight\">n</span></span><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\">x</span><span class=\"mclose mtight\">)</span></span></span></span></span></span></span></span></span></span></span></span>","key":"b8iAJqxeYK"},{"type":"text","value":", then ","position":{"start":{"line":369,"column":1},"end":{"line":369,"column":1}},"key":"hhFqz78ecg"},{"type":"inlineMath","value":"f''(0)=1","position":{"start":{"line":369,"column":1},"end":{"line":369,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>f</mi><mrow><mo mathvariant=\"normal\">′</mo><mo mathvariant=\"normal\">′</mo></mrow></msup><mo stretchy=\"false\">(</mo><mn>0</mn><mo stretchy=\"false\">)</mo><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">f&#x27;&#x27;(0)=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0019em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′′</span></span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"WrhplAcz7U"},{"type":"text","value":".","position":{"start":{"line":369,"column":1},"end":{"line":369,"column":1}},"key":"VJm1LVCW8L"}],"key":"XIQuFKBJ9k"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"f = @(x) exp(sin(x));","key":"FyP3PtW02V"},{"type":"output","id":"2PNetVeIgEjn6MecY3SkL","data":[],"key":"Shgi8agHl9"}],"data":{},"key":"NjoMTSOWgL"},{"type":"paragraph","position":{"start":{"line":375,"column":1},"end":{"line":375,"column":1}},"children":[{"type":"text","value":"Here is a centered estimate given by ","position":{"start":{"line":375,"column":1},"end":{"line":375,"column":1}},"key":"JZdwmPNLy5"},{"type":"crossReference","kind":"equation","identifier":"centerfd22","label":"centerFD22","children":[{"type":"text","value":"(","key":"eIeXrfEGFK"},{"type":"text","value":"5.4.12","key":"u5EQ9WoTMi"},{"type":"text","value":")","key":"Km8KUF76XM"}],"template":"(%s)","enumerator":"5.4.12","resolved":true,"html_id":"centerfd22","remote":true,"url":"/finitediffs","dataUrl":"/finitediffs.json","key":"tnX9wxw0KP"},{"type":"text","value":".","position":{"start":{"line":375,"column":1},"end":{"line":375,"column":1}},"key":"xjeuvidxbO"}],"key":"ul2Ku1DBNV"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"h = 0.05;\nformat long\nCD2 = (f(-h) - 2*f(0) + f(h)) / h^2","key":"ctJconblFO"},{"type":"output","id":"1xZq1EO6xo4TKhdQHEy5t","data":[{"output_type":"stream","name":"stderr","text":"Not enough input arguments.\n\nError in LiveEditorEvaluationHelperEc482176a-104e-4b4a-bc53-b10e8b2e2b15>@(t,u,p)[s*(u(2)-u(1)*u(2)+u(1)-q*u(1)^2);(-u(2)-u(1)*u(2)+u(3))/s;w*(u(1)-u(3))] (line 2)\nf = @(t, u, p) [ s*(u(2)- u(1) * u(2) + u(1) - q * u(1)^2);..."}],"key":"Kv3AxOPBOq"}],"data":{},"key":"bhRlAxQi83"},{"type":"paragraph","position":{"start":{"line":383,"column":1},"end":{"line":383,"column":1}},"children":[{"type":"text","value":"For the same ","position":{"start":{"line":383,"column":1},"end":{"line":383,"column":1}},"key":"DV0jhRPPPa"},{"type":"inlineMath","value":"h","position":{"start":{"line":383,"column":1},"end":{"line":383,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>h</mi></mrow><annotation encoding=\"application/x-tex\">h</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">h</span></span></span></span>","key":"xpf65xpuki"},{"type":"text","value":", here are forward estimates given by ","position":{"start":{"line":383,"column":1},"end":{"line":383,"column":1}},"key":"GQgPHIxiKV"},{"type":"crossReference","kind":"equation","identifier":"forwardfd21","label":"forwardFD21","children":[{"type":"text","value":"(","key":"iXU6QWSFZy"},{"type":"text","value":"5.4.13","key":"L07qUwVugK"},{"type":"text","value":")","key":"qYyNCnVx9L"}],"template":"(%s)","enumerator":"5.4.13","resolved":true,"html_id":"forwardfd21","remote":true,"url":"/finitediffs","dataUrl":"/finitediffs.json","key":"QiGZOvZzfW"},{"type":"text","value":" and ","position":{"start":{"line":383,"column":1},"end":{"line":383,"column":1}},"key":"kqAqtNbhcZ"},{"type":"crossReference","kind":"equation","identifier":"forwardfd22","label":"forwardFD22","children":[{"type":"text","value":"(","key":"zGCErZNQCl"},{"type":"text","value":"5.4.14","key":"p3n73lNl0s"},{"type":"text","value":")","key":"Lok0CvOCLr"}],"template":"(%s)","enumerator":"5.4.14","resolved":true,"html_id":"forwardfd22","remote":true,"url":"/finitediffs","dataUrl":"/finitediffs.json","key":"yjIubUroLS"},{"type":"text","value":".","position":{"start":{"line":383,"column":1},"end":{"line":383,"column":1}},"key":"tdv3xrlIzD"}],"key":"ts0e9irlKp"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"FD1 = (f(0) - 2*f(h) + f(2*h)) / h^2\nFD2 = (2*f(0) - 5*f(h) + 4*f(2*h) - f(3*h)) / h^2","key":"iZ2Pps9Zkx"},{"type":"output","id":"ksrHWCPkW03slBA5ksUdP","data":[{"output_type":"stream","name":"stderr","text":"Not enough input arguments.\n\nError in LiveEditorEvaluationHelperEc482176a-104e-4b4a-bc53-b10e8b2e2b15>@(t,u,p)[s*(u(2)-u(1)*u(2)+u(1)-q*u(1)^2);(-u(2)-u(1)*u(2)+u(3))/s;w*(u(1)-u(3))] (line 2)\n    -u(2)/s, (-1-u(1))/s, 1/s; ..."}],"key":"VjMxpOI1jG"}],"data":{},"key":"zEPVLefMMj"},{"type":"paragraph","position":{"start":{"line":390,"column":1},"end":{"line":390,"column":1}},"children":[{"type":"text","value":"Finally, here are the backward estimates that come from reversing ","position":{"start":{"line":390,"column":1},"end":{"line":390,"column":1}},"key":"jCXV86DkEb"},{"type":"crossReference","kind":"equation","identifier":"forwardfd21","label":"forwardFD21","children":[{"type":"text","value":"(","key":"dvANyQ9E8Y"},{"type":"text","value":"5.4.13","key":"ML2oBE2uos"},{"type":"text","value":")","key":"naQ6vgVA4Z"}],"template":"(%s)","enumerator":"5.4.13","resolved":true,"html_id":"forwardfd21","remote":true,"url":"/finitediffs","dataUrl":"/finitediffs.json","key":"A7bqvV0YqE"},{"type":"text","value":" and ","position":{"start":{"line":390,"column":1},"end":{"line":390,"column":1}},"key":"Evl62fxgGb"},{"type":"crossReference","kind":"equation","identifier":"forwardfd22","label":"forwardFD22","children":[{"type":"text","value":"(","key":"MI0cjJEqQn"},{"type":"text","value":"5.4.14","key":"GwIi70iKxK"},{"type":"text","value":")","key":"SN6i0WwmHb"}],"template":"(%s)","enumerator":"5.4.14","resolved":true,"html_id":"forwardfd22","remote":true,"url":"/finitediffs","dataUrl":"/finitediffs.json","key":"jAuyw39FqX"},{"type":"text","value":".","position":{"start":{"line":390,"column":1},"end":{"line":390,"column":1}},"key":"MMbRLy7Vdm"}],"key":"WZ7Ue74AVC"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"BD1 = (f(-2*h) - 2*f(-h) + f(0)) / h^2\nBD2 = (-f(-3*h) + 4*f(-2*h) - 5*f(-h) + 2*f(0)) / h^2","key":"iTafxYCSGv"},{"type":"output","id":"HWnjSG_xQu6BnjJE5Y7hV","data":[{"output_type":"stream","name":"stderr","text":"Not enough input arguments.\n\nError in LiveEditorEvaluationHelperEc482176a-104e-4b4a-bc53-b10e8b2e2b15>@(t,u,p)[s*(u(2)-u(1)*u(2)+u(1)-q*u(1)^2);(-u(2)-u(1)*u(2)+u(3))/s;w*(u(1)-u(3))] (line 2)\ntime_ode15s = toc"}],"key":"jsNeXXVjRp"}],"data":{},"key":"kloVjkPxUN"}],"label":"demo-finitediffs-fd2-matlab","identifier":"demo-finitediffs-fd2-matlab","html_id":"demo-finitediffs-fd2-matlab","key":"jjiPY5Srqb"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-finitediffs-fd-weights","label":"demo-finitediffs-fd-weights","kind":"proof:example","position":{"start":{"line":399,"column":1},"end":{"line":399,"column":29}},"children":[{"type":"text","value":"Example ","key":"wcOrbNmO8k"},{"type":"text","value":"5.4.5","key":"rtzE7Ocl6B"}],"template":"Example %s","enumerator":"5.4.5","resolved":true,"html_id":"demo-finitediffs-fd-weights","remote":true,"url":"/finitediffs","dataUrl":"/finitediffs.json","key":"Thz8aKhPj2"}],"key":"rnwl1zmQFE"},{"type":"paragraph","position":{"start":{"line":401,"column":1},"end":{"line":401,"column":1}},"children":[{"type":"text","value":"We will estimate the derivative of ","position":{"start":{"line":401,"column":1},"end":{"line":401,"column":1}},"key":"Ia3tjkla6E"},{"type":"inlineMath","value":"\\cos(x^2)","position":{"start":{"line":401,"column":1},"end":{"line":401,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>cos</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><msup><mi>x</mi><mn>2</mn></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\cos(x^2)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mop\">cos</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"fKBuTDjD7u"},{"type":"text","value":" at ","position":{"start":{"line":401,"column":1},"end":{"line":401,"column":1}},"key":"knLfBhBYLx"},{"type":"inlineMath","value":"x=0.5","position":{"start":{"line":401,"column":1},"end":{"line":401,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mo>=</mo><mn>0.5</mn></mrow><annotation encoding=\"application/x-tex\">x=0.5</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0.5</span></span></span></span>","key":"LZOpovsaqj"},{"type":"text","value":" using five nodes.","position":{"start":{"line":401,"column":1},"end":{"line":401,"column":1}},"key":"kEgWdWsY3C"}],"key":"aLKGjk5Q8W"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"t = [0.35, 0.5, 0.57, 0.6, 0.75];    % nodes\nf = @(x) cos(x.^2);\ndfdx = @(x) -2 * x * sin(x^2);\nexact_value = dfdx(0.5)","key":"Ic93OkgXxC"},{"type":"output","id":"UoPI0eJWCTVQm--wjK8TQ","data":[{"output_type":"execute_result","execution_count":29,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>exact_value = -0.2474</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"exact_value = -0.2474","content_type":"text/plain"}}}],"key":"xMWUrDMB3v"}],"data":{},"key":"hAJL2U9tO2"},{"type":"paragraph","position":{"start":{"line":410,"column":1},"end":{"line":410,"column":1}},"children":[{"type":"text","value":"We have to shift the nodes so that the point of estimation for the derivative is at ","position":{"start":{"line":410,"column":1},"end":{"line":410,"column":1}},"key":"GKZiW9UMbH"},{"type":"inlineMath","value":"x=0","position":{"start":{"line":410,"column":1},"end":{"line":410,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">x=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"b9Dk8jEHGG"},{"type":"text","value":". (To subtract a scalar from a vector, we must use the ","position":{"start":{"line":410,"column":1},"end":{"line":410,"column":1}},"key":"zuRJfkMOK4"},{"type":"inlineCode","value":".-","position":{"start":{"line":410,"column":1},"end":{"line":410,"column":1}},"key":"jWdRIh7bN3"},{"type":"text","value":" operator.)","position":{"start":{"line":410,"column":1},"end":{"line":410,"column":1}},"key":"UJOUKFlJPm"}],"key":"TpjRy0Qam0"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"format short\nw = fdweights(t - 0.5, 1)","key":"eBTXdsDbT8"},{"type":"output","id":"soUSoXlFotDEJeleiEoE3","data":[{"output_type":"execute_result","execution_count":30,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>w = 1×48 double\n    0.0000   -0.0000    0.0000   -0.0000    0.0000   -0.0001    0.0008   -0.0058    0.0361   -0.2086    1.1892   -8.0000  -25.0457   64.6154  -78.4615  115.0769 -172.6154  251.8154 -349.7436  457.5593 -560.5101  640.5830 -681.3474  673.2682 -617.1625  524.1134 -411.8034  298.9387 -200.1822  123.4389\n...</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"w = 1×48 double\n    0.0000   -0.0000    0.0000   -0.0000    0.0000   -0.0001    0.0008   -0.0058    0.0361   -0.2086    1.1892   -8.0000  -25.0457   64.6154  -78.4615  115.0769 -172.6154  251.8154 -349.7436  457.5593 -560.5101  640.5830 -681.3474  673.2682 -617.1625  524.1134 -411.8034  298.9387 -200.1822  123.4389\n...","content_type":"text/plain"}}}],"key":"lHF5sPZBCu"}],"data":{},"key":"RPxuRBwIGj"},{"type":"paragraph","position":{"start":{"line":417,"column":1},"end":{"line":417,"column":1}},"children":[{"type":"text","value":"The finite-difference formula is a dot product (i.e., inner product) between the vector of weights and the vector of function values at the nodes.","position":{"start":{"line":417,"column":1},"end":{"line":417,"column":1}},"key":"fpWPDG4ERF"}],"key":"P8C5B4hb1H"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"fd_value = w * f(t)'","key":"PN4BkHfjbh"},{"type":"output","id":"Zdl8tHZv38lyxmFssTPjf","data":[{"output_type":"stream","name":"stderr","text":"Error using *\nIncorrect dimensions for matrix multiplication. Check that the number of columns in the first matrix matches the number of rows in the second matrix. To operate on each element of the matrix individually, use TIMES (.*) for elementwise multiplication."}],"key":"BhUSLOQc1N"}],"data":{},"key":"OzehimSwyq"},{"type":"paragraph","position":{"start":{"line":423,"column":1},"end":{"line":423,"column":1}},"children":[{"type":"text","value":"We can reproduce the weights in the finite-difference tables by using equally spaced nodes with ","position":{"start":{"line":423,"column":1},"end":{"line":423,"column":1}},"key":"A3dkvFA6W6"},{"type":"inlineMath","value":"h=1","position":{"start":{"line":423,"column":1},"end":{"line":423,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>h</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">h=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">h</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"yJJqVy3rQ2"},{"type":"text","value":". For example, here is a one-sided formula at four nodes.","position":{"start":{"line":423,"column":1},"end":{"line":423,"column":1}},"key":"FoKNtTU8DN"}],"key":"KFbuCsDVAW"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"fdweights(0:3, 1)","key":"yFjcKpkd5h"},{"type":"output","id":"qkFT_TCjXR9PhM4pmAhhI","data":[{"output_type":"execute_result","execution_count":32,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = 1×4 double\n   -1.8333    3.0000   -1.5000    0.3333\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = 1×4 double\n   -1.8333    3.0000   -1.5000    0.3333\n","content_type":"text/plain"}}}],"key":"pl0UgmpKiD"}],"data":{},"key":"qfg5BvVUZj"}],"label":"demo-finitediffs-fd-weights-matlab","identifier":"demo-finitediffs-fd-weights-matlab","html_id":"demo-finitediffs-fd-weights-matlab","key":"j1Es6XB67Y"},{"type":"heading","depth":3,"position":{"start":{"line":431,"column":1},"end":{"line":431,"column":1}},"children":[{"type":"text","value":"5.5 ","position":{"start":{"line":431,"column":1},"end":{"line":431,"column":1}},"key":"aruG4SCcm9"},{"type":"link","identifier":"section-localapprox-fd-converge","label":"section-localapprox-fd-converge","kind":"narrative","position":{"start":{"line":431,"column":5},"end":{"line":431,"column":37}},"url":"/fd-converge","internal":true,"dataUrl":"/fd-converge.json","children":[{"type":"text","value":"Convergence of finite differences","key":"fOP78KMSaX"}],"key":"otRAlTyHrJ"}],"identifier":"id-5-5","label":"5.5 ","html_id":"id-5-5","implicit":true,"key":"wh0VNB0Xph"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-fdconverge-order12","label":"demo-fdconverge-order12","kind":"proof:example","position":{"start":{"line":434,"column":1},"end":{"line":434,"column":25}},"children":[{"type":"text","value":"Example ","key":"QZnuIjcrp1"},{"type":"text","value":"5.5.3","key":"tFZbIQOaTQ"}],"template":"Example %s","enumerator":"5.5.3","resolved":true,"html_id":"demo-fdconverge-order12","remote":true,"url":"/fd-converge","dataUrl":"/fd-converge.json","key":"jVp9jbcdYd"}],"key":"QCPbrsFwyz"},{"type":"paragraph","position":{"start":{"line":436,"column":1},"end":{"line":436,"column":1}},"children":[{"type":"text","value":"Let’s observe the convergence of the formulas in ","position":{"start":{"line":436,"column":1},"end":{"line":436,"column":1}},"key":"oDtw6lsjTA"},{"type":"crossReference","kind":"proof:example","identifier":"example-fd-converge-fd11","label":"example-fd-converge-FD11","children":[{"type":"text","value":"Example ","key":"xAAqCcVMdC"},{"type":"text","value":"5.5.1","key":"SU3IKV43Aw"}],"template":"Example %s","enumerator":"5.5.1","resolved":true,"html_id":"example-fd-converge-fd11","remote":true,"url":"/fd-converge","dataUrl":"/fd-converge.json","key":"tVJwwYEzF8"},{"type":"text","value":" and ","position":{"start":{"line":436,"column":1},"end":{"line":436,"column":1}},"key":"XdbSyzNoKa"},{"type":"crossReference","kind":"proof:example","identifier":"example-fd-converge-fd12","label":"example-fd-converge-FD12","children":[{"type":"text","value":"Example ","key":"Tpbfhe9FQX"},{"type":"text","value":"5.5.2","key":"ffPZD9eJ2v"}],"template":"Example %s","enumerator":"5.5.2","resolved":true,"html_id":"example-fd-converge-fd12","remote":true,"url":"/fd-converge","dataUrl":"/fd-converge.json","key":"Trytg23Aj5"},{"type":"text","value":", applied to the function ","position":{"start":{"line":436,"column":1},"end":{"line":436,"column":1}},"key":"PD3PwaPdve"},{"type":"inlineMath","value":"\\sin(e^{x+1})","position":{"start":{"line":436,"column":1},"end":{"line":436,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>sin</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><msup><mi>e</mi><mrow><mi>x</mi><mo>+</mo><mn>1</mn></mrow></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\sin(e^{x+1})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mop\">sin</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">x</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"AncYMXuvFX"},{"type":"text","value":" at ","position":{"start":{"line":436,"column":1},"end":{"line":436,"column":1}},"key":"iboApVztXO"},{"type":"inlineMath","value":"x=0","position":{"start":{"line":436,"column":1},"end":{"line":436,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">x=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"ihiS5OanNF"},{"type":"text","value":".","position":{"start":{"line":436,"column":1},"end":{"line":436,"column":1}},"key":"iRsrQuEmT0"}],"key":"Pw5e4Sx5qK"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"f = @(x) sin(exp(x + 1));\nexact_value = exp(1) * cos(exp(1))","key":"FryyOBJ721"},{"type":"output","id":"UfJ4FA9T9gAkzDoVifiKt","data":[{"output_type":"execute_result","execution_count":33,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>exact_value = -2.4783</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"exact_value = -2.4783","content_type":"text/plain"}}}],"key":"SVLQ5G6l1u"}],"data":{},"key":"jfoM4NrKXk"},{"type":"paragraph","position":{"start":{"line":443,"column":1},"end":{"line":443,"column":1}},"children":[{"type":"text","value":"We’ll compute the formulas in parallel for a sequence of ","position":{"start":{"line":443,"column":1},"end":{"line":443,"column":1}},"key":"lXJtHXWJ3z"},{"type":"inlineMath","value":"h","position":{"start":{"line":443,"column":1},"end":{"line":443,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>h</mi></mrow><annotation encoding=\"application/x-tex\">h</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">h</span></span></span></span>","key":"xjWRLCpGtx"},{"type":"text","value":" values.","position":{"start":{"line":443,"column":1},"end":{"line":443,"column":1}},"key":"PCYnf17vg7"}],"key":"Q91Z0oK2dw"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"h = 5 ./ 10.^(1:6)';\nFD1 = zeros(size(h));\nFD2 = zeros(size(h));\nfor i = 1:length(h)\n    h_i = h(i);\n    FD1(i) = (f(h_i) - f(0)    ) / h_i;\n    FD2(i) = (f(h_i) - f(-h_i)) / (2*h_i);\nend\ntable(h, FD1, FD2)","key":"IZzyycJfrZ"},{"type":"output","id":"vHb5ssSK_j9rFw3uCsebZ","data":[{"output_type":"execute_result","execution_count":34,"metadata":{},"data":{"text/html":{"content":"<html><head><style>.mwBasicVariableOutputWrapper .mwBasicVariableOutputHeader {font-style: italic;}</style></head><body><div class='mwBasicVariableOutputWrapper'><div>ans = <span class='mwBasicVariableOutputHeader'>6x3 table</span></div><table><thead><tr><th>h</th><th>FD1</th><th>FD2</th></tr></thead><tbody><tr><td>0.500000000000000</td><td>-2.768575766550465</td><td>-1.970471980386291</td></tr><tr><td>0.050000000000000</td><td>-2.612795285613695</td><td>-2.475520256824717</td></tr><tr><td>0.005000000000000</td><td>-2.492105218933405</td><td>-2.478321695117947</td></tr><tr><td>5.000000000000000e-04</td><td>-2.479727860970504</td><td>-2.478349452602613</td></tr><tr><td>5.000000000000000e-05</td><td>-2.478487571052623</td><td>-2.478349730152263</td></tr><tr><td>5.000000000000000e-06</td><td>-2.478363517077753</td><td>-2.478349732931706</td></tr></tbody></table></div></body></html>","content_type":"text/html"},"text/plain":{"content":"<html><head><style>.mwBasicVariableOutputWrapper .mwBasicVariableOutputHeader {font-style: italic;}</style></head><body><div class='mwBasicVariableOutputWrapper'><div>ans = <span class='mwBasicVariableOutputHeader'>6x3 table</span></div><table><thead><tr><th>h</th><th>FD1</th><th>FD2</th></tr></thead><tbody><tr><td>0.500000000000000</td><td>-2.768575766550465</td><td>-1.970471980386291</td></tr><tr><td>0.050000000000000</td><td>-2.612795285613695</td><td>-2.475520256824717</td></tr><tr><td>0.005000000000000</td><td>-2.492105218933405</td><td>-2.478321695117947</td></tr><tr><td>5.000000000000000e-04</td><td>-2.479727860970504</td><td>-2.478349452602613</td></tr><tr><td>5.000000000000000e-05</td><td>-2.478487571052623</td><td>-2.478349730152263</td></tr><tr><td>5.000000000000000e-06</td><td>-2.478363517077753</td><td>-2.478349732931706</td></tr></tbody></table></div></body></html>","content_type":"text/plain"}}}],"key":"BfiRZzlBRh"}],"data":{},"key":"qDb8J8GgDo"},{"type":"paragraph","position":{"start":{"line":457,"column":1},"end":{"line":457,"column":1}},"children":[{"type":"text","value":"All that’s easy to see from this table is that FD2 appears to converge to the same result as FD1, but more rapidly. A table of errors is more informative.","position":{"start":{"line":457,"column":1},"end":{"line":457,"column":1}},"key":"RYcoB9xbR9"}],"key":"Nkp2azSx5i"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"err1 = abs(exact_value - FD1);\nerr2 = abs(exact_value - FD2);\ntable(h, err1, err2, variableNames=[\"h\", \"error in FD1\", \"error in FD2\"])","key":"OnEIQQDcKd"},{"type":"output","id":"_h9jRjc-yGGAmyqS-7nzq","data":[{"output_type":"execute_result","execution_count":35,"metadata":{},"data":{"text/html":{"content":"<html><head><style>.mwBasicVariableOutputWrapper .mwBasicVariableOutputHeader {font-style: italic;}</style></head><body><div class='mwBasicVariableOutputWrapper'><div>ans = <span class='mwBasicVariableOutputHeader'>6x3 table</span></div><table><thead><tr><th>h</th><th>error in FD1</th><th>error in FD2</th></tr></thead><tbody><tr><td>0.500000000000000</td><td>0.290226033595230</td><td>0.507877752568944</td></tr><tr><td>0.050000000000000</td><td>0.134445552658460</td><td>0.002829476130518</td></tr><tr><td>0.005000000000000</td><td>0.013755485978170</td><td>2.803783728833054e-05</td></tr><tr><td>5.000000000000000e-04</td><td>0.001378128015269</td><td>2.803526220063191e-07</td></tr><tr><td>5.000000000000000e-05</td><td>1.378380973884319e-04</td><td>2.802972076665355e-09</td></tr><tr><td>5.000000000000000e-06</td><td>1.378412251806793e-05</td><td>2.352873451627602e-11</td></tr></tbody></table></div></body></html>","content_type":"text/html"},"text/plain":{"content":"<html><head><style>.mwBasicVariableOutputWrapper .mwBasicVariableOutputHeader {font-style: italic;}</style></head><body><div class='mwBasicVariableOutputWrapper'><div>ans = <span class='mwBasicVariableOutputHeader'>6x3 table</span></div><table><thead><tr><th>h</th><th>error in FD1</th><th>error in FD2</th></tr></thead><tbody><tr><td>0.500000000000000</td><td>0.290226033595230</td><td>0.507877752568944</td></tr><tr><td>0.050000000000000</td><td>0.134445552658460</td><td>0.002829476130518</td></tr><tr><td>0.005000000000000</td><td>0.013755485978170</td><td>2.803783728833054e-05</td></tr><tr><td>5.000000000000000e-04</td><td>0.001378128015269</td><td>2.803526220063191e-07</td></tr><tr><td>5.000000000000000e-05</td><td>1.378380973884319e-04</td><td>2.802972076665355e-09</td></tr><tr><td>5.000000000000000e-06</td><td>1.378412251806793e-05</td><td>2.352873451627602e-11</td></tr></tbody></table></div></body></html>","content_type":"text/plain"}}}],"key":"d5FSGD1Ol1"}],"data":{},"key":"QJ2YX1HXs1"},{"type":"paragraph","position":{"start":{"line":465,"column":1},"end":{"line":465,"column":1}},"children":[{"type":"text","value":"In each row, ","position":{"start":{"line":465,"column":1},"end":{"line":465,"column":1}},"key":"S2rG0aTg96"},{"type":"inlineMath","value":"h","position":{"start":{"line":465,"column":1},"end":{"line":465,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>h</mi></mrow><annotation encoding=\"application/x-tex\">h</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">h</span></span></span></span>","key":"jCPesnPoxf"},{"type":"text","value":" is decreased by a factor of 10, so that the error is reduced by a factor of 10 in the first-order method and 100 in the second-order method.","position":{"start":{"line":465,"column":1},"end":{"line":465,"column":1}},"key":"eiGakGyF60"}],"key":"lzBmRXPlIE"},{"type":"paragraph","position":{"start":{"line":467,"column":1},"end":{"line":467,"column":1}},"children":[{"type":"text","value":"A graphical comparison can be useful as well. On a log-log scale, the error should (as ","position":{"start":{"line":467,"column":1},"end":{"line":467,"column":1}},"key":"zA1XYjflkn"},{"type":"inlineMath","value":"h\\to 0","position":{"start":{"line":467,"column":1},"end":{"line":467,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>h</mi><mo>→</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">h\\to 0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">h</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"VnT20CUeuF"},{"type":"text","value":") be a straight line whose slope is the order of accuracy. However, it’s conventional in convergence plots to show ","position":{"start":{"line":467,"column":1},"end":{"line":467,"column":1}},"key":"JA42jAL9Dx"},{"type":"inlineMath","value":"h","position":{"start":{"line":467,"column":1},"end":{"line":467,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>h</mi></mrow><annotation encoding=\"application/x-tex\">h</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">h</span></span></span></span>","key":"pNQNN10br7"},{"type":"text","value":" ","position":{"start":{"line":467,"column":1},"end":{"line":467,"column":1}},"key":"QvL7fkqZiA"},{"type":"emphasis","position":{"start":{"line":467,"column":1},"end":{"line":467,"column":1}},"children":[{"type":"text","value":"decreasing","position":{"start":{"line":467,"column":1},"end":{"line":467,"column":1}},"key":"OeVMwiIcwI"}],"key":"HEKPZqlnYD"},{"type":"text","value":" from left to right, which negates the slopes.","position":{"start":{"line":467,"column":1},"end":{"line":467,"column":1}},"key":"yTRMFNVwkF"}],"key":"p5PFpn03z0"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf\nloglog(h, abs([err1 err2]), \"o-\")\nset(gca, \"xdir\", \"reverse\")\norder1 = 0.1 * err1(end) * (h / h(end)) .^ 1;\norder2 = 0.1 * err2(end) * (h / h(end)) .^ 2;\nhold on\nloglog(h, order1, \"--\", h, order2, \"--\")\nxlabel(\"h\");  ylabel(\"error\")\ntitle(\"Convergence of finite differences\")\nlegend(\"FD1\", \"FD2\", \"O(h)\", \"O(h^2)\");","key":"pMBoc5g5hU"},{"type":"output","id":"k8-lCgi512oU3BF2U71tb","data":[{"output_type":"execute_result","execution_count":36,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"9a1cec9931fca520e41d68318f73d108","path":"/build/9a1cec9931fca520e41d68318f73d108.png"}}}],"key":"GA0IkfMswJ"}],"data":{},"key":"xRulWtzIQ4"}],"label":"demo-fdconverge-order12-matlab","identifier":"demo-fdconverge-order12-matlab","html_id":"demo-fdconverge-order12-matlab","key":"is8kCfq8rQ"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-fdconverge-round","label":"demo-fdconverge-round","kind":"proof:example","position":{"start":{"line":484,"column":1},"end":{"line":484,"column":23}},"children":[{"type":"text","value":"Example ","key":"koBKd51wBk"},{"type":"text","value":"5.5.4","key":"qGERMJp2mk"}],"template":"Example %s","enumerator":"5.5.4","resolved":true,"html_id":"demo-fdconverge-round","remote":true,"url":"/fd-converge","dataUrl":"/fd-converge.json","key":"mPYe7XIFTT"}],"key":"ZiUqQFq4ZA"},{"type":"paragraph","position":{"start":{"line":486,"column":1},"end":{"line":486,"column":1}},"children":[{"type":"text","value":"Let ","position":{"start":{"line":486,"column":1},"end":{"line":486,"column":1}},"key":"qTQs4vwCs8"},{"type":"inlineMath","value":"f(x)=e^{-1.3x}","position":{"start":{"line":486,"column":1},"end":{"line":486,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msup><mi>e</mi><mrow><mo>−</mo><mn>1.3</mn><mi>x</mi></mrow></msup></mrow><annotation encoding=\"application/x-tex\">f(x)=e^{-1.3x}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1.3</span><span class=\"mord mathnormal mtight\">x</span></span></span></span></span></span></span></span></span></span></span></span>","key":"noPQyq2ojB"},{"type":"text","value":". We apply finite-difference formulas of first, second, and fourth order to estimate ","position":{"start":{"line":486,"column":1},"end":{"line":486,"column":1}},"key":"hlFLIrh8Oq"},{"type":"inlineMath","value":"f'(0)=-1.3","position":{"start":{"line":486,"column":1},"end":{"line":486,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>f</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo stretchy=\"false\">(</mo><mn>0</mn><mo stretchy=\"false\">)</mo><mo>=</mo><mo>−</mo><mn>1.3</mn></mrow><annotation encoding=\"application/x-tex\">f&#x27;(0)=-1.3</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0019em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">−</span><span class=\"mord\">1.3</span></span></span></span>","key":"dJFpEoh1gl"},{"type":"text","value":".","position":{"start":{"line":486,"column":1},"end":{"line":486,"column":1}},"key":"OPBRcWeR3F"}],"key":"cYmaz7DYxQ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"f = @(x) exp(-1.3 * x);\nexact = -1.3;\n\nh = 10 .^ (-(1:12))';\nFD = zeros(length(h), 3);\nfor i = 1:length(h)\n    h_i = h(i);\n    nodes = h_i * (-2:2);\n    vals = f(nodes);\n    FD(i, 1) = dot([0      0 -1   1    0] / h_i, vals);\n    FD(i, 2) = dot([0    -1/2 0 1/2    0] / h_i, vals);\n    FD(i, 3) = dot([1/12 -2/3 0 2/3 -1/12] / h_i, vals);\nend\nformat long\ntable(h, FD(:, 1), FD(:, 2), FD(:, 3), variableNames=[\"h\", \"FD1\", \"FD2\", \"FD4\"])","key":"Cf0AHL3wyR"},{"type":"output","id":"eeSNmBe9uqT0gl6ldDvwV","data":[{"output_type":"execute_result","execution_count":37,"metadata":{},"data":{"text/html":{"content":"<html><head><style>.mwBasicVariableOutputWrapper .mwBasicVariableOutputHeader {font-style: italic;}</style></head><body><div class='mwBasicVariableOutputWrapper'><div>ans = <span class='mwBasicVariableOutputHeader'>12x4 table</span></div><table><thead><tr><th>h</th><th>FD1</th><th>FD2</th><th>FD4</th></tr></thead><tbody><tr><td>0.100000000000000</td><td>-1.219045690794387</td><td>-1.303664762020302</td><td>-1.299987598641899</td></tr><tr><td>0.010000000000000</td><td>-1.291586497971238</td><td>-1.300036616976080</td><td>-1.299999998762345</td></tr><tr><td>1.000000000000000e-03</td><td>-1.299155366047785</td><td>-1.300000366166728</td><td>-1.299999999999955</td></tr><tr><td>1.000000000000000e-04</td><td>-1.299915503661396</td><td>-1.300000003661808</td><td>-1.300000000000182</td></tr><tr><td>9.999999999999999e-06</td><td>-1.299991550040431</td><td>-1.300000000039290</td><td>-1.300000000010186</td></tr><tr><td>1.000000000000000e-06</td><td>-1.299999154987745</td><td>-1.299999999988358</td><td>-1.300000000046566</td></tr><tr><td>1.000000000000000e-07</td><td>-1.299999915063381</td><td>-1.299999999813735</td><td>-1.300000001676381</td></tr><tr><td>1.000000000000000e-08</td><td>-1.299999997019768</td><td>-1.300000004470348</td><td>-1.300000011920929</td></tr><tr><td>1.000000000000000e-09</td><td>-1.299999952316284</td><td>-1.300000011920929</td><td>-1.300000190734863</td></tr><tr><td>1.000000000000000e-10</td><td>-1.299999237060547</td><td>-1.299999237060547</td><td>-1.300000190734863</td></tr><tr><td>1.000000000000000e-11</td><td>-1.300003051757812</td><td>-1.300003051757812</td><td>-1.300003051757812</td></tr><tr><td>1.000000000000000e-12</td><td>-1.299926757812500</td><td>-1.299987792968750</td><td>-1.300170898437500</td></tr></tbody></table></div></body></html>","content_type":"text/html"},"text/plain":{"content":"<html><head><style>.mwBasicVariableOutputWrapper .mwBasicVariableOutputHeader {font-style: italic;}</style></head><body><div class='mwBasicVariableOutputWrapper'><div>ans = <span class='mwBasicVariableOutputHeader'>12x4 table</span></div><table><thead><tr><th>h</th><th>FD1</th><th>FD2</th><th>FD4</th></tr></thead><tbody><tr><td>0.100000000000000</td><td>-1.219045690794387</td><td>-1.303664762020302</td><td>-1.299987598641899</td></tr><tr><td>0.010000000000000</td><td>-1.291586497971238</td><td>-1.300036616976080</td><td>-1.299999998762345</td></tr><tr><td>1.000000000000000e-03</td><td>-1.299155366047785</td><td>-1.300000366166728</td><td>-1.299999999999955</td></tr><tr><td>1.000000000000000e-04</td><td>-1.299915503661396</td><td>-1.300000003661808</td><td>-1.300000000000182</td></tr><tr><td>9.999999999999999e-06</td><td>-1.299991550040431</td><td>-1.300000000039290</td><td>-1.300000000010186</td></tr><tr><td>1.000000000000000e-06</td><td>-1.299999154987745</td><td>-1.299999999988358</td><td>-1.300000000046566</td></tr><tr><td>1.000000000000000e-07</td><td>-1.299999915063381</td><td>-1.299999999813735</td><td>-1.300000001676381</td></tr><tr><td>1.000000000000000e-08</td><td>-1.299999997019768</td><td>-1.300000004470348</td><td>-1.300000011920929</td></tr><tr><td>1.000000000000000e-09</td><td>-1.299999952316284</td><td>-1.300000011920929</td><td>-1.300000190734863</td></tr><tr><td>1.000000000000000e-10</td><td>-1.299999237060547</td><td>-1.299999237060547</td><td>-1.300000190734863</td></tr><tr><td>1.000000000000000e-11</td><td>-1.300003051757812</td><td>-1.300003051757812</td><td>-1.300003051757812</td></tr><tr><td>1.000000000000000e-12</td><td>-1.299926757812500</td><td>-1.299987792968750</td><td>-1.300170898437500</td></tr></tbody></table></div></body></html>","content_type":"text/plain"}}}],"key":"mQMB4HASLP"}],"data":{},"key":"V5UtkBKm6m"},{"type":"paragraph","position":{"start":{"line":506,"column":1},"end":{"line":506,"column":1}},"children":[{"type":"text","value":"They all seem to be converging to ","position":{"start":{"line":506,"column":1},"end":{"line":506,"column":1}},"key":"M8b339M7wS"},{"type":"text","value":"-1.3","position":{"start":{"line":506,"column":1},"end":{"line":506,"column":1}},"key":"eAWcn7bzSn"},{"type":"text","value":". The convergence plot reveals some interesting structure to the errors, though.","position":{"start":{"line":506,"column":1},"end":{"line":506,"column":1}},"key":"vCTjJhp2ui"}],"key":"ApTt0Uf77v"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"err = abs(FD - exact);\nclf\nloglog(h, err, \"o-\")\nset(gca, \"xdir\", \"reverse\")\norder1 = 0.1 * err(end, 1) * (h / h(end)) .^ (-1);\nhold on\nloglog(h, order1, \"k--\")\nxlabel(\"h\");  ylabel(\"error\")\ntitle(\"FD error with roundoff\")\nlegend(\"FD1\", \"FD2\", \"FD4\", \"O(1/h)\", \"location\", \"northeast\");","key":"kfGDYdjs3k"},{"type":"output","id":"RY2yxygN71ug4wEP3zqlL","data":[{"output_type":"stream","name":"stderr","text":"Error using loglog\nInvalid data argument."}],"key":"JV6hNux8xG"}],"data":{},"key":"mOVcwy2Zmx"},{"type":"paragraph","position":{"start":{"line":521,"column":1},"end":{"line":521,"column":1}},"children":[{"type":"text","value":"Again the graph is made so that ","position":{"start":{"line":521,"column":1},"end":{"line":521,"column":1}},"key":"wa1NOlnQ4r"},{"type":"inlineMath","value":"h","position":{"start":{"line":521,"column":1},"end":{"line":521,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>h</mi></mrow><annotation encoding=\"application/x-tex\">h</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">h</span></span></span></span>","key":"kdAB5B3wq1"},{"type":"text","value":" decreases from left to right. The errors are dominated at first by truncation error, which decreases most rapidly for the fourth-order formula. However, increasing roundoff error eventually equals and then dominates the truncation error as ","position":{"start":{"line":521,"column":1},"end":{"line":521,"column":1}},"key":"UCJry7CLnx"},{"type":"inlineMath","value":"h","position":{"start":{"line":521,"column":1},"end":{"line":521,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>h</mi></mrow><annotation encoding=\"application/x-tex\">h</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">h</span></span></span></span>","key":"is98qWu89B"},{"type":"text","value":" continues to decrease. As the order of accuracy increases, the crossover point moves to the left (greater efficiency) and down (greater accuracy).","position":{"start":{"line":521,"column":1},"end":{"line":521,"column":1}},"key":"AXHWXK4QMT"}],"key":"jGfhPgJzfD"}],"label":"demo-fdconverge-round-matlab","identifier":"demo-fdconverge-round-matlab","html_id":"demo-fdconverge-round-matlab","key":"lYPz6o8fwC"},{"type":"heading","depth":3,"position":{"start":{"line":524,"column":1},"end":{"line":524,"column":1}},"children":[{"type":"text","value":"5.6 ","position":{"start":{"line":524,"column":1},"end":{"line":524,"column":1}},"key":"bwtNPTZaBr"},{"type":"link","identifier":"section-localapprox-integration","label":"section-localapprox-integration","kind":"narrative","position":{"start":{"line":524,"column":5},"end":{"line":524,"column":37}},"url":"/integration","internal":true,"dataUrl":"/integration.json","children":[{"type":"text","value":"Numerical integration","key":"DIXrcAJVfJ"}],"key":"oqgBwo0Jir"}],"identifier":"id-5-6","label":"5.6 ","html_id":"id-5-6","implicit":true,"key":"Jh72j66WzI"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-int-antideriv","label":"demo-int-antideriv","kind":"proof:example","position":{"start":{"line":526,"column":1},"end":{"line":526,"column":20}},"children":[{"type":"text","value":"Example ","key":"gEG8q1AkjD"},{"type":"text","value":"5.6.1","key":"Zi4zsNQQeG"}],"template":"Example %s","enumerator":"5.6.1","resolved":true,"html_id":"demo-int-antideriv","remote":true,"url":"/integration","dataUrl":"/integration.json","key":"PkKuZrHgnW"}],"key":"KfWKGMYBA4"},{"type":"paragraph","position":{"start":{"line":528,"column":1},"end":{"line":528,"column":1}},"children":[{"type":"text","value":"The antiderivative of ","position":{"start":{"line":528,"column":1},"end":{"line":528,"column":1}},"key":"Gvio8qnLMK"},{"type":"inlineMath","value":"e^x","position":{"start":{"line":528,"column":1},"end":{"line":528,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>e</mi><mi>x</mi></msup></mrow><annotation encoding=\"application/x-tex\">e^x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6644em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span></span></span></span></span></span></span></span>","key":"TjcbSISgoD"},{"type":"text","value":" is, of course, itself. That makes evaluation of ","position":{"start":{"line":528,"column":1},"end":{"line":528,"column":1}},"key":"uXFJ9SNwDd"},{"type":"inlineMath","value":"\\int_0^1 e^x\\,dx","position":{"start":{"line":528,"column":1},"end":{"line":528,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msubsup><mo>∫</mo><mn>0</mn><mn>1</mn></msubsup><msup><mi>e</mi><mi>x</mi></msup><mtext> </mtext><mi>d</mi><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">\\int_0^1 e^x\\,dx</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.3648em;vertical-align:-0.3558em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"margin-right:0.19445em;position:relative;top:-0.0006em;\">∫</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.009em;\"><span style=\"top:-2.3442em;margin-left:-0.1945em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span><span style=\"top:-3.2579em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3558em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"F9lsYrcTl7"},{"type":"text","value":" by the Fundamental Theorem trivial.","position":{"start":{"line":528,"column":1},"end":{"line":528,"column":1}},"key":"EcXOo8VRUm"}],"key":"M79bPUSe1F"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"format long\nexact = exp(1) - 1","key":"suz9htPkED"},{"type":"output","id":"6Cr-XLPrp3AwuxR82qlvt","data":[{"output_type":"execute_result","execution_count":39,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>exact = \n   1.718281828459045\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"exact = \n   1.718281828459045\n","content_type":"text/plain"}}}],"key":"iaOBkZj7rP"}],"data":{},"key":"KszNvHu8nF"},{"type":"paragraph","position":{"start":{"line":538,"column":1},"end":{"line":538,"column":1}},"children":[{"type":"text","value":"MATLAB has numerical integrator ","position":{"start":{"line":538,"column":1},"end":{"line":538,"column":1}},"key":"AFF9eOZHnf"},{"type":"inlineCode","value":"integral","position":{"start":{"line":538,"column":1},"end":{"line":538,"column":1}},"key":"ISM2A2rK2J"},{"type":"text","value":" that estimates the value without finding the antiderivative first. As you can see here, it can be as accurate as floating-point precision allows.","position":{"start":{"line":538,"column":1},"end":{"line":538,"column":1}},"key":"n4rTxf5GBl"}],"indexEntries":[{"entry":"MATLAB","subEntry":{"value":"integral","kind":"entry"},"emphasis":true}],"label":"index-PcG61YnjkN","identifier":"index-pcg61ynjkn","html_id":"index-pcg61ynjkn","key":"H5PfSGJLPJ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"integral(@(x) exp(x), 0, 1)","key":"xsi0aikXWG"},{"type":"output","id":"lrXm5CD-ao5SVrqNzZaQk","data":[{"output_type":"execute_result","execution_count":40,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = \n   1.718281828459045\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = \n   1.718281828459045\n","content_type":"text/plain"}}}],"key":"wfvP1XF6B6"}],"data":{},"key":"kSWa5MYHn0"},{"type":"paragraph","position":{"start":{"line":544,"column":1},"end":{"line":544,"column":1}},"children":[{"type":"text","value":"The numerical approach is also far more robust. For example, ","position":{"start":{"line":544,"column":1},"end":{"line":544,"column":1}},"key":"J8vrGcM4rZ"},{"type":"inlineMath","value":"e^{\\,\\sin x}","position":{"start":{"line":544,"column":1},"end":{"line":544,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>e</mi><mrow><mtext> </mtext><mi>sin</mi><mo>⁡</mo><mi>x</mi></mrow></msup></mrow><annotation encoding=\"application/x-tex\">e^{\\,\\sin x}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8305em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8305em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mspace mtight\" style=\"margin-right:0.1952em;\"></span><span class=\"mop mtight\"><span class=\"mtight\">s</span><span class=\"mtight\">i</span><span class=\"mtight\">n</span></span><span class=\"mspace mtight\" style=\"margin-right:0.1952em;\"></span><span class=\"mord mathnormal mtight\">x</span></span></span></span></span></span></span></span></span></span></span></span>","key":"D18UtRj3rf"},{"type":"text","value":" has no useful antiderivative. But numerically, it’s no more difficult.","position":{"start":{"line":544,"column":1},"end":{"line":544,"column":1}},"key":"hG6Tl37jEj"}],"key":"lXtcT0fW5i"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"integral(@(x) exp(sin(x)), 0, 1)","key":"B1rY93L0FU"},{"type":"output","id":"Xj6nQbappbTZ_woswHdDi","data":[{"output_type":"execute_result","execution_count":41,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = \n   1.631869608418051\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = \n   1.631869608418051\n","content_type":"text/plain"}}}],"key":"li6VBdu8bW"}],"data":{},"key":"aR5dDiKecW"},{"type":"paragraph","position":{"start":{"line":550,"column":1},"end":{"line":550,"column":1}},"children":[{"type":"text","value":"When you look at the graphs of these functions, what’s remarkable is that one of these areas is basic calculus while the other is almost impenetrable analytically. From a numerical standpoint, they are practically the same problem.","position":{"start":{"line":550,"column":1},"end":{"line":550,"column":1}},"key":"aCA2DGDXwt"}],"key":"jHFlb3YrZF"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"x = linspace(0, 1, 201)';\nsubplot(2,1,1), fill([x; 1; 0], [exp(x); 0;0 ], [1, 0.9, 0.9])\ntitle('exp(x)')\nylabel('f(x)')\nsubplot(2, 1, 2), fill([x; 1; 0], [exp(sin(x)); 0; 0], [1, 0.9, 0.9])\ntitle('exp(sin(x))')\nxlabel('x'), ylabel(('f(x)'));","visibility":"hide","key":"CsQU03cfPK"},{"type":"output","id":"kW4D7RHrvkhJ966PV9AUq","data":[{"output_type":"stream","name":"stderr","text":"Failed to execute. Operation may have interrupted by user."}],"visibility":"show","key":"RnMp8cVpor"}],"data":{"tags":[]},"visibility":"show","key":"noQ2PPmnqL"}],"label":"demo-int-antideriv-matlab","identifier":"demo-int-antideriv-matlab","html_id":"demo-int-antideriv-matlab","key":"zyUY8FGNed"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-int-trap","label":"demo-int-trap","kind":"proof:example","position":{"start":{"line":565,"column":1},"end":{"line":565,"column":15}},"children":[{"type":"text","value":"Example ","key":"Znya340kgh"},{"type":"text","value":"5.6.2","key":"DVsD6u7nIf"}],"template":"Example %s","enumerator":"5.6.2","resolved":true,"html_id":"demo-int-trap","remote":true,"url":"/integration","dataUrl":"/integration.json","key":"EPBuNEyN3A"}],"key":"TzV1Th80aj"},{"type":"paragraph","position":{"start":{"line":567,"column":1},"end":{"line":567,"column":1}},"children":[{"type":"text","value":"We will approximate the integral of the function ","position":{"start":{"line":567,"column":1},"end":{"line":567,"column":1}},"key":"DnuAMIYDAr"},{"type":"inlineMath","value":"f(x)=e^{\\sin 7x}","position":{"start":{"line":567,"column":1},"end":{"line":567,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msup><mi>e</mi><mrow><mi>sin</mi><mo>⁡</mo><mn>7</mn><mi>x</mi></mrow></msup></mrow><annotation encoding=\"application/x-tex\">f(x)=e^{\\sin 7x}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8305em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8305em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mop mtight\"><span class=\"mtight\">s</span><span class=\"mtight\">i</span><span class=\"mtight\">n</span></span><span class=\"mspace mtight\" style=\"margin-right:0.1952em;\"></span><span class=\"mord mtight\">7</span><span class=\"mord mathnormal mtight\">x</span></span></span></span></span></span></span></span></span></span></span></span>","key":"wwkpAHE9Pi"},{"type":"text","value":" over the interval ","position":{"start":{"line":567,"column":1},"end":{"line":567,"column":1}},"key":"r240zEDdTB"},{"type":"inlineMath","value":"[0,2]","position":{"start":{"line":567,"column":1},"end":{"line":567,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mn>0</mn><mo separator=\"true\">,</mo><mn>2</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[0,2]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">2</span><span class=\"mclose\">]</span></span></span></span>","key":"SkNUeSvuwb"},{"type":"text","value":".","position":{"start":{"line":567,"column":1},"end":{"line":567,"column":1}},"key":"xboLH7lwtd"}],"key":"GxquFDfzKi"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"f = @(x) exp(sin(7 * x));\na = 0;  b = 2;","key":"BSWCCjOsNv"},{"type":"output","id":"ZuB0U_9GZYIKTaFR8VUuU","data":[],"key":"vNW3M9aOnt"}],"data":{},"key":"hwqoVHx59b"},{"type":"paragraph","position":{"start":{"line":574,"column":1},"end":{"line":574,"column":1}},"children":[{"type":"text","value":"In lieu of the exact value, we use the ","position":{"start":{"line":574,"column":1},"end":{"line":574,"column":1}},"key":"oStgeUlndG"},{"type":"inlineCode","value":"integral","position":{"start":{"line":574,"column":1},"end":{"line":574,"column":1}},"key":"ylPaXJxuz7"},{"type":"text","value":" function to find an accurate result.","position":{"start":{"line":574,"column":1},"end":{"line":574,"column":1}},"key":"tEMsQ1xpIH"}],"key":"dMBKnuL5Ts"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"I = integral(f, a, b, abstol=1e-14, reltol=1e-14);\nfprintf(\"Integral = %.15f\", I)","key":"nRLZ9qgC7o"},{"type":"output","id":"FqYRF_E-Dtpd7h71OQVQF","data":[{"output_type":"stream","name":"stdout","text":"Integral = "},{"output_type":"stream","name":"stdout","text":"2.663219782761539"}],"key":"gF0I81smC8"}],"data":{},"key":"sUBhqPacLj"},{"type":"paragraph","position":{"start":{"line":581,"column":1},"end":{"line":581,"column":1}},"children":[{"type":"text","value":"Here is the trapezoid result at ","position":{"start":{"line":581,"column":1},"end":{"line":581,"column":1}},"key":"np7VeTfzT1"},{"type":"inlineMath","value":"n=40","position":{"start":{"line":581,"column":1},"end":{"line":581,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>=</mo><mn>40</mn></mrow><annotation encoding=\"application/x-tex\">n=40</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">40</span></span></span></span>","key":"n7G29FjHKS"},{"type":"text","value":", and its error.","position":{"start":{"line":581,"column":1},"end":{"line":581,"column":1}},"key":"FuLyMpZHIy"}],"key":"O4NXbhVJBR"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"T = trapezoid(f, a, b, 40);\nfprintf(\"Trapezoid error = %.2e\", I - T)","key":"WPNyjGlDnM"},{"type":"output","id":"hoUanZiVO560uru5JXLqF","data":[{"output_type":"stream","name":"stderr","text":"Error using *\nIncorrect dimensions for matrix multiplication. Check that the number of columns in the first matrix matches the number of rows in the second matrix. To operate on each element of the matrix individually, use TIMES (.*) for elementwise multiplication.\n\nError in trapezoid (line 13)\nt = a + h*(0:n)';"}],"key":"N3S9U6JCRC"}],"data":{},"key":"hKrvCb7gTI"},{"type":"paragraph","position":{"start":{"line":588,"column":1},"end":{"line":588,"column":1}},"children":[{"type":"text","value":"In order to check the order of accuracy, we increase ","position":{"start":{"line":588,"column":1},"end":{"line":588,"column":1}},"key":"Pt96XarzO5"},{"type":"inlineMath","value":"n","position":{"start":{"line":588,"column":1},"end":{"line":588,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"QnFydkguwu"},{"type":"text","value":" by orders of magnitude and observe how the error decreases.","position":{"start":{"line":588,"column":1},"end":{"line":588,"column":1}},"key":"bIP3U6G3Gg"}],"key":"v2AXxyQCKT"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"n = 10 .^ (1:5)';\nerr = zeros(size(n));\nfor i = 1:length(n)\n    T = trapezoid(f, a, b, n(i));\n    err(i) = I - T;\nend\ntable(n, err, variableNames=[\"n\", \"Trapezoid error\"])","key":"nFo0z1aGqz"},{"type":"output","id":"QjAVrRAQYJV6_ACl04CKm","data":[{"output_type":"stream","name":"stderr","text":"Error using *\nIncorrect dimensions for matrix multiplication. Check that the number of columns in the first matrix matches the number of rows in the second matrix. To operate on each element of the matrix individually, use TIMES (.*) for elementwise multiplication.\n\nError in trapezoid (line 13)\nt = a + h*(0:n)';"}],"key":"MPlgOvdNnU"}],"data":{},"key":"bpUBbd0n8S"},{"type":"paragraph","position":{"start":{"line":600,"column":1},"end":{"line":600,"column":1}},"children":[{"type":"text","value":"Each increase by a factor of 10 in ","position":{"start":{"line":600,"column":1},"end":{"line":600,"column":1}},"key":"NhcIsqjxpo"},{"type":"inlineMath","value":"n","position":{"start":{"line":600,"column":1},"end":{"line":600,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"G4LyRH6NlG"},{"type":"text","value":" cuts the error by a factor of about 100, which is consistent with second-order convergence. Another check is that a log-log graph should give a line of slope ","position":{"start":{"line":600,"column":1},"end":{"line":600,"column":1}},"key":"XKEDtPU2bR"},{"type":"text","value":"-2","position":{"start":{"line":600,"column":1},"end":{"line":600,"column":1}},"key":"phQ1h3sMfm"},{"type":"text","value":" as ","position":{"start":{"line":600,"column":1},"end":{"line":600,"column":1}},"key":"kiYeuHrfpU"},{"type":"inlineMath","value":"n\\to\\infty","position":{"start":{"line":600,"column":1},"end":{"line":600,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>→</mo><mi mathvariant=\"normal\">∞</mi></mrow><annotation encoding=\"application/x-tex\">n\\to\\infty</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord\">∞</span></span></span></span>","key":"nQR9LSoXMj"},{"type":"text","value":".","position":{"start":{"line":600,"column":1},"end":{"line":600,"column":1}},"key":"U973vC7krX"}],"key":"XNdgZ2RKk2"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf\nloglog(n, abs(err), \"-o\", displayname=\"trapezoid\")\nhold on\nloglog(n, 0.1 * abs(err(end)) * (n / n(end)).^(-2), \"k--\", displayname=\"O(n^{-2})\")\nxlabel(\"n\");  ylabel(\"error\")\ntitle(\"Convergence of trapezoidal integration\")\nlegend();","key":"ZAKM9E0pO8"},{"type":"output","id":"rt-Dj1c6o72noWLbak2qi","data":[{"output_type":"stream","name":"stderr","text":"Error using loglog\nSpecify the coordinates as vectors or matrices of the same size, or as a vector and a matrix that share the same length in at least one dimension."}],"key":"vI2zURobXl"}],"data":{},"key":"mUPt2WazTE"}],"label":"demo-int-trap-matlab","identifier":"demo-int-trap-matlab","html_id":"demo-int-trap-matlab","key":"XNnL1zuGBF"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-int-extrap","label":"demo-int-extrap","kind":"proof:example","position":{"start":{"line":614,"column":1},"end":{"line":614,"column":17}},"children":[{"type":"text","value":"Example ","key":"HjJ68GY3bS"},{"type":"text","value":"5.6.3","key":"uXsUW9uaWV"}],"template":"Example %s","enumerator":"5.6.3","resolved":true,"html_id":"demo-int-extrap","remote":true,"url":"/integration","dataUrl":"/integration.json","key":"AwZfJXzqKy"}],"key":"XZuXiA44ab"},{"type":"paragraph","position":{"start":{"line":616,"column":1},"end":{"line":616,"column":1}},"children":[{"type":"text","value":"We estimate ","position":{"start":{"line":616,"column":1},"end":{"line":616,"column":1}},"key":"T1gG0rDV2F"},{"type":"inlineMath","value":"\\displaystyle\\int_0^2 x^2 e^{-2x}\\, dx","position":{"start":{"line":616,"column":1},"end":{"line":616,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle scriptlevel=\"0\" displaystyle=\"true\"><msubsup><mo>∫</mo><mn>0</mn><mn>2</mn></msubsup><msup><mi>x</mi><mn>2</mn></msup><msup><mi>e</mi><mrow><mo>−</mo><mn>2</mn><mi>x</mi></mrow></msup><mtext> </mtext><mi>d</mi><mi>x</mi></mstyle></mrow><annotation encoding=\"application/x-tex\">\\displaystyle\\int_0^2 x^2 e^{-2x}\\, dx</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.476em;vertical-align:-0.9119em;\"></span><span class=\"mop\"><span class=\"mop op-symbol large-op\" style=\"margin-right:0.44445em;position:relative;top:-0.0011em;\">∫</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.564em;\"><span style=\"top:-1.7881em;margin-left:-0.4445em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span><span style=\"top:-3.8129em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9119em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">2</span><span class=\"mord mathnormal mtight\">x</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"I04ZIkLpzK"},{"type":"text","value":" using extrapolation. First we use ","position":{"start":{"line":616,"column":1},"end":{"line":616,"column":1}},"key":"vzNsXV9jLU"},{"type":"inlineCode","value":"quadgk","position":{"start":{"line":616,"column":1},"end":{"line":616,"column":1}},"key":"vRkAlRE88z"},{"type":"text","value":" to get an accurate value.","position":{"start":{"line":616,"column":1},"end":{"line":616,"column":1}},"key":"Dfu5JdeDop"}],"key":"ioNqWlHXWi"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"f = @(x) x.^2 .* exp(-2 * x);\na = 0;  b = 2;\nformat long\nI = integral(f, a, b, abstol=1e-14, reltol=1e-14)","key":"Ghgc5Xmb22"},{"type":"output","id":"ItlIM1jC64y0Zf26zprTa","data":[{"output_type":"execute_result","execution_count":48,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>I = \n   0.190474173611614\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"I = \n   0.190474173611614\n","content_type":"text/plain"}}}],"key":"QpGh4ChdjO"}],"data":{},"key":"tqT9xEH14F"},{"type":"paragraph","position":{"start":{"line":625,"column":1},"end":{"line":625,"column":1}},"children":[{"type":"text","value":"We start with the trapezoid formula on ","position":{"start":{"line":625,"column":1},"end":{"line":625,"column":1}},"key":"m287OBGYWo"},{"type":"inlineMath","value":"n=N","position":{"start":{"line":625,"column":1},"end":{"line":625,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>=</mo><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">n=N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span>","key":"iLInDsZkQL"},{"type":"text","value":" nodes.","position":{"start":{"line":625,"column":1},"end":{"line":625,"column":1}},"key":"vnHrdgy6R8"}],"key":"HNhpCF1mKu"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"N = 20;       % the coarsest formula\nn = N;  h = (b - a) / n;\nt = h * (0:n)';\ny = f(t);","key":"duk3hKDLwN"},{"type":"output","id":"H4v7fbU4K97u7GBi7r6da","data":[],"key":"WYLFQr1XU6"}],"data":{},"key":"BYiBveMrdF"},{"type":"paragraph","position":{"start":{"line":634,"column":1},"end":{"line":634,"column":1}},"children":[{"type":"text","value":"We can now apply weights to get the estimate ","position":{"start":{"line":634,"column":1},"end":{"line":634,"column":1}},"key":"RPe1N4DC3q"},{"type":"inlineMath","value":"T_f(N)","position":{"start":{"line":634,"column":1},"end":{"line":634,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>T</mi><mi>f</mi></msub><mo stretchy=\"false\">(</mo><mi>N</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">T_f(N)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0361em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10764em;\">f</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span></span></span></span>","key":"MaM17bUi6l"},{"type":"text","value":".","position":{"start":{"line":634,"column":1},"end":{"line":634,"column":1}},"key":"gIIqBVAd39"}],"key":"sas680AK5I"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"T = h * ( sum(y(2:n)) + y(1) / 2 + y(n+1) / 2 )","key":"IXKd3PbCT5"},{"type":"output","id":"wdHAMwgGOYWLE6D5JPxbE","data":[{"output_type":"execute_result","execution_count":50,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>T = \n  -1.493670886075949\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"T = \n  -1.493670886075949\n","content_type":"text/plain"}}}],"key":"OqRO99Jx0C"}],"data":{},"key":"nCdvY4tjHf"},{"type":"paragraph","position":{"start":{"line":640,"column":1},"end":{"line":640,"column":1}},"children":[{"type":"text","value":"Now we double to ","position":{"start":{"line":640,"column":1},"end":{"line":640,"column":1}},"key":"yeRLBX6S3c"},{"type":"inlineMath","value":"n=2N","position":{"start":{"line":640,"column":1},"end":{"line":640,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>=</mo><mn>2</mn><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">n=2N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord\">2</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span>","key":"KCeDOuaT1g"},{"type":"text","value":", but we only need to evaluate ","position":{"start":{"line":640,"column":1},"end":{"line":640,"column":1}},"key":"Ihj1yOSEQm"},{"type":"inlineMath","value":"f","position":{"start":{"line":640,"column":1},"end":{"line":640,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>","key":"LzQ4SFCq5w"},{"type":"text","value":" at every other interior node and apply ","position":{"start":{"line":640,"column":1},"end":{"line":640,"column":1}},"key":"xlWQP6QksW"},{"type":"crossReference","kind":"equation","identifier":"nc-doubling","label":"nc-doubling","children":[{"type":"text","value":"(","key":"IAMgpvROyZ"},{"type":"text","value":"5.6.18","key":"nPnJX3k3BQ"},{"type":"text","value":")","key":"DdGgEDPecz"}],"template":"(%s)","enumerator":"5.6.18","resolved":true,"html_id":"nc-doubling","remote":true,"url":"/integration","dataUrl":"/integration.json","key":"A37PXqUcJU"},{"type":"text","value":".","position":{"start":{"line":640,"column":1},"end":{"line":640,"column":1}},"key":"dLrltTfzLN"}],"key":"Hq62gT5U1D"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"n = 2*n;  h = h / 2;\nt = h * (0:n)';\nT(2) = T(1) / 2 + h * sum( f(t(2:2:n)) )","key":"r2OaGbUjNC"},{"type":"output","id":"_jha_M3_QSzQRgsdri-MV","data":[{"output_type":"execute_result","execution_count":51,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>T = 1×2 double\n  -1.493670886075949   0.300770763620601\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"T = 1×2 double\n  -1.493670886075949   0.300770763620601\n","content_type":"text/plain"}}}],"key":"Awo9bNCC50"}],"data":{},"key":"htnJENCcJ9"},{"type":"paragraph","position":{"start":{"line":648,"column":1},"end":{"line":648,"column":1}},"children":[{"type":"text","value":"We can repeat the same code to double ","position":{"start":{"line":648,"column":1},"end":{"line":648,"column":1}},"key":"GX5CVzpd2P"},{"type":"inlineMath","value":"n","position":{"start":{"line":648,"column":1},"end":{"line":648,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"FewDs741gX"},{"type":"text","value":" again.","position":{"start":{"line":648,"column":1},"end":{"line":648,"column":1}},"key":"Jw9mpZJ0IV"}],"key":"Y2IByOMJRD"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"n = 2*n;  h = h / 2;\nt = h * (0:n)';\nT(3) = T(2) / 2 + h * sum( f(t(2:2:n)) )","key":"Xv4IL8gCXU"},{"type":"output","id":"NA6PO5BhvgCbpa5a7no0V","data":[{"output_type":"execute_result","execution_count":52,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>T = 1×3 double\n  -1.493670886075949   0.300770763620601   1.196511626792319\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"T = 1×3 double\n  -1.493670886075949   0.300770763620601   1.196511626792319\n","content_type":"text/plain"}}}],"key":"S65OR8nbZr"}],"data":{},"key":"ifk61GXhYL"},{"type":"paragraph","position":{"start":{"line":656,"column":1},"end":{"line":656,"column":1}},"children":[{"type":"text","value":"Let us now do the first level of extrapolation to get results from Simpson’s formula. We combine the elements ","position":{"start":{"line":656,"column":1},"end":{"line":656,"column":1}},"key":"LiJgtQSbcx"},{"type":"inlineCode","value":"T[i]","position":{"start":{"line":656,"column":1},"end":{"line":656,"column":1}},"key":"EOOc5rqXAg"},{"type":"text","value":" and ","position":{"start":{"line":656,"column":1},"end":{"line":656,"column":1}},"key":"Q2GPqlg1uF"},{"type":"inlineCode","value":"T[i+1]","position":{"start":{"line":656,"column":1},"end":{"line":656,"column":1}},"key":"we94incgU1"},{"type":"text","value":" the same way for ","position":{"start":{"line":656,"column":1},"end":{"line":656,"column":1}},"key":"e9TqijOgp6"},{"type":"inlineMath","value":"i=1","position":{"start":{"line":656,"column":1},"end":{"line":656,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">i=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"VwTlJYivlg"},{"type":"text","value":" and ","position":{"start":{"line":656,"column":1},"end":{"line":656,"column":1}},"key":"tbF2sEJXxO"},{"type":"inlineMath","value":"i=2","position":{"start":{"line":656,"column":1},"end":{"line":656,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi><mo>=</mo><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">i=2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span></span></span></span>","key":"Fo4TYgNPwd"},{"type":"text","value":".","position":{"start":{"line":656,"column":1},"end":{"line":656,"column":1}},"key":"SUSBp11sAM"}],"key":"jrXQVzbxCX"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"S = (4 * T(2:3) - T(1:2)) / 3","key":"jUJGF7FUMH"},{"type":"output","id":"zQh26a-XAa0d3ZaYe-iYJ","data":[{"output_type":"stream","name":"stderr","text":"Failed to execute. Operation may have interrupted by user."}],"key":"stWgnS39di"}],"data":{},"key":"bs9k5vJVPq"},{"type":"paragraph","position":{"start":{"line":662,"column":1},"end":{"line":662,"column":1}},"children":[{"type":"text","value":"With the two Simpson values ","position":{"start":{"line":662,"column":1},"end":{"line":662,"column":1}},"key":"RhI3mizxEH"},{"type":"inlineMath","value":"S_f(N)","position":{"start":{"line":662,"column":1},"end":{"line":662,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>S</mi><mi>f</mi></msub><mo stretchy=\"false\">(</mo><mi>N</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">S_f(N)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0361em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10764em;\">f</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span></span></span></span>","key":"XNkvM8E5x2"},{"type":"text","value":" and ","position":{"start":{"line":662,"column":1},"end":{"line":662,"column":1}},"key":"InHQNchPiE"},{"type":"inlineMath","value":"S_f(2N)","position":{"start":{"line":662,"column":1},"end":{"line":662,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>S</mi><mi>f</mi></msub><mo stretchy=\"false\">(</mo><mn>2</mn><mi>N</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">S_f(2N)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0361em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10764em;\">f</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\">2</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span></span></span></span>","key":"hJAaIhJ9xk"},{"type":"text","value":" in hand, we can do one more level of extrapolation to get a sixth-order accurate result.","position":{"start":{"line":662,"column":1},"end":{"line":662,"column":1}},"key":"rSFmZL7za1"}],"key":"oOYdUGZHf8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"R = (16*S(2) - S(1)) / 15","key":"zzPLCJ5kT6"},{"type":"output","id":"obVdUGhaG4MJcxflkQSNc","data":[{"output_type":"execute_result","execution_count":54,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>R = \n   1.534836843471565\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"R = \n   1.534836843471565\n","content_type":"text/plain"}}}],"key":"FFnwwyA9vi"}],"data":{},"key":"l3Nu8iXqEM"},{"type":"paragraph","position":{"start":{"line":668,"column":1},"end":{"line":668,"column":1}},"children":[{"type":"text","value":"We can make a triangular table of the errors:","position":{"start":{"line":668,"column":1},"end":{"line":668,"column":1}},"key":"gCzeF6wK5K"}],"key":"agQe8PAXJ0"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"err2 = T(:) - I;\nerr4 = [NaN; S(:) - I];\nerr6 = [NaN; NaN; R - I];\nformat short e\ntable(err2, err4, err6, variablenames=[\"order 2\", \"order 4\", \"order 6\"])","key":"a7ioOrJ8GA"},{"type":"output","id":"dDgQfsW2oWgzNbZU4bpcQ","data":[{"output_type":"execute_result","execution_count":55,"metadata":{},"data":{"text/html":{"content":"<html><head><style>.mwBasicVariableOutputWrapper .mwBasicVariableOutputHeader {font-style: italic;}</style></head><body><div class='mwBasicVariableOutputWrapper'><div>ans = <span class='mwBasicVariableOutputHeader'>3x3 table</span></div><table><thead><tr><th>order 2</th><th>order 4</th><th>order 6</th></tr></thead><tbody><tr><td>-1.6841e+00</td><td>NaN</td><td>NaN</td></tr><tr><td>1.1030e-01</td><td>7.0844e-01</td><td>NaN</td></tr><tr><td>1.0060e+00</td><td>1.3046e+00</td><td>1.3444e+00</td></tr></tbody></table></div></body></html>","content_type":"text/html"},"text/plain":{"content":"<html><head><style>.mwBasicVariableOutputWrapper .mwBasicVariableOutputHeader {font-style: italic;}</style></head><body><div class='mwBasicVariableOutputWrapper'><div>ans = <span class='mwBasicVariableOutputHeader'>3x3 table</span></div><table><thead><tr><th>order 2</th><th>order 4</th><th>order 6</th></tr></thead><tbody><tr><td>-1.6841e+00</td><td>NaN</td><td>NaN</td></tr><tr><td>1.1030e-01</td><td>7.0844e-01</td><td>NaN</td></tr><tr><td>1.0060e+00</td><td>1.3046e+00</td><td>1.3444e+00</td></tr></tbody></table></div></body></html>","content_type":"text/plain"}}}],"key":"QUqa7gp950"}],"data":{},"key":"nYzsXjn8FP"},{"type":"paragraph","position":{"start":{"line":678,"column":1},"end":{"line":678,"column":1}},"children":[{"type":"text","value":"If we consider the computational time to be dominated by evaluations of ","position":{"start":{"line":678,"column":1},"end":{"line":678,"column":1}},"key":"wKSOXu86XH"},{"type":"inlineMath","value":"f","position":{"start":{"line":678,"column":1},"end":{"line":678,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>","key":"rv0rJUGNCl"},{"type":"text","value":", then we have obtained a result with about twice as many accurate digits as the best trapezoid result, at virtually no extra cost.","position":{"start":{"line":678,"column":1},"end":{"line":678,"column":1}},"key":"SBHg5xmZsu"}],"key":"vpP0jJyfn0"}],"label":"demo-int-extrap-matlab","identifier":"demo-int-extrap-matlab","html_id":"demo-int-extrap-matlab","key":"tl8jzRXBEk"},{"type":"heading","depth":3,"position":{"start":{"line":681,"column":1},"end":{"line":681,"column":1}},"children":[{"type":"text","value":"5.7 ","position":{"start":{"line":681,"column":1},"end":{"line":681,"column":1}},"key":"ByM55MUT3D"},{"type":"link","identifier":"section-localapprox-adaptive","label":"section-localapprox-adaptive","kind":"narrative","position":{"start":{"line":681,"column":5},"end":{"line":681,"column":34}},"url":"/adaptive","internal":true,"dataUrl":"/adaptive.json","children":[{"type":"text","value":"Adaptive integration","key":"u74aWDZ2le"}],"key":"hQDvRBCkNm"}],"identifier":"id-5-7","label":"5.7 ","html_id":"id-5-7","implicit":true,"key":"s7g32IXYgF"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-adapt-motive","label":"demo-adapt-motive","kind":"proof:example","position":{"start":{"line":684,"column":1},"end":{"line":684,"column":19}},"children":[{"type":"text","value":"Example ","key":"c5lfvTBf71"},{"type":"text","value":"5.7.1","key":"gqNnmyE3lB"}],"template":"Example %s","enumerator":"5.7.1","resolved":true,"html_id":"demo-adapt-motive","remote":true,"url":"/adaptive","dataUrl":"/adaptive.json","key":"PmmmleANpv"}],"key":"uY9j9cueaC"},{"type":"paragraph","position":{"start":{"line":686,"column":1},"end":{"line":686,"column":1}},"children":[{"type":"text","value":"This function gets increasingly oscillatory as ","position":{"start":{"line":686,"column":1},"end":{"line":686,"column":1}},"key":"Dncgc4lAqF"},{"type":"inlineMath","value":"x","position":{"start":{"line":686,"column":1},"end":{"line":686,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"nMQSUuziCA"},{"type":"text","value":" increases.","position":{"start":{"line":686,"column":1},"end":{"line":686,"column":1}},"key":"gBKQo5cMd1"}],"key":"VwkufXgbK2"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"f = @(x) (x + 1).^2 .* cos((2 * x + 1) ./ (x - 4.3));\nclf\nfplot(f, [0, 4], 2000)\nxlabel('x'), ylabel(('f(x)'));","key":"J37JELK8fU"},{"type":"output","id":"SRAg_mDmmFR73GpxEzXzu","data":[{"output_type":"execute_result","execution_count":56,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"d5fdc34464654c48edb27cef5e4733d7","path":"/build/d5fdc34464654c48edb27cef5e4733d7.png"}}}],"key":"ZhTkMp2q8u"}],"data":{},"key":"BKthmV7IQD"},{"type":"paragraph","position":{"start":{"line":695,"column":1},"end":{"line":695,"column":1}},"children":[{"type":"text","value":"Accordingly, the trapezoid rule is more accurate on the left half of this interval than on the right half.","position":{"start":{"line":695,"column":1},"end":{"line":695,"column":1}},"key":"yjLqhpQdhd"}],"key":"LOhFQeovma"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"left_val = integral(f, 0, 2, abstol=1e-14, reltol=1e-14);\nright_val = integral(f, 2, 4, abstol=1e-14, reltol=1e-14);\n\nn = round(50 * 2 .^ (0:3)');\nerr = zeros(length(n), 2);\nfor i = 1:length(n)\n    T = trapezoid(f, 0, 2, n(i));\n    err(i, 1) = T - left_val;\n    T = trapezoid(f, 2, 4, n(i));\n    err(i, 2) = T - right_val;\nend\ntable(n, err(:, 1), err(:, 2), variableNames=[\"n\", \"left error\", \"right error\"])","key":"FJyAiw8oK9"},{"type":"output","id":"wAUqHi-SDjQuQrxz8DOyN","data":[{"output_type":"execute_result","execution_count":57,"metadata":{},"data":{"text/html":{"content":"<html><head><style>.mwBasicVariableOutputWrapper .mwBasicVariableOutputHeader {font-style: italic;}</style></head><body><div class='mwBasicVariableOutputWrapper'><div>ans = <span class='mwBasicVariableOutputHeader'>4x3 table</span></div><table><thead><tr><th>n</th><th>left error</th><th>right error</th></tr></thead><tbody><tr><td>50</td><td>-2.4911e-03</td><td>5.0423e-01</td></tr><tr><td>100</td><td>-6.2271e-04</td><td>9.6004e-02</td></tr><tr><td>200</td><td>-1.5568e-04</td><td>2.2547e-02</td></tr><tr><td>400</td><td>-3.8919e-05</td><td>5.5542e-03</td></tr></tbody></table></div></body></html>","content_type":"text/html"},"text/plain":{"content":"<html><head><style>.mwBasicVariableOutputWrapper .mwBasicVariableOutputHeader {font-style: italic;}</style></head><body><div class='mwBasicVariableOutputWrapper'><div>ans = <span class='mwBasicVariableOutputHeader'>4x3 table</span></div><table><thead><tr><th>n</th><th>left error</th><th>right error</th></tr></thead><tbody><tr><td>50</td><td>-2.4911e-03</td><td>5.0423e-01</td></tr><tr><td>100</td><td>-6.2271e-04</td><td>9.6004e-02</td></tr><tr><td>200</td><td>-1.5568e-04</td><td>2.2547e-02</td></tr><tr><td>400</td><td>-3.8919e-05</td><td>5.5542e-03</td></tr></tbody></table></div></body></html>","content_type":"text/plain"}}}],"key":"KSQ7gIwSmq"}],"data":{},"key":"JY07KVYX7x"},{"type":"paragraph","position":{"start":{"line":712,"column":1},"end":{"line":712,"column":1}},"children":[{"type":"text","value":"Both the picture and the numerical results suggest that more nodes should be used on the right half of the interval than on the left half.","position":{"start":{"line":712,"column":1},"end":{"line":712,"column":1}},"key":"dkyMCDYCN3"}],"key":"piWRGWobUn"}],"label":"demo-adapt-motive-matlab","identifier":"demo-adapt-motive-matlab","html_id":"demo-adapt-motive-matlab","key":"ACQ48nqKpI"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-adapt-usage","label":"demo-adapt-usage","kind":"proof:example","position":{"start":{"line":716,"column":1},"end":{"line":716,"column":18}},"children":[{"type":"text","value":"Example ","key":"FD2RasTuYl"},{"type":"text","value":"5.7.2","key":"ocWpHg43uX"}],"template":"Example %s","enumerator":"5.7.2","resolved":true,"html_id":"demo-adapt-usage","remote":true,"url":"/adaptive","dataUrl":"/adaptive.json","key":"f7vCDv9BLd"}],"key":"w8v2vfM1SI"},{"type":"paragraph","position":{"start":{"line":718,"column":1},"end":{"line":718,"column":1}},"children":[{"type":"text","value":"We’ll integrate the function from ","position":{"start":{"line":718,"column":1},"end":{"line":718,"column":1}},"key":"RU9wZekLW9"},{"type":"crossReference","kind":"proof:example","identifier":"demo-adapt-motive","label":"demo-adapt-motive","children":[{"type":"text","value":"Demo ","key":"iVeFVffHOe"},{"type":"text","value":"5.7.1","key":"vU1ApCg8bM"}],"template":"Example %s","enumerator":"5.7.1","resolved":true,"html_id":"demo-adapt-motive","remote":true,"url":"/adaptive","dataUrl":"/adaptive.json","key":"NdTtrLBgCi"},{"type":"text","value":".","position":{"start":{"line":718,"column":1},"end":{"line":718,"column":1}},"key":"pNolo2jhQL"}],"key":"Rw0BI7wrL8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"f = @(x) (x + 1).^2 .* cos((2 * x + 1) ./ (x - 4.3));","key":"t60q4HVa7R"},{"type":"output","id":"KmJlo19RUAPwYm4K8GWiW","data":[],"key":"pgKp6RKYWI"}],"data":{},"key":"jVhpOMhPPo"},{"type":"paragraph","position":{"start":{"line":724,"column":1},"end":{"line":724,"column":1}},"children":[{"type":"text","value":"We perform the integration and show the nodes selected underneath the curve.","position":{"start":{"line":724,"column":1},"end":{"line":724,"column":1}},"key":"DjFCLlXPMt"}],"key":"LpXyoI6C4c"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[Q, t] = intadapt(f, 0, 4, 0.001);\nclf, fplot(f, [0, 4], 2000)\nhold on\nstem(t, f(t), '.-')\ntitle('Adaptive node selection')\nxlabel('x'), ylabel('f(x)')\nfprintf(\"number of nodes = %d\", length(t))","key":"JiI55gGOuK"},{"type":"output","id":"AcsQTD1xiuWtl812Nx8du","data":[{"output_type":"execute_result","execution_count":59,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"2ca1cadf1fd08d856b0646096e535f4e","path":"/build/2ca1cadf1fd08d856b0646096e535f4e.png"}}},{"output_type":"stream","name":"stdout","text":"number of nodes = "},{"output_type":"stream","name":"stdout","text":"69"}],"key":"nYF8vJRt5D"}],"data":{},"key":"NFy03MxUrL"},{"type":"paragraph","position":{"start":{"line":736,"column":1},"end":{"line":736,"column":1}},"children":[{"type":"text","value":"The error turns out to be a bit more than we requested. It’s only an estimate, not a guarantee.","position":{"start":{"line":736,"column":1},"end":{"line":736,"column":1}},"key":"L1JkuQrbEC"}],"key":"O47q7rb4km"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"I = integral(f, 0, 4, abstol=1e-14, reltol=1e-14);    % 'exact' value\nfprintf(\"error = %.2e\", abs(Q - I))","key":"BJVv5cJnBF"},{"type":"output","id":"VTTavcGW7WxaCul_UYxlJ","data":[{"output_type":"stream","name":"stderr","text":"Error using integralCalc>finalInputChecks (line 548)\nOutput of the function must be the same size as the input. If FUN is an array-valued integrand, set the 'ArrayValued' option to true.\n\nError in integralCalc>iterateScalarValued (line 335)\n        [ATOL,RTOL,WT,EWT,NODES] = finalInputChecks(x,fx, ...\n\nError in integralCalc>vadapt (line 148)\n    [q,errbnd] = iterateScalarValued(u,tinterval,pathlen, ...\n\nError in integralCalc (line 77)\n        [q,errbnd] = vadapt(vfunAB,interval, ...\n\nError in integral (line 87)\nQ = integralCalc(fun,a,b,opstruct);"}],"key":"PYLhavACip"}],"data":{},"key":"KCsPD2vEmA"},{"type":"paragraph","position":{"start":{"line":743,"column":1},"end":{"line":743,"column":1}},"children":[{"type":"text","value":"Let’s see how the number of integrand evaluations and the error vary with the requested tolerance.","position":{"start":{"line":743,"column":1},"end":{"line":743,"column":1}},"key":"Fi8G0e1wKg"}],"key":"Sxds7p8B1T"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"tol = 1 ./ 10.^(4:14)';\nerr = zeros(size(tol));\nn = zeros(size(tol));\nfor k = 1:length(tol)\n    [A, t] = intadapt(f, 0, 4, tol(k));\n    err(k) =  I - A;\n    n(k) = length(t);\nend\ntable(tol, err, n, variableNames=[\"tolerance\", \"error\", \"number of nodes\"])","key":"x2KeeyVOVD"},{"type":"output","id":"ZM6tiCHCTXEKPZsLzgHXb","data":[{"output_type":"stream","name":"stderr","text":"Index exceeds the number of array elements. Index must not exceed 1.\n\nError in f46_nlsystem (line 3)\n    f(1) = exp(x(2) - x(1)) - 2;\n\nError in intadapt (line 12)\n[Q,t] = do_integral(a,f(a),b,f(b),m,f(m),tol);"}],"key":"a6SA526TQO"}],"data":{},"key":"pjsv1t62cx"},{"type":"paragraph","position":{"start":{"line":757,"column":1},"end":{"line":757,"column":1}},"children":[{"type":"text","value":"As you can see, even though the errors are not smaller than the estimates, the two columns decrease in tandem. If we consider now the convergence not in ","position":{"start":{"line":757,"column":1},"end":{"line":757,"column":1}},"key":"n0JmmTXLry"},{"type":"inlineMath","value":"h","position":{"start":{"line":757,"column":1},"end":{"line":757,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>h</mi></mrow><annotation encoding=\"application/x-tex\">h</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">h</span></span></span></span>","key":"rvzYAkiUDv"},{"type":"text","value":", which is poorly defined now, but in the number of nodes actually chosen, we come close to the fourth-order accuracy of the underlying Simpson scheme.","position":{"start":{"line":757,"column":1},"end":{"line":757,"column":1}},"key":"md3AzktwSG"}],"key":"OLlfOwp4Ll"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf\nloglog(n, abs(err), \"-o\", displayname=\"results\")\nxlabel(\"number of nodes\"), ylabel(\"error\")\ntitle(\"Convergence of adaptive integration\")\norder4 = 0.1 * abs(err(end)) * (n / n(end)).^(-4);\nhold on\nloglog(n, order4, \"k--\", displayname=\"O(n^{-4})\")\nlegend();","key":"ECQbj2AP7j"},{"type":"output","id":"kDJJ0PAY_z-NFud8eYFt3","data":[{"output_type":"execute_result","execution_count":62,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"7aed8ff982a47bfa64c41fd14febb200","path":"/build/7aed8ff982a47bfa64c41fd14febb200.png"}}}],"key":"JI61WwKWaa"}],"data":{},"key":"CwB6TJKAzl"}],"label":"demo-adapt-usage-matlab","identifier":"demo-adapt-usage-matlab","html_id":"demo-adapt-usage-matlab","key":"Oth41e0TyN"}],"key":"IqOdTw07Td"}],"key":"X0sNG90mXH"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Chapter 4","url":"/chapter4-1","group":"MATLAB codes"},"next":{"title":"Chapter 6","url":"/chapter6-1","group":"MATLAB codes"}}},"domain":"http://localhost:3000"}