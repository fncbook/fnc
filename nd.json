{"kind":"Notebook","sha256":"0c1a2acdb47752af387153cac52ca68b308b3f57cec6b964def02deeeb04d89f","slug":"nd","location":"/chapter10/section3/julia/2nd.ipynb","dependencies":[],"frontmatter":{"numbering":{"heading_1":{"enabled":false},"heading_2":{"enabled":false},"heading_3":{"enabled":false},"heading_4":{"enabled":false},"heading_5":{"enabled":false},"heading_6":{"enabled":false}},"kernelspec":{"name":"julia-1.11","display_name":"Julia 1","language":"julia"},"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"exports":[{"format":"ipynb","filename":"2nd.ipynb","url":"/fnc/build/2nd-dc249cc36fea86ce6c1e349bbf97408d.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"a2XEz4q49w"},{"type":"text","value":"10.3.1","key":"cM6t3pEjqB"}],"key":"HbPL1M5Lft"}],"identifier":"demo-diffmats-2nd","label":"demo-diffmats-2nd","kind":"proof:example","template":"Example %s","enumerator":"10.3.1","resolved":true,"html_id":"demo-diffmats-2nd","remote":true,"url":"/diffmats","dataUrl":"/diffmats.json","key":"IQbYoEInnc"}],"key":"T8mbofBKf0"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We test first-order and second-order differentiation matrices for the function ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"bsv6Cvp6dI"},{"type":"inlineMath","value":"x + \\exp(\\sin 4x)","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mo>+</mo><mi>exp</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mi>sin</mi><mo>⁡</mo><mn>4</mn><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">x + \\exp(\\sin 4x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop\">exp</span><span class=\"mopen\">(</span><span class=\"mop\">sin</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">4</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span>","key":"xoBRYdRPv2"},{"type":"text","value":" over ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"tO9I0FMB0p"},{"type":"inlineMath","value":"[-1,1]","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mo>−</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[-1,1]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">−</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]</span></span></span></span>","key":"bbWF882ALD"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Y5o7yv4am7"}],"key":"VCUsYda1Ay"}],"key":"REfBgov0V0"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:28:58.200000Z","iopub.status.busy":"2025-01-14T15:28:55.265000Z","iopub.execute_input":"2025-01-14T15:28:57.526000Z","shell.execute_reply":"2025-01-14T15:28:58.156000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"f = x -> x + exp(sin(4 * x));","key":"mJ4HNbVlE3"},{"type":"output","id":"WQBeQqC1eY1NWYFkE9Rw7","data":[],"key":"RZh4B6AqWh"}],"key":"F3uFoJvthi"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"For reference, here are the exact first and second derivatives.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"NAI8pmZNYO"}],"key":"HYLBHAYgg8"}],"key":"uQ2bfy5iXn"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:28:58.352000Z","iopub.status.busy":"2025-01-14T15:28:58.271000Z","iopub.execute_input":"2025-01-14T15:28:58.332000Z","shell.execute_reply":"2025-01-14T15:28:58.351000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"df_dx = x -> 1 + 4 * exp(sin(4x)) * cos(4x);\nd2f_dx2 = x -> 4 * exp(sin(4x)) * (4 * cos(4x)^2 - 4 * sin(4x));","key":"Glg8nkKm5M"},{"type":"output","id":"FR9_Az7i2bUQ2QQHc8A8k","data":[],"key":"fn0GVbYvLQ"}],"key":"Pp2sBjsf0u"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We discretize on equally spaced nodes and evaluate ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OivOkBfRnZ"},{"type":"inlineMath","value":"f","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>","key":"QwJyTWLFE1"},{"type":"text","value":" at the nodes.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"yDdTSuU0Yo"}],"key":"RhRYaRuvOf"}],"key":"L17CH8njEi"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:29:02.312000Z","iopub.status.busy":"2025-01-14T15:28:58.356000Z","iopub.execute_input":"2025-01-14T15:28:58.356000Z","shell.execute_reply":"2025-01-14T15:29:02.310000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"t, Dₓ, Dₓₓ = FNC.diffmat2(18, [-1, 1])\ny = f.(t);","key":"J71X5ZHXhs"},{"type":"output","id":"Y-j4FMPC_X0e_Yf0rjqav","data":[],"key":"VwCNWmjTUP"}],"key":"sF1xcgFCbt"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Then the first two derivatives of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"u9Yq7hCUDB"},{"type":"inlineMath","value":"f","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>","key":"HJMWuY6Vo5"},{"type":"text","value":" each require one matrix-vector multiplication.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"d9feedAxXm"}],"key":"QqIrAD8y9a"}],"key":"cI63Cnyafx"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:29:02.325000Z","iopub.status.busy":"2025-01-14T15:29:02.322000Z","iopub.execute_input":"2025-01-14T15:29:02.322000Z","shell.execute_reply":"2025-01-14T15:29:02.325000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"yₓ = Dₓ * y\nyₓₓ = Dₓₓ * y;","key":"QaU1VnmqoN"},{"type":"output","id":"R1Ym4Z6sLbox08qL82KC1","data":[],"key":"RwcPY0j06Z"}],"key":"MElCsL6bV8"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The results show poor accuracy for this small value of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xpwFPTpwcv"},{"type":"inlineMath","value":"n","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"xvZLRmtenz"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TfvAEqFXhU"}],"key":"PXhc468pKY"}],"key":"KCcOb4EAlx"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:30:05.898000Z","iopub.status.busy":"2025-01-14T15:29:02.328000Z","iopub.execute_input":"2025-01-14T15:29:02.328000Z","shell.execute_reply":"2025-01-14T15:30:05.881000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"plot(df_dx, -1, 1, layout = 2, xaxis = (L\"x\"), yaxis = (L\"f'(x)\"))\nscatter!(t, yₓ, subplot = 1)\nplot!(d2f_dx2, -1, 1, subplot = 2, xaxis = (L\"x\"), yaxis = (L\"f''(x)\"))\nscatter!(t, yₓₓ, subplot = 2)","key":"HiIL5RKZcQ"},{"type":"output","id":"oVYThw2fqYEngPliqO2XL","data":[{"output_type":"execute_result","execution_count":6,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"775dd46354e93e07461d9c4a640f3880","path":"/fnc/build/775dd46354e93e07461d9c4a640f3880.png"},"text/html":{"content_type":"text/html","hash":"3a5fad5b52966a1b15ec7056906d333e","path":"/fnc/build/3a5fad5b52966a1b15ec7056906d333e.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"806fee854988184bce0d60781abacb1f","path":"/fnc/build/806fee854988184bce0d60781abacb1f.svg"}}}],"key":"xbtlhEiDy4"}],"key":"KoPzhjGto5"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"A convergence experiment confirms the order of accuracy. Because we expect an algebraic convergence rate, we use a log-log plot of the errors.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UcuUkGPj0a"}],"key":"qRWE7SjikG"}],"key":"NenYnTxiTw"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:30:15.209000Z","iopub.status.busy":"2025-01-14T15:30:05.945000Z","iopub.execute_input":"2025-01-14T15:30:05.946000Z","shell.execute_reply":"2025-01-14T15:30:15.165000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"n = @. round(Int, 2^(4:0.5:11))\nerr = zeros(length(n), 2)\nfor (k, n) in enumerate(n)\n    t, Dₓ, Dₓₓ = FNC.diffmat2(n, [-1, 1])\n    y = f.(t)\n    err[k, 1] = norm(df_dx.(t) - Dₓ * y, Inf)\n    err[k, 2] = norm(d2f_dx2.(t) - Dₓₓ * y, Inf)\nend\nplot(n, err, m = :o, label = [L\"f'\" L\"f''\"])\nplot!(n, 10 * 10 * n .^ (-2);\n    l = (:dash, :black),\n    label = \"2nd order\",\n    xaxis = (:log10, \"n\"),\n    yaxis = (:log10, \"max error\"),\n    title = \"Convergence of finite differences\")","key":"z9Jev7WtMW"},{"type":"output","id":"f-0LqR-o5aaaALtCQMChG","data":[{"output_type":"execute_result","execution_count":7,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"cf04358e67277d7df5af5c4901499897","path":"/fnc/build/cf04358e67277d7df5af5c4901499897.png"},"text/html":{"content_type":"text/html","hash":"706f16de53b54744fb61309c41fbb7ed","path":"/fnc/build/706f16de53b54744fb61309c41fbb7ed.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"4834a27180e39d65ec179c28c34a67b8","path":"/fnc/build/4834a27180e39d65ec179c28c34a67b8.svg"}}}],"key":"HXJTW8o1w5"}],"key":"wcujlorBeU"}],"key":"EYZcC129UT"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Unstable","url":"/unstable-1","group":"Chapter 10"},"next":{"title":"Cheb","url":"/cheb","group":"Chapter 10"}}},"domain":"http://localhost:3000"}