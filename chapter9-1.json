{"kind":"Notebook","sha256":"77ec273b9987e90467b5ee13e1968115e6e19d0bcfca4e83694589df5cc6f64c","slug":"chapter9-1","location":"/matlab/chapter9.md","dependencies":[],"frontmatter":{"title":"Chapter 9","numbering":{"heading_1":{"enabled":false},"heading_2":{"enabled":false},"heading_3":{"enabled":false},"heading_4":{"enabled":false},"heading_5":{"enabled":false},"heading_6":{"enabled":false}},"kernelspec":{"name":"jupyter_matlab_kernel","display_name":"MATLAB","language":"matlab"},"content_includes_title":false,"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"exports":[{"format":"md","filename":"chapter9.md","url":"/build/chapter9-9c7a738d2c4809137d0b66c3ca25db82.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Functions","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"YkDeGvaN85"}],"identifier":"functions","label":"Functions","html_id":"functions","implicit":true,"key":"ylhbzcgVJg"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Barycentric polynomial interpolation","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"C0EWkVLkBE"}],"key":"ZwFVdkYGT0"},{"type":"include","file":"FNC-matlab/polyinterp.m","literal":true,"filter":{},"children":[{"type":"code","value":"function p = polyinterp(t,y)\r\n% POLYINTERP Polynomial interpolation by the barycentric formula.\r\n% Input:\r\n%   t   interpolation nodes (vector, length n+1)\r\n%   y   interpolation values (vector, length n+1)\r\n% Output:\r\n%   p   polynomial interpolant (function)\r\n\r\nt = t(:);                    % column vector\r\nn = length(t)-1;\r\nC = (t(end)-t(1)) / 4;       % scaling factor to ensure stability\r\ntc = t/C;\r\n\r\n% Adding one node at a time, compute inverses of the weights.\r\nomega = ones(n+1,1);\r\nfor m = 1:n\r\n    d = (tc(1:m) - tc(m+1));    % vector of node differences\r\n    omega(1:m) = omega(1:m).*d; % update previous \r\n    omega(m+1) = prod( -d );    % compute the new one\r\nend\r\nw = 1./omega;                   % go from inverses to weights\r\n\r\np = @evaluate;\r\n\r\n    function f = evaluate(x)\r\n        % % Compute interpolant, one value of x at a time.\r\n        f = zeros(size(x));\r\n        for j = 1:numel(x)\r\n            terms = w ./ (x(j) - t );\r\n            f(j) = sum(y.*terms) / sum(terms);\r\n        end\r\n        \r\n        % Apply L'Hopital's Rule exactly.\r\n        for j = find( isnan(f(:)) )'      % divided by zero here\r\n            [~,idx] = min( abs(x(j)-t) );   % node closest to x(j)\r\n            f(j) = y(idx);                  % value at node\r\n        end        \r\n    end\r\n\r\nend","lang":"matlab","showLineNumbers":true,"filename":"polyinterp.m","key":"JoKPn0PKdM"}],"key":"ui6lKD7u4i"}],"label":"function-polyinterp-matlab","identifier":"function-polyinterp-matlab","html_id":"function-polyinterp-matlab","key":"OMv4UTi6TF"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Trigonometric interpolation","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"UFrYMttD7o"}],"key":"ki9ooGMsCc"},{"type":"include","file":"FNC-matlab/triginterp.m","literal":true,"filter":{},"children":[{"type":"code","value":"function p = triginterp(t,y)\r\n% TRIGINTERP Trigonometric interpolation.\r\n% Input:\r\n%   t   equispaced interpolation nodes (vector, length N)\r\n%   y   interpolation values (vector, length N)\r\n% Output:\r\n%   p   trigonometric interpolant (function)\r\n\r\nN = length(t);\r\np = @value;\r\n\r\n    function f = value(x)\r\n        f = zeros(size(x));\r\n        for k = 1:N\r\n            f = f + y(k)*trigcardinal(x-t(k));\r\n        end\r\n    end\r\n        \r\n    function tau = trigcardinal(x)\r\n        if rem(N,2)==1   % odd\r\n            tau = sin(N*pi*x/2) ./ (N*sin(pi*x/2));\r\n        else             % even\r\n            tau = sin(N*pi*x/2) ./ (N*tan(pi*x/2));\r\n        end\r\n        tau(isnan(tau)) = 1;\r\n    end\r\n        \r\nend","lang":"matlab","showLineNumbers":true,"filename":"triginterp.m","key":"WJX0215ZGt"}],"key":"me7EOtPY8b"}],"label":"function-triginterp-matlab","identifier":"function-triginterp-matlab","html_id":"function-triginterp-matlab","key":"aXjO7t08TN"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Clenshaw-Curtis integration","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"BmZNoGYshx"}],"key":"D85771aadM"},{"type":"include","file":"FNC-matlab/ccint.m","literal":true,"filter":{},"children":[{"type":"code","value":"function [I,x] = ccint(f,n)\r\n% CCINT  Clenshaw-Curtis numerical integration.\r\n% Input:\r\n%   f     integrand (function)\r\n%   n     one less than the number of nodes (even integer)\r\n% Output:\r\n%   I     estimate of integral(f,-1,1)\r\n%   x     evaluation nodes of f (vector)\r\n\r\n% Find Chebyshev extreme nodes.\r\ntheta = pi*(0:n)'/n;\r\nx = -cos(theta);\r\n\r\n% Compute the C-C weights.\r\nc = zeros(1,n+1); \r\nc([1 n+1]) = 1/(n^2-1); \r\ntheta = theta(2:n); \r\nv = ones(n-1,1);\r\nfor k = 1:n/2-1\r\n  v = v - 2*cos(2*k*theta)/(4*k^2-1);\r\nend\r\nv = v - cos(n*theta)/(n^2-1);\r\nc(2:n) = 2*v/n;\r\n\r\n% Evaluate integrand and integral.\r\nI = c*f(x);   % use vector inner product","lang":"matlab","showLineNumbers":true,"filename":"ccint.m","key":"XH8Rc40Co3"}],"key":"IOI2aR7Z7W"}],"label":"function-ccint-matlab","identifier":"function-ccint-matlab","html_id":"function-ccint-matlab","key":"c4Q7EikNE7"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Gauss-Legendre integration","position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"key":"cWBBX9ErZz"}],"key":"i1UdScq0hz"},{"type":"include","file":"FNC-matlab/glint.m","literal":true,"filter":{},"children":[{"type":"code","value":"function [I,x] = glint(f,n)\r\n% GLINT  Gauss-Legendre numerical integration.\r\n% Input:\r\n%   f     integrand (function)\r\n%   n     number of nodes (integer)\r\n% Output:\r\n%   I     estimate of integral(f,-1,1)\r\n%   x     evaluation nodes of f (vector)\r\n\r\n% Nodes and weights are found via a tridiagonal eigenvalue problem.\r\nbeta = 0.5./sqrt(1-(2*(1:n-1)).^(-2));\r\nT = diag(beta,1) + diag(beta,-1);\r\n[V,D] = eig(T);\r\nx = diag(D); [x,idx] = sort(x);    % nodes\r\nc = 2*V(1,idx).^2;                 % weights\r\n\r\n% Evaluate the integrand and compute the integral.\r\nI = c*f(x);      % vector inner product","lang":"matlab","showLineNumbers":true,"filename":"glint.m","key":"Yl1253sLY9"}],"key":"q2pOUS7GCt"}],"label":"function-glint-matlab","identifier":"function-glint-matlab","html_id":"function-glint-matlab","key":"n0Z210Higj"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Integration over ","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"key":"pGhVnMqLsu"},{"type":"inlineMath","value":"(-\\infty,\\infty)","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mo>−</mo><mi mathvariant=\"normal\">∞</mi><mo separator=\"true\">,</mo><mi mathvariant=\"normal\">∞</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(-\\infty,\\infty)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\">−</span><span class=\"mord\">∞</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">∞</span><span class=\"mclose\">)</span></span></span></span>","key":"TTPoXLSZzy"}],"key":"XNo06myRKn"},{"type":"include","file":"FNC-matlab/intinf.m","literal":true,"filter":{},"children":[{"type":"code","value":"function [I, x] = intinf(f, tol)\r\n% INTINF   Adaptive doubly exponential integration over (-inf,inf).\r\n% Input:\r\n%   f   integrand (function)\r\n%   tol error tolerance (positive scalar)\r\n% Output:\r\n%   I   approximation to intergal(f) over (-inf,inf)\r\n%   x   evaluation nodes (vector) \r\n\r\nxi = @(t) sinh(sinh(t));\r\ndxi_dt = @(t) cosh(t) .* cosh(sinh(t));\r\ng = @(t) f(xi(t)) .* dxi_dt(t);\r\n\r\n% Find where to truncate the integration interval.\r\nM = 3;\r\nwhile (abs(g(-M)) > tol/100) || (abs(g(M)) > tol/100)\r\n    M = M + 0.5;\r\n    if isinf(xi(M)) \r\n        warning(\"Function may not decay fast enough.\")\r\n        M = M - 0.5;\r\n        break\r\n    end\r\nend\r\n\r\n[I, t] = intadapt(g, -M, M, tol);\r\nx = xi(t);\r\nend","lang":"matlab","showLineNumbers":true,"filename":"intinf.m","key":"dv1aqHJk8W"}],"key":"lq7FYyK13k"}],"label":"function-intinf-matlab","identifier":"function-intinf-matlab","html_id":"function-intinf-matlab","key":"AXaEL074z8"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Integration with endpoint singularities","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"lMRiQZN6sR"}],"key":"kv1nYw3FXq"},{"type":"include","file":"FNC-matlab/intsing.m","literal":true,"filter":{},"children":[{"type":"code","value":"function [I, x] = intsing(f, tol)\r\n% INTSING   Adaptively integrate a function with a singularity at the left endpoint.\r\n% Input:\r\n%   f   integrand  (function)\r\n%   tol error tolerance (positive scalar)\r\n% Output:\r\n%   I   approximation to integral(f) over (0,1)\r\n%   x   evaluation nodes (vector)\r\n\r\nxi = @(t) 2 ./ (1 + exp( 2*sinh(t) ));\r\ndxi_dt = @(t) cosh(t) ./ cosh( sinh(t) ).^2;\r\ng = @(t) f(xi(t)) .* dxi_dt(t);\r\n\r\n% Find where to truncate the integration interval.\r\nM = 3;\r\nwhile abs(g(M)) > tol/100\r\n    M = M + 0.5;\r\n    if xi(M) == 0\r\n        warning(\"Function may grow too rapidly.\")\r\n        M = M - 0.5;\r\n        break\r\n    end\r\nend\r\n\r\n[I, t] = intadapt(g, 0, M, tol);\r\nx = xi(t);\r\nend","lang":"matlab","showLineNumbers":true,"filename":"intsing.m","key":"Tx9z4Az4Eb"}],"key":"jpIkIrBar3"}],"label":"function-intsing-matlab","identifier":"function-intsing-matlab","html_id":"function-intsing-matlab","key":"LfjV6wIK4O"},{"type":"heading","depth":2,"position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"children":[{"type":"text","value":"Examples","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"key":"TufBAhToY9"}],"identifier":"examples","label":"Examples","html_id":"examples","implicit":true,"key":"CZiNemRGM8"}],"key":"Yvp9oIidvm"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"cd  /Users/driscoll/Documents/GitHub/fnc/matlab\nFNC_init","visibility":"show","key":"q3JytjBrOm"},{"type":"output","id":"DWx8-S7AuFEHBi0QuMWsp","data":[{"output_type":"stream","name":"stdout","text":"Executing ..."}],"visibility":"show","key":"Gc3jtc9qcb"}],"data":{"tags":[]},"visibility":"remove","key":"itkBnmhTpJ"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"children":[{"type":"text","value":"9.1 ","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"key":"EYphQkP0r9"},{"type":"link","identifier":"section-globalapprox-polynomial","label":"section-globalapprox-polynomial","kind":"narrative","position":{"start":{"line":75,"column":5},"end":{"line":75,"column":37}},"url":"/polynomial","internal":true,"dataUrl":"/polynomial.json","children":[{"type":"text","value":"Polynomial interpolation","key":"Ljqxf8jQlp"}],"key":"otgAVqOJgR"}],"identifier":"id-9-1","label":"9.1 ","html_id":"id-9-1","implicit":true,"key":"hFHoWT3Ino"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-polynomial-lagrange","label":"demo-polynomial-lagrange","kind":"proof:example","position":{"start":{"line":78,"column":1},"end":{"line":78,"column":26}},"children":[{"type":"text","value":"Example ","key":"m0y5pYEwVF"},{"type":"text","value":"9.1.1","key":"Jp3Nl6TVD8"}],"template":"Example %s","enumerator":"9.1.1","resolved":true,"html_id":"demo-polynomial-lagrange","remote":true,"url":"/polynomial","dataUrl":"/polynomial.json","key":"j1h068GMUO"}],"key":"DWmpsqMxW6"},{"type":"paragraph","position":{"start":{"line":80,"column":1},"end":{"line":80,"column":1}},"children":[{"type":"text","value":"Here is a vector of nodes.","position":{"start":{"line":80,"column":1},"end":{"line":80,"column":1}},"key":"cw98KX1lJc"}],"key":"q6KjIY9ay7"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"t = [ 1, 1.5, 2, 2.25, 2.75, 3 ];\nn = 5;  k = 2;\nnot_k = [0:k-1 k+1:n];   % all except the kth node","key":"lIAjKIp0dW"},{"type":"output","id":"yA4cB1mcIt9Ss3ODv-vK2","data":[],"key":"RkygxYBlWE"}],"data":{},"key":"J60XFKNG6t"},{"type":"paragraph","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"children":[{"type":"text","value":"Let’s apply the definition of the cardinal Lagrange polynomial for ","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"key":"wu42s28C6D"},{"type":"inlineMath","value":"k=2","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi><mo>=</mo><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">k=2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span></span></span></span>","key":"AwnaQRRNMp"},{"type":"text","value":". First we define a polynomial ","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"key":"IllrcWq6f3"},{"type":"inlineMath","value":"q","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>q</mi></mrow><annotation encoding=\"application/x-tex\">q</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span></span></span></span>","key":"Yop9t6y3uD"},{"type":"text","value":" that is zero at all the nodes except ","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"key":"gQquBDzwHT"},{"type":"inlineMath","value":"i=k","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi><mo>=</mo><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">i=k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span>","key":"QtOIPOzIT2"},{"type":"text","value":". Then ","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"key":"Id7bqWKq3D"},{"type":"inlineMath","value":"\\ell_2","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"normal\">ℓ</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\ell_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord\">ℓ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"nXoANA1WOA"},{"type":"text","value":" is found by normalizing ","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"key":"EXOWQAWrXY"},{"type":"inlineMath","value":"q","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>q</mi></mrow><annotation encoding=\"application/x-tex\">q</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span></span></span></span>","key":"XprlHO2l9x"},{"type":"text","value":" by ","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"key":"obb2wto5Bk"},{"type":"inlineMath","value":"q(t_k)","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>q</mi><mo stretchy=\"false\">(</mo><msub><mi>t</mi><mi>k</mi></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">q(t_k)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"Vnq6DCrfsN"},{"type":"text","value":".","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"key":"dOILUC5lfw"}],"key":"yPZSr4RMRl"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"VlLAjIQ5tL"}],"key":"MbfN7qLVzI"},{"type":"paragraph","position":{"start":{"line":91,"column":1},"end":{"line":91,"column":1}},"children":[{"type":"text","value":"Whenever we index into the node vector ","position":{"start":{"line":91,"column":1},"end":{"line":91,"column":1}},"key":"Powqfn0pe8"},{"type":"inlineCode","value":"t","position":{"start":{"line":91,"column":1},"end":{"line":91,"column":1}},"key":"g9Rf3Nuj9k"},{"type":"text","value":", we have to add 1 since the mathematical index starts at zero.","position":{"start":{"line":91,"column":1},"end":{"line":91,"column":1}},"key":"ES6bH0UEQv"}],"key":"F7ja9TiRt9"}],"class":"dropdown","key":"lBfZx1AxAa"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"q = @(x) prod(x - t(not_k + 1));\nell_k = @(x) q(x) ./ q(t(k + 1));","key":"P4CBzMc1M5"},{"type":"output","id":"2ZUXor37d5zgVKILkYiRx","data":[],"key":"s9OTFrM4gd"}],"data":{},"key":"ysKkSopbB3"},{"type":"paragraph","position":{"start":{"line":100,"column":1},"end":{"line":100,"column":1}},"children":[{"type":"text","value":"A plot confirms the cardinal property of the result.","position":{"start":{"line":100,"column":1},"end":{"line":100,"column":1}},"key":"veABlZNV6Y"}],"key":"yWKSMp4Y2e"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf\nfplot(ell_k, [1, 3])\nhold on, grid on\nplot(t(not_k + 1), 0 * t(not_k + 1), 'o')\nplot(t(k + 1), 1, 'o')\nxlabel('x'),  ylabel('\\ell_2(x)')    \ntitle('Lagrange cardinal function')","key":"MwHuSDt2Yu"},{"type":"output","id":"Wt0DvR-0xd6cRdmwce6qa","data":[{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"c42df9e68dd7e2c00ae1159aabeefbb0","path":"/build/c42df9e68dd7e2c00ae1159aabeefbb0.png"}}}],"key":"r9yghCBCDK"}],"data":{},"key":"IjeK2FTXhO"},{"type":"paragraph","position":{"start":{"line":112,"column":1},"end":{"line":112,"column":1}},"children":[{"type":"text","value":"Observe that ","position":{"start":{"line":112,"column":1},"end":{"line":112,"column":1}},"key":"Bv7XYzCMws"},{"type":"inlineMath","value":"\\ell_k","position":{"start":{"line":112,"column":1},"end":{"line":112,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"normal\">ℓ</mi><mi>k</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\ell_k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord\">ℓ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"egzQNIgq6Y"},{"type":"text","value":" is ","position":{"start":{"line":112,"column":1},"end":{"line":112,"column":1}},"key":"hwb7Nkp1Un"},{"type":"emphasis","position":{"start":{"line":112,"column":1},"end":{"line":112,"column":1}},"children":[{"type":"text","value":"not","position":{"start":{"line":112,"column":1},"end":{"line":112,"column":1}},"key":"Wh1vkUgce3"}],"key":"Q8ZxqH8npC"},{"type":"text","value":" between zero and one everywhere, unlike a hat function.","position":{"start":{"line":112,"column":1},"end":{"line":112,"column":1}},"key":"GobpJAHhtW"}],"key":"E93vAw7wPO"}],"label":"demo-polynomial-lagrange-matlab","identifier":"demo-polynomial-lagrange-matlab","html_id":"demo-polynomial-lagrange-matlab","key":"fRBk6VKeoc"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-polynomial-error","label":"demo-polynomial-error","kind":"proof:example","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":23}},"children":[{"type":"text","value":"Example ","key":"UwiIY1YvCX"},{"type":"text","value":"9.1.3","key":"HDPZyiv60t"}],"template":"Example %s","enumerator":"9.1.3","resolved":true,"html_id":"demo-polynomial-error","remote":true,"url":"/polynomial","dataUrl":"/polynomial.json","key":"uI93iyqtWM"}],"key":"vGTaonDfAp"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"t =  [ 1, 1.6, 1.9, 2.7, 3 ];\nn = length(t) - 1;\nPhi = @(x) prod(x - t);\n\nclf,  fplot(@(x) Phi(x) / 5, [1, 3])\nhold on,  plot(t, 0*t, 'o')\nxlabel('x'),  ylabel('\\Phi(x)')   \ntitle('Interpolation error function')","key":"SiRg1475Iy"},{"type":"output","id":"yOZ9ffktvGxcbd3o0YN6e","data":[{"output_type":"execute_result","execution_count":5,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"b92ae5acc8f6ae6d045216047e7f8eef","path":"/build/b92ae5acc8f6ae6d045216047e7f8eef.png"}}}],"key":"UKIfoUjm8w"}],"data":{},"key":"n9Xc5P2d2U"},{"type":"paragraph","position":{"start":{"line":130,"column":1},"end":{"line":130,"column":1}},"children":[{"type":"text","value":"The error is zero at the nodes, by the definition of interpolation. The error bound, as well as the error itself, has one local maximum between each consecutive pair of nodes.","position":{"start":{"line":130,"column":1},"end":{"line":130,"column":1}},"key":"ni3GFyyD6B"}],"key":"TKXLVXC46H"}],"label":"demo-polynomial-error-matlab","identifier":"demo-polynomial-error-matlab","html_id":"demo-polynomial-error-matlab","key":"trRMixrPcW"},{"type":"heading","depth":3,"position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"children":[{"type":"text","value":"9.2 ","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"key":"MgaTaNVVBo"},{"type":"link","identifier":"section-globalapprox-barycentric","label":"section-globalapprox-barycentric","kind":"narrative","position":{"start":{"line":133,"column":5},"end":{"line":133,"column":38}},"url":"/barycentric","internal":true,"dataUrl":"/barycentric.json","children":[{"type":"text","value":"The barycentric formula","key":"iQGc8sF9Mg"}],"key":"gxtJ9Wd1Zz"}],"identifier":"id-9-2","label":"9.2 ","html_id":"id-9-2","implicit":true,"key":"LwiY1avwW5"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-barycentric-example","label":"demo-barycentric-example","kind":"proof:example","position":{"start":{"line":136,"column":1},"end":{"line":136,"column":26}},"children":[{"type":"text","value":"Example ","key":"GWaIbfA0ZI"},{"type":"text","value":"9.2.2","key":"YvwCSUfeDk"}],"template":"Example %s","enumerator":"9.2.2","resolved":true,"html_id":"demo-barycentric-example","remote":true,"url":"/barycentric","dataUrl":"/barycentric.json","key":"M2s6hvn0EV"}],"key":"EGdhuSth7F"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"f = @(x) sin( exp(2 * x) );\nclf,  fplot(f, [0, 1], displayname=\"function\")\nxlabel('x'),  ylabel('f(x)')   \nlegend(location=\"southwest\");","key":"DZaEOQsTCf"},{"type":"output","id":"wn-YqA0asYvfxAS0FMo9A","data":[{"output_type":"execute_result","execution_count":6,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"dff05598f740d8f1f208c1f3afad3e0b","path":"/build/dff05598f740d8f1f208c1f3afad3e0b.png"}}}],"key":"MR4ypPq6oU"}],"data":{},"key":"BufsCsXD5d"},{"type":"paragraph","position":{"start":{"line":145,"column":1},"end":{"line":145,"column":1}},"children":[{"type":"text","value":"We start with 4 equally spaced nodes (","position":{"start":{"line":145,"column":1},"end":{"line":145,"column":1}},"key":"XRn788QJIp"},{"type":"inlineMath","value":"n=3","position":{"start":{"line":145,"column":1},"end":{"line":145,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>=</mo><mn>3</mn></mrow><annotation encoding=\"application/x-tex\">n=3</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">3</span></span></span></span>","key":"GTP3008MdS"},{"type":"text","value":").","position":{"start":{"line":145,"column":1},"end":{"line":145,"column":1}},"key":"SGaxItKJNI"}],"key":"QidC7r1Gog"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"t = linspace(0, 1, 4)'; \ny = f(t);\np = polyinterp(t, y);\nhold on,  fplot(p, [0, 1], displayname=\"interpolant on 4 nodes\")\nscatter(t, y, 'k', displayname=\"nodes\")","key":"C1gcnIixod"},{"type":"output","id":"nN9h-CijjLiis5lZMDkhZ","data":[{"output_type":"execute_result","execution_count":7,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"2863ffd96cb901030b80dd100b0d1458","path":"/build/2863ffd96cb901030b80dd100b0d1458.png"}}}],"key":"j9XckTbVM7"}],"data":{},"key":"HEi6g6jyTw"},{"type":"paragraph","position":{"start":{"line":155,"column":1},"end":{"line":155,"column":1}},"children":[{"type":"text","value":"The curves always intersect at the interpolation nodes. For ","position":{"start":{"line":155,"column":1},"end":{"line":155,"column":1}},"key":"pESpRQqhTM"},{"type":"inlineMath","value":"n=6","position":{"start":{"line":155,"column":1},"end":{"line":155,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>=</mo><mn>6</mn></mrow><annotation encoding=\"application/x-tex\">n=6</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">6</span></span></span></span>","key":"PLDhEltlpG"},{"type":"text","value":", the interpolant is noticeably better.","position":{"start":{"line":155,"column":1},"end":{"line":155,"column":1}},"key":"RTfsV8EhCU"}],"key":"nxStrbLQrJ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"cla,  fplot(f, [0, 1], displayname=\"function\")\nt = linspace(0, 1, 7)'; \ny = f(t);\np = polyinterp(t, y);\nhold on,  fplot(p, [0, 1], displayname=\"interpolant on 7 nodes\")\nscatter(t, y, 'k', displayname=\"nodes\")","key":"SG0FR4yMWL"},{"type":"output","id":"oN8yrYlLNwG2lJaalKNnD","data":[{"output_type":"execute_result","execution_count":8,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"8ce226398e32620a5868b90509f18377","path":"/build/8ce226398e32620a5868b90509f18377.png"}}}],"key":"hYLdYOtHCF"}],"data":{},"key":"ML6nMWxYOc"}],"label":"demo-barycentric-example-matlab","identifier":"demo-barycentric-example-matlab","html_id":"demo-barycentric-example-matlab","key":"NwIyNddpXW"},{"type":"heading","depth":3,"position":{"start":{"line":167,"column":1},"end":{"line":167,"column":1}},"children":[{"type":"text","value":"9.3 ","position":{"start":{"line":167,"column":1},"end":{"line":167,"column":1}},"key":"oqcAIOkzdz"},{"type":"link","identifier":"section-globalapprox-stability","label":"section-globalapprox-stability","kind":"narrative","position":{"start":{"line":167,"column":5},"end":{"line":167,"column":36}},"url":"/stability-1","internal":true,"dataUrl":"/stability-1.json","children":[{"type":"text","value":"Stability of polynomial interpolation","key":"NOSUfnOKUN"}],"key":"vI3jgMorDj"}],"identifier":"id-9-3","label":"9.3 ","html_id":"id-9-3","implicit":true,"key":"IkJlb7chp4"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-stability-equispaced","label":"demo-stability-equispaced","kind":"proof:example","position":{"start":{"line":170,"column":1},"end":{"line":170,"column":27}},"children":[{"type":"text","value":"Example ","key":"Eji1gM6q5B"},{"type":"text","value":"9.3.1","key":"aEqWU9cQ6O"}],"template":"Example %s","enumerator":"9.3.1","resolved":true,"html_id":"demo-stability-equispaced","remote":true,"url":"/stability-1","dataUrl":"/stability-1.json","key":"wrUuYKkIBm"}],"key":"oyJ8oZAzrb"},{"type":"paragraph","position":{"start":{"line":172,"column":1},"end":{"line":172,"column":1}},"children":[{"type":"text","value":"We choose a function over the interval ","position":{"start":{"line":172,"column":1},"end":{"line":172,"column":1}},"key":"ZpxdAzM8Q2"},{"type":"inlineMath","value":"[0,1]","position":{"start":{"line":172,"column":1},"end":{"line":172,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mn>0</mn><mo separator=\"true\">,</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[0,1]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]</span></span></span></span>","key":"BlnfWi70Jg"},{"type":"text","value":". Using 7 equally spaced nodes, the interpolation looks fine.","position":{"start":{"line":172,"column":1},"end":{"line":172,"column":1}},"key":"Kl5lEnsAPq"}],"key":"fbXj5GVHWv"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"f = @(x) sin(exp(2*x));\nclf,  fplot(f, [0, 1], displayname=\"function\")\nt = linspace(0, 1, 7);\ny = f(t);\nhold on,  scatter(t, y, displayname=\"nodes\")\np = polyinterp(t, y)\nfplot(p, [0, 1], displayname=\"interpolant\")\nxlabel('x'),  ylabel('f(x)') \ntitle('Test function')","key":"Mkd3KMRd6m"},{"type":"output","id":"7zk8Zt4U1iCGSsltUDFXY","data":[{"output_type":"execute_result","execution_count":9,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"a3db141b17562bb87e3abe1f525d1ee3","path":"/build/a3db141b17562bb87e3abe1f525d1ee3.png"}}},{"output_type":"execute_result","execution_count":9,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>p = function_handle with value:\n    @polyinterp/evaluate\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"p = function_handle with value:\n    @polyinterp/evaluate\n","content_type":"text/plain"}}}],"key":"LAGhOpBGdW"}],"data":{},"key":"yLrpOFSatR"},{"type":"paragraph","position":{"start":{"line":186,"column":1},"end":{"line":186,"column":1}},"children":[{"type":"text","value":"We want to track the behavior of the error as ","position":{"start":{"line":186,"column":1},"end":{"line":186,"column":1}},"key":"GMcWef6k27"},{"type":"inlineMath","value":"n","position":{"start":{"line":186,"column":1},"end":{"line":186,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"wupNbeY4Dn"},{"type":"text","value":" increases. We will estimate the error in the continuous interpolant by sampling it at a large number of points and taking the max-norm.","position":{"start":{"line":186,"column":1},"end":{"line":186,"column":1}},"key":"VqzH5KhB9g"}],"key":"yNNH8vpcos"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"n = (5:5:60)';   \nerr = zeros(size(n));\nx = linspace(0, 1, 1001)';         % for measuring error\nfor k = 1:length(n) \n  t = linspace(0, 1, n(k) + 1)';     % equally spaced nodes\n  y = f(t);                      % interpolation data\n  p = polyinterp(t, y);\n  err(k) = norm(f(x) - p(x), Inf);\nend\nclf,  semilogy(n, err, 'o-')\nxlabel('n'),  ylabel('max error')   \ntitle('Equispaced polynomial interpolation error')","visibility":"hide","key":"DH03MiVzvw"},{"type":"output","id":"j5S9ljxYp1QJcE8YLJ8bu","data":[{"output_type":"execute_result","execution_count":10,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"08b6d1e7eb3b07bd9ee0dffe4831d38c","path":"/build/08b6d1e7eb3b07bd9ee0dffe4831d38c.png"}}}],"visibility":"show","key":"GwZIPyZem4"}],"data":{"tags":[]},"visibility":"show","key":"Op4vuZ2jGL"},{"type":"paragraph","position":{"start":{"line":204,"column":1},"end":{"line":204,"column":1}},"children":[{"type":"text","value":"The error initially decreases as one would expect but then begins to grow. Both phases occur at rates that are exponential in ","position":{"start":{"line":204,"column":1},"end":{"line":204,"column":1}},"key":"ei3ve9qjJ8"},{"type":"inlineMath","value":"n","position":{"start":{"line":204,"column":1},"end":{"line":204,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"nFTGNuLt3h"},{"type":"text","value":", i.e., ","position":{"start":{"line":204,"column":1},"end":{"line":204,"column":1}},"key":"Jr9XYakNBH"},{"type":"inlineMath","value":"O(K^n","position":{"start":{"line":204,"column":1},"end":{"line":204,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><msup><mi>K</mi><mi>n</mi></msup></mrow><annotation encoding=\"application/x-tex\">O(K^n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span></span></span></span></span></span></span>","key":"DSrjgJmaCp"},{"type":"text","value":") for a constant ","position":{"start":{"line":204,"column":1},"end":{"line":204,"column":1}},"key":"IS4aYjII5W"},{"type":"inlineMath","value":"K","position":{"start":{"line":204,"column":1},"end":{"line":204,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>K</mi></mrow><annotation encoding=\"application/x-tex\">K</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span></span></span></span>","key":"IagFtEeVeN"},{"type":"text","value":", appearing linear on a semi-log plot.","position":{"start":{"line":204,"column":1},"end":{"line":204,"column":1}},"key":"QrbIh3P5m3"}],"key":"LlzHKsV7l7"}],"label":"demo-stability-equispaced-matlab","identifier":"demo-stability-equispaced-matlab","html_id":"demo-stability-equispaced-matlab","key":"C0e6XaaF9v"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-stability-errfun","label":"demo-stability-errfun","kind":"proof:example","position":{"start":{"line":208,"column":1},"end":{"line":208,"column":23}},"children":[{"type":"text","value":"Example ","key":"A85Gc3QyRw"},{"type":"text","value":"9.3.2","key":"aqzmV84vqp"}],"template":"Example %s","enumerator":"9.3.2","resolved":true,"html_id":"demo-stability-errfun","remote":true,"url":"/stability-1","dataUrl":"/stability-1.json","key":"GDNl3YUzLE"}],"key":"FHp2fEqXtH"},{"type":"paragraph","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"children":[{"type":"text","value":"We plot ","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"key":"Pp5R0seGID"},{"type":"inlineMath","value":"|\\Phi(x)|","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">∣</mi><mi mathvariant=\"normal\">Φ</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mi mathvariant=\"normal\">∣</mi></mrow><annotation encoding=\"application/x-tex\">|\\Phi(x)|</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">∣Φ</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mord\">∣</span></span></span></span>","key":"TLXPuI75Nt"},{"type":"text","value":" over the interval ","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"key":"KptbgJpux9"},{"type":"inlineMath","value":"[-1,1]","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mo>−</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[-1,1]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">−</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]</span></span></span></span>","key":"K7xuQRo76X"},{"type":"text","value":" with equispaced nodes for different values of ","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"key":"TeAxk3GxMp"},{"type":"inlineMath","value":"n","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"k3aC7uV7O5"},{"type":"text","value":".","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"key":"ujmpGw9X5p"}],"key":"mQKAv4XuWm"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf\nx = linspace(-1, 1, 1601)';\nPhi = zeros(size(x));\nfor n = 10:10:50\n    t = linspace(-1, 1, n+1)';\n    for k = 1:length(x)\n        Phi(k) = prod(x(k) - t);\n    end\n    semilogy(x, abs(Phi)),  hold on\nend\ntitle('Error indicator on equispaced nodes')    \nxlabel('x'),  ylabel('|\\Phi(x)|')","visibility":"hide","key":"Fykycurwt2"},{"type":"output","id":"oadz75D_QRgBs_nvo_PRD","data":[{"output_type":"execute_result","execution_count":11,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"1f47973bbc6b6ae4b5a39600f5b286c6","path":"/build/1f47973bbc6b6ae4b5a39600f5b286c6.png"}}}],"visibility":"show","key":"TCobaZzOP6"}],"data":{"tags":[]},"visibility":"show","key":"PGLjQO5chs"},{"type":"paragraph","position":{"start":{"line":228,"column":1},"end":{"line":228,"column":1}},"children":[{"type":"text","value":"Each time ","position":{"start":{"line":228,"column":1},"end":{"line":228,"column":1}},"key":"PFLL0DaEJW"},{"type":"text","value":"Φ","position":{"start":{"line":228,"column":1},"end":{"line":228,"column":1}},"key":"Z0asmUAU0q"},{"type":"text","value":" passes through zero at an interpolation node, the value on the log scale should go to ","position":{"start":{"line":228,"column":1},"end":{"line":228,"column":1}},"key":"Vs6SdqyAmm"},{"type":"inlineMath","value":"-\\infty","position":{"start":{"line":228,"column":1},"end":{"line":228,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>−</mo><mi mathvariant=\"normal\">∞</mi></mrow><annotation encoding=\"application/x-tex\">-\\infty</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord\">−</span><span class=\"mord\">∞</span></span></span></span>","key":"eJet7iFKe6"},{"type":"text","value":", which explains the numerous cusps on the curves.","position":{"start":{"line":228,"column":1},"end":{"line":228,"column":1}},"key":"P9Cy9y22Wf"}],"key":"tEqqdbZTMi"}],"label":"demo-stability-errfun-matlab","identifier":"demo-stability-errfun-matlab","html_id":"demo-stability-errfun-matlab","key":"sKrlsQDktz"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-stability-runge","label":"demo-stability-runge","kind":"proof:example","position":{"start":{"line":232,"column":1},"end":{"line":232,"column":22}},"children":[{"type":"text","value":"Example ","key":"kwpuze1MHR"},{"type":"text","value":"9.3.3","key":"rzFZSlrkx1"}],"template":"Example %s","enumerator":"9.3.3","resolved":true,"html_id":"demo-stability-runge","remote":true,"url":"/stability-1","dataUrl":"/stability-1.json","key":"UQo6h3C6eg"}],"key":"yYFPlcLg5R"},{"type":"paragraph","position":{"start":{"line":234,"column":1},"end":{"line":234,"column":1}},"children":[{"type":"text","value":"This function has infinitely many continuous derivatives on the entire real line and looks easy to approximate over ","position":{"start":{"line":234,"column":1},"end":{"line":234,"column":1}},"key":"XZZc9Knc7x"},{"type":"inlineMath","value":"[-1,1]","position":{"start":{"line":234,"column":1},"end":{"line":234,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mo>−</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[-1,1]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">−</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]</span></span></span></span>","key":"ZT6CvuStG6"},{"type":"text","value":".","position":{"start":{"line":234,"column":1},"end":{"line":234,"column":1}},"key":"uvrk4xIJEP"}],"key":"gbxisIVySD"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"f = @(x) 1 ./ (x.^2 + 16);\nclf,  fplot(f, [-1, 1])\nxlabel('x'),  ylabel('f(x)')    \ntitle('Test function')","key":"uww9hcc04g"},{"type":"output","id":"EgBbBB31vrSmB7ACsrFDr","data":[{"output_type":"execute_result","execution_count":12,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"2550c604c7d26e007edcd2fe06e1859a","path":"/build/2550c604c7d26e007edcd2fe06e1859a.png"}}}],"key":"xa6PSt7Aa9"}],"data":{},"key":"ql4cteISYt"},{"type":"paragraph","position":{"start":{"line":243,"column":1},"end":{"line":243,"column":1}},"children":[{"type":"text","value":"We start by doing equispaced polynomial interpolation for some small values of ","position":{"start":{"line":243,"column":1},"end":{"line":243,"column":1}},"key":"LS0om5Q0pc"},{"type":"inlineMath","value":"n","position":{"start":{"line":243,"column":1},"end":{"line":243,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"dxU7agjJE7"},{"type":"text","value":".","position":{"start":{"line":243,"column":1},"end":{"line":243,"column":1}},"key":"qb6y4IN5Tc"}],"key":"GUIraYuMSL"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"x = linspace(-1, 1, 1601)';\nn = (4:4:12)';\nfor k = 1:length(n)\n    t = linspace(-1, 1, n(k) + 1)';        % equally spaced nodes\n    p = polyinterp(t, f(t));\n    semilogy(x, abs(f(x) - p(x)));  hold on\nend\ntitle('Error for degrees 4, 8, 12')   \nxlabel('x'), ylabel('|f(x) - p(x)|')","visibility":"hide","key":"MquKp0YIZ4"},{"type":"output","id":"-HYogfdvfDSpe-eANiP0R","data":[{"output_type":"execute_result","execution_count":13,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"ffb38838d8a7479833a9c2d29f324a99","path":"/build/ffb38838d8a7479833a9c2d29f324a99.png"}}}],"visibility":"show","key":"qrOXjQNydX"}],"data":{"tags":[]},"visibility":"show","key":"mRMi7KvFsJ"},{"type":"paragraph","position":{"start":{"line":258,"column":1},"end":{"line":258,"column":1}},"children":[{"type":"text","value":"The convergence so far appears rather good, though not uniformly so. However, notice what happens as we continue to increase the degree.","position":{"start":{"line":258,"column":1},"end":{"line":258,"column":1}},"key":"NZIemqvEol"}],"key":"mckh10g0GE"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"n = 12 + 15 * (1:3);\nclf\nfor k = 1:length(n)\n    t = linspace(-1, 1, n(k) + 1)';        % equally spaced nodes\n    p = polyinterp(t, f(t));\n    semilogy(x, abs(f(x) - p(x)));  hold on\nend\ntitle('Error for degrees 27, 42, 57')   \nxlabel('x'), ylabel('|f(x) - p(x)|')","visibility":"hide","key":"qKBtq0XpoW"},{"type":"output","id":"0Mdlo9gJ_4i4k7YI2DyG5","data":[{"output_type":"execute_result","execution_count":14,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"ce7433f475f83e4226a11c75123442cc","path":"/build/ce7433f475f83e4226a11c75123442cc.png"}}}],"visibility":"show","key":"AZEWCdgX96"}],"data":{"tags":[]},"visibility":"show","key":"jT4YO2x2hR"},{"type":"paragraph","position":{"start":{"line":273,"column":1},"end":{"line":273,"column":1}},"children":[{"type":"text","value":"The convergence in the middle can’t get any better than machine precision relative to the function values. So maintaining the growing gap between the center and the ends pushes the error curves upward exponentially fast at the ends, wrecking the convergence.","position":{"start":{"line":273,"column":1},"end":{"line":273,"column":1}},"key":"HDSIuPxBYK"}],"key":"uPzUA9ZCe8"}],"label":"demo-stability-runge-matlab","identifier":"demo-stability-runge-matlab","html_id":"demo-stability-runge-matlab","key":"IjiSxggLUe"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-stability-errcheb","label":"demo-stability-errcheb","kind":"proof:example","position":{"start":{"line":277,"column":1},"end":{"line":277,"column":24}},"children":[{"type":"text","value":"Example ","key":"ZxgpMGIQho"},{"type":"text","value":"9.3.4","key":"lawq0haAK8"}],"template":"Example %s","enumerator":"9.3.4","resolved":true,"html_id":"demo-stability-errcheb","remote":true,"url":"/stability-1","dataUrl":"/stability-1.json","key":"XetuqoZYB3"}],"key":"hjB3birTbL"},{"type":"paragraph","position":{"start":{"line":279,"column":1},"end":{"line":279,"column":1}},"children":[{"type":"text","value":"Now we look at the error indicator function ","position":{"start":{"line":279,"column":1},"end":{"line":279,"column":1}},"key":"UTveTCKKwh"},{"type":"text","value":"Φ","position":{"start":{"line":279,"column":1},"end":{"line":279,"column":1}},"key":"eZXLsNKgId"},{"type":"text","value":" for Chebyshev node sets.","position":{"start":{"line":279,"column":1},"end":{"line":279,"column":1}},"key":"szSVBe2FxF"}],"key":"NqqARD4VY3"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf\nx = linspace(-1, 1, 1601)';\nPhi = zeros(size(x));\nfor n = 10:10:50\n    theta = linspace(0, pi, n+1)';\n    t = -cos(theta);                    \n    for k = 1:length(x)\n        Phi(k) = prod(x(k) - t);\n    end\n    semilogy(x, abs(Phi));  hold on\nend\naxis tight, title('Effect of Chebyshev nodes')    \nxlabel('x'), ylabel('|\\Phi(x)|')   \nylim([1e-18, 1e-2])","visibility":"hide","key":"hFX4xDnJz1"},{"type":"output","id":"WJlyBJIAoZgqrCh86Jt4j","data":[{"output_type":"execute_result","execution_count":15,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"d92a8965902da2983bcdadfb5606e4ef","path":"/build/d92a8965902da2983bcdadfb5606e4ef.png"}}}],"visibility":"show","key":"NEqWpormuI"}],"data":{"tags":[]},"visibility":"show","key":"dx0e86BtFX"},{"type":"paragraph","position":{"start":{"line":299,"column":1},"end":{"line":299,"column":1}},"children":[{"type":"text","value":"In contrast to the equispaced case, ","position":{"start":{"line":299,"column":1},"end":{"line":299,"column":1}},"key":"B6fKj97TjT"},{"type":"inlineMath","value":"|\\Phi|","position":{"start":{"line":299,"column":1},"end":{"line":299,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">∣</mi><mi mathvariant=\"normal\">Φ</mi><mi mathvariant=\"normal\">∣</mi></mrow><annotation encoding=\"application/x-tex\">|\\Phi|</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">∣Φ∣</span></span></span></span>","key":"Vd1ryGgxb3"},{"type":"text","value":" decreases exponentially with ","position":{"start":{"line":299,"column":1},"end":{"line":299,"column":1}},"key":"iknsf6quqD"},{"type":"inlineMath","value":"n","position":{"start":{"line":299,"column":1},"end":{"line":299,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"TxexZVtbUl"},{"type":"text","value":" almost uniformly across the interval.","position":{"start":{"line":299,"column":1},"end":{"line":299,"column":1}},"key":"c1TtRZH8M2"}],"key":"RUE4UPtv8U"}],"label":"demo-stability-errcheb-matlab","identifier":"demo-stability-errcheb-matlab","html_id":"demo-stability-errcheb-matlab","key":"Rghexw44ox"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-stability-rungefix","label":"demo-stability-rungefix","kind":"proof:example","position":{"start":{"line":303,"column":1},"end":{"line":303,"column":25}},"children":[{"type":"text","value":"Example ","key":"RWCzlpv0Rr"},{"type":"text","value":"9.3.5","key":"fXCK6UwTw1"}],"template":"Example %s","enumerator":"9.3.5","resolved":true,"html_id":"demo-stability-rungefix","remote":true,"url":"/stability-1","dataUrl":"/stability-1.json","key":"H4jArnKvUE"}],"key":"NGfAulXvpc"},{"type":"paragraph","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":1}},"children":[{"type":"text","value":"Here again is the function from ","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":1}},"key":"AV5UHBdjjo"},{"type":"crossReference","kind":"proof:example","identifier":"demo-stability-runge","label":"demo-stability-runge","children":[{"type":"text","value":"Demo ","key":"uhAbhggKuD"},{"type":"text","value":"9.3.3","key":"nv0Gv1KUtt"}],"template":"Example %s","enumerator":"9.3.3","resolved":true,"html_id":"demo-stability-runge","remote":true,"url":"/stability-1","dataUrl":"/stability-1.json","key":"AYVFFW2JDJ"},{"type":"text","value":" that provoked the Runge phenomenon when using equispaced nodes.","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":1}},"key":"G1AtwfbPco"}],"key":"CiUykj1MgO"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"f = @(x) 1 ./ (x.^2 + 16);","key":"EEnQhKoh45"},{"type":"output","id":"Tvgv6zcG6rIFxzx2e4b32","data":[],"key":"ynLhAIXnJe"}],"data":{},"key":"K1hS6w9iPC"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf\nx = linspace(-1, 1, 1601)';\nn = [4, 10, 16, 40];\nfor k = 1:length(n) \n    theta = linspace(0, pi, n(k) + 1)';\n    t = -cos(theta);\n    p = polyinterp(t, f(t));\n    semilogy( x, abs(f(x) - p(x)) );  hold on\nend\ntitle('Error for degrees 4, 10, 16, 40')   \nxlabel('x'), ylabel('|f(x)-p(x)|')","visibility":"hide","key":"ZlD59rr9oC"},{"type":"output","id":"eUevj97FSxXBtlgGCrnaJ","data":[{"output_type":"execute_result","execution_count":17,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"27f80fba5465904e7faae6e53cf0e84f","path":"/build/27f80fba5465904e7faae6e53cf0e84f.png"}}}],"visibility":"show","key":"JvrmpS8108"}],"data":{"tags":[]},"visibility":"show","key":"Zohv9kq2NC"},{"type":"paragraph","position":{"start":{"line":327,"column":1},"end":{"line":327,"column":1}},"children":[{"type":"text","value":"By degree 16 the error is uniformly within machine epsilon, and, importantly, it stays there as ","position":{"start":{"line":327,"column":1},"end":{"line":327,"column":1}},"key":"BIeY3U6gnS"},{"type":"inlineMath","value":"n","position":{"start":{"line":327,"column":1},"end":{"line":327,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"gON8SO6jME"},{"type":"text","value":" increases. Note that as predicted by the error indicator function, the error is uniform over the interval at each value of ","position":{"start":{"line":327,"column":1},"end":{"line":327,"column":1}},"key":"Cw81kFk2Rb"},{"type":"inlineMath","value":"n","position":{"start":{"line":327,"column":1},"end":{"line":327,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"j4A4MexkX4"},{"type":"text","value":".","position":{"start":{"line":327,"column":1},"end":{"line":327,"column":1}},"key":"DRUGYhmVnD"}],"key":"MIdANK4vpr"}],"label":"demo-stability-rungefix-matlab","identifier":"demo-stability-rungefix-matlab","html_id":"demo-stability-rungefix-matlab","key":"o3edeQnhcf"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-stability-spectral","label":"demo-stability-spectral","kind":"proof:example","position":{"start":{"line":331,"column":1},"end":{"line":331,"column":25}},"children":[{"type":"text","value":"Example ","key":"ZzXpDb0q1x"},{"type":"text","value":"9.3.6","key":"pebcF10m1w"}],"template":"Example %s","enumerator":"9.3.6","resolved":true,"html_id":"demo-stability-spectral","remote":true,"url":"/stability-1","dataUrl":"/stability-1.json","key":"MKh2TlFcZu"}],"key":"e1Gafhh9mq"},{"type":"paragraph","position":{"start":{"line":333,"column":1},"end":{"line":333,"column":1}},"children":[{"type":"text","value":"On the left, we use a log-log scale, which makes second-order algebraic convergence ","position":{"start":{"line":333,"column":1},"end":{"line":333,"column":1}},"key":"FQMURAg02u"},{"type":"inlineMath","value":"O(n^{-4})","position":{"start":{"line":333,"column":1},"end":{"line":333,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><msup><mi>n</mi><mrow><mo>−</mo><mn>4</mn></mrow></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(n^{-4})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">n</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">4</span></span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"lbW67rYjAS"},{"type":"text","value":" a straight line. On the right, we use a log-linear scale, which makes spectral convergence ","position":{"start":{"line":333,"column":1},"end":{"line":333,"column":1}},"key":"eR5JWgCAmX"},{"type":"inlineMath","value":"O(K^{-n})","position":{"start":{"line":333,"column":1},"end":{"line":333,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><msup><mi>K</mi><mrow><mo>−</mo><mi>n</mi></mrow></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(K^{-n})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0213em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7713em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mathnormal mtight\">n</span></span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"Pn67SFU36A"},{"type":"text","value":" linear.","position":{"start":{"line":333,"column":1},"end":{"line":333,"column":1}},"key":"ODMtY619HL"}],"key":"zze7PcHqsy"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"n = (20:20:400)';\nalgebraic = 100 ./ n.^4;\nspectral = 10 * 0.85.^n;\nclf, subplot(2, 1, 1)\nloglog(n, algebraic, 'o-', displayname=\"algebraic\")\nhold on;  loglog(n, spectral, 'o-', displayname=\"spectral\")\nxlabel('n'),  ylabel('error')   \ntitle('log–log')   \naxis tight,  ylim([1e-16, 1]);  legend(location=\"southwest\")   \n\nsubplot(2, 1, 2)\nsemilogy(n, algebraic, 'o-', displayname=\"algebraic\")\nhold on;  semilogy(n, spectral, 'o-', displayname=\"spectral\")\nxlabel('n'), ylabel('error'),  ylim([1e-16, 1])   \ntitle('log–linear')   \naxis tight,  ylim([1e-16, 1]);  legend(location=\"southwest\")","visibility":"hide","key":"ZGOMZaYo6o"},{"type":"output","id":"xgkv3JT-WKF6Pmc9gWUD-","data":[{"output_type":"execute_result","execution_count":18,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"5b7f2b8812651c0c905f15ae6267b9c9","path":"/build/5b7f2b8812651c0c905f15ae6267b9c9.png"}}}],"visibility":"show","key":"cxOolZfoU9"}],"data":{"tags":[]},"visibility":"show","key":"xBwsiTaJB4"}],"label":"demo-stability-spectral-matlab","identifier":"demo-stability-spectral-matlab","html_id":"demo-stability-spectral-matlab","key":"NHIcmlvJY7"},{"type":"heading","depth":3,"position":{"start":{"line":356,"column":1},"end":{"line":356,"column":1}},"children":[{"type":"text","value":"9.4 ","position":{"start":{"line":356,"column":1},"end":{"line":356,"column":1}},"key":"tTges7lOS1"},{"type":"link","identifier":"section-globalapprox-orthogonal","label":"section-globalapprox-orthogonal","kind":"narrative","position":{"start":{"line":356,"column":5},"end":{"line":356,"column":37}},"url":"/orthogonal","internal":true,"dataUrl":"/orthogonal.json","children":[{"type":"text","value":"Orthogonal polynomials","key":"NbLtI9OLQq"}],"key":"hDk9xW2xeF"}],"identifier":"id-9-4","label":"9.4 ","html_id":"id-9-4","implicit":true,"key":"az5OdAeGbv"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-orthogonal-approx","label":"demo-orthogonal-approx","kind":"proof:example","position":{"start":{"line":359,"column":1},"end":{"line":359,"column":24}},"children":[{"type":"text","value":"Example ","key":"edkRFNRsua"},{"type":"text","value":"9.4.1","key":"rB3XwkTUBx"}],"template":"Example %s","enumerator":"9.4.1","resolved":true,"html_id":"demo-orthogonal-approx","remote":true,"url":"/orthogonal","dataUrl":"/orthogonal.json","key":"kNjwzmhOPT"}],"key":"FCm5bW2wkK"},{"type":"paragraph","position":{"start":{"line":361,"column":1},"end":{"line":361,"column":1}},"children":[{"type":"text","value":"Let’s approximate ","position":{"start":{"line":361,"column":1},"end":{"line":361,"column":1}},"key":"Aj15splwWA"},{"type":"inlineMath","value":"e^x","position":{"start":{"line":361,"column":1},"end":{"line":361,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>e</mi><mi>x</mi></msup></mrow><annotation encoding=\"application/x-tex\">e^x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6644em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span></span></span></span></span></span></span></span>","key":"uHClkBegZX"},{"type":"text","value":" over the interval ","position":{"start":{"line":361,"column":1},"end":{"line":361,"column":1}},"key":"w3eMlw07mF"},{"type":"inlineMath","value":"[−1,1]","position":{"start":{"line":361,"column":1},"end":{"line":361,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mo>−</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[−1,1]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">−</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]</span></span></span></span>","key":"JncuPe65ZO"},{"type":"text","value":". We can sample it at, say, 15 points, and find the best-fitting straight line to that data.","position":{"start":{"line":361,"column":1},"end":{"line":361,"column":1}},"key":"TtGisMUoyU"}],"key":"bRj3C8xkQO"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf;  fplot(@exp, [-1, 1], displayname=\"function\")\nt = linspace(-1, 1, 15)';\ny = exp(t);\nV = [t.^0, t];\nc = V \\ y;\np = @(t) c(1) + c(2)*t;\n\nhold on,  fplot(p, [-1, 1], displayname=\"LS fit at 15 points\")\ntitle('Least-squares fit to samples of exp(x)')    \nxlabel('x'),  ylabel('f(x)')    \nlegend(location=\"northwest\")","key":"BdFu9PwUf0"},{"type":"output","id":"BDabk76ByJmNVEwa2UNqB","data":[{"output_type":"execute_result","execution_count":19,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"6d81301ab9a8db186e68fad0020a3488","path":"/build/6d81301ab9a8db186e68fad0020a3488.png"}}}],"key":"AI8kQjR1gF"}],"data":{},"key":"nYSNXSDy1f"},{"type":"paragraph","position":{"start":{"line":377,"column":1},"end":{"line":377,"column":1}},"children":[{"type":"text","value":"There’s nothing special about 15 points. Choosing more doesn’t change the result much.","position":{"start":{"line":377,"column":1},"end":{"line":377,"column":1}},"key":"wvmcofnmem"}],"key":"CKNKzVF8pq"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"t = linspace(-1, 1, 150)';\ny = exp(t);\nV = [t.^0, t];\nc = V \\ y;\np = @(t) c(1) + c(2)*t;\nfplot(p, [-1, 1], displayname=\"LS fit at 150 points\")","key":"xijj1zM5UV"},{"type":"output","id":"--Z8qARxomzB6WGAs93wu","data":[{"output_type":"execute_result","execution_count":20,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"fd7d0ff4e549d71fd5dcd179f1d7fc34","path":"/build/fd7d0ff4e549d71fd5dcd179f1d7fc34.png"}}}],"key":"s0seueaEdu"}],"data":{},"key":"P7J1T7vpwb"},{"type":"paragraph","position":{"start":{"line":388,"column":1},"end":{"line":388,"column":1}},"children":[{"type":"text","value":"This situation is unlike interpolation, where the degree of the interpolant increases with the number of nodes. Here, the linear fit is apparently approaching a limit that we may think of as a continuous least-squares fit.","position":{"start":{"line":388,"column":1},"end":{"line":388,"column":1}},"key":"Rdlbfoiq0z"}],"key":"ODXaXfedsG"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"n = (40:60:400)';\nslope = zeros(size(n));\nintercept = zeros(size(n));\n\nfor k = 1:length(n)\n    t = linspace(-1, 1, n(k))';\n    V = [t.^0, t];\n    c = V \\ exp(t);\n    intercept(k) = c(1);\n    slope(k) = c(2);\nend\ndisp(table(n, intercept, slope))","key":"sKh287U9tZ"},{"type":"output","id":"V4GTjqXoI9ttLtnZYDXVb","data":[{"output_type":"stream","name":"stdout","text":"     n     intercept    slope \n"},{"output_type":"stream","name":"stdout","text":"    ___    _________    ______\n\n"},{"output_type":"stream","name":"stdout","text":"     40     1.1846      1.1091\n"},{"output_type":"stream","name":"stdout","text":"    100     1.1789      1.1058\n"},{"output_type":"stream","name":"stdout","text":"    160     1.1775       1.105\n"},{"output_type":"stream","name":"stdout","text":"    220     1.1769      1.1046\n"},{"output_type":"stream","name":"stdout","text":"    280     1.1765      1.1044\n"},{"output_type":"stream","name":"stdout","text":"    340     1.1763      1.1043\n"},{"output_type":"stream","name":"stdout","text":"    400     1.1761      1.1042\n"},{"output_type":"stream","name":"stdout","text":"\n"}],"key":"YIIhYqpGqn"}],"data":{},"key":"OYXNN1rJmL"}],"label":"demo-orthogonal-approx-matlab","identifier":"demo-orthogonal-approx-matlab","html_id":"demo-orthogonal-approx-matlab","key":"tV88QLpEll"},{"type":"heading","depth":3,"position":{"start":{"line":406,"column":1},"end":{"line":406,"column":1}},"children":[{"type":"text","value":"9.5 ","position":{"start":{"line":406,"column":1},"end":{"line":406,"column":1}},"key":"Qd0aeBS3ax"},{"type":"link","identifier":"section-globalapprox-trig","label":"section-globalapprox-trig","kind":"narrative","position":{"start":{"line":406,"column":5},"end":{"line":406,"column":31}},"url":"/trig","internal":true,"dataUrl":"/trig.json","children":[{"type":"text","value":"Trigonometric interpolation","key":"wPQomupXh0"}],"key":"BwzQ4y1iEE"}],"identifier":"id-9-5","label":"9.5 ","html_id":"id-9-5","implicit":true,"key":"wbPmOTGmew"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-trig-interp","label":"demo-trig-interp","kind":"proof:example","position":{"start":{"line":409,"column":1},"end":{"line":409,"column":18}},"children":[{"type":"text","value":"Example ","key":"iOmMBpUdyU"},{"type":"text","value":"9.5.1","key":"AOxzzDEYk0"}],"template":"Example %s","enumerator":"9.5.1","resolved":true,"html_id":"demo-trig-interp","remote":true,"url":"/trig","dataUrl":"/trig.json","key":"Ded5mmHADl"}],"key":"Tifwqc1gDH"},{"type":"paragraph","position":{"start":{"line":412,"column":1},"end":{"line":412,"column":1}},"children":[{"type":"text","value":"We will get a cardinal function without using an explicit formula, just by passing data that is 1 at one node and 0 at the others.","position":{"start":{"line":412,"column":1},"end":{"line":412,"column":1}},"key":"E2nD9ypBb2"}],"key":"QgGyxrrOWw"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"N = 7;  n = (N-1) / 2;\nt = 2 * (-n:n)' / N;\ny = zeros(N, 1);  y(n+1) = 1;\nclf,  scatter(t, y, 'k'),  hold on\n\np = triginterp(t, y);\nfplot(p, [-1, 1])\nxlabel('x'),  ylabel('p(x)')   \ntitle('Trig cardinal function')","key":"VlNzt6Idci"},{"type":"output","id":"-wZdfDO6_3f0z-rWtbJeD","data":[{"output_type":"execute_result","execution_count":22,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"c59d3a2875e0998dbff20c78f64f560e","path":"/build/c59d3a2875e0998dbff20c78f64f560e.png"}}}],"key":"xiqX4lKTVb"}],"data":{},"key":"NoV0ZOMj4I"},{"type":"paragraph","position":{"start":{"line":426,"column":1},"end":{"line":426,"column":1}},"children":[{"type":"text","value":"Here is a 2-periodic function and one of its interpolants.","position":{"start":{"line":426,"column":1},"end":{"line":426,"column":1}},"key":"gS8qlGhrKr"}],"key":"BbLi2VBGYP"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf\nf = @(x) exp( sin(pi*x) - 2 * cos(pi*x) );\nfplot(f, [-1, 1], displayname=\"periodic function\"),  hold on\nfplot(triginterp(t, f(t)), [-1, 1], displayname=\"trig interpolant\")\ny = f(t);  scatter(t, f(t), 'k')\nxlabel('x'),  ylabel('f(x)')   \ntitle('Trig interpolation');  legend()","key":"ljznmXjRzW"},{"type":"output","id":"wsw4wqaT3dzRrmlqNxuyZ","data":[{"output_type":"execute_result","execution_count":23,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"7ec3b455dccd9cee82e8fc8e1556d85a","path":"/build/7ec3b455dccd9cee82e8fc8e1556d85a.png"}}}],"key":"zP4Bhcdv8O"}],"data":{},"key":"j1f3iVlV8O"},{"type":"paragraph","position":{"start":{"line":438,"column":1},"end":{"line":438,"column":1}},"children":[{"type":"text","value":"The convergence of the interpolant is spectral. We let ","position":{"start":{"line":438,"column":1},"end":{"line":438,"column":1}},"key":"xanXaSWQbL"},{"type":"inlineMath","value":"N","position":{"start":{"line":438,"column":1},"end":{"line":438,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span>","key":"JIkHL2EBTl"},{"type":"text","value":" go needlessly large here in order to demonstrate that unlike polynomials, trigonometric interpolation is stable on equally spaced nodes. Note that when ","position":{"start":{"line":438,"column":1},"end":{"line":438,"column":1}},"key":"Nn7MzkC1yP"},{"type":"inlineMath","value":"N","position":{"start":{"line":438,"column":1},"end":{"line":438,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span>","key":"bLceAANxs7"},{"type":"text","value":" is even, the value of ","position":{"start":{"line":438,"column":1},"end":{"line":438,"column":1}},"key":"sTgxtqYeR6"},{"type":"inlineMath","value":"n","position":{"start":{"line":438,"column":1},"end":{"line":438,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"hFl1oMHOeJ"},{"type":"text","value":" is not an integer but works fine for defining the nodes.","position":{"start":{"line":438,"column":1},"end":{"line":438,"column":1}},"key":"mLIk19sfUS"}],"key":"hbqb0Dwpam"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"N = 2:2:60;\nerr = zeros(size(N));\nx = linspace(-1, 1, 1601)';  % for measuring error\nfor k = 1:length(N)\n    n = (N(k) - 1) / 2;\n    t = 2 * (-n:n)' / N(k);\n    p = triginterp(t, f(t));\n    err(k) = norm(f(x) - p(x), Inf);\nend\nclf,  semilogy(N, err, 'o-')\naxis tight, title('Convergence of trig interpolation')   \nxlabel('N'),  ylabel('max error')","visibility":"hide","key":"DoRie7qUar"},{"type":"output","id":"oOgBEz7kBMelVectQlMbx","data":[{"output_type":"execute_result","execution_count":24,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"9f1b2d9f18b3d803e554e950568c493b","path":"/build/9f1b2d9f18b3d803e554e950568c493b.png"}}}],"visibility":"show","key":"rHSznJ9ixB"}],"data":{"tags":[]},"visibility":"show","key":"zI0ZRbRM3Z"}],"label":"demo-trig-interp-matlab","identifier":"demo-trig-interp-matlab","html_id":"demo-trig-interp-matlab","key":"U57Xm0vazF"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-trig-fft","label":"demo-trig-fft","kind":"proof:example","position":{"start":{"line":458,"column":1},"end":{"line":458,"column":15}},"children":[{"type":"text","value":"Example ","key":"qqR7NSCGks"},{"type":"text","value":"9.5.2","key":"PpCToTq01h"}],"template":"Example %s","enumerator":"9.5.2","resolved":true,"html_id":"demo-trig-fft","remote":true,"url":"/trig","dataUrl":"/trig.json","key":"Zcgo2zeAFc"}],"key":"ibi8LVvHy3"},{"type":"paragraph","position":{"start":{"line":460,"column":1},"end":{"line":460,"column":1}},"children":[{"type":"text","value":"This function has frequency content at ","position":{"start":{"line":460,"column":1},"end":{"line":460,"column":1}},"key":"qI91f3NFTQ"},{"type":"inlineMath","value":"2\\pi","position":{"start":{"line":460,"column":1},"end":{"line":460,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>2</mn><mi>π</mi></mrow><annotation encoding=\"application/x-tex\">2\\pi</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span></span></span></span>","key":"T5UKHi5Rvg"},{"type":"text","value":", ","position":{"start":{"line":460,"column":1},"end":{"line":460,"column":1}},"key":"auDaCsKRMh"},{"type":"inlineMath","value":"-2\\pi","position":{"start":{"line":460,"column":1},"end":{"line":460,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>−</mo><mn>2</mn><mi>π</mi></mrow><annotation encoding=\"application/x-tex\">-2\\pi</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">−</span><span class=\"mord\">2</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span></span></span></span>","key":"CbY2YioYqA"},{"type":"text","value":", and ","position":{"start":{"line":460,"column":1},"end":{"line":460,"column":1}},"key":"gmIiEgJ3nu"},{"type":"text","value":"π","position":{"start":{"line":460,"column":1},"end":{"line":460,"column":1}},"key":"T3KpsJve6U"},{"type":"text","value":".","position":{"start":{"line":460,"column":1},"end":{"line":460,"column":1}},"key":"XfUTx1cMjw"}],"key":"ggcjkqYmLx"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"f = @(x) 3 * cos(2*pi * x) - exp(1i*pi * x);","key":"Uu0x93AgT3"},{"type":"output","id":"-Fokbn2H2ZzwFUS8JBwkQ","data":[],"key":"ZExS64gMG7"}],"data":{},"key":"iEA0EDdG5H"},{"type":"paragraph","position":{"start":{"line":466,"column":1},"end":{"line":466,"column":1}},"children":[{"type":"text","value":"To use ","position":{"start":{"line":466,"column":1},"end":{"line":466,"column":1}},"key":"pvR5pHAQht"},{"type":"inlineCode","value":"fft","position":{"start":{"line":466,"column":1},"end":{"line":466,"column":1}},"key":"ix0SUS8wpp"},{"type":"text","value":", we set up nodes in the interval ","position":{"start":{"line":466,"column":1},"end":{"line":466,"column":1}},"key":"nnYcDO3EQ0"},{"type":"inlineMath","value":"[0,2)","position":{"start":{"line":466,"column":1},"end":{"line":466,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mn>0</mn><mo separator=\"true\">,</mo><mn>2</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">[0,2)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">2</span><span class=\"mclose\">)</span></span></span></span>","key":"Ykpf9eX9WR"},{"type":"text","value":".","position":{"start":{"line":466,"column":1},"end":{"line":466,"column":1}},"key":"mv9NpQWVnm"}],"key":"TB9BmRDHkR"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"n = 4;\nN = 2*n + 1;\nt = 2 * (0:N-1)' / N;      % nodes in $[0,2)$\ny = f(t);","key":"cwMNn0bLeH"},{"type":"output","id":"rXdY57ZnbnsPf_ZmwDtlW","data":[],"key":"ubnoMk9AWs"}],"data":{},"key":"IPEuQrekEV"},{"type":"paragraph","position":{"start":{"line":475,"column":1},"end":{"line":475,"column":1}},"children":[{"type":"text","value":"We perform Fourier analysis using ","position":{"start":{"line":475,"column":1},"end":{"line":475,"column":1}},"key":"kiwikHGxBE"},{"type":"inlineCode","value":"fft","position":{"start":{"line":475,"column":1},"end":{"line":475,"column":1}},"key":"GMH6E5IYZ3"},{"type":"text","value":" and then examine the resulting coefficients.","position":{"start":{"line":475,"column":1},"end":{"line":475,"column":1}},"key":"vU5ebAWXDY"}],"key":"YatXmDgiJM"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"c = fft(y) / N;\nfreq = [0:n, -n:-1]';\nformat short\ndisp(table(freq, c, variableNames=[\"k\", \"coefficient\"]))","key":"CiMe87LlPz"},{"type":"output","id":"ILzCVf2beuDATL8TNi_MF","data":[{"output_type":"stream","name":"stdout","text":"    k           coefficient      \n"},{"output_type":"stream","name":"stdout","text":"    __    _______________________\n\n"},{"output_type":"stream","name":"stdout","text":"     0    -7.4015e-17+0i         \n"},{"output_type":"stream","name":"stdout","text":"     1             -1+3.1961e-16i\n"},{"output_type":"stream","name":"stdout","text":"     2            1.5-6.7735e-16i\n"},{"output_type":"stream","name":"stdout","text":"     3     2.0068e-16-3.7007e-17i\n"},{"output_type":"stream","name":"stdout","text":"     4     9.8686e-17+2.1124e-16i\n"},{"output_type":"stream","name":"stdout","text":"    -4     9.6148e-17-2.5176e-16i\n"},{"output_type":"stream","name":"stdout","text":"    -3     2.4341e-16-3.7007e-17i\n"},{"output_type":"stream","name":"stdout","text":"    -2            1.5+7.2403e-16i\n"},{"output_type":"stream","name":"stdout","text":"    -1    -9.6148e-17-2.5176e-16i\n"},{"output_type":"stream","name":"stdout","text":"\n"}],"key":"YoWbaAAiJp"}],"data":{},"key":"ZsvNyTwlJf"},{"type":"paragraph","position":{"start":{"line":484,"column":1},"end":{"line":484,"column":1}},"children":[{"type":"text","value":"Note that ","position":{"start":{"line":484,"column":1},"end":{"line":484,"column":1}},"key":"xWzJBld0U7"},{"type":"inlineMath","value":"1.5 e^{2i\\pi x}+1.5 e^{-2i\\pi x} = 3 \\cos(2\\pi x)","position":{"start":{"line":484,"column":1},"end":{"line":484,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1.5</mn><msup><mi>e</mi><mrow><mn>2</mn><mi>i</mi><mi>π</mi><mi>x</mi></mrow></msup><mo>+</mo><mn>1.5</mn><msup><mi>e</mi><mrow><mo>−</mo><mn>2</mn><mi>i</mi><mi>π</mi><mi>x</mi></mrow></msup><mo>=</mo><mn>3</mn><mi>cos</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mn>2</mn><mi>π</mi><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">1.5 e^{2i\\pi x}+1.5 e^{-2i\\pi x} = 3 \\cos(2\\pi x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.908em;vertical-align:-0.0833em;\"></span><span class=\"mord\">1.5</span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8247em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">iπ</span><span class=\"mord mathnormal mtight\">x</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8247em;\"></span><span class=\"mord\">1.5</span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8247em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">2</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">iπ</span><span class=\"mord mathnormal mtight\">x</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">3</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">cos</span><span class=\"mopen\">(</span><span class=\"mord\">2</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span>","key":"EJu9q6NkbZ"},{"type":"text","value":", so this result is sensible.","position":{"start":{"line":484,"column":1},"end":{"line":484,"column":1}},"key":"qtuTYaoZhf"}],"key":"TLUI0p0Kt2"},{"type":"paragraph","position":{"start":{"line":486,"column":1},"end":{"line":486,"column":1}},"children":[{"type":"text","value":"Fourier’s greatest contribution to mathematics was to point out that ","position":{"start":{"line":486,"column":1},"end":{"line":486,"column":1}},"key":"rQbxJ2Z5qS"},{"type":"emphasis","position":{"start":{"line":486,"column":1},"end":{"line":486,"column":1}},"children":[{"type":"text","value":"every","position":{"start":{"line":486,"column":1},"end":{"line":486,"column":1}},"key":"FV9vqLN0eM"}],"key":"hKqQCP2IFG"},{"type":"text","value":" periodic function is just a combination of frequencies—infinitely many of them in general, but truncated for computational use. Here we look at the magnitudes of the coefficients for ","position":{"start":{"line":486,"column":1},"end":{"line":486,"column":1}},"key":"DLwTHHgE2l"},{"type":"inlineMath","value":"f(x) = \\exp( \\sin(\\pi x) )","position":{"start":{"line":486,"column":1},"end":{"line":486,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>exp</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mi>sin</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mi>π</mi><mi>x</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">f(x) = \\exp( \\sin(\\pi x) )</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop\">exp</span><span class=\"mopen\">(</span><span class=\"mop\">sin</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">))</span></span></span></span>","key":"iQnrUyweCw"},{"type":"text","value":".","position":{"start":{"line":486,"column":1},"end":{"line":486,"column":1}},"key":"mEjkIj3SFJ"}],"key":"EUMqmyc8eS"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"f = @(x) exp( sin(pi*x) );    % content at all frequencies\nn = 9;  N = 2*n + 1;\nt = 2 * (0:N-1)' / N;         % nodes in $[0,2)$\ny = f(t);\nc = fft(y) / N;\nfreq = [0:n, -n:-1]';\n\nclf\nsemilogy(freq, abs(c), 'o')\nxlabel('k'),  ylabel('|c_k|')   \ntitle('Fourier coefficients')","visibility":"hide","key":"LWbZogk2Am"},{"type":"output","id":"49smOHkGXK23pfeOkRHbi","data":[{"output_type":"execute_result","execution_count":28,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"d59fe4b246f878514c11c5ddb581a8ba","path":"/build/d59fe4b246f878514c11c5ddb581a8ba.png"}}}],"visibility":"show","key":"f0EFyW9lGs"}],"data":{"tags":[]},"visibility":"show","key":"hpNnJqyNVG"},{"type":"paragraph","position":{"start":{"line":503,"column":1},"end":{"line":503,"column":1}},"children":[{"type":"text","value":"The Fourier coefficients of smooth functions decay exponentially in magnitude as a function of the frequency. This decay rate is determines the convergence of the interpolation error.","position":{"start":{"line":503,"column":1},"end":{"line":503,"column":1}},"key":"VrUIkqqXyv"}],"key":"fRFwxtI5oz"}],"label":"demo-trig-fft-matlab","identifier":"demo-trig-fft-matlab","html_id":"demo-trig-fft-matlab","key":"NqvAXMhrof"},{"type":"heading","depth":3,"position":{"start":{"line":506,"column":1},"end":{"line":506,"column":1}},"children":[{"type":"text","value":"9.6 ","position":{"start":{"line":506,"column":1},"end":{"line":506,"column":1}},"key":"CmzVd7xXas"},{"type":"link","identifier":"section-globalapprox-integration","label":"section-globalapprox-integration","kind":"narrative","position":{"start":{"line":506,"column":5},"end":{"line":506,"column":38}},"url":"/spectral-integration","internal":true,"dataUrl":"/spectral-integration.json","children":[{"type":"text","value":"Spectrally accurate integration","key":"nSuyjcb6g7"}],"key":"qKDZBfKIkL"}],"identifier":"id-9-6","label":"9.6 ","html_id":"id-9-6","implicit":true,"key":"TNir9NU9tJ"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-integration-ellipse","label":"demo-integration-ellipse","kind":"proof:example","position":{"start":{"line":509,"column":1},"end":{"line":509,"column":26}},"children":[{"type":"text","value":"Example ","key":"AW7pSnAXy3"},{"type":"text","value":"9.6.1","key":"wdY8LQD8es"}],"template":"Example %s","enumerator":"9.6.1","resolved":true,"html_id":"demo-integration-ellipse","remote":true,"url":"/spectral-integration","dataUrl":"/spectral-integration.json","key":"LZcpCuGtjb"}],"key":"I2R5HDezg8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"f = @(t) pi * sqrt( cos(pi*t).^2 + sin(pi*t).^2 / 4 );\nN = (4:4:48)';\nperim = zeros(size(N));\nfor k = 1:length(N)\n    h = 2 / N(k);\n    t = h * (0:N(k)-1);\n    perim(k) = h * sum(f(t));\nend\nerr = abs(perim - perim(end));    % use last value as \"exact\"\nformat long\ndisp(table(N, perim, err, variableNames=[\"number of nodes\", \"perimeter\", \"error\"]))","key":"FPVFHvVV6z"},{"type":"output","id":"n1cY6jS2RpZ9T705HjlRQ","data":[{"output_type":"stream","name":"stdout","text":"    number of nodes       perimeter               error        \n"},{"output_type":"stream","name":"stdout","text":"    _______________    ________________    ____________________\n\n"},{"output_type":"stream","name":"stdout","text":"           4           4.71238898038469       0.131835129889071\n"},{"output_type":"stream","name":"stdout","text":"           8           4.83984155664137     0.00438255363239115\n"},{"output_type":"stream","name":"stdout","text":"          12           4.84397070699574     0.00025340327802148\n"},{"output_type":"stream","name":"stdout","text":"          16           4.84420619509697    1.79151767873975e-05\n"},{"output_type":"stream","name":"stdout","text":"          20           4.84422270295636    1.40731740483346e-06\n"},{"output_type":"stream","name":"stdout","text":"          24           4.84422399226142    1.18012335903472e-07\n"},{"output_type":"stream","name":"stdout","text":"          28           4.84422409992693    1.03468327239398e-08\n"},{"output_type":"stream","name":"stdout","text":"          32           4.84422410933683    9.36931421335885e-10\n"},{"output_type":"stream","name":"stdout","text":"          36           4.84422411018687    8.68887184424239e-11\n"},{"output_type":"stream","name":"stdout","text":"          40           4.84422411026561    8.14992517916835e-12\n"},{"output_type":"stream","name":"stdout","text":"          44           4.84422411027305    7.14095449438901e-13\n"},{"output_type":"stream","name":"stdout","text":"          48           4.84422411027376                       0\n"},{"output_type":"stream","name":"stdout","text":"\n"}],"key":"fkbWq6O5K1"}],"data":{},"key":"hdsG2Od1sR"},{"type":"paragraph","position":{"start":{"line":524,"column":1},"end":{"line":524,"column":1}},"children":[{"type":"text","value":"The approximations gain about one digit of accuracy for each constant increment of ","position":{"start":{"line":524,"column":1},"end":{"line":524,"column":1}},"key":"NVE9xnNgC2"},{"type":"inlineMath","value":"n","position":{"start":{"line":524,"column":1},"end":{"line":524,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"LAPTtDEVWe"},{"type":"text","value":", which is consistent with spectral convergence.","position":{"start":{"line":524,"column":1},"end":{"line":524,"column":1}},"key":"QmXi6M5VQL"}],"key":"lIczhnLecf"}],"label":"demo-integration-ellipse-matlab","identifier":"demo-integration-ellipse-matlab","html_id":"demo-integration-ellipse-matlab","key":"gJdCxbAQHn"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-integration-compare","label":"demo-integration-compare","kind":"proof:example","position":{"start":{"line":528,"column":1},"end":{"line":528,"column":26}},"children":[{"type":"text","value":"Example ","key":"UsFyexHF7s"},{"type":"text","value":"9.6.3","key":"JkDvYNxDrg"}],"template":"Example %s","enumerator":"9.6.3","resolved":true,"html_id":"demo-integration-compare","remote":true,"url":"/spectral-integration","dataUrl":"/spectral-integration.json","key":"SKF5qEJrMV"}],"key":"OQD6cGunBz"},{"type":"paragraph","position":{"start":{"line":530,"column":1},"end":{"line":530,"column":1}},"children":[{"type":"text","value":"First consider the integral","position":{"start":{"line":530,"column":1},"end":{"line":530,"column":1}},"key":"cbTyV8oYlQ"}],"key":"Iik04Np0by"},{"type":"math","value":"\\int_{-1}^1 \\frac{1}{1+4x^2} \\, dx = \\arctan(2).","position":{"start":{"line":532,"column":1},"end":{"line":534,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msubsup><mo>∫</mo><mrow><mo>−</mo><mn>1</mn></mrow><mn>1</mn></msubsup><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><mn>4</mn><msup><mi>x</mi><mn>2</mn></msup></mrow></mfrac><mtext> </mtext><mi>d</mi><mi>x</mi><mo>=</mo><mi>arctan</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mn>2</mn><mo stretchy=\"false\">)</mo><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">\\int_{-1}^1 \\frac{1}{1+4x^2} \\, dx = \\arctan(2).</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.5343em;vertical-align:-0.9703em;\"></span><span class=\"mop\"><span class=\"mop op-symbol large-op\" style=\"margin-right:0.44445em;position:relative;top:-0.0011em;\">∫</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.564em;\"><span style=\"top:-1.7881em;margin-left:-0.4445em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.8129em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9703em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">4</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7401em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7693em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop\">arctan</span><span class=\"mopen\">(</span><span class=\"mord\">2</span><span class=\"mclose\">)</span><span class=\"mord\">.</span></span></span></span></span>","enumerator":"1","key":"xtbOZhtdln"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"f = @(x) 1 ./ (1 + 4*x.^2);\nexact = atan(2);","key":"yBYP8USO5Y"},{"type":"output","id":"VYL4-VBEdR8ySj5cLD_CD","data":[],"key":"UAuMXKH9sT"}],"data":{},"key":"oNaCh7sjVO"},{"type":"paragraph","position":{"start":{"line":541,"column":1},"end":{"line":541,"column":1}},"children":[{"type":"text","value":"We compare the two spectral integration methods for a range of ","position":{"start":{"line":541,"column":1},"end":{"line":541,"column":1}},"key":"yt564Xt7P3"},{"type":"inlineMath","value":"n","position":{"start":{"line":541,"column":1},"end":{"line":541,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"x09pbVHpnr"},{"type":"text","value":" values.","position":{"start":{"line":541,"column":1},"end":{"line":541,"column":1}},"key":"Tgjp13iNfI"}],"key":"IpQbATWV5c"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"n = (8:4:96)';\nerrCC = zeros(size(n));\nerrGL = zeros(size(n));\nfor k = 1:length(n)\n  errCC(k) = exact - ccint(f, n(k));\n  errGL(k) = exact - glint(f, n(k));\nend\nclf,  semilogy(n, abs([errCC errGL]), 'o-')\nxlabel('number of nodes'),  ylabel('error')\ntitle('Spectral integration')   \nlegend('Clenshaw–Curtis', 'Gauss–Legendre')","visibility":"hide","key":"iOSt7PoRIq"},{"type":"output","id":"HCVOcXCyoXPIeORjiGasw","data":[{"output_type":"execute_result","execution_count":31,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"bac17e0abae34d367759de09159dbd84","path":"/build/bac17e0abae34d367759de09159dbd84.png"}}}],"visibility":"show","key":"Xft081nF88"}],"data":{"tags":[]},"visibility":"show","key":"iODGlJLWlq"},{"type":"paragraph","position":{"start":{"line":558,"column":1},"end":{"line":558,"column":1}},"children":[{"type":"text","value":"(The missing points are where the error is exactly zero.) Gauss–Legendre does converge faster here, but at something less than twice the rate.","position":{"start":{"line":558,"column":1},"end":{"line":558,"column":1}},"key":"M1OW0X9Msw"}],"key":"gcmIbJX6xw"},{"type":"paragraph","position":{"start":{"line":560,"column":1},"end":{"line":560,"column":1}},"children":[{"type":"text","value":"Now we try a more sharply peaked integrand:","position":{"start":{"line":560,"column":1},"end":{"line":560,"column":1}},"key":"rtYn5LCeNB"}],"key":"Er6BINUXw1"},{"type":"math","value":"\\int_{-1}^1 \\frac{1}{1+16x^2} \\, dx = \\frac{1}{2}\\arctan(4).","position":{"start":{"line":562,"column":1},"end":{"line":562,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msubsup><mo>∫</mo><mrow><mo>−</mo><mn>1</mn></mrow><mn>1</mn></msubsup><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><mn>16</mn><msup><mi>x</mi><mn>2</mn></msup></mrow></mfrac><mtext> </mtext><mi>d</mi><mi>x</mi><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mi>arctan</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mn>4</mn><mo stretchy=\"false\">)</mo><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">\\int_{-1}^1 \\frac{1}{1+16x^2} \\, dx = \\frac{1}{2}\\arctan(4).</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.5343em;vertical-align:-0.9703em;\"></span><span class=\"mop\"><span class=\"mop op-symbol large-op\" style=\"margin-right:0.44445em;position:relative;top:-0.0011em;\">∫</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.564em;\"><span style=\"top:-1.7881em;margin-left:-0.4445em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.8129em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9703em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">16</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7401em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7693em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.0074em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">2</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">arctan</span><span class=\"mopen\">(</span><span class=\"mord\">4</span><span class=\"mclose\">)</span><span class=\"mord\">.</span></span></span></span></span>","enumerator":"2","key":"N5xfgYXJIi"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"f = @(x) 1 ./ (1 + 16*x.^2);\nexact = atan(4) / 2;","key":"jdprbE4ovE"},{"type":"output","id":"WNqjwvXFmjFjnxnMxdzIF","data":[],"key":"f0juxO1K9y"}],"data":{},"key":"fkOSoWpTIj"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"n = (8:4:96)';\nerrCC = zeros(size(n));\nerrGL = zeros(size(n));\nfor k = 1:length(n)\n  errCC(k) = exact - ccint(f, n(k));\n  errGL(k) = exact - glint(f, n(k));\nend\nclf,  semilogy(n, abs([errCC errGL]), 'o-')\nxlabel('number of nodes'),  ylabel('error')\ntitle('Spectral integration')   \nlegend('Clenshaw–Curtis', 'Gauss–Legendre')","visibility":"hide","key":"v9NObJm7u0"},{"type":"output","id":"lsNu7xdPg6MLRhYYJftKN","data":[{"output_type":"execute_result","execution_count":33,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"b4176556c70c8df9cde34129221c9ae5","path":"/build/b4176556c70c8df9cde34129221c9ae5.png"}}}],"visibility":"show","key":"SbxRZ0uEoJ"}],"data":{"tags":[]},"visibility":"show","key":"R2JLIDajSo"},{"type":"paragraph","position":{"start":{"line":584,"column":1},"end":{"line":584,"column":1}},"children":[{"type":"text","value":"The two are very close until about ","position":{"start":{"line":584,"column":1},"end":{"line":584,"column":1}},"key":"v1DXBJEJ9f"},{"type":"inlineMath","value":"n=40","position":{"start":{"line":584,"column":1},"end":{"line":584,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>=</mo><mn>40</mn></mrow><annotation encoding=\"application/x-tex\">n=40</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">40</span></span></span></span>","key":"m9vzxIeAh8"},{"type":"text","value":", when the Clenshaw–Curtis method slows down.","position":{"start":{"line":584,"column":1},"end":{"line":584,"column":1}},"key":"YhIzrMPW0A"}],"key":"fvIsR22iyV"},{"type":"paragraph","position":{"start":{"line":586,"column":1},"end":{"line":586,"column":1}},"children":[{"type":"text","value":"Now let’s compare the spectral performance to that of our earlier adaptive method in ","position":{"start":{"line":586,"column":1},"end":{"line":586,"column":1}},"key":"Mxar5DoaQ9"},{"type":"inlineCode","value":"intadapt","position":{"start":{"line":586,"column":1},"end":{"line":586,"column":1}},"key":"inhfudUlkq"},{"type":"text","value":". We will specify varying error tolerances and record the error as well as the total number of evaluations of ","position":{"start":{"line":586,"column":1},"end":{"line":586,"column":1}},"key":"UnCbXWGPiB"},{"type":"inlineMath","value":"f","position":{"start":{"line":586,"column":1},"end":{"line":586,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>","key":"DQEvNK8Psi"},{"type":"text","value":".","position":{"start":{"line":586,"column":1},"end":{"line":586,"column":1}},"key":"TuzM2taHre"}],"key":"XbNH2eO6uO"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"tol = 10 .^ (-2:-2:-14)';\nn = zeros(size(tol));  \nerrAdapt = zeros(size(tol));\nfor k = 1:length(n)\n  [Q, t] = intadapt(f, -1, 1, tol(k));\n  errAdapt(k) = exact - Q;\n  n(k) = length(t);\nend\nhold on;  semilogy(n, abs(errAdapt), 'o-')\nplot(n, n.^(-4), 'k--')        % 4th order error\nset(gca, 'xscale', 'log')     \nlegend('ccint', 'glint', 'intadapt', '4th order')  \ntitle(('Spectral vs 4th order'));","visibility":"hide","key":"X4oJwInDon"},{"type":"output","id":"IvId2HAuZGOYpMN0XVczf","data":[{"output_type":"execute_result","execution_count":34,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"ce0bc89c9874c1e24b83168824e5b5a3","path":"/build/ce0bc89c9874c1e24b83168824e5b5a3.png"}}}],"visibility":"show","key":"RP77gZompK"}],"data":{"tags":[]},"visibility":"show","key":"fErjnvNGcL"},{"type":"paragraph","position":{"start":{"line":605,"column":1},"end":{"line":605,"column":1}},"children":[{"type":"text","value":"At the core of ","position":{"start":{"line":605,"column":1},"end":{"line":605,"column":1}},"key":"aZvFvODD8j"},{"type":"inlineCode","value":"intadapt","position":{"start":{"line":605,"column":1},"end":{"line":605,"column":1}},"key":"wvqz8zNnXU"},{"type":"text","value":" is a fourth-order formula, and the results track that rate closely. For all but the most relaxed error tolerances, both spectral methods are far more efficient than the low-order counterpart. For other integrands, particularly those that vary nonuniformly across the interval, the adaptive method might be more competitive.","position":{"start":{"line":605,"column":1},"end":{"line":605,"column":1}},"key":"Auijnm1JVN"}],"key":"gPFWljcmxr"}],"label":"demo-integration-compare-matlab","identifier":"demo-integration-compare-matlab","html_id":"demo-integration-compare-matlab","key":"QPHaP6665m"},{"type":"heading","depth":3,"position":{"start":{"line":608,"column":1},"end":{"line":608,"column":1}},"children":[{"type":"text","value":"9.7 ","position":{"start":{"line":608,"column":1},"end":{"line":608,"column":1}},"key":"PlviSuNe5E"},{"type":"link","identifier":"section-globalapprox-improper","label":"section-globalapprox-improper","kind":"narrative","position":{"start":{"line":608,"column":5},"end":{"line":608,"column":35}},"url":"/improper","internal":true,"dataUrl":"/improper.json","children":[{"type":"text","value":"Improper integrals","key":"ZOiNgYAO2L"}],"key":"sBiuilZ9OA"}],"identifier":"id-9-7","label":"9.7 ","html_id":"id-9-7","implicit":true,"key":"viQAZI9TK0"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-improper-decay","label":"demo-improper-decay","kind":"proof:example","position":{"start":{"line":611,"column":1},"end":{"line":611,"column":21}},"children":[{"type":"text","value":"Example ","key":"N4AjmCoPlL"},{"type":"text","value":"9.7.2","key":"SIFvPoAgny"}],"template":"Example %s","enumerator":"9.7.2","resolved":true,"html_id":"demo-improper-decay","remote":true,"url":"/improper","dataUrl":"/improper.json","key":"jVTO5qSXyG"}],"key":"CPjQDEmXoJ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"f = @(x) 1 ./ (1 + x.^2);\nclf,  subplot(2, 1, 1)\nfplot(f, [-4, 4]);  set(gca, 'yscale', 'log') \nxlabel('x'),  ylabel('f(x)'),  ylim([1e-20, 1])  \ntitle('Original integrand')   \n\nx = @(t) sinh( pi * sinh(t) / 2 );\nchain = @(t) pi/2 * cosh(t) .* cosh( pi * sinh(t) / 2 );\nintegrand = @(t) f(x(t)) .* chain(t);\nsubplot(2, 1, 2)\nfplot(integrand, [-4, 4]);  set(gca, 'yscale', 'log') \nxlabel('t'), ylabel('f(x(t))'),  ylim([1e-20, 1])  \ntitle('Transformed integrand')","visibility":"hide","key":"ur9eeS4fCB"},{"type":"output","id":"qCIpMrxeH68QO_GSDVwnW","data":[{"output_type":"execute_result","execution_count":35,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"6e075df972b867827914152d25ec45c7","path":"/build/6e075df972b867827914152d25ec45c7.png"}}}],"visibility":"show","key":"XCxDKSvypW"}],"data":{"tags":[]},"visibility":"show","key":"W9S4eR3gTP"},{"type":"paragraph","position":{"start":{"line":630,"column":1},"end":{"line":630,"column":1}},"children":[{"type":"text","value":"This graph suggests that we capture all of the integrand values that are larger than machine epsilon by integrating in ","position":{"start":{"line":630,"column":1},"end":{"line":630,"column":1}},"key":"APlLlcGkEQ"},{"type":"inlineMath","value":"t","position":{"start":{"line":630,"column":1},"end":{"line":630,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span></span></span></span>","key":"Ow4iXYUxVj"},{"type":"text","value":" from ","position":{"start":{"line":630,"column":1},"end":{"line":630,"column":1}},"key":"nhilCodSh7"},{"type":"text","value":"-4","position":{"start":{"line":630,"column":1},"end":{"line":630,"column":1}},"key":"GPYEPoMmvN"},{"type":"text","value":" to ","position":{"start":{"line":630,"column":1},"end":{"line":630,"column":1}},"key":"ALWaUmkJZM"},{"type":"text","value":"4","position":{"start":{"line":630,"column":1},"end":{"line":630,"column":1}},"key":"ygnGrajIFD"},{"type":"text","value":".","position":{"start":{"line":630,"column":1},"end":{"line":630,"column":1}},"key":"KOPyLjLdWu"}],"key":"zthJgu2SB7"}],"label":"demo-improper-decay-matlab","identifier":"demo-improper-decay-matlab","html_id":"demo-improper-decay-matlab","key":"M9E7PQktCg"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-improper-intinf","label":"demo-improper-intinf","kind":"proof:example","position":{"start":{"line":634,"column":1},"end":{"line":634,"column":22}},"children":[{"type":"text","value":"Example ","key":"fT0gz91vKc"},{"type":"text","value":"9.7.3","key":"jZkXzBfSG5"}],"template":"Example %s","enumerator":"9.7.3","resolved":true,"html_id":"demo-improper-intinf","remote":true,"url":"/improper","dataUrl":"/improper.json","key":"GBUyPe3kHT"}],"key":"H50gUDabu8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"f = @(x) 1 ./ (1 + x.^2);\ntol = 1 ./ 10.^(5:0.5:14);\nerr = zeros(length(tol), 2);\nlen = zeros(length(tol), 2);\nfor k = 1:length(tol)\n    [I1, x1] = intadapt(f, -2/tol(k), 2/tol(k), tol(k));\n    [I2, x2] = intinf(f, tol(k));\n    err(k, :) = abs(pi - [I1, I2]);\n    len(k, :) = [length(x1), length(x2)];\nend\nclf,  loglog(len, err, 'o-')   \nn = [100, 10000];\nhold on,  loglog(n, 1000 * n.^(-4), 'k--')  % 4th order error\nlegend(\"direct\", \"double exponential\", \"4th order\", location=\"southwest\")\ntitle((\"Comparison of integration methods\"));","visibility":"hide","key":"yVbOR9iq7M"},{"type":"output","id":"y5H2uiN9tIx_f7Q2Ufnqz","data":[{"output_type":"execute_result","execution_count":36,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"c7e484bc675e45763210ce30c525ee59","path":"/build/c7e484bc675e45763210ce30c525ee59.png"}}}],"visibility":"show","key":"M4ZJVVHeQz"}],"data":{"tags":[]},"visibility":"show","key":"U625Lwfr0K"},{"type":"paragraph","position":{"start":{"line":655,"column":1},"end":{"line":655,"column":1}},"children":[{"type":"text","value":"Both methods are roughly fourth-order due to Simpson’s formula in the underlying adaptive integration method. At equal numbers of evaluation nodes, however, the double exponential method is consistently 2–3 orders of magnitude more accurate.","position":{"start":{"line":655,"column":1},"end":{"line":655,"column":1}},"key":"Y6OsU4fJFg"}],"key":"IoL4G6dxT6"}],"label":"demo-improper-intinf-matlab","identifier":"demo-improper-intinf-matlab","html_id":"demo-improper-intinf-matlab","key":"uAw84bj7iL"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-improper-intsing","label":"demo-improper-intsing","kind":"proof:example","position":{"start":{"line":659,"column":1},"end":{"line":659,"column":23}},"children":[{"type":"text","value":"Example ","key":"VbUAOOYqAt"},{"type":"text","value":"9.7.4","key":"DzRmwXLhKK"}],"template":"Example %s","enumerator":"9.7.4","resolved":true,"html_id":"demo-improper-intsing","remote":true,"url":"/improper","dataUrl":"/improper.json","key":"Aa0to0IyTr"}],"key":"T3BU09Qa68"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"f = @(x) 1 ./ (10 * sqrt(x));\ntol = 1 ./ 10.^(5:0.5:14);\nerr = zeros(length(tol), 2);\nlen = zeros(length(tol), 2);\nfor k = 1:length(tol)\n    [I1, x1] = intadapt(f, (tol(k)/20)^2, 1, tol(k));\n    [I2, x2] = intsing(f, tol(k));\n    err(k, :) = abs(0.2 - [I1, I2]);\n    len(k, :) = [length(x1), length(x2)];\nend\nclf,  loglog(len, err, 'o-')   \nn = [30, 3000];\nhold on,  loglog(n, 30 * n.^(-4), 'k--')  % 4th order error\nlegend(\"direct\", \"double exponential\", \"4th order\", location=\"southwest\")\ntitle((\"Comparison of integration methods\"));","visibility":"hide","key":"ZWAgGhwYB6"},{"type":"output","id":"4Ff8ERwxEb9Z452lrXWPK","data":[{"output_type":"execute_result","execution_count":37,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"fe133d79fe5d5d667fe2c2a5439d0894","path":"/build/fe133d79fe5d5d667fe2c2a5439d0894.png"}}}],"visibility":"show","key":"BCZAkYgS8M"}],"data":{"tags":[]},"visibility":"show","key":"F5EXIfVeZJ"},{"type":"paragraph","position":{"start":{"line":681,"column":1},"end":{"line":681,"column":1}},"children":[{"type":"text","value":"As in ","position":{"start":{"line":681,"column":1},"end":{"line":681,"column":1}},"key":"wv6K2M6dt8"},{"type":"crossReference","kind":"proof:example","identifier":"demo-improper-intinf","label":"demo-improper-intinf","children":[{"type":"text","value":"Demo ","key":"nlmUw6fVH7"},{"type":"text","value":"9.7.3","key":"wr2gKmvD3b"}],"template":"Example %s","enumerator":"9.7.3","resolved":true,"html_id":"demo-improper-intinf","remote":true,"url":"/improper","dataUrl":"/improper.json","key":"sYderJXdbl"},{"type":"text","value":", the double exponential method is more accurate than direct integration by a few orders of magnitude. Equivalently, the same accuracy can be reached with many fewer nodes.","position":{"start":{"line":681,"column":1},"end":{"line":681,"column":1}},"key":"J9Bf0x6186"}],"key":"wHvcZNW6ji"}],"label":"demo-improper-intsing-matlab","identifier":"demo-improper-intsing-matlab","html_id":"demo-improper-intsing-matlab","key":"QS7Q4l7v51"}],"key":"Rr1dWOkOO7"}],"key":"oZ3Evj0Wtf"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Chapter 8","url":"/chapter8-1","group":"MATLAB codes"},"next":{"title":"Chapter 10","url":"/chapter10-1","group":"MATLAB codes"}}},"domain":"http://localhost:3000"}