

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Linear systems &#8212; Fundamentals of Numerical Computation</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
    <link href="../_static/css/index.css" rel="stylesheet">
    <link rel="stylesheet" href="../_static/sphinx-book-theme.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="../_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="../_static/jupyter-sphinx.css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/sphinx-book-theme.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/mystnb.js"></script>
    <script src="../_static/proof.js"></script>
    <script src="../_static/sphinx-book-theme.js"></script>
    <script >var togglebuttonSelector = '.toggle, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.18.0/dist/embed-amd.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"TeX": {"Macros": {"float": ["\\mathbb{F}"], "real": ["\\mathbb{R}"], "complex": ["\\mathbb{C}"], "nat": ["\\mathbb{N}"], "integer": ["\\mathbb{Z}"], "rmn{([^}]*)}{([^}]*)}": ["\\mathbb{R}^{#1 \\times #2}", 2], "dd{([^}]*)}{([^}]*)}": ["\\frac{d #1}{d #2}", 2], "ddd{([^}]*)}{([^}]*)}": ["\\frac{d^2 #1}{d #2^2}", 2], "pp{([^}]*)}{([^}]*)}": ["\\frac{\\partial #1}{\\partial #2}", 2], "ppp{([^}]*)}{([^}]*)}": ["\\frac{\\partial^2 #1}{\\partial #2^2}", 2], "ppdd{([^}]*)}{([^}]*)}{([^}]*)}": ["\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}", 3], "norm{([^}]*)}": ["\\| #1 \\|", 1], "twonorm{([^}]*)}": ["\\| #1 \\|_2", 1], "onenorm{([^}]*)}": ["\\| #1 \\|_1", 1], "infnorm{([^}]*)}": ["\\| #1 \\|_\\infty", 1], "anynorm{([^}]*)}{([^}]*)}": ["\\| #1 \\|_#2", 2], "innerprod{([^}]*)}{([^}]*)}": ["\\langle #1,#2 \\rangle", 2], "pr{([^}]*)}": ["^{(#1)}", 1], "kron{([^}]*)}{([^}]*)}": ["#1 \\otimes #2", 2], "eye{([^}]*)}": ["\\mathbf{e}_#1", 1], "meye": ["\\mathbf{I}"], "Qhat": ["\\hat{\\mathbf{Q}}"], "Rhat": ["\\hat{\\mathbf{R}}"], "bfalpha": ["\\mathbf{alpha}"], "bfdelta": ["\\mathbf{delta}"], "bfzero": ["\\boldsymbol{0}"], "macheps": ["\\epsilon_\\text{mach}"], "fl": ["\\operatorname{fl}"], "diag": ["\\operatorname{diag}"], "ign": ["\\operatorname{sign}"], "Re": ["\\operatorname{Re}"], "Im": ["\\operatorname{Im}"], "ee": ["\\times 10^"], "lnorm": ["\\|"], "rnorm": ["\\|"], "floor": ["\\lfloor#1\\rfloor", 1]}}})</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="LU factorization" href="lu.html" />
    <link rel="prev" title="Computing with matrices" href="matrices.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="docsearch:language" content="en">



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
  
  <img src="../_static/logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Fundamentals of Numerical Computation</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  
  <ul class="nav sidenav_l1">
  <li class="">
    <a href="../frontmatter.html">Home</a>
  </li>
  <li class="">
    <a href="../intro/overview.html">Introduction</a>
  </li>
  <li class="active">
    <a href="overview.html">Square linear systems</a>
  <ul class="nav sidenav_l2">
    <li class="">
      <a href="polyinterp.html">Polynomial interpolation</a>
    </li>
    <li class="">
      <a href="matrices.html">Computing with matrices</a>
    </li>
    <li class="active">
      <a href="">Linear systems</a>
    </li>
    <li class="">
      <a href="lu.html">LU factorization</a>
    </li>
    <li class="">
      <a href="efficiency.html">Efficiency of matrix computations</a>
    </li>
    <li class="">
      <a href="pivoting.html">Row pivoting</a>
    </li>
    <li class="">
      <a href="norms.html">Vector and matrix norms</a>
    </li>
    <li class="">
      <a href="condition-number.html">Conditioning of linear systems</a>
    </li>
    <li class="">
      <a href="structure.html">Exploiting matrix structure</a>
    </li>
    <li class="">
      <a href="next.html">Next steps</a>
    </li>
  </ul>
  </li>
  <li class="">
    <a href="../leastsq/overview.html">Overdetermined linear systems</a>
  </li>
  <li class="">
    <a href="../nonlineqn/overview.html">Roots of nonlinear equations</a>
  </li>
  <li class="">
    <a href="../localapprox/overview.html">Piecewise interpolation</a>
  </li>
  <li class="">
    <a href="../ivp/overview.html">Initial-value problems for ODEs</a>
  </li>
  <li class="">
    <a href="../appendix/linear-algebra.html">Review: Linear algebra</a>
  </li>
  <li class="">
    <a href="../appendix/demos.html">All demo notebooks</a>
  </li>
  <li class="">
    <a href="../refs.html">References</a>
  </li>
  <li class="">
    <a href="../genindex.html">Index</a>
  </li>
</ul>
</nav>

 <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse" data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu" aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation" title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
            <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i class="fas fa-download"></i></button>

            
            <div class="dropdown-buttons">
                <!-- ipynb file if we had a myst markdown file -->
                
                <!-- Download raw file -->
                <a class="dropdown-buttons" href="../_sources/linsys/linear-systems.md"><button type="button" class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip" data-placement="left">.md</button></a>
                <!-- Download PDF via print -->
                <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF" onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
            </div>
            
        </div>

        <!-- Edit this page -->
        

        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="bottom" onclick="toggleFullScreen()" title="Fullscreen mode"><i class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->
        
    </div>
    <div class="d-none d-md-block col-md-2 bd-toc show">
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="nav section-nav flex-column">
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#don-t-use-the-inverse" class="nav-link">Don’t use the inverse</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#triangular-systems" class="nav-link">Triangular systems</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#implementation" class="nav-link">Implementation</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#exercises" class="nav-link">Exercises</a>
        </li>
    
    </ul>
</nav>


    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="linear-systems">
<h1>Linear systems<a class="headerlink" href="#linear-systems" title="Permalink to this headline">¶</a></h1>
<p>We now attend to the central problem of this chapter: Given a square, <span class="math notranslate nohighlight">\(n\times n\)</span> matrix <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> and an <span class="math notranslate nohighlight">\(n\)</span>-vector <span class="math notranslate nohighlight">\(\mathbf{b}\)</span>, find an <span class="math notranslate nohighlight">\(n\)</span>-vector <span class="math notranslate nohighlight">\(\mathbf{x}\)</span> such that <span class="math notranslate nohighlight">\(\mathbf{A}\mathbf{x}=\mathbf{b}\)</span>. Writing out these equations, we obtain</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{split}
  a_{11}x_1 + a_{12}x_2 + \cdot s + a_{1n}x_n &amp;= b_1 \\
  a_{21}x_1 + a_{22}x_2 + \cdot s + a_{2n}x_n &amp;= b_2 \\
  \vdots  \\
  a_{n1}x_1 + a_{n2}x_2 + \cdot s + a_{nn}x_n &amp;= b_n.
\end{split}\end{split}\]</div>
<p id="index-0">If <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> is nonsingular, then the mathematical expression of the solution is <span class="math notranslate nohighlight">\(\mathbf{x}=\mathbf{A}^{-1}\mathbf{b}\)</span>, because</p>
<div class="math notranslate nohighlight">
\[\begin{split}
  \mathbf{A}^{-1}\mathbf{b} = \mathbf{A}^{-1} (\mathbf{A} \mathbf{x}) = (\mathbf{A}^{-1}\mathbf{A}) \mathbf{x} = \mathbf{I} \mathbf{x}
  = \mathbf{x}.
\end{split}\]</div>
<p>When <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> is singular, then <span class="math notranslate nohighlight">\(\mathbf{A}\mathbf{x}=\mathbf{b}\)</span> may have no solution or
infinitely many solutions.</p>
<div class="proof proof-type-example" id="id1">
<span id="example-singmatrix"></span>
    <div class="proof-title">
        <span class="proof-type">Example 10</span>
        
    </div><div class="proof-content">
<p>If we define</p>
<div class="math notranslate nohighlight">
\[\begin{split}\mathbf{S} =  \begin{bmatrix}
	0 &amp; 1\\0 &amp; 0
\end{bmatrix},\end{split}\]</div>
<p>then it is easy to check that for any real value of <span class="math notranslate nohighlight">\(\alpha\)</span> we have</p>
<div class="math notranslate nohighlight">
\[\begin{split}\mathbf{S}
\begin{bmatrix}
	\alpha \\ 1
\end{bmatrix}
=
\begin{bmatrix}
	1 \\ 0
\end{bmatrix}.\end{split}\]</div>
<p>Hence the linear system <span class="math notranslate nohighlight">\(\mathbf{S}\mathbf{x}=\mathbf{b}\)</span> with $\mathbf{b}=
\begin{bmatrix}
1\0
\end{bmatrix}
$ has infinitely many solutions. For many other choices of <span class="math notranslate nohighlight">\(\mathbf{b}\)</span> the
system can be proven to have no solutions.</p>
</div></div><div class="section" id="don-t-use-the-inverse">
<h2>Don’t use the inverse<a class="headerlink" href="#don-t-use-the-inverse" title="Permalink to this headline">¶</a></h2>
<p>Matrix inverses are indispensable for mathematical discussion and derivations. However, as you may remember from a linear algebra course, they are not trivial to compute from the entries of the original matrix. While it can be done numerically by computer, it almost never is, because when the goal is to solve a linear system of equations, the inverse is not needed—and the process of finding it is slower than solving the original problem.</p>
<span class="target" id="index-1"></span><p id="index-2">Julia does have a command <a class="reference internal" href="overview.html#term-inv"><span class="xref std std-term">inv</span></a> that finds the inverse of a matrix. But, as demonstrated in <a class="reference internal" href="demos/interp-vander.html"><span class="doc">Interpolating the population of China</span></a>, in order to solve a linear system of equations, you should use <a class="reference internal" href="overview.html#term-backslash"><span class="xref std std-term">backslash</span></a>  (the <code class="docutils literal notranslate"><span class="pre">\</span></code> symbol, not to be confused with the slash <code class="docutils literal notranslate"><span class="pre">/</span></code> used in web addresses).</p>
<div class="demo sidebar">
<p class="sidebar-title">Demo</p>
<p><a class="reference internal" href="demos/systems-backslash.html"><span class="doc">Backslash for solving linear systems</span></a></p>
</div>
</div>
<div class="section" id="triangular-systems">
<h2>Triangular systems<a class="headerlink" href="#triangular-systems" title="Permalink to this headline">¶</a></h2>
<p id="index-3">The solution process is especially easy to demonstrate for a system with a <a class="reference internal" href="overview.html#term-triangular-matrix"><span class="xref std std-term">triangular matrix</span></a>. For example, consider the lower triangular system</p>
<div class="math notranslate nohighlight">
\[\begin{split}  \begin{bmatrix}
    4 &amp; 0 &amp; 0 &amp; 0 \\
    3 &amp; -1 &amp; 0 &amp; 0 \\
    -1 &amp; 0 &amp; 3 &amp; 0 \\
    1 &amp; -1 &amp; -1 &amp; 2
  \end{bmatrix} \mathbf{x} =
  \begin{bmatrix}
    8 \\ 5 \\ 0 \\ 1
  \end{bmatrix}.\end{split}\]</div>
<p>The first row of this system states simply that <span class="math notranslate nohighlight">\(4x_1=8\)</span>, which is easily solved as <span class="math notranslate nohighlight">\(x_1=8/4=2\)</span>. Now, the second row states that <span class="math notranslate nohighlight">\(3x_1-x_2=5\)</span>. As <span class="math notranslate nohighlight">\(x_1\)</span> is already known, it can be replaced to find that <span class="math notranslate nohighlight">\(x_2 = -(5-3\cdot 2)=1\)</span>. Similarly, the third row gives <span class="math notranslate nohighlight">\(x_3=(0+1\cdot 2)/3 = 2/3\)</span>, and the last row yields <span class="math notranslate nohighlight">\(x_4=(1-1\cdot 2 + 1\cdot 1 + 1\cdot 2/3)/2 = 1/3\)</span>. Hence the solution is</p>
<div class="math notranslate nohighlight">
\[\begin{split}  \mathbf{x} =
  \begin{bmatrix} 2 \\ 1 \\ 2/3 \\ 1/3
  \end{bmatrix}.\end{split}\]</div>
<p id="index-4">The process just described is called <a class="reference internal" href="overview.html#term-forward-substitution"><span class="xref std std-term">forward substitution</span></a>. In the <span class="math notranslate nohighlight">\(4\times 4\)</span> lower triangular case of <span class="math notranslate nohighlight">\(\mathbf{L}\mathbf{x}=\mathbf{b}\)</span> it leads to the formulas</p>
<div class="math notranslate nohighlight" id="equation-forwardsub">
<span class="eqno">(27)<a class="headerlink" href="#equation-forwardsub" title="Permalink to this equation">¶</a></span>\[\begin{split}\begin{split}
  x_1 &amp;= \frac{b_1}{L_{11}} \\
  x_2 &amp;= \frac{b_2 - L_{21}x_1}{L_{22}} \\
  x_3 &amp;= \frac{b_3 - L_{31}x_1 - L_{32}x_2}{L_{33}} \\
  x_4 &amp;= \frac{b_4 - L_{41}x_1 - L_{42}x_2 - L_{43}x_3}{L_{44}}.
\end{split}:label: forwardsub\end{split}\]</div>
<p id="index-5">For upper triangular systems <span class="math notranslate nohighlight">\(\mathbf{U}\mathbf{x}=\mathbf{b}\)</span> an analogous process of <a class="reference internal" href="overview.html#term-backward-substitution"><span class="xref std std-term">backward substitution</span></a> begins by solving for the last component <span class="math notranslate nohighlight">\(x_n=b_n/U_{nn}\)</span> and working backward. For the <span class="math notranslate nohighlight">\(4\times 4\)</span> case we have</p>
<div class="math notranslate nohighlight">
\[\begin{split}  \begin{bmatrix}
    U_{11} &amp; U_{12} &amp; U_{13} &amp; U_{14} \\
    0 &amp; U_{22} &amp; U_{23} &amp; U_{24} \\
    0 &amp; 0 &amp; U_{33} &amp; U_{34} \\
    0 &amp; 0 &amp; 0 &amp; U_{44}
  \end{bmatrix} \mathbf{x} =
  \begin{bmatrix}
    b_1 \\ b_2 \\ b_3 \\ b_4
  \end{bmatrix}.\end{split}\]</div>
<p>Solving the system backward, starting with <span class="math notranslate nohighlight">\(x_4\)</span> first and then proceeding in descending order, gives</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{split}
  x_4 &amp;= \frac{b_4}{U_{44}} \\
  x_3 &amp;= \frac{b_3 - U_{34}x_4}{U_{33}} \\
  x_2 &amp;= \frac{b_2 - U_{23}x_3 - U_{24}x_4}{U_{22}} \\
  x_1 &amp;= \frac{b_1 - U_{12}x_2 - U_{13}x_3 - U_{14}x_4}{U_{11}}.
\end{split}\end{split}\]</div>
<p>It should be clear that forward or backward substitution fails if, and only if, one of the diagonal entries of the system matrix is zero. We have essentially proved the following theorem.</p>
<div class="proof proof-type-theorem" id="id2">
<span id="theorem-triangleinvert"></span>
    <div class="proof-title">
        <span class="proof-type">Theorem 11</span>
        
            <span class="proof-title-name">(Triangular singularity)</span>
        
    </div><div class="proof-content">
<p>A triangular matrix is singular if and only if at least one of its diagonal elements is zero.</p>
</div></div></div>
<div class="section" id="implementation">
<h2>Implementation<a class="headerlink" href="#implementation" title="Permalink to this headline">¶</a></h2>
<p>Consider how to implement the sequential process implied by equation <a class="reference internal" href="#equation-forwardsub">(27)</a>. It seems clear that we want to loop through the elements of <span class="math notranslate nohighlight">\(\mathbf{x}\)</span> in order. Within each iteration of that loop, we have an expression whose length depends on the iteration number. One way we could do this would be with a nested loop:</p>
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="o">:</span><span class="mi">4</span>
    <span class="n">s</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="o">:</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
    <span class="k">end</span>
    <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">s</span><span class="p">)</span> <span class="o">/</span> <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="p">]</span>
<span class="k">end</span>
</pre></div>
</div>
<p>A briefer version of the inner loop over <code class="docutils literal notranslate"><span class="pre">j</span></code> is the comprehension</p>
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="n">sum</span><span class="p">(</span> <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="o">:</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span> <span class="p">)</span>
</pre></div>
</div>
<p>However, when <code class="docutils literal notranslate"><span class="pre">i</span></code> equals 1, the range <code class="docutils literal notranslate"><span class="pre">1:i-1</span></code> is empty and the sum fails. To avoid this we can handle this case before the <code class="docutils literal notranslate"><span class="pre">i</span></code> loop begins, and start that loop at 2. This is the approach taken in <a class="reference internal" href="#function-forwardsub"><span class="std std-numref">Function 12</span></a>.</p>
<div class="proof proof-type-function" id="id3">
<span id="function-forwardsub"></span>
    <div class="proof-title">
        <span class="proof-type">Function 12</span>
        
            <span class="proof-title-name">(forwardsub)</span>
        
    </div><div class="proof-content">
<p><strong>Forward substitution to solve a lower-triangular linear system</strong></p>
<div class="highlight-julia notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="s">&quot;&quot;&quot;</span>
<span class="s">forwardsub(L,b)</span>

<span class="s">Solve the lower-triangular linear system with matrix `L` and</span>
<span class="s">right-hand side vector `b`.</span>
<span class="s">&quot;&quot;&quot;</span>
<span class="k">function</span> <span class="n">forwardsub</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>

<span class="n">n</span> <span class="o">=</span> <span class="n">size</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">L</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<span class="k">for</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">2</span><span class="o">:</span><span class="n">n</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">sum</span><span class="p">(</span> <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="o">:</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span> <span class="p">)</span>
    <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span> <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">s</span> <span class="p">)</span> <span class="o">/</span> <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="p">]</span>
<span class="k">end</span>

<span class="k">return</span> <span class="n">x</span>
<span class="k">end</span>
</pre></div>
</td></tr></table></div>
</div></div><p>The implementation of backward substitution is much like forward substitution and is given in <a class="reference internal" href="#function-backsub"><span class="std std-numref">Function 13</span></a>.</p>
<div class="proof proof-type-function" id="id4">
<span id="function-backsub"></span>
    <div class="proof-title">
        <span class="proof-type">Function 13</span>
        
            <span class="proof-title-name">(backsub)</span>
        
    </div><div class="proof-content">
<p><strong>Backward substitution to solve an upper-triangular linear system</strong></p>
<div class="highlight-julia notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="s">&quot;&quot;&quot;</span>
<span class="s">backsub(U,b)</span>

<span class="s">Solve the upper-triangular linear system with matrix `U` and</span>
<span class="s">right-hand side vector `b`.</span>
<span class="s">&quot;&quot;&quot;</span>
<span class="k">function</span> <span class="n">backsub</span><span class="p">(</span><span class="n">U</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>

<span class="n">n</span> <span class="o">=</span> <span class="n">size</span><span class="p">(</span><span class="n">U</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">x</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">b</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">/</span><span class="n">U</span><span class="p">[</span><span class="n">n</span><span class="p">,</span><span class="n">n</span><span class="p">]</span>
<span class="k">for</span> <span class="n">i</span> <span class="o">=</span> <span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="o">:-</span><span class="mi">1</span><span class="o">:</span><span class="mi">1</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">sum</span><span class="p">(</span> <span class="n">U</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span><span class="o">=</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="o">:</span><span class="n">n</span> <span class="p">)</span>
    <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span> <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">s</span> <span class="p">)</span> <span class="o">/</span> <span class="n">U</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="p">]</span>
<span class="k">end</span>

<span class="k">return</span> <span class="n">x</span>
<span class="k">end</span>
</pre></div>
</td></tr></table></div>
</div></div><div class="demo sidebar">
<p class="sidebar-title">Demo</p>
<p><a class="reference internal" href="demos/systems-triangular.html"><span class="doc">Solving triangular systems</span></a></p>
</div>
<p>The example in <a class="reference internal" href="demos/systems-triangular.html"><span class="doc">Solving triangular systems</span></a> is our first clue that linear system problems may have large condition numbers, making inaccurate solutions inevitable in floating point arithmetic. We will learn how to spot such problems <a class="reference internal" href="condition-number.html"><span class="doc">later in the chapter</span></a>. Before reaching that point, however, we need to discuss how to solve general linear systems, not just triangular ones.</p>
</div>
<div class="section" id="exercises">
<h2>Exercises<a class="headerlink" href="#exercises" title="Permalink to this headline">¶</a></h2>
<ol>
<li><p>✍ Find a right-hand side vector <span class="math notranslate nohighlight">\(\mathbf{b}\)</span> such that the system <span class="math notranslate nohighlight">\(\begin{bmatrix} 0&amp;1\\0&amp;0 \end{bmatrix} \mathbf{x}=\mathbf{b}\)</span> has no solution.</p></li>
<li><p>✍ Solve the following triangular systems by hand.</p>
<p><strong>(a)</strong> <span class="math notranslate nohighlight">\(\displaystyle
   \begin{aligned}
   -2x_1 &amp;        &amp;       &amp;= -4 \\
     x_1 &amp; - x_2  &amp;       &amp;= 2 \\
    3x_1 &amp;+ 2x_2  &amp; + x_3 &amp;= 1
   \end{aligned} \qquad\)</span>
<strong>(b)</strong> <span class="math notranslate nohighlight">\(\displaystyle
   \begin{bmatrix}
     4 &amp; 0 &amp; 0 &amp; 0 \\
     1 &amp; -2 &amp; 0 &amp; 0 \\
     -1 &amp; 4 &amp; 4 &amp; 0 \\
     2 &amp; -5 &amp; 5 &amp; 1
   \end{bmatrix} \mathbf{x} =
   \begin{bmatrix}
     -4 \\ 1 \\ -3 \\ 5
   \end{bmatrix}\qquad\)</span>
<strong>(c)</strong> <span class="math notranslate nohighlight">\(\displaystyle
   \begin{aligned}
    3x_1 + &amp;2x_2 &amp; +  x_3      &amp;= 1 \\
         &amp; x_2   &amp; -   x_3      &amp;= 2 \\
         &amp;          &amp; 2 x_3    &amp;= -4
   \end{aligned}\)</span></p>
</li>
<li><p>⌨ Use <a class="reference internal" href="#function-forwardsub"><span class="std std-ref">forwardsub</span></a> to solve the systems from the previous problem. Verify that the solution is correct by computing <span class="math notranslate nohighlight">\(\mathbf{L}\mathbf{x}\)</span> and subtracting <span class="math notranslate nohighlight">\(\mathbf{b}\)</span>.</p></li>
<li><p>⌨  Use <a class="reference internal" href="#function-backsub"><span class="std std-ref">backsub</span></a> to solve the following systems.  Verify that the solution is correct by computing <span class="math notranslate nohighlight">\(\mathbf{U}\mathbf{x}\)</span> and subtracting <span class="math notranslate nohighlight">\(\mathbf{b}\)</span>.</p>
<p><strong>(a)</strong> <span class="math notranslate nohighlight">\(\displaystyle
 \begin{bmatrix}
   3 &amp; 1 &amp; 0  \\
   0 &amp; -1 &amp; -2  \\
   0 &amp; 0 &amp; 3  \\
 \end{bmatrix} \mathbf{x} =
 \begin{bmatrix}
   1 \\ 1 \\ 6
 \end{bmatrix}\qquad\)</span>
<strong>(b)</strong> <span class="math notranslate nohighlight">\(\displaystyle
 \begin{bmatrix}
   3 &amp; 1 &amp; 0 &amp; 6 \\
   0 &amp; -1 &amp; -2 &amp; 7 \\
   0 &amp; 0 &amp; 3 &amp; 4 \\
   0 &amp; 0 &amp; 0 &amp; 5
 \end{bmatrix} \mathbf{x} =
 \begin{bmatrix}
   4 \\ 1 \\ 1 \\ 5
 \end{bmatrix}\)</span></p>
</li>
<li id="problem-systemsinverse"><p>⌨  If <span class="math notranslate nohighlight">\(\mathbf{B}\in\mathbb{R}^{n \times p}\)</span>, has columns <span class="math notranslate nohighlight">\(\mathbf{b}_1,\ldots,\mathbf{b}_p\)</span>, then we can pose <span class="math notranslate nohighlight">\(p\)</span> linear systems at once by writing <span class="math notranslate nohighlight">\(\mathbf{A} \mathbf{X} = \mathbf{B}\)</span>, where <span class="math notranslate nohighlight">\(\mathbf{X}\)</span> is <span class="math notranslate nohighlight">\(n\times p\)</span>. Specifically, this equation implies <span class="math notranslate nohighlight">\(\mathbf{A} \mathbf{x}_j = \mathbf{b}_j\)</span> for <span class="math notranslate nohighlight">\(j=1,\ldots,p\)</span>.</p>
<p><strong>(a)</strong> Modify <a class="reference internal" href="#function-forwardsub"><span class="std std-ref">forwardsub</span></a> and <a class="reference internal" href="#function-backsub"><span class="std std-ref">backsub</span></a> so that they solve the case where the second input is <span class="math notranslate nohighlight">\(n\times p\)</span> for <span class="math notranslate nohighlight">\(p\ge 1\)</span>.</p>
<p><strong>(b)</strong> If <span class="math notranslate nohighlight">\(\mathbf{A} \mathbf{X}=\mathbf{I}\)</span>, then <span class="math notranslate nohighlight">\(\mathbf{X}=\mathbf{A}^{-1}\)</span>. Use this fact to write a function <code class="docutils literal notranslate"><span class="pre">ltinverse</span></code> that uses your modified <strong>forwardsub</strong> to compute the inverse of a lower triangular matrix. Test your function on at least two nontrivial matrices. (We remind you here that this is just an exercise; matrix inverses are rarely a good idea in numerical practice!)</p>
</li>
<li id="problem-triangillcond"><p>⌨ <a class="reference internal" href="demos/systems-triangular.html"><span class="doc">Solving triangular systems</span></a> showed solutions of <span class="math notranslate nohighlight">\(\mathbf{A}\mathbf{x}=\mathbf{b}\)</span>, where</p>
<div class="math notranslate nohighlight">
\[\begin{split}\mathbf{A} = \begin{bmatrix} 1 &amp; -1 &amp; 0 &amp; \alpha-\beta &amp; \beta \\ 0 &amp; 1 &amp; -1 &amp;
  0 &amp; 0 \\ 0 &amp; 0 &amp; 1 &amp; -1 &amp; 0 \\ 0 &amp; 0 &amp; 0 &amp; 1 &amp; -1  \\ 0 &amp; 0 &amp; 0 &amp; 0 &amp; 1
\end{bmatrix}, \quad
\mathbf{b} = \begin{bmatrix} \alpha \\ 0 \\ 0 \\ 0 \\ 1 \end{bmatrix}.\end{split}\]</div>
<p>Solve with <span class="math notranslate nohighlight">\(\alpha=0.1\)</span> and <span class="math notranslate nohighlight">\(\beta=10,100,\ldots,10^{12}\)</span>, making a table of the values of <span class="math notranslate nohighlight">\(\beta\)</span> and <span class="math notranslate nohighlight">\(|x_1-1|\)</span>.</p>
</li>
</ol>
</div>
</div>


              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="matrices.html" title="previous page">Computing with matrices</a>
    <a class='right-next' id="next-link" href="lu.html" title="next page">LU factorization</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Tobin A. Driscoll and Richard J. Braun<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    <script src="../_static/js/index.js"></script>
    
  </body>
</html>