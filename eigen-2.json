{"kind":"Notebook","sha256":"bdfe3d49a93b3cc00f959ba466cdd619f616d3c00b404ce70ccbb220fb76de5b","slug":"eigen-2","location":"/chapter7/section2/python/eigen.ipynb","dependencies":[],"frontmatter":{"numbering":{"heading_1":{"enabled":false},"heading_2":{"enabled":false},"heading_3":{"enabled":false},"heading_4":{"enabled":false},"heading_5":{"enabled":false},"heading_6":{"enabled":false}},"kernelspec":{"name":"python3","display_name":"Python 3","language":"python"},"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"exports":[{"format":"ipynb","filename":"eigen.ipynb","url":"/build/eigen-82148a5f86d93cb1fe1fece000165684.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T16:31:35.014654Z","iopub.status.busy":"2025-01-11T16:31:35.014519Z","iopub.status.idle":"2025-01-11T16:31:35.322317Z","shell.execute_reply":"2025-01-11T16:31:35.321973Z"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"exec(open(\"../../../python/FNC_init.py\").read())","visibility":"show","key":"izshr9ZWR4"},{"type":"output","id":"32iVjAaNCz8UR1ZOhwP41","data":[],"visibility":"show","key":"PmDsZSzDDB"}],"visibility":"remove","key":"HsyadA38YS"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"XfJA0CvMrI"},{"type":"text","value":"7.2.2","key":"HioAgRWNob"}],"key":"H57QB9MDuU"}],"identifier":"demo-evd-eigen","label":"demo-evd-eigen","kind":"proof:example","template":"Example %s","enumerator":"7.2.2","resolved":true,"html_id":"demo-evd-eigen","remote":true,"url":"/evd","dataUrl":"/evd.json","key":"ULjC9SppA1"}],"key":"UMaXpH6Q8r"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"vxmbh9CAQq"},{"type":"inlineCode","value":"eig","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"yDgM6Of34a"},{"type":"text","value":" function from ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"VpRCBZ84jB"},{"type":"inlineCode","value":"scipy.linalg","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"N9uSvfywd7"},{"type":"text","value":" will return a vector of eigenvalues and a matrix of associated eigenvectors.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"YJDzKBXoo4"}],"indexEntries":[{"entry":"Python","subEntry":{"value":"eig","kind":"entry"},"emphasis":true}],"label":"index-aEErkT02ww","identifier":"index-aeerkt02ww","html_id":"index-aeerkt02ww","key":"sf2QTldAob"}],"key":"h7sp2ousKY"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T16:31:35.323958Z","iopub.status.busy":"2025-01-11T16:31:35.323824Z","iopub.status.idle":"2025-01-11T16:31:35.326108Z","shell.execute_reply":"2025-01-11T16:31:35.325865Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"from numpy.linalg import eig\nA = pi * ones([2, 2])\nd, V = eig(A)\nprint(\"eigenvalues:\", d)","key":"jyDdn7CYOd"},{"type":"output","id":"P4e3UH1lRJGBjhaR19iZe","data":[{"name":"stdout","output_type":"stream","text":"eigenvalues: [ 6.28318531e+00 -6.97573700e-16]\n"}],"key":"ignUFw4zUy"}],"key":"jir8S39SiZ"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We can check the fact that this is an ","key":"rcRugNWvg6"},{"type":"abbreviation","title":"eigenvalue decomposition","children":[{"type":"text","value":"EVD","key":"YYKHoeFpJa"}],"key":"SE5MBshDWB"},{"type":"text","value":" (although in practice we never invert a matrix).","key":"zOFJnr32tI"}],"key":"tmuuOTEUm7"}],"key":"qShrMq6gwb"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T16:31:35.327385Z","iopub.status.busy":"2025-01-11T16:31:35.327298Z","iopub.status.idle":"2025-01-11T16:31:35.329282Z","shell.execute_reply":"2025-01-11T16:31:35.329035Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"from numpy.linalg import inv\nD = diag(d)\nprint(f\"should be near zero: {norm(A - V @ D @ inv(V), 2):.2e}\")","key":"QFHuusqj2O"},{"type":"output","id":"adsf5w9a7ikqsu0jpmqVu","data":[{"name":"stdout","output_type":"stream","text":"should be near zero: 1.26e-15\n"}],"key":"ltSs0cX2TQ"}],"key":"XRgyqIKn0r"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"If the matrix is not diagonalizable, no message is given, but ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"uITtdVkowh"},{"type":"inlineCode","value":"V","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"fGuU4RPuow"},{"type":"text","value":" will be singular. The robust way to detect that circumstance is via ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RkwrzZoeZK"},{"type":"inlineMath","value":"\\kappa(\\mathbf{V})","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>κ</mi><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">V</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\kappa(\\mathbf{V})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">κ</span><span class=\"mopen\">(</span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">V</span><span class=\"mclose\">)</span></span></span></span>","key":"iTQ9d91Ci0"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"oxjJLUMSjE"}],"key":"wh5pjISb82"}],"key":"je8akNzGaO"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T16:31:35.330514Z","iopub.status.busy":"2025-01-11T16:31:35.330429Z","iopub.status.idle":"2025-01-11T16:31:35.333686Z","shell.execute_reply":"2025-01-11T16:31:35.332216Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"from numpy.linalg import cond\nA = array([[1, 1], [0, 1]])\nd, V = eig(A)\nprint(f\"cond(V) is {cond(V):.2e}\")","key":"jZ4XFMQPz7"},{"type":"output","id":"o_o36Pd_pk10t-T6ykc2-","data":[{"name":"stdout","output_type":"stream","text":"cond(V) is 9.01e+15\n"}],"key":"EJ3iVLDC2K"}],"key":"d18MyytVE6"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"But even in the nondiagonalizable case, ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PIHTk7UFnb"},{"type":"inlineMath","value":"\\mathbf{A}\\mathbf{V} = \\mathbf{V}\\mathbf{D}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi><mi mathvariant=\"bold\">V</mi><mo>=</mo><mi mathvariant=\"bold\">V</mi><mi mathvariant=\"bold\">D</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}\\mathbf{V} = \\mathbf{V}\\mathbf{D}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">AV</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">VD</span></span></span></span>","key":"AudKPtxwEt"},{"type":"text","value":" holds up to roundoff error.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mVcPCzspUF"}],"key":"zpWNWtWcsS"}],"key":"En8hn3Pz5Z"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T16:31:35.340999Z","iopub.status.busy":"2025-01-11T16:31:35.339543Z","iopub.status.idle":"2025-01-11T16:31:35.366103Z","shell.execute_reply":"2025-01-11T16:31:35.347359Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"print(f\"should be near zero: {norm(A @ V - V @ diag(d), 2):.2e}\")","key":"kQrOKDx2gu"},{"type":"output","id":"z5zzlO_hqGJihn1q7KHfk","data":[{"name":"stdout","output_type":"stream","text":"should be near zero: 2.22e-16\n"}],"key":"zeC6W0Evjh"}],"key":"MaApwGPxKJ"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"code","lang":"","value":"","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Z2BlzhBTH2"}],"key":"iQ6GfHzAiW"}],"key":"QybvqYSMOJ"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Image","url":"/image-2","group":"Chapter 7"},"next":{"title":"Bauerfike","url":"/bauerfike-2","group":"Chapter 7"}}},"domain":"http://localhost:3000"}