{"kind":"Notebook","sha256":"bdfe3d49a93b3cc00f959ba466cdd619f616d3c00b404ce70ccbb220fb76de5b","slug":"eigen-2","location":"/chapter7/section2/python/eigen.ipynb","dependencies":[],"frontmatter":{"numbering":{"heading_1":{"enabled":false},"heading_2":{"enabled":false},"heading_3":{"enabled":false},"heading_4":{"enabled":false},"heading_5":{"enabled":false},"heading_6":{"enabled":false}},"kernelspec":{"name":"python3","display_name":"Python 3","language":"python"},"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"exports":[{"format":"ipynb","filename":"eigen.ipynb","url":"/fnc/build/eigen-82148a5f86d93cb1fe1fece000165684.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T16:31:35.014654Z","iopub.status.busy":"2025-01-11T16:31:35.014519Z","iopub.status.idle":"2025-01-11T16:31:35.322317Z","shell.execute_reply":"2025-01-11T16:31:35.321973Z"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"exec(open(\"../../../python/FNC_init.py\").read())","visibility":"show","key":"XJa8knH0dK"},{"type":"output","id":"DQeh1iNPr1AphpOQIfzsp","data":[],"visibility":"show","key":"G8xeSePFXH"}],"visibility":"remove","key":"rpJQk0uubz"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"RUWBZXH6jX"},{"type":"text","value":"7.2.2","key":"WC5vfPv33p"}],"key":"COJxuTDcTW"}],"identifier":"demo-evd-eigen","label":"demo-evd-eigen","kind":"proof:example","template":"Example %s","enumerator":"7.2.2","resolved":true,"html_id":"demo-evd-eigen","remote":true,"url":"/evd","dataUrl":"/evd.json","key":"EHcUFc97DQ"}],"key":"jU8VHFMzZ5"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"Etg8pNk02x"},{"type":"inlineCode","value":"eig","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"YiPi9UbPKr"},{"type":"text","value":" function from ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"PvgvIcAt2z"},{"type":"inlineCode","value":"scipy.linalg","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"ytpfddtBWf"},{"type":"text","value":" will return a vector of eigenvalues and a matrix of associated eigenvectors.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"rjpDM03NYC"}],"indexEntries":[{"entry":"Python","subEntry":{"value":"eig","kind":"entry"},"emphasis":true}],"label":"index-LiB14QPU5M","identifier":"index-lib14qpu5m","html_id":"index-lib14qpu5m","key":"OtbzGVOarh"}],"key":"QQ0DRkQ6O6"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T16:31:35.323958Z","iopub.status.busy":"2025-01-11T16:31:35.323824Z","iopub.status.idle":"2025-01-11T16:31:35.326108Z","shell.execute_reply":"2025-01-11T16:31:35.325865Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"from numpy.linalg import eig\nA = pi * ones([2, 2])\nd, V = eig(A)\nprint(\"eigenvalues:\", d)","key":"oGUnEvwqcS"},{"type":"output","id":"kATjLz68otnbzVtfJkGwS","data":[{"name":"stdout","output_type":"stream","text":"eigenvalues: [ 6.28318531e+00 -6.97573700e-16]\n"}],"key":"w7rPu5jn1v"}],"key":"RaEN7y4WKP"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We can check the fact that this is an ","key":"Y0vpWASKxa"},{"type":"abbreviation","title":"eigenvalue decomposition","children":[{"type":"text","value":"EVD","key":"G2FToQRWFo"}],"key":"Le8JRieRrZ"},{"type":"text","value":" (although in practice we never invert a matrix).","key":"hgC9q8HFPz"}],"key":"hbYXC7yYOF"}],"key":"TYajQaXSUl"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T16:31:35.327385Z","iopub.status.busy":"2025-01-11T16:31:35.327298Z","iopub.status.idle":"2025-01-11T16:31:35.329282Z","shell.execute_reply":"2025-01-11T16:31:35.329035Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"from numpy.linalg import inv\nD = diag(d)\nprint(f\"should be near zero: {norm(A - V @ D @ inv(V), 2):.2e}\")","key":"jGcswE4zZs"},{"type":"output","id":"IlhTxnQ1Rda1ESCgM0ExC","data":[{"name":"stdout","output_type":"stream","text":"should be near zero: 1.26e-15\n"}],"key":"VvPGdKlMKJ"}],"key":"utOj4cmsTW"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"If the matrix is not diagonalizable, no message is given, but ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"BbrNfJYR7j"},{"type":"inlineCode","value":"V","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ppftBMhpzJ"},{"type":"text","value":" will be singular. The robust way to detect that circumstance is via ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WMf8x0cA9w"},{"type":"inlineMath","value":"\\kappa(\\mathbf{V})","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>κ</mi><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">V</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\kappa(\\mathbf{V})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">κ</span><span class=\"mopen\">(</span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">V</span><span class=\"mclose\">)</span></span></span></span>","key":"qrMI9LEMfJ"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"T5YDvauxZW"}],"key":"jQuesqw7Fx"}],"key":"uoeySkM9DP"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T16:31:35.330514Z","iopub.status.busy":"2025-01-11T16:31:35.330429Z","iopub.status.idle":"2025-01-11T16:31:35.333686Z","shell.execute_reply":"2025-01-11T16:31:35.332216Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"from numpy.linalg import cond\nA = array([[1, 1], [0, 1]])\nd, V = eig(A)\nprint(f\"cond(V) is {cond(V):.2e}\")","key":"ADacKG0Vmi"},{"type":"output","id":"_mRHqCl8_HS2Upyja-4Gl","data":[{"name":"stdout","output_type":"stream","text":"cond(V) is 9.01e+15\n"}],"key":"kjPwtYXTjL"}],"key":"Am0Jtl3tDE"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"But even in the nondiagonalizable case, ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"yrqaeHmA60"},{"type":"inlineMath","value":"\\mathbf{A}\\mathbf{V} = \\mathbf{V}\\mathbf{D}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi><mi mathvariant=\"bold\">V</mi><mo>=</mo><mi mathvariant=\"bold\">V</mi><mi mathvariant=\"bold\">D</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}\\mathbf{V} = \\mathbf{V}\\mathbf{D}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">AV</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">VD</span></span></span></span>","key":"h6kQZiTd3f"},{"type":"text","value":" holds up to roundoff error.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rODIBSHzAV"}],"key":"LyRzAOzIAe"}],"key":"eP6SaQD2Ol"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T16:31:35.340999Z","iopub.status.busy":"2025-01-11T16:31:35.339543Z","iopub.status.idle":"2025-01-11T16:31:35.366103Z","shell.execute_reply":"2025-01-11T16:31:35.347359Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"print(f\"should be near zero: {norm(A @ V - V @ diag(d), 2):.2e}\")","key":"VL7GXlcl6t"},{"type":"output","id":"9jt_AwpXD-66YWyGEQdWj","data":[{"name":"stdout","output_type":"stream","text":"should be near zero: 2.22e-16\n"}],"key":"W13oeVKPa3"}],"key":"zaISwGkpm0"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"code","lang":"","value":"","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"c0DvSmPdv0"}],"key":"JqFe9TXNPy"}],"key":"T7PKMM5fQD"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Image","url":"/image-2","group":"Chapter 7"},"next":{"title":"Bauerfike","url":"/bauerfike-2","group":"Chapter 7"}}},"domain":"http://localhost:3000"}