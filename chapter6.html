<!DOCTYPE html><html lang="en" class="" style="scroll-padding:60px"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>Chapter 6 - Fundamentals of Numerical Computation</title><meta property="og:title" content="Chapter 6 - Fundamentals of Numerical Computation"/><meta name="generator" content="mystmd"/><meta name="description" content="Online textbook for computational mathematics"/><meta property="og:description" content="Online textbook for computational mathematics"/><meta name="keywords" content=""/><meta name="image" content="/fnc/build/front_cover_small-3b81a246c798b3ded1375244c3419355.webp"/><meta property="og:image" content="/fnc/build/front_cover_small-3b81a246c798b3ded1375244c3419355.webp"/><link rel="icon" href="/fnc/favicon.ico"/><link rel="stylesheet" href="/fnc/build/_assets/app-H3NBUYVS.css"/><link rel="stylesheet" href="/fnc/build/_assets/thebe-core-VKVHG5VY.css"/><link rel="stylesheet" href="/myst-theme.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jupyter-matplotlib@0.11.3/css/mpl_widget.css"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css" integrity="sha384-MlJdn/WNKDGXveldHDdyRP1R4CTHr3FeuDNfhsLPYrq2t0UBkUdK2jyTnXPEK1NQ" crossorigin="anonymous"/><script>
  const savedTheme = localStorage.getItem("myst:theme");
  const theme = window.matchMedia("(prefers-color-scheme: light)").matches ? 'light' : 'dark';
  const classes = document.documentElement.classList;
  const hasAnyTheme = classes.contains('light') || classes.contains('dark');
  if (!hasAnyTheme) classes.add(savedTheme ?? theme);
</script></head><body class="m-0 transition-colors duration-500 bg-white dark:bg-stone-900"><div class="fixed top-1 left-1 h-[0px] w-[0px] focus-within:z-40 focus-within:h-auto focus-within:w-auto bg-white overflow-hidden focus-within:p-2 focus-within:ring-1" aria-label="skip to content options"><a href="#skip-to-frontmatter" class="block px-2 py-1 text-black underline">Skip to article frontmatter</a><a href="#skip-to-article" class="block px-2 py-1 text-black underline">Skip to article content</a></div><div class="bg-white/80 backdrop-blur dark:bg-stone-900/80 shadow dark:shadow-stone-700 p-3 md:px-8 sticky w-screen top-0 z-30 h-[60px]"><nav class="flex items-center justify-between flex-nowrap max-w-[1440px] mx-auto"><div class="flex flex-row xl:min-w-[19.5rem] mr-2 sm:mr-7 justify-start items-center shrink-0"><div class="block xl:hidden"><button class="flex items-center border-stone-400 text-stone-800 hover:text-stone-900 dark:text-stone-200 hover:dark:text-stone-100"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="m-1"><path fill-rule="evenodd" d="M3 6.75A.75.75 0 0 1 3.75 6h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 6.75ZM3 12a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 12Zm0 5.25a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75a.75.75 0 0 1-.75-.75Z" clip-rule="evenodd"></path></svg><span class="sr-only">Open Menu</span></button></div><a class="flex items-center ml-3 dark:text-white w-fit md:ml-5 xl:ml-7" href="/fnc/"><div class="p-1 mr-3 dark:bg-white dark:rounded"><img src="/fnc/build/FNClogo-8857b73cc9f6c65c9fea3e10797ba18a.png" class="h-9" alt="Fundamentals of Numerical Computation" height="2.25rem"/></div><span class="text-md sm:text-xl tracking-tight sm:mr-5 sr-only">Made with MyST</span></a></div><div class="flex items-center flex-grow w-auto"><div class="flex-grow hidden text-md lg:block"></div><div class="flex-grow block"></div><button type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:R3iop:" data-state="closed" class="flex items-center h-10 aspect-square sm:w-64 text-left text-gray-400 border border-gray-300 dark:border-gray-600 rounded-lg bg-gray-50 dark:bg-gray-700 hover:ring-blue-500 dark:hover:ring-blue-500 hover:border-blue-500 dark:hover:border-blue-500"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="p-2.5 h-10 w-10 aspect-square"><path fill-rule="evenodd" d="M10.5 3.75a6.75 6.75 0 1 0 0 13.5 6.75 6.75 0 0 0 0-13.5ZM2.25 10.5a8.25 8.25 0 1 1 14.59 5.28l4.69 4.69a.75.75 0 1 1-1.06 1.06l-4.69-4.69A8.25 8.25 0 0 1 2.25 10.5Z" clip-rule="evenodd"></path></svg><span class="hidden sm:block grow">Search</span><div aria-hidden="true" class="items-center hidden mx-1 font-mono text-sm text-gray-400 sm:flex gap-x-1"><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none hide-mac">CTRL</kbd><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none show-mac">⌘</kbd><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none ">K</kbd><script>
;(() => {
const script = document.currentScript;
const root = script.parentElement;

const isMac = /mac/i.test(
      window.navigator.userAgentData?.platform ?? window.navigator.userAgent,
    );
root.querySelectorAll(".hide-mac").forEach(node => {node.classList.add(isMac ? "hidden" : "block")});
root.querySelectorAll(".show-mac").forEach(node => {node.classList.add(!isMac ? "hidden" : "block")});
})()</script></div></button><button class="theme rounded-full aspect-square border border-stone-700 dark:border-white hover:bg-neutral-100 border-solid overflow-hidden text-stone-700 dark:text-white hover:text-stone-500 dark:hover:text-neutral-800 w-8 h-8 mx-3" title="Toggle theme between light and dark mode." aria-label="Toggle theme between light and dark mode."><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="h-full w-full p-0.5 hidden dark:block"><path fill-rule="evenodd" d="M9.528 1.718a.75.75 0 0 1 .162.819A8.97 8.97 0 0 0 9 6a9 9 0 0 0 9 9 8.97 8.97 0 0 0 3.463-.69.75.75 0 0 1 .981.98 10.503 10.503 0 0 1-9.694 6.46c-5.799 0-10.5-4.7-10.5-10.5 0-4.368 2.667-8.112 6.46-9.694a.75.75 0 0 1 .818.162Z" clip-rule="evenodd"></path></svg><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-full w-full p-0.5 dark:hidden"><path stroke-linecap="round" stroke-linejoin="round" d="M12 3v2.25m6.364.386-1.591 1.591M21 12h-2.25m-.386 6.364-1.591-1.591M12 18.75V21m-4.773-4.227-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0Z"></path></svg></button><div class="block sm:hidden"></div><div class="hidden sm:block"></div></div></nav></div><div class="fixed xl:article-grid grid-gap xl:w-screen xl:pointer-events-none overflow-auto max-xl:min-w-[300px] hidden z-10" style="top:60px"><div class="pointer-events-auto xl:col-margin-left flex-col overflow-hidden hidden xl:flex"><div class="flex-grow py-6 overflow-y-auto"><nav aria-label="Navigation" class="overflow-y-hidden transition-opacity ml-3 xl:ml-0 mr-3 max-w-[350px] lg:hidden"><div class="w-full px-1 dark:text-white"></div></nav><div class="my-3 border-b-2 lg:hidden"></div><nav aria-label="Table of Contents" class="flex-grow overflow-y-hidden transition-opacity ml-3 xl:ml-0 mr-3 max-w-[350px]"><div class="w-full px-1 dark:text-white"><a title="Fundamentals of Numerical Computation" class="block break-words focus:outline outline-blue-200 outline-2 rounded p-2 my-1 rounded-lg hover:bg-slate-300/30 font-bold" href="/fnc/">FNC</a><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Preface" class="block break-words rounded py-2 grow cursor-pointer">Preface</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:Rbd8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:Rbd8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><a title="Introduction" class="block break-words focus:outline outline-blue-200 outline-2 rounded py-2 grow" href="/fnc/overview">Introduction</a><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:Rfd8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:Rfd8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><a title="Linear systems of equations" class="block break-words focus:outline outline-blue-200 outline-2 rounded py-2 grow" href="/fnc/overview-1">Linear systems of equations</a><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:Rjd8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:Rjd8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><a title="Overdetermined linear systems" class="block break-words focus:outline outline-blue-200 outline-2 rounded py-2 grow" href="/fnc/overview-2">Overdetermined linear systems</a><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:Rnd8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:Rnd8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><a title="Roots of nonlinear equations" class="block break-words focus:outline outline-blue-200 outline-2 rounded py-2 grow" href="/fnc/overview-3">Roots of nonlinear equations</a><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:Rrd8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:Rrd8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><a title="Piecewise interpolation" class="block break-words focus:outline outline-blue-200 outline-2 rounded py-2 grow" href="/fnc/overview-4">Piecewise interpolation</a><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:Rvd8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:Rvd8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><a title="Initial-value problems for ODEs" class="block break-words focus:outline outline-blue-200 outline-2 rounded py-2 grow" href="/fnc/overview-5">Initial-value problems for ODEs</a><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R13d8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R13d8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Appendices" class="block break-words rounded py-2 grow cursor-pointer">Appendices</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R17d8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R17d8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><a title="Index" class="block break-words focus:outline outline-blue-200 outline-2 rounded p-2 my-1 rounded-lg hover:bg-slate-300/30" href="/fnc/genindex">Index</a></div></nav></div><div class="flex-none py-6 transition-all duration-700 translate-y-6 opacity-0"><a class="flex mx-auto text-gray-700 w-fit hover:text-blue-700 dark:text-gray-200 dark:hover:text-blue-400" href="https://mystmd.org/made-with-myst" target="_blank" rel="noreferrer"><svg style="width:24px;height:24px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" stroke="none"><g id="icon"><path fill="currentColor" d="M23.8,54.8v-3.6l4.7-0.8V17.5l-4.7-0.8V13H36l13.4,31.7h0.2l13-31.7h12.6v3.6l-4.7,0.8v32.9l4.7,0.8v3.6h-15
          v-3.6l4.9-0.8V20.8H65L51.4,53.3h-3.8l-14-32.5h-0.1l0.2,17.4v12.1l5,0.8v3.6H23.8z"></path><path fill="#F37726" d="M47,86.9c0-5.9-3.4-8.8-10.1-8.8h-8.4c-5.2,0-9.4-1.3-12.5-3.8c-3.1-2.5-5.4-6.2-6.8-11l4.8-1.6
          c1.8,5.6,6.4,8.6,13.8,8.8h9.2c6.4,0,10.8,2.5,13.1,7.5c2.3-5,6.7-7.5,13.1-7.5h8.4c7.8,0,12.7-2.9,14.6-8.7l4.8,1.6
          c-1.4,4.9-3.6,8.6-6.8,11.1c-3.1,2.5-7.3,3.7-12.4,3.8H63c-6.7,0-10,2.9-10,8.8"></path></g></svg><span class="self-center ml-2 text-sm">Made with MyST</span></a></div></div></div><article class="article content article-grid grid-gap"><main class="article-grid subgrid-gap col-screen"><div class="hidden"></div><div id="skip-to-frontmatter" aria-label="article frontmatter" class="mb-8 pt-9"><div class="flex items-center h-6 mb-5 text-sm font-light"><div class="flex-grow"></div><a href="https://github.com/fncbook/fnc" title="GitHub Repository: fncbook/fnc" target="_blank" rel="noopener noreferrer" class="text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="inline-block mr-1 opacity-60 hover:opacity-100"><path d="M12 2.5c-5.4 0-9.8 4.4-9.8 9.7 0 4.3 2.8 8 6.7 9.2.5.1.7-.2.7-.5v-1.8c-2.4.5-3.1-.6-3.3-1.1-.1-.3-.6-1.1-1-1.4-.3-.2-.8-.6 0-.6s1.3.7 1.5 1c.9 1.5 2.3 1.1 2.8.8.1-.6.3-1.1.6-1.3-2.2-.2-4.4-1.1-4.4-4.8 0-1.1.4-1.9 1-2.6-.1-.2-.4-1.2.1-2.6 0 0 .8-.3 2.7 1 .8-.2 1.6-.3 2.4-.3.8 0 1.7.1 2.4.3 1.9-1.3 2.7-1 2.7-1 .5 1.3.2 2.3.1 2.6.6.7 1 1.5 1 2.6 0 3.7-2.3 4.6-4.4 4.8.4.3.7.9.7 1.8V21c0 .3.2.6.7.5 3.9-1.3 6.6-4.9 6.6-9.2 0-5.4-4.4-9.8-9.8-9.8z"></path></svg></a><div class="inline-block mr-1"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="inline-block"><title>Jupyter Notebook</title><path d="M20.2 1.7c0 .8-.5 1.4-1.3 1.5-.8 0-1.4-.5-1.5-1.3 0-.8.5-1.4 1.3-1.5.8-.1 1.5.5 1.5 1.3zM12 17.9c-3.7 0-7-1.3-8.7-3.3 1.8 4.8 7.1 7.3 11.9 5.5 2.5-.9 4.5-2.9 5.5-5.5-1.7 2-4.9 3.3-8.7 3.3zM12 5.1c3.7 0 7 1.3 8.7 3.3-1.8-4.8-7.1-7.3-11.9-5.5-2.5.9-4.5 2.9-5.5 5.5 1.7-2 5-3.3 8.7-3.3zM6.9 21.8c.1 1-.7 1.8-1.7 1.9-1 .1-1.8-.7-1.9-1.7 0-1 .7-1.8 1.7-1.9 1-.1 1.8.7 1.9 1.7zM3.7 4.6c-.6 0-1-.4-1-1s.4-1 1-1 1 .4 1 1c0 .5-.4 1-1 1z"></path></svg></div><div class="relative flex inline-block mx-1 grow-0" data-headlessui-state=""><button class="relative ml-2 -mr-1" id="headlessui-menu-button-:Rd4fop:" type="button" aria-haspopup="menu" aria-expanded="false" data-headlessui-state=""><span class="sr-only">Downloads</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem"><path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"></path></svg></button></div></div><h1 class="mb-0">Chapter 6</h1><header class="mt-4 not-prose"><div><span class="font-semibold text-sm inline-block text-comma"><button class="focus:shadow-[0_0_0_2px] focus:shadow-black outline-none hover:underline" aria-label="Author Details" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:R5kfop:" data-state="closed">Tobin A. Driscoll</button><a class="ml-1" href="mailto:driscoll@udel.edu" title="Tobin A. Driscoll &lt;driscoll@udel.edu&gt;" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1rem" height="1rem" class="inline-block text-gray-400 hover:text-blue-400 -translate-y-[0.1em]"><path d="M21.8 18c0 1.1-.9 2-1.9 2H4.2c-1.1 0-1.9-.9-1.9-2V9.9c0-.5.3-.7.8-.4l7.8 4.7c.7.4 1.7.4 2.4 0L21 9.5c.4-.2.8-.1.8.4V18z"></path><path d="M21.8 6c0-1.1-.9-2-1.9-2H4.2c-1.1 0-2 .9-2 2v.4c0 .5.3 1.1.8 1.3l8.5 5.1c.2.1.7.1.9 0l8.6-5c.4-.3.8-.9.8-1.3-.1-.1-.1-.5 0-.5z"></path></svg></a></span><span class="font-semibold text-sm inline-block"><button class="focus:shadow-[0_0_0_2px] focus:shadow-black outline-none hover:underline" aria-label="Author Details" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:R6kfop:" data-state="closed">Richard J. Braun</button></span></div></header></div><div class="block my-10 lg:sticky lg:z-10 lg:h-0 lg:pt-0 lg:my-0 lg:ml-10 lg:col-margin-right" style="top:60px"><nav></nav></div><div id="skip-to-article"></div><div id="yKK3tcK3xO" class="relative group/block article-grid subgrid-gap col-screen"><h2 id="functions" class="relative group"><span class="heading-text">Functions</span><a class="no-underline text-inherit hover:text-inherit px-2 font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#functions" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><details class="rounded-md my-5 shadow dark:shadow-2xl dark:shadow-neutral-900 overflow-hidden bg-gray-50 dark:bg-stone-800"><summary class="m-0 text-lg font-medium py-1 min-h-[2em] pl-3 cursor-pointer hover:shadow-[inset_0_0_0px_30px_#00000003] dark:hover:shadow-[inset_0_0_0px_30px_#FFFFFF03] bg-gray-100 dark:bg-slate-900"><span class="text-neutral-900 dark:text-white"><span class="block float-right text-sm font-thin text-neutral-700 dark:text-neutral-200"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="inline-block pl-2 mr-2 -translate-y-[1px] details-toggle transition-transform"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></span>Euler’s method for an initial-value problem</span></summary><div class="px-4 py-1 details-body"><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm bg-stone-200/10"><div class="flex flex-row pl-2 bg-white border-b dark:bg-slate-600 dark:border-slate-300"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="16px" height="16px" class="self-center flex-none inline-block text-gray-500 dark:text-gray-100"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m2.25 0H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"></path></svg><div class="self-center p-2 text-sm leading-3 prose text-slate-600 dark:text-white">euler.jl</div></div><pre class="block p-3 hljs" style="background-color:unset"><code style="display:inline-block;float:left;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;border-left:4px solid transparent"><span class="react-syntax-highlighter-line-number">1
</span><span class="react-syntax-highlighter-line-number">2
</span><span class="react-syntax-highlighter-line-number">3
</span><span class="react-syntax-highlighter-line-number">4
</span><span class="react-syntax-highlighter-line-number">5
</span><span class="react-syntax-highlighter-line-number">6
</span><span class="react-syntax-highlighter-line-number">7
</span><span class="react-syntax-highlighter-line-number">8
</span><span class="react-syntax-highlighter-line-number">9
</span><span class="react-syntax-highlighter-line-number">10
</span><span class="react-syntax-highlighter-line-number">11
</span><span class="react-syntax-highlighter-line-number">12
</span><span class="react-syntax-highlighter-line-number">13
</span><span class="react-syntax-highlighter-line-number">14
</span><span class="react-syntax-highlighter-line-number">15
</span><span class="react-syntax-highlighter-line-number">16
</span><span class="react-syntax-highlighter-line-number">17
</span><span class="react-syntax-highlighter-line-number">18
</span><span class="react-syntax-highlighter-line-number">19
</span><span class="react-syntax-highlighter-line-number">20
</span><span class="react-syntax-highlighter-line-number">21
</span></code><code class="language-julia" style="white-space:pre">&quot;&quot;&quot;
    euler(ivp,n)

Apply Euler&#x27;s method to solve the given IVP using `n` time steps.
Returns a vector of times and a vector of solution values.
&quot;&quot;&quot;
function euler(ivp,n)
    # Time discretization.
    a,b = ivp.tspan
    h = (b-a)/n
    t = [ a + i*h for i in 0:n ]

    # Initial condition and output setup.
    u = fill(float(ivp.u0),n+1)

    # The time stepping iteration.
    for i in 1:n
        u[i+1] = u[i] + h*ivp.f(u[i],ivp.p,t[i])
    end
    return t,u
end</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-[32px]" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><details class="my-5 shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-gray-50/10 dark:bg-stone-800 overflow-hidden rounded border-l-4 border-blue-500 dropdown"><summary class="m-0 font-medium py-1 flex min-w-0 text-lg text-blue-600 bg-blue-50 dark:bg-slate-900 cursor-pointer hover:shadow-[inset_0_0_0px_30px_#00000003] dark:hover:shadow-[inset_0_0_0px_30px_#FFFFFF03]"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="inline-block pl-2 mr-2 self-center flex-none text-blue-600"><path stroke-linecap="round" stroke-linejoin="round" d="m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"></path></svg><div class="text-neutral-900 dark:text-white grow self-center overflow-hidden break-words">About the code</div><div class="self-center flex-none text-sm font-thin text-neutral-700 dark:text-neutral-200"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="inline-block pl-2 mr-2 self-center flex-none transition-transform details-toggle"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></div></summary><div class="px-4 py-1 details-body"><p>The <code>ivp</code> input argument is an <code>ODEProblem</code>, like in <span data-state="closed"><a class="hover-link" href="/fnc/basics#demo-basics-first">Demo <!-- -->6.1.2</a></span>. It has fields <code>ivp.f</code>, <code>ivp.tspan</code>, <code>ivp.u0</code>, and <code>ivp.p</code> that fully define the problem. The outputs are vectors of the nodes and approximate solution values at those nodes.</p></div></details></div></details><details class="rounded-md my-5 shadow dark:shadow-2xl dark:shadow-neutral-900 overflow-hidden bg-gray-50 dark:bg-stone-800"><summary class="m-0 text-lg font-medium py-1 min-h-[2em] pl-3 cursor-pointer hover:shadow-[inset_0_0_0px_30px_#00000003] dark:hover:shadow-[inset_0_0_0px_30px_#FFFFFF03] bg-gray-100 dark:bg-slate-900"><span class="text-neutral-900 dark:text-white"><span class="block float-right text-sm font-thin text-neutral-700 dark:text-neutral-200"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="inline-block pl-2 mr-2 -translate-y-[1px] details-toggle transition-transform"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></span>Improved Euler method for an IVP</span></summary><div class="px-4 py-1 details-body"><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm bg-stone-200/10"><div class="flex flex-row pl-2 bg-white border-b dark:bg-slate-600 dark:border-slate-300"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="16px" height="16px" class="self-center flex-none inline-block text-gray-500 dark:text-gray-100"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m2.25 0H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"></path></svg><div class="self-center p-2 text-sm leading-3 prose text-slate-600 dark:text-white">ie2.jl</div></div><pre class="block p-3 hljs" style="background-color:unset"><code style="display:inline-block;float:left;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;border-left:4px solid transparent"><span class="react-syntax-highlighter-line-number">1
</span><span class="react-syntax-highlighter-line-number">2
</span><span class="react-syntax-highlighter-line-number">3
</span><span class="react-syntax-highlighter-line-number">4
</span><span class="react-syntax-highlighter-line-number">5
</span><span class="react-syntax-highlighter-line-number">6
</span><span class="react-syntax-highlighter-line-number">7
</span><span class="react-syntax-highlighter-line-number">8
</span><span class="react-syntax-highlighter-line-number">9
</span><span class="react-syntax-highlighter-line-number">10
</span><span class="react-syntax-highlighter-line-number">11
</span><span class="react-syntax-highlighter-line-number">12
</span><span class="react-syntax-highlighter-line-number">13
</span><span class="react-syntax-highlighter-line-number">14
</span><span class="react-syntax-highlighter-line-number">15
</span><span class="react-syntax-highlighter-line-number">16
</span><span class="react-syntax-highlighter-line-number">17
</span><span class="react-syntax-highlighter-line-number">18
</span><span class="react-syntax-highlighter-line-number">19
</span><span class="react-syntax-highlighter-line-number">20
</span><span class="react-syntax-highlighter-line-number">21
</span><span class="react-syntax-highlighter-line-number">22
</span><span class="react-syntax-highlighter-line-number">23
</span></code><code class="language-julia" style="white-space:pre">&quot;&quot;&quot;
    ie2(ivp,n)

Apply the Improved Euler method to solve the given IVP using `n`
time steps. Returns a vector of times and a vector of solution
values.
&quot;&quot;&quot;
function ie2(ivp,n)
    # Time discretization.
    a,b = ivp.tspan
    h = (b-a)/n
    t = [ a + i*h for i in 0:n ]

    # Initialize output.
    u = fill(float(ivp.u0),n+1)

    # Time stepping.
    for i in 1:n
        uhalf = u[i] + h/2*ivp.f(u[i],ivp.p,t[i]);
        u[i+1] = u[i] + h*ivp.f(uhalf,ivp.p,t[i]+h/2);
    end
    return t,u
end</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-[32px]" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div></div></details><details class="rounded-md my-5 shadow dark:shadow-2xl dark:shadow-neutral-900 overflow-hidden bg-gray-50 dark:bg-stone-800"><summary class="m-0 text-lg font-medium py-1 min-h-[2em] pl-3 cursor-pointer hover:shadow-[inset_0_0_0px_30px_#00000003] dark:hover:shadow-[inset_0_0_0px_30px_#FFFFFF03] bg-gray-100 dark:bg-slate-900"><span class="text-neutral-900 dark:text-white"><span class="block float-right text-sm font-thin text-neutral-700 dark:text-neutral-200"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="inline-block pl-2 mr-2 -translate-y-[1px] details-toggle transition-transform"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></span>Fourth-order Runge-Kutta for an IVP</span></summary><div class="px-4 py-1 details-body"><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm bg-stone-200/10"><div class="flex flex-row pl-2 bg-white border-b dark:bg-slate-600 dark:border-slate-300"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="16px" height="16px" class="self-center flex-none inline-block text-gray-500 dark:text-gray-100"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m2.25 0H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"></path></svg><div class="self-center p-2 text-sm leading-3 prose text-slate-600 dark:text-white">rk4.jl</div></div><pre class="block p-3 hljs" style="background-color:unset"><code style="display:inline-block;float:left;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;border-left:4px solid transparent"><span class="react-syntax-highlighter-line-number">1
</span><span class="react-syntax-highlighter-line-number">2
</span><span class="react-syntax-highlighter-line-number">3
</span><span class="react-syntax-highlighter-line-number">4
</span><span class="react-syntax-highlighter-line-number">5
</span><span class="react-syntax-highlighter-line-number">6
</span><span class="react-syntax-highlighter-line-number">7
</span><span class="react-syntax-highlighter-line-number">8
</span><span class="react-syntax-highlighter-line-number">9
</span><span class="react-syntax-highlighter-line-number">10
</span><span class="react-syntax-highlighter-line-number">11
</span><span class="react-syntax-highlighter-line-number">12
</span><span class="react-syntax-highlighter-line-number">13
</span><span class="react-syntax-highlighter-line-number">14
</span><span class="react-syntax-highlighter-line-number">15
</span><span class="react-syntax-highlighter-line-number">16
</span><span class="react-syntax-highlighter-line-number">17
</span><span class="react-syntax-highlighter-line-number">18
</span><span class="react-syntax-highlighter-line-number">19
</span><span class="react-syntax-highlighter-line-number">20
</span><span class="react-syntax-highlighter-line-number">21
</span><span class="react-syntax-highlighter-line-number">22
</span><span class="react-syntax-highlighter-line-number">23
</span><span class="react-syntax-highlighter-line-number">24
</span><span class="react-syntax-highlighter-line-number">25
</span><span class="react-syntax-highlighter-line-number">26
</span><span class="react-syntax-highlighter-line-number">27
</span></code><code class="language-julia" style="white-space:pre">&quot;&quot;&quot;
    rk4(ivp,n)

Apply the common Runge-Kutta 4th order method to solve the given
IVP using `n` time steps. Returns a vector of times and a vector of
solution values.
&quot;&quot;&quot;
function rk4(ivp,n)

    # Time discretization.
    a,b = ivp.tspan
    h = (b-a)/n
    t = [ a + i*h for i in 0:n ]

    # Initialize output.
    u = fill(float(ivp.u0),n+1)

    # Time stepping.
    for i in 1:n
        k₁ = h*ivp.f( u[i],      ivp.p, t[i]     )
        k₂ = h*ivp.f( u[i]+k₁/2, ivp.p, t[i]+h/2 )
        k₃ = h*ivp.f( u[i]+k₂/2, ivp.p, t[i]+h/2 )
        k₄ = h*ivp.f( u[i]+k₃,   ivp.p, t[i]+h   )
        u[i+1] = u[i] + (k₁ + 2(k₂+k₃) + k₄)/6
    end
    return t,u
end</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-[32px]" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div></div></details><details class="rounded-md my-5 shadow dark:shadow-2xl dark:shadow-neutral-900 overflow-hidden bg-gray-50 dark:bg-stone-800"><summary class="m-0 text-lg font-medium py-1 min-h-[2em] pl-3 cursor-pointer hover:shadow-[inset_0_0_0px_30px_#00000003] dark:hover:shadow-[inset_0_0_0px_30px_#FFFFFF03] bg-gray-100 dark:bg-slate-900"><span class="text-neutral-900 dark:text-white"><span class="block float-right text-sm font-thin text-neutral-700 dark:text-neutral-200"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="inline-block pl-2 mr-2 -translate-y-[1px] details-toggle transition-transform"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></span>Adaptive IVP solver based on embedded RK formulas</span></summary><div class="px-4 py-1 details-body"><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm bg-stone-200/10"><div class="flex flex-row pl-2 bg-white border-b dark:bg-slate-600 dark:border-slate-300"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="16px" height="16px" class="self-center flex-none inline-block text-gray-500 dark:text-gray-100"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m2.25 0H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"></path></svg><div class="self-center p-2 text-sm leading-3 prose text-slate-600 dark:text-white">rk23.jl</div></div><pre class="block p-3 hljs" style="background-color:unset"><code style="display:inline-block;float:left;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;border-left:4px solid transparent"><span class="react-syntax-highlighter-line-number">1
</span><span class="react-syntax-highlighter-line-number">2
</span><span class="react-syntax-highlighter-line-number">3
</span><span class="react-syntax-highlighter-line-number">4
</span><span class="react-syntax-highlighter-line-number">5
</span><span class="react-syntax-highlighter-line-number">6
</span><span class="react-syntax-highlighter-line-number">7
</span><span class="react-syntax-highlighter-line-number">8
</span><span class="react-syntax-highlighter-line-number">9
</span><span class="react-syntax-highlighter-line-number">10
</span><span class="react-syntax-highlighter-line-number">11
</span><span class="react-syntax-highlighter-line-number">12
</span><span class="react-syntax-highlighter-line-number">13
</span><span class="react-syntax-highlighter-line-number">14
</span><span class="react-syntax-highlighter-line-number">15
</span><span class="react-syntax-highlighter-line-number">16
</span><span class="react-syntax-highlighter-line-number">17
</span><span class="react-syntax-highlighter-line-number">18
</span><span class="react-syntax-highlighter-line-number">19
</span><span class="react-syntax-highlighter-line-number">20
</span><span class="react-syntax-highlighter-line-number">21
</span><span class="react-syntax-highlighter-line-number">22
</span><span class="react-syntax-highlighter-line-number">23
</span><span class="react-syntax-highlighter-line-number">24
</span><span class="react-syntax-highlighter-line-number">25
</span><span class="react-syntax-highlighter-line-number">26
</span><span class="react-syntax-highlighter-line-number">27
</span><span class="react-syntax-highlighter-line-number">28
</span><span class="react-syntax-highlighter-line-number">29
</span><span class="react-syntax-highlighter-line-number">30
</span><span class="react-syntax-highlighter-line-number">31
</span><span class="react-syntax-highlighter-line-number">32
</span><span class="react-syntax-highlighter-line-number">33
</span><span class="react-syntax-highlighter-line-number">34
</span><span class="react-syntax-highlighter-line-number">35
</span><span class="react-syntax-highlighter-line-number">36
</span><span class="react-syntax-highlighter-line-number">37
</span><span class="react-syntax-highlighter-line-number">38
</span><span class="react-syntax-highlighter-line-number">39
</span><span class="react-syntax-highlighter-line-number">40
</span><span class="react-syntax-highlighter-line-number">41
</span><span class="react-syntax-highlighter-line-number">42
</span><span class="react-syntax-highlighter-line-number">43
</span><span class="react-syntax-highlighter-line-number">44
</span><span class="react-syntax-highlighter-line-number">45
</span><span class="react-syntax-highlighter-line-number">46
</span><span class="react-syntax-highlighter-line-number">47
</span></code><code class="language-julia" style="white-space:pre">&quot;&quot;&quot;
    rk23(ivp,tol)

Apply an adaptive embedded RK formula pair to solve given IVP with
estimated error `tol`. Returns a vector of times and a vector of
solution values.
&quot;&quot;&quot;
function rk23(ivp,tol)
    # Initialize for the first time step.
    a,b = ivp.tspan
    t = [a]
    u = [float(ivp.u0)];   i = 1;
    h = 0.5*tol^(1/3)
    s₁ = ivp.f(ivp.u0,ivp.p,a)

    # Time stepping.
    while t[i] &lt; b
        # Detect underflow of the step size.
        if t[i]+h == t[i]
            @warn &quot;Stepsize too small near t=$(t[i])&quot;
            break  # quit time stepping loop
        end

        # New RK stages.
        s₂ = ivp.f( u[i]+(h/2)*s₁,   ivp.p, t[i]+h/2   )
        s₃ = ivp.f( u[i]+(3h/4)*s₂, ivp.p, t[i]+3h/4 )
        unew3 = u[i] + h*(2s₁  + 3s₂ + 4s₃)/9   # 3rd order solution
        s₄ = ivp.f( unew3, ivp.p, t[i]+h )
        err = h*(-5s₁/72 + s₂/12 + s₃/9 - s₄/8)  # 2nd/3rd difference
        E = norm(err,Inf)                         # error estimate
        maxerr = tol*(1 + norm(u[i],Inf))     # relative/absolute blend

        # Accept the proposed step?
        if E &lt; maxerr     # yes
            push!(t,t[i]+h)
            push!(u,unew3)
            i += 1
            s₁ = s₄       # use FSAL property
        end

        # Adjust step size.
        q = 0.8*(maxerr/E)^(1/3)   # conservative optimal step factor
        q = min(q,4)               # limit stepsize growth
        h = min(q*h,b-t[i])        # don&#x27;t step past the end
    end
    return t,u
end</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-[32px]" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><details class="my-5 shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-gray-50/10 dark:bg-stone-800 overflow-hidden rounded border-l-4 border-blue-500 dropdown"><summary class="m-0 font-medium py-1 flex min-w-0 text-lg text-blue-600 bg-blue-50 dark:bg-slate-900 cursor-pointer hover:shadow-[inset_0_0_0px_30px_#00000003] dark:hover:shadow-[inset_0_0_0px_30px_#FFFFFF03]"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="inline-block pl-2 mr-2 self-center flex-none text-blue-600"><path stroke-linecap="round" stroke-linejoin="round" d="m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"></path></svg><div class="text-neutral-900 dark:text-white grow self-center overflow-hidden break-words">About the code</div><div class="self-center flex-none text-sm font-thin text-neutral-700 dark:text-neutral-200"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="inline-block pl-2 mr-2 self-center flex-none transition-transform details-toggle"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></div></summary><div class="px-4 py-1 details-body"><p>The check <code>t[i]+h == t[i]</code>on line 19 is to detect when <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi></mrow><annotation encoding="application/x-tex">h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">h</span></span></span></span></span> has become so small that it no longer changes the floating-point value of <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">t_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7651em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span>. This may be a sign that the underlying exact solution has a singularity near <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>=</mo><msub><mi>t</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">t=t_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7651em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span>, but in any case, the solver must halt by using a <code>break</code> statement to exit the loop.</p><p>On line 30, we use a combination of absolute and relative tolerances to judge the acceptability of a solution value, as in <span data-state="closed"><a class="hover-link" href="/fnc/adaptive#absreltolerance">(<!-- -->5.7.6<!-- -->)</a></span>. In lines 41--43 we underestimate the step factor <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi></mrow><annotation encoding="application/x-tex">q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span></span></span></span></span> a bit and prevent a huge increase in the step size, since a rejected step is expensive, and then we make sure that our final step doesn’t take us past the end of the domain.</p><p>Finally, line 37 exploits a subtle property of the BS23 formula called <em>first same as last</em> (FSAL).
While <span data-state="closed"><a class="hover-link" href="/fnc/adaptive-rk#bs23">(<!-- -->6.5.5<!-- -->)</a></span> calls for four stages to find the paired second- and third-order estimates, the final stage computed in stepping from <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">t_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7651em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> to <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">t_{i+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8234em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span></span> is identical to the first stage needed to step from <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">t_{i+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8234em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span></span> to <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mrow><mi>i</mi><mo>+</mo><mn>2</mn></mrow></msub></mrow><annotation encoding="application/x-tex">t_{i+2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8234em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span></span>. By repurposing <code>s₄</code> as <code>s₁</code> for the next pass, one of the stage evaluations comes for free, and only three evaluations of <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi></mrow><annotation encoding="application/x-tex">f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span></span></span></span></span> are needed per successful step.</p></div></details></div></details><details class="rounded-md my-5 shadow dark:shadow-2xl dark:shadow-neutral-900 overflow-hidden bg-gray-50 dark:bg-stone-800"><summary class="m-0 text-lg font-medium py-1 min-h-[2em] pl-3 cursor-pointer hover:shadow-[inset_0_0_0px_30px_#00000003] dark:hover:shadow-[inset_0_0_0px_30px_#FFFFFF03] bg-gray-100 dark:bg-slate-900"><span class="text-neutral-900 dark:text-white"><span class="block float-right text-sm font-thin text-neutral-700 dark:text-neutral-200"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="inline-block pl-2 mr-2 -translate-y-[1px] details-toggle transition-transform"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></span>4th-order Adams–Bashforth formula for an IVP</span></summary><div class="px-4 py-1 details-body"><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm bg-stone-200/10"><div class="flex flex-row pl-2 bg-white border-b dark:bg-slate-600 dark:border-slate-300"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="16px" height="16px" class="self-center flex-none inline-block text-gray-500 dark:text-gray-100"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m2.25 0H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"></path></svg><div class="self-center p-2 text-sm leading-3 prose text-slate-600 dark:text-white">ab4.jl</div></div><pre class="block p-3 hljs" style="background-color:unset"><code style="display:inline-block;float:left;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;border-left:4px solid transparent"><span class="react-syntax-highlighter-line-number">1
</span><span class="react-syntax-highlighter-line-number">2
</span><span class="react-syntax-highlighter-line-number">3
</span><span class="react-syntax-highlighter-line-number">4
</span><span class="react-syntax-highlighter-line-number">5
</span><span class="react-syntax-highlighter-line-number">6
</span><span class="react-syntax-highlighter-line-number">7
</span><span class="react-syntax-highlighter-line-number">8
</span><span class="react-syntax-highlighter-line-number">9
</span><span class="react-syntax-highlighter-line-number">10
</span><span class="react-syntax-highlighter-line-number">11
</span><span class="react-syntax-highlighter-line-number">12
</span><span class="react-syntax-highlighter-line-number">13
</span><span class="react-syntax-highlighter-line-number">14
</span><span class="react-syntax-highlighter-line-number">15
</span><span class="react-syntax-highlighter-line-number">16
</span><span class="react-syntax-highlighter-line-number">17
</span><span class="react-syntax-highlighter-line-number">18
</span><span class="react-syntax-highlighter-line-number">19
</span><span class="react-syntax-highlighter-line-number">20
</span><span class="react-syntax-highlighter-line-number">21
</span><span class="react-syntax-highlighter-line-number">22
</span><span class="react-syntax-highlighter-line-number">23
</span><span class="react-syntax-highlighter-line-number">24
</span><span class="react-syntax-highlighter-line-number">25
</span><span class="react-syntax-highlighter-line-number">26
</span><span class="react-syntax-highlighter-line-number">27
</span><span class="react-syntax-highlighter-line-number">28
</span><span class="react-syntax-highlighter-line-number">29
</span><span class="react-syntax-highlighter-line-number">30
</span><span class="react-syntax-highlighter-line-number">31
</span><span class="react-syntax-highlighter-line-number">32
</span></code><code class="language-julia" style="white-space:pre">&quot;&quot;&quot;
    ab4(ivp,n)

Apply the Adams-Bashforth 4th order method to solve the given IVP
using `n` time steps. Returns a vector of times and a vector of
solution values.
&quot;&quot;&quot;
function ab4(ivp,n)
    # Time discretization.
    a,b = ivp.tspan
    h = (b-a)/n
    t = [ a + i*h for i in 0:n ]

    # Constants in the AB4 method.
    k = 4;   σ = [55,-59,37,-9]/24;

    # Find starting values by RK4.
    u = fill(float(ivp.u0),n+1)
    rkivp = ODEProblem(ivp.f,ivp.u0,(a,a+(k-1)*h),ivp.p)
    ts,us = rk4(rkivp,k-1)
    u[1:k] .= us

    # Compute history of u&#x27; values, from newest to oldest.
    f = [ ivp.f(u[k-i],ivp.p,t[k-i]) for i in 1:k-1  ]

    # Time stepping.
    for i in k:n
        f = [ ivp.f(u[i],ivp.p,t[i]), f[1:k-1]... ]   # new value of du/dt
        u[i+1] = u[i] + h*sum(f[j]*σ[j] for j in 1:k)  # advance a step
    end
    return t,u
end</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-[32px]" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><details class="my-5 shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-gray-50/10 dark:bg-stone-800 overflow-hidden rounded border-l-4 border-blue-500 dropdown"><summary class="m-0 font-medium py-1 flex min-w-0 text-lg text-blue-600 bg-blue-50 dark:bg-slate-900 cursor-pointer hover:shadow-[inset_0_0_0px_30px_#00000003] dark:hover:shadow-[inset_0_0_0px_30px_#FFFFFF03]"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="inline-block pl-2 mr-2 self-center flex-none text-blue-600"><path stroke-linecap="round" stroke-linejoin="round" d="m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"></path></svg><div class="text-neutral-900 dark:text-white grow self-center overflow-hidden break-words">About the code</div><div class="self-center flex-none text-sm font-thin text-neutral-700 dark:text-neutral-200"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="inline-block pl-2 mr-2 self-center flex-none transition-transform details-toggle"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></div></summary><div class="px-4 py-1 details-body"><p>Line 15 sets <code>σ</code> to be the coefficients of the generating polynomial <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>σ</mi><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\sigma(z)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mclose">)</span></span></span></span></span> of AB4. Lines 19--21 set up the IVP over the time interval <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>≤</mo><mi>t</mi><mo>≤</mo><mi>a</mi><mo>+</mo><mn>3</mn><mi>h</mi></mrow><annotation encoding="application/x-tex">a \le t \le a+3 h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em;"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord">3</span><span class="mord mathnormal">h</span></span></span></span></span>, call <code>rk4</code> to solve it using the step size <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi></mrow><annotation encoding="application/x-tex">h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">h</span></span></span></span></span>, and use the result to fill the first four values of the solution. Then line 24 computes the vector <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><msub><mi>f</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>f</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>f</mi><mn>0</mn></msub><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[f_2,f_1,f_0]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span></span>.</p><p>Line 28 computes <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>f</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">f_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span>, based on the most recent solution value and time. That goes into the first spot of <code>f</code>, followed by the three values that were previously most recent. These are the four values that appear in <span data-state="closed"><a class="hover-link" href="/fnc/implicit#ab4">(<!-- -->6.7.1<!-- -->)</a></span>. Each particular <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>f</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">f_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> value starts at the front of <code>f</code>, moves through each position in the vector over three iterations, and then is forgotten.</p></div></details></div></details><details class="rounded-md my-5 shadow dark:shadow-2xl dark:shadow-neutral-900 overflow-hidden bg-gray-50 dark:bg-stone-800"><summary class="m-0 text-lg font-medium py-1 min-h-[2em] pl-3 cursor-pointer hover:shadow-[inset_0_0_0px_30px_#00000003] dark:hover:shadow-[inset_0_0_0px_30px_#FFFFFF03] bg-gray-100 dark:bg-slate-900"><span class="text-neutral-900 dark:text-white"><span class="block float-right text-sm font-thin text-neutral-700 dark:text-neutral-200"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="inline-block pl-2 mr-2 -translate-y-[1px] details-toggle transition-transform"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></span>2nd-order Adams–Moulton (trapezoid) formula for an IVP</span></summary><div class="px-4 py-1 details-body"><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm bg-stone-200/10"><div class="flex flex-row pl-2 bg-white border-b dark:bg-slate-600 dark:border-slate-300"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="16px" height="16px" class="self-center flex-none inline-block text-gray-500 dark:text-gray-100"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m2.25 0H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"></path></svg><div class="self-center p-2 text-sm leading-3 prose text-slate-600 dark:text-white">am2.jl</div></div><pre class="block p-3 hljs" style="background-color:unset"><code style="display:inline-block;float:left;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;border-left:4px solid transparent"><span class="react-syntax-highlighter-line-number">1
</span><span class="react-syntax-highlighter-line-number">2
</span><span class="react-syntax-highlighter-line-number">3
</span><span class="react-syntax-highlighter-line-number">4
</span><span class="react-syntax-highlighter-line-number">5
</span><span class="react-syntax-highlighter-line-number">6
</span><span class="react-syntax-highlighter-line-number">7
</span><span class="react-syntax-highlighter-line-number">8
</span><span class="react-syntax-highlighter-line-number">9
</span><span class="react-syntax-highlighter-line-number">10
</span><span class="react-syntax-highlighter-line-number">11
</span><span class="react-syntax-highlighter-line-number">12
</span><span class="react-syntax-highlighter-line-number">13
</span><span class="react-syntax-highlighter-line-number">14
</span><span class="react-syntax-highlighter-line-number">15
</span><span class="react-syntax-highlighter-line-number">16
</span><span class="react-syntax-highlighter-line-number">17
</span><span class="react-syntax-highlighter-line-number">18
</span><span class="react-syntax-highlighter-line-number">19
</span><span class="react-syntax-highlighter-line-number">20
</span><span class="react-syntax-highlighter-line-number">21
</span><span class="react-syntax-highlighter-line-number">22
</span><span class="react-syntax-highlighter-line-number">23
</span><span class="react-syntax-highlighter-line-number">24
</span><span class="react-syntax-highlighter-line-number">25
</span><span class="react-syntax-highlighter-line-number">26
</span><span class="react-syntax-highlighter-line-number">27
</span></code><code class="language-julia" style="white-space:pre">&quot;&quot;&quot;
    am2(ivp,n)

Apply the Adams-Moulton 2nd order method to solve given IVP using
`n` time steps. Returns a vector of times and a vector of
solution values.
&quot;&quot;&quot;
function am2(ivp,n)
    # Time discretization.
    a,b = ivp.tspan
    h = (b-a)/n
    t = [ a + i*h for i in 0:n ]

    # Initialize output.
    u = fill(float(ivp.u0),n+1)

    # Time stepping.
    for i in 1:n
        # Data that does not depend on the new value.
        known = u[i] + h/2*ivp.f(u[i],ivp.p,t[i])
        # Find a root for the new value.
        g = z -&gt; z - h/2*ivp.f(z,ivp.p,t[i+1]) - known
        unew = levenberg(g,known)
        u[i+1] = unew[end]
    end
    return t,u
end</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-[32px]" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><details class="my-5 shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-gray-50/10 dark:bg-stone-800 overflow-hidden rounded border-l-4 border-blue-500 dropdown"><summary class="m-0 font-medium py-1 flex min-w-0 text-lg text-blue-600 bg-blue-50 dark:bg-slate-900 cursor-pointer hover:shadow-[inset_0_0_0px_30px_#00000003] dark:hover:shadow-[inset_0_0_0px_30px_#FFFFFF03]"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="inline-block pl-2 mr-2 self-center flex-none text-blue-600"><path stroke-linecap="round" stroke-linejoin="round" d="m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"></path></svg><div class="text-neutral-900 dark:text-white grow self-center overflow-hidden break-words">About the code</div><div class="self-center flex-none text-sm font-thin text-neutral-700 dark:text-neutral-200"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="inline-block pl-2 mr-2 self-center flex-none transition-transform details-toggle"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></div></summary><div class="px-4 py-1 details-body"><p>Lines 22-23 define the function <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">g</mi></mrow><annotation encoding="application/x-tex">\mathbf{g}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6389em;vertical-align:-0.1944em;"></span><span class="mord mathbf" style="margin-right:0.01597em;">g</span></span></span></span></span> and call <code>levenberg</code> to find the new solution value, using an Euler half-step as its starting value. A robust code would have to intercept the case where <code>levenberg</code> fails to converge, but we have ignored this issue for the sake of brevity.</p></div></details></div></details><h2 id="examples" class="relative group"><span class="heading-text">Examples</span><a class="no-underline text-inherit hover:text-inherit px-2 font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#examples" title="Link to this Section" aria-label="Link to this Section">¶</a></h2></div><div id="cWHpxJOw3u" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-julia" style="white-space:pre">import Pkg; Pkg.activate(&quot;/Users/driscoll/Documents/GitHub/fnc&quot;)
using FundamentalsNumericalComputation
FNC.init_format()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="n5IyIQLzhtxi71LHzBJ_9" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5 hidden"><div><pre class="text-sm font-thin font-system"><code><span style="color:rgb(0, 187, 0);font-weight:bold">  Activating</span><span> </span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>project at `~/Documents/GitHub/fnc`
</span><span style="color:rgb(0, 187, 187);font-weight:bold">[ </span><span style="color:rgb(0, 187, 187);font-weight:bold">Info: </span><span>verify download of index files...
</span><span style="color:rgb(0, 187, 187);font-weight:bold">[ </span><span style="color:rgb(0, 187, 187);font-weight:bold">Info: </span><span>reading database
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>EOFError(</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>)
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span style="color:rgb(187, 187, 0);font-weight:bold">┌ </span><span style="color:rgb(187, 187, 0);font-weight:bold">Warning: </span><span>recreating database file
</span><span style="color:rgb(187, 187, 0);font-weight:bold">└ </span><span style="color:rgb(85, 85, 85)">@ MatrixDepot ~/.julia/packages/MatrixDepot/4S7Oa/src/download.jl:59</span><span>
</span><span style="color:rgb(0, 187, 187);font-weight:bold">[ </span><span style="color:rgb(0, 187, 187);font-weight:bold">Info: </span><span>reading index files
</span><span style="color:rgb(0, 187, 187);font-weight:bold">[ </span><span style="color:rgb(0, 187, 187);font-weight:bold">Info: </span><span>adding metadata...
</span><span style="color:rgb(0, 187, 187);font-weight:bold">[ </span><span style="color:rgb(0, 187, 187);font-weight:bold">Info: </span><span>adding svd data...
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span style="color:rgb(0, 187, 187);font-weight:bold">[ </span><span style="color:rgb(0, 187, 187);font-weight:bold">Info: </span><span>writing database
</span><span style="color:rgb(187, 187, 0);font-weight:bold">┌ </span><span style="color:rgb(187, 187, 0);font-weight:bold">Warning: </span><span>exception during initialization: &#x27;KeyError(MatrixDepot)&#x27;
</span><span style="color:rgb(187, 187, 0);font-weight:bold">└ </span><span style="color:rgb(85, 85, 85)">@ MatrixDepot ~/.julia/packages/MatrixDepot/4S7Oa/src/MatrixDepot.jl:125</span><span>
</span></code></pre></div></div></div><div id="h55rhGUHWz" class="relative group/block article-grid subgrid-gap col-screen"><h3 id="section-6-1" class="relative group"><span class="heading-text">Section 6.1</span><a class="no-underline text-inherit hover:text-inherit px-2 font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#section-6-1" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><details class="rounded-md my-5 shadow dark:shadow-2xl dark:shadow-neutral-900 overflow-hidden bg-gray-50 dark:bg-stone-800"><summary class="m-0 text-lg font-medium py-1 min-h-[2em] pl-3 cursor-pointer hover:shadow-[inset_0_0_0px_30px_#00000003] dark:hover:shadow-[inset_0_0_0px_30px_#FFFFFF03] bg-gray-100 dark:bg-slate-900"><span class="text-neutral-900 dark:text-white"><span class="block float-right text-sm font-thin text-neutral-700 dark:text-neutral-200"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="inline-block pl-2 mr-2 -translate-y-[1px] details-toggle transition-transform"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></span>Solving an IVP</span></summary><div class="px-4 py-1 details-body"><p>The <code>DifferentialEquations</code> package offers solvers for IVPs. Let’s use it to define and solve an initial-value problem for <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>u</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo>=</mo><mi>sin</mi><mo>⁡</mo><mo stretchy="false">[</mo><mo stretchy="false">(</mo><mi>u</mi><mo>+</mo><mi>t</mi><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">u&#x27;=\sin[(u+t)^2]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7519em;"></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">sin</span><span class="mopen">[(</span><span class="mord mathnormal">u</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal">t</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span></span> over <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>∈</mo><mo stretchy="false">[</mo><mn>0</mn><mo separator="true">,</mo><mn>4</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">t \in [0,4]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6542em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">4</span><span class="mclose">]</span></span></span></span></span>, such that <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo><mo>=</mo><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">u(0)=-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">u</span><span class="mopen">(</span><span class="mord">0</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">−</span><span class="mord">1</span></span></span></span></span>.</p><div class="myst-grid grid my-5 sm:grid-cols-1 md:grid-cols-1 lg:grid-cols-2 xl:grid-cols-2 gap-4"><p>Because many practical problems come with parameters that are fixed within an instance but varied from one instance to another, the syntax for IVPs includes a input argument <code>p</code> that stays fixed throughout the solution. Here we don’t want to use that argument, but it must be in the definition for the solver to work.</p><div class="my-5 rounded shadow dark:shadow-neutral-800 overflow-hidden border border-gray-100 dark:border-gray-800 flex flex-col"><div class="flex-grow px-4 py-2"><p>To create an initial-value problem for <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">u(t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">u</span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span></span></span></span></span>, you must supply a function that computes <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>u</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">u&#x27;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7519em;"></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span>, an initial value for <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">u</span></span></span></span></span>, and the endpoints of the interval for <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span></span>. The <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span></span> interval should be defined as <code>(a,b)</code>, where at least one of the values is a float.</p></div></div></div><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-julia" style="white-space:pre">f(u, p, t) = sin((t + u)^2)     # defines du/dt, must include p argument
u₀ = -1.0                       # initial value
tspan = (0.0, 4.0)               # t interval</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="nwCxq1-WiOBRJfMf9jb8G" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>(0.0, 4.0)</span></code></div></div></div><p>With the data above we define an IVP problem object and then solve it. Here we tell the solver to use the <code>Tsit5</code> method, which is a good first choice for most problems.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-julia" style="white-space:pre">ivp = ODEProblem(f, u₀, tspan)
sol = solve(ivp, Tsit5());</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="C7O4M5HeQ04bjG-ZWY8p6" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><p>The resulting solution object can be shown using <code>plot</code>.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-julia" style="white-space:pre">plot(sol, label=&quot;solution&quot;, legend=:bottom,
    xlabel=&quot;t&quot;, ylabel=L&quot;u(t)&quot;, title=L&quot;u&#x27;=\sin((t+u)^2)&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="_RW3BnJKkW0V8oKpllbAQ" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><p>The solution also acts like any callable function that can be evaluated at different values of <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span></span>.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-julia" style="white-space:pre">@show sol(1.0);</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="lPQydevs2qNlj2cLOcFqp" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>sol(1.0) = -0.7903205813665345
</span></code></pre></div></div></div><p>Under the hood, the solution object holds some information about how the values and plot are produced:</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-julia" style="white-space:pre">[sol.t sol.u]</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="eKynLg6hfOznJJS0oSsZ4" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>15×2 Matrix{Float64}:
 0.0        -1.0
 0.0867807  -0.93483
 0.241035   -0.856617
 0.464665   -0.805668
 0.696832   -0.793614
 1.00862    -0.789925
 1.37461    -0.718601
 1.70407    -0.476837
 1.93572    -0.29033
 2.17184    -0.294994
 2.4843     -0.483948
 2.69425    -0.654121
 3.27049    -1.1783
 3.62534    -1.51729
 4.0        -1.88086</span></code></div></div></div><p>The solver initially finds approximate values of the solution (second column above) at some automatically chosen times (first column above). To compute the solution at other times, the object performs an interpolation on those values. This chapter is about how the discrete <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span></span> and <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">u</span></span></span></span></span> values are computed. For now, just note how we can extract them from the solution object.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-julia" style="white-space:pre">scatter!(sol.t, sol.u, label=&quot;discrete values&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="EDwd_nQKWoZSe7BtB8BgI" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div></div></details><details class="rounded-md my-5 shadow dark:shadow-2xl dark:shadow-neutral-900 overflow-hidden bg-gray-50 dark:bg-stone-800"><summary class="m-0 text-lg font-medium py-1 min-h-[2em] pl-3 cursor-pointer hover:shadow-[inset_0_0_0px_30px_#00000003] dark:hover:shadow-[inset_0_0_0px_30px_#FFFFFF03] bg-gray-100 dark:bg-slate-900"><span class="text-neutral-900 dark:text-white"><span class="block float-right text-sm font-thin text-neutral-700 dark:text-neutral-200"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="inline-block pl-2 mr-2 -translate-y-[1px] details-toggle transition-transform"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></span>Finite-time singularity</span></summary><div class="px-4 py-1 details-body"><p>The equation <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>u</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo>=</mo><mo stretchy="false">(</mo><mi>u</mi><mo>+</mo><mi>t</mi><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">u&#x27;=(u+t)^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7519em;"></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal">t</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span> gives us some trouble.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-julia" style="white-space:pre">f(u, p, t) = (t + u)^2

ivp = ODEProblem(f, 1.0, (0.0, 1.0))
sol = solve(ivp, Tsit5());</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="mCPyUXpVWByA1z2M65Ksy" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span style="color:rgb(187, 187, 0);font-weight:bold">┌ </span><span style="color:rgb(187, 187, 0);font-weight:bold">Warning: </span><span>At t=0.7853839417697203, dt was forced below floating point epsilon 1.1102230246251565e-16, and step error estimate = 42.16290621054672. Aborting. There is either an error in your model specification or the true solution is unstable (or the true solution can not be represented in the precision of Float64).
</span><span style="color:rgb(187, 187, 0);font-weight:bold">└ </span><span style="color:rgb(85, 85, 85)">@ SciMLBase ~/.julia/packages/SciMLBase/ZyZAV/src/integrator_interface.jl:623</span><span>
</span></code></pre></div></div></div><p>The warning message we received can mean that there is a bug in the formulation of the problem. But if everything has been done correctly, it suggests that the solution may not exist past the indicated time. This is a possibility in nonlinear ODEs.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-julia" style="white-space:pre">plot(sol, label=&quot;&quot;,
    xlabel=L&quot;t&quot;, yaxis=(:log10, L&quot;u(t)&quot;), title=&quot;Finite-time blowup&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="9iqhJgfxW_pbX5YRJWu9t" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div></div></details><details class="rounded-md my-5 shadow dark:shadow-2xl dark:shadow-neutral-900 overflow-hidden bg-gray-50 dark:bg-stone-800"><summary class="m-0 text-lg font-medium py-1 min-h-[2em] pl-3 cursor-pointer hover:shadow-[inset_0_0_0px_30px_#00000003] dark:hover:shadow-[inset_0_0_0px_30px_#FFFFFF03] bg-gray-100 dark:bg-slate-900"><span class="text-neutral-900 dark:text-white"><span class="block float-right text-sm font-thin text-neutral-700 dark:text-neutral-200"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="inline-block pl-2 mr-2 -translate-y-[1px] details-toggle transition-transform"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></span>Conditioning of an IVP</span></summary><div class="px-4 py-1 details-body"><p>Consider the ODEs <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>u</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo>=</mo><mi>u</mi></mrow><annotation encoding="application/x-tex">u&#x27;=u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7519em;"></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">u</span></span></span></span></span> and <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>u</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo>=</mo><mo>−</mo><mi>u</mi></mrow><annotation encoding="application/x-tex">u&#x27;=-u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7519em;"></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord">−</span><span class="mord mathnormal">u</span></span></span></span></span>. In each case we compute <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∂</mi><mi>f</mi><mi mathvariant="normal">/</mi><mi mathvariant="normal">∂</mi><mi>u</mi><mo>=</mo><mo>±</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\partial f/\partial u = \pm 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord">/</span><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal">u</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">±</span><span class="mord">1</span></span></span></span></span>, so the condition number bound from <span data-state="closed"><a class="hover-link" href="/fnc/basics#theorem-depic">Theorem <!-- -->6.1.2</a></span> is <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>e</mi><mrow><mi>b</mi><mo>−</mo><mi>a</mi></mrow></msup></mrow><annotation encoding="application/x-tex">e^{b-a}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8491em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">b</span><span class="mbin mtight">−</span><span class="mord mathnormal mtight">a</span></span></span></span></span></span></span></span></span></span></span></span></span> in both problems. However, they behave quite differently. In the case of exponential growth, <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>u</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo>=</mo><mi>u</mi></mrow><annotation encoding="application/x-tex">u&#x27;=u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7519em;"></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">u</span></span></span></span></span>, the bound is the actual condition number.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-julia" style="white-space:pre">t = range(0, 3, length=800)
u = @. exp(t) * 1
lower, upper = @. exp(t) * 0.7, @. exp(t) * 1.3
plot(t, u, l=:black, ribbon=(lower, upper),
    leg=:none, xlabel=L&quot;t&quot;, ylabel=L&quot;u(t)&quot;,
    title=&quot;Exponential divergence of solutions&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="hB-caMCd63gsXMjiisk7Z" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><p>But with <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>u</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo>=</mo><mo>−</mo><mi>u</mi></mrow><annotation encoding="application/x-tex">u&#x27;=-u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7519em;"></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord">−</span><span class="mord mathnormal">u</span></span></span></span></span>, solutions actually get closer together with time.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-julia" style="white-space:pre">u = @. exp(-t) * 1
lower, upper = @. exp(-t) * 0.7, @. exp(-t) * 1.3
plot(t, u, l=:black, ribbon=(lower, upper),
    leg=:none, xlabel=L&quot;t&quot;, ylabel=L&quot;u(t)&quot;,
    title=&quot;Exponential convergence of solutions&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="Bolpafl5FFpRpXaJSKJBJ" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><p>In this case the actual condition number is one, because the initial difference between solutions is the largest over all time. Hence the exponentially growing bound <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>e</mi><mrow><mi>b</mi><mo>−</mo><mi>a</mi></mrow></msup></mrow><annotation encoding="application/x-tex">e^{b-a}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8491em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">b</span><span class="mbin mtight">−</span><span class="mord mathnormal mtight">a</span></span></span></span></span></span></span></span></span></span></span></span></span> is a gross overestimate.</p></div></details><h3 id="section-6-2" class="relative group"><span class="heading-text">Section 6.2</span><a class="no-underline text-inherit hover:text-inherit px-2 font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#section-6-2" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><details class="rounded-md my-5 shadow dark:shadow-2xl dark:shadow-neutral-900 overflow-hidden bg-gray-50 dark:bg-stone-800"><summary class="m-0 text-lg font-medium py-1 min-h-[2em] pl-3 cursor-pointer hover:shadow-[inset_0_0_0px_30px_#00000003] dark:hover:shadow-[inset_0_0_0px_30px_#FFFFFF03] bg-gray-100 dark:bg-slate-900"><span class="text-neutral-900 dark:text-white"><span class="block float-right text-sm font-thin text-neutral-700 dark:text-neutral-200"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="inline-block pl-2 mr-2 -translate-y-[1px] details-toggle transition-transform"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></span>Convergence of Euler’s method</span></summary><div class="px-4 py-1 details-body"><p>We consider the IVP <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>u</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo>=</mo><mi>sin</mi><mo>⁡</mo><mo stretchy="false">[</mo><mo stretchy="false">(</mo><mi>u</mi><mo>+</mo><mi>t</mi><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">u&#x27;=\sin[(u+t)^2]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7519em;"></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">sin</span><span class="mopen">[(</span><span class="mord mathnormal">u</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal">t</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span></span> over <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>≤</mo><mi>t</mi><mo>≤</mo><mn>4</mn></mrow><annotation encoding="application/x-tex">0\le t \le 4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7804em;vertical-align:-0.136em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em;"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">4</span></span></span></span></span>, with <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo><mo>=</mo><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">u(0)=-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">u</span><span class="mopen">(</span><span class="mord">0</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">−</span><span class="mord">1</span></span></span></span></span>.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-julia" style="white-space:pre">f(u, p, t) = sin((t + u)^2);
tspan = (0.0, 4.0);
u0 = -1.0;

ivp = ODEProblem(f, u0, tspan)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="4-Tn5UqOsKFWmSy4nYZMD" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span style="color:rgb(86, 182, 194)">ODEProblem</span><span> with uType </span><span style="color:rgb(86, 182, 194)">Float64</span><span> and tType </span><span style="color:rgb(86, 182, 194)">Float64</span><span>. In-place: </span><span style="color:rgb(86, 182, 194)">false</span><span>
timespan: (0.0, 4.0)
u0: -1.0</span></code></div></div></div><p>Here is the call to <span data-state="closed"><a class="hover-link" href="/fnc/euler#function-euler">Function <!-- -->6.2.2</a></span>.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-julia" style="white-space:pre">t, u = FNC.euler(ivp, 20)

plot(t, u, m=2, label=&quot;n=20&quot;,
    xlabel=L&quot;t&quot;, ylabel=L&quot;u(t)&quot;, title=&quot;Solution by Euler&#x27;s method&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="-mDM27fByUNSP312dBfgQ" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><p>We could define a different interpolant to get a smoother picture above, but the derivation of Euler’s method assumed a piecewise linear interpolant. We can instead request more steps to make the interpolant look smoother.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-julia" style="white-space:pre">t, u = FNC.euler(ivp, 50)
plot!(t, u, m=2, label=&quot;n=50&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="d4FadvSkiiOQ7g-geXNqH" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><p>Increasing <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></span> changed the solution noticeably. Since we know that interpolants and finite differences become more accurate as <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi><mo>→</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">h\to 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">h</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span></span>, we should anticipate the same behavior from Euler’s method. We don’t have an exact solution to compare to, so we will use a <code>DifferentialEquations</code> solver to construct an accurate reference solution.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-julia" style="white-space:pre">u_exact = solve(ivp, Tsit5(), reltol=1e-14, abstol=1e-14)

plot!(u_exact, l=(2, :black), label=&quot;reference&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="Kc_n-OHlGsaxJ3to3C3Kr" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><p>Now we can perform a convergence study.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-julia" style="white-space:pre">n = [round(Int, 5 * 10^k) for k in 0:0.5:3]
err = []
for n in n
    t, u = FNC.euler(ivp, n)
    push!(err, norm(u_exact.(t) - u, Inf))
end

pretty_table((n=n, err=err), header=[&quot;n&quot;, &quot;Inf-norm error&quot;])</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="AXuoK-dBRaZyNuRf2vFVH" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>┌──────┬────────────────┐
│</span><span style="font-weight:bold">    n </span><span>│</span><span style="font-weight:bold"> Inf-norm error </span><span>│
├──────┼────────────────┤
│    5 │         2.7342 │
│   16 │       0.107594 │
│   50 │      0.0299962 │
│  158 │     0.00885025 │
│  500 │     0.00273659 │
│ 1581 │    0.000859654 │
│ 5000 │    0.000271243 │
└──────┴────────────────┘
</span></code></pre></div></div></div><p>The error is approximately cut by a factor of 10 for each increase in <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></span> by the same factor. A log-log plot also confirms first-order convergence. Keep in mind that since <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi><mo>=</mo><mo stretchy="false">(</mo><mi>b</mi><mo>−</mo><mi>a</mi><mo stretchy="false">)</mo><mi mathvariant="normal">/</mi><mi>n</mi></mrow><annotation encoding="application/x-tex">h=(b-a)/n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">h</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">a</span><span class="mclose">)</span><span class="mord">/</span><span class="mord mathnormal">n</span></span></span></span></span>, it follows that <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>h</mi><mo stretchy="false">)</mo><mo>=</mo><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(h)=O(n^{-1})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">h</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span>.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-julia" style="white-space:pre">plot(n, err, m=:o, label=&quot;results&quot;,
    xaxis=(:log10, L&quot;n&quot;), yaxis=(:log10, &quot;Inf-norm global error&quot;),
    title=&quot;Convergence of Euler&#x27;s method&quot;)

# Add line for perfect 1st order.
plot!(n, 0.05 * (n / n[1]) .^ (-1), l=:dash, label=L&quot;O(n^{-1})&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="4Kd1mO1QgEoeri4QZ8zJF" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div></div></details><h3 id="section-6-3" class="relative group"><span class="heading-text">Section 6.3</span><a class="no-underline text-inherit hover:text-inherit px-2 font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#section-6-3" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><details class="rounded-md my-5 shadow dark:shadow-2xl dark:shadow-neutral-900 overflow-hidden bg-gray-50 dark:bg-stone-800"><summary class="m-0 text-lg font-medium py-1 min-h-[2em] pl-3 cursor-pointer hover:shadow-[inset_0_0_0px_30px_#00000003] dark:hover:shadow-[inset_0_0_0px_30px_#FFFFFF03] bg-gray-100 dark:bg-slate-900"><span class="text-neutral-900 dark:text-white"><span class="block float-right text-sm font-thin text-neutral-700 dark:text-neutral-200"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="inline-block pl-2 mr-2 -translate-y-[1px] details-toggle transition-transform"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></span>Predator-prey model</span></summary><div class="px-4 py-1 details-body"><p>We encode the predator–prey equations via a function.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-julia" style="white-space:pre">function predprey(u, p, t)
    α, β = p      # rename parameters for convenience
    y, z = u      # rename solution components
    s = (y * z) / (1 + β * y)     # appears in both equations
    return [y * (1 - α * y) - s, -z + s]
end;</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="McjRCCWC98e36ptQtABkx" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><p>As before, the ODE function must accept three inputs, <code>u</code>, <code>p</code>, and <code>t</code>, even though in this case there is no explicit dependence on <code>t</code>. The second input is used to pass parameters that don’t change throughout a single instance of the problem.</p><p>To specify the IVP we must also provide the initial condition, which is a 2-vector here, and the interval for the independent variable.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-julia" style="white-space:pre">u₀ = [1, 0.01]
tspan = (0.0, 60.0)
α, β = 0.1, 0.25

ivp = ODEProblem(predprey, u₀, tspan, [α, β])</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="LVAfjMxeppmmvsxKBs9Ng" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span style="color:rgb(86, 182, 194)">ODEProblem</span><span> with uType </span><span style="color:rgb(86, 182, 194)">Vector{Float64}</span><span> and tType </span><span style="color:rgb(86, 182, 194)">Float64</span><span>. In-place: </span><span style="color:rgb(86, 182, 194)">false</span><span>
timespan: (0.0, 60.0)
u0: 2-element Vector{Float64}:
 1.0
 0.01</span></code></div></div></div><p>You can use any <code>DifferentialEquations</code> solver on the IVP system.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-julia" style="white-space:pre">sol = solve(ivp, Tsit5());
plot(sol, label=[&quot;prey&quot; &quot;predator&quot;], title=&quot;Predator-prey solution&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="Ivt3gC6qLZpBlmEd3jU13" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><p>We can find the discrete values used to compute the interpolated solution. The <code>sol.u</code> value is a vector of vectors.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-julia" style="white-space:pre">t, u = sol.t, sol.u    # extract times and solution values
@show size(u);
@show t[20];
@show u[20];</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="OTY2otJi5EpvIW_MwQI_L" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>size(u) = (100,)
t[20] = 8.386698083051241
u[20] = [0.027739191695661334, 0.699418322938034]
</span></code></pre></div></div></div><p>We can also use <span data-state="closed"><a class="hover-link" href="/fnc/euler#function-euler">Function <!-- -->6.2.2</a></span> to find the solution.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-julia" style="white-space:pre">t, u = FNC.euler(ivp, 1200);</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="G8kXhCLS-Vb24QckYyE9d" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><p>The solution <code>u</code> is a vector of [prey,predator] 2-vectors for each of the discrete times in <code>t</code>. Manipulating the vector-of-vectors output can be a little tricky. Here, we convert it to an <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>×</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">n\times 2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span></span></span></span></span> matrix. Each column is one component, while each row is a single value of <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span></span>.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-julia" style="white-space:pre">u = [u[j] for u in u, j in 1:2]
plot!(t[1:3:end], u[1:3:end, :], l=(1, :black), m=2,
    label=[&quot;Euler prey&quot; &quot;Euler predator&quot;])</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="_hfGzO6t4S0IHKrNI_g03" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><p>Notice above that the accuracy of the Euler solution deteriorates rapidly.</p><div class="myst-grid grid my-5 sm:grid-cols-1 md:grid-cols-1 lg:grid-cols-2 xl:grid-cols-2 gap-4"><p>When there are just two components, it’s common to plot the solution in the <em>phase plane</em>, i.e., with <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>u</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">u_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> and <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>u</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">u_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> along the axes and time as a parameterization of the curve.</p><div class="my-5 rounded shadow dark:shadow-neutral-800 overflow-hidden border border-gray-100 dark:border-gray-800 flex flex-col"><div class="flex-grow px-4 py-2"><p>You can use <code>idxs</code> in the plot of a solution produced by <code>solve</code> to specify the components of the solution that appear on each axis.</p></div></div></div><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-julia" style="white-space:pre">plot(sol, idxs=(1, 2), title=&quot;Predator-prey in the phase plane&quot;,
    xlabel=L&quot;y&quot;, ylabel=L&quot;z&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="lc6ED8r8SQMAo7dRgw-DE" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><p>From this plot we can deduce that the solution approaches a periodic one, which in the phase plane is represented by a closed loop.</p></div></details><details class="rounded-md my-5 shadow dark:shadow-2xl dark:shadow-neutral-900 overflow-hidden bg-gray-50 dark:bg-stone-800"><summary class="m-0 text-lg font-medium py-1 min-h-[2em] pl-3 cursor-pointer hover:shadow-[inset_0_0_0px_30px_#00000003] dark:hover:shadow-[inset_0_0_0px_30px_#FFFFFF03] bg-gray-100 dark:bg-slate-900"><span class="text-neutral-900 dark:text-white"><span class="block float-right text-sm font-thin text-neutral-700 dark:text-neutral-200"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="inline-block pl-2 mr-2 -translate-y-[1px] details-toggle transition-transform"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></span>Coupled pendulums</span></summary><div class="px-4 py-1 details-body"><div class="myst-grid grid my-5 sm:grid-cols-1 md:grid-cols-1 lg:grid-cols-2 xl:grid-cols-2 gap-4"><p>Let’s implement the coupled pendulums from <span data-state="closed"><a class="hover-link" href="/fnc/systems#example-systems-coupledpendula">Example <!-- -->6.3.4</a></span>. The pendulums will be pulled in opposite directions and then released together from rest.</p><div class="my-5 rounded shadow dark:shadow-neutral-800 overflow-hidden border border-gray-100 dark:border-gray-800 flex flex-col"><div class="flex-grow px-4 py-2"><p>The <code>similar</code> function creates an array of the same size and type as a given value, without initializing the contents.</p></div></div></div><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-julia" style="white-space:pre">function couple(u, p, t)
    γ, L, k = p
    g = 9.8
    udot = similar(u)
    udot[1:2] .= u[3:4]
    udot[3] = -γ * u[3] - (g / L) * sin(u[1]) + k * (u[2] - u[1])
    udot[4] = -γ * u[4] - (g / L) * sin(u[2]) + k * (u[1] - u[2])
    return udot
end

u₀ = [1.25, -0.5, 0, 0]
tspan = (0.0, 50.0);</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="6mnFx4QDchVIzMayRh4KO" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div class="myst-grid grid my-5 sm:grid-cols-1 md:grid-cols-1 lg:grid-cols-2 xl:grid-cols-2 gap-4"><p>First we check the behavior of the system when the pendulums are uncoupled, i.e., when <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">k=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span></span>.</p><div class="my-5 rounded shadow dark:shadow-neutral-800 overflow-hidden border border-gray-100 dark:border-gray-800 flex flex-col"><div class="flex-grow px-4 py-2"><p>Here <code>idxs</code> is used to plot two components as functions of time.</p></div></div></div><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-julia" style="white-space:pre">γ, L, k = 0, 0.5, 0
ivp = ODEProblem(couple, u₀, tspan, [γ, L, k])
sol = solve(ivp, Tsit5())
plot(sol, idxs=[1, 2], label=[L&quot;\theta_1&quot; L&quot;\theta_2&quot;],
    xlims=[20, 50], title=&quot;Uncoupled pendulums&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="ReHbPmADIjdv-28tkVv9d" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><p>You can see that the pendulums swing independently. Because the model is nonlinear and the initial angles are not small, they have slightly different periods of oscillation, and they go in and out of phase.</p><p>With coupling activated, a different behavior is seen.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-julia" style="white-space:pre">k = 1
ivp = ODEProblem(couple, u₀, tspan, [γ, L, k])
sol = solve(ivp, Tsit5())
plot(sol, idxs=[1, 2], label=[L&quot;\theta_1&quot; L&quot;\theta_2&quot;],
    xlims=[20, 50], title=&quot;Coupled pendulums&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="25FduJpgeNUj9JsBJY3nb" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><p>The coupling makes the pendulums swap energy back and forth.</p></div></details><h3 id="section-6-4" class="relative group"><span class="heading-text">Section 6.4</span><a class="no-underline text-inherit hover:text-inherit px-2 font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#section-6-4" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><details class="rounded-md my-5 shadow dark:shadow-2xl dark:shadow-neutral-900 overflow-hidden bg-gray-50 dark:bg-stone-800"><summary class="m-0 text-lg font-medium py-1 min-h-[2em] pl-3 cursor-pointer hover:shadow-[inset_0_0_0px_30px_#00000003] dark:hover:shadow-[inset_0_0_0px_30px_#FFFFFF03] bg-gray-100 dark:bg-slate-900"><span class="text-neutral-900 dark:text-white"><span class="block float-right text-sm font-thin text-neutral-700 dark:text-neutral-200"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="inline-block pl-2 mr-2 -translate-y-[1px] details-toggle transition-transform"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></span>Convergence of Runge–Kutta methods</span></summary><div class="px-4 py-1 details-body"><p>We solve the IVP <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>u</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo>=</mo><mi>sin</mi><mo>⁡</mo><mo stretchy="false">[</mo><mo stretchy="false">(</mo><mi>u</mi><mo>+</mo><mi>t</mi><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">u&#x27;=\sin[(u+t)^2]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7519em;"></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">sin</span><span class="mopen">[(</span><span class="mord mathnormal">u</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal">t</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span></span> over <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>≤</mo><mi>t</mi><mo>≤</mo><mn>4</mn></mrow><annotation encoding="application/x-tex">0\le t \le 4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7804em;vertical-align:-0.136em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em;"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">4</span></span></span></span></span>, with <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo><mo>=</mo><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">u(0)=-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">u</span><span class="mopen">(</span><span class="mord">0</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">−</span><span class="mord">1</span></span></span></span></span>.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-julia" style="white-space:pre">f(u, p, t) = sin((t + u)^2)
tspan = (0.0, 4.0)
u₀ = -1.0

ivp = ODEProblem(f, u₀, tspan)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="xOkM677vsqCV66tQMiJqe" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span style="color:rgb(86, 182, 194)">ODEProblem</span><span> with uType </span><span style="color:rgb(86, 182, 194)">Float64</span><span> and tType </span><span style="color:rgb(86, 182, 194)">Float64</span><span>. In-place: </span><span style="color:rgb(86, 182, 194)">false</span><span>
timespan: (0.0, 4.0)
u0: -1.0</span></code></div></div></div><p>We use a <code>DifferentialEquations</code> solver to construct an accurate approximation to the exact solution.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-julia" style="white-space:pre">u_ref = solve(ivp, Tsit5(), reltol=1e-14, abstol=1e-14);</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="NRDH31TMk4aGLGPRjCAol" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><p>Now we perform a convergence study of our two Runge–Kutta implementations.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-julia" style="white-space:pre">n = [round(Int, 2 * 10^k) for k in 0:0.5:3]
err_IE2, err_RK4 = [], []
for n in n
    t, u = FNC.ie2(ivp, n)
    push!(err_IE2, maximum(@.abs(u_ref(t) - u)))
    t, u = FNC.rk4(ivp, n)
    push!(err_RK4, maximum(@.abs(u_ref(t) - u)))
end

pretty_table([n err_IE2 err_RK4], header=[&quot;n&quot;, &quot;IE2 error&quot;, &quot;RK4 error&quot;])</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="-dbQfAkmR70-1fU60pP-R" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>┌──────┬─────────────┬─────────────┐
│</span><span style="font-weight:bold">    n </span><span>│</span><span style="font-weight:bold">   IE2 error </span><span>│</span><span style="font-weight:bold">   RK4 error </span><span>│
├──────┼─────────────┼─────────────┤
│    2 │     1.76903 │    0.820651 │
│    6 │    0.512684 │    0.791925 │
│   20 │   0.0240594 │  0.00081269 │
│   63 │  0.00225327 │  8.06216e-6 │
│  200 │ 0.000222419 │  7.60655e-8 │
│  632 │  2.22528e-5 │   7.513e-10 │
│ 2000 │  2.22177e-6 │ 7.45187e-12 │
└──────┴─────────────┴─────────────┘
</span></code></pre></div></div></div><p>The amount of computational work at each time step is assumed to be proportional to the number of stages. Let’s compare on an apples-to-apples basis by using the number of <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi></mrow><annotation encoding="application/x-tex">f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span></span></span></span></span>-evaluations on the horizontal axis.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-julia" style="white-space:pre">plot([2n 4n], [err_IE2 err_RK4], m=3, label=[&quot;IE2&quot; &quot;RK4&quot;],
    xaxis=(:log10, &quot;f-evaluations&quot;), yaxis=(:log10, &quot;inf-norm error&quot;),
    title=&quot;Convergence of RK methods&quot;, leg=:bottomleft)

plot!(2n, 1e-5 * (n / n[end]) .^ (-2), l=:dash, label=L&quot;O(n^{-2})&quot;)
plot!(4n, 1e-10 * (n / n[end]) .^ (-4), l=:dash, label=L&quot;O(n^{-4})&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="Ltl6g0NRtyQY5B14RikZL" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><p>The fourth-order variant is more efficient in this problem over a wide range of accuracy.</p></div></details><h3 id="section-6-5" class="relative group"><span class="heading-text">Section 6.5</span><a class="no-underline text-inherit hover:text-inherit px-2 font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#section-6-5" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><details class="rounded-md my-5 shadow dark:shadow-2xl dark:shadow-neutral-900 overflow-hidden bg-gray-50 dark:bg-stone-800"><summary class="m-0 text-lg font-medium py-1 min-h-[2em] pl-3 cursor-pointer hover:shadow-[inset_0_0_0px_30px_#00000003] dark:hover:shadow-[inset_0_0_0px_30px_#FFFFFF03] bg-gray-100 dark:bg-slate-900"><span class="text-neutral-900 dark:text-white"><span class="block float-right text-sm font-thin text-neutral-700 dark:text-neutral-200"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="inline-block pl-2 mr-2 -translate-y-[1px] details-toggle transition-transform"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></span>Adaptive step size</span></summary><div class="px-4 py-1 details-body"><p>Let’s run adaptive RK on  <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>u</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo>=</mo><msup><mi>e</mi><mrow><mi>t</mi><mo>−</mo><mi>u</mi><mi>sin</mi><mo>⁡</mo><mi>u</mi></mrow></msup></mrow><annotation encoding="application/x-tex">u&#x27;=e^{t-u\sin u}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7519em;"></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8305em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8305em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mathnormal mtight">u</span><span class="mspace mtight" style="margin-right:0.1952em;"></span><span class="mop mtight"><span class="mtight">s</span><span class="mtight">i</span><span class="mtight">n</span></span><span class="mspace mtight" style="margin-right:0.1952em;"></span><span class="mord mathnormal mtight">u</span></span></span></span></span></span></span></span></span></span></span></span></span>.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-julia" style="white-space:pre">f(u, p, t) = exp(t - u * sin(u))
ivp = ODEProblem(f, 0, (0.0, 5.0))
t, u = FNC.rk23(ivp, 1e-5)

plot(t, u, m=2,
    xlabel=L&quot;t&quot;, ylabel=L&quot;u(t)&quot;, title=&quot;Adaptive IVP solution&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="GusR60uTzJT1H5H7PRH6G" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><p>The solution makes a very abrupt change near <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>=</mo><mn>2.4</mn></mrow><annotation encoding="application/x-tex">t=2.4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2.4</span></span></span></span></span>. The resulting time steps vary over three orders of magnitude.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-julia" style="white-space:pre">Δt = diff(t)
plot(t[1:end-1], Δt, title=&quot;Adaptive step sizes&quot;,
    xaxis=(L&quot;t&quot;, (0, 5)), yaxis=(:log10, &quot;step size&quot;))</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="zT3QWOy5VBaOwzpbofuFa" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><p>If we had to run with a uniform step size to get this accuracy, it would be</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-julia" style="white-space:pre">println(&quot;minimum step size = $(minimum(Δt))&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="QmcPtekzsKUOK6r0DUtEI" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>minimum step size = 4.6096854609878335e-5
</span></code></pre></div></div></div><p>On the other hand, the average step size that was actually taken was</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-julia" style="white-space:pre">println(&quot;average step size = $(sum(Δt)/(length(t)-1))&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="QDaGGGBKOKmPXLAhLDnKN" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>average step size = 0.03205128205128205
</span></code></pre></div></div></div><p>We took fewer steps by a factor of almost 1000! Even accounting for the extra stage per step and the occasional rejected step, the savings are clear.</p></div></details><details class="rounded-md my-5 shadow dark:shadow-2xl dark:shadow-neutral-900 overflow-hidden bg-gray-50 dark:bg-stone-800"><summary class="m-0 text-lg font-medium py-1 min-h-[2em] pl-3 cursor-pointer hover:shadow-[inset_0_0_0px_30px_#00000003] dark:hover:shadow-[inset_0_0_0px_30px_#FFFFFF03] bg-gray-100 dark:bg-slate-900"><span class="text-neutral-900 dark:text-white"><span class="block float-right text-sm font-thin text-neutral-700 dark:text-neutral-200"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="inline-block pl-2 mr-2 -translate-y-[1px] details-toggle transition-transform"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></span>Adaptive step size near a singularity</span></summary><div class="px-4 py-1 details-body"><p>In <span data-state="closed"><a class="hover-link" href="/fnc/basics#demo-basics-sing">Demo <!-- -->6.1.3</a></span> we saw an IVP that appears to blow up in a finite amount of time. Because the solution increases so rapidly as it approaches the blowup, adaptive stepping is required even to get close.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-julia" style="white-space:pre">f(u, p, t) = (t + u)^2
ivp = ODEProblem(f, 1, (0.0, 1.0))
t, u = FNC.rk23(ivp, 1e-5);</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="4MelkYh79DqXTqEGmsGXZ" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span style="color:rgb(187, 187, 0);font-weight:bold">┌ </span><span style="color:rgb(187, 187, 0);font-weight:bold">Warning: </span><span>Stepsize too small near t=0.7854087204072808
</span><span style="color:rgb(187, 187, 0);font-weight:bold">└ </span><span style="color:rgb(85, 85, 85)">@ FundamentalsNumericalComputation ~/.julia/packages/FundamentalsNumericalComputation/Gvhz2/src/chapter06.jl:93</span><span>
</span></code></pre></div></div></div><p>In fact, the failure of the adaptivity gives a decent idea of when the singularity occurs.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-julia" style="white-space:pre">plot(t, u, legend=:none,
    xlabel=L&quot;t&quot;, yaxis=(:log10, L&quot;u(t)&quot;), title=&quot;Finite-time blowup&quot;)

tf = t[end]
vline!([tf], l=:dash)
annotate!(tf, 1e5, latexstring(@sprintf(&quot;t = %.6f &quot;, tf)), :right)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="8zTokisv3qv4zN2BxVKEy" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div></div></details><h3 id="section-6-6" class="relative group"><span class="heading-text">Section 6.6</span><a class="no-underline text-inherit hover:text-inherit px-2 font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#section-6-6" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><details class="rounded-md my-5 shadow dark:shadow-2xl dark:shadow-neutral-900 overflow-hidden bg-gray-50 dark:bg-stone-800"><summary class="m-0 text-lg font-medium py-1 min-h-[2em] pl-3 cursor-pointer hover:shadow-[inset_0_0_0px_30px_#00000003] dark:hover:shadow-[inset_0_0_0px_30px_#FFFFFF03] bg-gray-100 dark:bg-slate-900"><span class="text-neutral-900 dark:text-white"><span class="block float-right text-sm font-thin text-neutral-700 dark:text-neutral-200"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="inline-block pl-2 mr-2 -translate-y-[1px] details-toggle transition-transform"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></span>Convergence of Adams–Bashforth</span></summary><div class="px-4 py-1 details-body"><p>We study the convergence of AB4 using the IVP <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>u</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo>=</mo><mi>sin</mi><mo>⁡</mo><mo stretchy="false">[</mo><mo stretchy="false">(</mo><mi>u</mi><mo>+</mo><mi>t</mi><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">u&#x27;=\sin[(u+t)^2]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7519em;"></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">sin</span><span class="mopen">[(</span><span class="mord mathnormal">u</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal">t</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span></span> over <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>≤</mo><mi>t</mi><mo>≤</mo><mn>4</mn></mrow><annotation encoding="application/x-tex">0\le t \le 4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7804em;vertical-align:-0.136em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em;"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">4</span></span></span></span></span>, with <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo><mo>=</mo><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">u(0)=-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">u</span><span class="mopen">(</span><span class="mord">0</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">−</span><span class="mord">1</span></span></span></span></span>. As usual, <code>solve</code> is called to give an accurate reference solution.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-julia" style="white-space:pre">ivp = ODEProblem((u, p, t) -&gt; sin((t + u)^2), -1.0, (0.0, 4.0))
u_ref = solve(ivp, Tsit5(), reltol=1e-14, abstol=1e-14);</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="OlGSbc3bnGuFsLBIZQKP7" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><p>Now we perform a convergence study of the AB4 code.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-julia" style="white-space:pre">n = @. [round(Int, 4 * 10^k) for k in 0:0.5:3]
err = []
for n in n
    t, u = FNC.ab4(ivp, n)
    push!(err, norm(u_ref.(t) - u, Inf))
end

pretty_table([n err], header=[&quot;n&quot;, &quot;inf-norm error&quot;])</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="vPyQstAthnOtd29bWYVfc" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>┌──────┬────────────────┐
│</span><span style="font-weight:bold">    n </span><span>│</span><span style="font-weight:bold"> inf-norm error </span><span>│
├──────┼────────────────┤
│    4 │        0.50044 │
│   13 │        1.39129 │
│   40 │     0.00627809 │
│  126 │     9.94942e-5 │
│  400 │     1.09598e-6 │
│ 1265 │     1.12766e-8 │
│ 4000 │    1.13736e-10 │
└──────┴────────────────┘
</span></code></pre></div></div></div><p>The method should converge as <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>h</mi><mn>4</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(h^4)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span>, so a log-log scale is appropriate for the errors.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-julia" style="white-space:pre">plot(n, err, m=3, label=&quot;AB4&quot;,
    xaxis=(:log10, L&quot;n&quot;), yaxis=(:log10, &quot;inf-norm error&quot;),
    title=&quot;Convergence of AB4&quot;, leg=:bottomleft)

plot!(n, (n / n[1]) .^ (-4), l=:dash, label=L&quot;O(n^{-4})&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="ktUtMGCcYQxXjHgbC9h2W" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div></div></details><details class="rounded-md my-5 shadow dark:shadow-2xl dark:shadow-neutral-900 overflow-hidden bg-gray-50 dark:bg-stone-800"><summary class="m-0 text-lg font-medium py-1 min-h-[2em] pl-3 cursor-pointer hover:shadow-[inset_0_0_0px_30px_#00000003] dark:hover:shadow-[inset_0_0_0px_30px_#FFFFFF03] bg-gray-100 dark:bg-slate-900"><span class="text-neutral-900 dark:text-white"><span class="block float-right text-sm font-thin text-neutral-700 dark:text-neutral-200"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="inline-block pl-2 mr-2 -translate-y-[1px] details-toggle transition-transform"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></span>Stiffness</span></summary><div class="px-4 py-1 details-body"><p>The following simple ODE uncovers a surprise.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-julia" style="white-space:pre">ivp = ODEProblem((u, p, t) -&gt; u^2 - u^3, 0.005, (0, 400.0))</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="k1Q785vfZplqnaGnWug9X" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span style="color:rgb(86, 182, 194)">ODEProblem</span><span> with uType </span><span style="color:rgb(86, 182, 194)">Float64</span><span> and tType </span><span style="color:rgb(86, 182, 194)">Float64</span><span>. In-place: </span><span style="color:rgb(86, 182, 194)">false</span><span>
timespan: (0.0, 400.0)
u0: 0.005</span></code></div></div></div><p>We will solve the problem first with the implicit AM2 method using <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mn>200</mn></mrow><annotation encoding="application/x-tex">n=200</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">200</span></span></span></span></span> steps.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-julia" style="white-space:pre">tI, uI = FNC.am2(ivp, 200)

plot(tI, uI, label=&quot;AM2&quot;,
    xlabel=L&quot;t&quot;, ylabel=L&quot;u(t)&quot;, leg=:bottomright)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="Szis-3jTA_A9Abh3hAS-4" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><p>Now we repeat the process using the explicit AB4 method.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-julia" style="white-space:pre">tE, uE = FNC.ab4(ivp, 200)

scatter!(tE, uE, m=3, label=&quot;AB4&quot;, ylim=[-4, 2])</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="tJOtGkuW-6j4MK02pdIOO" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><p>Once the solution starts to take off, the AB4 result goes catastrophically wrong.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-julia" style="white-space:pre">uE[105:111]</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="JEGuzDkt54s_aIx02VP16" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>7-element Vector{Float64}:
   0.7553857798343923
   1.4372970308402562
  -3.2889768512289934
 214.1791132643978
  -4.482089146771584e7
   4.1268902909420876e23
  -3.221441244795439e71</span></code></div></div></div><p>We hope that AB4 will converge in the limit <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi><mo>→</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">h\to 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">h</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span></span>, so let’s try using more steps.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-julia" style="white-space:pre">plt = scatter(tI, uI, label=&quot;AM2, n=200&quot;, m=3,
    xlabel=L&quot;t&quot;, ylabel=L&quot;u(t)&quot;, leg=:bottomright)

for n in [1000, 1600]
    tE, uE = FNC.ab4(ivp, n)
    plot!(tE, uE, label=&quot;AM4, n=$n&quot;)
end
plt</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="HHR9-_HMLe7P8f8hqL0RL" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><p>So AB4, which is supposed to be <em>more</em> accurate than AM2, actually needs something like 8 times as many steps to get a reasonable-looking answer!</p></div></details><h3 id="section-6-7" class="relative group"><span class="heading-text">Section 6.7</span><a class="no-underline text-inherit hover:text-inherit px-2 font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#section-6-7" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><details class="rounded-md my-5 shadow dark:shadow-2xl dark:shadow-neutral-900 overflow-hidden bg-gray-50 dark:bg-stone-800"><summary class="m-0 text-lg font-medium py-1 min-h-[2em] pl-3 cursor-pointer hover:shadow-[inset_0_0_0px_30px_#00000003] dark:hover:shadow-[inset_0_0_0px_30px_#FFFFFF03] bg-gray-100 dark:bg-slate-900"><span class="text-neutral-900 dark:text-white"><span class="block float-right text-sm font-thin text-neutral-700 dark:text-neutral-200"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="inline-block pl-2 mr-2 -translate-y-[1px] details-toggle transition-transform"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></span>Instability</span></summary><div class="px-4 py-1 details-body"><p>We’ll measure the error at the time <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">t=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></span>.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-julia" style="white-space:pre">du_dt(u, t) = u
û = exp
a, b = 0.0, 1.0;
n = [5, 10, 20, 40, 60]
err = []
t, u = [], []
for n in n
    h = (b - a) / n
    t = [a + i * h for i in 0:n]
    u = [1; û(h); zeros(n - 1)]
    f_val = [du_dt(u[1], t[1]); zeros(n)]
    for i in 2:n
        f_val[i] = du_dt(u[i], t[i])
        u[i+1] = -4 * u[i] + 5 * u[i-1] + h * (4 * f_val[i] + 2 * f_val[i-1])
    end
    push!(err, abs(û(b) - u[end]))
end

pretty_table([n (b - a) ./ n err], header=[&quot;n&quot;, &quot;h&quot;, &quot;error&quot;])</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="JThnDPknkm0wpZeiuydHW" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>┌────┬───────────┬────────────┐
│</span><span style="font-weight:bold">  n </span><span>│</span><span style="font-weight:bold">         h </span><span>│</span><span style="font-weight:bold">      error </span><span>│
├────┼───────────┼────────────┤
│  5 │       0.2 │  0.0160452 │
│ 10 │       0.1 │    2.84548 │
│ 20 │      0.05 │   1.6225e6 │
│ 40 │     0.025 │  9.3442e18 │
│ 60 │ 0.0166667 │ 1.74013e32 │
└────┴───────────┴────────────┘
</span></code></pre></div></div></div><p>The error starts out promisingly, but things explode from there. A graph of the last numerical attempt yields a clue.</p><div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-julia" style="white-space:pre">plot(t, abs.(u), m=3, label=&quot;&quot;,
    xlabel=L&quot;t&quot;, yaxis=(:log10, L&quot;|u(t)|&quot;), title=&quot;LIAF solution&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="j31UKFiepDuQEK_KeDDvJ" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><p>It’s clear that the solution is growing exponentially in time.</p></div></details></div><div></div><div class="flex pt-10 mb-10 space-x-4"><a class="flex-1 block p-4 font-normal text-gray-600 no-underline border border-gray-200 rounded shadow-sm group hover:border-blue-600 dark:hover:border-blue-400 hover:text-blue-600 dark:hover:text-blue-400 dark:text-gray-100 dark:border-gray-500 hover:shadow-lg dark:shadow-neutral-700" href="/fnc/chapter5"><div class="flex h-full align-middle"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="self-center transition-transform group-hover:-translate-x-1 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18"></path></svg><div class="flex-grow text-right"><div class="text-xs text-gray-500 dark:text-gray-400">Julia codes</div>Chapter 5</div></div></a><a class="flex-1 block p-4 font-normal text-gray-600 no-underline border border-gray-200 rounded shadow-sm group hover:border-blue-600 dark:hover:border-blue-400 hover:text-blue-600 dark:hover:text-blue-400 dark:text-gray-100 dark:border-gray-500 hover:shadow-lg dark:shadow-neutral-700" href="/fnc/chapter1-1"><div class="flex h-full align-middle"><div class="flex-grow"><div class="text-xs text-gray-500 dark:text-gray-400">MATLAB codes</div>Chapter 1</div><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="self-center transition-transform group-hover:translate-x-1 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 4.5 21 12m0 0-7.5 7.5M21 12H3"></path></svg></div></a></div></main></article><script>((a,d)=>{if(!window.history.state||!window.history.state.key){let h=Math.random().toString(32).slice(2);window.history.replaceState({key:h},"")}try{let f=JSON.parse(sessionStorage.getItem(a)||"{}")[d||window.history.state.key];typeof f=="number"&&window.scrollTo(0,f)}catch(h){console.error(h),sessionStorage.removeItem(a)}})("positions", null)</script><link rel="modulepreload" href="/fnc/build/entry.client-UNPC4GT3.js"/><link rel="modulepreload" href="/fnc/build/_shared/chunk-OCTKKCIL.js"/><link rel="modulepreload" href="/fnc/build/_shared/chunk-UAI5KRM7.js"/><link rel="modulepreload" href="/fnc/build/_shared/chunk-2NH4LW52.js"/><link rel="modulepreload" href="/fnc/build/_shared/chunk-JLDGA2DL.js"/><link rel="modulepreload" href="/fnc/build/_shared/chunk-YAIQ7LUU.js"/><link rel="modulepreload" href="/fnc/build/_shared/chunk-OCWQY3HK.js"/><link rel="modulepreload" href="/fnc/build/_shared/chunk-ZQWAZXET.js"/><link rel="modulepreload" href="/fnc/build/_shared/chunk-HYMQ7M2K.js"/><link rel="modulepreload" href="/fnc/build/_shared/chunk-3CVK3PYF.js"/><link rel="modulepreload" href="/fnc/build/_shared/chunk-J6FHCSRC.js"/><link rel="modulepreload" href="/fnc/build/_shared/chunk-IQBJE7PC.js"/><link rel="modulepreload" href="/fnc/build/_shared/chunk-5CFTM6YW.js"/><link rel="modulepreload" href="/fnc/build/_shared/chunk-GUCIBHGO.js"/><link rel="modulepreload" href="/fnc/build/root-HROFNPGU.js"/><link rel="modulepreload" href="/fnc/build/_shared/chunk-N544LW6X.js"/><link rel="modulepreload" href="/fnc/build/routes/$-WNZNXUO2.js"/><script>window.__remixContext = {"url":"/chapter6","state":{"loaderData":{"root":{"config":{"title":"Fundamentals of Numerical Computation","options":{"favicon":"/fnc/build/favicon-eb5519d0a12992c68aa24a8a04531b7e.png","logo":"/fnc/build/FNClogo-8857b73cc9f6c65c9fea3e10797ba18a.png"},"myst":"1.3.19","nav":[],"actions":[],"projects":[{"numbering":{"heading_1":{"enabled":true},"heading_2":{"enabled":true},"heading_3":{"enabled":false}},"math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"LU":"lower triangular times upper triangular","QR":"orthogonal times upper triangular"},"exports":[{"format":"pdf","filename":"myst.pdf","url":"/fnc/build/myst-17d85fc44120abd982ec3b44467ee78e.pdf"}],"title":"Fundamentals of Numerical Computation","short_title":"FNC","description":"Online textbook for computational mathematics","authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","id":"a36af5d8-56ed-4bf2-92e6-5f7fdb82e8e1","toc":[{"file":"home.md"},{"children":[{"file":"preface.md"},{"file":"preface-original.md"}],"title":"Preface"},{"children":[{"file":"chapter1/floating-point.md"},{"file":"chapter1/conditioning.md"},{"file":"chapter1/algorithms.md"},{"file":"chapter1/stability.md"},{"file":"chapter1/next.md"}],"file":"chapter1/overview.md"},{"children":[{"file":"chapter2/polyinterp.md"},{"file":"chapter2/matrices.md"},{"file":"chapter2/linear-systems.md"},{"file":"chapter2/lu.md"},{"file":"chapter2/efficiency.md"},{"file":"chapter2/pivoting.md"},{"file":"chapter2/norms.md"},{"file":"chapter2/condition-number.md"},{"file":"chapter2/structure.md"},{"file":"chapter2/next.md"}],"file":"chapter2/overview.md"},{"children":[{"file":"chapter3/fitting.md"},{"file":"chapter3/normaleqns.md"},{"file":"chapter3/qr.md"},{"file":"chapter3/house.md"},{"file":"chapter3/next.md"}],"file":"chapter3/overview.md"},{"children":[{"file":"chapter4/rootproblem.md"},{"file":"chapter4/fixed-point.md"},{"file":"chapter4/newton.md"},{"file":"chapter4/secant.md"},{"file":"chapter4/newtonsys.md"},{"file":"chapter4/quasinewton.md"},{"file":"chapter4/nlsq.md"},{"file":"chapter4/next.md"}],"file":"chapter4/overview.md"},{"children":[{"file":"chapter5/interpolation.md"},{"file":"chapter5/pwlin.md"},{"file":"chapter5/splines.md"},{"file":"chapter5/finitediffs.md"},{"file":"chapter5/fd-converge.md"},{"file":"chapter5/integration.md"},{"file":"chapter5/adaptive.md"},{"file":"chapter5/next.md"}],"file":"chapter5/overview.md"},{"children":[{"file":"chapter6/basics.md"},{"file":"chapter6/euler.md"},{"file":"chapter6/systems.md"},{"file":"chapter6/rk.md"},{"file":"chapter6/adaptive-rk.md"},{"file":"chapter6/multistep.md"},{"file":"chapter6/implicit.md"},{"file":"chapter6/zerostability.md"},{"file":"chapter6/next.md"}],"file":"chapter6/overview.md"},{"children":[{"file":"appendix/linear-algebra.md"},{"children":[{"file":"julia/chapter1.md"},{"file":"julia/chapter2.md"},{"file":"julia/chapter3.md"},{"file":"julia/chapter4.md"},{"file":"julia/chapter5.md"},{"file":"julia/chapter6.md"}],"title":"Julia codes"},{"children":[{"file":"matlab/chapter1.md"},{"file":"matlab/chapter2.md"},{"file":"matlab/chapter3.md"},{"file":"matlab/chapter4.md"},{"file":"matlab/chapter5.md"},{"file":"matlab/chapter6.md"}],"title":"MATLAB codes"},{"children":[{"file":"python/chapter1.md"},{"file":"python/chapter2.md"},{"file":"python/chapter3.md"},{"file":"python/chapter4.md"},{"file":"python/chapter5.md"},{"file":"python/chapter6.md"}],"title":"Python codes"}],"title":"Appendices"},{"file":"genindex.md"}],"thumbnail":"/fnc/build/front_cover_small-3b81a246c798b3ded1375244c3419355.png","thumbnailOptimized":"/fnc/build/front_cover_small-3b81a246c798b3ded1375244c3419355.webp","bibliography":[],"index":"home","pages":[{"level":1,"title":"Preface"},{"slug":"preface","title":"Preface to the Julia edition","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"preface-original","title":"Preface to the original edition","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"overview","title":"Introduction","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"floating-point","title":"Floating-point numbers","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"conditioning","title":"Problems and conditioning","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"algorithms","title":"Algorithms","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"stability","title":"Stability","description":"","date":"","thumbnail":"/fnc/build/backwarderror-bdcf58e0d5f4193c2230d0af9181d25c.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"next","title":"Next steps","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"overview-1","title":"Linear systems of equations","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"polyinterp","title":"Polynomial interpolation","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"matrices","title":"Computing with matrices","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"linear-systems","title":"Linear systems","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"lu","title":"LU factorization","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"efficiency","title":"Efficiency of matrix computations","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"pivoting","title":"Row pivoting","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"norms","title":"Vector and matrix norms","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"condition-number","title":"Conditioning of linear systems","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"structure","title":"Exploiting matrix structure","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"next-1","title":"Next steps","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"overview-2","title":"Overdetermined linear systems","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"fitting","title":"Fitting functions to data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"normaleqns","title":"The normal equations","description":"","date":"","thumbnail":"/fnc/build/normaleqns2d-3a9bdadad6b0273ad3bb332f316bfd7c.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"qr","title":"The QR factorization","description":"","date":"","thumbnail":"/fnc/build/nonorthogonal-b17ed1afa4e72fd15dc1d03a95b2c3d7.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"house","title":"Computing QR factorizations","description":"","date":"","thumbnail":"/fnc/build/hhreflect-4c7ca3f245617111b6fd9e68dcaee10e.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"next-2","title":"Next steps","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"overview-3","title":"Roots of nonlinear equations","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"rootproblem","title":"The rootfinding problem","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fixed-point","title":"Fixed-point iteration","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"newton","title":"Newton’s method","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"secant","title":"Interpolation-based methods","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"newtonsys","title":"Newton for nonlinear systems","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"quasinewton","title":"Quasi-Newton methods","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"nlsq","title":"Nonlinear least squares","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"next-3","title":"Next steps","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"overview-4","title":"Piecewise interpolation","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"interpolation","title":"The interpolation problem","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"pwlin","title":"Piecewise linear interpolation","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"splines","title":"Cubic splines","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"finitediffs","title":"Finite differences","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fd-converge","title":"Convergence of finite differences","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"integration","title":"Numerical integration","description":"","date":"","thumbnail":"/fnc/build/trapezoid-a279167525570df0e1ac47b0fceef54c.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"adaptive","title":"Adaptive integration","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"next-4","title":"Next steps","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"overview-5","title":"Initial-value problems for ODEs","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"basics","title":"Basics of IVPs","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"euler","title":"Euler’s method","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"systems","title":"IVP systems","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"rk","title":"Runge–Kutta methods","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"adaptive-rk","title":"Adaptive Runge–Kutta","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"multistep","title":"Multistep methods","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"implicit","title":"Implementation of multistep methods","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"zerostability","title":"Zero-stability of multistep methods","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"next-5","title":"Next steps","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Appendices"},{"slug":"linear-algebra","title":"Review of linear algebra","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":2,"title":"Julia codes"},{"slug":"chapter1","title":"Chapter 1","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter2","title":"Chapter 2","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter3","title":"Chapter 3","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter4","title":"Chapter 4","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter5","title":"Chapter 5","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter6","title":"Chapter 6","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":2,"title":"MATLAB codes"},{"slug":"chapter1-1","title":"Chapter 1","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter2-1","title":"Chapter 2","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter3-1","title":"Chapter 3","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter4-1","title":"Chapter 4","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter5-1","title":"Chapter 5","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter6-1","title":"Chapter 6","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":2,"title":"Python codes"},{"slug":"chapter1-2","title":"Chapter 1","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter2-2","title":"Chapter 2","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter3-2","title":"Chapter 3","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter4-2","title":"Chapter 4","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter5-2","title":"Chapter 5","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter6-2","title":"Chapter 6","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"genindex","title":"Index","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1}]}]},"CONTENT_CDN_PORT":"3100","MODE":"static","BASE_URL":"/fnc"},"routes/$":{"config":{"title":"Fundamentals of Numerical Computation","options":{"favicon":"/fnc/build/favicon-eb5519d0a12992c68aa24a8a04531b7e.png","logo":"/fnc/build/FNClogo-8857b73cc9f6c65c9fea3e10797ba18a.png"},"myst":"1.3.19","nav":[],"actions":[],"projects":[{"numbering":{"heading_1":{"enabled":true},"heading_2":{"enabled":true},"heading_3":{"enabled":false}},"math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"LU":"lower triangular times upper triangular","QR":"orthogonal times upper triangular"},"exports":[{"format":"pdf","filename":"myst.pdf","url":"/fnc/build/myst-17d85fc44120abd982ec3b44467ee78e.pdf"}],"title":"Fundamentals of Numerical Computation","short_title":"FNC","description":"Online textbook for computational mathematics","authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","id":"a36af5d8-56ed-4bf2-92e6-5f7fdb82e8e1","toc":[{"file":"home.md"},{"children":[{"file":"preface.md"},{"file":"preface-original.md"}],"title":"Preface"},{"children":[{"file":"chapter1/floating-point.md"},{"file":"chapter1/conditioning.md"},{"file":"chapter1/algorithms.md"},{"file":"chapter1/stability.md"},{"file":"chapter1/next.md"}],"file":"chapter1/overview.md"},{"children":[{"file":"chapter2/polyinterp.md"},{"file":"chapter2/matrices.md"},{"file":"chapter2/linear-systems.md"},{"file":"chapter2/lu.md"},{"file":"chapter2/efficiency.md"},{"file":"chapter2/pivoting.md"},{"file":"chapter2/norms.md"},{"file":"chapter2/condition-number.md"},{"file":"chapter2/structure.md"},{"file":"chapter2/next.md"}],"file":"chapter2/overview.md"},{"children":[{"file":"chapter3/fitting.md"},{"file":"chapter3/normaleqns.md"},{"file":"chapter3/qr.md"},{"file":"chapter3/house.md"},{"file":"chapter3/next.md"}],"file":"chapter3/overview.md"},{"children":[{"file":"chapter4/rootproblem.md"},{"file":"chapter4/fixed-point.md"},{"file":"chapter4/newton.md"},{"file":"chapter4/secant.md"},{"file":"chapter4/newtonsys.md"},{"file":"chapter4/quasinewton.md"},{"file":"chapter4/nlsq.md"},{"file":"chapter4/next.md"}],"file":"chapter4/overview.md"},{"children":[{"file":"chapter5/interpolation.md"},{"file":"chapter5/pwlin.md"},{"file":"chapter5/splines.md"},{"file":"chapter5/finitediffs.md"},{"file":"chapter5/fd-converge.md"},{"file":"chapter5/integration.md"},{"file":"chapter5/adaptive.md"},{"file":"chapter5/next.md"}],"file":"chapter5/overview.md"},{"children":[{"file":"chapter6/basics.md"},{"file":"chapter6/euler.md"},{"file":"chapter6/systems.md"},{"file":"chapter6/rk.md"},{"file":"chapter6/adaptive-rk.md"},{"file":"chapter6/multistep.md"},{"file":"chapter6/implicit.md"},{"file":"chapter6/zerostability.md"},{"file":"chapter6/next.md"}],"file":"chapter6/overview.md"},{"children":[{"file":"appendix/linear-algebra.md"},{"children":[{"file":"julia/chapter1.md"},{"file":"julia/chapter2.md"},{"file":"julia/chapter3.md"},{"file":"julia/chapter4.md"},{"file":"julia/chapter5.md"},{"file":"julia/chapter6.md"}],"title":"Julia codes"},{"children":[{"file":"matlab/chapter1.md"},{"file":"matlab/chapter2.md"},{"file":"matlab/chapter3.md"},{"file":"matlab/chapter4.md"},{"file":"matlab/chapter5.md"},{"file":"matlab/chapter6.md"}],"title":"MATLAB codes"},{"children":[{"file":"python/chapter1.md"},{"file":"python/chapter2.md"},{"file":"python/chapter3.md"},{"file":"python/chapter4.md"},{"file":"python/chapter5.md"},{"file":"python/chapter6.md"}],"title":"Python codes"}],"title":"Appendices"},{"file":"genindex.md"}],"thumbnail":"/fnc/build/front_cover_small-3b81a246c798b3ded1375244c3419355.png","thumbnailOptimized":"/fnc/build/front_cover_small-3b81a246c798b3ded1375244c3419355.webp","bibliography":[],"index":"home","pages":[{"level":1,"title":"Preface"},{"slug":"preface","title":"Preface to the Julia edition","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"preface-original","title":"Preface to the original edition","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"overview","title":"Introduction","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"floating-point","title":"Floating-point numbers","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"conditioning","title":"Problems and conditioning","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"algorithms","title":"Algorithms","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"stability","title":"Stability","description":"","date":"","thumbnail":"/fnc/build/backwarderror-bdcf58e0d5f4193c2230d0af9181d25c.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"next","title":"Next steps","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"overview-1","title":"Linear systems of equations","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"polyinterp","title":"Polynomial interpolation","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"matrices","title":"Computing with matrices","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"linear-systems","title":"Linear systems","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"lu","title":"LU factorization","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"efficiency","title":"Efficiency of matrix computations","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"pivoting","title":"Row pivoting","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"norms","title":"Vector and matrix norms","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"condition-number","title":"Conditioning of linear systems","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"structure","title":"Exploiting matrix structure","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"next-1","title":"Next steps","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"overview-2","title":"Overdetermined linear systems","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"fitting","title":"Fitting functions to data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"normaleqns","title":"The normal equations","description":"","date":"","thumbnail":"/fnc/build/normaleqns2d-3a9bdadad6b0273ad3bb332f316bfd7c.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"qr","title":"The QR factorization","description":"","date":"","thumbnail":"/fnc/build/nonorthogonal-b17ed1afa4e72fd15dc1d03a95b2c3d7.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"house","title":"Computing QR factorizations","description":"","date":"","thumbnail":"/fnc/build/hhreflect-4c7ca3f245617111b6fd9e68dcaee10e.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"next-2","title":"Next steps","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"overview-3","title":"Roots of nonlinear equations","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"rootproblem","title":"The rootfinding problem","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fixed-point","title":"Fixed-point iteration","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"newton","title":"Newton’s method","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"secant","title":"Interpolation-based methods","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"newtonsys","title":"Newton for nonlinear systems","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"quasinewton","title":"Quasi-Newton methods","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"nlsq","title":"Nonlinear least squares","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"next-3","title":"Next steps","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"overview-4","title":"Piecewise interpolation","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"interpolation","title":"The interpolation problem","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"pwlin","title":"Piecewise linear interpolation","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"splines","title":"Cubic splines","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"finitediffs","title":"Finite differences","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fd-converge","title":"Convergence of finite differences","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"integration","title":"Numerical integration","description":"","date":"","thumbnail":"/fnc/build/trapezoid-a279167525570df0e1ac47b0fceef54c.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"adaptive","title":"Adaptive integration","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"next-4","title":"Next steps","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"overview-5","title":"Initial-value problems for ODEs","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"basics","title":"Basics of IVPs","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"euler","title":"Euler’s method","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"systems","title":"IVP systems","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"rk","title":"Runge–Kutta methods","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"adaptive-rk","title":"Adaptive Runge–Kutta","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"multistep","title":"Multistep methods","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"implicit","title":"Implementation of multistep methods","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"zerostability","title":"Zero-stability of multistep methods","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"next-5","title":"Next steps","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Appendices"},{"slug":"linear-algebra","title":"Review of linear algebra","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":2,"title":"Julia codes"},{"slug":"chapter1","title":"Chapter 1","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter2","title":"Chapter 2","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter3","title":"Chapter 3","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter4","title":"Chapter 4","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter5","title":"Chapter 5","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter6","title":"Chapter 6","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":2,"title":"MATLAB codes"},{"slug":"chapter1-1","title":"Chapter 1","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter2-1","title":"Chapter 2","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter3-1","title":"Chapter 3","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter4-1","title":"Chapter 4","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter5-1","title":"Chapter 5","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter6-1","title":"Chapter 6","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":2,"title":"Python codes"},{"slug":"chapter1-2","title":"Chapter 1","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter2-2","title":"Chapter 2","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter3-2","title":"Chapter 3","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter4-2","title":"Chapter 4","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter5-2","title":"Chapter 5","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter6-2","title":"Chapter 6","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"genindex","title":"Index","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1}]}]},"page":{"kind":"Notebook","sha256":"34e7de4e4311698081c7e8ab4b86a90e3aa62baf90abdc42a6536fa676356a9d","slug":"chapter6","location":"/julia/chapter6.md","dependencies":[],"frontmatter":{"title":"Chapter 6","numbering":{"heading_1":{"enabled":false},"heading_2":{"enabled":false},"heading_3":{"enabled":false},"heading_4":{"enabled":false},"heading_5":{"enabled":false},"heading_6":{"enabled":false}},"kernelspec":{"name":"julia-1.11","display_name":"Julia 1","language":"julia"},"content_includes_title":false,"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"LU":"lower triangular times upper triangular","QR":"orthogonal times upper triangular"},"exports":[{"format":"md","filename":"chapter6.md","url":"/fnc/build/chapter6-f73b4768abf3669ed1ca345639f0511b.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Functions","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"ksbg82fHGp"}],"identifier":"functions","label":"Functions","html_id":"functions","implicit":true,"key":"WNua1F6TDd"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Euler’s method for an initial-value problem","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"sgbgqdPjBE"}],"key":"QNlSWMUdJZ"},{"type":"include","file":"../julia/package/src/chapter06.jl","literal":true,"filter":{"lines":[[1,21]]},"children":[{"type":"code","value":"\"\"\"\n    euler(ivp,n)\n\nApply Euler's method to solve the given IVP using `n` time steps.\nReturns a vector of times and a vector of solution values.\n\"\"\"\nfunction euler(ivp,n)\n    # Time discretization.\n    a,b = ivp.tspan\n    h = (b-a)/n\n    t = [ a + i*h for i in 0:n ]\n\n    # Initial condition and output setup.\n    u = fill(float(ivp.u0),n+1)\n\n    # The time stepping iteration.\n    for i in 1:n\n        u[i+1] = u[i] + h*ivp.f(u[i],ivp.p,t[i])\n    end\n    return t,u\nend","lang":"julia","showLineNumbers":true,"filename":"euler.jl","key":"AvEwyGDaB0"}],"key":"Q0dgm4POJD"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"About the code","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"hFtTyL51JV"}],"key":"nbyxMyoQcE"},{"type":"paragraph","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"KaFHjSMAzz"},{"type":"inlineCode","value":"ivp","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"ofOWJy9tIo"},{"type":"text","value":" input argument is an ","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"t2s0Tib2vR"},{"type":"inlineCode","value":"ODEProblem","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"f4PLwx3o1I"},{"type":"text","value":", like in ","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"tkgnhJtPr8"},{"type":"crossReference","kind":"proof:example","identifier":"demo-basics-first","label":"demo-basics-first","children":[{"type":"text","value":"Demo ","key":"kZxJjNHR2F"},{"type":"text","value":"6.1.2","key":"x1ebICNiYk"}],"template":"Example %s","enumerator":"6.1.2","resolved":true,"html_id":"demo-basics-first","remote":true,"url":"/basics","dataUrl":"/basics.json","key":"POzM38GgOM"},{"type":"text","value":". It has fields ","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"aYbnn2OwNN"},{"type":"inlineCode","value":"ivp.f","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"ChVF6LqjDv"},{"type":"text","value":", ","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"KuNOT8QQ7t"},{"type":"inlineCode","value":"ivp.tspan","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"t9st1paK6t"},{"type":"text","value":", ","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"KyklK5knpq"},{"type":"inlineCode","value":"ivp.u0","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"PvAN45ku7w"},{"type":"text","value":", and ","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"WJtUDNPS9J"},{"type":"inlineCode","value":"ivp.p","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"TAJEynaJ0Q"},{"type":"text","value":" that fully define the problem. The outputs are vectors of the nodes and approximate solution values at those nodes.","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"w6GIaHF1JN"}],"key":"qZXgZwNicz"}],"class":"dropdown","key":"zI0JOAgiey"}],"label":"function-euler-julia","identifier":"function-euler-julia","html_id":"function-euler-julia","key":"VFzjA9qsZk"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Improved Euler method for an IVP","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"X1I3XTJmGw"}],"key":"jKfIz3bS1m"},{"type":"include","file":"../julia/package/src/chapter06.jl","literal":true,"filter":{"lines":[[23,45]]},"children":[{"type":"code","value":"\"\"\"\n    ie2(ivp,n)\n\nApply the Improved Euler method to solve the given IVP using `n`\ntime steps. Returns a vector of times and a vector of solution\nvalues.\n\"\"\"\nfunction ie2(ivp,n)\n    # Time discretization.\n    a,b = ivp.tspan\n    h = (b-a)/n\n    t = [ a + i*h for i in 0:n ]\n\n    # Initialize output.\n    u = fill(float(ivp.u0),n+1)\n\n    # Time stepping.\n    for i in 1:n\n        uhalf = u[i] + h/2*ivp.f(u[i],ivp.p,t[i]);\n        u[i+1] = u[i] + h*ivp.f(uhalf,ivp.p,t[i]+h/2);\n    end\n    return t,u\nend","lang":"julia","showLineNumbers":true,"filename":"ie2.jl","key":"W1E60klhg8"}],"key":"gVZIvUxl9W"}],"label":"function-ie2-julia","identifier":"function-ie2-julia","html_id":"function-ie2-julia","key":"Dzm6qOkZwq"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Fourth-order Runge-Kutta for an IVP","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"s3Sen4ZZ3R"}],"key":"VFiOgeZspo"},{"type":"include","file":"../julia/package/src/chapter06.jl","literal":true,"filter":{"lines":[[47,73]]},"children":[{"type":"code","value":"\"\"\"\n    rk4(ivp,n)\n\nApply the common Runge-Kutta 4th order method to solve the given\nIVP using `n` time steps. Returns a vector of times and a vector of\nsolution values.\n\"\"\"\nfunction rk4(ivp,n)\n\n    # Time discretization.\n    a,b = ivp.tspan\n    h = (b-a)/n\n    t = [ a + i*h for i in 0:n ]\n\n    # Initialize output.\n    u = fill(float(ivp.u0),n+1)\n\n    # Time stepping.\n    for i in 1:n\n        k₁ = h*ivp.f( u[i],      ivp.p, t[i]     )\n        k₂ = h*ivp.f( u[i]+k₁/2, ivp.p, t[i]+h/2 )\n        k₃ = h*ivp.f( u[i]+k₂/2, ivp.p, t[i]+h/2 )\n        k₄ = h*ivp.f( u[i]+k₃,   ivp.p, t[i]+h   )\n        u[i+1] = u[i] + (k₁ + 2(k₂+k₃) + k₄)/6\n    end\n    return t,u\nend","lang":"julia","showLineNumbers":true,"filename":"rk4.jl","key":"brTKHZ6n8g"}],"key":"ypqqP5NcoE"}],"label":"function-rk4-julia","identifier":"function-rk4-julia","html_id":"function-rk4-julia","key":"qjVIRHZ469"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Adaptive IVP solver based on embedded RK formulas","position":{"start":{"line":51,"column":1},"end":{"line":51,"column":1}},"key":"uK7OK5blp8"}],"key":"kkAtgHVD0A"},{"type":"include","file":"../julia/package/src/chapter06.jl","literal":true,"filter":{"lines":[[75,121]]},"children":[{"type":"code","value":"\"\"\"\n    rk23(ivp,tol)\n\nApply an adaptive embedded RK formula pair to solve given IVP with\nestimated error `tol`. Returns a vector of times and a vector of\nsolution values.\n\"\"\"\nfunction rk23(ivp,tol)\n    # Initialize for the first time step.\n    a,b = ivp.tspan\n    t = [a]\n    u = [float(ivp.u0)];   i = 1;\n    h = 0.5*tol^(1/3)\n    s₁ = ivp.f(ivp.u0,ivp.p,a)\n\n    # Time stepping.\n    while t[i] \u003c b\n        # Detect underflow of the step size.\n        if t[i]+h == t[i]\n            @warn \"Stepsize too small near t=$(t[i])\"\n            break  # quit time stepping loop\n        end\n\n        # New RK stages.\n        s₂ = ivp.f( u[i]+(h/2)*s₁,   ivp.p, t[i]+h/2   )\n        s₃ = ivp.f( u[i]+(3h/4)*s₂, ivp.p, t[i]+3h/4 )\n        unew3 = u[i] + h*(2s₁  + 3s₂ + 4s₃)/9   # 3rd order solution\n        s₄ = ivp.f( unew3, ivp.p, t[i]+h )\n        err = h*(-5s₁/72 + s₂/12 + s₃/9 - s₄/8)  # 2nd/3rd difference\n        E = norm(err,Inf)                         # error estimate\n        maxerr = tol*(1 + norm(u[i],Inf))     # relative/absolute blend\n\n        # Accept the proposed step?\n        if E \u003c maxerr     # yes\n            push!(t,t[i]+h)\n            push!(u,unew3)\n            i += 1\n            s₁ = s₄       # use FSAL property\n        end\n\n        # Adjust step size.\n        q = 0.8*(maxerr/E)^(1/3)   # conservative optimal step factor\n        q = min(q,4)               # limit stepsize growth\n        h = min(q*h,b-t[i])        # don't step past the end\n    end\n    return t,u\nend","lang":"julia","showLineNumbers":true,"filename":"rk23.jl","key":"JQiyw0yjpA"}],"key":"y0FLqV9m76"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"About the code","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"iwUba5Q9Tu"}],"key":"zruHpAYGMf"},{"type":"paragraph","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"children":[{"type":"text","value":"The check ","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"pvElb1QuEc"},{"type":"inlineCode","value":"t[i]+h == t[i]","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"zqIqAxYVsS"},{"type":"text","value":"on line 19 is to detect when ","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"KJ2Oi5ZUSm"},{"type":"inlineMath","value":"h","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003eh\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003eh\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003eh\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"HQk6hBkYmR"},{"type":"text","value":" has become so small that it no longer changes the floating-point value of ","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"eY8ZBxFKcQ"},{"type":"inlineMath","value":"t_i","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsub\u003e\u003cmi\u003et\u003c/mi\u003e\u003cmi\u003ei\u003c/mi\u003e\u003c/msub\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003et_i\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.7651em;vertical-align:-0.15em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003et\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3117em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003ei\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"OFTQxVfjRd"},{"type":"text","value":". This may be a sign that the underlying exact solution has a singularity near ","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"kv4ynz0BJS"},{"type":"inlineMath","value":"t=t_i","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003et\u003c/mi\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmsub\u003e\u003cmi\u003et\u003c/mi\u003e\u003cmi\u003ei\u003c/mi\u003e\u003c/msub\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003et=t_i\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6151em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003et\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.7651em;vertical-align:-0.15em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003et\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3117em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003ei\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"LYOx4olhzU"},{"type":"text","value":", but in any case, the solver must halt by using a ","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"bwFPcOpGRv"},{"type":"inlineCode","value":"break","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"GCDoSWr7Ym"},{"type":"text","value":" statement to exit the loop.","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"rY7L2I4ClZ"}],"key":"LeWVJCCUcF"},{"type":"paragraph","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"children":[{"type":"text","value":"On line 30, we use a combination of absolute and relative tolerances to judge the acceptability of a solution value, as in ","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"key":"BOVMjyQWka"},{"type":"crossReference","kind":"equation","identifier":"absreltolerance","label":"absreltolerance","children":[{"type":"text","value":"(","key":"TGuTReKjAl"},{"type":"text","value":"5.7.6","key":"M1k7Y1uW8K"},{"type":"text","value":")","key":"VoqR1Bc3mQ"}],"template":"(%s)","enumerator":"5.7.6","resolved":true,"html_id":"absreltolerance","remote":true,"url":"/adaptive","dataUrl":"/adaptive.json","key":"xb1Zh7lTs2"},{"type":"text","value":". In lines 41--43 we underestimate the step factor ","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"key":"IHt1XSQHAl"},{"type":"inlineMath","value":"q","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003eq\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003eq\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003eq\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"EX1aKWCLdd"},{"type":"text","value":" a bit and prevent a huge increase in the step size, since a rejected step is expensive, and then we make sure that our final step doesn’t take us past the end of the domain.","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"key":"EAf6blaVu3"}],"key":"R8joh7JEsn"},{"type":"paragraph","position":{"start":{"line":65,"column":1},"end":{"line":66,"column":1}},"children":[{"type":"text","value":"Finally, line 37 exploits a subtle property of the BS23 formula called ","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"OAQhWAJNfP"},{"type":"emphasis","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"children":[{"type":"text","value":"first same as last","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"D2Yv9AhQHV"}],"key":"jr8LJxIFHV"},{"type":"text","value":" (FSAL).\nWhile ","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"ttQnjd2cba"},{"type":"crossReference","kind":"equation","identifier":"bs23","label":"bs23","children":[{"type":"text","value":"(","key":"G1sIMEjsMT"},{"type":"text","value":"6.5.5","key":"dQUfIQOgx1"},{"type":"text","value":")","key":"NtuCoRCs0l"}],"template":"(%s)","enumerator":"6.5.5","resolved":true,"html_id":"bs23","remote":true,"url":"/adaptive-rk","dataUrl":"/adaptive-rk.json","key":"tR5Y8Y4F8V"},{"type":"text","value":" calls for four stages to find the paired second- and third-order estimates, the final stage computed in stepping from ","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"X7L32wX8Mq"},{"type":"inlineMath","value":"t_i","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsub\u003e\u003cmi\u003et\u003c/mi\u003e\u003cmi\u003ei\u003c/mi\u003e\u003c/msub\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003et_i\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.7651em;vertical-align:-0.15em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003et\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3117em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003ei\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"NULO7JCyQP"},{"type":"text","value":" to ","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"DPmwpPxg5j"},{"type":"inlineMath","value":"t_{i+1}","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsub\u003e\u003cmi\u003et\u003c/mi\u003e\u003cmrow\u003e\u003cmi\u003ei\u003c/mi\u003e\u003cmo\u003e+\u003c/mo\u003e\u003cmn\u003e1\u003c/mn\u003e\u003c/mrow\u003e\u003c/msub\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003et_{i+1}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8234em;vertical-align:-0.2083em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003et\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3117em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003ei\u003c/span\u003e\u003cspan class=\"mbin mtight\"\u003e+\u003c/span\u003e\u003cspan class=\"mord mtight\"\u003e1\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.2083em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"jb3GVVHDWj"},{"type":"text","value":" is identical to the first stage needed to step from ","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"xZHUV0jtt3"},{"type":"inlineMath","value":"t_{i+1}","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsub\u003e\u003cmi\u003et\u003c/mi\u003e\u003cmrow\u003e\u003cmi\u003ei\u003c/mi\u003e\u003cmo\u003e+\u003c/mo\u003e\u003cmn\u003e1\u003c/mn\u003e\u003c/mrow\u003e\u003c/msub\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003et_{i+1}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8234em;vertical-align:-0.2083em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003et\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3117em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003ei\u003c/span\u003e\u003cspan class=\"mbin mtight\"\u003e+\u003c/span\u003e\u003cspan class=\"mord mtight\"\u003e1\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.2083em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"kNZjVv8HMb"},{"type":"text","value":" to ","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"TN6dJeVdYJ"},{"type":"inlineMath","value":"t_{i+2}","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsub\u003e\u003cmi\u003et\u003c/mi\u003e\u003cmrow\u003e\u003cmi\u003ei\u003c/mi\u003e\u003cmo\u003e+\u003c/mo\u003e\u003cmn\u003e2\u003c/mn\u003e\u003c/mrow\u003e\u003c/msub\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003et_{i+2}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8234em;vertical-align:-0.2083em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003et\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3117em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003ei\u003c/span\u003e\u003cspan class=\"mbin mtight\"\u003e+\u003c/span\u003e\u003cspan class=\"mord mtight\"\u003e2\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.2083em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"XrjQ8dHmx9"},{"type":"text","value":". By repurposing ","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"RuvC8dh4zU"},{"type":"inlineCode","value":"s₄","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"DQgUSGQFER"},{"type":"text","value":" as ","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"sa588JtmcR"},{"type":"inlineCode","value":"s₁","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"WvTSgSGTRy"},{"type":"text","value":" for the next pass, one of the stage evaluations comes for free, and only three evaluations of ","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"h0I1IgIfdc"},{"type":"inlineMath","value":"f","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003ef\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003ef\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.10764em;\"\u003ef\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"fyyAXEpEXN"},{"type":"text","value":" are needed per successful step.","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"pN5YyRRpwT"}],"key":"RnSwKudv3H"}],"class":"dropdown","key":"PfGtNmTtzU"}],"label":"function-rk23-julia","identifier":"function-rk23-julia","html_id":"function-rk23-julia","key":"GuqGyS3a2C"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"4th-order Adams–Bashforth formula for an IVP","position":{"start":{"line":72,"column":1},"end":{"line":72,"column":1}},"key":"k6sHJ64eeh"}],"key":"vP2LvYgiVO"},{"type":"include","file":"../julia/package/src/chapter06.jl","literal":true,"filter":{"lines":[[123,154]]},"children":[{"type":"code","value":"\"\"\"\n    ab4(ivp,n)\n\nApply the Adams-Bashforth 4th order method to solve the given IVP\nusing `n` time steps. Returns a vector of times and a vector of\nsolution values.\n\"\"\"\nfunction ab4(ivp,n)\n    # Time discretization.\n    a,b = ivp.tspan\n    h = (b-a)/n\n    t = [ a + i*h for i in 0:n ]\n\n    # Constants in the AB4 method.\n    k = 4;   σ = [55,-59,37,-9]/24;\n\n    # Find starting values by RK4.\n    u = fill(float(ivp.u0),n+1)\n    rkivp = ODEProblem(ivp.f,ivp.u0,(a,a+(k-1)*h),ivp.p)\n    ts,us = rk4(rkivp,k-1)\n    u[1:k] .= us\n\n    # Compute history of u' values, from newest to oldest.\n    f = [ ivp.f(u[k-i],ivp.p,t[k-i]) for i in 1:k-1  ]\n\n    # Time stepping.\n    for i in k:n\n        f = [ ivp.f(u[i],ivp.p,t[i]), f[1:k-1]... ]   # new value of du/dt\n        u[i+1] = u[i] + h*sum(f[j]*σ[j] for j in 1:k)  # advance a step\n    end\n    return t,u\nend","lang":"julia","showLineNumbers":true,"filename":"ab4.jl","key":"uCj8viP7yJ"}],"key":"PnH2ekI7fW"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"About the code","position":{"start":{"line":80,"column":1},"end":{"line":80,"column":1}},"key":"jlRBQl8okI"}],"key":"BoIKreXIxL"},{"type":"paragraph","position":{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},"children":[{"type":"text","value":"Line 15 sets ","position":{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},"key":"SFfhFbBCtj"},{"type":"inlineCode","value":"σ","position":{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},"key":"uLq8GLVWWP"},{"type":"text","value":" to be the coefficients of the generating polynomial ","position":{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},"key":"RAgldqQovz"},{"type":"inlineMath","value":"\\sigma(z)","position":{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003eσ\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmi\u003ez\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\sigma(z)\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003eσ\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.04398em;\"\u003ez\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"oBhTV8pgbX"},{"type":"text","value":" of AB4. Lines 19--21 set up the IVP over the time interval ","position":{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},"key":"jyNNRMvoiF"},{"type":"inlineMath","value":"a \\le t \\le a+3 h","position":{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003ea\u003c/mi\u003e\u003cmo\u003e≤\u003c/mo\u003e\u003cmi\u003et\u003c/mi\u003e\u003cmo\u003e≤\u003c/mo\u003e\u003cmi\u003ea\u003c/mi\u003e\u003cmo\u003e+\u003c/mo\u003e\u003cmn\u003e3\u003c/mn\u003e\u003cmi\u003eh\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003ea \\le t \\le a+3 h\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.7719em;vertical-align:-0.136em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003ea\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e≤\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.7719em;vertical-align:-0.136em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003et\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e≤\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003ea\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e+\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e3\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003eh\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"Cb8rFTR9vG"},{"type":"text","value":", call ","position":{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},"key":"gBCGsRqw8P"},{"type":"inlineCode","value":"rk4","position":{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},"key":"Y6oVuDyubK"},{"type":"text","value":" to solve it using the step size ","position":{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},"key":"hyWFMiZeBi"},{"type":"inlineMath","value":"h","position":{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003eh\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003eh\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003eh\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"LGYBEp1SVx"},{"type":"text","value":", and use the result to fill the first four values of the solution. Then line 24 computes the vector ","position":{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},"key":"Gyh4gOspJs"},{"type":"inlineMath","value":"[f_2,f_1,f_0]","position":{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmo stretchy=\"false\"\u003e[\u003c/mo\u003e\u003cmsub\u003e\u003cmi\u003ef\u003c/mi\u003e\u003cmn\u003e2\u003c/mn\u003e\u003c/msub\u003e\u003cmo separator=\"true\"\u003e,\u003c/mo\u003e\u003cmsub\u003e\u003cmi\u003ef\u003c/mi\u003e\u003cmn\u003e1\u003c/mn\u003e\u003c/msub\u003e\u003cmo separator=\"true\"\u003e,\u003c/mo\u003e\u003cmsub\u003e\u003cmi\u003ef\u003c/mi\u003e\u003cmn\u003e0\u003c/mn\u003e\u003c/msub\u003e\u003cmo stretchy=\"false\"\u003e]\u003c/mo\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e[f_2,f_1,f_0]\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mopen\"\u003e[\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.10764em;\"\u003ef\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3011em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e2\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mpunct\"\u003e,\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.1667em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.10764em;\"\u003ef\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3011em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e1\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mpunct\"\u003e,\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.1667em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.10764em;\"\u003ef\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3011em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e0\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose\"\u003e]\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"B7WMYX3uTA"},{"type":"text","value":".","position":{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},"key":"Ygqoewhe68"}],"key":"nVa1iCU3zD"},{"type":"paragraph","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"children":[{"type":"text","value":"Line 28 computes ","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"key":"z2XMMsiTmY"},{"type":"inlineMath","value":"f_i","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsub\u003e\u003cmi\u003ef\u003c/mi\u003e\u003cmi\u003ei\u003c/mi\u003e\u003c/msub\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003ef_i\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.10764em;\"\u003ef\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3117em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003ei\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"LWxi8rVvK5"},{"type":"text","value":", based on the most recent solution value and time. That goes into the first spot of ","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"key":"KHG7hkboEp"},{"type":"inlineCode","value":"f","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"key":"JxwHlw6guq"},{"type":"text","value":", followed by the three values that were previously most recent. These are the four values that appear in ","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"key":"E1lOBnGIYQ"},{"type":"crossReference","kind":"equation","identifier":"ab4","label":"ab4","children":[{"type":"text","value":"(","key":"TVI40UyMtZ"},{"type":"text","value":"6.7.1","key":"A7kTlPNC0f"},{"type":"text","value":")","key":"JBjhQpksC6"}],"template":"(%s)","enumerator":"6.7.1","resolved":true,"html_id":"ab4","remote":true,"url":"/implicit","dataUrl":"/implicit.json","key":"VfFTVLbwEa"},{"type":"text","value":". Each particular ","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"key":"aNY1r8QGAI"},{"type":"inlineMath","value":"f_i","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsub\u003e\u003cmi\u003ef\u003c/mi\u003e\u003cmi\u003ei\u003c/mi\u003e\u003c/msub\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003ef_i\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.10764em;\"\u003ef\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3117em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003ei\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"DhTpBEQYCN"},{"type":"text","value":" value starts at the front of ","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"key":"YIHGLiZ1hI"},{"type":"inlineCode","value":"f","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"key":"s8BK1NrCxu"},{"type":"text","value":", moves through each position in the vector over three iterations, and then is forgotten.","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"key":"FlSfj1m7b5"}],"key":"b254nWxPAQ"}],"class":"dropdown","key":"AsCziuMr7X"}],"label":"function-ab4-julia","identifier":"function-ab4-julia","html_id":"function-ab4-julia","key":"vYjUk7wVzZ"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"2nd-order Adams–Moulton (trapezoid) formula for an IVP","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"key":"DoOfuSOXyN"}],"key":"u2vVLfkNLm"},{"type":"include","file":"../julia/package/src/chapter06.jl","literal":true,"filter":{"lines":[[156,182]]},"children":[{"type":"code","value":"\"\"\"\n    am2(ivp,n)\n\nApply the Adams-Moulton 2nd order method to solve given IVP using\n`n` time steps. Returns a vector of times and a vector of\nsolution values.\n\"\"\"\nfunction am2(ivp,n)\n    # Time discretization.\n    a,b = ivp.tspan\n    h = (b-a)/n\n    t = [ a + i*h for i in 0:n ]\n\n    # Initialize output.\n    u = fill(float(ivp.u0),n+1)\n\n    # Time stepping.\n    for i in 1:n\n        # Data that does not depend on the new value.\n        known = u[i] + h/2*ivp.f(u[i],ivp.p,t[i])\n        # Find a root for the new value.\n        g = z -\u003e z - h/2*ivp.f(z,ivp.p,t[i+1]) - known\n        unew = levenberg(g,known)\n        u[i+1] = unew[end]\n    end\n    return t,u\nend","lang":"julia","showLineNumbers":true,"filename":"am2.jl","key":"dtzdZuxxTp"}],"key":"iqy9OFpGcg"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"About the code","position":{"start":{"line":97,"column":1},"end":{"line":97,"column":1}},"key":"JdNkmCwmK5"}],"key":"MXcCAc64PV"},{"type":"paragraph","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"children":[{"type":"text","value":"Lines 22-23 define the function ","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"key":"QZH3aQAtLS"},{"type":"inlineMath","value":"\\mathbf{g}","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi mathvariant=\"bold\"\u003eg\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\mathbf{g}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6389em;vertical-align:-0.1944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathbf\" style=\"margin-right:0.01597em;\"\u003eg\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"T8TEKuWiQT"},{"type":"text","value":" and call ","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"key":"RJe0WwaABr"},{"type":"inlineCode","value":"levenberg","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"key":"TuPJSomuRM"},{"type":"text","value":" to find the new solution value, using an Euler half-step as its starting value. A robust code would have to intercept the case where ","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"key":"fX0LDviqni"},{"type":"inlineCode","value":"levenberg","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"key":"Mugu0zSnGB"},{"type":"text","value":" fails to converge, but we have ignored this issue for the sake of brevity.","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"key":"kSbkNlXmAx"}],"key":"iW99LM4cLD"}],"class":"dropdown","key":"NabbgXQUyL"}],"label":"function-am2-julia","identifier":"function-am2-julia","html_id":"function-am2-julia","key":"yHhx65ug2W"},{"type":"heading","depth":2,"position":{"start":{"line":103,"column":1},"end":{"line":103,"column":1}},"children":[{"type":"text","value":"Examples","position":{"start":{"line":103,"column":1},"end":{"line":103,"column":1}},"key":"Cxiuqbhp9B"}],"identifier":"examples","label":"Examples","html_id":"examples","implicit":true,"key":"IPso2wQgkV"}],"key":"yKK3tcK3xO"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"import Pkg; Pkg.activate(\"/Users/driscoll/Documents/GitHub/fnc\")\nusing FundamentalsNumericalComputation\nFNC.init_format()","visibility":"show","key":"COFstLdlm5"},{"type":"output","id":"n5IyIQLzhtxi71LHzBJ_9","data":[{"output_type":"stream","name":"stderr","text":"\u001b[32m\u001b[1m  Activating\u001b[22m\u001b[39m "},{"output_type":"stream","name":"stderr","text":"project at `~/Documents/GitHub/fnc`\n\u001b[36m\u001b[1m[ \u001b[22m\u001b[39m\u001b[36m\u001b[1mInfo: \u001b[22m\u001b[39mverify download of index files...\n\u001b[36m\u001b[1m[ \u001b[22m\u001b[39m\u001b[36m\u001b[1mInfo: \u001b[22m\u001b[39mreading database\n"},{"output_type":"stream","name":"stdout","text":"EOFError("},{"output_type":"stream","name":"stdout","text":")\n"},{"output_type":"stream","name":"stderr","text":"\u001b[33m\u001b[1m┌ \u001b[22m\u001b[39m\u001b[33m\u001b[1mWarning: \u001b[22m\u001b[39mrecreating database file\n\u001b[33m\u001b[1m└ \u001b[22m\u001b[39m\u001b[90m@ MatrixDepot ~/.julia/packages/MatrixDepot/4S7Oa/src/download.jl:59\u001b[39m\n\u001b[36m\u001b[1m[ \u001b[22m\u001b[39m\u001b[36m\u001b[1mInfo: \u001b[22m\u001b[39mreading index files\n\u001b[36m\u001b[1m[ \u001b[22m\u001b[39m\u001b[36m\u001b[1mInfo: \u001b[22m\u001b[39madding metadata...\n\u001b[36m\u001b[1m[ \u001b[22m\u001b[39m\u001b[36m\u001b[1mInfo: \u001b[22m\u001b[39madding svd data...\n"},{"output_type":"stream","name":"stderr","text":"\u001b[36m\u001b[1m[ \u001b[22m\u001b[39m\u001b[36m\u001b[1mInfo: \u001b[22m\u001b[39mwriting database\n\u001b[33m\u001b[1m┌ \u001b[22m\u001b[39m\u001b[33m\u001b[1mWarning: \u001b[22m\u001b[39mexception during initialization: 'KeyError(MatrixDepot)'\n\u001b[33m\u001b[1m└ \u001b[22m\u001b[39m\u001b[90m@ MatrixDepot ~/.julia/packages/MatrixDepot/4S7Oa/src/MatrixDepot.jl:125\u001b[39m\n"}],"visibility":"remove","key":"O2YIx8MH0g"}],"data":{"tags":[]},"visibility":"show","key":"cWHpxJOw3u"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":112,"column":1},"end":{"line":112,"column":1}},"children":[{"type":"text","value":"Section 6.1","position":{"start":{"line":112,"column":1},"end":{"line":112,"column":1}},"key":"Iu0UCUyzMj"}],"identifier":"section-6-1","label":"Section 6.1","html_id":"section-6-1","implicit":true,"key":"kPm2neEw4j"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Solving an IVP","position":{"start":{"line":114,"column":1},"end":{"line":114,"column":1}},"key":"vokJbmKgQy"}],"key":"eBLPLoDfjh"},{"type":"paragraph","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"key":"Xhoc4dVSUI"},{"type":"inlineCode","value":"DifferentialEquations","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"key":"p86Fd1fZ5u"},{"type":"text","value":" package offers solvers for IVPs. Let’s use it to define and solve an initial-value problem for ","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"key":"OtbIAEbhHe"},{"type":"inlineMath","value":"u'=\\sin[(u+t)^2]","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsup\u003e\u003cmi\u003eu\u003c/mi\u003e\u003cmo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\"\u003e′\u003c/mo\u003e\u003c/msup\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmi\u003esin\u003c/mi\u003e\u003cmo\u003e⁡\u003c/mo\u003e\u003cmo stretchy=\"false\"\u003e[\u003c/mo\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmi\u003eu\u003c/mi\u003e\u003cmo\u003e+\u003c/mo\u003e\u003cmi\u003et\u003c/mi\u003e\u003cmsup\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003cmn\u003e2\u003c/mn\u003e\u003c/msup\u003e\u003cmo stretchy=\"false\"\u003e]\u003c/mo\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003eu\u0026#x27;=\\sin[(u+t)^2]\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.7519em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003eu\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.7519em;\"\u003e\u003cspan style=\"top:-3.063em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e′\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mop\"\u003esin\u003c/span\u003e\u003cspan class=\"mopen\"\u003e[(\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003eu\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e+\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003et\u003c/span\u003e\u003cspan class=\"mclose\"\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.8141em;\"\u003e\u003cspan style=\"top:-3.063em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e2\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose\"\u003e]\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"Qoj2Ij7MEz"},{"type":"text","value":" over ","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"key":"O4NoJt6Z9o"},{"type":"inlineMath","value":"t \\in [0,4]","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003et\u003c/mi\u003e\u003cmo\u003e∈\u003c/mo\u003e\u003cmo stretchy=\"false\"\u003e[\u003c/mo\u003e\u003cmn\u003e0\u003c/mn\u003e\u003cmo separator=\"true\"\u003e,\u003c/mo\u003e\u003cmn\u003e4\u003c/mn\u003e\u003cmo stretchy=\"false\"\u003e]\u003c/mo\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003et \\in [0,4]\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6542em;vertical-align:-0.0391em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003et\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e∈\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mopen\"\u003e[\u003c/span\u003e\u003cspan class=\"mord\"\u003e0\u003c/span\u003e\u003cspan class=\"mpunct\"\u003e,\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.1667em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e4\u003c/span\u003e\u003cspan class=\"mclose\"\u003e]\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"iVJ4pGqiKI"},{"type":"text","value":", such that ","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"key":"RTERK1LG7P"},{"type":"inlineMath","value":"u(0)=-1","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003eu\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmn\u003e0\u003c/mn\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmo\u003e−\u003c/mo\u003e\u003cmn\u003e1\u003c/mn\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003eu(0)=-1\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003eu\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord\"\u003e0\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e−\u003c/span\u003e\u003cspan class=\"mord\"\u003e1\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"rdDKdpuD3T"},{"type":"text","value":".","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"key":"eyQMVYaNQP"}],"key":"N0kTYC6owU"},{"type":"grid","columns":[1,1,2,2],"children":[{"type":"paragraph","position":{"start":{"line":118,"column":1},"end":{"line":118,"column":1}},"children":[{"type":"text","value":"Because many practical problems come with parameters that are fixed within an instance but varied from one instance to another, the syntax for IVPs includes a input argument ","position":{"start":{"line":118,"column":1},"end":{"line":118,"column":1}},"key":"Y5WOyC1L1w"},{"type":"inlineCode","value":"p","position":{"start":{"line":118,"column":1},"end":{"line":118,"column":1}},"key":"sZ5tzH43Q4"},{"type":"text","value":" that stays fixed throughout the solution. Here we don’t want to use that argument, but it must be in the definition for the solver to work.","position":{"start":{"line":118,"column":1},"end":{"line":118,"column":1}},"key":"AAX8d6wOw4"}],"key":"z91evXI8X3"},{"type":"card","children":[{"type":"paragraph","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"children":[{"type":"text","value":"To create an initial-value problem for ","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"key":"SU0CSZjGqD"},{"type":"inlineMath","value":"u(t)","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003eu\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmi\u003et\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003eu(t)\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003eu\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003et\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"il9rb5XLBu"},{"type":"text","value":", you must supply a function that computes ","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"key":"kqray4vFNR"},{"type":"inlineMath","value":"u'","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsup\u003e\u003cmi\u003eu\u003c/mi\u003e\u003cmo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\"\u003e′\u003c/mo\u003e\u003c/msup\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003eu\u0026#x27;\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.7519em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003eu\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.7519em;\"\u003e\u003cspan style=\"top:-3.063em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e′\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"LE06mXKvRl"},{"type":"text","value":", an initial value for ","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"key":"u5148EXvNV"},{"type":"inlineMath","value":"u","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003eu\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003eu\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.4306em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003eu\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"xOtFzAZPma"},{"type":"text","value":", and the endpoints of the interval for ","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"key":"JvxoFnkFgO"},{"type":"inlineMath","value":"t","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003et\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003et\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6151em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003et\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"uWSBFbyRuX"},{"type":"text","value":". The ","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"key":"xGWUVN4OIt"},{"type":"inlineMath","value":"t","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003et\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003et\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6151em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003et\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"FGBy9RtxrQ"},{"type":"text","value":" interval should be defined as ","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"key":"EnNOFMPkDi"},{"type":"inlineCode","value":"(a,b)","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"key":"cUUU1e55pP"},{"type":"text","value":", where at least one of the values is a float.","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"key":"BaxuY0xoLF"}],"key":"dCTR77At7H"}],"key":"y6O3HEGx10"}],"key":"aMNnGA3bUw"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"f(u, p, t) = sin((t + u)^2)     # defines du/dt, must include p argument\nu₀ = -1.0                       # initial value\ntspan = (0.0, 4.0)               # t interval","key":"PoMoFQp6PD"},{"type":"output","id":"nwCxq1-WiOBRJfMf9jb8G","data":[{"output_type":"execute_result","execution_count":2,"metadata":{},"data":{"text/plain":{"content":"(0.0, 4.0)","content_type":"text/plain"}}}],"key":"maIE8W2Fnr"}],"data":{},"indexEntries":[{"entry":"Julia","subEntry":{"value":"ODEProblem","kind":"entry"},"emphasis":true},{"entry":"Julia","subEntry":{"value":"solve","kind":"entry"},"emphasis":true}],"label":"index-ayYUvD4w8h","identifier":"index-ayyuvd4w8h","html_id":"index-ayyuvd4w8h","key":"yAW1SbAbP7"},{"type":"paragraph","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"children":[{"type":"text","value":"With the data above we define an IVP problem object and then solve it. Here we tell the solver to use the ","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"key":"NsBqYICmQA"},{"type":"inlineCode","value":"Tsit5","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"key":"zF9fWBY6qU"},{"type":"text","value":" method, which is a good first choice for most problems.","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"key":"ZSfGAgNmAO"}],"key":"GNQUvCeLdt"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"ivp = ODEProblem(f, u₀, tspan)\nsol = solve(ivp, Tsit5());","key":"UaDJsaJM9y"},{"type":"output","id":"C7O4M5HeQ04bjG-ZWY8p6","data":[],"key":"cCi3H5gdgo"}],"data":{},"key":"FKaR2Ukhqq"},{"type":"paragraph","position":{"start":{"line":140,"column":1},"end":{"line":140,"column":1}},"children":[{"type":"text","value":"The resulting solution object can be shown using ","position":{"start":{"line":140,"column":1},"end":{"line":140,"column":1}},"key":"WWvtYPNXhX"},{"type":"inlineCode","value":"plot","position":{"start":{"line":140,"column":1},"end":{"line":140,"column":1}},"key":"DUtYaBnxhh"},{"type":"text","value":".","position":{"start":{"line":140,"column":1},"end":{"line":140,"column":1}},"key":"r9g9R2lilv"}],"key":"FCgldtejZE"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"plot(sol, label=\"solution\", legend=:bottom,\n    xlabel=\"t\", ylabel=L\"u(t)\", title=L\"u'=\\sin((t+u)^2)\")","key":"rt23pfKGku"},{"type":"output","id":"_RW3BnJKkW0V8oKpllbAQ","data":[{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"c1a911d4a2c83f089b47213439a5c492","path":"/fnc/build/c1a911d4a2c83f089b47213439a5c492.png"},"text/html":{"content_type":"text/html","hash":"615669b2be238210fee8cc697448d500","path":"/fnc/build/615669b2be238210fee8cc697448d500.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"a66b7b31fcb2019de27e1f19b86975f9","path":"/fnc/build/a66b7b31fcb2019de27e1f19b86975f9.svg"}}}],"key":"SEij37mp34"}],"data":{},"key":"gPHWkE6oBI"},{"type":"paragraph","position":{"start":{"line":147,"column":1},"end":{"line":147,"column":1}},"children":[{"type":"text","value":"The solution also acts like any callable function that can be evaluated at different values of ","position":{"start":{"line":147,"column":1},"end":{"line":147,"column":1}},"key":"sPtzQEzFIq"},{"type":"inlineMath","value":"t","position":{"start":{"line":147,"column":1},"end":{"line":147,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003et\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003et\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6151em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003et\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"V4YNgrXeMb"},{"type":"text","value":".","position":{"start":{"line":147,"column":1},"end":{"line":147,"column":1}},"key":"M31GEb7QMc"}],"key":"RZyd2WM2kY"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"@show sol(1.0);","key":"IZb6cwa61M"},{"type":"output","id":"lPQydevs2qNlj2cLOcFqp","data":[{"output_type":"stream","name":"stdout","text":"sol(1.0) = -0.7903205813665345\n"}],"key":"dpFStDWJhH"}],"data":{},"key":"XGlu86f8Cm"},{"type":"paragraph","position":{"start":{"line":153,"column":1},"end":{"line":153,"column":1}},"children":[{"type":"text","value":"Under the hood, the solution object holds some information about how the values and plot are produced:","position":{"start":{"line":153,"column":1},"end":{"line":153,"column":1}},"key":"y0ca1ECd6Z"}],"key":"zPYbl1h02h"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"[sol.t sol.u]","key":"Bi21GwSa1F"},{"type":"output","id":"eKynLg6hfOznJJS0oSsZ4","data":[{"output_type":"execute_result","execution_count":6,"metadata":{},"data":{"text/plain":{"content":"15×2 Matrix{Float64}:\n 0.0        -1.0\n 0.0867807  -0.93483\n 0.241035   -0.856617\n 0.464665   -0.805668\n 0.696832   -0.793614\n 1.00862    -0.789925\n 1.37461    -0.718601\n 1.70407    -0.476837\n 1.93572    -0.29033\n 2.17184    -0.294994\n 2.4843     -0.483948\n 2.69425    -0.654121\n 3.27049    -1.1783\n 3.62534    -1.51729\n 4.0        -1.88086","content_type":"text/plain"}}}],"key":"JzPGzq9BwW"}],"data":{},"key":"yEypwCnAfo"},{"type":"paragraph","position":{"start":{"line":159,"column":1},"end":{"line":159,"column":1}},"children":[{"type":"text","value":"The solver initially finds approximate values of the solution (second column above) at some automatically chosen times (first column above). To compute the solution at other times, the object performs an interpolation on those values. This chapter is about how the discrete ","position":{"start":{"line":159,"column":1},"end":{"line":159,"column":1}},"key":"fBTFmcNiIX"},{"type":"inlineMath","value":"t","position":{"start":{"line":159,"column":1},"end":{"line":159,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003et\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003et\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6151em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003et\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"g0xEMdWyOS"},{"type":"text","value":" and ","position":{"start":{"line":159,"column":1},"end":{"line":159,"column":1}},"key":"aXpSwKxheQ"},{"type":"inlineMath","value":"u","position":{"start":{"line":159,"column":1},"end":{"line":159,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003eu\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003eu\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.4306em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003eu\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"pTgvlljEei"},{"type":"text","value":" values are computed. For now, just note how we can extract them from the solution object.","position":{"start":{"line":159,"column":1},"end":{"line":159,"column":1}},"key":"uCcieixPtS"}],"key":"lzHlUePYnI"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"scatter!(sol.t, sol.u, label=\"discrete values\")","key":"f5jlCpmfxi"},{"type":"output","id":"EDwd_nQKWoZSe7BtB8BgI","data":[{"output_type":"execute_result","execution_count":7,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"a97d455ce06ece4839e5818a8d4390eb","path":"/fnc/build/a97d455ce06ece4839e5818a8d4390eb.png"},"text/html":{"content_type":"text/html","hash":"faa4fdbbb214ae63f6db6cb764cc4f89","path":"/fnc/build/faa4fdbbb214ae63f6db6cb764cc4f89.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"79ee6ba5a8aa6ce90e1b7f8121c08303","path":"/fnc/build/79ee6ba5a8aa6ce90e1b7f8121c08303.svg"}}}],"key":"iQvI5JXI0P"}],"data":{},"key":"YqmUzKmKBx"}],"label":"demo-basics-first-julia","identifier":"demo-basics-first-julia","html_id":"demo-basics-first-julia","key":"kfAuIKTleR"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Finite-time singularity","position":{"start":{"line":167,"column":1},"end":{"line":167,"column":1}},"key":"U0hnJuVwPX"}],"key":"oIhuoElHIK"},{"type":"paragraph","position":{"start":{"line":169,"column":1},"end":{"line":169,"column":1}},"children":[{"type":"text","value":"The equation ","position":{"start":{"line":169,"column":1},"end":{"line":169,"column":1}},"key":"y72Bt0FfJI"},{"type":"inlineMath","value":"u'=(u+t)^2","position":{"start":{"line":169,"column":1},"end":{"line":169,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsup\u003e\u003cmi\u003eu\u003c/mi\u003e\u003cmo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\"\u003e′\u003c/mo\u003e\u003c/msup\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmi\u003eu\u003c/mi\u003e\u003cmo\u003e+\u003c/mo\u003e\u003cmi\u003et\u003c/mi\u003e\u003cmsup\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003cmn\u003e2\u003c/mn\u003e\u003c/msup\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003eu\u0026#x27;=(u+t)^2\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.7519em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003eu\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.7519em;\"\u003e\u003cspan style=\"top:-3.063em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e′\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003eu\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e+\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003et\u003c/span\u003e\u003cspan class=\"mclose\"\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.8141em;\"\u003e\u003cspan style=\"top:-3.063em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e2\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"ZXeYG1t9en"},{"type":"text","value":" gives us some trouble.","position":{"start":{"line":169,"column":1},"end":{"line":169,"column":1}},"key":"aYj0ye4yms"}],"key":"hUdhowXPUp"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"f(u, p, t) = (t + u)^2\n\nivp = ODEProblem(f, 1.0, (0.0, 1.0))\nsol = solve(ivp, Tsit5());","key":"lZob5wWGrV"},{"type":"output","id":"mCPyUXpVWByA1z2M65Ksy","data":[{"output_type":"stream","name":"stderr","text":"\u001b[33m\u001b[1m┌ \u001b[22m\u001b[39m\u001b[33m\u001b[1mWarning: \u001b[22m\u001b[39mAt t=0.7853839417697203, dt was forced below floating point epsilon 1.1102230246251565e-16, and step error estimate = 42.16290621054672. Aborting. There is either an error in your model specification or the true solution is unstable (or the true solution can not be represented in the precision of Float64).\n\u001b[33m\u001b[1m└ \u001b[22m\u001b[39m\u001b[90m@ SciMLBase ~/.julia/packages/SciMLBase/ZyZAV/src/integrator_interface.jl:623\u001b[39m\n"}],"key":"vM4K2lFAxu"}],"data":{},"key":"AgTkdYIJXl"},{"type":"paragraph","position":{"start":{"line":178,"column":1},"end":{"line":178,"column":1}},"children":[{"type":"text","value":"The warning message we received can mean that there is a bug in the formulation of the problem. But if everything has been done correctly, it suggests that the solution may not exist past the indicated time. This is a possibility in nonlinear ODEs.","position":{"start":{"line":178,"column":1},"end":{"line":178,"column":1}},"key":"VfLuHvIxM2"}],"key":"xzOND1InSg"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"plot(sol, label=\"\",\n    xlabel=L\"t\", yaxis=(:log10, L\"u(t)\"), title=\"Finite-time blowup\")","key":"XuStlkra4U"},{"type":"output","id":"9iqhJgfxW_pbX5YRJWu9t","data":[{"output_type":"execute_result","execution_count":9,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"c3a4b5fd4476d26fdcf1206840520f67","path":"/fnc/build/c3a4b5fd4476d26fdcf1206840520f67.png"},"text/html":{"content_type":"text/html","hash":"26074fb48868c120cdd5280b76d26b9f","path":"/fnc/build/26074fb48868c120cdd5280b76d26b9f.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"fc2d4d1018e03e01a658fde2f09eb24c","path":"/fnc/build/fc2d4d1018e03e01a658fde2f09eb24c.svg"}}}],"key":"I1tpIVWwTw"}],"data":{},"key":"seooH2jevJ"}],"label":"demo-basics-sing-julia","identifier":"demo-basics-sing-julia","html_id":"demo-basics-sing-julia","key":"RASDXspf4F"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Conditioning of an IVP","position":{"start":{"line":187,"column":1},"end":{"line":187,"column":1}},"key":"SeFAFOq8Vu"}],"key":"k8DnlyYOgD"},{"type":"paragraph","position":{"start":{"line":188,"column":1},"end":{"line":188,"column":1}},"children":[{"type":"text","value":"Consider the ODEs ","position":{"start":{"line":188,"column":1},"end":{"line":188,"column":1}},"key":"eSNCBk6DTA"},{"type":"inlineMath","value":"u'=u","position":{"start":{"line":188,"column":1},"end":{"line":188,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsup\u003e\u003cmi\u003eu\u003c/mi\u003e\u003cmo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\"\u003e′\u003c/mo\u003e\u003c/msup\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmi\u003eu\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003eu\u0026#x27;=u\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.7519em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003eu\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.7519em;\"\u003e\u003cspan style=\"top:-3.063em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e′\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.4306em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003eu\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"nmZj6RQTqt"},{"type":"text","value":" and ","position":{"start":{"line":188,"column":1},"end":{"line":188,"column":1}},"key":"WltAnOoOIN"},{"type":"inlineMath","value":"u'=-u","position":{"start":{"line":188,"column":1},"end":{"line":188,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsup\u003e\u003cmi\u003eu\u003c/mi\u003e\u003cmo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\"\u003e′\u003c/mo\u003e\u003c/msup\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmo\u003e−\u003c/mo\u003e\u003cmi\u003eu\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003eu\u0026#x27;=-u\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.7519em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003eu\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.7519em;\"\u003e\u003cspan style=\"top:-3.063em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e′\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e−\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003eu\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"Nd1Z6cQ5H6"},{"type":"text","value":". In each case we compute ","position":{"start":{"line":188,"column":1},"end":{"line":188,"column":1}},"key":"bDOJo3A39o"},{"type":"inlineMath","value":"\\partial f/\\partial u = \\pm 1","position":{"start":{"line":188,"column":1},"end":{"line":188,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi mathvariant=\"normal\"\u003e∂\u003c/mi\u003e\u003cmi\u003ef\u003c/mi\u003e\u003cmi mathvariant=\"normal\"\u003e/\u003c/mi\u003e\u003cmi mathvariant=\"normal\"\u003e∂\u003c/mi\u003e\u003cmi\u003eu\u003c/mi\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmo\u003e±\u003c/mo\u003e\u003cmn\u003e1\u003c/mn\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\partial f/\\partial u = \\pm 1\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\" style=\"margin-right:0.05556em;\"\u003e∂\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.10764em;\"\u003ef\u003c/span\u003e\u003cspan class=\"mord\"\u003e/\u003c/span\u003e\u003cspan class=\"mord\" style=\"margin-right:0.05556em;\"\u003e∂\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003eu\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e±\u003c/span\u003e\u003cspan class=\"mord\"\u003e1\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"MCTpB7c4nw"},{"type":"text","value":", so the condition number bound from ","position":{"start":{"line":188,"column":1},"end":{"line":188,"column":1}},"key":"ECD9j7YdRg"},{"type":"crossReference","kind":"proof:theorem","identifier":"theorem-depic","label":"theorem-depIC","children":[{"type":"text","value":"Theorem ","key":"whwdOzLiAe"},{"type":"text","value":"6.1.2","key":"u6W3mJcOHr"}],"template":"Theorem %s","enumerator":"6.1.2","resolved":true,"html_id":"theorem-depic","remote":true,"url":"/basics","dataUrl":"/basics.json","key":"iYcGsHCMvy"},{"type":"text","value":" is ","position":{"start":{"line":188,"column":1},"end":{"line":188,"column":1}},"key":"kqEAig2XbG"},{"type":"inlineMath","value":"e^{b-a}","position":{"start":{"line":188,"column":1},"end":{"line":188,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsup\u003e\u003cmi\u003ee\u003c/mi\u003e\u003cmrow\u003e\u003cmi\u003eb\u003c/mi\u003e\u003cmo\u003e−\u003c/mo\u003e\u003cmi\u003ea\u003c/mi\u003e\u003c/mrow\u003e\u003c/msup\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003ee^{b-a}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8491em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003ee\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.8491em;\"\u003e\u003cspan style=\"top:-3.063em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003eb\u003c/span\u003e\u003cspan class=\"mbin mtight\"\u003e−\u003c/span\u003e\u003cspan class=\"mord mathnormal mtight\"\u003ea\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"yt4zHKYt1f"},{"type":"text","value":" in both problems. However, they behave quite differently. In the case of exponential growth, ","position":{"start":{"line":188,"column":1},"end":{"line":188,"column":1}},"key":"qWiheRh0gL"},{"type":"inlineMath","value":"u'=u","position":{"start":{"line":188,"column":1},"end":{"line":188,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsup\u003e\u003cmi\u003eu\u003c/mi\u003e\u003cmo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\"\u003e′\u003c/mo\u003e\u003c/msup\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmi\u003eu\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003eu\u0026#x27;=u\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.7519em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003eu\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.7519em;\"\u003e\u003cspan style=\"top:-3.063em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e′\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.4306em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003eu\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"WOrZABq42W"},{"type":"text","value":", the bound is the actual condition number.","position":{"start":{"line":188,"column":1},"end":{"line":188,"column":1}},"key":"vF3xD0EIvC"}],"key":"s5zTBlSOU6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"t = range(0, 3, length=800)\nu = @. exp(t) * 1\nlower, upper = @. exp(t) * 0.7, @. exp(t) * 1.3\nplot(t, u, l=:black, ribbon=(lower, upper),\n    leg=:none, xlabel=L\"t\", ylabel=L\"u(t)\",\n    title=\"Exponential divergence of solutions\")","key":"cB2Y34nCcu"},{"type":"output","id":"hB-caMCd63gsXMjiisk7Z","data":[{"output_type":"execute_result","execution_count":10,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"3d190cabc0b0e1685544434ddba8644a","path":"/fnc/build/3d190cabc0b0e1685544434ddba8644a.png"},"text/html":{"content_type":"text/html","hash":"866e725a681e0e961f85d3549880b518","path":"/fnc/build/866e725a681e0e961f85d3549880b518.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"eac2a7e471c9a5e52e6ecb254f8e9995","path":"/fnc/build/eac2a7e471c9a5e52e6ecb254f8e9995.svg"}}}],"key":"z5SqJJ37U0"}],"data":{},"key":"gR6MuQ1XXg"},{"type":"paragraph","position":{"start":{"line":199,"column":1},"end":{"line":199,"column":1}},"children":[{"type":"text","value":"But with ","position":{"start":{"line":199,"column":1},"end":{"line":199,"column":1}},"key":"AwL2RdYwtH"},{"type":"inlineMath","value":"u'=-u","position":{"start":{"line":199,"column":1},"end":{"line":199,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsup\u003e\u003cmi\u003eu\u003c/mi\u003e\u003cmo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\"\u003e′\u003c/mo\u003e\u003c/msup\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmo\u003e−\u003c/mo\u003e\u003cmi\u003eu\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003eu\u0026#x27;=-u\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.7519em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003eu\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.7519em;\"\u003e\u003cspan style=\"top:-3.063em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e′\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e−\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003eu\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"aiJB3DcaFs"},{"type":"text","value":", solutions actually get closer together with time.","position":{"start":{"line":199,"column":1},"end":{"line":199,"column":1}},"key":"Ish0XaCDgu"}],"key":"PzgbH87o5s"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"u = @. exp(-t) * 1\nlower, upper = @. exp(-t) * 0.7, @. exp(-t) * 1.3\nplot(t, u, l=:black, ribbon=(lower, upper),\n    leg=:none, xlabel=L\"t\", ylabel=L\"u(t)\",\n    title=\"Exponential convergence of solutions\")","key":"ERudbUwV0i"},{"type":"output","id":"Bolpafl5FFpRpXaJSKJBJ","data":[{"output_type":"execute_result","execution_count":11,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"a186c208e5a5487c201a0bffc3aeebe2","path":"/fnc/build/a186c208e5a5487c201a0bffc3aeebe2.png"},"text/html":{"content_type":"text/html","hash":"c5deeaa4c7523d25ff2c6dca31f36c5d","path":"/fnc/build/c5deeaa4c7523d25ff2c6dca31f36c5d.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"28afe2d0f6f857066de8c829485e65a1","path":"/fnc/build/28afe2d0f6f857066de8c829485e65a1.svg"}}}],"key":"ISGrk7QpHT"}],"data":{},"key":"r1hIUfCgYW"},{"type":"paragraph","position":{"start":{"line":209,"column":1},"end":{"line":209,"column":1}},"children":[{"type":"text","value":"In this case the actual condition number is one, because the initial difference between solutions is the largest over all time. Hence the exponentially growing bound ","position":{"start":{"line":209,"column":1},"end":{"line":209,"column":1}},"key":"vDs7kcs0Ej"},{"type":"inlineMath","value":"e^{b-a}","position":{"start":{"line":209,"column":1},"end":{"line":209,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsup\u003e\u003cmi\u003ee\u003c/mi\u003e\u003cmrow\u003e\u003cmi\u003eb\u003c/mi\u003e\u003cmo\u003e−\u003c/mo\u003e\u003cmi\u003ea\u003c/mi\u003e\u003c/mrow\u003e\u003c/msup\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003ee^{b-a}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8491em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003ee\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.8491em;\"\u003e\u003cspan style=\"top:-3.063em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003eb\u003c/span\u003e\u003cspan class=\"mbin mtight\"\u003e−\u003c/span\u003e\u003cspan class=\"mord mathnormal mtight\"\u003ea\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"RrLOt8TxM7"},{"type":"text","value":" is a gross overestimate.","position":{"start":{"line":209,"column":1},"end":{"line":209,"column":1}},"key":"ys3S7izJcm"}],"key":"LVxRvycCsB"}],"label":"demo-basics-cond-julia","identifier":"demo-basics-cond-julia","html_id":"demo-basics-cond-julia","key":"GSKoTqknfR"},{"type":"heading","depth":3,"position":{"start":{"line":212,"column":1},"end":{"line":212,"column":1}},"children":[{"type":"text","value":"Section 6.2","position":{"start":{"line":212,"column":1},"end":{"line":212,"column":1}},"key":"ndkoISJvo0"}],"identifier":"section-6-2","label":"Section 6.2","html_id":"section-6-2","implicit":true,"key":"Kcv6eDtnut"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Convergence of Euler’s method","position":{"start":{"line":214,"column":1},"end":{"line":214,"column":1}},"key":"BsV8xQWCWZ"}],"key":"BxysbI08FO"},{"type":"paragraph","position":{"start":{"line":215,"column":1},"end":{"line":215,"column":1}},"children":[{"type":"text","value":"We consider the IVP ","position":{"start":{"line":215,"column":1},"end":{"line":215,"column":1}},"key":"Zj3atU1dXC"},{"type":"inlineMath","value":"u'=\\sin[(u+t)^2]","position":{"start":{"line":215,"column":1},"end":{"line":215,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsup\u003e\u003cmi\u003eu\u003c/mi\u003e\u003cmo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\"\u003e′\u003c/mo\u003e\u003c/msup\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmi\u003esin\u003c/mi\u003e\u003cmo\u003e⁡\u003c/mo\u003e\u003cmo stretchy=\"false\"\u003e[\u003c/mo\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmi\u003eu\u003c/mi\u003e\u003cmo\u003e+\u003c/mo\u003e\u003cmi\u003et\u003c/mi\u003e\u003cmsup\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003cmn\u003e2\u003c/mn\u003e\u003c/msup\u003e\u003cmo stretchy=\"false\"\u003e]\u003c/mo\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003eu\u0026#x27;=\\sin[(u+t)^2]\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.7519em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003eu\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.7519em;\"\u003e\u003cspan style=\"top:-3.063em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e′\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mop\"\u003esin\u003c/span\u003e\u003cspan class=\"mopen\"\u003e[(\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003eu\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e+\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003et\u003c/span\u003e\u003cspan class=\"mclose\"\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.8141em;\"\u003e\u003cspan style=\"top:-3.063em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e2\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose\"\u003e]\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"XPTrHppzSZ"},{"type":"text","value":" over ","position":{"start":{"line":215,"column":1},"end":{"line":215,"column":1}},"key":"nRRPSTlWrr"},{"type":"inlineMath","value":"0\\le t \\le 4","position":{"start":{"line":215,"column":1},"end":{"line":215,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmn\u003e0\u003c/mn\u003e\u003cmo\u003e≤\u003c/mo\u003e\u003cmi\u003et\u003c/mi\u003e\u003cmo\u003e≤\u003c/mo\u003e\u003cmn\u003e4\u003c/mn\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e0\\le t \\le 4\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.7804em;vertical-align:-0.136em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e0\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e≤\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.7719em;vertical-align:-0.136em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003et\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e≤\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6444em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e4\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"LNKYLRyWf8"},{"type":"text","value":", with ","position":{"start":{"line":215,"column":1},"end":{"line":215,"column":1}},"key":"qq2We6isem"},{"type":"inlineMath","value":"u(0)=-1","position":{"start":{"line":215,"column":1},"end":{"line":215,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003eu\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmn\u003e0\u003c/mn\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmo\u003e−\u003c/mo\u003e\u003cmn\u003e1\u003c/mn\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003eu(0)=-1\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003eu\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord\"\u003e0\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e−\u003c/span\u003e\u003cspan class=\"mord\"\u003e1\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"YjNVaBBFlh"},{"type":"text","value":".","position":{"start":{"line":215,"column":1},"end":{"line":215,"column":1}},"key":"WEtV1QfpfH"}],"key":"qE2kYWwboK"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"f(u, p, t) = sin((t + u)^2);\ntspan = (0.0, 4.0);\nu0 = -1.0;\n\nivp = ODEProblem(f, u0, tspan)","key":"CGXbdpjvlp"},{"type":"output","id":"4-Tn5UqOsKFWmSy4nYZMD","data":[{"output_type":"execute_result","execution_count":12,"metadata":{},"data":{"text/plain":{"content":"\u001b[38;2;86;182;194mODEProblem\u001b[0m with uType \u001b[38;2;86;182;194mFloat64\u001b[0m and tType \u001b[38;2;86;182;194mFloat64\u001b[0m. In-place: \u001b[38;2;86;182;194mfalse\u001b[0m\ntimespan: (0.0, 4.0)\nu0: -1.0","content_type":"text/plain"}}}],"key":"EgKvkZzjBW"}],"data":{},"key":"kKqrcj78sv"},{"type":"paragraph","position":{"start":{"line":225,"column":1},"end":{"line":225,"column":1}},"children":[{"type":"text","value":"Here is the call to ","position":{"start":{"line":225,"column":1},"end":{"line":225,"column":1}},"key":"KzcZvMXEqS"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-euler","label":"function-euler","children":[{"type":"text","value":"Function ","key":"ODGO7mYIhG"},{"type":"text","value":"6.2.2","key":"vbMlUszdTU"}],"template":"Algorithm %s","enumerator":"6.2.2","resolved":true,"html_id":"function-euler","remote":true,"url":"/euler","dataUrl":"/euler.json","key":"oKOpUu0spd"},{"type":"text","value":".","position":{"start":{"line":225,"column":1},"end":{"line":225,"column":1}},"key":"AnelPsiiUC"}],"key":"yIbixsz89l"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"t, u = FNC.euler(ivp, 20)\n\nplot(t, u, m=2, label=\"n=20\",\n    xlabel=L\"t\", ylabel=L\"u(t)\", title=\"Solution by Euler's method\")","key":"azUr4ZTAAu"},{"type":"output","id":"-mDM27fByUNSP312dBfgQ","data":[{"output_type":"execute_result","execution_count":13,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"19d57bb88bdf9820acf701191a375e41","path":"/fnc/build/19d57bb88bdf9820acf701191a375e41.png"},"text/html":{"content_type":"text/html","hash":"112b23a87a73fd9e82f52303406016dc","path":"/fnc/build/112b23a87a73fd9e82f52303406016dc.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"e8129b03b14c4b18937c716c85e9a699","path":"/fnc/build/e8129b03b14c4b18937c716c85e9a699.svg"}}}],"key":"mN0pJ2q4UX"}],"data":{},"key":"zzcT3YnSzd"},{"type":"paragraph","position":{"start":{"line":234,"column":1},"end":{"line":234,"column":1}},"children":[{"type":"text","value":"We could define a different interpolant to get a smoother picture above, but the derivation of Euler’s method assumed a piecewise linear interpolant. We can instead request more steps to make the interpolant look smoother.","position":{"start":{"line":234,"column":1},"end":{"line":234,"column":1}},"key":"kFrGuzWq3W"}],"key":"NjBj9AOvju"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"t, u = FNC.euler(ivp, 50)\nplot!(t, u, m=2, label=\"n=50\")","key":"A5aO9QBIwU"},{"type":"output","id":"d4FadvSkiiOQ7g-geXNqH","data":[{"output_type":"execute_result","execution_count":14,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"fd436d5573949ff23fba44a3b64b90aa","path":"/fnc/build/fd436d5573949ff23fba44a3b64b90aa.png"},"text/html":{"content_type":"text/html","hash":"a1e6cf31d570fef89bb250f58443169c","path":"/fnc/build/a1e6cf31d570fef89bb250f58443169c.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"4ccfd286b4bc3f16f7a75d9bfbf82048","path":"/fnc/build/4ccfd286b4bc3f16f7a75d9bfbf82048.svg"}}}],"key":"LPH2BKlcHD"}],"data":{},"key":"Er7cqP9wO6"},{"type":"paragraph","position":{"start":{"line":241,"column":1},"end":{"line":241,"column":1}},"children":[{"type":"text","value":"Increasing ","position":{"start":{"line":241,"column":1},"end":{"line":241,"column":1}},"key":"BB3BvkYLgU"},{"type":"inlineMath","value":"n","position":{"start":{"line":241,"column":1},"end":{"line":241,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003en\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003en\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.4306em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003en\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"Pat3l343gv"},{"type":"text","value":" changed the solution noticeably. Since we know that interpolants and finite differences become more accurate as ","position":{"start":{"line":241,"column":1},"end":{"line":241,"column":1}},"key":"m57a14aAJz"},{"type":"inlineMath","value":"h\\to 0","position":{"start":{"line":241,"column":1},"end":{"line":241,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003eh\u003c/mi\u003e\u003cmo\u003e→\u003c/mo\u003e\u003cmn\u003e0\u003c/mn\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003eh\\to 0\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003eh\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e→\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6444em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e0\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"DIGC11yjie"},{"type":"text","value":", we should anticipate the same behavior from Euler’s method. We don’t have an exact solution to compare to, so we will use a ","position":{"start":{"line":241,"column":1},"end":{"line":241,"column":1}},"key":"gcoGXqopyZ"},{"type":"inlineCode","value":"DifferentialEquations","position":{"start":{"line":241,"column":1},"end":{"line":241,"column":1}},"key":"TSvYyKOqNG"},{"type":"text","value":" solver to construct an accurate reference solution.","position":{"start":{"line":241,"column":1},"end":{"line":241,"column":1}},"key":"OS90kBxHQW"}],"key":"bf88dIu6Ql"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"u_exact = solve(ivp, Tsit5(), reltol=1e-14, abstol=1e-14)\n\nplot!(u_exact, l=(2, :black), label=\"reference\")","key":"Ug6a6UgAzG"},{"type":"output","id":"Kc_n-OHlGsaxJ3to3C3Kr","data":[{"output_type":"execute_result","execution_count":15,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"ae6edd271be1369086b2f56b34e11239","path":"/fnc/build/ae6edd271be1369086b2f56b34e11239.png"},"text/html":{"content_type":"text/html","hash":"6a022dd58eea65ee1f08af0554db4a70","path":"/fnc/build/6a022dd58eea65ee1f08af0554db4a70.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"2d6119004cf0bf21cb2af861c110addb","path":"/fnc/build/2d6119004cf0bf21cb2af861c110addb.svg"}}}],"key":"s3XebeIeoc"}],"data":{},"key":"yz4KgYegSc"},{"type":"paragraph","position":{"start":{"line":249,"column":1},"end":{"line":249,"column":1}},"children":[{"type":"text","value":"Now we can perform a convergence study.","position":{"start":{"line":249,"column":1},"end":{"line":249,"column":1}},"key":"z4L9iGmRNg"}],"key":"zkvwJZlp37"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"n = [round(Int, 5 * 10^k) for k in 0:0.5:3]\nerr = []\nfor n in n\n    t, u = FNC.euler(ivp, n)\n    push!(err, norm(u_exact.(t) - u, Inf))\nend\n\npretty_table((n=n, err=err), header=[\"n\", \"Inf-norm error\"])","key":"fRF4cRzR0F"},{"type":"output","id":"AXuoK-dBRaZyNuRf2vFVH","data":[{"output_type":"stream","name":"stdout","text":"┌──────┬────────────────┐\n│\u001b[1m    n \u001b[0m│\u001b[1m Inf-norm error \u001b[0m│\n├──────┼────────────────┤\n│    5 │         2.7342 │\n│   16 │       0.107594 │\n│   50 │      0.0299962 │\n│  158 │     0.00885025 │\n│  500 │     0.00273659 │\n│ 1581 │    0.000859654 │\n│ 5000 │    0.000271243 │\n└──────┴────────────────┘\n"}],"key":"WraFVZP4rq"}],"data":{},"key":"Vm2JROjAxL"},{"type":"paragraph","position":{"start":{"line":262,"column":1},"end":{"line":262,"column":1}},"children":[{"type":"text","value":"The error is approximately cut by a factor of 10 for each increase in ","position":{"start":{"line":262,"column":1},"end":{"line":262,"column":1}},"key":"REYVJLVi0C"},{"type":"inlineMath","value":"n","position":{"start":{"line":262,"column":1},"end":{"line":262,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003en\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003en\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.4306em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003en\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"Hhy6RK3Df6"},{"type":"text","value":" by the same factor. A log-log plot also confirms first-order convergence. Keep in mind that since ","position":{"start":{"line":262,"column":1},"end":{"line":262,"column":1}},"key":"x73j02tPSB"},{"type":"inlineMath","value":"h=(b-a)/n","position":{"start":{"line":262,"column":1},"end":{"line":262,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003eh\u003c/mi\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmi\u003eb\u003c/mi\u003e\u003cmo\u003e−\u003c/mo\u003e\u003cmi\u003ea\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003cmi mathvariant=\"normal\"\u003e/\u003c/mi\u003e\u003cmi\u003en\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003eh=(b-a)/n\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003eh\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003eb\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e−\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003ea\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003cspan class=\"mord\"\u003e/\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003en\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"k1G0SoePr7"},{"type":"text","value":", it follows that ","position":{"start":{"line":262,"column":1},"end":{"line":262,"column":1}},"key":"N8KEqxP7Fx"},{"type":"inlineMath","value":"O(h)=O(n^{-1})","position":{"start":{"line":262,"column":1},"end":{"line":262,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003eO\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmi\u003eh\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmi\u003eO\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmsup\u003e\u003cmi\u003en\u003c/mi\u003e\u003cmrow\u003e\u003cmo\u003e−\u003c/mo\u003e\u003cmn\u003e1\u003c/mn\u003e\u003c/mrow\u003e\u003c/msup\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003eO(h)=O(n^{-1})\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\"\u003eO\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003eh\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\"\u003eO\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003en\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.8141em;\"\u003e\u003cspan style=\"top:-3.063em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e−\u003c/span\u003e\u003cspan class=\"mord mtight\"\u003e1\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"kPTKorLk9H"},{"type":"text","value":".","position":{"start":{"line":262,"column":1},"end":{"line":262,"column":1}},"key":"liA99TvKDo"}],"key":"dk4gb3e3Ra"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"plot(n, err, m=:o, label=\"results\",\n    xaxis=(:log10, L\"n\"), yaxis=(:log10, \"Inf-norm global error\"),\n    title=\"Convergence of Euler's method\")\n\n# Add line for perfect 1st order.\nplot!(n, 0.05 * (n / n[1]) .^ (-1), l=:dash, label=L\"O(n^{-1})\")","key":"BMBysurk8t"},{"type":"output","id":"4Kd1mO1QgEoeri4QZ8zJF","data":[{"output_type":"execute_result","execution_count":17,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"c28f372776d26616c9d3ca8abb85ec5b","path":"/fnc/build/c28f372776d26616c9d3ca8abb85ec5b.png"},"text/html":{"content_type":"text/html","hash":"65aee0c0c197ab0720abfcb34bc13f83","path":"/fnc/build/65aee0c0c197ab0720abfcb34bc13f83.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"dc212d2b747415cf498f029b34f7b1b8","path":"/fnc/build/dc212d2b747415cf498f029b34f7b1b8.svg"}}}],"key":"wmdcd3bwDn"}],"data":{},"key":"icHw0WdUrW"}],"label":"demo-euler-converge-julia","identifier":"demo-euler-converge-julia","html_id":"demo-euler-converge-julia","key":"pNBdLvb0xC"},{"type":"heading","depth":3,"position":{"start":{"line":274,"column":1},"end":{"line":274,"column":1}},"children":[{"type":"text","value":"Section 6.3","position":{"start":{"line":274,"column":1},"end":{"line":274,"column":1}},"key":"eHlGZbN53Y"}],"identifier":"section-6-3","label":"Section 6.3","html_id":"section-6-3","implicit":true,"key":"aWWA5I6avo"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Predator-prey model","position":{"start":{"line":276,"column":1},"end":{"line":276,"column":1}},"key":"xGIalYbQxS"}],"key":"EDJvIU04Il"},{"type":"paragraph","position":{"start":{"line":277,"column":1},"end":{"line":277,"column":1}},"children":[{"type":"text","value":"We encode the predator–prey equations via a function.","position":{"start":{"line":277,"column":1},"end":{"line":277,"column":1}},"key":"tCaS95eZdz"}],"key":"tLD56F6xsD"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"function predprey(u, p, t)\n    α, β = p      # rename parameters for convenience\n    y, z = u      # rename solution components\n    s = (y * z) / (1 + β * y)     # appears in both equations\n    return [y * (1 - α * y) - s, -z + s]\nend;","key":"rh956g3RTS"},{"type":"output","id":"McjRCCWC98e36ptQtABkx","data":[],"key":"eh3jCNYb1O"}],"data":{},"key":"fYlRh4tVXT"},{"type":"paragraph","position":{"start":{"line":288,"column":1},"end":{"line":288,"column":1}},"children":[{"type":"text","value":"As before, the ODE function must accept three inputs, ","position":{"start":{"line":288,"column":1},"end":{"line":288,"column":1}},"key":"l5suUYaMqZ"},{"type":"inlineCode","value":"u","position":{"start":{"line":288,"column":1},"end":{"line":288,"column":1}},"key":"gyBusSzFqW"},{"type":"text","value":", ","position":{"start":{"line":288,"column":1},"end":{"line":288,"column":1}},"key":"FSfXXtRdwV"},{"type":"inlineCode","value":"p","position":{"start":{"line":288,"column":1},"end":{"line":288,"column":1}},"key":"bfySS5ECFY"},{"type":"text","value":", and ","position":{"start":{"line":288,"column":1},"end":{"line":288,"column":1}},"key":"zjGbmQ6Ket"},{"type":"inlineCode","value":"t","position":{"start":{"line":288,"column":1},"end":{"line":288,"column":1}},"key":"gIETqv5YfD"},{"type":"text","value":", even though in this case there is no explicit dependence on ","position":{"start":{"line":288,"column":1},"end":{"line":288,"column":1}},"key":"LunjiihTvT"},{"type":"inlineCode","value":"t","position":{"start":{"line":288,"column":1},"end":{"line":288,"column":1}},"key":"ieoWdZp335"},{"type":"text","value":". The second input is used to pass parameters that don’t change throughout a single instance of the problem.","position":{"start":{"line":288,"column":1},"end":{"line":288,"column":1}},"key":"mmbHuytLF7"}],"key":"pURUyrXze1"},{"type":"paragraph","position":{"start":{"line":290,"column":1},"end":{"line":290,"column":1}},"children":[{"type":"text","value":"To specify the IVP we must also provide the initial condition, which is a 2-vector here, and the interval for the independent variable.","position":{"start":{"line":290,"column":1},"end":{"line":290,"column":1}},"key":"SOjZSNmnkx"}],"key":"KUFxAiEkck"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"u₀ = [1, 0.01]\ntspan = (0.0, 60.0)\nα, β = 0.1, 0.25\n\nivp = ODEProblem(predprey, u₀, tspan, [α, β])","key":"oONqWuXjeI"},{"type":"output","id":"LVAfjMxeppmmvsxKBs9Ng","data":[{"output_type":"execute_result","execution_count":19,"metadata":{},"data":{"text/plain":{"content":"\u001b[38;2;86;182;194mODEProblem\u001b[0m with uType \u001b[38;2;86;182;194mVector{Float64}\u001b[0m and tType \u001b[38;2;86;182;194mFloat64\u001b[0m. In-place: \u001b[38;2;86;182;194mfalse\u001b[0m\ntimespan: (0.0, 60.0)\nu0: 2-element Vector{Float64}:\n 1.0\n 0.01","content_type":"text/plain"}}}],"key":"JikimuRWk9"}],"data":{},"key":"UAmZQiOqQn"},{"type":"paragraph","position":{"start":{"line":300,"column":1},"end":{"line":300,"column":1}},"children":[{"type":"text","value":"You can use any ","position":{"start":{"line":300,"column":1},"end":{"line":300,"column":1}},"key":"b0WvbvCfFS"},{"type":"inlineCode","value":"DifferentialEquations","position":{"start":{"line":300,"column":1},"end":{"line":300,"column":1}},"key":"PcSoJ2qc3y"},{"type":"text","value":" solver on the IVP system.","position":{"start":{"line":300,"column":1},"end":{"line":300,"column":1}},"key":"PxPt0oZwMT"}],"key":"Ss08PZ3qGm"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"sol = solve(ivp, Tsit5());\nplot(sol, label=[\"prey\" \"predator\"], title=\"Predator-prey solution\")","key":"VLQcX8LTWG"},{"type":"output","id":"Ivt3gC6qLZpBlmEd3jU13","data":[{"output_type":"execute_result","execution_count":20,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"c20d139de7db8f0267c34a6e01cd176a","path":"/fnc/build/c20d139de7db8f0267c34a6e01cd176a.png"},"text/html":{"content_type":"text/html","hash":"35b0c2d6478d7778b04fda0fefe37a6a","path":"/fnc/build/35b0c2d6478d7778b04fda0fefe37a6a.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"add88fcf91f07f52feb719ba243e65f3","path":"/fnc/build/add88fcf91f07f52feb719ba243e65f3.svg"}}}],"key":"Fmrac1onLI"}],"data":{},"key":"AKEFMHgLFB"},{"type":"paragraph","position":{"start":{"line":307,"column":1},"end":{"line":307,"column":1}},"children":[{"type":"text","value":"We can find the discrete values used to compute the interpolated solution. The ","position":{"start":{"line":307,"column":1},"end":{"line":307,"column":1}},"key":"x5uE9Jmk7J"},{"type":"inlineCode","value":"sol.u","position":{"start":{"line":307,"column":1},"end":{"line":307,"column":1}},"key":"G2nbtbi2lQ"},{"type":"text","value":" value is a vector of vectors.","position":{"start":{"line":307,"column":1},"end":{"line":307,"column":1}},"key":"It84texW19"}],"key":"yyBxeOo9oP"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"t, u = sol.t, sol.u    # extract times and solution values\n@show size(u);\n@show t[20];\n@show u[20];","key":"tyHG3biHfw"},{"type":"output","id":"OTY2otJi5EpvIW_MwQI_L","data":[{"output_type":"stream","name":"stdout","text":"size(u) = (100,)\nt[20] = 8.386698083051241\nu[20] = [0.027739191695661334, 0.699418322938034]\n"}],"key":"SpVYMBRBTN"}],"data":{},"key":"cFsdxUWx5T"},{"type":"paragraph","position":{"start":{"line":316,"column":1},"end":{"line":316,"column":1}},"children":[{"type":"text","value":"We can also use ","position":{"start":{"line":316,"column":1},"end":{"line":316,"column":1}},"key":"hV2kZw87dy"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-euler","label":"function-euler","children":[{"type":"text","value":"Function ","key":"HY2mlmiqE3"},{"type":"text","value":"6.2.2","key":"sTbMoJnufp"}],"template":"Algorithm %s","enumerator":"6.2.2","resolved":true,"html_id":"function-euler","remote":true,"url":"/euler","dataUrl":"/euler.json","key":"Zitx6RosTm"},{"type":"text","value":" to find the solution.","position":{"start":{"line":316,"column":1},"end":{"line":316,"column":1}},"key":"GlXdUvcO2o"}],"key":"iygDyt0EKV"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"t, u = FNC.euler(ivp, 1200);","key":"kEJNzyx7dB"},{"type":"output","id":"G8kXhCLS-Vb24QckYyE9d","data":[],"key":"Xyx0p4jVBf"}],"data":{},"key":"AfVrORvyZz"},{"type":"paragraph","position":{"start":{"line":322,"column":1},"end":{"line":322,"column":1}},"children":[{"type":"text","value":"The solution ","position":{"start":{"line":322,"column":1},"end":{"line":322,"column":1}},"key":"x1KRudJZ8P"},{"type":"inlineCode","value":"u","position":{"start":{"line":322,"column":1},"end":{"line":322,"column":1}},"key":"OwQKXx383U"},{"type":"text","value":" is a vector of [prey,predator] 2-vectors for each of the discrete times in ","position":{"start":{"line":322,"column":1},"end":{"line":322,"column":1}},"key":"HCoEuhlnwv"},{"type":"inlineCode","value":"t","position":{"start":{"line":322,"column":1},"end":{"line":322,"column":1}},"key":"tucu2XZvMN"},{"type":"text","value":". Manipulating the vector-of-vectors output can be a little tricky. Here, we convert it to an ","position":{"start":{"line":322,"column":1},"end":{"line":322,"column":1}},"key":"qoUx1CwvJB"},{"type":"inlineMath","value":"n\\times 2","position":{"start":{"line":322,"column":1},"end":{"line":322,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003en\u003c/mi\u003e\u003cmo\u003e×\u003c/mo\u003e\u003cmn\u003e2\u003c/mn\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003en\\times 2\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003en\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e×\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6444em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e2\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"Gqi18QUGtQ"},{"type":"text","value":" matrix. Each column is one component, while each row is a single value of ","position":{"start":{"line":322,"column":1},"end":{"line":322,"column":1}},"key":"HQBfifRXIx"},{"type":"inlineMath","value":"t","position":{"start":{"line":322,"column":1},"end":{"line":322,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003et\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003et\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6151em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003et\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"CrgdEpmEQu"},{"type":"text","value":".","position":{"start":{"line":322,"column":1},"end":{"line":322,"column":1}},"key":"S7DK1oLcov"}],"key":"sBUXKEaLpj"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"u = [u[j] for u in u, j in 1:2]\nplot!(t[1:3:end], u[1:3:end, :], l=(1, :black), m=2,\n    label=[\"Euler prey\" \"Euler predator\"])","key":"DMCBXWBk44"},{"type":"output","id":"_hfGzO6t4S0IHKrNI_g03","data":[{"output_type":"execute_result","execution_count":23,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"0c08aeb8ae9351d455099a7f18318980","path":"/fnc/build/0c08aeb8ae9351d455099a7f18318980.png"},"text/html":{"content_type":"text/html","hash":"bf9b083874ce73f8766740ee954ffb87","path":"/fnc/build/bf9b083874ce73f8766740ee954ffb87.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"d0203ddcf7ae87f5d25366305d364569","path":"/fnc/build/d0203ddcf7ae87f5d25366305d364569.svg"}}}],"key":"bxUNB9Q9PZ"}],"data":{},"key":"rF6s4eteOV"},{"type":"paragraph","position":{"start":{"line":330,"column":1},"end":{"line":330,"column":1}},"children":[{"type":"text","value":"Notice above that the accuracy of the Euler solution deteriorates rapidly.","position":{"start":{"line":330,"column":1},"end":{"line":330,"column":1}},"key":"qcUZNhSLjz"}],"key":"DjQbGOnMCv"},{"type":"grid","columns":[1,1,2,2],"children":[{"type":"paragraph","position":{"start":{"line":333,"column":1},"end":{"line":333,"column":1}},"children":[{"type":"text","value":"When there are just two components, it’s common to plot the solution in the ","position":{"start":{"line":333,"column":1},"end":{"line":333,"column":1}},"key":"qNiOyyli06"},{"type":"emphasis","position":{"start":{"line":333,"column":1},"end":{"line":333,"column":1}},"children":[{"type":"text","value":"phase plane","position":{"start":{"line":333,"column":1},"end":{"line":333,"column":1}},"key":"tc4HfsV8ep"}],"key":"CDdAuxPvqc"},{"type":"text","value":", i.e., with ","position":{"start":{"line":333,"column":1},"end":{"line":333,"column":1}},"key":"YEmN1JW3Md"},{"type":"inlineMath","value":"u_1","position":{"start":{"line":333,"column":1},"end":{"line":333,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsub\u003e\u003cmi\u003eu\u003c/mi\u003e\u003cmn\u003e1\u003c/mn\u003e\u003c/msub\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003eu_1\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003eu\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3011em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e1\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"lJnUyqpRn3"},{"type":"text","value":" and ","position":{"start":{"line":333,"column":1},"end":{"line":333,"column":1}},"key":"mdeeEZi87p"},{"type":"inlineMath","value":"u_2","position":{"start":{"line":333,"column":1},"end":{"line":333,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsub\u003e\u003cmi\u003eu\u003c/mi\u003e\u003cmn\u003e2\u003c/mn\u003e\u003c/msub\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003eu_2\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003eu\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3011em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e2\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"Kp79eR9A0L"},{"type":"text","value":" along the axes and time as a parameterization of the curve.","position":{"start":{"line":333,"column":1},"end":{"line":333,"column":1}},"key":"EFsTTDLdEH"}],"key":"ntzqJ9C5PQ"},{"type":"card","children":[{"type":"paragraph","position":{"start":{"line":335,"column":1},"end":{"line":335,"column":1}},"children":[{"type":"text","value":"You can use ","position":{"start":{"line":335,"column":1},"end":{"line":335,"column":1}},"key":"pvLP4Iimlf"},{"type":"inlineCode","value":"idxs","position":{"start":{"line":335,"column":1},"end":{"line":335,"column":1}},"key":"pzB7o3KXWD"},{"type":"text","value":" in the plot of a solution produced by ","position":{"start":{"line":335,"column":1},"end":{"line":335,"column":1}},"key":"ksvq6Q7gcY"},{"type":"inlineCode","value":"solve","position":{"start":{"line":335,"column":1},"end":{"line":335,"column":1}},"key":"uBKPoKEwOo"},{"type":"text","value":" to specify the components of the solution that appear on each axis.","position":{"start":{"line":335,"column":1},"end":{"line":335,"column":1}},"key":"c68OiHg7i3"}],"key":"WVP6JTO5zq"}],"key":"psybgSyjl5"}],"key":"WDOXiBLotV"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"plot(sol, idxs=(1, 2), title=\"Predator-prey in the phase plane\",\n    xlabel=L\"y\", ylabel=L\"z\")","key":"bquGY0hu8F"},{"type":"output","id":"lc6ED8r8SQMAo7dRgw-DE","data":[{"output_type":"execute_result","execution_count":24,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"9f759107870311a6d62b6a53302231c4","path":"/fnc/build/9f759107870311a6d62b6a53302231c4.png"},"text/html":{"content_type":"text/html","hash":"0122a3517c226f740025151b3839a01b","path":"/fnc/build/0122a3517c226f740025151b3839a01b.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"e420a75644e9cc5514cc89db4035e093","path":"/fnc/build/e420a75644e9cc5514cc89db4035e093.svg"}}}],"key":"wgrKOmd5kP"}],"data":{},"key":"qtvC6PQS6q"},{"type":"paragraph","position":{"start":{"line":344,"column":1},"end":{"line":344,"column":1}},"children":[{"type":"text","value":"From this plot we can deduce that the solution approaches a periodic one, which in the phase plane is represented by a closed loop.","position":{"start":{"line":344,"column":1},"end":{"line":344,"column":1}},"key":"Sc9YHYqgfR"}],"key":"mt7pv41Kqj"}],"label":"demo-systems-predator-julia","identifier":"demo-systems-predator-julia","html_id":"demo-systems-predator-julia","key":"YgM81VWesM"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Coupled pendulums","position":{"start":{"line":348,"column":1},"end":{"line":348,"column":1}},"key":"BykyQ8ArG8"}],"key":"mcSzAqIVgI"},{"type":"grid","columns":[1,1,2,2],"children":[{"type":"paragraph","position":{"start":{"line":350,"column":1},"end":{"line":350,"column":1}},"children":[{"type":"text","value":"Let’s implement the coupled pendulums from ","position":{"start":{"line":350,"column":1},"end":{"line":350,"column":1}},"key":"awnd3YLsCT"},{"type":"crossReference","kind":"proof:example","identifier":"example-systems-coupledpendula","label":"example-systems-coupledpendula","children":[{"type":"text","value":"Example ","key":"gdx8VIrcvO"},{"type":"text","value":"6.3.4","key":"eQYrIWdZW0"}],"template":"Example %s","enumerator":"6.3.4","resolved":true,"html_id":"example-systems-coupledpendula","remote":true,"url":"/systems","dataUrl":"/systems.json","key":"NDadcdf1DT"},{"type":"text","value":". The pendulums will be pulled in opposite directions and then released together from rest.","position":{"start":{"line":350,"column":1},"end":{"line":350,"column":1}},"key":"NR6ggyo1G8"}],"key":"UbyOskBVFf"},{"type":"card","children":[{"type":"paragraph","position":{"start":{"line":352,"column":1},"end":{"line":352,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":352,"column":1},"end":{"line":352,"column":1}},"key":"s7UkhHkqaG"},{"type":"inlineCode","value":"similar","position":{"start":{"line":352,"column":1},"end":{"line":352,"column":1}},"key":"im6IG9xdSl"},{"type":"text","value":" function creates an array of the same size and type as a given value, without initializing the contents.","position":{"start":{"line":352,"column":1},"end":{"line":352,"column":1}},"key":"c3oJvhoMeN"}],"key":"YsZMpsu5OO"}],"key":"PFGtiwH9Cv"}],"key":"g2Onzb89hm"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"function couple(u, p, t)\n    γ, L, k = p\n    g = 9.8\n    udot = similar(u)\n    udot[1:2] .= u[3:4]\n    udot[3] = -γ * u[3] - (g / L) * sin(u[1]) + k * (u[2] - u[1])\n    udot[4] = -γ * u[4] - (g / L) * sin(u[2]) + k * (u[1] - u[2])\n    return udot\nend\n\nu₀ = [1.25, -0.5, 0, 0]\ntspan = (0.0, 50.0);","key":"T3UCYTWhMK"},{"type":"output","id":"6mnFx4QDchVIzMayRh4KO","data":[],"key":"GAc1DKu1f4"}],"data":{},"key":"qYMEnp065d"},{"type":"grid","columns":[1,1,2,2],"children":[{"type":"paragraph","position":{"start":{"line":372,"column":1},"end":{"line":372,"column":1}},"children":[{"type":"text","value":"First we check the behavior of the system when the pendulums are uncoupled, i.e., when ","position":{"start":{"line":372,"column":1},"end":{"line":372,"column":1}},"key":"qKI5taJlCV"},{"type":"inlineMath","value":"k=0","position":{"start":{"line":372,"column":1},"end":{"line":372,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003ek\u003c/mi\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmn\u003e0\u003c/mn\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003ek=0\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03148em;\"\u003ek\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6444em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e0\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"nYj0J0JX8O"},{"type":"text","value":".","position":{"start":{"line":372,"column":1},"end":{"line":372,"column":1}},"key":"EewkNICWMN"}],"key":"uie8qCyS4R"},{"type":"card","children":[{"type":"paragraph","position":{"start":{"line":374,"column":1},"end":{"line":374,"column":1}},"children":[{"type":"text","value":"Here ","position":{"start":{"line":374,"column":1},"end":{"line":374,"column":1}},"key":"yt0IZKijU0"},{"type":"inlineCode","value":"idxs","position":{"start":{"line":374,"column":1},"end":{"line":374,"column":1}},"key":"gGuz6gEb9p"},{"type":"text","value":" is used to plot two components as functions of time.","position":{"start":{"line":374,"column":1},"end":{"line":374,"column":1}},"key":"fFjCAiR81V"}],"key":"vMrgJrHAQ3"}],"key":"EQrv7fu8rJ"}],"key":"spAmrhZSYR"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"γ, L, k = 0, 0.5, 0\nivp = ODEProblem(couple, u₀, tspan, [γ, L, k])\nsol = solve(ivp, Tsit5())\nplot(sol, idxs=[1, 2], label=[L\"\\theta_1\" L\"\\theta_2\"],\n    xlims=[20, 50], title=\"Uncoupled pendulums\")","key":"SaOXnmD7nE"},{"type":"output","id":"ReHbPmADIjdv-28tkVv9d","data":[{"output_type":"execute_result","execution_count":26,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"94cfe8381bb3d4b0bb277c1c444b43c4","path":"/fnc/build/94cfe8381bb3d4b0bb277c1c444b43c4.png"},"text/html":{"content_type":"text/html","hash":"3a7e12e2d058c07b3384d795c4b8d311","path":"/fnc/build/3a7e12e2d058c07b3384d795c4b8d311.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"a9d8d121dbdaea048b12e76b91293ca4","path":"/fnc/build/a9d8d121dbdaea048b12e76b91293ca4.svg"}}}],"key":"mT46zb6T8c"}],"data":{},"key":"a9HyTd13ml"},{"type":"paragraph","position":{"start":{"line":386,"column":1},"end":{"line":386,"column":1}},"children":[{"type":"text","value":"You can see that the pendulums swing independently. Because the model is nonlinear and the initial angles are not small, they have slightly different periods of oscillation, and they go in and out of phase.","position":{"start":{"line":386,"column":1},"end":{"line":386,"column":1}},"key":"QHr5qMxLeL"}],"key":"Yhudq2fJYx"},{"type":"paragraph","position":{"start":{"line":388,"column":1},"end":{"line":388,"column":1}},"children":[{"type":"text","value":"With coupling activated, a different behavior is seen.","position":{"start":{"line":388,"column":1},"end":{"line":388,"column":1}},"key":"ZkZoOulG4C"}],"key":"XOSjEVyWKL"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"k = 1\nivp = ODEProblem(couple, u₀, tspan, [γ, L, k])\nsol = solve(ivp, Tsit5())\nplot(sol, idxs=[1, 2], label=[L\"\\theta_1\" L\"\\theta_2\"],\n    xlims=[20, 50], title=\"Coupled pendulums\")","key":"SGxk6fj9VU"},{"type":"output","id":"25FduJpgeNUj9JsBJY3nb","data":[{"output_type":"execute_result","execution_count":27,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"16056e7e5cd15352f27dd1edac5311f7","path":"/fnc/build/16056e7e5cd15352f27dd1edac5311f7.png"},"text/html":{"content_type":"text/html","hash":"9b472c74ee471cdd9c32d2859fa4da8c","path":"/fnc/build/9b472c74ee471cdd9c32d2859fa4da8c.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"7701e56badc2c8950d696cc3a2be113d","path":"/fnc/build/7701e56badc2c8950d696cc3a2be113d.svg"}}}],"key":"XAShSQbf8y"}],"data":{},"key":"ChsR2eQinl"},{"type":"paragraph","position":{"start":{"line":398,"column":1},"end":{"line":398,"column":1}},"children":[{"type":"text","value":"The coupling makes the pendulums swap energy back and forth.","position":{"start":{"line":398,"column":1},"end":{"line":398,"column":1}},"key":"CRrLTXJ5Fk"}],"key":"BF3x2ekHDt"}],"label":"demo-systems-coupledpendula-julia","identifier":"demo-systems-coupledpendula-julia","html_id":"demo-systems-coupledpendula-julia","key":"p0IzQGdqW7"},{"type":"heading","depth":3,"position":{"start":{"line":401,"column":1},"end":{"line":401,"column":1}},"children":[{"type":"text","value":"Section 6.4","position":{"start":{"line":401,"column":1},"end":{"line":401,"column":1}},"key":"afTqACLmx3"}],"identifier":"section-6-4","label":"Section 6.4","html_id":"section-6-4","implicit":true,"key":"isxhB3lxtP"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Convergence of Runge–Kutta methods","position":{"start":{"line":403,"column":1},"end":{"line":403,"column":1}},"key":"vBh436QXJb"}],"key":"XrNN5GtPSX"},{"type":"paragraph","position":{"start":{"line":404,"column":1},"end":{"line":404,"column":1}},"children":[{"type":"text","value":"We solve the IVP ","position":{"start":{"line":404,"column":1},"end":{"line":404,"column":1}},"key":"fdHeblqOz4"},{"type":"inlineMath","value":"u'=\\sin[(u+t)^2]","position":{"start":{"line":404,"column":1},"end":{"line":404,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsup\u003e\u003cmi\u003eu\u003c/mi\u003e\u003cmo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\"\u003e′\u003c/mo\u003e\u003c/msup\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmi\u003esin\u003c/mi\u003e\u003cmo\u003e⁡\u003c/mo\u003e\u003cmo stretchy=\"false\"\u003e[\u003c/mo\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmi\u003eu\u003c/mi\u003e\u003cmo\u003e+\u003c/mo\u003e\u003cmi\u003et\u003c/mi\u003e\u003cmsup\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003cmn\u003e2\u003c/mn\u003e\u003c/msup\u003e\u003cmo stretchy=\"false\"\u003e]\u003c/mo\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003eu\u0026#x27;=\\sin[(u+t)^2]\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.7519em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003eu\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.7519em;\"\u003e\u003cspan style=\"top:-3.063em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e′\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mop\"\u003esin\u003c/span\u003e\u003cspan class=\"mopen\"\u003e[(\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003eu\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e+\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003et\u003c/span\u003e\u003cspan class=\"mclose\"\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.8141em;\"\u003e\u003cspan style=\"top:-3.063em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e2\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose\"\u003e]\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"Ko6h9c9vHw"},{"type":"text","value":" over ","position":{"start":{"line":404,"column":1},"end":{"line":404,"column":1}},"key":"byFfRdObzq"},{"type":"inlineMath","value":"0\\le t \\le 4","position":{"start":{"line":404,"column":1},"end":{"line":404,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmn\u003e0\u003c/mn\u003e\u003cmo\u003e≤\u003c/mo\u003e\u003cmi\u003et\u003c/mi\u003e\u003cmo\u003e≤\u003c/mo\u003e\u003cmn\u003e4\u003c/mn\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e0\\le t \\le 4\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.7804em;vertical-align:-0.136em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e0\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e≤\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.7719em;vertical-align:-0.136em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003et\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e≤\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6444em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e4\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"Z4zVtBcKLR"},{"type":"text","value":", with ","position":{"start":{"line":404,"column":1},"end":{"line":404,"column":1}},"key":"JTxsYrP2HV"},{"type":"inlineMath","value":"u(0)=-1","position":{"start":{"line":404,"column":1},"end":{"line":404,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003eu\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmn\u003e0\u003c/mn\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmo\u003e−\u003c/mo\u003e\u003cmn\u003e1\u003c/mn\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003eu(0)=-1\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003eu\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord\"\u003e0\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e−\u003c/span\u003e\u003cspan class=\"mord\"\u003e1\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"I7yojihqLt"},{"type":"text","value":".","position":{"start":{"line":404,"column":1},"end":{"line":404,"column":1}},"key":"GykxJBveEQ"}],"key":"IlPWYPkPmX"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"f(u, p, t) = sin((t + u)^2)\ntspan = (0.0, 4.0)\nu₀ = -1.0\n\nivp = ODEProblem(f, u₀, tspan)","key":"afZ5t4NeZS"},{"type":"output","id":"xOkM677vsqCV66tQMiJqe","data":[{"output_type":"execute_result","execution_count":28,"metadata":{},"data":{"text/plain":{"content":"\u001b[38;2;86;182;194mODEProblem\u001b[0m with uType \u001b[38;2;86;182;194mFloat64\u001b[0m and tType \u001b[38;2;86;182;194mFloat64\u001b[0m. In-place: \u001b[38;2;86;182;194mfalse\u001b[0m\ntimespan: (0.0, 4.0)\nu0: -1.0","content_type":"text/plain"}}}],"key":"faPPepyDtU"}],"data":{},"key":"L7zWJ2UY8t"},{"type":"paragraph","position":{"start":{"line":414,"column":1},"end":{"line":414,"column":1}},"children":[{"type":"text","value":"We use a ","position":{"start":{"line":414,"column":1},"end":{"line":414,"column":1}},"key":"OCWLo4HRpE"},{"type":"inlineCode","value":"DifferentialEquations","position":{"start":{"line":414,"column":1},"end":{"line":414,"column":1}},"key":"kCcuplBhgU"},{"type":"text","value":" solver to construct an accurate approximation to the exact solution.","position":{"start":{"line":414,"column":1},"end":{"line":414,"column":1}},"key":"Hz8H73bsbO"}],"key":"ZcOwFsqVvF"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"u_ref = solve(ivp, Tsit5(), reltol=1e-14, abstol=1e-14);","key":"E78D4u08pq"},{"type":"output","id":"NRDH31TMk4aGLGPRjCAol","data":[],"key":"GFyJcRcRkd"}],"data":{},"key":"JcQIYFdkib"},{"type":"paragraph","position":{"start":{"line":420,"column":1},"end":{"line":420,"column":1}},"children":[{"type":"text","value":"Now we perform a convergence study of our two Runge–Kutta implementations.","position":{"start":{"line":420,"column":1},"end":{"line":420,"column":1}},"key":"aBJWIdcNfP"}],"key":"wzqd65Se7w"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"n = [round(Int, 2 * 10^k) for k in 0:0.5:3]\nerr_IE2, err_RK4 = [], []\nfor n in n\n    t, u = FNC.ie2(ivp, n)\n    push!(err_IE2, maximum(@.abs(u_ref(t) - u)))\n    t, u = FNC.rk4(ivp, n)\n    push!(err_RK4, maximum(@.abs(u_ref(t) - u)))\nend\n\npretty_table([n err_IE2 err_RK4], header=[\"n\", \"IE2 error\", \"RK4 error\"])","key":"EUWM5cJIBw"},{"type":"output","id":"-dbQfAkmR70-1fU60pP-R","data":[{"output_type":"stream","name":"stdout","text":"┌──────┬─────────────┬─────────────┐\n│\u001b[1m    n \u001b[0m│\u001b[1m   IE2 error \u001b[0m│\u001b[1m   RK4 error \u001b[0m│\n├──────┼─────────────┼─────────────┤\n│    2 │     1.76903 │    0.820651 │\n│    6 │    0.512684 │    0.791925 │\n│   20 │   0.0240594 │  0.00081269 │\n│   63 │  0.00225327 │  8.06216e-6 │\n│  200 │ 0.000222419 │  7.60655e-8 │\n│  632 │  2.22528e-5 │   7.513e-10 │\n│ 2000 │  2.22177e-6 │ 7.45187e-12 │\n└──────┴─────────────┴─────────────┘\n"}],"key":"odiQBixKty"}],"data":{},"key":"PZ1uV57NKk"},{"type":"paragraph","position":{"start":{"line":435,"column":1},"end":{"line":435,"column":1}},"children":[{"type":"text","value":"The amount of computational work at each time step is assumed to be proportional to the number of stages. Let’s compare on an apples-to-apples basis by using the number of ","position":{"start":{"line":435,"column":1},"end":{"line":435,"column":1}},"key":"QLVWuE4y6A"},{"type":"inlineMath","value":"f","position":{"start":{"line":435,"column":1},"end":{"line":435,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003ef\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003ef\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.10764em;\"\u003ef\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"PKfEo0UNPL"},{"type":"text","value":"-evaluations on the horizontal axis.","position":{"start":{"line":435,"column":1},"end":{"line":435,"column":1}},"key":"Os1QXJ54Ce"}],"key":"Ehgo7NamGn"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"plot([2n 4n], [err_IE2 err_RK4], m=3, label=[\"IE2\" \"RK4\"],\n    xaxis=(:log10, \"f-evaluations\"), yaxis=(:log10, \"inf-norm error\"),\n    title=\"Convergence of RK methods\", leg=:bottomleft)\n\nplot!(2n, 1e-5 * (n / n[end]) .^ (-2), l=:dash, label=L\"O(n^{-2})\")\nplot!(4n, 1e-10 * (n / n[end]) .^ (-4), l=:dash, label=L\"O(n^{-4})\")","key":"kdVbDDconn"},{"type":"output","id":"Ltl6g0NRtyQY5B14RikZL","data":[{"output_type":"execute_result","execution_count":31,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"fbc2f02b3413a6e0cc9ac888e9769c96","path":"/fnc/build/fbc2f02b3413a6e0cc9ac888e9769c96.png"},"text/html":{"content_type":"text/html","hash":"77fc21a53474681243018f54829df04a","path":"/fnc/build/77fc21a53474681243018f54829df04a.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"f3baa943885ca86c51ea1bcf7eb586e7","path":"/fnc/build/f3baa943885ca86c51ea1bcf7eb586e7.svg"}}}],"key":"xER0hOqVh5"}],"data":{},"key":"OnSnFDpluE"},{"type":"paragraph","position":{"start":{"line":446,"column":1},"end":{"line":446,"column":1}},"children":[{"type":"text","value":"The fourth-order variant is more efficient in this problem over a wide range of accuracy.","position":{"start":{"line":446,"column":1},"end":{"line":446,"column":1}},"key":"mXqWjgFIZ9"}],"key":"DlfojuIAy7"}],"label":"demo-rk-converge-julia","identifier":"demo-rk-converge-julia","html_id":"demo-rk-converge-julia","key":"ylvOz3BIFK"},{"type":"heading","depth":3,"position":{"start":{"line":449,"column":1},"end":{"line":449,"column":1}},"children":[{"type":"text","value":"Section 6.5","position":{"start":{"line":449,"column":1},"end":{"line":449,"column":1}},"key":"w4fDKvD5gK"}],"identifier":"section-6-5","label":"Section 6.5","html_id":"section-6-5","implicit":true,"key":"snfoi6fmwq"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Adaptive step size","position":{"start":{"line":451,"column":1},"end":{"line":451,"column":1}},"key":"tT59uwtQWz"}],"key":"wyg7QOG5wj"},{"type":"paragraph","position":{"start":{"line":452,"column":1},"end":{"line":452,"column":1}},"children":[{"type":"text","value":"Let’s run adaptive RK on  ","position":{"start":{"line":452,"column":1},"end":{"line":452,"column":1}},"key":"ZN2VIB8dBY"},{"type":"inlineMath","value":"u'=e^{t-u\\sin u}","position":{"start":{"line":452,"column":1},"end":{"line":452,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsup\u003e\u003cmi\u003eu\u003c/mi\u003e\u003cmo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\"\u003e′\u003c/mo\u003e\u003c/msup\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmsup\u003e\u003cmi\u003ee\u003c/mi\u003e\u003cmrow\u003e\u003cmi\u003et\u003c/mi\u003e\u003cmo\u003e−\u003c/mo\u003e\u003cmi\u003eu\u003c/mi\u003e\u003cmi\u003esin\u003c/mi\u003e\u003cmo\u003e⁡\u003c/mo\u003e\u003cmi\u003eu\u003c/mi\u003e\u003c/mrow\u003e\u003c/msup\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003eu\u0026#x27;=e^{t-u\\sin u}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.7519em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003eu\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.7519em;\"\u003e\u003cspan style=\"top:-3.063em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e′\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8305em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003ee\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.8305em;\"\u003e\u003cspan style=\"top:-3.063em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003et\u003c/span\u003e\u003cspan class=\"mbin mtight\"\u003e−\u003c/span\u003e\u003cspan class=\"mord mathnormal mtight\"\u003eu\u003c/span\u003e\u003cspan class=\"mspace mtight\" style=\"margin-right:0.1952em;\"\u003e\u003c/span\u003e\u003cspan class=\"mop mtight\"\u003e\u003cspan class=\"mtight\"\u003es\u003c/span\u003e\u003cspan class=\"mtight\"\u003ei\u003c/span\u003e\u003cspan class=\"mtight\"\u003en\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace mtight\" style=\"margin-right:0.1952em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal mtight\"\u003eu\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"DiHZYhLdoJ"},{"type":"text","value":".","position":{"start":{"line":452,"column":1},"end":{"line":452,"column":1}},"key":"oCSeA7sxTS"}],"key":"A8q16hFPer"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"f(u, p, t) = exp(t - u * sin(u))\nivp = ODEProblem(f, 0, (0.0, 5.0))\nt, u = FNC.rk23(ivp, 1e-5)\n\nplot(t, u, m=2,\n    xlabel=L\"t\", ylabel=L\"u(t)\", title=\"Adaptive IVP solution\")","key":"eKEfQCYZCN"},{"type":"output","id":"GusR60uTzJT1H5H7PRH6G","data":[{"output_type":"execute_result","execution_count":32,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"13c76cef9dc6e9251aa46e34e2c48c95","path":"/fnc/build/13c76cef9dc6e9251aa46e34e2c48c95.png"},"text/html":{"content_type":"text/html","hash":"15137c3ff425c011a10ab712edd8c0ab","path":"/fnc/build/15137c3ff425c011a10ab712edd8c0ab.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"7f562e7757373e5eb27e10fcc1fd12d3","path":"/fnc/build/7f562e7757373e5eb27e10fcc1fd12d3.svg"}}}],"key":"T54XVoiTTe"}],"data":{},"key":"igzFJVHuN4"},{"type":"paragraph","position":{"start":{"line":463,"column":1},"end":{"line":463,"column":1}},"children":[{"type":"text","value":"The solution makes a very abrupt change near ","position":{"start":{"line":463,"column":1},"end":{"line":463,"column":1}},"key":"AhP2aOdciP"},{"type":"inlineMath","value":"t=2.4","position":{"start":{"line":463,"column":1},"end":{"line":463,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003et\u003c/mi\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmn\u003e2.4\u003c/mn\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003et=2.4\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6151em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003et\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6444em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e2.4\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"PJ7j02FdE3"},{"type":"text","value":". The resulting time steps vary over three orders of magnitude.","position":{"start":{"line":463,"column":1},"end":{"line":463,"column":1}},"key":"DHDvnuqonB"}],"key":"ZWAgNBT15P"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"Δt = diff(t)\nplot(t[1:end-1], Δt, title=\"Adaptive step sizes\",\n    xaxis=(L\"t\", (0, 5)), yaxis=(:log10, \"step size\"))","key":"gYjnRMCxJf"},{"type":"output","id":"zT3QWOy5VBaOwzpbofuFa","data":[{"output_type":"execute_result","execution_count":33,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"a0fb87535fa921065e3241b4f03a05c7","path":"/fnc/build/a0fb87535fa921065e3241b4f03a05c7.png"},"text/html":{"content":"\u003c?xml version=\"1.0\" encoding=\"utf-8\"?\u003e\n\u003csvg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" width=\"500\" height=\"320\" viewBox=\"0 0 2000 1280\"\u003e\n\u003cdefs\u003e\n  \u003cclipPath id=\"clip350\"\u003e\n    \u003crect x=\"0\" y=\"0\" width=\"2000\" height=\"1280\"/\u003e\n  \u003c/clipPath\u003e\n\u003c/defs\u003e\n\u003cpath clip-path=\"url(#clip350)\" d=\"M0 1280 L2000 1280 L2000 0 L0 0  Z\" fill=\"#ffffff\" fill-rule=\"evenodd\" fill-opacity=\"1\"/\u003e\n\u003cdefs\u003e\n  \u003cclipPath id=\"clip351\"\u003e\n    \u003crect x=\"400\" y=\"0\" width=\"1401\" height=\"1280\"/\u003e\n  \u003c/clipPath\u003e\n\u003c/defs\u003e\n\u003cpath clip-path=\"url(#clip350)\" d=\"M245.508 1111.02 L1952.76 1111.02 L1952.76 107.256 L245.508 107.256  Z\" fill=\"#ffffff\" fill-rule=\"evenodd\" fill-opacity=\"1\"/\u003e\n\u003cdefs\u003e\n  \u003cclipPath id=\"clip352\"\u003e\n    \u003crect x=\"245\" y=\"107\" width=\"1708\" height=\"1005\"/\u003e\n  \u003c/clipPath\u003e\n\u003c/defs\u003e\n\u003cpolyline clip-path=\"url(#clip352)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"245.508,1111.02 245.508,107.256 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip352)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"586.957,1111.02 586.957,107.256 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip352)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"928.407,1111.02 928.407,107.256 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip352)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"1269.86,1111.02 1269.86,107.256 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip352)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"1611.31,1111.02 1611.31,107.256 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip352)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"1952.76,1111.02 1952.76,107.256 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip352)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"245.508,1000.16 1952.76,1000.16 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip352)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"245.508,509.899 1952.76,509.899 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip350)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"245.508,1111.02 1952.76,1111.02 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip350)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"245.508,1111.02 245.508,1092.12 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip350)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"586.957,1111.02 586.957,1092.12 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip350)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"928.407,1111.02 928.407,1092.12 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip350)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"1269.86,1111.02 1269.86,1092.12 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip350)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"1611.31,1111.02 1611.31,1092.12 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip350)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"1952.76,1111.02 1952.76,1092.12 \"/\u003e\n\u003cpath clip-path=\"url(#clip350)\" d=\"M245.508 1138.74 Q241.897 1138.74 240.068 1142.3 Q238.262 1145.84 238.262 1152.97 Q238.262 1160.08 240.068 1163.64 Q241.897 1167.19 245.508 1167.19 Q249.142 1167.19 250.947 1163.64 Q252.776 1160.08 252.776 1152.97 Q252.776 1145.84 250.947 1142.3 Q249.142 1138.74 245.508 1138.74 M245.508 1135.03 Q251.318 1135.03 254.373 1139.64 Q257.452 1144.22 257.452 1152.97 Q257.452 1161.7 254.373 1166.31 Q251.318 1170.89 245.508 1170.89 Q239.698 1170.89 236.619 1166.31 Q233.563 1161.7 233.563 1152.97 Q233.563 1144.22 236.619 1139.64 Q239.698 1135.03 245.508 1135.03 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip350)\" d=\"M577.339 1166.28 L584.978 1166.28 L584.978 1139.92 L576.668 1141.58 L576.668 1137.33 L584.932 1135.66 L589.608 1135.66 L589.608 1166.28 L597.247 1166.28 L597.247 1170.22 L577.339 1170.22 L577.339 1166.28 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip350)\" d=\"M923.06 1166.28 L939.379 1166.28 L939.379 1170.22 L917.435 1170.22 L917.435 1166.28 Q920.097 1163.53 924.68 1158.9 Q929.287 1154.25 930.467 1152.9 Q932.713 1150.38 933.592 1148.64 Q934.495 1146.89 934.495 1145.2 Q934.495 1142.44 932.55 1140.7 Q930.629 1138.97 927.527 1138.97 Q925.328 1138.97 922.875 1139.73 Q920.444 1140.5 917.666 1142.05 L917.666 1137.33 Q920.49 1136.19 922.944 1135.61 Q925.398 1135.03 927.435 1135.03 Q932.805 1135.03 936 1137.72 Q939.194 1140.4 939.194 1144.89 Q939.194 1147.02 938.384 1148.95 Q937.597 1150.84 935.49 1153.44 Q934.912 1154.11 931.81 1157.33 Q928.708 1160.52 923.06 1166.28 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip350)\" d=\"M1274.1 1151.58 Q1277.46 1152.3 1279.34 1154.57 Q1281.23 1156.84 1281.23 1160.17 Q1281.23 1165.29 1277.72 1168.09 Q1274.2 1170.89 1267.72 1170.89 Q1265.54 1170.89 1263.22 1170.45 Q1260.93 1170.03 1258.48 1169.18 L1258.48 1164.66 Q1260.42 1165.8 1262.74 1166.38 Q1265.05 1166.95 1267.58 1166.95 Q1271.97 1166.95 1274.27 1165.22 Q1276.58 1163.48 1276.58 1160.17 Q1276.58 1157.12 1274.43 1155.4 Q1272.3 1153.67 1268.48 1153.67 L1264.45 1153.67 L1264.45 1149.83 L1268.66 1149.83 Q1272.11 1149.83 1273.94 1148.46 Q1275.77 1147.07 1275.77 1144.48 Q1275.77 1141.82 1273.87 1140.4 Q1272 1138.97 1268.48 1138.97 Q1266.56 1138.97 1264.36 1139.39 Q1262.16 1139.8 1259.52 1140.68 L1259.52 1136.51 Q1262.18 1135.77 1264.5 1135.4 Q1266.84 1135.03 1268.9 1135.03 Q1274.22 1135.03 1277.32 1137.46 Q1280.42 1139.87 1280.42 1143.99 Q1280.42 1146.86 1278.78 1148.85 Q1277.14 1150.82 1274.1 1151.58 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip350)\" d=\"M1614.32 1139.73 L1602.51 1158.18 L1614.32 1158.18 L1614.32 1139.73 M1613.09 1135.66 L1618.97 1135.66 L1618.97 1158.18 L1623.9 1158.18 L1623.9 1162.07 L1618.97 1162.07 L1618.97 1170.22 L1614.32 1170.22 L1614.32 1162.07 L1598.71 1162.07 L1598.71 1157.56 L1613.09 1135.66 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip350)\" d=\"M1943.03 1135.66 L1961.39 1135.66 L1961.39 1139.59 L1947.32 1139.59 L1947.32 1148.07 Q1948.33 1147.72 1949.35 1147.56 Q1950.37 1147.37 1951.39 1147.37 Q1957.18 1147.37 1960.56 1150.54 Q1963.94 1153.71 1963.94 1159.13 Q1963.94 1164.71 1960.46 1167.81 Q1956.99 1170.89 1950.67 1170.89 Q1948.5 1170.89 1946.23 1170.52 Q1943.98 1170.15 1941.58 1169.41 L1941.58 1164.71 Q1943.66 1165.84 1945.88 1166.4 Q1948.1 1166.95 1950.58 1166.95 Q1954.58 1166.95 1956.92 1164.85 Q1959.26 1162.74 1959.26 1159.13 Q1959.26 1155.52 1956.92 1153.41 Q1954.58 1151.31 1950.58 1151.31 Q1948.71 1151.31 1946.83 1151.72 Q1944.98 1152.14 1943.03 1153.02 L1943.03 1135.66 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cg clip-path=\"url(#clip350)\"\u003e\n\u003cimage width=\"20\" height=\"42\" xlink:href=\"data:image/png;base64,\niVBORw0KGgoAAAANSUhEUgAAABQAAAAqCAYAAACz+XvQAAABb0lEQVRIia2WXbGEMAyFT6+CggQk\noAUN4AANSAAL4KAaKgENAQfZhws70B8mLduZPADpafr1TAqYGSlBRNy2LVtrOfQ9SWyeZwbwjXVd\nPdEkwasYAB7H0RNUR6JoKKVuycys3Jw/qdg0TbKVpdvVWt+2+z/VzxNXuO/77bnv+2CemKGEHyBk\nuCyL/OQk/KqqEvET+9AVG4YhKihiKOUHCBgm8QMAa63HJze01mHDvokvw23bglsry/L2TETR3RZF\noZLaFR7sIrKN6z+t9TtBt7pQ/0vyYYr/zhH1obj/uUPa/yT8Hhkig98jwxx+QIRhNr9j5Z/xizJE\nJr8ow1x+QIDhK37H6j/jF2SIF/xEglKh8+K6vRzHMbn/XecR0fv+d92VV2EOP2MMA2BjDHs+zPHf\nOefMFf99hUbXdQw4F1fuCa/rygC4aZpb3qOpY2JEFD20Rx8SkTfhPISYA6KeckWvd3Rd19HqH/mE\nIlT1NT62/UqELBm6rwAAAABJRU5ErkJggg==\n\" transform=\"translate(1089, 1200)\"/\u003e\n\u003c/g\u003e\n\u003cpolyline clip-path=\"url(#clip350)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"245.508,1111.02 245.508,107.256 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip350)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"245.508,1000.16 264.405,1000.16 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip350)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"245.508,509.899 264.405,509.899 \"/\u003e\n\u003cpath clip-path=\"url(#clip350)\" d=\"M113.675 1019.96 L121.314 1019.96 L121.314 993.592 L113.004 995.258 L113.004 990.999 L121.268 989.332 L125.944 989.332 L125.944 1019.96 L133.583 1019.96 L133.583 1023.89 L113.675 1023.89 L113.675 1019.96 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip350)\" d=\"M153.027 992.411 Q149.416 992.411 147.587 995.976 Q145.782 999.518 145.782 1006.65 Q145.782 1013.75 147.587 1017.32 Q149.416 1020.86 153.027 1020.86 Q156.661 1020.86 158.467 1017.32 Q160.295 1013.75 160.295 1006.65 Q160.295 999.518 158.467 995.976 Q156.661 992.411 153.027 992.411 M153.027 988.707 Q158.837 988.707 161.893 993.314 Q164.971 997.897 164.971 1006.65 Q164.971 1015.37 161.893 1019.98 Q158.837 1024.56 153.027 1024.56 Q147.217 1024.56 144.138 1019.98 Q141.082 1015.37 141.082 1006.65 Q141.082 997.897 144.138 993.314 Q147.217 988.707 153.027 988.707 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip350)\" d=\"M164.971 982.809 L189.083 982.809 L189.083 986.006 L164.971 986.006 L164.971 982.809 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip350)\" d=\"M207.721 971.712 L198.129 986.702 L207.721 986.702 L207.721 971.712 M206.724 968.402 L211.502 968.402 L211.502 986.702 L215.508 986.702 L215.508 989.862 L211.502 989.862 L211.502 996.482 L207.721 996.482 L207.721 989.862 L195.045 989.862 L195.045 986.194 L206.724 968.402 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip350)\" d=\"M115.368 529.691 L123.007 529.691 L123.007 503.326 L114.697 504.992 L114.697 500.733 L122.96 499.066 L127.636 499.066 L127.636 529.691 L135.275 529.691 L135.275 533.626 L115.368 533.626 L115.368 529.691 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip350)\" d=\"M154.72 502.145 Q151.108 502.145 149.28 505.71 Q147.474 509.252 147.474 516.381 Q147.474 523.488 149.28 527.052 Q151.108 530.594 154.72 530.594 Q158.354 530.594 160.159 527.052 Q161.988 523.488 161.988 516.381 Q161.988 509.252 160.159 505.71 Q158.354 502.145 154.72 502.145 M154.72 498.441 Q160.53 498.441 163.585 503.048 Q166.664 507.631 166.664 516.381 Q166.664 525.108 163.585 529.714 Q160.53 534.298 154.72 534.298 Q148.909 534.298 145.831 529.714 Q142.775 525.108 142.775 516.381 Q142.775 507.631 145.831 503.048 Q148.909 498.441 154.72 498.441 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip350)\" d=\"M166.664 492.543 L190.775 492.543 L190.775 495.74 L166.664 495.74 L166.664 492.543 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip350)\" d=\"M202.248 503.019 L215.508 503.019 L215.508 506.216 L197.678 506.216 L197.678 503.019 Q199.841 500.781 203.565 497.019 Q207.308 493.239 208.267 492.148 Q210.091 490.098 210.806 488.687 Q211.539 487.258 211.539 485.885 Q211.539 483.647 209.959 482.236 Q208.398 480.826 205.878 480.826 Q204.091 480.826 202.098 481.446 Q200.123 482.067 197.866 483.327 L197.866 479.49 Q200.161 478.569 202.154 478.098 Q204.148 477.628 205.803 477.628 Q210.166 477.628 212.762 479.81 Q215.357 481.992 215.357 485.64 Q215.357 487.371 214.699 488.932 Q214.06 490.474 212.348 492.58 Q211.878 493.126 209.358 495.74 Q206.837 498.336 202.248 503.019 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cg clip-path=\"url(#clip350)\"\u003e\n\u003ctext style=\"fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:66px; text-anchor:middle;\" transform=\"rotate(-90, 71.4418, 609.137)\" x=\"71.4418\" y=\"609.137\"\u003estep size\u003c/text\u003e\n\u003c/g\u003e\n\u003cg clip-path=\"url(#clip350)\"\u003e\n\u003ctext style=\"fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:66px; text-anchor:middle;\" transform=\"rotate(0, 1099.13, 57.6)\" x=\"1099.13\" y=\"57.6\"\u003eAdaptive step sizes\u003c/text\u003e\n\u003c/g\u003e\n\u003cpolyline clip-path=\"url(#clip352)\" style=\"stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none\" points=\"245.508,501.98 249.186,354.395 263.898,325.393 283.218,336.127 300.685,343.179 317.033,346.864 332.824,348.257 348.409,347.805 364.062,345.672 380.031,341.853 396.583,336.198 414.038,328.349 432.829,317.582 453.619,302.269 477.626,277.557 507.905,262.52 542.778,255.132 580.158,273.539 611.602,278.885 641.505,280.343 671.003,280.884 700.35,281.538 729.518,282.904 758.314,285.377 786.449,289.188 813.595,294.41 839.441,300.988 863.739,308.773 886.323,317.581 907.113,327.224 926.104,337.54 943.34,348.396 958.906,359.692 972.904,371.354 985.45,383.325 996.662,395.566 1006.66,408.048 1015.54,420.747 1023.43,433.647 1030.42,446.734 1036.6,459.997 1042.06,473.426 1046.87,487.013 1051.1,500.75 1054.82,514.63 1058.09,528.646 1060.95,542.791 1063.46,557.057 1065.65,571.439 1067.57,585.929 1069.24,600.519 1070.7,615.203 1071.97,629.972 1073.07,644.819 1074.03,659.736 1074.87,674.713 1075.59,689.741 1076.22,704.811 1076.77,719.914 1077.25,735.037 1077.66,750.17 1078.02,765.302 1078.33,780.418 1078.6,795.504 1078.83,810.547 1079.03,825.529 1079.21,840.433 1079.36,855.239 1079.49,869.923 1079.61,884.463 1079.71,898.829 1079.8,912.99 1079.88,926.907 1079.95,940.535 1080,953.823 1080.06,966.702 1080.1,979.091 1080.15,990.88 1080.18,1001.92 1080.22,1012.01 1080.25,1020.82 1080.28,1027.84 1080.3,1032.06 1080.33,1031.14 1080.35,1016.34 1080.38,1063.72 1080.4,1053.13 1080.42,1073.01 1080.44,1081.82 1080.45,1082.61 1080.47,1077.39 1080.49,1065.47 1080.51,1042.48 1080.53,1017.51 1080.56,1014.28 1080.59,1027.3 1080.61,1025.75 1080.64,1019.66 1080.67,1011.54 1080.7,1002.14 1080.73,991.809 1080.77,980.762 1080.81,969.133 1080.86,957.018 1080.91,944.485 1080.97,931.587 1081.03,918.366 1081.1,904.855 1081.19,891.081 1081.28,877.068 1081.39,862.834 1081.52,848.398 1081.66,833.772 1081.82,818.972 1082.01,804.007 1082.22,788.888 1082.47,773.626 1082.76,758.227 1083.09,742.701 1083.47,727.053 1083.92,711.291 1084.43,695.421 1085.03,679.449 1085.72,663.379 1086.53,647.217 1087.47,630.967 1088.57,614.635 1089.84,598.223 1091.33,581.736 1093.07,565.178 1095.1,548.551 1097.48,531.86 1100.26,515.106 1103.51,498.294 1107.32,481.425 1111.78,464.501 1117.01,447.525 1123.14,430.499 1130.34,413.423 1138.79,396.298 1148.72,379.126 1160.38,361.905 1174.09,344.636 1190.22,327.317 1209.19,309.948 1231.53,292.526 1257.83,275.052 1288.83,257.529 1325.38,239.964 1368.48,222.384 1419.32,204.846 1479.27,187.479 1549.84,170.558 1632.56,154.658 1728.62,140.874 1837.94,135.664 \"/\u003e\n\u003c/svg\u003e\n","content_type":"text/html"},"image/svg+xml":{"content":"\u003c?xml version=\"1.0\" encoding=\"utf-8\"?\u003e\n\u003csvg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" width=\"500\" height=\"320\" viewBox=\"0 0 2000 1280\"\u003e\n\u003cdefs\u003e\n  \u003cclipPath id=\"clip300\"\u003e\n    \u003crect x=\"0\" y=\"0\" width=\"2000\" height=\"1280\"/\u003e\n  \u003c/clipPath\u003e\n\u003c/defs\u003e\n\u003cpath clip-path=\"url(#clip300)\" d=\"M0 1280 L2000 1280 L2000 0 L0 0  Z\" fill=\"#ffffff\" fill-rule=\"evenodd\" fill-opacity=\"1\"/\u003e\n\u003cdefs\u003e\n  \u003cclipPath id=\"clip301\"\u003e\n    \u003crect x=\"400\" y=\"0\" width=\"1401\" height=\"1280\"/\u003e\n  \u003c/clipPath\u003e\n\u003c/defs\u003e\n\u003cpath clip-path=\"url(#clip300)\" d=\"M245.508 1111.02 L1952.76 1111.02 L1952.76 107.256 L245.508 107.256  Z\" fill=\"#ffffff\" fill-rule=\"evenodd\" fill-opacity=\"1\"/\u003e\n\u003cdefs\u003e\n  \u003cclipPath id=\"clip302\"\u003e\n    \u003crect x=\"245\" y=\"107\" width=\"1708\" height=\"1005\"/\u003e\n  \u003c/clipPath\u003e\n\u003c/defs\u003e\n\u003cpolyline clip-path=\"url(#clip302)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"245.508,1111.02 245.508,107.256 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip302)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"586.957,1111.02 586.957,107.256 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip302)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"928.407,1111.02 928.407,107.256 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip302)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"1269.86,1111.02 1269.86,107.256 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip302)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"1611.31,1111.02 1611.31,107.256 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip302)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"1952.76,1111.02 1952.76,107.256 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip302)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"245.508,1000.16 1952.76,1000.16 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip302)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"245.508,509.899 1952.76,509.899 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip300)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"245.508,1111.02 1952.76,1111.02 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip300)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"245.508,1111.02 245.508,1092.12 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip300)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"586.957,1111.02 586.957,1092.12 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip300)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"928.407,1111.02 928.407,1092.12 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip300)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"1269.86,1111.02 1269.86,1092.12 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip300)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"1611.31,1111.02 1611.31,1092.12 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip300)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"1952.76,1111.02 1952.76,1092.12 \"/\u003e\n\u003cpath clip-path=\"url(#clip300)\" d=\"M245.508 1138.74 Q241.897 1138.74 240.068 1142.3 Q238.262 1145.84 238.262 1152.97 Q238.262 1160.08 240.068 1163.64 Q241.897 1167.19 245.508 1167.19 Q249.142 1167.19 250.947 1163.64 Q252.776 1160.08 252.776 1152.97 Q252.776 1145.84 250.947 1142.3 Q249.142 1138.74 245.508 1138.74 M245.508 1135.03 Q251.318 1135.03 254.373 1139.64 Q257.452 1144.22 257.452 1152.97 Q257.452 1161.7 254.373 1166.31 Q251.318 1170.89 245.508 1170.89 Q239.698 1170.89 236.619 1166.31 Q233.563 1161.7 233.563 1152.97 Q233.563 1144.22 236.619 1139.64 Q239.698 1135.03 245.508 1135.03 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip300)\" d=\"M577.339 1166.28 L584.978 1166.28 L584.978 1139.92 L576.668 1141.58 L576.668 1137.33 L584.932 1135.66 L589.608 1135.66 L589.608 1166.28 L597.247 1166.28 L597.247 1170.22 L577.339 1170.22 L577.339 1166.28 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip300)\" d=\"M923.06 1166.28 L939.379 1166.28 L939.379 1170.22 L917.435 1170.22 L917.435 1166.28 Q920.097 1163.53 924.68 1158.9 Q929.287 1154.25 930.467 1152.9 Q932.713 1150.38 933.592 1148.64 Q934.495 1146.89 934.495 1145.2 Q934.495 1142.44 932.55 1140.7 Q930.629 1138.97 927.527 1138.97 Q925.328 1138.97 922.875 1139.73 Q920.444 1140.5 917.666 1142.05 L917.666 1137.33 Q920.49 1136.19 922.944 1135.61 Q925.398 1135.03 927.435 1135.03 Q932.805 1135.03 936 1137.72 Q939.194 1140.4 939.194 1144.89 Q939.194 1147.02 938.384 1148.95 Q937.597 1150.84 935.49 1153.44 Q934.912 1154.11 931.81 1157.33 Q928.708 1160.52 923.06 1166.28 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip300)\" d=\"M1274.1 1151.58 Q1277.46 1152.3 1279.34 1154.57 Q1281.23 1156.84 1281.23 1160.17 Q1281.23 1165.29 1277.72 1168.09 Q1274.2 1170.89 1267.72 1170.89 Q1265.54 1170.89 1263.22 1170.45 Q1260.93 1170.03 1258.48 1169.18 L1258.48 1164.66 Q1260.42 1165.8 1262.74 1166.38 Q1265.05 1166.95 1267.58 1166.95 Q1271.97 1166.95 1274.27 1165.22 Q1276.58 1163.48 1276.58 1160.17 Q1276.58 1157.12 1274.43 1155.4 Q1272.3 1153.67 1268.48 1153.67 L1264.45 1153.67 L1264.45 1149.83 L1268.66 1149.83 Q1272.11 1149.83 1273.94 1148.46 Q1275.77 1147.07 1275.77 1144.48 Q1275.77 1141.82 1273.87 1140.4 Q1272 1138.97 1268.48 1138.97 Q1266.56 1138.97 1264.36 1139.39 Q1262.16 1139.8 1259.52 1140.68 L1259.52 1136.51 Q1262.18 1135.77 1264.5 1135.4 Q1266.84 1135.03 1268.9 1135.03 Q1274.22 1135.03 1277.32 1137.46 Q1280.42 1139.87 1280.42 1143.99 Q1280.42 1146.86 1278.78 1148.85 Q1277.14 1150.82 1274.1 1151.58 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip300)\" d=\"M1614.32 1139.73 L1602.51 1158.18 L1614.32 1158.18 L1614.32 1139.73 M1613.09 1135.66 L1618.97 1135.66 L1618.97 1158.18 L1623.9 1158.18 L1623.9 1162.07 L1618.97 1162.07 L1618.97 1170.22 L1614.32 1170.22 L1614.32 1162.07 L1598.71 1162.07 L1598.71 1157.56 L1613.09 1135.66 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip300)\" d=\"M1943.03 1135.66 L1961.39 1135.66 L1961.39 1139.59 L1947.32 1139.59 L1947.32 1148.07 Q1948.33 1147.72 1949.35 1147.56 Q1950.37 1147.37 1951.39 1147.37 Q1957.18 1147.37 1960.56 1150.54 Q1963.94 1153.71 1963.94 1159.13 Q1963.94 1164.71 1960.46 1167.81 Q1956.99 1170.89 1950.67 1170.89 Q1948.5 1170.89 1946.23 1170.52 Q1943.98 1170.15 1941.58 1169.41 L1941.58 1164.71 Q1943.66 1165.84 1945.88 1166.4 Q1948.1 1166.95 1950.58 1166.95 Q1954.58 1166.95 1956.92 1164.85 Q1959.26 1162.74 1959.26 1159.13 Q1959.26 1155.52 1956.92 1153.41 Q1954.58 1151.31 1950.58 1151.31 Q1948.71 1151.31 1946.83 1151.72 Q1944.98 1152.14 1943.03 1153.02 L1943.03 1135.66 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cg clip-path=\"url(#clip300)\"\u003e\n\u003cimage width=\"20\" height=\"42\" xlink:href=\"data:image/png;base64,\niVBORw0KGgoAAAANSUhEUgAAABQAAAAqCAYAAACz+XvQAAABb0lEQVRIia2WXbGEMAyFT6+CggQk\noAUN4AANSAAL4KAaKgENAQfZhws70B8mLduZPADpafr1TAqYGSlBRNy2LVtrOfQ9SWyeZwbwjXVd\nPdEkwasYAB7H0RNUR6JoKKVuycys3Jw/qdg0TbKVpdvVWt+2+z/VzxNXuO/77bnv+2CemKGEHyBk\nuCyL/OQk/KqqEvET+9AVG4YhKihiKOUHCBgm8QMAa63HJze01mHDvokvw23bglsry/L2TETR3RZF\noZLaFR7sIrKN6z+t9TtBt7pQ/0vyYYr/zhH1obj/uUPa/yT8Hhkig98jwxx+QIRhNr9j5Z/xizJE\nJr8ow1x+QIDhK37H6j/jF2SIF/xEglKh8+K6vRzHMbn/XecR0fv+d92VV2EOP2MMA2BjDHs+zPHf\nOefMFf99hUbXdQw4F1fuCa/rygC4aZpb3qOpY2JEFD20Rx8SkTfhPISYA6KeckWvd3Rd19HqH/mE\nIlT1NT62/UqELBm6rwAAAABJRU5ErkJggg==\n\" transform=\"translate(1089, 1200)\"/\u003e\n\u003c/g\u003e\n\u003cpolyline clip-path=\"url(#clip300)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"245.508,1111.02 245.508,107.256 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip300)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"245.508,1000.16 264.405,1000.16 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip300)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"245.508,509.899 264.405,509.899 \"/\u003e\n\u003cpath clip-path=\"url(#clip300)\" d=\"M113.675 1019.96 L121.314 1019.96 L121.314 993.592 L113.004 995.258 L113.004 990.999 L121.268 989.332 L125.944 989.332 L125.944 1019.96 L133.583 1019.96 L133.583 1023.89 L113.675 1023.89 L113.675 1019.96 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip300)\" d=\"M153.027 992.411 Q149.416 992.411 147.587 995.976 Q145.782 999.518 145.782 1006.65 Q145.782 1013.75 147.587 1017.32 Q149.416 1020.86 153.027 1020.86 Q156.661 1020.86 158.467 1017.32 Q160.295 1013.75 160.295 1006.65 Q160.295 999.518 158.467 995.976 Q156.661 992.411 153.027 992.411 M153.027 988.707 Q158.837 988.707 161.893 993.314 Q164.971 997.897 164.971 1006.65 Q164.971 1015.37 161.893 1019.98 Q158.837 1024.56 153.027 1024.56 Q147.217 1024.56 144.138 1019.98 Q141.082 1015.37 141.082 1006.65 Q141.082 997.897 144.138 993.314 Q147.217 988.707 153.027 988.707 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip300)\" d=\"M164.971 982.809 L189.083 982.809 L189.083 986.006 L164.971 986.006 L164.971 982.809 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip300)\" d=\"M207.721 971.712 L198.129 986.702 L207.721 986.702 L207.721 971.712 M206.724 968.402 L211.502 968.402 L211.502 986.702 L215.508 986.702 L215.508 989.862 L211.502 989.862 L211.502 996.482 L207.721 996.482 L207.721 989.862 L195.045 989.862 L195.045 986.194 L206.724 968.402 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip300)\" d=\"M115.368 529.691 L123.007 529.691 L123.007 503.326 L114.697 504.992 L114.697 500.733 L122.96 499.066 L127.636 499.066 L127.636 529.691 L135.275 529.691 L135.275 533.626 L115.368 533.626 L115.368 529.691 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip300)\" d=\"M154.72 502.145 Q151.108 502.145 149.28 505.71 Q147.474 509.252 147.474 516.381 Q147.474 523.488 149.28 527.052 Q151.108 530.594 154.72 530.594 Q158.354 530.594 160.159 527.052 Q161.988 523.488 161.988 516.381 Q161.988 509.252 160.159 505.71 Q158.354 502.145 154.72 502.145 M154.72 498.441 Q160.53 498.441 163.585 503.048 Q166.664 507.631 166.664 516.381 Q166.664 525.108 163.585 529.714 Q160.53 534.298 154.72 534.298 Q148.909 534.298 145.831 529.714 Q142.775 525.108 142.775 516.381 Q142.775 507.631 145.831 503.048 Q148.909 498.441 154.72 498.441 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip300)\" d=\"M166.664 492.543 L190.775 492.543 L190.775 495.74 L166.664 495.74 L166.664 492.543 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip300)\" d=\"M202.248 503.019 L215.508 503.019 L215.508 506.216 L197.678 506.216 L197.678 503.019 Q199.841 500.781 203.565 497.019 Q207.308 493.239 208.267 492.148 Q210.091 490.098 210.806 488.687 Q211.539 487.258 211.539 485.885 Q211.539 483.647 209.959 482.236 Q208.398 480.826 205.878 480.826 Q204.091 480.826 202.098 481.446 Q200.123 482.067 197.866 483.327 L197.866 479.49 Q200.161 478.569 202.154 478.098 Q204.148 477.628 205.803 477.628 Q210.166 477.628 212.762 479.81 Q215.357 481.992 215.357 485.64 Q215.357 487.371 214.699 488.932 Q214.06 490.474 212.348 492.58 Q211.878 493.126 209.358 495.74 Q206.837 498.336 202.248 503.019 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cg clip-path=\"url(#clip300)\"\u003e\n\u003ctext style=\"fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:66px; text-anchor:middle;\" transform=\"rotate(-90, 71.4418, 609.137)\" x=\"71.4418\" y=\"609.137\"\u003estep size\u003c/text\u003e\n\u003c/g\u003e\n\u003cg clip-path=\"url(#clip300)\"\u003e\n\u003ctext style=\"fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:66px; text-anchor:middle;\" transform=\"rotate(0, 1099.13, 57.6)\" x=\"1099.13\" y=\"57.6\"\u003eAdaptive step sizes\u003c/text\u003e\n\u003c/g\u003e\n\u003cpolyline clip-path=\"url(#clip302)\" style=\"stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none\" points=\"245.508,501.98 249.186,354.395 263.898,325.393 283.218,336.127 300.685,343.179 317.033,346.864 332.824,348.257 348.409,347.805 364.062,345.672 380.031,341.853 396.583,336.198 414.038,328.349 432.829,317.582 453.619,302.269 477.626,277.557 507.905,262.52 542.778,255.132 580.158,273.539 611.602,278.885 641.505,280.343 671.003,280.884 700.35,281.538 729.518,282.904 758.314,285.377 786.449,289.188 813.595,294.41 839.441,300.988 863.739,308.773 886.323,317.581 907.113,327.224 926.104,337.54 943.34,348.396 958.906,359.692 972.904,371.354 985.45,383.325 996.662,395.566 1006.66,408.048 1015.54,420.747 1023.43,433.647 1030.42,446.734 1036.6,459.997 1042.06,473.426 1046.87,487.013 1051.1,500.75 1054.82,514.63 1058.09,528.646 1060.95,542.791 1063.46,557.057 1065.65,571.439 1067.57,585.929 1069.24,600.519 1070.7,615.203 1071.97,629.972 1073.07,644.819 1074.03,659.736 1074.87,674.713 1075.59,689.741 1076.22,704.811 1076.77,719.914 1077.25,735.037 1077.66,750.17 1078.02,765.302 1078.33,780.418 1078.6,795.504 1078.83,810.547 1079.03,825.529 1079.21,840.433 1079.36,855.239 1079.49,869.923 1079.61,884.463 1079.71,898.829 1079.8,912.99 1079.88,926.907 1079.95,940.535 1080,953.823 1080.06,966.702 1080.1,979.091 1080.15,990.88 1080.18,1001.92 1080.22,1012.01 1080.25,1020.82 1080.28,1027.84 1080.3,1032.06 1080.33,1031.14 1080.35,1016.34 1080.38,1063.72 1080.4,1053.13 1080.42,1073.01 1080.44,1081.82 1080.45,1082.61 1080.47,1077.39 1080.49,1065.47 1080.51,1042.48 1080.53,1017.51 1080.56,1014.28 1080.59,1027.3 1080.61,1025.75 1080.64,1019.66 1080.67,1011.54 1080.7,1002.14 1080.73,991.809 1080.77,980.762 1080.81,969.133 1080.86,957.018 1080.91,944.485 1080.97,931.587 1081.03,918.366 1081.1,904.855 1081.19,891.081 1081.28,877.068 1081.39,862.834 1081.52,848.398 1081.66,833.772 1081.82,818.972 1082.01,804.007 1082.22,788.888 1082.47,773.626 1082.76,758.227 1083.09,742.701 1083.47,727.053 1083.92,711.291 1084.43,695.421 1085.03,679.449 1085.72,663.379 1086.53,647.217 1087.47,630.967 1088.57,614.635 1089.84,598.223 1091.33,581.736 1093.07,565.178 1095.1,548.551 1097.48,531.86 1100.26,515.106 1103.51,498.294 1107.32,481.425 1111.78,464.501 1117.01,447.525 1123.14,430.499 1130.34,413.423 1138.79,396.298 1148.72,379.126 1160.38,361.905 1174.09,344.636 1190.22,327.317 1209.19,309.948 1231.53,292.526 1257.83,275.052 1288.83,257.529 1325.38,239.964 1368.48,222.384 1419.32,204.846 1479.27,187.479 1549.84,170.558 1632.56,154.658 1728.62,140.874 1837.94,135.664 \"/\u003e\n\u003c/svg\u003e\n","content_type":"image/svg+xml"}}}],"key":"S3csqD6XHL"}],"data":{},"key":"pbNoziSBtb"},{"type":"paragraph","position":{"start":{"line":471,"column":1},"end":{"line":471,"column":1}},"children":[{"type":"text","value":"If we had to run with a uniform step size to get this accuracy, it would be","position":{"start":{"line":471,"column":1},"end":{"line":471,"column":1}},"key":"TtZElIjnv3"}],"key":"BZ9iMFeqTf"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"println(\"minimum step size = $(minimum(Δt))\")","key":"saNPhYWW1Z"},{"type":"output","id":"QmcPtekzsKUOK6r0DUtEI","data":[{"output_type":"stream","name":"stdout","text":"minimum step size = 4.6096854609878335e-5\n"}],"key":"xNYyQF9ofd"}],"data":{},"key":"GSiGm9VeOY"},{"type":"paragraph","position":{"start":{"line":477,"column":1},"end":{"line":477,"column":1}},"children":[{"type":"text","value":"On the other hand, the average step size that was actually taken was","position":{"start":{"line":477,"column":1},"end":{"line":477,"column":1}},"key":"zPYHAiW80B"}],"key":"n3oMFEZyul"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"println(\"average step size = $(sum(Δt)/(length(t)-1))\")","key":"Xr9u8VEnW8"},{"type":"output","id":"QDaGGGBKOKmPXLAhLDnKN","data":[{"output_type":"stream","name":"stdout","text":"average step size = 0.03205128205128205\n"}],"key":"Ou2TN1YxlY"}],"data":{},"key":"JvGl3iXVh6"},{"type":"paragraph","position":{"start":{"line":483,"column":1},"end":{"line":483,"column":1}},"children":[{"type":"text","value":"We took fewer steps by a factor of almost 1000! Even accounting for the extra stage per step and the occasional rejected step, the savings are clear.","position":{"start":{"line":483,"column":1},"end":{"line":483,"column":1}},"key":"axrWPJqVlW"}],"key":"AKVSzoKZwB"}],"label":"demo-adapt-basic-julia","identifier":"demo-adapt-basic-julia","html_id":"demo-adapt-basic-julia","key":"cd1wc71il4"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Adaptive step size near a singularity","position":{"start":{"line":488,"column":1},"end":{"line":488,"column":1}},"key":"JmzXE0bUEU"}],"key":"b68h7E1me5"},{"type":"paragraph","position":{"start":{"line":489,"column":1},"end":{"line":489,"column":1}},"children":[{"type":"text","value":"In ","position":{"start":{"line":489,"column":1},"end":{"line":489,"column":1}},"key":"aqczIglRHe"},{"type":"crossReference","kind":"proof:example","identifier":"demo-basics-sing","label":"demo-basics-sing","children":[{"type":"text","value":"Demo ","key":"B2HMN1zTpr"},{"type":"text","value":"6.1.3","key":"ch34UtX1sV"}],"template":"Example %s","enumerator":"6.1.3","resolved":true,"html_id":"demo-basics-sing","remote":true,"url":"/basics","dataUrl":"/basics.json","key":"RGGtRbkscY"},{"type":"text","value":" we saw an IVP that appears to blow up in a finite amount of time. Because the solution increases so rapidly as it approaches the blowup, adaptive stepping is required even to get close.","position":{"start":{"line":489,"column":1},"end":{"line":489,"column":1}},"key":"jj2Og56DSq"}],"key":"SohIbTzgkU"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"f(u, p, t) = (t + u)^2\nivp = ODEProblem(f, 1, (0.0, 1.0))\nt, u = FNC.rk23(ivp, 1e-5);","key":"ZybYnp27Ie"},{"type":"output","id":"4MelkYh79DqXTqEGmsGXZ","data":[{"output_type":"stream","name":"stderr","text":"\u001b[33m\u001b[1m┌ \u001b[22m\u001b[39m\u001b[33m\u001b[1mWarning: \u001b[22m\u001b[39mStepsize too small near t=0.7854087204072808\n\u001b[33m\u001b[1m└ \u001b[22m\u001b[39m\u001b[90m@ FundamentalsNumericalComputation ~/.julia/packages/FundamentalsNumericalComputation/Gvhz2/src/chapter06.jl:93\u001b[39m\n"}],"key":"MPynrxPb6C"}],"data":{},"key":"yUnIVLp1nu"},{"type":"paragraph","position":{"start":{"line":497,"column":1},"end":{"line":497,"column":1}},"children":[{"type":"text","value":"In fact, the failure of the adaptivity gives a decent idea of when the singularity occurs.","position":{"start":{"line":497,"column":1},"end":{"line":497,"column":1}},"key":"VCkZCWuHyn"}],"key":"F8h6yTmWU3"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"plot(t, u, legend=:none,\n    xlabel=L\"t\", yaxis=(:log10, L\"u(t)\"), title=\"Finite-time blowup\")\n\ntf = t[end]\nvline!([tf], l=:dash)\nannotate!(tf, 1e5, latexstring(@sprintf(\"t = %.6f \", tf)), :right)","key":"Xk40VEZdUc"},{"type":"output","id":"8zTokisv3qv4zN2BxVKEy","data":[{"output_type":"execute_result","execution_count":37,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"79dfa2cf97e3907772dff193a0db65fa","path":"/fnc/build/79dfa2cf97e3907772dff193a0db65fa.png"},"text/html":{"content_type":"text/html","hash":"de9114133b64a98cf40d577df1ed694b","path":"/fnc/build/de9114133b64a98cf40d577df1ed694b.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"1d944cf0534b4e134d96828273f04885","path":"/fnc/build/1d944cf0534b4e134d96828273f04885.svg"}}}],"key":"U7p8RTtuot"}],"data":{},"key":"XQajfP4LkO"}],"label":"demo-adpat-sing-julia","identifier":"demo-adpat-sing-julia","html_id":"demo-adpat-sing-julia","key":"tVgrbYcOvi"},{"type":"heading","depth":3,"position":{"start":{"line":509,"column":1},"end":{"line":509,"column":1}},"children":[{"type":"text","value":"Section 6.6","position":{"start":{"line":509,"column":1},"end":{"line":509,"column":1}},"key":"UB53miMrkH"}],"identifier":"section-6-6","label":"Section 6.6","html_id":"section-6-6","implicit":true,"key":"i365J5EzVj"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Convergence of Adams–Bashforth","position":{"start":{"line":511,"column":1},"end":{"line":511,"column":1}},"key":"kuKfSs8UZM"}],"key":"iEY4GKS6Fb"},{"type":"paragraph","position":{"start":{"line":512,"column":1},"end":{"line":512,"column":1}},"children":[{"type":"text","value":"We study the convergence of AB4 using the IVP ","position":{"start":{"line":512,"column":1},"end":{"line":512,"column":1}},"key":"EZ9Tb3ouP0"},{"type":"inlineMath","value":"u'=\\sin[(u+t)^2]","position":{"start":{"line":512,"column":1},"end":{"line":512,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsup\u003e\u003cmi\u003eu\u003c/mi\u003e\u003cmo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\"\u003e′\u003c/mo\u003e\u003c/msup\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmi\u003esin\u003c/mi\u003e\u003cmo\u003e⁡\u003c/mo\u003e\u003cmo stretchy=\"false\"\u003e[\u003c/mo\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmi\u003eu\u003c/mi\u003e\u003cmo\u003e+\u003c/mo\u003e\u003cmi\u003et\u003c/mi\u003e\u003cmsup\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003cmn\u003e2\u003c/mn\u003e\u003c/msup\u003e\u003cmo stretchy=\"false\"\u003e]\u003c/mo\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003eu\u0026#x27;=\\sin[(u+t)^2]\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.7519em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003eu\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.7519em;\"\u003e\u003cspan style=\"top:-3.063em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e′\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mop\"\u003esin\u003c/span\u003e\u003cspan class=\"mopen\"\u003e[(\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003eu\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e+\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003et\u003c/span\u003e\u003cspan class=\"mclose\"\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.8141em;\"\u003e\u003cspan style=\"top:-3.063em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e2\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose\"\u003e]\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"DxK3lzj68K"},{"type":"text","value":" over ","position":{"start":{"line":512,"column":1},"end":{"line":512,"column":1}},"key":"hBzYpYxfgn"},{"type":"inlineMath","value":"0\\le t \\le 4","position":{"start":{"line":512,"column":1},"end":{"line":512,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmn\u003e0\u003c/mn\u003e\u003cmo\u003e≤\u003c/mo\u003e\u003cmi\u003et\u003c/mi\u003e\u003cmo\u003e≤\u003c/mo\u003e\u003cmn\u003e4\u003c/mn\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e0\\le t \\le 4\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.7804em;vertical-align:-0.136em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e0\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e≤\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.7719em;vertical-align:-0.136em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003et\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e≤\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6444em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e4\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"H7guWkXUIj"},{"type":"text","value":", with ","position":{"start":{"line":512,"column":1},"end":{"line":512,"column":1}},"key":"IrJsc9IfeK"},{"type":"inlineMath","value":"u(0)=-1","position":{"start":{"line":512,"column":1},"end":{"line":512,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003eu\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmn\u003e0\u003c/mn\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmo\u003e−\u003c/mo\u003e\u003cmn\u003e1\u003c/mn\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003eu(0)=-1\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003eu\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord\"\u003e0\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e−\u003c/span\u003e\u003cspan class=\"mord\"\u003e1\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"pTIpdcwBDg"},{"type":"text","value":". As usual, ","position":{"start":{"line":512,"column":1},"end":{"line":512,"column":1}},"key":"waKncGhuvU"},{"type":"inlineCode","value":"solve","position":{"start":{"line":512,"column":1},"end":{"line":512,"column":1}},"key":"NuokByOHEc"},{"type":"text","value":" is called to give an accurate reference solution.","position":{"start":{"line":512,"column":1},"end":{"line":512,"column":1}},"key":"p1spjx5RxW"}],"key":"fcz5gxcfiB"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"ivp = ODEProblem((u, p, t) -\u003e sin((t + u)^2), -1.0, (0.0, 4.0))\nu_ref = solve(ivp, Tsit5(), reltol=1e-14, abstol=1e-14);","key":"P3a8tpOQdV"},{"type":"output","id":"OlGSbc3bnGuFsLBIZQKP7","data":[],"key":"Hjxyu8ZWUj"}],"data":{},"key":"y3Q2bW3IxJ"},{"type":"paragraph","position":{"start":{"line":519,"column":1},"end":{"line":519,"column":1}},"children":[{"type":"text","value":"Now we perform a convergence study of the AB4 code.","position":{"start":{"line":519,"column":1},"end":{"line":519,"column":1}},"key":"EZx0OFatKC"}],"key":"Kj3zkH4Otc"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"n = @. [round(Int, 4 * 10^k) for k in 0:0.5:3]\nerr = []\nfor n in n\n    t, u = FNC.ab4(ivp, n)\n    push!(err, norm(u_ref.(t) - u, Inf))\nend\n\npretty_table([n err], header=[\"n\", \"inf-norm error\"])","key":"oUUWP1TkZo"},{"type":"output","id":"vPyQstAthnOtd29bWYVfc","data":[{"output_type":"stream","name":"stdout","text":"┌──────┬────────────────┐\n│\u001b[1m    n \u001b[0m│\u001b[1m inf-norm error \u001b[0m│\n├──────┼────────────────┤\n│    4 │        0.50044 │\n│   13 │        1.39129 │\n│   40 │     0.00627809 │\n│  126 │     9.94942e-5 │\n│  400 │     1.09598e-6 │\n│ 1265 │     1.12766e-8 │\n│ 4000 │    1.13736e-10 │\n└──────┴────────────────┘\n"}],"key":"Lrq6XSoTrF"}],"data":{},"key":"aH8EQhL7mi"},{"type":"paragraph","position":{"start":{"line":532,"column":1},"end":{"line":532,"column":1}},"children":[{"type":"text","value":"The method should converge as ","position":{"start":{"line":532,"column":1},"end":{"line":532,"column":1}},"key":"fwNM9hUwyP"},{"type":"inlineMath","value":"O(h^4)","position":{"start":{"line":532,"column":1},"end":{"line":532,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003eO\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmsup\u003e\u003cmi\u003eh\u003c/mi\u003e\u003cmn\u003e4\u003c/mn\u003e\u003c/msup\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003eO(h^4)\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\"\u003eO\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003eh\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.8141em;\"\u003e\u003cspan style=\"top:-3.063em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e4\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"kzXfpqew6N"},{"type":"text","value":", so a log-log scale is appropriate for the errors.","position":{"start":{"line":532,"column":1},"end":{"line":532,"column":1}},"key":"PxptqRsdK1"}],"key":"wtbBAVbg3j"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"plot(n, err, m=3, label=\"AB4\",\n    xaxis=(:log10, L\"n\"), yaxis=(:log10, \"inf-norm error\"),\n    title=\"Convergence of AB4\", leg=:bottomleft)\n\nplot!(n, (n / n[1]) .^ (-4), l=:dash, label=L\"O(n^{-4})\")","key":"QqbVaC8mVm"},{"type":"output","id":"ktUtMGCcYQxXjHgbC9h2W","data":[{"output_type":"execute_result","execution_count":40,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"9301c8720e616488bb772c7c0e20f5c9","path":"/fnc/build/9301c8720e616488bb772c7c0e20f5c9.png"},"text/html":{"content":"\u003c?xml version=\"1.0\" encoding=\"utf-8\"?\u003e\n\u003csvg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" width=\"500\" height=\"320\" viewBox=\"0 0 2000 1280\"\u003e\n\u003cdefs\u003e\n  \u003cclipPath id=\"clip530\"\u003e\n    \u003crect x=\"0\" y=\"0\" width=\"2000\" height=\"1280\"/\u003e\n  \u003c/clipPath\u003e\n\u003c/defs\u003e\n\u003cpath clip-path=\"url(#clip530)\" d=\"M0 1280 L2000 1280 L2000 0 L0 0  Z\" fill=\"#ffffff\" fill-rule=\"evenodd\" fill-opacity=\"1\"/\u003e\n\u003cdefs\u003e\n  \u003cclipPath id=\"clip531\"\u003e\n    \u003crect x=\"400\" y=\"0\" width=\"1401\" height=\"1280\"/\u003e\n  \u003c/clipPath\u003e\n\u003c/defs\u003e\n\u003cpath clip-path=\"url(#clip530)\" d=\"M269.619 1099.23 L1952.76 1099.23 L1952.76 107.256 L269.619 107.256  Z\" fill=\"#ffffff\" fill-rule=\"evenodd\" fill-opacity=\"1\"/\u003e\n\u003cdefs\u003e\n  \u003cclipPath id=\"clip532\"\u003e\n    \u003crect x=\"269\" y=\"107\" width=\"1684\" height=\"993\"/\u003e\n  \u003c/clipPath\u003e\n\u003c/defs\u003e\n\u003cpolyline clip-path=\"url(#clip532)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"527.88,1099.23 527.88,107.256 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip532)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"1057.17,1099.23 1057.17,107.256 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip532)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"1586.46,1099.23 1586.46,107.256 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip532)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"269.619,917.024 1952.76,917.024 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip532)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"269.619,531.703 1952.76,531.703 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip532)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"269.619,146.383 1952.76,146.383 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip530)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"269.619,1099.23 1952.76,1099.23 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip530)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"527.88,1099.23 527.88,1080.33 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip530)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"1057.17,1099.23 1057.17,1080.33 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip530)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"1586.46,1099.23 1586.46,1080.33 \"/\u003e\n\u003cpath clip-path=\"url(#clip530)\" d=\"M494.208 1170.15 L501.847 1170.15 L501.847 1143.79 L493.536 1145.45 L493.536 1141.19 L501.8 1139.53 L506.476 1139.53 L506.476 1170.15 L514.115 1170.15 L514.115 1174.09 L494.208 1174.09 L494.208 1170.15 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip530)\" d=\"M533.559 1142.61 Q529.948 1142.61 528.12 1146.17 Q526.314 1149.71 526.314 1156.84 Q526.314 1163.95 528.12 1167.51 Q529.948 1171.05 533.559 1171.05 Q537.194 1171.05 538.999 1167.51 Q540.828 1163.95 540.828 1156.84 Q540.828 1149.71 538.999 1146.17 Q537.194 1142.61 533.559 1142.61 M533.559 1138.9 Q539.37 1138.9 542.425 1143.51 Q545.504 1148.09 545.504 1156.84 Q545.504 1165.57 542.425 1170.17 Q539.37 1174.76 533.559 1174.76 Q527.749 1174.76 524.671 1170.17 Q521.615 1165.57 521.615 1156.84 Q521.615 1148.09 524.671 1143.51 Q527.749 1138.9 533.559 1138.9 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip530)\" d=\"M546.049 1143.48 L552.256 1143.48 L552.256 1122.06 L545.504 1123.41 L545.504 1119.95 L552.218 1118.6 L556.017 1118.6 L556.017 1143.48 L562.224 1143.48 L562.224 1146.68 L546.049 1146.68 L546.049 1143.48 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip530)\" d=\"M1022.94 1170.15 L1030.58 1170.15 L1030.58 1143.79 L1022.27 1145.45 L1022.27 1141.19 L1030.53 1139.53 L1035.21 1139.53 L1035.21 1170.15 L1042.85 1170.15 L1042.85 1174.09 L1022.94 1174.09 L1022.94 1170.15 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip530)\" d=\"M1062.29 1142.61 Q1058.68 1142.61 1056.85 1146.17 Q1055.05 1149.71 1055.05 1156.84 Q1055.05 1163.95 1056.85 1167.51 Q1058.68 1171.05 1062.29 1171.05 Q1065.93 1171.05 1067.73 1167.51 Q1069.56 1163.95 1069.56 1156.84 Q1069.56 1149.71 1067.73 1146.17 Q1065.93 1142.61 1062.29 1142.61 M1062.29 1138.9 Q1068.1 1138.9 1071.16 1143.51 Q1074.24 1148.09 1074.24 1156.84 Q1074.24 1165.57 1071.16 1170.17 Q1068.1 1174.76 1062.29 1174.76 Q1056.48 1174.76 1053.4 1170.17 Q1050.35 1165.57 1050.35 1156.84 Q1050.35 1148.09 1053.4 1143.51 Q1056.48 1138.9 1062.29 1138.9 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip530)\" d=\"M1078.81 1143.48 L1092.07 1143.48 L1092.07 1146.68 L1074.24 1146.68 L1074.24 1143.48 Q1076.4 1141.24 1080.12 1137.48 Q1083.87 1133.7 1084.83 1132.61 Q1086.65 1130.56 1087.37 1129.15 Q1088.1 1127.72 1088.1 1126.35 Q1088.1 1124.11 1086.52 1122.7 Q1084.96 1121.29 1082.44 1121.29 Q1080.65 1121.29 1078.66 1121.91 Q1076.68 1122.53 1074.43 1123.79 L1074.43 1119.95 Q1076.72 1119.03 1078.71 1118.56 Q1080.71 1118.09 1082.36 1118.09 Q1086.73 1118.09 1089.32 1120.27 Q1091.92 1122.45 1091.92 1126.1 Q1091.92 1127.83 1091.26 1129.39 Q1090.62 1130.93 1088.91 1133.04 Q1088.44 1133.59 1085.92 1136.2 Q1083.4 1138.8 1078.81 1143.48 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip530)\" d=\"M1551.9 1170.15 L1559.54 1170.15 L1559.54 1143.79 L1551.23 1145.45 L1551.23 1141.19 L1559.49 1139.53 L1564.17 1139.53 L1564.17 1170.15 L1571.81 1170.15 L1571.81 1174.09 L1551.9 1174.09 L1551.9 1170.15 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip530)\" d=\"M1591.25 1142.61 Q1587.64 1142.61 1585.81 1146.17 Q1584.01 1149.71 1584.01 1156.84 Q1584.01 1163.95 1585.81 1167.51 Q1587.64 1171.05 1591.25 1171.05 Q1594.89 1171.05 1596.69 1167.51 Q1598.52 1163.95 1598.52 1156.84 Q1598.52 1149.71 1596.69 1146.17 Q1594.89 1142.61 1591.25 1142.61 M1591.25 1138.9 Q1597.06 1138.9 1600.12 1143.51 Q1603.2 1148.09 1603.2 1156.84 Q1603.2 1165.57 1600.12 1170.17 Q1597.06 1174.76 1591.25 1174.76 Q1585.44 1174.76 1582.36 1170.17 Q1579.31 1165.57 1579.31 1156.84 Q1579.31 1148.09 1582.36 1143.51 Q1585.44 1138.9 1591.25 1138.9 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip530)\" d=\"M1615.89 1131.54 Q1618.62 1132.12 1620.14 1133.96 Q1621.68 1135.81 1621.68 1138.51 Q1621.68 1142.67 1618.83 1144.95 Q1615.97 1147.22 1610.7 1147.22 Q1608.93 1147.22 1607.05 1146.86 Q1605.19 1146.53 1603.2 1145.83 L1603.2 1142.16 Q1604.78 1143.08 1606.66 1143.55 Q1608.54 1144.02 1610.59 1144.02 Q1614.16 1144.02 1616.02 1142.61 Q1617.9 1141.2 1617.9 1138.51 Q1617.9 1136.03 1616.15 1134.64 Q1614.42 1133.23 1611.32 1133.23 L1608.05 1133.23 L1608.05 1130.11 L1611.47 1130.11 Q1614.27 1130.11 1615.76 1129 Q1617.25 1127.87 1617.25 1125.76 Q1617.25 1123.6 1615.7 1122.45 Q1614.18 1121.29 1611.32 1121.29 Q1609.76 1121.29 1607.97 1121.62 Q1606.19 1121.96 1604.04 1122.68 L1604.04 1119.29 Q1606.21 1118.69 1608.09 1118.39 Q1609.99 1118.09 1611.66 1118.09 Q1615.99 1118.09 1618.51 1120.06 Q1621.03 1122.02 1621.03 1125.37 Q1621.03 1127.7 1619.69 1129.32 Q1618.36 1130.92 1615.89 1131.54 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cg clip-path=\"url(#clip530)\"\u003e\n\u003cimage width=\"36\" height=\"30\" xlink:href=\"data:image/png;base64,\niVBORw0KGgoAAAANSUhEUgAAACQAAAAeCAYAAABE4bxTAAABuUlEQVRYhbVYW4GEMAyMBDRUAhoq\nAQ1IQAMS0FAJaEACGmph7uOue21I+trykR+aHSaZSVuWABAP7z2stSAiGGPgnIOUp8W2bZjnGUSE\naZpgrcV5nlUY8kMi8Ni2rQh4nufjd3Gs61rEUMlc1wUAtCxLAiqBXNeV5BzH8cnz3sMYk6zf960S\nE8nkOmatTdZjaXKVBwvkCksIhXZLWvMKw/NpmkBE1R6LMbQCit2JuxDCOfcxrfe+2vDcU0VCmulC\nJ3gEnw0ntO97XtfOiSnhSAUV5dIItZKRcKRp+yQaY8SX8JFu9U2zZN57dbogGLq3O1JhqodyYzvC\nO8BzHypOWS2hUXIty9JOSDqbesi0FJYFGeWfsK00HR1v+ofjaBPdTGiUf6pP+zf80yJXltAo/3CM\neZ77CHGgmhvjt7I75971z7qu1V0+juM3R2X6glzaZpjkSov8hthDKJyR1Wb+I1xVWc/+wz8OcoSC\ntNBMPcI//JaZGwqi/zv2a/7hsmtFxd0RCY3wD/DcEHM+iy1RlKt3/+FYGhn+OVQk1EsGSI+f8OL4\nfwMJPytZ7+kex33fDwsQEfZ9F7F/AEI9aqd2YHXbAAAAAElFTkSuQmCC\n\" transform=\"translate(1093, 1212)\"/\u003e\n\u003c/g\u003e\n\u003cpolyline clip-path=\"url(#clip530)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"269.619,1099.23 269.619,107.256 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip530)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"269.619,917.024 288.517,917.024 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip530)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"269.619,531.703 288.517,531.703 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip530)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"269.619,146.383 288.517,146.383 \"/\u003e\n\u003cpath clip-path=\"url(#clip530)\" d=\"M113.675 936.816 L121.314 936.816 L121.314 910.451 L113.004 912.117 L113.004 907.858 L121.268 906.191 L125.944 906.191 L125.944 936.816 L133.583 936.816 L133.583 940.751 L113.675 940.751 L113.675 936.816 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip530)\" d=\"M153.027 909.27 Q149.416 909.27 147.587 912.835 Q145.782 916.377 145.782 923.506 Q145.782 930.613 147.587 934.177 Q149.416 937.719 153.027 937.719 Q156.661 937.719 158.467 934.177 Q160.295 930.613 160.295 923.506 Q160.295 916.377 158.467 912.835 Q156.661 909.27 153.027 909.27 M153.027 905.566 Q158.837 905.566 161.893 910.173 Q164.971 914.756 164.971 923.506 Q164.971 932.233 161.893 936.839 Q158.837 941.423 153.027 941.423 Q147.217 941.423 144.138 936.839 Q141.082 932.233 141.082 923.506 Q141.082 914.756 144.138 910.173 Q147.217 905.566 153.027 905.566 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip530)\" d=\"M164.971 899.668 L189.083 899.668 L189.083 902.865 L164.971 902.865 L164.971 899.668 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip530)\" d=\"M197.941 910.144 L204.148 910.144 L204.148 888.722 L197.396 890.076 L197.396 886.615 L204.11 885.261 L207.909 885.261 L207.909 910.144 L214.116 910.144 L214.116 913.341 L197.941 913.341 L197.941 910.144 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip530)\" d=\"M229.914 887.762 Q226.98 887.762 225.495 890.659 Q224.028 893.536 224.028 899.329 Q224.028 905.103 225.495 908 Q226.98 910.877 229.914 910.877 Q232.867 910.877 234.334 908 Q235.82 905.103 235.82 899.329 Q235.82 893.536 234.334 890.659 Q232.867 887.762 229.914 887.762 M229.914 884.753 Q234.635 884.753 237.118 888.496 Q239.619 892.22 239.619 899.329 Q239.619 906.42 237.118 910.162 Q234.635 913.886 229.914 913.886 Q225.194 913.886 222.692 910.162 Q220.21 906.42 220.21 899.329 Q220.21 892.22 222.692 888.496 Q225.194 884.753 229.914 884.753 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip530)\" d=\"M138.99 551.496 L146.629 551.496 L146.629 525.13 L138.319 526.797 L138.319 522.538 L146.583 520.871 L151.259 520.871 L151.259 551.496 L158.898 551.496 L158.898 555.431 L138.99 555.431 L138.99 551.496 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip530)\" d=\"M178.342 523.95 Q174.731 523.95 172.902 527.514 Q171.097 531.056 171.097 538.186 Q171.097 545.292 172.902 548.857 Q174.731 552.399 178.342 552.399 Q181.976 552.399 183.782 548.857 Q185.611 545.292 185.611 538.186 Q185.611 531.056 183.782 527.514 Q181.976 523.95 178.342 523.95 M178.342 520.246 Q184.152 520.246 187.208 524.852 Q190.286 529.436 190.286 538.186 Q190.286 546.913 187.208 551.519 Q184.152 556.102 178.342 556.102 Q172.532 556.102 169.453 551.519 Q166.398 546.913 166.398 538.186 Q166.398 529.436 169.453 524.852 Q172.532 520.246 178.342 520.246 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip530)\" d=\"M190.286 514.347 L214.398 514.347 L214.398 517.545 L190.286 517.545 L190.286 514.347 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip530)\" d=\"M222.636 499.941 L237.55 499.941 L237.55 503.138 L226.115 503.138 L226.115 510.022 Q226.943 509.739 227.77 509.608 Q228.598 509.457 229.425 509.457 Q234.127 509.457 236.873 512.034 Q239.619 514.611 239.619 519.012 Q239.619 523.544 236.798 526.065 Q233.977 528.566 228.842 528.566 Q227.074 528.566 225.231 528.265 Q223.407 527.964 221.451 527.362 L221.451 523.544 Q223.144 524.466 224.949 524.917 Q226.755 525.369 228.767 525.369 Q232.021 525.369 233.921 523.657 Q235.82 521.946 235.82 519.012 Q235.82 516.078 233.921 514.366 Q232.021 512.655 228.767 512.655 Q227.244 512.655 225.72 512.993 Q224.216 513.332 222.636 514.046 L222.636 499.941 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip530)\" d=\"M168.914 166.175 L176.552 166.175 L176.552 139.81 L168.242 141.476 L168.242 137.217 L176.506 135.551 L181.182 135.551 L181.182 166.175 L188.821 166.175 L188.821 170.111 L168.914 170.111 L168.914 166.175 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip530)\" d=\"M208.265 138.629 Q204.654 138.629 202.825 142.194 Q201.02 145.736 201.02 152.865 Q201.02 159.972 202.825 163.537 Q204.654 167.078 208.265 167.078 Q211.9 167.078 213.705 163.537 Q215.534 159.972 215.534 152.865 Q215.534 145.736 213.705 142.194 Q211.9 138.629 208.265 138.629 M208.265 134.926 Q214.075 134.926 217.131 139.532 Q220.21 144.115 220.21 152.865 Q220.21 161.592 217.131 166.199 Q214.075 170.782 208.265 170.782 Q202.455 170.782 199.376 166.199 Q196.321 161.592 196.321 152.865 Q196.321 144.115 199.376 139.532 Q202.455 134.926 208.265 134.926 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip530)\" d=\"M229.914 117.122 Q226.98 117.122 225.495 120.018 Q224.028 122.896 224.028 128.688 Q224.028 134.462 225.495 137.359 Q226.98 140.236 229.914 140.236 Q232.867 140.236 234.334 137.359 Q235.82 134.462 235.82 128.688 Q235.82 122.896 234.334 120.018 Q232.867 117.122 229.914 117.122 M229.914 114.112 Q234.635 114.112 237.118 117.855 Q239.619 121.579 239.619 128.688 Q239.619 135.779 237.118 139.522 Q234.635 143.246 229.914 143.246 Q225.194 143.246 222.692 139.522 Q220.21 135.779 220.21 128.688 Q220.21 121.579 222.692 117.855 Q225.194 114.112 229.914 114.112 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cg clip-path=\"url(#clip530)\"\u003e\n\u003ctext style=\"fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:66px; text-anchor:middle;\" transform=\"rotate(-90, 71.4418, 603.241)\" x=\"71.4418\" y=\"603.241\"\u003einf-norm error\u003c/text\u003e\n\u003c/g\u003e\n\u003cg clip-path=\"url(#clip530)\"\u003e\n\u003ctext style=\"fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:66px; text-anchor:middle;\" transform=\"rotate(0, 1111.19, 57.6)\" x=\"1111.19\" y=\"57.6\"\u003eConvergence of AB4\u003c/text\u003e\n\u003c/g\u003e\n\u003cpolyline clip-path=\"url(#clip532)\" style=\"stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none\" points=\"317.255,169.552 588.189,135.331 846.543,316.091 1110.29,454.809 1375.83,605.7 1640.49,758.875 1905.12,912.716 \"/\u003e\n\u003ccircle clip-path=\"url(#clip532)\" cx=\"317.255\" cy=\"169.552\" r=\"10.8\" fill=\"#009af9\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"#000000\" stroke-opacity=\"1\" stroke-width=\"2.56\"/\u003e\n\u003ccircle clip-path=\"url(#clip532)\" cx=\"588.189\" cy=\"135.331\" r=\"10.8\" fill=\"#009af9\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"#000000\" stroke-opacity=\"1\" stroke-width=\"2.56\"/\u003e\n\u003ccircle clip-path=\"url(#clip532)\" cx=\"846.543\" cy=\"316.091\" r=\"10.8\" fill=\"#009af9\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"#000000\" stroke-opacity=\"1\" stroke-width=\"2.56\"/\u003e\n\u003ccircle clip-path=\"url(#clip532)\" cx=\"1110.29\" cy=\"454.809\" r=\"10.8\" fill=\"#009af9\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"#000000\" stroke-opacity=\"1\" stroke-width=\"2.56\"/\u003e\n\u003ccircle clip-path=\"url(#clip532)\" cx=\"1375.83\" cy=\"605.7\" r=\"10.8\" fill=\"#009af9\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"#000000\" stroke-opacity=\"1\" stroke-width=\"2.56\"/\u003e\n\u003ccircle clip-path=\"url(#clip532)\" cx=\"1640.49\" cy=\"758.875\" r=\"10.8\" fill=\"#009af9\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"#000000\" stroke-opacity=\"1\" stroke-width=\"2.56\"/\u003e\n\u003ccircle clip-path=\"url(#clip532)\" cx=\"1905.12\" cy=\"912.716\" r=\"10.8\" fill=\"#009af9\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"#000000\" stroke-opacity=\"1\" stroke-width=\"2.56\"/\u003e\n\u003cpolyline clip-path=\"url(#clip532)\" style=\"stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none\" stroke-dasharray=\"32, 20\" points=\"317.255,146.383 588.189,304.174 846.543,454.639 1110.29,608.247 1375.83,762.896 1640.49,917.033 1905.12,1071.15 \"/\u003e\n\u003cpath clip-path=\"url(#clip530)\" d=\"M325.724 1066.16 L648.862 1066.16 L648.862 910.641 L325.724 910.641  Z\" fill=\"#ffffff\" fill-rule=\"evenodd\" fill-opacity=\"1\"/\u003e\n\u003cpolyline clip-path=\"url(#clip530)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"325.724,1066.16 648.862,1066.16 648.862,910.641 325.724,910.641 325.724,1066.16 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip530)\" style=\"stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none\" points=\"344.425,962.481 456.634,962.481 \"/\u003e\n\u003ccircle clip-path=\"url(#clip530)\" cx=\"400.53\" cy=\"962.481\" r=\"15.5846\" fill=\"#009af9\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"#000000\" stroke-opacity=\"1\" stroke-width=\"4.68114\"/\u003e\n\u003cpath clip-path=\"url(#clip530)\" d=\"M491.169 949.807 L484.827 967.006 L497.535 967.006 L491.169 949.807 M488.53 945.201 L493.831 945.201 L507.002 979.761 L502.141 979.761 L498.993 970.895 L483.415 970.895 L480.266 979.761 L475.336 979.761 L488.53 945.201 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip530)\" d=\"M516.725 963.256 L516.725 975.918 L524.225 975.918 Q527.998 975.918 529.803 974.367 Q531.632 972.793 531.632 969.576 Q531.632 966.335 529.803 964.807 Q527.998 963.256 524.225 963.256 L516.725 963.256 M516.725 949.043 L516.725 959.46 L523.646 959.46 Q527.072 959.46 528.738 958.187 Q530.428 956.891 530.428 954.252 Q530.428 951.636 528.738 950.34 Q527.072 949.043 523.646 949.043 L516.725 949.043 M512.049 945.201 L523.993 945.201 Q529.34 945.201 532.234 947.423 Q535.127 949.645 535.127 953.743 Q535.127 956.914 533.646 958.789 Q532.164 960.664 529.294 961.127 Q532.743 961.868 534.641 964.229 Q536.562 966.567 536.562 970.085 Q536.562 974.715 533.414 977.238 Q530.266 979.761 524.456 979.761 L512.049 979.761 L512.049 945.201 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip530)\" d=\"M557.836 949.275 L546.03 967.724 L557.836 967.724 L557.836 949.275 M556.609 945.201 L562.488 945.201 L562.488 967.724 L567.419 967.724 L567.419 971.613 L562.488 971.613 L562.488 979.761 L557.836 979.761 L557.836 971.613 L542.234 971.613 L542.234 967.099 L556.609 945.201 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpolyline clip-path=\"url(#clip530)\" style=\"stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none\" stroke-dasharray=\"32, 20\" points=\"344.425,1014.32 456.634,1014.32 \"/\u003e\n\u003cpath clip-path=\"url(#clip530)\" d=\"M508.502 1005.84 Q508.502 1009.19 507.308 1012.52 Q506.136 1015.82 504.075 1018.54 Q502.014 1021.26 499.391 1023.36 Q496.768 1025.47 493.699 1026.64 Q490.631 1027.81 487.633 1027.81 Q482.316 1027.81 478.826 1024.33 Q475.336 1020.84 475.336 1015 Q475.336 1010.93 477.163 1006.88 Q478.99 1002.8 481.894 999.778 Q484.799 996.733 488.616 994.836 Q492.458 992.939 496.252 992.939 Q501.639 992.939 505.059 996.523 Q508.502 1000.08 508.502 1005.84 M504.216 1003.97 Q504.216 1001.39 503.49 999.45 Q502.764 997.483 501.546 996.359 Q500.351 995.234 498.922 994.696 Q497.517 994.133 495.971 994.133 Q492.973 994.133 489.764 996.078 Q486.555 998.022 484.166 1001.63 Q482.878 1003.6 481.941 1005.96 Q481.004 1008.3 480.583 1010.39 Q480.161 1012.45 479.974 1013.9 Q479.81 1015.35 479.81 1016.36 Q479.81 1021.05 482.058 1023.81 Q484.307 1026.57 487.914 1026.57 Q490.748 1026.57 493.512 1024.91 Q496.276 1023.22 498.173 1020.81 Q499.859 1018.73 501.101 1016.22 Q502.365 1013.71 502.998 1011.42 Q503.63 1009.12 503.911 1007.27 Q504.216 1005.42 504.216 1003.97 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip530)\" d=\"M514.838 1014.77 Q514.838 1006.66 517.859 1000.13 Q519.148 997.389 520.951 995.094 Q522.755 992.798 523.949 991.791 Q525.144 990.784 525.472 990.784 Q525.94 990.784 525.964 991.253 Q525.964 991.487 525.331 992.072 Q517.602 999.942 517.625 1014.77 Q517.625 1029.64 525.144 1037.21 Q525.964 1038.03 525.964 1038.28 Q525.964 1038.75 525.472 1038.75 Q525.144 1038.75 523.996 1037.79 Q522.848 1036.83 521.068 1034.63 Q519.288 1032.43 518 1029.74 Q514.838 1023.2 514.838 1014.77 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip530)\" d=\"M559.257 1019.9 Q559.257 1020.09 559.047 1020.81 Q558.836 1021.54 558.321 1022.66 Q557.829 1023.79 557.149 1024.82 Q556.47 1025.82 555.346 1026.57 Q554.245 1027.3 552.98 1027.3 Q551.294 1027.3 550.17 1026.18 Q549.045 1025.05 549.045 1023.36 Q549.045 1022.43 549.537 1021.14 Q552.652 1012.82 552.652 1009.97 Q552.652 1006.62 550.052 1006.62 Q548.764 1006.62 547.546 1007.11 Q546.352 1007.58 545.532 1008.23 Q544.712 1008.89 543.963 1009.8 Q543.236 1010.69 542.862 1011.3 Q542.51 1011.89 542.229 1012.47 L541.62 1014.86 Q541.48 1015.52 540.801 1018.07 L539.747 1022.4 Q538.997 1025.64 538.833 1025.94 Q538.599 1026.6 538.084 1026.95 Q537.568 1027.3 537.053 1027.3 Q536.467 1027.3 536.069 1026.95 Q535.671 1026.6 535.671 1025.99 Q535.671 1025.89 535.741 1025.54 Q535.812 1025.19 535.929 1024.7 Q536.046 1024.21 536.093 1023.93 L538.88 1012.85 Q539.395 1010.83 539.512 1010.2 Q539.653 1009.55 539.653 1008.82 Q539.653 1006.62 538.154 1006.62 Q536.936 1006.62 536.139 1008.07 Q535.343 1009.52 534.664 1012.33 Q534.453 1013.11 534.313 1013.27 Q534.195 1013.43 533.844 1013.43 Q533.258 1013.41 533.258 1012.94 Q533.258 1012.82 533.446 1012.05 Q533.633 1011.28 533.985 1010.18 Q534.359 1009.05 534.711 1008.3 Q535.015 1007.74 535.179 1007.48 Q535.367 1007.2 535.812 1006.66 Q536.28 1006.1 536.889 1005.84 Q537.521 1005.56 538.294 1005.56 Q540.028 1005.56 541.292 1006.69 Q542.557 1007.79 542.721 1009.73 Q545.836 1005.56 550.193 1005.56 Q552.769 1005.56 554.245 1006.92 Q555.721 1008.28 555.721 1010.69 Q555.721 1011.26 555.604 1011.98 Q555.51 1012.68 555.276 1013.57 Q555.065 1014.46 554.877 1015.14 Q554.69 1015.82 554.315 1016.92 Q553.941 1018 553.777 1018.47 Q553.613 1018.94 553.214 1020.04 Q552.84 1021.12 552.793 1021.23 Q551.926 1023.41 551.926 1024.65 Q551.926 1025.47 552.184 1025.85 Q552.465 1026.22 553.074 1026.22 Q554.713 1026.22 555.931 1024.61 Q557.173 1022.97 557.969 1020.3 Q558.157 1019.71 558.25 1019.57 Q558.367 1019.43 558.695 1019.43 Q559.257 1019.43 559.257 1019.9 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip530)\" d=\"M586.288 1003.66 Q586.484 1003.85 586.484 1004.13 Q586.484 1004.41 586.288 1004.61 Q586.091 1004.81 585.812 1004.81 L564.793 1004.81 Q564.514 1004.81 564.317 1004.61 Q564.121 1004.41 564.121 1004.13 Q564.121 1003.85 564.317 1003.66 Q564.514 1003.46 564.793 1003.46 L585.812 1003.46 Q586.091 1003.46 586.288 1003.66 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip530)\" d=\"M589.991 1006.99 L589.991 1005.95 L600.304 990.197 Q600.566 989.787 600.976 989.804 Q601.353 989.804 601.435 989.951 Q601.517 990.099 601.517 990.673 L601.517 1005.95 L604.878 1005.95 L604.878 1006.99 L601.517 1006.99 L601.517 1009.9 Q601.517 1010.87 601.91 1011.18 Q602.32 1011.5 604.058 1011.5 L604.763 1011.5 L604.763 1012.53 Q603.386 1012.43 600.205 1012.43 Q597.041 1012.43 595.664 1012.53 L595.664 1011.5 L596.369 1011.5 Q598.107 1011.5 598.516 1011.2 Q598.926 1010.89 598.926 1009.9 L598.926 1006.99 L589.991 1006.99 M590.942 1005.95 L599.123 1005.95 L599.123 993.427 L590.942 1005.95 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip530)\" d=\"M611.74 1038.28 Q611.74 1038.05 612.349 1037.47 Q620.079 1029.6 620.079 1014.77 Q620.079 999.895 612.654 992.377 Q611.74 991.51 611.74 991.253 Q611.74 990.784 612.209 990.784 Q612.537 990.784 613.684 991.744 Q614.855 992.705 616.612 994.906 Q618.392 997.108 619.704 999.802 Q622.866 1006.34 622.866 1014.77 Q622.866 1022.87 619.844 1029.41 Q618.556 1032.15 616.753 1034.44 Q614.949 1036.74 613.755 1037.75 Q612.56 1038.75 612.209 1038.75 Q611.74 1038.75 611.74 1038.28 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003c/svg\u003e\n","content_type":"text/html"},"image/svg+xml":{"content":"\u003c?xml version=\"1.0\" encoding=\"utf-8\"?\u003e\n\u003csvg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" width=\"500\" height=\"320\" viewBox=\"0 0 2000 1280\"\u003e\n\u003cdefs\u003e\n  \u003cclipPath id=\"clip480\"\u003e\n    \u003crect x=\"0\" y=\"0\" width=\"2000\" height=\"1280\"/\u003e\n  \u003c/clipPath\u003e\n\u003c/defs\u003e\n\u003cpath clip-path=\"url(#clip480)\" d=\"M0 1280 L2000 1280 L2000 0 L0 0  Z\" fill=\"#ffffff\" fill-rule=\"evenodd\" fill-opacity=\"1\"/\u003e\n\u003cdefs\u003e\n  \u003cclipPath id=\"clip481\"\u003e\n    \u003crect x=\"400\" y=\"0\" width=\"1401\" height=\"1280\"/\u003e\n  \u003c/clipPath\u003e\n\u003c/defs\u003e\n\u003cpath clip-path=\"url(#clip480)\" d=\"M269.619 1099.23 L1952.76 1099.23 L1952.76 107.256 L269.619 107.256  Z\" fill=\"#ffffff\" fill-rule=\"evenodd\" fill-opacity=\"1\"/\u003e\n\u003cdefs\u003e\n  \u003cclipPath id=\"clip482\"\u003e\n    \u003crect x=\"269\" y=\"107\" width=\"1684\" height=\"993\"/\u003e\n  \u003c/clipPath\u003e\n\u003c/defs\u003e\n\u003cpolyline clip-path=\"url(#clip482)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"527.88,1099.23 527.88,107.256 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip482)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"1057.17,1099.23 1057.17,107.256 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip482)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"1586.46,1099.23 1586.46,107.256 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip482)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"269.619,917.024 1952.76,917.024 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip482)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"269.619,531.703 1952.76,531.703 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip482)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"269.619,146.383 1952.76,146.383 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip480)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"269.619,1099.23 1952.76,1099.23 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip480)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"527.88,1099.23 527.88,1080.33 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip480)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"1057.17,1099.23 1057.17,1080.33 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip480)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"1586.46,1099.23 1586.46,1080.33 \"/\u003e\n\u003cpath clip-path=\"url(#clip480)\" d=\"M494.208 1170.15 L501.847 1170.15 L501.847 1143.79 L493.536 1145.45 L493.536 1141.19 L501.8 1139.53 L506.476 1139.53 L506.476 1170.15 L514.115 1170.15 L514.115 1174.09 L494.208 1174.09 L494.208 1170.15 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip480)\" d=\"M533.559 1142.61 Q529.948 1142.61 528.12 1146.17 Q526.314 1149.71 526.314 1156.84 Q526.314 1163.95 528.12 1167.51 Q529.948 1171.05 533.559 1171.05 Q537.194 1171.05 538.999 1167.51 Q540.828 1163.95 540.828 1156.84 Q540.828 1149.71 538.999 1146.17 Q537.194 1142.61 533.559 1142.61 M533.559 1138.9 Q539.37 1138.9 542.425 1143.51 Q545.504 1148.09 545.504 1156.84 Q545.504 1165.57 542.425 1170.17 Q539.37 1174.76 533.559 1174.76 Q527.749 1174.76 524.671 1170.17 Q521.615 1165.57 521.615 1156.84 Q521.615 1148.09 524.671 1143.51 Q527.749 1138.9 533.559 1138.9 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip480)\" d=\"M546.049 1143.48 L552.256 1143.48 L552.256 1122.06 L545.504 1123.41 L545.504 1119.95 L552.218 1118.6 L556.017 1118.6 L556.017 1143.48 L562.224 1143.48 L562.224 1146.68 L546.049 1146.68 L546.049 1143.48 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip480)\" d=\"M1022.94 1170.15 L1030.58 1170.15 L1030.58 1143.79 L1022.27 1145.45 L1022.27 1141.19 L1030.53 1139.53 L1035.21 1139.53 L1035.21 1170.15 L1042.85 1170.15 L1042.85 1174.09 L1022.94 1174.09 L1022.94 1170.15 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip480)\" d=\"M1062.29 1142.61 Q1058.68 1142.61 1056.85 1146.17 Q1055.05 1149.71 1055.05 1156.84 Q1055.05 1163.95 1056.85 1167.51 Q1058.68 1171.05 1062.29 1171.05 Q1065.93 1171.05 1067.73 1167.51 Q1069.56 1163.95 1069.56 1156.84 Q1069.56 1149.71 1067.73 1146.17 Q1065.93 1142.61 1062.29 1142.61 M1062.29 1138.9 Q1068.1 1138.9 1071.16 1143.51 Q1074.24 1148.09 1074.24 1156.84 Q1074.24 1165.57 1071.16 1170.17 Q1068.1 1174.76 1062.29 1174.76 Q1056.48 1174.76 1053.4 1170.17 Q1050.35 1165.57 1050.35 1156.84 Q1050.35 1148.09 1053.4 1143.51 Q1056.48 1138.9 1062.29 1138.9 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip480)\" d=\"M1078.81 1143.48 L1092.07 1143.48 L1092.07 1146.68 L1074.24 1146.68 L1074.24 1143.48 Q1076.4 1141.24 1080.12 1137.48 Q1083.87 1133.7 1084.83 1132.61 Q1086.65 1130.56 1087.37 1129.15 Q1088.1 1127.72 1088.1 1126.35 Q1088.1 1124.11 1086.52 1122.7 Q1084.96 1121.29 1082.44 1121.29 Q1080.65 1121.29 1078.66 1121.91 Q1076.68 1122.53 1074.43 1123.79 L1074.43 1119.95 Q1076.72 1119.03 1078.71 1118.56 Q1080.71 1118.09 1082.36 1118.09 Q1086.73 1118.09 1089.32 1120.27 Q1091.92 1122.45 1091.92 1126.1 Q1091.92 1127.83 1091.26 1129.39 Q1090.62 1130.93 1088.91 1133.04 Q1088.44 1133.59 1085.92 1136.2 Q1083.4 1138.8 1078.81 1143.48 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip480)\" d=\"M1551.9 1170.15 L1559.54 1170.15 L1559.54 1143.79 L1551.23 1145.45 L1551.23 1141.19 L1559.49 1139.53 L1564.17 1139.53 L1564.17 1170.15 L1571.81 1170.15 L1571.81 1174.09 L1551.9 1174.09 L1551.9 1170.15 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip480)\" d=\"M1591.25 1142.61 Q1587.64 1142.61 1585.81 1146.17 Q1584.01 1149.71 1584.01 1156.84 Q1584.01 1163.95 1585.81 1167.51 Q1587.64 1171.05 1591.25 1171.05 Q1594.89 1171.05 1596.69 1167.51 Q1598.52 1163.95 1598.52 1156.84 Q1598.52 1149.71 1596.69 1146.17 Q1594.89 1142.61 1591.25 1142.61 M1591.25 1138.9 Q1597.06 1138.9 1600.12 1143.51 Q1603.2 1148.09 1603.2 1156.84 Q1603.2 1165.57 1600.12 1170.17 Q1597.06 1174.76 1591.25 1174.76 Q1585.44 1174.76 1582.36 1170.17 Q1579.31 1165.57 1579.31 1156.84 Q1579.31 1148.09 1582.36 1143.51 Q1585.44 1138.9 1591.25 1138.9 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip480)\" d=\"M1615.89 1131.54 Q1618.62 1132.12 1620.14 1133.96 Q1621.68 1135.81 1621.68 1138.51 Q1621.68 1142.67 1618.83 1144.95 Q1615.97 1147.22 1610.7 1147.22 Q1608.93 1147.22 1607.05 1146.86 Q1605.19 1146.53 1603.2 1145.83 L1603.2 1142.16 Q1604.78 1143.08 1606.66 1143.55 Q1608.54 1144.02 1610.59 1144.02 Q1614.16 1144.02 1616.02 1142.61 Q1617.9 1141.2 1617.9 1138.51 Q1617.9 1136.03 1616.15 1134.64 Q1614.42 1133.23 1611.32 1133.23 L1608.05 1133.23 L1608.05 1130.11 L1611.47 1130.11 Q1614.27 1130.11 1615.76 1129 Q1617.25 1127.87 1617.25 1125.76 Q1617.25 1123.6 1615.7 1122.45 Q1614.18 1121.29 1611.32 1121.29 Q1609.76 1121.29 1607.97 1121.62 Q1606.19 1121.96 1604.04 1122.68 L1604.04 1119.29 Q1606.21 1118.69 1608.09 1118.39 Q1609.99 1118.09 1611.66 1118.09 Q1615.99 1118.09 1618.51 1120.06 Q1621.03 1122.02 1621.03 1125.37 Q1621.03 1127.7 1619.69 1129.32 Q1618.36 1130.92 1615.89 1131.54 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cg clip-path=\"url(#clip480)\"\u003e\n\u003cimage width=\"36\" height=\"30\" xlink:href=\"data:image/png;base64,\niVBORw0KGgoAAAANSUhEUgAAACQAAAAeCAYAAABE4bxTAAABuUlEQVRYhbVYW4GEMAyMBDRUAhoq\nAQ1IQAMS0FAJaEACGmph7uOue21I+trykR+aHSaZSVuWABAP7z2stSAiGGPgnIOUp8W2bZjnGUSE\naZpgrcV5nlUY8kMi8Ni2rQh4nufjd3Gs61rEUMlc1wUAtCxLAiqBXNeV5BzH8cnz3sMYk6zf960S\nE8nkOmatTdZjaXKVBwvkCksIhXZLWvMKw/NpmkBE1R6LMbQCit2JuxDCOfcxrfe+2vDcU0VCmulC\nJ3gEnw0ntO97XtfOiSnhSAUV5dIItZKRcKRp+yQaY8SX8JFu9U2zZN57dbogGLq3O1JhqodyYzvC\nO8BzHypOWS2hUXIty9JOSDqbesi0FJYFGeWfsK00HR1v+ofjaBPdTGiUf6pP+zf80yJXltAo/3CM\neZ77CHGgmhvjt7I75971z7qu1V0+juM3R2X6glzaZpjkSov8hthDKJyR1Wb+I1xVWc/+wz8OcoSC\ntNBMPcI//JaZGwqi/zv2a/7hsmtFxd0RCY3wD/DcEHM+iy1RlKt3/+FYGhn+OVQk1EsGSI+f8OL4\nfwMJPytZ7+kex33fDwsQEfZ9F7F/AEI9aqd2YHXbAAAAAElFTkSuQmCC\n\" transform=\"translate(1093, 1212)\"/\u003e\n\u003c/g\u003e\n\u003cpolyline clip-path=\"url(#clip480)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"269.619,1099.23 269.619,107.256 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip480)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"269.619,917.024 288.517,917.024 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip480)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"269.619,531.703 288.517,531.703 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip480)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"269.619,146.383 288.517,146.383 \"/\u003e\n\u003cpath clip-path=\"url(#clip480)\" d=\"M113.675 936.816 L121.314 936.816 L121.314 910.451 L113.004 912.117 L113.004 907.858 L121.268 906.191 L125.944 906.191 L125.944 936.816 L133.583 936.816 L133.583 940.751 L113.675 940.751 L113.675 936.816 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip480)\" d=\"M153.027 909.27 Q149.416 909.27 147.587 912.835 Q145.782 916.377 145.782 923.506 Q145.782 930.613 147.587 934.177 Q149.416 937.719 153.027 937.719 Q156.661 937.719 158.467 934.177 Q160.295 930.613 160.295 923.506 Q160.295 916.377 158.467 912.835 Q156.661 909.27 153.027 909.27 M153.027 905.566 Q158.837 905.566 161.893 910.173 Q164.971 914.756 164.971 923.506 Q164.971 932.233 161.893 936.839 Q158.837 941.423 153.027 941.423 Q147.217 941.423 144.138 936.839 Q141.082 932.233 141.082 923.506 Q141.082 914.756 144.138 910.173 Q147.217 905.566 153.027 905.566 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip480)\" d=\"M164.971 899.668 L189.083 899.668 L189.083 902.865 L164.971 902.865 L164.971 899.668 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip480)\" d=\"M197.941 910.144 L204.148 910.144 L204.148 888.722 L197.396 890.076 L197.396 886.615 L204.11 885.261 L207.909 885.261 L207.909 910.144 L214.116 910.144 L214.116 913.341 L197.941 913.341 L197.941 910.144 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip480)\" d=\"M229.914 887.762 Q226.98 887.762 225.495 890.659 Q224.028 893.536 224.028 899.329 Q224.028 905.103 225.495 908 Q226.98 910.877 229.914 910.877 Q232.867 910.877 234.334 908 Q235.82 905.103 235.82 899.329 Q235.82 893.536 234.334 890.659 Q232.867 887.762 229.914 887.762 M229.914 884.753 Q234.635 884.753 237.118 888.496 Q239.619 892.22 239.619 899.329 Q239.619 906.42 237.118 910.162 Q234.635 913.886 229.914 913.886 Q225.194 913.886 222.692 910.162 Q220.21 906.42 220.21 899.329 Q220.21 892.22 222.692 888.496 Q225.194 884.753 229.914 884.753 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip480)\" d=\"M138.99 551.496 L146.629 551.496 L146.629 525.13 L138.319 526.797 L138.319 522.538 L146.583 520.871 L151.259 520.871 L151.259 551.496 L158.898 551.496 L158.898 555.431 L138.99 555.431 L138.99 551.496 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip480)\" d=\"M178.342 523.95 Q174.731 523.95 172.902 527.514 Q171.097 531.056 171.097 538.186 Q171.097 545.292 172.902 548.857 Q174.731 552.399 178.342 552.399 Q181.976 552.399 183.782 548.857 Q185.611 545.292 185.611 538.186 Q185.611 531.056 183.782 527.514 Q181.976 523.95 178.342 523.95 M178.342 520.246 Q184.152 520.246 187.208 524.852 Q190.286 529.436 190.286 538.186 Q190.286 546.913 187.208 551.519 Q184.152 556.102 178.342 556.102 Q172.532 556.102 169.453 551.519 Q166.398 546.913 166.398 538.186 Q166.398 529.436 169.453 524.852 Q172.532 520.246 178.342 520.246 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip480)\" d=\"M190.286 514.347 L214.398 514.347 L214.398 517.545 L190.286 517.545 L190.286 514.347 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip480)\" d=\"M222.636 499.941 L237.55 499.941 L237.55 503.138 L226.115 503.138 L226.115 510.022 Q226.943 509.739 227.77 509.608 Q228.598 509.457 229.425 509.457 Q234.127 509.457 236.873 512.034 Q239.619 514.611 239.619 519.012 Q239.619 523.544 236.798 526.065 Q233.977 528.566 228.842 528.566 Q227.074 528.566 225.231 528.265 Q223.407 527.964 221.451 527.362 L221.451 523.544 Q223.144 524.466 224.949 524.917 Q226.755 525.369 228.767 525.369 Q232.021 525.369 233.921 523.657 Q235.82 521.946 235.82 519.012 Q235.82 516.078 233.921 514.366 Q232.021 512.655 228.767 512.655 Q227.244 512.655 225.72 512.993 Q224.216 513.332 222.636 514.046 L222.636 499.941 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip480)\" d=\"M168.914 166.175 L176.552 166.175 L176.552 139.81 L168.242 141.476 L168.242 137.217 L176.506 135.551 L181.182 135.551 L181.182 166.175 L188.821 166.175 L188.821 170.111 L168.914 170.111 L168.914 166.175 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip480)\" d=\"M208.265 138.629 Q204.654 138.629 202.825 142.194 Q201.02 145.736 201.02 152.865 Q201.02 159.972 202.825 163.537 Q204.654 167.078 208.265 167.078 Q211.9 167.078 213.705 163.537 Q215.534 159.972 215.534 152.865 Q215.534 145.736 213.705 142.194 Q211.9 138.629 208.265 138.629 M208.265 134.926 Q214.075 134.926 217.131 139.532 Q220.21 144.115 220.21 152.865 Q220.21 161.592 217.131 166.199 Q214.075 170.782 208.265 170.782 Q202.455 170.782 199.376 166.199 Q196.321 161.592 196.321 152.865 Q196.321 144.115 199.376 139.532 Q202.455 134.926 208.265 134.926 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip480)\" d=\"M229.914 117.122 Q226.98 117.122 225.495 120.018 Q224.028 122.896 224.028 128.688 Q224.028 134.462 225.495 137.359 Q226.98 140.236 229.914 140.236 Q232.867 140.236 234.334 137.359 Q235.82 134.462 235.82 128.688 Q235.82 122.896 234.334 120.018 Q232.867 117.122 229.914 117.122 M229.914 114.112 Q234.635 114.112 237.118 117.855 Q239.619 121.579 239.619 128.688 Q239.619 135.779 237.118 139.522 Q234.635 143.246 229.914 143.246 Q225.194 143.246 222.692 139.522 Q220.21 135.779 220.21 128.688 Q220.21 121.579 222.692 117.855 Q225.194 114.112 229.914 114.112 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cg clip-path=\"url(#clip480)\"\u003e\n\u003ctext style=\"fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:66px; text-anchor:middle;\" transform=\"rotate(-90, 71.4418, 603.241)\" x=\"71.4418\" y=\"603.241\"\u003einf-norm error\u003c/text\u003e\n\u003c/g\u003e\n\u003cg clip-path=\"url(#clip480)\"\u003e\n\u003ctext style=\"fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:66px; text-anchor:middle;\" transform=\"rotate(0, 1111.19, 57.6)\" x=\"1111.19\" y=\"57.6\"\u003eConvergence of AB4\u003c/text\u003e\n\u003c/g\u003e\n\u003cpolyline clip-path=\"url(#clip482)\" style=\"stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none\" points=\"317.255,169.552 588.189,135.331 846.543,316.091 1110.29,454.809 1375.83,605.7 1640.49,758.875 1905.12,912.716 \"/\u003e\n\u003ccircle clip-path=\"url(#clip482)\" cx=\"317.255\" cy=\"169.552\" r=\"10.8\" fill=\"#009af9\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"#000000\" stroke-opacity=\"1\" stroke-width=\"2.56\"/\u003e\n\u003ccircle clip-path=\"url(#clip482)\" cx=\"588.189\" cy=\"135.331\" r=\"10.8\" fill=\"#009af9\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"#000000\" stroke-opacity=\"1\" stroke-width=\"2.56\"/\u003e\n\u003ccircle clip-path=\"url(#clip482)\" cx=\"846.543\" cy=\"316.091\" r=\"10.8\" fill=\"#009af9\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"#000000\" stroke-opacity=\"1\" stroke-width=\"2.56\"/\u003e\n\u003ccircle clip-path=\"url(#clip482)\" cx=\"1110.29\" cy=\"454.809\" r=\"10.8\" fill=\"#009af9\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"#000000\" stroke-opacity=\"1\" stroke-width=\"2.56\"/\u003e\n\u003ccircle clip-path=\"url(#clip482)\" cx=\"1375.83\" cy=\"605.7\" r=\"10.8\" fill=\"#009af9\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"#000000\" stroke-opacity=\"1\" stroke-width=\"2.56\"/\u003e\n\u003ccircle clip-path=\"url(#clip482)\" cx=\"1640.49\" cy=\"758.875\" r=\"10.8\" fill=\"#009af9\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"#000000\" stroke-opacity=\"1\" stroke-width=\"2.56\"/\u003e\n\u003ccircle clip-path=\"url(#clip482)\" cx=\"1905.12\" cy=\"912.716\" r=\"10.8\" fill=\"#009af9\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"#000000\" stroke-opacity=\"1\" stroke-width=\"2.56\"/\u003e\n\u003cpolyline clip-path=\"url(#clip482)\" style=\"stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none\" stroke-dasharray=\"32, 20\" points=\"317.255,146.383 588.189,304.174 846.543,454.639 1110.29,608.247 1375.83,762.896 1640.49,917.033 1905.12,1071.15 \"/\u003e\n\u003cpath clip-path=\"url(#clip480)\" d=\"M325.724 1066.16 L648.862 1066.16 L648.862 910.641 L325.724 910.641  Z\" fill=\"#ffffff\" fill-rule=\"evenodd\" fill-opacity=\"1\"/\u003e\n\u003cpolyline clip-path=\"url(#clip480)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"325.724,1066.16 648.862,1066.16 648.862,910.641 325.724,910.641 325.724,1066.16 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip480)\" style=\"stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none\" points=\"344.425,962.481 456.634,962.481 \"/\u003e\n\u003ccircle clip-path=\"url(#clip480)\" cx=\"400.53\" cy=\"962.481\" r=\"15.5846\" fill=\"#009af9\" fill-rule=\"evenodd\" fill-opacity=\"1\" stroke=\"#000000\" stroke-opacity=\"1\" stroke-width=\"4.68114\"/\u003e\n\u003cpath clip-path=\"url(#clip480)\" d=\"M491.169 949.807 L484.827 967.006 L497.535 967.006 L491.169 949.807 M488.53 945.201 L493.831 945.201 L507.002 979.761 L502.141 979.761 L498.993 970.895 L483.415 970.895 L480.266 979.761 L475.336 979.761 L488.53 945.201 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip480)\" d=\"M516.725 963.256 L516.725 975.918 L524.225 975.918 Q527.998 975.918 529.803 974.367 Q531.632 972.793 531.632 969.576 Q531.632 966.335 529.803 964.807 Q527.998 963.256 524.225 963.256 L516.725 963.256 M516.725 949.043 L516.725 959.46 L523.646 959.46 Q527.072 959.46 528.738 958.187 Q530.428 956.891 530.428 954.252 Q530.428 951.636 528.738 950.34 Q527.072 949.043 523.646 949.043 L516.725 949.043 M512.049 945.201 L523.993 945.201 Q529.34 945.201 532.234 947.423 Q535.127 949.645 535.127 953.743 Q535.127 956.914 533.646 958.789 Q532.164 960.664 529.294 961.127 Q532.743 961.868 534.641 964.229 Q536.562 966.567 536.562 970.085 Q536.562 974.715 533.414 977.238 Q530.266 979.761 524.456 979.761 L512.049 979.761 L512.049 945.201 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip480)\" d=\"M557.836 949.275 L546.03 967.724 L557.836 967.724 L557.836 949.275 M556.609 945.201 L562.488 945.201 L562.488 967.724 L567.419 967.724 L567.419 971.613 L562.488 971.613 L562.488 979.761 L557.836 979.761 L557.836 971.613 L542.234 971.613 L542.234 967.099 L556.609 945.201 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpolyline clip-path=\"url(#clip480)\" style=\"stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none\" stroke-dasharray=\"32, 20\" points=\"344.425,1014.32 456.634,1014.32 \"/\u003e\n\u003cpath clip-path=\"url(#clip480)\" d=\"M508.502 1005.84 Q508.502 1009.19 507.308 1012.52 Q506.136 1015.82 504.075 1018.54 Q502.014 1021.26 499.391 1023.36 Q496.768 1025.47 493.699 1026.64 Q490.631 1027.81 487.633 1027.81 Q482.316 1027.81 478.826 1024.33 Q475.336 1020.84 475.336 1015 Q475.336 1010.93 477.163 1006.88 Q478.99 1002.8 481.894 999.778 Q484.799 996.733 488.616 994.836 Q492.458 992.939 496.252 992.939 Q501.639 992.939 505.059 996.523 Q508.502 1000.08 508.502 1005.84 M504.216 1003.97 Q504.216 1001.39 503.49 999.45 Q502.764 997.483 501.546 996.359 Q500.351 995.234 498.922 994.696 Q497.517 994.133 495.971 994.133 Q492.973 994.133 489.764 996.078 Q486.555 998.022 484.166 1001.63 Q482.878 1003.6 481.941 1005.96 Q481.004 1008.3 480.583 1010.39 Q480.161 1012.45 479.974 1013.9 Q479.81 1015.35 479.81 1016.36 Q479.81 1021.05 482.058 1023.81 Q484.307 1026.57 487.914 1026.57 Q490.748 1026.57 493.512 1024.91 Q496.276 1023.22 498.173 1020.81 Q499.859 1018.73 501.101 1016.22 Q502.365 1013.71 502.998 1011.42 Q503.63 1009.12 503.911 1007.27 Q504.216 1005.42 504.216 1003.97 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip480)\" d=\"M514.838 1014.77 Q514.838 1006.66 517.859 1000.13 Q519.148 997.389 520.951 995.094 Q522.755 992.798 523.949 991.791 Q525.144 990.784 525.472 990.784 Q525.94 990.784 525.964 991.253 Q525.964 991.487 525.331 992.072 Q517.602 999.942 517.625 1014.77 Q517.625 1029.64 525.144 1037.21 Q525.964 1038.03 525.964 1038.28 Q525.964 1038.75 525.472 1038.75 Q525.144 1038.75 523.996 1037.79 Q522.848 1036.83 521.068 1034.63 Q519.288 1032.43 518 1029.74 Q514.838 1023.2 514.838 1014.77 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip480)\" d=\"M559.257 1019.9 Q559.257 1020.09 559.047 1020.81 Q558.836 1021.54 558.321 1022.66 Q557.829 1023.79 557.149 1024.82 Q556.47 1025.82 555.346 1026.57 Q554.245 1027.3 552.98 1027.3 Q551.294 1027.3 550.17 1026.18 Q549.045 1025.05 549.045 1023.36 Q549.045 1022.43 549.537 1021.14 Q552.652 1012.82 552.652 1009.97 Q552.652 1006.62 550.052 1006.62 Q548.764 1006.62 547.546 1007.11 Q546.352 1007.58 545.532 1008.23 Q544.712 1008.89 543.963 1009.8 Q543.236 1010.69 542.862 1011.3 Q542.51 1011.89 542.229 1012.47 L541.62 1014.86 Q541.48 1015.52 540.801 1018.07 L539.747 1022.4 Q538.997 1025.64 538.833 1025.94 Q538.599 1026.6 538.084 1026.95 Q537.568 1027.3 537.053 1027.3 Q536.467 1027.3 536.069 1026.95 Q535.671 1026.6 535.671 1025.99 Q535.671 1025.89 535.741 1025.54 Q535.812 1025.19 535.929 1024.7 Q536.046 1024.21 536.093 1023.93 L538.88 1012.85 Q539.395 1010.83 539.512 1010.2 Q539.653 1009.55 539.653 1008.82 Q539.653 1006.62 538.154 1006.62 Q536.936 1006.62 536.139 1008.07 Q535.343 1009.52 534.664 1012.33 Q534.453 1013.11 534.313 1013.27 Q534.195 1013.43 533.844 1013.43 Q533.258 1013.41 533.258 1012.94 Q533.258 1012.82 533.446 1012.05 Q533.633 1011.28 533.985 1010.18 Q534.359 1009.05 534.711 1008.3 Q535.015 1007.74 535.179 1007.48 Q535.367 1007.2 535.812 1006.66 Q536.28 1006.1 536.889 1005.84 Q537.521 1005.56 538.294 1005.56 Q540.028 1005.56 541.292 1006.69 Q542.557 1007.79 542.721 1009.73 Q545.836 1005.56 550.193 1005.56 Q552.769 1005.56 554.245 1006.92 Q555.721 1008.28 555.721 1010.69 Q555.721 1011.26 555.604 1011.98 Q555.51 1012.68 555.276 1013.57 Q555.065 1014.46 554.877 1015.14 Q554.69 1015.82 554.315 1016.92 Q553.941 1018 553.777 1018.47 Q553.613 1018.94 553.214 1020.04 Q552.84 1021.12 552.793 1021.23 Q551.926 1023.41 551.926 1024.65 Q551.926 1025.47 552.184 1025.85 Q552.465 1026.22 553.074 1026.22 Q554.713 1026.22 555.931 1024.61 Q557.173 1022.97 557.969 1020.3 Q558.157 1019.71 558.25 1019.57 Q558.367 1019.43 558.695 1019.43 Q559.257 1019.43 559.257 1019.9 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip480)\" d=\"M586.288 1003.66 Q586.484 1003.85 586.484 1004.13 Q586.484 1004.41 586.288 1004.61 Q586.091 1004.81 585.812 1004.81 L564.793 1004.81 Q564.514 1004.81 564.317 1004.61 Q564.121 1004.41 564.121 1004.13 Q564.121 1003.85 564.317 1003.66 Q564.514 1003.46 564.793 1003.46 L585.812 1003.46 Q586.091 1003.46 586.288 1003.66 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip480)\" d=\"M589.991 1006.99 L589.991 1005.95 L600.304 990.197 Q600.566 989.787 600.976 989.804 Q601.353 989.804 601.435 989.951 Q601.517 990.099 601.517 990.673 L601.517 1005.95 L604.878 1005.95 L604.878 1006.99 L601.517 1006.99 L601.517 1009.9 Q601.517 1010.87 601.91 1011.18 Q602.32 1011.5 604.058 1011.5 L604.763 1011.5 L604.763 1012.53 Q603.386 1012.43 600.205 1012.43 Q597.041 1012.43 595.664 1012.53 L595.664 1011.5 L596.369 1011.5 Q598.107 1011.5 598.516 1011.2 Q598.926 1010.89 598.926 1009.9 L598.926 1006.99 L589.991 1006.99 M590.942 1005.95 L599.123 1005.95 L599.123 993.427 L590.942 1005.95 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip480)\" d=\"M611.74 1038.28 Q611.74 1038.05 612.349 1037.47 Q620.079 1029.6 620.079 1014.77 Q620.079 999.895 612.654 992.377 Q611.74 991.51 611.74 991.253 Q611.74 990.784 612.209 990.784 Q612.537 990.784 613.684 991.744 Q614.855 992.705 616.612 994.906 Q618.392 997.108 619.704 999.802 Q622.866 1006.34 622.866 1014.77 Q622.866 1022.87 619.844 1029.41 Q618.556 1032.15 616.753 1034.44 Q614.949 1036.74 613.755 1037.75 Q612.56 1038.75 612.209 1038.75 Q611.74 1038.75 611.74 1038.28 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003c/svg\u003e\n","content_type":"image/svg+xml"}}}],"key":"ztkwGCdkAN"}],"data":{},"key":"W7uutdtrvE"}],"label":"demo-implicit-ab4-julia","identifier":"demo-implicit-ab4-julia","html_id":"demo-implicit-ab4-julia","key":"fhYro6l76P"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Stiffness","position":{"start":{"line":544,"column":1},"end":{"line":544,"column":1}},"key":"bJl6fubVkM"}],"key":"oXNBTEt5tu"},{"type":"paragraph","position":{"start":{"line":545,"column":1},"end":{"line":545,"column":1}},"children":[{"type":"text","value":"The following simple ODE uncovers a surprise.","position":{"start":{"line":545,"column":1},"end":{"line":545,"column":1}},"key":"IFTVPuLHuM"}],"key":"DWTDRScXtX"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"ivp = ODEProblem((u, p, t) -\u003e u^2 - u^3, 0.005, (0, 400.0))","key":"mfBQECP4xQ"},{"type":"output","id":"k1Q785vfZplqnaGnWug9X","data":[{"output_type":"execute_result","execution_count":41,"metadata":{},"data":{"text/plain":{"content":"\u001b[38;2;86;182;194mODEProblem\u001b[0m with uType \u001b[38;2;86;182;194mFloat64\u001b[0m and tType \u001b[38;2;86;182;194mFloat64\u001b[0m. In-place: \u001b[38;2;86;182;194mfalse\u001b[0m\ntimespan: (0.0, 400.0)\nu0: 0.005","content_type":"text/plain"}}}],"key":"RgWsDuWipB"}],"data":{},"key":"lQV3NzolEk"},{"type":"paragraph","position":{"start":{"line":551,"column":1},"end":{"line":551,"column":1}},"children":[{"type":"text","value":"We will solve the problem first with the implicit AM2 method using ","position":{"start":{"line":551,"column":1},"end":{"line":551,"column":1}},"key":"K9bbecPLKj"},{"type":"inlineMath","value":"n=200","position":{"start":{"line":551,"column":1},"end":{"line":551,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003en\u003c/mi\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmn\u003e200\u003c/mn\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003en=200\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.4306em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003en\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6444em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e200\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"WxfcGJ6dWn"},{"type":"text","value":" steps.","position":{"start":{"line":551,"column":1},"end":{"line":551,"column":1}},"key":"B3r3HTH3Oh"}],"key":"conEeQwp3V"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"tI, uI = FNC.am2(ivp, 200)\n\nplot(tI, uI, label=\"AM2\",\n    xlabel=L\"t\", ylabel=L\"u(t)\", leg=:bottomright)","key":"ihXzL5RthQ"},{"type":"output","id":"Szis-3jTA_A9Abh3hAS-4","data":[{"output_type":"execute_result","execution_count":42,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"8f1115b44e1856a7b7aef897b549db0b","path":"/fnc/build/8f1115b44e1856a7b7aef897b549db0b.png"},"text/html":{"content_type":"text/html","hash":"06e9ade50e62b7bf7ec7ccd4bc8c26ca","path":"/fnc/build/06e9ade50e62b7bf7ec7ccd4bc8c26ca.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"8f1cb84c7c483f101b2fea2e6cbe245f","path":"/fnc/build/8f1cb84c7c483f101b2fea2e6cbe245f.svg"}}}],"key":"rc5P82qvYK"}],"data":{},"key":"oKXyQlhezF"},{"type":"paragraph","position":{"start":{"line":560,"column":1},"end":{"line":560,"column":1}},"children":[{"type":"text","value":"Now we repeat the process using the explicit AB4 method.","position":{"start":{"line":560,"column":1},"end":{"line":560,"column":1}},"key":"EobwwLtp4L"}],"key":"obPJf6iK8s"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"tE, uE = FNC.ab4(ivp, 200)\n\nscatter!(tE, uE, m=3, label=\"AB4\", ylim=[-4, 2])","key":"rMmUs2WJEl"},{"type":"output","id":"tJOtGkuW-6j4MK02pdIOO","data":[{"output_type":"execute_result","execution_count":43,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"687a93fef86d3e878b424c77dd42c260","path":"/fnc/build/687a93fef86d3e878b424c77dd42c260.png"},"text/html":{"content_type":"text/html","hash":"a4b33634a3a8b8feb5eabfe24cf14f38","path":"/fnc/build/a4b33634a3a8b8feb5eabfe24cf14f38.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"8d4e8bb5942d8ba1c3adb72556870ace","path":"/fnc/build/8d4e8bb5942d8ba1c3adb72556870ace.svg"}}}],"key":"BpankvpTmC"}],"data":{},"key":"ozcqmsr8Cz"},{"type":"paragraph","position":{"start":{"line":568,"column":1},"end":{"line":568,"column":1}},"children":[{"type":"text","value":"Once the solution starts to take off, the AB4 result goes catastrophically wrong.","position":{"start":{"line":568,"column":1},"end":{"line":568,"column":1}},"key":"sgoCVSADHm"}],"key":"Nm9fVOnGPl"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"uE[105:111]","key":"YsY00OXHtF"},{"type":"output","id":"JEGuzDkt54s_aIx02VP16","data":[{"output_type":"execute_result","execution_count":44,"metadata":{},"data":{"text/plain":{"content":"7-element Vector{Float64}:\n   0.7553857798343923\n   1.4372970308402562\n  -3.2889768512289934\n 214.1791132643978\n  -4.482089146771584e7\n   4.1268902909420876e23\n  -3.221441244795439e71","content_type":"text/plain"}}}],"key":"R7LuChtTPX"}],"data":{},"key":"ksMOGXz9fp"},{"type":"paragraph","position":{"start":{"line":574,"column":1},"end":{"line":574,"column":1}},"children":[{"type":"text","value":"We hope that AB4 will converge in the limit ","position":{"start":{"line":574,"column":1},"end":{"line":574,"column":1}},"key":"dUwdV0ueve"},{"type":"inlineMath","value":"h\\to 0","position":{"start":{"line":574,"column":1},"end":{"line":574,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003eh\u003c/mi\u003e\u003cmo\u003e→\u003c/mo\u003e\u003cmn\u003e0\u003c/mn\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003eh\\to 0\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003eh\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e→\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6444em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e0\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"gSHSuwBhey"},{"type":"text","value":", so let’s try using more steps.","position":{"start":{"line":574,"column":1},"end":{"line":574,"column":1}},"key":"PC6md9fUKa"}],"key":"xT5NujgVuo"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"plt = scatter(tI, uI, label=\"AM2, n=200\", m=3,\n    xlabel=L\"t\", ylabel=L\"u(t)\", leg=:bottomright)\n\nfor n in [1000, 1600]\n    tE, uE = FNC.ab4(ivp, n)\n    plot!(tE, uE, label=\"AM4, n=$n\")\nend\nplt","key":"hyCkzWFFy6"},{"type":"output","id":"HHR9-_HMLe7P8f8hqL0RL","data":[{"output_type":"execute_result","execution_count":45,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"fc1d3c2ba788e2f71389087627aa0364","path":"/fnc/build/fc1d3c2ba788e2f71389087627aa0364.png"},"text/html":{"content_type":"text/html","hash":"3e350bd8e172a79637e014f3facb5746","path":"/fnc/build/3e350bd8e172a79637e014f3facb5746.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"d0989bf9a8249091c21adc45118b2fee","path":"/fnc/build/d0989bf9a8249091c21adc45118b2fee.svg"}}}],"key":"Ue045iwyEP"}],"data":{},"key":"rLyMrhydNv"},{"type":"paragraph","position":{"start":{"line":587,"column":1},"end":{"line":587,"column":1}},"children":[{"type":"text","value":"So AB4, which is supposed to be ","position":{"start":{"line":587,"column":1},"end":{"line":587,"column":1}},"key":"OhgFzuAqI8"},{"type":"emphasis","position":{"start":{"line":587,"column":1},"end":{"line":587,"column":1}},"children":[{"type":"text","value":"more","position":{"start":{"line":587,"column":1},"end":{"line":587,"column":1}},"key":"h4XRYfhjv8"}],"key":"Dv2nkLen4w"},{"type":"text","value":" accurate than AM2, actually needs something like 8 times as many steps to get a reasonable-looking answer!","position":{"start":{"line":587,"column":1},"end":{"line":587,"column":1}},"key":"crhEWlDW7n"}],"key":"yt3aDEbfv3"}],"label":"demo-implicit-stiff-julia","identifier":"demo-implicit-stiff-julia","html_id":"demo-implicit-stiff-julia","key":"xGdehOSI9D"},{"type":"heading","depth":3,"position":{"start":{"line":590,"column":1},"end":{"line":590,"column":1}},"children":[{"type":"text","value":"Section 6.7","position":{"start":{"line":590,"column":1},"end":{"line":590,"column":1}},"key":"pUODLwZ9jk"}],"identifier":"section-6-7","label":"Section 6.7","html_id":"section-6-7","implicit":true,"key":"pMM0B1aYax"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Instability","position":{"start":{"line":592,"column":1},"end":{"line":592,"column":1}},"key":"yp7apzTY9a"}],"key":"i0WT6Ebf1r"},{"type":"paragraph","position":{"start":{"line":593,"column":1},"end":{"line":593,"column":1}},"children":[{"type":"text","value":"We’ll measure the error at the time ","position":{"start":{"line":593,"column":1},"end":{"line":593,"column":1}},"key":"wRSIJc5Zhf"},{"type":"inlineMath","value":"t=1","position":{"start":{"line":593,"column":1},"end":{"line":593,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003et\u003c/mi\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmn\u003e1\u003c/mn\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003et=1\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6151em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003et\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6444em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e1\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"o0VCN0spp7"},{"type":"text","value":".","position":{"start":{"line":593,"column":1},"end":{"line":593,"column":1}},"key":"ZEBpaZJT7v"}],"key":"LeQL72EsN2"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"du_dt(u, t) = u\nû = exp\na, b = 0.0, 1.0;\nn = [5, 10, 20, 40, 60]\nerr = []\nt, u = [], []\nfor n in n\n    h = (b - a) / n\n    t = [a + i * h for i in 0:n]\n    u = [1; û(h); zeros(n - 1)]\n    f_val = [du_dt(u[1], t[1]); zeros(n)]\n    for i in 2:n\n        f_val[i] = du_dt(u[i], t[i])\n        u[i+1] = -4 * u[i] + 5 * u[i-1] + h * (4 * f_val[i] + 2 * f_val[i-1])\n    end\n    push!(err, abs(û(b) - u[end]))\nend\n\npretty_table([n (b - a) ./ n err], header=[\"n\", \"h\", \"error\"])","key":"SAAuhPyjl4"},{"type":"output","id":"JThnDPknkm0wpZeiuydHW","data":[{"output_type":"stream","name":"stdout","text":"┌────┬───────────┬────────────┐\n│\u001b[1m  n \u001b[0m│\u001b[1m         h \u001b[0m│\u001b[1m      error \u001b[0m│\n├────┼───────────┼────────────┤\n│  5 │       0.2 │  0.0160452 │\n│ 10 │       0.1 │    2.84548 │\n│ 20 │      0.05 │   1.6225e6 │\n│ 40 │     0.025 │  9.3442e18 │\n│ 60 │ 0.0166667 │ 1.74013e32 │\n└────┴───────────┴────────────┘\n"}],"key":"BE9lqkNAcN"}],"data":{},"key":"yE6emGJGOo"},{"type":"paragraph","position":{"start":{"line":617,"column":1},"end":{"line":617,"column":1}},"children":[{"type":"text","value":"The error starts out promisingly, but things explode from there. A graph of the last numerical attempt yields a clue.","position":{"start":{"line":617,"column":1},"end":{"line":617,"column":1}},"key":"n8zhVVgH0D"}],"key":"J7FpyHyqNS"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"plot(t, abs.(u), m=3, label=\"\",\n    xlabel=L\"t\", yaxis=(:log10, L\"|u(t)|\"), title=\"LIAF solution\")","key":"NpwnJRKnRQ"},{"type":"output","id":"j31UKFiepDuQEK_KeDDvJ","data":[{"output_type":"execute_result","execution_count":47,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"9f00a40313ee1cd673fbce6eb9e5c8d1","path":"/fnc/build/9f00a40313ee1cd673fbce6eb9e5c8d1.png"},"text/html":{"content_type":"text/html","hash":"9f6a55b632adb3e874a097100abb40df","path":"/fnc/build/9f6a55b632adb3e874a097100abb40df.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"138e3310e18317ceb78448f86681788f","path":"/fnc/build/138e3310e18317ceb78448f86681788f.svg"}}}],"key":"PaBLRj2ulO"}],"data":{},"key":"iD1BZInFmt"},{"type":"paragraph","position":{"start":{"line":624,"column":1},"end":{"line":624,"column":1}},"children":[{"type":"text","value":"It’s clear that the solution is growing exponentially in time.","position":{"start":{"line":624,"column":1},"end":{"line":624,"column":1}},"key":"NvHRWt30Up"}],"key":"WOtLd79HlC"}],"label":"demo-zs-LIAF-julia","identifier":"demo-zs-liaf-julia","html_id":"demo-zs-liaf-julia","key":"Vzd1hEP2TP"}],"key":"h55rhGUHWz"}],"key":"e4mfFiv7Ir"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Chapter 5","url":"/chapter5","group":"Julia codes"},"next":{"title":"Chapter 1","url":"/chapter1-1","group":"MATLAB codes"}}},"domain":"http://localhost:3000"},"project":{"numbering":{"heading_1":{"enabled":true},"heading_2":{"enabled":true},"heading_3":{"enabled":false}},"math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"LU":"lower triangular times upper triangular","QR":"orthogonal times upper triangular"},"exports":[{"format":"pdf","filename":"myst.pdf","url":"/fnc/build/myst-17d85fc44120abd982ec3b44467ee78e.pdf"}],"title":"Fundamentals of Numerical Computation","short_title":"FNC","description":"Online textbook for computational mathematics","authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","id":"a36af5d8-56ed-4bf2-92e6-5f7fdb82e8e1","toc":[{"file":"home.md"},{"children":[{"file":"preface.md"},{"file":"preface-original.md"}],"title":"Preface"},{"children":[{"file":"chapter1/floating-point.md"},{"file":"chapter1/conditioning.md"},{"file":"chapter1/algorithms.md"},{"file":"chapter1/stability.md"},{"file":"chapter1/next.md"}],"file":"chapter1/overview.md"},{"children":[{"file":"chapter2/polyinterp.md"},{"file":"chapter2/matrices.md"},{"file":"chapter2/linear-systems.md"},{"file":"chapter2/lu.md"},{"file":"chapter2/efficiency.md"},{"file":"chapter2/pivoting.md"},{"file":"chapter2/norms.md"},{"file":"chapter2/condition-number.md"},{"file":"chapter2/structure.md"},{"file":"chapter2/next.md"}],"file":"chapter2/overview.md"},{"children":[{"file":"chapter3/fitting.md"},{"file":"chapter3/normaleqns.md"},{"file":"chapter3/qr.md"},{"file":"chapter3/house.md"},{"file":"chapter3/next.md"}],"file":"chapter3/overview.md"},{"children":[{"file":"chapter4/rootproblem.md"},{"file":"chapter4/fixed-point.md"},{"file":"chapter4/newton.md"},{"file":"chapter4/secant.md"},{"file":"chapter4/newtonsys.md"},{"file":"chapter4/quasinewton.md"},{"file":"chapter4/nlsq.md"},{"file":"chapter4/next.md"}],"file":"chapter4/overview.md"},{"children":[{"file":"chapter5/interpolation.md"},{"file":"chapter5/pwlin.md"},{"file":"chapter5/splines.md"},{"file":"chapter5/finitediffs.md"},{"file":"chapter5/fd-converge.md"},{"file":"chapter5/integration.md"},{"file":"chapter5/adaptive.md"},{"file":"chapter5/next.md"}],"file":"chapter5/overview.md"},{"children":[{"file":"chapter6/basics.md"},{"file":"chapter6/euler.md"},{"file":"chapter6/systems.md"},{"file":"chapter6/rk.md"},{"file":"chapter6/adaptive-rk.md"},{"file":"chapter6/multistep.md"},{"file":"chapter6/implicit.md"},{"file":"chapter6/zerostability.md"},{"file":"chapter6/next.md"}],"file":"chapter6/overview.md"},{"children":[{"file":"appendix/linear-algebra.md"},{"children":[{"file":"julia/chapter1.md"},{"file":"julia/chapter2.md"},{"file":"julia/chapter3.md"},{"file":"julia/chapter4.md"},{"file":"julia/chapter5.md"},{"file":"julia/chapter6.md"}],"title":"Julia codes"},{"children":[{"file":"matlab/chapter1.md"},{"file":"matlab/chapter2.md"},{"file":"matlab/chapter3.md"},{"file":"matlab/chapter4.md"},{"file":"matlab/chapter5.md"},{"file":"matlab/chapter6.md"}],"title":"MATLAB codes"},{"children":[{"file":"python/chapter1.md"},{"file":"python/chapter2.md"},{"file":"python/chapter3.md"},{"file":"python/chapter4.md"},{"file":"python/chapter5.md"},{"file":"python/chapter6.md"}],"title":"Python codes"}],"title":"Appendices"},{"file":"genindex.md"}],"thumbnail":"/fnc/build/front_cover_small-3b81a246c798b3ded1375244c3419355.png","thumbnailOptimized":"/fnc/build/front_cover_small-3b81a246c798b3ded1375244c3419355.webp","bibliography":[],"index":"home","pages":[{"level":1,"title":"Preface"},{"slug":"preface","title":"Preface to the Julia edition","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"preface-original","title":"Preface to the original edition","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"overview","title":"Introduction","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"floating-point","title":"Floating-point numbers","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"conditioning","title":"Problems and conditioning","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"algorithms","title":"Algorithms","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"stability","title":"Stability","description":"","date":"","thumbnail":"/fnc/build/backwarderror-bdcf58e0d5f4193c2230d0af9181d25c.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"next","title":"Next steps","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"overview-1","title":"Linear systems of equations","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"polyinterp","title":"Polynomial interpolation","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"matrices","title":"Computing with matrices","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"linear-systems","title":"Linear systems","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"lu","title":"LU factorization","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"efficiency","title":"Efficiency of matrix computations","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"pivoting","title":"Row pivoting","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"norms","title":"Vector and matrix norms","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"condition-number","title":"Conditioning of linear systems","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"structure","title":"Exploiting matrix structure","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"next-1","title":"Next steps","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"overview-2","title":"Overdetermined linear systems","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"fitting","title":"Fitting functions to data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"normaleqns","title":"The normal equations","description":"","date":"","thumbnail":"/fnc/build/normaleqns2d-3a9bdadad6b0273ad3bb332f316bfd7c.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"qr","title":"The QR factorization","description":"","date":"","thumbnail":"/fnc/build/nonorthogonal-b17ed1afa4e72fd15dc1d03a95b2c3d7.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"house","title":"Computing QR factorizations","description":"","date":"","thumbnail":"/fnc/build/hhreflect-4c7ca3f245617111b6fd9e68dcaee10e.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"next-2","title":"Next steps","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"overview-3","title":"Roots of nonlinear equations","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"rootproblem","title":"The rootfinding problem","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fixed-point","title":"Fixed-point iteration","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"newton","title":"Newton’s method","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"secant","title":"Interpolation-based methods","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"newtonsys","title":"Newton for nonlinear systems","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"quasinewton","title":"Quasi-Newton methods","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"nlsq","title":"Nonlinear least squares","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"next-3","title":"Next steps","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"overview-4","title":"Piecewise interpolation","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"interpolation","title":"The interpolation problem","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"pwlin","title":"Piecewise linear interpolation","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"splines","title":"Cubic splines","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"finitediffs","title":"Finite differences","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fd-converge","title":"Convergence of finite differences","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"integration","title":"Numerical integration","description":"","date":"","thumbnail":"/fnc/build/trapezoid-a279167525570df0e1ac47b0fceef54c.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"adaptive","title":"Adaptive integration","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"next-4","title":"Next steps","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"overview-5","title":"Initial-value problems for ODEs","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"basics","title":"Basics of IVPs","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"euler","title":"Euler’s method","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"systems","title":"IVP systems","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"rk","title":"Runge–Kutta methods","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"adaptive-rk","title":"Adaptive Runge–Kutta","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"multistep","title":"Multistep methods","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"implicit","title":"Implementation of multistep methods","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"zerostability","title":"Zero-stability of multistep methods","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"next-5","title":"Next steps","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Appendices"},{"slug":"linear-algebra","title":"Review of linear algebra","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":2,"title":"Julia codes"},{"slug":"chapter1","title":"Chapter 1","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter2","title":"Chapter 2","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter3","title":"Chapter 3","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter4","title":"Chapter 4","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter5","title":"Chapter 5","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter6","title":"Chapter 6","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":2,"title":"MATLAB codes"},{"slug":"chapter1-1","title":"Chapter 1","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter2-1","title":"Chapter 2","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter3-1","title":"Chapter 3","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter4-1","title":"Chapter 4","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter5-1","title":"Chapter 5","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter6-1","title":"Chapter 6","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":2,"title":"Python codes"},{"slug":"chapter1-2","title":"Chapter 1","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter2-2","title":"Chapter 2","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter3-2","title":"Chapter 3","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter4-2","title":"Chapter 4","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter5-2","title":"Chapter 5","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter6-2","title":"Chapter 6","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"genindex","title":"Index","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1}]}}},"actionData":null,"errors":null},"future":{"unstable_dev":false,"unstable_postcss":false,"unstable_tailwind":false,"v2_errorBoundary":true,"v2_headers":true,"v2_meta":true,"v2_normalizeFormMethod":true,"v2_routeConvention":true}};</script><script type="module" async="">import "/fnc/build/manifest-A92797E9.js";
import * as route0 from "/fnc/build/root-HROFNPGU.js";
import * as route1 from "/fnc/build/routes/$-WNZNXUO2.js";
window.__remixRouteModules = {"root":route0,"routes/$":route1};

import("/fnc/build/entry.client-UNPC4GT3.js");</script></body></html>