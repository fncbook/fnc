{"kind":"Notebook","sha256":"2aa8dbd5895280cc51a1dcc90851cbdbc06c015b369089b8132d254dfea4e060","slug":"chapter12","location":"/julia/chapter12.md","dependencies":[],"frontmatter":{"title":"Chapter 12","numbering":{"heading_1":{"enabled":false},"heading_2":{"enabled":false},"heading_3":{"enabled":false},"heading_4":{"enabled":false},"heading_5":{"enabled":false},"heading_6":{"enabled":false}},"kernelspec":{"name":"julia-1.11","display_name":"Julia 1","language":"julia"},"content_includes_title":false,"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"exports":[{"format":"md","filename":"chapter12.md","url":"/fnc/build/chapter12-a2be275e9976b32f4427abd1b80663fc.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Examples","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"ihor1dA2PJ"}],"identifier":"examples","label":"Examples","html_id":"examples","implicit":true,"key":"fRpuq4lupV"}],"key":"KUmRR6UZR7"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"include(\"FNC_init.jl\")","visibility":"show","key":"VA93315H5U"},{"type":"output","id":"MafHZU6rdX2-fTy8tyH40","data":[{"output_type":"stream","name":"stderr","text":"\u001b[32m\u001b[1m  Activating\u001b[22m\u001b[39m "},{"output_type":"stream","name":"stderr","text":"project at `~/Documents/GitHub/fnc`\n"}],"visibility":"remove","key":"nC0408PaxV"}],"data":{"tags":[]},"visibility":"show","key":"OQhV8rNAN3"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"12.1 ","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"uhd38cQrt8"},{"type":"link","identifier":"section-advection-traffic","label":"section-advection-traffic","kind":"narrative","position":{"start":{"line":18,"column":6},"end":{"line":18,"column":32}},"url":"/traffic","internal":true,"dataUrl":"/traffic.json","children":[{"type":"text","value":"Traffic flow","key":"LbQHpMujEn"}],"key":"vAJpJVN7pZ"}],"identifier":"id-12-1","label":"12.1 ","html_id":"id-12-1","implicit":true,"key":"fUbyEjOiLQ"},{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-traffic-advection","label":"demo-traffic-advection","kind":"proof:example","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":24}},"children":[{"type":"text","value":"Example ","key":"AL4RmCKX0O"},{"type":"text","value":"12.1.1","key":"vLyovcBFEh"}],"template":"Example %s","enumerator":"12.1.1","resolved":true,"html_id":"demo-traffic-advection","remote":true,"url":"/traffic","dataUrl":"/traffic.json","key":"ewkt5Bz8Ws"}],"key":"iCLPU2LdOZ"},{"type":"paragraph","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"text","value":"In the following definition we allow the velocity ","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"VdcNJKwavX"},{"type":"inlineMath","value":"c","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>c</mi></mrow><annotation encoding=\"application/x-tex\">c</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">c</span></span></span></span>","key":"DCvOl1o0wM"},{"type":"text","value":" to be specified as a parameter in the ","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"pTwi91kIfV"},{"type":"inlineCode","value":"ODEProblem","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"UoCzYUsIpQ"},{"type":"text","value":".","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"bqYmmIMPZl"}],"key":"L35rliN2jB"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"x, Dₓ, Dₓₓ = FNC.diffper(300, [-4, 4]);\nf = (u, c, t) -> -c * (Dₓ*u);","key":"W4g2Q75gQ1"},{"type":"output","id":"fgX_PaLvOhgrKKh40lAjh","data":[],"key":"vN6fVHTXmG"}],"data":{},"key":"tUsV8IZUIW"},{"type":"paragraph","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"children":[{"type":"text","value":"The following initial condition isn’t mathematically periodic, but the deviation is less than machine precision. We specify RK4 as the solver.","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"DSKS7x9QT9"}],"key":"Q1BRh5efOH"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"using OrdinaryDiffEq\nu_init = @. 1 + exp( -3x^2 )\nIVP = ODEProblem(f, u_init, (0., 4.), 2)\nsol = solve(IVP, RK4());","key":"YMFLEBvlxQ"},{"type":"output","id":"gkdJupsJp_8RoFwMFUPnD","data":[],"key":"NNntmfzZqw"}],"data":{},"key":"mZsh4Omcqb"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"using Plots\nplt = plot(\n    legend=:bottomleft,\n    title=\"Advection with periodic boundary\",\n    xaxis=(L\"x\"),  yaxis=(L\"u(x,t)\"))\nfor t in (0:4) * 2/3\n    plot!(x, sol(t), label=@sprintf(\"t=%.1f\", t))\nend\nplt","visibility":"hide","key":"NuiXsPRbRK"},{"type":"output","id":"Pbet9DsXrMovjAQkkLIuj","data":[{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"3f0a22fd72789354fa8b05c10c3037ad","path":"/fnc/build/3f0a22fd72789354fa8b05c10c3037ad.png"},"text/html":{"content_type":"text/html","hash":"1b02ae9f59c0c9fa0596858d06b10372","path":"/fnc/build/1b02ae9f59c0c9fa0596858d06b10372.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"7d55ce1d03724868dcbd2ed27850ecb9","path":"/fnc/build/7d55ce1d03724868dcbd2ed27850ecb9.svg"}}}],"visibility":"show","key":"kXxAwTOhip"}],"data":{"tags":[]},"visibility":"show","key":"ABt7fgNIxn"},{"type":"paragraph","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"children":[{"type":"text","value":"An animation shows the solution nicely. The bump moves with speed 2 to the right, reentering on the left as it exits to the right because of the periodic conditions.","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"key":"F1MEpemrA2"}],"key":"Lcvden4vd8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"anim = @animate for t in range(0, 4, 120) \n    plot(x, sol(t),\n        title=@sprintf(\"Advection equation, t = %.2f\", t),\n        xaxis=(L\"x\"),  yaxis=([1, 2], L\"u(x,t)\"),\n        dpi=150)\nend\nmp4(anim, \"figures/advection.mp4\")","visibility":"hide","key":"qQUqTrTG4h"},{"type":"output","id":"Pvbpkwv3GYDiGt5l3YEOk","data":[{"output_type":"stream","name":"stderr","text":"\u001b[36m\u001b[1m[ \u001b[22m\u001b[39m\u001b[36m\u001b[1mInfo: \u001b[22m\u001b[39mSaved animation to /Users/driscoll/Dropbox/Mac/Documents/GitHub/fnc/julia/figures/advection.mp4\n"},{"output_type":"execute_result","execution_count":5,"metadata":{},"data":{"text/plain":{"content":"Plots.AnimatedGif(\"/Users/driscoll/Dropbox/Mac/Documents/GitHub/fnc/julia/figures/advection.mp4\")","content_type":"text/plain"},"text/html":{"content_type":"text/html","hash":"2aa36b0f116daf57a36937f6baad0023","path":"/fnc/build/2aa36b0f116daf57a36937f6baad0023.html"}}}],"visibility":"show","key":"h8im52WOuw"}],"data":{"tags":[]},"visibility":"show","key":"ZQlPEv1H0X"}],"label":"demo-traffic-advection-julia","identifier":"demo-traffic-advection-julia","html_id":"demo-traffic-advection-julia","key":"W9xWrbJ2Yx"},{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-traffic-solve","label":"demo-traffic-solve","kind":"proof:example","position":{"start":{"line":68,"column":1},"end":{"line":68,"column":20}},"children":[{"type":"text","value":"Example ","key":"hXIzOPsn9q"},{"type":"text","value":"12.1.2","key":"MNPc8qxOSJ"}],"template":"Example %s","enumerator":"12.1.2","resolved":true,"html_id":"demo-traffic-solve","remote":true,"url":"/traffic","dataUrl":"/traffic.json","key":"lGsijGuJ93"}],"key":"BHQlcaWvq5"},{"type":"paragraph","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"children":[{"type":"text","value":"The following are parameters and a function relevant to defining the problem.","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"key":"t5MN63xALa"}],"key":"UtorDLIAg2"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"ρc = 1080;  ρm = 380;  q_m = 10000;\ndQ0 = ρ -> 4q_m * ρc^2 * (ρc-ρm) * ρm * (ρm-ρ) / (ρ*(ρc-2*ρm) + ρc*ρm)^3;","key":"kUVvdL2FEb"},{"type":"output","id":"7dy6OnGIMDu3-VrTtiXkn","data":[],"key":"vaeiv2AvSY"}],"data":{},"key":"uJtwIAuTVM"},{"type":"paragraph","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"children":[{"type":"text","value":"Here we create a discretization on ","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"key":"JVXE9tsPAp"},{"type":"inlineMath","value":"m=800","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi><mo>=</mo><mn>800</mn></mrow><annotation encoding=\"application/x-tex\">m=800</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">800</span></span></span></span>","key":"R7kN72KEU5"},{"type":"text","value":" points.","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"key":"vLIXsSnsm0"}],"key":"A2J2AcqlLe"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"x, Dₓ, Dₓₓ = FNC.diffper(800, [0, 4]);","key":"SjG0ARiqTI"},{"type":"output","id":"5NHNPMuW5JMowAkvyV3wx","data":[],"key":"N2Z4LkKieJ"}],"data":{},"key":"emfkTMv6jn"},{"type":"paragraph","position":{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},"children":[{"type":"text","value":"Next we define the ","key":"Un7Mw3mJ1B"},{"type":"abbreviation","title":"ordinary differential equation","children":[{"type":"text","value":"ODE","key":"wIr418ryfa"}],"key":"vfraTEBFcE"},{"type":"text","value":" resulting from the method of lines.","key":"cTWvRFhFae"}],"key":"u1aWMvLwDa"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"ode = (ρ, ϵ, t) -> -dQ0.(ρ) .* (Dₓ*ρ) + ϵ * (Dₓₓ*ρ);","key":"Q0ReOP3ZPx"},{"type":"output","id":"-bcvJ38KqXV7-vcAg4RXR","data":[],"key":"A3nk6iL03H"}],"data":{},"key":"huZoQ9RVAy"},{"type":"paragraph","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"children":[{"type":"text","value":"Our first initial condition has moderate density with a small bump. Because of the diffusion present, we use a stiff solver for the ","key":"PviOe4Rtva"},{"type":"abbreviation","title":"initial-value problem","children":[{"type":"text","value":"IVP","key":"oeQ2pwNxTY"}],"key":"QsZvuzZyjA"},{"type":"text","value":".","key":"MCNCayfdU9"}],"key":"evCm87avYE"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"ρ_init = @. 400 + 10 * exp( -20*(x-3)^2 )\nIVP = ODEProblem(ode, ρ_init, (0., 1.), 0.02)\nsol = solve(IVP, Rodas4P());","key":"PeIACwN50B"},{"type":"output","id":"MXJPUTM7ZF355hLVymc2y","data":[],"key":"EJg70pCXch"}],"data":{},"key":"gBFURLVXZ1"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"plt = plot(\n    legend=:topleft, \n    title=\"Traffic flow\",\n    xaxis=(L\"x\"),  yaxis=(\"car density\"))\nfor t in 0:0.2:1\n    plot!(x, sol(t), label=@sprintf(\"t=%.1f\", t))\nend\nplt","visibility":"hide","key":"OTXyjohN38"},{"type":"output","id":"8m-Milg5cRZDcsT5CBGz6","data":[{"output_type":"execute_result","execution_count":10,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"7abd9c7be7bbcd6482ecf213933ba178","path":"/fnc/build/7abd9c7be7bbcd6482ecf213933ba178.png"},"text/html":{"content_type":"text/html","hash":"d481ab75285188c820276651f1c05bad","path":"/fnc/build/d481ab75285188c820276651f1c05bad.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"69ae299ecb678d243dbe733ca511fbb9","path":"/fnc/build/69ae299ecb678d243dbe733ca511fbb9.svg"}}}],"visibility":"show","key":"XhZMmpFlOM"}],"data":{"tags":[]},"visibility":"show","key":"C1RsdD7yGw"},{"type":"paragraph","position":{"start":{"line":108,"column":1},"end":{"line":108,"column":1}},"children":[{"type":"text","value":"The bump slowly moves backward on the roadway, spreading out and gradually fading away due to the presence of diffusion.","position":{"start":{"line":108,"column":1},"end":{"line":108,"column":1}},"key":"MS61VHdOWx"}],"key":"XznxMeS9ra"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"anim = @animate for t in range(0,0.9,91) \n    plot(x, sol(t);\n        xaxis=(L\"x\"),  yaxis=([400,410], \"density\"),\n        dpi=150,  title=@sprintf(\"Traffic flow, t=%.2f\",t))\nend\nmp4(anim, \"figures/traffic-fade.mp4\")","visibility":"hide","key":"QkdCDKK2mD"},{"type":"output","id":"z7DP-x36XArb5hmrQdiTz","data":[{"output_type":"stream","name":"stderr","text":"\u001b[36m\u001b[1m[ \u001b[22m\u001b[39m\u001b[36m\u001b[1mInfo: \u001b[22m\u001b[39mSaved animation to /Users/driscoll/Dropbox/Mac/Documents/GitHub/fnc/julia/figures/traffic-fade.mp4\n"},{"output_type":"execute_result","execution_count":11,"metadata":{},"data":{"text/plain":{"content":"Plots.AnimatedGif(\"/Users/driscoll/Dropbox/Mac/Documents/GitHub/fnc/julia/figures/traffic-fade.mp4\")","content_type":"text/plain"},"text/html":{"content_type":"text/html","hash":"04ba6f64d6095f98be3ec71671dfc10c","path":"/fnc/build/04ba6f64d6095f98be3ec71671dfc10c.html"}}}],"visibility":"show","key":"pPLNU5PXBF"}],"data":{"tags":[]},"visibility":"show","key":"hD1aviWOaB"},{"type":"paragraph","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"children":[{"type":"text","value":"Now we use an initial condition with a larger bump. Note that the scale on the ","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"key":"Ij4Z4zfXQD"},{"type":"inlineMath","value":"y","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>","key":"Iys35If3cZ"},{"type":"text","value":"-axis is much different for this solution.","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"key":"UpBznm19AI"}],"key":"YjWXDxYKAa"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"ρ_init = @. 400 + 80 * exp( -16*(x - 3)^2 )\nIVP = ODEProblem(ode, ρ_init, (0., 0.5), 0.02)\nsol = solve(IVP, Rodas4P());","key":"yej88X8TXQ"},{"type":"output","id":"ThDs8Tsp6-gwbnI-Jj7aZ","data":[],"key":"IHLGaFcgRN"}],"data":{},"key":"TsXqksOLej"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"plt = plot(\n    legend=:topleft,\n    title=\"Traffic jam\",\n    xaxis=(L\"x\"),  yaxis=(\"car density\"))\nfor t in range(0, 5, 11)\n    plot!(x, sol(t), label=@sprintf(\"t=%.1f\", t))\nend\nplt","visibility":"hide","key":"RvhQ5cXI9A"},{"type":"output","id":"Lhdj4WsT2FNKwX5aHB690","data":[{"output_type":"execute_result","execution_count":13,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"e8924017baa87bc398f89b208d68819c","path":"/fnc/build/e8924017baa87bc398f89b208d68819c.png"},"text/html":{"content_type":"text/html","hash":"8e01a98f1f49d01c385f090fef31794c","path":"/fnc/build/8e01a98f1f49d01c385f090fef31794c.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"51e4eb2b49e42be0492c56c58f913496","path":"/fnc/build/51e4eb2b49e42be0492c56c58f913496.svg"}}}],"visibility":"show","key":"bUzRllxDP9"}],"data":{"tags":[]},"visibility":"show","key":"qgDmGZuPrl"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"anim = @animate for t in range(0, 0.5, 101) \n    plot(x, sol(t);\n        xaxis=(L\"x\"),  yaxis=([400,480], \"density\"),\n        dpi=150,  title=@sprintf(\"Traffic jam, t=%.2f\",t))\nend\nmp4(anim,\"figures/traffic-jam.mp4\")","visibility":"hide","key":"m71h3OoqgM"},{"type":"output","id":"_zeExiZaD1Em4fMm5JHYH","data":[{"output_type":"stream","name":"stderr","text":"\u001b[36m\u001b[1m[ \u001b[22m\u001b[39m\u001b[36m\u001b[1mInfo: \u001b[22m\u001b[39mSaved animation to /Users/driscoll/Dropbox/Mac/Documents/GitHub/fnc/julia/figures/traffic-jam.mp4\n"},{"output_type":"execute_result","execution_count":14,"metadata":{},"data":{"text/plain":{"content":"Plots.AnimatedGif(\"/Users/driscoll/Dropbox/Mac/Documents/GitHub/fnc/julia/figures/traffic-jam.mp4\")","content_type":"text/plain"},"text/html":{"content_type":"text/html","hash":"5e6c0173dc440b6138780c5c63c24a23","path":"/fnc/build/5e6c0173dc440b6138780c5c63c24a23.html"}}}],"visibility":"show","key":"DVHogUH967"}],"data":{"tags":[]},"visibility":"show","key":"QWPJPyddKg"},{"type":"paragraph","position":{"start":{"line":150,"column":1},"end":{"line":150,"column":1}},"children":[{"type":"text","value":"In this case the density bump travels backward along the road. It also steepens on the side facing the incoming traffic and decreases much more slowly on the other side. A motorist would experience this as an abrupt increase in density, followed by a much more gradual decrease in density and resulting gradual increase in speed. (You also see some transient, high-frequency oscillations. These are caused by instabilities, as we discuss in simpler situations later in this chapter.)","position":{"start":{"line":150,"column":1},"end":{"line":150,"column":1}},"key":"j5WuYzN2TS"}],"key":"Vl2eWLQMTa"}],"label":"demo-traffic-solve-julia","identifier":"demo-traffic-solve-julia","html_id":"demo-traffic-solve-julia","key":"czBDUgLh8O"},{"type":"heading","depth":3,"position":{"start":{"line":154,"column":1},"end":{"line":154,"column":1}},"children":[{"type":"text","value":"12.2 ","position":{"start":{"line":154,"column":1},"end":{"line":154,"column":1}},"key":"hlP0YASYZq"},{"type":"link","identifier":"section-advection-upwind","label":"section-advection-upwind","kind":"narrative","position":{"start":{"line":154,"column":6},"end":{"line":154,"column":31}},"url":"/upwind","internal":true,"dataUrl":"/upwind.json","children":[{"type":"text","value":"Upwinding and stability","key":"BMEKcAV7h3"}],"key":"pfUrZVW5oJ"}],"identifier":"id-12-2","label":"12.2 ","html_id":"id-12-2","implicit":true,"key":"PRhqEN14yP"},{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-upwind-cfl","label":"demo-upwind-cfl","kind":"proof:example","position":{"start":{"line":157,"column":1},"end":{"line":157,"column":17}},"children":[{"type":"text","value":"Example ","key":"Mb6f0nWW17"},{"type":"text","value":"12.2.3","key":"RH3bEa7xt9"}],"template":"Example %s","enumerator":"12.2.3","resolved":true,"html_id":"demo-upwind-cfl","remote":true,"url":"/upwind","dataUrl":"/upwind.json","key":"QBYm0YhB3o"}],"key":"md80bRReA8"},{"type":"paragraph","position":{"start":{"line":158,"column":1},"end":{"line":158,"column":1}},"children":[{"type":"text","value":"For time stepping, we use the adaptive explicit method ","position":{"start":{"line":158,"column":1},"end":{"line":158,"column":1}},"key":"qBhkrKPzya"},{"type":"inlineCode","value":"RK4","position":{"start":{"line":158,"column":1},"end":{"line":158,"column":1}},"key":"ZIioVeg3jI"},{"type":"text","value":".","position":{"start":{"line":158,"column":1},"end":{"line":158,"column":1}},"key":"g4h8YOB0G2"}],"key":"QAfLZN86Sr"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"using OrdinaryDiffEq\nm = 400;\nx, Dₓ = FNC.diffper(m, [0, 1])\nu_init = x -> exp( -80 * (x - 0.5)^2 )\node = (u, c, t) -> -c * (Dₓ*u)\nIVP = ODEProblem(ode, u_init.(x), (0., 2.), 2.)\nu = solve(IVP, RK4());","key":"bgUHM0LSR3"},{"type":"output","id":"UPLfQo6YD2pkYmgqKkaN1","data":[],"key":"rKmKonj31t"}],"data":{},"key":"RT2oe8eVxq"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"using Plots\nt = range(0, 2, 81);\nU = reduce(hcat, u(t) for t in t)\ncontour(x, t, U'; \n    color=:redsblues,  clims=(-1, 1),\n    xaxis=(L\"x\"),  yaxis=(L\"t\"),\n    title=\"Linear advection\",  right_margin=3Plots.mm)","visibility":"hide","key":"LD7PozHpeS"},{"type":"output","id":"Fmc0k6BtkrgtdYclCldLN","data":[{"output_type":"execute_result","execution_count":16,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"5265900b137297ac6f67467b0300043d","path":"/fnc/build/5265900b137297ac6f67467b0300043d.png"},"text/html":{"content_type":"text/html","hash":"3c16e256712b42a38e658259fc164c32","path":"/fnc/build/3c16e256712b42a38e658259fc164c32.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"b5315e4c17854373fa50a5e7b7c63fee","path":"/fnc/build/b5315e4c17854373fa50a5e7b7c63fee.svg"}}}],"visibility":"show","key":"PnGDgBa6HP"}],"data":{"tags":[]},"visibility":"show","key":"oL8ltTRUKW"},{"type":"paragraph","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"children":[{"type":"text","value":"In the space-time plot above, you can see the initial hump traveling rightward at constant speed. It fully traverses the domain once for each integer multiple of ","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"key":"f6KRyjPmgo"},{"type":"inlineMath","value":"t=1/2","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi><mo>=</mo><mn>1</mn><mi mathvariant=\"normal\">/</mi><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">t=1/2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1/2</span></span></span></span>","key":"eLfjVjG8F6"},{"type":"text","value":".","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"key":"Y4U7aEry7J"}],"key":"znC67cDwsb"},{"type":"paragraph","position":{"start":{"line":183,"column":1},"end":{"line":183,"column":1}},"children":[{"type":"text","value":"If we cut ","position":{"start":{"line":183,"column":1},"end":{"line":183,"column":1}},"key":"RGuplvYQYV"},{"type":"inlineMath","value":"h","position":{"start":{"line":183,"column":1},"end":{"line":183,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>h</mi></mrow><annotation encoding=\"application/x-tex\">h</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">h</span></span></span></span>","key":"SkWl341Wxg"},{"type":"text","value":" by a factor of 2 (i.e., double ","position":{"start":{"line":183,"column":1},"end":{"line":183,"column":1}},"key":"isCji5ZPwi"},{"type":"inlineMath","value":"m","position":{"start":{"line":183,"column":1},"end":{"line":183,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi></mrow><annotation encoding=\"application/x-tex\">m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">m</span></span></span></span>","key":"eY9ygPdudp"},{"type":"text","value":"), then the CFL condition suggests that the time step should be cut by a factor of 2 also.","position":{"start":{"line":183,"column":1},"end":{"line":183,"column":1}},"key":"uVBpVglldS"}],"key":"dZoYrRKjYk"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"println(\"Number of time steps for m = 400: $(length(u.t))\")\n\nm = 800;\nx, Dₓ = FNC.diffper(m, [0, 1])\nIVP = ODEProblem(ode, u_init.(x), (0., 2.), 2.)\nu = solve(IVP, RK4())\nprintln(\"Number of time steps for m = 800: $(length(u.t))\")","key":"JP8jMVOM0J"},{"type":"output","id":"rotzaOBGVOqHbQ5BbZ9iE","data":[{"output_type":"stream","name":"stdout","text":"Number of time steps for m = 400: 565\nNumber of time steps for m = 800: 1128\n"}],"key":"lJdUDpWW2Z"}],"data":{},"key":"K8Fnn44Ql2"}],"label":"demo-upwind-cfl-julia","identifier":"demo-upwind-cfl-julia","html_id":"demo-upwind-cfl-julia","key":"W6ud91FqW5"},{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-upwind-direction","label":"demo-upwind-direction","kind":"proof:example","position":{"start":{"line":197,"column":1},"end":{"line":197,"column":23}},"children":[{"type":"text","value":"Example ","key":"kRpq1uEY6r"},{"type":"text","value":"12.2.6","key":"OIIBtWTeyp"}],"template":"Example %s","enumerator":"12.2.6","resolved":true,"html_id":"demo-upwind-direction","remote":true,"url":"/upwind","dataUrl":"/upwind.json","key":"Squ8nw5JFP"}],"key":"eXACfxz5dW"},{"type":"paragraph","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"children":[{"type":"text","value":"If we solve advection over ","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"key":"cXbMQZLckk"},{"type":"inlineMath","value":"[0,1]","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mn>0</mn><mo separator=\"true\">,</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[0,1]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]</span></span></span></span>","key":"qWDy0GYe0V"},{"type":"text","value":" with velocity ","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"key":"zG4ijPxXBu"},{"type":"inlineMath","value":"c=-1","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>c</mi><mo>=</mo><mo>−</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">c=-1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">c</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">−</span><span class=\"mord\">1</span></span></span></span>","key":"NynPAuuXsh"},{"type":"text","value":", the right boundary is in the upwind/inflow direction. Thus a well-posed boundary condition is ","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"key":"FRii1ryzx0"},{"type":"inlineMath","value":"u(1,t)=0","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo stretchy=\"false\">(</mo><mn>1</mn><mo separator=\"true\">,</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">u(1,t)=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"kE2XzBUIrs"},{"type":"text","value":".","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"key":"pDciSSBB8e"}],"key":"GrM1KD53yI"},{"type":"paragraph","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"children":[{"type":"text","value":"We’ll pattern a solution after ","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"key":"l8Zu7I2YN9"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-parabolic","label":"function-parabolic","children":[{"type":"text","value":"Function ","key":"PHaWnfrfYc"},{"type":"text","value":"11.5.2","key":"eIupPMeF7l"}],"template":"Algorithm %s","enumerator":"11.5.2","resolved":true,"html_id":"function-parabolic","remote":true,"url":"/boundaries","dataUrl":"/boundaries.json","key":"UTZPVS3q2s"},{"type":"text","value":". Since ","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"key":"yzPLHyGFgD"},{"type":"inlineMath","value":"u(x_m,t)=0","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>m</mi></msub><mo separator=\"true\">,</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">u(x_m,t)=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"gGApj0OIbz"},{"type":"text","value":", we define the ","key":"diP9QDbjjd"},{"type":"abbreviation","title":"ordinary differential equation","children":[{"type":"text","value":"ODE","key":"NawYOEIFxe"}],"key":"JNLJkxHebY"},{"type":"text","value":" interior problem ","key":"Y2oArcRJAl"},{"type":"crossReference","kind":"equation","identifier":"mol-interior","label":"mol-interior","children":[{"type":"text","value":"(","key":"ifU8VrAzUo"},{"type":"text","value":"11.5.4","key":"OFq9SexENV"},{"type":"text","value":")","key":"qoo7sh1LKE"}],"template":"(%s)","enumerator":"11.5.4","resolved":true,"html_id":"mol-interior","remote":true,"url":"/boundaries","dataUrl":"/boundaries.json","key":"bGoPNrhIRs"},{"type":"text","value":" for ","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"key":"KAPYFkNKB3"},{"type":"inlineMath","value":"\\mathbf{v}","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">v</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{v}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4444em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">v</span></span></span></span>","key":"sNQsKG8M3u"},{"type":"text","value":" without ","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"key":"PRqCTgYfxF"},{"type":"inlineMath","value":"u_m","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>u</mi><mi>m</mi></msub></mrow><annotation encoding=\"application/x-tex\">u_m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"zTkaiRGeVa"},{"type":"text","value":". For each evaluation of ","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"key":"x25qTlc7Df"},{"type":"inlineMath","value":"\\mathbf{v}'","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi mathvariant=\"bold\">v</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup></mrow><annotation encoding=\"application/x-tex\">\\mathbf{v}&#x27;</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span></span></span></span>","key":"rY8MyM7stz"},{"type":"text","value":", we must extend the data back to ","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"key":"yFgej99j81"},{"type":"inlineMath","value":"x_m","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mi>m</mi></msub></mrow><annotation encoding=\"application/x-tex\">x_m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"J46tzP7H4d"},{"type":"text","value":" first.","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"key":"ZnZLZBBRl1"}],"key":"it5RrCdV84"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"m = 100\nx, Dₓ = FNC.diffmat2(m, [0, 1])\n\ninterior = 1:m\nextend = v -> [v; 0]\n\nfunction ode!(f, v, c, t)\n    u = extend(v)\n    uₓ = Dₓ * u\n    @. f = -c * uₓ[interior]\nend;","key":"TIzB5LZKzt"},{"type":"output","id":"zpvOMkxG2yKL5eRWtrYv7","data":[],"key":"MU5mJAnsXL"}],"data":{},"key":"DWdm5MnbSt"},{"type":"paragraph","position":{"start":{"line":216,"column":1},"end":{"line":216,"column":1}},"children":[{"type":"text","value":"Now we solve for an initial condition that has a single hump.","position":{"start":{"line":216,"column":1},"end":{"line":216,"column":1}},"key":"HxlhA1foMs"}],"key":"ZQrWGavmkP"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"init = @. exp( -80*(x[interior] - 0.5)^2 )\nivp = ODEProblem(ode!, init, (0., 1), -1)\nu = solve(ivp);","key":"QdFvgOftmS"},{"type":"output","id":"UvDNEcHOaFOcWbJQioRDz","data":[],"key":"lqTFXEyGrF"}],"data":{},"key":"txrmJTeC5K"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"t = range(0, 0.75, 80)\nU = reduce(hcat, extend(u(t)) for t in t)\ncontour(x, t, U';\n    color=:blues,  clims=(0, 1), \n    xaxis=(L\"x\"),  yaxis=(L\"t\"),\n    title=\"Advection with inflow BC\")","key":"vVUJTWfkuj"},{"type":"output","id":"D72RdBMsifHKSB2Shpzjy","data":[{"output_type":"execute_result","execution_count":20,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"0c7f82719144bc873536174a4854acfc","path":"/fnc/build/0c7f82719144bc873536174a4854acfc.png"},"text/html":{"content_type":"text/html","hash":"18d73f21bb8de3606e7dc907c699f7e5","path":"/fnc/build/18d73f21bb8de3606e7dc907c699f7e5.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"920aedc3150a2806fb8c1347be490c86","path":"/fnc/build/920aedc3150a2806fb8c1347be490c86.svg"}}}],"key":"PWR4VCSfdC"}],"data":{},"key":"WV1W7VoKMR"},{"type":"paragraph","position":{"start":{"line":233,"column":1},"end":{"line":233,"column":1}},"children":[{"type":"text","value":"We find that the hump gracefully exits out the downwind end.","position":{"start":{"line":233,"column":1},"end":{"line":233,"column":1}},"key":"EV3t9JVfLt"}],"key":"LOEgz3yPCk"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"anim = @animate for t in range(0, 1, 161) \n    plot(x, extend(u(t));\n        label=@sprintf(\"t = %.4f\", t), \n        xaxis=(L\"x\"),  yaxis=(L\"u(x, t)\", (0, 1)), \n        title=\"Advection equation with inflow BC\",  dpi=150)\nend\nmp4(anim,\"figures/upwind-inflow.mp4\")","visibility":"hide","key":"kbq0qKQCDE"},{"type":"output","id":"5l5izgddp_ND8H2LD53aX","data":[{"output_type":"stream","name":"stderr","text":"\u001b[36m\u001b[1m[ \u001b[22m\u001b[39m\u001b[36m\u001b[1mInfo: \u001b[22m\u001b[39mSaved animation to /Users/driscoll/Dropbox/Mac/Documents/GitHub/fnc/julia/figures/upwind-inflow.mp4\n"},{"output_type":"execute_result","execution_count":21,"metadata":{},"data":{"text/plain":{"content":"Plots.AnimatedGif(\"/Users/driscoll/Dropbox/Mac/Documents/GitHub/fnc/julia/figures/upwind-inflow.mp4\")","content_type":"text/plain"},"text/html":{"content_type":"text/html","hash":"fae1f6fec0a2c561d66f7b48b0f6bf00","path":"/fnc/build/fae1f6fec0a2c561d66f7b48b0f6bf00.html"}}}],"visibility":"show","key":"kJQ0yC8X3D"}],"data":{"tags":[]},"visibility":"show","key":"Fwm7pXYJs4"},{"type":"paragraph","position":{"start":{"line":246,"column":1},"end":{"line":246,"column":1}},"children":[{"type":"text","value":"If instead of ","position":{"start":{"line":246,"column":1},"end":{"line":246,"column":1}},"key":"VkAmtjTOPO"},{"type":"inlineMath","value":"u(1,t)=0","position":{"start":{"line":246,"column":1},"end":{"line":246,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo stretchy=\"false\">(</mo><mn>1</mn><mo separator=\"true\">,</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">u(1,t)=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"aDoUptJITj"},{"type":"text","value":" we were to try to impose the downwind condition ","position":{"start":{"line":246,"column":1},"end":{"line":246,"column":1}},"key":"Eut3ZDBw5q"},{"type":"inlineMath","value":"u(0,t)=0","position":{"start":{"line":246,"column":1},"end":{"line":246,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo stretchy=\"false\">(</mo><mn>0</mn><mo separator=\"true\">,</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">u(0,t)=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"Rwm1CXWaZo"},{"type":"text","value":", we only need to change the index of the interior nodes and where to append the zero value.","position":{"start":{"line":246,"column":1},"end":{"line":246,"column":1}},"key":"gKoEM20Cbg"}],"key":"aG7QN6FzwW"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"interior = 2:m+1\nextend = v -> [0; v]\n\ninit = @. exp( -80*(x[interior] - 0.5)^2 )\nivp = ODEProblem(ode!, init, (0., 0.25), -1)\nu = solve(ivp);","key":"DphnO9ZjXv"},{"type":"output","id":"brS_ycLJDldlgZUkfHVBI","data":[],"key":"OB1I479Omz"}],"data":{},"key":"H4FXoReYiE"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"t = range(0, 0.2, 61)\nU = reduce(hcat, extend(u(t)) for t in t)\ncontour(x, t, U'; \n    color=:redsblues,  clims=(-1, 1),\n    xaxis=(L\"x\"),  yaxis=(L\"t\"), \n    title=\"Advection with outflow BC\",  right_margin=3Plots.mm)","visibility":"hide","key":"uK3yYdd7Hq"},{"type":"output","id":"MtRRARo3jwkeQvQFLjPKP","data":[{"output_type":"execute_result","execution_count":23,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"440d5ae8360f79119c4ce53b78480983","path":"/fnc/build/440d5ae8360f79119c4ce53b78480983.png"},"text/html":{"content_type":"text/html","hash":"10af3ffbcb1c85a8b8482b497d897be3","path":"/fnc/build/10af3ffbcb1c85a8b8482b497d897be3.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"f1c97c87e0ea3001201860282846dc12","path":"/fnc/build/f1c97c87e0ea3001201860282846dc12.svg"}}}],"visibility":"show","key":"gYWJ6MoGPZ"}],"data":{"tags":[]},"visibility":"show","key":"oMLh2XjAti"},{"type":"paragraph","position":{"start":{"line":267,"column":1},"end":{"line":267,"column":1}},"children":[{"type":"text","value":"This time, the solution blows up as soon as the hump runs into the boundary because there are conflicting demands there.","position":{"start":{"line":267,"column":1},"end":{"line":267,"column":1}},"key":"JhLFdrH9OF"}],"key":"ISpsVDkPCW"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"anim = @animate for t in range(0, 0.2, 41) \n    plot(x, extend(u(t));\n        label=@sprintf(\"t = %.4f\", t),\n        xaxis=(L\"x\"),  yaxis=(L\"u(x,t)\", (0, 1)), \n        title=\"Advection equation with outflow BC\",  dpi=150)\nend\nmp4(anim,\"figures/upwind-outflow.mp4\")","visibility":"hide","key":"fZAZSlaIh8"},{"type":"output","id":"VJ3HqFGYQqvxMdb7OKqI9","data":[{"output_type":"stream","name":"stderr","text":"\u001b[36m\u001b[1m[ \u001b[22m\u001b[39m\u001b[36m\u001b[1mInfo: \u001b[22m\u001b[39mSaved animation to /Users/driscoll/Dropbox/Mac/Documents/GitHub/fnc/julia/figures/upwind-outflow.mp4\n"},{"output_type":"execute_result","execution_count":24,"metadata":{},"data":{"text/plain":{"content":"Plots.AnimatedGif(\"/Users/driscoll/Dropbox/Mac/Documents/GitHub/fnc/julia/figures/upwind-outflow.mp4\")","content_type":"text/plain"},"text/html":{"content_type":"text/html","hash":"026386b9931417a3f006ca7f77f92ec4","path":"/fnc/build/026386b9931417a3f006ca7f77f92ec4.html"}}}],"visibility":"show","key":"saShyqvPHN"}],"data":{"tags":[]},"visibility":"show","key":"RTyXoYKNf9"}],"label":"demo-upwind-direction-julia","identifier":"demo-upwind-direction-julia","html_id":"demo-upwind-direction-julia","key":"pg04mkse1r"},{"type":"heading","depth":3,"position":{"start":{"line":281,"column":1},"end":{"line":281,"column":1}},"children":[{"type":"text","value":"12.3 ","position":{"start":{"line":281,"column":1},"end":{"line":281,"column":1}},"key":"U8pTJExI59"},{"type":"link","identifier":"section-advection-absstab","label":"section-advection-absstab","kind":"narrative","position":{"start":{"line":281,"column":6},"end":{"line":281,"column":32}},"url":"/absstab-advection","internal":true,"dataUrl":"/absstab-advection.json","children":[{"type":"text","value":"Absolute stability","key":"QQxpSz0lfw"}],"key":"hJDgeYJlYM"}],"identifier":"id-12-3","label":"12.3 ","html_id":"id-12-3","implicit":true,"key":"bXPdsg2and"},{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-absstab-advection","label":"demo-absstab-advection","kind":"proof:example","position":{"start":{"line":284,"column":1},"end":{"line":284,"column":24}},"children":[{"type":"text","value":"Example ","key":"fBn2zLXDe2"},{"type":"text","value":"12.3.1","key":"fffVX7mpid"}],"template":"Example %s","enumerator":"12.3.1","resolved":true,"html_id":"demo-absstab-advection","remote":true,"url":"/absstab-advection","dataUrl":"/absstab-advection.json","key":"lorOxw7C71"}],"key":"CNZLfLKS6b"},{"type":"paragraph","position":{"start":{"line":285,"column":1},"end":{"line":285,"column":1}},"children":[{"type":"text","value":"For ","position":{"start":{"line":285,"column":1},"end":{"line":285,"column":1}},"key":"ypFeblPHC1"},{"type":"inlineMath","value":"c=1","position":{"start":{"line":285,"column":1},"end":{"line":285,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>c</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">c=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">c</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"ZKO5Xe4Oh4"},{"type":"text","value":" we get purely imaginary eigenvalues.","position":{"start":{"line":285,"column":1},"end":{"line":285,"column":1}},"key":"jenfHJOwFL"}],"key":"e07Zz8jVxo"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"using Plots\nx, Dₓ = FNC.diffper(40, [0, 1])\nλ = eigvals(Dₓ);\nscatter(real(λ), imag(λ);\n    aspect_ratio = 1,  frame=:zerolines,\n    xlabel=\"Re λ\",  ylabel=\"Im λ\", \n    title=\"Eigenvalues for pure advection\",  legend=:none)","visibility":"hide","key":"zKAoOpkoTe"},{"type":"output","id":"-IVjOe3w9dBtlSpR7kc6d","data":[{"output_type":"execute_result","execution_count":25,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"c357fdfd2deaf43c59f0ccf2bf43bae2","path":"/fnc/build/c357fdfd2deaf43c59f0ccf2bf43bae2.png"},"text/html":{"content_type":"text/html","hash":"5058e4477f31e8ae71041bfc8afff2e8","path":"/fnc/build/5058e4477f31e8ae71041bfc8afff2e8.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"e3d05e7706447b1ec02e308aeb8f755a","path":"/fnc/build/e3d05e7706447b1ec02e308aeb8f755a.svg"}}}],"visibility":"show","key":"Qf3QjGiCfh"}],"data":{"tags":[]},"visibility":"show","key":"Xq6n4koKX5"},{"type":"paragraph","position":{"start":{"line":298,"column":1},"end":{"line":298,"column":1}},"children":[{"type":"text","value":"Let’s choose a time step of ","position":{"start":{"line":298,"column":1},"end":{"line":298,"column":1}},"key":"fiagoWPQ1p"},{"type":"inlineMath","value":"\\tau=0.1","position":{"start":{"line":298,"column":1},"end":{"line":298,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>τ</mi><mo>=</mo><mn>0.1</mn></mrow><annotation encoding=\"application/x-tex\">\\tau=0.1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.1132em;\">τ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0.1</span></span></span></span>","key":"DPe6IrDcEV"},{"type":"text","value":" and compare to the stability regions of the Euler and backward Euler time steppers (shown as shaded regions):","position":{"start":{"line":298,"column":1},"end":{"line":298,"column":1}},"key":"Siwv2UrecB"}],"key":"oeQspoXhk6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"zc = @. cispi(2 * (0:360) / 360);     # points on |z|=1\nz = zc .- 1;                          # shift left by 1\nplot(Shape(real(z), imag(z)), color=RGB(.8, .8, 1))\nζ = 0.1 * λ\nscatter!(real(ζ), imag(ζ);\n    aspect_ratio=1,  frame=:zerolines,\n    xaxis=(\"Re ζ\", [-5, 5]),  yaxis=(\"Im ζ\", [-5, 5]),\n    title=\"Euler for advection\")","visibility":"hide","key":"sG1Tw2Ltls"},{"type":"output","id":"P-rF-bkdOnFGXtQ_tSRrJ","data":[{"output_type":"execute_result","execution_count":26,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"5b551d1f5d425ba03cfd6cc22bc6f2fb","path":"/fnc/build/5b551d1f5d425ba03cfd6cc22bc6f2fb.png"},"text/html":{"content_type":"text/html","hash":"95b2506615719eca8e4abeb6e628ee15","path":"/fnc/build/95b2506615719eca8e4abeb6e628ee15.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"95191c860cb4c5d3ccd14178d38d16d3","path":"/fnc/build/95191c860cb4c5d3ccd14178d38d16d3.svg"}}}],"visibility":"show","key":"jpDS2pbj4S"}],"data":{"tags":[]},"visibility":"show","key":"bM9K4qcmnL"},{"type":"paragraph","position":{"start":{"line":312,"column":1},"end":{"line":312,"column":1}},"children":[{"type":"text","value":"In the Euler case it’s clear that ","position":{"start":{"line":312,"column":1},"end":{"line":312,"column":1}},"key":"AvVzlISJXO"},{"type":"emphasis","position":{"start":{"line":312,"column":1},"end":{"line":312,"column":1}},"children":[{"type":"text","value":"no","position":{"start":{"line":312,"column":1},"end":{"line":312,"column":1}},"key":"qQB7440PSF"}],"key":"WqndLXgH2f"},{"type":"text","value":" real value of ","position":{"start":{"line":312,"column":1},"end":{"line":312,"column":1}},"key":"nQGpFNj1XT"},{"type":"inlineMath","value":"\\tau>0","position":{"start":{"line":312,"column":1},"end":{"line":312,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>τ</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">\\tau&gt;0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.1132em;\">τ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&gt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"e6bVHyKNoo"},{"type":"text","value":" is going to make ","position":{"start":{"line":312,"column":1},"end":{"line":312,"column":1}},"key":"S0oykzOmMb"},{"type":"text","value":"ζ","position":{"start":{"line":312,"column":1},"end":{"line":312,"column":1}},"key":"UYYO6QCzzq"},{"type":"text","value":" values fit within the stability region. Any method whose stability region includes none of the imaginary axis is an unsuitable choice for advection.","position":{"start":{"line":312,"column":1},"end":{"line":312,"column":1}},"key":"leU3K5Xwnw"}],"key":"MmOEdusUdt"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"z = zc .+ 1;                        # shift circle right by 1\nplot(Shape([-6, 6, 6, -6], [-6, -6, 6, 6]), color=RGB(.8, .8, 1))\nplot!(Shape(real(z), imag(z)), color=:white)\nscatter!(real(ζ), imag(ζ);\n    aspect_ratio=1,  frame=:zerolines,\n    xaxis=(\"Re ζ\", [-5, 5]),  yaxis=(\"Im ζ\", [-5, 5]),\n    title=\"Backward Euler for advection\")","visibility":"hide","key":"EVH2qjkNUt"},{"type":"output","id":"R75DVE2dRFfXgITFubssO","data":[{"output_type":"execute_result","execution_count":27,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"83e4bb088ef7e7a300e319c20012e5e7","path":"/fnc/build/83e4bb088ef7e7a300e319c20012e5e7.png"},"text/html":{"content_type":"text/html","hash":"a85d527152dbf3d90c8dbe9f99fe06e4","path":"/fnc/build/a85d527152dbf3d90c8dbe9f99fe06e4.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"ccbb7a1c6e0003f7a761b2819e1361da","path":"/fnc/build/ccbb7a1c6e0003f7a761b2819e1361da.svg"}}}],"visibility":"show","key":"zq80VQhp8U"}],"data":{"tags":[]},"visibility":"show","key":"cMgQFzFtkU"},{"type":"paragraph","position":{"start":{"line":325,"column":1},"end":{"line":325,"column":1}},"children":[{"type":"text","value":"The A-stable backward Euler time stepping tells the exact opposite story: it will be absolutely stable for any choice of the time step ","position":{"start":{"line":325,"column":1},"end":{"line":325,"column":1}},"key":"mNAnFDFXgx"},{"type":"text","value":"τ","position":{"start":{"line":325,"column":1},"end":{"line":325,"column":1}},"key":"iYuzMs4EQM"},{"type":"text","value":".","position":{"start":{"line":325,"column":1},"end":{"line":325,"column":1}},"key":"rC8LQO2kVI"}],"key":"lxVzh60XaQ"}],"label":"demo-absstab-advection-julia","identifier":"demo-absstab-advection-julia","html_id":"demo-absstab-advection-julia","key":"t2PqWqhjJP"},{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-absstab-advdiff","label":"demo-absstab-advdiff","kind":"proof:example","position":{"start":{"line":329,"column":1},"end":{"line":329,"column":22}},"children":[{"type":"text","value":"Example ","key":"X7OkooCXOf"},{"type":"text","value":"12.3.2","key":"v28nKCEjR1"}],"template":"Example %s","enumerator":"12.3.2","resolved":true,"html_id":"demo-absstab-advdiff","remote":true,"url":"/absstab-advection","dataUrl":"/absstab-advection.json","key":"qEWLR2YGQM"}],"key":"Vl8NOo3ceR"},{"type":"paragraph","position":{"start":{"line":330,"column":1},"end":{"line":330,"column":1}},"children":[{"type":"text","value":"The eigenvalues of advection-diffusion are near-imaginary for ","position":{"start":{"line":330,"column":1},"end":{"line":330,"column":1}},"key":"SJOWYlBpdi"},{"type":"inlineMath","value":"\\epsilon\\approx 0","position":{"start":{"line":330,"column":1},"end":{"line":330,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ϵ</mi><mo>≈</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">\\epsilon\\approx 0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4831em;\"></span><span class=\"mord mathnormal\">ϵ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"WAPf7HnmHH"},{"type":"text","value":" and get closer to the negative real axis as ","position":{"start":{"line":330,"column":1},"end":{"line":330,"column":1}},"key":"aHwws7zPZK"},{"type":"text","value":"ε","position":{"start":{"line":330,"column":1},"end":{"line":330,"column":1}},"key":"plI2ZoVyWL"},{"type":"text","value":" increases.","position":{"start":{"line":330,"column":1},"end":{"line":330,"column":1}},"key":"jZR2IJBD8i"}],"key":"TTeVbFOga5"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"plt = plot(\n    legend=:topleft,\n    aspect_ratio=1,\n    xlabel=\"Re ζ\",  ylabel=\"Im ζ\",\n    title=\"Eigenvalues for advection-diffusion\")\nx, Dₓ, Dₓₓ = FNC.diffper(40, [0, 1]);\nfor ϵ in [0.001, 0.01, 0.05]\n    λ = eigvals(-Dₓ + ϵ*Dₓₓ)\n    scatter!(real(λ), imag(λ), m=:o, label=\"\\\\epsilon = $ϵ\")\nend\nplt","visibility":"hide","key":"TBI0gDtGWE"},{"type":"output","id":"trdjpxNDwjCgTIdrkwvJM","data":[{"output_type":"execute_result","execution_count":28,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"1520fc53fba698d621bc014dfabb0ea2","path":"/fnc/build/1520fc53fba698d621bc014dfabb0ea2.png"},"text/html":{"content_type":"text/html","hash":"ed9786ae6c10d37bdbd3de222f86381e","path":"/fnc/build/ed9786ae6c10d37bdbd3de222f86381e.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"49b05c43251011d600ec22adb027dd51","path":"/fnc/build/49b05c43251011d600ec22adb027dd51.svg"}}}],"visibility":"show","key":"mwMgTbizOm"}],"data":{"tags":[]},"visibility":"show","key":"eaYUgE3pAY"}],"label":"demo-absstab-advdiff-julia","identifier":"demo-absstab-advdiff-julia","html_id":"demo-absstab-advdiff-julia","key":"TrVi1LuL53"},{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-absstab-inflow","label":"demo-absstab-inflow","kind":"proof:example","position":{"start":{"line":349,"column":1},"end":{"line":349,"column":21}},"children":[{"type":"text","value":"Example ","key":"SkDEc2lMc3"},{"type":"text","value":"12.3.3","key":"QJz4v2asEm"}],"template":"Example %s","enumerator":"12.3.3","resolved":true,"html_id":"demo-absstab-inflow","remote":true,"url":"/absstab-advection","dataUrl":"/absstab-advection.json","key":"NiHVQ6UmsB"}],"key":"QmrncoEyzo"},{"type":"paragraph","position":{"start":{"line":350,"column":1},"end":{"line":350,"column":1}},"children":[{"type":"text","value":"Deleting the last row and column places all the eigenvalues of the discretization into the left half of the complex plane.","position":{"start":{"line":350,"column":1},"end":{"line":350,"column":1}},"key":"XtigMbiyIg"}],"key":"WDr2iQW1vg"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"x, Dₓ, _ = FNC.diffcheb(40, [0, 1])\nA = Dₓ[1:end-1, 1:end-1];     # delete last row and column\nλ = eigvals(A);","key":"vDX9PoeDte"},{"type":"output","id":"1EAxcq_W9CaLqEfPmVFhQ","data":[],"key":"pwcDIVgF9O"}],"data":{},"key":"LyQ1hsqiMA"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"scatter(real(λ), imag(λ);\n    m=3,  aspect_ratio=1,\n    legend=:none,  frame=:zerolines,\n    xaxis=([-300, 100], \"Re λ\"),  yaxis=(\"Im λ\"),\n    title=\"Eigenvalues of advection with zero inflow\")","visibility":"hide","key":"cqHw4JkITL"},{"type":"output","id":"cCMaaYj2h3RazeGsmY_LJ","data":[{"output_type":"execute_result","execution_count":30,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"7db3214b712e3e4931fddd30cf15b55a","path":"/fnc/build/7db3214b712e3e4931fddd30cf15b55a.png"},"text/html":{"content_type":"text/html","hash":"c1d535d84a264344ca5c1f1f64fbac87","path":"/fnc/build/c1d535d84a264344ca5c1f1f64fbac87.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"95fb30b574369d6fcd7dabb3a2c6020c","path":"/fnc/build/95fb30b574369d6fcd7dabb3a2c6020c.svg"}}}],"visibility":"show","key":"ALX8dSh5KS"}],"data":{"tags":[]},"visibility":"show","key":"N8wPjIrLQn"},{"type":"paragraph","position":{"start":{"line":368,"column":1},"end":{"line":368,"column":1}},"children":[{"type":"text","value":"Note that the rightmost eigenvalues have real part at most","position":{"start":{"line":368,"column":1},"end":{"line":368,"column":1}},"key":"sgRH3382D8"}],"key":"kbIBLgO2Xg"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"maximum(real(λ))","key":"gCLeIQlPN6"},{"type":"output","id":"5_xeMI_GWum2KIzmoDjDL","data":[{"output_type":"execute_result","execution_count":31,"metadata":{},"data":{"text/plain":{"content":"-4.931967035822774","content_type":"text/plain"}}}],"key":"ZfC8IRE8Rx"}],"data":{},"key":"O4vZh4XXjB"},{"type":"paragraph","position":{"start":{"line":374,"column":1},"end":{"line":374,"column":1}},"children":[{"type":"text","value":"Consequently all solutions decay exponentially to zero as ","position":{"start":{"line":374,"column":1},"end":{"line":374,"column":1}},"key":"CPiZYweVkv"},{"type":"inlineMath","value":"t\\to\\infty","position":{"start":{"line":374,"column":1},"end":{"line":374,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi><mo>→</mo><mi mathvariant=\"normal\">∞</mi></mrow><annotation encoding=\"application/x-tex\">t\\to\\infty</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord\">∞</span></span></span></span>","key":"PDcODCc9q0"},{"type":"text","value":". This matches our observation of the solution: eventually, everything flows out of the domain.","position":{"start":{"line":374,"column":1},"end":{"line":374,"column":1}},"key":"aWsVGtfFGa"}],"key":"X8m0A3Pndm"}],"label":"demo-absstab-inflow-julia","identifier":"demo-absstab-inflow-julia","html_id":"demo-absstab-inflow-julia","key":"K2KrmoohzD"},{"type":"heading","depth":3,"position":{"start":{"line":378,"column":1},"end":{"line":378,"column":1}},"children":[{"type":"text","value":"12.4 ","position":{"start":{"line":378,"column":1},"end":{"line":378,"column":1}},"key":"GrBeEgjvBv"},{"type":"link","identifier":"section-advection-wave","label":"section-advection-wave","kind":"narrative","position":{"start":{"line":378,"column":6},"end":{"line":378,"column":29}},"url":"/wave","internal":true,"dataUrl":"/wave.json","children":[{"type":"text","value":"The wave equation","key":"wKgRwXVJwb"}],"key":"QmahQ0Dk2H"}],"identifier":"id-12-4","label":"12.4 ","html_id":"id-12-4","implicit":true,"key":"VsDrWEVrHZ"},{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-wave-boundaries","label":"demo-wave-boundaries","kind":"proof:example","position":{"start":{"line":381,"column":1},"end":{"line":381,"column":22}},"children":[{"type":"text","value":"Example ","key":"Sc3XWh2AOl"},{"type":"text","value":"12.4.1","key":"ryzdDn9r8l"}],"template":"Example %s","enumerator":"12.4.1","resolved":true,"html_id":"demo-wave-boundaries","remote":true,"url":"/wave","dataUrl":"/wave.json","key":"KDpV3PuRB2"}],"key":"fyBZbogxtq"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"m = 200\nx, Dₓ = FNC.diffcheb(m, [-1, 1]);","key":"aUIyUapHA5"},{"type":"output","id":"Z3KnMlT_wtXKLO5L5p2we","data":[],"key":"Ui8iceMum6"}],"data":{},"key":"iertP3Rzl3"},{"type":"paragraph","position":{"start":{"line":388,"column":1},"end":{"line":388,"column":1}},"children":[{"type":"text","value":"The boundary values of ","position":{"start":{"line":388,"column":1},"end":{"line":388,"column":1}},"key":"pJ6n2MMFAJ"},{"type":"inlineMath","value":"u","position":{"start":{"line":388,"column":1},"end":{"line":388,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span>","key":"RAR9ZU7Rw4"},{"type":"text","value":" are given to be zero, so they are not unknowns in the ","key":"qko2PguFr0"},{"type":"abbreviation","title":"ordinary differential equation","children":[{"type":"text","value":"ODE","key":"bZn7k3stXl"}],"key":"NJQpLy6lPi"},{"type":"text","value":"s. Instead they are added or removed as necessary.","key":"XCYDHkl6Kk"}],"key":"VlstfbUWP5"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"extend = v -> [0; v; 0]\nchop = u -> u[2:m];","key":"mzeJ3On3bB"},{"type":"output","id":"__n84JiDmZvmTN8LhPqiC","data":[],"key":"r0qKFyuBPZ"}],"data":{},"key":"wdcXdhrNUW"},{"type":"paragraph","position":{"start":{"line":395,"column":1},"end":{"line":395,"column":1}},"children":[{"type":"text","value":"The following function computes the time derivative of the system at interior points.","position":{"start":{"line":395,"column":1},"end":{"line":395,"column":1}},"key":"pNxQPptKv9"}],"key":"S1WLWCzH2v"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"ode = function(w, c, t)\n    u = extend(w[1:m-1])\n    z = w[m:2m]\n    du_dt = Dₓ * z\n    dz_dt = c^2 * (Dₓ * u)\n    return [ chop(du_dt); dz_dt ]\nend;","key":"duTo9ShyGL"},{"type":"output","id":"-KpIU95qZs35gUIRW3QsU","data":[],"key":"OZtJyU7Kg8"}],"data":{},"key":"v0hSdjFluo"},{"type":"paragraph","position":{"start":{"line":407,"column":1},"end":{"line":407,"column":1}},"children":[{"type":"text","value":"Our initial condition is a single hump for ","position":{"start":{"line":407,"column":1},"end":{"line":407,"column":1}},"key":"azkgUqw4K4"},{"type":"inlineMath","value":"u","position":{"start":{"line":407,"column":1},"end":{"line":407,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span>","key":"amYUF78z5G"},{"type":"text","value":".","position":{"start":{"line":407,"column":1},"end":{"line":407,"column":1}},"key":"Z2VVu0DD0o"}],"key":"Ghd01CykWs"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"u_init = @. exp( -100*(x + 0.5)^2 )\nz_init = -u_init\nw_init = [ chop(u_init); z_init ];","key":"Kb92Pqzhrr"},{"type":"output","id":"LAf4-a7FEktFf7IdKxXZ0","data":[],"key":"jWpx8l4hKI"}],"data":{},"key":"ymXTzz9bCz"},{"type":"paragraph","position":{"start":{"line":415,"column":1},"end":{"line":415,"column":1}},"children":[{"type":"text","value":"Because the wave equation is hyperbolic, we can use a nonstiff explicit solver.","position":{"start":{"line":415,"column":1},"end":{"line":415,"column":1}},"key":"auJKaiDqtv"}],"key":"h3iXKMIpEq"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"using OrdinaryDiffEq\nIVP = ODEProblem(ode, w_init ,(0., 2.), 2)\nw = solve(IVP, RK4());","key":"uTB9b83QcP"},{"type":"output","id":"hXBaMVuAC_EoO0bO6donR","data":[],"key":"bpD5xl03Vk"}],"data":{},"key":"pFHMhYOVuD"},{"type":"paragraph","position":{"start":{"line":423,"column":1},"end":{"line":423,"column":1}},"children":[{"type":"text","value":"We plot the results for the original ","position":{"start":{"line":423,"column":1},"end":{"line":423,"column":1}},"key":"f8lHfRj9kz"},{"type":"inlineMath","value":"u","position":{"start":{"line":423,"column":1},"end":{"line":423,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span>","key":"PYl4yDN1g0"},{"type":"text","value":" variable only. Its interior values are at indices ","position":{"start":{"line":423,"column":1},"end":{"line":423,"column":1}},"key":"o7Wv5kNIT2"},{"type":"inlineCode","value":"1:m-1","position":{"start":{"line":423,"column":1},"end":{"line":423,"column":1}},"key":"vMe49szrdr"},{"type":"text","value":" of the composite ","position":{"start":{"line":423,"column":1},"end":{"line":423,"column":1}},"key":"s71JxRVAF7"},{"type":"inlineMath","value":"\\mathbf{w}","position":{"start":{"line":423,"column":1},"end":{"line":423,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">w</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{w}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4444em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">w</span></span></span></span>","key":"U4a05eUMBW"},{"type":"text","value":" variable.","position":{"start":{"line":423,"column":1},"end":{"line":423,"column":1}},"key":"ifVnBeCtgM"}],"key":"S0vyoLg8UN"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"using Plots\nt = range(0, 2, 80)\nU = [extend(w(t)[1:m-1]) for t in t]\ncontour(x, t, hcat(U...)';\n    levels=24,\n    color=:redsblues,  clims=(-1, 1),\n    xlabel=L\"x\",  ylabel=L\"t\",\n    title=\"Wave equation\",  right_margin=3Plots.mm)","key":"xqgPwE58DB"},{"type":"output","id":"mBIsvwowP7lRX2bkn0W7T","data":[{"output_type":"execute_result","execution_count":37,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"2696b8ee721069072dcd739e4f62ebe9","path":"/fnc/build/2696b8ee721069072dcd739e4f62ebe9.png"},"text/html":{"content_type":"text/html","hash":"86549625bbbcc6ad219e76285ebe972c","path":"/fnc/build/86549625bbbcc6ad219e76285ebe972c.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"4cfbf6d0177bec3aa2aa1bd027aeedfc","path":"/fnc/build/4cfbf6d0177bec3aa2aa1bd027aeedfc.svg"}}}],"key":"xv1SZQSBFm"}],"data":{},"key":"XBX5jYEcUb"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"anim = @animate for t in range(0 ,2, 120)\n    plot(x, extend(w(t)[1:m-1]);\n        label=@sprintf(\"t=%.3f\",t),\n        xaxis=(L\"x\"),  yaxis=([-1, 1], L\"u(x,t)\"),\n        dpi=150,  title=\"Wave equation\")\nend\nmp4(anim, \"figures/wave-boundaries.mp4\")","visibility":"hide","key":"GjNudhkMIa"},{"type":"output","id":"h3jLa00to7s6tQqcfrn-v","data":[{"output_type":"stream","name":"stderr","text":"\u001b[36m\u001b[1m[ \u001b[22m\u001b[39m\u001b[36m\u001b[1mInfo: \u001b[22m\u001b[39mSaved animation to /Users/driscoll/Dropbox/Mac/Documents/GitHub/fnc/julia/figures/wave-boundaries.mp4\n"},{"output_type":"execute_result","execution_count":38,"metadata":{},"data":{"text/plain":{"content":"Plots.AnimatedGif(\"/Users/driscoll/Dropbox/Mac/Documents/GitHub/fnc/julia/figures/wave-boundaries.mp4\")","content_type":"text/plain"},"text/html":{"content_type":"text/html","hash":"0faa4a250f8c6ad949c5b0b3a5a77d64","path":"/fnc/build/0faa4a250f8c6ad949c5b0b3a5a77d64.html"}}}],"visibility":"show","key":"jEFX69jpsT"}],"data":{"tags":[]},"visibility":"show","key":"lVbLnMDugz"},{"type":"paragraph","position":{"start":{"line":447,"column":1},"end":{"line":447,"column":1}},"children":[{"type":"text","value":"The original hump breaks into two pieces of different amplitudes, each traveling with speed ","position":{"start":{"line":447,"column":1},"end":{"line":447,"column":1}},"key":"uaqXaE2yvY"},{"type":"inlineMath","value":"c=2","position":{"start":{"line":447,"column":1},"end":{"line":447,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>c</mi><mo>=</mo><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">c=2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">c</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span></span></span></span>","key":"OiGq74vmpx"},{"type":"text","value":". They pass through one another without interference. When a hump encounters a boundary, it is perfectly reflected, but with inverted shape. At time ","position":{"start":{"line":447,"column":1},"end":{"line":447,"column":1}},"key":"bfrxrDpItk"},{"type":"inlineMath","value":"t=2","position":{"start":{"line":447,"column":1},"end":{"line":447,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi><mo>=</mo><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">t=2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span></span></span></span>","key":"yY9BUyzUG5"},{"type":"text","value":", the solution looks just like the initial condition.","position":{"start":{"line":447,"column":1},"end":{"line":447,"column":1}},"key":"jA5Ogs0Uyz"}],"key":"mV9WJv6CD9"}],"label":"demo-wave-boundaries-julia","identifier":"demo-wave-boundaries-julia","html_id":"demo-wave-boundaries-julia","key":"OOwToMpdIk"},{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-wave-speed","label":"demo-wave-speed","kind":"proof:example","position":{"start":{"line":452,"column":1},"end":{"line":452,"column":17}},"children":[{"type":"text","value":"Example ","key":"w1m7A7DXME"},{"type":"text","value":"12.4.2","key":"OBEvjHv9CZ"}],"template":"Example %s","enumerator":"12.4.2","resolved":true,"html_id":"demo-wave-speed","remote":true,"url":"/wave","dataUrl":"/wave.json","key":"SGcXOiTIWp"}],"key":"DpXpBXvZ7P"},{"type":"paragraph","position":{"start":{"line":453,"column":1},"end":{"line":453,"column":1}},"children":[{"type":"text","value":"The ","key":"Cxg6xAy5RE"},{"type":"abbreviation","title":"ordinary differential equation","children":[{"type":"text","value":"ODE","key":"J7D6PQBy9o"}],"key":"w6Bf2T4t0A"},{"type":"text","value":" implementation has to change slightly.","key":"OSH7TQmi0Z"}],"key":"pzeQj5PULQ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"ode = function(w,c,t)\n    u = extend(w[1:m-1])\n    z = w[m:2m]\n    du_dt = Dₓ*z\n    dz_dt = c.^2 .* (Dₓ*u)\n    return [ chop(du_dt); dz_dt ]\nend;","key":"JnSGhobZwC"},{"type":"output","id":"nMQUhOKNeo1nELaFkcdeS","data":[],"key":"cx8mDhRQBg"}],"data":{},"key":"ZOaPRLL8rn"},{"type":"paragraph","position":{"start":{"line":465,"column":1},"end":{"line":465,"column":1}},"children":[{"type":"text","value":"The variable wave speed is passed as an extra parameter through the ","key":"IeFWddWK2b"},{"type":"abbreviation","title":"initial-value problem","children":[{"type":"text","value":"IVP","key":"AfbztqjB57"}],"key":"gNHwN642pM"},{"type":"text","value":" solver.","key":"YHkltOuHQv"}],"key":"zKqwRux3rT"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"c = @. 1 + (sign(x)+1)/2\nIVP = ODEProblem(ode, w_init, (0., 5.), c)\nw = solve(IVP, RK4());","key":"TQpcKIOpka"},{"type":"output","id":"pRfkZNZyTuNSR_p4XwLsr","data":[],"key":"sJksgguqkI"}],"data":{},"key":"G2ug4oAwDM"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"t = range(0, 5, 80)\nU = [extend(w(t)[1:m-1]) for t in t]\ncontour(x, t, hcat(U...)';\n    color=:redsblues,  clims=(-1,1),\n    levels=24,\n    xlabel=L\"x\",  ylabel=L\"t\",\n    title=\"Wave equation\",\n    right_margin=3Plots.mm\n    )","key":"WN2oreZIE4"},{"type":"output","id":"NPAz3jn2i_VYCBg3yM3lM","data":[{"output_type":"execute_result","execution_count":41,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"a598559cd3c7d950cda10aff7ae1171b","path":"/fnc/build/a598559cd3c7d950cda10aff7ae1171b.png"},"text/html":{"content_type":"text/html","hash":"a2ebeb37ab7339e8b4b2aa76cfed3f5d","path":"/fnc/build/a2ebeb37ab7339e8b4b2aa76cfed3f5d.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"ff6dc794f9325d84d5ff6c61e3e30483","path":"/fnc/build/ff6dc794f9325d84d5ff6c61e3e30483.svg"}}}],"key":"QFvfvBBv9O"}],"data":{},"key":"kwJsDPmiR7"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"anim = @animate for t in range(0,5,181)\n    plot(Shape([-1, 0, 0, -1], [-1, -1, 1, 1]), color=RGB(.8, .8, .8), l=0, label=\"\")\n    plot!(x, extend(w(t, idxs=1:m-1));\n        label=@sprintf(\"t=%.2f\", t), \n        xaxis=(L\"x\"),  yaxis=([-1, 1], L\"u(x,t)\"),\n        dpi=150,  title=\"Wave equation, variable speed\")\nend\nmp4(anim, \"figures/wave-speed.mp4\")","visibility":"hide","key":"qjF1F2D9bz"},{"type":"output","id":"wznWFuYaa7fbuTZsoJp8q","data":[{"output_type":"stream","name":"stderr","text":"\u001b[36m\u001b[1m[ \u001b[22m\u001b[39m\u001b[36m\u001b[1mInfo: \u001b[22m\u001b[39mSaved animation to /Users/driscoll/Dropbox/Mac/Documents/GitHub/fnc/julia/figures/wave-speed.mp4\n"},{"output_type":"execute_result","execution_count":42,"metadata":{},"data":{"text/plain":{"content":"Plots.AnimatedGif(\"/Users/driscoll/Dropbox/Mac/Documents/GitHub/fnc/julia/figures/wave-speed.mp4\")","content_type":"text/plain"},"text/html":{"content_type":"text/html","hash":"82b4de29af1675350c9503e441b8f79f","path":"/fnc/build/82b4de29af1675350c9503e441b8f79f.html"}}}],"visibility":"show","key":"zQ82n0aA2l"}],"data":{"tags":[]},"visibility":"show","key":"Rvi2DL3Ts6"},{"type":"paragraph","position":{"start":{"line":497,"column":1},"end":{"line":497,"column":1}},"children":[{"type":"text","value":"Each pass through the interface at ","position":{"start":{"line":497,"column":1},"end":{"line":497,"column":1}},"key":"YzwtjFNUoc"},{"type":"inlineMath","value":"x=0","position":{"start":{"line":497,"column":1},"end":{"line":497,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">x=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"j7Nx3LIamt"},{"type":"text","value":" generates a reflected and transmitted wave. By conservation of energy, these are both smaller in amplitude than the incoming bump.","position":{"start":{"line":497,"column":1},"end":{"line":497,"column":1}},"key":"ZHjGwIMyUR"}],"key":"G8m2XR5tXR"}],"label":"demo-wave-speed-julia","identifier":"demo-wave-speed-julia","html_id":"demo-wave-speed-julia","key":"qNIz19XRpH"}],"key":"kVbpn00a2r"}],"key":"l7SiyqaNIs"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Chapter 11","url":"/chapter11","group":"Julia codes"},"next":{"title":"Chapter 13","url":"/chapter13","group":"Julia codes"}}},"domain":"http://localhost:3000"}