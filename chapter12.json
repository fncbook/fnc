{"kind":"Notebook","sha256":"2aa8dbd5895280cc51a1dcc90851cbdbc06c015b369089b8132d254dfea4e060","slug":"chapter12","location":"/julia/chapter12.md","dependencies":[],"frontmatter":{"title":"Chapter 12","numbering":{"heading_1":{"enabled":false},"heading_2":{"enabled":false},"heading_3":{"enabled":false},"heading_4":{"enabled":false},"heading_5":{"enabled":false},"heading_6":{"enabled":false}},"kernelspec":{"name":"julia-1.11","display_name":"Julia 1","language":"julia"},"content_includes_title":false,"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"exports":[{"format":"md","filename":"chapter12.md","url":"/fnc/build/chapter12-ceb2d651bb7ff81748f0ac24d2d2a6ab.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Examples","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"U71WSidoEX"}],"identifier":"examples","label":"Examples","html_id":"examples","implicit":true,"key":"HVxC4WaWlC"}],"key":"NedSzINor0"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"include(\"FNC_init.jl\")","visibility":"show","key":"LrRDn9H6Jw"},{"type":"output","id":"wvRv5MWk3RpJY1PzoB7-v","data":[{"output_type":"stream","name":"stderr","text":"\u001b[32m\u001b[1m  Activating\u001b[22m\u001b[39m "},{"output_type":"stream","name":"stderr","text":"project at `~/Documents/GitHub/fnc`\n"}],"visibility":"remove","key":"GLh7bfYhiV"}],"data":{"tags":[]},"visibility":"show","key":"rXqeXLbium"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"12.1 ","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"hMtwweVJeh"},{"type":"link","identifier":"section-advection-traffic","label":"section-advection-traffic","kind":"narrative","position":{"start":{"line":18,"column":6},"end":{"line":18,"column":32}},"url":"/traffic","internal":true,"dataUrl":"/traffic.json","children":[{"type":"text","value":"Traffic flow","key":"P7I5HoRw5q"}],"key":"BYskB2bZgK"}],"identifier":"id-12-1","label":"12.1 ","html_id":"id-12-1","implicit":true,"key":"GLawLzPygF"},{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-traffic-advection","label":"demo-traffic-advection","kind":"proof:example","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":24}},"children":[{"type":"text","value":"Example ","key":"eiqD9DkqVG"},{"type":"text","value":"12.1.1","key":"lvAF1q1kIS"}],"template":"Example %s","enumerator":"12.1.1","resolved":true,"html_id":"demo-traffic-advection","remote":true,"url":"/traffic","dataUrl":"/traffic.json","key":"nzYrgecDLE"}],"key":"GgMp7JLvld"},{"type":"paragraph","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"text","value":"In the following definition we allow the velocity ","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"ttMhafjpxX"},{"type":"inlineMath","value":"c","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>c</mi></mrow><annotation encoding=\"application/x-tex\">c</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">c</span></span></span></span>","key":"ET63UlpfBf"},{"type":"text","value":" to be specified as a parameter in the ","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"mRZkPQf1RW"},{"type":"inlineCode","value":"ODEProblem","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"uxMdOlOBOB"},{"type":"text","value":".","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"A3zcKbTSSu"}],"key":"ngLsA59e8y"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"x, Dₓ, Dₓₓ = FNC.diffper(300, [-4, 4]);\nf = (u, c, t) -> -c * (Dₓ*u);","key":"FjGR3MbtgK"},{"type":"output","id":"YEBIZQnFbt_YBd_GizvMw","data":[],"key":"RrRMJAfAwy"}],"data":{},"key":"Gqs8ogI5hh"},{"type":"paragraph","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"children":[{"type":"text","value":"The following initial condition isn’t mathematically periodic, but the deviation is less than machine precision. We specify RK4 as the solver.","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"PDMdi8qLSS"}],"key":"IN5QlkJPCU"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"using OrdinaryDiffEq\nu_init = @. 1 + exp( -3x^2 )\nIVP = ODEProblem(f, u_init, (0., 4.), 2)\nsol = solve(IVP, RK4());","key":"Z0mwq5LIsa"},{"type":"output","id":"HFJmBtAPmwIxU9dz7Q1wR","data":[],"key":"zzY99EeKlC"}],"data":{},"key":"vUdWSz1u7G"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"using Plots\nplt = plot(\n    legend=:bottomleft,\n    title=\"Advection with periodic boundary\",\n    xaxis=(L\"x\"),  yaxis=(L\"u(x,t)\"))\nfor t in (0:4) * 2/3\n    plot!(x, sol(t), label=@sprintf(\"t=%.1f\", t))\nend\nplt","visibility":"hide","key":"H0G7ZJ4Fyv"},{"type":"output","id":"VbeLI3_uxPO9cpspSX-wE","data":[{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"3f0a22fd72789354fa8b05c10c3037ad","path":"/fnc/build/3f0a22fd72789354fa8b05c10c3037ad.png"},"text/html":{"content_type":"text/html","hash":"1b02ae9f59c0c9fa0596858d06b10372","path":"/fnc/build/1b02ae9f59c0c9fa0596858d06b10372.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"7d55ce1d03724868dcbd2ed27850ecb9","path":"/fnc/build/7d55ce1d03724868dcbd2ed27850ecb9.svg"}}}],"visibility":"show","key":"I581NzDqoN"}],"data":{"tags":[]},"visibility":"show","key":"s0ctGABmio"},{"type":"paragraph","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"children":[{"type":"text","value":"An animation shows the solution nicely. The bump moves with speed 2 to the right, reentering on the left as it exits to the right because of the periodic conditions.","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"key":"f5kYn1Pe0v"}],"key":"ZRzvzf53G0"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"anim = @animate for t in range(0, 4, 120) \n    plot(x, sol(t),\n        title=@sprintf(\"Advection equation, t = %.2f\", t),\n        xaxis=(L\"x\"),  yaxis=([1, 2], L\"u(x,t)\"),\n        dpi=150)\nend\nmp4(anim, \"figures/advection.mp4\")","visibility":"hide","key":"JaExcVKL3J"},{"type":"output","id":"tFHCgueDoOKn5Dwnpl4iQ","data":[{"output_type":"stream","name":"stderr","text":"\u001b[36m\u001b[1m[ \u001b[22m\u001b[39m\u001b[36m\u001b[1mInfo: \u001b[22m\u001b[39mSaved animation to /Users/driscoll/Dropbox/Mac/Documents/GitHub/fnc/julia/figures/advection.mp4\n"},{"output_type":"execute_result","execution_count":5,"metadata":{},"data":{"text/plain":{"content":"Plots.AnimatedGif(\"/Users/driscoll/Dropbox/Mac/Documents/GitHub/fnc/julia/figures/advection.mp4\")","content_type":"text/plain"},"text/html":{"content_type":"text/html","hash":"2aa36b0f116daf57a36937f6baad0023","path":"/fnc/build/2aa36b0f116daf57a36937f6baad0023.html"}}}],"visibility":"show","key":"nHPDEznJNy"}],"data":{"tags":[]},"visibility":"show","key":"STvme4qPt8"}],"label":"demo-traffic-advection-julia","identifier":"demo-traffic-advection-julia","html_id":"demo-traffic-advection-julia","key":"ghREMjVtHy"},{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-traffic-solve","label":"demo-traffic-solve","kind":"proof:example","position":{"start":{"line":68,"column":1},"end":{"line":68,"column":20}},"children":[{"type":"text","value":"Example ","key":"oKK3yx5fYI"},{"type":"text","value":"12.1.2","key":"U3ZVXMNnrJ"}],"template":"Example %s","enumerator":"12.1.2","resolved":true,"html_id":"demo-traffic-solve","remote":true,"url":"/traffic","dataUrl":"/traffic.json","key":"ssZM0I1zo7"}],"key":"lSf15DSQAz"},{"type":"paragraph","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"children":[{"type":"text","value":"The following are parameters and a function relevant to defining the problem.","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"key":"aRIv9MCGgY"}],"key":"K7gbVWGPTG"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"ρc = 1080;  ρm = 380;  q_m = 10000;\ndQ0 = ρ -> 4q_m * ρc^2 * (ρc-ρm) * ρm * (ρm-ρ) / (ρ*(ρc-2*ρm) + ρc*ρm)^3;","key":"RhgSznKSre"},{"type":"output","id":"NfNFzM3pCSt4Bc5wwBTd9","data":[],"key":"ll9d2qEdqh"}],"data":{},"key":"lDa8Vv9NF3"},{"type":"paragraph","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"children":[{"type":"text","value":"Here we create a discretization on ","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"key":"OcTKJ6xIQL"},{"type":"inlineMath","value":"m=800","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi><mo>=</mo><mn>800</mn></mrow><annotation encoding=\"application/x-tex\">m=800</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">800</span></span></span></span>","key":"FvdtOpn3jF"},{"type":"text","value":" points.","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"key":"gVdOG8swMO"}],"key":"uMU7Tjs7wk"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"x, Dₓ, Dₓₓ = FNC.diffper(800, [0, 4]);","key":"DkKaHBL3Rl"},{"type":"output","id":"oEOuoo3Aj8fLwhZieXZdq","data":[],"key":"ry7qJHWVCP"}],"data":{},"key":"yj6POcLFNO"},{"type":"paragraph","position":{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},"children":[{"type":"text","value":"Next we define the ","key":"JCG8YC8IVz"},{"type":"abbreviation","title":"ordinary differential equation","children":[{"type":"text","value":"ODE","key":"cVjcJs3NLj"}],"key":"EgNYh9CNtr"},{"type":"text","value":" resulting from the method of lines.","key":"Wa8x6hJLdP"}],"key":"WlLMtE6wZu"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"ode = (ρ, ϵ, t) -> -dQ0.(ρ) .* (Dₓ*ρ) + ϵ * (Dₓₓ*ρ);","key":"GMc0BZBAmr"},{"type":"output","id":"ONU20UR4qz5vVwo471r68","data":[],"key":"ROv7udEYTJ"}],"data":{},"key":"HsyCKR8Hj5"},{"type":"paragraph","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"children":[{"type":"text","value":"Our first initial condition has moderate density with a small bump. Because of the diffusion present, we use a stiff solver for the ","key":"HMwFRqhMOp"},{"type":"abbreviation","title":"initial-value problem","children":[{"type":"text","value":"IVP","key":"DJcyRK34ag"}],"key":"Hj3tYsPmPO"},{"type":"text","value":".","key":"dzu1mU5iCr"}],"key":"pt7PBNGnSK"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"ρ_init = @. 400 + 10 * exp( -20*(x-3)^2 )\nIVP = ODEProblem(ode, ρ_init, (0., 1.), 0.02)\nsol = solve(IVP, Rodas4P());","key":"Gh0hphxp1P"},{"type":"output","id":"MmhKcEW8mLSdUNx8s3-bk","data":[],"key":"bcTe1ZMVER"}],"data":{},"key":"PzcfFgyD5G"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"plt = plot(\n    legend=:topleft, \n    title=\"Traffic flow\",\n    xaxis=(L\"x\"),  yaxis=(\"car density\"))\nfor t in 0:0.2:1\n    plot!(x, sol(t), label=@sprintf(\"t=%.1f\", t))\nend\nplt","visibility":"hide","key":"xVzatOouHP"},{"type":"output","id":"p36Efsib6Np_rGrwM4S4A","data":[{"output_type":"execute_result","execution_count":10,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"7abd9c7be7bbcd6482ecf213933ba178","path":"/fnc/build/7abd9c7be7bbcd6482ecf213933ba178.png"},"text/html":{"content_type":"text/html","hash":"d481ab75285188c820276651f1c05bad","path":"/fnc/build/d481ab75285188c820276651f1c05bad.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"69ae299ecb678d243dbe733ca511fbb9","path":"/fnc/build/69ae299ecb678d243dbe733ca511fbb9.svg"}}}],"visibility":"show","key":"G5oGL13Sms"}],"data":{"tags":[]},"visibility":"show","key":"AfyRy8NWzv"},{"type":"paragraph","position":{"start":{"line":108,"column":1},"end":{"line":108,"column":1}},"children":[{"type":"text","value":"The bump slowly moves backward on the roadway, spreading out and gradually fading away due to the presence of diffusion.","position":{"start":{"line":108,"column":1},"end":{"line":108,"column":1}},"key":"Nvwm5QsUFs"}],"key":"BNJgjomcAE"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"anim = @animate for t in range(0,0.9,91) \n    plot(x, sol(t);\n        xaxis=(L\"x\"),  yaxis=([400,410], \"density\"),\n        dpi=150,  title=@sprintf(\"Traffic flow, t=%.2f\",t))\nend\nmp4(anim, \"figures/traffic-fade.mp4\")","visibility":"hide","key":"lb4XBfZdJn"},{"type":"output","id":"O9FpDcJNewjqi_F_cmjyW","data":[{"output_type":"stream","name":"stderr","text":"\u001b[36m\u001b[1m[ \u001b[22m\u001b[39m\u001b[36m\u001b[1mInfo: \u001b[22m\u001b[39mSaved animation to /Users/driscoll/Dropbox/Mac/Documents/GitHub/fnc/julia/figures/traffic-fade.mp4\n"},{"output_type":"execute_result","execution_count":11,"metadata":{},"data":{"text/plain":{"content":"Plots.AnimatedGif(\"/Users/driscoll/Dropbox/Mac/Documents/GitHub/fnc/julia/figures/traffic-fade.mp4\")","content_type":"text/plain"},"text/html":{"content_type":"text/html","hash":"04ba6f64d6095f98be3ec71671dfc10c","path":"/fnc/build/04ba6f64d6095f98be3ec71671dfc10c.html"}}}],"visibility":"show","key":"MWM3UIvoDu"}],"data":{"tags":[]},"visibility":"show","key":"Mn5WgEQSr5"},{"type":"paragraph","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"children":[{"type":"text","value":"Now we use an initial condition with a larger bump. Note that the scale on the ","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"key":"cThWAH2WJ9"},{"type":"inlineMath","value":"y","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>","key":"o3HyN23GRB"},{"type":"text","value":"-axis is much different for this solution.","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"key":"au9QI6OTwK"}],"key":"x5VpG2Qoya"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"ρ_init = @. 400 + 80 * exp( -16*(x - 3)^2 )\nIVP = ODEProblem(ode, ρ_init, (0., 0.5), 0.02)\nsol = solve(IVP, Rodas4P());","key":"s9f91MntWS"},{"type":"output","id":"ePDGNWIZ76_TGWzJYZizk","data":[],"key":"euhCQQAIth"}],"data":{},"key":"G54DKpi0M3"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"plt = plot(\n    legend=:topleft,\n    title=\"Traffic jam\",\n    xaxis=(L\"x\"),  yaxis=(\"car density\"))\nfor t in range(0, 5, 11)\n    plot!(x, sol(t), label=@sprintf(\"t=%.1f\", t))\nend\nplt","visibility":"hide","key":"cPCPJaQV0u"},{"type":"output","id":"2jnrym39T0eqlc2HcqD-R","data":[{"output_type":"execute_result","execution_count":13,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"e8924017baa87bc398f89b208d68819c","path":"/fnc/build/e8924017baa87bc398f89b208d68819c.png"},"text/html":{"content_type":"text/html","hash":"8e01a98f1f49d01c385f090fef31794c","path":"/fnc/build/8e01a98f1f49d01c385f090fef31794c.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"51e4eb2b49e42be0492c56c58f913496","path":"/fnc/build/51e4eb2b49e42be0492c56c58f913496.svg"}}}],"visibility":"show","key":"yTu8c06bXW"}],"data":{"tags":[]},"visibility":"show","key":"nSFciNaUot"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"anim = @animate for t in range(0, 0.5, 101) \n    plot(x, sol(t);\n        xaxis=(L\"x\"),  yaxis=([400,480], \"density\"),\n        dpi=150,  title=@sprintf(\"Traffic jam, t=%.2f\",t))\nend\nmp4(anim,\"figures/traffic-jam.mp4\")","visibility":"hide","key":"XXvHnle07f"},{"type":"output","id":"wAeksK4IOnGj4wrdKRs4L","data":[{"output_type":"stream","name":"stderr","text":"\u001b[36m\u001b[1m[ \u001b[22m\u001b[39m\u001b[36m\u001b[1mInfo: \u001b[22m\u001b[39mSaved animation to /Users/driscoll/Dropbox/Mac/Documents/GitHub/fnc/julia/figures/traffic-jam.mp4\n"},{"output_type":"execute_result","execution_count":14,"metadata":{},"data":{"text/plain":{"content":"Plots.AnimatedGif(\"/Users/driscoll/Dropbox/Mac/Documents/GitHub/fnc/julia/figures/traffic-jam.mp4\")","content_type":"text/plain"},"text/html":{"content_type":"text/html","hash":"5e6c0173dc440b6138780c5c63c24a23","path":"/fnc/build/5e6c0173dc440b6138780c5c63c24a23.html"}}}],"visibility":"show","key":"omaMm4XeTq"}],"data":{"tags":[]},"visibility":"show","key":"nc49MG3fLL"},{"type":"paragraph","position":{"start":{"line":150,"column":1},"end":{"line":150,"column":1}},"children":[{"type":"text","value":"In this case the density bump travels backward along the road. It also steepens on the side facing the incoming traffic and decreases much more slowly on the other side. A motorist would experience this as an abrupt increase in density, followed by a much more gradual decrease in density and resulting gradual increase in speed. (You also see some transient, high-frequency oscillations. These are caused by instabilities, as we discuss in simpler situations later in this chapter.)","position":{"start":{"line":150,"column":1},"end":{"line":150,"column":1}},"key":"Qa3qDH3itm"}],"key":"wt2JWLFrvU"}],"label":"demo-traffic-solve-julia","identifier":"demo-traffic-solve-julia","html_id":"demo-traffic-solve-julia","key":"VBe99djgF7"},{"type":"heading","depth":3,"position":{"start":{"line":154,"column":1},"end":{"line":154,"column":1}},"children":[{"type":"text","value":"12.2 ","position":{"start":{"line":154,"column":1},"end":{"line":154,"column":1}},"key":"deiSUA7Tih"},{"type":"link","identifier":"section-advection-upwind","label":"section-advection-upwind","kind":"narrative","position":{"start":{"line":154,"column":6},"end":{"line":154,"column":31}},"url":"/upwind","internal":true,"dataUrl":"/upwind.json","children":[{"type":"text","value":"Upwinding and stability","key":"SaB5p3j8Eg"}],"key":"lpIB4H4Arb"}],"identifier":"id-12-2","label":"12.2 ","html_id":"id-12-2","implicit":true,"key":"FO19hMDQRM"},{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-upwind-cfl","label":"demo-upwind-cfl","kind":"proof:example","position":{"start":{"line":157,"column":1},"end":{"line":157,"column":17}},"children":[{"type":"text","value":"Example ","key":"q9W1rCqulV"},{"type":"text","value":"12.2.3","key":"ZpE1Cs0IcY"}],"template":"Example %s","enumerator":"12.2.3","resolved":true,"html_id":"demo-upwind-cfl","remote":true,"url":"/upwind","dataUrl":"/upwind.json","key":"SRezxgAdBK"}],"key":"pAaKN6e7B5"},{"type":"paragraph","position":{"start":{"line":158,"column":1},"end":{"line":158,"column":1}},"children":[{"type":"text","value":"For time stepping, we use the adaptive explicit method ","position":{"start":{"line":158,"column":1},"end":{"line":158,"column":1}},"key":"QUBf3vPZK1"},{"type":"inlineCode","value":"RK4","position":{"start":{"line":158,"column":1},"end":{"line":158,"column":1}},"key":"KBdLdvAxYN"},{"type":"text","value":".","position":{"start":{"line":158,"column":1},"end":{"line":158,"column":1}},"key":"Ux4u6jzBUx"}],"key":"MCoUTcMoZY"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"using OrdinaryDiffEq\nm = 400;\nx, Dₓ = FNC.diffper(m, [0, 1])\nu_init = x -> exp( -80 * (x - 0.5)^2 )\node = (u, c, t) -> -c * (Dₓ*u)\nIVP = ODEProblem(ode, u_init.(x), (0., 2.), 2.)\nu = solve(IVP, RK4());","key":"yoSsJK9Jqt"},{"type":"output","id":"CAN_2InVDRUagEF6kew2M","data":[],"key":"lLv61Bp9Eq"}],"data":{},"key":"dGga2cXHfP"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"using Plots\nt = range(0, 2, 81);\nU = reduce(hcat, u(t) for t in t)\ncontour(x, t, U'; \n    color=:redsblues,  clims=(-1, 1),\n    xaxis=(L\"x\"),  yaxis=(L\"t\"),\n    title=\"Linear advection\",  right_margin=3Plots.mm)","visibility":"hide","key":"Qqg17mQ9ID"},{"type":"output","id":"Ilyl5OgZHGM68kemett4T","data":[{"output_type":"execute_result","execution_count":16,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"5265900b137297ac6f67467b0300043d","path":"/fnc/build/5265900b137297ac6f67467b0300043d.png"},"text/html":{"content_type":"text/html","hash":"3c16e256712b42a38e658259fc164c32","path":"/fnc/build/3c16e256712b42a38e658259fc164c32.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"b5315e4c17854373fa50a5e7b7c63fee","path":"/fnc/build/b5315e4c17854373fa50a5e7b7c63fee.svg"}}}],"visibility":"show","key":"PGMv8DDuc7"}],"data":{"tags":[]},"visibility":"show","key":"FWyVWwt5IH"},{"type":"paragraph","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"children":[{"type":"text","value":"In the space-time plot above, you can see the initial hump traveling rightward at constant speed. It fully traverses the domain once for each integer multiple of ","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"key":"Zie2C1nsdi"},{"type":"inlineMath","value":"t=1/2","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi><mo>=</mo><mn>1</mn><mi mathvariant=\"normal\">/</mi><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">t=1/2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1/2</span></span></span></span>","key":"HgDBTceEtD"},{"type":"text","value":".","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"key":"fCsTDTcaKw"}],"key":"cpuYobnUyv"},{"type":"paragraph","position":{"start":{"line":183,"column":1},"end":{"line":183,"column":1}},"children":[{"type":"text","value":"If we cut ","position":{"start":{"line":183,"column":1},"end":{"line":183,"column":1}},"key":"KTUpivnyJw"},{"type":"inlineMath","value":"h","position":{"start":{"line":183,"column":1},"end":{"line":183,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>h</mi></mrow><annotation encoding=\"application/x-tex\">h</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">h</span></span></span></span>","key":"lbSi4ML7iy"},{"type":"text","value":" by a factor of 2 (i.e., double ","position":{"start":{"line":183,"column":1},"end":{"line":183,"column":1}},"key":"ox4HzhcvEu"},{"type":"inlineMath","value":"m","position":{"start":{"line":183,"column":1},"end":{"line":183,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi></mrow><annotation encoding=\"application/x-tex\">m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">m</span></span></span></span>","key":"LXMZ7T05jr"},{"type":"text","value":"), then the CFL condition suggests that the time step should be cut by a factor of 2 also.","position":{"start":{"line":183,"column":1},"end":{"line":183,"column":1}},"key":"j5TCzZS2M7"}],"key":"eexH4csCrf"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"println(\"Number of time steps for m = 400: $(length(u.t))\")\n\nm = 800;\nx, Dₓ = FNC.diffper(m, [0, 1])\nIVP = ODEProblem(ode, u_init.(x), (0., 2.), 2.)\nu = solve(IVP, RK4())\nprintln(\"Number of time steps for m = 800: $(length(u.t))\")","key":"usdNSRv7dz"},{"type":"output","id":"5sg7OHkkVkLz5O3UR82r7","data":[{"output_type":"stream","name":"stdout","text":"Number of time steps for m = 400: 565\nNumber of time steps for m = 800: 1128\n"}],"key":"AmUU2uACQx"}],"data":{},"key":"CTIH0OdA6H"}],"label":"demo-upwind-cfl-julia","identifier":"demo-upwind-cfl-julia","html_id":"demo-upwind-cfl-julia","key":"kFDtrrPMp2"},{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-upwind-direction","label":"demo-upwind-direction","kind":"proof:example","position":{"start":{"line":197,"column":1},"end":{"line":197,"column":23}},"children":[{"type":"text","value":"Example ","key":"mr42FZRrXL"},{"type":"text","value":"12.2.6","key":"KjiNnZtZ0S"}],"template":"Example %s","enumerator":"12.2.6","resolved":true,"html_id":"demo-upwind-direction","remote":true,"url":"/upwind","dataUrl":"/upwind.json","key":"pYUPHRyEFq"}],"key":"MLaQwsGQuI"},{"type":"paragraph","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"children":[{"type":"text","value":"If we solve advection over ","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"key":"h5E6XFtpMJ"},{"type":"inlineMath","value":"[0,1]","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mn>0</mn><mo separator=\"true\">,</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[0,1]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]</span></span></span></span>","key":"ooQrZgU8v3"},{"type":"text","value":" with velocity ","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"key":"Ta0xiC2yIz"},{"type":"inlineMath","value":"c=-1","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>c</mi><mo>=</mo><mo>−</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">c=-1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">c</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">−</span><span class=\"mord\">1</span></span></span></span>","key":"tohB6vHCnX"},{"type":"text","value":", the right boundary is in the upwind/inflow direction. Thus a well-posed boundary condition is ","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"key":"tVXVS1TwMm"},{"type":"inlineMath","value":"u(1,t)=0","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo stretchy=\"false\">(</mo><mn>1</mn><mo separator=\"true\">,</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">u(1,t)=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"EXxqtx9irn"},{"type":"text","value":".","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"key":"CoALVTM2DZ"}],"key":"ncsyZfjKYc"},{"type":"paragraph","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"children":[{"type":"text","value":"We’ll pattern a solution after ","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"key":"OTvaQKU9Q3"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-parabolic","label":"function-parabolic","children":[{"type":"text","value":"Function ","key":"rFbDZp1ZQq"},{"type":"text","value":"11.5.2","key":"kypJ5C1LMz"}],"template":"Algorithm %s","enumerator":"11.5.2","resolved":true,"html_id":"function-parabolic","remote":true,"url":"/boundaries","dataUrl":"/boundaries.json","key":"htP9NkufCK"},{"type":"text","value":". Since ","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"key":"QoxZAtVmyi"},{"type":"inlineMath","value":"u(x_m,t)=0","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>m</mi></msub><mo separator=\"true\">,</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">u(x_m,t)=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"B6pOsXCU7u"},{"type":"text","value":", we define the ","key":"fTAFOoLqvV"},{"type":"abbreviation","title":"ordinary differential equation","children":[{"type":"text","value":"ODE","key":"lADVgJdHGe"}],"key":"PSeSOO2n4c"},{"type":"text","value":" interior problem ","key":"FSkBoLCLC5"},{"type":"crossReference","kind":"equation","identifier":"mol-interior","label":"mol-interior","children":[{"type":"text","value":"(","key":"CUGIPREIL6"},{"type":"text","value":"11.5.4","key":"mlGX8de8Bs"},{"type":"text","value":")","key":"aukm2LwonM"}],"template":"(%s)","enumerator":"11.5.4","resolved":true,"html_id":"mol-interior","remote":true,"url":"/boundaries","dataUrl":"/boundaries.json","key":"jeo5I3brE9"},{"type":"text","value":" for ","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"key":"Oq0DuhJlfx"},{"type":"inlineMath","value":"\\mathbf{v}","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">v</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{v}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4444em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">v</span></span></span></span>","key":"pBwgX0gh09"},{"type":"text","value":" without ","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"key":"MeDW2UBrCp"},{"type":"inlineMath","value":"u_m","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>u</mi><mi>m</mi></msub></mrow><annotation encoding=\"application/x-tex\">u_m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"NtPuwE0tUW"},{"type":"text","value":". For each evaluation of ","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"key":"o3AIL6s5sS"},{"type":"inlineMath","value":"\\mathbf{v}'","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi mathvariant=\"bold\">v</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup></mrow><annotation encoding=\"application/x-tex\">\\mathbf{v}&#x27;</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span></span></span></span>","key":"oZoB6ipWLA"},{"type":"text","value":", we must extend the data back to ","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"key":"HWs5QhpLoz"},{"type":"inlineMath","value":"x_m","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mi>m</mi></msub></mrow><annotation encoding=\"application/x-tex\">x_m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"Gh7hoRpXMW"},{"type":"text","value":" first.","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"key":"YFBOZVzyAl"}],"key":"kFc10IBdUq"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"m = 100\nx, Dₓ = FNC.diffmat2(m, [0, 1])\n\ninterior = 1:m\nextend = v -> [v; 0]\n\nfunction ode!(f, v, c, t)\n    u = extend(v)\n    uₓ = Dₓ * u\n    @. f = -c * uₓ[interior]\nend;","key":"nEsqVjKqwe"},{"type":"output","id":"8A5EBiUyjWaUcKa1MK7aQ","data":[],"key":"IDCZcFPxb3"}],"data":{},"key":"hPVseyTbEF"},{"type":"paragraph","position":{"start":{"line":216,"column":1},"end":{"line":216,"column":1}},"children":[{"type":"text","value":"Now we solve for an initial condition that has a single hump.","position":{"start":{"line":216,"column":1},"end":{"line":216,"column":1}},"key":"d9fpfZIZm1"}],"key":"ETYotFGVWo"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"init = @. exp( -80*(x[interior] - 0.5)^2 )\nivp = ODEProblem(ode!, init, (0., 1), -1)\nu = solve(ivp);","key":"MTF46kgjaI"},{"type":"output","id":"RWQLESIYjwqBJxgWtq8vf","data":[],"key":"A3OFFSUZD8"}],"data":{},"key":"B9Vpl49bwG"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"t = range(0, 0.75, 80)\nU = reduce(hcat, extend(u(t)) for t in t)\ncontour(x, t, U';\n    color=:blues,  clims=(0, 1), \n    xaxis=(L\"x\"),  yaxis=(L\"t\"),\n    title=\"Advection with inflow BC\")","key":"ylgVHCWd3K"},{"type":"output","id":"zcLLYg9eUN5HZuFFVnYfq","data":[{"output_type":"execute_result","execution_count":20,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"0c7f82719144bc873536174a4854acfc","path":"/fnc/build/0c7f82719144bc873536174a4854acfc.png"},"text/html":{"content_type":"text/html","hash":"18d73f21bb8de3606e7dc907c699f7e5","path":"/fnc/build/18d73f21bb8de3606e7dc907c699f7e5.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"920aedc3150a2806fb8c1347be490c86","path":"/fnc/build/920aedc3150a2806fb8c1347be490c86.svg"}}}],"key":"hX9jIFAdW0"}],"data":{},"key":"XPr1SgrghQ"},{"type":"paragraph","position":{"start":{"line":233,"column":1},"end":{"line":233,"column":1}},"children":[{"type":"text","value":"We find that the hump gracefully exits out the downwind end.","position":{"start":{"line":233,"column":1},"end":{"line":233,"column":1}},"key":"hQgk6y3Gbj"}],"key":"zasYNB825g"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"anim = @animate for t in range(0, 1, 161) \n    plot(x, extend(u(t));\n        label=@sprintf(\"t = %.4f\", t), \n        xaxis=(L\"x\"),  yaxis=(L\"u(x, t)\", (0, 1)), \n        title=\"Advection equation with inflow BC\",  dpi=150)\nend\nmp4(anim,\"figures/upwind-inflow.mp4\")","visibility":"hide","key":"XiWaJdnfdB"},{"type":"output","id":"kY68uYBo3JgknHKZC4vvA","data":[{"output_type":"stream","name":"stderr","text":"\u001b[36m\u001b[1m[ \u001b[22m\u001b[39m\u001b[36m\u001b[1mInfo: \u001b[22m\u001b[39mSaved animation to /Users/driscoll/Dropbox/Mac/Documents/GitHub/fnc/julia/figures/upwind-inflow.mp4\n"},{"output_type":"execute_result","execution_count":21,"metadata":{},"data":{"text/plain":{"content":"Plots.AnimatedGif(\"/Users/driscoll/Dropbox/Mac/Documents/GitHub/fnc/julia/figures/upwind-inflow.mp4\")","content_type":"text/plain"},"text/html":{"content_type":"text/html","hash":"fae1f6fec0a2c561d66f7b48b0f6bf00","path":"/fnc/build/fae1f6fec0a2c561d66f7b48b0f6bf00.html"}}}],"visibility":"show","key":"pcKwmHNyCB"}],"data":{"tags":[]},"visibility":"show","key":"EDtgpW1UaI"},{"type":"paragraph","position":{"start":{"line":246,"column":1},"end":{"line":246,"column":1}},"children":[{"type":"text","value":"If instead of ","position":{"start":{"line":246,"column":1},"end":{"line":246,"column":1}},"key":"fRhiUQ1LI3"},{"type":"inlineMath","value":"u(1,t)=0","position":{"start":{"line":246,"column":1},"end":{"line":246,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo stretchy=\"false\">(</mo><mn>1</mn><mo separator=\"true\">,</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">u(1,t)=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"xlAboIOR30"},{"type":"text","value":" we were to try to impose the downwind condition ","position":{"start":{"line":246,"column":1},"end":{"line":246,"column":1}},"key":"MVRN7skMt8"},{"type":"inlineMath","value":"u(0,t)=0","position":{"start":{"line":246,"column":1},"end":{"line":246,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo stretchy=\"false\">(</mo><mn>0</mn><mo separator=\"true\">,</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">u(0,t)=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"qnCS0iJgv5"},{"type":"text","value":", we only need to change the index of the interior nodes and where to append the zero value.","position":{"start":{"line":246,"column":1},"end":{"line":246,"column":1}},"key":"sFI6c1dVnG"}],"key":"TmRlLKXvKR"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"interior = 2:m+1\nextend = v -> [0; v]\n\ninit = @. exp( -80*(x[interior] - 0.5)^2 )\nivp = ODEProblem(ode!, init, (0., 0.25), -1)\nu = solve(ivp);","key":"vpSnhN1Nlz"},{"type":"output","id":"QBJQMatYagPu-KFlD0l8H","data":[],"key":"bPvIw8pSLf"}],"data":{},"key":"CE2bZNvP4O"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"t = range(0, 0.2, 61)\nU = reduce(hcat, extend(u(t)) for t in t)\ncontour(x, t, U'; \n    color=:redsblues,  clims=(-1, 1),\n    xaxis=(L\"x\"),  yaxis=(L\"t\"), \n    title=\"Advection with outflow BC\",  right_margin=3Plots.mm)","visibility":"hide","key":"fpUWlHSvO0"},{"type":"output","id":"fGrVOEyHPBnVyzgLMT6IA","data":[{"output_type":"execute_result","execution_count":23,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"440d5ae8360f79119c4ce53b78480983","path":"/fnc/build/440d5ae8360f79119c4ce53b78480983.png"},"text/html":{"content_type":"text/html","hash":"10af3ffbcb1c85a8b8482b497d897be3","path":"/fnc/build/10af3ffbcb1c85a8b8482b497d897be3.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"f1c97c87e0ea3001201860282846dc12","path":"/fnc/build/f1c97c87e0ea3001201860282846dc12.svg"}}}],"visibility":"show","key":"J3nS9c1g0l"}],"data":{"tags":[]},"visibility":"show","key":"X9hfxx0F12"},{"type":"paragraph","position":{"start":{"line":267,"column":1},"end":{"line":267,"column":1}},"children":[{"type":"text","value":"This time, the solution blows up as soon as the hump runs into the boundary because there are conflicting demands there.","position":{"start":{"line":267,"column":1},"end":{"line":267,"column":1}},"key":"WioocHF2Uf"}],"key":"s5qwAoZKfO"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"anim = @animate for t in range(0, 0.2, 41) \n    plot(x, extend(u(t));\n        label=@sprintf(\"t = %.4f\", t),\n        xaxis=(L\"x\"),  yaxis=(L\"u(x,t)\", (0, 1)), \n        title=\"Advection equation with outflow BC\",  dpi=150)\nend\nmp4(anim,\"figures/upwind-outflow.mp4\")","visibility":"hide","key":"xeZK9Uewd1"},{"type":"output","id":"pZZgxscjeSynV_ppSXkuB","data":[{"output_type":"stream","name":"stderr","text":"\u001b[36m\u001b[1m[ \u001b[22m\u001b[39m\u001b[36m\u001b[1mInfo: \u001b[22m\u001b[39mSaved animation to /Users/driscoll/Dropbox/Mac/Documents/GitHub/fnc/julia/figures/upwind-outflow.mp4\n"},{"output_type":"execute_result","execution_count":24,"metadata":{},"data":{"text/plain":{"content":"Plots.AnimatedGif(\"/Users/driscoll/Dropbox/Mac/Documents/GitHub/fnc/julia/figures/upwind-outflow.mp4\")","content_type":"text/plain"},"text/html":{"content_type":"text/html","hash":"026386b9931417a3f006ca7f77f92ec4","path":"/fnc/build/026386b9931417a3f006ca7f77f92ec4.html"}}}],"visibility":"show","key":"wKTOyPYVZh"}],"data":{"tags":[]},"visibility":"show","key":"bEOoT8iqCX"}],"label":"demo-upwind-direction-julia","identifier":"demo-upwind-direction-julia","html_id":"demo-upwind-direction-julia","key":"Bm3xH2lL5K"},{"type":"heading","depth":3,"position":{"start":{"line":281,"column":1},"end":{"line":281,"column":1}},"children":[{"type":"text","value":"12.3 ","position":{"start":{"line":281,"column":1},"end":{"line":281,"column":1}},"key":"mo2EhL1tYe"},{"type":"link","identifier":"section-advection-absstab","label":"section-advection-absstab","kind":"narrative","position":{"start":{"line":281,"column":6},"end":{"line":281,"column":32}},"url":"/absstab-advection","internal":true,"dataUrl":"/absstab-advection.json","children":[{"type":"text","value":"Absolute stability","key":"wkatbWyKGw"}],"key":"j3AZhePB3I"}],"identifier":"id-12-3","label":"12.3 ","html_id":"id-12-3","implicit":true,"key":"chohMRNVlf"},{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-absstab-advection","label":"demo-absstab-advection","kind":"proof:example","position":{"start":{"line":284,"column":1},"end":{"line":284,"column":24}},"children":[{"type":"text","value":"Example ","key":"SzNZ1KkIwG"},{"type":"text","value":"12.3.1","key":"RBfiMDx9vw"}],"template":"Example %s","enumerator":"12.3.1","resolved":true,"html_id":"demo-absstab-advection","remote":true,"url":"/absstab-advection","dataUrl":"/absstab-advection.json","key":"q1T0hLjW8g"}],"key":"iNCPxtUxU2"},{"type":"paragraph","position":{"start":{"line":285,"column":1},"end":{"line":285,"column":1}},"children":[{"type":"text","value":"For ","position":{"start":{"line":285,"column":1},"end":{"line":285,"column":1}},"key":"xzShzPOPmB"},{"type":"inlineMath","value":"c=1","position":{"start":{"line":285,"column":1},"end":{"line":285,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>c</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">c=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">c</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"riqBA0PCQQ"},{"type":"text","value":" we get purely imaginary eigenvalues.","position":{"start":{"line":285,"column":1},"end":{"line":285,"column":1}},"key":"PQGw7nkhF2"}],"key":"Kpz6rOHrtc"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"using Plots\nx, Dₓ = FNC.diffper(40, [0, 1])\nλ = eigvals(Dₓ);\nscatter(real(λ), imag(λ);\n    aspect_ratio = 1,  frame=:zerolines,\n    xlabel=\"Re λ\",  ylabel=\"Im λ\", \n    title=\"Eigenvalues for pure advection\",  legend=:none)","visibility":"hide","key":"iiNRgl9A9R"},{"type":"output","id":"0WDd58CrK1B6PBTGeZOWt","data":[{"output_type":"execute_result","execution_count":25,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"c357fdfd2deaf43c59f0ccf2bf43bae2","path":"/fnc/build/c357fdfd2deaf43c59f0ccf2bf43bae2.png"},"text/html":{"content_type":"text/html","hash":"5058e4477f31e8ae71041bfc8afff2e8","path":"/fnc/build/5058e4477f31e8ae71041bfc8afff2e8.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"e3d05e7706447b1ec02e308aeb8f755a","path":"/fnc/build/e3d05e7706447b1ec02e308aeb8f755a.svg"}}}],"visibility":"show","key":"GxHb3pLjis"}],"data":{"tags":[]},"visibility":"show","key":"HJzdnG8Ttr"},{"type":"paragraph","position":{"start":{"line":298,"column":1},"end":{"line":298,"column":1}},"children":[{"type":"text","value":"Let’s choose a time step of ","position":{"start":{"line":298,"column":1},"end":{"line":298,"column":1}},"key":"lOZmwULctu"},{"type":"inlineMath","value":"\\tau=0.1","position":{"start":{"line":298,"column":1},"end":{"line":298,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>τ</mi><mo>=</mo><mn>0.1</mn></mrow><annotation encoding=\"application/x-tex\">\\tau=0.1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.1132em;\">τ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0.1</span></span></span></span>","key":"XcVSWCtCm2"},{"type":"text","value":" and compare to the stability regions of the Euler and backward Euler time steppers (shown as shaded regions):","position":{"start":{"line":298,"column":1},"end":{"line":298,"column":1}},"key":"JuLQNZRJvw"}],"key":"jlAFbsvrpd"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"zc = @. cispi(2 * (0:360) / 360);     # points on |z|=1\nz = zc .- 1;                          # shift left by 1\nplot(Shape(real(z), imag(z)), color=RGB(.8, .8, 1))\nζ = 0.1 * λ\nscatter!(real(ζ), imag(ζ);\n    aspect_ratio=1,  frame=:zerolines,\n    xaxis=(\"Re ζ\", [-5, 5]),  yaxis=(\"Im ζ\", [-5, 5]),\n    title=\"Euler for advection\")","visibility":"hide","key":"ntIRjeCH8X"},{"type":"output","id":"_C3R3YaElaeiySPSz17TN","data":[{"output_type":"execute_result","execution_count":26,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"5b551d1f5d425ba03cfd6cc22bc6f2fb","path":"/fnc/build/5b551d1f5d425ba03cfd6cc22bc6f2fb.png"},"text/html":{"content_type":"text/html","hash":"95b2506615719eca8e4abeb6e628ee15","path":"/fnc/build/95b2506615719eca8e4abeb6e628ee15.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"95191c860cb4c5d3ccd14178d38d16d3","path":"/fnc/build/95191c860cb4c5d3ccd14178d38d16d3.svg"}}}],"visibility":"show","key":"pzQZfkg2N1"}],"data":{"tags":[]},"visibility":"show","key":"SecQvHlSx9"},{"type":"paragraph","position":{"start":{"line":312,"column":1},"end":{"line":312,"column":1}},"children":[{"type":"text","value":"In the Euler case it’s clear that ","position":{"start":{"line":312,"column":1},"end":{"line":312,"column":1}},"key":"ECDluCin7p"},{"type":"emphasis","position":{"start":{"line":312,"column":1},"end":{"line":312,"column":1}},"children":[{"type":"text","value":"no","position":{"start":{"line":312,"column":1},"end":{"line":312,"column":1}},"key":"ewH9cfonXE"}],"key":"EZCIaUabeB"},{"type":"text","value":" real value of ","position":{"start":{"line":312,"column":1},"end":{"line":312,"column":1}},"key":"nw4FdPqGNs"},{"type":"inlineMath","value":"\\tau>0","position":{"start":{"line":312,"column":1},"end":{"line":312,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>τ</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">\\tau&gt;0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.1132em;\">τ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&gt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"kr1Hh2EmlY"},{"type":"text","value":" is going to make ","position":{"start":{"line":312,"column":1},"end":{"line":312,"column":1}},"key":"O4EOZOSMLQ"},{"type":"text","value":"ζ","position":{"start":{"line":312,"column":1},"end":{"line":312,"column":1}},"key":"dGKQHrEq8Y"},{"type":"text","value":" values fit within the stability region. Any method whose stability region includes none of the imaginary axis is an unsuitable choice for advection.","position":{"start":{"line":312,"column":1},"end":{"line":312,"column":1}},"key":"UutJzhirU8"}],"key":"Nh6MRrRcVl"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"z = zc .+ 1;                        # shift circle right by 1\nplot(Shape([-6, 6, 6, -6], [-6, -6, 6, 6]), color=RGB(.8, .8, 1))\nplot!(Shape(real(z), imag(z)), color=:white)\nscatter!(real(ζ), imag(ζ);\n    aspect_ratio=1,  frame=:zerolines,\n    xaxis=(\"Re ζ\", [-5, 5]),  yaxis=(\"Im ζ\", [-5, 5]),\n    title=\"Backward Euler for advection\")","visibility":"hide","key":"ZpBPMdbsO3"},{"type":"output","id":"zWjpEf84zdqAL1Ph59EUN","data":[{"output_type":"execute_result","execution_count":27,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"83e4bb088ef7e7a300e319c20012e5e7","path":"/fnc/build/83e4bb088ef7e7a300e319c20012e5e7.png"},"text/html":{"content_type":"text/html","hash":"a85d527152dbf3d90c8dbe9f99fe06e4","path":"/fnc/build/a85d527152dbf3d90c8dbe9f99fe06e4.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"ccbb7a1c6e0003f7a761b2819e1361da","path":"/fnc/build/ccbb7a1c6e0003f7a761b2819e1361da.svg"}}}],"visibility":"show","key":"YRx5QVnOUv"}],"data":{"tags":[]},"visibility":"show","key":"w9X1oSoXT1"},{"type":"paragraph","position":{"start":{"line":325,"column":1},"end":{"line":325,"column":1}},"children":[{"type":"text","value":"The A-stable backward Euler time stepping tells the exact opposite story: it will be absolutely stable for any choice of the time step ","position":{"start":{"line":325,"column":1},"end":{"line":325,"column":1}},"key":"KJYJ9s9Mck"},{"type":"text","value":"τ","position":{"start":{"line":325,"column":1},"end":{"line":325,"column":1}},"key":"sYZlrPnzge"},{"type":"text","value":".","position":{"start":{"line":325,"column":1},"end":{"line":325,"column":1}},"key":"Fx9feeqZTB"}],"key":"WvyY4pSlsC"}],"label":"demo-absstab-advection-julia","identifier":"demo-absstab-advection-julia","html_id":"demo-absstab-advection-julia","key":"p1ceyXdAjm"},{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-absstab-advdiff","label":"demo-absstab-advdiff","kind":"proof:example","position":{"start":{"line":329,"column":1},"end":{"line":329,"column":22}},"children":[{"type":"text","value":"Example ","key":"c1DB11hYXV"},{"type":"text","value":"12.3.2","key":"W1PXko9wnW"}],"template":"Example %s","enumerator":"12.3.2","resolved":true,"html_id":"demo-absstab-advdiff","remote":true,"url":"/absstab-advection","dataUrl":"/absstab-advection.json","key":"V5Tt4T1fHH"}],"key":"qCwArJkgwF"},{"type":"paragraph","position":{"start":{"line":330,"column":1},"end":{"line":330,"column":1}},"children":[{"type":"text","value":"The eigenvalues of advection-diffusion are near-imaginary for ","position":{"start":{"line":330,"column":1},"end":{"line":330,"column":1}},"key":"tyU4PjAog6"},{"type":"inlineMath","value":"\\epsilon\\approx 0","position":{"start":{"line":330,"column":1},"end":{"line":330,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ϵ</mi><mo>≈</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">\\epsilon\\approx 0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4831em;\"></span><span class=\"mord mathnormal\">ϵ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"OQelyx36Ua"},{"type":"text","value":" and get closer to the negative real axis as ","position":{"start":{"line":330,"column":1},"end":{"line":330,"column":1}},"key":"gmrkCxXHDK"},{"type":"text","value":"ε","position":{"start":{"line":330,"column":1},"end":{"line":330,"column":1}},"key":"NbBMC0WplW"},{"type":"text","value":" increases.","position":{"start":{"line":330,"column":1},"end":{"line":330,"column":1}},"key":"nS72JSsXVi"}],"key":"MiuFUn0vK7"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"plt = plot(\n    legend=:topleft,\n    aspect_ratio=1,\n    xlabel=\"Re ζ\",  ylabel=\"Im ζ\",\n    title=\"Eigenvalues for advection-diffusion\")\nx, Dₓ, Dₓₓ = FNC.diffper(40, [0, 1]);\nfor ϵ in [0.001, 0.01, 0.05]\n    λ = eigvals(-Dₓ + ϵ*Dₓₓ)\n    scatter!(real(λ), imag(λ), m=:o, label=\"\\\\epsilon = $ϵ\")\nend\nplt","visibility":"hide","key":"kPLtUdKmid"},{"type":"output","id":"aN3VKfGhOFztScsOZnP-P","data":[{"output_type":"execute_result","execution_count":28,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"1520fc53fba698d621bc014dfabb0ea2","path":"/fnc/build/1520fc53fba698d621bc014dfabb0ea2.png"},"text/html":{"content_type":"text/html","hash":"ed9786ae6c10d37bdbd3de222f86381e","path":"/fnc/build/ed9786ae6c10d37bdbd3de222f86381e.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"49b05c43251011d600ec22adb027dd51","path":"/fnc/build/49b05c43251011d600ec22adb027dd51.svg"}}}],"visibility":"show","key":"E7QzlL4SYk"}],"data":{"tags":[]},"visibility":"show","key":"d4YOXyIXmo"}],"label":"demo-absstab-advdiff-julia","identifier":"demo-absstab-advdiff-julia","html_id":"demo-absstab-advdiff-julia","key":"u7xJS0B1R1"},{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-absstab-inflow","label":"demo-absstab-inflow","kind":"proof:example","position":{"start":{"line":349,"column":1},"end":{"line":349,"column":21}},"children":[{"type":"text","value":"Example ","key":"edkEXldxSf"},{"type":"text","value":"12.3.3","key":"g51QIlWPPA"}],"template":"Example %s","enumerator":"12.3.3","resolved":true,"html_id":"demo-absstab-inflow","remote":true,"url":"/absstab-advection","dataUrl":"/absstab-advection.json","key":"v6UG2baUc6"}],"key":"JzuOBWbjOl"},{"type":"paragraph","position":{"start":{"line":350,"column":1},"end":{"line":350,"column":1}},"children":[{"type":"text","value":"Deleting the last row and column places all the eigenvalues of the discretization into the left half of the complex plane.","position":{"start":{"line":350,"column":1},"end":{"line":350,"column":1}},"key":"VyLJVMnhDj"}],"key":"rBNPcQt7ch"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"x, Dₓ, _ = FNC.diffcheb(40, [0, 1])\nA = Dₓ[1:end-1, 1:end-1];     # delete last row and column\nλ = eigvals(A);","key":"q4uSI5PtcT"},{"type":"output","id":"zERjTuAnHkvp7LaVKK8Eh","data":[],"key":"laqtfhfV0H"}],"data":{},"key":"eeFXCgbZZu"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"scatter(real(λ), imag(λ);\n    m=3,  aspect_ratio=1,\n    legend=:none,  frame=:zerolines,\n    xaxis=([-300, 100], \"Re λ\"),  yaxis=(\"Im λ\"),\n    title=\"Eigenvalues of advection with zero inflow\")","visibility":"hide","key":"tO9EilhaEY"},{"type":"output","id":"Q7X6rpyKFMVSDvhWqgryD","data":[{"output_type":"execute_result","execution_count":30,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"7db3214b712e3e4931fddd30cf15b55a","path":"/fnc/build/7db3214b712e3e4931fddd30cf15b55a.png"},"text/html":{"content_type":"text/html","hash":"c1d535d84a264344ca5c1f1f64fbac87","path":"/fnc/build/c1d535d84a264344ca5c1f1f64fbac87.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"95fb30b574369d6fcd7dabb3a2c6020c","path":"/fnc/build/95fb30b574369d6fcd7dabb3a2c6020c.svg"}}}],"visibility":"show","key":"MAZaa2mKRv"}],"data":{"tags":[]},"visibility":"show","key":"d3AZPB1Xh8"},{"type":"paragraph","position":{"start":{"line":368,"column":1},"end":{"line":368,"column":1}},"children":[{"type":"text","value":"Note that the rightmost eigenvalues have real part at most","position":{"start":{"line":368,"column":1},"end":{"line":368,"column":1}},"key":"vwZdnsntsE"}],"key":"qqIaRPZ9o6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"maximum(real(λ))","key":"yOK1viGyx0"},{"type":"output","id":"VKK78QSo4fdCV5k9wxR5k","data":[{"output_type":"execute_result","execution_count":31,"metadata":{},"data":{"text/plain":{"content":"-4.931967035822774","content_type":"text/plain"}}}],"key":"UmddtxOpiw"}],"data":{},"key":"qp1LVaK8ot"},{"type":"paragraph","position":{"start":{"line":374,"column":1},"end":{"line":374,"column":1}},"children":[{"type":"text","value":"Consequently all solutions decay exponentially to zero as ","position":{"start":{"line":374,"column":1},"end":{"line":374,"column":1}},"key":"liGd8SK0r2"},{"type":"inlineMath","value":"t\\to\\infty","position":{"start":{"line":374,"column":1},"end":{"line":374,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi><mo>→</mo><mi mathvariant=\"normal\">∞</mi></mrow><annotation encoding=\"application/x-tex\">t\\to\\infty</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord\">∞</span></span></span></span>","key":"m5k5FuwdFy"},{"type":"text","value":". This matches our observation of the solution: eventually, everything flows out of the domain.","position":{"start":{"line":374,"column":1},"end":{"line":374,"column":1}},"key":"viAisQAb1w"}],"key":"B8oePxaqVt"}],"label":"demo-absstab-inflow-julia","identifier":"demo-absstab-inflow-julia","html_id":"demo-absstab-inflow-julia","key":"PC1AoDn41j"},{"type":"heading","depth":3,"position":{"start":{"line":378,"column":1},"end":{"line":378,"column":1}},"children":[{"type":"text","value":"12.4 ","position":{"start":{"line":378,"column":1},"end":{"line":378,"column":1}},"key":"itbYXUZ5Sz"},{"type":"link","identifier":"section-advection-wave","label":"section-advection-wave","kind":"narrative","position":{"start":{"line":378,"column":6},"end":{"line":378,"column":29}},"url":"/wave","internal":true,"dataUrl":"/wave.json","children":[{"type":"text","value":"The wave equation","key":"oq90yaH1Fe"}],"key":"vIXrRItQP3"}],"identifier":"id-12-4","label":"12.4 ","html_id":"id-12-4","implicit":true,"key":"uNtje80gmg"},{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-wave-boundaries","label":"demo-wave-boundaries","kind":"proof:example","position":{"start":{"line":381,"column":1},"end":{"line":381,"column":22}},"children":[{"type":"text","value":"Example ","key":"h0MEo9Dktl"},{"type":"text","value":"12.4.1","key":"LRLXDEdCGO"}],"template":"Example %s","enumerator":"12.4.1","resolved":true,"html_id":"demo-wave-boundaries","remote":true,"url":"/wave","dataUrl":"/wave.json","key":"mXvbBSzJgk"}],"key":"d1R8IBL64e"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"m = 200\nx, Dₓ = FNC.diffcheb(m, [-1, 1]);","key":"oQjTWcmFDE"},{"type":"output","id":"1yBtxCbA2AorTivrV4iea","data":[],"key":"c1Oaq9wNyo"}],"data":{},"key":"XeE8Oy802W"},{"type":"paragraph","position":{"start":{"line":388,"column":1},"end":{"line":388,"column":1}},"children":[{"type":"text","value":"The boundary values of ","position":{"start":{"line":388,"column":1},"end":{"line":388,"column":1}},"key":"dgNcKIkVK6"},{"type":"inlineMath","value":"u","position":{"start":{"line":388,"column":1},"end":{"line":388,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span>","key":"zY5d1cPj4g"},{"type":"text","value":" are given to be zero, so they are not unknowns in the ","key":"E3fBitgazo"},{"type":"abbreviation","title":"ordinary differential equation","children":[{"type":"text","value":"ODE","key":"Efac7JkPJZ"}],"key":"alRYiWNXSn"},{"type":"text","value":"s. Instead they are added or removed as necessary.","key":"K8ew00IQRY"}],"key":"TkW3SAkUVx"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"extend = v -> [0; v; 0]\nchop = u -> u[2:m];","key":"Z2XzinbfQP"},{"type":"output","id":"A0IsRl-yQaoU04w_8CbXM","data":[],"key":"v5zNA9qkr9"}],"data":{},"key":"WLaA48mMoJ"},{"type":"paragraph","position":{"start":{"line":395,"column":1},"end":{"line":395,"column":1}},"children":[{"type":"text","value":"The following function computes the time derivative of the system at interior points.","position":{"start":{"line":395,"column":1},"end":{"line":395,"column":1}},"key":"NoC7qVTM1l"}],"key":"JGII58vjYQ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"ode = function(w, c, t)\n    u = extend(w[1:m-1])\n    z = w[m:2m]\n    du_dt = Dₓ * z\n    dz_dt = c^2 * (Dₓ * u)\n    return [ chop(du_dt); dz_dt ]\nend;","key":"w0rMZDrw0S"},{"type":"output","id":"r-WuHL20DHgo7Yr4sukbt","data":[],"key":"DqUugihHna"}],"data":{},"key":"ePwI2SfbcE"},{"type":"paragraph","position":{"start":{"line":407,"column":1},"end":{"line":407,"column":1}},"children":[{"type":"text","value":"Our initial condition is a single hump for ","position":{"start":{"line":407,"column":1},"end":{"line":407,"column":1}},"key":"zJHuBbWBYe"},{"type":"inlineMath","value":"u","position":{"start":{"line":407,"column":1},"end":{"line":407,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span>","key":"mjWihbBffi"},{"type":"text","value":".","position":{"start":{"line":407,"column":1},"end":{"line":407,"column":1}},"key":"zngMrbhQea"}],"key":"RrEFwr0Luq"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"u_init = @. exp( -100*(x + 0.5)^2 )\nz_init = -u_init\nw_init = [ chop(u_init); z_init ];","key":"qn8SvC3sae"},{"type":"output","id":"QtrlW6GIi9HEhhJcwiHg3","data":[],"key":"nANI0uaGc1"}],"data":{},"key":"flqlvbbh83"},{"type":"paragraph","position":{"start":{"line":415,"column":1},"end":{"line":415,"column":1}},"children":[{"type":"text","value":"Because the wave equation is hyperbolic, we can use a nonstiff explicit solver.","position":{"start":{"line":415,"column":1},"end":{"line":415,"column":1}},"key":"Vec3H900u3"}],"key":"L9AfGhtlOG"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"using OrdinaryDiffEq\nIVP = ODEProblem(ode, w_init ,(0., 2.), 2)\nw = solve(IVP, RK4());","key":"S59LRX19pB"},{"type":"output","id":"62Vx-kaKzVCIEgkhmjJBp","data":[],"key":"vAkG7wWpwE"}],"data":{},"key":"Iwg2JddQ8f"},{"type":"paragraph","position":{"start":{"line":423,"column":1},"end":{"line":423,"column":1}},"children":[{"type":"text","value":"We plot the results for the original ","position":{"start":{"line":423,"column":1},"end":{"line":423,"column":1}},"key":"CJ1LgFihrw"},{"type":"inlineMath","value":"u","position":{"start":{"line":423,"column":1},"end":{"line":423,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span>","key":"K6YYutt4Di"},{"type":"text","value":" variable only. Its interior values are at indices ","position":{"start":{"line":423,"column":1},"end":{"line":423,"column":1}},"key":"qWAGyDilRH"},{"type":"inlineCode","value":"1:m-1","position":{"start":{"line":423,"column":1},"end":{"line":423,"column":1}},"key":"o7xaMH2J6N"},{"type":"text","value":" of the composite ","position":{"start":{"line":423,"column":1},"end":{"line":423,"column":1}},"key":"PHoLo3l7it"},{"type":"inlineMath","value":"\\mathbf{w}","position":{"start":{"line":423,"column":1},"end":{"line":423,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">w</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{w}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4444em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">w</span></span></span></span>","key":"h9RtzrFXPu"},{"type":"text","value":" variable.","position":{"start":{"line":423,"column":1},"end":{"line":423,"column":1}},"key":"t94vbPj2nN"}],"key":"A9Rgo1FqSN"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"using Plots\nt = range(0, 2, 80)\nU = [extend(w(t)[1:m-1]) for t in t]\ncontour(x, t, hcat(U...)';\n    levels=24,\n    color=:redsblues,  clims=(-1, 1),\n    xlabel=L\"x\",  ylabel=L\"t\",\n    title=\"Wave equation\",  right_margin=3Plots.mm)","key":"JSLDY20CcG"},{"type":"output","id":"JGU1AvX9CmfgBQGLkD7zj","data":[{"output_type":"execute_result","execution_count":37,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"2696b8ee721069072dcd739e4f62ebe9","path":"/fnc/build/2696b8ee721069072dcd739e4f62ebe9.png"},"text/html":{"content_type":"text/html","hash":"86549625bbbcc6ad219e76285ebe972c","path":"/fnc/build/86549625bbbcc6ad219e76285ebe972c.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"4cfbf6d0177bec3aa2aa1bd027aeedfc","path":"/fnc/build/4cfbf6d0177bec3aa2aa1bd027aeedfc.svg"}}}],"key":"mb9XdVpU5D"}],"data":{},"key":"uUBA2pYoNg"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"anim = @animate for t in range(0 ,2, 120)\n    plot(x, extend(w(t)[1:m-1]);\n        label=@sprintf(\"t=%.3f\",t),\n        xaxis=(L\"x\"),  yaxis=([-1, 1], L\"u(x,t)\"),\n        dpi=150,  title=\"Wave equation\")\nend\nmp4(anim, \"figures/wave-boundaries.mp4\")","visibility":"hide","key":"Wnjr8nvOpP"},{"type":"output","id":"_ninFXQ6IOBEhMELyPQFr","data":[{"output_type":"stream","name":"stderr","text":"\u001b[36m\u001b[1m[ \u001b[22m\u001b[39m\u001b[36m\u001b[1mInfo: \u001b[22m\u001b[39mSaved animation to /Users/driscoll/Dropbox/Mac/Documents/GitHub/fnc/julia/figures/wave-boundaries.mp4\n"},{"output_type":"execute_result","execution_count":38,"metadata":{},"data":{"text/plain":{"content":"Plots.AnimatedGif(\"/Users/driscoll/Dropbox/Mac/Documents/GitHub/fnc/julia/figures/wave-boundaries.mp4\")","content_type":"text/plain"},"text/html":{"content_type":"text/html","hash":"0faa4a250f8c6ad949c5b0b3a5a77d64","path":"/fnc/build/0faa4a250f8c6ad949c5b0b3a5a77d64.html"}}}],"visibility":"show","key":"mwsOEykelW"}],"data":{"tags":[]},"visibility":"show","key":"ydWq78TUM0"},{"type":"paragraph","position":{"start":{"line":447,"column":1},"end":{"line":447,"column":1}},"children":[{"type":"text","value":"The original hump breaks into two pieces of different amplitudes, each traveling with speed ","position":{"start":{"line":447,"column":1},"end":{"line":447,"column":1}},"key":"IFTlIal369"},{"type":"inlineMath","value":"c=2","position":{"start":{"line":447,"column":1},"end":{"line":447,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>c</mi><mo>=</mo><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">c=2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">c</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span></span></span></span>","key":"iBDGHnR7zT"},{"type":"text","value":". They pass through one another without interference. When a hump encounters a boundary, it is perfectly reflected, but with inverted shape. At time ","position":{"start":{"line":447,"column":1},"end":{"line":447,"column":1}},"key":"HsFcdoE5ur"},{"type":"inlineMath","value":"t=2","position":{"start":{"line":447,"column":1},"end":{"line":447,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi><mo>=</mo><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">t=2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span></span></span></span>","key":"olD324CudJ"},{"type":"text","value":", the solution looks just like the initial condition.","position":{"start":{"line":447,"column":1},"end":{"line":447,"column":1}},"key":"msIE2rfKTN"}],"key":"iJRtI9FXD1"}],"label":"demo-wave-boundaries-julia","identifier":"demo-wave-boundaries-julia","html_id":"demo-wave-boundaries-julia","key":"nBUeuDRodn"},{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-wave-speed","label":"demo-wave-speed","kind":"proof:example","position":{"start":{"line":452,"column":1},"end":{"line":452,"column":17}},"children":[{"type":"text","value":"Example ","key":"ogiMz4WqZT"},{"type":"text","value":"12.4.2","key":"xgJCCA1xaM"}],"template":"Example %s","enumerator":"12.4.2","resolved":true,"html_id":"demo-wave-speed","remote":true,"url":"/wave","dataUrl":"/wave.json","key":"DKyo85JZkO"}],"key":"F98GOXkJwJ"},{"type":"paragraph","position":{"start":{"line":453,"column":1},"end":{"line":453,"column":1}},"children":[{"type":"text","value":"The ","key":"ney4rn1hqq"},{"type":"abbreviation","title":"ordinary differential equation","children":[{"type":"text","value":"ODE","key":"Oj0YtWz3vS"}],"key":"Ei7QoAQp75"},{"type":"text","value":" implementation has to change slightly.","key":"g1d59qfPZe"}],"key":"Ndqf9fkQ3C"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"ode = function(w,c,t)\n    u = extend(w[1:m-1])\n    z = w[m:2m]\n    du_dt = Dₓ*z\n    dz_dt = c.^2 .* (Dₓ*u)\n    return [ chop(du_dt); dz_dt ]\nend;","key":"tWhJ0S6vnO"},{"type":"output","id":"u-w4DA0T4K0qBtinw-ogo","data":[],"key":"wBEn4RQxj7"}],"data":{},"key":"wxyn0GNZrp"},{"type":"paragraph","position":{"start":{"line":465,"column":1},"end":{"line":465,"column":1}},"children":[{"type":"text","value":"The variable wave speed is passed as an extra parameter through the ","key":"J7dMvaSZd6"},{"type":"abbreviation","title":"initial-value problem","children":[{"type":"text","value":"IVP","key":"YPX0r9xyuC"}],"key":"SifrNrU87b"},{"type":"text","value":" solver.","key":"Ek6dxtf8Cf"}],"key":"z6IKUJQfIG"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"c = @. 1 + (sign(x)+1)/2\nIVP = ODEProblem(ode, w_init, (0., 5.), c)\nw = solve(IVP, RK4());","key":"GC57ELr8xO"},{"type":"output","id":"VrPHS_AzaHmxZ-ptz8q7M","data":[],"key":"UQDTjRLcQ5"}],"data":{},"key":"FMe2E0Wu0e"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"t = range(0, 5, 80)\nU = [extend(w(t)[1:m-1]) for t in t]\ncontour(x, t, hcat(U...)';\n    color=:redsblues,  clims=(-1,1),\n    levels=24,\n    xlabel=L\"x\",  ylabel=L\"t\",\n    title=\"Wave equation\",\n    right_margin=3Plots.mm\n    )","key":"eOWHhnNPvQ"},{"type":"output","id":"rg2oQPd6i7DaRUhLs2j_I","data":[{"output_type":"execute_result","execution_count":41,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"a598559cd3c7d950cda10aff7ae1171b","path":"/fnc/build/a598559cd3c7d950cda10aff7ae1171b.png"},"text/html":{"content_type":"text/html","hash":"a2ebeb37ab7339e8b4b2aa76cfed3f5d","path":"/fnc/build/a2ebeb37ab7339e8b4b2aa76cfed3f5d.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"ff6dc794f9325d84d5ff6c61e3e30483","path":"/fnc/build/ff6dc794f9325d84d5ff6c61e3e30483.svg"}}}],"key":"yCUiK0ipb6"}],"data":{},"key":"WVLQVqhRJZ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"anim = @animate for t in range(0,5,181)\n    plot(Shape([-1, 0, 0, -1], [-1, -1, 1, 1]), color=RGB(.8, .8, .8), l=0, label=\"\")\n    plot!(x, extend(w(t, idxs=1:m-1));\n        label=@sprintf(\"t=%.2f\", t), \n        xaxis=(L\"x\"),  yaxis=([-1, 1], L\"u(x,t)\"),\n        dpi=150,  title=\"Wave equation, variable speed\")\nend\nmp4(anim, \"figures/wave-speed.mp4\")","visibility":"hide","key":"wJ7UTrPR1O"},{"type":"output","id":"DC-80SMk5aibqdQqZ1rw3","data":[{"output_type":"stream","name":"stderr","text":"\u001b[36m\u001b[1m[ \u001b[22m\u001b[39m\u001b[36m\u001b[1mInfo: \u001b[22m\u001b[39mSaved animation to /Users/driscoll/Dropbox/Mac/Documents/GitHub/fnc/julia/figures/wave-speed.mp4\n"},{"output_type":"execute_result","execution_count":42,"metadata":{},"data":{"text/plain":{"content":"Plots.AnimatedGif(\"/Users/driscoll/Dropbox/Mac/Documents/GitHub/fnc/julia/figures/wave-speed.mp4\")","content_type":"text/plain"},"text/html":{"content_type":"text/html","hash":"82b4de29af1675350c9503e441b8f79f","path":"/fnc/build/82b4de29af1675350c9503e441b8f79f.html"}}}],"visibility":"show","key":"BRR0jHoMS1"}],"data":{"tags":[]},"visibility":"show","key":"BY1Asn3meL"},{"type":"paragraph","position":{"start":{"line":497,"column":1},"end":{"line":497,"column":1}},"children":[{"type":"text","value":"Each pass through the interface at ","position":{"start":{"line":497,"column":1},"end":{"line":497,"column":1}},"key":"XBiJQZbO3y"},{"type":"inlineMath","value":"x=0","position":{"start":{"line":497,"column":1},"end":{"line":497,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">x=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"pxvbhKVtSn"},{"type":"text","value":" generates a reflected and transmitted wave. By conservation of energy, these are both smaller in amplitude than the incoming bump.","position":{"start":{"line":497,"column":1},"end":{"line":497,"column":1}},"key":"JNFXa4KuUD"}],"key":"LCyqyV8G0i"}],"label":"demo-wave-speed-julia","identifier":"demo-wave-speed-julia","html_id":"demo-wave-speed-julia","key":"Zpy6rnY8Qb"}],"key":"rRlE9tWJSa"}],"key":"mJelrezgdE"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Chapter 11","url":"/chapter11","group":"Julia codes"},"next":{"title":"Chapter 13","url":"/chapter13","group":"Julia codes"}}},"domain":"http://localhost:3000"}