{"kind":"Notebook","sha256":"2aa8dbd5895280cc51a1dcc90851cbdbc06c015b369089b8132d254dfea4e060","slug":"chapter12","location":"/julia/chapter12.md","dependencies":[],"frontmatter":{"title":"Chapter 12","numbering":{"heading_1":{"enabled":false},"heading_2":{"enabled":false},"heading_3":{"enabled":false},"heading_4":{"enabled":false},"heading_5":{"enabled":false},"heading_6":{"enabled":false}},"kernelspec":{"name":"julia-1.11","display_name":"Julia 1","language":"julia"},"content_includes_title":false,"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"exports":[{"format":"md","filename":"chapter12.md","url":"/fnc/build/chapter12-ceb2d651bb7ff81748f0ac24d2d2a6ab.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Examples","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"LV0yKucUb8"}],"identifier":"examples","label":"Examples","html_id":"examples","implicit":true,"key":"BkcgMvUiYp"}],"key":"WIgVYc7peR"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"include(\"FNC_init.jl\")","visibility":"show","key":"Lts9ZnZvEu"},{"type":"output","id":"KcNbWh6i9w38kce6bUjoK","data":[{"output_type":"stream","name":"stderr","text":"\u001b[32m\u001b[1m  Activating\u001b[22m\u001b[39m "},{"output_type":"stream","name":"stderr","text":"project at `~/Documents/GitHub/fnc`\n"},{"output_type":"stream","name":"stderr","text":"\u001b[36m\u001b[1m[ \u001b[22m\u001b[39m\u001b[36m\u001b[1mInfo: \u001b[22m\u001b[39mWaiting for another process (pid: 2709) to finish precompiling FNCFunctions [ab0dfefa-d313-416d-841c-e73335ae36c8]. Pidfile: /Users/driscoll/.julia/compiled/v1.11/FNCFunctions/j0Zi9_WGZhz.ji.pidfile\n"}],"visibility":"remove","key":"rjpYj6Rd5h"}],"data":{"tags":[]},"visibility":"show","key":"CHAMobllHD"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"12.1 ","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"rReAIxFQP0"},{"type":"link","identifier":"section-advection-traffic","label":"section-advection-traffic","kind":"narrative","position":{"start":{"line":18,"column":6},"end":{"line":18,"column":32}},"url":"/traffic","internal":true,"dataUrl":"/traffic.json","children":[{"type":"text","value":"Traffic flow","key":"myOXsKXhhz"}],"key":"JBISlHtomB"}],"identifier":"id-12-1","label":"12.1 ","html_id":"id-12-1","implicit":true,"key":"WZo9JQrecZ"},{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-traffic-advection","label":"demo-traffic-advection","kind":"proof:example","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":24}},"children":[{"type":"text","value":"Example ","key":"wTS9mrwbvu"},{"type":"text","value":"12.1.1","key":"F1ee1RqhYT"}],"template":"Example %s","enumerator":"12.1.1","resolved":true,"html_id":"demo-traffic-advection","remote":true,"url":"/traffic","dataUrl":"/traffic.json","key":"J2DVQPfrRo"}],"key":"Y3pEKl4ZpD"},{"type":"paragraph","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"text","value":"In the following definition we allow the velocity ","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"KgJVSSHST5"},{"type":"inlineMath","value":"c","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>c</mi></mrow><annotation encoding=\"application/x-tex\">c</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">c</span></span></span></span>","key":"bQGPDZZ5Dr"},{"type":"text","value":" to be specified as a parameter in the ","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"FWkTOjlI0y"},{"type":"inlineCode","value":"ODEProblem","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"C26Du8q5Xa"},{"type":"text","value":".","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"nyxw24FC7A"}],"key":"GxUSgu8vVD"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"x, Dₓ, Dₓₓ = FNC.diffper(300, [-4, 4]);\nf = (u, c, t) -> -c * (Dₓ*u);","key":"u7pokFU2QA"},{"type":"output","id":"85HEWGDfP5ygEY5bQBLWB","data":[],"key":"HvkPPB1y6t"}],"data":{},"key":"X9SOsLzCuh"},{"type":"paragraph","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"children":[{"type":"text","value":"The following initial condition isn’t mathematically periodic, but the deviation is less than machine precision. We specify RK4 as the solver.","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"KVPdLs5m39"}],"key":"AIFdLZvNUV"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"using OrdinaryDiffEq\nu_init = @. 1 + exp( -3x^2 )\nIVP = ODEProblem(f, u_init, (0., 4.), 2)\nsol = solve(IVP, RK4());","key":"EuCoSkakcy"},{"type":"output","id":"Rpe4WfWuhNmibkodRyHbX","data":[],"key":"lzcWHqf9kW"}],"data":{},"key":"ts2ThPUuIw"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"using Plots\nplt = plot(\n    legend=:bottomleft,\n    title=\"Advection with periodic boundary\",\n    xaxis=(L\"x\"),  yaxis=(L\"u(x,t)\"))\nfor t in (0:4) * 2/3\n    plot!(x, sol(t), label=@sprintf(\"t=%.1f\", t))\nend\nplt","visibility":"hide","key":"L7vFKXKvE3"},{"type":"output","id":"g8i7VbsNRBO0-XYrEFBak","data":[{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"3f0a22fd72789354fa8b05c10c3037ad","path":"/fnc/build/3f0a22fd72789354fa8b05c10c3037ad.png"},"text/html":{"content_type":"text/html","hash":"8cdce5ca132ed04a514fbab12d2d1953","path":"/fnc/build/8cdce5ca132ed04a514fbab12d2d1953.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"112a1714404809557d95ac30aab0a7f4","path":"/fnc/build/112a1714404809557d95ac30aab0a7f4.svg"}}}],"visibility":"show","key":"M2J7eItlJx"}],"data":{"tags":[]},"visibility":"show","key":"A6KAc5oRoR"},{"type":"paragraph","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"children":[{"type":"text","value":"An animation shows the solution nicely. The bump moves with speed 2 to the right, reentering on the left as it exits to the right because of the periodic conditions.","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"key":"mOrVeXaxjV"}],"key":"m0eqMN4Ae3"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"anim = @animate for t in range(0, 4, 120) \n    plot(x, sol(t),\n        title=@sprintf(\"Advection equation, t = %.2f\", t),\n        xaxis=(L\"x\"),  yaxis=([1, 2], L\"u(x,t)\"),\n        dpi=150)\nend\nmp4(anim, \"figures/advection.mp4\")","visibility":"hide","key":"y1pE5zKOQM"},{"type":"output","id":"CvtsaTPj2QfHGQIiQVm6I","data":[{"output_type":"stream","name":"stderr","text":"\u001b[36m\u001b[1m[ \u001b[22m\u001b[39m\u001b[36m\u001b[1mInfo: \u001b[22m\u001b[39mSaved animation to /Users/driscoll/Dropbox/Mac/Documents/GitHub/fnc/julia/figures/advection.mp4\n"},{"output_type":"execute_result","execution_count":5,"metadata":{},"data":{"text/plain":{"content":"Plots.AnimatedGif(\"/Users/driscoll/Dropbox/Mac/Documents/GitHub/fnc/julia/figures/advection.mp4\")","content_type":"text/plain"},"text/html":{"content_type":"text/html","hash":"2aa36b0f116daf57a36937f6baad0023","path":"/fnc/build/2aa36b0f116daf57a36937f6baad0023.html"}}}],"visibility":"show","key":"jXqMXWdhxI"}],"data":{"tags":[]},"visibility":"show","key":"dzxweVhqok"}],"label":"demo-traffic-advection-julia","identifier":"demo-traffic-advection-julia","html_id":"demo-traffic-advection-julia","key":"o31nTjwyQw"},{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-traffic-solve","label":"demo-traffic-solve","kind":"proof:example","position":{"start":{"line":68,"column":1},"end":{"line":68,"column":20}},"children":[{"type":"text","value":"Example ","key":"Tl3h1jFkkZ"},{"type":"text","value":"12.1.2","key":"ecmjvQ5lBy"}],"template":"Example %s","enumerator":"12.1.2","resolved":true,"html_id":"demo-traffic-solve","remote":true,"url":"/traffic","dataUrl":"/traffic.json","key":"slV3SERW5b"}],"key":"QAqU3W4Sh9"},{"type":"paragraph","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"children":[{"type":"text","value":"The following are parameters and a function relevant to defining the problem.","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"key":"DA3mqM6Ov5"}],"key":"HM8iWItyrI"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"ρc = 1080;  ρm = 380;  q_m = 10000;\ndQ0 = ρ -> 4q_m * ρc^2 * (ρc-ρm) * ρm * (ρm-ρ) / (ρ*(ρc-2*ρm) + ρc*ρm)^3;","key":"SuR7BJIzw2"},{"type":"output","id":"kx0KkwH_hnjQpKYKHsFZV","data":[],"key":"GRp49ADYJQ"}],"data":{},"key":"OA1LHGH0Zy"},{"type":"paragraph","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"children":[{"type":"text","value":"Here we create a discretization on ","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"key":"g23zf9o4U9"},{"type":"inlineMath","value":"m=800","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi><mo>=</mo><mn>800</mn></mrow><annotation encoding=\"application/x-tex\">m=800</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">800</span></span></span></span>","key":"Pgt2CAgj5J"},{"type":"text","value":" points.","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"key":"wnvMTAP4J6"}],"key":"N5u5t5hCDe"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"x, Dₓ, Dₓₓ = FNC.diffper(800, [0, 4]);","key":"aM3IseOx6Q"},{"type":"output","id":"z_eaEEAMx4N7yJ-p2lDrm","data":[],"key":"aOmhOxe3zU"}],"data":{},"key":"YfO9nWVNWf"},{"type":"paragraph","position":{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},"children":[{"type":"text","value":"Next we define the ","key":"TQnnAffQt7"},{"type":"abbreviation","title":"ordinary differential equation","children":[{"type":"text","value":"ODE","key":"lUZAS7JJOO"}],"key":"XVvUGDd7i9"},{"type":"text","value":" resulting from the method of lines.","key":"pWSbjSbpwJ"}],"key":"zLd7MyEBIP"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"ode = (ρ, ϵ, t) -> -dQ0.(ρ) .* (Dₓ*ρ) + ϵ * (Dₓₓ*ρ);","key":"Y3mngjpjXQ"},{"type":"output","id":"AjQV4m2KZBfT3m_NWUGOY","data":[],"key":"OD9qgTKG97"}],"data":{},"key":"U0IhheOXfA"},{"type":"paragraph","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"children":[{"type":"text","value":"Our first initial condition has moderate density with a small bump. Because of the diffusion present, we use a stiff solver for the ","key":"dFJApRUYVj"},{"type":"abbreviation","title":"initial-value problem","children":[{"type":"text","value":"IVP","key":"INxBIL0EVK"}],"key":"TUrQ1EyUc9"},{"type":"text","value":".","key":"q1dLQdHanV"}],"key":"etoQKnwNFI"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"ρ_init = @. 400 + 10 * exp( -20*(x-3)^2 )\nIVP = ODEProblem(ode, ρ_init, (0., 1.), 0.02)\nsol = solve(IVP, Rodas4P());","key":"upSg43TZTL"},{"type":"output","id":"64X50I-_Sa4KorjeQ2A7F","data":[],"key":"kmLedfLS0k"}],"data":{},"key":"CAHvbYzEe2"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"plt = plot(\n    legend=:topleft, \n    title=\"Traffic flow\",\n    xaxis=(L\"x\"),  yaxis=(\"car density\"))\nfor t in 0:0.2:1\n    plot!(x, sol(t), label=@sprintf(\"t=%.1f\", t))\nend\nplt","visibility":"hide","key":"wLwJHmkUHV"},{"type":"output","id":"cJPJ0ejau5N70RNCkA19f","data":[{"output_type":"execute_result","execution_count":10,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"7abd9c7be7bbcd6482ecf213933ba178","path":"/fnc/build/7abd9c7be7bbcd6482ecf213933ba178.png"},"text/html":{"content_type":"text/html","hash":"a209bc8f143d6975e8be39b1289d93f8","path":"/fnc/build/a209bc8f143d6975e8be39b1289d93f8.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"d284df007600ea2f7170750b63ce3669","path":"/fnc/build/d284df007600ea2f7170750b63ce3669.svg"}}}],"visibility":"show","key":"o7Ow6Kiecy"}],"data":{"tags":[]},"visibility":"show","key":"sAuU3KRAYN"},{"type":"paragraph","position":{"start":{"line":108,"column":1},"end":{"line":108,"column":1}},"children":[{"type":"text","value":"The bump slowly moves backward on the roadway, spreading out and gradually fading away due to the presence of diffusion.","position":{"start":{"line":108,"column":1},"end":{"line":108,"column":1}},"key":"nFT1pj2UUl"}],"key":"fjFOd2mK7T"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"anim = @animate for t in range(0,0.9,91) \n    plot(x, sol(t);\n        xaxis=(L\"x\"),  yaxis=([400,410], \"density\"),\n        dpi=150,  title=@sprintf(\"Traffic flow, t=%.2f\",t))\nend\nmp4(anim, \"figures/traffic-fade.mp4\")","visibility":"hide","key":"OHEpHlfGQu"},{"type":"output","id":"Yxt34QNx6ZSqGOL6b02Cb","data":[{"output_type":"stream","name":"stderr","text":"\u001b[36m\u001b[1m[ \u001b[22m\u001b[39m\u001b[36m\u001b[1mInfo: \u001b[22m\u001b[39mSaved animation to /Users/driscoll/Dropbox/Mac/Documents/GitHub/fnc/julia/figures/traffic-fade.mp4\n"},{"output_type":"execute_result","execution_count":11,"metadata":{},"data":{"text/plain":{"content":"Plots.AnimatedGif(\"/Users/driscoll/Dropbox/Mac/Documents/GitHub/fnc/julia/figures/traffic-fade.mp4\")","content_type":"text/plain"},"text/html":{"content_type":"text/html","hash":"04ba6f64d6095f98be3ec71671dfc10c","path":"/fnc/build/04ba6f64d6095f98be3ec71671dfc10c.html"}}}],"visibility":"show","key":"T3xFm8B4np"}],"data":{"tags":[]},"visibility":"show","key":"Y9OshKwnVS"},{"type":"paragraph","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"children":[{"type":"text","value":"Now we use an initial condition with a larger bump. Note that the scale on the ","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"key":"ICltsI1219"},{"type":"inlineMath","value":"y","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>","key":"BssX7b1xvu"},{"type":"text","value":"-axis is much different for this solution.","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"key":"lw4zMSginm"}],"key":"mVCIpiuGBQ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"ρ_init = @. 400 + 80 * exp( -16*(x - 3)^2 )\nIVP = ODEProblem(ode, ρ_init, (0., 0.5), 0.02)\nsol = solve(IVP, Rodas4P());","key":"lvXZBexMLn"},{"type":"output","id":"2lyatJHBc4oC0G5q_EVFW","data":[],"key":"ouwqk5uRRQ"}],"data":{},"key":"ycZ7ndcbDi"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"plt = plot(\n    legend=:topleft,\n    title=\"Traffic jam\",\n    xaxis=(L\"x\"),  yaxis=(\"car density\"))\nfor t in range(0, 5, 11)\n    plot!(x, sol(t), label=@sprintf(\"t=%.1f\", t))\nend\nplt","visibility":"hide","key":"fJRUIHo0vW"},{"type":"output","id":"k-u7Qt07yyjwCVZgOFJQP","data":[{"output_type":"execute_result","execution_count":13,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"e8924017baa87bc398f89b208d68819c","path":"/fnc/build/e8924017baa87bc398f89b208d68819c.png"},"text/html":{"content_type":"text/html","hash":"48b64886d655e64009f79a6e8d785753","path":"/fnc/build/48b64886d655e64009f79a6e8d785753.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"784e4fd86f3c1adb96fe93279faf600c","path":"/fnc/build/784e4fd86f3c1adb96fe93279faf600c.svg"}}}],"visibility":"show","key":"oFto5HWdZm"}],"data":{"tags":[]},"visibility":"show","key":"VwJMVV7kCs"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"anim = @animate for t in range(0, 0.5, 101) \n    plot(x, sol(t);\n        xaxis=(L\"x\"),  yaxis=([400,480], \"density\"),\n        dpi=150,  title=@sprintf(\"Traffic jam, t=%.2f\",t))\nend\nmp4(anim,\"figures/traffic-jam.mp4\")","visibility":"hide","key":"Gum7EtVGr7"},{"type":"output","id":"WFbclzvuF4OkmRmwLE19A","data":[{"output_type":"stream","name":"stderr","text":"\u001b[36m\u001b[1m[ \u001b[22m\u001b[39m\u001b[36m\u001b[1mInfo: \u001b[22m\u001b[39mSaved animation to /Users/driscoll/Dropbox/Mac/Documents/GitHub/fnc/julia/figures/traffic-jam.mp4\n"},{"output_type":"execute_result","execution_count":14,"metadata":{},"data":{"text/plain":{"content":"Plots.AnimatedGif(\"/Users/driscoll/Dropbox/Mac/Documents/GitHub/fnc/julia/figures/traffic-jam.mp4\")","content_type":"text/plain"},"text/html":{"content_type":"text/html","hash":"5e6c0173dc440b6138780c5c63c24a23","path":"/fnc/build/5e6c0173dc440b6138780c5c63c24a23.html"}}}],"visibility":"show","key":"JVU0vZup41"}],"data":{"tags":[]},"visibility":"show","key":"rcsWlYIl8j"},{"type":"paragraph","position":{"start":{"line":150,"column":1},"end":{"line":150,"column":1}},"children":[{"type":"text","value":"In this case the density bump travels backward along the road. It also steepens on the side facing the incoming traffic and decreases much more slowly on the other side. A motorist would experience this as an abrupt increase in density, followed by a much more gradual decrease in density and resulting gradual increase in speed. (You also see some transient, high-frequency oscillations. These are caused by instabilities, as we discuss in simpler situations later in this chapter.)","position":{"start":{"line":150,"column":1},"end":{"line":150,"column":1}},"key":"UhBvSL5AdG"}],"key":"njTXc5F4fe"}],"label":"demo-traffic-solve-julia","identifier":"demo-traffic-solve-julia","html_id":"demo-traffic-solve-julia","key":"FQ6ssIgxW7"},{"type":"heading","depth":3,"position":{"start":{"line":154,"column":1},"end":{"line":154,"column":1}},"children":[{"type":"text","value":"12.2 ","position":{"start":{"line":154,"column":1},"end":{"line":154,"column":1}},"key":"MomRBW3eF3"},{"type":"link","identifier":"section-advection-upwind","label":"section-advection-upwind","kind":"narrative","position":{"start":{"line":154,"column":6},"end":{"line":154,"column":31}},"url":"/upwind","internal":true,"dataUrl":"/upwind.json","children":[{"type":"text","value":"Upwinding and stability","key":"xNls74qzyS"}],"key":"zBm86AOnAA"}],"identifier":"id-12-2","label":"12.2 ","html_id":"id-12-2","implicit":true,"key":"VhUuykXuhT"},{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-upwind-cfl","label":"demo-upwind-cfl","kind":"proof:example","position":{"start":{"line":157,"column":1},"end":{"line":157,"column":17}},"children":[{"type":"text","value":"Example ","key":"G5BOaRQnIu"},{"type":"text","value":"12.2.3","key":"FCmnR2MrAP"}],"template":"Example %s","enumerator":"12.2.3","resolved":true,"html_id":"demo-upwind-cfl","remote":true,"url":"/upwind","dataUrl":"/upwind.json","key":"KUHMmjxcjg"}],"key":"JSLjlbUeVV"},{"type":"paragraph","position":{"start":{"line":158,"column":1},"end":{"line":158,"column":1}},"children":[{"type":"text","value":"For time stepping, we use the adaptive explicit method ","position":{"start":{"line":158,"column":1},"end":{"line":158,"column":1}},"key":"cnH5pZAzB3"},{"type":"inlineCode","value":"RK4","position":{"start":{"line":158,"column":1},"end":{"line":158,"column":1}},"key":"rtV9OYjHJm"},{"type":"text","value":".","position":{"start":{"line":158,"column":1},"end":{"line":158,"column":1}},"key":"DYbKAPmRYQ"}],"key":"Jn3EuETR5B"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"using OrdinaryDiffEq\nm = 400;\nx, Dₓ = FNC.diffper(m, [0, 1])\nu_init = x -> exp( -80 * (x - 0.5)^2 )\node = (u, c, t) -> -c * (Dₓ*u)\nIVP = ODEProblem(ode, u_init.(x), (0., 2.), 2.)\nu = solve(IVP, RK4());","key":"NxDwMGMuUR"},{"type":"output","id":"J1081U53cIgY3v5xdgK41","data":[],"key":"qb0dBiRVC6"}],"data":{},"key":"Zuvxn23xYH"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"using Plots\nt = range(0, 2, 81);\nU = reduce(hcat, u(t) for t in t)\ncontour(x, t, U'; \n    color=:redsblues,  clims=(-1, 1),\n    xaxis=(L\"x\"),  yaxis=(L\"t\"),\n    title=\"Linear advection\",  right_margin=3Plots.mm)","visibility":"hide","key":"N4bm4ZngBh"},{"type":"output","id":"ZKnNIb6ORuVFoLk6RMgDx","data":[{"output_type":"execute_result","execution_count":16,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"5265900b137297ac6f67467b0300043d","path":"/fnc/build/5265900b137297ac6f67467b0300043d.png"},"text/html":{"content_type":"text/html","hash":"6a25f55157cb1165599c5ea763e09544","path":"/fnc/build/6a25f55157cb1165599c5ea763e09544.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"6b33ed272c09e8e530077dfe5923fd16","path":"/fnc/build/6b33ed272c09e8e530077dfe5923fd16.svg"}}}],"visibility":"show","key":"DvdUqdiK8o"}],"data":{"tags":[]},"visibility":"show","key":"jTp9kh9Drh"},{"type":"paragraph","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"children":[{"type":"text","value":"In the space-time plot above, you can see the initial hump traveling rightward at constant speed. It fully traverses the domain once for each integer multiple of ","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"key":"JAPquog06t"},{"type":"inlineMath","value":"t=1/2","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi><mo>=</mo><mn>1</mn><mi mathvariant=\"normal\">/</mi><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">t=1/2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1/2</span></span></span></span>","key":"qsvPjUBePm"},{"type":"text","value":".","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"key":"sMoL8GPJAO"}],"key":"pMrEU0DLoV"},{"type":"paragraph","position":{"start":{"line":183,"column":1},"end":{"line":183,"column":1}},"children":[{"type":"text","value":"If we cut ","position":{"start":{"line":183,"column":1},"end":{"line":183,"column":1}},"key":"T8NeGL7EXh"},{"type":"inlineMath","value":"h","position":{"start":{"line":183,"column":1},"end":{"line":183,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>h</mi></mrow><annotation encoding=\"application/x-tex\">h</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">h</span></span></span></span>","key":"s25qtROpGz"},{"type":"text","value":" by a factor of 2 (i.e., double ","position":{"start":{"line":183,"column":1},"end":{"line":183,"column":1}},"key":"ioHUqbKDyP"},{"type":"inlineMath","value":"m","position":{"start":{"line":183,"column":1},"end":{"line":183,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi></mrow><annotation encoding=\"application/x-tex\">m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">m</span></span></span></span>","key":"PP3LMFNBOm"},{"type":"text","value":"), then the CFL condition suggests that the time step should be cut by a factor of 2 also.","position":{"start":{"line":183,"column":1},"end":{"line":183,"column":1}},"key":"nuY9vm3ezv"}],"key":"aWXWWysm3Y"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"println(\"Number of time steps for m = 400: $(length(u.t))\")\n\nm = 800;\nx, Dₓ = FNC.diffper(m, [0, 1])\nIVP = ODEProblem(ode, u_init.(x), (0., 2.), 2.)\nu = solve(IVP, RK4())\nprintln(\"Number of time steps for m = 800: $(length(u.t))\")","key":"DPc0itRbpo"},{"type":"output","id":"MY62i8FIXbcdVF42assKQ","data":[{"output_type":"stream","name":"stdout","text":"Number of time steps for m = 400: 565\n"},{"output_type":"stream","name":"stdout","text":"Number of time steps for m = 800: 1128\n"}],"key":"cstVBGYM32"}],"data":{},"key":"ZItdUcm7gk"}],"label":"demo-upwind-cfl-julia","identifier":"demo-upwind-cfl-julia","html_id":"demo-upwind-cfl-julia","key":"D2lZa5oOMZ"},{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-upwind-direction","label":"demo-upwind-direction","kind":"proof:example","position":{"start":{"line":197,"column":1},"end":{"line":197,"column":23}},"children":[{"type":"text","value":"Example ","key":"MGl3ch0pjJ"},{"type":"text","value":"12.2.6","key":"q4pXLw5ES2"}],"template":"Example %s","enumerator":"12.2.6","resolved":true,"html_id":"demo-upwind-direction","remote":true,"url":"/upwind","dataUrl":"/upwind.json","key":"i83mjTGrNV"}],"key":"hm7OoEhqWl"},{"type":"paragraph","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"children":[{"type":"text","value":"If we solve advection over ","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"key":"cyGzVfRbIY"},{"type":"inlineMath","value":"[0,1]","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mn>0</mn><mo separator=\"true\">,</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[0,1]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]</span></span></span></span>","key":"LiOjFLqtm9"},{"type":"text","value":" with velocity ","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"key":"escLyGFLjS"},{"type":"inlineMath","value":"c=-1","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>c</mi><mo>=</mo><mo>−</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">c=-1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">c</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">−</span><span class=\"mord\">1</span></span></span></span>","key":"xDxJyfkaOb"},{"type":"text","value":", the right boundary is in the upwind/inflow direction. Thus a well-posed boundary condition is ","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"key":"St2p23xuBM"},{"type":"inlineMath","value":"u(1,t)=0","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo stretchy=\"false\">(</mo><mn>1</mn><mo separator=\"true\">,</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">u(1,t)=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"VcTNIHNtY0"},{"type":"text","value":".","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"key":"E0QPHNOFZK"}],"key":"Od5gxD0V78"},{"type":"paragraph","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"children":[{"type":"text","value":"We’ll pattern a solution after ","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"key":"ur5L7nvi54"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-parabolic","label":"function-parabolic","children":[{"type":"text","value":"Function ","key":"sksT1qiycG"},{"type":"text","value":"11.5.2","key":"VQ7OMx1RZT"}],"template":"Algorithm %s","enumerator":"11.5.2","resolved":true,"html_id":"function-parabolic","remote":true,"url":"/boundaries","dataUrl":"/boundaries.json","key":"jp8kxHs5br"},{"type":"text","value":". Since ","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"key":"JbmPcgWaGA"},{"type":"inlineMath","value":"u(x_m,t)=0","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>m</mi></msub><mo separator=\"true\">,</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">u(x_m,t)=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"cZBJ02FVBF"},{"type":"text","value":", we define the ","key":"elD9VURStL"},{"type":"abbreviation","title":"ordinary differential equation","children":[{"type":"text","value":"ODE","key":"YzM3dCq5Mz"}],"key":"Nle9Y7vMAw"},{"type":"text","value":" interior problem ","key":"ytUmJh9IJX"},{"type":"crossReference","kind":"equation","identifier":"mol-interior","label":"mol-interior","children":[{"type":"text","value":"(","key":"kc3774FSnj"},{"type":"text","value":"11.5.4","key":"jyKWmF2fyi"},{"type":"text","value":")","key":"kRoU9LnlSd"}],"template":"(%s)","enumerator":"11.5.4","resolved":true,"html_id":"mol-interior","remote":true,"url":"/boundaries","dataUrl":"/boundaries.json","key":"dglHU414NR"},{"type":"text","value":" for ","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"key":"IKFw6tQjPS"},{"type":"inlineMath","value":"\\mathbf{v}","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">v</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{v}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4444em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">v</span></span></span></span>","key":"ZsBmMJF5WC"},{"type":"text","value":" without ","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"key":"MxrYI5bALv"},{"type":"inlineMath","value":"u_m","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>u</mi><mi>m</mi></msub></mrow><annotation encoding=\"application/x-tex\">u_m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"vlvI7Nm9fh"},{"type":"text","value":". For each evaluation of ","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"key":"ZqdSwVrVk5"},{"type":"inlineMath","value":"\\mathbf{v}'","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi mathvariant=\"bold\">v</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup></mrow><annotation encoding=\"application/x-tex\">\\mathbf{v}&#x27;</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span></span></span></span>","key":"G2WkpB9lZ0"},{"type":"text","value":", we must extend the data back to ","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"key":"o5A9cun4VY"},{"type":"inlineMath","value":"x_m","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mi>m</mi></msub></mrow><annotation encoding=\"application/x-tex\">x_m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"O3E6JB32um"},{"type":"text","value":" first.","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"key":"VnamfoK29E"}],"key":"wLD1bQAdMP"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"m = 100\nx, Dₓ = FNC.diffmat2(m, [0, 1])\n\ninterior = 1:m\nextend = v -> [v; 0]\n\nfunction ode!(f, v, c, t)\n    u = extend(v)\n    uₓ = Dₓ * u\n    @. f = -c * uₓ[interior]\nend;","key":"a47elg0I0m"},{"type":"output","id":"-Xu0I8wu2lwwkb5v2R4Yp","data":[],"key":"NRBcpwiz5d"}],"data":{},"key":"NuB1oORlVr"},{"type":"paragraph","position":{"start":{"line":216,"column":1},"end":{"line":216,"column":1}},"children":[{"type":"text","value":"Now we solve for an initial condition that has a single hump.","position":{"start":{"line":216,"column":1},"end":{"line":216,"column":1}},"key":"yNbGksVOEL"}],"key":"koWZzbsIQS"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"init = @. exp( -80*(x[interior] - 0.5)^2 )\nivp = ODEProblem(ode!, init, (0., 1), -1)\nu = solve(ivp);","key":"j4ebosLahF"},{"type":"output","id":"2kymomG-ibMog60m-K5Ft","data":[],"key":"rdZCkc14SP"}],"data":{},"key":"Vv0w5vu74j"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"t = range(0, 0.75, 80)\nU = reduce(hcat, extend(u(t)) for t in t)\ncontour(x, t, U';\n    color=:blues,  clims=(0, 1), \n    xaxis=(L\"x\"),  yaxis=(L\"t\"),\n    title=\"Advection with inflow BC\")","key":"NsqcDCO4LI"},{"type":"output","id":"Q-MKlgmOa050SI1iKJrbK","data":[{"output_type":"execute_result","execution_count":20,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"0c7f82719144bc873536174a4854acfc","path":"/fnc/build/0c7f82719144bc873536174a4854acfc.png"},"text/html":{"content_type":"text/html","hash":"df06e206bb4574868bced9396a61aacd","path":"/fnc/build/df06e206bb4574868bced9396a61aacd.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"68727643ec3a197679b1ce53f7da856d","path":"/fnc/build/68727643ec3a197679b1ce53f7da856d.svg"}}}],"key":"LNtXUxSA0b"}],"data":{},"key":"PM5Q5HCoKb"},{"type":"paragraph","position":{"start":{"line":233,"column":1},"end":{"line":233,"column":1}},"children":[{"type":"text","value":"We find that the hump gracefully exits out the downwind end.","position":{"start":{"line":233,"column":1},"end":{"line":233,"column":1}},"key":"eopb9Ae9NF"}],"key":"kcAH4VofFo"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"anim = @animate for t in range(0, 1, 161) \n    plot(x, extend(u(t));\n        label=@sprintf(\"t = %.4f\", t), \n        xaxis=(L\"x\"),  yaxis=(L\"u(x, t)\", (0, 1)), \n        title=\"Advection equation with inflow BC\",  dpi=150)\nend\nmp4(anim,\"figures/upwind-inflow.mp4\")","visibility":"hide","key":"YWuHb5V3x2"},{"type":"output","id":"LTxGnHMZc36aDNiF-vGPw","data":[{"output_type":"stream","name":"stderr","text":"\u001b[36m\u001b[1m[ \u001b[22m\u001b[39m\u001b[36m\u001b[1mInfo: \u001b[22m\u001b[39mSaved animation to /Users/driscoll/Dropbox/Mac/Documents/GitHub/fnc/julia/figures/upwind-inflow.mp4\n"},{"output_type":"execute_result","execution_count":21,"metadata":{},"data":{"text/plain":{"content":"Plots.AnimatedGif(\"/Users/driscoll/Dropbox/Mac/Documents/GitHub/fnc/julia/figures/upwind-inflow.mp4\")","content_type":"text/plain"},"text/html":{"content_type":"text/html","hash":"fae1f6fec0a2c561d66f7b48b0f6bf00","path":"/fnc/build/fae1f6fec0a2c561d66f7b48b0f6bf00.html"}}}],"visibility":"show","key":"UQiapEriPF"}],"data":{"tags":[]},"visibility":"show","key":"qCGrKNFuyx"},{"type":"paragraph","position":{"start":{"line":246,"column":1},"end":{"line":246,"column":1}},"children":[{"type":"text","value":"If instead of ","position":{"start":{"line":246,"column":1},"end":{"line":246,"column":1}},"key":"ICMYhe6rar"},{"type":"inlineMath","value":"u(1,t)=0","position":{"start":{"line":246,"column":1},"end":{"line":246,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo stretchy=\"false\">(</mo><mn>1</mn><mo separator=\"true\">,</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">u(1,t)=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"B0DXfzSQcG"},{"type":"text","value":" we were to try to impose the downwind condition ","position":{"start":{"line":246,"column":1},"end":{"line":246,"column":1}},"key":"KzQVwuMLSq"},{"type":"inlineMath","value":"u(0,t)=0","position":{"start":{"line":246,"column":1},"end":{"line":246,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo stretchy=\"false\">(</mo><mn>0</mn><mo separator=\"true\">,</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">u(0,t)=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"kMKi4L8Rys"},{"type":"text","value":", we only need to change the index of the interior nodes and where to append the zero value.","position":{"start":{"line":246,"column":1},"end":{"line":246,"column":1}},"key":"wmvLJWZhhJ"}],"key":"EFFywrampG"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"interior = 2:m+1\nextend = v -> [0; v]\n\ninit = @. exp( -80*(x[interior] - 0.5)^2 )\nivp = ODEProblem(ode!, init, (0., 0.25), -1)\nu = solve(ivp);","key":"ajml8sVZ9U"},{"type":"output","id":"OqxSQ4VW0BWCC5GldpjGP","data":[],"key":"K5PMcGJ4Mf"}],"data":{},"key":"lCpFKCltz8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"t = range(0, 0.2, 61)\nU = reduce(hcat, extend(u(t)) for t in t)\ncontour(x, t, U'; \n    color=:redsblues,  clims=(-1, 1),\n    xaxis=(L\"x\"),  yaxis=(L\"t\"), \n    title=\"Advection with outflow BC\",  right_margin=3Plots.mm)","visibility":"hide","key":"EfQmk9EVzo"},{"type":"output","id":"UHVQJYsauH6bs1VEwEawg","data":[{"output_type":"execute_result","execution_count":23,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"440d5ae8360f79119c4ce53b78480983","path":"/fnc/build/440d5ae8360f79119c4ce53b78480983.png"},"text/html":{"content_type":"text/html","hash":"c8c600a98db4fe04185c009463da493f","path":"/fnc/build/c8c600a98db4fe04185c009463da493f.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"f17c8e96a75187191820ebfbbfe11fe0","path":"/fnc/build/f17c8e96a75187191820ebfbbfe11fe0.svg"}}}],"visibility":"show","key":"HpvsEoloH2"}],"data":{"tags":[]},"visibility":"show","key":"tyPAAXzrGb"},{"type":"paragraph","position":{"start":{"line":267,"column":1},"end":{"line":267,"column":1}},"children":[{"type":"text","value":"This time, the solution blows up as soon as the hump runs into the boundary because there are conflicting demands there.","position":{"start":{"line":267,"column":1},"end":{"line":267,"column":1}},"key":"ReNPe7B5Kd"}],"key":"BlyuloU4PN"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"anim = @animate for t in range(0, 0.2, 41) \n    plot(x, extend(u(t));\n        label=@sprintf(\"t = %.4f\", t),\n        xaxis=(L\"x\"),  yaxis=(L\"u(x,t)\", (0, 1)), \n        title=\"Advection equation with outflow BC\",  dpi=150)\nend\nmp4(anim,\"figures/upwind-outflow.mp4\")","visibility":"hide","key":"SKnrgjanJJ"},{"type":"output","id":"LXaj-fnSZEE7lPs3lejxZ","data":[{"output_type":"stream","name":"stderr","text":"\u001b[36m\u001b[1m[ \u001b[22m\u001b[39m\u001b[36m\u001b[1mInfo: \u001b[22m\u001b[39mSaved animation to /Users/driscoll/Dropbox/Mac/Documents/GitHub/fnc/julia/figures/upwind-outflow.mp4\n"},{"output_type":"execute_result","execution_count":24,"metadata":{},"data":{"text/plain":{"content":"Plots.AnimatedGif(\"/Users/driscoll/Dropbox/Mac/Documents/GitHub/fnc/julia/figures/upwind-outflow.mp4\")","content_type":"text/plain"},"text/html":{"content_type":"text/html","hash":"026386b9931417a3f006ca7f77f92ec4","path":"/fnc/build/026386b9931417a3f006ca7f77f92ec4.html"}}}],"visibility":"show","key":"bSe2D7Pdgu"}],"data":{"tags":[]},"visibility":"show","key":"dejUoZLaWr"}],"label":"demo-upwind-direction-julia","identifier":"demo-upwind-direction-julia","html_id":"demo-upwind-direction-julia","key":"WcrcVpLCTE"},{"type":"heading","depth":3,"position":{"start":{"line":281,"column":1},"end":{"line":281,"column":1}},"children":[{"type":"text","value":"12.3 ","position":{"start":{"line":281,"column":1},"end":{"line":281,"column":1}},"key":"qMnMFJxQE2"},{"type":"link","identifier":"section-advection-absstab","label":"section-advection-absstab","kind":"narrative","position":{"start":{"line":281,"column":6},"end":{"line":281,"column":32}},"url":"/absstab-advection","internal":true,"dataUrl":"/absstab-advection.json","children":[{"type":"text","value":"Absolute stability","key":"HdygJFCMVE"}],"key":"meYcalHM6y"}],"identifier":"id-12-3","label":"12.3 ","html_id":"id-12-3","implicit":true,"key":"g3IUF5JBIe"},{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-absstab-advection","label":"demo-absstab-advection","kind":"proof:example","position":{"start":{"line":284,"column":1},"end":{"line":284,"column":24}},"children":[{"type":"text","value":"Example ","key":"TlzveIX008"},{"type":"text","value":"12.3.1","key":"Nj1kC7CMXM"}],"template":"Example %s","enumerator":"12.3.1","resolved":true,"html_id":"demo-absstab-advection","remote":true,"url":"/absstab-advection","dataUrl":"/absstab-advection.json","key":"NaVLr23dfc"}],"key":"RAp86BZt30"},{"type":"paragraph","position":{"start":{"line":285,"column":1},"end":{"line":285,"column":1}},"children":[{"type":"text","value":"For ","position":{"start":{"line":285,"column":1},"end":{"line":285,"column":1}},"key":"qB49HydVWD"},{"type":"inlineMath","value":"c=1","position":{"start":{"line":285,"column":1},"end":{"line":285,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>c</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">c=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">c</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"peZeQRFTHR"},{"type":"text","value":" we get purely imaginary eigenvalues.","position":{"start":{"line":285,"column":1},"end":{"line":285,"column":1}},"key":"zkrDz54DH7"}],"key":"lRMUE0hr9q"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"using Plots\nx, Dₓ = FNC.diffper(40, [0, 1])\nλ = eigvals(Dₓ);\nscatter(real(λ), imag(λ);\n    aspect_ratio = 1,  frame=:zerolines,\n    xlabel=\"Re λ\",  ylabel=\"Im λ\", \n    title=\"Eigenvalues for pure advection\",  legend=:none)","visibility":"hide","key":"bOFEfyNLx1"},{"type":"output","id":"WrHNUWW10I6kpnq8IhOtT","data":[{"output_type":"execute_result","execution_count":25,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"c357fdfd2deaf43c59f0ccf2bf43bae2","path":"/fnc/build/c357fdfd2deaf43c59f0ccf2bf43bae2.png"},"text/html":{"content_type":"text/html","hash":"3ac25708b0aedfa3155f40d5cdc602ec","path":"/fnc/build/3ac25708b0aedfa3155f40d5cdc602ec.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"63f89123b491a7ce9e60e7552c89762c","path":"/fnc/build/63f89123b491a7ce9e60e7552c89762c.svg"}}}],"visibility":"show","key":"vkpmuvtaVR"}],"data":{"tags":[]},"visibility":"show","key":"JwBMu2aE0b"},{"type":"paragraph","position":{"start":{"line":298,"column":1},"end":{"line":298,"column":1}},"children":[{"type":"text","value":"Let’s choose a time step of ","position":{"start":{"line":298,"column":1},"end":{"line":298,"column":1}},"key":"xD1K5Qh5il"},{"type":"inlineMath","value":"\\tau=0.1","position":{"start":{"line":298,"column":1},"end":{"line":298,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>τ</mi><mo>=</mo><mn>0.1</mn></mrow><annotation encoding=\"application/x-tex\">\\tau=0.1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.1132em;\">τ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0.1</span></span></span></span>","key":"GNCHHnPFNz"},{"type":"text","value":" and compare to the stability regions of the Euler and backward Euler time steppers (shown as shaded regions):","position":{"start":{"line":298,"column":1},"end":{"line":298,"column":1}},"key":"aNJbSc8sEQ"}],"key":"sNZPeo2Pa5"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"zc = @. cispi(2 * (0:360) / 360);     # points on |z|=1\nz = zc .- 1;                          # shift left by 1\nplot(Shape(real(z), imag(z)), color=RGB(.8, .8, 1))\nζ = 0.1 * λ\nscatter!(real(ζ), imag(ζ);\n    aspect_ratio=1,  frame=:zerolines,\n    xaxis=(\"Re ζ\", [-5, 5]),  yaxis=(\"Im ζ\", [-5, 5]),\n    title=\"Euler for advection\")","visibility":"hide","key":"LM1jlm1kG5"},{"type":"output","id":"OUMiuiVjpbwzzy0hicCv4","data":[{"output_type":"execute_result","execution_count":26,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"5b551d1f5d425ba03cfd6cc22bc6f2fb","path":"/fnc/build/5b551d1f5d425ba03cfd6cc22bc6f2fb.png"},"text/html":{"content_type":"text/html","hash":"e35fc912f2a4eabcce93245d61cc0973","path":"/fnc/build/e35fc912f2a4eabcce93245d61cc0973.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"e0833c9a1f9e3d340fbc1aa86d7ea606","path":"/fnc/build/e0833c9a1f9e3d340fbc1aa86d7ea606.svg"}}}],"visibility":"show","key":"c5wxKPBUqa"}],"data":{"tags":[]},"visibility":"show","key":"CAPaHiSAd3"},{"type":"paragraph","position":{"start":{"line":312,"column":1},"end":{"line":312,"column":1}},"children":[{"type":"text","value":"In the Euler case it’s clear that ","position":{"start":{"line":312,"column":1},"end":{"line":312,"column":1}},"key":"oPViOoWjjc"},{"type":"emphasis","position":{"start":{"line":312,"column":1},"end":{"line":312,"column":1}},"children":[{"type":"text","value":"no","position":{"start":{"line":312,"column":1},"end":{"line":312,"column":1}},"key":"UydwM9nThH"}],"key":"AvzRKU7Z3F"},{"type":"text","value":" real value of ","position":{"start":{"line":312,"column":1},"end":{"line":312,"column":1}},"key":"Sx2yaRTXoU"},{"type":"inlineMath","value":"\\tau>0","position":{"start":{"line":312,"column":1},"end":{"line":312,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>τ</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">\\tau&gt;0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.1132em;\">τ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&gt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"wYO4QoyKjg"},{"type":"text","value":" is going to make ","position":{"start":{"line":312,"column":1},"end":{"line":312,"column":1}},"key":"A7P39ANzSR"},{"type":"text","value":"ζ","position":{"start":{"line":312,"column":1},"end":{"line":312,"column":1}},"key":"DSKc6sunLA"},{"type":"text","value":" values fit within the stability region. Any method whose stability region includes none of the imaginary axis is an unsuitable choice for advection.","position":{"start":{"line":312,"column":1},"end":{"line":312,"column":1}},"key":"FmhFB1G2dw"}],"key":"HKRuX2nLuO"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"z = zc .+ 1;                        # shift circle right by 1\nplot(Shape([-6, 6, 6, -6], [-6, -6, 6, 6]), color=RGB(.8, .8, 1))\nplot!(Shape(real(z), imag(z)), color=:white)\nscatter!(real(ζ), imag(ζ);\n    aspect_ratio=1,  frame=:zerolines,\n    xaxis=(\"Re ζ\", [-5, 5]),  yaxis=(\"Im ζ\", [-5, 5]),\n    title=\"Backward Euler for advection\")","visibility":"hide","key":"dq3J5U1tNv"},{"type":"output","id":"Ef26LvkR5bDcewuSiAOT3","data":[{"output_type":"execute_result","execution_count":27,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"83e4bb088ef7e7a300e319c20012e5e7","path":"/fnc/build/83e4bb088ef7e7a300e319c20012e5e7.png"},"text/html":{"content_type":"text/html","hash":"30b48c92b283f17bd1eed9d0e8659237","path":"/fnc/build/30b48c92b283f17bd1eed9d0e8659237.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"a0323c9589f4a9f390c6aa8c721db3a4","path":"/fnc/build/a0323c9589f4a9f390c6aa8c721db3a4.svg"}}}],"visibility":"show","key":"FtLZWDLAVB"}],"data":{"tags":[]},"visibility":"show","key":"glNb0cWDvj"},{"type":"paragraph","position":{"start":{"line":325,"column":1},"end":{"line":325,"column":1}},"children":[{"type":"text","value":"The A-stable backward Euler time stepping tells the exact opposite story: it will be absolutely stable for any choice of the time step ","position":{"start":{"line":325,"column":1},"end":{"line":325,"column":1}},"key":"Lw8NHERzvB"},{"type":"text","value":"τ","position":{"start":{"line":325,"column":1},"end":{"line":325,"column":1}},"key":"X8FqfVGsRf"},{"type":"text","value":".","position":{"start":{"line":325,"column":1},"end":{"line":325,"column":1}},"key":"aGmzL7FYIb"}],"key":"GAhuUdjyz9"}],"label":"demo-absstab-advection-julia","identifier":"demo-absstab-advection-julia","html_id":"demo-absstab-advection-julia","key":"P8HpynwV0Z"},{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-absstab-advdiff","label":"demo-absstab-advdiff","kind":"proof:example","position":{"start":{"line":329,"column":1},"end":{"line":329,"column":22}},"children":[{"type":"text","value":"Example ","key":"HqCe3bwadu"},{"type":"text","value":"12.3.2","key":"b4LiXYCxUQ"}],"template":"Example %s","enumerator":"12.3.2","resolved":true,"html_id":"demo-absstab-advdiff","remote":true,"url":"/absstab-advection","dataUrl":"/absstab-advection.json","key":"etdnygIy6C"}],"key":"axzsDbtwNa"},{"type":"paragraph","position":{"start":{"line":330,"column":1},"end":{"line":330,"column":1}},"children":[{"type":"text","value":"The eigenvalues of advection-diffusion are near-imaginary for ","position":{"start":{"line":330,"column":1},"end":{"line":330,"column":1}},"key":"YMqEgu7rBx"},{"type":"inlineMath","value":"\\epsilon\\approx 0","position":{"start":{"line":330,"column":1},"end":{"line":330,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ϵ</mi><mo>≈</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">\\epsilon\\approx 0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4831em;\"></span><span class=\"mord mathnormal\">ϵ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"pvf486glev"},{"type":"text","value":" and get closer to the negative real axis as ","position":{"start":{"line":330,"column":1},"end":{"line":330,"column":1}},"key":"vmoV7bsrZw"},{"type":"text","value":"ε","position":{"start":{"line":330,"column":1},"end":{"line":330,"column":1}},"key":"htzRvC7Zbw"},{"type":"text","value":" increases.","position":{"start":{"line":330,"column":1},"end":{"line":330,"column":1}},"key":"Mux73AkPgw"}],"key":"VG2fzkGJ1f"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"plt = plot(\n    legend=:topleft,\n    aspect_ratio=1,\n    xlabel=\"Re ζ\",  ylabel=\"Im ζ\",\n    title=\"Eigenvalues for advection-diffusion\")\nx, Dₓ, Dₓₓ = FNC.diffper(40, [0, 1]);\nfor ϵ in [0.001, 0.01, 0.05]\n    λ = eigvals(-Dₓ + ϵ*Dₓₓ)\n    scatter!(real(λ), imag(λ), m=:o, label=\"\\\\epsilon = $ϵ\")\nend\nplt","visibility":"hide","key":"H66sVLGWA0"},{"type":"output","id":"IO7dRikeqeGmSo3YrcbL3","data":[{"output_type":"execute_result","execution_count":28,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"1520fc53fba698d621bc014dfabb0ea2","path":"/fnc/build/1520fc53fba698d621bc014dfabb0ea2.png"},"text/html":{"content_type":"text/html","hash":"90a450f8188d7c6b9c45cf3a4fcd8569","path":"/fnc/build/90a450f8188d7c6b9c45cf3a4fcd8569.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"0171264f7ba3d8bda06b4d297b335896","path":"/fnc/build/0171264f7ba3d8bda06b4d297b335896.svg"}}}],"visibility":"show","key":"BWZK2gs3fV"}],"data":{"tags":[]},"visibility":"show","key":"Xfd6ISSgUH"}],"label":"demo-absstab-advdiff-julia","identifier":"demo-absstab-advdiff-julia","html_id":"demo-absstab-advdiff-julia","key":"DApoyHMb8H"},{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-absstab-inflow","label":"demo-absstab-inflow","kind":"proof:example","position":{"start":{"line":349,"column":1},"end":{"line":349,"column":21}},"children":[{"type":"text","value":"Example ","key":"GeHn10ywqM"},{"type":"text","value":"12.3.3","key":"TOPFlAxX5D"}],"template":"Example %s","enumerator":"12.3.3","resolved":true,"html_id":"demo-absstab-inflow","remote":true,"url":"/absstab-advection","dataUrl":"/absstab-advection.json","key":"VA5dQfvkRz"}],"key":"dAcmu3DsBk"},{"type":"paragraph","position":{"start":{"line":350,"column":1},"end":{"line":350,"column":1}},"children":[{"type":"text","value":"Deleting the last row and column places all the eigenvalues of the discretization into the left half of the complex plane.","position":{"start":{"line":350,"column":1},"end":{"line":350,"column":1}},"key":"BfV8kqrvrx"}],"key":"EV1dEv4huU"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"x, Dₓ, _ = FNC.diffcheb(40, [0, 1])\nA = Dₓ[1:end-1, 1:end-1];     # delete last row and column\nλ = eigvals(A);","key":"vwVcbVbXsD"},{"type":"output","id":"caV-aUUq1pnkCYdMFwOL1","data":[],"key":"wo32DjPe5A"}],"data":{},"key":"KMZs977RUK"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"scatter(real(λ), imag(λ);\n    m=3,  aspect_ratio=1,\n    legend=:none,  frame=:zerolines,\n    xaxis=([-300, 100], \"Re λ\"),  yaxis=(\"Im λ\"),\n    title=\"Eigenvalues of advection with zero inflow\")","visibility":"hide","key":"bGlA7wA8yI"},{"type":"output","id":"OALqDuDsEv08Hb1sMWe93","data":[{"output_type":"execute_result","execution_count":30,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"7db3214b712e3e4931fddd30cf15b55a","path":"/fnc/build/7db3214b712e3e4931fddd30cf15b55a.png"},"text/html":{"content_type":"text/html","hash":"56befee77946aaff2a1f57adf28707da","path":"/fnc/build/56befee77946aaff2a1f57adf28707da.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"acd707649cbbef7e5f387e0195e71cac","path":"/fnc/build/acd707649cbbef7e5f387e0195e71cac.svg"}}}],"visibility":"show","key":"jmJB0jiRva"}],"data":{"tags":[]},"visibility":"show","key":"HhKixIY9s4"},{"type":"paragraph","position":{"start":{"line":368,"column":1},"end":{"line":368,"column":1}},"children":[{"type":"text","value":"Note that the rightmost eigenvalues have real part at most","position":{"start":{"line":368,"column":1},"end":{"line":368,"column":1}},"key":"ZSDRJYosgW"}],"key":"PxLyihoAea"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"maximum(real(λ))","key":"oQNzHl4BT4"},{"type":"output","id":"oStVYz5YgTbhTxU7KCbvm","data":[{"output_type":"execute_result","execution_count":31,"metadata":{},"data":{"text/plain":{"content":"-4.931967035822774","content_type":"text/plain"}}}],"key":"ZsFAEI9hJR"}],"data":{},"key":"jkDG84fUze"},{"type":"paragraph","position":{"start":{"line":374,"column":1},"end":{"line":374,"column":1}},"children":[{"type":"text","value":"Consequently all solutions decay exponentially to zero as ","position":{"start":{"line":374,"column":1},"end":{"line":374,"column":1}},"key":"uETcZdrhFZ"},{"type":"inlineMath","value":"t\\to\\infty","position":{"start":{"line":374,"column":1},"end":{"line":374,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi><mo>→</mo><mi mathvariant=\"normal\">∞</mi></mrow><annotation encoding=\"application/x-tex\">t\\to\\infty</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord\">∞</span></span></span></span>","key":"I0pWft4TUf"},{"type":"text","value":". This matches our observation of the solution: eventually, everything flows out of the domain.","position":{"start":{"line":374,"column":1},"end":{"line":374,"column":1}},"key":"l5paaa5PCd"}],"key":"OQbHpTYdTE"}],"label":"demo-absstab-inflow-julia","identifier":"demo-absstab-inflow-julia","html_id":"demo-absstab-inflow-julia","key":"JG8ED4d62H"},{"type":"heading","depth":3,"position":{"start":{"line":378,"column":1},"end":{"line":378,"column":1}},"children":[{"type":"text","value":"12.4 ","position":{"start":{"line":378,"column":1},"end":{"line":378,"column":1}},"key":"jHU9s5AwUD"},{"type":"link","identifier":"section-advection-wave","label":"section-advection-wave","kind":"narrative","position":{"start":{"line":378,"column":6},"end":{"line":378,"column":29}},"url":"/wave","internal":true,"dataUrl":"/wave.json","children":[{"type":"text","value":"The wave equation","key":"x8mahJM6dl"}],"key":"oVON6rP43n"}],"identifier":"id-12-4","label":"12.4 ","html_id":"id-12-4","implicit":true,"key":"tg0k4Jcura"},{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-wave-boundaries","label":"demo-wave-boundaries","kind":"proof:example","position":{"start":{"line":381,"column":1},"end":{"line":381,"column":22}},"children":[{"type":"text","value":"Example ","key":"Xm5BER4Q14"},{"type":"text","value":"12.4.1","key":"e1RhYNTMnH"}],"template":"Example %s","enumerator":"12.4.1","resolved":true,"html_id":"demo-wave-boundaries","remote":true,"url":"/wave","dataUrl":"/wave.json","key":"o09pyi9cdd"}],"key":"tTsKaA3sZK"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"m = 200\nx, Dₓ = FNC.diffcheb(m, [-1, 1]);","key":"p3zcXWFuX5"},{"type":"output","id":"joDexbz8bRK0pSyImE1om","data":[],"key":"ytRgsysYfD"}],"data":{},"key":"v5Zm8cqxeq"},{"type":"paragraph","position":{"start":{"line":388,"column":1},"end":{"line":388,"column":1}},"children":[{"type":"text","value":"The boundary values of ","position":{"start":{"line":388,"column":1},"end":{"line":388,"column":1}},"key":"PwF0nlOTUB"},{"type":"inlineMath","value":"u","position":{"start":{"line":388,"column":1},"end":{"line":388,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span>","key":"IuzpHFdznY"},{"type":"text","value":" are given to be zero, so they are not unknowns in the ","key":"OW8Xj5Pp9l"},{"type":"abbreviation","title":"ordinary differential equation","children":[{"type":"text","value":"ODE","key":"UhOWL9CKfO"}],"key":"sVkZnFjGjk"},{"type":"text","value":"s. Instead they are added or removed as necessary.","key":"FWvgej3D80"}],"key":"HGg6Hlqj4J"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"extend = v -> [0; v; 0]\nchop = u -> u[2:m];","key":"geCTM8LMnc"},{"type":"output","id":"Qya3OxthK5H7ESmcP_zSy","data":[],"key":"Uz1WCQ8n9n"}],"data":{},"key":"FeS2StlVC2"},{"type":"paragraph","position":{"start":{"line":395,"column":1},"end":{"line":395,"column":1}},"children":[{"type":"text","value":"The following function computes the time derivative of the system at interior points.","position":{"start":{"line":395,"column":1},"end":{"line":395,"column":1}},"key":"vmZoDCe2Ko"}],"key":"HT0BmOxXc6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"ode = function(w, c, t)\n    u = extend(w[1:m-1])\n    z = w[m:2m]\n    du_dt = Dₓ * z\n    dz_dt = c^2 * (Dₓ * u)\n    return [ chop(du_dt); dz_dt ]\nend;","key":"INikgT8mOA"},{"type":"output","id":"Y-gx6Yxl4y9KUiwzjpEj8","data":[],"key":"MqJBLGeUGT"}],"data":{},"key":"mECh1l1udv"},{"type":"paragraph","position":{"start":{"line":407,"column":1},"end":{"line":407,"column":1}},"children":[{"type":"text","value":"Our initial condition is a single hump for ","position":{"start":{"line":407,"column":1},"end":{"line":407,"column":1}},"key":"OVb9qhH7ih"},{"type":"inlineMath","value":"u","position":{"start":{"line":407,"column":1},"end":{"line":407,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span>","key":"BF3D8cf2s4"},{"type":"text","value":".","position":{"start":{"line":407,"column":1},"end":{"line":407,"column":1}},"key":"AvkQj2Ow1l"}],"key":"rJlLzAi4Iv"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"u_init = @. exp( -100*(x + 0.5)^2 )\nz_init = -u_init\nw_init = [ chop(u_init); z_init ];","key":"rqriVSbaGh"},{"type":"output","id":"0tzNWzBGNcCOijPNl3oT9","data":[],"key":"KHsX75i1pO"}],"data":{},"key":"aNw2Fcu9su"},{"type":"paragraph","position":{"start":{"line":415,"column":1},"end":{"line":415,"column":1}},"children":[{"type":"text","value":"Because the wave equation is hyperbolic, we can use a nonstiff explicit solver.","position":{"start":{"line":415,"column":1},"end":{"line":415,"column":1}},"key":"xcp6vDEUdi"}],"key":"wzatl8PpWl"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"using OrdinaryDiffEq\nIVP = ODEProblem(ode, w_init ,(0., 2.), 2)\nw = solve(IVP, RK4());","key":"Hz8vlu3UDP"},{"type":"output","id":"z76Fg4DFmRKgF_uzWLHdP","data":[],"key":"ujGcA8ptwf"}],"data":{},"key":"sm5rsEVGu6"},{"type":"paragraph","position":{"start":{"line":423,"column":1},"end":{"line":423,"column":1}},"children":[{"type":"text","value":"We plot the results for the original ","position":{"start":{"line":423,"column":1},"end":{"line":423,"column":1}},"key":"MhP9WDAj5h"},{"type":"inlineMath","value":"u","position":{"start":{"line":423,"column":1},"end":{"line":423,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span>","key":"ojEwZpUvr4"},{"type":"text","value":" variable only. Its interior values are at indices ","position":{"start":{"line":423,"column":1},"end":{"line":423,"column":1}},"key":"EFNuL6blHx"},{"type":"inlineCode","value":"1:m-1","position":{"start":{"line":423,"column":1},"end":{"line":423,"column":1}},"key":"BPCx4u5kU3"},{"type":"text","value":" of the composite ","position":{"start":{"line":423,"column":1},"end":{"line":423,"column":1}},"key":"gG0wYYDOSg"},{"type":"inlineMath","value":"\\mathbf{w}","position":{"start":{"line":423,"column":1},"end":{"line":423,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">w</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{w}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4444em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">w</span></span></span></span>","key":"zI4eef0Fbl"},{"type":"text","value":" variable.","position":{"start":{"line":423,"column":1},"end":{"line":423,"column":1}},"key":"F8AiwPHTJT"}],"key":"H1rUe76ptR"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"using Plots\nt = range(0, 2, 80)\nU = [extend(w(t)[1:m-1]) for t in t]\ncontour(x, t, hcat(U...)';\n    levels=24,\n    color=:redsblues,  clims=(-1, 1),\n    xlabel=L\"x\",  ylabel=L\"t\",\n    title=\"Wave equation\",  right_margin=3Plots.mm)","key":"XgRdqlag6M"},{"type":"output","id":"mOGMoHsL7_GCuEbmz2q1C","data":[{"output_type":"execute_result","execution_count":37,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"2696b8ee721069072dcd739e4f62ebe9","path":"/fnc/build/2696b8ee721069072dcd739e4f62ebe9.png"},"text/html":{"content_type":"text/html","hash":"a3dc840041c5642291b633db2b209392","path":"/fnc/build/a3dc840041c5642291b633db2b209392.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"7fdb22ae7aa26ad43103cfe6264757e6","path":"/fnc/build/7fdb22ae7aa26ad43103cfe6264757e6.svg"}}}],"key":"EjswgyRvcU"}],"data":{},"key":"pKwacswHrR"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"anim = @animate for t in range(0 ,2, 120)\n    plot(x, extend(w(t)[1:m-1]);\n        label=@sprintf(\"t=%.3f\",t),\n        xaxis=(L\"x\"),  yaxis=([-1, 1], L\"u(x,t)\"),\n        dpi=150,  title=\"Wave equation\")\nend\nmp4(anim, \"figures/wave-boundaries.mp4\")","visibility":"hide","key":"axaGKRqiYv"},{"type":"output","id":"VklCrcswPvOiPhW6gnvUU","data":[{"output_type":"stream","name":"stderr","text":"\u001b[36m\u001b[1m[ \u001b[22m\u001b[39m\u001b[36m\u001b[1mInfo: \u001b[22m\u001b[39mSaved animation to /Users/driscoll/Dropbox/Mac/Documents/GitHub/fnc/julia/figures/wave-boundaries.mp4\n"},{"output_type":"execute_result","execution_count":38,"metadata":{},"data":{"text/plain":{"content":"Plots.AnimatedGif(\"/Users/driscoll/Dropbox/Mac/Documents/GitHub/fnc/julia/figures/wave-boundaries.mp4\")","content_type":"text/plain"},"text/html":{"content_type":"text/html","hash":"0faa4a250f8c6ad949c5b0b3a5a77d64","path":"/fnc/build/0faa4a250f8c6ad949c5b0b3a5a77d64.html"}}}],"visibility":"show","key":"f7IVaHwG9p"}],"data":{"tags":[]},"visibility":"show","key":"LqiRafwVaz"},{"type":"paragraph","position":{"start":{"line":447,"column":1},"end":{"line":447,"column":1}},"children":[{"type":"text","value":"The original hump breaks into two pieces of different amplitudes, each traveling with speed ","position":{"start":{"line":447,"column":1},"end":{"line":447,"column":1}},"key":"wSVwzNemQS"},{"type":"inlineMath","value":"c=2","position":{"start":{"line":447,"column":1},"end":{"line":447,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>c</mi><mo>=</mo><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">c=2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">c</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span></span></span></span>","key":"qooYp17PHJ"},{"type":"text","value":". They pass through one another without interference. When a hump encounters a boundary, it is perfectly reflected, but with inverted shape. At time ","position":{"start":{"line":447,"column":1},"end":{"line":447,"column":1}},"key":"TpsX5D5pBM"},{"type":"inlineMath","value":"t=2","position":{"start":{"line":447,"column":1},"end":{"line":447,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi><mo>=</mo><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">t=2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span></span></span></span>","key":"EIJ1weEQel"},{"type":"text","value":", the solution looks just like the initial condition.","position":{"start":{"line":447,"column":1},"end":{"line":447,"column":1}},"key":"P2MmyzbPmH"}],"key":"j3Dpms38QD"}],"label":"demo-wave-boundaries-julia","identifier":"demo-wave-boundaries-julia","html_id":"demo-wave-boundaries-julia","key":"AkePy8ujqw"},{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-wave-speed","label":"demo-wave-speed","kind":"proof:example","position":{"start":{"line":452,"column":1},"end":{"line":452,"column":17}},"children":[{"type":"text","value":"Example ","key":"PsAxkZbnKv"},{"type":"text","value":"12.4.2","key":"JY8apEaJYk"}],"template":"Example %s","enumerator":"12.4.2","resolved":true,"html_id":"demo-wave-speed","remote":true,"url":"/wave","dataUrl":"/wave.json","key":"uH20wujNZb"}],"key":"xFASN8Be7B"},{"type":"paragraph","position":{"start":{"line":453,"column":1},"end":{"line":453,"column":1}},"children":[{"type":"text","value":"The ","key":"cTz5K9BXUP"},{"type":"abbreviation","title":"ordinary differential equation","children":[{"type":"text","value":"ODE","key":"XpTu72S7gD"}],"key":"pUVjNjZc5y"},{"type":"text","value":" implementation has to change slightly.","key":"gZvYzEnL5Y"}],"key":"VH2hSFT2An"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"ode = function(w,c,t)\n    u = extend(w[1:m-1])\n    z = w[m:2m]\n    du_dt = Dₓ*z\n    dz_dt = c.^2 .* (Dₓ*u)\n    return [ chop(du_dt); dz_dt ]\nend;","key":"p86Bs1yUlH"},{"type":"output","id":"Frw6fAq5vLGOj8oWd67Xe","data":[],"key":"TZ88QXhSFI"}],"data":{},"key":"fUcj6ljm8G"},{"type":"paragraph","position":{"start":{"line":465,"column":1},"end":{"line":465,"column":1}},"children":[{"type":"text","value":"The variable wave speed is passed as an extra parameter through the ","key":"y23WQ5gfWz"},{"type":"abbreviation","title":"initial-value problem","children":[{"type":"text","value":"IVP","key":"Tdn6iAR96F"}],"key":"DAhHNJqyRh"},{"type":"text","value":" solver.","key":"vdp039pL52"}],"key":"va5LB2cNM9"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"c = @. 1 + (sign(x)+1)/2\nIVP = ODEProblem(ode, w_init, (0., 5.), c)\nw = solve(IVP, RK4());","key":"TYqcrmmWip"},{"type":"output","id":"lH-TjlLKNufMbr-zWDhqF","data":[],"key":"DoStly7COl"}],"data":{},"key":"vZuK6MRnED"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"t = range(0, 5, 80)\nU = [extend(w(t)[1:m-1]) for t in t]\ncontour(x, t, hcat(U...)';\n    color=:redsblues,  clims=(-1,1),\n    levels=24,\n    xlabel=L\"x\",  ylabel=L\"t\",\n    title=\"Wave equation\",\n    right_margin=3Plots.mm\n    )","key":"wGiec86yxr"},{"type":"output","id":"hIh1zxc1yWWloSsas6PjT","data":[{"output_type":"execute_result","execution_count":41,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"a598559cd3c7d950cda10aff7ae1171b","path":"/fnc/build/a598559cd3c7d950cda10aff7ae1171b.png"},"text/html":{"content_type":"text/html","hash":"a074f5267115fb403984c666c73251d7","path":"/fnc/build/a074f5267115fb403984c666c73251d7.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"ae131055357225bc8b8f7e5e94e1029f","path":"/fnc/build/ae131055357225bc8b8f7e5e94e1029f.svg"}}}],"key":"oCmaRul1TR"}],"data":{},"key":"bjM8D41jkj"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"anim = @animate for t in range(0,5,181)\n    plot(Shape([-1, 0, 0, -1], [-1, -1, 1, 1]), color=RGB(.8, .8, .8), l=0, label=\"\")\n    plot!(x, extend(w(t, idxs=1:m-1));\n        label=@sprintf(\"t=%.2f\", t), \n        xaxis=(L\"x\"),  yaxis=([-1, 1], L\"u(x,t)\"),\n        dpi=150,  title=\"Wave equation, variable speed\")\nend\nmp4(anim, \"figures/wave-speed.mp4\")","visibility":"hide","key":"m3t1NPNOEP"},{"type":"output","id":"4RSAv-9MMYR2jvUKn3eGb","data":[{"output_type":"stream","name":"stderr","text":"\u001b[36m\u001b[1m[ \u001b[22m\u001b[39m\u001b[36m\u001b[1mInfo: \u001b[22m\u001b[39mSaved animation to /Users/driscoll/Dropbox/Mac/Documents/GitHub/fnc/julia/figures/wave-speed.mp4\n"},{"output_type":"execute_result","execution_count":42,"metadata":{},"data":{"text/plain":{"content":"Plots.AnimatedGif(\"/Users/driscoll/Dropbox/Mac/Documents/GitHub/fnc/julia/figures/wave-speed.mp4\")","content_type":"text/plain"},"text/html":{"content_type":"text/html","hash":"82b4de29af1675350c9503e441b8f79f","path":"/fnc/build/82b4de29af1675350c9503e441b8f79f.html"}}}],"visibility":"show","key":"NjLrEQJo3f"}],"data":{"tags":[]},"visibility":"show","key":"rregSnhiYv"},{"type":"paragraph","position":{"start":{"line":497,"column":1},"end":{"line":497,"column":1}},"children":[{"type":"text","value":"Each pass through the interface at ","position":{"start":{"line":497,"column":1},"end":{"line":497,"column":1}},"key":"nElzKgrMS9"},{"type":"inlineMath","value":"x=0","position":{"start":{"line":497,"column":1},"end":{"line":497,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">x=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"hPmw8XFiIq"},{"type":"text","value":" generates a reflected and transmitted wave. By conservation of energy, these are both smaller in amplitude than the incoming bump.","position":{"start":{"line":497,"column":1},"end":{"line":497,"column":1}},"key":"ykJjWu69iO"}],"key":"cyXVJWq88p"}],"label":"demo-wave-speed-julia","identifier":"demo-wave-speed-julia","html_id":"demo-wave-speed-julia","key":"BGDcMoqvBL"}],"key":"K72uuzMi1k"}],"key":"WQim7NVQJj"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Chapter 11","url":"/chapter11","group":"Julia codes"},"next":{"title":"Chapter 13","url":"/chapter13","group":"Julia codes"}}},"domain":"http://localhost:3000"}