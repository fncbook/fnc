{"kind":"Notebook","sha256":"de7386a9b9dd62418f4fccb24578f09e87c3faf476115cc34f7e35c3394ef7e0","slug":"basic-2","location":"/chapter6/section5/python/basic.ipynb","dependencies":[],"frontmatter":{"numbering":{"heading_1":{"enabled":false},"heading_2":{"enabled":false},"heading_3":{"enabled":false},"heading_4":{"enabled":false},"heading_5":{"enabled":false},"heading_6":{"enabled":false}},"kernelspec":{"name":"python3","display_name":"Python 3","language":"python"},"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"exports":[{"format":"ipynb","filename":"basic.ipynb","url":"/fnc/build/basic-2d526e3f790526e35e96eab8ceb78753.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T16:37:28.980163Z","iopub.status.busy":"2025-01-11T16:37:28.980073Z","iopub.status.idle":"2025-01-11T16:37:29.287406Z","shell.execute_reply":"2025-01-11T16:37:29.287004Z"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"exec(open(\"../../../python/FNC_init.py\").read())","visibility":"show","key":"SitYMSzkXV"},{"type":"output","id":"4KmpwGo-ZtcFS7_eX2Qhq","data":[],"visibility":"show","key":"SdNCEwphTt"}],"visibility":"remove","key":"DjLcP7GCyv"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"ava3ozN25x"},{"type":"text","value":"6.5.1","key":"nsnTK4ga72"}],"key":"TlWWroDaFR"}],"identifier":"demo-adapt-basic","label":"demo-adapt-basic","kind":"proof:example","template":"Example %s","enumerator":"6.5.1","resolved":true,"html_id":"demo-adapt-basic","remote":true,"url":"/adaptive-rk","dataUrl":"/adaptive-rk.json","key":"VehwIhZqGO"}],"key":"ydbtEY64cy"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Let’s run adaptive RK on  ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"MAy1ge3lls"},{"type":"inlineMath","value":"u'=e^{t-u\\sin u}","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>u</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo>=</mo><msup><mi>e</mi><mrow><mi>t</mi><mo>−</mo><mi>u</mi><mi>sin</mi><mo>⁡</mo><mi>u</mi></mrow></msup></mrow><annotation encoding=\"application/x-tex\">u&#x27;=e^{t-u\\sin u}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8305em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8305em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mbin mtight\">−</span><span class=\"mord mathnormal mtight\">u</span><span class=\"mspace mtight\" style=\"margin-right:0.1952em;\"></span><span class=\"mop mtight\"><span class=\"mtight\">s</span><span class=\"mtight\">i</span><span class=\"mtight\">n</span></span><span class=\"mspace mtight\" style=\"margin-right:0.1952em;\"></span><span class=\"mord mathnormal mtight\">u</span></span></span></span></span></span></span></span></span></span></span></span>","key":"nXSzMBaPTS"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"pG6isGYau2"}],"key":"LcjiLOhC96"}],"key":"oKQ0eWCzPl"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T16:37:29.289067Z","iopub.status.busy":"2025-01-11T16:37:29.288903Z","iopub.status.idle":"2025-01-11T16:37:29.425192Z","shell.execute_reply":"2025-01-11T16:37:29.424916Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"f = lambda t, u: exp(t - u * sin(u))\nt, u = FNC.rk23(f, [0.0, 5.0], [0.0], 1e-5)\nscatter(t, u[0, :])\nxlabel(\"$t$\"), ylabel(\"$u(t)$\")\ntitle((\"Adaptive IVP solution\"));","key":"cGOpN3bTmu"},{"type":"output","id":"MqEo1L46RPg7WtUdLvT6N","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"2c0ef544586d85369ca444b7e24692df","path":"/fnc/build/2c0ef544586d85369ca444b7e24692df.png"},"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"}}}],"key":"gs2kvHGOC6"}],"key":"wuqJCEQpCp"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The solution makes a very abrupt change near ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"AyQA3M7PIs"},{"type":"inlineMath","value":"t=2.4","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi><mo>=</mo><mn>2.4</mn></mrow><annotation encoding=\"application/x-tex\">t=2.4</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2.4</span></span></span></span>","key":"bxX59B4WH2"},{"type":"text","value":". The resulting time steps vary over three orders of magnitude.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hrC57KF14H"}],"key":"MzkMgh20Ao"}],"key":"bdMPtzwwDH"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T16:37:29.427022Z","iopub.status.busy":"2025-01-11T16:37:29.426694Z","iopub.status.idle":"2025-01-11T16:37:29.581940Z","shell.execute_reply":"2025-01-11T16:37:29.581625Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"dt = [t[i + 1] - t[i] for i in range(t.size - 1)]\nsemilogy(t[:-1], dt)\nxlabel(\"$t$\"), ylabel(\"time step\")\ntitle((\"Adaptive step sizes\"));","key":"zfx0pYfDmp"},{"type":"output","id":"1NRSF6dQLbVWtWInPCd67","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"6f5f1476588f27b429711a2efee7a657","path":"/fnc/build/6f5f1476588f27b429711a2efee7a657.png"},"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"}}}],"key":"kr3r0dJn1T"}],"key":"rvnJZhwag5"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"If we had to run with a uniform step size to get this accuracy, it would be","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RnlH6Pobgb"}],"key":"PQq61e0hQa"}],"key":"gao2nRs7Ni"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T16:37:29.583392Z","iopub.status.busy":"2025-01-11T16:37:29.583269Z","iopub.status.idle":"2025-01-11T16:37:29.585243Z","shell.execute_reply":"2025-01-11T16:37:29.584958Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"print(f\"min step size was {min(dt):.2e}\")","key":"dV8Dr4QEtZ"},{"type":"output","id":"7-i9n6EO2c_BwlULGuppc","data":[{"name":"stdout","output_type":"stream","text":"min step size was 4.61e-05\n"}],"key":"dBu8xWJxkC"}],"key":"HybJvWCMAg"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"On the other hand, the average step size that was actually taken was","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ZQbgR1VYGM"}],"key":"NpLdjbUA1h"}],"key":"o1pqyOMeXH"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T16:37:29.586455Z","iopub.status.busy":"2025-01-11T16:37:29.586341Z","iopub.status.idle":"2025-01-11T16:37:29.588103Z","shell.execute_reply":"2025-01-11T16:37:29.587874Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"print(f\"mean step size was {mean(dt):.2e}\")","key":"BXvAd8UreT"},{"type":"output","id":"pFqiAMnqSIEdENOR-hcaO","data":[{"name":"stdout","output_type":"stream","text":"mean step size was 3.21e-02\n"}],"key":"n2E7TLMLwN"}],"key":"Ok52a1VBGu"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We took fewer steps by a factor of 1000! Even accounting for the extra stage per step and the occasional rejected step, the savings are clear.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"D5kKsQdzhJ"}],"key":"knaCQpMdXA"}],"key":"tXpRxrMRx9"}],"key":"Li34BtiSBc"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Converge","url":"/converge-27","group":"Chapter 6"},"next":{"title":"Sing","url":"/sing-5","group":"Chapter 6"}}},"domain":"http://localhost:3000"}