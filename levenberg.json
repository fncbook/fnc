{"kind":"Notebook","sha256":"899c8bcf23b7552a21cadf74dfb9b009f510d18cd8323367eccb8859ed594667","slug":"levenberg","location":"/chapter4/section6/julia/levenberg.ipynb","dependencies":[],"frontmatter":{"numbering":{"heading_1":{"enabled":false},"heading_2":{"enabled":false},"heading_3":{"enabled":false},"heading_4":{"enabled":false},"heading_5":{"enabled":false},"heading_6":{"enabled":false}},"kernelspec":{"name":"julia-1.11","display_name":"Julia 1","language":"julia"},"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"exports":[{"format":"ipynb","filename":"levenberg.ipynb","url":"/fnc/build/levenberg-b90e81c6b0367305dd6d5580f854f429.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"HvTb4XoiFS"},{"type":"text","value":"4.6.1","key":"VepkJWhOTE"}],"key":"pzhnF9Mwia"}],"identifier":"demo-quasi-levenberg","label":"demo-quasi-levenberg","kind":"proof:example","template":"Example %s","enumerator":"4.6.1","resolved":true,"html_id":"demo-quasi-levenberg","remote":true,"url":"/quasinewton","dataUrl":"/quasinewton.json","key":"h9zFGi9iR4"}],"key":"s89KdrTNhK"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"To solve a nonlinear system, we need to code only the function defining the system, and not its Jacobian.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"oWP9uU6XfI"}],"key":"fjg2sk8AIf"}],"key":"jhu2CEQtDl"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:34:16.365000Z","iopub.status.busy":"2025-01-14T15:34:07.428000Z","iopub.execute_input":"2025-01-14T15:34:10.615000Z","shell.execute_reply":"2025-01-14T15:34:16.352000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"f(x) = \n    [\n        exp(x[2] - x[1]) - 2,\n        x[1] * x[2] + x[3],\n        x[2] * x[3] + x[1]^2 - x[2]\n    ]","key":"pWfOEZQagl"},{"type":"output","id":"LD1WtanUqWn65AQg6bfJa","data":[{"output_type":"execute_result","execution_count":2,"metadata":{},"data":{"text/plain":{"content":"f (generic function with 1 method)","content_type":"text/plain"}}}],"key":"Yokj4y3gZl"}],"key":"FtPLptTZhI"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"In all other respects usage is the same as for the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WKFP1v3rs0"},{"type":"inlineCode","value":"newtonsys","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XZWZFPsVuk"},{"type":"text","value":" function.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"thHeJyiOcM"}],"key":"gUfpayuVVu"}],"key":"zMpkiB38Fu"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:34:39.382000Z","iopub.status.busy":"2025-01-14T15:34:16.369000Z","iopub.execute_input":"2025-01-14T15:34:16.370000Z","shell.execute_reply":"2025-01-14T15:34:39.376000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"x₁ = [0.0, 0.0, 0.0]\nx = FNC.levenberg(f, x₁)","key":"x9AnrA6yAC"},{"type":"output","id":"sunXuWfMQNnwALk1yvETv","data":[{"output_type":"execute_result","execution_count":3,"metadata":{},"data":{"text/plain":{"content":"12-element Vector{Vector{Float64}}:\n [0.0, 0.0, 0.0]\n [-0.08396946536317919, 0.07633587873004255, 0.0]\n [-0.42205075841965206, 0.21991260740534585, 0.012997569823167984]\n [-0.48610710938504953, 0.2138968287772044, 0.09771872586402451]\n [-0.45628390809556546, 0.24211047709245145, 0.10100440258901365]\n [-0.4556388336696561, 0.23470443548745376, 0.10854665717226099]\n [-0.45839614510679244, 0.2353095686241835, 0.10739828073307472]\n [-0.45804340381597397, 0.2351212406112955, 0.10768079583159752]\n [-0.45803332584412787, 0.23511390840121466, 0.10768998049540802]\n [-0.45803327880719313, 0.23511389867393448, 0.10768999250671268]\n [-0.4580332805601996, 0.2351138998630789, 0.10768999097568899]\n [-0.458033280641234, 0.23511389991865284, 0.10768999090414473]","content_type":"text/plain"}}}],"key":"MmPHlttVCC"}],"key":"LbBZ0wvGpW"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"It’s always a good idea to check the accuracy of the root, by measuring the residual (backward error).","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Ltd1eGD8gv"}],"key":"z2Fso8EFyD"}],"key":"YABKWNgwZX"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:34:39.741000Z","iopub.status.busy":"2025-01-14T15:34:39.401000Z","iopub.execute_input":"2025-01-14T15:34:39.401000Z","shell.execute_reply":"2025-01-14T15:34:39.726000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"r = x[end]\nprintln(\"backward error = $(norm(f(r)))\")","key":"gSFOvTPyWS"},{"type":"output","id":"bNX9huwBXW2mHwt7e_3uE","data":[{"name":"stdout","output_type":"stream","text":"backward error = 1.2707848769787674e-13\n"}],"key":"aVzIxNC9qT"}],"key":"EIoiuCb3gM"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Looking at the convergence in norm, we find a convergence rate between linear and quadratic, like with the secant method.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Zuz0D9074Q"}],"key":"GxrqISsIU7"}],"key":"cEWM65CSoK"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:34:54.758000Z","iopub.status.busy":"2025-01-14T15:34:39.771000Z","iopub.execute_input":"2025-01-14T15:34:39.773000Z","shell.execute_reply":"2025-01-14T15:34:54.718000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"logerr = [log(norm(r - x[k])) for k in 1:length(x)-1]\nratios = [NaN; [logerr[i+1] / logerr[i] for i in 1:length(logerr)-1]]\n@pt :header=[\"iteration\", \"log error\", \"ratio\"] [eachindex(logerr) logerr ratios]","key":"FJ3ILljWHP"},{"type":"output","id":"2vposawHBA6vDcPbqHY7K","data":[{"output_type":"display_data","metadata":{},"data":{"text/html":{"content":"<table>\n  <thead>\n    <tr class = \"header headerLastRow\">\n      <th style = \"text-align: right;\">iteration</th>\n      <th style = \"text-align: right;\">log error</th>\n      <th style = \"text-align: right;\">ratio</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td style = \"text-align: right;\">1.0</td>\n      <td style = \"text-align: right;\">-0.642465</td>\n      <td style = \"text-align: right;\">NaN</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">2.0</td>\n      <td style = \"text-align: right;\">-0.866562</td>\n      <td style = \"text-align: right;\">1.34881</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">3.0</td>\n      <td style = \"text-align: right;\">-2.27855</td>\n      <td style = \"text-align: right;\">2.62941</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">4.0</td>\n      <td style = \"text-align: right;\">-3.30839</td>\n      <td style = \"text-align: right;\">1.45197</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">5.0</td>\n      <td style = \"text-align: right;\">-4.6219</td>\n      <td style = \"text-align: right;\">1.39702</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">6.0</td>\n      <td style = \"text-align: right;\">-5.96158</td>\n      <td style = \"text-align: right;\">1.28986</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">7.0</td>\n      <td style = \"text-align: right;\">-7.5909</td>\n      <td style = \"text-align: right;\">1.2733</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">8.0</td>\n      <td style = \"text-align: right;\">-11.0733</td>\n      <td style = \"text-align: right;\">1.45876</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">9.0</td>\n      <td style = \"text-align: right;\">-16.8698</td>\n      <td style = \"text-align: right;\">1.52347</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">10.0</td>\n      <td style = \"text-align: right;\">-19.7171</td>\n      <td style = \"text-align: right;\">1.16878</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">11.0</td>\n      <td style = \"text-align: right;\">-22.8307</td>\n      <td style = \"text-align: right;\">1.15792</td>\n    </tr>\n  </tbody>\n</table>\n","content_type":"text/html"}}}],"key":"rld9c3iC2s"}],"key":"tG24aPGvdT"}],"key":"Znty0duei5"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Converge","url":"/converge-3","group":"Chapter 4"},"next":{"title":"Converge","url":"/converge-4","group":"Chapter 4"}}},"domain":"http://localhost:3000"}