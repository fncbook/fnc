{"kind":"Notebook","sha256":"f0ee280a111cb4923068bbd7d6c4f6c4c8110e722cc78e5c0fe25c055b6f21da","slug":"tempinterp-2","location":"/chapter3/section1/python/tempinterp.ipynb","dependencies":[],"frontmatter":{"numbering":{"heading_1":{"enabled":false},"heading_2":{"enabled":false},"heading_3":{"enabled":false},"heading_4":{"enabled":false},"heading_5":{"enabled":false},"heading_6":{"enabled":false}},"kernelspec":{"name":"python3","display_name":"Python 3","language":"python"},"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"exports":[{"format":"ipynb","filename":"tempinterp.ipynb","url":"/build/tempinterp-c12297209a5043ebc366763204e33411.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:34:01.529136Z","iopub.status.busy":"2025-01-11T17:34:01.528866Z","iopub.status.idle":"2025-01-11T17:34:01.845179Z","shell.execute_reply":"2025-01-11T17:34:01.844809Z"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"exec(open(\"../../../python/FNC_init.py\").read())","visibility":"show","key":"jsTScsz14M"},{"type":"output","id":"BET_bEdgxLXsZI5J2t8Pl","data":[],"visibility":"show","key":"EbPGekwzu5"}],"visibility":"remove","key":"JFYvo8p5Qx"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"FA85vcRWMa"},{"type":"text","value":"3.1.1","key":"Ue7iknaTiQ"}],"key":"v7FYX4TQ0s"}],"identifier":"demo-fitting-tempinterp","label":"demo-fitting-tempinterp","kind":"proof:example","template":"Example %s","enumerator":"3.1.1","resolved":true,"html_id":"demo-fitting-tempinterp","remote":true,"url":"/fitting","dataUrl":"/fitting.json","key":"koe4Jvazqo"}],"key":"bbt38xGjlh"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Here are 5-year averages of the worldwide temperature anomaly as compared to the 1951–1980 average (source: NASA).","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"eHa0ovr5u5"}],"key":"uzWKE89d9Z"}],"key":"h4OfJSKUM0"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:34:01.846698Z","iopub.status.busy":"2025-01-11T17:34:01.846576Z","iopub.status.idle":"2025-01-11T17:34:01.909112Z","shell.execute_reply":"2025-01-11T17:34:01.908822Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"year = arange(1955,2005,5)\ny = array([ -0.0480, -0.0180, -0.0360, -0.0120, -0.0040,\n    0.1180, 0.2100, 0.3320, 0.3340, 0.4560 ])\n\nfig, ax = subplots()\nax.scatter(year, y, color=\"k\", label=\"data\")\nxlabel(\"year\")\nylabel(\"anomaly (degrees C)\")\ntitle(\"World temperature anomaly\");","key":"mcu6wMHtT2"},{"type":"output","id":"BgDDbAnvDGGIbDGZswVwc","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"5dbe24ecc5c1a3f64cc164b3dee7df8c","path":"/build/5dbe24ecc5c1a3f64cc164b3dee7df8c.png"},"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"}}}],"key":"i8KGUrve6N"}],"key":"bueRNY3shV"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"A polynomial interpolant can be used to fit the data. Here we build one using a Vandermonde matrix. First, though, we express time as decades since 1950, as it improves the condition number of the matrix.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"S90bhAU6bB"}],"key":"BlUbBfBeE3"}],"key":"cNfisnkvlZ"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:34:01.910441Z","iopub.status.busy":"2025-01-11T17:34:01.910352Z","iopub.status.idle":"2025-01-11T17:34:01.912444Z","shell.execute_reply":"2025-01-11T17:34:01.912183Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"t = (year - 1950) / 10\nV = vander(t)\nc = linalg.solve(V, y)\nprint(c)","key":"O4k0J8HIsu"},{"type":"output","id":"KP8i1AVQIXUTNOv7Ch8WP","data":[{"name":"stdout","output_type":"stream","text":"[ 1.03111111e-02 -2.54666667e-01  2.69480635e+00 -1.59628889e+01\n  5.80155778e+01 -1.33273472e+02  1.91960567e+02 -1.65455972e+02\n  7.63617381e+01 -1.41140000e+01]\n"}],"key":"H1b1uQ8geX"}],"key":"Wze8eRuKqC"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"The coefficients in vector ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"Xz5r4Hx9ox"},{"type":"inlineCode","value":"c","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"VgMsKTH9UJ"},{"type":"text","value":" are used to create a polynomial. Then we create a function that evaluates the polynomial after changing the time variable as we did for the Vandermonde matrix.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"mJDk7pbg00"}],"indexEntries":[{"entry":"Python","subEntry":{"value":"plotting functions","kind":"entry"},"emphasis":false}],"label":"index-XUZfkvnLIu","identifier":"index-xuzfkvnliu","html_id":"index-xuzfkvnliu","key":"BqieHn64Te"}],"key":"dwfOv50rcW"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:34:01.913628Z","iopub.status.busy":"2025-01-11T17:34:01.913549Z","iopub.status.idle":"2025-01-11T17:34:01.963011Z","shell.execute_reply":"2025-01-11T17:34:01.962765Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"p = poly1d(c)    # convert to a polynomial\ntt = linspace(1955, 2000, 500)\nax.plot(tt, p((tt - 1950) / 10), label=\"interpolant\")\nax.legend();\nfig","key":"VATxD387Ks"},{"type":"output","id":"-CqUhgJktPNT4qrjYDWga","data":[{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"de196f707cff163f3efa6ff60288b3e2","path":"/build/de196f707cff163f3efa6ff60288b3e2.png"},"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"}}}],"key":"kBs9o6TSSG"}],"key":"grYq8Q9xyE"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"As you can see, the interpolant does represent the data, in a sense. However it’s a crazy-looking curve for the application. Trying too hard to reproduce all the data exactly is known as ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pFRulpbd3E"},{"type":"emphasis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"overfitting","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rCSYIAJQOc"}],"key":"nLTDaGSRU4"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"afZBejUNI7"}],"key":"Fhs4qSs0DT"}],"key":"WxyxleYTZs"}],"key":"ANSmahDZGc"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Cholesky","url":"/cholesky-2","group":"Chapter 2"},"next":{"title":"Tempfit","url":"/tempfit-2","group":"Chapter 3"}}},"domain":"http://localhost:3000"}