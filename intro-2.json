{"kind":"Notebook","sha256":"02893d74eb8af3f0393a772a3bbf59a8993c216d7efbb2df270178c7a9ad95c8","slug":"intro-2","location":"/chapter8/section5/python/intro.ipynb","dependencies":[],"frontmatter":{"numbering":{"heading_1":{"enabled":false},"heading_2":{"enabled":false},"heading_3":{"enabled":false},"heading_4":{"enabled":false},"heading_5":{"enabled":false},"heading_6":{"enabled":false}},"kernelspec":{"name":"python3","display_name":"Python 3","language":"python"},"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"exports":[{"format":"ipynb","filename":"intro.ipynb","url":"/build/intro-3e8c8487bc97a3d92dca196addd48a13.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T16:23:19.930229Z","iopub.status.busy":"2025-01-11T16:23:19.929983Z","iopub.status.idle":"2025-01-11T16:23:20.333274Z","shell.execute_reply":"2025-01-11T16:23:20.332994Z"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"exec(open(\"../../../python/FNC_init.py\").read())","visibility":"show","key":"bElHVfthOn"},{"type":"output","id":"rDGQ1zkkkxwv2-Ki8j_WM","data":[],"visibility":"show","key":"yMOaVVSd3t"}],"visibility":"remove","key":"HFylJhr9IL"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"SrDu4LKkR1"},{"type":"text","value":"8.5.1","key":"lKPiou7ChK"}],"key":"dt7WOztmwf"}],"identifier":"demo-gmres-intro","label":"demo-gmres-intro","kind":"proof:example","template":"ExampleÂ %s","enumerator":"8.5.1","resolved":true,"html_id":"demo-gmres-intro","remote":true,"url":"/gmres","dataUrl":"/gmres.json","key":"IDmGuR8Zcv"}],"key":"YHDyuMP5aY"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We define a triangular matrix with known eigenvalues and a random vector ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"xmnsTgXR9f"},{"type":"inlineMath","value":"\\mathbf{b}","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"LGlbuqvMKe"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"CpLcin04OH"}],"key":"LM85ZaG3Ck"}],"key":"WFFDv8e0Ak"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T16:23:20.334763Z","iopub.status.busy":"2025-01-11T16:23:20.334632Z","iopub.status.idle":"2025-01-11T16:23:20.336639Z","shell.execute_reply":"2025-01-11T16:23:20.336411Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"ev = 10 + arange(1, 101)\nA = triu(random.rand(100, 100), 1) + diag(ev)\nb = random.rand(100)","key":"r5h1BpqOfn"},{"type":"output","id":"Uxg3YcaSWg_eOxZqxdVtP","data":[],"key":"rltyrbQbva"}],"key":"Tjtlu7qDaw"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Instead of building the Krylov matrices, we use the Arnoldi iteration to generate equivalent orthonormal vectors.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"sqHTtXkX4W"}],"key":"ThwMuSoyka"}],"key":"bIqp0TYq34"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T16:23:20.337877Z","iopub.status.busy":"2025-01-11T16:23:20.337788Z","iopub.status.idle":"2025-01-11T16:23:20.343016Z","shell.execute_reply":"2025-01-11T16:23:20.342802Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"Q, H = FNC.arnoldi(A, b, 60)\nprint(H[:5, :5])","key":"RgpP7c672U"},{"type":"output","id":"AJpfWmAoFV9fD9IYtBw0I","data":[{"name":"stdout","output_type":"stream","text":"[[77.14276215 38.49074553  7.5389319   1.39092855  0.45170256]\n [20.65700883 57.3484252  28.60226044  1.71978101 -0.77652805]\n [ 0.         21.80994849 55.7959736  24.70219603  1.34722829]\n [ 0.          0.         22.24894275 57.74488124 26.07193351]\n [ 0.          0.          0.         25.24546482 63.54302246]]\n"}],"key":"c3h8gDDdHZ"}],"key":"ypmW02cQd3"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The Arnoldi bases are used to solve the least-squares problems defining the GMRES iterates.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zsEIWwJAbU"}],"key":"cNBQgJaxqc"}],"key":"cId18jkP5e"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T16:23:20.344130Z","iopub.status.busy":"2025-01-11T16:23:20.344055Z","iopub.status.idle":"2025-01-11T16:23:20.358846Z","shell.execute_reply":"2025-01-11T16:23:20.358622Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"from numpy.linalg import lstsq\nresid = zeros(61)\nresid[0] = norm(b)\nfor m in range(1, 61):\n    s = hstack([norm(b), zeros(m)])\n    z = lstsq(H[: m + 1, :m], s, rcond=None)[0]\n    x = Q[:, :m] @ z\n    resid[m] = norm(b - A @ x)","key":"lwuMtLCEzM"},{"type":"output","id":"WTKoAKBrcnTS4jKVTJOoe","data":[],"key":"dBi0UdV495"}],"key":"yjFtLHZBeg"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The approximations converge smoothly, practically all the way to machine epsilon.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mNcusSNiD7"}],"key":"JrJzbVbMKA"}],"key":"CtRLEHCUIt"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T16:23:20.359953Z","iopub.status.busy":"2025-01-11T16:23:20.359871Z","iopub.status.idle":"2025-01-11T16:23:20.539413Z","shell.execute_reply":"2025-01-11T16:23:20.539161Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"semilogy(range(61), resid, \"-o\")\nxlabel(\"$m$\"),  ylabel(\"$\\| b-Ax_m \\|$\")\ntitle(\"Residual for GMRES\");","key":"FKrDmeZwST"},{"type":"output","id":"p4FRtgIgty0IN14pbdZPB","data":[{"name":"stderr","output_type":"stream","text":"<>:2: SyntaxWarning: invalid escape sequence '\\|'\n<>:2: SyntaxWarning: invalid escape sequence '\\|'\n/var/folders/gc/0752xrm56pnf0r0dsrn5370c0000gr/T/ipykernel_12863/580350478.py:2: SyntaxWarning: invalid escape sequence '\\|'\n  xlabel(\"$m$\"),  ylabel(\"$\\| b-Ax_m \\|$\")\n"},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"4b70a210f3728f56e029230266d01e3b","path":"/build/4b70a210f3728f56e029230266d01e3b.png"},"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"}}}],"key":"udBxqzg67M"}],"key":"MnXepUyoAj"}],"key":"snKbXZux7A"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Arnoldi","url":"/arnoldi-2","group":"Chapter 8"},"next":{"title":"Restart","url":"/restart-2","group":"Chapter 8"}}},"domain":"http://localhost:3000"}