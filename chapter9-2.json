{"version":1,"kind":"Notebook","sha256":"a00f52383c43f2ec5319cf4e73906c87c622cd37b36eb3899ba450bc686d76d5","slug":"chapter9-2","location":"/python/chapter9.md","dependencies":[],"frontmatter":{"title":"Chapter 9","numbering":{"heading_1":{"enabled":false},"heading_2":{"enabled":false},"heading_3":{"enabled":false},"heading_4":{"enabled":false},"heading_5":{"enabled":false},"heading_6":{"enabled":false},"title":{"offset":2}},"kernelspec":{"name":"python3","display_name":"Python 3","language":"python"},"content_includes_title":false,"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"edit_url":"https://github.com/fncbook/fnc/blob/master/python/chapter9.md","exports":[{"format":"md","filename":"chapter9.md","url":"/build/chapter9-bff343b1d4b608c6b008b42ffcdbf036.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Functions","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"kpf59q0R8f"}],"identifier":"functions","label":"Functions","html_id":"functions","implicit":true,"key":"qr4hYrq3gD"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Barycentric polynomial interpolation","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"hW1yrToe3N"}],"key":"XF0GSnIy92"},{"type":"include","file":"fncbook/fncbook/chapter09.py","literal":true,"filter":{"startAt":"def polyinterp","endAt":"return np.vectorize(p)"},"children":[{"type":"code","value":"def polyinterp(t, y):\n    \"\"\"\n    polyinterp(t, y)\n\n    Return a callable polynomial interpolant through the points in vectors t, y. Uses\n    the barycentric interpolation formula.\n    \"\"\"\n    n = len(t) - 1\n    C = (t[-1] - t[0]) / 4  # scaling factor to ensure stability\n    tc = t / C\n\n    # Adding one node at a time, compute inverses of the weights.\n    omega = np.ones(n + 1)\n    for m in range(n):\n        d = tc[: m + 1] - tc[m + 1]  # vector of node differences\n        omega[: m + 1] = omega[: m + 1] * d  # update previous\n        omega[m + 1] = np.prod(-d)  # compute the new one\n    w = 1 / omega  # go from inverses to weights\n\n    def p(x):\n        # Compute interpolant.\n        z = np.where(x == t)[0]\n        if len(z) > 0:  # avoid dividing by zero\n            # Apply L'Hopital's Rule exactly.\n            f = y[z[0]]\n        else:\n            terms = w / (x - t)\n            f = np.sum(y * terms) / np.sum(terms)\n        return f\n\n    return np.vectorize(p)","lang":"python","showLineNumbers":true,"filename":"polyinterp.py","key":"T9JBb6XWPy"}],"key":"Nh7fkzSqog"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"About the code","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"vcj2OIjiqP"}],"key":"CdneL5rtWs"},{"type":"paragraph","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"text","value":"As noted in ","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"aLJChGzBj9"},{"type":"crossReference","kind":"proof:example","identifier":"example-writeoutbary2","label":"example-writeoutbary2","children":[{"type":"text","value":"Example ","key":"zVXONcaoWu"},{"type":"text","value":"9.2.1","key":"sposkqIOEZ"}],"template":"Example %s","enumerator":"9.2.1","resolved":true,"html_id":"example-writeoutbary2","remote":true,"url":"/barycentric","dataUrl":"/barycentric.json","key":"CXFgZCbOrf"},{"type":"text","value":", a common scaling factor in the weights does not affect the barycentric formula ","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"sI3o2aUrF9"},{"type":"crossReference","kind":"equation","identifier":"bary2","label":"bary2","children":[{"type":"text","value":"(","key":"EkTaWk8xMa"},{"type":"text","value":"9.2.3","key":"QXg4UhW3lV"},{"type":"text","value":")","key":"Dq9m9rTXn7"}],"template":"(%s)","enumerator":"9.2.3","resolved":true,"html_id":"bary2","remote":true,"url":"/barycentric","dataUrl":"/barycentric.json","key":"nXTKEcRU8X"},{"type":"text","value":". In lines 9--10 this fact is used to rescale the nodes in order to avoid eventual tiny or enormous numbers that could go outside the bounds of double precision.","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"raL9F8CxV7"}],"key":"tgcshmfqFP"},{"type":"paragraph","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"text","value":"The return value is a function that evaluates the polynomial interpolant. Within this function, ","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"QN5h3O4ouE"},{"type":"inlineCode","value":"isinf","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"xW1bAzYOjO"},{"type":"text","value":" is used to detect either ","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"NH5A93IYlk"},{"type":"inlineCode","value":"Inf","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"zPg4h1e5OL"},{"type":"text","value":" or ","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"v37Ky3WTLn"},{"type":"inlineCode","value":"-Inf","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"tJQ7oYMZsl"},{"type":"text","value":", which occurs when ","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"G2aY6X2PZi"},{"type":"inlineMath","value":"x","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"mt09Ech3Z5"},{"type":"text","value":" exactly equals one of the nodes. In this event, the corresponding data value is returned.","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"I7Nbg8aXIN"}],"key":"Dt5AJf8WMH"}],"class":"dropdown","key":"FZoxnhi6jh"}],"label":"function-polyinterp-python","identifier":"function-polyinterp-python","html_id":"function-polyinterp-python","key":"YNlzsml0Jw"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Trigonometric interpolation","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"F3FST2blRm"}],"key":"kw6wKtqZGF"},{"type":"include","file":"fncbook/fncbook/chapter09.py","literal":true,"filter":{"startAt":"def triginterp","endAt":"return np.vectorize(p)"},"children":[{"type":"code","value":"def triginterp(t, y):\n    \"\"\"\n        triginterp(t, y)\n\n    Return trigonometric interpolant for points defined by vectors t and y.\n    \"\"\"\n    N = len(t)\n\n    def trigcardinal(x):\n        if x == 0:\n            tau = 1.0\n        elif np.mod(N, 2) == 1:  # odd\n            tau = np.sin(N * np.pi * x / 2) / (N * np.sin(np.pi * x / 2))\n        else:  # even\n            tau = np.sin(N * np.pi * x / 2) / (N * np.tan(np.pi * x / 2))\n        return tau\n\n    def p(x):\n        return np.sum([y[k] * trigcardinal(x - t[k]) for k in range(N)])\n\n    return np.vectorize(p)","lang":"python","showLineNumbers":true,"filename":"triginterp.py","key":"KQcysEHdIN"}],"key":"UHM3E5S16U"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"About the code","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"o6i6dzRUnK"}],"key":"ehbGZseD1E"},{"type":"paragraph","position":{"start":{"line":45,"column":1},"end":{"line":45,"column":1}},"children":[{"type":"text","value":"The construct on line 13 is known as a ","position":{"start":{"line":45,"column":1},"end":{"line":45,"column":1}},"key":"Yno3PM1J2a"},{"type":"emphasis","position":{"start":{"line":45,"column":1},"end":{"line":45,"column":1}},"children":[{"type":"text","value":"ternary operator","position":{"start":{"line":45,"column":1},"end":{"line":45,"column":1}},"key":"jxRs9ois72"}],"key":"WebVnemxM2"},{"type":"text","value":". It is a shorthand for an ","position":{"start":{"line":45,"column":1},"end":{"line":45,"column":1}},"key":"JsgUIuiFwV"},{"type":"inlineCode","value":"if","position":{"start":{"line":45,"column":1},"end":{"line":45,"column":1}},"key":"mlvQV6lwjQ"},{"type":"text","value":"–","position":{"start":{"line":45,"column":1},"end":{"line":45,"column":1}},"key":"QOMZnriWqV"},{"type":"inlineCode","value":"else","position":{"start":{"line":45,"column":1},"end":{"line":45,"column":1}},"key":"K4ej0V0c9L"},{"type":"text","value":" statement, giving two alternative results for the true/false cases. Line 19 uses ","position":{"start":{"line":45,"column":1},"end":{"line":45,"column":1}},"key":"BBslkfTdON"},{"type":"inlineCode","value":"eachindex(y)","position":{"start":{"line":45,"column":1},"end":{"line":45,"column":1}},"key":"K0JJ9GlXnN"},{"type":"text","value":", which generalizes ","position":{"start":{"line":45,"column":1},"end":{"line":45,"column":1}},"key":"XZ7muJablx"},{"type":"inlineCode","value":"1:length(y)","position":{"start":{"line":45,"column":1},"end":{"line":45,"column":1}},"key":"RGWsSxYZCT"},{"type":"text","value":" to cases where a vector might have a more exotic form of indexing.","position":{"start":{"line":45,"column":1},"end":{"line":45,"column":1}},"key":"Z8QRfkTolw"}],"key":"aC3jtdKLbg"}],"class":"dropdown","key":"foxvx6T2vd"}],"label":"function-triginterp-python","identifier":"function-triginterp-python","html_id":"function-triginterp-python","key":"NSbQZJ9nq6"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Clenshaw–Curtis integration","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"key":"rdURASTbJD"}],"key":"MmCwWEiGUF"},{"type":"include","file":"fncbook/fncbook/chapter09.py","literal":true,"filter":{"startAt":"def ccint","endAt":"return I, x"},"children":[{"type":"code","value":"def ccint(f, n):\n    \"\"\"\n    ccint(f, n)\n\n    Perform Clenshaw-Curtis integration for the function f on n+1 nodes in [-1,1]. Return\n    integral and a vector of the nodes used. Note: n must be even.\n    \"\"\"\n    # Find Chebyshev extreme nodes.\n    theta = np.linspace(0, np.pi, n + 1)\n    x = -np.cos(theta)\n\n    # Compute the C-C weights.\n    c = np.zeros(n + 1)\n    c[[0, n]] = 1 / (n**2 - 1)\n    v = np.ones(n - 1)\n    for k in range(1, int(n / 2)):\n        v -= 2 * np.cos(2 * k * theta[1:-1]) / (4 * k**2 - 1)\n    v -= np.cos(n * theta[1:-1]) / (n**2 - 1)\n    c[1:-1] = 2 * v / n\n\n    # Evaluate integrand and integral.\n    I = np.dot(c, f(x))  # use vector inner product\n    return I, x","lang":"python","showLineNumbers":true,"filename":"ccint.py","key":"KsSH1jZuut"}],"key":"WAYxW7Am0o"}],"label":"function-ccint-python","identifier":"function-ccint-python","html_id":"function-ccint-python","key":"UFLsyqs5Ep"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Gauss–Legendre integration","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"key":"elZxR7Ctvv"}],"key":"YQzuOeSssB"},{"type":"include","file":"fncbook/fncbook/chapter09.py","literal":true,"filter":{"startAt":"def glint","endAt":"return I, x"},"children":[{"type":"code","value":"def glint(f, n):\n    \"\"\"\n    glint(f, n)\n\n    Perform Gauss-Legendre integration for the function f on n nodes in (-1,1). Return\n    integral and a vector of the nodes used.\n    \"\"\"\n    # Nodes and weights are found via a tridiagonal eigenvalue problem.\n    beta = 0.5 / np.sqrt(1 - (2.0 * np.arange(1, n)) ** (-2))\n    T = np.diag(beta, 1) + np.diag(beta, -1)\n    ev, V = eig(T)\n    ev = np.real_if_close(ev)\n    p = np.argsort(ev)\n    x = ev[p]  # nodes\n    c = 2 * V[0, p] ** 2  # weights\n\n    # Evaluate the integrand and compute the integral.\n    I = np.dot(c, f(x))  # vector inner product\n    return I, x","lang":"python","showLineNumbers":true,"filename":"glint.py","key":"MgwhcmXkhh"}],"key":"Gj8wVnmW8H"}],"label":"function-glint-python","identifier":"function-glint-python","html_id":"function-glint-python","key":"jddYJOVJYR"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Integration over ","position":{"start":{"line":74,"column":1},"end":{"line":74,"column":1}},"key":"TfqtcSKH4k"},{"type":"inlineMath","value":"(-\\infty,\\infty)","position":{"start":{"line":74,"column":1},"end":{"line":74,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mo>−</mo><mi mathvariant=\"normal\">∞</mi><mo separator=\"true\">,</mo><mi mathvariant=\"normal\">∞</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(-\\infty,\\infty)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\">−</span><span class=\"mord\">∞</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">∞</span><span class=\"mclose\">)</span></span></span></span>","key":"DhsqIrHlVa"}],"key":"Kdpwqkxvgi"},{"type":"include","file":"fncbook/fncbook/chapter09.py","literal":true,"filter":{"startAt":"def intinf","endAt":"return I, x"},"children":[{"type":"code","value":"def intinf(f, tol):\n    \"\"\"\n    intinf(f, tol)\n\n    Perform doubly-exponential integration of function f over (-Inf,Inf), using\n    error tolerance tol. Return integral and a vector of the nodes used.\n    \"\"\"\n    xi = lambda t: np.sinh(np.sinh(t))\n    dxi_dt = lambda t: np.cosh(t) * np.cosh(np.sinh(t))\n    g = lambda t: f(xi(t)) * dxi_dt(t)\n    M = 3\n    while (abs(g(-M)) > tol/100) or (abs(g(M)) > tol/100):\n        M += 0.5\n        if np.isinf(xi(M)):\n            warnings.warn(\"Function may not decay fast enough.\")\n            M -= 0.5\n            break\n\n    I, t = intadapt(g,-M,M,tol)\n    x = xi(t)\n    return I, x","lang":"python","showLineNumbers":true,"filename":"intinf.py","key":"nr17CTdxMo"}],"key":"tDASOB8Mm5"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"About the code","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"key":"dw2NrjqU6u"}],"key":"KnMV9qVzwf"},{"type":"paragraph","position":{"start":{"line":86,"column":1},"end":{"line":86,"column":1}},"children":[{"type":"text","value":"The test ","position":{"start":{"line":86,"column":1},"end":{"line":86,"column":1}},"key":"hXdlw7bR5t"},{"type":"inlineCode","value":"isinf(x(M))","position":{"start":{"line":86,"column":1},"end":{"line":86,"column":1}},"key":"camUgfY2gc"},{"type":"text","value":" in line 17 checks whether ","position":{"start":{"line":86,"column":1},"end":{"line":86,"column":1}},"key":"Gb9hDKc0gR"},{"type":"inlineMath","value":"x(M)","position":{"start":{"line":86,"column":1},"end":{"line":86,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mo stretchy=\"false\">(</mo><mi>M</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">x(M)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span><span class=\"mclose\">)</span></span></span></span>","key":"SrisuQziOJ"},{"type":"text","value":" is larger than the maximum double-precision value, causing it to ","position":{"start":{"line":86,"column":1},"end":{"line":86,"column":1}},"key":"T4Z69UJUCo"},{"type":"emphasis","position":{"start":{"line":86,"column":1},"end":{"line":86,"column":1}},"children":[{"type":"text","value":"overflow","position":{"start":{"line":86,"column":1},"end":{"line":86,"column":1}},"key":"W2ci0Kf1hd"}],"key":"yAXG68e1Wt"},{"type":"text","value":" to ","position":{"start":{"line":86,"column":1},"end":{"line":86,"column":1}},"key":"EUAwFHkMau"},{"type":"inlineCode","value":"Inf","position":{"start":{"line":86,"column":1},"end":{"line":86,"column":1}},"key":"P1rUHoEp8o"},{"type":"text","value":".","position":{"start":{"line":86,"column":1},"end":{"line":86,"column":1}},"key":"MSVSKnRAwK"}],"key":"x6tOh7ZYyu"}],"class":"dropdown","key":"oncCfTRv9g"}],"label":"function-intinf-python","identifier":"function-intinf-python","html_id":"function-intinf-python","key":"ezrY2WUP9v"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Integration with endpoint singularities","position":{"start":{"line":91,"column":1},"end":{"line":91,"column":1}},"key":"lSfRo3ZRxD"}],"key":"zMmZ0fbLnz"},{"type":"include","file":"fncbook/fncbook/chapter09.py","literal":true,"filter":{"startAt":"def intsing","endAt":"return I, x"},"children":[{"type":"code","value":"def intsing(f, tol):\n    \"\"\"\n    intsing(f, tol)\n\n    Adaptively integrate function f over (0,1), where f may be \n    singular at zero, with error tolerance tol. Returns the\n    integral estimate and a vector of the nodes used.\n    \"\"\"\n    xi = lambda t: 2 / (1 + np.exp( 2*np.sinh(t) ))\n    dxi_dt = lambda t: np.cosh(t) / np.cosh(np.sinh(t))**2\n    g = lambda t: f(xi(t)) * dxi_dt(t)\n    # Find where to truncate the integration interval.\n    M = 3\n    while abs(g(M)) > tol/100:\n        M += 0.5\n        if xi(M) == 0:\n            warnings.warn(\"Function may grow too rapidly.\")\n            M -= 0.5\n            break\n\n    I, t = intadapt(g, 0, M, tol)\n    x = xi(t)\n    return I, x","lang":"python","showLineNumbers":true,"filename":"intsing.py","key":"ruPZFRG2qf"}],"key":"wdheogm8Jr"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"About the code","position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"key":"Smkxcl8g9f"}],"key":"r7MkTOvMCJ"},{"type":"paragraph","position":{"start":{"line":103,"column":1},"end":{"line":103,"column":1}},"children":[{"type":"text","value":"The test ","position":{"start":{"line":103,"column":1},"end":{"line":103,"column":1}},"key":"B8JZQRFqfV"},{"type":"inlineCode","value":"iszero(x(M))","position":{"start":{"line":103,"column":1},"end":{"line":103,"column":1}},"key":"LqwZBICM1N"},{"type":"text","value":" in line 17 checks whether ","position":{"start":{"line":103,"column":1},"end":{"line":103,"column":1}},"key":"IrsVIv4tou"},{"type":"inlineMath","value":"x(M)","position":{"start":{"line":103,"column":1},"end":{"line":103,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mo stretchy=\"false\">(</mo><mi>M</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">x(M)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span><span class=\"mclose\">)</span></span></span></span>","key":"IwUWzoubsN"},{"type":"text","value":" is less than the smallest positive double-precision value, causing it to ","position":{"start":{"line":103,"column":1},"end":{"line":103,"column":1}},"key":"vrFBvPFHuo"},{"type":"emphasis","position":{"start":{"line":103,"column":1},"end":{"line":103,"column":1}},"children":[{"type":"text","value":"underflow","position":{"start":{"line":103,"column":1},"end":{"line":103,"column":1}},"key":"j4pqKvV92H"}],"key":"iGAQDcYrkF"},{"type":"text","value":" to zero.","position":{"start":{"line":103,"column":1},"end":{"line":103,"column":1}},"key":"mLpS7d59Bz"}],"key":"Sdbe8yKt9W"}],"class":"dropdown","key":"X9GhTpjAUQ"}],"label":"function-intsing-python","identifier":"function-intsing-python","html_id":"function-intsing-python","key":"XBMI3zAXWt"},{"type":"heading","depth":2,"position":{"start":{"line":107,"column":1},"end":{"line":107,"column":1}},"children":[{"type":"text","value":"Examples","position":{"start":{"line":107,"column":1},"end":{"line":107,"column":1}},"key":"k01BY3xtdp"}],"identifier":"examples","label":"Examples","html_id":"examples","implicit":true,"key":"mLFcMPHMQW"}],"key":"tEn5nSA9ob"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"exec(open(\"FNC_init.py\").read())","visibility":"show","key":"AJdvHkLsbj"},{"type":"output","id":"t3CAIhnAoAUMbFtSVA8Mo","data":[],"visibility":"show","key":"hKxJUeih3c"}],"data":{"tags":[]},"visibility":"remove","key":"N2QCGQPKCY"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":114,"column":1},"end":{"line":114,"column":1}},"children":[{"type":"text","value":"9.1 ","position":{"start":{"line":114,"column":1},"end":{"line":114,"column":1}},"key":"JQoLXyzBea"},{"type":"link","identifier":"section-globalapprox-polynomial","label":"section-globalapprox-polynomial","kind":"narrative","position":{"start":{"line":114,"column":5},"end":{"line":114,"column":37}},"url":"/polynomial","internal":true,"dataUrl":"/polynomial.json","children":[{"type":"text","value":"Polynomial interpolation","key":"Km26w49ctp"}],"key":"BbAwCLzGhD"}],"identifier":"id-9-1","label":"9.1 ","html_id":"id-9-1","implicit":true,"key":"wkQbjk1UxC"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-polynomial-lagrange","label":"demo-polynomial-lagrange","kind":"proof:example","position":{"start":{"line":117,"column":1},"end":{"line":117,"column":26}},"children":[{"type":"text","value":"Example ","key":"RoP39JvYW3"},{"type":"text","value":"9.1.1","key":"PWPkCZa86P"}],"template":"Example %s","enumerator":"9.1.1","resolved":true,"html_id":"demo-polynomial-lagrange","remote":true,"url":"/polynomial","dataUrl":"/polynomial.json","key":"B2izbkSJVF"}],"key":"beIkYB9Gjr"},{"type":"paragraph","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"children":[{"type":"text","value":"Here is a vector of nodes.","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"key":"ld6EWiqkpR"}],"key":"Hb9y413kZw"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"t = array([1, 1.5, 2, 2.25, 2.75, 3])\nn = 5","key":"a3hIeoQ7j9"},{"type":"output","id":"xhMjMRGVqLPnaZn5YokJ7","data":[],"key":"U8F9JvQary"}],"data":{},"key":"BDNNe9PZLQ"},{"type":"paragraph","position":{"start":{"line":126,"column":1},"end":{"line":126,"column":1}},"children":[{"type":"text","value":"Let’s apply the definition of the cardinal Lagrange polynomial for ","position":{"start":{"line":126,"column":1},"end":{"line":126,"column":1}},"key":"LZmZ58Mivz"},{"type":"inlineMath","value":"k=2","position":{"start":{"line":126,"column":1},"end":{"line":126,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi><mo>=</mo><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">k=2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span></span></span></span>","key":"p0gwQt6AFA"},{"type":"text","value":". First we define a polynomial ","position":{"start":{"line":126,"column":1},"end":{"line":126,"column":1}},"key":"NXDszDGHf5"},{"type":"inlineMath","value":"q","position":{"start":{"line":126,"column":1},"end":{"line":126,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>q</mi></mrow><annotation encoding=\"application/x-tex\">q</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span></span></span></span>","key":"XiMln92Yj4"},{"type":"text","value":" that is zero at all the nodes except ","position":{"start":{"line":126,"column":1},"end":{"line":126,"column":1}},"key":"LjzKRBYU5c"},{"type":"inlineMath","value":"i=k","position":{"start":{"line":126,"column":1},"end":{"line":126,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi><mo>=</mo><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">i=k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span>","key":"LRRuP6N2tG"},{"type":"text","value":". Then ","position":{"start":{"line":126,"column":1},"end":{"line":126,"column":1}},"key":"x3FTcKo27v"},{"type":"inlineMath","value":"\\ell_2","position":{"start":{"line":126,"column":1},"end":{"line":126,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"normal\">ℓ</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\ell_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord\">ℓ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"sxVCJMELOk"},{"type":"text","value":" is found by normalizing ","position":{"start":{"line":126,"column":1},"end":{"line":126,"column":1}},"key":"safOBzQZhr"},{"type":"inlineMath","value":"q","position":{"start":{"line":126,"column":1},"end":{"line":126,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>q</mi></mrow><annotation encoding=\"application/x-tex\">q</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span></span></span></span>","key":"X5ug1aK7Kf"},{"type":"text","value":" by ","position":{"start":{"line":126,"column":1},"end":{"line":126,"column":1}},"key":"ghh8OXqKRD"},{"type":"inlineMath","value":"q(t_k)","position":{"start":{"line":126,"column":1},"end":{"line":126,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>q</mi><mo stretchy=\"false\">(</mo><msub><mi>t</mi><mi>k</mi></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">q(t_k)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"GqzfkhgHxA"},{"type":"text","value":".","position":{"start":{"line":126,"column":1},"end":{"line":126,"column":1}},"key":"FpNDl1pO2w"}],"key":"F5fRfBktNm"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"k = 2\nq = lambda x: prod([x - t[i] for i in range(n + 1) if i != k])\nell_k = lambda x: q(x) / q(t[k])","key":"R62pJtwTGc"},{"type":"output","id":"g0T_tiTcEjSTlicKda2bQ","data":[],"key":"Aum9usOYIm"}],"data":{},"key":"DCYSWFdBpF"},{"type":"paragraph","position":{"start":{"line":134,"column":1},"end":{"line":134,"column":1}},"children":[{"type":"text","value":"A plot confirms the cardinal property of the result.","position":{"start":{"line":134,"column":1},"end":{"line":134,"column":1}},"key":"J3Du2YZEjz"}],"key":"xjiy63ULCJ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"x = linspace(1, 3, 500)\nplot(x, [ell_k(xx) for xx in x])\ny = zeros(n+1)\ny[k] = 1\nplot(t, y, \"ko\")\nxlabel(\"$x$\"),  ylabel(\"$\\\\ell_2(x)$\")\ntitle((\"Lagrange cardinal function\"));","key":"AjsbhECyxU"},{"type":"output","id":"_wWnK5SHNQXc1MNcykx1p","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"e02f4aafb83fea6651a797019b00c9a9","path":"/build/e02f4aafb83fea6651a797019b00c9a9.png"}}}],"key":"kJPnUzPTMQ"}],"data":{},"key":"ZOSeZOeRYK"},{"type":"paragraph","position":{"start":{"line":146,"column":1},"end":{"line":146,"column":1}},"children":[{"type":"text","value":"Observe that ","position":{"start":{"line":146,"column":1},"end":{"line":146,"column":1}},"key":"v0QlXdRX0J"},{"type":"inlineMath","value":"\\ell_k","position":{"start":{"line":146,"column":1},"end":{"line":146,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"normal\">ℓ</mi><mi>k</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\ell_k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord\">ℓ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"NrOX8R85yp"},{"type":"text","value":" is ","position":{"start":{"line":146,"column":1},"end":{"line":146,"column":1}},"key":"ca2YNqUL2x"},{"type":"emphasis","position":{"start":{"line":146,"column":1},"end":{"line":146,"column":1}},"children":[{"type":"text","value":"not","position":{"start":{"line":146,"column":1},"end":{"line":146,"column":1}},"key":"uqqrjrIjxX"}],"key":"hgn21qZH1e"},{"type":"text","value":" between zero and one everywhere, unlike a hat function.","position":{"start":{"line":146,"column":1},"end":{"line":146,"column":1}},"key":"RxiFJzwMLG"}],"key":"vTJJccUwVC"}],"label":"demo-polynomial-lagrange-python","identifier":"demo-polynomial-lagrange-python","html_id":"demo-polynomial-lagrange-python","key":"mpj1lN5hWI"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-polynomial-error","label":"demo-polynomial-error","kind":"proof:example","position":{"start":{"line":150,"column":1},"end":{"line":150,"column":23}},"children":[{"type":"text","value":"Example ","key":"AiPEZdeUyt"},{"type":"text","value":"9.1.3","key":"Z9lHfzHmAY"}],"template":"Example %s","enumerator":"9.1.3","resolved":true,"html_id":"demo-polynomial-error","remote":true,"url":"/polynomial","dataUrl":"/polynomial.json","key":"jtrv656KZf"}],"key":"CvSFJTyGLi"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"t = array([1, 1.6, 1.9, 2.7, 3])\nn = len(t) - 1\nPhi = lambda x: prod([x - ti for ti in t])\nx = linspace(1, 3, 500)\nplot(x, [abs(Phi(xj)) / 5 for xj in x], label=\"$\\\\frac{1}{5}|\\\\Phi(x)|$\")\n\nfrom scipy.interpolate import BarycentricInterpolator as interp\np = interp(t, log(t))\nplot(x, abs(log(x) - p(x)), label=\"$|f(x)-p(x)|$\")\nplot(t, zeros(t.size), \"ko\", label=\"nodes\")\nxlabel(\"$x$\"),  ylabel(\"error\")\ntitle(\"Interpolation error and upper bound\"),  legend();","key":"XirzUIGIVY"},{"type":"output","id":"Nwml2oDP655LVo_oNinjN","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"e45746747b75c7d29b13579860ef0443","path":"/build/e45746747b75c7d29b13579860ef0443.png"}}}],"key":"gy4X4lc4aG"}],"data":{},"key":"ATyyF7QhG9"},{"type":"paragraph","position":{"start":{"line":168,"column":1},"end":{"line":168,"column":1}},"children":[{"type":"text","value":"The error is zero at the nodes, by the definition of interpolation. The error bound, as well as the error itself, has one local maximum between each consecutive pair of nodes.","position":{"start":{"line":168,"column":1},"end":{"line":168,"column":1}},"key":"R17bPEAgN6"}],"key":"X85qFeOxk0"}],"label":"demo-polynomial-error-python","identifier":"demo-polynomial-error-python","html_id":"demo-polynomial-error-python","key":"h4dNWCknye"},{"type":"heading","depth":3,"position":{"start":{"line":171,"column":1},"end":{"line":171,"column":1}},"children":[{"type":"text","value":"9.2 ","position":{"start":{"line":171,"column":1},"end":{"line":171,"column":1}},"key":"gb7T7aMTnP"},{"type":"link","identifier":"section-globalapprox-barycentric","label":"section-globalapprox-barycentric","kind":"narrative","position":{"start":{"line":171,"column":5},"end":{"line":171,"column":38}},"url":"/barycentric","internal":true,"dataUrl":"/barycentric.json","children":[{"type":"text","value":"The barycentric formula","key":"VZKAVrYYiL"}],"key":"g2ZIOSnRRO"}],"identifier":"id-9-2","label":"9.2 ","html_id":"id-9-2","implicit":true,"key":"eNqIHqfDCN"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-barycentric-example","label":"demo-barycentric-example","kind":"proof:example","position":{"start":{"line":174,"column":1},"end":{"line":174,"column":26}},"children":[{"type":"text","value":"Example ","key":"gQChnC6YJw"},{"type":"text","value":"9.2.2","key":"K91E5m0tY3"}],"template":"Example %s","enumerator":"9.2.2","resolved":true,"html_id":"demo-barycentric-example","remote":true,"url":"/barycentric","dataUrl":"/barycentric.json","key":"CguW4Fuzv5"}],"key":"qvMupDv2dJ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"f = lambda x: sin(exp(2 * x))\nx = linspace(0, 1, 500)\nfig, ax = subplots()\nax.plot(x, f(x), label=\"function\")","key":"PpRhEw3r8M"},{"type":"output","id":"LvBrhFLTST1MsgijFrXZq","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"829f5c4f1ec5ba7365a9847701d1773e","path":"/build/829f5c4f1ec5ba7365a9847701d1773e.png"}}}],"key":"pPTVbf1ixX"}],"data":{},"key":"n0aOPx3Qri"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"t = linspace(0, 1, 4)\ny = f(t)\np = FNC.polyinterp(t, y)\n\nax.plot(x, p(x), label=\"interpolant\")\nax.plot(t, y, \"ko\", label=\"nodes\")\nax.legend()\nax.set_title(\"Interpolation on 4 nodes\")\nfig","key":"ykNqFsUOzD"},{"type":"output","id":"z365m9FHLasMTS3VJDxbf","data":[{"output_type":"execute_result","execution_count":7,"metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"9b6e96d11d738adc4c60f4dee8f8cfab","path":"/build/9b6e96d11d738adc4c60f4dee8f8cfab.png"}}}],"key":"WER3obxhui"}],"data":{},"key":"OYcoZ9piBU"},{"type":"paragraph","position":{"start":{"line":195,"column":1},"end":{"line":195,"column":1}},"children":[{"type":"text","value":"The curves must intersect at the interpolation nodes. For ","position":{"start":{"line":195,"column":1},"end":{"line":195,"column":1}},"key":"SqYOCaqPkW"},{"type":"inlineMath","value":"n=6","position":{"start":{"line":195,"column":1},"end":{"line":195,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>=</mo><mn>6</mn></mrow><annotation encoding=\"application/x-tex\">n=6</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">6</span></span></span></span>","key":"V30N4xb6LB"},{"type":"text","value":" the interpolant is noticeably better.","position":{"start":{"line":195,"column":1},"end":{"line":195,"column":1}},"key":"TKwQI32Rx1"}],"key":"JjsqLzeOpw"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plot(x, f(x), label=\"function\")\nt = linspace(0, 1, 7)\ny = f(t)\np = FNC.polyinterp(t, y)\nplot(x, p(x), label=\"interpolant\")\nplot(t, y, \"ko\", label=\"nodes\")\nlegend(),  title(\"Interpolation on 7 nodes\");","key":"hdir7Ann3s"},{"type":"output","id":"MvCi-1VZLj_DcRgM9QwIK","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"83148cc31bcf9281485f15c9084d6654","path":"/build/83148cc31bcf9281485f15c9084d6654.png"}}}],"key":"aFleeWqFjj"}],"data":{},"key":"QDNQdOGevR"}],"label":"demo-barycentric-example-python","identifier":"demo-barycentric-example-python","html_id":"demo-barycentric-example-python","key":"PEThKQCLXH"},{"type":"heading","depth":3,"position":{"start":{"line":208,"column":1},"end":{"line":208,"column":1}},"children":[{"type":"text","value":"9.3 ","position":{"start":{"line":208,"column":1},"end":{"line":208,"column":1}},"key":"wXp1NH6zeU"},{"type":"link","identifier":"section-globalapprox-stability","label":"section-globalapprox-stability","kind":"narrative","position":{"start":{"line":208,"column":5},"end":{"line":208,"column":36}},"url":"/stability-1","internal":true,"dataUrl":"/stability-1.json","children":[{"type":"text","value":"Stability of polynomial interpolation","key":"mdsGqYZJJh"}],"key":"H3aGSfTILw"}],"identifier":"id-9-3","label":"9.3 ","html_id":"id-9-3","implicit":true,"key":"jWGR7oT07P"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-stability-equispaced","label":"demo-stability-equispaced","kind":"proof:example","position":{"start":{"line":211,"column":1},"end":{"line":211,"column":27}},"children":[{"type":"text","value":"Example ","key":"UewBkDWdTT"},{"type":"text","value":"9.3.1","key":"j71UTNk5Rn"}],"template":"Example %s","enumerator":"9.3.1","resolved":true,"html_id":"demo-stability-equispaced","remote":true,"url":"/stability-1","dataUrl":"/stability-1.json","key":"GnS7sXBP08"}],"key":"QuFjHClTUA"},{"type":"paragraph","position":{"start":{"line":213,"column":1},"end":{"line":213,"column":1}},"children":[{"type":"text","value":"We choose a function over the interval ","position":{"start":{"line":213,"column":1},"end":{"line":213,"column":1}},"key":"pswRTcKwuu"},{"type":"inlineMath","value":"[0,1]","position":{"start":{"line":213,"column":1},"end":{"line":213,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mn>0</mn><mo separator=\"true\">,</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[0,1]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]</span></span></span></span>","key":"yy7Y1QDgX6"},{"type":"text","value":".","position":{"start":{"line":213,"column":1},"end":{"line":213,"column":1}},"key":"MJSyDJqitR"}],"key":"LMX8IVfx8u"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"f = lambda x: sin(exp(2 * x))","key":"gBHHBVggX5"},{"type":"output","id":"3akXSgCVp4UgxDyUf8Yj9","data":[],"key":"v3XVRluh9A"}],"data":{},"key":"prihWqC3hu"},{"type":"paragraph","position":{"start":{"line":219,"column":1},"end":{"line":219,"column":1}},"children":[{"type":"text","value":"Here is a graph of ","position":{"start":{"line":219,"column":1},"end":{"line":219,"column":1}},"key":"uhMFdPpzIJ"},{"type":"inlineMath","value":"f","position":{"start":{"line":219,"column":1},"end":{"line":219,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>","key":"euuAoDqUK8"},{"type":"text","value":" and its polynomial interpolant using seven equally spaced nodes.","position":{"start":{"line":219,"column":1},"end":{"line":219,"column":1}},"key":"Mx01yuPKdg"}],"key":"zb6GfSanee"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"x = linspace(0, 1, 500)\nplot(x, f(x), label=\"function\")\nt = linspace(0, 1, 7)\ny = f(t)\np = FNC.polyinterp(t, y)\nplot(x, p(x), label=\"interpolant\")\nplot(t, y, 'ko', label=\"nodes\")\nlegend(),  title(\"Equispaced interpolant, n=6\");","visibility":"hide","key":"AXCQ2B6u8s"},{"type":"output","id":"qhfA4-8PGQtw-pbFJJlAP","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"a0ea8ea89732aea2a6abbc3a5e1fd6e8","path":"/build/a0ea8ea89732aea2a6abbc3a5e1fd6e8.png"}}}],"visibility":"show","key":"Q3spiKur9g"}],"data":{"tags":[]},"visibility":"show","key":"w0uCDo8ib3"},{"type":"paragraph","position":{"start":{"line":233,"column":1},"end":{"line":233,"column":1}},"children":[{"type":"text","value":"This looks pretty good. We want to track the behavior of the error as ","position":{"start":{"line":233,"column":1},"end":{"line":233,"column":1}},"key":"VMXhkzeRpe"},{"type":"inlineMath","value":"n","position":{"start":{"line":233,"column":1},"end":{"line":233,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"DvoYeAnlOs"},{"type":"text","value":" increases. We will estimate the error in the continuous interpolant by sampling it at a large number of points and taking the max-norm.","position":{"start":{"line":233,"column":1},"end":{"line":233,"column":1}},"key":"YgDMzx3eQ3"}],"key":"bHVjB0ZZKK"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"N = arange(5, 65, 5)\nerr = zeros(N.size)\nx = linspace(0, 1, 1001)         # for measuring error\nfor k, n in enumerate(N):\n    t = linspace(0, 1, n + 1)    # equally spaced nodes\n    y = f(t)  # interpolation data\n    p = FNC.polyinterp(t, y)\n    err[k] = max(abs(f(x) - p(x)))\n\nsemilogy(N, err, \"-o\")\nxlabel(\"$n$\"),  ylabel(\"max error\")\ntitle((\"Polynomial interpolation error\"));","visibility":"hide","key":"h4f28uF1hh"},{"type":"output","id":"n41U5c6cnE2MFQLKQ4kOR","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"f2da279c61a1a151994ada8d62797a5a","path":"/build/f2da279c61a1a151994ada8d62797a5a.png"}}}],"visibility":"show","key":"FhOyT1cUUC"}],"data":{"tags":[]},"visibility":"show","key":"a4Zd8YU97i"},{"type":"paragraph","position":{"start":{"line":251,"column":1},"end":{"line":251,"column":1}},"children":[{"type":"text","value":"The error initially decreases as one would expect but then begins to grow. Both phases occur at rates that are exponential in ","position":{"start":{"line":251,"column":1},"end":{"line":251,"column":1}},"key":"m7nWRgnuXw"},{"type":"inlineMath","value":"n","position":{"start":{"line":251,"column":1},"end":{"line":251,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"pRG6f91JaN"},{"type":"text","value":", i.e., ","position":{"start":{"line":251,"column":1},"end":{"line":251,"column":1}},"key":"VgvYjtwLcS"},{"type":"inlineMath","value":"O(K^n","position":{"start":{"line":251,"column":1},"end":{"line":251,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><msup><mi>K</mi><mi>n</mi></msup></mrow><annotation encoding=\"application/x-tex\">O(K^n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span></span></span></span></span></span></span>","key":"W6QSUUvL0D"},{"type":"text","value":") for a constant ","position":{"start":{"line":251,"column":1},"end":{"line":251,"column":1}},"key":"zo14w0kKxd"},{"type":"inlineMath","value":"K","position":{"start":{"line":251,"column":1},"end":{"line":251,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>K</mi></mrow><annotation encoding=\"application/x-tex\">K</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span></span></span></span>","key":"mHS6GJYcGY"},{"type":"text","value":", appearing linear on a semi-log plot.","position":{"start":{"line":251,"column":1},"end":{"line":251,"column":1}},"key":"MC0zuCslwL"}],"key":"Zz6jedRyIa"}],"label":"demo-stability-equispaced-python","identifier":"demo-stability-equispaced-python","html_id":"demo-stability-equispaced-python","key":"BgVji3XHhV"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-stability-errfun","label":"demo-stability-errfun","kind":"proof:example","position":{"start":{"line":255,"column":1},"end":{"line":255,"column":23}},"children":[{"type":"text","value":"Example ","key":"EjQQl5CCFm"},{"type":"text","value":"9.3.2","key":"yKcOLlG9Js"}],"template":"Example %s","enumerator":"9.3.2","resolved":true,"html_id":"demo-stability-errfun","remote":true,"url":"/stability-1","dataUrl":"/stability-1.json","key":"T8FMht0KM9"}],"key":"h0DIf3UbZ4"},{"type":"paragraph","position":{"start":{"line":257,"column":1},"end":{"line":257,"column":1}},"children":[{"type":"text","value":"We plot ","position":{"start":{"line":257,"column":1},"end":{"line":257,"column":1}},"key":"VcNksSXLK5"},{"type":"inlineMath","value":"|\\Phi(x)|","position":{"start":{"line":257,"column":1},"end":{"line":257,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">∣</mi><mi mathvariant=\"normal\">Φ</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mi mathvariant=\"normal\">∣</mi></mrow><annotation encoding=\"application/x-tex\">|\\Phi(x)|</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">∣Φ</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mord\">∣</span></span></span></span>","key":"rYc8HP4W8e"},{"type":"text","value":" over the interval ","position":{"start":{"line":257,"column":1},"end":{"line":257,"column":1}},"key":"XHMoS9A8QH"},{"type":"inlineMath","value":"[-1,1]","position":{"start":{"line":257,"column":1},"end":{"line":257,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mo>−</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[-1,1]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">−</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]</span></span></span></span>","key":"j9FWfvxOZN"},{"type":"text","value":" with equispaced nodes for different values of ","position":{"start":{"line":257,"column":1},"end":{"line":257,"column":1}},"key":"EfA35FwuUi"},{"type":"inlineMath","value":"n","position":{"start":{"line":257,"column":1},"end":{"line":257,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"OOYfa88iwv"},{"type":"text","value":".","position":{"start":{"line":257,"column":1},"end":{"line":257,"column":1}},"key":"yiZ6sPwTF3"}],"key":"vsr9GiiSxh"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"x = linspace(-1, 1, 1601)\nfor n in range(10, 60, 10):\n    t = linspace(-1, 1, n + 1)\n    Phi = array([prod(xk - t) for xk in x])\n    semilogy(x, abs(Phi), \".\", markersize=2)\nxlabel(\"$x$\")\nylabel(\"$|\\Phi(x)|$\")\nylim([1e-25, 1])\ntitle((\"Effect of equispaced nodes\"));","visibility":"hide","key":"Cv8Xs2zu5p"},{"type":"output","id":"Tl_zoCVWtFxWonh5kgf7G","data":[{"output_type":"stream","name":"stderr","text":"<>:7: SyntaxWarning: invalid escape sequence '\\P'\n<>:7: SyntaxWarning: invalid escape sequence '\\P'\n/var/folders/gc/0752xrm56pnf0r0dsrn5370c0000gr/T/ipykernel_68073/3615654825.py:7: SyntaxWarning: invalid escape sequence '\\P'\n  ylabel(\"$|\\Phi(x)|$\")\n"},{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"e2ec37f8fc6a5f3e032d3cfb480d25b1","path":"/build/e2ec37f8fc6a5f3e032d3cfb480d25b1.png"}}}],"visibility":"show","key":"B3TYwa53yU"}],"data":{"tags":[]},"visibility":"show","key":"pS7LLlZshW"},{"type":"paragraph","position":{"start":{"line":272,"column":1},"end":{"line":272,"column":1}},"children":[{"type":"text","value":"Each time ","position":{"start":{"line":272,"column":1},"end":{"line":272,"column":1}},"key":"XruJL1Ykck"},{"type":"text","value":"Φ","position":{"start":{"line":272,"column":1},"end":{"line":272,"column":1}},"key":"YxhYvdc9B9"},{"type":"text","value":" passes through zero at an interpolation node, the value on the log scale should go to ","position":{"start":{"line":272,"column":1},"end":{"line":272,"column":1}},"key":"Cl7tdKjQrp"},{"type":"inlineMath","value":"-\\infty","position":{"start":{"line":272,"column":1},"end":{"line":272,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>−</mo><mi mathvariant=\"normal\">∞</mi></mrow><annotation encoding=\"application/x-tex\">-\\infty</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord\">−</span><span class=\"mord\">∞</span></span></span></span>","key":"IBZPl78Lbd"},{"type":"text","value":", which explains the numerous cusps on the curves.","position":{"start":{"line":272,"column":1},"end":{"line":272,"column":1}},"key":"QmQQQNi8Xc"}],"key":"pB7sxHqIRw"}],"label":"demo-stability-errfun-python","identifier":"demo-stability-errfun-python","html_id":"demo-stability-errfun-python","key":"f7CWzd7gik"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-stability-runge","label":"demo-stability-runge","kind":"proof:example","position":{"start":{"line":276,"column":1},"end":{"line":276,"column":22}},"children":[{"type":"text","value":"Example ","key":"Cw0EplBglB"},{"type":"text","value":"9.3.3","key":"qFdUDrccHq"}],"template":"Example %s","enumerator":"9.3.3","resolved":true,"html_id":"demo-stability-runge","remote":true,"url":"/stability-1","dataUrl":"/stability-1.json","key":"wxGzUM8ugq"}],"key":"LqZjFImASe"},{"type":"paragraph","position":{"start":{"line":278,"column":1},"end":{"line":278,"column":1}},"children":[{"type":"text","value":"This function has infinitely many continuous derivatives on the entire real line and looks easy to approximate over ","position":{"start":{"line":278,"column":1},"end":{"line":278,"column":1}},"key":"ptKsWFMiSE"},{"type":"inlineMath","value":"[-1,1]","position":{"start":{"line":278,"column":1},"end":{"line":278,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mo>−</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[-1,1]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">−</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]</span></span></span></span>","key":"giza42zpMy"},{"type":"text","value":".","position":{"start":{"line":278,"column":1},"end":{"line":278,"column":1}},"key":"abRQzxpOsJ"}],"key":"oUWI5iR1DY"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"f = lambda x: 1 / (x**2 + 16)\nx = linspace(-1, 1, 1601)\nplot(x, f(x))\ntitle(\"Test function\");","key":"YgHtPgMv7a"},{"type":"output","id":"6xyUC6QHL1dc0vCbVCAL_","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"f76d077e96f8d14567c142712033ccfe","path":"/build/f76d077e96f8d14567c142712033ccfe.png"}}}],"key":"XUJK2TaQGd"}],"data":{},"key":"d9m3ACAOnL"},{"type":"paragraph","position":{"start":{"line":287,"column":1},"end":{"line":287,"column":1}},"children":[{"type":"text","value":"We start by doing equispaced polynomial interpolation for some small values of ","position":{"start":{"line":287,"column":1},"end":{"line":287,"column":1}},"key":"jF2RCi38np"},{"type":"inlineMath","value":"n","position":{"start":{"line":287,"column":1},"end":{"line":287,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"HhnCkwALqY"},{"type":"text","value":".","position":{"start":{"line":287,"column":1},"end":{"line":287,"column":1}},"key":"ximtSfSV2M"}],"key":"F9qO0ojwE2"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"N = arange(4, 16, 4)\nlabel = []\nfor k, n in enumerate(N):\n    t = linspace(-1, 1, n + 1)  # equally spaced nodes\n    y = f(t)  # interpolation data\n    p = FNC.polyinterp(t, y)\n    err = abs(f(x) - p(x))\n    semilogy(x, err, \".\", markersize=2)\n    label.append(f\"degree {n}\")\n\nxlabel(\"$x$\"),  ylabel(\"$|f(x)-p(x)|$\")\nylim([1e-20, 1])\nlegend(label),  title(\"Error for low degrees\");","visibility":"hide","key":"IgxgVqQz6P"},{"type":"output","id":"t4z9nu5rZrwGHddDQL4Tr","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"74d3fec528c820c9c1f8cad34e6d213d","path":"/build/74d3fec528c820c9c1f8cad34e6d213d.png"}}}],"visibility":"show","key":"apPWM7qXsM"}],"data":{"tags":[]},"visibility":"show","key":"scmc7vPwc4"},{"type":"paragraph","position":{"start":{"line":306,"column":1},"end":{"line":306,"column":1}},"children":[{"type":"text","value":"The convergence so far appears rather good, though not uniformly so. However, notice what happens as we continue to increase the degree.","position":{"start":{"line":306,"column":1},"end":{"line":306,"column":1}},"key":"NuW2FjqR3L"}],"key":"kKDmDYZAHR"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"N = 12 + 15 * arange(1, 4)\nlabels = []\nfor k, n in enumerate(N):\n    t = linspace(-1, 1, n + 1)  # equally spaced nodes\n    y = f(t)  # interpolation data\n    p = FNC.polyinterp(t, y)\n    err = abs(f(x) - p(x))\n    semilogy(x, err, \".\", markersize=2)\n    labels.append(f\"degree {n}\")\nxlabel(\"$x$\"),  ylabel(\"$|f(x)-p(x)|$\"),  ylim([1e-20, 1])\nlegend(labels),  title(\"Error for higher degrees\");","visibility":"hide","key":"SXvzMdtiIy"},{"type":"output","id":"amQnCU-MtQUnKPoSWKrCi","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"d2b8037bd1ca21079cf49ccb8b6637cf","path":"/build/d2b8037bd1ca21079cf49ccb8b6637cf.png"}}}],"visibility":"show","key":"gZL3ZQZ1sW"}],"data":{"tags":[]},"visibility":"show","key":"pe66DgHLat"},{"type":"paragraph","position":{"start":{"line":323,"column":1},"end":{"line":323,"column":1}},"children":[{"type":"text","value":"The convergence in the middle can’t get any better than machine precision relative to the function values. So maintaining the growing gap between the center and the ends pushes the error curves upward exponentially fast at the ends, wrecking the convergence.","position":{"start":{"line":323,"column":1},"end":{"line":323,"column":1}},"key":"bVX5Rw30HU"}],"key":"yu9O8K1IuE"}],"label":"demo-stability-runge-python","identifier":"demo-stability-runge-python","html_id":"demo-stability-runge-python","key":"yk5iuZOaRj"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-stability-errcheb","label":"demo-stability-errcheb","kind":"proof:example","position":{"start":{"line":327,"column":1},"end":{"line":327,"column":24}},"children":[{"type":"text","value":"Example ","key":"Z8yY2xRUwb"},{"type":"text","value":"9.3.4","key":"AfchnbQZ95"}],"template":"Example %s","enumerator":"9.3.4","resolved":true,"html_id":"demo-stability-errcheb","remote":true,"url":"/stability-1","dataUrl":"/stability-1.json","key":"TFPmkH7Abq"}],"key":"g3WeSTH3jv"},{"type":"paragraph","position":{"start":{"line":329,"column":1},"end":{"line":329,"column":1}},"children":[{"type":"text","value":"Now we look at the error indicator function ","position":{"start":{"line":329,"column":1},"end":{"line":329,"column":1}},"key":"Da4W2eD2Sv"},{"type":"text","value":"Φ","position":{"start":{"line":329,"column":1},"end":{"line":329,"column":1}},"key":"ML50MVnK8O"},{"type":"text","value":" for Chebyshev node sets.","position":{"start":{"line":329,"column":1},"end":{"line":329,"column":1}},"key":"SDBeKeaQVZ"}],"key":"Zc4yv6nVmG"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"x = linspace(-1, 1, 1601)\nlabels = []\nfor n in range(10, 60, 10):\n    theta = pi * arange(n + 1) / n\n    t = -cos(theta)\n    Phi = array([prod(xk - t) for xk in x])\n    semilogy(x, abs(Phi), \".\")\n    labels.append(f\"degree {n}\")\n\nxlabel(\"$x$\"),  ylabel(\"$|\\\\Phi(x)|$\"),  ylim([1e-18, 1e-2])\nlegend(labels),  title(\"Error indicator for Chebyshev nodes\");","visibility":"hide","key":"XKPdbInt51"},{"type":"output","id":"0hUeBzbELAJp-Q_hNWYqv","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"6bad3f707cc41d809b65390a839174be","path":"/build/6bad3f707cc41d809b65390a839174be.png"}}}],"visibility":"show","key":"Lif7uxf4bt"}],"data":{"tags":[]},"visibility":"show","key":"EqmEBycSEm"},{"type":"paragraph","position":{"start":{"line":346,"column":1},"end":{"line":346,"column":1}},"children":[{"type":"text","value":"In contrast to the equispaced case, ","position":{"start":{"line":346,"column":1},"end":{"line":346,"column":1}},"key":"yp2brtBsK1"},{"type":"inlineMath","value":"|\\Phi|","position":{"start":{"line":346,"column":1},"end":{"line":346,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">∣</mi><mi mathvariant=\"normal\">Φ</mi><mi mathvariant=\"normal\">∣</mi></mrow><annotation encoding=\"application/x-tex\">|\\Phi|</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">∣Φ∣</span></span></span></span>","key":"cys0UEhkIM"},{"type":"text","value":" decreases exponentially with ","position":{"start":{"line":346,"column":1},"end":{"line":346,"column":1}},"key":"orbvW2k5GO"},{"type":"inlineMath","value":"n","position":{"start":{"line":346,"column":1},"end":{"line":346,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"BhKd3Kfb1C"},{"type":"text","value":" almost uniformly across the interval.","position":{"start":{"line":346,"column":1},"end":{"line":346,"column":1}},"key":"MnMZ4UykMB"}],"key":"TdXKRGd4Y1"}],"label":"demo-stability-errcheb-python","identifier":"demo-stability-errcheb-python","html_id":"demo-stability-errcheb-python","key":"ZaSITMcjf6"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-stability-rungefix","label":"demo-stability-rungefix","kind":"proof:example","position":{"start":{"line":350,"column":1},"end":{"line":350,"column":25}},"children":[{"type":"text","value":"Example ","key":"DbPDWHHMaj"},{"type":"text","value":"9.3.5","key":"lCje5mi6XD"}],"template":"Example %s","enumerator":"9.3.5","resolved":true,"html_id":"demo-stability-rungefix","remote":true,"url":"/stability-1","dataUrl":"/stability-1.json","key":"m4qNNplzL8"}],"key":"fjzg1iLLVS"},{"type":"paragraph","position":{"start":{"line":352,"column":1},"end":{"line":352,"column":1}},"children":[{"type":"text","value":"Here again is the function from ","position":{"start":{"line":352,"column":1},"end":{"line":352,"column":1}},"key":"ZV4udHja3X"},{"type":"crossReference","kind":"proof:example","identifier":"demo-stability-runge","label":"demo-stability-runge","children":[{"type":"text","value":"Demo ","key":"eZq8ZkFjgG"},{"type":"text","value":"9.3.3","key":"J2tbtbvyQy"}],"template":"Example %s","enumerator":"9.3.3","resolved":true,"html_id":"demo-stability-runge","remote":true,"url":"/stability-1","dataUrl":"/stability-1.json","key":"wgVCpMNvSu"},{"type":"text","value":" that provoked the Runge phenomenon when using equispaced nodes.","position":{"start":{"line":352,"column":1},"end":{"line":352,"column":1}},"key":"ugqMj2yqkH"}],"key":"UtlZNC0iU1"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"f = lambda x: 1 / (x**2 + 16)","key":"UJbXafcLEw"},{"type":"output","id":"8GJehlLxwLZIzhj18mEg_","data":[],"key":"duKuNjzxAu"}],"data":{},"key":"tm41W0bDGg"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"x = linspace(-1, 1, 1601)\nlabels = []\nfor k, n in enumerate([4, 10, 16, 40]):\n    t = -cos(pi * arange(n + 1) / n)         # Chebyshev nodes\n    y = f(t)                                 # interpolation data\n    p = FNC.polyinterp(t, y)\n    err = abs(f(x) - p(x))\n    semilogy(x, err, \".\", markersize=2)\n    labels.append(f\"degree {n}\")\n\nxlabel(\"$x$\"),  ylabel(\"$|f(x)-p(x)|$\"),  ylim([1e-20, 1])\nlegend(labels),  title(\"Error for Chebyshev interpolants\");","visibility":"hide","key":"rbh0i6JlN5"},{"type":"output","id":"7OHjCBQ2maABbU8cG8VSc","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"9a4cf5cb2b83e09e4fbb24e46d27c6a8","path":"/build/9a4cf5cb2b83e09e4fbb24e46d27c6a8.png"}}}],"visibility":"show","key":"HU02ebp6EV"}],"data":{"tags":[]},"visibility":"show","key":"W1Sw2cTZxm"},{"type":"paragraph","position":{"start":{"line":374,"column":1},"end":{"line":374,"column":1}},"children":[{"type":"text","value":"By degree 16 the error is uniformly within machine epsilon, and, importantly, it stays there as ","position":{"start":{"line":374,"column":1},"end":{"line":374,"column":1}},"key":"yVHcihGzmw"},{"type":"inlineMath","value":"n","position":{"start":{"line":374,"column":1},"end":{"line":374,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"LAH4QyAYc3"},{"type":"text","value":" increases. Note that as predicted by the error indicator function, the error is uniform over the interval at each value of ","position":{"start":{"line":374,"column":1},"end":{"line":374,"column":1}},"key":"hzY7BhIdq7"},{"type":"inlineMath","value":"n","position":{"start":{"line":374,"column":1},"end":{"line":374,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"UDNPhiaOWW"},{"type":"text","value":".","position":{"start":{"line":374,"column":1},"end":{"line":374,"column":1}},"key":"uBGuozgHB8"}],"key":"RvnKDgYWOw"}],"label":"demo-stability-rungefix-python","identifier":"demo-stability-rungefix-python","html_id":"demo-stability-rungefix-python","key":"YQ5cgcwMh0"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-stability-spectral","label":"demo-stability-spectral","kind":"proof:example","position":{"start":{"line":378,"column":1},"end":{"line":378,"column":25}},"children":[{"type":"text","value":"Example ","key":"xvmj1uJ2f1"},{"type":"text","value":"9.3.6","key":"Tfrr9S8JmD"}],"template":"Example %s","enumerator":"9.3.6","resolved":true,"html_id":"demo-stability-spectral","remote":true,"url":"/stability-1","dataUrl":"/stability-1.json","key":"m7RqJJuAAe"}],"key":"ZkqtZgyWJ0"},{"type":"paragraph","position":{"start":{"line":380,"column":1},"end":{"line":380,"column":1}},"children":[{"type":"text","value":"On the left, we use a log-log scale, which makes second-order algebraic convergence ","position":{"start":{"line":380,"column":1},"end":{"line":380,"column":1}},"key":"QzM72VtjO9"},{"type":"inlineMath","value":"O(n^{-4})","position":{"start":{"line":380,"column":1},"end":{"line":380,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><msup><mi>n</mi><mrow><mo>−</mo><mn>4</mn></mrow></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(n^{-4})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">n</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">4</span></span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"xbDTgcyTte"},{"type":"text","value":" a straight line. On the right, we use a log-linear scale, which makes spectral convergence ","position":{"start":{"line":380,"column":1},"end":{"line":380,"column":1}},"key":"hIZdR8UL2C"},{"type":"inlineMath","value":"O(K^{-n})","position":{"start":{"line":380,"column":1},"end":{"line":380,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><msup><mi>K</mi><mrow><mo>−</mo><mi>n</mi></mrow></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(K^{-n})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0213em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7713em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mathnormal mtight\">n</span></span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"g2QBH45bgq"},{"type":"text","value":" linear.","position":{"start":{"line":380,"column":1},"end":{"line":380,"column":1}},"key":"LShmwwvTe8"}],"key":"b6UHYJKISF"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"n = arange(20, 420, 20)\nalgebraic = 100 / n**4\nspectral = 10 * 0.85**n\n\nsubplot(2, 1, 1)\nloglog(n, algebraic, 'o-', label=\"algebraic\")\nloglog(n, spectral, 'o-', label=\"spectral\")\nxlabel('n'),  ylabel('error') \ntitle('log–log'), ylim([1e-16, 1]);\nlegend() \n\nsubplot(2, 1, 2)\nsemilogy(n, algebraic, 'o-', label=\"algebraic\")\nsemilogy(n, spectral, 'o-', label=\"spectral\")\nxlabel('n'),  ylabel('error')\ntitle('log–linear') ,  ylim([1e-16, 1]);  \nlegend();","visibility":"hide","key":"lFYNc2JdxP"},{"type":"output","id":"4hph6ijY9fp5uKDuYtuBX","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 2 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"e48740560493626232caa58b83196b12","path":"/build/e48740560493626232caa58b83196b12.png"}}}],"visibility":"show","key":"LhKNiHwlAF"}],"data":{"tags":[]},"visibility":"show","key":"zVzNOAhffA"}],"label":"demo-stability-spectral-python","identifier":"demo-stability-spectral-python","html_id":"demo-stability-spectral-python","key":"T0Z2rdLsec"},{"type":"heading","depth":3,"position":{"start":{"line":404,"column":1},"end":{"line":404,"column":1}},"children":[{"type":"text","value":"9.4 ","position":{"start":{"line":404,"column":1},"end":{"line":404,"column":1}},"key":"GOaLdSa4I3"},{"type":"link","identifier":"section-globalapprox-orthogonal","label":"section-globalapprox-orthogonal","kind":"narrative","position":{"start":{"line":404,"column":5},"end":{"line":404,"column":37}},"url":"/orthogonal","internal":true,"dataUrl":"/orthogonal.json","children":[{"type":"text","value":"Orthogonal polynomials","key":"kQwmRYb5rN"}],"key":"SRtCNak5gf"}],"identifier":"id-9-4","label":"9.4 ","html_id":"id-9-4","implicit":true,"key":"cy4Wh0mbOF"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-orthogonal-approx","label":"demo-orthogonal-approx","kind":"proof:example","position":{"start":{"line":407,"column":1},"end":{"line":407,"column":24}},"children":[{"type":"text","value":"Example ","key":"Q3TLz5hizj"},{"type":"text","value":"9.4.1","key":"Cl88Pq961p"}],"template":"Example %s","enumerator":"9.4.1","resolved":true,"html_id":"demo-orthogonal-approx","remote":true,"url":"/orthogonal","dataUrl":"/orthogonal.json","key":"HZ4NUEGiIR"}],"key":"VBX05OwOLU"},{"type":"paragraph","position":{"start":{"line":409,"column":1},"end":{"line":409,"column":1}},"children":[{"type":"text","value":"Let’s approximate ","position":{"start":{"line":409,"column":1},"end":{"line":409,"column":1}},"key":"fipEfHiq0z"},{"type":"inlineMath","value":"e^x","position":{"start":{"line":409,"column":1},"end":{"line":409,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>e</mi><mi>x</mi></msup></mrow><annotation encoding=\"application/x-tex\">e^x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6644em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span></span></span></span></span></span></span></span>","key":"kTVM6LdZPT"},{"type":"text","value":" over the interval ","position":{"start":{"line":409,"column":1},"end":{"line":409,"column":1}},"key":"d5aDxvJPv1"},{"type":"inlineMath","value":"[−1,1]","position":{"start":{"line":409,"column":1},"end":{"line":409,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mo>−</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[−1,1]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">−</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]</span></span></span></span>","key":"EBcmZeqTfN"},{"type":"text","value":". We can sample it at, say, 15 points, and find the best-fitting straight line to that data.","position":{"start":{"line":409,"column":1},"end":{"line":409,"column":1}},"key":"y1qsu3t2F3"}],"key":"u0nnCrlmKl"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from numpy.linalg import lstsq\nt = linspace(-1, 1, 15)\ny = exp(t)\nplot(t, y, label=\"function\")\n\nV = [[ti**j for j in range(2)] for ti in t]\nc = lstsq(V, y, rcond=None)[0]\nprint(\"fit coeffs:\", c)\n\nx = linspace(-1, 1, 600)\nplot(x, c[1] + c[0] * x, label=\"fit\")\nxlabel(\"x\"),  ylabel(\"value\")\nlegend(),  title(\"Least squares fit of exp(x)\");","key":"bsBlNIg1A5"},{"type":"output","id":"sXGVCtzGlG6kZBJ_pKQkl","data":[{"output_type":"stream","name":"stdout","text":"fit coeffs: [1.20159125 1.11828384]\n"},{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"947809d79495f8018e7e32f7cec2c893","path":"/build/947809d79495f8018e7e32f7cec2c893.png"}}}],"key":"gSUhlYqYBS"}],"data":{},"key":"A8x6xWjKRB"},{"type":"paragraph","position":{"start":{"line":427,"column":1},"end":{"line":427,"column":1}},"children":[{"type":"text","value":"There’s nothing special about 15 points. Choosing more doesn’t change the result much.","position":{"start":{"line":427,"column":1},"end":{"line":427,"column":1}},"key":"tcGcgY2rMS"}],"key":"T4fc9yi4hN"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"t = linspace(-1, 1, 150)\ny = exp(t)\nplot(t, y, label=\"function\")\n\nV = [[ti**j for j in range(2)] for ti in t]\nc = lstsq(V, y, rcond=None)[0]\nprint(\"fit coeffs:\", c)\n\nx = linspace(-1, 1, 600)\nplot(x, c[1] + c[0] * x, label=\"fit\")\nxlabel(\"x\"),  ylabel(\"value\")\nlegend(),  title(\"Least squares fit of exp(x)\");","key":"arZLbKW9UZ"},{"type":"output","id":"sgRemNBHX-klNTh3G6YbA","data":[{"output_type":"stream","name":"stdout","text":"fit coeffs: [1.17767125 1.10507318]\n"},{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"7587172ef1b9b409c60c3a22b25712df","path":"/build/7587172ef1b9b409c60c3a22b25712df.png"}}}],"key":"lEczDtNiZm"}],"data":{},"key":"UGnhXVtNcC"},{"type":"paragraph","position":{"start":{"line":444,"column":1},"end":{"line":444,"column":1}},"children":[{"type":"text","value":"This situation is unlike interpolation, where the degree of the interpolant increases with the number of nodes. Here, the linear fit is apparently approaching a limit that we may think of as a continuous least-squares fit.","position":{"start":{"line":444,"column":1},"end":{"line":444,"column":1}},"key":"MxWWW8jIFE"}],"key":"CH2tLjSFmf"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"n = arange(40, 420, 60)\nresults = PrettyTable([\"n\", \"intercept\", \"slope\"])\nslope = zeros(n.size)\nintercept = zeros(n.size)\n\nfor k in range(n.size):\n    t = linspace(-1, 1, n[k])\n    y = exp(t)\n    V = [[ti**j for j in range(2)] for ti in t]\n    c = lstsq(V, y, rcond=None)[0]\n    results.add_row([n[k], c[1], c[0]])\n\nprint(results)","key":"FuvqRftRsW"},{"type":"output","id":"6pD0Vo356bO-z6qiKuPRz","data":[{"output_type":"stream","name":"stdout","text":"+-----+--------------------+--------------------+\n|  n  |     intercept      |       slope        |\n+-----+--------------------+--------------------+\n|  40 | 1.1090551764670025 | 1.1846492800335242 |\n| 100 | 1.105793288180965  | 1.1789195568501283 |\n| 160 | 1.1049832955976737 | 1.1775158384490085 |\n| 220 | 1.1046158595861273 | 1.176881503540092  |\n| 280 | 1.1044061059639807 | 1.1765200632992356 |\n| 340 | 1.1042704646318244 | 1.1762865906944795 |\n| 400 | 1.1041755539295632 | 1.1761233467177028 |\n+-----+--------------------+--------------------+\n"}],"key":"xQfZqU4LjW"}],"data":{},"key":"sq5UW7e2mg"}],"label":"demo-orthogonal-approx-python","identifier":"demo-orthogonal-approx-python","html_id":"demo-orthogonal-approx-python","key":"jG5KkWpPzI"},{"type":"heading","depth":3,"position":{"start":{"line":463,"column":1},"end":{"line":463,"column":1}},"children":[{"type":"text","value":"9.5 ","position":{"start":{"line":463,"column":1},"end":{"line":463,"column":1}},"key":"Elz2Qpu36K"},{"type":"link","identifier":"section-globalapprox-trig","label":"section-globalapprox-trig","kind":"narrative","position":{"start":{"line":463,"column":5},"end":{"line":463,"column":31}},"url":"/trig","internal":true,"dataUrl":"/trig.json","children":[{"type":"text","value":"Trigonometric interpolation","key":"YACbwctWyX"}],"key":"SAqY8GWbzO"}],"identifier":"id-9-5","label":"9.5 ","html_id":"id-9-5","implicit":true,"key":"aLcNY4iBJr"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-trig-interp","label":"demo-trig-interp","kind":"proof:example","position":{"start":{"line":466,"column":1},"end":{"line":466,"column":18}},"children":[{"type":"text","value":"Example ","key":"DNilfcAmSR"},{"type":"text","value":"9.5.1","key":"XfYEd9fbuC"}],"template":"Example %s","enumerator":"9.5.1","resolved":true,"html_id":"demo-trig-interp","remote":true,"url":"/trig","dataUrl":"/trig.json","key":"olqUtp50c0"}],"key":"elEz6Hlg9i"},{"type":"paragraph","position":{"start":{"line":468,"column":1},"end":{"line":468,"column":1}},"children":[{"type":"text","value":"We will get a cardinal function without using an explicit formula, just by passing data that is 1 at one node and 0 at the others.","position":{"start":{"line":468,"column":1},"end":{"line":468,"column":1}},"key":"yYHD4rKn29"}],"key":"jeB83BUB4Q"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"TCu3XCxxgk"}],"key":"zqh2uAsS9e"},{"type":"paragraph","position":{"start":{"line":471,"column":1},"end":{"line":471,"column":1}},"children":[{"type":"text","value":"The operator ","position":{"start":{"line":471,"column":1},"end":{"line":471,"column":1}},"key":"TqhnKQsbxA"},{"type":"inlineCode","value":"÷","position":{"start":{"line":471,"column":1},"end":{"line":471,"column":1}},"key":"feZj01oKoo"},{"type":"text","value":", typed as ","position":{"start":{"line":471,"column":1},"end":{"line":471,"column":1}},"key":"PteCuPxI2w"},{"type":"inlineCode","value":"\\div","position":{"start":{"line":471,"column":1},"end":{"line":471,"column":1}},"key":"cVOJ1aj6fV"},{"type":"text","value":" then ","position":{"start":{"line":471,"column":1},"end":{"line":471,"column":1}},"key":"k7CLIn8udR"},{"type":"keyboard","children":[{"type":"text","value":"Tab","key":"vDFUI8MOnm"}],"key":"fz8pgfB0Ab"},{"type":"text","value":", returns the quotient without remainder of two integers.","position":{"start":{"line":471,"column":1},"end":{"line":471,"column":1}},"key":"lLGZ0aIS99"}],"key":"ALxCTH1UR3"}],"class":"dropdown","key":"THu5r0gDHB"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"N = 7\nn = int((N - 1) / 2)\nt = 2 * arange(-n, n + 1) / N\ny = zeros(N)\ny[n] = 1\n\np = FNC.triginterp(t, y)\nx = linspace(-1, 1, 600)\nplot(x, p(x))\nplot(t, y, \"ko\")\n\nxlabel(\"x\"),  ylabel(\"tau(x)\")\ntitle(\"Trig cardinal function\");","key":"Ct6FvHmHqL"},{"type":"output","id":"nFtZFlc0jeP-g4rrnZUbY","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"fb00190277c8965c014ca999b7ddd102","path":"/build/fb00190277c8965c014ca999b7ddd102.png"}}}],"key":"fw74I6KAcM"}],"data":{},"key":"JKxWo07aOO"},{"type":"paragraph","position":{"start":{"line":490,"column":1},"end":{"line":490,"column":1}},"children":[{"type":"text","value":"Here is a 2-periodic function and one of its interpolants.","position":{"start":{"line":490,"column":1},"end":{"line":490,"column":1}},"key":"RSlAIrx6nv"}],"key":"iU9NWbSJSv"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"f = lambda x: exp(sin(pi * x) - 2 * cos(pi * x))\n\nplot(x, f(x), label=\"periodic function\")\ny = f(t)\n\np = FNC.triginterp(t, y)\nplot(x, p(x), label=\"trig interpolant\")\nplot(t, y, \"ko\", label=\"nodes\")\n\nxlabel(\"$x$\"),  ylabel(\"$p(x)$\")\nlegend(),  title(\"Trig interpolation\");","key":"qwogdhzNUW"},{"type":"output","id":"c1vkpF_--dJvDnOupZtRG","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"09dfe3433bca50bda96dc613b2fb2556","path":"/build/09dfe3433bca50bda96dc613b2fb2556.png"}}}],"key":"imjRsLGBbZ"}],"data":{},"key":"e0i0MD0qED"},{"type":"paragraph","position":{"start":{"line":506,"column":1},"end":{"line":506,"column":1}},"children":[{"type":"text","value":"The convergence of the interpolant is spectral. We let ","position":{"start":{"line":506,"column":1},"end":{"line":506,"column":1}},"key":"G9CAqrG1cP"},{"type":"inlineMath","value":"N","position":{"start":{"line":506,"column":1},"end":{"line":506,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span>","key":"DJOg3mijXt"},{"type":"text","value":" go needlessly large here in order to demonstrate that unlike polynomials, trigonometric interpolation is stable on equally spaced nodes. Note that when ","position":{"start":{"line":506,"column":1},"end":{"line":506,"column":1}},"key":"ps1QdtCGZf"},{"type":"inlineMath","value":"N","position":{"start":{"line":506,"column":1},"end":{"line":506,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span>","key":"MZ2XvgTlXs"},{"type":"text","value":" is even, the value of ","position":{"start":{"line":506,"column":1},"end":{"line":506,"column":1}},"key":"AhxAUiszUe"},{"type":"inlineMath","value":"n","position":{"start":{"line":506,"column":1},"end":{"line":506,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"ubGzIUf8iy"},{"type":"text","value":" is not an integer but works fine for defining the nodes.","position":{"start":{"line":506,"column":1},"end":{"line":506,"column":1}},"key":"A23Rv9N0fp"}],"key":"HN0p9mzoxP"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"N = arange(2, 62, 2)\nerr = zeros(N.size)\n\nx = linspace(-1, 1, 1601)    # for measuring error\nfor k in range(N.size):\n    n = (N[k] - 1) / 2\n    t = 2 * arange(-n, n + 1) / N[k]\n    p = FNC.triginterp(t, f(t))\n    err[k] = max(abs(f(x) - p(x)))\n\nsemilogy(N, err, \"-o\")\nxlabel(\"N\"),  ylabel(\"max error\")\ntitle(\"Convergence of trig interpolation\");","visibility":"hide","key":"BpbIOIw4W3"},{"type":"output","id":"SpLT2GD8wHXoUhtvRAupz","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"38e318a2a4767780cf5bfa0460961802","path":"/build/38e318a2a4767780cf5bfa0460961802.png"}}}],"visibility":"show","key":"ylhfFdvbhI"}],"data":{"tags":[]},"visibility":"show","key":"TOOe5ymu0L"}],"label":"demo-trig-interp-python","identifier":"demo-trig-interp-python","html_id":"demo-trig-interp-python","key":"ZXjWGsjQ7o"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-trig-fft","label":"demo-trig-fft","kind":"proof:example","position":{"start":{"line":527,"column":1},"end":{"line":527,"column":15}},"children":[{"type":"text","value":"Example ","key":"Tv5J1OfwLS"},{"type":"text","value":"9.5.2","key":"Pv9AOLQEFR"}],"template":"Example %s","enumerator":"9.5.2","resolved":true,"html_id":"demo-trig-fft","remote":true,"url":"/trig","dataUrl":"/trig.json","key":"ChSNycrTsO"}],"key":"LH1gscnV2q"},{"type":"paragraph","position":{"start":{"line":529,"column":1},"end":{"line":529,"column":1}},"children":[{"type":"text","value":"This function has frequency content at ","position":{"start":{"line":529,"column":1},"end":{"line":529,"column":1}},"key":"Cotvm1vOci"},{"type":"inlineMath","value":"2\\pi","position":{"start":{"line":529,"column":1},"end":{"line":529,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>2</mn><mi>π</mi></mrow><annotation encoding=\"application/x-tex\">2\\pi</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span></span></span></span>","key":"HqQS0AZJXI"},{"type":"text","value":", ","position":{"start":{"line":529,"column":1},"end":{"line":529,"column":1}},"key":"AwFZmVbJaf"},{"type":"inlineMath","value":"-2\\pi","position":{"start":{"line":529,"column":1},"end":{"line":529,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>−</mo><mn>2</mn><mi>π</mi></mrow><annotation encoding=\"application/x-tex\">-2\\pi</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">−</span><span class=\"mord\">2</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span></span></span></span>","key":"johDFko8oD"},{"type":"text","value":", and ","position":{"start":{"line":529,"column":1},"end":{"line":529,"column":1}},"key":"JO0CWbM752"},{"type":"text","value":"π","position":{"start":{"line":529,"column":1},"end":{"line":529,"column":1}},"key":"zSL3Uvddqv"},{"type":"text","value":".","position":{"start":{"line":529,"column":1},"end":{"line":529,"column":1}},"key":"RbZWTAQohf"}],"key":"xta7vovyXi"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"f = lambda x: 3 * cos(2 * pi * x) - exp(1j * pi * x)","key":"Q6201ucswN"},{"type":"output","id":"WgHxoS_WFABBI1sVUM8os","data":[],"key":"ipihjrzW0m"}],"data":{},"key":"Uysxll1aJR"},{"type":"paragraph","position":{"start":{"line":535,"column":1},"end":{"line":535,"column":1}},"children":[{"type":"text","value":"To use ","position":{"start":{"line":535,"column":1},"end":{"line":535,"column":1}},"key":"sral0QRZw0"},{"type":"inlineCode","value":"fft","position":{"start":{"line":535,"column":1},"end":{"line":535,"column":1}},"key":"cX6uzmd4LI"},{"type":"text","value":", we set up nodes in the interval ","position":{"start":{"line":535,"column":1},"end":{"line":535,"column":1}},"key":"ZxYoWsWOou"},{"type":"inlineMath","value":"[0,2)","position":{"start":{"line":535,"column":1},"end":{"line":535,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mn>0</mn><mo separator=\"true\">,</mo><mn>2</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">[0,2)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">2</span><span class=\"mclose\">)</span></span></span></span>","key":"yqS6EVIXf1"},{"type":"text","value":".","position":{"start":{"line":535,"column":1},"end":{"line":535,"column":1}},"key":"k7gxsCt2CE"}],"key":"RZu8YD25rp"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"n = 4\nN = 2 * n + 1\nt = 2 * arange(0, N) / N    # nodes in [0,2)\ny = f(t)","key":"u5XAv0sy3A"},{"type":"output","id":"hfFCxmB_cTWGfmUvUIjAv","data":[],"key":"sNVDwLmzFd"}],"data":{},"key":"VeLGINcIZ0"},{"type":"paragraph","position":{"start":{"line":544,"column":1},"end":{"line":544,"column":1}},"children":[{"type":"text","value":"We perform Fourier analysis using ","position":{"start":{"line":544,"column":1},"end":{"line":544,"column":1}},"key":"iwnguq3l8V"},{"type":"inlineCode","value":"fft","position":{"start":{"line":544,"column":1},"end":{"line":544,"column":1}},"key":"Q26mcz4UrO"},{"type":"text","value":" and then examine the resulting coefficients.","position":{"start":{"line":544,"column":1},"end":{"line":544,"column":1}},"key":"cfCTRiVHbh"}],"key":"V8O5HkQcGD"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from scipy.fftpack import fft, ifft, fftshift\nc = fft(y) / N\nfreq = hstack([arange(n+1), arange(-n,0)])\nresults = PrettyTable()\nresults.add_column(\"freq\", freq) \nresults.add_column(\"coefficient\", c)\nresults","key":"KFmlCvmBzO"},{"type":"output","id":"cUvIy3ugmGXe0Ixk44z6v","data":[{"output_type":"execute_result","execution_count":28,"metadata":{},"data":{"text/plain":{"content":"+------+--------------------------------------------------+\n| freq |                   coefficient                    |\n+------+--------------------------------------------------+\n|  0   | (-7.401486830834377e-17-1.2335811384723961e-17j) |\n|  1   |           (-1+3.7511926088583134e-16j)           |\n|  2   |   (1.4999999999999996-6.858640241643501e-16j)    |\n|  3   | (2.006783528541028e-16-4.9343245538895844e-17j)  |\n|  4   | (1.9737298215558337e-16+1.9273910434303325e-16j) |\n|  -4  | (9.048923903630054e-17-2.3825059632365783e-16j)  |\n|  -3  | (2.434108569959598e-16-4.9343245538895844e-17j)  |\n|  -2  |    (1.4999999999999998+7.05529154045317e-16j)    |\n|  -1  | (-9.048923903630054e-17-2.3825059632365783e-16j) |\n+------+--------------------------------------------------+","content_type":"text/plain"},"text/html":{"content":"<table>\n    <thead>\n        <tr>\n            <th>freq</th>\n            <th>coefficient</th>\n        </tr>\n    </thead>\n    <tbody>\n        <tr>\n            <td>0</td>\n            <td>(-7.401486830834377e-17-1.2335811384723961e-17j)</td>\n        </tr>\n        <tr>\n            <td>1</td>\n            <td>(-1+3.7511926088583134e-16j)</td>\n        </tr>\n        <tr>\n            <td>2</td>\n            <td>(1.4999999999999996-6.858640241643501e-16j)</td>\n        </tr>\n        <tr>\n            <td>3</td>\n            <td>(2.006783528541028e-16-4.9343245538895844e-17j)</td>\n        </tr>\n        <tr>\n            <td>4</td>\n            <td>(1.9737298215558337e-16+1.9273910434303325e-16j)</td>\n        </tr>\n        <tr>\n            <td>-4</td>\n            <td>(9.048923903630054e-17-2.3825059632365783e-16j)</td>\n        </tr>\n        <tr>\n            <td>-3</td>\n            <td>(2.434108569959598e-16-4.9343245538895844e-17j)</td>\n        </tr>\n        <tr>\n            <td>-2</td>\n            <td>(1.4999999999999998+7.05529154045317e-16j)</td>\n        </tr>\n        <tr>\n            <td>-1</td>\n            <td>(-9.048923903630054e-17-2.3825059632365783e-16j)</td>\n        </tr>\n    </tbody>\n</table>","content_type":"text/html"}}}],"key":"FT1X8dWtPY"}],"data":{},"key":"kj58JHUu3K"},{"type":"paragraph","position":{"start":{"line":556,"column":1},"end":{"line":556,"column":1}},"children":[{"type":"text","value":"Note that ","position":{"start":{"line":556,"column":1},"end":{"line":556,"column":1}},"key":"jlTRyoZGtU"},{"type":"inlineMath","value":"1.5 e^{2i\\pi x}+1.5 e^{-2i\\pi x} = 3 \\cos(2\\pi x)","position":{"start":{"line":556,"column":1},"end":{"line":556,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1.5</mn><msup><mi>e</mi><mrow><mn>2</mn><mi>i</mi><mi>π</mi><mi>x</mi></mrow></msup><mo>+</mo><mn>1.5</mn><msup><mi>e</mi><mrow><mo>−</mo><mn>2</mn><mi>i</mi><mi>π</mi><mi>x</mi></mrow></msup><mo>=</mo><mn>3</mn><mi>cos</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mn>2</mn><mi>π</mi><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">1.5 e^{2i\\pi x}+1.5 e^{-2i\\pi x} = 3 \\cos(2\\pi x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.908em;vertical-align:-0.0833em;\"></span><span class=\"mord\">1.5</span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8247em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">iπ</span><span class=\"mord mathnormal mtight\">x</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8247em;\"></span><span class=\"mord\">1.5</span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8247em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">2</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">iπ</span><span class=\"mord mathnormal mtight\">x</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">3</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">cos</span><span class=\"mopen\">(</span><span class=\"mord\">2</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span>","key":"L6sLQEaRrN"},{"type":"text","value":", so this result is sensible.","position":{"start":{"line":556,"column":1},"end":{"line":556,"column":1}},"key":"sBoZL9GOKX"}],"key":"Lmsb4qEe6z"},{"type":"paragraph","position":{"start":{"line":558,"column":1},"end":{"line":558,"column":1}},"children":[{"type":"text","value":"Fourier’s greatest contribution to mathematics was to point out that ","position":{"start":{"line":558,"column":1},"end":{"line":558,"column":1}},"key":"btJyO5wdOG"},{"type":"emphasis","position":{"start":{"line":558,"column":1},"end":{"line":558,"column":1}},"children":[{"type":"text","value":"every","position":{"start":{"line":558,"column":1},"end":{"line":558,"column":1}},"key":"Pt8TojCahL"}],"key":"BhHbd8AThe"},{"type":"text","value":" periodic function is just a combination of frequencies—infinitely many of them in general, but truncated for computational use. Here we look at the magnitudes of the coefficients for ","position":{"start":{"line":558,"column":1},"end":{"line":558,"column":1}},"key":"ww7YzNUkUF"},{"type":"inlineMath","value":"f(x) = \\exp( \\sin(\\pi x) )","position":{"start":{"line":558,"column":1},"end":{"line":558,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>exp</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mi>sin</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mi>π</mi><mi>x</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">f(x) = \\exp( \\sin(\\pi x) )</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop\">exp</span><span class=\"mopen\">(</span><span class=\"mop\">sin</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">))</span></span></span></span>","key":"EAFbm2LASF"},{"type":"text","value":".","position":{"start":{"line":558,"column":1},"end":{"line":558,"column":1}},"key":"N9yTTBPVX4"}],"key":"FgTwpYZdK6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"f = lambda x: exp(sin(pi * x))    # content at all frequencies\nn = 9;  N = 2*n + 1;\nt = 2 * arange(0, N) / N    # nodes in [0,2)\nc = fft(f(t)) / N\n\nsemilogy(range(-n, n+1), abs(fftshift(c)), \"o\")\nxlabel(\"$k$\"),  ylabel(\"$|c_k|$\")\ntitle(\"Fourier coefficients\");","visibility":"hide","key":"MvMYu2BJKB"},{"type":"output","id":"ziN29Y_4gah8c0jZiQWZv","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"44f979aa530255f1a957ea4a6a20a44f","path":"/build/44f979aa530255f1a957ea4a6a20a44f.png"}}}],"visibility":"show","key":"baDJ3Qvd1H"}],"data":{"tags":[]},"visibility":"show","key":"AEZ3PDUxs2"},{"type":"paragraph","position":{"start":{"line":572,"column":1},"end":{"line":572,"column":1}},"children":[{"type":"text","value":"The Fourier coefficients of smooth functions decay exponentially in magnitude as a function of the frequency. This decay rate is determines the convergence of the interpolation error.","position":{"start":{"line":572,"column":1},"end":{"line":572,"column":1}},"key":"BTo9jqoCgZ"}],"key":"ff8C6po5Ap"}],"label":"demo-trig-fft-python","identifier":"demo-trig-fft-python","html_id":"demo-trig-fft-python","key":"E6wPG6Jn8U"},{"type":"heading","depth":3,"position":{"start":{"line":575,"column":1},"end":{"line":575,"column":1}},"children":[{"type":"text","value":"9.6 ","position":{"start":{"line":575,"column":1},"end":{"line":575,"column":1}},"key":"Q04SmxgvEe"},{"type":"link","identifier":"section-globalapprox-integration","label":"section-globalapprox-integration","kind":"narrative","position":{"start":{"line":575,"column":5},"end":{"line":575,"column":38}},"url":"/spectral-integration","internal":true,"dataUrl":"/spectral-integration.json","children":[{"type":"text","value":"Spectrally accurate integration","key":"D8UFEyiagN"}],"key":"LCLrknOA56"}],"identifier":"id-9-6","label":"9.6 ","html_id":"id-9-6","implicit":true,"key":"LCFuMHmxws"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-integration-ellipse","label":"demo-integration-ellipse","kind":"proof:example","position":{"start":{"line":578,"column":1},"end":{"line":578,"column":26}},"children":[{"type":"text","value":"Example ","key":"AhE1CToyW7"},{"type":"text","value":"9.6.1","key":"hvlvKSscXF"}],"template":"Example %s","enumerator":"9.6.1","resolved":true,"html_id":"demo-integration-ellipse","remote":true,"url":"/spectral-integration","dataUrl":"/spectral-integration.json","key":"tvm5nSjsoX"}],"key":"BDBzRiA6yR"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"f = lambda t: pi * sqrt(cos(pi * t) ** 2 + sin(pi * t) ** 2 / 4)\nN = arange(4, 48, 6)\nperim = zeros(N.size)\nfor k in range(N.size):\n    h = 2 / N[k]\n    t = h * arange(N[k]) - 1\n    perim[k] = h * sum(f(t))\nerr = abs(perim - perim[-1])    # use the last value as reference\nresults = PrettyTable()\nresults.add_column(\"N\", N)\nresults.add_column(\"perimeter\", perim)\nresults.add_column(\"error\", err)\nresults","key":"ICN3LsaKxR"},{"type":"output","id":"HPOY3NIygXHIrEzcl3V68","data":[{"output_type":"execute_result","execution_count":30,"metadata":{},"data":{"text/plain":{"content":"+----+--------------------+------------------------+\n| N  |     perimeter      |         error          |\n+----+--------------------+------------------------+\n| 4  |  4.71238898038469  |  0.13183512988939494   |\n| 10 | 4.845238036570318  |  0.001013926296232981  |\n| 16 | 4.844206195096973  | 1.7915177111582636e-05 |\n| 22 | 4.844224515125559  | 4.0485147412283595e-07 |\n| 28 | 4.844224099926928  | 1.034715690906296e-08  |\n| 34 | 4.844224110558528  | 2.844435798010636e-10  |\n| 40 | 4.8442241102656105 | 8.474110302358895e-12  |\n| 46 | 4.844224110274085  |          0.0           |\n+----+--------------------+------------------------+","content_type":"text/plain"},"text/html":{"content":"<table>\n    <thead>\n        <tr>\n            <th>N</th>\n            <th>perimeter</th>\n            <th>error</th>\n        </tr>\n    </thead>\n    <tbody>\n        <tr>\n            <td>4</td>\n            <td>4.71238898038469</td>\n            <td>0.13183512988939494</td>\n        </tr>\n        <tr>\n            <td>10</td>\n            <td>4.845238036570318</td>\n            <td>0.001013926296232981</td>\n        </tr>\n        <tr>\n            <td>16</td>\n            <td>4.844206195096973</td>\n            <td>1.7915177111582636e-05</td>\n        </tr>\n        <tr>\n            <td>22</td>\n            <td>4.844224515125559</td>\n            <td>4.0485147412283595e-07</td>\n        </tr>\n        <tr>\n            <td>28</td>\n            <td>4.844224099926928</td>\n            <td>1.034715690906296e-08</td>\n        </tr>\n        <tr>\n            <td>34</td>\n            <td>4.844224110558528</td>\n            <td>2.844435798010636e-10</td>\n        </tr>\n        <tr>\n            <td>40</td>\n            <td>4.8442241102656105</td>\n            <td>8.474110302358895e-12</td>\n        </tr>\n        <tr>\n            <td>46</td>\n            <td>4.844224110274085</td>\n            <td>0.0</td>\n        </tr>\n    </tbody>\n</table>","content_type":"text/html"}}}],"key":"R52XNJLddf"}],"data":{},"key":"xN0jyJcwET"},{"type":"paragraph","position":{"start":{"line":595,"column":1},"end":{"line":595,"column":1}},"children":[{"type":"text","value":"The approximations gain about one digit of accuracy for each constant increment of ","position":{"start":{"line":595,"column":1},"end":{"line":595,"column":1}},"key":"aEatIQTNMH"},{"type":"inlineMath","value":"n","position":{"start":{"line":595,"column":1},"end":{"line":595,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"YVowvaf29C"},{"type":"text","value":", which is consistent with spectral convergence.","position":{"start":{"line":595,"column":1},"end":{"line":595,"column":1}},"key":"p9ZMzlprBf"}],"key":"PDfeUDps2j"}],"label":"demo-integration-ellipse-python","identifier":"demo-integration-ellipse-python","html_id":"demo-integration-ellipse-python","key":"FJDTaaFNKR"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-integration-compare","label":"demo-integration-compare","kind":"proof:example","position":{"start":{"line":599,"column":1},"end":{"line":599,"column":26}},"children":[{"type":"text","value":"Example ","key":"KdAo5CaqLk"},{"type":"text","value":"9.6.3","key":"Z1IAHXaNwF"}],"template":"Example %s","enumerator":"9.6.3","resolved":true,"html_id":"demo-integration-compare","remote":true,"url":"/spectral-integration","dataUrl":"/spectral-integration.json","key":"Y9GIjtdsRB"}],"key":"iT906s2EyL"},{"type":"paragraph","position":{"start":{"line":601,"column":1},"end":{"line":601,"column":1}},"children":[{"type":"text","value":"First consider the integral","position":{"start":{"line":601,"column":1},"end":{"line":601,"column":1}},"key":"TQvvnR0CUz"}],"key":"Q5m5Zw453x"},{"type":"math","value":"\\int_{-1}^1 \\frac{1}{1+4x^2} \\, dx = \\arctan(2).","position":{"start":{"line":603,"column":1},"end":{"line":605,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msubsup><mo>∫</mo><mrow><mo>−</mo><mn>1</mn></mrow><mn>1</mn></msubsup><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><mn>4</mn><msup><mi>x</mi><mn>2</mn></msup></mrow></mfrac><mtext> </mtext><mi>d</mi><mi>x</mi><mo>=</mo><mi>arctan</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mn>2</mn><mo stretchy=\"false\">)</mo><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">\\int_{-1}^1 \\frac{1}{1+4x^2} \\, dx = \\arctan(2).</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.5343em;vertical-align:-0.9703em;\"></span><span class=\"mop\"><span class=\"mop op-symbol large-op\" style=\"margin-right:0.44445em;position:relative;top:-0.0011em;\">∫</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.564em;\"><span style=\"top:-1.7881em;margin-left:-0.4445em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.8129em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9703em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">4</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7401em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7693em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop\">arctan</span><span class=\"mopen\">(</span><span class=\"mord\">2</span><span class=\"mclose\">)</span><span class=\"mord\">.</span></span></span></span></span>","enumerator":"1","key":"QYkocKqQUO"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"f = lambda x: 1 / (1 + 4 * x**2)\nexact = arctan(2)","key":"EWQChy9U9x"},{"type":"output","id":"mIrD9bNzmuNBwFVdulOB3","data":[],"key":"YsPmai5ro8"}],"data":{},"key":"aavt7NnXOE"},{"type":"paragraph","position":{"start":{"line":612,"column":1},"end":{"line":612,"column":1}},"children":[{"type":"text","value":"We compare the two spectral integration methods for a range of ","position":{"start":{"line":612,"column":1},"end":{"line":612,"column":1}},"key":"gj5M4PFJG6"},{"type":"inlineMath","value":"n","position":{"start":{"line":612,"column":1},"end":{"line":612,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"Qei6OKzU88"},{"type":"text","value":" values.","position":{"start":{"line":612,"column":1},"end":{"line":612,"column":1}},"key":"KFOrjGKWoN"}],"key":"WTHTDu32ii"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"N = range(8, 100, 4)\nerrCC = zeros(len(N))\nerrGL = zeros(len(N))\nfor k, n in enumerate(N):\n    errCC[k] = exact - FNC.ccint(f, n)[0]\n    errGL[k] = exact - FNC.glint(f, n)[0]\n\nsemilogy(N, abs(errCC), \"-o\", label=\"Clenshaw–Curtis\")\nsemilogy(N, abs(errGL), \"-o\", label=\"Gauss–Legendre\")\nxlabel(\"number of nodes\"),  ylabel(\"error\"),  ylim(1e-16, 0.01)\nlegend(),  title(\"Spectral integration\");","visibility":"hide","key":"mqLSYE35gK"},{"type":"output","id":"0BM7r2_Ew79d8thLLJmew","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"d14f3fed4cfc4785472abb152f1ee95e","path":"/build/d14f3fed4cfc4785472abb152f1ee95e.png"}}}],"visibility":"show","key":"RWQUITfaES"}],"data":{"tags":[]},"visibility":"show","key":"GEa0JE9g10"},{"type":"paragraph","position":{"start":{"line":629,"column":1},"end":{"line":629,"column":1}},"children":[{"type":"text","value":"(The missing dots are where the error is exactly zero.) Gauss–Legendre does converge faster here, but at something less than twice the rate.","position":{"start":{"line":629,"column":1},"end":{"line":629,"column":1}},"key":"d8cj5Dsc2r"}],"key":"A8H582jPsC"},{"type":"paragraph","position":{"start":{"line":631,"column":1},"end":{"line":631,"column":1}},"children":[{"type":"text","value":"Now we try a more sharply peaked integrand:","position":{"start":{"line":631,"column":1},"end":{"line":631,"column":1}},"key":"mWapYp7dh0"}],"key":"Qlwm7JXGys"},{"type":"math","value":"\\int_{-1}^1 \\frac{1}{1+16x^2} \\, dx = \\frac{1}{2}\\arctan(4).","position":{"start":{"line":633,"column":1},"end":{"line":633,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msubsup><mo>∫</mo><mrow><mo>−</mo><mn>1</mn></mrow><mn>1</mn></msubsup><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><mn>16</mn><msup><mi>x</mi><mn>2</mn></msup></mrow></mfrac><mtext> </mtext><mi>d</mi><mi>x</mi><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mi>arctan</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mn>4</mn><mo stretchy=\"false\">)</mo><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">\\int_{-1}^1 \\frac{1}{1+16x^2} \\, dx = \\frac{1}{2}\\arctan(4).</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.5343em;vertical-align:-0.9703em;\"></span><span class=\"mop\"><span class=\"mop op-symbol large-op\" style=\"margin-right:0.44445em;position:relative;top:-0.0011em;\">∫</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.564em;\"><span style=\"top:-1.7881em;margin-left:-0.4445em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.8129em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9703em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">16</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7401em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7693em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.0074em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">2</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">arctan</span><span class=\"mopen\">(</span><span class=\"mord\">4</span><span class=\"mclose\">)</span><span class=\"mord\">.</span></span></span></span></span>","enumerator":"2","key":"sk6FEiF2jI"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"f = lambda x: 1 / (1 + 16 * x**2)\nexact = atan(4) / 2","key":"kWraRj5DOz"},{"type":"output","id":"wi0n0eP3e7EOGdt3zcbRO","data":[],"key":"LEo5CPQxBf"}],"data":{},"key":"nGJt69smd8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"N = range(8, 100, 4)\nerrCC = zeros(len(N))\nerrGL = zeros(len(N))\nfor k, n in enumerate(N):\n    errCC[k] = exact - FNC.ccint(f, n)[0]\n    errGL[k] = exact - FNC.glint(f, n)[0]\n\nsemilogy(N, abs(errCC), \"-o\", label=\"Clenshaw–Curtis\")\nsemilogy(N, abs(errGL), \"-o\", label=\"Gauss–Legendre\")\nxlabel(\"number of nodes\"),  ylabel(\"error\"),  ylim(1e-16, 0.1)\nlegend(),  title(\"Spectral integration\");","visibility":"hide","key":"jZVLjEmZFA"},{"type":"output","id":"tSIj2k0Up7Dbov71qbIWw","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"2eeb8174c715ca33186a5e774670235c","path":"/build/2eeb8174c715ca33186a5e774670235c.png"}}}],"visibility":"show","key":"r4hLLrdxow"}],"data":{"tags":[]},"visibility":"show","key":"F9wByAf1LO"},{"type":"paragraph","position":{"start":{"line":655,"column":1},"end":{"line":655,"column":1}},"children":[{"type":"text","value":"The two are very close until about ","position":{"start":{"line":655,"column":1},"end":{"line":655,"column":1}},"key":"r2xxNI2hC0"},{"type":"inlineMath","value":"n=40","position":{"start":{"line":655,"column":1},"end":{"line":655,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>=</mo><mn>40</mn></mrow><annotation encoding=\"application/x-tex\">n=40</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">40</span></span></span></span>","key":"hvIS1OEVo6"},{"type":"text","value":", when the Clenshaw–Curtis method slows down.","position":{"start":{"line":655,"column":1},"end":{"line":655,"column":1}},"key":"UGz4UFAjEW"}],"key":"vO0tvHRNMm"},{"type":"paragraph","position":{"start":{"line":657,"column":1},"end":{"line":657,"column":1}},"children":[{"type":"text","value":"Now let’s compare the spectral performance to that of our earlier adaptive method in ","position":{"start":{"line":657,"column":1},"end":{"line":657,"column":1}},"key":"DZkXMiAS6P"},{"type":"inlineCode","value":"intadapt","position":{"start":{"line":657,"column":1},"end":{"line":657,"column":1}},"key":"ipv08pzKTe"},{"type":"text","value":". We will specify varying error tolerances and record the error as well as the total number of evaluations of ","position":{"start":{"line":657,"column":1},"end":{"line":657,"column":1}},"key":"DCQDyd8M3U"},{"type":"inlineMath","value":"f","position":{"start":{"line":657,"column":1},"end":{"line":657,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>","key":"bbNJ0PjMsd"},{"type":"text","value":".","position":{"start":{"line":657,"column":1},"end":{"line":657,"column":1}},"key":"VEjhgfoKrO"}],"key":"F7zjHcErQc"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"loglog(N, abs(errCC), \"-o\", label=\"ccint\")\nloglog(N, abs(errGL), \"-o\", label=\"glint\")\n\ntol_ = 1 / 10 ** arange(2, 15)\nn = zeros(tol_.size)\nerrAdapt = zeros(tol_.size)\nfor k, tol in enumerate(tol_):\n    Q, t = FNC.intadapt(f, -1, 1, tol)\n    errAdapt[k] = exact - Q\n    n[k] = t.size\n\nloglog(n, abs(errAdapt), \"-o\", label=\"intadapt\")\nloglog(n, 1 / (n**4), \"--\", label=\"4th order\")\nxlabel(\"number of nodes\"),  ylabel(\"error\"),  ylim(1e-16, 1)\nlegend(),  title(\"Spectral vs 4th order\");","visibility":"hide","key":"qBkqhZNIOA"},{"type":"output","id":"RIL2X2Wew8Qtw2ZgqSIzR","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"f238209abb390cc8c76050109a0eebd4","path":"/build/f238209abb390cc8c76050109a0eebd4.png"}}}],"visibility":"show","key":"WzS6DCeB0a"}],"data":{"tags":[]},"visibility":"show","key":"s8ohZnY2CP"},{"type":"paragraph","position":{"start":{"line":678,"column":1},"end":{"line":678,"column":1}},"children":[{"type":"text","value":"At the core of ","position":{"start":{"line":678,"column":1},"end":{"line":678,"column":1}},"key":"MgSPGjG1qP"},{"type":"inlineCode","value":"intadapt","position":{"start":{"line":678,"column":1},"end":{"line":678,"column":1}},"key":"y8PwHU1Qkq"},{"type":"text","value":" is a fourth-order formula, and the results track that rate closely. For all but the most relaxed error tolerances, both spectral methods are far more efficient than the low-order counterpart. For other integrands, particularly those that vary nonuniformly across the interval, the adaptive method might be more competitive.","position":{"start":{"line":678,"column":1},"end":{"line":678,"column":1}},"key":"GjybJqVCR3"}],"key":"Vns8F8kWWY"}],"label":"demo-integration-compare-python","identifier":"demo-integration-compare-python","html_id":"demo-integration-compare-python","key":"zO6Ttd6aDR"},{"type":"heading","depth":3,"position":{"start":{"line":682,"column":1},"end":{"line":682,"column":1}},"children":[{"type":"text","value":"9.7 ","position":{"start":{"line":682,"column":1},"end":{"line":682,"column":1}},"key":"g45gxW7zZ3"},{"type":"link","identifier":"section-globalapprox-improper","label":"section-globalapprox-improper","kind":"narrative","position":{"start":{"line":682,"column":5},"end":{"line":682,"column":35}},"url":"/improper","internal":true,"dataUrl":"/improper.json","children":[{"type":"text","value":"Improper integrals","key":"pLFE8GvjFa"}],"key":"hQXByouLho"}],"identifier":"id-9-7","label":"9.7 ","html_id":"id-9-7","implicit":true,"key":"ighofXPvT1"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-improper-decay","label":"demo-improper-decay","kind":"proof:example","position":{"start":{"line":685,"column":1},"end":{"line":685,"column":21}},"children":[{"type":"text","value":"Example ","key":"q3xhvYbZWL"},{"type":"text","value":"9.7.2","key":"Q7rdoinkyP"}],"template":"Example %s","enumerator":"9.7.2","resolved":true,"html_id":"demo-improper-decay","remote":true,"url":"/improper","dataUrl":"/improper.json","key":"rvUTcVSCsO"}],"key":"NmCozcbI9y"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"f = lambda x: 1 / (1 + x**2)\nx = linspace(-4, 4, 500)\nsubplot(2, 1, 1)\nplot(x, f(x)),  yscale('log')\nxlabel('x'),  ylabel('f(x)'),  ylim([1e-16, 1])  \ntitle('Original integrand')   \n\nxi = lambda t: sinh( pi * sinh(t) / 2 )\ndxi_dt = lambda t: pi/2 * cosh(t) * cosh( pi * sinh(t) / 2 )\nintegrand = lambda t: f(xi(t)) * dxi_dt(t)\nsubplot(2, 1, 2)\nplot(x, integrand(x)),  yscale('log')\nxlabel('t'),  ylabel('f(x(t))'),  ylim([1e-16, 1])  \ntitle('Transformed integrand')","key":"n2hDX2OaGr"},{"type":"output","id":"xUMNbSrN0l6U_Dd4uQ3hN","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 2 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"ce38e05084aeaeb087863e540ec909e0","path":"/build/ce38e05084aeaeb087863e540ec909e0.png"}}}],"key":"DQcKAHLiv6"}],"data":{},"key":"AVYas8NU4w"},{"type":"paragraph","position":{"start":{"line":704,"column":1},"end":{"line":704,"column":1}},"children":[{"type":"text","value":"This graph suggests that we capture all of the integrand values that are larger than machine epsilon by integrating in ","position":{"start":{"line":704,"column":1},"end":{"line":704,"column":1}},"key":"bKaqVL0npr"},{"type":"inlineMath","value":"t","position":{"start":{"line":704,"column":1},"end":{"line":704,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span></span></span></span>","key":"D5d30TF3BX"},{"type":"text","value":" from ","position":{"start":{"line":704,"column":1},"end":{"line":704,"column":1}},"key":"YckTPEzbAh"},{"type":"text","value":"-4","position":{"start":{"line":704,"column":1},"end":{"line":704,"column":1}},"key":"FLrclMAr7q"},{"type":"text","value":" to ","position":{"start":{"line":704,"column":1},"end":{"line":704,"column":1}},"key":"itGpuEqcqb"},{"type":"text","value":"4","position":{"start":{"line":704,"column":1},"end":{"line":704,"column":1}},"key":"LwGBqPaKdq"},{"type":"text","value":".","position":{"start":{"line":704,"column":1},"end":{"line":704,"column":1}},"key":"IZr94fODOl"}],"key":"IiI7jwesYI"}],"label":"demo-improper-decay-python","identifier":"demo-improper-decay-python","html_id":"demo-improper-decay-python","key":"Mpa96sxfgH"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-improper-intinf","label":"demo-improper-intinf","kind":"proof:example","position":{"start":{"line":708,"column":1},"end":{"line":708,"column":22}},"children":[{"type":"text","value":"Example ","key":"fPej4TcMxZ"},{"type":"text","value":"9.7.3","key":"qLT3zJbOfF"}],"template":"Example %s","enumerator":"9.7.3","resolved":true,"html_id":"demo-improper-intinf","remote":true,"url":"/improper","dataUrl":"/improper.json","key":"Omi4nBPlR6"}],"key":"G3shStFbJR"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"f = lambda x: 1 / (1 + x**2)\nexact = pi\ntol = array([1 / 10**d for d in arange(5, 14, 0.5)])\nerr = zeros((tol.size, 2))\nlength = zeros((tol.size, 2))\nfor k in range(tol.size):\n    I1, x1 = FNC.intadapt(f, -2/tol[k], 2/tol[k], tol[k])\n    I2, x2 = FNC.intinf(f, tol[k])\n    err[k] = abs(exact - array([I1, I2]))\n    length[k] = [x1.size, x2.size]\nloglog(length, err, \"-o\")\n# plot(len,err,m=:o,label=[\"direct\" \"double exponential\"])\nn = array([100, 10000])\nloglog(n, 1000 / n**4, 'k--')\nxlabel(\"number of nodes\"),  ylabel(\"error\")\ntitle(\"Comparison of integration methods\")\nlegend([\"direct\", \"double exponential\", \"4th-order\"], loc=\"lower left\");","visibility":"hide","key":"BaFPT0lAU9"},{"type":"output","id":"Burs4pdXLDDCtC6wIJo2t","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"bd98193f83a79d6ee0ae9d3fd606e29f","path":"/build/bd98193f83a79d6ee0ae9d3fd606e29f.png"}}}],"visibility":"show","key":"k1TbRrqTI7"}],"data":{"tags":[]},"visibility":"show","key":"CHgCVl9yN6"},{"type":"paragraph","position":{"start":{"line":731,"column":1},"end":{"line":731,"column":1}},"children":[{"type":"text","value":"Both methods are roughly fourth-order due to Simpson’s formula in the underlying adaptive integration method. At equal numbers of evaluation nodes, however, the double exponential method is consistently 2--3 orders of magnitude more accurate.","position":{"start":{"line":731,"column":1},"end":{"line":731,"column":1}},"key":"xlGpTPBFXI"}],"key":"IKPmAPhjcb"}],"label":"demo-improper-intinf-python","identifier":"demo-improper-intinf-python","html_id":"demo-improper-intinf-python","key":"g7sBHpqZUy"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-improper-intsing","label":"demo-improper-intsing","kind":"proof:example","position":{"start":{"line":735,"column":1},"end":{"line":735,"column":23}},"children":[{"type":"text","value":"Example ","key":"Dzdh37cShn"},{"type":"text","value":"9.7.4","key":"iEAb4HJgBL"}],"template":"Example %s","enumerator":"9.7.4","resolved":true,"html_id":"demo-improper-intsing","remote":true,"url":"/improper","dataUrl":"/improper.json","key":"CUBnXEKEAm"}],"key":"znN4UlIzk9"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"f = lambda x: 1 / (10 * sqrt(x))\nexact = 0.2\ntol = array([1 / 10**d for d in arange(5, 14, 0.5)])\nerr = zeros((tol.size, 2))\nlength = zeros((tol.size, 2))\nfor k in range(tol.size):\n    I1, x1 = FNC.intadapt(f, (tol[k]/20)**2, 1, tol[k])\n    I2, x2 = FNC.intsing(f, tol[k])\n    err[k] = abs(exact - array([I1, I2]))\n    length[k] = [x1.size, x2.size]\nloglog(length, err, \"-o\")\n# plot(len,err,m=:o,label=[\"direct\" \"double exponential\"])\nn = array([100, 10000])\nloglog(n, 30 / n**4, 'k--')\nxlabel(\"number of nodes\"),  ylabel(\"error\")\ntitle(\"Comparison of integration methods\")\nlegend([\"direct\", \"double exponential\", \"4th-order\"], loc=\"lower left\");","visibility":"hide","key":"qEPjznBgQt"},{"type":"output","id":"RmUDHvfp_K6OVZW5NPu6R","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"9d3cbbe6ca2dff2f9e28fd03610282f9","path":"/build/9d3cbbe6ca2dff2f9e28fd03610282f9.png"}}}],"visibility":"show","key":"trFXiVkIW1"}],"data":{"tags":[]},"visibility":"show","key":"dFSGcPUsZa"},{"type":"paragraph","position":{"start":{"line":759,"column":1},"end":{"line":759,"column":1}},"children":[{"type":"text","value":"As in ","position":{"start":{"line":759,"column":1},"end":{"line":759,"column":1}},"key":"dHXuHDKWAc"},{"type":"crossReference","kind":"proof:example","identifier":"demo-improper-intinf","label":"demo-improper-intinf","children":[{"type":"text","value":"Demo ","key":"npNumCv15B"},{"type":"text","value":"9.7.3","key":"LqAraucmJ7"}],"template":"Example %s","enumerator":"9.7.3","resolved":true,"html_id":"demo-improper-intinf","remote":true,"url":"/improper","dataUrl":"/improper.json","key":"lquKphmasx"},{"type":"text","value":", the double exponential method is more accurate than direct integration by a few orders of magnitude. Equivalently, the same accuracy can be reached with many fewer nodes.","position":{"start":{"line":759,"column":1},"end":{"line":759,"column":1}},"key":"MMvTnml5me"}],"key":"ygUdsGHUAF"}],"label":"demo-improper-intsing-python","identifier":"demo-improper-intsing-python","html_id":"demo-improper-intsing-python","key":"UyFF4qslkM"}],"key":"EMljI22IDA"}],"key":"TDf4l8oR8w"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Chapter 8","url":"/chapter8-2","group":"Python codes"},"next":{"title":"Chapter 10","url":"/chapter10-2","group":"Python codes"}}},"domain":"http://localhost:3000"}