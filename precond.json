{"version":1,"kind":"Article","sha256":"60870965230ad4d058c75412ae6d5f977ceb8635d3351516659d08456519f80e","slug":"precond","location":"/chapter8/precond.md","dependencies":[{"url":"/chapter8","label":"demo-precond-diagonal-julia","kind":"Notebook","slug":"chapter8","location":"/julia/chapter8.md","title":"Chapter 8"},{"url":"/chapter8-1","label":"demo-precond-diagonal-matlab","kind":"Notebook","slug":"chapter8-1","location":"/matlab/chapter8.md","title":"Chapter 8"},{"url":"/chapter8-2","label":"demo-precond-diagonal-python","kind":"Notebook","slug":"chapter8-2","location":"/python/chapter8.md","title":"Chapter 8"}],"frontmatter":{"title":"Preconditioning","numbering":{"heading_1":{"enabled":true},"heading_2":{"enabled":true},"heading_3":{"enabled":false},"enumerator":{"enumerator":"8.8.%s"},"title":{"offset":1}},"content_includes_title":false,"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","TPBVP":"two-point boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"edit_url":"https://github.com/fncbook/fnc/blob/master/chapter8/precond.md","exports":[{"format":"md","filename":"precond.md","url":"/build/precond-8cd6da3f680a7e60a1380c31280c1e5d.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"An important aspect of MINRES and CG (and, by extension, GMRES) is that the convergence of a Krylov method can be expected to deteriorate as the condition number of the matrix increases. Even moderately large condition numbers can make the convergence impractically slow. Therefore it’s common for these methods to be used with a technique to reduce the relevant condition number.","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"NIAhAThSDv"}],"key":"FwEeL2TL83"},{"type":"proof","kind":"definition","enumerated":true,"children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Preconditioning","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"D6qQzesCyR"}],"key":"qG5N64I3fJ"},{"type":"paragraph","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"Given a linear system ","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"zXGsI5It9q"},{"type":"inlineMath","value":"\\mathbf{A}\\mathbf{x}=\\mathbf{b}","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi><mi mathvariant=\"bold\">x</mi><mo>=</mo><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}\\mathbf{x}=\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">Ax</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"fDceH12ew5"},{"type":"text","value":", a ","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"fRHCoM8cXo"},{"type":"strong","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"preconditioner","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"eue9BG90oB"}],"key":"YqBNEceE1R"},{"type":"text","value":" is a matrix ","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"yQBjTwGoZk"},{"type":"inlineMath","value":"\\mathbf{M}","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">M</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{M}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">M</span></span></span></span>","key":"hjAJnmtzpH"},{"type":"text","value":" or equivalent linear transformation that modifies the system to be","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"RrUcpQTE8V"}],"key":"VblbtKI5GA"},{"type":"math","value":"(\\mathbf{M}^{-1} \\mathbf{A}) \\mathbf{x} = \\mathbf{M}^{-1}\\mathbf{b}.","label":"precond","identifier":"precond","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mo stretchy=\"false\">(</mo><msup><mi mathvariant=\"bold\">M</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi mathvariant=\"bold\">A</mi><mo stretchy=\"false\">)</mo><mi mathvariant=\"bold\">x</mi><mo>=</mo><msup><mi mathvariant=\"bold\">M</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi mathvariant=\"bold\">b</mi><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">(\\mathbf{M}^{-1} \\mathbf{A}) \\mathbf{x} = \\mathbf{M}^{-1}\\mathbf{b}.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.1141em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathbf\">M</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mord mathbf\">A</span><span class=\"mclose\">)</span><span class=\"mord mathbf\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8641em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">M</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mord mathbf\">b</span><span class=\"mord\">.</span></span></span></span></span>","enumerator":"8.8.1","html_id":"precond","key":"mDSr0RLXVu"}],"indexEntries":[{"entry":"GMRES","subEntry":{"value":"preconditioning in","kind":"entry"},"emphasis":false},{"entry":"preconditioning","emphasis":true}],"label":"index-krsDElgQw1","identifier":"index-krsdelgqw1","html_id":"index-krsdelgqw1","enumerator":"8.8.1","key":"DK7jCBjguv"},{"type":"paragraph","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"More specifically, ","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"SjD7pvyExE"},{"type":"crossReference","kind":"equation","identifier":"precond","label":"precond","children":[{"type":"text","value":"(","key":"G9WJbf4pzE"},{"type":"text","value":"8.8.1","key":"pY75NtGvpz"},{"type":"text","value":")","key":"aodsPx3X7Z"}],"template":"(%s)","enumerator":"8.8.1","resolved":true,"html_id":"precond","key":"Np59mCLJeP"},{"type":"text","value":" is known as ","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"z8kUAljDTP"},{"type":"emphasis","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"left preconditioning","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"Gfn1D98Zfc"}],"key":"fv9ElLB4uM"},{"type":"text","value":", but it is the simplest and most common type.","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"YU0ny4lMnT"}],"key":"fgurRmeUm9"},{"type":"paragraph","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"As usual, we do not want to actually compute ","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"TASc8bfqXI"},{"type":"inlineMath","value":"\\mathbf{M}^{-1}","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi mathvariant=\"bold\">M</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding=\"application/x-tex\">\\mathbf{M}^{-1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">M</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span></span></span></span>","key":"k1o6jxhXzi"},{"type":"text","value":" for a given ","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"NHqaTPtAZp"},{"type":"inlineMath","value":"\\mathbf{M}","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">M</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{M}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">M</span></span></span></span>","key":"HA10GrnqwP"},{"type":"text","value":". Instead, we have a linear system with the matrix ","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"PGV2VjMmeM"},{"type":"inlineMath","value":"\\mathbf{M}^{-1}\\mathbf{A}","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi mathvariant=\"bold\">M</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{M}^{-1}\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">M</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"Lq29K6Ryfm"},{"type":"text","value":". In a Krylov method, the operation “let ","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"I0B0eQ2SZ6"},{"type":"inlineMath","value":"\\mathbf{v}=\\mathbf{A}\\mathbf{u}","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">v</mi><mo>=</mo><mi mathvariant=\"bold\">A</mi><mi mathvariant=\"bold\">u</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{v}=\\mathbf{A}\\mathbf{u}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4444em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">v</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">Au</span></span></span></span>","key":"qBqSmyxu3b"},{"type":"text","value":"” becomes a two-step process:","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"ApvlP1CLrX"}],"key":"AD9ZM0EWMb"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":26,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"text","value":"Set ","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"glMYw50Hiz"},{"type":"inlineMath","value":"\\mathbf{y}=\\mathbf{A}\\mathbf{u}","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">y</mi><mo>=</mo><mi mathvariant=\"bold\">A</mi><mi mathvariant=\"bold\">u</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{y}=\\mathbf{A}\\mathbf{u}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6389em;vertical-align:-0.1944em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">Au</span></span></span></span>","key":"WbsPU3wU3G"},{"type":"text","value":".","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"kodzIZOSpZ"}],"key":"QrAvpiudvG"},{"type":"listItem","spread":true,"position":{"start":{"line":27,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"text","value":"Solve ","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"cPF7fhPePr"},{"type":"inlineMath","value":"\\mathbf{M}\\mathbf{v}=\\mathbf{y}","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">M</mi><mi mathvariant=\"bold\">v</mi><mo>=</mo><mi mathvariant=\"bold\">y</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{M}\\mathbf{v}=\\mathbf{y}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">Mv</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6389em;vertical-align:-0.1944em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">y</span></span></span></span>","key":"EOOtHCadmd"},{"type":"text","value":" for ","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"sgySJu4xjA"},{"type":"inlineMath","value":"\\mathbf{v}","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">v</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{v}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4444em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">v</span></span></span></span>","key":"jTecW1MSXS"},{"type":"text","value":".","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"jAqdgVAXqn"}],"key":"Tibxr1EAFZ"}],"key":"QA6EFwcsNM"},{"type":"paragraph","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"children":[{"type":"text","value":"As an implementation detail, it is common to provide the Krylov solver with code that does step 2; if the matrix ","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"kZgwhwFp7a"},{"type":"inlineMath","value":"\\mathbf{M}","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">M</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{M}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">M</span></span></span></span>","key":"Noza9phTn3"},{"type":"text","value":" is given, the default is to use sparse factorization.","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"CHVcgzGlri"}],"indexEntries":[{"entry":"sparse matrix","emphasis":false},{"entry":"LU factorization","emphasis":false}],"label":"index-dX0Rr5arOs","identifier":"index-dx0rr5aros","html_id":"index-dx0rr5aros","key":"ChDXKUoneZ"},{"type":"paragraph","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"children":[{"type":"text","value":"There are competing objectives in the choice of ","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"SeHJUcrPYs"},{"type":"inlineMath","value":"\\mathbf{M}","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">M</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{M}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">M</span></span></span></span>","key":"yPkpWB5xBO"},{"type":"text","value":". On one hand, we want ","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"SgVMB6csgo"},{"type":"inlineMath","value":"\\mathbf{M}^{-1}\\mathbf{A}\\approx \\mathbf{I}","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi mathvariant=\"bold\">M</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi mathvariant=\"bold\">A</mi><mo>≈</mo><mi mathvariant=\"bold\">I</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{M}^{-1}\\mathbf{A}\\approx \\mathbf{I}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">M</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mord mathbf\">A</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">I</span></span></span></span>","key":"Q7yBfFU3ht"},{"type":"text","value":" in some sense because that makes ","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"YBVXpmMvSm"},{"type":"crossReference","kind":"equation","identifier":"precond","label":"precond","children":[{"type":"text","value":"(","key":"k6QkzrmTSU"},{"type":"text","value":"8.8.1","key":"zxgK7BjadY"},{"type":"text","value":")","key":"d3eRhxJBSe"}],"template":"(%s)","enumerator":"8.8.1","resolved":true,"html_id":"precond","key":"MN6A5dD347"},{"type":"text","value":" easy to solve by Krylov iteration. Hence ","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"TsupZpe57J"},{"type":"inlineMath","value":"\\mathbf{M}\\approx \\mathbf{A}","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">M</mi><mo>≈</mo><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{M}\\approx \\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">M</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"sf4RNKguyZ"},{"type":"text","value":". On the other hand, we desire that solving the system ","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"jqlNXiNwn7"},{"type":"inlineMath","value":"\\mathbf{M}\\mathbf{v}=\\mathbf{y}","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">M</mi><mi mathvariant=\"bold\">v</mi><mo>=</mo><mi mathvariant=\"bold\">y</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{M}\\mathbf{v}=\\mathbf{y}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">Mv</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6389em;vertical-align:-0.1944em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">y</span></span></span></span>","key":"G2Dilpxguy"},{"type":"text","value":" be relatively fast.","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"n6nnAIHQCa"}],"key":"usfc3JWP32"},{"type":"proof","kind":"observation","enumerated":true,"children":[{"type":"paragraph","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"children":[{"type":"text","value":"Good preconditioning is a matter of finding an easily inverted (i.e., quickly solvable) approximation of the original matrix.","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"key":"v6ZHy4XRDG"}],"key":"w39GLOd12Q"}],"enumerator":"8.8.1","key":"NB6L9s6SoZ"},{"type":"heading","depth":2,"position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"children":[{"type":"text","value":"Diagonal preconditioning","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"NibyXjaYvV"}],"identifier":"diagonal-preconditioning","label":"Diagonal preconditioning","html_id":"diagonal-preconditioning","implicit":true,"enumerator":"8.8.1","key":"Z1MDtj0pui"},{"type":"paragraph","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"children":[{"type":"text","value":"One of the simplest choices for the preconditioner ","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"key":"iRirr0igiF"},{"type":"inlineMath","value":"\\mathbf{M}","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">M</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{M}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">M</span></span></span></span>","key":"GA51KmIJ7Y"},{"type":"text","value":" is a diagonal matrix. This definitely meets the requirement of being fast to invert: the solution of ","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"key":"WB1MOXs1ME"},{"type":"inlineMath","value":"\\mathbf{M}\\mathbf{v}=\\mathbf{y}","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">M</mi><mi mathvariant=\"bold\">v</mi><mo>=</mo><mi mathvariant=\"bold\">y</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{M}\\mathbf{v}=\\mathbf{y}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">Mv</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6389em;vertical-align:-0.1944em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">y</span></span></span></span>","key":"B59PrLQsZr"},{"type":"text","value":" is just ","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"key":"hMmrlXyzo6"},{"type":"inlineMath","value":"v_i=y_i/M_{ii}","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>v</mi><mi>i</mi></msub><mo>=</mo><msub><mi>y</mi><mi>i</mi></msub><mi mathvariant=\"normal\">/</mi><msub><mi>M</mi><mrow><mi>i</mi><mi>i</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">v_i=y_i/M_{ii}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">/</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.109em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">ii</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"QtA851gxd9"},{"type":"text","value":". The only question is whether it can be chosen in such a way that ","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"key":"EWLqulFY5R"},{"type":"inlineMath","value":"\\mathbf{M}^{-1}\\mathbf{A}","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi mathvariant=\"bold\">M</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{M}^{-1}\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">M</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"LIW0b0wbcA"},{"type":"text","value":" is much more amenable to Krylov iterations than ","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"key":"iDBUFLTW5S"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"lK8U4r3odq"},{"type":"text","value":" is. This may be the case when the rows of ","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"key":"BUsznv6Ii2"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"sFvjJj9g0a"},{"type":"text","value":" differ greatly in scale, or when ","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"key":"ekOebMZMPA"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"M2kDPyag1Z"},{"type":"text","value":" is diagonally dominant (see ","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"key":"I9L85hP5u0"},{"type":"crossReference","kind":"equation","identifier":"diag-dominant","label":"diag-dominant","children":[{"type":"text","value":"(","key":"C1pT1WMUAP"},{"type":"text","value":"2.9.1","key":"moeqoWEnQA"},{"type":"text","value":")","key":"OWARiSvikU"}],"template":"(%s)","enumerator":"2.9.1","resolved":true,"html_id":"diag-dominant","remote":true,"url":"/structure","dataUrl":"/structure.json","key":"n0QlfK3sx4"},{"type":"text","value":").","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"key":"jAziETI4hZ"}],"key":"LHG5QBld8s"},{"type":"proof","kind":"example","enumerated":true,"children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Diagonal preconditioning","position":{"start":{"line":45,"column":1},"end":{"line":45,"column":1}},"key":"AgDcSe7SZ7"}],"key":"aQvUBxTTSp"},{"type":"tabSet","children":[{"type":"tabItem","title":"Julia","sync":"julia","children":[{"type":"embed","source":{"url":"/chapter8","label":"demo-precond-diagonal-julia","kind":"Notebook","slug":"chapter8","location":"/julia/chapter8.md","title":"Chapter 8"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-precond-diagonal","label":"demo-precond-diagonal","kind":"proof:example","position":{"start":{"line":822,"column":1},"end":{"line":822,"column":23}},"children":[{"type":"text","value":"Example ","key":"q71ETjhYDX"},{"type":"text","value":"8.8.1","key":"leSXcqhpG6"}],"template":"Example %s","enumerator":"8.8.1","resolved":true,"html_id":"demo-precond-diagonal","remote":true,"url":"/precond","dataUrl":"/precond.json","key":"SUO6uBhYtN"}],"key":"DZ6xhpQZ08"},{"type":"paragraph","position":{"start":{"line":824,"column":1},"end":{"line":824,"column":1}},"children":[{"type":"text","value":"Here is an ","key":"Chz1gJkGUz"},{"type":"abbreviation","title":"symmetric positive definite","children":[{"type":"text","value":"SPD","key":"tT8jXODw7H"}],"key":"xD9Jov5Ggt"},{"type":"text","value":" matrix that arises from solving partial differential equations.","key":"ZaXoPVr0wZ"}],"key":"lLw6CqPMPZ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"using MatrixDepot\nA = matrixdepot(\"wathen\", 60)\nn = size(A, 1)\n@show n, nnz(A);","key":"feIEnW4zUd"},{"type":"output","id":"a5WKXO28aEbFVjQEkNNAy","data":[{"output_type":"stream","name":"stderr","text":"\u001b[36m\u001b[1m[ \u001b[22m\u001b[39m\u001b[36m\u001b[1mInfo: \u001b[22m\u001b[39mverify download of index files...\n\u001b[36m\u001b[1m[ \u001b[22m\u001b[39m\u001b[36m\u001b[1mInfo: \u001b[22m\u001b[39mreading database\n"},{"output_type":"stream","name":"stdout","text":"EOFError("},{"output_type":"stream","name":"stdout","text":")\n"},{"output_type":"stream","name":"stderr","text":"\u001b[33m\u001b[1m┌ \u001b[22m\u001b[39m\u001b[33m\u001b[1mWarning: \u001b[22m\u001b[39mrecreating database file\n\u001b[33m\u001b[1m└ \u001b[22m\u001b[39m\u001b[90m@ MatrixDepot ~/.julia/packages/MatrixDepot/4S7Oa/src/download.jl:59\u001b[39m\n\u001b[36m\u001b[1m[ \u001b[22m\u001b[39m\u001b[36m\u001b[1mInfo: \u001b[22m\u001b[39mreading index files\n\u001b[36m\u001b[1m[ \u001b[22m\u001b[39m\u001b[36m\u001b[1mInfo: \u001b[22m\u001b[39madding metadata...\n\u001b[36m\u001b[1m[ \u001b[22m\u001b[39m\u001b[36m\u001b[1mInfo: \u001b[22m\u001b[39madding svd data...\n"},{"output_type":"stream","name":"stderr","text":"\u001b[36m\u001b[1m[ \u001b[22m\u001b[39m\u001b[36m\u001b[1mInfo: \u001b[22m\u001b[39mwriting database\n\u001b[33m\u001b[1m┌ \u001b[22m\u001b[39m\u001b[33m\u001b[1mWarning: \u001b[22m\u001b[39mexception during initialization: 'KeyError(MatrixDepot)'\n\u001b[33m\u001b[1m└ \u001b[22m\u001b[39m\u001b[90m@ MatrixDepot ~/.julia/packages/MatrixDepot/4S7Oa/src/MatrixDepot.jl:125\u001b[39m\n"},{"output_type":"stream","name":"stdout","text":"(n, nnz(A)) = (11041, 170161)"},{"output_type":"stream","name":"stdout","text":"\n"}],"key":"cdmzuSEvrc"}],"data":{},"key":"nN716sPwXq"},{"type":"paragraph","position":{"start":{"line":836,"column":1},"end":{"line":836,"column":1}},"children":[{"type":"text","value":"There is an easy way to use the diagonal elements of ","position":{"start":{"line":836,"column":1},"end":{"line":836,"column":1}},"key":"si3ZEfe4kA"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":836,"column":1},"end":{"line":836,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"AdOfnU2SIO"},{"type":"text","value":", or any other vector, as a diagonal preconditioner.","position":{"start":{"line":836,"column":1},"end":{"line":836,"column":1}},"key":"BO48cXEsSP"}],"indexEntries":[{"entry":"Julia","subEntry":{"value":"DiagonalPreconditioner","kind":"entry"},"emphasis":true}],"key":"M2mPgcMGVS"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"using Preconditioners\nb = ones(n)\nM = DiagonalPreconditioner(diag(A));","key":"tNawk4pRtr"},{"type":"output","id":"fzrrdqcGgpjB-VQdpzBUZ","data":[],"key":"wfQyCndqTP"}],"data":{},"key":"S3MkM34r33"},{"type":"paragraph","position":{"start":{"line":844,"column":1},"end":{"line":844,"column":1}},"children":[{"type":"text","value":"We now compare CG with and without the preconditioner.","position":{"start":{"line":844,"column":1},"end":{"line":844,"column":1}},"key":"jB9KSWdKD4"}],"key":"ZofTPolVK8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"using IterativeSolvers, Plots\nplain(b) = cg(A, b, maxiter=200, reltol=1e-4, log=true)\ntime_plain = @elapsed x, hist1 = plain(b)\nprec(b) = cg(A, b, Pl=M, maxiter=200, reltol=1e-4, log=true)\ntime_prec = @elapsed x, hist2 = prec(b)\n@show time_plain, time_prec\n\nrr = hist1[:resnorm]\nplot(0:length(rr)-1, rr / rr[1], yscale=:log10, label=\"plain\")\nrr = hist2[:resnorm]\nplot!(0:length(rr)-1, rr / rr[1], yscale=:log10, label=\"preconditioned\")\ntitle!(\"Diagonal preconditioning in CG\")","visibility":"hide","key":"kruS9aDQcl"},{"type":"output","id":"J6eDvr3eaw-PsE_v6xCmC","data":[{"output_type":"stream","name":"stdout","text":"(time_plain, time_prec) = (11.505741375, 3.161089584)"},{"output_type":"stream","name":"stdout","text":"\n"},{"output_type":"execute_result","execution_count":71,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"769765da0e3dc74b82ddac2fa8d12e41","path":"/build/769765da0e3dc74b82ddac2fa8d12e41.png"},"text/html":{"content_type":"text/html","hash":"5c83a9aaa4040073d85a9a0b4e1d437b","path":"/build/5c83a9aaa4040073d85a9a0b4e1d437b.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"347ad383f878720ae369325edf95d8b8","path":"/build/347ad383f878720ae369325edf95d8b8.svg"}}}],"visibility":"show","key":"gj30RhRxm0"}],"data":{"tags":[]},"visibility":"show","key":"PkGR9RJNKa"},{"type":"paragraph","position":{"start":{"line":862,"column":1},"end":{"line":862,"column":1}},"children":[{"type":"text","value":"The diagonal preconditioner cut down substantially on the number of iterations. The effect on the total time is less dramatic, but this is not a large version of the problem.","position":{"start":{"line":862,"column":1},"end":{"line":862,"column":1}},"key":"tC1UZ2UIow"}],"key":"nSEMJZxfWO"}],"key":"XsfUNVrV3o"}],"key":"QM9aONMPSb"}],"key":"nU5WOE6BHX"},{"type":"tabItem","title":"MATLAB","sync":"matlab","children":[{"type":"embed","source":{"url":"/chapter8-1","label":"demo-precond-diagonal-matlab","kind":"Notebook","slug":"chapter8-1","location":"/matlab/chapter8.md","title":"Chapter 8"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-precond-diagonal","label":"demo-precond-diagonal","kind":"proof:example","position":{"start":{"line":772,"column":1},"end":{"line":772,"column":23}},"children":[{"type":"text","value":"Example ","key":"rCRbB9mtEs"},{"type":"text","value":"8.8.1","key":"pLTnMk9Lv7"}],"template":"Example %s","enumerator":"8.8.1","resolved":true,"html_id":"demo-precond-diagonal","remote":true,"url":"/precond","dataUrl":"/precond.json","key":"UpyHDH41x5"}],"key":"jjoQBhYRp4"},{"type":"paragraph","position":{"start":{"line":774,"column":1},"end":{"line":774,"column":1}},"children":[{"type":"text","value":"Here is an ","key":"U7zKL4qZ6y"},{"type":"abbreviation","title":"symmetric positive definite","children":[{"type":"text","value":"SPD","key":"PjUjUw9sus"}],"key":"gHKh0lCOgD"},{"type":"text","value":" matrix that arises from solving partial differential equations.","key":"tzyve3PjAD"}],"key":"DUJBiuSd3m"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A = gallery(\"wathen\", 60, 60);\nn = size(A, 1);\nclf,  spy(A)","key":"EmZjHgVfUi"},{"type":"output","id":"4ehJgEksxVaacaP2kaD1U","data":[{"output_type":"execute_result","execution_count":68,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"2e40bfa6a1affd76cf43bc0a66f7aa59","path":"/build/2e40bfa6a1affd76cf43bc0a66f7aa59.png"}}}],"key":"V2Z2d6s85f"}],"data":{},"key":"b30lXTsGV9"},{"type":"paragraph","position":{"start":{"line":782,"column":1},"end":{"line":782,"column":1}},"children":[{"type":"text","value":"There is an easy way to use the diagonal elements of ","position":{"start":{"line":782,"column":1},"end":{"line":782,"column":1}},"key":"DN2rYmQzOy"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":782,"column":1},"end":{"line":782,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"fcVVomBwIi"},{"type":"text","value":", or any other vector, as a diagonal preconditioner.","position":{"start":{"line":782,"column":1},"end":{"line":782,"column":1}},"key":"dYNNX0gCZM"}],"key":"bRqa1y6tCP"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"M = spdiags(diag(A), 0, n, n);","key":"bfzEcLozt5"},{"type":"output","id":"wzgdIKgwZKjgpD84JBQ9t","data":[{"output_type":"stream","name":"stderr","text":"Error using sparse\nUse sparse(m,n) to preallocate an m-by-n sparse matrix, or sparse(i,j,v) to specify the (i,j) locations of nonzero entries v.\n\nError in spdiags (line 72)\n        A = sparse(arg3, arg4);"}],"key":"gp8EUTQtn1"}],"data":{},"key":"XOJMZmMe9q"},{"type":"paragraph","position":{"start":{"line":788,"column":1},"end":{"line":788,"column":1}},"children":[{"type":"text","value":"We now compare MINRES with and without the preconditioner.","position":{"start":{"line":788,"column":1},"end":{"line":788,"column":1}},"key":"phboISUZoy"}],"key":"K4gX4dakq0"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"b = ones(n, 1);\n[x, ~, ~, ~, resid_plain] = minres(A, b, 1e-10, 400);\nclf,  semilogy(resid_plain)\nxlabel('iteration number'), ylabel('residual norm')\ntitle('Unpreconditioned MINRES')\n\n[x, ~, ~, ~, resid_prec] = minres(A, b, 1e-10, 400, M);\nhold on,  semilogy(resid_prec)\ntitle('Precondtioned MINRES')\nlegend('no prec.', 'with prec.');","visibility":"hide","key":"vVD5mCcawl"},{"type":"output","id":"la0dhtYv3mUNOOp5U8Sch","data":[{"output_type":"stream","name":"stderr","text":"Error using ones\nSize inputs must be scalar."}],"visibility":"show","key":"rpybxZDiAC"}],"data":{"tags":[]},"visibility":"show","key":"r9XCRLyt30"},{"type":"paragraph","position":{"start":{"line":805,"column":1},"end":{"line":805,"column":1}},"children":[{"type":"text","value":"The diagonal preconditioner cut down substantially on the number of iterations. The effect on the total time is less dramatic, but this is not a large version of the problem.","position":{"start":{"line":805,"column":1},"end":{"line":805,"column":1}},"key":"E9otRCbjw4"}],"key":"xMYYARn9tU"}],"key":"UOoHIdrwLO"}],"key":"D8A94FAyeK"}],"key":"uNr2PFuePk"},{"type":"tabItem","title":"Python","sync":"python","children":[{"type":"embed","source":{"url":"/chapter8-2","label":"demo-precond-diagonal-python","kind":"Notebook","slug":"chapter8-2","location":"/python/chapter8.md","title":"Chapter 8"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-precond-diagonal","label":"demo-precond-diagonal","kind":"proof:example","position":{"start":{"line":837,"column":1},"end":{"line":837,"column":23}},"children":[{"type":"text","value":"Example ","key":"tTPPupokW0"},{"type":"text","value":"8.8.1","key":"YSdNwN6c9R"}],"template":"Example %s","enumerator":"8.8.1","resolved":true,"html_id":"demo-precond-diagonal","remote":true,"url":"/precond","dataUrl":"/precond.json","key":"gQeMDXhT2t"}],"key":"VqNMwxahPi"},{"type":"paragraph","position":{"start":{"line":839,"column":1},"end":{"line":839,"column":1}},"children":[{"type":"text","value":"Here is an ","key":"N2Ukk5KzqV"},{"type":"abbreviation","title":"symmetric positive definite","children":[{"type":"text","value":"SPD","key":"QW1Zcc89x4"}],"key":"V1xn6G27qQ"},{"type":"text","value":" matrix that arises from solving partial differential equations.","key":"w3vXO3eATF"}],"key":"tJlv897G96"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from scipy.sparse import sparray\nimport rogues\nA = rogues.wathen(60, 60)\nn = A.shape[0]\nprint(f\"Matrix is {n} x {n} with {A.nnz} nonzeros\")","key":"TWIojTTZC9"},{"type":"output","id":"tzu6WzqfRFXMSwsBqqNux","data":[{"output_type":"stream","name":"stdout","text":"Matrix is 11041 x 11041 with 170161 nonzeros\n"}],"key":"mQRSZ05o1X"}],"data":{},"key":"aTdjUOKkUO"},{"type":"paragraph","position":{"start":{"line":849,"column":1},"end":{"line":849,"column":1}},"children":[{"type":"text","value":"There is an easy way to use the diagonal elements of ","position":{"start":{"line":849,"column":1},"end":{"line":849,"column":1}},"key":"IgejSQ1IWM"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":849,"column":1},"end":{"line":849,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"SerToqoKOJ"},{"type":"text","value":", or any other vector, as a diagonal preconditioner.","position":{"start":{"line":849,"column":1},"end":{"line":849,"column":1}},"key":"mokM7Rw0Ms"}],"key":"mbUg9mkzZB"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import scipy.sparse as sp\nprec = sp.diags(1 / A.diagonal(), 0)","key":"x6g6lU2967"},{"type":"output","id":"2h3OMPvnMfFQJzup7w1sP","data":[],"key":"wZquGzJlYN"}],"data":{},"key":"ITLrzbU2OJ"},{"type":"paragraph","position":{"start":{"line":856,"column":1},"end":{"line":856,"column":1}},"children":[{"type":"text","value":"We now compare CG with and without the preconditioner.","position":{"start":{"line":856,"column":1},"end":{"line":856,"column":1}},"key":"bLFsh69pDT"}],"key":"CjseWhYEcQ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from scipy.sparse.linalg import cg\nb = ones(n)\nhist = lambda x: resid.append(norm(b - A @ x))\nresid = [norm(b)]\nstart = timer()\nx, _ = cg(A, b, rtol=1e-4, maxiter=200, callback=hist)\nprint(f\"No preconditioner: Finished in {timer() - start:.2f} sec\")\nresid_plain = resid.copy()\nresid = [norm(b)]\nstart = timer()\nx, _ = cg(A, b, rtol=1e-4, maxiter=200, M=prec, callback=hist)\nprint(f\"Diagonal preconditioner: Finished in {timer() - start:.2f} sec\")\nresid_prec = resid.copy()\n\nsemilogy(resid_plain, label=\"no preconditioner\")\nsemilogy(resid_prec, label=\"diagonal preconditioner\")\nxlabel(\"iteration\"), ylabel(\"residual norm\")\nlegend(),  title(\"Convergence of CG with and without preconditioning\");","visibility":"hide","key":"OjFN95UnA3"},{"type":"output","id":"5QP7Za5DmiwMjmBJYo_4q","data":[{"output_type":"stream","name":"stdout","text":"No preconditioner: Finished in 1.15 sec\n"},{"output_type":"stream","name":"stdout","text":"Diagonal preconditioner: Finished in 0.32 sec\n"},{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"f1fe579e82c20e3715d6d8069bc93fc4","path":"/build/f1fe579e82c20e3715d6d8069bc93fc4.png"}}}],"visibility":"show","key":"eEeEfRoDZR"}],"data":{"tags":[]},"visibility":"show","key":"OvokrAabty"},{"type":"paragraph","position":{"start":{"line":881,"column":1},"end":{"line":881,"column":1}},"children":[{"type":"text","value":"The diagonal preconditioner cut down substantially on the number of iterations and the execution time.","position":{"start":{"line":881,"column":1},"end":{"line":881,"column":1}},"key":"vBmXIxyoCH"}],"key":"ofVBbFZiHr"}],"key":"imc9L49cJj"}],"key":"HPVBfk4osd"}],"key":"IzglQcPcQs"}],"key":"On65e1DJeD"}],"label":"demo-precond-diagonal","identifier":"demo-precond-diagonal","html_id":"demo-precond-diagonal","enumerator":"8.8.1","key":"RMEXeodDsS"},{"type":"heading","depth":2,"position":{"start":{"line":68,"column":1},"end":{"line":68,"column":1}},"children":[{"type":"text","value":"Incomplete factorization","position":{"start":{"line":68,"column":1},"end":{"line":68,"column":1}},"key":"UFoDPSW2rR"}],"identifier":"incomplete-factorization","label":"Incomplete factorization","html_id":"incomplete-factorization","implicit":true,"enumerator":"8.8.2","key":"Rt9Z1br6Gu"},{"type":"paragraph","position":{"start":{"line":73,"column":1},"end":{"line":73,"column":1}},"children":[{"type":"text","value":"Another general-purpose technique is the ","position":{"start":{"line":73,"column":1},"end":{"line":73,"column":1}},"key":"nps3NZq4ND"},{"type":"strong","position":{"start":{"line":73,"column":1},"end":{"line":73,"column":1}},"children":[{"type":"text","value":"incomplete LU factorization","position":{"start":{"line":73,"column":1},"end":{"line":73,"column":1}},"key":"edrHeT0o9b"}],"key":"G9j5Ux1M2P"},{"type":"text","value":". Since true factorization of a sparse matrix usually leads to an undesirable amount of fill-in, incomplete LU sacrifices exact factors by dropping elements smaller than an adjustable threshold.","position":{"start":{"line":73,"column":1},"end":{"line":73,"column":1}},"key":"kdmK8gpkdg"}],"indexEntries":[{"entry":"LU factorization","subEntry":{"value":"incomplete","kind":"entry"},"emphasis":true}],"label":"index-sopNLQbj9J","identifier":"index-sopnlqbj9j","html_id":"index-sopnlqbj9j","key":"rUfpjACKIW"},{"type":"proof","kind":"example","enumerated":true,"children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Incomplete LU preconditioning","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"key":"drJDTRItir"}],"key":"QOkknxvdAL"},{"type":"tabSet","children":[{"type":"tabItem","title":"Julia","sync":"julia","children":[{"type":"embed","source":{"url":"/chapter8","label":"demo-precond-gmres-julia","kind":"Notebook","slug":"chapter8","location":"/julia/chapter8.md","title":"Chapter 8"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-precond-gmres","label":"demo-precond-gmres","kind":"proof:example","position":{"start":{"line":867,"column":1},"end":{"line":867,"column":20}},"children":[{"type":"text","value":"Example ","key":"naB9jMm1pC"},{"type":"text","value":"8.8.2","key":"FLaI6u3EZn"}],"template":"Example %s","enumerator":"8.8.2","resolved":true,"html_id":"demo-precond-gmres","remote":true,"url":"/precond","dataUrl":"/precond.json","key":"kvEqEWFQ1V"}],"key":"aqa67OaE4Z"},{"type":"paragraph","position":{"start":{"line":869,"column":1},"end":{"line":869,"column":1}},"children":[{"type":"text","value":"Here is a nonsymmetric matrix arising from a probabilistic model in computational chemistry.","position":{"start":{"line":869,"column":1},"end":{"line":869,"column":1}},"key":"YVbf3d0HEN"}],"key":"K0mhvdnZTE"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"using SparseArrays\nA = sparse(matrixdepot(\"Watson/chem_master1\"))\nn = size(A, 1)\n@show n, nnz(A), issymmetric(A)","key":"bTi4E7TNMJ"},{"type":"output","id":"QSV3iwr0phbIj5_A7XtcX","data":[{"output_type":"stream","name":"stdout","text":"(n, nnz(A), issymmetric(A)) = (40401, 201201, false)"},{"output_type":"stream","name":"stdout","text":"\n"},{"output_type":"execute_result","execution_count":72,"metadata":{},"data":{"text/plain":{"content":"(40401, 201201, false)","content_type":"text/plain"}}}],"key":"EzovdFU0fa"}],"data":{},"key":"d8KqsNegIo"},{"type":"paragraph","position":{"start":{"line":878,"column":1},"end":{"line":878,"column":1}},"children":[{"type":"text","value":"Without a preconditioner, GMRES makes essentially no progress after 100 iterations.","position":{"start":{"line":878,"column":1},"end":{"line":878,"column":1}},"key":"Z0AJ88aLwq"}],"key":"jwoZQP5fvq"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"b = rand(40000)\nconst GMRES = IterativeSolvers.gmres\nx, history = GMRES(A, b, maxiter=100, reltol=1e-5, log=true)\nresnorm = history[:resnorm]\n@show resnorm[end] / resnorm[1];","key":"Un1XHjfH7L"},{"type":"output","id":"PBGH5lxktg_ugyFfdDIwu","data":[{"output_type":"stream","name":"stdout","text":"resnorm[end] / resnorm[1] = 0.9688576715478653"},{"output_type":"stream","name":"stdout","text":"\n"}],"key":"WvLY8OWdRO"}],"data":{},"key":"vhVEiJzA2n"},{"type":"paragraph","position":{"start":{"line":891,"column":1},"end":{"line":891,"column":1}},"children":[{"type":"text","value":"The following version of incomplete LU factorization drops all sufficiently small values (i.e., replaces them with zeros). This keeps the number of nonzeros in the factors under control.","position":{"start":{"line":891,"column":1},"end":{"line":891,"column":1}},"key":"Kwx7ncBsqV"}],"indexEntries":[{"entry":"Julia","subEntry":{"value":"ilu","kind":"entry"},"emphasis":true}],"key":"If46Tt7IBg"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"using IncompleteLU\niLU = ilu(A, τ=0.25)\n@show nnz(iLU) / nnz(A);","key":"M4gLVLfuXq"},{"type":"output","id":"h0q6BYxUu2e9Rw0x9Ycbs","data":[{"output_type":"stream","name":"stdout","text":"nnz(iLU) / nnz(A) = 9.654509669435043"},{"output_type":"stream","name":"stdout","text":"\n"}],"key":"H4vKkLtVkO"}],"data":{},"key":"L5ifqaY3KR"},{"type":"paragraph","position":{"start":{"line":899,"column":1},"end":{"line":899,"column":1}},"children":[{"type":"text","value":"The result is almost 10 times as dense as ","position":{"start":{"line":899,"column":1},"end":{"line":899,"column":1}},"key":"ZiUaDrlAPo"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":899,"column":1},"end":{"line":899,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"w8PAhDUjb6"},{"type":"text","value":" and yet still not a true factorization of it. However, it’s close enough for an approximate inverse in a preconditioner. The actual preconditioning matrix is ","position":{"start":{"line":899,"column":1},"end":{"line":899,"column":1}},"key":"rQZT8vN9CF"},{"type":"inlineMath","value":"\\mathbf{M}=\\mathbf{L}\\mathbf{U}","position":{"start":{"line":899,"column":1},"end":{"line":899,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">M</mi><mo>=</mo><mi mathvariant=\"bold\">L</mi><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{M}=\\mathbf{L}\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">M</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">LU</span></span></span></span>","key":"vGxtTogPsT"},{"type":"text","value":", but we just supply the factorization to ","position":{"start":{"line":899,"column":1},"end":{"line":899,"column":1}},"key":"kbGNsSg8xd"},{"type":"inlineCode","value":"gmres","position":{"start":{"line":899,"column":1},"end":{"line":899,"column":1}},"key":"O38jUKGZMC"},{"type":"text","value":".","position":{"start":{"line":899,"column":1},"end":{"line":899,"column":1}},"key":"kZuVIZGlMs"}],"key":"RtIhb35Mkh"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"_, history = GMRES(A, b, Pl=iLU, maxiter=100, reltol=1e-5, log=true)\nhistory","key":"yZ6tv9CFuO"},{"type":"output","id":"rNGasjiYedMhYc0ASCyQc","data":[{"output_type":"execute_result","execution_count":75,"metadata":{},"data":{"text/plain":{"content":"Converged after 7 iterations.","content_type":"text/plain"}}}],"key":"aJ3TGSzvex"}],"data":{},"key":"b7EuVMTXwE"},{"type":"paragraph","position":{"start":{"line":906,"column":1},"end":{"line":906,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":906,"column":1},"end":{"line":906,"column":1}},"key":"shxltDbN8E"},{"type":"text","value":"τ","position":{"start":{"line":906,"column":1},"end":{"line":906,"column":1}},"key":"fjC0K1HP6z"},{"type":"text","value":" parameter in ","position":{"start":{"line":906,"column":1},"end":{"line":906,"column":1}},"key":"AJda4OsoCH"},{"type":"inlineCode","value":"ilu","position":{"start":{"line":906,"column":1},"end":{"line":906,"column":1}},"key":"eM3BEphGei"},{"type":"text","value":" balances the accuracy of the iLU factorization with the time needed to compute it and invert it. As ","position":{"start":{"line":906,"column":1},"end":{"line":906,"column":1}},"key":"OTNtLlMN3g"},{"type":"inlineMath","value":"\\tau\\to 0","position":{"start":{"line":906,"column":1},"end":{"line":906,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>τ</mi><mo>→</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">\\tau\\to 0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.1132em;\">τ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"GbcU4njQxj"},{"type":"text","value":", more of the elements are kept, making the preconditioner more effective but slower per iteration.","position":{"start":{"line":906,"column":1},"end":{"line":906,"column":1}},"key":"MTGz872KQY"}],"key":"TYEfwHvmva"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"plt = plot(0:40, resnorm[1:41] / resnorm[1];\n    label=\"no preconditioning\",  legend=:bottomright,\n    xaxis=(\"iteration number\"),\n    yaxis=(:log10, \"residual norm\"),\n    title=\"Incomplete LU preconditioning\")\nfor τ in [2, 1, 0.25, 0.1]\n    t = @elapsed iLU = ilu(A; τ)\n    t += @elapsed _, history = GMRES(A, b, Pl=iLU, maxiter=100,\n        reltol=1e-5, log=true)\n    resnorm = history[:resnorm]\n    label = \"τ = $τ, time = $(round(t,digits=3))\"\n    plot!(0:length(resnorm)-1, resnorm / resnorm[1]; label)\nend\nplt","visibility":"hide","key":"xS5ytPxEJQ"},{"type":"output","id":"KISO3vJRXdgKlcvcUARyV","data":[{"output_type":"execute_result","execution_count":76,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"3228312f43cff3448f895bdb9e0ab82e","path":"/build/3228312f43cff3448f895bdb9e0ab82e.png"},"text/html":{"content_type":"text/html","hash":"a49991562c9d6cc84951c235d411e5b6","path":"/build/a49991562c9d6cc84951c235d411e5b6.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"e33d0af2846979d67a27581d779803d2","path":"/build/e33d0af2846979d67a27581d779803d2.svg"}}}],"visibility":"show","key":"CURdVprQgb"}],"data":{"tags":[]},"visibility":"show","key":"QWfyPlcrEh"},{"type":"paragraph","position":{"start":{"line":927,"column":1},"end":{"line":927,"column":1}},"children":[{"type":"text","value":"In any given problem, it’s impossible to know in advance where the right balance lies between fidelity and speed for the preconditioner.","position":{"start":{"line":927,"column":1},"end":{"line":927,"column":1}},"key":"SunrVrYFUW"}],"key":"Wxx0AvDRUL"}],"key":"ya8BdUY7tp"}],"key":"hKQrtbzpZC"}],"key":"mCzzIQdhfb"},{"type":"tabItem","title":"MATLAB","sync":"matlab","children":[{"type":"embed","source":{"url":"/chapter8-1","label":"demo-precond-gmres-matlab","kind":"Notebook","slug":"chapter8-1","location":"/matlab/chapter8.md","title":"Chapter 8"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-precond-gmres","label":"demo-precond-gmres","kind":"proof:example","position":{"start":{"line":810,"column":1},"end":{"line":810,"column":20}},"children":[{"type":"text","value":"Example ","key":"HO1MPIQI7a"},{"type":"text","value":"8.8.2","key":"sHkIVaXg2i"}],"template":"Example %s","enumerator":"8.8.2","resolved":true,"html_id":"demo-precond-gmres","remote":true,"url":"/precond","dataUrl":"/precond.json","key":"XjkUaq28Uc"}],"key":"ZbGua7NzBJ"},{"type":"paragraph","position":{"start":{"line":812,"column":1},"end":{"line":812,"column":1}},"children":[{"type":"text","value":"Here is a random nonsymmetric matrix.","position":{"start":{"line":812,"column":1},"end":{"line":812,"column":1}},"key":"RcrbAPZ9J0"}],"key":"KXsmMbb7Jk"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"n = 8000;\nA = speye(n) + sprand(n, n, 0.00035);","key":"NuM3t61XsD"},{"type":"output","id":"CPH3YqAv7uOxYz1UtUzYt","data":[],"key":"g8LAq30lni"}],"data":{},"key":"XMC9wBdIx5"},{"type":"paragraph","position":{"start":{"line":819,"column":1},"end":{"line":819,"column":1}},"children":[{"type":"text","value":"Without a preconditioner, restarted GMRES makes slow progress.","position":{"start":{"line":819,"column":1},"end":{"line":819,"column":1}},"key":"rdHY3fenmZ"}],"key":"a4mloKQ4MB"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"b = rand(n, 1);\n[x, ~, ~, ~, resid_plain] = gmres(A, b, 50, 1e-10, 3);  % restart at 50\nformat short e\nresid_plain(1:30:end)","key":"R9M8GV2GVo"},{"type":"output","id":"n3YLwVzU_6BYJlBCEC1HH","data":[{"output_type":"stream","name":"stderr","text":"Error using rand\nSize inputs must be scalar."}],"key":"CFuAXhTYJM"}],"data":{},"key":"KNTRrBkzGk"},{"type":"paragraph","position":{"start":{"line":831,"column":1},"end":{"line":831,"column":1}},"children":[{"type":"text","value":"This version of incomplete LU factorization simply prohibits fill-in for the factors, freezing the sparsity pattern of the approximate factors to match the original matrix.","position":{"start":{"line":831,"column":1},"end":{"line":831,"column":1}},"key":"JZFJccICFJ"}],"indexEntries":[{"entry":"MATLAB","subEntry":{"value":"ilu","kind":"entry"},"emphasis":true}],"key":"e4j2ACmyz4"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[L, U] = ilu(A);\nclf\nsubplot(121), spy(L)\ntitle('L')\nsubplot(122), spy(U)\ntitle('U')\ndisp(sprintf(\"There are %d nonzeros in A\", nnz(A)))","key":"hGdBfEjTxi"},{"type":"output","id":"lsPu6OSXiCR6LI5rcBKWw","data":[{"output_type":"stream","name":"stderr","text":"Error using ilu\nFirst argument must be sparse."}],"key":"d5owcOEOdi"}],"data":{},"key":"CBaJt14Chl"},{"type":"paragraph","position":{"start":{"line":843,"column":1},"end":{"line":843,"column":1}},"children":[{"type":"text","value":"It does ","position":{"start":{"line":843,"column":1},"end":{"line":843,"column":1}},"key":"GPzfjbJGmM"},{"type":"emphasis","position":{"start":{"line":843,"column":1},"end":{"line":843,"column":1}},"children":[{"type":"text","value":"not","position":{"start":{"line":843,"column":1},"end":{"line":843,"column":1}},"key":"skuvYtyuuE"}],"key":"qsdVxzEuD8"},{"type":"text","value":" produce a true factorization of ","position":{"start":{"line":843,"column":1},"end":{"line":843,"column":1}},"key":"I2QOeQuTDr"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":843,"column":1},"end":{"line":843,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"CrbuViUeXM"},{"type":"text","value":".","position":{"start":{"line":843,"column":1},"end":{"line":843,"column":1}},"key":"Qj5Pp08yId"}],"key":"DWVsT26oMK"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"norm( full(A - L * U) )","key":"PKWOsicXB8"},{"type":"output","id":"Pgoa7ZNQASWGZc2bUy9xI","data":[{"output_type":"stream","name":"stderr","text":"Error using -\nArrays have incompatible sizes for this operation."}],"key":"FPKhUTNxDZ"}],"data":{},"key":"yL7NOOwkW8"},{"type":"paragraph","position":{"start":{"line":849,"column":1},"end":{"line":849,"column":1}},"children":[{"type":"text","value":"The actual preconditioning matrix is ","position":{"start":{"line":849,"column":1},"end":{"line":849,"column":1}},"key":"UgCxB9QgIO"},{"type":"inlineMath","value":"\\mathbf{M}=\\mathbf{L}\\mathbf{U}","position":{"start":{"line":849,"column":1},"end":{"line":849,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">M</mi><mo>=</mo><mi mathvariant=\"bold\">L</mi><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{M}=\\mathbf{L}\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">M</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">LU</span></span></span></span>","key":"CYHdFNLlOj"},{"type":"text","value":". However, the ","position":{"start":{"line":849,"column":1},"end":{"line":849,"column":1}},"key":"mlpOwRUiRI"},{"type":"inlineCode","value":"gmres","position":{"start":{"line":849,"column":1},"end":{"line":849,"column":1}},"key":"Y6cmxfi25Q"},{"type":"text","value":" function allows setting the preconditioner by giving the factors independently.","position":{"start":{"line":849,"column":1},"end":{"line":849,"column":1}},"key":"lCI0vHO2sY"}],"key":"hBeEXTbiBR"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[x, ~, ~, ~, resid_prec] = gmres(A, b, [], 1e-10, 300, L, U);","key":"YPYjWeeJV2"},{"type":"output","id":"XOju6HKXTchd2gGz5-2Ep","data":[{"output_type":"stream","name":"stderr","text":"Error using gmres (line 93)\nRight hand side must be a column vector of length 2400 to match the coefficient matrix."}],"key":"SikHAaAmDE"}],"data":{},"key":"u1TcwlAyTy"},{"type":"paragraph","position":{"start":{"line":855,"column":1},"end":{"line":855,"column":1}},"children":[{"type":"text","value":"The preconditioner makes a significant difference in the number of iterations needed.","position":{"start":{"line":855,"column":1},"end":{"line":855,"column":1}},"key":"zFkCZ1W9PR"}],"key":"ZVdX49f7Dy"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf, semilogy(resid_plain)\nhold on, semilogy(resid_prec)\nxlabel('iteration number'), ylabel('residual norm')\ntitle('Precondtioned GMRES ')\nlegend('no preconditioner', 'with preconditioner');","key":"V5LzucVg1z"},{"type":"output","id":"R8_8cumTe-bfcNx_NWff_","data":[{"output_type":"stream","name":"stderr","text":"Unrecognized function or variable 'resid_plain'."}],"key":"AGI2bB7Ic4"}],"data":{},"key":"qw70CxI4Iu"},{"type":"code","lang":"","value":"","position":{"start":{"line":864,"column":1},"end":{"line":864,"column":1}},"key":"f3aAsD8Ju0"}],"key":"S9Far2HnbG"}],"key":"LkafltKTkh"}],"key":"GUCO6DLLEF"},{"type":"tabItem","title":"Python","sync":"python","children":[{"type":"embed","source":{"url":"/chapter8-2","label":"demo-precond-gmres-python","kind":"Notebook","slug":"chapter8-2","location":"/python/chapter8.md","title":"Chapter 8"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-precond-gmres","label":"demo-precond-gmres","kind":"proof:example","position":{"start":{"line":885,"column":1},"end":{"line":885,"column":20}},"children":[{"type":"text","value":"Example ","key":"OhNC3gtNG7"},{"type":"text","value":"8.8.2","key":"ogAT7pCsH7"}],"template":"Example %s","enumerator":"8.8.2","resolved":true,"html_id":"demo-precond-gmres","remote":true,"url":"/precond","dataUrl":"/precond.json","key":"gnGn5WJKIA"}],"key":"Gjs7whLU7R"},{"type":"paragraph","position":{"start":{"line":887,"column":1},"end":{"line":887,"column":1}},"children":[{"type":"text","value":"Here is a random nonsymmetric matrix.","position":{"start":{"line":887,"column":1},"end":{"line":887,"column":1}},"key":"a9BqVBArOA"}],"key":"vU40YkUwVN"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import scipy.sparse as sp\nn = 8000\nA = 2.8 * sp.eye(n) + sp.rand(n, n, 0.002)","key":"Ec5q4KaPOz"},{"type":"output","id":"REiIGFu1na71t3KlZfAff","data":[],"key":"JqntfZwWV6"}],"data":{},"key":"PsLtgn5MjO"},{"type":"paragraph","position":{"start":{"line":895,"column":1},"end":{"line":895,"column":1}},"children":[{"type":"text","value":"Without a preconditioner, GMRES can solve a system with this matrix.","position":{"start":{"line":895,"column":1},"end":{"line":895,"column":1}},"key":"e6HAar3Q5a"}],"key":"pRW3EI5myt"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from scipy.sparse.linalg import gmres\n\nb = random.rand(n)\nhist = lambda rvec: resid.append(norm(rvec))\nresid = [1.]\n\nstart = timer()\nx, flag = gmres(A, b, maxiter=300, rtol=1e-10, restart=50, callback=hist)\nprint(f\"time for plain GMRES: {timer() - start:.3f} sec\")\nresid_plain = resid.copy()","key":"HJFi97919c"},{"type":"output","id":"1neDHHfFavGSj9NIL8Asu","data":[{"output_type":"stream","name":"stdout","text":"time for plain GMRES: 0.177 sec\n"}],"key":"kTo5ibkWAy"}],"data":{},"key":"uboWvvtajK"},{"type":"paragraph","position":{"start":{"line":913,"column":1},"end":{"line":913,"column":1}},"children":[{"type":"text","value":"The following version of incomplete LU factorization drops all sufficiently small values (i.e., replaces them with zeros). This keeps the number of nonzeros in the factors under control.","position":{"start":{"line":913,"column":1},"end":{"line":913,"column":1}},"key":"NtvUNiFjBC"}],"indexEntries":[{"entry":"Python","subEntry":{"value":"spilu","kind":"entry"},"emphasis":true}],"key":"Qz46MiisXM"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from scipy.sparse.linalg import spilu\niLU = spilu(A, drop_tol=0.2)\nprint(f\"Factors have {iLU.nnz} nonzeros, while A has {A.nnz}\")","key":"s3JJSnK4Ps"},{"type":"output","id":"PfPJxgnRoeHnMQSps5Y_n","data":[{"output_type":"stream","name":"stderr","text":"/var/folders/y5/mgf703t57tx9cwrbbjjvdzzr0000gr/T/ipykernel_44645/769705972.py:2: SparseEfficiencyWarning: spilu converted its input to CSC format\n  iLU = spilu(A, drop_tol=0.2)\n"},{"output_type":"stream","name":"stdout","text":"Factors have 90006 nonzeros, while A has 135984\n"}],"key":"iAauHs0O8U"}],"data":{},"key":"XiMsDxIrk5"},{"type":"paragraph","position":{"start":{"line":921,"column":1},"end":{"line":921,"column":1}},"children":[{"type":"text","value":"The result is not a true factorization of the original matrix. However, it’s close enough for an approximate inverse in a preconditioner.","position":{"start":{"line":921,"column":1},"end":{"line":921,"column":1}},"key":"qojrAdO2aa"}],"key":"g7PLQ5e4sR"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from scipy.sparse.linalg import LinearOperator\nprec = LinearOperator((n, n), matvec=lambda y: iLU.solve(y))\n\nresid = [1.];  start = timer()\nx, flag = gmres(A, b, M=prec, maxiter=300, rtol=1e-10, restart=50, callback=hist)\nprint(f\"time for preconditioned GMRES: {timer() - start:.3f} sec\")\nresid_prec = resid","key":"Q0xRND0UdA"},{"type":"output","id":"t_P3Q_i--Zs4kfVm7JaVR","data":[{"output_type":"stream","name":"stdout","text":"time for preconditioned GMRES: 0.127 sec\n"}],"key":"vPSMbUEX1M"}],"data":{},"key":"GQLGbIbqFW"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"semilogy(resid_plain, label=\"no prec.\")\nsemilogy(resid_prec, label=\"iLU prec.\")\nxlabel(\"iteration number\"),  ylabel(\"residual norm\")\nlegend()\ntitle(\"GMRES convergence compared\");","visibility":"hide","key":"MCwhZnB77i"},{"type":"output","id":"5tZMBLSUQp08Z1PsZiQJF","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"f954d353256da46f88d52e72634d4be5","path":"/build/f954d353256da46f88d52e72634d4be5.png"}}}],"visibility":"show","key":"de1JG49qEy"}],"data":{"tags":[]},"visibility":"show","key":"OhfMr65klY"}],"key":"Opjkp96P27"}],"key":"aLQXSCOUER"}],"key":"pHfOD4VEzN"}],"key":"BhwbYXJmFP"}],"label":"demo-precond-gmres","identifier":"demo-precond-gmres","html_id":"demo-precond-gmres","enumerator":"8.8.2","key":"Sf9c1q63OX"},{"type":"paragraph","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"children":[{"type":"text","value":"In practice, good preconditioning is often as important, if not more important, than the specific choice of Krylov method. Effective preconditioning may require deep understanding of the underlying application, however, which limits our ability to go into further details. For instance, the linear system may be some approximation of a continuous mathematical model, and then ","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"key":"Xa813ZxIWJ"},{"type":"inlineMath","value":"\\mathbf{M}","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">M</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{M}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">M</span></span></span></span>","key":"VCCvZIUrpx"},{"type":"text","value":" can be derived by using a cruder form of the approximation. Krylov methods offer a natural way to exploit these and other approximate inverses.","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"key":"p0XHIK6Iq7"}],"key":"wq13tMoxmf"},{"type":"heading","depth":2,"position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"children":[{"type":"text","value":"Exercises","position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"key":"Bkqlov8rE0"}],"identifier":"exercises","label":"Exercises","html_id":"exercises","implicit":true,"enumerator":"8.8.3","key":"fiYfee0AoK"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":104,"column":1},"end":{"line":140,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":104,"column":1},"end":{"line":105,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":104,"column":1},"end":{"line":104,"column":1}},"children":[{"type":"text","value":"✍ Suppose ","position":{"start":{"line":104,"column":1},"end":{"line":104,"column":1}},"key":"zSGbmuLCKZ"},{"type":"inlineMath","value":"\\mathbf{M}=\\mathbf{R}^T\\mathbf{R}","position":{"start":{"line":104,"column":1},"end":{"line":104,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">M</mi><mo>=</mo><msup><mi mathvariant=\"bold\">R</mi><mi>T</mi></msup><mi mathvariant=\"bold\">R</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{M}=\\mathbf{R}^T\\mathbf{R}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">M</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8413em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">R</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span><span class=\"mord mathbf\">R</span></span></span></span>","key":"CWV62wl7Rp"},{"type":"text","value":". Show that the eigenvalues of ","position":{"start":{"line":104,"column":1},"end":{"line":104,"column":1}},"key":"Ki1wvcg41K"},{"type":"inlineMath","value":"\\mathbf{R}^{-T}\\mathbf{A}\\mathbf{R}^{-1}","position":{"start":{"line":104,"column":1},"end":{"line":104,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi mathvariant=\"bold\">R</mi><mrow><mo>−</mo><mi>T</mi></mrow></msup><mi mathvariant=\"bold\">A</mi><msup><mi mathvariant=\"bold\">R</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding=\"application/x-tex\">\\mathbf{R}^{-T}\\mathbf{A}\\mathbf{R}^{-1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8413em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">R</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span></span><span class=\"mord mathbf\">A</span><span class=\"mord\"><span class=\"mord mathbf\">R</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span></span></span></span>","key":"EdSHeiglb5"},{"type":"text","value":" are the same as the eigenvalues of ","position":{"start":{"line":104,"column":1},"end":{"line":104,"column":1}},"key":"lO0DS0Gbf3"},{"type":"inlineMath","value":"\\mathbf{M}^{-1}\\mathbf{A}","position":{"start":{"line":104,"column":1},"end":{"line":104,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi mathvariant=\"bold\">M</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{M}^{-1}\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">M</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"XgMOanoiD3"},{"type":"text","value":". (This observation underlies preconditioning variants for ","key":"hlZEmaKII9"},{"type":"abbreviation","title":"symmetric positive definite","children":[{"type":"text","value":"SPD","key":"lqUelqrCPM"}],"key":"an5loiPmD2"},{"type":"text","value":" matrices.)","key":"DIfCWr4wuQ"}],"key":"RyNn9ZazzX"}],"key":"wdYQKexHVk"},{"type":"listItem","spread":true,"position":{"start":{"line":106,"column":1},"end":{"line":118,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":106,"column":1},"end":{"line":106,"column":1}},"children":[{"type":"text","value":"⌨ The object returned by ","position":{"start":{"line":106,"column":1},"end":{"line":106,"column":1}},"key":"Tu31mqsUEJ"},{"type":"inlineCode","value":"ilu","position":{"start":{"line":106,"column":1},"end":{"line":106,"column":1}},"key":"IEhvo7b9LS"},{"type":"text","value":" stores the factors in a way that optimizes sparse triangular substitution. You can recover the factors themselves via","position":{"start":{"line":106,"column":1},"end":{"line":106,"column":1}},"key":"U4UsQ6lYFu"}],"key":"M2xyl9QQR4"},{"type":"code","lang":"julia","value":"iLU = ilu(A,τ=0.1)   # for example\nL, U = I+iLU.L, iLU.U'","position":{"start":{"line":108,"column":1},"end":{"line":111,"column":1}},"key":"XGvcgipQzQ"},{"type":"paragraph","position":{"start":{"line":113,"column":1},"end":{"line":113,"column":1}},"children":[{"type":"text","value":"In this problem, use ","position":{"start":{"line":113,"column":1},"end":{"line":113,"column":1}},"key":"qkDfoKkQmB"},{"type":"inlineCode","value":"A = 1.5I + sprand(800,800,0.005)","position":{"start":{"line":113,"column":1},"end":{"line":113,"column":1}},"key":"jgffEcc5vs"},{"type":"text","value":".","position":{"start":{"line":113,"column":1},"end":{"line":113,"column":1}},"key":"ZeGjsYHxM2"}],"key":"NDMhzVwhn6"},{"type":"paragraph","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"children":[{"type":"strong","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"children":[{"type":"text","value":"(a)","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"key":"WowVpJHM8X"}],"key":"FrMhWeeILB"},{"type":"text","value":" Using ","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"key":"MbC4moiHwm"},{"type":"inlineMath","value":"\\tau=0.3","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>τ</mi><mo>=</mo><mn>0.3</mn></mrow><annotation encoding=\"application/x-tex\">\\tau=0.3</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.1132em;\">τ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0.3</span></span></span></span>","key":"dHaVvxlXpg"},{"type":"text","value":" for the factorization, plot the eigenvalues of ","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"key":"U94cjQSswv"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"HbwbwZCm9a"},{"type":"text","value":" and of ","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"key":"eSyg8nVU93"},{"type":"inlineMath","value":"\\mathbf{M}^{-1}\\mathbf{A}","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi mathvariant=\"bold\">M</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{M}^{-1}\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">M</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"mWjMep582k"},{"type":"text","value":" in the complex plane on side-by-side subplots. Do they support the notion that ","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"key":"gSQ03jGnWB"},{"type":"inlineMath","value":"\\mathbf{M}^{-1}\\mathbf{A}","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi mathvariant=\"bold\">M</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{M}^{-1}\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">M</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"WTScm2FQyo"},{"type":"text","value":" is “more like” an identity matrix than ","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"key":"VCi5IE2Zkb"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"LpuB2Y8Os7"},{"type":"text","value":" is? (Hint: the matrices are small enough to convert to standard dense form for the use of ","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"key":"D7HzBkoetu"},{"type":"inlineCode","value":"eigvals","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"key":"HtLTmqM4QH"},{"type":"text","value":".)","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"key":"UgXJ5YG9Tu"}],"key":"FbElzbXwz8"},{"type":"paragraph","position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"children":[{"type":"strong","position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"children":[{"type":"text","value":"(b)","position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"key":"QHhy6aeRFt"}],"key":"WpTbkpbr1j"},{"type":"text","value":" Repeat part (a) for ","position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"key":"lCfI7jRK32"},{"type":"inlineMath","value":"\\tau=0.03","position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>τ</mi><mo>=</mo><mn>0.03</mn></mrow><annotation encoding=\"application/x-tex\">\\tau=0.03</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.1132em;\">τ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0.03</span></span></span></span>","key":"ITYJQ1W7px"},{"type":"text","value":". Is ","position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"key":"KADxnp8K9r"},{"type":"inlineMath","value":"\\mathbf{M}","position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">M</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{M}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">M</span></span></span></span>","key":"GGlJGcoRki"},{"type":"text","value":" more accurate than in part (a), or less?","position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"key":"Ay7QjdZTDf"}],"key":"YUBrQIdtww"}],"key":"xBS2T5zCU5"},{"type":"listItem","spread":true,"position":{"start":{"line":119,"column":1},"end":{"line":132,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"children":[{"type":"text","value":"⌨ (Continuation of ","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"key":"VI95byF3Ev"},{"type":"crossReference","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"children":[{"type":"text","value":"Exercise 8.5.5","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"key":"jpVkC4GLdK"}],"identifier":"problem-gmres-surround","label":"problem-gmres-surround","kind":"list","template":"List","resolved":true,"html_id":"problem-gmres-surround","remote":true,"url":"/gmres","dataUrl":"/gmres.json","key":"yrrNfnA4Pj"},{"type":"text","value":".) Let ","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"key":"eDiaBmCf0W"},{"type":"inlineMath","value":"\\mathbf{B}","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">B</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{B}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">B</span></span></span></span>","key":"UjTl1wtyTW"},{"type":"text","value":" be ","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"key":"cHXYh2Sn4y"},{"type":"inlineCode","value":"diagm(1:100)","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"key":"HMGkqrdm97"},{"type":"text","value":",  let ","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"key":"qV5oR5snjS"},{"type":"inlineMath","value":"\\mathbf{I}","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">I</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{I}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">I</span></span></span></span>","key":"ScM9xhC0mK"},{"type":"text","value":" be ","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"key":"hPfWDdaStp"},{"type":"inlineCode","value":"I(100)","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"key":"x7HxwxlxAJ"},{"type":"text","value":", and let ","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"key":"HH106lmshC"},{"type":"inlineMath","value":"\\mathbf{Z}","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">Z</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{Z}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">Z</span></span></span></span>","key":"HDaWULO6Oe"},{"type":"text","value":" be a ","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"key":"b0sV3jU8I1"},{"type":"inlineMath","value":"100\\times 100","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>100</mn><mo>×</mo><mn>100</mn></mrow><annotation encoding=\"application/x-tex\">100\\times 100</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">100</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">100</span></span></span></span>","key":"adi2RZCk3y"},{"type":"text","value":" matrix of zeros. Define","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"key":"lUZCpOzSGW"}],"key":"qbAms6Foln"},{"type":"math","value":"\\mathbf{A} = \\begin{bmatrix}\n      \\mathbf{B} & \\mathbf{I} \\\\ \\mathbf{Z} & -\\mathbf{B}\n    \\end{bmatrix}","position":{"start":{"line":121,"column":1},"end":{"line":125,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi mathvariant=\"bold\">A</mi><mo>=</mo><mrow><mo fence=\"true\">[</mo><mtable rowspacing=\"0.16em\" columnalign=\"center center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mi mathvariant=\"bold\">B</mi></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mi mathvariant=\"bold\">I</mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mi mathvariant=\"bold\">Z</mi></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mi mathvariant=\"bold\">B</mi></mrow></mstyle></mtd></mtr></mtable><mo fence=\"true\">]</mo></mrow></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A} = \\begin{bmatrix}\n      \\mathbf{B} &amp; \\mathbf{I} \\\\ \\mathbf{Z} &amp; -\\mathbf{B}\n    \\end{bmatrix}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.4em;vertical-align:-0.95em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">[</span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">B</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">Z</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.95em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">I</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord mathbf\">B</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.95em;\"><span></span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">]</span></span></span></span></span></span></span>","enumerator":"8.8.2","key":"QuQWnOFS0K"},{"type":"paragraph","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"children":[{"type":"text","value":"and let ","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"key":"fp5nZCAZ0B"},{"type":"inlineMath","value":"\\mathbf{b}","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"H16cI9kQtU"},{"type":"text","value":" be a 200-vector of ones. The matrix ","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"key":"s3IlKRMQ0n"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"wRiIGUfd5B"},{"type":"text","value":" is difficult for GMRES.","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"key":"JlTjdeICcu"}],"key":"dmK9EgHbtu"},{"type":"paragraph","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"children":[{"type":"strong","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"children":[{"type":"text","value":"(a)","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"key":"NmlV5SgAuf"}],"key":"xg5TFamHjE"},{"type":"text","value":" Design a diagonal preconditioner ","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"key":"xRgTghlwo3"},{"type":"inlineMath","value":"\\mathbf{M}","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">M</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{M}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">M</span></span></span></span>","key":"QyjbFuim8W"},{"type":"text","value":", with all diagonal elements equal to ","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"key":"OmgwcJyxwv"},{"type":"text","value":"1","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"key":"l6UatYd0AD"},{"type":"text","value":" or ","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"key":"I5OqLDVNkN"},{"type":"text","value":"-1","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"key":"sNZabHWA9A"},{"type":"text","value":", such that ","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"key":"mXjwR7Tb7W"},{"type":"inlineMath","value":"\\mathbf{M}^{-1}\\mathbf{A}","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi mathvariant=\"bold\">M</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{M}^{-1}\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">M</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"FdjwH9t45P"},{"type":"text","value":" has all positive eigenvalues. Apply ","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"key":"qQtaiXia6U"},{"type":"inlineCode","value":"gmres","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"key":"AxDMaygQvF"},{"type":"text","value":" without restarts using this preconditioner and a tolerance of ","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"key":"TtkKJBwN4F"},{"type":"span","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"children":[{"type":"text","value":"10","key":"hoDabUa9QJ"},{"type":"superscript","children":[{"type":"text","value":"-10","key":"z1ocLmic3W"}],"key":"iCwDnPVk2B"}],"key":"W8bPtBIESl"},{"type":"text","value":" for 100 iterations. Plot the convergence curve.","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"key":"UZ1f7yiDNJ"}],"key":"XjGA8jvP30"},{"type":"paragraph","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"children":[{"type":"strong","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"children":[{"type":"text","value":"(b)","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"key":"Qrmy28e167"}],"key":"ReVFuZY3Ve"},{"type":"text","value":" Now design another diagonal preconditioner such that all the eigenvalues of ","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"key":"P25D6psvlG"},{"type":"inlineMath","value":"\\mathbf{M}^{-1}\\mathbf{A}","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi mathvariant=\"bold\">M</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{M}^{-1}\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">M</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"Xx99I1aXeq"},{"type":"text","value":" are ","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"key":"tEzdKmqMkT"},{"type":"text","value":"1","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"key":"Vk9KwWR5UZ"},{"type":"text","value":", and apply preconditioned ","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"key":"A8Yjqyod0L"},{"type":"inlineCode","value":"gmres","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"key":"KZW9NXDMxe"},{"type":"text","value":" again. How many iterations are apparently needed for convergence?","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"key":"LPp1i2sOBv"}],"key":"wUM4QHzVIy"}],"key":"ybRKYB12FB"},{"type":"listItem","spread":true,"position":{"start":{"line":133,"column":1},"end":{"line":140,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"children":[{"type":"text","value":"⌨ Let ","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"key":"OJrxyshhxE"},{"type":"inlineCode","value":"A = matrixdepot(\"Bai/rdb2048\")","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"key":"kRvMmSLvbS"},{"type":"text","value":", and let ","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"key":"Q3SOKm0hpZ"},{"type":"inlineCode","value":"b","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"key":"KTZW0RSSRB"},{"type":"text","value":" be a vector of 2048 ones. In the steps below, use GMRES for up to 300 iterations without restarts and with a stopping tolerance of ","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"key":"liCodGps8K"},{"type":"span","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"children":[{"type":"text","value":"10","key":"Q6rxbkCIR6"},{"type":"superscript","children":[{"type":"text","value":"-4","key":"vLgw7lhsRy"}],"key":"p5q7AzhhO8"}],"key":"q3rkDxkqyD"},{"type":"text","value":".","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"key":"CXcLMQVOQ8"}],"key":"q0UKac5Ujq"},{"type":"paragraph","position":{"start":{"line":135,"column":1},"end":{"line":135,"column":1}},"children":[{"type":"strong","position":{"start":{"line":135,"column":1},"end":{"line":135,"column":1}},"children":[{"type":"text","value":"(a)","position":{"start":{"line":135,"column":1},"end":{"line":135,"column":1}},"key":"A5bwB3aDf2"}],"key":"OSBiwIupuw"},{"type":"text","value":" Time the GMRES solution without preconditioning. Verify that convergence was achieved.","position":{"start":{"line":135,"column":1},"end":{"line":135,"column":1}},"key":"aXYoipzyx1"}],"key":"Zg9GqXtILW"},{"type":"paragraph","position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"children":[{"type":"strong","position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"children":[{"type":"text","value":"(b)","position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"key":"MK14RchCTx"}],"key":"DgUacbF1uJ"},{"type":"text","value":" Show that diagonal preconditioning is not helpful for this problem.","position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"key":"Y08If1GLFN"}],"key":"dRdrrRz4p1"},{"type":"paragraph","position":{"start":{"line":139,"column":1},"end":{"line":139,"column":1}},"children":[{"type":"strong","position":{"start":{"line":139,"column":1},"end":{"line":139,"column":1}},"children":[{"type":"text","value":"(c)","position":{"start":{"line":139,"column":1},"end":{"line":139,"column":1}},"key":"xa2yqWXDCg"}],"key":"Nyc9rU52dZ"},{"type":"text","value":" To two digits, find a value of ","position":{"start":{"line":139,"column":1},"end":{"line":139,"column":1}},"key":"O4X2oatIfa"},{"type":"text","value":"τ","position":{"start":{"line":139,"column":1},"end":{"line":139,"column":1}},"key":"Iu9Xbh4f3t"},{"type":"text","value":" in iLU such that the preconditioned method transitions from effective and faster than part (a) to ineffective.","position":{"start":{"line":139,"column":1},"end":{"line":139,"column":1}},"key":"rABIGAbCoC"}],"key":"hjJ59VXmMq"}],"key":"JEiC2v7OD7"}],"label":"problem-precond-spd","identifier":"problem-precond-spd","html_id":"problem-precond-spd","key":"ltCvPB9c3Z"}],"key":"PcJD5PMojP"}],"key":"KP9I9BXFnK"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Matrix-free iterations","url":"/matrixfree","group":"Preface"},"next":{"title":"Next steps","url":"/next-7","group":"Preface"}}},"domain":"http://localhost:3000"}